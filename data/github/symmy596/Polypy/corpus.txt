p aligncent img srchttpsgithubcomsymmypolypyblobmasterdocssourcefigurespolypy_pngrawtru p statushttpsjosstheojorgpapersefffeffabeafeacbcstatussvghttpsjosstheojorgpapersefffeffabeafeacbc pypi versionhttpsbadgefuryiopypolypysvghttpsbadgefuryiopypolypi build statushttpstraviscicomsymmypolypysvgbranchmasterhttpstraviscicomsymmypolypi build statushttpsciappveyorcomapiprojectsstatuseomlmkbhrxsvgtruehttpsciappveyorcomprojectsymmypolypi document statushttpsreadthedocsorgprojectspolypybadgeversionlatesthttpspolypyreadthedocsioenlatestbadgelatest hrefhttpscoverallsiogithubsymmypolypybranchmasterimg srchttpscoverallsioreposgithubsymmypolypybadgesvgbranchmast altcoverag statu doihttpszenodoorgbadgedoizenodosvghttpsdoiorgzenodo document opensourc python project polypi librari design facilit analysi dl_polyhttpswwwscdstfcacukpagesdl_polyaspx dl_montehttpswwwccpacukdl_mont calcul polypi built exist python packag solid state physicschemistri commun alreadi familiar hope tool bring benfit solid state commun facilit data analysi gener public readi plot power matplotlib main featur includ method analys number denisti given speci one two dimens gener plot total number speci bin perpendicular specifi direct gener plot total number speci cuboid parallel specifi direct method calcul charg densiti number densiti convert number densiti speci bin perpendicular specifi direct charg densiti calcul electr field electrostat potenti charg densiti solv poisson boltzmann equat convert charg densiti electr field electrostat potenti calcul diffus coeffici given speci mean squar displac carri mean squar displac md trajectori calcul diffus coeffici use densiti analysi diffus coeffici calcul ionic conduct p aligncent img srchttpsgithubcomsymmypolypyblobmasterdocssourcefiguresshow_offpngrawtru width figcaptiona mean squar displac calcuim fluorid b system volum calcium fluorid molecular dynam simul c cerium oxygen number densiti grain boundari electrostat potenti across grain boundari cerium oxid e center mass cerium blue oxygen orang cerium oxid grain boundari two dimensionsfigcapt p code develop analys dl_poli dl_mont calcul howev code incorpor user demand format pdb xyz convert dl_poli format code atomskhttpsatomskunivlillefr analys polypi user welcom increas file coverag ad read function differ format accomplish ad read modul class uniqu file type convert polypyreadtrajectori object polypi develop phd project function focus research question encount project clarifi wide rang code contribut aim expand code new problem encourag polypi free use usag full list exampl found exampl folder git repositori includ python script jupyt notebook tutori combin full theori code exampl note howev dl_poli histori file dl_mont archiv file sizabl gb short exampl trajectori includ repositori notebook provid illustr theori practicl instal polypi python packag requir typic scientif python stack use tutori requir anacondajupyt instal build sourc pip instal r requirementstxt python setuppi build python setuppi instal altern instal pip pip instal polypi use conda conda skeleton pypi polypi conda build polypi conda instal useloc polypi test test run type python setuppi test root directori document build document scratch cd doc make html onlin version document found herehttpspolypyreadthedocsioenlatestindexhtml document contain extens explan underli theori function document tutori licens polypi made avail mit licens detail requir polypi compat python reli number open sourc python packag specif matplotlib numpi scipi coveral coverag seaborn panda jupyt nbsphinx jupytersphinx sphinx_rtd_them contribut contact question regard aspect softwar pleas get touch develop adam symington via email arsbathacuk altern creat issu issu trackerhttpsgithubcomsymmypolypyissu bug may bug think youv caught one pleas report issu trackerhttpsgithubcomsymmypolypyissu also place propos new idea featur ask question design polypi poor document consid bug feel free request improv code contribut welcom help improv extend packag manag github pull request extern contribut prefer fork pullhttpsguidesgithubcomactivitiesfork workflow core develop use branch main repositori first open issu discuss propos contribut discuss might includ chang fit polypi scope gener technic approach make project fork implement chang pleas keep code style compliant pep open pull request merg chang main project detail discuss take place chang accept inform pleas contact adam symington arsbathacuk futur list seri use addit would like make codebas user encourag fork repositori work problem inde function list welcom add rdf diagon slice region msd cube author adam rsymington research defect segreg facilit oxygen transport fluorit uo grain boundarieshttpsroyalsocietypublishingorgdoifullrsta role dopant segreg oxygen vacanc distribut oxygen diffus ceo grain boundarieshttpsiopscienceioporgarticleabbmeta quantifi impact disord liion naion transport perovskit titan solid electrolyt solidst batterieshttpspubsrscorgencontentarticlehtmltadtak elucid natur grain boundari resist lithium lanthanum titanatehttpspubsrscorgencontentarticlelandingtadtahdivabstract acknowledg packag written phd project fund awe epsrc epr polypi softwar packag develop analys data gener use balena hpc facil univers bath archer uk nation supercomput servic httpwwwarcheracuk via membership uk hec materi chemistri consortium fund epsrc eplth author would like thank andrew r mccluskey benjamin morgan marco molinari jame grant stephen c parker help guidanc phd project titl polypi analysi tool solid state molecular dynam mont carlo trajectori tag chemistri physic materi scienc solid state chemistri simul molecular dynam mont carlo author name adam r symington orcid x affili affili name depart chemistri univers bath index date septemb bibliographi paperbib summari larg number research question solid state chemistri address use molecular dynam mont carlo simul simul allow mani materi properti calcul direct comparison experi includ diffus coeffici ionic conduct charg densiti electr field electrostat potenti diffus coeffici ionic conduct particular import studi batteri materi eg liion naion diffus llto llto_ solid oxid fuel cell materi eg oion diffus ceo mani applic solid state chemistri charg densiti electr field electrostat potenti interest problem relat interfac solid state chemistri eg space charg theori maier_berbunseng maier_jphyschemsol maier_solstation chiangetal_applphyslett kimandmaier_jelectrochemsoc final calcul distribut defect materi use studi segreg behaviour uo ceo adsorpt behaviournora molecular dynam simul posit atom throughout time simul molecular dynam trajectori snapshot posit occupi atom simul function time exampl trajectori singl atom would show sequenti posit occupi atom throughout simul mont carlo simul posit atom updat randomli provid statist ensembl describ materi mont carlo trajectori similar although simul time resolv atom posit simpli function simul step simul timestep posit atom allow particl densiti atom determin electrostat potenti electr field charg densiti calcul mean squar displac perform molecular dynam trajectori diffus coeffici ionic conduct calcul diffus coeffici ionic conduct use estim activ energi diffus use arrheniu relationship polypi code design solv follow problem read dl_poli smith dl_mont purton trajectori calcul particl densiti speci trajectori one two dimens calcul charg densiti one two dimens calcul electr field electrostat potenti one dimens calcul mean squar displac given atom use calcul diffus coeffici ionic conduct calcul volum function simul timestep gener public readi figur polypi use studi liion diffus lithium lanthanum titan llto llto_ oxygen diffus cation migrat uranium oxid cerium oxid uo ceo thu clear research applic figur mean squar displac fluorin diffus calcium fluorid msd plot one two three dimens b evolut system volum molecular dynam simul c particl densiti cerium blue oxygen orang atom grain boundari cerium oxid electrostat potenti cerium oxid grain boundari e center mass cerium blue oxygen orang atom two dimens grain boundari cerium oxidefig_png polypi polypi python modul analys molecular dynam mont carlo trajectori gener dl_poli smith dl_mont purton code code read dl_poli histori config file dl_mont archiv file store data polypyreadtrajectori object use variou data analysi modul polypydensitydens modul gener three dimension grid count number time given atom spend grid point simul use gener particl densiti given atom one two dimens charg densiti one two dimens electr field one dimens electrostat potenti one dimens calcul use polypyanalysi modul polypymsd modul perform mean squar displac calcul mean squar displac three two one dimension diffus coeffici ionic coeffici calcul modul allow easi gener public plot calcul data avail output return sensibl form allow manipul plot repositori contain exampl core function well tutori implement jupyt notebook explain full theori furthermor detail descript theori also avail within document polypi aim toward theoret solid state physicist chemist basic familiar python although exampl contain repositori design help less experienc user make use code statement need number code design analys molecular dynam trajectori current exist mdanalysi chemfil dlanalys dl_analys dlanalys avail licens analysi dl_poli simul chemfil chemfil avail analysi wide rang file type mdanalysi mdanalysi wide use molecular dynam analysi code function polypi alreadi present mdanalysi mdanalysisanalysislineardens modul calcul charg densiti differ dimens although accord document limit orthoromb fix volum cell polypi design work sever simul ensembl includ npt nvt semi grand grand canon furthermor calcul electr field electrostat potenti uniqu polypi mdanalysi polypi capabl calcul mean squar displac polypi goe step allow calcul diffus coeffici conduct within localis region structur eg grain boundari uo ceo local structur environ llto polypi also uniqu sens design analysi molecular dynam mont carlo trajectori summari featur uniqu polypi follow analysi molecular dynam mont carlo trajectori calcul electr field electrostat potenti region mean squar displac acknowledg packag written phd project fund awe epsrc epr polypi softwar packag develop analys data gener use balena hpc facil univers bath archer uk nation supercomput servic httpwwwarcheracuk via membership uk hec materi chemistri consortium fund epsrc epl author would like thank andrew r mccluskey benjamin morgan marco molinari jame grant stephen c parker help guidanc phd project refer atom densiti densiti analysi understand posit atom materi incred use studi thing like atom structur defect segreg consid system interfac may interest know distribut materi atom chang interfac eg increas decreas amount certain speci interfac inform segreg behaviour modul polypi allow posit atom simul evalu one two dimens convert charg densiti one dimens electr field electrostat potenti code ipython polypyread import histori polypyread import archiv polypydens import densiti polypi import analysi polypi import util ut polypi import plot import numpi np import matplotlibpyplot plt import warn warningsfilterwarningsignor tutori use polypi analys molecular dynam simul grain boundari fluorit cerium oxid mont carlo simul al li li vacanc swap lithium lanthanum titan exampl cerium oxid grain boundari exampl use polypi analys molecular dynam simul grain boundari cerium oxid first step read data want data speci need provid list speci ce note exampl xlim specifi highlight grain boundari feel free remov axset_xlim see whole plot code ipython histori historyexample_datahistory_gb ce printnpaminhistorytrajectorycartesian_trajectori printnpamaxhistorytrajectoryfractional_trajectori parsedliter next step creat densiti object speci exampl creat seper object cerium oxygen atom analys posit resolut angstrom code ipython ce_dens densityhistorytrajectori atomc histogram_s o_dens densityhistorytrajectori atomo histogram_s subsequ analysi perform two object one dimens particl densiti one_dimensional_dens function take direct correspond dimens simul cell exampl x correspond first lattic vector code calcul total number speci angstrom histogram along first cell dimens function return posit histogram total number speci plot one_dimensional_density_plot function take list histogram valu list particl densiti list label code ipython cx cy c_volum ce_densityone_dimensional_densitydirectionz ox oy o_volum o_densityone_dimensional_densitydirectionz ax plottingone_dimensional_density_plotcx ox cy oy ce axset_xlim pltshow imag figuresoutput__png charg densiti particl densiti combin atom charg gener one dimension charg densiti accord math rho_qz sum_i q_i rho_iz mathrho_i particl densiti atom mathq_i charg onedimensionalchargedens class use charg densiti electr field electrostat potenti requir list particl densiti list charg histogram volum total number timestep code ipython charg analysisonedimensionalchargedensityox oy cy c_volum historytrajectorytimestep dx charge_dens chargecalculate_charge_dens ax plottingone_dimensional_charge_density_plotdx charge_dens axset_xlim pltshow imag figuresoutput__png electr field electrostat potenti charg densiti convert electr field electrostat potenti math ez frac epsilon_ int_z_z rho_qzdz math delta_psiz int_z_z ezdz mathrho_i charg densiti mathepsilon_ permitt free space calculate_electric_field calculate_electrostatic_potenti function return electr field electrostat potenti code ipython dx electric_field chargecalculate_electric_field ax plottingelectric_field_plotdx electric_field axset_xlim pltshow imag figuresoutput__png code ipython dx electrostatic_potenti chargecalculate_electrostatic_potenti ax plottingelectrostatic_potential_plotdx electrostatic_potenti axset_xlim pltshow imag figuresoutput__png two dimens particl densiti particl densiti evalu two dimens two_dimensional_dens function calcul total number speci histogram coordin x box return grid speci count return exampl colorbar turn use grey palett data plot log scale code ipython cx_d cy_d cz_d c_volum ce_densitytwo_dimensional_densitydirectionx ox_d oy_d oz_d o_volum o_densitytwo_dimensional_densitydirectionx fig ax plottingtwo_dimensional_density_plotcx_d cy_d cz_d colorbarfals palettegrey logtru axset_xlim axaxisoff pltshow fig ax plottingtwo_dimensional_density_plotox_d oy_d oz_d colorbarfals palettegrey logtru axset_xlim axaxisoff pltshow imag figuresoutput__png imag figuresoutput__png charg densiti fashion one dimension case charg densiti evalu two dimens use two_dimensional_charge_dens function function requir two dimension array atom posit atom charg volum grid point total number timestep simul code ipython charge_dens analysistwo_dimensional_charge_densityoz_d cz_d o_volum historytrajectorytimestep fig ax plottingtwo_dimensional_charge_density_plotox_d oy_d charge_dens palettebwr axset_xlim pltshow imag figuresoutput__png one two dimens contour plot give good understand averag posit atom locat lattic site howev give good represent mani speci actual combined_density_plot function evalu particl densiti one two dimens overlay two singl plot allow lattic site total densiti view exampl use orang palett orang line color cerium atom blue palett blue line oxygen posit data plot log scale code ipython fig ax plottingcombined_density_plotcx_d cy_d cz_d paletteorang linecolororang logtru axe ax axesset_xlim pltshow fig ax plottingcombined_density_plotox_d oy_d oz_d paletteblu linecolorblu logtru axe ax axesset_xlim pltshow imag figuresoutput__png imag figuresoutput__png put togeth final polypyplot function gener singl contour plot speci function requir list x axe list axe list two dimension array correspond x axe list color palett code ipython fig ax plottingtwo_dimensional_density_plot_multiple_speciescx_d ox_d cy_d oy_d cz_d oz_d blue orang logtru axset_xlim pltshow imag figuresoutput__png analys thing like electrostat potenti use abl view electrostat potenti chang structur easi use polypyplot function conjunct matplotlib visualis relationship code ipython fig ax plottingtwo_dimensional_density_plot_multiple_speciescx_d ox_d cy_d oy_d cz_d oz_d blue orang logtru axset_xlim ax axtwinx axplotdx electrostatic_potenti colorgreen axset_ylabelelectrostat potenti v pltshow imag figuresoutput__png final polypyplot gener contour plot show number densiti one two dimens singl plot function requir list x axe list axe list two dimension array correspond x axe list color palett list label list line color code ipython fig ax plottingcombined_density_plot_multiple_speciesx_listcx_d ox_d y_listcy_d oy_d z_listcz_d oz_d palette_listblu orang label_listc color_listblu orang logtru axe ax axesset_xlim pltshow imag figuresoutput__png exampl li al li vacanc swap exampl analys mont carlo simul al dope lithium lanthanum titan possibl use molecular dynam simul studi defect segreg defect rel high diffus coeffici one could randomli dope configur run long molecular dynam simul analys evolut defect locat diffus coeffici defect low possibl use molecular dynam simul studi defect segreg would need huge md simul order record enough statist mont carlo simul allow perform unphys move comparit small mont carlo simul gener enough statist reliabl studi thing like defect segreg exampl analys mc simul al llzo mathal dope mathli site charg compens li vacanc ad ultim want calcul al dope effect li conduct howev without repres distribut allili vacanc cant calcul repres conduct ns md distribut al unchang mont carlo simul swap move need shake distribut follow swap move use al li al mathv_li li mathv_li archive_llzo short mc trajectori analys first extract plot configur first timestep plot posit across whole simul see distribut chang code ipython archiv archiveexample_dataarchive_llzo li al lv config_ archivetrajectoryget_config timestep code ipython li_dens densityconfig_ atomli histogram_s al_dens densityconfig_ atom histogram_s lv_densiti densityconfig_ atomlv histogram_s code ipython lix liy li_volum li_densityone_dimensional_densitydirectioni alx ali al_volum al_densityone_dimensional_densitydirectioni lvx lvi lv_volum lv_densityone_dimensional_densitydirectioni ax plottingone_dimensional_density_plotlix lvx alx liy lvi ali li v_li al pltshow imag figuresoutput__png full simul disclaim short snapshot simul fulli equilibri howev provid exampl polypi functionailti interestingli find al li mathv_li tend distribut even pattern within structur sharp contrast distribut start simul code ipython li_dens densityarchivetrajectori atomli histogram_s al_dens densityarchivetrajectori atom histogram_s lv_densiti densityarchivetrajectori atomlv histogram_s code ipython lix liy li_volum li_densityone_dimensional_densitydirectioni alx ali al_volum al_densityone_dimensional_densitydirectioni lvx lvi lv_volum lv_densityone_dimensional_densitydirectioni ax plottingone_dimensional_density_plotlix lvx alx liy lvi ali li v_li al pltshow imag figuresoutput__png code ipython lix_d liy_d liz_d li_volum li_densitytwo_dimensional_densitydirectionz alx_d aly_d alz_d al_volum al_densitytwo_dimensional_densitydirectionz lvx_d lvy_d lvz_d lv_volum lv_densitytwo_dimensional_densitydirectionz code ipython fig ax plottingtwo_dimensional_density_plot_multiple_speciesalx_d lvx_d aly_d lvy_d alz_d lvz_d blue orang logtru figsiz pltshow imag figuresoutput__png code ipython fig ax plottingcombined_density_plot_multiple_speciesx_listlix_d alx_d lvx_d y_listliy_d aly_d lvy_d z_listliz_d alz_d lvz_d palette_listgreen blue orang label_listli al v_li color_listgreen blue orang logtru figsiz pltshow imag figuresoutput__png polypymsd automodul polypymsd member undocmemb showinheritancetutori read data histori archiv config class expect two thing filenam histori file list atom read return polypyreadtrajectori object store atom label trajectoryatom_list datatyp trajectorydatatyp cartesian coordin trajectorycartesian_coordin fractiona coordin trajectoryfractional_coordin reciproc lattic vector trajectoryreciprocal_lv lattic vector trajectorylv cell length trajectorycell_length total atom file trajectoryatoms_in_histori timestep trajectorytimestep total atom per timestep trajectorytotal_atom histori file code ipython polypi import read rd code ipython histori rdhistoryexample_datahistory_caf ca f code ipython printhistorytrajectoryfractional_trajectori parsedliter code ipython printhistorytrajectorytimestep parsedliter code ipython printhistorytrajectoryatoms_in_histori parsedliter code ipython printhistorytrajectorytotal_atom parsedliter often necessari remov equilibri timestep simul accomlish remove_initial_timestep method remov timestep start simul remove_final_timestep remov timestep end simul code ipython new_histori historytrajectoryremove_initial_timestep printnew_historytimestep parsedliter code ipython new_histori new_historyremove_final_timestep printnew_historytimestep parsedliter possibl return trajectori singl timestep within histori file return trajectori singl atom code ipython config_ca historytrajectoryget_atomca printconfig_cafractional_trajectori parsedliter code ipython config_ historytrajectoryget_config printconfig_fractional_trajectori parsedliter config file code ipython config rdconfigexample_dataconfig ca f code ipython printconfigtrajectoryfractional_trajectori parsedliter dlmont code ipython archiv rdarchiveexample_dataarchive_short al code ipython printarchivetrajectorytimestep parsedliter theori polypi python modul analys dlpoli dlmont trajectori file use code need gener relev data polypi aim solid state commun wide rang applic charg densiti use densiti modul calcul number densiti atom math rho_qz sum_i q_i rho_iz mathrho_i densiti atom mathq_i charg electr field electrostat potenti charg densiti convert electr field electrostat potenti electr field calcul accord math ez frac epsilon_ int_z_z rho_qzdz mathepsilon_ permitt vacuum mathrho_q charg densiti electrostat potenti calcul accord math delta_psiz int_z_z ezdz mean squar displac molecul liqud gase solid stay place move constantli think drop dye glass water time pass dye distribut throughout water process call diffus common throughout natur incred relev properti materi scientist work thing like batteri use dye exampl motion dye molecul simpl move jostl collis molecul prevent move straight path path examin close detail seen good approxim random walk mathmat random walk seri step taken random direct analys albert einstein studi brownian motion show mean squar distanc travel particl follow random walk proport time elaps math big langl r_i big rangl d_t c math big langl r_i big rangl frac big r_it r_i big mathbig langl r big rangl mean squar distanc time mathd_t diffus rate c constant mathbig langl r_i big rangl plot function time gradient curv obtain equal time selfdiffus coeffici particl mean squar displac go back exampl dye water let assum sake simplic one dimens step either forward backward predict given start posit distanc dye molecul like travel step determin simpli ad togeth step take account fact step backward subtract total step forward add total sinc forward backward step equal probabl come surpris conclus probabl distanc travel sum zero ad squar distanc alway ad posit number total increas linearli time base upon equat clear plot mathbig langl r_i big rangl vs time produc line gradient equal give us direct access diffus coeffici system state matter effect shape msd plot solid littl diffus occur flat msd profil liquid howev particl diffus randomli gradient curv proport diffus coeffici imag figuresstates_of_matterpng height px align center follow exampl fluorin diffus mathcaf_ imag figuresmsd_png align center ionic conduct use diffus coeffici number particl charg carrier abil calcul volum convert data ionic conduct resist math sigma fracd c_f ek_b hr mathsigma ionic conduct diffus coefficientmathc_f concentr charg carrier case f ion math charg diffus speci mathk_b boltzmann constant temperatur hr ratio resist calcul accord math omega fracsigma arrheniu possibl calcul diffus coeffici larg temperatur rang use arrheniu equat calcul activ energi diffus common sens chemic intuit suggest higher temperatur faster given chemic reaction proceed quantit relationship rate reaction proce temperatur determin arrheniu equat higher temperatur probabl two molecul collid higher higher collis rate result higher kinet energi effect activ energi reaction activ energi amount energi requir ensur reaction happen math k eea rt k rate coeffici constant ea activ energi r univers ga constant temperatur kelvinpolypyutil automodul polypyutil member undocmemb showinherit polypydens automodul polypydens member undocmemb showinheritancemean squar displac msd mean squar displac msd molecul liqud gase solid stay place move constantli think drop dye glass water time pass dye distribut throughout water process call diffus common throughout natur incred relev properti materi scientist work thing like batteri use dye exampl motion dye molecul simpl move jostl collis molecul prevent move straight path path examin close detail seen good approxim random walk mathmat random walk seri step taken random direct analys albert einstein studi brownian motion show mean squar distanc travel particl follow random walk proport time elaps math big langl r_i big rangl d_t c math big langl r_i big rangl frac big r_it r_i big mathbig langl r big rangl mean squar distanc time mathd_t diffus rate c constant mathbig langl r_i big rangl plot function time gradient curv obtain equal time selfdiffus coeffici particl state matter effect shape msd plot solid littl diffus occur flat msd profil liquid howev particl diffus randomli gradient curv proport diffus coeffici mean squar displac go back exampl dye water let assum sake simplic one dimens step either forward backward predict given start posit distanc dye molecul like travel step determin simpli ad togeth step take account fact step backward subtract total step forward add total sinc forward backward step equal probabl come surpris conclus probabl distanc travel sum zero ad squar distanc alway ad posit number total increas linearli time base upon equat clear plot mathbig langl r_i big rangl vs time produc line gradient equal give us direct access diffus coeffici system code ipython polypi import read rd polypymsd import msd polypymsd import regionalmsd polypi import analysi polypi import util ut polypi import plot import numpi np import matplotlibpyplot plt exampl use short step preprepar trajectori bulk mathcaf_ realiti probabl want consider longer simul step simul gener huge file gb analysi would take long tutori first step read histori file gener data histori class expect two thing filenam histori file list atom read return polypyreadtrajectori object store atom label trajectoryatom_label datatyp trajectorydata_typ cartesian coordin trajectorycartesian_coordin fractiona coordin trajectoryfractional_coordin reciproc lattic vector trajectoryreciprocal_lv lattic vector trajectorylv cell length trajectorycell_length total atom file trajectoryatoms_in_histori timestep trajectorytimestep total atom per timestep trajectorytotal_atom code ipython history_caf rdhistoryexample_datahistory_caf f data read code msd calcul perform use msd class code return polypymsdmsdcontain object contain msd inform code ipython f_msd msdhistory_caftrajectori sweep output f_msdmsd code ipython ax plottingmsd_plotoutput pltshow imag figuresoutput__png msd calcul requir larg number statist consid repres full msd use everi singl frame trajectori start point effect seper msd start point averag give final result msd technic ensembl averag sweep number particl sweep paramt use control number frame use start point calcul simul lot diffus event smaller number suffici wherea simul small number diffus event requir larger number code ipython f_msd msdhistory_caftrajectori sweep output f_msdmsd ax plottingmsd_plotoutput pltshow imag figuresoutput__png code ipython printthre dimension diffus coeffici outputxyz_diffusion_coeffici printon dimension diffus coeffici x outputx_diffusion_coeffici printon dimension diffus coeffici outputy_diffusion_coeffici printon dimension diffus coeffici z outputz_diffusion_coeffici parsedliter three dimension diffus coeffici one dimension diffus coeffici x one dimension diffus coeffici one dimension diffus coeffici z note msd suppos linear ballist regim usual lack statist longer time thu linear fit extract slope thu diffus coeffici done portion msd accomplish use exclude_initi exclude_fin paramet code ipython printthre dimension diffus coeffici outputxyz_diffusion_coefficientexclude_initi exclude_fin printon dimension diffus coeffici x outputx_diffusion_coefficientexclude_initi exclude_fin printon dimension diffus coeffici outputy_diffusion_coefficientexclude_initi exclude_fin printon dimension diffus coeffici z outputz_diffusion_coefficientexclude_initi exclude_fin parsedliter three dimension diffus coeffici one dimension diffus coeffici x one dimension diffus coeffici one dimension diffus coeffici z arrheniu possibl take diffus coeffici calcul larg temperatur rang use arrheniu equat calcul activ energi diffus common sens chemic intuit suggest higher temperatur faster given chemic reaction proceed quantit relationship rate reaction proce temperatur determin arrheniu equat higher temperatur probabl two molecul collid higher higher collis rate result higher kinet energi effect activ energi reaction activ energi amount energi requir ensur reaction happen math k eea rt k rate coeffici constant ea activ energi r univers ga constant temperatur kelvin ionic conduct use diffus coeffici number particl charg carrier abil calcul volum convert data ionic conduct resist math sigma fracd c_f ek_b mathsigma ionic conduct diffus coeffici mathc_f concentr charg carrier case f ion math charg diffus speci mathk_b boltzmann constant temperatur resit calcul accord math omega fracsigma first step calcul volum system voum modul given data code ipython volum step analysissystem_volumehistory_caftrajectori average_volum npmeanvolum number charg carrier total number atom code ipython sigma analysisconductivityhistory_caftrajectorytotal_atom average_volum outputxyz_diffusion_coeffici code ipython printion conduct sigma parsedliter ionic conduct code ipython printresist sigma parsedliter resist simul length import consid lenght simul number step exampl use short trajectori suffici temperatur enough diffus event get good msd plot follow exampl short simul hope note msd plot clearli converg code ipython history_short rdhistoryexample_datahistory_short atom_listf code ipython f_msd_short msdhistory_shorttrajectori sweep output f_msd_shortmsd code ipython ax plottingmsd_plotoutput pltshow imag figuresoutput__png code ipython printthre dimension diffus coeffici outputxyz_diffusion_coeffici printon dimension diffus coeffici x outputx_diffusion_coeffici printon dimension diffus coeffici outputy_diffusion_coeffici printon dimension diffus coeffici z outputz_diffusion_coeffici parsedliter three dimension diffus coeffici one dimension diffus coeffici x one dimension diffus coeffici one dimension diffus coeffici z amusingli actual seem huge effect diffus coeffici compar longer simul howev trajectori caf math_ simul k thu larg number diffus event short time frame state matter possibl identifi phase matter msd plot raw html center figur anticip msd form state matter raw html center fluorin diffus discuss alreadi clearli show fluorin sub lattic melt diffus liquid like wherea carri analysi calcium sub lattic show fluorin sub lattic melt calcium sub lattic still behav like solid code ipython f_msd msdhistory_caftrajectori sweep output f_msdmsd ax plottingmsd_plotoutput pltshow imag figuresoutput__png region msd calcul often solid state chemistri simul involv defect structur eg grain boundari disloc surfac chemic eg point defect import tri isol contribut defect overal properti regard diffus could imagin certain region within structur differ properti compar stoichiometr bulk eg grain boundari vs grain surfac vs bulk polypi capabl isol trajectori pass within certain region structur thu calcul diffus coeffici region exampl calcul diffus coeffici box dimens first lattic vector code ipython f_msd regionalmsdhistory_caftrajectori dimensionx output f_msdanalyse_trajectori code ipython ax plottingmsd_plotoutput pltshow imag figuresoutput_png code ipython printthre dimension diffus coeffici outputxyz_diffusion_coeffici printon dimension diffus coeffici x outputx_diffusion_coeffici printon dimension diffus coeffici outputy_diffusion_coeffici printon dimension diffus coeffici z outputz_diffusion_coeffici parsedliter three dimension diffus coeffici one dimension diffus coeffici x one dimension diffus coeffici one dimension diffus coeffici z dlmont code ipython archiv rdarchiveexample_dataarchive_llzo atom_listo code ipython f_msd msdarchivetrajectori sweep valueerror traceback recent call last ipythoninputefda modul f_msd msdarchivetrajectori sweep optanacondalibpythonsitepackagespolypypyeggpolypymsdpi __init__self data sweep rais valueerrorerror msd handl one atom type exit datadata_typ dl_mont archiv rais valueerrordlmont simul time resolv selfdist selfmsd_inform msdcontain valueerror dlmont simul time resolv tutori tutori replic jupyt notebook form contain within exampl exampl found examplesnotebook httpsgithubcomsymmypolypytreemasterexamplesnotebooks_ tutori use fluorit mathceo_ grain boundari exampl due larg size dl_poli dl_mont trajectori file tutori notebook contain within git repositori use short mathcaf_ trajectori toctre maxdepth reading_datarst volumerst density_tutorialrst msd_tutorialrst mean squar displac msd molecul liqud gase solid stay place move constantli think drop dye glass water time pass dye distribut throughout water process call diffus common throughout natur incred relev properti materi scientist work thing like batteri use dye exampl motion dye molecul simpl move jostl collis molecul prevent move straight path path examin close detail seen good approxim random walk mathmat random walk seri step taken random direct analys albert einstein studi brownian motion show mean squar distanc travel particl follow random walk proport time elaps math big langl r_i big rangl d_t c math big langl r_i big rangl frac big r_it r_i big mathbig langl r big rangl mean squar distanc time mathd_t diffus rate c constant mathbig langl r_i big rangl plot function time gradient curv obtain equal time selfdiffus coeffici particl state matter effect shape msd plot solid littl diffus occur flat msd profil liquid howev particl diffus randomli gradient curv proport diffus coeffici mean squar displac go back exampl dye water let assum sake simplic one dimens step either forward backward predict given start posit distanc dye molecul like travel step determin simpli ad togeth step take account fact step backward subtract total step forward add total sinc forward backward step equal probabl come surpris conclus probabl distanc travel sum zero ad squar distanc alway ad posit number total increas linearli time base upon equat clear plot mathbig langl r_i big rangl vs time produc line gradient equal give us direct access diffus coeffici system usag codeblock python polypi import read rd polypymsd import msd polypymsd import regionalmsd polypi import analysi polypi import util ut polypi import plot import numpi np import matplotlibpyplot plt exampl use short step preprepar trajectori bulk caf_ realiti probabl want consider longer simul step simul gener huge file gb analysi would take long tutori first step read histori file gener data histori class expect two thing filenam histori file list atom read return polypyreadtrajectori object store atom label trajectoryatom_label datatyp trajectorydata_typ cartesian coordin trajectorycartesian_coordin fractiona coordin trajectoryfractional_coordin reciproc lattic vector trajectoryreciprocal_lv lattic vector trajectorylv cell length trajectorycell_length total atom file trajectoryatoms_in_histori timestep trajectorytimestep total atom per timestep trajectorytotal_atom codeblock python histori rdhistoryexample_datahistori f data read code msd calcul perform codeblock python f_msd msdhistorytrajectori sweep output f_msdmsd ax plottingmsd_plotoutput pltshow imag figuresmsd_png align center codeblock python f_msd msdhistorytrajectori sweep output f_msdmsd ax plottingmsd_plotoutput pltshow imag figuresmsd_png align center use data diffus coeffici calcul slope codeblock python printthre dimension diffus coeffici outputxyz_diffusion_coeffici printon dimension diffus coeffici x outputx_diffusion_coeffici printon dimension diffus coeffici outputy_diffusion_coeffici printon dimension diffus coeffici z outputz_diffusion_coeffici three dimension diffus coeffici one dimension diffus coeffici x one dimension diffus coeffici one dimension diffus coeffici z arrheniu possibl take diffus coeffici calcul larg temperatur rang use arrheniu equat calcul activ energi diffus common sens chemic intuit suggest higher temperatur faster given chemic reaction proceed quantit relationship rate reaction proce temperatur determin arrheniu equat higher temperatur probabl two molecul collid higher higher collis rate result higher kinet energi effect activ energi reaction activ energi amount energi requir ensur reaction happen math k eea rt k rate coeffici constant ea activ energi r univers ga constant temperatur kelvin ionic conduct use diffus coeffici number particl charg carrier abil calcul volum convert data ionic conduct resist math sigma fracd c_f ek_b mathsigma ionic conduct diffus coeffici mathc_f concentr charg carrier case f ion math charg diffus speci mathk_b boltzmann constant temperatur resit calcul accord math omega fracsigma first step calcul volum system volum modul given data codeblock python volum step analysissystem_volumehistorytrajectori average_volum npmeanvolum number charg carrier total number atom codeblock python sigma analysisconductivityhistorytrajectorytotal_atom average_volum outputxyz_diffusion_coeffici printion conduct sigma ionic conduct codeblock python printresist sigma resist simul length import consid lenght simul number step exampl use short trajectori suffici temperatur enough diffus event get good msd plot follow exampl short simul hope note msd plot clearli converg codeblock python data_short rdhistoryexample_datahistory_short atom_listf f_msd_short msddata_shorttrajectori sweep output f_msd_shortmsd ax plottingmsd_plotoutput pltshow imag figuresmsd_png align center codeblock python printthre dimension diffus coeffici outputxyz_diffusion_coeffici printon dimension diffus coeffici x outputx_diffusion_coeffici printon dimension diffus coeffici outputy_diffusion_coeffici printon dimension diffus coeffici z outputz_diffusion_coeffici three dimension diffus coeffici one dimension diffus coeffici x one dimension diffus coeffici one dimension diffus coeffici z state matter possibl identifi phase matter msd plot imag figuresstates_of_matterpng height px align center fluorin diffus discuss alreadi clearli show fluorin sub lattic melt diffus liquid like wherea carri analysi calcium sub lattic show fluorin sub lattic melt calcium sub lattic still behav like solid codeblock python histori rdhistoryexample_datahistori ca f_msd msdhistorytrajectori sweep output f_msdmsd ax plottingmsd_plotoutput pltshow imag figuresmsd_png align center region msd often solid state chemistri simul involv defect structur eg grain boundari disloc surfac chemic eg point defect import tri isol contribut defect overal properti regard diffus could imagin certain region within structur differ properti compar stoichiometr bulk eg grain boundari vs grain surfac vs bulk polypi capabl isol trajectori pass within certain region structur thu calcul diffus coeffici region codeblock python histori rdhistoryexample_datahistori atom_listf f_msd regionalmsdhistorytrajectori output f_msdanalyse_trajectori ax plottingmsd_plotoutput pltshow imag figuresmsd_png align center codeblock python printthre dimension diffus coeffici outputxyz_diffusion_coeffici printon dimension diffus coeffici x outputx_diffusion_coeffici printon dimension diffus coeffici outputy_diffusion_coeffici printon dimension diffus coeffici z outputz_diffusion_coeffici three dimension diffus coeffici one dimension diffus coeffici x one dimension diffus coeffici one dimension diffus coeffici z atom densiti understand posit atom materi incred use studi thing like atom structur defect segreg consid system interfac may interest know distribut materi atom chang interfac eg increas decreas amount certain speci interfac inform segreg behaviour modul polypi allow posit atom simul evalu one two dimens convert charg densiti one dimens electr field electrostat potenti codeblock python polypyread import histori polypyread import archiv polypydens import densiti polypi import analysi polypi import util ut polypi import plot import numpi np import matplotlibpyplot plt tutori use polypi analys molecular dynam simul grain boundari fluorit cerium oxid mont carlo simul al li li vacanc swap lithium lanthanum titan exampl cerium oxid grain boundari exampl use pyattrpolypi analys molecular dynam simul grain boundari cerium oxid first step read data want data speci need provid list speci ce note exampl xlim specifi highlight grain boundari feel free remov axset_xlim see whole plot codeblock python histori historyhistory_gb ce next step creat densiti object speci exampl creat seper object cerium oxygen atom analys posit resolut angstrom codeblock python ca_dens densityhistorytrajectori atomc f_densiti densityhistorytrajectori atomo pyattronedimensionalchargedens class take direct correspond dimens simul cell exampl x correspond first lattic vector code calcul total number speci histogram along first cell dimens function return posit histogram total number speci clear plot pyattrone_dimensional_plot function take list histogram valu list valu list label codeblock python cx cy c_volum ce_densityone_dimensional_densitydirectionz ox oy o_volum o_densityone_dimensional_densitydirectionz ax plottingone_dimensional_density_plotox cx oy cy ce axset_xlim pltshow imag figuresdensity_gb_png align center charg densiti particl densiti combin atom charg gener one dimension charg densiti accord math rho_qz sum_i q_i rho_iz mathrho_i densiti atom mathq_i charg pyattronedimensionalchargedens class use charg densiti electr field electrostat potenti requir list particl densiti list charg histogram volum total number timestep codeblock python charg analysisonedimensionalchargedensityox oy cy c_volum historytrajectorytimestep dx charge_dens chargecalculate_charge_dens ax plottingone_dimensional_charge_density_plotdx charge_dens axset_xlim pltshow imag figuresdensity_gb_png align center electr field electrostat potenti charg densiti convert electr field mathez electrostat potenti mathdelta_psiz math ez frac epsilon_ int_z_z rho_qzdz math delta_psiz int_z_z ezdz mathrho_i charg densiti mathepsilon_ permitt free space pyattrcalculate_electric_field pyattrcalculate_electrostatic_potenti function take bin posit charg densiti return electr field electrostat potenti codeblock python dx electric_field chargecalculate_electric_field ax plottingelectric_field_plotdx electric_field axset_xlim pltshow imag figuresdensity_gb_png align center codeblock python dx electrostatic_potenti chargecalculate_electrostatic_potenti ax plottingelectrostatic_potential_plotdx electrostatic_potenti axset_xlim pltshow imag figuresdensity_gb_png align center two dimens particl densiti evalu two dimens pyattrtwo_dimensional_dens function calcul total number speci histogram coordin x box return grid speci count return exampl colorbar turn use grey palett data plot log scale codeblock python cx_d cy_d cz_d c_volum ce_densitytwo_dimensional_densitydirectionx ox_d oy_d oz_d o_volum o_densitytwo_dimensional_densitydirectionx fig ax plottingtwo_dimensional_density_plotcx_d cy_d cz_d pltshow imag figuresdensity_gb_png align center codeblock python fig ax plottingtwo_dimensional_density_plotox_d oy_d oz_d pltshow imag figuresdensity_gb_png align center charg densiti fashion one dimension case charg densiti evalu two dimens use pyattrtwo_dimensional_charge_dens function function requir two dimension array atom posit atom charg volum grid point total number timestep simul codeblock python charge_dens analysistwo_dimensional_charge_densityoz_d cz_d o_volum fig ax plottingtwo_dimensional_charge_density_plotox_d oy_d charge_dens pltshow imag figuresdensity_gb_png align center one two dimens contour plot give good understand averag posit atom locat lattic site howev give good represent mani speci actual pyattrcombined_density_plot function evalu particl densiti one two dimens overlay two singl plot allow lattic site total densiti view exampl use orang palett orang line color cerium atom blue palett blue line oxygen posit data plot log scale codeblock python fig ax plottingcombined_density_plotcx_d cy_d cz_d pltshow imag figuresdensity_gb_png align center codeblock python fig ax plottingcombined_density_plotfx_d fy_d fz_d pltshow imag figuresdensity_gb_png align center togeth final pyattrpolypyplot function gener singl contour plot speci function requir list x axe list axe list two dimension array correspond x axe list color palett codeblock python fig ax plottingtwo_dimensional_density_plot_multiple_speciescx_d ox_d cy_d oy_d cz_d oz_d blue orang logtru pltshow imag figuresdensity_gb_png align center analys thing like electrostat potenti use abl view electrostat potenti chang structur easi use pyattrpolypyplot function conjunct matplotlib visualis relationship codeblock python fig ax plottingtwo_dimensional_density_plot_multiple_speciescx_d ox_d cy_d oy_d cz_d oz_d blue orang logtru axset_xlim ax axtwinx axplotdx electrostatic_potenti colorgreen axset_ylabelelectrostat potenti v pltshow imag figuresdensity_gb_eppng align center final pyattrpolypyplot gener contour plot show number densiti one two dimens singl plot codeblock python fig ax plottingcombined_density_plot_multiple_speciescx_d ox_d cy_d oy_d cz_d oz_d blue orang logtru pltshow imag figuresdensity_gb_png align center exampl li al li vacanc swap exampl analys mont carlo simul al dope lithium lanthanum titan possibl use molecular dynam simul studi defect segreg defect rel high diffus coeffici one could randomli dope configur run long molecular dynam simul analys evolut defect locat diffus coeffici defect low possibl use molecular dynam simul studi defect segreg would need huge md simul order record enough statist mont carlo simul allow perform unphys move comparit small mont carlo simul gener enough statist reliabl studi thing like defect segreg exampl analys mc simul al llzo al dope li site charg compens li vacanc ad ultim want calcul al dope effect li conduct howev without repres distribut allili vacanc cant calcul repres conduct ns md distribut al unchang mont carlo simul swap move need shake distribut follow swap move use al li al v_li li v_li archive_llzo short mc trajectori analys first extract plot configur first timestep plot posit across whole simul see distribut chang codeblock python archiv archiveexample_dataarchive_llzo li al lv config_ archivetrajectoryget_config timestep codeblock python li_dens densityconfig_ atomli histogram_s al_dens densityconfig_ atom histogram_s lv_densiti densityconfig_ atomlv histogram_s lix liy li_volum li_densityone_dimensional_densitydirectioni alx ali al_volum al_densityone_dimensional_densitydirectioni lvx lvi lv_volum lv_densityone_dimensional_densitydirectioni ax plottingone_dimensional_density_plotlix lvx alx liy lvi ali li v_li al pltshow imag figuresdensity_png align center full simul disclaim short snapshot simul fulli equilibri howev provid exampl polypi functionailti interestingli find al li v_li tend distribut even pattern within structur sharp contrast distribut start simul codeblock python li_dens densityarchivetrajectori atomli histogram_s al_dens densityarchivetrajectori atom histogram_s lv_densiti densityarchivetrajectori atomlv histogram_s lix liy li_volum li_densityone_dimensional_densitydirectioni alx ali al_volum al_densityone_dimensional_densitydirectioni lvx lvi lv_volum lv_densityone_dimensional_densitydirectioni ax plottingone_dimensional_density_plotlix lvx alx liy lvi ali li v_li al pltshow imag figuresdensity_png align center codeblock python lix_d liy_d liz_d li_volum li_densitytwo_dimensional_densitydirectionz alx_d aly_d alz_d al_volum al_densitytwo_dimensional_densitydirectionz lvx_d lvy_d lvz_d lv_volum lv_densitytwo_dimensional_densitydirectionz fig ax plottingtwo_dimensional_density_plot_multiple_speciesalx_d lvx_d aly_d lvy_d alz_d lvz_d blue orang logtru figsiz pltshow imag figuresdensity_png align center codeblock python fig ax plottingcombined_density_plot_multiple_speciesx_listlix_d alx_d lvx_d y_listliy_d aly_d lvy_d z_listliz_d alz_d lvz_d palette_listgreen blue orang label_listli al v_li color_listgreen blue orang logtru figsiz pltshow imag figuresdensity_png align centerpolypyanalysi automodul polypyanalysi member undocmemb showinherit instal pymodpolypi instal pypi packag manag pymodpip codeblock bash pip instal polypi altern would like download instal latest develop build found github_ along specif instal instruct _github httpsgithubcomsymmypolypyvolum codeblock python polypi import analysi polypi import plot polypi import read rd import matplotlibpyplot plt histori rdhistoryexample_datahistory_caf ca volum step analysissystem_volumehistorytrajectori ax plottingvolume_plotstep volum pltshow imag figuresvolumepng align centerapi toctre maxdepth analysisrst densityrst msdrst plottingrst readrst utilsrst polypyread automodul polypyread member undocmemb showinherit use polypi number way get use polypi fork code pleas feel free fork code github httpsgithubcomsymmypolypy_ add function interest run local polypi avail pip packag manag get touch adam rsymington arsbathacuk alway keen chat potenti user includ readmerst toctre maxdepth installationrst theoryrst using_polypyrst tutorialsrst modul indic tabl refgenindex refmodindex refsearch polypyplot automodul polypyplot member undocmemb showinherit imag figurespolypy_png align center document opensourc python project polypi librari design facilit analysi dl_poli httpswwwscdstfcacukpagesdl_polyaspx_ dl_mont httpswwwccpacukdl_monte_ calcul polypi built exist python packag solid state physicschemistri commun alreadi familiar hope tool bring benfit solid state commun facilit data analysi gener public readi plot power matplotlib main featur includ method analys number denisti given speci one two dimens gener plot total number speci bin perpendicular specifi direct gener plot total number speci cuboid parallel specifi direct method calcul charg densiti number densiti convert number densiti speci bin perpendicular specifi direct charg densiti calcul electr field electrostat potenti charg densiti solv poisson boltzmann equat convert charg densiti electr field electrostat potenti calcul diffus coeffici given speci mean squar displac carri mean squar displac md trajectori calcul diffus coeffici use densiti analysi diffus coeffici calcul ionic conduct imag figuresshow_offpng align center code develop analys dl_poli dl_mont calcul howev code incorpor user demand polypi develop phd project function focus research question encount project clarifi wide rang code contribut aim expand code new problem encourag code develop analys dl_poli dl_mont calcul howev code incorpor user demand format pdb xyz convert dl_poli format code atomsk httpsatomskunivlillefr_ analys polypi user welcom increas file coverag ad read function differ format accomplish ad read modul class uniqu file type convert polypyreadtrajectori object polypi free use usag full list exampl found exampl folder git repositori includ python script jupyt notebook tutori combin full theori code exampl note howev dl_poli histori file dl_mont archiv file sizabl gb short exampl trajectori includ repositori notebook provid illustr theori practicl instal polypi python packag requir typic scientif python stack use tutori requir anacondajupyt instal build sourc codeblock bash pip instal r requirementstxt python setuppi build python setuppi instal altern instal pip codeblock bash pip instal polypi use conda codeblock bash conda skeleton pypi polypi conda build polypi conda instal useloc polypi test test run type python setuppi test root directori document build document scratch codeblock bash cd doc make html licens polypi made avail mit licens detail requir polypi compat python reli number open sourc python packag specif numpi scipi matplotlib contribut contact question regard aspect softwar pleas get touch develop adam symington via email arsbathacuk altern creat issu issu tracker httpsgithubcomsymmypolypyissues_ bug may bug think youv caught one pleas report issu tracker httpsgithubcomsymmypolypyissues_ also place propos new idea featur ask question design polypi poor document consid bug feel free request improv code contribut welcom help improv extend packag manag github pull request extern contribut prefer fork pull httpsguidesgithubcomactivitiesforking__ workflow core develop use branch main repositori first open issu discuss propos contribut discuss might includ chang fit surfinpi scope gener technic approach make project fork implement chang pleas keep code style compliant pep open pull request merg chang main project detail discuss take place chang accept inform pleas contact adam symington arsbathacuk futur list seri use addit would like make codebas user encourag fork repositori work problem inde function list welcom add rdf diagon slice region msd cube acknowledg packag written phd project fund awe epsrc epr polypi softwar packag develop analys data gener use balena hpc facil univers bath archer uk nation supercomput servic httpwwwarcheracuk via membership uk hec materi chemistri consortium fund epsrc eplth author would like thank andrew r mccluskey benjamin morgan marco molinari jame grant stephen c parker help guidanc phd project api