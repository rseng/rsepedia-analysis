p aligncent img width srcmkdocsdocsfigslogo_nap_png p doihttpszenodoorgbadgesvghttpszenodoorgbadgelatestdoi news nap select github archiv program store magnet tape arctic vaulthttpsarchiveprogramgithubcom what nap nagoya atomisticsimul packag nap includ follow program util parallel molecular dynam simul pmd potenti paramet fit fitpot neuralnetwork potenti fppi classic potenti python modul prepostprocess nappi program pmd includ variou interatom potenti metal semiconductor use spatial decomposit techniqu parallel linkedcel method effici neighbor search made ryo kobayashihttpryokbyswebnitechacjpindexhtml assist professor depart mechan engin nagoya institut technolog requir depend compil pmd fitpot follow programslibrari requir fortran compil mpi librari nappi fppi requir follow packag numpi scipi panda docopt ase compil usag short test whether use program environ bash git clone httpsgithubcomryokbysnapgit cd nap configur prefixpwd make test work use program system instal python packag nappi shell python setuppi sdist pip instal e use nappi command napsi napopt termin import nappi packag python program detail pleas see documentationhttpryokbyswebnitechacjpcontentsnap_doc ask via email kobayashiryoatnitechacjp acknowledg program support part materi research inform integr initi miihttpwwwnimsgojpmiii project support program start innov hub japan scienc technolog agenc jst licens softwar releas mit licens see licens titl nap molecular dynam packag parameteroptim program classic machinelearn potenti tag fortran python materi scienc molecular dynam interatom potenti neuralnetwork potenti metaheurist author name ryo kobayashi orcid affili affili name depart physic scienc engin nagoya institut technolog gokiso showa nagoya japan index date august bibliographi paperbib summari nap packag molecular dynam md simul consist md program pmd perform largescal simul use spatialdecomposit techniqu two parameteroptim program one classic cl potenti fppi anoth machinelearn ml potenti fitpot sinc number paramet optim much differ cl ml potenti optim approach also differ metaheurist global minimumsearch algorithm cl potenti number paramet usual much less one hundr gradientbas method ml potenti paramet cl potenti optim target quantiti comput use potenti sinc metaheurist method requir deriv quantiti respect paramet hand mlpotenti paramet optim energi forc atom stress compon refer system mainli gradientbas method requir deriv quantiti respect paramet analyt deriv code usual pain sometim imposs potenti use combin potenti pair angular potenti shortrang longrang potenti cl ml potenti use nap packag user perform md simul solidst materi choic differ level complex cl ml creat interatom potenti optim quantummechan calcul data even potenti avail statement need md simul wide use mani research field materi scienc chemistri physic etc studi dynam atom molecul order perform md simul system includ larg number atom quantummechan calcul use due comput cost empir interatom potenti speci requir result md simul strongli depend properti accuraci potenti use simul henc lot cl potenti model propos lennardjon lj potenti van der waal interact coulomb potenti ionic interact mors potenti coval interact morseow angulardepend model angl coval bond bondord model complex system etc recent ml potenti also activ studi usual flexibl reproduc refer data precis cl potenti even though potenti flexibl suitabl problem consid paramet potenti model still need optim well reproduc properti phenomena focu alreadi lot md program lammp plimptonaz imd stadlerwr use cl ml potenti also parameteroptim program produc paramet set avail md program aenet artrithmu ml potenti potfit brommerkr brommerhw cl potenti howev also demand combin ml potenti simpler cl potenti eg ml potenti coulomb interact morawietzqq ml potenti corecor repuls wangpi sinc creat ml potenti cover shortrang andor longrang interact ineffici thu benefici program parameteroptim cl ml potenti one packag highli connect one md program effici use sever differ program optim paramet cl ml potenti program function pmd fortran program perform md simul perform largescal md simul effici use linkedcel list allennw spatial decomposit mpi parallel sever widelyus interatom potenti solidst materi implement exampl pair potenti lj mors coulomb screen coulomb angulardepend potenti stillingerweb stillingergi tersoff tersoffbo multibodi potenti finnissinclair finnishv embededatom method dawhj machinelearn potenti linearregress sekomh neuralnetwork nn behlerhr fppi python program optim paramet classic potenti use metaheurist algorithm cuckoo search yangat metaheurist algorithm need perform md simul evalu quantiti compar target valu individu repres candid paramet set job individu perform child process program call shell script describ comput use given paramet program function automat updat search rang paramet allow optim paramet effici less depend initi rang paramet kobayashirz fitpot fortran program optim paramet ml potenti linear regress nn use gradientbas method kobayashiki use highperform comput resourc evalu energi forc stress huge number sampl system parallel use mpi librari sometim crucial sinc gener ml model requir lot sampl avoid overfit make robust acknowledg work support part jsp kakenhi grant number jph grantinaid scientif research innov area interfac ionic materi research inform integr initi mii project support program start innov hub jst refer napexamplespmd_w exampl show perform md simul bccw system use ito potenti file requir run md simul case pmdini inform simul cell posit atom inpmd inform md simul set perform md bash pathtopmd tee outpmd user check result look output outpmd compar outpmdref refer output user may compar look potenti confirm result ident bash grep potenti outpmd outpmd potenti energi ev evatom outpmd potenti energi ev evatom outpmdref potenti energi ev evatom outpmdref potenti energi ev evatom refer ito yoshimoto saito takayama h nakamura phi scripta napexamplefp_latp exampl show use fppi optim paramet interatom potenti lialtipo system potenti form screen coulomb mors angular target quantiti rdf adf equilibrium volum see ref detail file requir perform fppi infitpot inform fppi set invarsfitpot initi valu potenti paramet search rang paramet inparamscoulomb paramet file coulomb potenti datarefxxx target quantiti rdf adf volum subjobsh shellscript describ comput target quantiti current paramet inpmdnpt pmdini someth file need perform md simul describ subjobsh see commandlin option bash python pathtofppi h perform fppi use four thread bash pathtofppi nproc tee outfp sinc fppi use random valu gener trial paramet random valu would differ everi time execut output obtain ident outfpref ok tail outfp look like follow bash tail outfp iidloss iidloss steptimebestvar iidloss iidloss iidloss iidloss iidloss steptimebestvar elaps time sec use fppi better use process like case effici run program differ examplesfp_lzp exampl use whatev mode target quantiti like dfmatch mode examplesfp_lzp differ examplesfp_lzp includ format datarefxxx file match entri infitpot subjobsh script outfp option specifi case refer r kobayashi miyaji k nakano nakayama highthroughput product forcefield solidst electrolyt materi apl materi linkhttpsaipscitationorgdoi napexamplefp_lzp exampl show use fppi optim paramet interatom potenti lizrpo system potenti form screen coulomb mors angular target quantiti rdf adf equilibrium volum see ref detail file requir perform fppi infitpot inform fppi set invarsfitpot initi valu potenti paramet search rang paramet inparamscoulomb paramet file coulomb potenti datarefxxx target quantiti rdf adf volum subjobsh shellscript describ comput target quantiti current paramet inpmdnpt pmdini someth file need perform md simul describ subjobsh see commandlin option bash python pathtofppi h perform fppi use four thread bash pathtofppi nproc tee outfp sinc fppi use random valu gener trial paramet random valu would differ everi time execut output obtain ident outfpref ok tail outfp look like follow bash tail outfp iidlrlthlvolllatl iidlrlthlvolllatl steptimebestvar iidlrlthlvolllatl iidlrlthlvolllatl iidlrlthlvolllatl iidlrlthlvolllatl iidlrlthlvolllatl steptimebestvar elaps time sec use fppi better use process like case effici run program refer r kobayashi miyaji k nakano nakayama highthroughput product forcefield solidst electrolyt materi apl materi linkhttpsaipscitationorgdoi napexamplespmd_dnn_sio exampl show perform md simul sio system use neuralnetwork nn potenti file requir run md simul case pmdini inform simul cell posit atom inpmd inform md simul set inparamsdesc inparamsdnn inparamszbl paramet file nn potenti sio perform md bash pathtopmd tee outpmd user check result look output outpmd compar outpmdref refer output user may compar look potenti confirm result ident bash grep potenti outpmd outpmd potenti energi ev evatom outpmd potenti energi ev evatom outpmdref potenti energi ev evatom outpmdref potenti energi ev evatom also dump_ file contain snapshot configur atom user see movi simul use visual softwar ovitohttpswwwovitoorgabout napexamplefitpot_dnn_sio exampl show use fitpot optim paramet neuralnetwork potenti sio system see ref detail nn potenti file requir perform fitpot infitpot inform fitpot set inparamsdesc inform descriptor use input nn potenti inparamsdnn initi valu potenti paramet nn weight search rang paramet inparamszbl classic potenti ad nn potenti case zbl potenti datasetsmpl_xxx refer dataset perform fitpot use mpi process bash mpirun np pathtofitpot tee outfitpot tail output show like follow least fitpot program finish corectli without error bash tail outfitpot energi forc stress number func grad call memoryproc mb time func sec time grad sec time comm sec time sec hm job finish pleas see nap document detail use fitpot obtain nn potenti paramet refer behler jörg michel parrinello gener neuralnetwork represent highdimension potentialenergi surfac physic review letter kobayashi ryo daniel giofré till jung michel ceriotti william arthur curtin neural network potenti almgsi alloy physic review materi linkhttpsjournalsapsorgprmaterialsabstractphysrevmateri input file inpmd pmd start read set file inpmd atomconfigur file pmdini simul set except atom configur must describ inpmd exampl inpmd unit time femto sec unit length angstrom unit mass unifi atom mass unit io_format ascii print_level time_interv num_iter min_iter num_out_energi flag_out_po num_out_po force_typ mors coulomb cutoff_radiu cutoff_buff flag_damp damping_coeff converge_ep converge_num initial_temperatur final_temperatur temperature_control none temperature_target temperature_relax_tim factor_direct stress_control none stress_relax_tim stress_target pressure_target boundari ppp line begin treat comment line input paramet num_nodes_x default number divis x z direct one nonposit number automat estim system size number mpi process use posit specifi valu use product xyz number divid atomconfigur file comput node specifi execut mpirun mpiexec command io_format default ascii choos either ascii binari format atomconfigur file perform larg scale simul choos binari effici readingwrit atomconfigur file print_level default much inform written run normal inform md simul run debug info written time_interv default time interv unit femto second neg activ variabl timestep mode absolut valu maximum time interv delta t_max mode appropri rang dt_max would depend minimum mass ion system vardt_length_scal default specif length l variabl timestep mode time interv determin beginequ delta min left delta t_mathrmmax fraclv_mathrmmaxright endequ num_iter default altern num_step number md step simul time equal time_interv time num_iter min_iter default altern min_step minimum number md step case want md simul least min_iter set paramet num_out_energi default number output energi flag_out_po default altern flag_out_pmd flag whether write atom configur file certain step write write pmdformat atom configur file pmd_ indic sequenti number file write lammp dumpfomrat atom configur file dump_ num_out_po default altern num_out_pmd number atomconfigur file written flag_sort default flag whether sort order atom tag write atom configur pmd file might cost time larg scale simul sort sort force_typ default none choic interatom potenti avail potenti list lj lennardjon potenti ar system sw_si stillingerweb potenti si system edip_si environ depend interatom potenti si system ito_wh eam potenti whe system made ito et al nif mors mors potenti requir input file inparamsmors coulomb coulomb potenti requir input file inparamscoulomb dnn neuralnetwork potenti requir two input file inparamsdesc inparamsnn flag_damp default flag whether damp atom veloc damp simpl damp md use follow damping_coeff fire algorithm usual much faster stabler simpl damp md damping_coeff default damp coeffici converge_ep default converg criterion ev neg valu stop converg converge_num default converg achiev converg criterion suffic time success initial_temperatur default initi temperatur atom final_temperatur default final temperatur atom set target temperatur atom chang linearli initial_temperatur simul proce temperature_control default none temperaturecontrol method none berendsen langevin avail temperature_target default target temperatur k atom specifi ifmv exampl temperature_target indic set temperatur ifmv k temperature_relax_tim default relax time berendsen thermostat fs stress_control default none type barostat follow method avail berendsen vcberendsen variablecel berendsen method vvberendsen variablevolum berendsen method keep cell shape chang volum scale cell vector see berendsen paperberendsen detail berendsen berendsen c postma p van gunsteren w f dinola haak r molecular dynam coupl extern bath pressure_target default target hydrostat pressur work stress_control vvberendsen stress_target default target stress tensor work stress_control berendsen vcberendsen stress_relax_tim default relax time fs berendsen barostat zload_typ default appli zdirect strain atom atom whose ifmv valu rel zposit move upward rel zposit move downward box control zcompon simul box matrix appli zdirect strain final_strain default final strain valu thu strain rate given final_strain time_interv num_iter shear_stress default shear stress valu appli system cutoff_radiu default cutoff radiu angstrom interatom potenti use flag_temp_dist default fals flag whether write temperatur distribut outtempdist file num_temp_dist default number bin along xdirect temperatur calcul valu must multipl num_nodes_x mass default mass given speci set automat mass speci need set differ element mass specifi follow mass si mass boundari default ppp boundari condit axi p period boundari condit f free boundari condit pmd usag instal download download sourc code current version whole packang github site httpsgithubcomryokbysnaphttpsgithubcomryokbysnap compil download napmasterzip file site get napmast directori unzip zip file eas follow explan chang directori name nap unzip napmasterzip mv napmast nap cd nap compil pmd program follow configur prefixpwd cd pmd make pmd get error find mpi fortran compil run configur find mpi fortran compil ask system administr configur specifi compil posit configur prefixpwd fcpathtofortrancompil option prefxpwd necessari pmd use fitpot program requir note get error relat c preprocessor configur error c preprocessor libcpp fail saniti check may specifi true c preprocessor path configur command ad option like cppusrbincpp although pmd command avail compil pmd may optim system compil might need add option relev system compil gfortran openmpi case gfortran openmpi configur prefixpwd fcflagso g optim option seem caus error depend version gfortran recommend use optim option debug may better set warn check option enabl follow configur prefixpwd fcflagso g fboundscheck wuniniti fbacktrac note compil llvm version gcc test use homebrew version gcc openmpi intel fortran compil use intel fortran compilerifort system configur command would like configur prefixpwd fcflagsxhost ip ipo noprecdiv option ip ipo inlin expans relev effici pmd pgi fortran compil mpi fortran command mpif link pgi fortran compil use compil specifi compil path fcpathtompif configur prefixpwd fcflagsminfo g fujitsu fortran fx easier compil comput node login node sinc differ configuringcompil node configur compil pmd first need login comput node pjsub interact pjsub interact pjsub interact l rscgrpfxinteractivenod case flowfxnagoyau configur prefixpwd fcflagso cd pmd make pmd exit note case configur return error exit without complet configur error messag relat cross compil may need add option like hostsparc command line fujitsu fortran cx case fujitsu fortran compil mpifrt cx configur prefixpwd fcflagskfastparallel helio rokkashomura linux os intel cpu compil seem basic one one need add specif option follow configur prefixpwd fcmpiifort fcflagsxavx ip ipo g cb dont specifi mpiifor explicitli ifort set default compil work correctli run sampl simul input file exampletestw directori inpmd pmdini input file system bcc tungsten crystallin structur includ one helium atom cd exampletestw pmdpmd run pmd command like nve md simul step perform total kinet potenti energi output outerg file look evolu energi use gnuplot command gnuplot gnuplot plot outerg us w l outerg us w l outerg us w l case sinc perform nve md simul bccw total energi conserv conpens deviat kinet potenti energi imagefigsgraph_energystepspng note format ot outerg bit chang version total potenti energi raw valu subtract initi valu also configur atom step step written lammpsdump format eg dump_ dump_ dump_ input file need run pmd run pmd follow file requir work directori inpmd input file describ simul set pmdini cell inform initi posit veloc atom option file requir pmd use interatom potenti requir input paramet file inparamsxxx imagefigspmdpng run pmd output file appear directori unit use pmd length angstrom time femto second fs energi electron volt ev mass carbon atom make initi atomconfigur file pleas atomconfigur filepmdfilemd detail one make initi atomconfigur file pmdini run pmd alreadi program make initi atomconfigur file system mkconfmkconf_f andor nappymkcellcell_makerpi make initi atomconfigur file look program code alreadi program make atomconfigur file target system make atomconfigur file cd mkconf emac makefil find mkconf_ made make mkconf_si_disl mkconf_si_disl use nappymkcellcell_makerpi well python pathtonappymkcellcell_makerpi h python pathtonappymkcellcell_makerpi dia l get atomconfigur file pmdini note make program make atomconfigur file copi program like mkconf_bccf modifi add entri makefil compil make inpmd file pleas refer inpmdinterpretedtext roleref detail inpmd file instanc inpmd file system step md simul use sw_si potenti follow unit time femto sec unit length angstrom unit mass unifi atom mass unit io_format ascii print_level time_interv num_iter num_out_energi flag_out_pmd num_out_pmd force_typ sw_si cutoff_radiu cutoff_buff flag_damp damping_coeff converge_ep converge_num initial_temperatur final_temperatur temperature_control none temperature_target temperature_relax_tim factor_direct stress_control none stress_relax_tim stress_target pressure_target shear_stress line begin treat comment line blanc line skip run pmd run pmd process realli easi run pmd process directori inpmd pmdini exist execut pmd pathtopmdpmd want perform background pathtopmdpmd outpmd follow file appear perform pmd outerg total kinet potenti energi temperatur volum pressur dump_ atomconfigur certain md step written lammpsdump format default mean md step run pmd parallelnod differ old version pmd requir divid atom configur file parallel node current version sinc parallel simul perform almost serial run need describ mani divis direct inpmd num_nodes_x num_nodes_i num_nodes_z run pmd mpirun mpiexec command run mpi execut mpirun np pathtopmd outpmd pmd execut node standard output written outpmd jobschedul system avail system use describ command job script submit note perform massiv parallel simul perform parallel simul one million atom data atomconfigur file becom consider larg readingwrit data take long time compar intrins comput pmd readwrit binari version atomconfigur file way small amount data want readwrit binari file describ follow inpmd io_format binari also write code write binari atomconfigur file mkconf_f mkconf_f file line subroutin call call write_pmd_ascii replac call write_pmd_bin recompil program forc field forc field ff specifi force_typ keyword inpmd file plural ff specifi spacesepar list force_typ nn mors coulomb ff read one paramet file work directori usual name like inparamscoulomb specifi ff exampl dnn requir two file inparamsdnn file weight nn inparamsdesc file descriptor inform avail ff list force_fieldsdnnforce_fieldsdnnmd force_fieldscoulombforce_fieldscoulombmd force_fieldsmorseforce_fieldsmorsemd force_fieldsswforce_fieldsswmd lennardjon ar linear regress nap document document nagoya atomisticsimul packag nap nap host github httpsgithubcomryokbysnap nap includ follow program util pmd fortran program massiv parallel molecular dynam fitpot fortran program fit paramet neuralnetwork potenti fppi python script fit paramet classic potenti nappi python script pre postprocess nagoya name citi japan project start cite nap r kobayashi miyaji k nakano nakayama apl materi httpsaipscitationorgdoi nap packag andor fppi program kobayashi ryo daniel giofré till jung michel ceriotti william arthur curtin physic review materi httpsjournalsapsorgprmaterialsabstractphysrevmateri fitpot program andor neuralnetwork nn potenti licens nap distribut mit licens pleas see licens statement github repositori contact ryo kobayashi kobayashiryo nitechacjp depart physic scienc engin nagoya institut technolog acknowledg program support part materi research inform integr initi miihttpwwwnimsgojpmiii project support program start innov hub japan scienc technolog agenc jst fppi fit paramet classic potenti python program fppi anoth program fit potenti paramet fitpot focus neuralnetwork nn potenti hand fppi focus classic potenti much less potenti paramet compar nn potenti usual less sinc number paramet optim small fppi employ metaheurist natureinspir method adopt physic valu learn target sinc deriv target valu wrt optim paramet requir setup use fppi check nappi work correctli sinc fppi actual part nappi packag fppi exist napnappyfitpotfppi see nappy_setupnappyhtmlsetup nappi packag fppi fppi follow loss function minim optim potenti paramet mathcal sum_t mathcall_t stand type target anyth comput abinitio program md program use potenti target volum system mathcall_mathrmv left fracv_mathrmff v_mathrmrefv_mathrmref right target radial distribut function rdf mathcall_mathrmr fracn_p sum_pn_p left fracsum_in_mathrmr g_pmathrmffr_i g_pmathrmrefr_isum_in_mathrmr g_pmathrmrefr_i right n_p number rdf pair consid n_mathrmr number sampl point rdf minim loss function follow metaheurist method avail cuckoo search cs differenti evolut de quick trial exampl two exampl fppi napexampl fp_lzp fit paramet mors coulomb swlike angular potenti rdf angular distribut function adf equilibrium volum lizrpo system fp_latp fit paramet mors coulomb swlike angular potenti rdf adf equilibrium volum lialtipo system either two directori tri fppi run follow command python pathtonapnappyfitpotfppi nproc tee outfp could take minut use process see output file written fppi see discuss resultresultsandoutput file need run fppi see napexamplesfp_lzp nap_examplesfp_latp sever file need run fppi program infitpot fppi configur file invarsfitpot optim paramet file inparamsxxx potenti paramet file actual use optim except inparamscoulomb must exist becuas charg inform element read datarefxxx refer data file subjobsh shellscript file perform sub job file need perform sub job pmdini atom configur file cell info posit veloc inpmdnpt input file pmd refer data fppi refer data store file datarefxxx xxx indic type target quantiti rdf adf vol etc current juli fppi run two differ mode distribut function dfmatch mode rdf adf equilibrium volum lattic constant adopt target whatev mode quantiti comput use target dfmatch mode refer data format target differ hand whatev mode format refer data fix refer data format dfmatch mode see format target rdf adf vol lat napexamplesfp_lzp refer data format whatev mode format refer data follow comment line begin line begin head file treat comment line st line ndat number data wgt weight target nd line later data limit number entri line recommend includ entri line input file infitpot control paramet fppi read infitpot work directori diffier dfmatch mode whatev mode infitpot first case whatev mode infitpot exampl napexamplesfp_latp shown num_iter print_level fitting_method cs sample_directori param_fil invarsfitpot match rdf adf vol potenti bvsx cs_num_individu cs_fraction update_vrang fval_upper_limit specord li al ti p interact li al ti p al ti p num_iter number iter gener comput print_level frequenc output default fitting_method optim algorithm default cs sample_directori directori refer data datarefxxx exist param_fil paramet file contain initi valu rang match xxx yyy zzz list quantiti use optim target potenti potenti type whose paramet optim current avail potenti mors bv bvsx cs_xxxx paramet relat cs cs_num_individu number individu nest gener cs_fraction fraction abandon gener update_vrang fval_upper_limit upper limit loss function loss function limit set valu specord order speci use refer md program interact pair tripl taken account optim paramet file invarsfitpot paramet file invarsfitpot contain initi valu rang paramet explor file specifi param_fil infitpot file hardlimit line begin head file treat comment line hardlimit comment line option set hardlimit set addit hard limit paramet automat updat search rang st line number optim paramet nvar cutoff radiu bodi potenti rcut cutoff bodi potenti rcut respect nd line later initial valu softlimit lower upper hardlimit lower upper respect hardlimit f hardlimit set entri hardlimit requir line subjob script subjobsh subjobsh use perform md run extract data evalu loss function nest individu binbash script call fppi perfom pmd simul extract rdf adf volum data usag run_pmdssh copi file requir pmd calcul cp inpmd pmdini cd directori clean rm f dump_ datapmd npt md cp inpmdnpt inpmd pmd outpmdnpt head n outpmdnpt tail n outpmdnpt echo nptmd done date extract rdf adf vol renam file python srcnapnappyrdfpi r gsmear skip specorderlalif pairslaflif outfp datapmdrdf dump_ python srcnapnappyadfpi gsmear tripletsliff outfp skip datapmdadf dump_ python srcnapnappyvol_latpi outfp skip dump_ echo postprocess done date pair triplet correctli set rdfpi adfpi well specord option outfp option requir write whatev mode format refer data hand case dfmatch mode outfp option use inpmd file subjob exampl inpmd file use subjob individu nest acual name inpmdnpt napexamplesfp_latp max_num_neighbor time_interv num_iter min_iter num_out_energi flag_out_pmd num_out_pmd flag_sort force_typ mors coulomb angular cutoff_radiu cutoff_buff flag_damp damping_coeff converge_ep e converge_num initial_temperatur temperature_control langevin temperature_target temperature_relax_tim remove_transl factor_direct stress_control vcberendsen pressure_target stress_relax_tim see input file inpmdinpmdmd detail mean input file short inpmdnpt go perform md simul step mors coulomb angular potenti k npt condit output pmd_ file target quantiti extract use python script describ subjobsh python script creat datapmdxxx file output fppi go read data file evalu loss function individu nest run fppi python srcnapfitpotfppi nproc tee outfp nproc set number process use evalu individu subjobscript option set script file use perform subjob default subjobsh subdir option set prefix directori subjob perform default subdir result output file directori creat fppi outfp standard output outcsgener inform gener outcsindividu inform individu invarsfitpot paramet file written whenev best individu updat invarsfitpotbest paramet file best individu run subdir_ directori use calcul individu remov directori run convert fppi paramet file pmd paramet file python srcnapnappyfitpotfpprmspi bvsx invarsfitpotbest command creat inparamsmors inparamscoulomb inparamsangular file keyword bvsx mean potenti visual evolut optim one plot loss function valu individu appear optim function gener use gnuplot gnuplot gnuplot set ylabel loss function valu gnuplot set xlabel gener gnuplot p outcsgener us w p pt check loss function converg check minimum loss function valu suffici small per target would good enough visual distribut paramet plot paramet valu individu use data outcsindividu gnuplot gnuplot p outcsindividu us w p li us w p alpha li us w p rmin li exampl structur relax gener atom configur made systemat use mkconf_ may stabl structur one need relax structur relax strucur run md simul fire algorithmbitzek without control temperatur temperature_control none appli veloc damp flag_damp use fire converg criterion e ev converge_ep atom move toward direct forc atom indic reduc energi final system becom least energi structur relax structur output use relax structur initi structur next simul mv pmdini pmdorig save initi structur pmdini mv pmdfin pmdini replac pmdini pmdfin relax structur lattic constant bulk modulu order calcul lattic constant bulk modulu chang lattic size evalu potenti energi system lattic size minim potenti energi lattic constant curvatur around lattic constant correspond bulk modulu prepar small simul cell system make pmdini file set num_iter valu inpmd file zero st evalu potenti energi forc requir perform test run pmd pathtopmdpmd confirm pmd done correctli run script pathtonapnappyenergy_vs_sizepi min max valu lattic size get follow output graph plsq result lattic constant ang cohes energi ev bulk modulu gpa output outecohvss logecohvssizeep make graph use plot program like gnuplot outenergy_vs_s file imagefigsecohvssizepng elast constant appli cell deform correspond elast constant want calcul obtain elast constant calcul potenti energi deform structur note script work cubic system assum latticeconstantinterpretedtext roleref done lattic constant alreadli obtain set lattic constant pmdini file valu obtain latticeconstantinterpretedtext roleref run script follow get follow output graph calcelasticconstantspi result c gpa cc gpa c gpa c gpa follow valu mayb valid isotrop materi young modulu gpa poisson ratio shear modulu gpa output outelasticconst graphelasticconstantsep imagefigsgraph_elasticconstantspng phonon dispers use phonopi phonon dispers relat calcul use phonopyhttpphonopysourceforgenet program instal phonopi move forward topic first prepar atom configur file pmd pmdini contain cell structur atom posit gener primit unit cell crystal structur consid warn follow approach make force_const old fashion way see pmdphonopypmdphonopi run one command get phonon dispers relat nd run follow command get forc constanst via finit displac approach python pathtonapnappyforce_constantpi r pmdini get poscar force_const use phonopi program option mean magnitud displac angstrom r cutoff radiu interatom potenti use force_constantpi show output follow displac ang rcut ang poscar written vol unit cell num cell axi num atom extend system sysextnum_atom mean force_const file contain xx cell origin primit unit cell valu pass phonopi rd prepar configur file phonopi name confphonopi atom_nam si cell_filenam poscar create_displac fals force_const read dim band dim valu force_const read let phonopi read forc constant file force_const run phonopi specifi confphonopi input phonopi p confphonopi get phonon dispers graph follow imagefigsphonondispersionsipng specifi phonopi configur file like atom_nam si cell_filenam poscar create_displac fals force_const read dim mp dos_rang sigma get phonon do imagefigsphonondossipng pmdphonopypi get phonon dispers directori approach force_const obtain old fashion lengthi user get phonon dispers relat directori one command first prepar pmdini bandconf file bandconf file like follow atom_nam si dim band atom_nam necessari want get correct frequenc valu phonon dispers graph phonon frequenc correspond wave number given band paramet shown user need consid dim valu automat determin follow command bash python pathtopmdphonopypi c pmdini get band output file out_band see graph gnuplot bash gnuplot gnuplot plot out_band us w l nonequilibrium molecular dynam nemd heat flux one perform nemd heat flux simul appli differ temperatur differ region figur show set heatflux nemd simul imagefigsnemdsettingpng heat flux must flown along xdirect case left right side system atom fix simul vacuum region place order avoid interact hot cool atom digit bottom pictur ifmv valu ifmv valu fix atom hot atom cool atom intermedi atom temperatur set inpmd like follow initial_temperatur temperature_control berendsen temperature_target temperature_target temperature_target temperature_relax_tim factor_direct target temperatur hot cool atom k k wherea target temperatur intermedi atom set valu set neg temperatur distribut along x obtain specifi follow inpmd flag_temp_dist num_temp_dist mean set flag true number bin along x num_temp_dist valu must multipl num_nodes_x result written outtempdist outtempdist file contain temperatur point everi num_iter num_out_energi step bitzek e bitzek p koskinen f gähler mosel p gumbsch phi rev lett public list public nap use let us know want show public nap use kobayashi r miyaji nakano k nakayama highthroughput product forcefield solidst electrolyt materi apl materi httpsaipscitationorgdoi nakano k et al exhaust informaticsaid search fast liion conductor nasicontyp structur use materi simul bayesian optim exhaust informaticsaid search fast liion conductor nasicontyp structur use materi apl materi httpsaipscitationorgdoi kobayashi r giofré jung ceriotti curtin w neural network potenti almgsi alloy physic review materi httpsjournalsapsorgprmaterialsabstractphysrevmateri kobayashi r hattori tamura ogata molecular dynam studi bubbl growth tungsten helium irradi j nucl mater httpswwwsciencedirectcomsciencearticleabspiisxviadihub kobayashi r ohba n tamura ogata mont carlo studi hostmateri deform effect li migrat graphit j phi soc jpn httpsjournalsjpsjpdoijpsj kobayashi r nakamura ogata coupl molecular dynamicscoarsegrainedparticl method dynam simul crack growth finit temperatur mater tran httpdxdoiorgmatertransm analyz simul result plot evolut energi energi basic valu md perform nve simul damp temperatur control extern forc total energi conserv wherea kinet potenti energi fluctuat often use check valid forc atom program new potenti one perform structur relax damp veloc atom md step increas kinet energi decreas zero one perform constant tempertur simul kinet energi almost constant simul sinc total kinet potenti energi written outerg file user plot energi evolut use gnuplot command gnuplot gnuplot plot outerg us w l total outerg us w l kinet outerg us w l potenti copi utilgperg script work directori gnuplot load gperg visual atom configur convert pmdformat file convers program chang pmd format visual softwar format visual atom configur use ovitohttpswwwovitoorg first convert pmdformat file pmd_ lammpsdump format file follow pathtonapnappynapsyspi convert specorderabc pmd_ dump_ specorderabc specifi order speci use pmdformat file get dump_ file digit number ovitohttpswwwovitoorg open lammpsdump format file sequenti pmd_ file one convert file use bash forstat f pmd_ pathtonapnappynapsyspi convert specorderabc f echo f sed spmddump done write lammpsdump file directli set flag_out_pmd pmd program write atom configur lammpsdump format file name dump_ visual file without convers use ovito program visual lammpsdump file radial distribut function rdf rdf commonli use investig structur system eg solid vs liquid crystal vs amorph get rdf python pathtonapnappyrdfpi option dump_ get averag rdf atom outrdf given atom configur file dump_ read averag atom file taken option shown option h help show help messag exit dr width bin default r rmax cutoff radiu radial distribut default gsmearsigma width gaussian smear zero mean smear default output file name default outrdf specorderspecord order speci separ comma like specorderwh default none skipnskip skip first nskip step statist default noaverag take averag file nonorm normal densiti plot plot figur default fals rdf pair speci normal densiti pair imagefigsgraph_rdfpng angular distribut function adf get adf perform adfpi someth like python pathtonapnappyadfpi tripletslaffbaff dump_ triplet consist angl must provid via option triplet note st speci triplet central atom bond two atom mayb counterintuit imagefigsgraph_adfpng option adfpi option h help show help messag exit w deg width angular degre default r rcut cutoff radiu bond pair default gsmearsigma width gaussian smear zero mean smear default tripletstriplet triplet whose angl comput three speci specifi connect hyphen separ comma eg poolioo default none output file name default outadf skipnskip skip first nskip step statist default noaverag take averag file plot plot figur default fals voronoi analysi way analyz local structur voronoi analysi make cell contain one atom accord rule minimum cell made face bisect atom bond perform voronoi analysi need instal voro first python pathtonapnappyvoropi pmd_ command provid output pmd_voro pmd_vorovol input output voro respect veloc autocorrel power spectrum note file format use section akr longer use sinc year explan would work directli remov section somebodi might interest procedur use order get power spectrum md simul result firstli think long md simul run case si phonon do exist thz invers time interv sampl data frequenc resolut invers simul time time interv sampl data fs correspond thz sinc half data omit symmetri simul time fs correspond frequenc resolut thz usual one make akr file power spectrum calcul get veloc autocorrel power specturm use power_spectrumpi nappi directori python pathtonapnappypower_spectrumpi relax akr option specifi time interv success akr file relax specifi relax time decay factor autocorrel function omit decay factor appli get datautocorr datpow file datautocorr includ veloc autocorrel function x z sum datpow also includ power spectrum x z sum power spectrum graph seem spiki smear use gaussian_smearpi python pathtonapnappygaussian_smearpi x datpow get datpowersmear file contain column blur data st th column datpow nappi nap python util nappi set python util contain napnappi directori currenli exactli python modul user may use util call directli shell setup nappi work python python seri mainten pythonx seri stop recommend use python nappi requir follow packag instal use pip command docopthttpdocoptorg asehttpswikifysikdtudkaseindexhtml use nappi python program requir add path napnappi directori environ variabl pythonpath case bash achiev ad follow line bash_profil bash export pythonpathpythonpathpathtonap check whether path nappi ad pythonpath follow command python c import nappi printnappy__file__ quick start nappi instal follow code ipython jupyt notebook python nappynapsi import napsystem analyz nsi napsystemfnamepathtonapexampletest_wpmdini analyzensi code show follow result vector vector vector b c alpha deg beta deg gamma deg volum number atom read write file read atom structur file sever format python nsi napsystemfnameposcar nsi napsystemfnamestructuredat ffmtxsf specorderalo current avail format pmd file format specif pmd program poscar vasp poscar file dump lammp dump file xsf akr file format akira viewer format readabl asehttpswikifysikdtudkas write structur file python nsyswriteposcar nsyswritepmdini nsyswrite_dump write function pars file name choos appropri file format name develop packag nap open sourc project modifi use free charg risk usual user modifi program sourc code appli md program specif subject tackl sourc code packag contain lot line algorithm usesd packag mostli basic user easili understand familiar molecular dynam enjoy code md simul formula want read modifi program sourc would help show detail formula pmd program basic pmd perform standard md veloc verlet algorithm one firstli understand standard md formula use standard textbooksfrenkel howev cours lot codespecif definit implement standard md section show codespecif definit use pmd simul cell simul cell consist one scalar valu l three vector mathbfa mathbfb mathbfc shown atomconfigur file l ax ay az bx bz cx cy cz cell inform actual use code matrix mathbfh defin beginalign beginequ mathbfh l time mathbfamathbfbmathbfc l time beginpmatrix a_x b_x c_x a_i b_i c_i a_z b_z c_z endpmatrix endequ endalign posit atom posit defin ranatm code normal within md simul becom absolut posit multipli cell matrix mathbfh beginalign begineqnarray mathbfr mathbfh cdot mathbfr r_amathbfa r_bmathbfb r_cmathbfc endeqnarray endalign written fortran code follow fortran xi hrai hrai hrai veloc atom veloc vanatm also scale cell matrix howev also scale time mean veloc code actual length scale veloc scale thu veloc verlet algorithm veloc directli ad posit without multipli time interv delta acceler atom acceler aanatm also scale cell matrix multpli delta becom unit posit end forc calcul subroutin thu acceler well directli ad posit without multipli delta veloc verlet loop veloc verlet vv basic md veloc verlet algorithm simpl comput initi forc veloc verlet loop start updat veloc use current forc half time interv delta updat posit use current veloc time interv delta comput forc current posit updat veloc use current forc half time interv delta written mathemat beginalign begineqnarray mathbfv_in mathbfv_i fracmathbff_inm_i fracdelta mathbfr_in mathbfr_in mathbfv_indelta textcomput mathbff_inleftleftmathbfrnrightright mathbfv_i mathbfv_in fracmathbff_inm_i fracdelta endeqnarray endalign subscript atom index superscript n mdstep implement code fortran call get_forcenamaxnatmtagrannmaxaastrshhi tcomnbnbmaxlsblsrcmyparitynnsvrclspr mpi_md_worldmyid_mdepiepotnismaxaconavol cforc istpnstp vanatmvanatm aanatm ranatmranatm vanatm call get_forcenamaxnatmtagrannmaxaastrshhi tcomnbnbmaxlsblsrcmyparitynnsvrclspr mpi_md_worldmyid_mdepiepotnismaxaconavol cforc vanatmvanatm aanatm enddo see basic construct simpl howev code miscellan stuff thermostat isobar parallel hidden codeblock rather lengthi berendsen barostat berendsen barostat similar berendsen thermostat control stress temperatur moder target one forc implement implement interatom forc potenti core md program want perform simul includ combin element implement pmd implement forc calcul routin everi forc routin defin separ modul force_sw_sif indic forc routin stillingerweb type si system call via get_forc subroutin force_commonf file thu write forc routin follow get_forc force_sw_si subroutin forcetyp use simul determin variabl cforc charact specifi inpmd file correspond forc routin call accord forcetyp name forc subroutin argument order provid use use begin get_forc routin ase interfac python script connect pmd ase atomist simul environ enabl us small calcul pmd much easier follow code show use nappyinterfaceasepmdrunpi ase program python import ossi aseio import read nappyinterfaceasepmdrun import pmd atomsreadposcarindexformatvasp ossystemcp pathtoinnn calc pmdlabelpmdcommandpathtonappmdpmd outpmdforce_typenn atomsset_calculatorcalc print atomsget_potential_energi print atomsget_forc atomsget_potential_energi call pmd program perform background ase get calcul result outpmd file version tag nap use git version control develop recommend make new branch modifi code merg chang master branch tag name like rev mean revis date need make new tag date would happen often name tag like rev_ someth like ad suffix underscor version nap follow strictli semant versioninghttpssemverorg howev sinc api defin major version never get one version like vxx frenkel dann frenkel berend smit understand molecular simul academ press cluster manag util what clmgrpi python util autom process submit job cluster supercomput make job script submit job specifi appropri resourc combin job submit one job script reduc actual number submiss provid clmgrpi make input file calcul send input file local comput remot cluster gather result remot cluster pars check calcul result sophist program process well process clmgrpi provid aiida marvel firework materi project rememb use sophist program also easi compar program clmgrpi thought much easier setup use includ nappi basic clmgrpi provid separ modul requir parser vasp parser alreadi implement nappi easier make util exist packag also make instal process easier well instal nappi export pythonpathpathtonappythonpath test instal went well python c import nappi print nappy__file__ get path nappi directori instal ok setup remot cluster machin follow file requir run pathtonappyclutilclmgrpi probabl remot cluster supercomput nappyclmgr nappyclmgrmachin nappyvaspconf machin file machin file written yaml format contain inform schedulertyp use list queue correspond resourc number processorscor one node mpi command use exampl machin file fujitsu fx follow schedul fujitsu queue fxdebug num_nod default_sec limit_sec fxsmall num_nod default_sec limit_sec fxmiddl num_nod default_sec limit_sec fxlarg num_nod default_sec limit_sec fxxlarg num_nod default_sec limit_sec nprocs_per_nod mpi_command mpiexec vcoordfil rankfil n npara stdout exec_path schedul schedul take valu either one follow fujitsu pb torqu queue queue list queue name queue name dictionari entri num_nod default_sec limit_sec nprocs_per_nod valu machin specif must provid mpi_command mpi_command entri specifi mpi command use machin current follow paramet use command npara number parallel process mpi run output file path exec_path execut file path rankfil path rankfil use fujitsu fx vaspconf file file written yaml format contain path vasp execut file like exec_path binvaspfx usag usag shown type clmgrpi h usag clmgrpi option dir dir option h help show messag exit c calcul set calcul type avail type vasp default vasp dryrun run clmgr without actual submit job default fals enabl multipl job one submiss case limit number job run time server may better set true default fals q queue_nam queue name job submit default default exampl linux cluster without limit run job per user one run clmgrpi like pathtoclmgrpi q queue_nam calc_dir supercomput limit number run job time pathtoclmgrpi q queue_nam calc_dir log file clmgrpi creat log file nappyclmgr name includ pid process clmgrpi run file find directori treat directori job run job id job assign fitpot fit paramet neuralnetwork potenti valid md simul depend strongli accuraci interatom potenti use simul think simul specif system prepar interatom potenti reproduc phenomena think indroduc make neuralnetwork potenti fit potenti paramet fitpot program includ nap packag note current fitpot program use neuralnetwork potenti classic potenti use fppi instead fitpot fitpot follow loss function minim optim potenti paramet w mathcallw fraceta n_ssum_sn_ left delta e sum_ins_mathrmaleft delta boldsymbolf_iright left delta sigma rightright case fit energi forc sampl number n_ number sampl ns_mathrma number atom sampl eta paramet correspond mani properti fit case eta energi forc stress use minim loss function follow gradientbas method avail fitpot steepest descent sd quasinewton method bfg conjug gradient cg stochast gradient descent sgd compil sinc modul pmd program requir compil fitpot compil pmd compil fitpot cd pathtonap configur prefixpwd cd pmd make pmd cd fitpot make fitpot quick trial exampl exampl fitpot minim dataset see work go directori examplesfitpot_dnn_sio read readmemd tri run fitpot look output file fit procedur hereaft assum refer data obtain use abinitio calcul program vasp potenti paramet fit follow procedur vaspdatapreparereferencedata prepareinputsprepareinputfil execfitpotrunfitpotprogram prepar refer data assum refer data dataset directori data store directori whose name start smpl_ follow file requir eaci sampl directori smpl_ po ergref frcref strsref po pmdformat atomconfigur file ergerg contain scalar valu energi system frcref contain number atom system forc atom shown case extract dft data abinitio md run vasp posit energi forc stress md step obtain vasprunxml file follow python pathtonapnappyvaspvasprunfppi pathtodirthatincludesvasprunxml get directori name like includ po ergref frcref strsref file prepar input file input file need fitpot follow infitpot inparamsdnn inparamsdesc inparamscoulomb smpl_xxx directori special case specifi num_sampl infitpot file number sampl dataset directori number sampl directori count follow command bash ls pathtodataset grep smpl_ c run fitpot program directori dataset directori infitpot file exist run fitpot program srcnapfitpotfitpot outfitpot want run parallel mode mpirun np srcnapfitpotfitpot outfitpot output file outergtrnfin outergtstfin file includ refer pmd data energi see whether fit went well plot data use gnuplot gnuplot gnuplot plot outergtrnfin us w p train set gnuplot rep outergtstfin us w p test set outfrctrnfin outfrctstfin file includ refer pmd data forc input file fitpot follow code show exampl input file infitpot num_sampl test_ratio num_iter num_iter_ev fitting_method bfg sample_directori dataset param_fil inparamsdnn normalize_input none energy_match force_match stress_match potenti dnn ftol e xtol e penalti none penalty_weight speci order al mg si specord al mg si num_sampl default none number refer sampl use train test sample_list default none path file contain list sampl use train test format list file like smpl_ smpl_ smpl_ specifi sampl train test smpl_ smpl_ smpl_ whether train test specifi list test_ratiotest_ratio neglect test_ratio default ratio test data set r within whole data set n thu number test data set rn number train data set rn num_iter default number iter minim method num_iter_ev default test data set evalu everi num_iter_ev iter fitting_method default test method use fit paramet sampl data avail method follow sdsd steepest descent algorithm requir gradient inform cgcg conjug gradient algorithm requir gradient inform bfgsbfg quasinewton method bfg requir gradient inform check_grad comparison analyt deriv numer deriv use check implement analyt gradient testtest calcul function l gradient l wrt fit paramet sample_directori default dataset directori includ sampl data call dataset instruct want use specifi directori rel current work directori eg dataset need enclos doublequot mark like dataset param_fil default inparamsdnn name file paramet valu pass pmd program ftol default e toler differ loss function valu xtol default e toler chang variabl optim either one ftoltitleref xtoltitleref achiev optim stop energy_match force_match stress_match default true energi fals forc stress whether match forc true fals recommend match energi also forc sinc forc import molecular dynam potenti force_field default dnn potenti whose paramet go fit potenti current avail dnn neuralnetwork potenti linreg linear regress potenti random_se default initi random seed uniform random number use fitpot use chang random choic train test set regular whether regular base obtain linreg dnn potenti true fals default fals penalti default type penalti term lasso lnorm penalti ridg lnorm penalti mean penalti term penalty_weight default weight appli penalti term valu also determin crossvalid score sample_error default number sampl whose error given error appear denomin energi forc evalu function left fracemathrmnnemathrmdftn_mathrmavarepsilon_mathrmeright sum_in_mathrma sum_alphaxyz fracn_mathrmaleft fracfmathrmnn_ialpha fmathrmdft_ialphavarepsilon_mathrmfright differ nn energi dft energyforc lower valu term becom less mean energyforc sampl thought converg initi valu error evatom evang energi forc respect must number follow entri line valu determin error energi forc sampl like sample_error al_fcc al_bcc entri entry_nam error energi evatom error forc evang error stress gpa error valu appli sampl contain entry_nam directori name force_denom_typ rel absolut default rel type denomin forc term loss function use absolut specifi fitpot use error forc specifi sample_errorsample_error denomin forc term rel specifi fitpot use magnitud forc atom denomin forc term specord default none order speci common fitpot must specifi atom_energi entri must hold everi sampl init_param default read whether paramt optim read file initi read read paramet file gaussian paramet initi gaussian distribut accord init_params_sgm init_params_mu init_params_sgm default varianc gaussian distribut initi valu paramet init_params_mu default mean valu gaussian distribut initi valu paramet init_params_r default random seed initi paramet random seed use purpos affect random seed choic train test set affect random_seedinterpretedtext roleref 分子動力学法mdの基礎 mdの概要 分子動力学法molecular dynam mdは原子分子の動きを計算機上で再現することで 実験では観測できないミクロの世界の現象を観たり 実験では行うことのできない状況の仮想実験を行ってみたり 統計データからマクロな物理量を計算したり と様々なことが可能な計算機シミュレーション手法である 単純に言えばmdシミュレーションとは 原子間に働く力つまりは原子に働く加速度を求める 加速度に従い原子を動かす のつを繰り返すシミュレーションであり 原子間に働く力をいかに正確に求められるかがシミュレーションの精度を決定する 単純であるがもしくは単純であるが故に応用範囲は広く研究レベルでは 工学 化学 生物創薬 物理 の様々な分野で使われている しかし有限要素法や第一原理計算に比べると企業レベルではまだまだ知名度は低いと思われる 分子動力学シミュレーションにおいて重要なことは 原子間ポテンシャル モデリング 結果の解釈 であるすでに述べたようにまずは原子間ポテンシャルが正しくないと原子間に働く力が現実と異なるのでどんなに他を頑張ってもダメなことがある しかし完璧な原子間ポテンシャルなどは存在しないのでその限界や適用範囲などを理解しながらシミュレーションを行い 結果を解釈できれば目的は達成できると期待される そのためシミュレーションをするに際し何を解決するためにどのようなことが分かれば良いのかを明確にしなければならない そして初めてどのようなシミュレーションを行えば良いのかが決まる この段階が モデリング と呼ばれる 原子間ポテンシャル 原子に働く力は原子の周りに存在している電子を介した量子論的な相互作用により初めて求まるものである そのため量子論的な計算を行い原子間に働く力を求めそれを用いて分子動力学シミュレーションを行う 第一原理分子動力学法 もある ただし一般的に量子論的な計算は非常に計算量が多いために多数の原子や長時間のダイナミクスを行うことは現在でも難しい そこで量子論的な相互作用を何らかの関数系で近似し原子に働く力を求めてシミュレーションを行うことを古典分子動力学法という これまでに様々な関数系が種々の系に対して提案されている lennardjoneポテンシャル 希ガス原子の間の相互作用は電子の揺らぎに起因する静電相互作用でありvan der waals相互作用と呼ばれる これは距離 r の乗に比例する引力となることが知られている この相互作用を表現するのがlennardjonesポテンシャルであり次のような形となっている phi r_ij epsilon_ij left left fracsigma_ijr_ij right left fracsigma_ijr_ij right right 斥力項には物理的な根拠はないが一般的には乗が用いられる moorseポテンシャル embed atom method eam ポテンシャル eamポテンシャル fsポテンシャル meamポテンシャル geamポテンシャル stillingerweberポテンシャル tersoffポテンシャル 長距離力 クーロン力 高速化技法 cell list法とbook keeping法 原子間ポテンシャルの計算には近くに存在する原子の情報が必要である 大抵の原子間ポテンシャルにおいて隣接原子を検索する段階が計算スピードのボトルネックとなる そのためmdシミュレーションでは隣接原子の検索をどれだけ速く計算できるかが重要なポイントである 単純に全ての他の原子との距離を計算するとn個の原子一つ一つがn個の他の原子との距離を計算するので onの計算量となる これを減らすための手法が cell list法 と book keeping法 である cell list法 系を小さなセルに分割しそこに原子を登録していく こうすることで全ての原子との距離を計算する必要がなくなり隣のセルに入っている原子とのみ距離を測れば良くなり onの計算量となる book keeping法 cell list法では個のセルの中に入っている原子の数だけ検索すれば良いのでonに比べれば非常に高速だが そのセルの端にある原子はカットオフ半径の外にあるので毎回検索するとムダが多い そのためカットオフ半径に入っている原子だけをリストに保存しておいてポテンシャルと力の計算に用いることで計算量を減らすことができる その際カットオフ半径よりも少し大きめの半径を取っておけば毎ステップこのリストを更新する必要がなくなるため 全シミュレーションとしての計算量を減らすことができる 空間分割並列化法 多くの原子間ポテンシャルは短距離相互作用となっているので遠くまで相互作用は及ばない そのことを活かし大規模な系を空間分割し各領域を各プロセスとして同時並列的に各領域の計算を行う こうすることでおよぼ並列数倍だけ計算が速くなる 各領域の端にある原子は隣りの領域つまりは別プロセスの原子と相互作用する必要があるため 毎ステップ原子座標情報を隣りの領域と交換する必要がある このデータ通信量が大きいと並列性能がでない 隣りの領域と情報交換する原子は領域の端からカットオフ半径程度にある原子であるため カットオフ半径が長いポテンシャルは隣接原子探索にも時間がかかるし並列性能も悪くなる mdで得られる物理量 凝集エネルギー 輸送係数 グリーン久保公式 note temperatur control simpl veloc scale ad format input file inpmd chang littl van der waal potenti brenner correct paramet vdw potenti fit potenti check num divis cutoff length inpmd simul run use variabl array tag instead effici parallel tag includ speci index fmv total id histori input output file seper folder name output number unit chang atom unit ev angstrom mass chang input format user readabl one input file name becam inpmd use tag instead reduc num mpi messag pass bamov bacopi add brenner potenti van der waal term also simpl veloc scale ad add smooth embed term bug fix copi ifmv subroutin bamov add smooth bodi term eam potenti atomconfigur file origin file format describ use pmd file format specord w h e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e line number shown eas explan line line begin treat comment line keyword use specifi addit data pmd comment line begin specord specifi speci order use pmd note specord must specifi current pmd sinc rev mass interatom potenti determin use inform line superfici appar latti constant valu multipli cell vector obtain absolut cell vector line lattic vector nd line vector rd line th line column x z compon vector line veloc lattic vector use npt ensembl simul involv lattic deform line number atom system decompos region line one atom inform per one line st column line tag atom digit one place mean speci atom digit tenth place ifmv valu control direct motion atom th column line x z coordin atom normal lattic vector thu th column line x z compon atom veloc also normal sampl fortran code fortran openionumfilecfnamestatusreplac writeionumes hunit writeionumes hiaiblhunitia ibl writeionumi natm intot writeionumes tagi rtoti vtoti closeionum enddo detail explan variabl omit user write code follow sampl fortran code format convers python util napsyspi convert file amoung follow format pmd input format pmd program poscar input format vasp program dump output format lammpsdump command use like follow python pathtonapnappynapsyspi convert pmdini poscar pmdini file convert poscar file poscar format file format determin automat file name user also specifi inputoutput file format option informat outformat see help messag detail python pathtonapnappynapsyspi h make crystallin structur also python util cell_makerpi make typic convent crystallin structur make pmd format file diamond structur cubic system atom python pathtonapnappymkcellcell_makerpi dia l pmdini option l specifi lattic constant lattic output format automat detect file name also make fcc bcc sc simpl cubic hcp structur well introduct pmd acronym parallel molecular dynam mean molecular dynam md use spatial decomposit techniqu parallel ditributedmemori comput pmd part nagoya atomisticsimul packag nap main featur pmd follow sever interatom potenti solid state system avail deep neuralnetwork dnn interatom potenti qeq variabl charg coulomb potenti parallel comput use spatial decomposit techniqu effici search neighbor atom use linkedlist cell method structur relax use simpl veloc damp fire algorithm thermostat berendsen langevin barostat berendsen variabletimestep md highenergi ionbombard simul nonequilibrium md nemd heat flux simul twotemperatur model md ttmmd laserabl simul sinc program develop purpos person research tool mani function open sourc md program almost thing pmd featur pmd parent packang nap pleas feel free contact ask anyth want use pmd nap specif purpos bug report question pmd nap welcom afraid might abl respond report question requir pmd execut unixlinux maco x window use fortran compil mpi librari analysi tool written python languag may also need python pythonutil numpi scipi panda docopt ase faq enough slot avail get follow error messag run pmd number parallel process enough slot avail system satisfi slot request applic pmd either request fewer slot applic make slot avail use may increas number slot avail oversubscrib option mpirun oversubscrib np pmd refer httpsstackoverflowcomquestionsmpirunnotenoughslotsavail system call fail share memori initi follow error messag could appear end pmd output number mpi process number automat determin spatial decomposit divis differ system call fail share memori initi like mpi job either abort experi perform degrad local host mbprkethogtnitechacjp system call unlink varfoldersfhcdqtsjdfrwmjwxtgntompimbprkethpidvader_segmentmbprkethf error file directori errno pmd result correct remov set environ variabl export ompi_mca_btlselftcp refer httpsgithubcomopenmpiompiissu neuralnetwork nn potenti neural_network nn potenti requir follow two input file work directori inconstnn network structur type symmetri function paramet symmetri function interact pair inparamsnn number weight cutoff radii two threebodi interact weight valu network two file must consist number weight must correspond number symmetri function number layer number node layer exampl file found pmdforce_paramsnn_ directori rule inconstnn follow threebodi term must come twobodi term within twobodi term term specif pair must written consecut line like pair see nd rd column appear finish input pair stillingerweb sw potenti sw potenti requir paramet file inparamssw follow format unit line start unit defin unit energi length line entri twobodi paramet format isp jsp eij aij bij pij qij cij rcij line entri threebodi paramet format isp jsp ksp sij tij neuralnetwork nn potenti nn note titl note nn potenti updat ver june forcefield name nntitleref document nn potenti one use ver see neural_networkinterpretedtext roledoc nn potenti requir follow two input file work directori inparamsdesc type symmetri function paramet symmetri function cutoff radii interact pair inparamsnn nn structur number layer number node layer weight valu network two file must consist number weight must correspond number symmetri function number layer number node layer exampl file found pmdforce_paramsnn_ directori inparamsdesc note titl note format inparamsdesc file chang previou one around may speci written directli acronym name si speciesid digit want use previousformat inparamsdesc modifi replac speciesid speci name format inparamsdesc like follow w w w w w w w h w h w h w w w w w w st line two entri number specei number descriptor follow line descriptor inform st entri type descriptor nd rd speci interact pair th end paramet descriptor number paramet depend type descriptor inparamsnn inparamsnn file follow format e e e e e e three digit st line number layer number input node number node st layer follow line case nn weight two dummi valu deep neuralnetwork dnn potenti note nn potenti nn nn replac dnn potenti januari strongli recommend use dnn potenti instead nn dnn superset nn nn longer maintenanc futur dnn potenti requir follow two input file work directori inparamsdesc type symmetri function paramet symmetri function cutoff radii interact pair inparamsdnn nn structur number layer number node layer weight valu network two file must consist number descriptor must correspond number input nn exampl file found pmdforce_paramsdnn_ directori inparamsdesc note format inparamsdesc file chang previou one around may speci written directli acronym name si speciesid digit want use previousformat inparamsdesc modifi replac speciesid speci name format inparamsdesc like follow w w w w w w w h w h w h w w w w w w st line two entri number specei number descriptor follow line descriptor inform st entri type descriptor nd rd speci interact pair th end paramet descriptor number paramet depend type descriptor inparamsdnn inparamsdnn file follow format sigtyp e e e e e e line start comment line special keyword found option pass program st entri st line follow comment number hidden layer nn nd entri number node th layer call input layer follow digit number node hidden layer number digit must number hidden layer given st entri follow line includ weight valu lower upper bound use fitpot mors potenti potenti form mors potenti beginequ e_ijr_ij d_ij left exp alpha_ij r_ij r_ij right endequ potenti requir paramet file inparamsmors follow format isp jsp d_ij alpha_ij r_ij case three interact interact three paramet d_ij depth potenti curv ev alpha_ij relat width potenti well ang r_ij posit potenti minimum ang coulomb potenti ewald shortscreend coulomb potenti requir paramet file inparamscoulomb follow format charg fix si interact si si si term short sigma format black line neglect keyword charg fix variabl qeq follow line speci charg eg q_ q_ interact option follow pair speci specifi interact taken account term full long shortscreened_cut either full ewald term longrang term shortrang term shortterm smooth cutoff sigma width gaussian charg distribut relat accuraci case ewald method variabl charg qeq coulomb potenti treat variabl charg qeq specifi variabl qeq charg keyword shown charg variabl si interact si si si term short sigma conv_ep charg variabl requir follow line name chi jii e qlow qup name name chemic speci chi electroneg speci ev jii hard speci ev e atom energi ev qlow lower limit charg speci qup upper limit charg speci conv_ep converg criterion charg optim usual small achiev good energi conserv what qmcl qmcl program perform qmmm simul use vasp pmd qm cl calcul respect packag includ variou forc interfac qm cl qmmm made ryo kobayashi assist professor depart mechan engin nagoya institut technolog compil usag see manual web site japanes httplocsbwnitechacjpkobayashiqmcl_manu