_scgps_ singl cell global fate potenti subpopul p aligncent img srcmanfiguresscgpslogopng widthpx p _scgps_ packag websit avail httpsimbcomputationalgenomicslabgithubioscgpsindexhtml usag instruct found httpsimbcomputationalgenomicslabgithubioscgpsarticlesvignettehtml _scgps_ gener descript _scgps_ complet singl cell rna analysi framework decompos mix popul cluster _score_ analys relationship cluster _scgps_ _scgps_ also perform unsupervis select predict gene defin subpopul andor drive transit subpopul packag implement two new algorithm _score_ _scgps_ key featur _score_ cluster algorithm unsupervis prior number cluster stabl autom select stabil resolut paramet scan rang search window run togeth boostrap aggreg approach determin stabl cluster fast rcpp implement _score_ first build refer cluster highest resolut run iter cluster window dendrogram resolut quantifi diverg refer appli adjust rand index stabil proport number execut run without rand index chang chang cluster search space optim resolut combin stabl high resolut bag algorithm bootstrap aggreg detect rare subpopul appear multipl time differ decis tree run key featur _scgps_ algorithm estim transit score two subpopul _scgps_ predict model base elast net procedur enabl select predict gene train interpret model predict subpopul gene identifi _scgps_ perform better known gene marker predict cell subpopul transit score percent target cell classifi class origin subpopul cell subtyp comparis transit score similar two subpopul score averag valu bootstrap run comparison nonshrinkag procedur linear discrimin analysi lda use _scgps_ workflow _scgps_ take scrna express dataset one unknown sampl find subpopul relationship subpopul input dataset contain mix heterog cell _scgps_ first use _score_ _core_ v identifi homogen subpopul _scgps_ contain number function verifi subpopul identifi _score_ eg function compar result pca tsne imput method cidr _scgps_ also option find gene marker distinguish subpopul remain cell perform pathway enrich analysi annot subpopul second stage _scgps_ appli machin learn procedur select optim gene predictor build predict model estim betweensubpopul transit score probabl cell one subpopul like transit subpopul p aligncent img srcmanfigurespackageplanpng widthpx br figur scgp workflow yellow box show input green box show main scgp analysi p titl scgp introduct descript scgp singl cell rna analysi framework decompos mix popul cluster score follow analys relationship cluster scgp author quan nguyen michael thompson date r sysdat output rmarkdownhtml_vignett vignett vignetteindexentrysingl cell global fate potenti subpopul vignetteengineknitrrmarkdown usepackageutfinputenc r setup eval true echo fals knitropts_chunkset collaps true comment instal instruct r instal eval fals instal scgp github depend configur local comput hpc possibl custom c compil may requir see instal troubleshoot devtoolsinstall_githubimbcomputationalgenomicslabscgp c compil troubleshoot manual download instal done github git clone httpsgithubcomimbcomputationalgenomicslabscgp check scgpssrc precompil eg file exist delet recompil scgp r work directori manual instal load use devtool function instal packag devtoolsinstal load packag workspac libraryscgp simpl workflow scgp purpos workflow solv follow task given mix popul known subpopul estim transit score subpopul creat scgp object r scgps_object warn fals messag fals load mix popul load day__cardio_cell_sampl dataset name day libraryscgp day day__cardio_cell_sampl mixedpop new_scgps_objectexpressionmatrix daydat_count genemetadata daydatgeneinfo cellmetadata daydat_clust load mix popul load day__cardio_cell_sampl dataset name day day day__cardio_cell_sampl mixedpop new_scgps_objectexpressionmatrix daydat_count genemetadata daydatgeneinfo cellmetadata daydat_clust run predict r predict warn fals messag fals select subpopul c_selectid load gene list list user select gene gene training_gene_sampl gene genesmerged_uniqu load cluster inform cluster_mixedpop coldatamixedpop cluster_mixedpop coldatamixedpop run train run nboot recommend use nboot lsolda_dat bootstrap_predictionnboot mixedpop mixedpop mixedpop mixedpop gene gene c_selectid c_selectid listdata list cluster_mixedpop cluster_mixedpop cluster_mixedpop cluster_mixedpop trainset_ratio nameslsolda_dat summaris result r summarise_result warn fals messag fals summari result lda sum_pred_lda summary_prediction_ldalsolda_dat lsolda_dat npredsubpop summari result lasso show percent cell classifi cell belong sum_pred_lasso summary_prediction_lassolsolda_dat lsolda_dat npredsubpop plot summari result plot_sum functionsum_dat sum_dat_tf tsum_dat sum_dat_tf naomitsum_dat_tf sum_dat_tf applysum_dat ncolsum_dat functionxasnumericasvectorx sum_datnam gsubelasticnet subpopsp sum_datnam sum_datnam gsubin target mixedpopin p sum_datnam sum_datnam gsublda subpopsp sum_datnam sum_datnam gsubin target mixedpopin p sum_datnam colnamessum_dat_tf sum_datnam boxplotsum_dat_tf la plot_sumsum_pred_lasso plot_sumsum_pred_lda summari accuraci check model accuraci leaveout test set summary_accuracyobject lsolda_dat summari maximum devianc explain model summary_devianceobject lsolda_dat complet workflow scgp purpos workflow solv follow task given unknown mix popul find cluster estim relationship cluster identifi cluster dataset use core skip step cluster known r core warn fals messag fals find cluster inform expres data use core day day__cardio_cell_sampl cellnam colnamesdaydat_count cluster daydat_clust cellnam dataframeclusterclust cellbarcod cellnam mixedpop new_scgps_objectexpressionmatrix daydat_count genemetadata daydatgeneinfo cellmetadata cellnam core_clust core_clusteringmixedpop remove_outli c pcafals updat cluster inform user key_height core_clusteroptimalclustkeystatsheight optimal_r core_clusteroptimalclustoptimalr optimal_index whichkey_height optimal_r clustering_after_outlier_remov unnameunlist core_clusterclusteroptimal_index corresponding_cells_after_outlier_remov core_clustercellsforclust original_cells_before_remov coldatamixedpop corresponding_index matchcorresponding_cells_after_outlier_remov original_cells_before_remov check match identicalascharacteroriginal_cells_before_removalcorresponding_index corresponding_cells_after_outlier_remov creat new object new cluster remov outlier mixedpop_post_clust mixedpopcorresponding_index coldatamixedpop_post_clust clustering_after_outlier_remov identifi cluster dataset use score stabl cluster optim resolut skip step cluster known score aim get stabl subpopul result introduc bag aggreg bootstrap core algorithm r score bag warn fals messag fals find cluster inform expres data use score day day__cardio_cell_sampl cellnam colnamesdaydat_count cluster daydat_clust cellnam dataframeclusterclust cellbarcod cellnam mixedpop new_scgps_objectexpressionmatrix daydat_count genemetadata daydatgeneinfo cellmetadata cellnam score_test core_baggingmixedpop remove_outli c pcafals bagging_run subsample_proport visualis cluster result iter r visualis devcairopdf devoff plot core cluster p plot_corecore_clustertre core_clusterclust color_branch ceb ced ce fca bceb p extract optim index identifi core key_height core_clusteroptimalclustkeystatsheight optimal_r core_clusteroptimalclustoptimalr optimal_index whichkey_height optimal_r plot one optim cluster bar plot_optimal_coreoriginal_tre core_clustertre optimal_clust unlistcore_clusterclusteroptimal_index shift plot score cluster plot cluster bar plot_corescore_testtre list_clust score_testclust plot one stabl optim cluster bar plot_optimal_coreoriginal_tre score_testtre optimal_clust unlistscore_testclust score_testoptimal_index shift compar cluster result dimension reduct method eg tsne r compare_clust figwidth figheight tsneexpressionmatassaymixedpop p plot_reducedt color_fac factorcoldatamixedpop pallet lengthuniquecoldatamixedpop p find gene marker annot cluster r find_mark warn fals messag fals figwidth load gene list list userselect gene gene training_gene_sampl gene genesmerged_uniqu gene list also object identifi differenti express analysi cluster inform requi find_mark use core result coldatamixedpop unlistscore_testclusterscore_testoptimal_index suppressmessageslibrarylocfit degen find_markersexpression_matrixassaymixedpop cluster coldatamixedpop selected_clusteruniquecoldatamixedpop output contain datafram cluster data frame contain gene sort pvalu namesdegen annot identifi cluster degenelist_vsoth degenesde_subpopvsremainingid user need check format gene input make sure consist gene name express matrix follow command save file pathwayenrichmentxlsx work dir use top de gene suppressmessageslibrarydos suppressmessageslibraryreactomepa suppressmessageslibraryclusterprofil gene asfactordegenelist_vsothersseq_len enrichment_test annotate_clustersgen pvaluecutoff gene_symboltru enrich output display run clusterprofilerdotplotenrichment_test showcategori fontsiz relationship cluster within one sampl two sampl purpos workflow solv follow task given one two unknown mix popul cluster mix popul estim visualis relationship cluster start scgp predict find relationship cluster r scgps_predict warn fals messag fals select subpopul input gene list c_selectid note make sure format gene input format gene mixedpop mixedpop gene degenesid run test bootstrap nboot run cluster_mixedpop coldatamixedpop cluster_mixedpop coldatamixedpop lsolda_dat bootstrap_predictionnboot mixedpop mixedpop mixedpop mixedpop gene gene c_selectid c_selectid listdata list cluster_mixedpop cluster_mixedpop cluster_mixedpop cluster_mixedpop display summari result predict r summarise_predict get number row summari matrix row_clust lengthuniquecoldatamixedpop summari result lda show percent cell classifi cell belong lda classifi summary_prediction_ldalsolda_datlsolda_dat npredsubpop row_clust summari result lasso show percent cell classifi cell belong lasso classifi summary_prediction_lassolsolda_datlsolda_dat npredsubpop row_clust summari maximum devianc explain model model train summary_devianceobject lsolda_dat summari accuraci check model accuraci leaveout test set summary_accuracyobject lsolda_dat plot relationship cluster one sampl look one exampl use case find relationship cluster within one sampl two sampl r prediction_one_sampl warn fals messag fals figwidth run predict cluster cluster_mixedpop coldatamixedpop cluster_mixedpop coldatamixedpop cluster_mixedpop asnumericasvectorcoldatamixedpop c_selectid top gene marker distinguish cluster gene degenesid lsolda_dat bootstrap_predictionnboot mixedpop mixedpop mixedpop mixedpop genesgen c_selectid listdata list cluster_mixedpop cluster_mixedpop cluster_mixedpop cluster_mixedpop c_selectid gene degenesid lsolda_dat bootstrap_predictionnboot mixedpop mixedpop mixedpop mixedpop genesgen c_selectid listdata list cluster_mixedpop cluster_mixedpop cluster_mixedpop cluster_mixedpop c_selectid gene degenesid lsolda_dat bootstrap_predictionnboot mixedpop mixedpop mixedpop mixedpop genesgen c_selectid listdata list cluster_mixedpop cluster_mixedpop cluster_mixedpop cluster_mixedpop c_selectid gene degenesid lsolda_dat bootstrap_predictionnboot mixedpop mixedpop mixedpop mixedpop genesgen c_selectid listdata list cluster_mixedpop cluster_mixedpop cluster_mixedpop cluster_mixedpop prepar tabl input sankey plot lasso_c reformat_lassoc_selectid mp_selectid lsolda_datlsolda_dat npredsubpop lengthuniquecoldatamixedpop nodes_group b lasso_c reformat_lassoc_selectid mp_selectid lsolda_datlsolda_dat npredsubpop lengthuniquecoldatamixedpop nodes_group lasso_c reformat_lassoc_selectid mp_selectid lsolda_datlsolda_dat npredsubpop lengthuniquecoldatamixedpop nodes_group ea lasso_c reformat_lassoc_selectid mp_selectid lsolda_datlsolda_dat npredsubpop lengthuniquecoldatamixedpop nodes_group ffff combin rbindlasso_cslasso_cslasso_c lasso_c combin combinedisnacombinedvalu true nboot link sourc target valu sourc node nodegroup combined_dobj listnodescombinednbootsnboot linkscombinedcnbootsnbootsncolcombin librarynetworkd node_sourc asvectorsortuniquecombined_dobjlinkssourc node_target asvectorsortuniquecombined_dobjlinkstarget node_al uniquecnode_sourc node_target assign id sourc start sourc combined_dobjlinkssourc target combined_dobjlinkstarget fori lengthnode_al sourcesourcenode_ targettargetnode_ combined_dobjlinkssourc asnumericsourc combined_dobjlinkstarget asnumerictarget combined_dobjlinkslinkcolor combinednodegroup prepar node info node_df dataframenodenode_al node_dfid asnumericc lengthnode_al suppressmessageslibrarydplyr color combin countnod colornodegroup select node_dfcolor colorcolor suppressmessageslibrarynetworkd psankeynetworklink combined_dobjlink node node_df valu valu nodegroup color linkgroup linkcolor nodeidnod sourcesourc targettarget fontsiz p savenetworkp file pastepathsubpopulation_nethtml plot relationship cluster two sampl look one exampl use case find relationship cluster within one sampl two sampl r prediction_two_sampleswarn fals messag fals figwidth run predict cluster cluster_mixedpop coldatamixedpop cluster_mixedpop coldatamixedpop row_clust lengthuniquecoldatamixedpop c_selectid top gene marker distinguish cluster gene degenesid lsolda_dat bootstrap_predictionnboot mixedpop mixedpop mixedpop mixedpop genesgen c_selectid listdata list cluster_mixedpop cluster_mixedpop cluster_mixedpop cluster_mixedpop c_selectid gene degenesid lsolda_dat bootstrap_predictionnboot mixedpop mixedpop mixedpop mixedpop genesgen c_selectid listdata list cluster_mixedpop cluster_mixedpop cluster_mixedpop cluster_mixedpop c_selectid gene degenesid lsolda_dat bootstrap_predictionnboot mixedpop mixedpop mixedpop mixedpop genesgen c_selectid listdata list cluster_mixedpop cluster_mixedpop cluster_mixedpop cluster_mixedpop prepar tabl input sankey plot lasso_c reformat_lassoc_selectid mp_selectid lsolda_datlsolda_dat npredsubpop row_clust nodes_group b lasso_c reformat_lassoc_selectid mp_selectid lsolda_datlsolda_dat npredsubpop row_clust nodes_group lasso_c reformat_lassoc_selectid mp_selectid lsolda_datlsolda_dat npredsubpop row_clust nodes_group ea combin rbindlasso_cslasso_cslasso_c nboot link sourc target valu sourc node nodegroup combined_dobj listnodescombinednbootsnboot linkscombinedcnbootsnbootsncolcombin combin combinedisnacombinedvalu true librarynetworkd node_sourc asvectorsortuniquecombined_dobjlinkssourc node_target asvectorsortuniquecombined_dobjlinkstarget node_al uniquecnode_sourc node_target assign id sourc start sourc combined_dobjlinkssourc target combined_dobjlinkstarget fori lengthnode_al sourcesourcenode_ targettargetnode_ combined_dobjlinkssourc asnumericsourc combined_dobjlinkstarget asnumerictarget combined_dobjlinkslinkcolor combinednodegroup prepar node info node_df dataframenodenode_al node_dfid asnumericc lengthnode_al suppressmessageslibrarydplyr n lengthuniquenode_dfnod getpalett colorramppalettercolorbrewerbrewerp set color getpaletten node_dfcolor color suppressmessageslibrarynetworkd psankeynetworklink combined_dobjlink node node_df valu valu nodegroup color linkgroup linkcolor nodeidnod sourcesourc targettarget fontsiz p savenetworkp file pastepathsubpopulation_nethtml r session_info includetru echotru resultsmarkup devtoolssession_info gener roxygen edit hand pleas edit document rmainlassoldatrainingr namebootstrap_predict aliasbootstrap_predict titlebootstrap run scgp train predict usag bootstrap_predict nboot gene gene mixedpop mixedpop mixedpop mixedpop c_selectid null listdata list cluster_mixedpop null cluster_mixedpop null trainset_ratio lda_run true verbos fals log_transform fals argument itemnbootsa number specifi mani bootstrap run itemgenesa gene list build model itemmixedpopa linksclasssinglecellexperi object mix popul train itemmixedpopa linksclasssinglecellexperi object target mix popul predict itemc_selectidth root cluster mixedpop becompar cluster mixedpop itemlistdataa codelist object contain train result first mix popul itemcluster_mixedpopa vector cluster assign mixedpop itemcluster_mixedpopa vector cluster assign mixedpop itemtrainset_ratioa number specifi proport cell part train subpopul itemlda_runlog lda predict ad compar elasticnet itemverbosea logic whether display addit messag itemlog_transformboolean whether log transform comput valu codelist predict result written index codeout_idx descript elasticnet lda predict subpopul new mix popul train model subpopul first mix popul number bootstrap run specifi exampl day day__cardio_cell_sampl mixedpop new_scgps_objectexpressionmatrix daydat_count genemetadata daydatgeneinfo cellmetadata daydat_clust day day__cardio_cell_sampl mixedpop new_scgps_objectexpressionmatrix daydat_count genemetadata daydatgeneinfo cellmetadata daydat_clust gene training_gene_sampl gene genesmerged_uniqu cluster_mixedpop coldatamixedpop cluster_mixedpop coldatamixedpop c_selectid test bootstrap_predictionnboot mixedpop mixedpop mixedpop mixedpop genesgen listdata list cluster_mixedpop cluster_mixedpop cluster_mixedpop cluster_mixedpop c_selectid c_selectid namestest testelasticnetpredict testldapredict seealso codelinkbootstrap_parallel parallel option author quan nguyen gener roxygen edit hand pleas edit document rcore_clustering_baggingr namecore_bag aliascore_bag titlemain cluster score core v stabl cluster optim resolut bag bootstrap usag core_bag mixedpop null bagging_run subsample_proport window seqfrom remove_outli c nround pca fals npc ngene log_transform fals argument itemmixedpopi linksclasssinglecellexperi object train mix popul itembagging_runan integ specifi number bag run comput itemsubsample_proportiona numer specifi proport tree chosen subsampl itemwindowsa numer vector specifi rang window itemremove_outliera vector contain id cluster remov default vector contain cluster singleton itemnroundsan integ specifi number round attempt remov outlier itempcalog specifi pca use calcul distanc matrix itemnpcsan integ specifi number princip compon use itemngenesnumb gene use cluster calcul itemlog_transformboolean whether log transform comput valu codelist cluster result iter select optim resolut descript core algorithm gener reproduci cluster core first implement ascend r packag core v use bag analysi find stabl cluster result detect rare cluster mix popul exampl day day__cardio_cell_sampl cellnamescolnamesdaydat_count cluster daydat_clust cellnam dataframeclust cluster cellbarcod cellnam daydat_count need matrix format mixedpop new_summarized_scgps_objectexpressionmatrix daydat_count genemetadata daydatgeneinfo cellmetadata daydat_clust test core_baggingmixedpop remove_outli c pcafals bagging_run subsample_proport author quan nguyen gener roxygen edit hand pleas edit document rutilitiesr nameannotate_clust aliasannotate_clust titleannotate_clust function annot identifi cluster usag annotate_clust degenelist pvaluecutoff gene_symbol true speci human argument itemdegenelisti vector gene symbol convert entrezid itempvaluecutoffi numer cutoff p valu itemgene_symbollog whether genelist gene symbol itemspeciesi select human mous default human gene valu write enrich test output file enrich test object plot descript often need label cluster uniqu biolog charact one common approach annot cluster perform function enrich analysi annot implement reactomepa clusterprofil analysi type r function requir instal sever databas describ exampl gene training_gene_sampl gene genesmerged_uniqueseq_len enrichment_test annotate_clustersgen pvaluecutoff gene_symboltru speci human clusterprofilerdotplotenrichment_test showcategori gener roxygen edit hand pleas edit document rcore_clusteringr namecore_clust aliascore_clust titlemain cluster core v updat usag core_clust mixedpop null window seqfrom remove_outli c nround pca fals npc ngene verbos fals log_transform fals argument itemmixedpopi linksclasssinglecellexperi object train mix popul itemwindowsa numer specifi number window test itemremove_outliera vector contain id cluster remov default vector contain cluster singleton itemnroundsan integ specifi number round attempt remov outlier itempcalog specifi pca use calcul distanc matrix itemnpcsan integ specifi number princip compon use itemngenesnumb gene use cluster calcul itemverbosea logic whether display addit messag itemlog_transformboolean whether log transform comput valu codelist cluster result iter select optim resolut descript core algorithm gener reproduci cluster core first implement ascend r packag core v introduc sever new function includ three key featur fast memori effici implement c paralellis option allow cluster hundr thousand cell ongo develop outlier revom import singleton exist done number dimension reduct method includ imput implement cidr confirm cluster result done option select number optimis tree height window increas resolut exampl day day__cardio_cell_sampl daydat_count need matrix format cellnam colnamesdaydat_count cluster daydat_clust cellnam dataframeclusterclust cellbarcod cellnam mixedpop new_summarized_scgps_objectexpressionmatrix daydat_count genemetadata daydatgeneinfo cellmetadata daydat_clust test core_clusteringmixedpop remove_outli c pcafals npc ngene author quan nguyen gener roxygen edit hand pleas edit document rrcppexportsr namecalcdistarma aliascalcdistarma titlecomput euclidean distanc matrix row usag calcdistarmax argument itemxa numer matrix valu distanc matrix descript comput euclidean distanc matrix row exampl mat_test matrixrnbinommu sizenrow librarymicrobenchmark microbenchmarkcalcdistarmamat_test distmat_test time gener roxygen edit hand pleas edit document rcore_clusteringr namesub_clust aliassub_clust titlesub_clust select cell usag sub_clust object null ngene window seqfrom select_cell_index null argument itemobjecti linksclasssinglecellexperi object train mix popul itemngenesnumb gene use cluster calcul itemwindowsa numer vector specifi rang window itemselect_cell_indexa vector contain index cell select cluster reclust valu cluster result descript perform cluster run depend window exampl day day__cardio_cell_sampl mixedpop new_summarized_scgps_objectexpressionmatrix daydat_count genemetadata daydatgeneinfo cellmetadata daydat_clust test_sub_clust sub_clusteringmixedpop select_cell_index cseq_len author quan nguyen gener roxygen edit hand pleas edit document rscgps_prediction_summaryr namesummary_accuraci aliassummary_accuraci titleget percent accuraci lasso model coden bootstrap usag summary_accuracyobject null argument itemobjecti list contain train result codesummary_accuraci summaris coden bootstrap valu vector percent accuraci select subpopul descript train result codetrain written exampl c_selectid day day__cardio_cell_sampl mixedpop new_scgps_objectexpressionmatrix daydat_count genemetadata daydatgeneinfo cellmetadata daydat_clust day day__cardio_cell_sampl mixedpop new_scgps_objectexpressionmatrix daydat_count genemetadata daydatgeneinfo cellmetadata daydat_clust gene training_gene_sampl gene genesmerged_uniqu lsolda_dat bootstrap_predictionnboot mixedpop mixedpop mixedpop mixedpop genesgen c_selectid listdata list cluster_mixedpop coldatamixedpop cluster_mixedpopcoldatamixedpop summary_accuracylsolda_dat summary_deviancelsolda_dat author quan nguyen gener roxygen edit hand pleas edit document rscgps_prediction_summaryr namesummary_prediction_lda aliassummary_prediction_lda titleget percent devianc explain lda model coden bootstrap usag summary_prediction_ldalsolda_dat null npredsubpop null argument itemlsolda_dati list contain train result codetrain itemnpredsubpopi number subpopul target mix popul valu datafram conta inform lda predict result column contain predict result subpopul bootstrap run descript train result codetrain written object codelsolda_dat codesummary_predict summaris predict explain coden bootstrap run also return best devianc matrix plot well best matrix lasso gene coeffici exampl c_selectid day day__cardio_cell_sampl mixedpop new_scgps_objectexpressionmatrix daydat_count genemetadata daydatgeneinfo cellmetadata daydat_clust day day__cardio_cell_sampl mixedpop new_scgps_objectexpressionmatrix daydat_count genemetadata daydatgeneinfo cellmetadata daydat_clust gene training_gene_sampl gene genesmerged_uniqu lsolda_dat bootstrap_predictionnboot mixedpop mixedpop mixedpop mixedpop genesgen c_selectid listdata list cluster_mixedpop coldatamixedpop cluster_mixedpopcoldatamixedpop summary_prediction_ldalsolda_datlsolda_dat npredsubpop gener roxygen edit hand pleas edit document rtraining_gene_sampl doctypedata nametraining_gene_sampl aliastraining_gene_sampl titleinput gene list train pkgscgp eg differenti express gene format list instanc contain count matrix vector cluster inform sourc dr joseph powel laboratori imb uq usag training_gene_sampl valu vector contain gene symbol descript gene order least import gene row per gene author quan nguyen keyworddataset gener roxygen edit hand pleas edit document rcore_clusteringr namecore_subclust aliascore_subclust titlesub_clust option run core test usag core_subclust mixedpop null window seqfrom select_cell_index null ngene argument itemmixedpopi linksclasssinglecellexperi object train mix popul itemwindowsa numer specifi number window test itemselect_cell_indexa vector contain index cell select cluster reclust itemngenesnumb gene use cluster calcul valu codelist cluster result iter select optim resolut descript core_subclust allow reclust core cluster result exampl day day__cardio_cell_sampl mixedpop new_summarized_scgps_objectexpressionmatrix daydat_count genemetadata daydatgeneinfo cellmetadata daydat_clust test core_clusteringmixedpopremove_outli c author quan nguyen gener roxygen edit hand pleas edit document rrcppexportsr namemean_cpp aliasmean_cpp titlecalcul mean usag mean_cppx argument itemxinteg valu scalar valu descript calcul mean exampl mean_cppseq_len gener roxygen edit hand pleas edit document rrcppexportsr namesubset_cpp aliassubset_cpp titlesubset matrix usag subset_cppmin rowidx_in colidx_in argument itemminan r matrix express matrix itemrowidx_ina numer vector row keep itemcolidx_ina numer vector column keep valu subset matrix descript subset matrix exampl mat_test matrixrnbinommu sizenrow subset_mat subset_cppmat_test rowidx_inc colidx_inc dimsubset_mat gener roxygen edit hand pleas edit document rrcppexportsr nameprincomp_cpp aliasprincomp_cpp titleprincip compon analysi usag princomp_cppx argument itemxan r matrix express matrix row gene column cell valu list three list pca list descript function provid signific speed gain input matrix big exampl mat_test matrixrnbinommu sizenrow librarymicrobenchmark microbenchmarkprincomp_cppmat_test prcompmat_test time gener roxygen edit hand pleas edit document rday__cardio_cell_sampl doctypedata nameday__cardio_cell_sampl aliasday__cardio_cell_sampl titleon two exampl singlecel count matric use pkgscgp predict format list instanc contain count matrix vector cluster inform sourc dr joseph powel laboratori imb uq usag day__cardio_cell_sampl valu list name day descript count data set contain count gene cell row per gene randomli subsampl day cardiodifferenti popul vector cluster inform contain correspond cell count matrix author quan nguyen keyworddataset gener roxygen edit hand pleas edit document rmainlassoldatrainingr nametrain aliastrain titlemain model train function find best model characteris subpopul usag train gene null cluster_mixedpop null mixedpop null mixedpop null c_selectid null listdata list out_idx standard true trainset_ratio lda_run fals log_transform fals argument itemgenesa vector gene name elasticnet shrinkag gene symbol must format gene name subpop note gene list order import eg differenti express gene significan gene list contain mani gene top gene use itemcluster_mixedpopa vector cluster assign mixedpop itemmixedpopi linksclasssinglecellexperi object train mix popul itemmixedpopi linksclasssinglecellexperi object target mix popul itemc_selectida select number specifi subpopul use train itemlistdatalist store output itemout_idxa number specifi index write result list output need run bootstrap itemstandardizea logic valu specifi whether standard train matrix itemtrainset_ratioa number specifi proport cell part train subpopul itemlda_runlog lda run ad compar elasticnet itemlog_transformboolean whether log transform comput valu codelist predict result written index codeout_idx descript train haft cell find optim elasticnet lda model predict subpopul exampl c_selectid out_idx day day__cardio_cell_sampl mixedpop new_scgps_objectexpressionmatrix daydat_count genemetadata daydatgeneinfo cellmetadata daydat_clust day day__cardio_cell_sampl mixedpop new_scgps_objectexpressionmatrix daydat_count genemetadata daydatgeneinfo cellmetadata daydat_clust gene training_gene_sampl gene genesmerged_uniqu listdata traininggen cluster_mixedpop coldatamixedpop mixedpop mixedpop mixedpop mixedpop c_selectid listdata list out_idxout_idx trainset_ratio nameslistdata listdataaccuraci author quan nguyen gener roxygen edit hand pleas edit document rmainlassoldatrainingr namebootstrap_parallel aliasbootstrap_parallel titlebootstrap run scgp train predict parallel option usag bootstrap_parallel ncore nboot gene gene mixedpop mixedpop mixedpop mixedpop c_selectid listdata list cluster_mixedpop null cluster_mixedpop null argument itemncoresa number specifi mani cpu use run itemnbootsa number specifi mani bootstrap run itemgenesa gene list build model itemmixedpopa linksclasssinglecellexperi object mix popul train itemmixedpopa linksclasssinglecellexperi object target mix popul predict itemc_selectidth root cluster mixedpop becompar cluster mixedpop itemlistdataa codelist object contain train result first mix popul itemcluster_mixedpopa vector cluster assign mixedpop itemcluster_mixedpopa vector cluster assign mixedpop valu codelist predict result written index codeout_idx descript bootstrap_predict multicor option exampl day day__cardio_cell_sampl mixedpop new_scgps_objectexpressionmatrix daydat_count genemetadata daydatgeneinfo cellmetadata daydat_clust day day__cardio_cell_sampl mixedpop new_scgps_objectexpressionmatrix daydat_count genemetadata daydatgeneinfo cellmetadata daydat_clust gene training_gene_sampl gene genesmerged_uniqu prl_boot bootstrap_parallelncor nboot genesgen mixedpop mixedpop mixedpop mixedpop c_selectid listdata list prl_bootselasticnetpredict prl_bootsldapredict author quan nguyen gener roxygen edit hand pleas edit document rutilitiesr namefind_mark aliasfind_mark titlefind marker gene usag find_mark expression_matrix null cluster null selected_clust null fittyp local dispersion_method percondit sharing_mod maximum argument itemexpression_matrixi normalis express matrix itemclustercorrespond cluster inform expression_matrix run core cluster use method itemselected_clustera vector uniqu cluster id calcul itemfittypestr specifi local parametr deseq dispers estim itemdispersion_methodon option c pool pooledcr percondit blind itemsharing_modeon option cmaximum fitonli geneestonli valu codelist contain sort deseq analysi result descript find de gene compar one clust vs remain exampl day day__cardio_cell_sampl mixedpop new_scgps_objectexpressionmatrix daydat_count genemetadata daydatgeneinfo cellmetadata daydat_clust depend data deseqestimatedispers function requir suitabl fittyp dispersion_method option degen find_markersexpression_matrixassaymixedpop cluster coldatamixedpop selected_clusterc also run one cluster egselected_clust c fittyp parametr dispersion_method blind sharing_modefitonli namesdegen author quan nguyen gener roxygen edit hand pleas edit document rrcppexportsr namecalcdist aliascalcdist titlecomput euclidean distanc matrix row usag calcdistx argument itemxa numer matrix valu distanc matrix descript comput euclidean distanc matrix row exampl mat_test matrixrnbinommu sizenrow calcdistmat_test gener roxygen edit hand pleas edit document rscgps_objectr namenew_summarized_scgps_object aliasnew_summarized_scgps_object titlenew_summarized_scgps_object usag new_summarized_scgps_object expressionmatrix null genemetadata null cellmetadata null argument itemexpressionmatrixan express dataset matrix format row repres transcript normalis count column repres individu cell itemgenemetadataa data frame vector contain gene identifi use express matrix first column hold cell identifi use express matrix column contain inform gene correspond ensembl transcript identifi itemcellmetadataa data frame contain cell identifi usual barcod cluster inform first column data frame contain cluster inform column contain cluster inform need name cluster cluster inform avail user run core function add inform scgp run scgp predict valu function gener scgp object belong linksclasssinglecellexperi descript codelinknew_scgps_object gener scgp object linksclasssinglecellexperi class use scgp packag object contain express matrix associ metadata cell gene cluster data expect normalis count exampl day day__cardio_cell_sampl new_summarized_scgps_objectexpressionmatrix daydat_count genemetadata daydatgeneinfo cellmetadata daydat_clust coldatat showt colnamest seealso linksclasssinglecellexperi author quan nguyen gener roxygen edit hand pleas edit document rmainlassoldatrainingr namepredict aliaspredict titlemain predict function appli optim elasticnet lda model usag predict listdata null cluster_mixedpop null mixedpop null out_idx null standard true lda_run fals c_selectid null log_transform fals argument itemlistdataa codelist object contain train result select subpopul first mix popul itemcluster_mixedpopa vector cluster assign mixedpop itemmixedpopa linksclasssinglecellexperi object target mix popul import eg differenti express gene signific itemout_idxa number specifi index write result list output need run bootstrap itemstandardizea logic whether standard data itemlda_runlog lda predict ad compar elasticnet lda model need train train input predict step itemc_selectida number specifi train cluster use predict itemlog_transformboolean whether log transform comput valu codelist predict result written index codeout_idx descript predict new mix popul train model subpopul first mix popul subpopul new target mix popul predict target subpopul transit score orgin subpopul new subpopul exampl c_selectid out_idx day day__cardio_cell_sampl mixedpop new_scgps_objectexpressionmatrix daydat_count genemetadata daydatgeneinfo cellmetadata daydat_clust day day__cardio_cell_sampl mixedpop new_scgps_objectexpressionmatrix daydat_count genemetadata daydatgeneinfo cellmetadata daydat_clust gene training_gene_sampl gene genesmerged_uniqu listdata traininggen cluster_mixedpop coldatamixedpop mixedpop mixedpop mixedpop mixedpop c_selectid listdata list out_idxout_idx listdata predictinglistdata listdata mixedpop mixedpop out_idxout_idx cluster_mixedpop coldatamixedpop c_selectid c_selectid author quan nguyen gener roxygen edit hand pleas edit document rscgps_objectr namenew_scgps_object aliasnew_scgps_object titlenew_scgps_object usag new_scgps_object expressionmatrix null genemetadata null cellmetadata null logmatrix null argument itemexpressionmatrixan express matrix datafram matrix format row repres transcript normalis count column repres individu cell itemgenemetadataa data frame vector contain gene identifi use express matrix first column hold gene identifi use express matrix column contain inform gene correspond ensembl transcript identifi itemcellmetadataa data frame contain cell identifi usual barcod integ repres batch belong column contain cluster inform need first column cellmetadata datafram cluster inform avail user run core function add inform scgp run scgp predict itemlogmatrixopt input log matrix data log matrix suppli one creat object valu function gener scgp object belong linksclasssinglecellexperi descript codelinknew_scgps_object gener scgp object linksclasssinglecellexperi class use scgp packag object contain express matrix associ metadata cell gene cluster data expect normalis count exampl day day__cardio_cell_sampl new_scgps_objectexpressionmatrix daydat_count genemetadata daydatgeneinfo cellmetadata daydat_clust coldatat showt colnamest seealso linksclasssinglecellexperi author quan nguyen gener roxygen edit hand pleas edit document rscgps_prediction_summaryr namesummary_prediction_lasso aliassummary_prediction_lasso titleget percent devianc explain lasso model coden bootstrap usag summary_prediction_lassolsolda_dat null npredsubpop null argument itemlsolda_dati list contain train result codetrain itemnpredsubpopi number subpopul target mix popul valu datafram conta inform lasso predict result column contain predict result subpopul bootstrap run descript train result codetrain written object codelsolda_dat codesummary_predict summaris predict coden bootstrap run exampl c_selectid day day__cardio_cell_sampl mixedpop new_scgps_objectexpressionmatrix daydat_count genemetadata daydatgeneinfo cellmetadata daydat_clust day day__cardio_cell_sampl mixedpop new_scgps_objectexpressionmatrix daydat_count genemetadata daydatgeneinfo cellmetadata daydat_clust gene training_gene_sampl gene genesmerged_uniqu lsolda_dat bootstrap_predictionnboot mixedpop mixedpop mixedpop mixedpop genesgen c_selectid listdata list cluster_mixedpop coldatamixedpop cluster_mixedpopcoldatamixedpop summary_prediction_lassolsolda_datlsolda_dat npredsubpop gener roxygen edit hand pleas edit document rscgps_prediction_summaryr namesummary_devi aliassummary_devi titleget percent devianc explain lasso model coden bootstrap usag summary_devianceobject null argument itemobjecti list contain train result codetrain valu codelist contain three element vector percent maximum devianc explain datafram conta inform full devianc datafram contain gene name coeffici best model descript train result codetrain written object codelsolda_dat codesummary_devid summaris devianc explain coden bootstrap run also return best devianc matrix plot well best matrix lasso gene coeffici exampl c_selectid day day__cardio_cell_sampl mixedpop new_scgps_objectexpressionmatrix daydat_count genemetadata daydatgeneinfo cellmetadata daydat_clust day day__cardio_cell_sampl mixedpop new_scgps_objectexpressionmatrix daydat_count genemetadata daydatgeneinfo cellmetadata daydat_clust gene training_gene_sampl gene genesmerged_uniqu lsolda_dat bootstrap_predictionnboot mixedpop mixedpop mixedpop mixedpop genesgen c_selectid listdata list cluster_mixedpop coldatamixedpop cluster_mixedpopcoldatamixedpop summary_deviancelsolda_dat author quan nguyen gener roxygen edit hand pleas edit document rscgps_prediction_summaryr namereformat_lasso aliasreformat_lasso titlesummaris bootstrap run lasso model coden bootstrap usag reformat_lasso c_selectid null mp_selectid null lsolda_dat null npredsubpop null nodes_group b nboot argument itemc_selectidi origin cluster project itemmp_selectidi target mixedpop project itemlsolda_dati result bootstrap itemnpredsubpopi number cluster target mixedpop coderow_clust lengthuniquetarget_clust itemnodes_groupstr represent hexidecim color code node itemnbootsi integ mani bootstrap run valu datafram conta inform lasso predict result column contain predict result subpopul bootstrap run descript train predict result codebootstrap written object codelsolda_dat codereformat_lasso summaris predict coden bootstrap run exampl c_selectid day day__cardio_cell_sampl mixedpop new_scgps_objectexpressionmatrix daydat_count genemetadata daydatgeneinfo cellmetadata daydat_clust day day__cardio_cell_sampl mixedpop new_scgps_objectexpressionmatrix daydat_count genemetadata daydatgeneinfo cellmetadata daydat_clust gene training_gene_sampl gene genesmerged_uniqu lsolda_dat bootstrap_predictionnboot mixedpop mixedpop mixedpop mixedpop genesgen c_selectid listdata list cluster_mixedpop coldatamixedpop cluster_mixedpopcoldatamixedpop reformat_lassolsolda_datlsolda_dat npredsubpoplengthuniquecoldatamixedpop c_selectid mp_selectid nboot gener roxygen edit hand pleas edit document rrcppexportsr namevar_cpp aliasvar_cpp titlecalcul varianc usag var_cppx bia true argument itemxa vector gene express itembiasdegre freedom valu varianc valu descript calcul varianc exampl var_cppseq_len gener roxygen edit hand pleas edit document rutilitiesr nameplot_reduc aliasplot_reduc titleplot reduc data usag plot_reduc reduced_dat color_fac null dim c dimnam cdim dim pallet null legend_titl cluster argument itemreduced_dati matrix gene row cell column itemcolor_faci vector color correspond cluster determin color scatter plot itemdimsan integ number dimest itemdimnamesa vector name dimens itempalletescan customis color pallet determin color densiti plot null use rcolorbrew colorramppalettercolorbrewerbrewerpalsample_num setsample_num itemlegend_titletitl plot legend valu matrix top cidr dimens descript plot pca tsne cidr reduc dataset exampl day day__cardio_cell_sampl mixedpop new_scgps_objectexpressionmatrix daydat_count genemetadata daydatgeneinfo cellmetadata daydat_clust cidr_dim cidrexpressionmatrixassaymixedpop p plot_reducedcidr_dim color_fac factorcoldatamixedpop pallet seq_lenlengthuniquecoldatamixedpop plotp tsne_dim tsneexpressionmatassaymixedpop p plot_reducedtsne_dim color_fac factorcoldatamixedpop pallet seq_lenlengthuniquecoldatamixedpop plotp gener roxygen edit hand pleas edit document rcore_clustering_baggingr nameclustering_bag aliasclustering_bag titlehc cluster number resolut usag clustering_bag object null ngene bagging_run subsample_proport window seqfrom remove_outli c nround pca fals npc log_transform fals argument itemobjecti linksclasssinglecellexperi object train mix popul itemngenesnumb gene use cluster calcul itembagging_runan integ specifi number bag run comput itemsubsample_proportiona numer specifi proport tree chosen subsampl itemwindowsa numer vector specifi rage window itemremove_outliera vector contain id cluster remov default vector contain cluster singleton itemnroundsa integ specifi number round attempt remov outlier itempcalog specifi pca use calcul distanc matrix itemnpcsan integ specifi number princip compon use itemlog_transformboolean whether log transform comput valu list cluster result contain bag run well cluster origin tree tree descript subsampl cell bag run perform cluster run depend window exampl day day__cardio_cell_sampl mixedpop new_summarized_scgps_objectexpressionmatrix daydat_count genemetadata daydatgeneinfo cellmetadata daydat_clust test clustering_baggingmixedpop remove_outli c bagging_run subsample_proport author quan nguyen gener roxygen edit hand pleas edit document rrcppexportsr namercpp_parallel_dist aliasrcpp_parallel_dist titledist matrix use c usag rcpp_parallel_distancemat argument itemmatan r matrix express matrix row gene column cell valu distanc matrix descript function provid fast memori effici distanc matrix calcul exampl mat_test matrixrnbinommu sizenrow librarymicrobenchmark microbenchmarkrcpp_parallel_distancemat_test distmat_test time gener roxygen edit hand pleas edit document rrcppexportsr namedistvec aliasdistvec titlecomput distanc two vector usag distvecx argument itemxa numer vector itemya numer vector valu numer distanc descript comput distanc two vector exampl x matrixrnbinommu sizenrow x x matrixrnbinommu sizenrow distvecx gener roxygen edit hand pleas edit document rutilitiesr nametop_var aliastop_var titleselect top variabl gene usag top_varexpressionmatrix null ngene argument itemexpressionmatrixi matrix gene row cell column itemngenesnumb gene use cluster calcul valu subset express matrix top n variabl gene descript subset matrix top variabl gene exampl day day__cardio_cell_sampl mixedpop new_scgps_objectexpressionmatrix daydat_count genemetadata daydatgeneinfo cellmetadata daydat_clust sortedexprsmat top_varexpressionmatrixassaymixedpop gener roxygen edit hand pleas edit document rday__cardio_cell_sampl doctypedata nameday__cardio_cell_sampl aliasday__cardio_cell_sampl titleon two exampl singlecel count matric use train pkgscgp model format list instanc contain count matrix vector cluster inform sourc dr joseph powel laboratori imb uq usag day__cardio_cell_sampl valu list name day descript count data set contain count gene cell randomli subsampl day cardiodifferenti popul vector cluster inform contain correspond cell count matrix author quan nguyen keyworddataset gener roxygen edit hand pleas edit document rcore_clusteringr namefind_optimal_st aliasfind_optimal_st titlefind optim cluster usag find_optimal_st list_clust run_randidx bag fals window seqfrom argument itemlist_clustersi codelist object contain cluster result itemrun_randidxi codedata frame object iter cluster run itembaggingi logic true bag perform chang return itemwindowsa numer vector specifi rang window valu bag fals codelist optim stabil cluster count summari stat bag true codelist high re cluster count optim cluster count keystat descript calcul stabil base rand index consecut cluster run find resolut window stabil highest exampl day day__cardio_cell_sampl mixedpop new_summarized_scgps_objectexpressionmatrix daydat_count genemetadata daydatgeneinfo cellmetadata daydat_clust cluster_al clusteringobjectmixedpop stab_df find_stabilitylist_clusterscluster_alllist_clust cluster_ref cluster_allcluster_ref optimal_stab find_optimal_stabilitylist_clust cluster_alllist_clust stab_df bag fals author quan nguyen gener roxygen edit hand pleas edit document rdimreductionr namepca aliaspca titlepca usag pcaexpressionmatrix null ngene scale true npc argument itemexpressionmatrixan express matrix gene row itemngenesnumb gene use cluster calcul itemscalinga logic whether want scale matrix itemnpcsan integ specifi number princip compon use valu list contain pca result varianc explain descript select top variabl gene perform prcomp exampl day day__cardio_cell_sampl mixedpop new_scgps_objectexpressionmatrix daydat_count genemetadata daydatgeneinfo cellmetadata daydat_clust pcaexpressionmatrixassaymixedpop gener roxygen edit hand pleas edit document rcore_clusteringr namefind_st aliasfind_st titlecalcul stabil index usag find_stabilitylist_clust null cluster_ref null argument itemlist_clustersi object iter cluster run itemcluster_refi object refer cluster valu codedata frame stabil score rand_index result descript cluster result compar similar cluster adjust randindex exampl day day__cardio_cell_sampl mixedpop new_summarized_scgps_objectexpressionmatrix daydat_count genemetadata daydatgeneinfo cellmetadata daydat_clust cluster_al clusteringobjectmixedpop stab_df find_stabilitylist_clusterscluster_alllist_clust cluster_ref cluster_allcluster_ref author quan nguyen gener roxygen edit hand pleas edit document rdimreductionr nametsn aliastsn titletsn usag tsne expressionmat null topgen scale true thet perp argument itemexpressionmatan express matrix gene row itemtopgenesnumb gene use cluster calcul itemscalea logic whether want scale matrix itemthetnumer speedaccuraci tradeoff increas less accuraci itemperpnumer perplex paramet bigger perplex nrowx see detail interpret valu tsne reduc matrix contain three tsne dimens descript calcul tsne top variabl gene exampl day day__cardio_cell_sampl mixedpop new_scgps_objectexpressionmatrix daydat_count genemetadata daydatgeneinfo cellmetadata daydat_clust tsneexpressionmat assaymixedpop gener roxygen edit hand pleas edit document rcore_clusteringr nameplot_optimal_cor aliasplot_optimal_cor titleplot one singl tree optim cluster result usag plot_optimal_cor original_tre optimal_clust null shift valu null argument itemoriginal_treea dendrogram object itemoptimal_clustera vector cluster id cell dendrogram itemshifta numer specifi gap dendrogram color itemvaluesa vector contain color valu branch color bar underneath tree bar underneath dendrogram paramet allow better select color display valu plot color brach bar optim cluster result descript optim cluster identifi user may use function plot result dendrogram branch color repres cluter result exampl day day__cardio_cell_sampl mixedpop new_summarized_scgps_objectexpressionmatrix daydat_count genemetadata daydatgeneinfo cellmetadata daydat_clust core_clust core_clusteringmixedpop remove_outli c key_height core_clusteroptimalclustkeystatsheight optimal_r core_clusteroptimalclustoptimalr optimal_index whichkey_height optimal_r plot_optimal_coreoriginal_tre core_clustertre optimal_clust unlistcore_clusterclusteroptimal_index shift author quan nguyen gener roxygen edit hand pleas edit document rrcppexportsr nametp_cpp aliastp_cpp titletranspos matrix usag tp_cppx argument itemxan r matrix express matrix valu transpos matrix descript transpos matrix exampl mat_test matrixrnbinommu sizenrow tp_mat tp_cppmat_test gener roxygen edit hand pleas edit document rcore_clusteringr namerand_index aliasrand_index titlecalcul rand index usag rand_indextab adjust true argument itemtaba tabl contain differ cluster result row itemadjusta logic whether use adjust rand index valu rand_index valu descript compar cluster result function calcul randindex adapt function steve horvath luohua jiang ucla exampl day day__cardio_cell_sampl mixedpop new_summarized_scgps_objectexpressionmatrix daydat_count genemetadata daydatgeneinfo cellmetadata daydat_clust cluster_al clusteringobjectmixedpop rand_indextableunlistcluster_alllist_clust cluster_allcluster_ref author quan nguyen michael thompson gener roxygen edit hand pleas edit document rcore_clusteringr nameplot_cor aliasplot_cor titleplot dendrogram tree core result usag plot_coreoriginaltre list_clust null color_branch null argument itemoriginaltreeth origin dendrogram cluster itemlist_clustersa list contain cluster result itemcolor_branchi vector contain userspecifi color number uniqu color equal larger number cluster paramet allow better select color display valu plot cluster bar underneath tree descript function plot core cluster result underneath exampl day day__cardio_cell_sampl cellnam colnamesdaydat_count cluster daydat_clust cellnam dataframeclusterclust cellbarcod cellnam mixedpop new_summarized_scgps_objectexpressionmatrix daydat_count genemetadata daydatgeneinfo cellmetadata cellnam core_clust core_clusteringmixedpop remove_outli c plot_corecore_clustertre core_clusterclust gener roxygen edit hand pleas edit document rrcppexportsr namercpp_eucl_distance_notpar aliasrcpp_eucl_distance_notpar titlefunct calcul eucledean distanc matrix without parallelis usag rcpp_eucl_distance_notparmat argument itemmatan r matrix express matrix cell row gene column valu distanc matrix descript function calcul eucledean distanc matrix without parallelis exampl mat_test matrixrnbinommu sizenrow librarymicrobenchmark microbenchmarkrcpp_eucl_distance_notparmat_test distmat_test time gener roxygen edit hand pleas edit document rutilitiesr nameadd_import aliasadd_import titleadd_import descript import packag namespac gener roxygen edit hand pleas edit document rcore_clusteringr nameclust aliasclust titlehc cluster number resolut usag cluster object null ngene window seqfrom remove_outli c nround pca fals npc verbos fals log_transform fals argument itemobjecti linksclasssinglecellexperi object train mix popul itemngenesnumb top variabl gene use itemwindowsa numer specifi number window test itemremove_outliera vector contain id cluster remov default vector contain cluster singleton itemnroundsnumb iter remov select cluster itempcalog specifi pca use calcul distanc matrix itemnpcsnumb princip compon pca dimension reduct use itemverbosea logic whether display addit messag itemlog_transformboolean whether log transform comput valu cluster result descript perform cluster run depend window exampl day day__cardio_cell_sampl mixedpop new_summarized_scgps_objectexpressionmatrix daydat_count genemetadata daydatgeneinfo cellmetadata daydat_clust test clusteringmixedpop remove_outli c author quan nguyen