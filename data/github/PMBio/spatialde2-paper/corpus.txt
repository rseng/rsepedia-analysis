titl figur output html_document setup r knitr_setup cachefals echofals resultshid libraryknitr cachedir cach opts_chunksetcachetru autodeptru devcpng cairo_pdf svglite dpi figpathplot figwidth figheight devargslistsystem_fontslistsanshelvetica cachepathcachedir figkeephigh tidystyl warningfals messagefals optionswidth r setup cachefals messagefals librarytibbl librarydplyr librarytidyr librarymagrittr librarypurrr libraryggplot libraryggsci libraryreticul libraryarrow th theme_bw thlines threctsiz thpanelgridminor element_blank thpanelbordercolour black thaxistickscolour black thaxistext element_text thlegendtext element_text thstriptextcolour listnul thstriptexts listnul thplottitlehjust thplottitles listnul thaspectratio theme_setth guide_fcolorbar functionguide_colourbarframecolourblack tickscolourblack scale_color_discret scale_colour_discret function scale_color_startrek scale_color_brew paletteset scale_fill_discret function scale_fill_startrekscale_fill_brew paletteset update_geom_defaultspoint listshap size update_geom_defaultspath listsiz update_geom_defaultssmooth listsiz colorblack update_geom_defaultsrect listsiz update_geom_defaultstext listsizethtexts pt update_geom_defaultsviolin listcolorblack update_geom_defaultsboxplot listcolorblack update_geom_defaultstext_repel listsizethtexts pt setse python score_test_simul messagefals resultshid import sy syspathappendhomekatsspatiald import spatiald import numpi np import scipi import panda pd import anndata ad import gpflow rng nprandomdefault_rngse npoints_per_dim npoint npoints_per_dim coord npstacktupleireshap npmeshgridnparangenpoints_per_dim nparangenpoints_per_dim indexingij axi rngnormalscal sizenpoint nsampl dispers sigma sizefactor rngrandomnpoint mean sizefactor var mean dispers mean r nprepeatdispers npoint p var mean var samples_nul rngnegative_binomialnprepeatr npnewaxi nsampl axi p npnewaxi adata_nul adanndatasamples_nul adata_nullobsmspati coord results_null_cauchi spatialdetestadata_nul results_null_omnibu spatialdetestadata_nul omnibustru python score_test_simulation_alt echofals evalfals distanc scipyspatialdistance_matrixcoord coord max_dist npmaxdist npfill_diagonaldist npinf min_dist npmindist lengthscal nplogspacenplog min_dist nplogmax_dist kernel gpflowkernelssquaredexponentiallengthscalesl l lengthscal kernelmat kkcoordsnumpi k kernel samples_alt npfullnpoint nsampl nplogm rangensampl samples_alti rngmultivariate_normalnpzerosnpoint sigma kernelmatsrngchoicelenkernel samples_alt npexpsamples_alt sizefactor npnewaxi var samples_alt dispers samples_alt r samples_alt var samples_alt p var samples_alt var samples_alt rngnegative_binomialr p adata_alt adanndatasamples_alt adata_altobsmspati coord results_alt_cauchi spatialdetestadata_alt kernel_spaces lengthscal results_alt_omnibu spatialdetestadata_alt omnibustru kernel_spaces lengthscal r get_python_data dependsonscore_test_simul simul bind_rowsmutatepyresults_null_cauchi methodcauchi mutatepyresults_null_omnibu methodomnibu r figure_a figheight figwidth group_bysimul method mutateexpectedrow_numberpv n ggplotaesexpect pval colormethod geom_ablineslop colorlightgray geom_point labsxexpect pvalu yobserv pvalu colornul scale_x_loglimitsc expandexpans labelsscaleslabel_mathformatlog scale_y_loglimitsc expandexpans labelsscaleslabel_mathformatlog guidescolorguide_legendoverrideaeslists scale_color_startreklabelsccauchycauchi combin omnibusomnibu r read_data ad importanndata make_benchmark_summari functionbench group_by_atbench varspval padj gene group_modifyfunctionx map_dfrseq functionnfdr idx whichxgen power sumxpadjidx nfdr lengthidx fdr sumxpadjidx nfdr sumxpadj nfdr tibblenominal_fdrnfdr fdrfdr powerpow ungroup method_nam mutatemethod_namerecodemethod omnibusomnibu cauchycauchi combin sparkspark spark_nocheckpositivespark eigenvalu clip spatialdespatiald bench readrdsbenchmarkssparsim_benchmark_rep_rd method_nam mutatefoldchangel asintegerfoldchang lengthscaleidxasintegerlengthscal padjif_elseisnapadj padj padj selectpadj lengthscal as_tibbl bench pmap_dfrlistuniquebenchlengthscaleidx functionlengthscaleidx adata adread_hadfilepathsimul pastecl_mouse_brain_lengthscale_ lengthscaleidx _fc__rep_had backedr tibblelengthscaleadataunssimulation_paramslengthscal idlengthscaleidx mutatelengthscaleidxasintegerlengthscaleidx inner_joinbench bench_summary_default make_benchmark_summarybench r figureb figwidth figheight filterbench_summary_default nominal_fdr foldchang ggplotaeslengthscal power colormethod_nam geom_lin geom_point scale_y_continuouslimitsc expandexpans guidescolorguide_legendtitlenul overrideaeslists r figurec figwidth figheight singl readrdstests_runtime_coresrd mutatecor core multi readrdstests_runtime_coresrd mutatecor core gpu readrdstests_runtime_gpurd mutatecoresgpu speed_bench bind_rowssingl multi gpu method_nam ggplotspeed_bench aesnpoint colormethod_nam geom_lineaesytim facet_wrapcor nrow scale_y_lognametim min labelsscaleslabel_mathformatlog geom_lineaesytim colorgray linetypedash datadataframenpoint mutatetim npoint geom_lineaesytim colorgray linetypetwodash datadataframenpoint mutatetim npoint annotategeomtext x labeln parsetru annotategeomseg x xend yend colordarkgray annotategeomtext x labeln parsetru annotategeomseg x xend yend colordarkgray labsxnumb locat colornul scale_x_continuouslimitsc na expandexpans guidescolorguide_legendoverrideaeslists r figur e figwidth figheight filterspeed_bench method comnibu spark spatiald mutatemethod_namerecodemethod_nam omnibusspatiald ggplotaesnpoint colormethod_nam geom_lineaesytim facet_wrapcor nrow scale_y_lognametim min labelsscaleslabel_mathformatlog geom_lineaesytim colorgray linetypedash datadataframenpoint mutatetim npoint geom_lineaesytim colorgray linetypetwodash datadataframenpoint mutatetim npoint annotategeomtext x labeln parsetru annotategeomseg x xend yend colordarkgray annotategeomtext x labeln parsetru annotategeomseg x xend yend colordarkgray labsxnumb locat colornul scale_x_continuouslimitsc na expandexpans guidescolorguide_legendoverrideaeslists themelegendpositiontop r figur figwidth figheight clusterspe read_featherclustering_speed_benchmarkfeath mutateclusterspe methodrecodemethod leidenleiden spatialdespatiald coresrecodencor core core gpugpu ggplotaesnpoint time_second colormethod geom_lin facet_wrapcor nrow labsxnumb locat ytime min colornul scale_x_continuouslimitsc na expandexpans guidescolorguide_legendoverrideaeslists themelegendpositiontop