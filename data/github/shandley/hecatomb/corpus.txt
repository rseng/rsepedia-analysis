citat current unpublish work choos use pleas contact rob edward raedwardsgmailcom scott handley shandleywustledu appropri citat anacondaserv badgehttpsanacondaorgbiocondahecatombbadgeslatest_release_datesvghttpsanacondaorgbiocondahecatomb anacondaserv badgehttpsanacondaorgbiocondahecatombbadgesplatformssvghttpsanacondaorgbiocondahecatomb anacondaserv badgehttpsanacondaorgbiocondahecatombbadgeslicensesvghttpsanacondaorgbiocondahecatomb document statushttpsreadthedocsorgprojectshecatombbadgeversionlatesthttpshecatombreadthedocsioenlatestbadgelatest anacondaserv badgehttpsanacondaorgbiocondahecatombbadgesdownloadssvghttpsanacondaorgbiocondahecatomb anacondaserv badgehttpsanacondaorgbiocondahecatombbadgesinstallercondasvghttpscondaanacondaorgbioconda docsimghecatomblogopng hecatombhttpsenwiktionaryorgwikihecatomb great sacrific extens loss heactomb softwar empow analyst make data driven decis sacrific falseposit viral read metagenom enrich trueposit viral read process frequent result great loss suspect viral sequenc contig detail pipelin overview instal usag customis instruct pleas refer document host read docshttpshecatombreadthedocsio quick start guid run hpc hecatomb power snakemakehttpssnakemakereadthedocsioenst greatli benefit use snakemak profil hpc cluster inform exampl set snakemak profil hecatomb documentationhttpshecatombreadthedocsioenlatestprofil instal bash creat conda env instal conda creat n hecatomb c condaforg c bioconda hecatomb activ conda env conda activ hecatomb check instal hecatomb h download databas local use thread default hecatomb instal hpc use profil name slurm hecatomb instal profil slurm run test dataset bash local use thread gb ram default hecatomb run test hpc use profil name slurm hecatomb run test profil slurm current limit hecatomb current design work pairedend read consid make branch singleend read current avail specifi directori read read hecatomb expect pair sequenc read format samplename_rrfastqgz eg text sample_rfastqgz sample_rfastqgz sample_rfastqgz sample_rfastqgz specifi tsv file read hecatomb expect column tab separ file first column specifi sampl name column rel full path forward revers read file eg text sampl pathtoreadssamplefastqgz pathtoreadssamplefastqgz sampl pathtoreadssamplefastqgz pathtoreadssamplefastqgz depend depend need get run hecatomb condahttpsdocscondaioenlatest hecatomb reli condahttpsdocscondaioenlatest mambahttpsgithubcommambaorgmamba ensur portabl eas instal depend hecatomb depend instal instal runtim dont worri thing link hecatomb biotoolshttpsbiotoolshecatomb hecatomb workflowhubhttpsworkflowhubeuworkflow current conda build recip hecatomb current host httpsanacondaorgbeardymcjohnfacehttpsanacondaorgbeardymcjohnfac bash hecatombbuild conda build hecatomb depend make sure use python obvious need snakemak otherwis need specifi mamba snakemak build conda env rule pysam plotli snakemak run rule cant specifi env build depend instal repo download unpack conda env copi content bin snakemak requir run pipelin test_data file copi requir run hecatomb test also copi doc mkdocsyaml user want build local copi document would need separ instal mkdoc requir use build conda env would gener bioconda instal use check depend version etc bioconda instal edward labhttpsimgshieldsiobadgebioinformaticsedwardslabafhttpsedwardssdsueduresearch licens mithttpsimgshieldsiobadgelicensemityellowsvghttpsopensourceorglicensesmit github languag counthttpsimgshieldsiogithublanguagescountshandleyhecatomb snakemak implement hecatomb snakemakehttpssnakemakereadthedocsio default implement hecatomb pleas refer documentationhttpshecatombreadthedocsioenlatest instal usag script histor reason unlik use user default instal conda build hecatomb primer_statssh bash script compil statist primer detect step_ contaminant_removalsmk script automat call primer_statsr final multijoin note need tidyversehttpswwwtidyverseorg instal part work script output two tsv file use determin primer detect sampl snakemak hecatomb pipelin power snakemakehttpssnakemakereadthedocsio make extens use condahttpsdocscondaioenlatest come preconfigur includ launcher script make run pipelin simpl chose use snakemak workflow manag larg extens experi snakemak lot heavi lift make live easier pipelin better manag pipelin job well gener benchmark report everyth allow pipelin natur reentrant parallel portabl robust containeris mani buzzword imghecatombsnakemakepng overview pipelin consist three main section read preprocess viru identif assembl imghecatombpipelinepng preprocess heactomb design perform rigor qualiti control prior assembl taxonom assign rigor justifi primarili philosophi garbag garbag outhttpsenwikipediaorgwikigarbage_in_garbage_out specif follow issu dealt ensur noncontaminat biolog sequenc use downstream analysi nonbiolog sequenc remov primer adapt host sequenc remov remov redund sequenc cluster creation sequenc count tabl calcul sequenc properti eg gc content tetram frequenc hecatomb come number host genom use preprocess bespok host genom ad user viru identif hecatomb use mmseq assign taxonomi individu sequenc iter search approach larg part heart hecatomb first search take queri seqeunc seqtabl preprocess step queri viru protein target databas initi search translat nttoaa search read assign viral taxonomi first search need confirm truli viral origin issu queri target databas consist sole viral protein permit sequenc see realli origin differ domain life sequenc may classifi viral stage queri comprehens sequenc databas consist bacteria plant vertebr fungi etc sequenc may higher statist similar sequenc domain life formal possibl secondari search skip first step queri sequenc virusonli protien databs howev comput expens exampl e read queri input sequenc seqtabl queri virusonli protien databas e entri order magnitud smaller uniref entri written primari search virusonli databas serv net rel quickli captur sequenc interest experi howev secondari search larger databas still requir mani sequenc assign viral taxonomi queri smaller virusonli sequenc databas reveal entir someth els upon secondari search thu iter approach expedit sampl process captur small portion input sequenc potenti viral confirm secondari search like viral process wherein sequenc classifi viral first search virusonli databas longer classfi viral second search comprehens databas hecatomb get namesak mani investig particularli lack access larg comput infrastructur reli result primari search due rel small target databas size done commod hardwar examin result stage regularli identifi larg number virus basic anyth level sequenc ident viral protein call viral even sequenc origin bacteria plant fungi organ sequenc sacrif secondari search mani viral call first search lost assembl preprocess rule also goe ahead assembl contig import prerequisit mani downstream analysi assembl strategi consist sever step intend resourc effici maximis represent present speci first individu megahithttpsgithubcomvoutcnmegahit assembl produc sampl read map combin assembl unmap read undergo anoth round assembl contig combin merg nonredund set contig flyehttpsgithubcomfenderglassfly assembl contig directli annot mmseq assembl also subject pseudo consensu annot approach wherebi seqtabl sequenc map taxonom assign bigtabl combin read map inform find use investig origin contig interest command hecatomb instal instal databas need hecatomb run run pipelin hecatomb listhost list currentlyavail host genom hecatomb addhost add host genom hecatomb config copi default config file current directori use configfil input hecatomb current design work pairedend read either specifi directori read hecatomb infer sampl name forwardrevers file specifi tsv file explicitli assign sampl name point correspond read file either case use read hecatomb figur file directori specifi directori read eg hecatomb run read readdir hecatomb expect pair sequenc read format samplename_rrfastqgz eg text sample_rfastqgz sample_rfastqgz sample_rfastqgz sample_rfastqgz specifi tsv file eg hecatomb run read samplestsv hecatomb expect column tab separ file first column specifi sampl name column rel full path forward revers read file eg text sampl pathtoreadssamplefastqgz pathtoreadssamplefastqgz sampl pathtoreadssamplefastqgz pathtoreadssamplefastqgz read annot assembl default hecatomb annot read perform assembl thread avail increas thread provid pipelin thread bash hecatomb run read fastq thread your run hpc cluster first set snakemak profilehttpssnakemakereadthedocsioenstableexecutingclihtmlprofil info exampl hecatomb hereconfigurationmdprofilesforhpcclust would specifi profil name run hecatomb assum profil call slurm bash hecatomb run read fastq profil slurm run hecatomb hpc snakemak profil best way run pipelin read annot option skip gener assembl run hecatomb command exactli addit skipassembl flag bash hecatomb run read fastq profil slurm skipassembl quicker read annot pipelin bottleneck mmseq search use fast flag run hecatomb less sensit set mmseq limit test find perform almost well consider runtim improv bash hecatomb run read fastq profil slurm fast specifi host genom hecatomb includ thorough host read remov step utilis process host genom specifi host add default hecatomb use human genom sampl differ sourc need specifi host genom sampl sourc see host genom avail bash hecatomb listhost follow avail default bat mous camel celegan macaqu rat dog cat tick mosquito cow human work mous sampl would run bash hecatomb run read fastq host mous add host genom genom host your work isnt includ avail host refer genom think better add addhost script mask virallik region genom add hecatomb host databas need specifi host genom fasta file well name host assum want add llama genom fasta genom file call llamafasta bash hecatomb addhost host llama hostfa llamafasta abl run hecatomb new host genom bash hecatomb run read fastq host llama section assum finish part preparationtutorialptmd download bigtabletsvgz metadatatsvgz load rstudio datafram call data meta inspect datafram let look bigtabl file r rrstudio viewdata imgtutedatatablepngimgtutedatatablepng metadata r viewmeta imgtutemetatablepng metadata tabl ive made sure column header sampl id tabl metadata associ origin sampl weve simplifi thing merg metadata merg metadata easi merg function perform inner join default specifi outer left rightout shouldnt matter metadata sampl r save merg tabl new datafram datameta mergedata meta bysampleid metadata incomplet want keep sampl datameta mergedata meta bysampleid allt preliminari bigtabl plot let look raw align first extract viral hit new data frame r virus datameta filterkingdomvirus like plot align length ident facet viral famili show differ align type color scale point size cluster number ive ad alpha set opac point overlap lot scale r ggplotvirus geom_point aesxalnlenypidentcoloralntypesizecount alpha facet_wrapfamili imgtutealnpidfampngimgtutealnpidfampng immedi see hand viral famili make major viral hit use plot help guid filter strategi divid align quadrant ad align length percent ident threshold instanc align length percent ident r ggplotvirus geom_point aesxalnlenypidentcoloralntypesizecount alpha facet_wrapfamili geom_vlinexinterceptcolourredlinetypelongdash geom_hlineyinterceptcolourredlinetypelongdash imgtutealnpidfamquadpngimgtutealnpidfamquadpng see adenovirida parvovirida major hit occupi top two quadrant reason confid align podovirida circovirida major hit occupi bottom two quadrant could indic virus distantli relat refer genom famili challeng plot bacteri hit facet phylum dont facet bacteri hit famili way mani panel plot adenovirida hit sampl use filter insid ggplot function filter strategi hecatomb intend black box predetermin filter cutoff return immut tabl hit instead deliv much inform possibl empow user decid hit want keep hit purg let take raw viral hit datafram virus filter keep one confid evalu one common metric use filter align let see hit would remov use fairli stringent cutoff e return filter datafram like r virusesfilt virus filterevalue let instead add flag origin datafram purg hit r mutat add modifi column ifels return valu base condit virus virus mutatefilterifelseevalueepassfilt plot r ggplotvirus geom_point aesxalnlenypidentcolorfilt alpha facet_wrapfamili imgtutevirevalfiltpngimgtutevirevalfiltpng orang red sequenc destin remov bluegreen sequenc kept viral famili remov altogeth probabl good thing low qualiti hit go back quadrant concept might want keep sequenc certain length percent ident r overwrit flag new design virus virus mutatefilterifelsealnlen pidentpassfilt plot vertic horizont line match cutoff r ggplotvirus geom_point aesxalnlenypidentcolorfilt alpha facet_wrapfamili geom_vlinexinterceptcolourredlinetypelongdash geom_hlineyinterceptcolourredlinetypelongdash imgtutevirlenfiltpngimgtutevirlenfiltpng mani align metric includ bigtabl choos suggest previou plot colour align align type aa nt alntyp hecatomb attempt identifi nucleotid hit sequenc protein hit gener expect protein nucleotid hit intergen space gener small viral genom high nucleotideprotein hit ratio could result falseposit hit may wish ignor nucleotid hit circumst hecatomb tri assign taxonomi use lowest common ancestor approach lca taxmethod lca calcul fail hecatomb default top hit tophit taxmethod may may wish includ top hitbas annot ignor top hit annot accompani lcabas annot challeng filter raw viral hit keep protein hit evalu e save virusesfilt move part visualis annotationstutorialptmd snakemak profil snakemak profil musthav run snakemak pipelin hpc cluster pain set need life easi want get run littl effort possibl see tutori belowprofilesmdprofileinstallationexampl inform check snakemak document profileshttpssnakemakereadthedocsioenstableexecutingclihtmlprofil recent blog post snakemak profileshttpsfameflinderseduaublogsnakemakeprofilesupd profil hecatomb hecatomb ship exampl profil slurm workload manag hecatombsnakemakeprofileexample_slurm exampl _profile_ configyaml file confus _hecatomb_ config file contain snakemak option job submit schedul hecatomb expect follow cluster command resourcestim time minut resourcesmem_mb request memori mb thread request cpu tri use believ common nomenclatur variabl snakemak pipelin hope hecatomb compat exist snakemak profil avail cookiecutt profil snakemakehttpsgithubcomsnakemakeprofil recommend redirect stderr stdout messag log file use snakemak variabl rule jobid instanc like outputlogsrulejobidout also prepend schedul command command make log directori case dont exist caus error schedul exampl like mkdir p logsrul sbatch make troubleshoot easier job fail due schedul issu exampl profil includ watcher script snakemak wont alway pick schedul prematur termin job need watcher script line config file tell snakemak check statu job clusterstatu configsnakemakeslurmslurmstatuspi sure check updat file path slurmstatuspi script queri schedul jobid report back snakemak job statu profil instal exampl well walk two way set profil slurm workload manag hpc use differ workload manag process instal profil similar differ copi exampl profil provid exampl profil slurm workload manag work hpc use slurm snakemak look profil home directori text configsnakemak first creat directori new profil well call slurm bash mkdir p configsnakemakeslurm copi file exampl slurm profil view githubhttpsgithubcomshandleyhecatombblobmainsnakemakeprofileexample_slurm bash go new profil directori cd configsnakemakeslurm copi file either github instal hecatomb wget httpsrawgithubusercontentcomshandleyhecatombecccfaddfadecffffafeesnakemakeprofileexample_slurmconfigyaml wget httpsrawgithubusercontentcomshandleyhecatombecccfaddfadecffffafeesnakemakeprofileexample_slurmslurmstatuspi exampl includ necessari configyaml file profil watcher script call slurmstatuspi make watcher script execut bash chmod x configsnakemakeslurmslurmstatuspi done use profil hecatomb bash hecatomb run test fast profil slurm creat profil cookiecutt cookiecutt nifti tool creat project use templat snakemak profil cookiecutt take away lot manual configur step involv set profil specif schedul current cookiecutt templat slurm sge pb sever workload managershttpsgithubcomsnakemakeprofil hecatomb intend compat profil walk instal slurm profil use cookiecutterhttpsgithubcomsnakemakeprofilesslurm begin creat new directori profil bash mkdir p configsnakemakeslurm move directori run cookiecutt command profil bash cd configsnakemakeslurm cookiecutt httpsgithubcomsnakemakeprofilesslurmgit follow prompt your done system need specifi anyth may need specifi account inform bill etc detail github page profilehttpsgithubcomsnakemakeprofilesslurm use profil hecatomb bash hecatomb run test fast profil slurm imghecatomblogopng hecatomb great sacrific extens loss heactomb softwar empow analyst make data driven decis sacrific falseposit viral read metagenom enrich trueposit viral read process frequent result great loss suspect viral sequenc contig imghecatombbannerpng hecatomb develop respons challeng associ detect viral sequenc metagenom viru detect virom profil typic perform sampl contain extens host nucleic acid eg tissu biopsi nucleic acid varieti organ bacteria fungi archaea soil sampl bacteria fungi archaea food mammalian stool sampl nonvir nucleic acid type constitut background present varieti issu must evalu order confid detect viral sequenc detect quantit analysi viral sequenc mix metagenom data uniqu challeng virus propens rapidli acquir mutat evolv highli diverg refer databas sequenc code noncod region viral genom dispar challeng eg longtermin repeat virus clssifi either singl doubl strand either dna rna falseposit rampant mani studi due signific sequenc homolog virus domain life hecatomb utilis uniqu search strategi address issu enabl research accur identifi quantifi virus metagenom sampl system requir set sensibl default hecatomb follow minimum recommend system requir cpu cpu hyperthread gb ram approxim gb hdd space databas addit hdd space temporari output file highli depend input file size larger dataset may requir ram cpu speed thing along highli recommend run hecatomb hpc cluster depend hecatomb develop set snakemakehttpssnakemakereadthedocsioenst workflow control python launcher conveni pipelin utilis number program tool run manag pipelin use condahttpsdocscondaioenlatest mambahttpsgithubcommambaorgmamba instal hecatomb via conda bash command creat new conda env call hecatomb instal hecatomb depend conda creat n hecatomb c condaforg c bioconda hecatomb that bash use hecatomb activ new conda env conda activ hecatomb check instal hecatomb h customis your run hecatomb cluster highli recommend use snakemak profil set profil snakemakeprofilesmd may also want customis avail resourc system whether your use cluster run local advanc configurationconfigurationmd download databas run hecatomb first time need download databas need step unless updat databas rerun step much like pipelin download databas file miss bash either run local hecatomb instal hpc cluster use snakemak profil replac slurm profil name hecatomb instal profil slurm run test dataset hecatomb come test dataset run take hour complet use test place specifi read directori read bash run local hecatomb run test run cluster use snakemak profil hecatomb run test profil slurm build doc document page built repo like bash instal mkdoc pip instal mkdoc cd instal directori cd pathtohecatomb build mkdoc build contig readbas annot hecatomb produc assembl annot read also combin two map annot read assembl build tabl combin map coordin read annot load tabl look r contigt readcsvcontigseqtabletsvgzheadertsept viewcontigt imgtutectgtblpngimgtutectgtblpng contain sequenc seqtabl contig map coordin map qualiti count taxonom annot could also join bigtabl bring everyth sequenc premis behind tabl enabl dynam taxonom assign assembl contig still work progress show exampl plot demonstr idea let look read map contig_ separ read genu color famili r ggplotcontigt filtercontigidcontig_ geom_pointaesxstartygenuscolorfamili imgtutectgpngimgtutectgpng nice clear consensu mastadenoviru hand read could fairli confid reassign want given clear consensu might possibl assign specif speci r ggplotcontigt filtercontigidcontig_ geom_pointaesxstartyspeciescolorfamili imgtutectgsppngimgtutectgsppng unfortun closest hit refer databas unclassifi speci howev next closest hit rhesu adenovirus make sens macaqu sampl let look contig_ r ggplotcontigt filtercontigidcontig_ geom_pointaesxstartyfamilycolorkingdom imgtutectgpngimgtutectgpng hit remain unclassifi classifi hit split kingdom let see speci sequenc hit r ggplotcontigt filtercontigidcontig_ geom_pointaesxstartyspeciescolorkingdom imgtutectgsppngimgtutectgsppng annot hit split _bacteroides_ phage speci _ktedonobacter_ bacteria speci contig could repres novel phage speci novel prophag bacteria genom think cool analysi lot potenti would love feedback tutori walk process run hecatomb perform preliminari plot analys rrstudio first section detail hecatomb run wont need actual run hecatomb simpli download filestutorialptmddownloadthefil continu rest tutori system inform tutori ill run hecatomb corethread workstat gb ram run ubuntu lt fine smaller dataset larger dataset requir hpc resourc new instal bash creat new conda env instal hecatomb conda creat n hecatomb c condaforg c bioconda hecatomb activ env conda activ hecatomb instal databas file hecatomb instal run hecatomb run hecatomb test dataset subset dataset describ handley et al httpsdoiorgjchom use fast mmseq set default thread gener summari report give us assembl read annot bash hecatomb run test fast report file need download file download follow gzip file gener hecatomb bigtabletsvgzhttpscloudstoraarneteduauplusssmspixhnryikdownload seqtablefastagzhttpscloudstoraarneteduauplusspzgxotygpfafdownload taxonlevelcountstsvgzhttpscloudstoraarneteduauplusswgfkmgmszhgkuafdownload contigseqtabletsvgzhttpscloudstoraarneteduauplussflovocywicrpxdownload sankeysvghttpscloudstoraarneteduauplussgwfaxcamarmgdownload kronahtmlhttpscloudstoraarneteduauplusshfornxhrtxsudownload assemblyfastahttpscloudstoraarneteduauplussbmtojzwbersrdownload also prepar metadata file sampl test dataset sampl deceas macaqu origin studi metadata contain individu gender vaccin administ metadatatsvgzhttpscloudstoraarneteduauplussxbleetnxvocpdownload sankeysvg kronahtml automaticallygener plot look file dont need anyth tutori bigtabletsvgz readbas annot form basi subsequ analysi contigseqtabletsvgz combin readbas annot contig map coordin taxonlevelcountstsvgz file summaris sequenc count sampl everi taxon level make easi perform preliminari comparison option prefilt bigtabletsv dataset tutori small manag your work larg dataset size bigtabl big load r run situat check prefilt bigtableadvancedmdprefilterthebigt set rrstudio remaind tutori rhttpswwwrprojectorg rstudiohttpswwwrstudiocom use packag dplyrhttpsdplyrtidyverseorg tidyrhttpstidyrtidyverseorg ggplothttpsggplottidyverseorg instal packag tutori test fresh instal r rstudio window assum instal r rstudio oper system abl instal packag like r rrstudio installpackagestidyr installpackagesdplyr installpackagesggplot altern instal whole tidyvers r installpackagestidyvers well also need rstatix statist test r installpackagesrstatix instal load packag r librarytidyr librarydplyr libraryggplot libraryrstatix load data make sure set work directori download file directori load bigtabletsvgz datafram call data loadcsv file tabsepar contain header r data readcsvbigtabletsvgzheadertsept next load metadatatsvgz file datafram call meta way r meta readcsvmetadatatsvgzheadertsept well load taxonlevelcountstsvgz r taxoncount readcsvtaxonlevelcountstsvgzheadertsept keep contigseqtabletsvgz file handi well load r well later move onto part filter annotationstutorialptmd prefilt bigtabl bigtabl big remov stuff dont want use linux command line load r python remov low qualiti hit use awk appli evaluebitscorealignemnt lenghtetcetera cutoff bash copi header new file head bigtabletsv newbigtabletsv filter low qualiti hit eg use evalu cutoff say e awk f e bigtabletsv newbigtabletsv remov irrelev hit plan analys virus say protein hit remov everyth els awk bash copi header head bigtabletsv newbigtabletsv return row virus kingdom column akw f virus bigtabletsv newbigtabletsv altern return aa proteinbas hit awk f aa bigtabletsv newbigtabletsv remov irrelev column youv finish prefilt plan use say evalu filter remov align metric time use cut bash remov align metric except evalu cut complement f bigtabletsv newbigtabletsv retriev sequenc interest upon analys bigtabl may collect interest hit want investig retriev relev sequenc seqtablefasta file need list sequenc idsth first column bigtabl instanc get seqid viral famili flavivirida save file r r use tidyrdplyr get seq id flaviviridaeseq data filterfamilyflavivirida pullseqid print file lapplyflaviviridaeseq write flavseqidslist appendtru ncolumn use samtool grab sequenc seqtablefasta file shell bash samtool faidx seqtablefasta r flavseqidslist flaviviridaeseqsfasta pipelin output number file analysi explor well provid overview read preprocess distribut report reporthtml file gener snakemak outlin lot inform relat hecatomb run result tab summari file thing like read sampl follow differ preprocess step well summari plot seqtabl hecatomb_outresultsseqtablefasta seqtabl primari output read preprocess serv input taxonom assign compos repres sequenc cluster read sampl sampl cluster individu seq id fasta file follow format sampleidcountseqnumb count number read cluster import statist explor sequenc number sequenti seqnumb ensur uniqu id bigtabl hecatomb_outresultsbigtabletsv bigtabl main output taxonom assign directli import r python bigtabl combin seqtabl id sampleid count normalis count align inform taxonom assign baltimor classif file big henc name design make merg sampl metadata plot statist interrog easi possibl header look like text seqid sampleid count cpm alntyp targetid evalu pident fident nident mismatch qcov tcov qstart qend qlen tstart tend tlen alnlen bit targetnam taxmethod kingdom phylum class order famili genu speci baltimoretyp baltimoregroup taxonlevelcount hecatomb_reporttaxonlevelcountstsv file deriv bigtabl summaris total sequenc count sampl taxonom level taxonlevelcount combin sampleid taxonom level count refer full taxonom path taxon name total normalis read count purpos file expedit statist interrog data instanc want compar number say flavivirida read two group sampl count alreadi collect simpli run analysi plot relev slice tabl file look someth like text sampleid taxonlevel taxonpath taxonnam count cpm sampl kingdom k_bacteria bacteria sampl phylum k_virusesp_phixviricota phixviricota sampl class k_virusesp_uroviricotac_caudoviricet caudoviricet etc assembl hecatomb_outresultsassemblyfasta contig gener unless run hecatomb skipassembl flag assembl use produc contigseqt contigkrona plot well direct contig annot contig annot todo contigseqt hecatomb_outresultscontigseqtabletsv contigseqt combin read map inform assembl readbas taxonom assign file intend assist user identifi bin assembl contig appli consensu approach contig taxonom assign file includ posit map inform also enabl investig complex featur chimer contig recombin horizont transfer event header look like text contigid seqid start stop len qual count cpm alntyp taxmethod kingdom phylum class order famili genu speci baltimoretyp baltimoregroup sankey hecatomb_reportsankeysvg sankey diagram show fate read throughout preprocess readbas taxonom assign step serv visualis read filter distribut taxonom assign method give overal impress well thing went sankey diagram produc test dataset shown dataset rel rich viral sequenc yet major read either filter nonvir know imgsankeysvgimgsankeysvg kronahtml contigkronahtml hecatomb_reportkronahtml hecatomb_reportcontigkronahtml krona plot assist visual explor read annot kronahtml deriv bigtabl show raw distribut taxon assign contigkronahtml deriv contigseqt includ taxon assign method either tophit lca contigkrona plot help visualis distribut tophit versu lca assign read well distribut contig identifi speci distribut taxonom assign contig get help support open issu githubhttpsgithubcomshandleyhecatombissu question stupid pipelin still earli day develop expect still bug code pipelin die went wrong great mani thing may gone wrong simpli tri rerun pipelin pick left tri make log thorough possibl meaning error messag look termin output produc snakemak fail job appear red text termin look snakemak log snakemakelog rule directori hecatomb_outstderr log file snakemak error code tell exactli file look your run profil hpc job may fail reason relat schedul instanc memori time may exceed request look schedul log see case exampl profil slurm log save logsrulejobid rule name jobid suppli snakemak error messag make easi find relev log much data memori problem run sampl batch even split sampl separ run realli need bigtabletsv file differ run concaten rememb remov extra header assembl combin use flye subassembl function sequenc depth except high could also subsampl fastq file run coupl full coverag control depend job fail reduc cluster threshold clusterid configyaml help reduc size seqtabl use stringent evalu cutoff mmseq search also configyaml reduc output file size hecatomb take long first tri run hecatomb fast flag mmseq step far time consum step fast flag tell hecatomb use mmseq set much much faster quit sensit also configur instal utilis mani cpu much memori possibl see default resourc confighttpshecatombreadthedocsioenlatestadvanceddefaultresourc info dont need assembl skip step skipassembl also save bit time ive run pipelin look tutoria goe exampl plot analys section assum finish tutori part tutorialptmd part tutorialptmd unfilt taxon count taxonlevelcountstsv file intend make quick easi compar viru hit count across sampl let take look r viewtaxoncount imgtaxcounttablepngimgtaxcounttablepng file contain count normalis count taxonom level sampl base raw unfilt hit count want compar number adenovirida hit sampl could pull adenovirida count plot r get adenovirida count adenocount taxoncount filtertaxonlevelfamilytaxonnameadenovirida plot ggplotadenocount geom_baraesxsampleidycountstatident coord_flip imgtuteadenobarpngimgtuteadenobarpng take one step plot viral famili normalis count sampl stack bar chart r get viral famili count viralcount taxoncount filtertaxonlevelfamilygreplk_virusestaxonpath plot ggplotviralcount geom_baraesxsampleidycountfilltaxonnamepositionstackstatident coord_flip imgtuteviralcountspngimgtuteviralcountspng gener taxon count taxonlevelcountstsv file conveni compar raw count like want gener new count _filtered_ hit recreat plot filter hit first sum count normalisedcount eg famili level r answer challeng filter raw viral hit keep protein hit evalu e virusesfilt virus filteralntypeaaevalue collect filter count viralfiltcount virusesfilt group_bysampleidfamili summarisen sumcpm plot time use positionfil make look like data confus peopl well also add theme_bw grey ugli r ggplotviralfiltcount geom_baraesxsampleidynfillfamilypositionfillstatident coord_flip theme_bw imgtuteviralfiltcountspngimgtuteviralfiltcountspng count tabl use plot statist comparison challeng make stack bar chart viral famili male femal monkey imgtutegendercountspng visualis group viral famili promin sampl let see differ viral load accord sampl group collect sampl count _microviridae_ includ metadata group group_bi use plot r microcount virusesfilt group_byfamilysampleidmacguffingroup filterfamilymicrovirida summarisen sumcpm plot like jitter plot boxplot violin plot might work better hundr sampl r ggplotmicrocount geom_jitteraesxmacguffingroupynwidth theme_bw imgtutemicrovirjitterpng let _podoviridae_ r collect count podocount virusesfilt group_byfamilysampleidmacguffingroup filterfamilypodovirida summarisen sumcpm plot ggplotpodocount geom_jitteraesxmacguffingroupynwidth theme_bw imgtutepodojitterpng challeng could gender good predictor viral load famili macguffingroup look promis _podoviridae_ well need move part statist teststutorialptmd find sure complet list databas file avail hecatomb configyaml file contamin databasescontamin databas consist collect nebnext truseq adapt primerb sequenc collect clone vector common sourc fals posit sequenc use preprocess trim read nonbiolog contamin sequenc host genom databaseshost contamin viral metagenom host dna signific burden sourc fals posit viral annot use host refer genom filter host read prior annot howev host genom typic contain larg amount viruslik virusderiv sequenc could lead erron remov true viral read therefor must process host refer genom mask virallik sequenc prior use preprocess hecatomb come sever process host genom tool user add genom see ad host genomeusagemdaddingyourownhostgenom info amino acid databas databasesaa primari aa primari aa databas use quickli identifi read virallik databas uniprot viral protein entir clusterd ident cluster greatli reduc size databas minim sacrific inform content exampl protein entir virus uniprot octob cluster ident repres sequenc remain reduct target queri space secondari aa secondari aa databas use check virallik read primari aa search better nonvir match todo nucleotid databas databasesnt primari nt primari nt databas use quickli identifi virallik read identifi primari aa search todo secondari nt secondari nt databas use check virallik read primari nt search better nonvir match todo taxonomi databasestax hecatomb utilis ncbi taxonomi databas taxdump taxonkithttpsgithubcomshenweitaxonkit convert taxon id complet lineag output bigtabl tabl databasest collect supplementari tabl primarili baltimor classif provid merg bigtabl annot section assum complet tutori parttutorialptmd compar viral load part compar viral count two sampl group _podoviridae_ appear though group b viral sequenc hit averag group compar normalis count two group see theyr significantli differ student ttest let check datafram made earlier well use test r viewpodocount imgtutepodocntspng well use baser function ttest take two vectorson group count one group b count use filter pull function within ttest function like r ttest podocount filtermacguffingroupa pulln podocount filtermacguffingroupb pulln alternativetwosid pairedf varequalt text two sampl ttest data podocount filtermacguffingroup pulln podocount filtermacguffingroup b pulln df pvalu altern hypothesi true differ mean equal percent confid interv sampl estim mean x mean note follow plot ive manual ad signific asterisk imgtutepodojitterttestpng wilcoxon test might prefer perform wilcoxon test syntax similar ttest r wilcoxtest podocount filtermacguffingroupa pulln podocount filtermacguffingroupb pulln alternativet pairedf text wilcoxon rank sum exact test data podocount filtermacguffingroup pulln podocount filtermacguffingroup b pulln w pvalu altern hypothesi true locat shift equal imgtutepodojitterwilcpng dunn test let use dunn test check major famili time dunn good three categori metadata field vaccin column first find major famili sum hit famili sort tabl r collect famili count viralfamcount virusesfilt group_byfamili summarisensumcpm arrangedescn updat factor level sort order viralfamcountsfamili factorviralfamcountsfamilylevelsviralfamcountsfamili plot r ggplotviralfamcount geom_baraesxfamilyynstatident coord_flip imgtutefamcntspng let focu _siphoviridae_ _adenoviridae_ _podoviridae_ _microviridae_ collect summari count famili sampl includ metadata want use r viralmajorfamcount virus filterfamili csiphoviridaeadenoviridaepodoviridaemicrovirida group_bysampleidfamilyvaccin summarisensumcpm let dunn test famili r viralmajorfamcount group_byfamili dunn_testn vaccinepadjustmethodholm add_signific text tibbl famili group group n n statist p padj padjsignif chr chr chr chr int int dbl dbl dbl chr adenovirida n ad_alon ad_protein ns adenovirida n ad_alon sham ns adenovirida n ad_protein sham ns microvirida n ad_alon ad_protein ns microvirida n ad_alon sham ns microvirida n ad_protein sham ns podovirida n ad_alon ad_protein ns podovirida n ad_alon sham ns podovirida n ad_protein sham ns siphovirida n ad_alon ad_protein siphovirida n ad_alon sham ns siphovirida n ad_protein sham ns there one comparison signific let put plot r ggplotviralmajorfamcount geom_jitteraesxvaccineyn facet_wrapfamili imgtutedunnspng compar presenceabs might care viral load instead interest compar presenc absenc virus could use fisher exact test perform test need assign presenc absenc viral familygenusetc sampl number hit use decid viru present want sure align ill appli stringent filter cutoff ill assign anyth _any_ hit present viral famili let look _myoviridae_ particular reason r appli stringent filter virusesstring virus filterevalueealnlenpidentalntypeaa count hit myovirida score presenc note absent sampl wont tabl yet add myovirpresab virusesstring filterfamilymyovirida group_bysampleid summarisensumcpm mutatepresentifelsen merg metadata use allt outer join bring absent sampl myovirpresab mergemyovirpresabsmetabysampleidallt convert na zero myovirpresabsisnamyovirpresab fisher exact test need specifi x grid first column number _myoviridae_ group second column number without group r matrix row mtxgroupa c myovirpresab filtermacguffingroupapres summarisenn pulln myovirpresab filtermacguffingroupapres summarisenn pulln mtxgroupb c myovirpresab filtermacguffingroupbpres summarisenn pulln myovirpresab filtermacguffingroupbpres summarisenn pulln creat x matrix myovirfishmtx matrixcmtxgroupamtxgroupbnrow bit necessari let add row col name illustr matrix layout colnamesmyovirfishmtx cgroupagroupb rownamesmyovirfishmtx cpresentabs view viewmyovirfishmtx imgtutefishmtxpng r run fisher exact test fishertestmyovirfishmtx text fisher exact test count data data myovirfishmtx pvalu altern hypothesi true odd ratio equal percent confid interv sampl estim odd ratio dont mani sampl signific wont great regardless part tutorialptmd look contig readbas annot recommend customis your run hecatomb hpc cluster absolut recommend set snakemak profileprofilesmd also recommend review snakemak configyaml file hecatomb instal directori config file hecatombsnakemakeconfigconfigyaml find instal directori bash hecatomb chang hecatomb configur hecatomb configur file hecatombsnakemakeconfigconfigyaml contain set relat resourc cutoff variou stage pipelin differ config set outlin perman chang behaviour hecatomb instal modifi valu config file altern specifi config file first copi system default config file like bash hecatomb config edit new hecatombconfigyaml file suit need use hecatomb run like bash hecatomb run configfil hecatombconfigyaml databas locat databas larg gb hecatomb instal partit limit space might want specifi new locat hous databas file default config set blank pipelin use instal locat hecatombdatabas specifi directori hecatomb config file hecatombsnakemakeconfigconfigyaml databas eg yaml databas scratchhecatombdatabas run rerun instal bash hecatomb instal default resourc hecatomb config file contain sensibl default resourc work dataset may fail larger one may also cpu etc dispos want minimis runtim pipelin current slowest step mmseq search increas cpu ram could significantli improv runtim set megahit minimap bbtool misc probabl show modest improv relev section hecatombsnakemakeconfigconfigyaml shown yaml memori mmseq megabyt eg gb recommend mmseqsmem thread mmseq recommend mmseqscpu max runtim minut mmseq enforc snakemak profil mmseqstimemin day memori bbtool megabyt recommend bbtoolsmem cpu bbtool recommend bbtoolscpu memori megahitfly megabyt recommend mhitmem cpu megahitfly megabyt recommend mhitcpu memori slightli ramhungri job megabyt recommend miscmem cpu slightli ramhungri job recommend misccpu default memori megabyt use profil defaultmem default time minut use profil defaulttim default concurr job use profil defaultjob preprocess set mani filter etc cutoff valu specifi hecatomb config file instanc read_minlength specifi minimum allow read length trim relev section hecatombsnakemakeconfigconfigyaml shown yaml preprocess qscore read qualiti trim score rule remove_low_qu _preprocessingsmk read_minlength minimum read length qc step rule remove_low_qu _preprocessingsmk contig_minlength read minimum length rule contig_reformating_and_stat _preprocessingsmk entropi read minimum entropi rule remove_low_qu _preprocessingsmk entropywindow entropi window low qual read filter cluster read seqtabl mmseq easylinclust c req coverag target seq minseqid req ident align linclustparam kmerperseqscal c covmod minseqid alignmentmod addit set config file user familiar mmseq well set alter align filter hecatomb set filter mmseq align stage search strategi default use lenient evalu cutoff maximis identif viral sequenc primari search stringent evalu cutoff multikingdom search lower evalu cutoff e improv runtim perform cost lower recal minlenghth lower preprocess cutoff relev section hecatombsnakemakeconfigconfigyaml shown yaml align filter cutoff minlength aa equal less read_minlength minlength nt equal less read_minlength filtaaprimari minlength e e filtaasecondari minlength e e filtntprimari minlength e e filtntsecondari minlength e e align set hecatomb perform mmseq align use either sensit default fast fast paramet tweak set config file consult mmseq document make chang relev section hecatombsnakemakeconfigconfigyaml shown yaml perform set see mmseq document detail sensit aa search perfaa startsen sensstep lcamod shuffl fast aa search perfaafast lcamod shuffl sensit nt search perfnt startsen sensstep fast nt search perfntfast addit snakemak command mention hecatomb power snakemak run via launcher conveni launchercal hecatomblet specifi directori read host genom save result whether assembl either specifi number thread use profil use snakemak mani command line option launcher pass addit command snakemak use snake option one exampl your product readi might wish dryrun run simul job submit see everyth configur correctli snakemak need dri run flag dryrun dryrun n hecatomb pass flag like bash hecatomb run read fasq profil slurm snakedryrun hecatomb print snakemak command termin window run see addit option ad snakemak command bash hecatomb run test snakedryrun text run hecatomb run snakemak command snakemak j useconda condafrontend mamba rerunincomplet printshellcmd nolock condaprefix scratchhecatombsnakemakeworkflowconda dryrun scratchhecatombsnakemakeworkflowhecatombsmk c readsscratchhecatombtest_data hosthuman outputhecatomb_out assemblyfals build dag job look full list avail snakemak option snakemak help launcher pass anyth snake verbatim use care note dont use hecatomb snake arg pass addit config set snakemak cconfig arg instead follow direct chang config hecatomb runconfigurationmdchangingthehecatombconfigur