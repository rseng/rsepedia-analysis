titl fastsf parallel code comput structur function turbul tag c structur function turbul fluid dynam author name shubhadeep sadhukhan orcid affili name shashwat bhattacharya orcid affili name mahendra k verma orcid affili affili name depart physic indian institut technolog kanpur kanpur india index name depart mechan engin indian institut technolog kanpur india index date februari bibliographi paperbib summari turbul complex phenomenon fluid dynam involv nonlinear interact multipl scale structur function popular diagnost studi statist properti properti turbul flow kolmogorovdissip kolmogorovstructur frischbook earlier work compris analysi gotohpf kanedapf ishiharaarfm threedimension hydrodynam turbul yeungpf raynjp passiv scalar turbul biferalenjp twodimension hydrodynam turbul kunnenpr kaczorowskijfm bhattacharyapf turbul thermal convect structur function twopoint statist quantiti thu accur comput quantiti requir averag mani point howev incorpor larg number point make comput expens challeng therefor requir effici parallel code accur comput structur function paper describ design valid result fastsf parallel code comput structur function given veloc scalar field fastsf c applic comput structur function scalar vector field cartesian grid period box store hdf file code employ mpi messag pass interfac parallel equal load distribut vector effici simd architectur user select rang order structur function comput comput structur function written hdf file process user awar open sour commerci packag comput structur function prior studi reli inhous softwar never publicli releas open sourc packag fastsf provid standard highperform implement thu facilit wider use structur function fastsf use mpi pachecobookpp parallel hdf hdf_web via hsi hsi_web read grid field data write structur function well blitz blitz_web vector comput yamlcpp yaml_web read control paramet next section briefli explain veloc scalar structur function turbul flow veloc scalar structur function denot veloc scalar field use boldsymbolu theta respect veloc differ two point boldsymbolr boldsymbolrboldsymbol delta boldsymbolu boldsymbolur boldsymbollboldsymbolur differ parallel compon veloc field along boldsymbol delta u_paralleldelta boldsymbolucdot hatboldsymbol correspond differ perpendicular compon delta u_perp delta boldsymbolu delta u_parallel hatboldsymbol assum statist homogen defin longitudin veloc structur function order q s_qu_parallelboldsymbol langl delta u_parallelq rangl langl boldsymbolurlboldsymbolurcdot hatboldsymbollq rangl quad quad transvers veloc structur function order q s_qu_perpboldsymbol langl delta u_perpq rangl langl delta boldsymbolu delta u_parallel hatboldsymbollq rangl quad quad langl cdot rangl denot spatial averag similarli defin scalar structur function scalar field s_qthetaboldsymbol langl delta thetaqrangl langl theta boldsymbolrl thetaboldsymbolrq rangl quad quad isotrop turbul addit homogen structur function becom function l lboldsymbol secondord veloc structur function s_qu_parallel provid estim energi eddi size l less davidsonbookturbul homogen isotrop turbul plot neg normal third fifth seventhord longitudin veloc structur function vs l neg normal thirdord structur function close dash line inerti rang labelsf_hydrodocsfigssf_hydropng incompress hydrodynam turbul homegen isotropi thirdord longitudin veloc structur function inerti rang scale lie largescal forc regim smallscal dissip regim given kolmogorovdissip kolmogorovstructur frischbook s_u_parallel frac epsilon l sim l quad quad epsilon viscou dissip rate arbitrari order q sheprl propos longitudin structur function scale s_qu_parallel l sim zeta_q expon zeta_q given zeta_q fracq left left frac rightq right quad quad figurerefsf_hydro exhibit plot neg normal rd th thorder longitudin veloc structur function comput use simul data hydrodynam turbul sadhukhanprf structur function normal epsilon lzeta_q zeta_q given eq inerti rang l normal thirdord longitudin veloc structur function fairli close repres dash line consist kolmogorov theori moreov normal fifth seventhord structur function show plateau rang l thu exhibit consist shelevequ model next section provid brief descript code design code section present sketch structur function comput veloc structur function employ vector loop boldsymbol thu requir three loop field two loop field follow provid algorithm structur function comput veloc field pseudocod data veloc field boldsymbolu domain l_x l_z number processor p procedur divid boldsymbol among variou processor process data divis among processor describ later section everi processor boldsymbol l_xl_z assign processor comput delta boldsymbolul_xl_z take differ two point indic pink green subdomain shown fig refschemat featur enabl vector subtract oper delta u_parallell_xl_z delta boldsymbolu cdot hatboldsymbol vector delta u_perpl_xl_z delta boldsymbolu delta u_parallel hatboldsymbol vector order q s_qu_parallell_xl_z averag delta u_parallelq vector s_qu_perpl_xl_z averag delta u_perpq vector send valu s_qu_parallell_xl_z s_qu_perpl_xl_z q l_x l_z root process root process store s_qu_parallel l_x l_z s_qu_perp l_x l_z stop veloc differ delta boldsymboluboldsymbol comput take differ two point indic pink green subdomain exampl boldsymboluboldsymbol boldsymbolu boldsymbolu_b boldsymbolu_a b origin green pink subdomain featur enabl vecotr comput labelschematicdocsfigsschematicpng sinc s_quboldsymbol import intermedi scale inerti rang vari boldsymbol upto half domain size upto l_x l_z save comput cost boldsymbol divid among mpi processor along x z direct mpi processor comput structur function point assign access entir input data comput structur function given boldsymbol processor commun result root process store s_qu_parallelboldsymbol s_qu_perpboldsymbol array clear fig refschemat size pink green subdomain l_xl_xl_zl_z function boldsymbol function decreas increas boldsymbol lead larger comput cost small l less cost larger l henc straightforward divis domain among processor along x z direct lead load imbal therefor assign larg small boldsymbol processor achiev equal load distribut illustr idea use follow exampl consid onedimension domain size l possibl ls l need comput structur function l rang divid task among four processor two ls assign processor follow distribut ls ensur equal load distribut mboxprocessor quad l quad sumll mboxprocessor quad l quad sumll mboxprocessor quad l quad sumll mboxprocessor quad l quad sumll similarli two processor use follow distribut result load balanc mboxprocessor quad l mboxprocessor quad l idea load distribut implement program extend higher dimens note l_x l_z take posit neg valu howev isotrop turbul structur function l_z l_z statist equal therefor comput restrict l_x l_z anisotrop turbul discuss structur function depend l_xl_z rather l code extend system futur turbul structur function depend l_xl_yl_z divid task among processor l_x l_i done turbul aforement algorithm easili extend case employ similar method comput scalar structur function well next section discuss scale code scale fastsf fastsf scalabl mani processor due vector equal load distribut demonstr scale fastsf thirdord longitudin structur function ideal veloc field grid comput employ maximum core take veloc field boldsymbolu beginbmatrix x z endbmatrix perform four run cray xc system shaheen ii kaust problem use total core use core per node run fig refscal plot invers time taken second versu number core best fit curv data point yield sim p pm thu datapoint follow sim p curv good approxim henc conclud code exhibit good scale scale fastsf comput thirdord longitudin veloc structur function use processor shaheen ii run conduct grid observ linear scale labelscalingdocsfigssf_scalingpng conclus paper provid brief descript fastsf effici parallel c code comput structur function given veloc scalar field code shown scalabl mani processor earlier version code use bhattacharyapf analyz structur function turbul convect believ fastsf use turbul commun facilit wider use structur function acknowledg thank roshan samuel anando chatterje soumyadeep chatterje manohar sharma help discuss develop fastsf grate jed brown ilja honkonen chri green care review work use suggest comput perform shaheen ii kaust supercomput laboratori saudi arabia project k refer fastsf fastsf open sourc hybrid parallel c code comput structur function given veloc scalar field get sourc code fastsf host github download sourc code follow link httpsgithubcomshubhadeepsadhukhanfastsf instal fastsf fastsf requir sever librari list later section compil librari instal directori long said directori ad user path section provid guidelin instal librari homeloc gener recommend environ variabl follow environ variabl need set compil fastsf may append line homebashrc export pathhomelocalbinpath export pkg_config_disable_uninstalledtru export pkg_config_pathhomelocallibpkgconfigpkg_config_path export hdf_roothomeloc export cpathhomelocalincludecpath export ld_library_pathhomelocallibld_library_path export library_pathhomelocalliblibrary_path export manpathhomelocalsharemanmanpath requir librari follow librari requir instal run fastsf blitzhttpsgithubcomblitzppblitz version array manipul perform use blitz librari download blitz herehttpsgithubcomblitzppblitz download chang blitzmast directori enter follow command ccgcc cxxg configur prefixhomeloc make instal yamlcpphttpsgithubcomjbederyamlcppreleasestagreleasevers input paramet store parayaml file need yamlcpp librari pars download yamlcpp herehttpsgithubcomjbederyamlcppreleasestagreleas extract ziptar file chang yamlcppreleas directori import pleas ensur cmakehttpscmakeorg instal system enter follow command ccgcc cxxg cmake dcmake_install_prefixhomeloc make instal mpi messag pass interfac librari fastsf use mpi parallel softwar test use mpichhttpswwwmpichorgvers howev standard mpi implement suffici provid instruct instal mpich download mpich herehttpswwwmpichorgdownload extract chang mpich folder enter follow ccgcc cxxg configur prefixhomeloc make instal hdfhttpturbulencehuborgwpcontentuploadsdownload_fileshdftarbzvers output file written hdf format download hdf herehttpturbulencehuborgwpcontentuploadsdownload_fileshdftarbz extract tar file chang hdf enter follow ccmpicc cxxmpicxx configur prefixhomeloc enableparallel withoutzlib make instal hsihttpsgithubcomanandogchsivers librari use simplifi inputoutput oper hdf download hsi herehttpsgithubcomanandogchsi download zip file extract chang hsimastertrunk import pleas ensur cmakehttpscmakeorg instal system enter follow cxxmpicxx cmake dcmake_install_prefixhomeloc make make instal import note fastsf compat higher version yamlcpp compil instruct download fastsf chang fastsfsrc directori run command make termin execut name fastsfout creat insid fastsfsrc folder test fastsf fastsf offer autom test process valid code relev test script found test folder code execut tese process chang fastsf run command bash runtestsh code run four test case follow first case code gener veloc field given u x z comput structur function given field case longitudin structur function equal lsupqsup second case code gener scalar field given x z comput structur function given field case structur function equal lsubxsub lsubzsubsupqsup third case code gener veloc field given u x z comput structur function given field case longitudin structur function equal lsupqsup fourth case code gener scalar field given x z comput structur function given field case structur function equal lsubxsub lsubysub lsubzsubsupqsup case fastsf compar comput structur function analyt result percentag differ two valu less supsup code deem pass final visual purpos python script testtestpi invok script gener plot second thirdord longitudin structur function versu l densiti plot comput secondord scalar structur function lsubxsub lsubzsubsupsup scalar field densiti plot comput secondord scalar structur function lsubysub lsubxsub lsubzsubsupsup gener plot demonstr structur function comput accur note follow python modul need run test script success hpi numpi matplotlib detail instruct run fastsf section provid detail procedur execut fastsf given veloc scalar field file requir hdf schema file store input field need hdf format store insid folder input dataset requir precis per follow schema two dimension field vector field two dataset file requir dataset store xcompon vector veloc field dataset dimens nxnz store real doubleprecis float point valu name dataset hdf file contain dataset arbitrari need specifi user via command line argument execut fastsf user prefer use command line argument hdf file default name uvrh dataset uvr dataset store zcompon vector veloc field dataset dimens nxnz store real doubleprecis float point valu name dataset hdf file contain dataset arbitrari need specifi user via command line argument execut fastsf user prefer use command line argument hdf file default name uvrh dataset uvr scalar field one dataset requir dataset store scalar field dataset dimens nxnz store real doubleprecis float point valu name dataset hdf file contain dataset arbitrari need specifi user via command line argument execut fastsf user prefer use command line argument hdf file default name tfrh dataset tfr three dimension field vector field three hdf file requir dataset store xcompon vector veloc field dataset dimens nxnynz store real doubleprecis float point valu name dataset hdf file contain dataset arbitrari need specifi user via command line argument execut fastsf user prefer use command line argument hdf file default name uvrh dataset uvr dataset store ycompon vector veloc field dataset dimens nxnynz store real doubleprecis float point valu name dataset hdf file contain dataset arbitrari need specifi user via command line argument execut fastsf user prefer use command line argument hdf file default name uvrh dataset uvr dataset store zcompon vector veloc field dataset dimens nxnynz store real doubleprecis float point valu name dataset hdf file contain dataset arbitrari need specifi user via command line argument execut fastsf user prefer use command line argument hdf file default name uvrh dataset uvr scalar field vector field one hdf file requir dataset store scalar field dataset dimens nxnynz store real doubleprecis float point valu name dataset hdf file contain dataset arbitrari need specifi user via command line argument execut fastsf user prefer use command line argument hdf file default name tfrh dataset tfr import vector field must ensur dimens ux uy uz otherwis code throw error ii parayaml detail user specifi relev paramet via command line via paramet file commandlin option given entri paramet file taken first explain use paramet file proceed commandlin option fastsf folder name folder contain input field file hdf format paramet file name parayaml need provid requir input paramet file detail entri follow program scalar_switch enter true fals true calcul structur function given scalar field fals calcul structur function given veloc field program d_switch enter true fals true calcul structur function two dimension field fals calcul structur function three dimension field program only_logitudin entri structur function veloc field enter true fals true comput longitudin structur function fals comput longitudin transvers structur function program processors_x number processor xdirect integ valu accept note valu integ factor total number processor grid nx ny nz applic test switch set true case code gener input field number point along x z direct respect grid valid vector scalar field two dimension field need provid nx nz integ valu accept domain_dimens lx ly lz length cubic box along x z direct respect two dimension field need provid lx lz structure_funct q q lower upper limit order structur function comput test test_switch enter true fals true run test mode ideal veloc scalar field gener intern code comput structur function compar analyt result code pass percentag differ two result less e fals regular mode code read field hdf file folder iii run instruct commandlin argument run fastsf chang fastsf directori ensur input hdf file follow schema describ previou subsect want relev paramet read inparayaml simpli type follow mpirun np number mpi processor srcfastsfout fastsf allow user pass input paramet use command line argument well input provid via commandlin correspond input read inparayaml file get overriden user also specifi input output hdf file name via commandlin command line argument given follow mpirun np number mpi processor srcfastsfout scalar_switch d_switch l only_longitudin p processors_x x nx ny z nz x lx ly z lz q q test_switch u name hdf file contain dataset store ux u name dataset store ux v name hdf file contain dataset store uy v name dataset store uy w name hdf file contain dataset store uz w name dataset store uz q name hdf file contain dataset store scalar q name dataset store scalar p name hdf file store transvers structur function l name hdf file store longitudin structur function h help user need give command line argument argument provid read inparayaml file user want run fastsf processor processor x direct want comput longitudin structur function follow command enter mpirun np srcfastsfout p l true case number processor xdirect longitudin structur function switch taken via command line rest paramet taken inparayaml file note nx ny nz specifi test case case code gener input field iv output inform unless specifi otherwis user via commandlin argument follow output file written fastsf veloc structur function logitudin transvers structur function order q store file sf_grid_pllh sf_grid_perph respect sf_grid_pllh sf_grid_perph dataset name sf_grid_pllq sf_grid_perpq respect dataset store twothre dimension array twothre dimension input field scalar structur function structur function order q store file sf_grid_scalarh consist dataset name sf_grid_scalarq memori requir memori requir per processor run fastsf depend primarili resolut grid memori requir also depend number order structur function comput number processor p distribut processor x z direct memori requir byte estim follow two dimension scalar field nnsubxsubnsubzsub nsubxsubpsubxsub nsubzsubpsubxsubp p three dimension scalar field nnsubxsubnsubysubnsubzsub nsubxsubnsubysub nsubxsubpsubxsub nsubzsubpsubxsubp p two dimension vector field nnsubxsubnsubzsub nsubxsubpsubxsub nsubzsubpsubxsubp p longitudin structur function comput nnsubxsubnsubzsub nsubxsubpsubxsub nsubzsubpsubxsubp p longitudin transvers structur function comput three dimension vector field nnsubxsubnsubysubnsubzsub nsubxsubnsubysub nsubxsubpsubxsub nsubzsubpsubxsubp p longitudin structur function comput nnsubxsubnsubysubnsubzsub nsubxsubnsubysub nsubxsubpsubxsub nsubzsubpsubxsubp p longitudin transvers structur function comput express psubxsub refer number process x direct p refer total number processor note larg nsubzsub first term domin remain term thu memori requir quickli estim use first term document valid document found fastsfdocsindexhtml valid fastsf report herehttpsgithubcomshubhadeepsadhukhanfastsfblobmasterdocsverificationmd contribut bug report welcom contribut project wish contribut pleas creat branch pull requesthttpsgithubcomshubhadeepsadhukhanfastsfpul chang discuss find bug error document pleas open new issuehttpsgithubcomshubhadeepsadhukhanfastsfissuesnew github repositori report bug error pleas provid suffici inform bug reproduc licens fastsf releas term bsd new licens test valid fastsf valid fastsf compar numer result analyt result ideal u theta field well predict k kolmogorov b problem consid follow veloc scalar field u x z theta x z field analyt shown longitudin veloc structur function scalar structur function ssubqsubsupusubllsubsup lsubxsubsupsup lsubzsubsupsupsupqsup lsupqsup ssubqsubsupthetasup lsubxsub lsubzsubsupqsup run fastsf comput veloc scalar structur function field resolut field domain size supsup x respect plot second thirdord longitudin veloc structur function versu l fig clearli ssubsubsupusubllsubsup l ssubsubsupusubllsubsup l equal lsupsup lsupsup respect consist analyt result figur exhibit densiti plot comput secondord scalar structur function ssubsubsupthetasup l along lsubxsub lsubzsubsupsup two plot similar thu show fastsf comput scalar structur function correctli figur img srcfigssf_velocity_rdpng alttrulli stylewidth figcaptionfig veloc field defin problem plot second thirdord longitudin structur function vs l second thirdord structur function equal lsupsup lsupsup respectivelyfigcapt figur figur img srcfigssf_scalardpng alttrulli stylewidth figcaptionfig scalar field defin problem densiti plot secondord scalar structur function function displac vector b densiti plot lsubxsub lsubzsubsupsup analyt valu secondord scalar structur function two densiti plot similarfigcapt figur problem consid follow veloc scalar field u x z theta x z field analyt shown longitudin veloc structur function scalar structur function ssubqsubsupusubllsubsup lsubxsubsupsup lsubysubsupsup lsubzsubsupsupsupqsup lsupqsup ssubqsubsupthetasup lsubxsub lsubysub lsubzsubsupqsup run fastsf comput veloc scalar structur function field resolut field domain size supsup x x respect plot second thirdord longitudin veloc structur function versu l fig clearli ssubsubsupusubllsubsup l ssubsubsupusubllsubsup l equal lsupsup lsupsup respect consist analyt result figur exhibit densiti plot comput secondord scalar structur function ssubsubsupthetasup lsubxsub lsubzsub lsubysub plane along lsubxsub lsubzsubsupsup two plot similar thu show fastsf comput scalar structur function correctli problem use test case code user requir execut shell script fastsfruntestsh run test case code gener veloc scalar field per relat comput structur function code comput percentag differ theoret comput valu structur function error exceed x supsup code deem pass figur img srcfigssf_velocity_rdpng alttrulli stylewidth figcaptionfig veloc field defin problem plot second thirdord longitudin structur function vs l second thirdord structur function equal lsupsup lsupsup respectivelyfigcapt figur figur img srcfigssf_scalardpng alttrulli stylewidth figcaptionfig scalar field defin problem densiti plot secondord scalar structur function function displac vector lsubysub plane b densiti plot lsubxsub lsubzsubsupsup analyt valu secondord scalar structur function lsubysub two densiti plot similarfigcapt figur problem consid classic result kolmogorov kolmogorov b incompress hydrodynam turbul homegen isotropi flow inerti rang compris scale lie largescal forc regim smallscal dissip regim thirdord longitudin veloc structur function given ssubsubsupusubllsubsup l epsilonl epsilon viscou dissip rate kolmogorova b frisch verma arbitrari order q levequ propos longitudin structur function scale ssubsubsupusubllsubsup l lsupzetasubqsubsup expon zetasubqsub given zetasubqsub q supqsup comput longitudin veloc structur function q use simul data hydrodynam turbul reynold number simul perform use tarang verma et al chatterje et al supsup grid domain size pi x pi x pi detail simul refer sadhukhan et al run fastsf shaheen ii comput structur function employ mpi process normal third fifth seventhord longitudin veloc structur function epsilonlsupzetasubqsubsup zetasubqsub given shelevequ relat plot neg quantiti versu l fig figur clearli show inerti rang l normal thirdord longitudin veloc structur function fairli close repres dash line consist kolmogorov theori moreov normal fifth seventhord structur function show plateau rang l thu exhibit consist shelevequ model note expect accur result higher resolut simul verma et al result obtain problem thu valid fastsf figur img srcfigssf_hydropng alttrulli stylewidth figcaptionfig homogen isotrop turbul problem plot neg normal third fifth seventhord structur function vs l neg normal thirdord structur function close dash line inerti rangefigcapt figur bibliographi chatterje g verma k kumar samtaney r hadri b khurram r scale fast fourier transform pseudospectr fluid solver core j parallel distrib comput doijjpdc frisch u turbul legaci n kolmogorov cambridg cambridg univers press doicbo kolmogorov n dissip energi local isotrop turbul dokl acad nauk sssr doirspa kolmogorov n b local structur turbul incompress viscou fluid larg reynold number dokl acad nauk sssr doirspa sadhukhan samuel r verma k stepanov r plunian f samtaney r enstrophi transfer helic turbul phi rev fluid doiphysrevfluid z levequ e univers scale law fulli develop turbul phi rev lett doiphysrevlett verma k energi transer fluid flow multiscal spectral perspect cambridg cambridg univers press doi verma k chatterje g reddi yadav r k paul chandra samtaney r benchmark scale studi pseudospectr code tarang turbul simul pramanaj phi doi