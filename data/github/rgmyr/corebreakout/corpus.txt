titl corebreakout subsurfac core imag depthregist dataset tag python imag process deep learn geolog geoscienc subsurfac author name ross g meyer orcid x affili name thoma p martin orcid affili name zane r jobe orcid affili affili name depart geolog geolog engin colorado school mine index date decemb bibliographi paperbib summari core sampl cylindr rock sampl taken subsurfac borehol commonli use earth scientist studi geolog histori process core usual cut onemet segment slab lengthwis expos flat surfac store cardboard wooden box photograph enabl remot inspect unlik common sourc borehol data eg well log rider core data preserv true geolog scale heterogen geologist often describ core visual inspect handdraw graphic log vertic chang grain size rock properti eg jobe descript process time consum subject result data analog digit structur core imag data allow develop autom semiautom workflow turn facilit quantit analysi million meter core store public privat repositori around world corebreakout python packag provid two main function deep learn workflow transform raw imag geolog core sampl box depthregist dataset corecolumn data structur store manipul depthregist imag data former use mask rcnn algorithm instanc segment built around open sourc tensorflow kera implement releas matterport inc abdulla mask rcnn workflow primari user workflow enabl corebreakout depict figur straightforward geologist add label train imag use labelm wada russel configur train new mask rcnn model label imag subsequ use train model process unlabel imag compil depthalign dataset primari user workflowjoss_figure_workflowpng futur would like train gener model anticip user train segment model found label imag point diminish return segment accuraci number like depend consist imag layout core materi within given dataset train model load use coresegment class provid method process imag use model accord userspecifi layout paramet corecolumn data structur main piec function provid corebreakout corecolumn class contain depthregist singlecolumn imag core materi allow joint manipul imag associ depth array corecolumn may slice stack iter includ save load plot function usag detail found document provid corecolumn tutori gener function corebreakout support standard vertic horizont core imag layout provid sever method measur assign depth core sampl column includ label arbitrari measur stick object eg ruler empti tray provid label dataset courtesi british geolog survey opengeosci projecthttpswwwbgsacukdatabmdhtml well mask rcnn model train dataset test demonstr addit core python packag sourc code includ script train model extract text metadata imag optic charact recognit smith process directori imag save model corebreakout use compil larg imag dataset ongo work imagebas litholog classif martin plan releas model code separ project use corecolumn data structur combin depthregist imag data sampl well log data interv label multimod dataset sequenc predict acknowledg would like acknowledg contribut open sourc subsurfac core imag british geolog survey httpsbgsacuk financi support chevron chevron center research excel colorado school mine httpscoreminesedu refer changelog notabl chang project document file format base keep changeloghttpkeepachangelogcomen project adher semant versioninghttpsemverorgspecvhtml unreleas todo refactor polygondataset use labelm imagedata field rather requir jpeg chang increas flexibl includ script convert docsmd file rst minor paper bibliographi correctionsfix ad built sphinxgener html doc host readthedoc implement corecolumniter_chunk ad demoinspect notebook column_demoipynb segmenter_demoipynb inspect_datasetipynb ad explanatori markdown select_modelipynb ad restrict setuppi requir tensorflow instal chang modifi code format use black readmemd instal instruct move paper file root directori ad requirementstxt except imgaug includ setuppi contribut licens code_of_conduct file testsnotebook test corecolumn save load remov superflu notebook script initi privat version corebreakout statushttpsjosstheojorgpapersaddffdcdbfdstatussvghttpsjosstheojorgpapersaddffdcdbfd requir instal contribut guidelin found full usag api document found corebreakoutreadthedocsiohttpscorebreakoutreadthedocsioenlatest overview corebreakout python packag built around matterportmask_rcnnhttpsgithubcommatterportmask_rcnn segment depthalign geolog core sampl imag provid util api enabl workflow depict figur well corecolumn data structur manag manipul result depthregist imag data joss_figure_workflowpng current use packag enabl research litholog predict slab core photo use machin learn modelshttpsfigsharecomarticleslithology_prediction_of_slabbed_core_photos_using_machine_learning_model work get doi project journal open sourc softwarehttpsjosstheojorg get start target platform packag develop linux ubuntu popo also test os x may work platform make guarante requir addit python packag list requirementstxtrequirementstxt requir notabl except list tensorflowgpu possibl tensorflow mrcnn via submodul matterportmask_rcnnhttpsgithubcommatterportmask_rcnntreedeaecddedafbdddcbc tensorflow requir explicitli list requirementstxt due ambigu tensorflow tensorflowgpu version latter almost certainli requir train new model although may possibl perform infer save model cpu use corecolumn data structur requir gpu note tensorflow gpu capabl implement cudahttpsdevelopernvidiacomcudazon requir support nvidia gpuhttpsdevelopernvidiacomcudagpu addit option requir option jupyt requir run demo test notebook pytest requir run unit test manual instal plan modifi contribut packag sourc code also provid script extract topbas depth core imag text use pytesseract instal tesseract ocr enginehttpsgithubcomtesseractocrtesseract machin instal pytesseract packag conda pip download code git clone recursesubmodul httpsgithubcomrgmyrcorebreakoutgit cd corebreakout download data option make use provid dataset model train new model start pretrain coco weight need download assetszip folder v releasehttpsgithubcomrgmyrcorebreakoutreleasestagv unzip place folder root directori repositori content ignor git see gitignor would like place elsewher modifi path corebreakoutdefaultspyhttpsgithubcomrgmyrcorebreakoutblobmastercorebreakoutdefaultspi point prefer locat current version assetsdata json annot file includ imagedata field repres associ imag string delet field reduc size data scriptsprune_imagedatapi python scriptsprune_imagedatapi asset instal recommend instal corebreakout depend isol environ recommend use conda see conda manag environmentshttpsdocscondaioprojectscondaenlatestuserguidetasksmanageenvironmentshtml creat new conda environ call corebreakoutenv activ conda creat n corebreakoutenv python tensorflowgpu conda activ corebreakoutenv note want tri cpuonli instal replac tensorflowgpu tensorflow may also lower version number machin cuda requir tensorflow see tensorflow gpu requirementshttpswwwtensorfloworginstallgpusoftware_requir compat detail instal rest requir packag environ conda instal file requirementstxt final instal mrcnn corebreakout use pip develop mode instal e recommend requir corebreakout sinc mani user want chang default paramet suit data without reinstal afterward pip instal mask_rcnn pip instal e usag pleas refer readthedoc pagehttpscorebreakoutreadthedocsioenlatest full document develop commun guidelin submit issu navig repositori issu tabhttpsgithubcomrgmyrcorebreakoutissu search exist relat issu necessari creat submit new issu contribut pleas see contributingmdcontributingmd code conductcode_of_conductmd contribut project test corebreakout function requir train model weight verifi pytest cd root_directori pytest model usag via coresegment class verifi run testsnotebookstest_inferenceipynb requir save model weight plot corecolumn verifi run testsnotebookstest_plottingipynb contributor coven code conduct pledg interest foster open welcom environ contributor maintain pledg make particip project commun harassmentfre experi everyon regardless age bodi size disabl ethnic gender ident express level experi nation person appear race religion sexual ident orient standard exampl behavior contribut creat posit environ includ use welcom inclus languag respect differ viewpoint experi grace accept construct critic focus best commun show empathi toward commun member exampl unaccept behavior particip includ use sexual languag imageri unwelcom sexual attent advanc troll insultingderogatori comment person polit attack public privat harass publish other privat inform physic electron address without explicit permiss conduct could reason consid inappropri profession set respons project maintain respons clarifi standard accept behavior expect take appropri fair correct action respons instanc unaccept behavior project maintain right respons remov edit reject comment commit code wiki edit issu contribut align code conduct ban temporarili perman contributor behavior deem inappropri threaten offens harm scope code conduct appli within project space public space individu repres project commun exampl repres project commun includ use offici project email address post via offici social media account act appoint repres onlin offlin event represent project may defin clarifi project maintain enforc instanc abus harass otherwis unaccept behavior may report contact project team rossmeyerutexasedu project team review investig complaint respond way deem appropri circumst project team oblig maintain confidenti regard report incid detail specif enforc polici may post separ project maintain follow enforc code conduct good faith may face temporari perman repercuss determin member project leadership attribut code conduct adapt contributor covenanthomepag version avail httpcontributorcovenantorgversionvers homepag httpcontributorcovenantorg version httpcontributorcovenantorgvers contribut fork creat featur branch pass pytest test verifi testsnotebook run without error updat changelogmd describ chang unreleas section submit pull request script contain util gener handl pascalvoc style xml data label creat label eg labelimg use scheme assign interv label aggreg corecolumn imag use downstream ml pipelin relat code releas concurr paper later date entir separ corebreakout function may use peopl interest undertak similar project feel free rais issu email rossmeyeratutexasedu guidanc may also integr function main packag start eg corecolumniter_chunk basic split save column imag array small enough save jpeg dimens limit assign label interv labelimglink final snap concaten xml label convert rowwis label array split_npy_imagepi take imagenpi depthnpi file src write set imag jpeg size limit dstwell join_xml_labelspi concaten xml label file src directori write row label file requir model dst script refer train_mrcnn_modelpi train new mrcnn model start pretrain coco weight option argument h help show help messag exit step step mani step train head entir model model_dir model_dir directori creat new train subdirectori checkpoint tensorboard log data_dir data_dir directori find train test subdirectori contain label imag extract ocr top base depth imag pytesseract get_ocr_depthspi extract ocr top base depth imag pytesseract option argument h help show help messag exit root_dir root_dir common parent directori target subdir directori subdir subdir string contain name target subdirectori save_nam save_nam name depth csv file save match subdir forc flag forc overwrit exist save_namecsv file inspect flag inspect imag print ocr output whenev issu exampl test script run code none cd script python get_ocr_depthspi root_dir testsdata subdir two_image_dataset save_nam auto_depths_test save new file testsdatatwo_image_datasetauto_depths_testcsv content like code topbottom sjpeg sjpeg note misread least bg imag manual correct usual requir provid templat depth_csv file requir run process_directorypi process_directorypi process directori raw imag mask rcnn save result corecolumn path given contain imag jpeg file depth_csv file format code top bottom filenam top bottom filenamen topn bottomn note model config class_nam segment layout_param chang manual top script default configur defaultspi httpsgithubcomrgmyrcorebreakoutblobmastercorebreakoutdefaultspy_ posit argument path path directori imag depth inform csv process option argument h help show help messag exit model_dir model_dir directori load mrcnn model defaultdefaultsmodel_dir weights_path weights_path path model weight load defaultdefaultscb_model_path add_tol add_tol gap toler ad corecolumn object default add_mod add_mod corecolumnadd_mod one fill collaps depth_csv depth_csv name filenam top bottom csv read path defaultauto_depthscsv save_dir save_dir path save corecolumn defaultnon save path save_nam save_nam name use corecolumnsav defaultnon result corecolumn_top_bas save_mod save_mod one pickl numpi whether save singl pkl file multipl npi file assum youv download unzip asset folder default locat test script default paramet run code cd script python process_directorypi testsdatatwo_image_dataset depth_csv dummy_depthscsv save aggreg corecolumn testsdatatwo_image_datasetcorecolumn__pkl prune_imagedatapi remov imagedata field json file tree path posit argument path path parent target json file option argument h help show help messag exit _modelbuild build mask rcnn model best result user want train model data see refcreatingdataset guidelin may releas gener pretrain model futur pend demand avail open sourc dataset feel free contact us would like contribut data purpos rough outlin model construct train look like code python import mrcnnmodel modellib corebreakout import default dataset model_config defaultsdefaultconfig train_dataset datasetspolygondataset test_dataset datasetspolygondataset model modellibmaskrcnn modeltraintrain_dataset test_dataset finer detail see scriptstrain_mrcnn_modelpi httpsgithubcomrgmyrcorebreakoutblobmasterscriptstrain_mrcnn_modelpy__ mrcnn model configur model creat subclass mrcnnconfigconfig see corebreakoutdefaultsdefaultconfig latest model configur see avail configur paramet see mrcnnconfigpi httpsgithubcommatterportmask_rcnnblobdeaecddedafbdddcbcmrcnnconfigpy__ obviou paramet user might want chang includ name rpn_anchor_ratio default set horizont column someth like would make sens vertic column steps_per_epoch validation_step batch per train epoch valid step necessarili need match dataset size images_per_gpu tri increas larg gpu gpu_count increas multipl gpu either modifi defaultconfig directli instanti config subclass model train simplest way train model run scriptstrain_mrcnn_modelpi httpsgithubcomrgmyrcorebreakoutblobmasterscriptstrain_mrcnn_modelpy__ script load pretrain coco weight execut three step train tune run also serv demonstr dataset collect instanti train mrcnnmodellibmaskrcnn train mrcnn log tensorboard file specifi model_dir view file run tensorboard logdir model_dir model select recommend view tensorboard file particularli val_loss scalar select candid model notebooksselect_modelipynb httpsgithubcomrgmyrcorebreakoutblobmasternotebooksselect_modelipynb__ provid templat view output candid model test dataset note mrcnn save checkpoint epoch start tensorboard log epoch start epoch x look good tensorboard want refer epoch x list candid load correspond weight use model train select new model may want chang path variabl corebreakoutdefaultspi point locat new model weight path get referenc default scriptsprocess_directorypi etc altern alway pass whatev model_dir weights_path model_config instanc like construct coresegment corebreakout document master file creat sphinxquickstart fri apr adapt file complet like least contain root toctre direct welcom corebreakout document project repositori rgmyrcorebreakout httpsgithubcomrgmyrcorebreakout_ mrcnn repositori matterportmask_rcnn httpsgithubcommatterportmask_rcnn_ corebreakout provid two main function deep learn workflow transform raw imag geolog core sampl box depthregist dataset facilit coresegment api corecolumn data structur store manipul depthregist imag data workflowfigur document cover usag corebreakout dig finer detail mask rcnn model implement pleas refer mrcnn document provid data provid label imag british geolog survey north sea collect well save mask rcnn model train data pretrain coco model start new train run use data model download assetszip folder releas page httpsgithubcomrgmyrcorebreakoutreleases_ unzip root directori project modifi path defaultspi httpsgithubcomrgmyrcorebreakoutblobmastercorebreakoutdefaultspy_ point locat json annot data current contain superflu field call imagedata take memori file delet field reduc file size scriptsprune_imagedatapi code python scriptsprune_imagedatapi asset want use data label imag mask rcnn train follow guidelin refcreatingdataset recommend start imag overview imag process workflow your look use data probabl need label imag best result follow guidelin refcreatingdataset train mask rcnn model use label data model configur train select explain refmodelbuild use train model process directori unlabel imag save result corecolumn provid scriptsprocess_directorypi httpsgithubcomrgmyrcorebreakoutblobmasterscriptsprocess_directorypy__ facilit step requir save model weight csv file list top bottom depth imag directori make creat csv easier provid scriptsget_ocr_depthspi httpsgithubcomrgmyrcorebreakoutblobmasterscriptsget_ocr_depthspy_ coresegment class scriptsprocess_directorypi httpsgithubcomrgmyrcorebreakoutblobmasterscriptsprocess_directorypy__ use corebreakoutcoresegment api handl convert imag corecolumn may also use class directli code python segment corebreakoutcoresegment model_dir weights_path model_config corebreakoutdefaultsdefaultconfig class_nam corebreakoutdefaultsclass layout_param corebreakoutdefaultslayout_param img array path imag column segmentersegmentimg top_depth base_depth kwarg iter imag path depth rang pair column segmentersegment_allimg depth_rang kwarg class_nam correspond dataset model train layout_param explain detail reflayoutparamet document corecolumn class object contain depthregist imag data column ad slice plot iter chunk save load either singlefil pkl format multifil npi format demonstr corecolumn api see notebookscolumn_demopi httpsgithubcomrgmyrcorebreakoutblobmasternotebookscolumn_demoipynb__ toctre maxdepth caption usag document creating_dataset model_build layout_paramet scripts_refer indic tabl refgenindex refmodindex refsearch workflowfigur imag imagesjoss_figure_workflowpng _creatingdataset creat dataset use labelm recommend way add new set label train imag annot use wkentarolabelm httpsgithubcomwkentarolabelme__ labelm gui allow user draw number label polygon imag save label coordin json annot file easili instal labelm pip open small test dataset code pip instal labelm labelm testsdatatwo_image_dataset open window look like imag new polygon drawn click creat polygon click point imag add vertic get back around start vertex close loop point creat polygon labelm ask assign text label uniqu text label aggreg right side individu polygon shown imag color list assign label happen exampl could label label list polygon polygon label list given imag directori finish ad polygon click save button export annot json file default save current directori file list show imag current directori checkbox indic whether annot save file yet use next imag previou imag button travers imag correspond annot directori inspect annot handson explor annot structur dataset api see notebooksinspect_datasetpi httpsgithubcomrgmyrcorebreakoutblobmasternotebooksinspect_datasetipynb__ name thing see text label individu object form classnumb class refer gener object type number differenti individu instanc class within imag isnt possibl name scheme one use want annot compat polygondataset implement data use two class col tray label two differ type object col column core materi individu object want segment crop stack top tray empti tray data reliabl measur stick use defin top base posit column within imag first type object requir whole purpos workflow segment core column need least label second type object option use anoth object empti tray measur stick etc defin top base posit column one option endpt set reflayoutparamet other requir exist object core column your make dataset class name whatev want need least name core column keep gener consist polygondataset train model use annot save kwarg provid instanti coresegment name class argument polygondataset col_class possibl endpt field layout_param decid use differ class name layout paramet wed recommend chang class layout_param defaultspi httpsgithubcomrgmyrcorebreakoutblobmastercorebreakoutdefaultspy__ dont specifi often remov imagedata labelm save field call imagedata encod entir imag string consum quit bit unnecessari memori polygondataset class doesnt make use field weve provid script delet json file root path code python scriptsprune_imagedatapi path summari guidelin abl use builtin corebreakoutdatasetspolygondataset class train data want adher guidelin save fnamejson annot flat directori correspond fnamejpeg file labelm default behavior may label number class suppli list class polygondataset coresegment constructor modifi defaultsclass minimum want class name repres column core call col doesnt matter want call your use data may also creat class eg tray object consist demarc top base posit core column better column differ instanc class begin class name differenti afterward eg col col col corollari class name substr class name eg col col_tray would allow multipl polygon may belong singl instanc exampl there larg gap middl column annot imag split sibl train test subdirectori note weve found point diminish return happen somewher rang train imag probabl correspond column instanc dataset ymmv compil annot may wish modifi defaultsdataset_dir avoid need explicitli specifi data locat corebreakoutdatasetspolygondataset subclass mrcnnutilsdataset instanc segment annot default json format wkentarolabelm httpsgithubcomwkentarolabelme__ usag corebreakoutdataset import polygondataset data_dir defaultsdefault_data_dir parent separ annot data directori subset train subdirectori read dataset polygondatasetclassesdefaultsdefault_class collect requi id path inform datasetcollect_annotated_imagesdata_dir subset set attr requir use datasetprepar printdataset two dataset object train test requir call modeltrain split separ directori subclass mrcnnutilsdataset want use differ annot format inherit base mrcnnutilsdataset class need write usercal method collect file inform eg collect_annotated_imagesdata_dir subset regist image_id path ann_path imag annot file pair data_dirsubset directori overrid least two method load_maskimage_id given image_id load comput necessari correspond mask n object includ background return valu function mask class_id mask boolean array shape hwn class_id integ array size n one class_id channel mask image_referenceimage_id return path imag link uniqu properti help look debug imag imag imageslabelmepng _layoutparamet layout paramet corebreakout allow process core imag differ layout provid sever differ method find crop bound box individu column within imag layout paramet use within coresegmenterseg method default paramet overridden updat coresegment constructor singl call segment method either case pass new paramet dict layout_param keyword argument default paramet reflect characterist bg dataset exampl model train code python corebreakoutdefaultspi layout_param order tb orient lr col_height col_class col endpt tray develop note allow valu order orient tb lr cover convent core imag layout awar would consid ad bt rl provid usecas one pleas open issu submit pull request order orient order paramet specifi depth order sort set column detect imag tb impli column laid horizont uppermost column come first order depth lr impli column laid vertic leftmost column come first order depth orient paramet specifi depth orient column convers order tb impli top vertic column toward top imag lr impli top horizont column toward left side imag sinc requir order one option orient requir redund howev make explicit improv code readabl make easier add option choos futur releas col_height col_height paramet specifi height depth unit usual meter feet individu complet column valu use conjunct depth_rang posit argument find number expect column imag call coresegmentersegmentimg depth_rang kwarg col_class name class repres core sampl column mrcnn model use coresegment instanc endpt endpt paramet determin method make sure crop top base partial column extend locat approxim col_height apart differ option may work better wors depend clean sampl consist layout predict mask tend subset true mask short column extend longer column shorten see exampl imag comput minim endpoint locat shown solid yellow line result column bound box shown green dash line allow valu endpt includ name class eg tray result column extend top base strongest detect class must found class_nam attribut coresegment instanc typic choic would empti tray measur stick commonli place next box core imag one keyword auto auto_al result column extend minmax coordin set detect object auto use object col_class relev set eg col detect first exampl auto_al use object imag eg col tray detect second exampl imag imag tupl explicit integ endpoint coordin eg result column extend least minmax coordin imag imag imag imagesendpts_traypng imag imag imagesendpts_autopng imag imag imagesendpts_auto_allpng imag imag imagesendpts_explicitpng corebreakout packag subpackag toctre corebreakoutdataset submodul corebreakoutcolumn modul automodul corebreakoutcolumn member undocmemb showinherit corebreakoutdefault modul automodul corebreakoutdefault member undocmemb showinherit corebreakoutsegment modul automodul corebreakoutsegment member undocmemb showinherit corebreakoututil modul automodul corebreakoututil member undocmemb showinherit corebreakoutviz modul automodul corebreakoutviz member undocmemb showinherit modul content automodul corebreakout member undocmemb showinherit corebreakoutdataset packag submodul corebreakoutdatasetspolygondataset modul automodul corebreakoutdatasetspolygondataset member undocmemb showinherit modul content automodul corebreakoutdataset member undocmemb showinherit corebreakout toctre maxdepth corebreakout