doihttpszenodoorgbadgedoizenodosvghttpsdoiorgzenodo staphopiapap code use staphopia manuscript titl result section public metadata output pdf_document default r librarystaphopia librarydplyr libraryggplot libraryreshap aggreg data public sampl first well get publicli avail aureu sampl r ps get_public_sampl r tostringnrowp sampl work next acquir metadata associ sampl also get inform pertain submiss year public link made r submiss get_submission_by_year publication_link get_publication_link next go pull metadata associ public sampl r metric merg ps get_metadatapssample_id bysample_id go add two column rank_nam year r metricsyear sappli metricsfirst_publ functionx strsplitx metricsrank_nam ifels metricsrankx gold ifels metricsrankx silver bronz public inform summari detail look total submiss public statu r tsubmissionssubmissionsyear maxsubmissionsyear inform public link made r tpublication_link row name follow elink number sampl link pubm id identifi elink text number sampl link pubm id identifi text mine elink elink_pmid number pubm id identifi elink text_pmid number pubm id identifi text mine elink total total number sampl associ pubm id total_pmid total number pubm id associ publish sampl percent sampl publish r stat submissionssubmissionsyear maxsubmissionsyear statsoverall_publish statsoveral publish vs unpublish submiss per year r figwidth figasp melt meltsubmiss idcyear measurevar cpublish unpublish meltedtitl ifelsemeltedvari publish publish unpublish p ggplotdatamelt aesxyear yvalu filltitl xlabyear ylabcount geom_barstatident positiondodg geom_textaeslabelvalu vjust posit position_dodg scale_fill_manualvaluesccaf abac scale_x_continuousbreak round seqminsubmissionsyear maxsubmissionsyear theme_bw themeaxistextelement_texts axistitleelement_textsizefacebold legendtitl element_blank p overal publish vs unpublish submiss r figur pub figwidth figasp melt meltsubmiss idcyear measurevar coverall_publish overall_unpublish meltedtitl ifelsemeltedvari overall_publish publish unpublish p ggplotdatamelt aesxyear yvalu filltitl xlabyear ylabcumul count geom_barstatident positiondodg geom_textaeslabelvalu vjust posit position_dodg scale_fill_manualvaluesccaf abac scale_x_continuousbreak round seqminsubmissionsyear maxsubmissionsyear theme_bw themeaxistextelement_texts axistitleelement_textsizefacebold legendtitl element_blank p overal publish vs unpublish submiss r figur pub figwidth figasp melt meltsubmiss idcyear measurevar coverall_publish overall_unpublish meltedtitl ifelsemeltedvari overall_publish publish unpublish meltedfin ifelsemeltedyear meltedvalu p ggplotdatamelt aesxyear yvalu filltitl labelfin xlabyear ylabcumul count geom_barstatident positionstack geom_textposit position_stackvjust geom_textaesyear overal label overal fill null data submiss scale_fill_manualvaluesccaf abac scale_x_continuousbreak round seqminsubmissionsyear maxsubmissionsyear theme_bw themeaxistextelement_texts axistitleelement_textsizefacebold legendtitl element_blank p output plot pdf png staphopiawrite_plotp pastegetwd figuresfiguresubmissionpublishedperyear metadata inform number sampl collect date r has_collection_d nrowmetricsmetricscollection_d pastehas_collection_d has_collection_d nrowmetr number sampl locat inform r has_loc nrowmetricsmetricsloc unknownmiss pastehas_loc has_loc nrowmetr number locat r nrowasdataframetablemetricsmetricsloc unknownmissingloc countri r country_data asdataframet metricsmetricscountri unknownmiss metricscountri countri colnamescountry_data ccountri total country_data arrangecountry_data desctot country_data number countri r pastenrowcountry_data countri repres sumcountry_datatot sampl number sampl isol sourc r has_sourc nrowmetricsmetricsisolation_sourc pastehas_sourc has_sourc nrowmetr isol sourc r df asdataframetablesubstrtolow metricsmetricsisolation_sourc isolation_sourc dforderdffreq number isol sourc r nrowasdataframetabletolow metricsmetricsisolation_sourc isolation_sourc session info r sessioninfo titl result section public sequenc metric output pdf_document default r librarystaphopia libraryggplot libraryreshap aggreg data public sampl first well get publicli avail aureu sampl r ps get_public_sampl also get inform pertain submiss rank year r submiss get_submission_by_yearal true rank get_rank_by_year r tostringnrowp sampl work next acquir metadata sequenc stat assembl stat associ sampl r metric merg ps merg get_assembly_statspssample_id merg get_metadatapssample_id get_sequence_qualitypssample_id stagecleanup bysample_id bysample_id bysample_id go add two column rank_nam year r metricsyear sappli metricsfirst_publ functionx strsplitx metricsrank_nam ifels metricsrankx gold ifels metricsrankx silver bronz visual metric follow section plot visual relationship data year plot submiss per year r figwidth figasp p ggplotdatasubmiss aesxyear ycount xlabyear ylabcount geom_barstatident geom_textaeslabelcount vjust scale_x_continuousbreak round seqminsubmissionsyear maxsubmissionsyear theme_bw themeaxistextelement_texts axistitleelement_textsizefacebold p overal submiss r figur figasp figwidth p ggplotdatasubmiss aesxyear yoveral xlabyear ylabcumul count geom_barstatident geom_textaeslabeloveral vjust scale_x_continuousbreak round seqminsubmissionsyear maxsubmissionsyear theme_bw themeaxistextelement_texts axistitleelement_textsizefacebold p submiss rank r figur bsg figwidth figasp melt meltrank idcyear measurevar cbronz silver gold meltedtitl ifelsemeltedvari gold gold ifelsemeltedvari silver silver bronz meltedrank ifelsemeltedvari gold ifelsemeltedvari silver p ggplotdatamelt aesxyear yvalu filltitl grouprank labeltitl xlabyear ylabcount geom_barstatident positiondodg geom_textaeslabelvalu vjust posit position_dodg scale_fill_manualvaluesccdf daf ccc scale_x_continuousbreak round seqminranksyear maxranksyear theme_bw themeaxistextelement_texts axistitleelement_textsizefacebold legendtitl element_blank p output plot pdf png staphopiawrite_plotp pastegetwd figuresfigurerankperyear assembl size r figwidth figasp p ggplotmetr aesx year total_contig_length geom_boxplot p total contig smaller better r figwidth figasp p ggplotmetr aesx year total_contig geom_boxplot p n r figwidth figasp p ggplotmetr aesx year n_contig_length geom_boxplot p mean contig length r figwidth figasp p ggplotmetr aesx year mean_contig_length geom_boxplot p max contig length r figwidth figasp p ggplotmetr aesx year max_contig_length geom_boxplot p mean read length r figwidth figasp p ggplotmetr aesx year read_mean geom_boxplot p mean perread qualiti score r figwidth figasp p ggplotmetr aesx year qual_mean geom_boxplot p assembl size group rank r figwidth figasp p ggplotmetr aesx year total_contig_length fillrank_nam labelrank_nam geom_boxplot p total contig group rank r figwidth figasp p ggplotmetr aesx year total_contig fillrank_nam labelrank_nam geom_boxplot p n group rank r figwidth figasp p ggplotmetr aesx year n_contig_length fillrank_nam labelrank_nam geom_boxplot p mean contig length group rank r figwidth figasp p ggplotmetr aesx year mean_contig_length fillrank_nam labelrank_nam geom_boxplot p max contig length group rank r figwidth figasp p ggplotmetr aesx year max_contig_length fillrank_nam labelrank_nam geom_boxplot p mean read length group rank r figwidth figasp p ggplotmetr aesx year read_mean fillrank_nam labelrank_nam geom_boxplot p mean perread qualiti score group rank r figwidth figasp p ggplotmetr aesx year qual_mean fillrank_nam labelrank_nam geom_boxplot p rank plot assembl size r figwidth figasp p ggplotmetr aesx rank_nam total_contig_length geom_boxplot p total contig smaller better r figwidth figasp p ggplotmetr aesx rank_nam total_contig geom_boxplot p n r figwidth figasp p ggplotmetr aesx rank_nam n_contig_length geom_boxplot p mean contig length r figwidth figasp p ggplotmetr aesx rank_nam mean_contig_length geom_boxplot p max contig length r figwidth figasp p ggplotmetr aesx rank_nam max_contig_length geom_boxplot p mean read length r figwidth figasp p ggplotmetr aesx rank_nam read_mean geom_boxplot p mean perread qualiti score r figwidth figasp p ggplotmetr aesx rank_nam qual_mean geom_boxplot p coverag r figwidth figasp p ggplotmetr aesx rank_nam coverag geom_boxplot p bronz data coverag qualiti r figwidth figasp p ggplotmetricsmetricsrankx aesx coverag qual_mean geom_point p coverag read length r figwidth figasp p ggplotmetricsmetricsrankx aesx coverag read_mean geom_point p session info r sessioninfo titl result section public genet divers output pdf_document default r librarystaphopia libraryggplot libraryreshap libraryscal section look genet divers sequenc staphylococcu aureu order well use variant count cgmlst mlst measur divers aggreg data public sampl first well get publicli avail aureu sampl r ps get_public_sampl mlst next use mlst inform measur genit divers case interest total number uniqu sequenc type sequenc well use get_st_by_year get basic stat mani st sequenc also use get_top_sequence_typ get st repres databas total number sampl st note arbitrarli larg number retreiv st r sequence_typ get_st_by_year top_st get_top_sequence_typ colnamessequence_typ give us column year column year year uniqu number uniqu st given year novel number st sequenc previous assign sampl st determin assigned_agre sampl program call st agre st assigned_disagre sampl program call st unassign sampl st determin unassigned_agre program unabl assign st unassigned_disagre sampl st determin program agre predicted_novel sampl match loci allel pattern exist sampl st determin agreement program partial sampl st determin agreement two program ariba_blast sampl st determin agreement ariba blast mentalist_blast sampl st determin agreement mentalist blast mentalist_ariba sampl st determin agreement mentalist ariba singl sampl st determin singl program ariba sampl st determin ariba mentalist sampl st determin mentalist blast sampl st determin blast count total number sampl given year overall_x cumul total previou year column x compar mlst predict r mlst get_sequence_typepssample_id metadata merg ps get_metadatapssample_id bysample_id metadatayear sappli metadatafirst_publ functionx strsplitx metadatarank_nam ifels metadatarank gold ifels metadatarank silver bronz r mlst_temp mergemlst metadatacsample_id is_pair bysample_id mlst_tempis_pair ifelsemlst_tempis_pair fals true mlst_tempagr past ifelsemlstst mlstst ifelsemlstmentalist mlstariba mlstmentalist mlstblast ifelsemlstmentalist mlstariba ifelsemlstmentalist mlstblast ifelsemlstblast mlstariba ifelsemlstmentalist ifelsemlstariba ifelsemlstblast mentalist ariba blast mlst_tempagr ifelsemlst_tempis_pair true mlst_tempagr pastesubstrmlst_tempagr substrmlst_tempagr tablemlst_tempagr platform metadatacsample_id instrument_model study_access year rank_nam mlst_temp mergemlst_temp platform bysample_id r tablemlst_tempmlst_tempagr rank_nam tablemlst_tempmlst_tempagr rank_nam tablemlst_tempmlst_tempagr rank_nam pubmlst st count r st_count merg readtabledatapubmlstcountstxt headertru sept staphopia top_sttop_stst cst count byst alltru st_countsisnast_count st_count st_countsst_countspubmlst_count nrowst_count nrowst_countsst_countscount nrowst_countsst_countscount nrowst_countsst_countspubmlst_count nrowst_countsst_countspubmlst_count tablest_countsst_countscount pubmlst_count summaryst_countsst_countscount pubmlst_count st_countsst_countspubmlst_count st_countscount summari mlst divers assign breakdown r tsequence_typessequence_typesyear maxsequence_typesyear top st r top_st give us column st descend order base count column word repres st seen first column st sequenc type count number sampl given st percent percent sampl repres given st overal percent sampl repres given st previou st mani uniqu st repres r nrowtop_sttop_stst mani st repres singl sampl r nrowtop_sttop_stcount visual mlst divers follow section plot visual relationship data uniqu sequenc type year r figwidth figasp p ggplotdatasequence_typ aesxyear yuniqu xlabyear ylabcount geom_barstatident geom_textaeslabeluniqu vjust scale_x_continuousbreak roundseqminsequence_typesyear maxsequence_typesyear theme_bw themeaxistextelement_texts axistitleelement_textsizefacebold p novel sequenc type year r figwidth figasp p ggplotdatasequence_typ aesxyear ynovel xlabyear ylabcount geom_barstatident geom_textaeslabelnovel vjust scale_x_continuousbreak roundseqminsequence_typesyear maxsequence_typesyear theme_bw themeaxistextelement_texts axistitleelement_textsizefacebold p overal novel sequenc type year r figwidth figasp p ggplotdatasequence_typ aesxyear yoverall_novel xlabyear ylabcumul count geom_barstatident geom_textaeslabeloverall_novel vjust scale_x_continuousbreak roundseqminsequence_typesyear maxsequence_typesyear theme_bw themeaxistextelement_texts axistitleelement_textsizefacebold p top sequenc type r figur topst figwidth figasp p ggplotdatatop_st aesxreorderst count ycount xlabsequ type ylabcount geom_barstatident geom_textaeslabelcount vjust theme_bw themeaxistextelement_texts axistitleelement_textsizefacebold p total allel match unassign sampl r figwidth figasp allele_match get_mlst_allele_matchespspsst sample_id df asdataframetableallele_matchesallele_matchesmatch match colnamesdf cmatch count p ggplotdatadf aesxmatch ycount xlabmatch allel ylabcount geom_barstatident geom_textaeslabelcount vjust theme_bw themeaxistextelement_texts axistitleelement_textsizefacebold p cgmlst pattern final well look cgmlst measur genet divers use get_cgmlst function get cgmlst result sampl function might take littl retriev teh result r use_dev prevent timeout problem resolv use_dev true cgmlst get_public_cgmlst_pattern cgmlstpercent cgmlstcount sumcgmlsttotal_sampl cgmlst give us two column samples_in_pattern number sampl given cgmlst pattern count number pattern given number sampl total_sampl number sampl repres row samples_in_pattern count percent percent sampl repres exampl samples_in_pattern count mean count cgmlst pattern share sampl samples_in_count repres total sampl count samples_in_count total number distinct cgmlst pattern r sumcgmlstcount mani share cgmlst pattern r sumcgmlstcgmlstsamples_in_pattern count mani sampl share cgmlst pattern r sumcgmlstcgmlstsamples_in_pattern total_sampl mani sampl uniqu cgmlst pattern r cgmlstpercent cgmlstcount sumcgmlsttotal_sampl cgmlstcgmlstsamples_in_pattern session info r sessioninfo titl result section supplementari subsampl output pdf_document default read data r libraryggplot librarydplyr optionsscipen make_plot function df ylab p ggplotdatadf aesxx yy ylabylab xlabcoverag geom_pointaescolorcolor scale_x_continuousbreak seqmindfx maxdfx theme_bw themeaxistextelement_texts axistitleelement_textsizefacebold returnp result readtabl datasupplementarysubsamplesubsamplesummarytxt header true sep result resultsresultsmut resultssimul ef colnamesresult overview want determin level coverag diminish return observ analysi import high coverag sequenc requir compuat resourc mostli form memori take longer process use cancer genom cloud httpwwwcancergenomicscloudorg process project also import reduc overal cost use runtim assembl metric singleton kmer count determin cutoff coverag coverag improv result simul sequenc simul hiseq miseq sequenc aureu n nc_ refer genom art huang w li l myer jr marth gt art nextgener sequenc read simul bioinformat multipl coverag simul see process staphopia analysi pipelin cgc simul multipl coverag r sortuniqueresultscoverag coverag affect run time r echofals figasp figwidth p make_plot dataframexresultscoverag yresultsruntim colorresultssimul total run time minut p plot evid increas coverag lead longer runtim base simul miseq ms seqeunc tend take longer process hiseq hs coverag affect cost r figwidth figasp p make_plot dataframexresultscoverag yresultspric colorresultssimul total price analysi usd p job cost cgc depend overal runtim plot much differ x x x differ genom cost process genom x coverag cutoff process genom x coverag cutoff roughli differ price coverag affect assembl total number contig r figwidth figasp p make_plot dataframexresultscoverag yresultstotal_contig colorresultssimul total number assembl contig p plot x x coverag contig x coverag suggest coverag may produc best assembl x coverag onward total number contig chang much x look like slight increas total contig total number contig greater bp r figwidth figasp p make_plot dataframexresultscoverag yresultstotal_contig_bp colorresultssimul total contig bp length p look total number contig greater bp similar pattern obersev x x may produc best assembl x coverag onward produc similar number n contig length r figwidth figasp p make_plot dataframexresultscoverag yresultsn_contig_length colorresultssimul assembl n length p similar plot except n appear level around x instead x coverag affect total number singleton kmer r figwidth figasp p make_plot dataframexresultscoverag yresultstotal_singleton colorresultssimul total singleton kmer count p plot appear sequenc depth increas number observ singleton kmer may true singleton sequenc mani assum due sequenc error suggest higher seqeunc depth greater need correct erron read affect analysi result effect much greater miseq hiseq like due differ error profil use art conclus overal use metric describ appear coverag cutoff use without affect result analysi although sampl x x coverag lowest runtim produc assembl could improv coverag sampl x greater coverag produc assembl similar xx coverag took longer process increas cost also singleton kmer leav x x x coverag similar runtim cost assembl kmer three coverag arbitrari select x default coverag cutoff staphopia analysi titl result section antibiot resist pattern output pdf_document default r librarystaphopia libraryggplot libraryreshap libraryscal librarydplyr librarygridextra librarygrid produce_all_plot fals section look resist pattern staphylococcu aureu aggreg data public sampl first well get publicli avail aureu sampl r ps get_public_sampl mrsa mssa defin mrsa presenc meca sampl evid meca classifi mssa primer base classif first well use result primer base sccmec classif identifi sampl full match meca primer import note result identifi sccmec type contain meca exampl sccmec xi mecc includ strict full hit r sccmec_prim get_sccmec_typepssample_id tablesccmec_primermeca r sccmec_count asdataframecolsumssccmec_prim colnamessccmec_count ctotal sccmec_count dataframetyperownamessccmec_count totalsccmec_countstot sccmec_count relax ham distanc r sccmec_type_hd get_sccmec_typepssample_id ham true tablesccmec_type_hdmeca protein base classif r sccmec_protein get_sccmec_protein_hitspssample_id max_scor group_bysccmec_proteinstarget summarisemaxscor maxbitscor sccmec_protein mergesccmec_protein max_scor bytarget r sccmec_proteinsbsr sccmec_proteinsbitscor sccmec_proteinsmaxscor tablesccmec_proteinssccmec_proteinsbsr target r figwidth figasp p ggplotdatasccmec_proteinssccmec_proteinsbsr aesxtarget ylabcount xlabsccmec target geom_bar theme_bw themeaxistextelement_texts axistitleelement_textsizefacebold legendtitl element_blank p r figwidth figasp sccmec_proteinssccmec_proteinstarget meca sccmec_proteins_mec dataframesample_idasample_id bsrabsr sccmec_proteins_mecmec ifels sccmec_proteins_mecbsr true fals p ggplotdatasccmec_proteins_mec aesxbsr xlabblast score ratio ylabcount geom_histogrambinwidth theme_bw themeaxistextelement_texts axistitleelement_textsizefacebold legendtitl element_blank p r figwidth figasp histsccmec_proteins_mecbsr plotfals meca_bsr datafram regionsapplylengthacount functionx pasteabreaksx abreaksx countacount meca_bsr ariba base classif use result ariba via megar identifi sampl predict resist methicillin two way first look result match strict result includ partial assembl relax remind ariba result includ sampl pair end read strict result base match sccmec relat cluster r ariba get_sccmec_aribapssample_id resistance_report true tablearibamec relax result allow partial match sccmec relat cluster r ariba_relax get_sccmec_aribapssample_id resistance_report true include_alltru tableariba_relaxedmec sccmec cassett coverag r sccmec_coverag get_sccmec_cassette_coveragespssample_id group cover sccmec type r tabl top sccmec type map top_typ sccmec_coverag group_bysample_id slice whichmaxtot tabletop_typetop_typetot cassett r lengthtop_typetop_typetot cassett group cover mec region r top_mec sccmec_coverag group_bysample_id slice whichmaxmeca_tot tabletop_mectop_typetot cassett plot top sccmec cover mec region cover mec predict primer r figur sccmec primer figwidth figasp p ggplotdatamergetop_typ sccmec_prim bysample_id aestot meca_tot colour meca ylabmec region cover xlabtop sccmec type cover geom_point scale_fill_manualvaluesccaf abac theme_bw themeaxistextelement_texts axistitleelement_textsizefacebold legendtitl element_blank p mec predict ariba strict r figur sccmec ariba figwidth figasp p ggplotdatamergetop_typ ariba bysample_id aestot meca_tot colour mec ylabmec region cover xlabtop sccmec type cover geom_point scale_fill_manualvaluesccaf abac theme_bw themeaxistextelement_texts axistitleelement_textsizefacebold legendtitl element_blank p mec predict ariba relax r figwidth figasp p ggplotdatamergetop_typ ariba_relax bysample_id aestot meca_tot colour mec ylabmec region cover xlabtop sccmec type cover geom_point scale_fill_manualvaluesccaf abac theme_bw themeaxistextelement_texts axistitleelement_textsizefacebold legendtitl element_blank p plot sccmec cover top mec region cover mec predict primer r figwidth figasp p ggplotdatamergetop_mec sccmec_prim bysample_id aestot meca_tot colour meca ylabtop mec region cover xlabsccmec type cover geom_point scale_fill_manualvaluesccaf abac theme_bw themeaxistextelement_texts axistitleelement_textsizefacebold legendtitl element_blank p mec predict ariba strict r figwidth figasp p ggplotdatamergetop_mec ariba bysample_id aestot meca_tot colour mec ylabtop mec region cover xlabsccmec type cover geom_point scale_fill_manualvaluesccaf abac theme_bw themeaxistextelement_texts axistitleelement_textsizefacebold legendtitl element_blank p mec predict ariba relax r figwidth figasp p ggplotdatamergetop_mec ariba_relax bysample_id aestot meca_tot colour mec ylabtop mec region cover xlabsccmec type cover geom_point scale_fill_manualvaluesccaf abac theme_bw themeaxistextelement_texts axistitleelement_textsizefacebold legendtitl element_blank p plot sccmec type individu function plot r plot_by_sccmectyp functioncoverag column p ggplotdatacoverag aesxtot ymeca_tot colour mec ylabmec region cover xlabpastesccmec type column cover geom_point scale_fill_manualvaluesccaf abac theme_bw themeaxistextelement_texts axistitleelement_textsizefacebold legendtitl element_blank returnp sccmec type individu color ariba strict r figwidth figasp produce_all_plot column uniquesccmec_coveragecassett printplot_by_sccmectyp mergesccmec_coveragesccmec_coveragecassett column ariba bysample_id column sccmec type individu color ariba relax r figwidth figasp produce_all_plot column uniquesccmec_coveragecassett printplot_by_sccmectyp mergesccmec_coveragesccmec_coveragecassett column ariba_relax bysample_id column compar mec predict r mec merg ps datafram sample_idsccmec_proteins_mecsample_id protein_mecsccmec_proteins_mecmec bysample_id alltru mecisnamecprotein_mecprotein_mec fals mec mergemec datafram sample_idsccmec_primersample_id primer_mecsccmec_primermeca bysample_id alltru mec mergemec datafram sample_idaribasample_id ariba_mecaribamec bysample_id alltru mecagr past ifelsemecprotein_mec ifelsemecprimer_mec ifelseisnamecariba_mec ifels mecariba_mec tablemecagr note mec predict mec predict test ariba singleend read order number meca bsr base protein meca full primer hit mec full match base ariba exampl singleend protein primer fals approach agre mec predict approach agre mec predict r metric merg ps merg get_assembly_statspssample_id merg get_metadatapssample_id get_sequence_qualitypssample_id stagecleanup bysample_id bysample_id bysample_id metricsyear sappli metricsfirst_publ functionx strsplitx metricsrank_nam ifels metricsrankx gold ifels metricsrankx silver bronz platform metricscsample_id instrument_model total_contig study_access rank_nam mec_temp mergemec platform bysample_id r tablemec_tempmec_tempagr study_access r summarymec_tempmec_tempagr total_contig r colnamesmetr r mec mergemec datafram sample_idtop_typesample_id totaltop_typetot bysample_id mec mergemec datafram sample_idtop_typesample_id mec_totaltop_typemeca_tot bysample_id tablemecmectot primer_mec r tablemecmectot protein_mec r tablemecmectot ariba_mec r tablemecmectot ariba_relaxed_mec sccmec cassett coverag mec region r tablemecmectot mecmec_tot ariba_mec meca presenc st r meca_group merg datafram sample_idpssample_id stpsst rankpsrank ariba bysample_id meca_groupsstatu ifels meca_groupsmec true mrsa mssa meca_by_st plyrcountmeca_group cst statu headmeca_by_st get top st r top_st get_top_sequence_typ top_st mrsamssa distribut top sequenc type readi plot distribut mrsa mssa predict sequenc type r figwidth figasp top_st_meca mergetop_st meca_by_st byst p ggplotdatatop_st_meca aesxreorderst count yfreq fill statu xlabsequ type ylabcount geom_barstatident posit dodg geom_textaeslabelfreq vjust posit position_dodg scale_fill_manualvaluesccaf abac theme_bw themeaxistextelement_texts axistitleelement_textsizefacebold legendtitl element_blank p mrsamssa distribut top sequenc type readi plot distribut mrsa mssa predict sequenc type r figwidth figasp top_st_meca mergetop_st meca_by_st byst count top_st_mecatop_st_mecastatu mrsa countslabel pastecountsfreq countscount countsfreq count countscst count label p ggplotdatatop_st_meca aesxreorderst count yfreq fill statu labelfreq xlabsequ type ylabcount geom_barstatident posit stack geom_texts aesascharacterst count label label fill null data count scale_fill_manualvaluesccaf abac theme_bw themeaxistextelement_texts axistitleelement_textsizefacebold legendtitl element_blank p resist pattern base ariba megar resist class match r resistance_report get_resistance_resultspssample_id resistance_reporttru df asdataframecolsum resistance_reportncolresistance_report colnamesdf ctotal resistance_report_count datafram classrownamesdf totaldftot resistance_report_countsresistance_report_countstot resist class without match r dataframeclassascharact resistance_report_countsresistance_report_countstot class r cluster_report get_resistance_resultspssample_id cluster_reporttru df asdataframecolsum cluster_reportncolcluster_report colnamesdf ctotal cluster_report_count datafram clusterrownamesdf totaldftot cluster_report_countscluster_report_countstot resist cluster without match r dataframeclassascharact cluster_report_countscluster_report_countstot cluster group r resistance_group merg dataframesample_idpssample_id stpsst rankpsrank resistance_report bysample_id st function plot r plot_by_st functiongroup top_st column by_st plyrcount group cst ifels lengthstrsplitcolumn past column column by_ststatu ifels by_stmakenamescolumn true resist suscept top_st_resist mergetop_st by_st byst p ggplotdatatop_st_resist aesxreorderst count yfreq fill statu xlabsequ type ylabpastecount geom_barstatident posit stack scale_fill_manualvaluesccaf abac name column theme_bw themeaxistextelement_texts axistitleelement_texts facebold legendpositiontop legendtitleelement_blank returnp resist class match top sequenc type r figwidth figasp top_st get_top_sequence_typ column sortascharact resistance_report_countsresistance_report_countstot class p plot_by_stresistance_group top_st column printcolumn printp r figur figwidth figasp grid_arrange_shar function ncol lengthlist nrow posit cbottom right plot list posit matchargposit g ggplotgrobplot themelegendposit positiongrob legend gwhichsapplyg functionx xname guidebox lheight sumlegendheight lwidth sumlegendwidth gl lapplyplot functionx x themelegendpositionnon gl arrangegrobgl top textgrob x unit npc unit npc justclefttop gpgparcolblack fontsiz fontfacebold gl arrangegrobgl top textgrob b x unit npc unit npc justclefttop gpgparcolblack fontsiz fontfacebold gl arrangegrobgl top textgrob c x unit npc unit npc justclefttop gpgparcolblack fontsiz fontfacebold gl arrangegrobgl top textgrob x unit npc unit npc justclefttop gpgparcolblack fontsiz fontfacebold gl cgl ncol ncol nrow nrow combin switchposit bottom arrangegrobdocallarrangegrob gl legend ncol height unitcunit npc lheight lheight right arrangegrobdocallarrangegrob gl legend ncol width unitcunit npc lwidth lwidth gridnewpag griddrawcombin return gtabl invis invisiblecombin top_st get_top_sequence_typ p plot_by_stresistance_group top_st betalactam mec p plot_by_stresistance_group top_st aminoglycosid p plot_by_stresistance_group top_st fosfomycin p plot_by_stresistance_group top_st ml grid_arrange_sharedpppp nrow ncol output plot pdf png pdfpast getwd figuresfigureresistancefacettopsequencetypespdf height width grid_arrange_sharedpppp nrow ncol dev_nul devoff pngpast getwd figuresfigureresistancefacettopsequencetypespng height width grid_arrange_sharedpppp nrow ncol dev_nul devoff session info r sessioninfo titl result section public metadata output pdf_document default r librarystaphopia libraryggplot libraryreshap aggreg data public sampl first well get publicli avail aureu sampl r ps get_public_sampl variat aureu n staphopia sampl variant snp indel call use aureu n refer genom section well visual total number variant sampl give us idea sequenc genit divers respect n gather variant count use get_variant_count get variant count sampl also order count total r variant_count get_variant_countspssample_id variant_count variant_countsordertot summari variant count total variant snp indel r summaryvariant_countstot snp r summaryvariant_countssnp_count indel r summaryvariant_countsindel_count visual variant count total variant snp indel r figwidth figasp p ggplotdatavariant_count aesxseqnrowvariant_count ytotal xlabsampl count ylabcount geom_barstatident scale_x_continuousbreak seq nrowvariant_count scale_y_continuousbreak seq maxvariant_countstot label scalescomma theme_bw themeaxistextelement_texts axistitleelement_textsizefacebold p snp r figur figwidth figasp cutoff maxvariant_countsvariant_countssnp_count snp_count variant_countsfil ifelsevariant_countssnp_count cutoff true fals p ggplotdatavariant_count aesxseqnrowvariant_count ysnp_count fillfil xlabsampl ylabcount geom_hlineyintercept cutoff linetypedot geom_barstatident annotatetext x label argenteu fontfac annotatetext x label aureu fontfac scale_x_continuousbreak seq nrowvariant_count scale_y_continuousbreak seq maxvariant_countssnp_count label scalescomma scale_fill_manualvaluescc bcc theme_bw themeaxistextelement_texts axistitleelement_textsizefacebold legendpositionnon p output plot pdf png staphopiawrite_plotp pastegetwd figuresfiguresnpaccumul r figwidth figasp cutoff maxvariant_countsvariant_countssnp_count snp_count variant_countsfil ifelsevariant_countssnp_count cutoff true fals p ggplotdatavariant_countsvariant_countssnp_count ae xseqnrowvariant_countsvariant_countssnp_count ysnp_count fillfil xlabsampl ylabcount geom_hlineyintercept cutoff linetypedot geom_barstatident scale_x_continuousbreak seq nrowvariant_countsvariant_countssnp_count scale_y_continuousbreak seq maxvariant_countssnp_count label scalescomma scale_fill_manualvaluescc bcc theme_bw themeaxistextelement_texts axistitleelement_textsizefacebold legendpositionnon p indel r figwidth figasp p ggplotdatavariant_count aesxseqnrowvariant_count yindel_count xlabsampl count ylabcount geom_barstatident scale_x_continuousbreak seq nrowvariant_count scale_y_continuousbreak seq maxvariant_countsindel_count label scalescomma theme_bw themeaxistextelement_texts axistitleelement_textsizefacebold p nonredund divers dataset set command use gener nrd dataset execut local server use staphopia function avail api due execut time bash nrd dataset evalfals creat nrd dataset nonredundantsettxt staphopiawebmanagepi create_nonredundant_set nrddataset publish rank singleton extract gene without indel valid snp via mer nrdnrdannotationsummarytxt staphopiahomerpetitcgcstaphopiastaphopia mkdir extractgenom awk print nonredundantsettxt grep v sample_id xarg staphopiawebmanagepi extract_genom nrd staphopia identifi gene less sampl miss mer cat extractgenomeannotationdetailstxt awk falseprint sort uniq c awk print sort n validatedgenestxt extract valid gene extractcorefasta extractcorephylip staphopiawebmanagepi extract_cor validatedgenestxt extractgenom build phylogeni start tree iqtre extractcorephylip gtr nt auto fast pre starttre tee iqtreestartstdouttxt identifi recombin clonalframeml starttreetreefil extractcorefasta clonalfram emsim tee clonalframestdouttxt remov recombin maskrcsvgpi clonalfram aln extractcorefasta extractcorecfmaskedfasta symbol tee maskrcsvgstdouttxt final tree iqtre extractcorecfmaskedfasta gtr nt pre finaltre bb alrt wbt wbtl alninfo tee iqtreefinalstdouttxt session info r sessioninfo titl result section pipelin design process genom output pdf_document default notebook gener statist plot relat process genom seven bridg cancer genom cloud cgc platform load packag r librarystaphopia libraryggplot librarydplyr read data r result readtabledatacgcrunstxt header true sep colnamesresult leav use column name name job statu job statu project cgc project job execut app cgc app use execut job created_bi user submit job total_tim total amount time minut job queu run run_tim total amount time minut job took complet queue_tim total amount time minut job queu price total cost run clean data gener statist plot need clean data job run_tim price properli report cgc filter sampl run_tim r results_clean resultsresultsrun_tim nrowresult nrowresults_clean job summari run time summari r summaryresults_cleanrun_tim number job minut runtim r nrowresults_cleanresults_cleanrun_tim summari job run time minut r summaryresults_cleanbetweenresults_cleanrun_tim run_tim plot run time complet r figwidth figasp p ggplotdataresults_clean aesrun_tim xlabrun time minut ylabcount geom_histogrambin theme_bw themeaxistextelement_texts axistitleelement_textsizefacebold p pipelin run time minut r figur pipelin run time figwidth figasp p ggplotdataresults_cleanbetweenresults_cleanrun_tim aesrun_tim xlabrun time minut ylabcount geom_histogrambin theme_bw themeaxistextelement_texts axistitleelement_textsizefacebold p output plot pdf png staphopiawrite_plotp pastegetwd figuressupplementaryfigurepipelineruntim session info r sessioninfo