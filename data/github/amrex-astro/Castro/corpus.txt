cite castro number castro paper describ part algorithm ask cite appropri paper describ capabl use gener code use use castro appreci cite recent code paper articlealmgren doi joss url httpsdoiorgjoss year publish open journal volum number page author ann almgren maria barrio sazo john bell alic harpol max katz jean sexton donald willcox weiqun zhang michael zingal titl castro massiv parallel compress astrophys simul code journal journal open sourc softwar welcom cite origin code paper well provid detail algorithm implement articleapja author almgren beckner bell jb day ms howel lh joggerst cc lijewski mj nonaka singer zingal titl castro new compress astrophys solver hydrodynam selfgrav journal apj archiveprefix arxiv eprint primaryclass astrophim keyword equat state gravit hydrodynam method numer nuclear reaction nucleosynthesi abund year month jun volum page doi x adsurl httpadsabsharvardeduabsapja adsnot provid saonasa astrophys data system also cite zenodo doi code releas bibtex entri latest releas found httpsdoiorgzenodo radiat hydrodynam use radiat hydrodynam capabl pleas addit cite follow articleapjsz author zhang w howel l almgren burrow bell j titl castro new compress astrophys solver ii gray radiat hydrodynam journal apj archiveprefix arxiv eprint primaryclass astrophim keyword diffus hydrodynam method numer radi transfer year month oct volum eid page doi adsurl httpadsabsharvardeduabsapjsz adsnot provid saonasa astrophys data system articleapjsz author zhang w howel l almgren burrow dolenc j bell j titl castro new compress astrophys solver iii multigroup radiat hydrodynam journal apj archiveprefix arxiv eprint primaryclass astrophim keyword diffus hydrodynam method numer radi transfer year month jan volum eid page doi adsurl httpadsabsharvardeduabsapjsz adsnot provid saonasa astrophys data system graviti rotat use poisson graviti solver rotat pleas cite follow includ lot improv coupl hydro graviti articleapjk author katz mp zingal calder ac swesti fd almgren zhang w titl white dwarf merger adapt mesh methodolog code verif journal apj archiveprefix arxiv eprint primaryclass astrophh keyword hydrodynam method numer supernova gener white dwarf year month mar volum eid page doi x adsurl httpadsabsharvardeduabsapjk adsnot provid saonasa astrophys data system gpu scale cpu perform number pleas cite inproceedingsjphcsaz author zingal almgren barrio sazo mg beckner bell jb friesen b jacob katz mp malon cm nonaka aj willcox de zhang w titl meet challeng model astrophys thermonuclear explos castro maestro amrex astrophys suit keyword astrophys instrument method astrophys booktitl journal physic confer seri year seri journal physic confer seri volum month may eid page doi archiveprefix arxiv eprint primaryclass astrophim adsurl httpsuiadsabsharvardeduabsjphcsaz adsnot provid saonasa astrophys data system gpu perform pleas cite articlearxivk author katz max p almgren ann barrio sazo maria eiden kiran gott kevin harpol alic sexton jean willcox e zhang weiqun zingal michael titl prepar nuclear astrophys exascal journal arxiv eprint keyword astrophys instrument method astrophys astrophys high energi astrophys phenomena year month jul eid arxiv page arxiv archiveprefix arxiv eprint primaryclass astrophim adsurl httpsuiadsabsharvardeduabsarxivk adsnot provid saonasa astrophys data system spectral defer correct nd th order sdc coupl hydro reaction pleas cite articleapjz author zingal katz mp bell jb minion ml nonaka aj zhang w titl improv coupl hydrodynam nuclear reaction via spectral defer correct journal apj keyword hydrodynam astrophys fluid dynam comput method comput astronomi astronomi softwar nuclear astrophys nucleosynthesi stellar nucleosynthesi physic comput physic astrophys instrument method astrophys year month dec volum number eid page doi abe archiveprefix arxiv eprint primaryclass physicscompph adsurl httpsuiadsabsharvardeduabsapjz adsnot provid saonasa astrophys data system doihttpszenodoorgbadgedoizenodosvghttpsdoiorgzenodo doihttpsjosstheojorgpapersjossstatussvghttpsdoiorgjoss amrexhttpsamrexcodesgithubiobadgespoweredbyamrexredsvghttpsamrexcodesgithubio ytprojecthttpsimgshieldsiostaticvlabelworkswithmessageytcolorblueviolethttpsytprojectorg github pageshttpsgithubcomamrexastrocastroworkflowsgithubpagesbadgesvghttpsgithubcomamrexastrocastroactionsqueryworkflowagithubpag castrohttpsgithubcomamrexastrocastroblobdevelopmentutillogocastro_logo_hot_png adapt mesh astrophys radiat hydrodynam simul code castro adaptivemesh compress radiat mhd hydrodynam code astrophys flow castro support gener equat state full poisson graviti reactiv flow parallel mpi openmp cpu mpi cuda gpu inform castro found httpamrexastrogithubiocastro get start get start section user guid walk run first problem httpsamrexastrogithubiocastrodocsgetting_startedhtml clone castro depend amrex starkil microphys user guid written restructur text use sphinx sourc castrodoc built automat develop branch run supercomput center document run amrex astrophys code popular supercomput center found httpsamrexastrogithubioworkflow call graph doxygengener call graph castro avail httpbenderastrosunysbeducastrostagingcastrohtml develop model develop gener follow follow idea new featur commit develop branch nightli regress test use ensur answer chang chang expect chang critic cherrypick commit develop main contribut welcom anyon form pull request fork castro target develop branch mistakenli target main chang pleas add line changesmd summar chang bug fix new featur refer pr issu appropri addit chang fix bug find bug fix current issu describ bug pleas file separ issu describ bug regardless signific bug possibl changesmd file issu pleas cite pull request number git commit hash problem introduc fix respect squash commit upon merg clean histori pleas ensur pr titl pr summari field descript sinc use squash commit messag first workday month perform merg develop main coordin amrex maestro microphys merg take place need pass regress test accommod need close merg window develop day merg day merg window close bug fix push develop merg develop main done merg window reopen core develop peopl make number substant contribut name core develop castro criteria becom core develop flexibl gener involv one follow nonmerg commit castrosourc castrodoc one problem scienc problem addit new algorithm modul substanti input code design process test core develop recogn follow way invit group slack team list user guid websit core develop list author list zenodo doi project given zenodojson file invit coauthor gener code paper proceed describ castro perform etc note scienc paper alway left scienc lead determin authorship core develop inact year may reassess statu core develop get help use github discuss ask gener question code httpsgithubcomamrexastrocastrodiscuss tile ad main loop mhd algorithm enabl scale perform increas use multipl thread openmp see issu castrohse_fixed_temp ad allow fix temperatur hse boundari enabl set posit valu set castrohse_interp_temp new option castrodrive_initial_convect ad use temperatur interpol initi model instead valu grid call reaction help prevent reactiv zone burn place convect veloc field establish carri energi burn_weight longer store default plotfil instead enabl set castrostore_burn_weight addit give better estim cost numer jacobian castrochange_max requir greater enforc timestep cap still allow timestep decreas use castromax_dt graviti modifi introduc parallel plane graviti point mass set radiu star castropoint_mass_location_offset integ castropoint_mass_offset_is_tru default paramet respect castrosource_term_predictor work simplifiedsdc disabl sourc predictor hydrodynam state interfac castroadd_sdc_react_source_to_advect ad disabl react sourc advect simplifiedsdc spong appli fulli implicit manner end ctu advanc rather use predictorcorrector approach time center consist origin form spong castro castro valid runtim paramet set input file commandlin set castroabort_on_invalid_param start releas problem setup written fortran longer support longer work pleas consult code document exampl problem setup exec understand new problem setup format need help convert fortran setup c pleas file issu spong paramet accept input file spong namelist probin file longer read ambient paramet accept input file ambient namelist probin file longer read update_sponge_param hook remov fortran problemspecif sourc file ext_src_ndf remov problemspecif sourc implement c problem_sourceh support legaci tag scheme base probin paramet denerr tempgrad etc remov replac equival tag criteria construct input file see doc exampl exec see use amrrefinement_ind fortran set_problem_tag hook remov c replac problem_tag problem_taggingh prescribedgrav function remov replac c implement want obtain function use problemdefin sourc term look problem_sourc document make appropri modif appli directli state eg momentum sourc term rho g custom radiat boundari use lo_bcflag hi_bcflag coupl implement rbndri remov longer store reactions_typ checkpoint file mean newer version castro restart old version paramet use_eos_in_riemann remov found instanc use option castroapply_sources_consecut remov simplifiedsdc correctli store reactiv part updat rho_enuc enuc rho_omegadot plotfil variabl axisymmetr geometri addit forc aris due chang direct unit vector divrho u u term paper bernandchampmartin discuss see issu add forc note corioli forc axisymmetri alreadi consist righthand system despit intern order state r z theta set microphys runtim paramet input file instead probin group paramet namesapc input file set way eg eosuse_coulomb c input valu take preced valu set probin set place minimum c standard support castro c modern compil support c notabl except rhel deriv like cento default compil gcc case newer compil must load particularli version gcc exampl instal devtoolset run hpc cluster provid modul use recent gcc modul multipl _prob_param file throughout sourc tree read problem file last take preced _prob_param file found timestep limit dtnuc_t remov dtnuc_ dtnuc_x still avail control burn timestep bug fix nd order true sdc reaction give wrong solut converg second bug fix defin weight radau quadratur use true sdc compil pgi compil longer requir cuda build castro recommend use compgnu version gcc c compliant gcc issu incorrect applic hse boundari condit deriv quantiti resolv also point old fortran implement hypfil denfil ext_hypfil ext_denfil remov problemspecif boundari condit implement use new c interfac releas minimum support hypr version switch fortran c implement vode microphys result also switch strang simplifi sdc burner castro use c implement network use castro alreadi port c network requir c implement network implement fortran useabl gpu eventu use c problem_checkpoint problem_restart move c fortran see execsciencewdmerg exampl new scheme problemf problem_fh delet code use implement problemspecif function still manual add file makepackag problem setup setup use poisson graviti tag turn locat fine level would adjac physic boundari previous led abort interfac problem tag c ad simplifi sdc support c integr mhd problem magnet field initi c minimum c standard support castro c modern compil support c notabl except rhel deriv like cento default compil gcc case newer compil must load particularli version gcc exampl instal devtoolset run hpc cluster provid modul use recent gcc modul new option castroretry_small_density_cutoff ad case small neg densiti retri may trigger updat move zone alreadi close small_den uncommon ambientfluff materi outsid star sinc zone dynam import anyway trigger retri unnecessari possibl counterproduct sinc may requir small timestep avoid set cutoff valu appropri retri skip densiti zone prior updat cutoff new refin scheme use input file rather fortran tag namelist ad exampl consid amrrefinement_ind den temp amrrefinedensmax_level amrrefinedensvalue_great amrrefinedensfield_nam densiti amrrefinetempmax_level amrrefinetempvalue_less amrrefinetempfield_nam temp amrrefinement_ind list userdefin name refin scheme defin name amrrefinenam accept predefin field describ tag current implement max_level maximum level refin start_tim start tag end_tim stop tag value_great valu refin value_less valu refin gradient absolut valu differ adjac cell refin field_nam name string defin field code refin indic ad either value_great value_less gradient must provid automat problem paramet configur avail everi problem place _prob_param file problem directori exampl found problem castroexec look set problem section document inform function option howev note file contain fortran modul name probdata_modul automat gener legaci probdataf file contain modul name renam variabl center problem namespac part automat gener probdata modul present time valid way chang problem center valu zero amrex_probinit initi problem paramet done automat call probdata_init longer requir amrex_probinit problem may initi c instead fortran instead implement amrex_probinit ca_initdata problem implement analog function initialize_problem initialize_problem_state_data switch new c initi sure delet prob_ndf file default implement noth pick either one pick extern heat sourc term routin port c problem use extern heat sourc look convert code c interpolate_ndf file move utilinterpol compil castro set use_interpolatetru reaction work mhd mhd use main slope routin order slope control plm_iorder hydro addit option mhd_limit_characterist determin limit done primit characterist variabl default rotation_typ remov statedata castrouse_post_step_regrid uncondit regrid everi timestep everi level issu gravitymax_solve_level result access invalid data resolv castrospeed_limit set number greater zero strictli enforc magnitud veloc use amr graviti rotat sourc term appli reflux would incorrect previou timestep retri fix abil access problemspecif runtim paramet c master branch renam main branch exist clone castro follow updat chang first git checkout master your alreadi old master branch git pull gather updat repo fail messag configur specifi merg ref refsheadsmast remot ref fetch simpli git checkout main local repo automat switch branch track updat upstream repo github like delet old master branch git branch master cuda build longer requir amrblocking_factor multipl though recommend perform reason previous requir due correct reason use amrex fortran function amrex_filccn note function longer requir due recent chang castro problem overrid bc_fill_ndf bc_ext_fill_ndf need provid initi fill ghost zone data implement specif boundari condit done call function may result race condit correct issu cuda build remov problem setup function permit rotat rate chang function time castrorotation_include_domegadt castrorotational_dpdt remov cuda illeg memori access error poisson graviti diffus fix paramet castrotrack_grid_loss remov paramet castroprint_fortran_warn longer effect remov ppm reconstruct ad mhd solver reactions_typ statedata rework first numspec compon rho omegadot rather omegadot numaux auxiliari compon store network auxiliari variabl rho enuc store enuc remov final burn weight store checkpoint version increment version code restart checkpoint gener earlier version code bug reflux amr level result incorrect result retri occur previou timestep fix paramet castrodensity_reset_method remov densiti reset uncondit set densiti small_den temperatur small_temp zero veloc constrainedtransport corner transport upwind mhd solver ad use compil use_mpi true present work singl level amr burn timestep limit dtnuc_t ad restrict burn updat temperatur factor dtnuc_t dtdt reaction weight metric implement version ad simplifi sdc reaction driver use simplifi sdc integr scheme save newtim reactions_typ data plotfil paramet use_custom_knapsack_weight associ function remov weve chang runtim paramet store previous static member respect class prevent use lambdacaptur function gpu runtim paramet group namespac extern manag data current scheme store reaction weight measur number rh evalu burn therefor proxi difficulti burn weight ad separ statedata depend runtim option use_custom_knapsack_weight instead place weight directli reactions_typ statedata new compon number ghost zone reactions_typ increas checkpoint version increment version code abl restart checkpoint gener earlier version code mean dt_cutoff chang fraction current simul time dt may smaller instead absolut measur set nonzero default e well backward compat restart checkpoint longer support checkpoint older version code determin checkpoint version castrohead file checkpoint directori restart ad option ctu reaction c compil flag use_cxx_react ad switch c integr microphys sinc phase implement network microphys optin core routin port c includ hydro diffus timestep estim spong amrex provid cpubndryfuncfab gpubndryfuncfab similar generic_fil hypfil amrex implement use still hypfil denfil function exist problem broken main one sourc longer call amrex_filcc ambient code problem overrid bc_fill_ndf thu longer requir call amrex_filcc alway issu timestep retri densiti advanc neg less small_den paramet castroretry_neg_dens_factor remov paramet castroretry_toler also remov longer effect timestep control paramet castrochange_max also prevent timestep shrink much one timestep previous would prevent grow much change_max violat timestep retri take grace step check problem setup initi densiti temperatur valu near small_den small_temp abort happen recours adjust small_den small_temp meaning valu problem src_q multifab remov instead convert conserv state sourc primit state sourc fab fab save lot memori expens eo call plm_well_balanc option remov essenti use_pslop except lower order work constant graviti use_pslop work ctuplm sdcplm new test problem hse_converg ad look behavior differ reconstruct method hse potenti undefin flux hll solver use hybrid_riemann fix paramet castroallow_small_energi remov code behavior similar would allow_small_energi intern energi never smaller allow small_temp bc interfac merg convert new fab interfac part port c boundari fill interfac hypfil denfil remov longer support overrid boundari condit data state_typ radiat still set custom boundari condit access input file describ doc convers ctu hydrodynam code c continu riemann solver convert c hybrid momentum routin plm reconstruct convers primit conserv variabl weve chang backup retri done present use_retri enabl make preemptiv copi statedata right begin timestep backup detect retri need depend fundament constant microphys instead keep copi castro remov ppm_predict_gamma option ctu hydro solver use frequent show much differ default rho e reconstruct microphys extern paramet avail c weve start convert ctu hydro solver fortran c ppm reconstruct done c option ppm_temp_fix remov use temperaturebas eigensystem characterist trace never use product scienc deriv variabl multipl compon compon ad plotfil previous first compon use updat workflow come castro depend previous castro ship minim set microphys allow basic problem setup like sedov compil advanc setup like one includ nuclear burn requir download starkillerastro microphys repositori addit step microphys repositori requir use castro current user microphys repositori prefer current workflow maintain microphys separ instal castro chang workflow necessari microphysics_hom set environ variabl castro use microphys instal directori howev also ad microphys git submodul castro requir path previous use advanc microphys also possibl previous use standalon microphys instal obtain use git submodul updat init recurs toplevel directori castro develop team ensur version microphys obtain way consist current version castro keep date code mostli normal except use git pull recursesubmodul instead git pull similarli amrex maintain git submodul rather extern standalon instal use git submodul command youll obtain amrex microphys may opt reli instal amrex set amrex_hom environ variabl howev respons keep sync castro use submodul youll get version amrex test ensur compat current version castro name conserv state variabl c densiti xmom etc chang match name fortran urho umx etc user code affect problemspecif setup code like probcpp refer specif state variabl compat kept copi old name around redirect new name old name consid deprec remov futur releas fix bug nuclear burn timestep estim gpu rewrot th order sdc hydro driver c allow code reus solver simplifi nd order sdc code dimension sweep reduc memori option radiationintegrate_planck remov use one test default alway full integr planck function radiat test problem move new opac directori rad_power_law paramet control behavior power law opac move extern probin modul alway expect pick specif opac implement paramet radiationuse_opacity_table_modul remov null opac implement previous move code fail compil attempt use need updat rad_power_law see document inform use new implement addit code multigroup solver effect previous set rosseland opac kappa_r equal planck opac kappa_p latter set former similar unintuit behavior behavior scatter paramet get exactli ask probin file given default _paramet file rad_power_law opac default constant coeffici neg invalid must set nonneg valu code work problem previous set const_kappa_p const_kappa_r set latter equal former maintain code behavior analog thing done expon kappa_p_exp_m kappa_p_exp_n kappa_p_exp_p paramet radiationdo_real_eo remov function enabl new equat state call rad_power_law new eo compat pure radiationdiffus test castrodo_hydro default use_retri instruct castro retri step smaller dt cfl violat burn failur neg timestep burn failur castro set microphys paramet abort_on_failur fals high prioriti overrid microphys default also check make sure combin paramet make sens runtim paramet castrohard_cfl_limit remov unnecessari clean_stat call remov support neutrino radiat diffus remov bug fix hydro cfl timestep estim simplifiedsdc timestep restrict need bug fix simplifiedsdc nuclear burn timestep estim new option castrolimit_fluxes_on_large_vel ad similar exist option limit_fluxes_on_small_den flux limit prevent veloc zone get high largest legal speed set castrospeed_limit gener previou solut propos castroriemann_speed_limit paramet remov amr paramet amrcompute_new_dt_on_regrid default avoid crash result cfl number larg regrid updat timestep see larger veloc still opt set want input file ad call hypr exist version new minimum requir castro radiat note hypr host github httpsgithubcomhyprespacehypr new option castrolimit_fluxes_on_large_vel ad similar exist option limit_fluxes_on_small_den flux limit prevent veloc zone get high largest legal speed set castroriemann_speed_limit new option castroapply_sources_consecut ad default add sourc term togeth option enabl add sourc one time sourc see effect previous ad sourc matter exampl spong sourc term may effect ad sourc term graviti updat veloc new option castroext_src_implicit ad extern sourc term previous implement explicit predictorcorrector scheme new option turn chang handl extern sourc term allow implicit solv done subtract full oldtim sourc ad full newtim sourc corrector rather respect still individu problem make sure consist scheme option turn add option use monopol bc set gravitymax_multipole_ord neg number use monopol graviti fill boundari condit rather multipl bc use debug purpos make behavior consist use multipol bc default well use_retri mechan enabl simplifi sdc time integr method case use_retri could result small last subcycl avoid longer alloc memori sourc speci conserv state unless prim_species_have_sourc set subroutin eos_on_host ad eo modul wrapper eo must use cuda build eo call probinit place dont run gpu use vode instead vode default new unit test ad model_burn read initi model call reaction network use test toler etc densiti flux limit simplifi fix race condit sdc algorithm use radau quadratur instead gausslobatto quadratur option castroppm_reference_eigenvector remov use default ctu ppm solver sdc algorithm implement burn condit depend rho react_rho_min react_rho_max react_t_min react_t_max sdcmol plm reconstruct implement reflect bc interfac state wellbalanc scheme ad piecewis linear sdc method enabl castroplm_well_balanac moment support constant graviti weight timenod flux store flux regist sdc fix choos reconstruct plm use castroplm_iord flag piecewis constant piecewis linear slope ad way specifi limit use linear slope castroplm_limit use nd order mc limit castroplm_limit use default th order mc limit previous way select nd order limit rungekutta base methodoflin integr method remov favor sdc integr new way specifi problem runtim paramet introduc specifi plain text file _prob_param compil time probdata_modul automat creat autom creation probdata variabl namelist read set manag cuda add abil output valu file like job_info featur optin need set use_prob_param gnumakefil defin problem paramet file _prob_param problem directori time output store job_info file sdc time advanc method document job_info file report number gpu use type castrognuex describ see list modul compil code built reaction quantiti comput proper th order averag plotfil use sdc_order velerr tag take ab veloc compon ensur tag larg posit neg veloc fix cuda compil remov special treatment th order outflow bc see slightli chang characterist trace done ctu ppm hydro solver use limit parabola edg state wave move toward interfac ctu ppm solver use lot less memori comput integr parabola need instead precomput store creat new error wrapper castro_error replac amrex amrex_error allow us deal error gpu new sdc solver substanti improv explicit thermal diffus implement nd th order accur solver new option castrosdc_extra take extra sdc iter newton solver sdc updat subcycl sdc_solver_relax_factor option fix absolut toler speci use error check sdc solv scale term jacobian fix use onesid stencil reconstruct physic boundari flame problem setup initi conserv preexist flame solut analysi routin seen improv work th order accur simul diffusion_test unit test work th order problem separ set boundari fill routin sourc term source_fillf previous handl generic_fillf tag routin reformul run gpu sinc tags_and_untag routin amrex gpuacceler opt directli fill tagboxarray tag routin pass tagbox fortran int_t mean interfac problem_tagging_ndf updat use integ castro_prob_err_listh relat file delet actual use anywher castro_errorcpp remov support write custom tag routin set variabl check tag hardcod castro expand need problemspecif tag done set_problem_tag function dimensionspecif code problem initi boundari condit extern heat term remov warn previou releas notic deprec notic releas dimensionspecif problem setup deprec present optin ad dimension_agnost true makefil use prob_ndf file instead prob_df file dimensionagnost prob_ndf use fill initi data dimens alway loop dimens unus dimens indic lo hi valid fortran current interfac found sourceproblemsprob_ndf problem convert dimensionagnost form remain one done shortli use eg sedov dustcollaps problem model problem dimens agnost problem setup also impli dimens agnost helper routin bc_fill_ndf userfac file end dddf file extens deprec releas support remov problem setup work dimens agnost pleas file issu need assist convert problem deprec notic releas problemspecif overrid castro_errorcpp gener custom tag routin includ castro_prob_errcpp associ file deprec support mechan problemspecif tag set_problem_tag function problem_tagging_ndf also dimensionspecif version file deprec pleas file issu need assist convert tag setup use problem tag need data interfac abl implement tag scheme support remov releas deprec notic releas problem_pre_tagging_hook problem_post_tagging_hook deprec actual use problem remov releas dimens agnost version extern sourc term ext_src_ndf updat use iso c bind interfac two paramet time dt pass valu see sourcesourcesext_src_ndf new interfac problem_derive_ndf renam problem_derive_ndf veloc calcul interfac riemann solv cgfcg riemann solver longer exceed speed light paramet castroriemann_speed_limit set control speed limit appli riemann solver use prevent unphys larg veloc creat shock front near larg densiti gradient algorithm recalcul sourc term amr reflux set data need correctli calcul posit fine level positiondepend sourc term rotat hybrid momentum calcul incorrectli caus strang effect amr simul rotat binari star orbit get wider time drift rel system center mass fix density_reset_method event densiti reset reset densiti begin timestep longer exist behavior use_retri retry_neg_dens_factor chang slightli sinc choos retri timestep base differ incorrect neg densiti densiti reset rather old densiti begin step still similar type timestep limit quantit timestep choos differ sign error fix hybrid_hydro angular momentum algorithm address issu commmit f chang sign introduc add_hybrid_momentum_sourc analog linear_to_hybrid runtim paramet castrofix_mass_flux remov clear use case test suit coverag fix bug introduc august result incorrect real bound pass ca_initdata restart problem use grown domain would result incorrect initi problem use grown restart capabl initi depend posit grid use pointmass graviti longer requir use_pointmass true makefil use_grav true suffici howev compens must includ castrouse_point_mass input file enabl point mass input paramet alreadi exist default sinc matter compil flag enabl default also coupl bug pointmass graviti fix algorithm correct resolv point mass valu preserv across restart issu your use point_mass_fix_solut updat point mass valu mass accret center domain fix well fix bug sourc term rho e evolut use mol new sdc integr also longer recomput sourc term reflux method dimens agnost problem setup interfac physic boundari condit chang hypfil denfil etc problem dimens agnost pleas consult new interfac sourceproblemsbc_fill_ndf understand convert problem chang ca_ prefix remov subroutin name time paramet pass valu lo hi indic target region updat boundari explicitli pass first two argument remov code extrapol diffus term ghost cell longer necessari remov enthalpi diffus known applic speci veloc diffus none routin regularli test problem diagnost castrodiagnost convert c remain compat amrex build system fix minor longstand bug simplifi sdc implement involv incorrect index chang result slightli number test involv reaction move hydro_test reacting_test old spectral defer correct method renam simplifi sdc access time_integration_method still requir build use_sdc true build way time integr method unavail th order hydro extend support gener equat state still singl level artifici viscos also ad framework new spectral defer correct method ad allow higherord time integr fix bug self_heat paramet initi burn timestep limit default longer alloc storag sourc term speci primit variabl state set via _variabl file pars set_variablespi allow speci sourc need set prim_species_have_sourc done current sdc renam qvar nqsrc make clear number sourc term primit variabl state also fix number place qvar use instead nq new runtim paramet t_guess creat use initi temperatur guess call eo input rho initi newton iter ctu hydrodynam driver rewritten c input paramet castrodo_ctu renam castrotime_integration_method current legal valu ctu default mol fix bug ppm_temp_fix reconstruct initi reconstruct temperatur flux limit use option limit_fluxes_on_low_den implement correctli fix pr ctu hydro solver longer alloc support routin done toplevel driver ctu solver make explicit rang cell loop transvers routin plotfil quantiti divu magvort fix axisymmetr coordin diff_term fix geometri abar new deriv variabl job_info file store domain inform job_info file also store checkpoint refin enuc nuclear energi gener rate control paramet tag probin namespac enucerr max_enucerr_lev also move dxnuc tag paramet input probin name dxnuc_min formerli castrodxnuc dxnuc_max max_dxnuc_lev diffus cutoff linear ramp instead discontin cutoff densiti less diffuse_cutoff_density_hi transport coeffici scale linearli densiti reach diffuse_cutoff_dens zero fix zenodojson user guid automat built develop branch use travi store job_info file checkpoint automat gener doxygen doc along user guid start ad docstr throughout code mg solver optim bit fix bug cuda version mol integr set interfac state incorrectli remov ppm_type use scienc simul never shown complet stabl near futur full fourth order method merg better replac bug fix sdc integr appli reactiv sourc term hydrodynam interfac predict appli sourc term plm transvers routin consist ppm version angular momentum plotfil comput respect center array initi probinit fix bug rotat ad sourc term outofplan veloc twice predict interfac state result overal firstord approxim fix issu result custom knapsack distribut map gener use distribut map reaction also fix edg case custom distribut map could caus numer overflow code crash rewrot reconstruct routin elimin temporari array make gpu friendli document convert sphinx chang interfac conduct routin conduct part eos_t weve restructur ctu solver longer use slab approach prepar offload solver gpu minor bug fix transvers routin ctu solver radiat simplifi conduct interfac match eo interfac move conduct variabl argument eo type fix handl extern bc unifi cuda hydro solver code methodoflin code offload graviti sourc term rotat reaction spong gpu cuda merg differ dimension version ctu consup routin singl routin remov unsaf option allow_negative_energi trace sourc nonzero save comput expens updat consist reset small intern energi e paramet dual_energy_update_e_from_ remov default behavior total energi e chang reset intern energi e caus chang simul output probin paramet eos_input_is_const true default mean call eo mode eos_input_r energi updat eo call eg newton iter scheme helmholtz caus chang simul output problemspecif runtim paramet probin written job_info file skip initi eo call prior burn redund alreadi clean_stat support recent version hypr old use_mlmg_solv paramet remov multigrid solver castro time paramet effect paramet dual_energy_eta remov introduc mostli test purpos end unnecessari also eo call begin burn remov provid modest comput gain answer may chang level eo toler function check regrid end timestep appli tag criteria t_sound t_enuc criterion bug fix occur retri trigger middl group subcycl rather begin advanc bug logic reflux use retri fix tag done rel gradient addit exist capabl absolut gradient exampl tempgrad_rel rel gradient criterion tag zone temperatur adjac zone temperatur differ tempgrad_rel tag enabl given level paramet max_tempgrad_rel_lev correspond new tag criteria field name similarli retri done dynam fashion advanc subcycl advanc alway keep subcycl done step default still singl timestep use_retri enabl help case reject timestep say cfl violat retri cfl criterion violat past would simpli abort run happen cut timestep keep go addit set abort_on_fals f probin file extern paramet burn microphys caus abort run castro know deal retri take shorter timestep logic burn failur come take larg hydrodynam timestep burner abl keep new gpu cuda hydrodynam solver base methodoflin solver ad base work initi done starlord work progress requir gpu branch amrex remov depend amrex f_boxlib sourc prepar sourc remov futur set number variabl compil time pars _variabl file interpret option set preprocessor note side effect chang number radiat group set compil time instead runtim chang need gpu port set number radiat group set ngroup eg group problem gnumakefil similar option exist neutrino relat chang possibl set number advect quantiti speci eo auxillari field via numadv gnumakefil new multilevel multigrid solver mlmg amrex framework default selfgrav construct oper explicit diffus new test problem classic doubl mach reflect ad fix issu retri logic could sometim result overflow estim number subcycl step improv behavior retri hit cfl violat gamma_ deriv variabl new diffus solver implement use new muligrid framework amrex comput diffus oper enabl diffusionuse_mlmg_solv job_info file indic runtim paramet chang default valu improv made th order hydro solver singlelevel option ppm_trace_sourc remov alway trace sourc term ppm addit sourc trace momentum sourc methodoflin integr rewritten work properli sourc note intend multilevel yet approxim state riemann solver split two part comput interfac state evalu flux interfac state give addit flexibililti use solver method paramet dtnuc_mod remov initi use test variou form burn timestep limit final form settl minor inconsist extern diffus sourc term construct simultan use reaction fix deprec paramet castrouse_colglaz remov deprec june obsolet paramet castroriemann_solv set use colella glaz riemann solver state variabl indici fortran defin singl file sourcedriver_vari make much clearer consist allow autodocument cleanup gpu acceler futur spong oper base pressur new paramet belong spong namelist name sponge_lower_pressur sponge_upper_pressur work principl densiti spong spong drive system particular veloc default still zero veloc new paramet belong spong namelist probin file name sponge_target_xyz_veloc sdc_source_typ statedata remov purpos supplant chang alway keep sourc term statedata see thu redund chang code output mean old checkpoint gener use sdc longer compat current code normal strive maintain forward compat checkpoint chang consid justifi sdc still consid experiment featur develop knowledg product scienc run yet done use sdc paramet gravitymax_solve_level remov ad work around converg issu multigrid solv converg issu sinc fix paramet longer use source_typ statedata hold actual old newtim sourc previous held sourc term predictor statedata use fill sources_for_hydro multifab provid sourc term use hydrodynam updat sinc statedata oper done fillpatch consequ sources_for_hydro data meaning data physic domain ghost zone ghost zone coarsefin interfac previous meaning data fulli interior ghost zone checkpoint old new data chang result differ simul output simul sourc term answer differ boundari coarsefin interfac relat bug use sdc fix paramet castrokeep_sources_until_end remov sourc term graviti rotat etc coalesc singl multifab reduc memori footprint code negat need code paramet update_state_between_sourc coalesce_update_diagnost remov caus chang result previou code behavior updat state success sourc term appli new time everi sourc term calcul use newtim state one come hydro sourc term appli state one shot end note old approach secondord accur time problem combin multipl sourc term caus chang larger roundoff particular rotat use conjunct sourc term chang rel larg corioli forc depend veloc sourc term bit differ see differ veloc new option castroplot_per_is_exact set timestep shorten exactli hit time interv specifi amrplot_p issu fix incorrect timestep would taken restart previou step shorten use new multigrid solver amrex implement c instead older fortran solver enabl gravityuse_mlmg_solv note work current sever option gravitymlmg_max_fmg_it integ paramet determin mani fmg cycl perform switch vcycl gravitymlmg_agglomer boolean flag determin amr level grid agglomer grid coarsen multigrid hierarchi gravitymlmg_consolid boolean flag determin grid amr fine level singlelevel solv lowest amr level multilevel composit solv consolid grid coarsen multigrid hierarchi consolid mean grid move fewer mpi process numer experi show scale better old solver appli sourc state ghost zone fix ensur advanc give valid updat ghost zone state_typ minor bug fix releas correspond releas amrex bug fix noncartesian simul amr spheric cylindr bug introduc around version result incorrect synchron pressur term momentum equat effect would manifest nonconserv momentum strang effect coarsefin interfac spong alway time center option otherwis introduc remov addit form energi sourc term correct time center case brought line energi sourc term sourc issu issu fix bug fix conductivity_dir renam conductivity_dir consist eos_dir network_dir longer get composit deriv part eo call need function need set preprocessor variabl fortran extra_thermo use system bla routin instead compil version microphys set use_system_blastru look blas_librari link line sometim use abl sort initi phase simul stop checkpoint restart possibl differ option main phase run case may want reset simul time zero analysi purpos new option castroreset_checkpoint_tim allow set time want checkpoint gener new time similarli castroreset_checkpoint_step allow reset timestep number exampl option work your use amrcheckpoint_on_restart requir amrregrid_on_restart option intend use case your gener checkpoint also need temporarili set max_step stop_tim target valu your reset prevent step restart new checkpoint undo temporari variabl continu run usual minor error graviti sourc term fix error normal observ fix bug artif viscos noncartesian geometri issu readmemd describ process becom core develop castro mean network_dir renam network_dir eos_dir renam eos_dir problem gnumakefil updat old name continu work near futur user encourag chang problem use new allcap name pr densiti flux limit function small toler also document timestep retri conserv accomplish save densiti flux use conserv graviti updat also bug timestep retri poisson graviti fix sourc directori structur reorgan put sourc file directori physic elimin src_d src_d subdirectori riemann solver merg singl dimensionalagnost version src_nd issu godunov state cg solver store interfac would affect intern eneri evolut plm ppm reconstruct routin merg singl dimensionalagnost version hydro characterist trace routin merg dimensionalagnost version hydro radiat chang fix outstand issu plm reconstruct use refer state issu option castrolimit_fluxes_on_small_den limit densiti name suggest origin also limit flux intern energi would go neg caus problem run mpi remov strictli need anyway normal logic handl neg intern energi reliabl two error fix implement trigger regrid end timestep method correctli conserv fluid variabl coarsefin boundari xgraph stuff output xmgrcompat ascii profil fix bug graviti runtim paramet properli initi fortran side code viscos routin separ conduct microphys also castro use stellar conduct part starkil starkillerastro microphys repo use denser tabl helmholtz eo thank frank timm use eo new tabl softlink build directori automat old copi lay around might fail run io error start code clean eventu gpu offload support merg starlord ad framework methodoflin integr hydrodynam characterist trace instead reconstruct multipl stage ode integr moment radiat support requir amrex librari instead boxlib librari microphys repositori reli eo reaction network part starkillerastro github chang clone refer via git remot seturl origin sshgitgithubcomstarkillerastromicrophys new mechan use stabil criterion trigger regrid end timestep ad pr clean logic momentum flux limit_hydro_fluxes_on_small_den issu protect ad retri code rewrot conserv graviti formul work potenti give best conserv amr equival descript appendix b katz et al new reflux method introduc remov determin provid benefit accuraci new deriv plot variabl avail use thermal diffus includ conduct diffus coeffici entir diffus term energi equat issu deriv variabl store plotfil store mass fraction twice eg save xhe latter store creat post_simul function call end simul exampl provid test_diffus output norm error analyt solut issu diagnost inform sourc term updat state overhaul made uniform sourc term includ hydro reset print chang state format paramet print_energy_diagnost renam print_update_diagnost new paramet coalesce_update_diagnost ad combin oldtim newtim updat one print issu support singl doubl precis float point declar use amrex_r type defin amrex_fort_modul set singl doubl precis compil time constant also use type breviti renam rt use statement issu spong timecent default issu ppm_temp_fix stuff document made consist across dimens issu job info git inform output git describ give inform includ last tag far tag abbrevi hash also indic work directori dirti radiationspecif version computetemp remov instead everyth goe main castro computetemp affect particular treat small intern energi radiat issu radiationspecif version umeth consup merg pure hydro routin give roundoff level differ also use veloc compon kinet energi correct radiat issu minor bug fix radiat characterist trace regard gamma_ gamc use fix restart bug radiat introduc cherrypick develop issu boxlib requir c compil default part transit parray replac c array addit chang boxlib build system mean need suppl comp compil fcomp ignor user guid updat reflect current flow algorithm distinguish graviti includ constant gravit acceler selfgrav graviti self_grav preprocessor direct work sync level done describ forthcom paper main chang default reflux recomput valu sourc term affect level newtim sourc term know updat state due flux graviti resembl origin castro paper describ sync sourc done consist way sourc term fairli cheap enabl default disabl see castroupdate_sources_after_reflux addit option chang new strategi reflux see castroreflux_strategi exist standard method reflux fine timestep coars timestep complet new method partial reflux end fine timestep mean coars state use time interpol fine level slightli accur go later fine timestep also need selfconsist conserv energi graviti present expens standard method graviti sync solv tradeoff simul accur order comput temperatur reset intern energi chang spot chang result default radiationspecif sourc move radiat subdirectori paramet first_order_hydro move radiat namespac castro namespac problem setup move subdirectori categori make easier read issu way use toler multigrid solv poisson graviti chang old behavior would pass gravityml_tol rel toler grid level absolut toler would use suffer defect notabl fine grid often loosen rel toler higher level achiev converg certain case scheme would fail complet exampl fine grid cover mass grid use input paramet gravityabs_tol control absolut scale toler either array valu one level singl scalar valu latter absolut toler pass multigrid scheme toler multipli maximum valu rh entir domain coars grid absolut toler pigrho_maxabs_tol fine grid multipli ref_ratio specifi gravityabs_tol reason valu select coars level scheme use give reason valu fine level well paramet gravityml_tol renam gravityrel_tol mean default zero gravityml_tol deprec remov futur releas note toler use determin converg alway less restrict rel absolut toler requir gravitydelta_tol remov issu radiat hydro solver use live castroradiationgit complet integr main castro git repo histori preserv transit also clean littl issu radiat build variabl network_input renam network_input consist eos use come castroradi avail microphysicsgit graviti diffus runtim paramet move master _cpp_paramet file issu enthalpi speci temperatur diffus properli timecent issu bug hi boundari inflow boundari condit diffus fix issu flux limit ad limit size hydro flux would caus rho rho e go neg use castrolimit_hydro_fluxes_on_small_den bug singlelevel problem poisson graviti fix multigrid toler set uniniti valu flaw sourc term primit variabl hydro updat fix sourc term like graviti longer affect pressur rho e interfac state issu predict sourc term halftim use hydrodynam reconstruct done properli fix issu radiat hydro ppm implement ppm_predict_gamma option longer ship vode bla castro provid separ microphys git repo document architectur castro significantli improv issu ppm trace routin radiat sync pure hydro version particular support ppm_trace_sourc implement refer state fix issu flatten ppm routin also updat support trace predict gamma_ instead rho e inconsist flatten fix paramet ppm_refer ppm_reference_edge_limit remov reason use anyth default paramet ppm_tau_in_trac remov use part preserv ppm_predict_gamma function use differ set primit variabl tau u p gamma_ predict interfac state flux correct axisymmetr spheric coord fix particular separ flux regist pressur term enter gradient momentum equat sign gravit potenti flip consist usual convent physic literatur ie potenti neg solv del phi pi g rho castro_advancecpp significantli clean sourc term graviti rotat diffus etc multifab associ affect state data chang result slightli typic rel chang larger e level due updat order oper consist usag ghost zone iter solver coupl reaction hydrodynam introduc enabl use_sdc true makefil number iter done timestep control castrosdc_max_it chang default graviti rotat sourc grav_source_typ rot_source_typ default conserv formul energi equat incorpor sourc flux energi equat see katz et al detail also implicit_rotation_upd default slightli better coupl corioli forc momentum equat implicit veloc updat also make ppm_trace_sourc default parabol reconstruct momentum sourc trace construct interfac state set castrocg_blend default effect default cgf riemann solver colella glaz solver castroriemann_solv augment secant iter pstar find bisect fail converg make root find star state robust new fake setup riemann_test_zon use send left right hydro state cg riemann solver test act unit test solver default castroallow_negative_energi safer choic default castropoint_mass_fix_solut chang expect behavior new user new paramet gravitymax_multipole_moment_level ad come play use multipol solver comput boundari condit domain isol mass distribut default behavior castro construct boundari condit graviti solv multipol expans sum densiti coars grid increas valu new paramet default higher number use data refin level construct boundari condit valu file sponge_ndf sourcesrc_nd renam sponge_ndf file extens chang indic run preprocessor pleas updat local name file your overrid problem setup spong updat usual done implicit fashion instead explicit updat castrosponge_implicit shock variabl output run shock detect enabl microphysicseo microphysicseo number chang done microphys repo see microphysicschang log consist across boxlib suit astro code weve renam main environ variabl castro_hom replac castro_dir microphysics_hom replac microphysics_dir eo network conduct routin move subdirectori castromicrophys reflect way layout standalon microphys repo well maestro routin sourcesrc_nd renam f file f file use preprocessor use prob_ndf problem_tagging_ndf rotation_frequencyf ext_src_ndf local copi problem directori overwrot pleas sure updat file extens castro recogn use allow_negative_energi case rhoe total ga energi zone neg indirectli cover would reset case due way logic work reset intern energi updat total energi consist howev one point ad option castrodual_energy_update_e_from_ disabl second updat also meant neg rhoe possibl possibl preclud directli reset rhoe way detect neg chang result unless use castrodual_energy_update_e_from_ also good time plug newer option castroallow_small_energi set reset hit rhoe less smallest possibl energi rho small_temp x zone note requir extra eo call default interpol coars zone fine zone piecewis linear option use piecewis constant instead set castrostate_interp_ord note use piecewis linear set castrolin_limit_state_interp want preserv linear combin therefor guarante say sumx set new option castrolimit_fluxes_on_small_den flux explicitli limit neg densiti never creat along similar line also new option reset neg densiti one aris set castrodensity_reset_method use averag adjac zone instead default characterist adjac zone highest densiti set want reset origin zone state hydro updat fix issu diffus work correctli add_ext_src diffus sourc term independ whether userdefin sourc term convertcheckpoint live util usersguid doc consist boxlib code burn longer done ghost cell boundari neighbor level refin instead ghost cell fill done fill likelevel neighbor cell consequ chang reset_internal_energi invok cell reset intern energi e k reset reflect ghost cell consist behavior previous energi never reset ghost cell titl castro massiv parallel compress astrophys simul code tag c fortran convect hydrodynam nuclear reaction nucleosynthesi abund supernova author name ann almgren orcid x affili name maria barrio sazo orcid affili name john bell orcid x affili name alic harpol orcid x affili name max katz orcid affili name jean sexton orcid affili name donald willcox orcid affili name weiqun zhang orcid affili name michael zingal orcid x affili affili name center comput scienc engin lawrenc berkeley nation laboratori index name depart physic astronomi stoni brook univers index name nvidia corpor index name center comput astrophys flatiron institut index date juli bibliographi paperbib summari castro highli parallel adapt mesh multiphys simul code compress astrophys flow use simul differ progenitor model type ia supernova xray burst corecollaps electron captur supernova dynam exoplanet togeth castro low mach number code maestroex maestroex cosmolog code nyx nyx make amrexastrophys suit opensourc adapt mesh perform portabl astrophys simul code core hydrodynam solver castro castro base direct unsplit corner transport upwind method ctu piecewis parabol reconstruct ppm model reactiv flow stellar environ core capabl castro astrophys reaction network stiff requir implicit integr techniqu accur stabl solut castro sever mode coupl reaction hydro simplest method tradit oper split approach use strang split achiev secondord time howev reaction energet coupl break two differ implement base spectral defer correct sdc method aim prevent hydro reaction becom decoupl simplifi sdc method use ctu ppm hydro togeth iter scheme fulli coupl reaction hydro still second order simple_sdc altern implement tradit sdc method coupl hydro reaction second fourthord space time castro_sdc present method singlelevel strang split simplifi sdc method retri scheme timestep reject retri smaller subcycl timestep burn solv fail meet toler neg densiti gener violat one timestep criteria addit reactiv hydrodynam castro includ full selfgrav isol boundari condit rotat implement energyconserv fashion explicit thermal diffus gray castroii multigroup castroiii flux limit diffus radiat hydrodynam constrain transport mhd solver base ctu algorithm also avail use physic sourc term castro use arbitrari equat state reaction network microphys routin provid starkil project starkil castro built amrex amrex adapt mesh refin amr librari larg written c fortran comput kernel amr level advanc timestep subcycl jump factor support level use mpi distribut amr grid across node use logic tile openmp divid grid across thread multicor cpu machin expos coarsegrain parallel cuda spread work across gpu thread gpubas machin finegrain parallel core physic run gpu shown scale well thousand gpu castro_ hundr thousand cpu core castro_ perform portabl use sourc code cpu gpu implement parallel loop abstract layer provid amrex abstract parallel loop accept argument rang indic bodi loop execut given index amrex backend dispatch work appropri eg one zone per gpu thread strategi similar way kokko kokko raja raja abstract model provid perform portabl c statement need number astrophys hydrodynam simul code castro offer uniqu featur origin motiv develop castro build simul code base modern wellsupport amr librari boxlib evolv amrex use unsplit integr techniqu target problem nuclear astrophys radiat solver key design consider earli develop larg develop commun contribut amrex repres larg number applic code across variou domain result castro continu gain optim new architectur castro evolv adopt fulli open develop model enzo enzo code exampl pride make scienc problem avail castro git repositori develop infrastructur use run problem write scienc paper publicli avail amrexastro organ simul code like flash flash also work gener equat state reaction network castro uniqu focus spectral defer correct techniqu coupl hydro reaction final astrophys code perform portabl fork like kathena kathena use kokko castro current design target cpu gpu solver achiev perform portabl core design principl avoid need fractur develop model acknowledg work stoni brook support doeoffic nuclear physic grant defger nsf award ast mz acknowledg support simon foundat research support exascal comput project scsc collabor effort us depart energi offic scienc nation nuclear secur administr work lbnl support us depart energi contract deacch also thank nvidia corpor donat titan x pascal titan v use research gpu develop castro benefit greatli numer gpu hackathon arrang olcf refer radiat diagnost directori contain diagnost castro radiat test gaussian_puls process gaussian radiat puls lgt_frntd process radi sedov problem produc rho u p function r comparison analyt solut rad_shock extract slice data radi shock test variabl singl variabl along specifi coordin direct plotfil plotfil rad_sourc analysi routin radiat sourc test take list file print rho e total radiat energi densiti first zone function time rad_spher print radiat quantiti specifi distanc origin written radiat sphere problem rhd_shocktub analysi routin rhd_shocktub build build one radiat diagnost specifi execut name target eg make dim rad_sphereex take care compil correct dimens ie set dim equal valu code gener plotfil investig run command line argument must pass execut provid plotfil anaylz problem paramet gaussian_puls p plotfile_nam plotfil provid plotfil slicefile_nam slicefil provid name file output result xctr x yctr provid coordin center domain xy provid default lgt_frntd p plotfile_nam plotfil provid plotfil slicefile_nam slicefil provid name file output result rad_shock p plotfile_nam plotfil provid plotfil slicefile_nam slicefil provid name file output result idir direct along take slice integ correspond xz direct default rad_sourc argument assum list plotfil analyz rad_spher p plotfile_nam plotfil provid plotfil g groupfile_nam groupfil provid name group file output runtim radspher problem r radiu radiu provid radiu print radiat quantiti rhd_shocktub p plotfile_nam plotfil provid plotfil g groupfile_nam groupfil provid name group file output runtim radspher problem slicefile_nam slicefil provid name file output result sedov diagnost process sedov problem produc rho u p function r comparison analyt solut build run ndimension diagnost built execut make dimn produc execut sedov_ndex run execut must provid list argument problem must provid name plotfil analyz name slicefil result shall output sedov_ndex p plotfile_nam slicefile_nam addit argument depend problem addit argument requir cylindr extra arguent xctr x yctr give coordin domain center xy provid default spheric argument sphr must provid indic spheric problem yctr argument provid give coordin domain center default cylindr extra arguent xctr x yctr give coordin domain center xy provid default spheric argument sphr must provid indic spheric problem extra arguent xctr x yctr zctr z give coordin domain center xyz provid default sedov diagnost routin diagnost routin diagnosticsdustcollaps use construct data appear figur first castro paper analyt maximum densiti comput initi densiti analyt rt use conserv mass hardwir maincpp file radiu star plotfil comput first comput radial averag densiti find radiu densiti equal half analyt maximum densiti build run type make dimn build diagnost routin ndimension problem run problem run dustcollapse_dex plotfil plotfil ie run execut follow list plotfil analyz problem addit argument pass list plotfil give coordin domain center provid default problem would dustcollapse_dex xctr x yctr plotfil plotfil similarli dustcollapse_dex xctr x yctr zctr z plotfil plotfil problem also possibl print profil file provid argument profil creat profil file profprofil plotfil directori analyt solut make analyt profil type gfortran analyticf aout analytictxt plot use gnuplot make figur use dustcollapsegp creat file analytictxt results_dtxt results_dtxt results_dtxt thank pr pleas provid descript titl fill follow field best note pr target develop branch follow style convent httpsamrexastrogithubiocastrodocscoding_conventionshtml pr summari pleas summar pr squash merg pr summari suitabl commit messag pr address issu refer issu well pr motiv pleas describ motiv pr appropri section includ commit messag use commun develop pr accept section option delet pr checklist test suit need run pr pr chang answer test suit roundoff level newlyad function docstr per code convent chang file updat appropri appropri chang describ doc sampl script volum render yt origin written wd merger problem mind volwdpi script basic volum render use perspect len volwdsphericalpi script spheric project pi steradian camera set origin use creat degre video upload youtub note prepar video youtub follow instruct httpssupportgooglecomyoutubeanswerhlen particular need add metadata video done googl spatial media metadata injector httpsgithubcomgooglespatialmediablobmasterspatialmediareadmemd construct logo creat bitmap slice wdmerger simul use script logopi use gimp resiz imag interact star cut axe use imag crop select open inkscap import imag use file import select imag use path trace bitmap set color check remov background box select largest element resiz canva use edit resiz page select problem radiationhydro sedovtaylor like blast wave castro paper ii default case one section kp variant larg planck mean opac one section radfront setup base opticallythin stream radiat front describ castro paper ii differ instead defin bc er im use correspond valu fr assum optic thin frcer fill region radiat im use do_hydro instead hyperbol updat medium low densiti temperatur im use valu rosseland planck coeff version domain size cm wherea x cm opac chang similar optic depth along domain setup case seen radiat front propag speed light problem setup pure diffus problem hydro use explicit diffus solver castro diffus gaussian thermal puls diffus castro incorpor energi equat solv dρedt k l laplacian k thermal conduct assum k constant castro requir assumpt problem take ρ constant use gammalaw eo e c_v take form diffus equat dtdt kρ c_v constant diffus coeffici diffus explicitli constraint timestep dt dxd constant diffus coeffici analyt solut diffus gaussian remain gaussian amplitud descreas width increas time test problem creat deriv variabl analyt analyt solut time plotfil output allow compar current solut analyt solut assess error also use castro problemspecif postsimul hook probcpp output linf norm error numer vs analy solut end simul use converg test spheric amr use nd order accur predictorcorrector formul diffus use ctu hydrodynam solver test diffus spheric coordin level refin run castrodgnuex inputsdsph castrodgnuex inputsdsph amrn_cel castrodgnuex inputsdsph amrn_cel end run report norm error analyt solut give base resolut linf error e e sdc converg test thorder sdc algorithm run castrodgnuex inputsd castrotime_integration_method castrosdc_ord amrn_cel castrodgnuex inputsd castrotime_integration_method castrosdc_ord amrn_cel castrodgnuex inputsd castrotime_integration_method castrosdc_ord amrn_cel castrodgnuex inputsd castrotime_integration_method castrosdc_ord amrn_cel note cartesian spheric sinc dont spheric implement th order norm error output end function resolut resolut linf error e e e e nonconst conduct analyt solut nonconst conduct converg test vari resolut manner error report end run meaningless sinc compar analyt solut constant conduct secondord predictorcorrector algorithm powerlaw conduct simpli k k tν build test conduct make dim conductivity_dirpowerlaw j test run castrodgnuex inputsdpowerlaw amrn_cel mv diffuse_plt diffuse_ castrodgnuex inputsdpowerlaw mv diffuse_plt diffuse_ castrodgnuex inputsdpowerlaw amrn_cel mv diffuse_plt diffuse_ error measur use richardsonconvergencetest tool amrextoolsc_utilconverg richardsonconvergencetestdgnuex coarfilediffuse_ medifilediffuse_ finefilediffuse_ give level l norm error compon warn boxarray length level level l norm error compon warn boxarray length level begintablep begincent begintabularcccc hline variabl e_h rightarrow h order e_h rightarrow h hline densiti e e xmom e e ymom e e zmom e e rho_e e e rho_e e e temp e e rho_x e e bit edit eg see secondord converg temperatur th order sdc built previou test make dim conductivity_dirpowerlaw j run castrodgnuex inputsdpowerlaw castrotime_integration_method castrosdc_ord amrn_cel mv diffuse_plt diffuse_ castrodgnuex inputsdpowerlaw castrotime_integration_method castrosdc_ord mv diffuse_plt diffuse_ castrodgnuex inputsdpowerlaw castrotime_integration_method castrosdc_ord amrn_cel mv diffuse_plt diffuse_ castrodgnuex inputsdpowerlaw castrotime_integration_method castrosdc_ord amrn_cel mv diffuse_plt diffuse_ richardsonconvergencetestdgnuex coarfilediffuse_ medifilediffuse_ finefilediffuse_ convergence_diffusiondlosdcout richardsonconvergencetestdgnuex coarfilediffuse_ medifilediffuse_ finefilediffuse_ convergence_diffusiondhisdcout give lower resolut run level l norm error compon warn boxarray length level level l norm error compon warn boxarray length level begintablep begincent begintabularcccc hline variabl e_h rightarrow h order e_h rightarrow h hline densiti e e xmom e e ymom e e zmom e e rho_e e e rho_e e e temp e e rho_x e e pressur e e eg see fourthord converg temperatur th order sdc built previou test make dim conductivity_dirpowerlaw j use_mpitru run mpiexec n castrodgnumpiex inputsdpowerlaw castrotime_integration_method castrosdc_ord amrn_cel mv diffuse_plt diffuse_d_ mpiexec n castrodgnumpiex inputsdpowerlaw castrotime_integration_method castrosdc_ord mv diffuse_plt diffuse_d_ mpiexec n castrodgnumpiex inputsdpowerlaw castrotime_integration_method castrosdc_ord amrn_cel mv diffuse_plt diffuse_d_ mpiexec n castrodgnumpiex inputsdpowerlaw castrotime_integration_method castrosdc_ord amrn_cel mv diffuse_plt diffuse_d_ richardsonconvergencetestdgnuex coarfilediffuse_d_ medifilediffuse_d_ finefilediffuse_d_ convergence_diffusiondlosdcout richardsonconvergencetestdgnuex coarfilediffuse_d_ medifilediffuse_d_ finefilediffuse_d_ convergence_diffusiondhisdcout give lower resolut run level l norm error compon warn boxarray length level level l norm error compon begintablep begincent begintabularcccc hline variabl e_h rightarrow h order e_h rightarrow h hline densiti e e xmom e e ymom e e zmom e e rho_e e e rho_e e e temp e e eg see fourthord converg temperatur model_burn take initi model read via model_pars simpli call burner zone initi model hse_converg meant simpl test assess converg hydro graviti maintain hse converg measur either richardsonconvergencetest tool look max u plotfil run problem use one converg script convergence_plmsh run ctu plm use default hse bc default use_pslop reflect bc without use_pslop final run reflect instead hse bc test show best result come hse bc reflect vel convergence_ppmsh run ctu ppm similar set configur plm one addit one grav_source_typ test show best result come hse bc reflect vel convergence_sdcsh use true_sdc integ first sdc plm reflect bc sdc ppm reflect bc hse bc final sdc reflect test show plm reflect use wellbalanc use_pslop sdc reflect give lowest error expect better converg evrard collaps problem collaps isotherm spheric ga cloud problem origin discuss evrard implement test come section springel v monthli notic royal astronom societi volum issu pp section hse_convergence_gener hse converg test problem base flame_wav meant run understand well preserv hse problem reacting_converg reaction test use measur converg react hydro built acoustic_pulse_gener test converg test castroexecreacting_testsreacting_converg make compintel j output directori mkdir reacting_converg cd reacting_converg cp castroexecreacting_testsreacting_convergencecastrodintelhaswellmpiex cp castroexecreacting_testsreacting_convergenceinput cp castroexecreacting_testsreacting_convergenceprobin cp castroexecreacting_testsreacting_convergencehelm_tabledat cp castroexecreacting_testsreacting_convergencejob_scriptscorireacting_convergenceslurm sbatch corireacting_convergenceslurm analysi output directori cp developmentcastroexecreacting_testsreacting_convergenceanalysischeck_convergencesh cp developmentcastroexecreacting_testsreacting_convergenceanalysiscreate_pretty_tablespi edit use bash give proper execut name check_convergencesh output set converg data file process set latex tabl row python create_pretty_tablespi bubble_converg problem develop test converg th order sdc solver graviti reaction reflect boundari condit featur castro sdc paper httpsuiadsabsharvardeduabsapjz measur converg script converge_testsh test converg bubbl rise problem run test differ resolut resolut shown paper build make use_true_sdctru j run test via converge_testsh reli built richardsonconvergencetest amrextoolsc_utilconverg put execut path output file produc sdc_convergeloout sdc_convergemidout sdc_convergehiout give order converg run respect creat summari tabl use create_pretty_tablespi eg mid hi resolut case would python create_pretty_tablespi simpl sdc_convergemidout sdc_convergehiout give rho e e e rho u e e e rho v e e e rho e e e e rho e e e e e e e rho xisotmh e e e rho xisotmc e e e rho xisotmo rho xisotmf essenti valu shown tabl castro sdc paper hse converg setup also use test hse converg build make use_true_sdctru use_reactfals j run test converge_test_sdc_nopertsh get maximum veloc fextremagnuex bubble__plt grep magvel fextremagnuex bubble__plt grep magvel fextremagnuex bubble__plt grep magvel give max u e demonstr nearli th order converg hse state origin cori converg test result castro sdc paper run cori use file job_script castroexecreacting_testsbubble_converg make use_true_sdctru compintel j output directori mkdir bubble_converg cd bubble_converg cp castroexecreacting_testsbubble_convergencecastrodintelhaswellmpiex cp castroexecreacting_testsbubble_convergencehelm_tabledat cp castroexecreacting_testsbubble_convergenceinputs_d cp castroexecreacting_testsbubble_convergenceprobin cp castroexecreacting_testsbubble_convergencejob_scriptscoribubble_convergenceslurm sbatch coribubble_convergenceslurm measur converg bubble_converg output directori cp developmentcastroexecreacting_testsbubble_convergencejob_scriptscheck_convergencesh cp developmentcastroexecreacting_testsbubble_convergencejob_scriptscreate_pretty_tablespi edit use bash give proper execut name check_convergencesh output set converg data file process set latex tabl row python create_pretty_tablespi nse_test simpl test problem design explor well hydro reaction coupl system enter nse version base reacting_converg turn base acoustic_pulse_gener use aprox network nse tabl enabl run strang converg test script convergence_strangsh script create_pretty_tablespi take output file make singl latexformat tabl result problem descript singl mode rayleightaylor instabl problem instabl trigger perturb interfac dens light fluid problem use castro paper compar differ ppm type particl run particl build make use_particlestru run inputs_dparticl input file assign particl accord particle_fil locat particl move fluid veloc time step leav domain disappear test primarili design test abil castro handl particl acoustic_puls acoust puls problem mccorquodal colella use measur converg note dim still run mode set input paramet probleminit_as_d puls coordin direct converg test detail procedur use converg test nersc process result pretti tabl includ castro sdc paper castroexechydro_testsacoustic_puls make compintel j output directori mkdir acoustic_puls cd acoustic_puls cp castroexechydro_testsacoustic_pulsecastrodintelhaswellmpiex cp castroexechydro_testsacoustic_pulseinputsd cp castroexechydro_testsacoustic_pulsejob_scriptscoriacoustic_pulse_convergenceslurm sbatch coriacoustic_pulse_convergenceslurm analysi output directori cp castroexechydro_testsacoustic_pulsejob_scriptscheck_convergencesh cp castroexechydro_testsacoustic_pulsejob_scriptscreate_pretty_tablespi may need edit check_convergencesh use bash differ execut name check_convergencesh output convergencedlosdcout convergencedhisdcout process set latex tabl row python create_pretty_tablespi sod onedimension shock tube problem use run classic sod problem input file also provid run test problem defin toro text plot analyt solut done use script data verif verif directori contain analyt solut sedov problem comput use frank timm exact sedov routin httpwwwcococubedcomcodessedovsedovf compar castro output need radial bin plotfil data get densiti total veloc pressur function radiu accomplish use fsedovf routin castrodiagnosticssedov cylindr explos cartesian coordin run castrodgnumpiex inputsdcyl_in_cartcoord creat angleaverag profil compil castrodiagnosticssedovfsedovd_cyl_in_cartcoordsf make programsfsedovd_cyl_in_cartcoord run fsedovd_cyl_in_cartcoordslinuxgfortranex p plt sedovdout plot gnuplot script plot data overtop analyt solut provid simpli execut gnuplot sedovdgp sedovverif directori slice output run inputsdsph_in_cylcoord inputsdsph use sedovgp instead sedovdgp note get good agreement analyt solut sedov problem necessari start small timestep accomplish set castroinit_shrink input file subsampl critic ensur perturb spheric possibl import use lot step sedovf routin get good analyt solut acoustic_puls altern version acoust puls problem mccorquodal colella version perturb pressur use constant entropi via eo find densiti converg test detail procedur use converg test nersc process result pretti tabl includ castro sdc paper castroexechydro_testsacoustic_pulse_gener make compintel j output directori mkdir acoustic_pulse_gener cd acoustic_pulse_gener cp castroexechydro_testsacoustic_pulse_generalcastrodintelhaswellmpiex cp castroexechydro_testsacoustic_pulse_generalinputsd cp castroexechydro_testsacoustic_pulse_generalhelm_tabledat cp castroexechydro_testsacoustic_pulse_generaljob_scriptscoriacoustic_pulse_convergenceslurm sbatch coriacoustic_pulse_convergenceslurm analysi output directori cp castroexechydro_testsacoustic_pulse_generaljob_scriptscheck_convergencesh cp castroexechydro_testsacoustic_pulse_generaljob_scriptscreate_pretty_tablespi may need edit check_convergencesh use bash differ execut name check_convergencesh output convergencedlosdcout convergencedhisdcout process set latex tabl row python create_pretty_tablespi sod_stellar problem setup use zingal katz test hydrodynam gener equat state problem pure shock tube problem gener equat state exact solut produc comparison use exact riemann solver castroutilexact_riemann test check initi relax phase set rel larg damp factor run relax turn approxim planet model hot jupit planet use conjunct castroradi code dimens actual model paramet defin calcul hotjupitercpp file output newmodelcpphs file castro read planetari model base paper youdin mitchel mechan greenhous burial heat turbul hot jupit atmospher input castro inputs_d file edit paramet veloc vortic probin file nse_deton directori contain set script setup run analyz set deton compar strang split simplifi sdc basic usag screen session similar setup_runspi creat run directori copi need file run job parallel use python pool mechan job run check statu show_statuspi run finis make suit plot make_plotspi flame_wav xrb flame setup use eiden et al httpsuiadsabsharvardeduabsapj origin paper use boost flame longer boost flame speed find input file boost flame castro version earlier current set input file inputs_h pure flame includ input file followon paper harpol et al prep setup also inputs_h_h mix hhe flame intend run rprox network script cori script corixferslurm use migrat file hpss processxrb script run via screen data transfer node dtn archiv data hpss flame wave analysi script plot_generatorpi script gener plot sequenc dataset use yt variabl plot whether use logscal domain colorbar bound streamlin option etc configur command line argument usag descript full list valid paramet type plot_generatorpi h todo add output dpi figur size set image_animatorpi use ffmpeg directli ossystem call gener anim sequenc imag allow user specifi output file offer support sort imag advantag fast low memori footprint configur framer restrict width height imag must divis mpl_image_animatorpi use matplotlib gener anim sequenc imag allow user specifi output file offer support sort imag advantag height width restrict offer stack featur vertic stack multipl imag use separ subplot restrict much slower ffmpeg version much larger memori footprint todo allow user specifi framer front_trackerpi script measur locat flame shock front sequenc snapshot allow user specifi metric track th local enuc maximum default whether use global local maximum domain bound thing usag descript full list valid paramet type front_trackerpi h work dataset test flame wave one restrict current track along one dimens user tell elimin other either slice averag track percentag maximum field output spacedelimit data file call front_trackingdat default flame_speedpi script read front track dataset plot fit line portion usag flame_speedpi data_fil starting_index start index index first datapoint consid fit line script print slope line rsquar valu fit error plot appear squash pop window need enlarg use scipi panda multirayspi plot vertic slice axisymmetr dataset gener ortho ray one end domain one along center variabl plot suppli command line argument eg multirayspi v temp parallel run multipl instanc particular analysi script parallel run one instanc time given directori overviewpi plot temperatur enuc zveloc vertic stack field plot set modifi field list script time_seriespi creat stack plot abar sequenc time point schlierenpi make schlieren plot plot ln ρ ρ dataset problem descript simpl flame problem set fuel ash region smooth transit temperatur composit densiti comput domain constant pressur initi thermal diffus heat fuel point ignit flame ignit propag right usag public file go togeth boost flame flame_wav problem compil triple_alpha_plus_cago network