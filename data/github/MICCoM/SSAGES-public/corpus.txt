ssage v releas note v critic bug fix patch eigen gromac correct gradient anglecv addit check doc multiwalk logger support newer lammp version minor sourc cleanup v critic bug fix neuralnetwork base method updat eigen depend v mani document improv support newer hoomd version build process fix v new combin forcefrequ sampl method addit nonweight intern center mass calcul document addit new annbas collect variabl ssage v releas note v new rmsd collect variabl improv qbox exampl standard test suit improv document addit travisci test gener code cleanup bugfix see commit v improv elast band sampl temporari remov gromac addit document gener code cleanup bugfix see commit v major document updat improv hoomdblu support ann restart python script metadynam exampl support newer gromac version sever bugfix see commit v hoomdblu support support newer gromac lammp version cv definit check method document updat sever bugfix see commit v grid intern updat abf integr handl interpol direct independ abf restart handl json member gyrationtensorcv project number dimens document updat sever bugfix see commit v gromac support x x x better cmake handl hook handl lammp line continu correct handl multiprocessor abf method bf method cleanup minor document updat eigen includ updat googletest includ updat jsoncpp includ updat v ad ann sampl document updat updat exampl ad fourier chebyshev basi set bf ad abf integr improv period handl grid secondari structur cv bug fix improv qbox integr ssage v releas note v major document updat major exampl updat new gener pairwis cv new secondari structur cv alpha antiparallel beta sheet rmsd new cv log capabl cv select name method updat unit test updat abf integr period nonperiod cv gromac support mani bug fix v new simplifi json syntax support multipl simultan method elimin boost depend cv selector method argument forward gromac updat forward flux exampl signific underthehood improv fix gromac autodownload ssage v releas note v support qbox firstprincipl md engin support openmd engin coordin number cv polym rous mode cv box volum cv virial contribut npt support cv method updat exampl document new backend grid gridbas metadynam updat forward flux sampl fix regress string method perform improv ssage v releas note v gromac restart support new gyrat tensor cv updat exampl document metadynam optim better engin error handl see commit log div aligncent hrefhttpssagesprojectgithubio target_blank img srcdocassetsssageslogopng altssag height div h aligncent p aligncent hrefhttpssagesprojectgithubiodocsindexhtml target_blank img srchttpsimgshieldsiobadgedocsvbluesvg altdocument nbsp hrefhttpsdoiorg target_blank img srchttpsimgshieldsiobadgedoifblu altcit ssage p h ssage softwar suit advanc gener ensembl simul opensourc engin agnost c base advanc sampl packag design easi use extend extrem versatil current prebeta mean mani rough edg work rapidli expand featur fix bug keep eye page futur updat see contribut what new v numer improv gromac hook new qbox exampl support newer lammp version engin version log ann cff schema includ cv section sourc cleanup fetch extern depend build time minor sourc cleanup chang view full changelog histori refer historyhistorymd idfeaturesa featur ssage current work multipl molecular dynam engin contain varieti collect variabl cv advanc sampl method highlight engin agnost framework simpl json input file syntax easi add new cv easi add new method much engin gromac x x x lammp recent version openmd qbox cv artifici neural network function group posit atom group coordin atom group posit atom group separ bend angl box volum compon gyrat tensor pairwis kernel coordin number nearest neighbor polym rous mode rootmeansquar deviat rmsd secondari structur alpha antiparallel beta sheet rmsd torsion angl method adapt bias forc artifici neural network sampl basi function sampl combin forcefrequ sampl metadynam umbrella sampl finit temperatur string nudg elast band swarm trajectori forward flux sampl idinstallationa instal first step clone repositori local bash git clone httpsgithubcomssagesprojectssagesgit ssage use cmake build system also requir use support md engin exampl compil lammp execut follow bash cd ssage mkdir build cd build cmake dlammps_srcpathtolammpssrc make build ssage execut resid build directori want use specif compil default compil support set c c compil cmake_c_compil cmake_cxx_compil respect exampl use gccg replac cmake command bash cmake dlammps_srcpathtolammpssrc dcmake_c_compilergcc dcmake_cxx_compilerg want compil run unit integr test replac cmake command exampl bash cmake dlammps_srcpathtolammpssrc dbuild_testson mpi requisit underli mpi librari also requir run ssage recent debian base system use openmpi requir instal via bash sudo aptget instal libopenmpidev openmpibin detail build system pleas check document build document refer document readmedocreadmemd known issu ssage current prebeta mean may known issu yet resolv major issu list restart fulli function method contribut feel free fork project github pullrequest featur request form contribut welcom exampl demonstr cff method calcul potenti mean forc alanin dipeptid water use gromac insid directori walker run cff use singl walker run exampl execut ssages_pathbuildhooksgromacsgromacsbingmx_mpi grompp f nptmdp p topoltop c nptgro adptpr mpirun np nprocessor ssages_pathbuildssag cffjson run produc main output file call cffout similar file cffout locat folder pleas see ssage document methodscff inform definit input variabl addit note gromac input file modifi chang underli properti simul chang paramet tpr file must regener use gmx grompp follow ssages_pathbuildhooksgromacsgromacsbingmx_mpi grompp f nptmdp p topoltop c nptgro adptpr free energi surfac potenti mean forc plot one cff output data file cffout first two column cffout peptid torsion angl phi psi radian last column potenti mean forc kjmol hoomdblu umbrella sampl exampl author bradley dice bdiceumichedu pleas refer ssage document umbrella sampl instruct use exampl code folder contain sampl output ssage hoomdblu umbrella sampl exampl code cv_vs_timepng plot collect variabl dihedr angl time help check enough autocorrel time pass cv vs timecv_vs_timepng cv vs time histogram_trajectoriespng show histogram trajectori region cv sampl histogram trajectorieshistogram_trajectoriespng histogram trajectori histogram_combinedpng show histogram sum trajectori ensur entir rang angl sampl histogram combinedhistogram_combinedpng histogram combin wham_free_energypng free energi function dihedr angl wham free energywham_free_energypng wham free energi exampl calcul mfep particl move energi surfac two well barrier default exampl run imag mpirun np ssage ftsjson use file input_generatorpi modifi mani imag exampl use initi string imag paramet method modifi template_inputjson experi differ spring constant etc lastli lammp input file directli modifi chang underli properti simul exampl calcul mfep isomer alanin dipeptid use lammp exampl configur run two processor per walker paramet input may differ singl processor per walker exampl run exampl execut mpirun np ssage ftsjson use file input_generatorpi modifi mani imag exampl use initi string imag paramet method modifi template_inputjson experi differ spring constant etc lastli lammp input file directli modifi chang underli properti simul imag string overlaid free energi surfac data contain basiscsv execut python plotterpi bf exampl calcul mfep isomer alanin dipeptid water use gromac first must copi tpr file obtain gmx grompp includ python script run python copytprpi run exampl execut mpirun np ssage ftsjson use file input_generatorpi modifi mani imag exampl use initi string imag paramet method modifi template_inputjson experi differ spring constant etc lastli gromac input file modifi chang underli properti simul chang paramet tpr file must regener use gmx grompp follow gmx_mpi grompp f nvtmdp c adp_watergro p topol_watertop adp_hotpr imag string overlaid free energi surfac data contain f_out execut python plotterpi abf exampl calcul mfep isomer alanin dipeptid water use lammp run exampl execut mpirun np ssage ftsjson use file input_generatorpi modifi mani imag exampl use initi string imag paramet method modifi template_inputjson experi differ spring constant etc lastli lammp input file directli modifi chang underli properti simul imag string overlaid free energi surfac data contain f_out execut python plotterpi abf exampl calcul mfep isomer alanin dipeptid water use gromac exampl configur run two processor per walker paramet input may differ singl processor per walker exampl first must copi tpr file obtain gmx grompp includ python script run python copytprpi run exampl execut mpirun np ssage ftsjson use file input_generatorpi modifi mani imag exampl use initi string imag paramet method modifi template_inputjson experi differ spring constant etc lastli gromac input file modifi chang underli properti simul chang paramet tpr file must regener use gmx grompp follow gmx_mpi grompp f nvtmdp c adp_watergro p topol_watertop adp_hotpr imag string overlaid free energi surfac data contain f_out execut python plotterpi abf exampl calcul mfep isomer alanin dipeptid use lammp run exampl execut mpirun np ssage ftsjson use file input_generatorpi modifi mani imag exampl use initi string imag paramet method modifi template_inputjson experi differ spring constant etc lastli lammp input file directli modifi chang underli properti simul imag string overlaid free energi surfac data contain basiscsv execut python plotterpi bf exampl calcul mfep isomer alanin dipeptid water use lammp exampl configur run two processor per walker paramet input may differ singl processor per walker exampl run exampl execut mpirun np ssage ftsjson use file input_generatorpi modifi mani imag exampl use initi string imag paramet method modifi template_inputjson experi differ spring constant etc lastli lammp input file directli modifi chang underli properti simul imag string overlaid free energi surfac data contain f_out execut python plotterpi abf exampl calcul mfep isomer alanin dipeptid use gromac exampl configur run two processor per walker paramet input may differ singl processor per walker exampl first must copi tpr file obtain gmx grompp includ python script run python copytprpi run exampl execut mpirun np ssage ftsjson use file input_generatorpi modifi mani imag exampl use initi string imag paramet method modifi template_inputjson experi differ spring constant etc lastli gromac input file modifi chang underli properti simul chang paramet tpr file must regener use gmx grompp follow gmx_mpi grompp f nvtmdp c adpgro p topoltop adptpr imag string overlaid free energi surfac data contain f_out execut python plotterpi abf exampl calcul mfep isomer alanin dipeptid use gromac first must copi tpr file obtain gmx grompp includ python script run python copytprpi run exampl execut mpirun np ssage ftsjson use file input_generatorpi modifi mani imag exampl use initi string imag paramet method modifi template_inputjson experi differ spring constant etc lastli gromac input file modifi chang underli properti simul chang paramet tpr file must regener use gmx grompp follow gmx_mpi grompp f nvtmdp c adpgro p topoltop adptpr imag string overlaid free energi surfac data contain f_out execut python plotterpi abf exampl calcul mfep particl move energi surfac two well barrier default exampl run imag mpirun np ssage swarmjson use file input_generatorpi modifi mani imag exampl use initi string imag paramet method modifi template_inputjson experi differ spring constant etc lastli lammp input file directli modifi chang underli properti simul exampl calcul mfep isomer alanin dipeptid use lammp exampl configur run two processor per walker paramet input may differ singl processor per walker exampl run exampl execut mpirun np ssage swarmjson use file input_generatorpi modifi mani imag exampl use initi string imag paramet method modifi template_inputjson experi differ spring constant etc lastli lammp input file directli modifi chang underli properti simul imag string overlaid free energi surfac data contain basiscsv execut python plotterpi bf exampl calcul mfep isomer alanin dipeptid water use gromac first must copi tpr file obtain gmx grompp includ python script run python copytprpi run exampl execut mpirun np ssage swarmjson use file input_generatorpi modifi mani imag exampl use initi string imag paramet method modifi template_inputjson experi differ spring constant etc lastli gromac input file modifi chang underli properti simul chang paramet tpr file must regener use gmx grompp follow gmx_mpi grompp f nvtmdp c adp_watergro p topol_watertop adp_hotpr imag string overlaid free energi surfac data contain f_out execut python plotterpi abf exampl calcul mfep isomer alanin dipeptid water use lammp run exampl execut mpirun np ssage swarmjson use file input_generatorpi modifi mani imag exampl use initi string imag paramet method modifi template_inputjson experi differ spring constant etc lastli lammp input file directli modifi chang underli properti simul imag string overlaid free energi surfac data contain f_out execut python plotterpi abf exampl calcul mfep isomer alanin dipeptid water use gromac exampl configur run two processor per walker paramet input may differ singl processor per walker exampl first must copi tpr file obtain gmx grompp includ python script run python copytprpi run exampl execut mpirun np ssage swarmjson use file input_generatorpi modifi mani imag exampl use initi string imag paramet method modifi template_inputjson experi differ spring constant etc lastli gromac input file modifi chang underli properti simul chang paramet tpr file must regener use gmx grompp follow gmx_mpi grompp f nvtmdp c adp_watergro p topol_watertop adp_hotpr imag string overlaid free energi surfac data contain f_out execut python plotterpi abf exampl calcul mfep isomer alanin dipeptid use lammp run exampl execut mpirun np ssage swarmjson use file input_generatorpi modifi mani imag exampl use initi string imag paramet method modifi template_inputjson experi differ spring constant etc lastli lammp input file directli modifi chang underli properti simul imag string overlaid free energi surfac data contain basiscsv execut python plotterpi bf exampl calcul mfep isomer alanin dipeptid water use lammp exampl configur run two processor per walker paramet input may differ singl processor per walker exampl run exampl execut mpirun np ssage swarmjson use file input_generatorpi modifi mani imag exampl use initi string imag paramet method modifi template_inputjson experi differ spring constant etc lastli lammp input file directli modifi chang underli properti simul imag string overlaid free energi surfac data contain f_out execut python plotterpi abf exampl calcul mfep isomer alanin dipeptid use gromac exampl configur run two processor per walker paramet input may differ singl processor per walker exampl first must copi tpr file obtain gmx grompp includ python script run python copytprpi run exampl execut mpirun np ssage swarmjson use file input_generatorpi modifi mani imag exampl use initi string imag paramet method modifi template_inputjson experi differ spring constant etc lastli gromac input file modifi chang underli properti simul chang paramet tpr file must regener use gmx grompp follow gmx_mpi grompp f nvtmdp c adpgro p topoltop adptpr imag string overlaid free energi surfac data contain f_out execut python plotterpi abf exampl calcul mfep isomer alanin dipeptid use gromac first must copi tpr file obtain gmx grompp includ python script run python copytprpi run exampl execut mpirun np ssage swarmjson use file input_generatorpi modifi mani imag exampl use initi string imag paramet method modifi template_inputjson experi differ spring constant etc lastli gromac input file modifi chang underli properti simul chang paramet tpr file must regener use gmx grompp follow gmx_mpi grompp f nvtmdp c adpgro p topoltop adptpr imag string overlaid free energi surfac data contain f_out execut python plotterpi abf run parallel temper lammp input file replac temperatur valu keyword ptemp butane_ssagesin temepl json file set paramet template_inputjson mdstep total timestep run frequenc timestep frequenc swape configur cv dummpi cv influenc simul gener json file set paramet paralleltemp_input_generatorpi nwalker number walker min_temp minimum temperatur max_temp maximum temperatur run python paralleltemp_input_generatorpi run ssage mpirun np nwalker buildssag paralleltempjson exampl demonstr free energi surfac fe clcccl torsion angl dichloroethan chclchcl vacuum use qbox engin abf method run produc three output file f_out fworld_cv nworld fe creat run script tool folder python pathtossagestoolsabf_integratorpi f_out g p true addit note exampl inputjson md_iter set creat rough estim fe respect torsion angl get accur estim fe increas md_iter improv sampl ssage document ssagess document found onlin manualhttpsssagesprojectgithubiodocsindexhtml altern built ssage build document build directori requir make sure follow addit tool instal doxygen gener document annot c sourc code graphviz dot tool use draw graph visual sphinx document builder sphinxrtdthem read doc sphinx theme sphinxcontribbibtex sphinx extens bibtex style citat doxygen httpswwwdoxygennlindexhtml graphviz httpsgraphvizorg sphinx httpssphinxdocorg sphinxrtdthem httpssphinxrtdthemereadthedocsio sphinxcontribbibtex httpssphinxcontribbibtexreadthedocsio debianbas distribut eg ubuntu easili instal follow command sudo apt instal doxygen graphviz pythonsphinx pythonpip pip instal sphinx_rtd_them sphinxcontribbibtex build build document make doc also build apirefer user manual separ make apiref make manual pdflatex instal also build pdf file document compil apirefer pdf file cd docapidoclatex make pdf call refmanpdf similarli build pdf version manual cd docmanu make pdf call ssagespdf view document built document find docapidoc docmanu directori view document browser open file docmanualindexhtml docapidochtmlindexhtml _metadynam metadynam introduct metadynam defin class flathistogram method use molecular dynam simul within metadynam historydepend bia accru period applic element gaussian bias collect variabl cv interest form individu bias math gvecxivecs_i w_i efracleftvecxivecs_irightsigma_i mathvecxi collect variabl mathvecs_i locat mathitextth hill mathw_i weight mathsigma_i width hill bia act push system away previous visit state bia accru height nearbi featur free energi surfac system trajectori begin explor expand area cv space suffici number bias appli total appli bia within given region begin oscil around neg free energi region free energi surfac fe time matht may reconstruct sum appli bias thusli math fvecxit vvecxi sum_i nt w_i efracleftvecxivecs_irightsigma_i mathnt refer number bias appli time matht timedepend fe use determin whether simul reach converg fe comput block averag appli bia see citesingh metadynam appli unbound region cv space bound region case bound nonperiod cv boundari correct must appli alter structur hill mathgvecxivecs_i see citemcgovern metadynam exist mani flavor mathw_i mathsigma_i alter time trajectori depend fashion includ welltemp metadynam transitiontemp metadynam metadynam adapt gaussian method advantag drawback current ssage includ standard metadynam fixedshap hill temper algorithm detail use algorithm within ssage given follow section option paramet metadynam select defin type metadynam method json input file support follow option width array doubl length number cv array defin width gaussian deposit time cv dimens height doubl valu defin height gaussian deposit time unit energi use md engin hill_frequ doubl valu defin frequenc iter gaussian deposit note metadynam method yet support cv bound note metadynam method yet support restart warn metadynam run durat specifi input file user respons ensur enough time given metadynam obtain satisfactori represent free energi surfac interest simpl way prevent metadynam termin converg defin larg number timestep check output file period converg exampl input codeblock javascript method type metadynam width height hill_frequ output output metadynam store file call hillsout file contain locat width height gaussian deposit time time gaussian deposit new line written file follow format center center width width height center denot locat cv space gaussian deposit list order cv appear within ssage json input file width denot correspond gaussian width cv dimens height gaussian height match paramet height defin json input file note although width height gaussian current chang time futur addit metadynam method allow adapt gaussian exampl matlab script provid examplesusermeta directori script sum gaussian gener free energi surfac hillsout file _metadynamicstutori tutori two metadynam exampl includ examplesusermeta directori first exampl metadynam use sampl free energi surfac twodimension particl undergo langevin dynam exampl found single_atom directori use lammp file includ describ inlammps_meta_test lammp input file describ langevin particl underli free energi surfac sampl free energi surfac consist two gaussian well respect one gaussian barrier origin metajson ssage json input file specifi metadynam cv sampl case cv x coordin particl analys matlab script analyz output metadynam method moviem matlab script gener movi free energi surfac estim time run exampl either copi creat symbol link ssage execut exampl directori codeblock bash ln pathtossagesbuildssag run exampl issu command pleas note exampl two walker use explor system effici would like use walker processor per walker simpli includ driver metajson input file codeblock bash mpirun np ssage metajson run complet use provid analys analysispi script gener represent underli free energi surfac use matlab python matplotlib numpi requir develop hythem sidki swarm swarm trajectori introduct like string method gener string method swarm trajectori often abbrevi swarm trajectori even simpli sot method identifi transit pathway arbitrarili highdimension collect variabl space two metast state system pathway string parametr curv discret set imag molecular system classic string method collect variabl citemaragliano evolv imag estim mean forc metric tensor imag restrain molecular dynam simul sot method string instead evolv launch larg number swarm unrestrain trajectori imag estim averag drift collect variabl swarm mathemat background method express rel straightforward equat detail avail origin work benoît roux collabor citepan first consid path mathzalpha construct two metast state mathalpha repres start state mathalpha final state probabl transit pathway mptp defin molecular system start anywher path probabl evolv stay path shown origin work mathemat definit path given collect variabl evolv accord math z_ialpha z_ialpha sumlimits_jleft beta d_ijleft z right f_jleftzright fracpartialparti z_jleft d_ijleftzrightright rightdeltatau follow notat use mathz_i repres collect variabl belong string mathalpha repres paramet identifi point string mathbeta repres temperatur mathd_ij repres diffus tensor mathf_j repres mean forc mathz repres collect variabl construct molecular system given moment time mathdeltatau repres time step evolut dynam sot method approxim equat use averag drift evalu larg number unbias trajectori length mathdeltatau launch imag math overlinedelta z_ideltatau overlinez_ideltatau z_i equiv sumlimits_j left beta d_ijleftzright f_jleftzright fracpartialparti z_jleft d_ijleft zrightrightrightdeltatau like string method addit step beyond evolv collect variabl one iter evolut imag along path must reparameter lie exampl equal arc length apart step necessari ensur imag fall one metast basin algorithm sot method implement follow initi string defin two state interest defin howev one wish often simpli linear interpol space collect variabl fact end string need necessarili basin interest dynam natur method allow end natur fall nearbi metast basin imag string molecular system atom coordin roughli correspond collect variabl imag construct set equilibrium trajectori gener system perform restrain sampl around imag collect variabl set equilibrium trajectori use start point larg number short unbias trajectori result averag displac collect variabl use updat posit imag reparameter scheme enforc ensur exampl string imag equal distant collect variabl space step iter upon lead converg method mptp option paramet construct swarm input file follow option avail complet swarm json file inherit input string schema paramet common string method option uniqu swarm initial_step iter method number step spend restrain sampl harvest trajectori time import ensur underli molecular system cv valu close string cv valu harvest_length initi restrain finish trajectori harvest later use launch unrestrain trajectori everi often harvest length specifi often done harvest length multipli number trajectori see determin overal mani step taken restrain sampl number_of_trajectori total number unrestrain trajectori includ swarm swarm_length length unrestrain trajectori swarm swarm length multipli number trajectori specifi mani total step spent unrestrain sampl string schema option type paramet identifi stringtyp method use thu set string flavor paramet identifi specif kind stringtyp method use swarm set swarm center initi valu cv imag string specifi center array size equal total number imag entri consist array size equal number cv use string method way initi string defin toler toler threshold set trigger end method percentag node cv chang percentag method end must specifi array one entri cv desir max_iter complementari stop criterion specifi method stop undergo mani iter string method kspring uniqu spring constant must defin cv purpos describ frequenc frequenc integr step almost alway set _swarm_tutori tutori tutori walk step step user exampl provid ssage sourc code run sot method alanin dipeptid use lammp first sure compil ssage lammp navig ssagesexamplesuserswarmadp subdirectori take moment observ inadp_test datainput file gener would use method sot method import defin larger skin distanc one normal would neighbor command lammp hood unrestrain trajectori swarm start manual reset posit atom lammp simul start new trajectori perspect lammp huge amount distanc move singl time step move trigger neighbor list rebuild lammp consid danger build threaten crash simul thu increas skin distanc forc lammp keep track pair neighbor list thu reduc number danger build keep mind futur run sot method next two file interest template_inputjson input file input_generatorpi script file modifi text editor choic custom input tutori simpli observ leav template_inputjson contain inform necessari fulli specifi one driver input_generatorpi copi inform number time specifi within script tutori time also linearli interpol start end state defin script substitut correct valu center portion method definit execut script follow codeblock bash python input_generatorpi produc file call swarmjson also open file verifi script suppos json input ssage binari everyth need perform simul simpli run codeblock bash mpiexec np ssage swarmjson soon simul produc nodexlog file driver x number specifi driver case driver one report follow inform order node number iter number cv current valu string cv well current valu cv calcul molecular system allow system run desir number md step keep eye system exit one driver reach maximum number md step possibl instead one driver exit rest get stuck check node file see theyv updat recent simul like finish done execut includ plotterpi function directori contain node file command line argument mani imag string script also accept argument plot free energi surfac alongsid string gener anoth method goe beyond scope tutori thu simpli execut codeblock bash python plotterpi none moment graph converg string thu conclud tutori develop codi bezik acknowledg grate argonn nation laboratori initi project continu support julian helfferich acknowledg financi support dfg research fellowship program grant import core function ssage come saphron saphron statist appli physic random onthefli numer httpsgithubcomhsidkysaphron project supervisor juan de pablo jonathan whitmer project lead michael quevillon emr sevgen past project lead yamil j colón hythem sidki core develop julian helfferich hythem sidki benjamin sikora method codi bezik yamil j colón federico giberti ashley guo joshua lequieu jiyuan li joshua moller hadi ramezanidakhel emr sevgen hythem sidki benjamin sikora jonathan whitmer collect variabl yamil j colón ashley guo michael quevillon hythem sidki benjamin sikora mike webb document codi bezik yamil j colón federico giberti ashley guo julian helfferich joshua moller michael quevillon hadi ramezanidakhel emr sevgen hythem sidki engin adapt carl simon adorf federico giberti bradley dice michael quevillon emr sevgen hythem sidki benjamin sikora _engin engin ssage support multipl molecular dynam engin howev support featur md engin may result engin limit work progress tabl summar main featur vari support engin engin support version multiwalk npt virial lammps_ newer ye ye gromacs_ x x x ye ye openmd_ qbox_ newer ye hoomdblue_ newer ye special instruct use ssage particular engin list appropri section lammp build ssage support recent version lammp compil ssage compat version lammp either dlammpsy dlammps_srcpathtolammp must specifi cmake command exampl code bash cmake dlammpsy make automat download lammp version jul tag r compil ssage user interest use differ version lammp ssage download specif stabl releas must support code bash cmake dlammp aug user interest use alreadydownload sourc one person modif ssage point particular sourc repositori code bash cmake dlammps_srcpathtolammp mani user may take advantag option lammp packag ssage forward make command necessari enabl disabl packag call codeblock bash make yespackag codeblock bash make nopackag inform option packag lammp refer lammp user manual httpslammpssandiagovdocpackageshtml_ warn link ssage particular lammp sourc unabl compil lammp sourc outsid ssage ssage depend introduc sure backup repositori accordingli follow stabl version lammp test extens confid ssage also work lammp version aug dec feb may jul nov nov mar aug mar aug run ssage integr lammp though flexibl fix api offer lammp therefor necessari defin ssage fix within lammp input file follow codeblock none fix ssage ssage direct ensur ssage abl locat appropri adapt interfac lammp librari import name fix ssage shown otherwis ssage work properli highli recommend ssage fix command place integr fix also make sure fix specifi run command begin advanc sampl simul note due natur ssage forward command lammp use includ labeljump within lammp input script current support ssage compat typic lammp workflow includ equilibr energi minim step product long ssage fix declar lammp run without modif lammpsspecif properti requir ssage input file input properti point lammp input script detail found refinput file page inputfil gromac build ssage support recent version gromac compil ssage compat version gromac either dgromacsy dgromacs_srcpathtogromac must specifi cmake command exampl code bash cmake dgromacsy make automat download gromac compil ssage user interest use differ version gromac ssage download specif releas must support code bash cmake dgromac user interest use alreadydownload sourc one person modif ssage point particular sourc repositori code bash cmake dgromacs_srcpathtogromac common option build gromac pass gromac compil step instanc option dgmx_build_own_fftwon dgmx_gpuon dgmx_doubleon support newer version hwloc packag gromac may abl automat detect simd level workaround manual specifi dgmx_simdavx_ turn automat detect use hwloc packag warn link ssage particular gromac sourc unabl compil gromac sourc outsid ssage ssage depend introduc sure backup repositori accordingli follow version gromac support ssage confid ssage work version gromac box contrast lammp work hard make ssage compat new version gromac releas x x x setup compil gromac ssage use gromacss avail tool set system gener input file execut locat hooksgromacsgromacsbingmx_ssag within build directori note note gmx_ssage execut ssage folder function normal run regular gromac simul via gmx_ssage mdrun gromac indepth document httpmanualgromacsorgdocumentationcurrentuserguide_ help get start httpmanualgromacsorgdocumentationcurrentuserguidegettingstartedhtml_ section dwell much use tool gener system briefli gener gromac binari input file tpr requir follow three file box particl coordin simul gro file topolog describ forcefield connect top file option itp file simul detail file set paramet thermostat barostat use number length time step integr save frequenc mani mdp file exampl one convert protein pdb file onlin databas httpswwwrcsborg_ use gromac tool gener gro top file gener input file use preprocessor gmx_ssage grompp command codeblock bash gmx_ssage grompp f nptmdp p topoltop c confgro inputtpr exampl gro mdp top tpr json input avail exampl folder energi minim brief nvt npt equilibr run readi use ssage system first gener json file ssage input use singl walker inputfil tpr file name use multipl walker number input file right extens includ numberless file set inputfil numberless exampl use four walker set inputfil inputtpr follow folder inputtpr inputtpr inputtpr inputtpr inputtpr final defin cv method detail refinput file inputfil page run ssage forward argument gromac mdrun librari arg properti must specifi ssage input file describ refinput file inputfil page start simul call ssage execut codeblock bash mpiexec np n ssage inputjson n total number mpi process exampl three walker use processor set mathn openmd build ssage support recent version openmd compil ssage compat version openmd locat alreadydownload sourc must specifi cmake command code bash cmake dopenmd_srcpathtoopenmd warn link ssage particular openmd sourc unabl compil openmd sourc outsid ssage ssage depend introduc sure backup repositori accordingli follow version openmd support ssage confid ssage work version openmd box contrast lammp run openmdspecif properti requir ssage input file input properti point openmd input script detail found refinput file page inputfil qbox build ssage qbox run togeth use advanc sampl method ab initio molecular dynam simul coupl qbox perform serverdriv mode ssage act driver qbox server mean access version qbox minimum need recompil ssage qbox togeth howev necessari configur ssage use qbox compil correct hook driver add follow flag configur ssage code bash cmake dqboxy import remark case ssage automat download qbox simpli configur commun requir access qbox execut access precompil version need download compil httpqboxcodeorgbuild_ setup engin two input script necessari run qboxssag calcul compos n walker json input file specifi method cv want use also specifi qbox input file name number md densiti wavefunct step want use number n qbox input file use first step calcul obtain ground state densiti first step json file contain field would usual cv method logger etc three addit option code javascript walker n input md md mdn md_iter qm_iter wf_iter keyword walker input standard ssage keyword declar number walker start input file walker keyword md_iter qm_iter wf_iter respect number md step perform number scf perform per md step number wavefunct optim per scf step paramet correspond first second third number command run consult qbox document httpqboxcodeorgdochtml_ inform qbox input file walker specifi paramet use dft calcul xc ecut etc file pars qbox first time step simul set calcul file contain command run md step qbox perform unbias want featur use equilibr system first step command run qm_iter wf_iter repeat md_iter qbox input file must contain least md step order run ssage thu alway includ run command exampl inputjson mdi present examplesuserabfnaclqbox directori run previous report qbox ssage commun serverdriv mode launch qbox server mode suffici use proper keyword specifi input output file code bash mpirun n x qb server ssages_in_ ssages_out_ singl walker code bash mpirun n x qb server ssages_in_ ssages_out_ mpirun n x qb server ssages_in_ ssages_out_ mpirun n x qb server ssages_in_n ssages_out_n multipl walker moment name ssages_in_ ssages_out_ mandatori chang launch way qbox creat n file call ssages_in_nlock wait input file ssages_in_nlock delet disk qbox execut command contain file ssages_in_n write result calcul ssages_out_n creat n ssages_in_nlock file without delet lock file qbox execut command remain idl qbox start server mode run idl lock file present disk launch ssage drive calcul code mpirun n n ssage inputjson ssage start two code altern follow way ssage write script mdi file ssages_in_i initi dft paramet calcul trigger qbox execut delet lock file qbox perform dft calcul specifi ssages_in_i write output ssages_out_i recreat lock file ssage read qbox output calcul cv bia write file ssages_in_i contain extern forc posit atom well command run qm_iter wf_iter delet lock file trigger anoth md step calcul qbox step repeat md_iter number time last iter ssage write input file instruct qbox save restart_ixml file use restart calcul termin qbox instanc qbox ssage finish execut normal qbox overwrit output ssages_out_i server mode preserv trajectori avoid loss data ssage append ssages_out_i file ssages_out_i_run_jxml file latter index identifi walker j index identifi number run exampl restart two time would _run_xml _run_xml _run_xml suggest use restart_ixml file avoid discontinu trajectori restart creat mdi file contain load restart_ixml instruct use script analyz plot qbox trajectori avail qbox tool webpag httpqboxcodeorgtools_ run script first reformat ssages_out_i_run_jxml file run python script qboxxmlcleaningpi present tool directori exampl origin ssagesqbox output file ssages_out__run_xml command line reformat xml file code bash python qboxxmlcleaningpi ssages_out__run_xml ssages_out__run__cleanedxml first arug name origin xml output file second argument reformat xml file file analyz use script qbox tool webpag httpqboxcodeorgtools_ exampl creat xyz trajectori file reformat output ssages_out__run__cleanedxml run command code bash python qbox_xyzpi ssages_out__run__cleanedxml out__run_xyz run cluster like go launch calcul cluster supercomput need prepar submiss script launch job schedul given fact ssage need start qbox better either separ script submit two differ calcul use syntax ensur submiss occur right order exampl slurm httpsslurmschedmdcom_ use one script code bash srun n x n qb server ssages_in ssages_out srun n x n qb server ssages_in ssages_out srun n n ssage inputjson wait ensur script execut right way want differ script qbox ssage qbox script qbsh code bash srun n x n qb server ssages_in ssages_out srun n x n qb server ssages_in ssages_out ssage script ssagessh code bash srun n n ssage inputjson need submit third script launchsh code bash binbash j_qbsbatch qbsh awk print sbatch dependencyafterj_qb ssagessh advantag latter method three script avoid conflict modul may present first exampl depend compil qbox ssage hoomdblu build hoomdblu support ssage releas v later hoomdblu must built mpi support enabl use hoomd cmake flag denable_mpion recommend use python virtual environ hoomdblu describ hoomd compil instruct httpshoomdbluereadthedocsioenstableinstallationhtmlcompilehoomdblue_ virtual environ activ build hoomdblu ssage sourc use python appropri set relev cmake variabl exampl use make job slot code bash cd pathtohoomd mkdir build cd build python venv pathtonewvirtualenviron systemsitepackag sourc pathtonewvirtualenvironmentbinactiv cmake dcmake_install_prefixpython c import site printsitegetsitepackag denable_mpion make instal j cd pathtossag mkdir build cd build cmake dhoomdon make j altern hoomd built use make without instal use hoomd cmake flag dcopy_headerson inform hoomd cmake flag see hoomd document httpshoomdbluereadthedocsioenstableinstallationhtml_ case must specifi ssage cmake flag dhoomd_rootpathtohoomd_installationhoomd point hoomd directori within hoomdblu instal prefix code bash cd pathtohoomd mkdir build cd build cmake dcopy_headerson denable_mpion make j cd pathtossag mkdir build cd build cmake dhoomd_rootpathtohoomdbuildhoomd make j may necessari put hoomd build directori pythonpath python interpret find hoomd modul set variabl follow command code bash export pythonpathpythonpathpathtohoomdbuild run hoomdblu offer halfstep hook api support ssage featur automat configur ssage launch hoomdblu simul hoomdblu ssage user script written python script contain necessari import statement configur simul set type interact integr log output forth howev simul user script call hoomdrunstep call within ssage set hoomdblu commandlin option httpshoomdbluereadthedocsioenvcommandlineoptionshtml_ use ssage json input file set key arg string command line option pass hoomdcontextiniti _inputfil input file ssage input file contain multipl section defin collect variabl cv method variou compon go advanc sampl simul brief primer json format use ssage input file remain topic describ basic syntax requir section input file detail inform particular method collect variabl found respect locat manual json ssage run use input file written json_ file format json lightweight text format easi human read write machin pars gener almost everi program languag offer level nativ json support make particularli conveni script autom input file gener use say python youv never use json dont worri throughout document make assumpt user knowledg json provid clear easytofollow exampl ssage input file valid json document defin bit terminolog relat json take follow json structur exampl obtain wikipedia_ codeblock javascript firstnam john lastnam smith age address streetaddress nd street citi new york state ny postalcod phonenumb type home number type fax number gender type male first pair curli bracket defin root section signifi use item hierarchi street address referenc like addressstreetaddress squar bracket json refer array curli bracket refer object thought python list dictionari respect would make phonenumb array phone number object contain type number fax number referenc phonenumbernumb array index begin zero item json object python dictionari uniqu exampl age defin key root tree defin age throw error instead last definit overrid previou definit actual power behavior mean user import gener templat json file overrid whatev paramet wish exact behavior merg process describ detail user guid type matter json notic age specifi number surround quot number specif integ hand addresspostalcod string even though content string number certain field ssage input file may requir string integ number user awar take care format input file appropri simul properti ssage build compil support particular md engin requir engin vari slightli detail inform specif engin option check refengin engin section follow paramet need defin simul json root warn properti specifi casesensit pleas sure check defin accord document input input properti specifi name input file use simul engin codeblock javascript input insystem codeblock javascript input insysteminsysteminsystem first syntax use singl input file multiwalk simul possibl use singl file walker though may recommend depend method specifi separ input file walker note properti use gromac see arg properti arg warn properti exclus gromac hoomdblu arg properti specifi addit command line argument pass engin codeblock javascript arg v deffnm runfil codeblock javascript arg v deffnm runfil gromac standard simul invok use gmx mdrun deffnm runfil execut runfiletpr binari equival argument must specifi arg properti provid user flexibl call commandlin argument fashion standard mdrun util except case multiwalk simul user wish use multiwalk capabl arg invok fashion singlewalk simul specifi multi option done automat deffnm call gromac expect tpr file walker name accord walker id start zero exampl three walker gromac look file runfiletpr runfiletpr runfiletpr walker walker properti specifi number walker independ instanc simul engin run ssage codeblock javascript walker mani advanc sampl method support multiwalk simul improv converg mani algorithm typic walker independ system configur separ input file import note specifi singl walker number processor pass mpiexec must divis number walker request otherwis ssage termin error note possibl alloc differ number processor walker time collect variabl cv properti specifi collect variabl ssage perform advanc sampl codeblock javascript cv type torsion name mytorsion_ atom_id type particlecoordin atom_id dimens x collect variabl specifi array element cv object collect variabl assign name referenc index begin zero method method properti specifi advanc sampl algorithm ssage appli system codeblock javascript method type umbrella kspring output_fil ulogdat output_frequ center cv mytorsion_ type metadynam width height hill_frequ lower_bound upper_bound lower_bound_restraint upper_bound_restraint cv method specifi array sinc possibl run multipl method simultan use user interest perform advanc sampl system subject restraint typic appli via umbrella method select oper subset cv referenc either name index shown logger logger properti specifi output file track cv simul proce codeblock javascript logger frequenc output_fil cvsdat cv simul use multipl walker must defin array output_fil number filenam number walker instanc two walker use syntax codeblock javascript logger frequenc output_fil cvs_wdatcvs_wdat cv logger use track evolut cv cours advanc sampl calcul log cv allow postsimul reweight indic sampl problem system studi frequenc log cv specifi walker multiwalk simul separ output file user choos select log individu cv well put togeth combin previou section singl input file yield follow pure hypothet exampl input lammp simul codeblock javascript walker input infirst insecond cv type torsion name mytorsion_ atom_id type particlecoordin atom_id dimens x method type umbrella kspring output_fil walkerdat walkerdat output_frequ center cv mytorsion_ type metadynam width height hill_frequ lower_bound upper_bound lower_bound_restraint upper_bound_restraint cv execut input file assign two processor per walker one would call command codeblock bash mpirun np ssage inputfilejson _json httpswwwjsonorgjsonenhtml _wikipedia httpsenwikipediaorgwikijsonjson_sampl _umbrellasampl umbrella sampl introduct calcul thermodynam data properti reli proper sampl configur space howev presenc energi barrier prevent certain configur sampl properli even sampl umbrella sampl simul techniqu help overcom barrier improv sampl appli bia along specifi collect variabl bia take form harmon potenti typic constant throughout simul usual seri umbrellasampl simul perform analyz togeth use weight histogram analysi method wham citekumar function form artifici bia math u_textumbrella frac k leftxi xi_right mathk spring constant mathxi current valu collect variabl mathxi_ desir valu collect variabl success umbrella sampl method depend correct choic mathk mathxi_ differ simul suitabl valu mathk mathxi_ depend distanc adjac umbrella gradient free energi surfac mathxi_ inform umbrella sampl method interest reader refer ref citekastn option paramet follow paramet need set method json input file codeblock javascript type umbrella follow option avail umbrella sampl center requir array target valu cv either array number array array number multipl walker singl array defin use across walker kspring requir array spring constant cv either array number array array number multipl walker singl array defin use across walker output_fil requir output file name umbrella sampl data string array string multipl walker output_frequ option frequenc write output file default append option boolean valu caus umbrella sampl either append exist file overrid entir default fals umbrella sampl method also run time depend center equival steer md method omit center use follow option instead center requir array initi target valu cv either array number array array number multipl walker singl array defin use across walker center requir array final target valu cv either array number array array number multipl walker singl array defin use across walker timestep requir number timestep scale umbrella center set option umbrella method linearli interpol center center timestep iter _umbrella_tutori lammp tutori tutori go run umbrella sampl atomist model butan use lammp md engin umbrella sampl perform torsion cv butan c atom butan implement lammp requir sever modul ad link ssage return build directori issu follow command codeblock bash make yesmolecul make yeskspac make add molecul kspace lammp packag inform option packag lammp refer lammp user manual httpslammpssandiagovdocpackageshtml_ file run exampl found examplesuserumbrellalammp consist follow file butane_ssagesin lammp input file butanedata lammp data file describ butan molecul umbrella_inputjson templat json input contain inform one umbrella sampl simul umbrella_multiwalker_genpi python script creat multiwalker_umbrellajson input file total number simul center valu control file directori appropri json file need gener json file alreadi directori umbrella_inputjson contain cv inform specifi lammp input file use singlewalk umbrella simul run directli use codeblock bash ssage umbrella_inputjson simul creat output file name umbrelladat contain valu cv target valu center everi timestep histogram local free energi calcul possibl run umbrella sampl use singl walker typic multipl walker multipl umbrella simul run multiwalk umbrella sampl butan gener input file use umbrella_multiwalker_genpi script via codeblock bash python umbrella_multiwalker_genpi gener input file call multiwalker_umbrellajson contain inform umbrella_inputjson duplic time vari valu center valu correspond target valu torsion cv run multiwalk ssage issu command codeblock bash mpiexec np pathtossagesbuildssag multiwaler_umbrellajson run differ umbrella sampl simul simultan ideal exampl run comput environ process run differ processor exampl still work run user local desktop laptop machin runtim code larg simul differ output file gener contain iter target valu correspond center cv valu cv iter number output file use construct complet free energi surfac use wham algorithm citekumar though ssage current contain implement wham mani implement avail provid grossfield lab citewham hoomdblu tutori exampl use hoomdblu engin run parallel simul butan molecul free energi measur function dihedr angl termin carbon butan molecul backbon four carbon atom rotat differ conform httpschemlibretextsorgtextbook_mapsorganic_chemistrysupplemental_modules_organic_chemistrychiralitystereoisomersbutane_conformers_ anti gauch eclips wish extract free energi rotat know energi cost angl degre degre exampl use umbrella sampl weight histogram analysi method wham wham tool develop alan grossfield citewham use determin free energi bias sampl perform disclaim paramet simul number walker strength bia potenti spring length run etc may provid ideal sampl exampl problem improv code welcom file run exampl found examplesuserumbrellahoomd sampl output file exampl code examplesuserumbrellahoomdsample_output folder run exampl script modifi hoomdblu script set desir paramet eg kt butane_ssagespi modifi input gener set paramet umbrella_multiwalker_genpi umbrella_inputjson import paramet umbrella_multiwalker_genpi nwalker number walker determin mani independ simul run umbrella_inputjson kspring give bia potenti spring strength hoomd_step chang length run paramet use defin system collect variabl chang gener input codeblock bash python umbrella_multiwalker_genpi run ssage replac nwalker number walker specifi previous codeblock bash mpiexec np nwalker pathtossagesbuildssag multiwalker_umbrella_inputjson analyz data download wham code avail citewham compil program use instruct document provid recommend read talk theori practic wham httpmembraneurmcrochesteredusitesdefaultfileswhamwham_talkpdf_ call wham script wham_analysissh contain set paramet call wham requir execut wham directori codeblock bash wham_analysissh b run visual script codeblock bash python wham_visualizationpi script wham_visualizationpi read output data file ssage wham softwar produc set figur similar talk link visual output includ cv_vs_timepng plot collect variabl dihedr angl time help check enough autocorrel time pass histogram_trajectoriespng show histogram trajectori region cv sampl histogram_combinedpng show histogram sum trajectori ensur entir rang angl sampl wham_free_energypng free energi function dihedr angl develop hythem sidki benjamin sikora ssage cookbook collect short solut common problem like faq collect resourc relat ssage miccom summer school juli thth miccom httpmiccomcenterorg_ held summer school session focus code develop within center includ ssage main page event miccom comput school httpmiccomcenterorgsummerschoolindexhtml_ slide relev talk includ set ssage httpmiccomcenterorgimagessummer_school_setting_up_your_ssagespdf_ add new collect variabl cv httpmiccomcenterorgimagesmiccom_cv_talk_revealedpdf_ classic molecular dynam sampl method httpmiccomcenterorgimagesclassicalmdandsamplingvpdf_ enhanc sampl string method forward flux httpmiccomcenterorgimagesenhanced_samplingstring_methodspdf_ free energi method httpmiccomcenterorgimagesfree_energy_methodspdf_ _combinedforcefrequencysampl combin forcefrequ sampl introduct combin forcefrequ cff sampl free energi sampl method use artifici neural network gener onthefli adapt bia capabl rapidli resolv free energi landscap recent method propos citesevgen extens applic ab initio md demonstr citele method main strength resid abil learn frequenc visit distinct state gener forc estim aris system evolv phase space accomplish introduc selfintegr artifici neural network gener estim free energi directli deriv cff algorithm proce sweep statist collect user specifi interv sweep flexibl choic end sweep artifici neural network fit statist determin optim bia appli subsequ sweep proce free energi landscap converg exampl input codeblock javascript method type cff topolog nsweep temperatur grid lower upper number_point period falsefals lower_bound upper_bound lower_bound_restraint upper_bound_restraint timestep unit_convers minimum_count overwrite_output true warn sure follow correct json syntax input comma everi line except last within bracket option paramet defin cff method block defin cff method syntax codeblock javascript type cff defin neural network topolog codeblock javascript topolog array integ length number hidden layer array defin architectur neural network like ann sampl good heurist use network singl hidden layer bias one cv two hidden layer bias two codeblock javascript temperatur temperatur simul must specifi defin length sweep codeblock javascript nsweep typic valu rang depend size system slower system dynam longer sweep go heavili affect converg time method gener quit robust choic sweep length main consequ choic neural network train time becom rel expens system free energi cheap evalu defin grid defin bound codeblock javascript lower upper array doubl whose length number cv use defin minimum maximum valu cv rang method use order defin number cv bin use codeblock javascript number_point array integ defin number histogram bin cv dimens order codeblock javascript period falsefals array defin whether given cv period restraint purpos use appli minimum imag convent cv restraint valu safe set fals even period cv restraint use defin restraint codeblock javascript lower_bound upper_bound array defin minimum maximum valu cv restraint order codeblock javascript lower_bound_restraint upper_bound_restraint array defin spring constant lower upper bound defin time unit paramet codeblock javascript timestep timestep simul unit depend convers factor follow must enter correctli otherwis gener forc estim incorrect codeblock javascript unit_convers defin unit convers dmomentumdtim forc simul lammp use unit real gramangstrommolefemtosecond kcalmoleangstrom gromac codeblock javascript minimum_count number hit requir bin gener histogram full bias forc activ valu bia linearli decreas zero hit default valu user provid reason valu system handl output option codeblock javascript overwrite_output true enabl output file overwritten sweep otherwis output file save sweep default true output six output file method cffout f_out netstatenet netstatenet cffout_gamma traintimeout main output method store cffout column correspond respect cv visit frequenc histogram bia base frequencybas ann bia base forcebas ann averag bia averag free energi estim neg averag bia constant shift format follow cv cv hist biasfreq_onli biasforce_onli biasavg free_energyavg file call cffout_gamma output network complex term gamma neural net ratio gamma neural net see citesevgen inform format follow sweep_it gammafreq_onli gammaforce_onli gamma_ratio file traintimeout contain cpu wall time second taken train neural network sweep file call netstatedat netstatedat contain neural network paramet two neural network use appli bias sampl netstatedat store frequencybas paramet netstatedat store forcebas one inform file see ann sampl method file call f_out contain gener forc vector field output file adapt bias forc method vector defin point grid goe cv_lower_bound cv_upper_bound cv dimens cv_bin grid point dimens printout follow format n number column n number cv first n column coordin cv space n n column compon gener forc vector see abf sampl method inform exampl cff eg alanin dipeptid water locat examplesusercffadp develop elizabeth lee emr sevgen boyuan yu warn pleas make sure cite citesevgen citele use method _refer develop note file name zreferencesrst appear end file list sphinxcontribbibtex must refer file compil last refer bibliographi referencesbib style plain orphan image_method imag method introduct surfac charg polar strongli affect natur interact charg dielectr object particularli sharp dielectr discontinu involv howev effici accur comput tool publicli avail especi descript polar effect manybodi system purpos imag method analyt perturb approach recent develop evalu polar energi manybodi collect charg dielectr sphere embed dielectr medium becom particularli suitabl _ polarizationinduc interact sphere depend ratio dielectr constant sphere medium ratio distanc particl radii particl shown case polar complet alter qualit behavior case polar lead stabl configur otherwis could occur absenc think help includ imag method ssage user includ polar correct properli system meanwhil coupl advanc sampl method acceler simul option paramet ssage imag method implement way easi conduct simul use lammp includ pairwis coulomb interact electrostat interact achiev updat electrostat forc act object ad polar correct use ssage engin pass modifi snapshot back lammp engin time step json file need ssage engin includ einner rel dielectr permitt polariz object iontypestart case polariz object nonpolariz object system exampl colloid ion treat polariz nonpolariz respect paramet control nonpolariz typo start atom type radiu radiu type object guidelin similar run simul includ electrostat interact use lammp refer exampl lammp inputfil datafil need doubl check declar follow variabl particularli necessari imag method comput polar correct charg dielectr rel dielectr permitt surround continuum method output special output file gener imag method sinc provid updat electrostat forc includ polar correct nevertheless provid option dump trajectori print forcedist data lammp inputfil exampl user visual signific polar effect case conveni _im_tutori tutori todo write tutori develop jiyuan li refer j qin j li v lee h jaeger j j de pablo k freed theori interact polariz dielectr sphere j coll int sci _finitetemperaturestr finit temperatur string introduct along nudg elast band swarm trajectori finit temperatur string method ft chainofst method chainofst method multipl copi system simul copi imag correspond differ state system along propos transit pathway ft imag associ node along smooth curv collect variabl space repres transit pathway goal ft evolv path smooth curv string approxim transit pathway find princip curv definit intersect perpendicular hyperplan pass expect valu hyperplan princip curv often refer expect rather sampl along hyperplan belong node along string use voronoi approxim introduc vandeneijnden venturoli citevandeneijndenb associ node along string correspond voronoi cell consist region state space point closer origin node node along string imag free explor within bound associ voronoi cell evolv string toward expect string evolv toward run averag cv space imag along string evolut string broken follow step evolv individu imag dynam scheme use locat initi imag start point keep new updat time step fall within voronoi cell associ imag updat posit leav voronoi cell system return back state previou timestep keep track run averag locat visit cv space imag updat node string toward run averag keep path smooth specif equat found citevandeneijndenb enforc parametr eg interpol smooth curv new node locat redistribut node new locat along smooth curv equal arc length two adjac node imag move respect voronoi cell also chang check imag still fall within new voronoi cell associ imag imag longer correct voronoi cell system must return voronoi cell return step repeat converg ie chang string fall toler criteria stop iter certain number string method iter option paramet follow paramet need set method json input file codeblock javascript type string flavor ft follow option avail ft input center requir array contain imag coordin cv space kspring requir array spring constant correspond cv use ensur simul remain within respect voronoi cell block_iter requir number integr step perform updat string default time_step requir paramet use updat string mathdeltatau citevandeneijndenb default kappa requir paramet use smooth string mathkappa citevandeneijndenb default frequenc requir frequenc perform integr almost alway set max_iter requir maximum number string method iter perform toler requir array toler valu correspond cv simul stop toler criteria met cv iter valu initi string method iter default _fts_tutori tutori two exampl run ft found examplesuserft directori tutori go run ft singl particl system use lammp md engin necessari file found examplesuserftsd_particl contain follow inlammps_dparticl lammp input file set particl surfac two gaussian well differ depth math math one gaussian barrier origin template_inputjson templat json input contain inform one imag string look two cv x coordin use input_generatorpi use templat creat json input file contain inform string imag input_generatorpi python script creat ft json input file compil ssage lammp use input_generatorpi creat json input file ft run script codeblock bash python input_generatorpi creat file call ftsjson string imag init surfac evenli space straight line math math take look ftsjson see locat imag along string append center field center locat list one end string first center list correspond one end string final center list correspond opposit end string ftsjson gener run exampl follow command codeblock bash mpiexec np ssage ftsjson ssage run seri output file gener loglammp output lammp nodexxlog ft output node string first column contain imag number second column contain iter number remain column list locat imag instantan valu cv exampl two cv x coordin coordin remain column left right x coordin string node instantan x coordin particl coordin string node instantan coordin particl visual string plot appropri valu last line nodexxlog file exampl one quickli plot final string use gnuplot command codeblock gnuplot plot tail n node u follow imag show initi string blue compar final string plot green figur imagesdsinglepng align center two end string move two energi minima math math center string curv away energi barrier origin develop ashley guo benjamin sikora yamil j colón _advancedsamplingmethod advanc sampl method list advanc sampl method alphabet order toctre maxdepth adapt bias forc algorithm artifici neural network sampl basi function sampl combin forcefrequ sampl elast band finit temperatur string forwardflux metadynam swarm trajectori umbrella sampl follow orphan page imag method replica exchang ssage document master file creat sphinxquickstart mon jun adapt file complet like least contain root toctre direct welcom ssage simplest form particlebas simul limit gener ensembl configur mont carlo mc simul trajectori time molecular dynam md brownian dynam bd one extract mechan variabl potenti energi pressur perform ensembl time averag two import limit calcul complex materi time scale avail standard md simul often insuffici sampl relev region phase space order develop fundament understand materi research primarili interest calcul free energi entropi deriv respect variou thermodynam quantiti lead materi properti elast moduli heat capac variou suscept quantiti difficult obtain intract standard mc md simul overcom limit mc md simul must supplement advanc sampl techniqu method critic effici simul complex assembl process ssage softwar suit advanc gener ensembl simul design perform calcul framework design treat molecular simul routin black box use coordin system evolv md engin comput collect variabl permit meaning reduceddimension represent phase space within system inform use defin evolv reactiv pathway bia statist simul purpos comput free energi intern structur code design simpl extens new sampl method engin detail exampl capabl ssage perus document refspecif method advancedsamplingmethod content toctre maxdepth introduct get start input file engin collect variabl advanc sampl method write method cv contribut ssage ssage cookbook acknowledg zrefer copyright licens develop note refer name zreferencesrst appear end file list sphinxcontribbibtex must refer file compil last indic tabl refgenindex refmodindex refsearch _adaptivebiasingforc adapt bias forc algorithm introduct rel free energi method base ad bias hamiltonian system obtain flat histogram converg sampl adapt bias forc method abf uniqu seek flatten gener forc like flat histogram method bia forc appli landscap seen simul flat collect variabl cv space freeli diffus sampl achiev practic abf function partit relev cv space histogram like bin grid keep run tabul number visit bin concurr run sum instantan gener forc experienc system put togeth give estim mean gener forc integr quantiti yield free energi note mean abf return vector field rather free energi surfac output method ref citecom contain excel writeup method gener specif implement ssage discuss ref citedarv note integr surfac provid ssagestoolsabf_integr requir numpi scipi matplotlib syntax illustr tutori found page codeblock bash abf_integratorpi inputfil outputnam p bool bool bool interpol integ integ integ scale float implement note abf calcul gener forc cv timestep bias simul use neg estim gener forc requir grid requir defin cv rang outsid cv rang simul continu run grid extend bia appli histogram hit collect histogram hit collect abf restart previou run simpli includ fworld_cvx nworld output gener previou run work directori set restart option true warn abf keep singl backup old file overwrit older backup new data alreadi exist restart backup creat instead abf read updat newest file want keep copi output previou run restart sure renam output place copi differ directori use multipl walker option read write histogram forc estim runtim result histogram forc data save way singlewalk simul abf option defin restraint rang bias simul back toward region interest use harmon restraint userchosen spring constant disabl restraint enter spring constant k equal less zero warn restraint rang wider cv rang least one bin size direct restraint use period system one defin period boundari minimum imag convent cv appli use command cv_periodic_boundary_upper_bound cv_periodic_boundary_lower_bound exampl mathpi mathpi cv cv restrain system cross period boundari set ensur restraint appli correctli back toward rather appli incorrect larg forc push toward exampl input codeblock javascript method type abf cv cv_lower_bound cv_upper_bound cv_bin cv_restraint_minimum cv_restraint_maximum cv_restraint_spring_const cv_isperiod falsefals timestep minimum_count output_fil f_out output_frequ unit_convers frequenc warn sure follow correct json syntax input comma everi line except last within bracket option paramet defin abf method block defin abf method syntax codeblock javascript type abf defin cv defin collect variabl codeblock javascript cv exampl input defin twodimension cvspace sampl abf indic argument must list integ defin cv oper abf defin grid defin bound codeblock javascript cv_lower_bound cv_upper_bound thee array doubl whose length number cv use defin minimum maximum valu cv rang method use order defin number cv bin use codeblock javascript cv_bin array integ defin number histogram bin cv dimens order defin restraint codeblock javascript cv_restraint_minimum cv_restraint_maximum array defin minimum maximum valu cv restraint order codeblock javascript cv_restraint_spring_const array defin spring constant cv restraint order enter valu equal less zero turn restraint codeblock javascript cv_isperiod falsefals array defin whether given cv period restraint purpos use appli minimum imag convent cv restraint valu safe set fals even period cv restraint use warn cv set period cv_periodic_boundary_lower_bound cv_periodic_boundary_upper_bound must provid cv valu enter nonperiod cv use codeblock javascript cv_periodic_boundary_lower_bound cv_periodic_boundary_upper_bound array defin lower upper end period matter cv_isperiod true cv defin time unit paramet codeblock javascript timestep timestep simul unit depend convers factor follow must enter correctli otherwis gener forc estim incorrect codeblock javascript unit_convers defin unit convers dmomentumdtim forc simul lammp use unit real gramangstrommolefemtosecond kcalmoleangstrom gromac codeblock javascript minimum_count number hit requir bin gener histogram full bia activ valu bia linearli decreas equal hit default user provid reason valu system see citecom citedarv detail output paramet codeblock javascript output_frequ option defin mani timestep pass output gener forc codeblock javascript output_fil f_out string valu defin file name adapt vector forc field acquir default name f_out codeblock javascript fworld_output_fil fworld_cv option name file backup raw fworld forc output use restart separ output cv default filenam fworld_cv save cv output fworld_cvx codeblock javascript nworld_output_fil nworld option name file back raw histogram data restart purpos default filenam nworld option paramet codeblock javascript mass_weight fals turn onoff mass weigh adapt forc default fals turn weight warn leav system massless site tipp water codeblock javascript restart fals boolean determin whether simul restart default valu fals set true abf attempt load previou state nworld fworld file codeblock javascript frequenc leav output main output method store file specifi filenam file contain adapt forc vector field print everi backup_frequ step end simul method output vector field vector defin point grid goe cv_lower_bound cv_upper_bound cv dimens cv_bin grid point dimens exampl cv defin bin respect would x grid grid point printout follow format n number column n number cv first n column coordin cv space n n column compon adapt forc vector exampl n cv coord cv coord dadcv dadcv _abftutori tutori alanin dipeptid lammp must built rigid molecul packag build rigid molecul go lammp src folder buildhookslammpslammpsdownloadprefixsrclammpsdownloadsrc dlammpsy codeblock bash make yesrigid make yesmolecul go build folder make find follow input file examplesuserabfexample_alaninedipeptid inadp_abf_exampl file exampleinput adp_abf_walkerjson adp_abf_walkersjson put content abf_adp_lammps_exampl folder ssage build folder singl walker exampl codeblock bash ssage adp_abf_walkerjsonjson walker codeblock bash mpirun np ssage adp_abf_walkersjson gromac option adpgro topoltop nvtmdp requir example_adptpr file adp_abf_walkerjson adp_abf_walkersjson put content abf_adp_gromacs_exampl ssage build folder singl walker exampl codeblock bash ssage abf_adp_walkerjson walker codeblock bash mpirun np ssage abf_adp_walkersjson run use preprepar input file tpr format wish prepar input file use gromac tool compil dgromacsy codeblock bash buildhooksgromacsgromacsbingmx_ssag grompp f nvtmdp p topoltop c adpgro example_adptpr buildhooksgromacsgromacsbingmx_ssag grompp f nvtmdp p topoltop c adpgro example_adptpr sure chang seed mdp file random veloc gener walker explor differ place free energi surfac multipl walker initi differ seed explor differ region contribut adapt forc run finish check output match sampl output given exampl folder copi abf_integratorpi requir numpi scipi matplotlib build folder run integr codeblock bash python abf_integratorpi period true period true interpol output contour map gradient field heatmap compar sampl output sodium chlorid lammp must built kspace molecul packag build rigid molecul go lammp src folder buildhookslammpslammpsdownloadprefixsrclammpsdownloadsrc dlammpsy codeblock bash make yeskspac make yesmolecul go build folder make find follow input file examplesuserabfexample_naclabf_nacl_lammps_exampl innacl_adp_exampl file dataspc adp_nacl_walkerjson adp_nacl_walkersjson put content abf_nacl_lammps_exampl folder ssage build folder singl walker exampl codeblock bash ssage adp_nacl_walkerjsonjson walker codeblock bash mpirun np ssage adp_nacl_walkersjson gromac option naclgro topoltop nptmdp requir example_nacltpr file adp_nacl_walkerjson adp_nacl_walkersjson put content abf_nacl_gromacs_exampl ssage build folder singl walker exampl codeblock bash ssage abf_nacl_walkerjson walker codeblock bash mpirun np ssage abf_nacl_walkersjson run use preprepar input file tpr format wish prepar input file use gromac tool compil dgromacsy codeblock bash buildhooksgromacsgromacsbingmx_ssag grompp f nptmdp p topoltop c naclgro example_nacltpr buildhooksgromacsgromacsbingmx_ssag grompp f nptmdp p topoltop c naclgro example_nacltpr sure chang seed mdp file random veloc gener walker explor differ place free energi surfac multipl walker initi differ seed explor differ region contribut adapt forc run finish check output match sampl output given exampl folder copi abf_integratorpi requir numpi scipi matplotlib build folder run integr codeblock bash python abf_integratorpi output potenti mean forc graph compar sampl output develop emr sevgen hythem sidki contribut ssage ssage project built inclus welcom group physicist chemist chemic engin work complex molecular dynam md simul employ advanc sampl techniqu advanc sampl excit rapidli develop field similarli project design facilit usag implement wide array sampl method welcom heartili join us embark great adventur mani way contribut ssage necessarili need program skill part project even though sure help decid work code base happi find ssage design easi use easi extend put high prioriti maintain readabl clearli structur code base well inclus commun welcom new idea contribut short summari idea becom part ssage report triag fix bug softwar without error inconsist strang behavior even zero program knowledg help tremend report bug confirm issu bug refread report_bug improv ssage document strive ssage detail yet comprehens document includ concis introduct method quick learn tutori complet coverag intricaci method help pointer case run error document alreadi expans improv never go unappreci refread improve_document includ method cv ssage develop new sampl method collect variabl want make avail commun via ssage great refread add_your_method work core ssage system would like climb heart ssage get hand dirti task refread work_on_core_ssag _report_bug report bug request featur ssage opensourc project maintain small team scientif develop appreci help commun provid use ssage come across error might affect user core code base pleas report github issues_ page within repositori report bug help includ much detail possibl includ limit input file necessari replic bug output expect see versu got ssage relev error messag submit bug brows current issu make sure alreadi report feel featur miss ssage either submit featur request also via github issues_ add featur submit pull request github pull requests_ page submit featur request pleas includ refer relev literatur new methodscvsetc well gener use case motiv ad request featur _github issu httpsgithubcomssagesprojectssagesissu _github pull request httpsgithubcomssagesprojectssagespul _improve_document improv document great document great code produc great softwar ssage advic improv document alway highli appreci ssage document split two part user manual read right api document user manual use sphinx_ document contain inform necessari use program api doc built doxygen_ describ usag underli class function everyon will extend improv ssage _sphinx httpswwwsphinxdocorgenmast _doxygen httpswwwdoxygennlindexhtml idea help fix typo even though regularli check certainli still hidden somewher check link verifi intern extern link work bring date make sure document current ie reflect usag latest version add exampl exampl use method avoid common problem etc help hundr page dri descript write tutori aspect code miss tutori one might use consid ad short tutori simpl toy system build document work document first build document part ssage sourc code assum alreadi download built sourc code describ refget start gettingstart section find collect rst file compris user manual docsourc file end rst stand restructur text api document hand resid directli header file right next class function describ assum alreadi built ssage build document easi type code bash make doc within build directori order make document must follow program instal sphinx pypi via pip instal sphinx exampl doxygen dot ubuntu part graphviz packag sphinx read docs_ theme via pip instal sphinx_rtd_them _read doc httpsgithubcomreadthedocssphinx_rtd_them success built document find user manual docmanu api document docapidochtml rel build directori confus doc folder main directori project view favorit web browser use firefox exampl type firefox docmanualindexhtml user manual firefox docapidochtmlindexhtml api document write document pointer write help document dive detail sphinx doxygen user manual api document write document along way code first write document later use help error messag consid part document probabl part read frequent everyth structur text let face peopl skim document feel encourag use techniqu help spot relev inform exampl format text bold ital code etc use effect header write short paragraph use list code block tabl etc note note block extrem help exampl warn warn work great seealso find exampl help sphinx markup httpswwwsphinxdocorgenmasterusagerestructuredtextbasicshtml use exampl lot initi stage dont perfectionist miss document worst kind document better written code never written ssage advic document sphinx sphinx document system use restructuredtext loos base markdown format exampl document written sphinx includ lammps_ hoomdblue_ virtual python_ document follow tutori extrem help httpswwwsphinxdocorgenmasterusagerestructuredtextbasicshtml httpsdocutilssourceforgeiodocsuserrstquickrefhtml httpopenaleagforgeinriafrdocopenaleadoc_buildhtmlsourcesphinxrest_syntaxhtml _lammp httpslammpssandiagovdocmanualhtml _hoomdblu httpshoomdbluereadthedocsioenstableindexhtml _python httpsdocspythonorg one great thing sphinx document view page sourc link top page take look sphinx sourc code thu best way learn sphinx click link right look sourc code page short summari import command markup use ital bold code ital bold code header underlin header least three titl subtitl subsubtitl paragraph list bullet list indic line begin note highlight block creat note content block need indent also use warn seealso even found httpswwwsphinxdocorgenmasterusagerestructuredtextbasicshtml_ document doxygen doxygen follow differ philosophi compar sphinx steer toward api document exactli use ssage instead maintain document separ sourc code class function document place declar header file doxygen read sourc code automat build document exampl document creat doxygen includ plumed_ root_ _plume httpsplumedgithubiodocvuserdochtmlindexhtml _root httpsrootcernchdocmasterindexhtml mainpag doxygen document written separ header file case docmainpageh good introduct doxygen syntax found httpswwwdoxygennlmanualdocblockshtml basic rule doxygen comment start document class namespac function directli follow let start short exampl codeblock cpp function take squar valu param val input valu return squar input valu function calcul squar given valu doubl squaredoubl val return valval exampl document function squar simpli calcul squar number first line start brief descript longer one line second comment block start full descript two special command use param command document one paramet function return command document return valu function mani special doxygen command start backslash import apart two mention tparam use document templat paramet ingroup class part group method core group defin docmainpageh also help box highlight given aspect function attent put follow text rais box blank line end attent box note start highlight block blank line end note block remark start paragraph remark may enter see paragraph see also deprec document class function deprec kept backward compat todo leav note command also highlight text em ital word appli multipl word use em ital text em b bold word appli multipl word use b bold text b c code word typewrit font appli multipl word use tt typewrit tt code start code block block end endcod li line start li entri bullet list anoth benefit doxygen use latex syntax exampl f start end inlin math equat similar latex f f start end displaystyl latex equat cite label cite refer refer list docreferencesbib follow bibtex syntax doxygen clever produc automat link exampl exist class method ssage thu doxygen automat creat link document class word method appear howev work plural method instead write link method method endlink hand want prevent doxygen creat autolink put front word document strive comprehens document method avail ssage well core featur thu method document includ introduct method short tutori base one work exampl reader abl complet tutori min leav sens accomplish eg nice energi profil pictur fold protein detail descript use method paramet constraint requir etc _add_your_method ad method ssage seealso see refher writeyourownmethod introduct develop method develop new sampl method new collect variabl cv great ssage collabor integr new cv method prioriti make sure check follow box code need compil run obvious implement new method method publish peer review journal public cite document method see next point implement cv pleas give small exampl usag case new cv come handi method need come necessari document other abl use method explain work take look section refimprov document improve_document starter write good document pleas provid exampl system could fold alanin dipeptid molecul nacl system toy model simpl energi landscap long system small method easili complet within hour fine box check team friendli develop review sourc code help meet standard ssage code _work_on_core_ssag work core class todo describ ssage code hierarchi develop workflow _writeyourownmethod write cv method one basic design goal ssage easili extens end provid intuit simpl tool implement new collect variabl cv new advanc sampl method section cover basic step implement new cv new method let us first start implement new cv techniqu implement new method cover refbelow write_new_method _write_new_cv write new cv cv consist two compon header file schema file header file contain sourc code calcul cv schema file describ properti cv simpl json format final make ssage awar new cv incorpor core class cv header file cv ssage implement child class collectivevari header file place directori srccv reimplement follow function codevoid initializeconst snapshot option call presimul phase typic use alloc reserv memori codevoid evaluateconst snapshot evalu cv base simul snapshot function calcul valu gradient cv gradient vector length mathn mathn number atom snapshot element vector deriv cv respect correspond atom coordin method call postintegr phase everi iter codedoubl getvalu const return current valu cv calcul evaluateconst snapshot codedoubl getperiodicvalu const return current valu cv take period boundari condit account exampl would angular cv bound region mathpipi case getvalu could return angl getperiodicvalu return angl map back region mathpipi cv use period boundari function return valu getvalu codeconst stdvectorvector getgradi const return gradient cv see evaluateconst snapshot gradient defin codeconst stdarraydoubl getboundari const return twoelement array contain lower upper boundari cv codedoubl getdifferencedoubl locat const return distanc current valu cv specifi locat take period boundari condit account cv use period boundari condit return valu simpli getvalu locat cv schema file togeth header file contain sourc code cv provid schema file make cv access ssage input file schema file place directori schemacv written json format contain follow item type valu type set object varnam name new cv form examplecv properti properti contain type intern name cv set properti suppli constructor cv requir list contain requir properti option paramet cv constructor list additionalproperti boolean valu allow unlist json member includ input file integr new cv ssage provid header schema file two step order make ssage awar newli includ cv includ new cv edit file srccvscollectivevariablecpp includ cv header file top file add new els claus buildcv iftest check type cv select return respect buildjson path function new cv _write_new_method write new method method consist three compon header file h sourc file cpp schema file json header sourc file contain main code method schema file describ properti method simpl json format final make ssage awar new method incorpor core class method header file method ssage implement child class method header file place directori srcmethod declar follow function codevoid presimulationsnapshot snapshot const cvlist cv call method actual run typic use alloc reserv memori codevoid postintegrationsnapshot snapshot const cvlist cv call md integr step heart method go use snapshot cv function modifi forc posit veloc etc appropri new method codevoid postsimulationsnapshot snapshot const cvlist cv call end simul run use close file method open write data method store etc codevoid build call upon instanti ssage build method standard part includ read json input set variabl variabl function new method need use must declar defin simpl enough method sourc file sourc file place directori srcmethod reimplement function defin presimul postintegr postsimul build function declar header file need defin well string method variant edit logic framework srcmethodsstringmethodcpp build function instead new sourc file method schema file togeth sourc code method provid schema file make method access ssage input file schema file place directori schemamethod written json format contain follow item type valu type set object varnam name new method form examplemethod properti properti contain type intern name method set properti suppli constructor method requir list contain requir properti option paramet method constructor list additionalproperti boolean valu allow unlist json member includ input file new method use string method framework simpli need add new flavor method defin schemamethodsstringmethodjson integr new method ssage provid header sourc schema file two step order make ssage awar newli includ method includ new method edit file srcmethodsmethodcpp includ method header file top file add new els claus buildmethod iftest check type method select call respect buildjson world comm path function new method pointer newli creat object store variabl name method final add method cpp file cmakeliststxt sourc _elasticband elast band introduct mani method sever includ ssage calcul transit pathway metast state one kind pathway state minimum energi pathway mep quit simpli lowest energi pathway system take state mep condit forc everywher along pathway point along path perpendicular compon find mep one also find saddl point potenti energi surfac definit maxima mep nudg elast band neb method popular effici method calcul mep initi final state transit citehenkelmanhenkelman method involv evolut seri imag connect spring interact henc elast natur band forc act imag combin spring forc along band true forc act perpendicular band minim ensur converg mep nudg natur neb refer forc project ensur spring forc interfer elast band converg mep well true forc alter distribut imag along band ensur imag fall metast state project accomplish use parallel portion spring forc perpendicular portion true forc way spring forc act similarli reparameter scheme common string method full mathemat background avail citehenkelman citehenkelman brief overview given band discret seri n imag forc imag given math f_i f_iparallel nabla er_i_perp mathf_i total forc imag mathf_iparallel refer parallel compon spring forc mathitextth imag mathnabla er_i_perp perpendicular compon gradient energi evalu imag mathr_i second term right hand side true forc evalu math nabla er_i_perp nabla er_i nabla er_icdothattau_i term mathhattau_i repres normal local tangent mathitextth imag thu equat state simpli perpendicular compon gradient full gradient minu parallel portion gradient differ scheme avail literatur evalu tangent vector citehenkelman spring forc calcul math f_iparallel k left lvert r_i r_i rvert lvert r_i r_i rvert right hattau_i mathk spring constant differ imag band one evolv imag forc accord number scheme straightforward verlet integr scheme use ssage implement describ algorithm neb method implement ssage follow initi band defin two state interest defin howev one wish often simpli linear interpol space collect variabl fact end band need necessarili basin interest method allow end natur fall nearbi metast basin imag band molecular system atom coordin roughli correspond collect variabl imag construct period equilibr perform ensur underli system cv match respect band imag gradient sampl userdefin period time interv quantiti statist varianc need averag suffici sampl gradient done band updat one timestep forward simpl verlet scheme step iter upon lead converg method mep option paramet construct eb input file follow option avail complet eb json file inherit input string schema paramet common string method option uniqu eb equilibration_step number md step simpli perform umbrella sampl without invok neb method suffici long number step ensur underli molecular system cv close cv associ imag band evolution_step number step perform neb band updat evolut step time number sampl total md step new valu gradient harvest everi time number md step taken integ multipl evolut step kstring constant use calcul spring forc imag specifi uniqu imag pleas notic differ kspring string schema option type paramet identifi stringtyp method use thu set string flavor paramet identifi specif kind stringtyp method use eb set elasticband center paramet assign locat cv space individu imag along stringelast band array size equal total number imag entri consist array size equal number cv use elast band method toler toler threshold set trigger end method percentag node cv chang percentag method end must specifi array one entri cv desir max_iter complementari stop criterion specifi method stop undergo mani iter string method kspring uniqu spring constant must defin cv purpos describ frequenc frequenc integr step almost alway set _eb_tutori tutori tutori walk step step user exampl provid ssage sourc code run neb method alanin dipeptid use lammp first sure compil ssage lammp navig examplesuserelasticbandadp subdirectori take moment observ inadp_test datainput file order familiar system simul next two file interest template_inputjson input file input_generatorpi script file modifi text editor choic custom input tutori simpli observ leav template_inputjson contain inform necessari fulli specifi one driver input_generatorpi copi inform number time specifi within script tutori time also linearli interpol start end state defin script substitut correct valu center portion method definit execut script follow codeblock bash python input_generatorpi produc file call elasticbandjson also open file verifi script suppos json input ssage binari everyth need perform simul simpli run codeblock bash mpiexec np ssage elasticbandjson soon simul produc nodexlog file driver x number specifi driver case driver one report follow inform order node number iter number cv current valu band cv well current valu cv calcul molecular system allow system run specifi number iter tutori last line everi node file analyz view last posit imag elast band develop benjamin sikora _cv collect variabl collect variabl cv arbitrari differenti function mathn cartesian coordin atom simul usual repres structur thermodynam chemic meaning quantiti along advanc sampl perform list collect variabl current support ssage along brief descript inform syntax implement ssage addit specif properti cv name properti may defin cv use refer cv within method ssage codeblock javascript name mycvnam name specifi cv must uniqu possibl howev omit simpli refer cv numer index note tacitli assum work spheric atom join togeth form molecul angl descript cv calcul bend angl radian form three select atom mathijk math xi cosleftfracmathbfr_ij cdot mathbfr_kjvert mathbfr_ij vert vert mathbfr_kj vert right help probe conform molecul understand stabl metast state angl defin bond atom exampl codeblock javascript type angl atom_id warn angl must three individu particl rather centersofmass particl group option paramet requir codeblock javascript type properti type must set string angl codeblock javascript atom_id properti atom_id must contain three integ consist atom id form angl interest anncv descript cv take scale specifi scaling_factor cartesian coordin group atom specifi atomid input neural network number node connect weight activ function specifi num_nod coeff_fil activ respect comput one compon specifi out_index final neural network output cv valu coeffici neural network obtain feedforward neural network train cartesian coordin input exampl neural network includ encod autoencod mesa framework httpsgithubcomweihelloworldaccelerated_sampling_with_autoencoder_ statefre revers vampnet httpsgithubcomhsidkysrv_ follow exampl defin ann cv take cartesian coordin atom scale factor input neural network node number activ function tanh tanh weight defin file autoencoder_info_txt store weight neural network output two compon mark index cv exampl codeblock javascript cv type anncv atom_id scaling_factor num_nod activ tanh tanh index coeff_fil autoencoder_info_txt type anncv atom_id scaling_factor num_nod activ tanh tanh index coeff_fil autoencoder_info_txt option paramet requir codeblock javascript type anncv select collect variabl codeblock javascript atom_id properti atom_id must contain integ consist atom id input ann codeblock javascript scaling_factor properti scaling_factor scale factor input codeblock javascript num_nod properti num_nod defin number node layer neural network codeblock javascript activ properti activ defin activ function layer neural network codeblock javascript coeff_fil properti coeff_fil defin file store weight neural network codeblock javascript index properti index defin output index want use cv box volum descript current volum simul box import paramet determin thermodynam state constantpressur simul volum inform record may reweight accord standard method citeconrad cv calcul box volum determin parrinellorahman matrix mathmathbfh math xi detleft h_ij right exampl codeblock javascript type boxvolum warn nonorthorhomb box current support gromac lammp current support option paramet requir codeblock javascript type properti type must set string boxvolum gyrat tensor descript cv calcul quantiti deriv symmetr massweight gyrat tensor group mathn atom defin math mathbf fracsum_inm_isum_inm_i left mathbfr_i mathbfr_mathrmcomright otim left mathbfr_i mathbfr_mathrmcomright mathm_i mass mathmathbfr_i vector coordin mathimathrmth atom mathmathbfr_mathrmcom vector center mass mathn atom group mathotim outer tensor product eigenvalu radiu gyrat tensor particularli use collect variabl quantifi conform molecul long polym shape given assembl molecul eigenvalu mathlambda_xlambda_ylambda_z increas order defin frame princip axe inertia follow quantiti may comput radiu gyrat squar math r_g lambda_x lambda_i lambda_z princip moment math lambda_i xyz aspher math b lambda_z fracleftlambda_x lambda_i right acylindr math c lambda_i lambda_x shape anisotropi math kappa fracfraclambda_xlambda_ylambda_zleftlambda_xlambda_ylambda_zrightfrac exampl exampl comput shape anisotropi tenatom group codeblock javascript type gyrationtensor atom_id compon shapeaniso option paramet requir codeblock javascript type properti type must set string gyrationtensor codeblock javascript atom_id properti atom_id must array integ contain atom id enter calcul codeblock javascript compon properti compon must string defin gyrat tensor compon interest valid option rg princip princip princip aspher acylindr shapeaniso option codeblock javascript dimens properti dimens element array boolean specifi cartesian compon includ calcul left unspecifi three xyz compon use particl coordin descript cv calcul mathx mathi mathz posit center mass group atom math xi fracsum_imisum_inr_alphai alpha xyz exampl codeblock javascript type particlecoordin atom_id dimens x option paramet requir codeblock javascript type properti type must set string particlecoordin codeblock javascript atom_id properti atom_id must array integ contain atom id enter calcul codeblock javascript dimens properti dimens must string defin cartesian compon interest x z pairwis descript cv calcul varieti pairwis properti function kernel use contin analog otherwis discontinu cv paramet chosen judici kernel use place standard discontinu cv gaussian kernel emul count nearest neighbor switch function kernel emul coordin number math xi sum_i asum_i bf_ij mathf_ij pairwis function atom mathi mathj distanc center gaussian mathr_ijmu decreas zero distanc deviat away mathmu exampl exampl use gaussian pairwis kernel comput contribut contacttyp interact two atom size codeblock javascript type pairwis group group kernel type gaussian mu sigma option paramet requir codeblock javascript type properti type must set string pairwis codeblock javascript group properti group must array integ contain atom id first set codeblock javascript group properti group must array integ contain atom id second set note atom exist group group simultan contact automat skip mathi j codeblock javascript kernel properti kernel must object defin properti pairwis kernel function associ properti pairwis kernel gaussian function gaussian function defin math g_ij efracleftr_ij murightsigma type kernel use select conform differ posit eg neighbor next nearest neighbor particl cluster select particl separ approxim mathdelta distribut properti codeblock javascript mu properti mu requir must numer codeblock javascript sigma properti sigma requir must numer ration switch function ration switch function defin math s_ij fracleftfracr_ij d_r_rightnleftfracr_ij d_r_rightm quantiti use measur mani atom group occupi spheric shell around atom group form chosen variabl continu differenti tune mathn mathm made arbitrarili close heavisid switch function properti codeblock javascript type properti type must set string rationalswitch codeblock javascript properti requir must numer codeblock javascript r properti r requir must numer codeblock javascript n properti n requir must integ codeblock javascript properti requir must integ particl posit exampl codeblock javascript type particleposit atom_id dimens true fals true posit descript cv calcul distanc center mass group atom particular point cartesian space option paramet requir codeblock javascript type properti type must set string particleposit codeblock javascript atom_id properti atom_id must array integ contain atom id enter calcul codeblock javascript posit properti posit must element array number defin refer point simul box option codeblock javascript dimens properti dimens element array boolean specifi cartesian compon includ calcul left unspecifi three xyz compon use particl separ descript cv calcul distanc center mass two group atom variabl unsign distanc magnitud exampl codeblock javascript type particlesepar group group option paramet requir codeblock javascript type properti type must set string particlesepar codeblock javascript group properti group must array integ contain atom id make first group atom cv calcul distanc center mass group group defin properti group codeblock javascript group properti group must array integ contain atom id make second group atom cv calcul distanc center mass group group defin properti group option codeblock javascript dimens properti dimens element array boolean specifi cartesian compon includ calcul left unspecifi three xyz compon use polym rous mode descript cv calcul magnitud given rous mode set atom math x_p sqrtmathbfx_pcdotmathbfx_p math p th rous mode defin math mathbfx_p sqrtfracc_pnsum_in mathbfr_i co biglfracppinbiglifracbigr bigr math n number group bead compris polym math mathbfr_i centerofmass math th bead math c_p constant equal math p equal math pcdotsn cv help bia conform moderates longchain protein polym exampl codeblock javascript type rousemod mode group option paramet requir codeblock javascript type properti mode must set string rousemod codeblock javascript group properti group array array contain atom id integ compris discret polym bead number group provid implicitli defin math n number polym bead codeblock javascript mode properti mode integ indic index desir rous mode valid valu rang one less number group cdot n torsion angl descript cv calcul dihedr angl radian form four atom mathijkl comput citeblondel math xi tanleft fracleftr_lk time r_jk time r_ij time r_jk right cdot fracr_jkvert r_jkvertr_lk time r_jk cdot r_ij time r_jk right specif function atan use invers tangent calcul yield fourquadr angl warn torsion angl defin four atom rather four group atom exampl codeblock javascript type torsion atom_id option paramet requir codeblock javascript type properti type must set string torsion codeblock javascript atom_id properti atom_id must array integ contain atom id form dihedr alpha helix rmsd descript cv calcul alpha helix charact comparis ideal alpha helix structur compos amino acid comput perform summat possibl sequenc consecut amino acid segment interest math xi sum_i frac leftfracr_itext nmright fracr_itext nm mathr_i pairwis rmsd calcul backbon atom amino acid sequenc ideal refer structur backbon atom use amino acid pairwis rmsd calcul two set atom case glycin ha atom use place cb backbon atom note note cv basic summat switch function appli rmsd rather coordin futur version user abl choos custom paramet switch function note unlik simpler cv discuss one take atom label form refer pdb structur true proteinlik cv compar refer structur warn sinc definit cv use nanomet unit length must specifi unitconv paramet outlin order appli cv base unit length exampl codeblock javascript type alpharmsd residue_id refer reference_structurepdb unitconv option paramet requir codeblock javascript type properti type must set string alpharmsd codeblock javascript residue_id properti residue_id must array two integ design rang amino acid calcul cv indic amino acid must match refer structur provid properti refer smaller index must list first rang must span least amino acid codeblock javascript refer properti refer must string contain name refer pdb structur refer pdb structur use along residu rang defin residue_id check alpha helix charact residu system must number increas order even belong separ chain exampl system two chain amino acid first amino acid second chain number option codeblock javascript unitconv properti unitconv must numer factor use reconcil intern md unit engin unit use ideal alpha helix refer structur engin use unit nanomet ignor otherwis unitconv must set equival number length unit md engin equal nm exampl default unit length angstrom unitconv set anti beta rmsd descript cv calcul anti betasheet charact comparis ideal anti betasheet structur compos amino acid comput perform summat possibl sequenc amino acid consist two segment consecut amino acid region interest math xi sum_i frac leftfracr_itext nmright fracr_itext nm mathr_i pairwis rmsd calcul backbon atom amino acid sequenc ideal refer structur backbon atom use amino acid pairwis rmsd calcul two set atom case glycin ha atom use place cb backbon atom note note cv basic summat switch function appli rmsd rather coordin futur version user abl choos custom paramet switch function note unlik simpler cv discuss one take atom label form refer pdb structur true proteinlik cv compar refer structur warn sinc definit cv use nanomet unit length must specifi unitconv paramet outlin order appli cv base unit length exampl codeblock javascript type antibetarmsd residue_id refer reference_structurepdb unitconv mode option paramet requir codeblock javascript type properti type must set string antibetarmsd codeblock javascript residue_id properti residue_id must array two integ design rang amino acid calcul cv indic amino acid must match refer structur provid properti refer smaller index must list first rang must span least amino acid codeblock javascript refer properti refer must string contain name refer pdb structur refer pdb structur use along residu rang defin residue_id check anti betasheet charact residu system must number increas order even belong separ chain exampl system two chain amino acid first amino acid second chain number option codeblock javascript unitconv properti unitconv must numer factor use reconcil intern md unit engin unit use ideal anti betasheet refer structur engin use unit nanomet ignor otherwis unitconv must set equival number length unit md engin equal nm exampl default unit length angstrom unitconv set codeblock javascript mode properti mode integ specifi whether calcul betasheet form residu chain intra residu separ chain inter mode set mode use valu select intra mode valu select inter mode parallel beta rmsd descript cv calcul anti betasheet charact comparis ideal parallel betasheet structur compos amino acid comput perform summat possibl sequenc amino acid consist two segment consecut amino acid region interest math xi sum_i frac leftfracr_itext nmright fracr_itext nm mathr_i pairwis rmsd calcul backbon atom amino acid sequenc ideal refer structur backbon atom use amino acid pairwis rmsd calcul two set atom case glycin ha atom use place cb backbon atom note note cv basic summat switch function appli rmsd rather coordin futur version user abl choos custom paramet switch function note unlik simpler cv discuss one take atom label form refer pdb structur true proteinlik cv compar refer structur warn sinc definit cv use nanomet unit length must specifi unitconv paramet outlin order appli cv base unit length exampl codeblock javascript type parallelbetarmsd residue_id refer reference_structurepdb unitconv mode option paramet requir codeblock javascript type properti type must set string parallelbetarmsd codeblock javascript residue_id properti residue_id must array two integ design rang amino acid calcul cv indic amino acid must match refer structur provid properti refer smaller index must list first rang must span least amino acid codeblock javascript refer properti refer must string contain name refer pdb structur refer pdb structur use along residu rang defin residue_id check parallel betasheet charact residu system must number increas order even belong separ chain exampl system two chain amino acid first amino acid second chain number option codeblock javascript unitconv properti unitconv must numer factor use reconcil intern md unit engin unit use ideal parallel betasheet refer structur engin use unit nanomet ignor otherwis unitconv must set equival number length unit md engin equal nm exampl default unit length angstrom unitconv set codeblock javascript mode properti mode integ specifi whether calcul betasheet form residu chain intra residu separ chain inter mode set mode use valu select intra mode valu select inter mode _forwardflux forwardflux forward flux sampl ff advanc sampl method simul rare event nonequilibrium equilibrium system sever review articl literatur present comprehens perspect basic applic implement recent advanc ff provid brief gener introduct ff describ rosenbluthlik variant forward flux method also explain variou option variabl setup run effici ff simul use ssage introduct rare event ubiquit natur import exampl includ crystal nucleat earthquak format slow chemic reaction protein conform chang switch biochem network transloc pore activatedrar process stablemetast region stablemetast region b character long wait time event sever order magnitud longer transit process long wait time typic aris due presenc larg free energi barrier system overcom make transit one region anoth outcom rare event gener substanti therebi essenti obtain molecularlevel understand mechan kinet event thermal fluctuat commonli drive system initi state final state energi barrier mathdelta e transit frequenc state state b proport mathefracdelta ek_bt mathk_bt thermal energi system accordingli time requir equilibr system state reach state b grow exponenti constant temperatur energi barrier mathdelta e becom larger eventu none transit may occur within typic timescal molecular simul ff method sever intermedi state socal interfac mathlambda_i place along reaction coordin order paramet initi state final state b figur intermedi state chosen energi barrier adjac interfac readili surmount use typic simul use store configur interfac sever attempt made arriv next interfac forward direct order paramet must chang monoton go b increment progress make probabl observ full transit path state state b ff use posit flux express calcul rate constant system dynam integr forward time therefor detail balanc requir figur imagesforward_flux_imagepng align center alt forward flux sampl setup forward flux sampl method sever intermedi state place along order paramet link initi state final state b increment progress system record analyz obtain relev kinet thermodynam properti sever protocol forward flux sampl adopt literatur gener intermedi configur calcul condit probabl reach state b start state mathplambda_b lambda_n lambda_a lambda_ comput variou thermodynam properti optim overal effici method citeallen follow widelyus variant forward flux sampl method direct ff dff current implement ssage branch growth ff bgff rosenbluthlik ff rbff restrict branch growth ff rbgff ff leastsquar estim ffslse ff umbrella sampl ffu rate constant initi flux overal rate constant frequenc go state state b comput use follow equat math k_ab phi_a cdot pleftlambda_n vert lambda_right mathphi_a initi forward flux flux initi interfac mathpleftlambda_n vert lambda_right condit probabl trajectori initi reach b return practic mathphi_a obtain simul singl trajectori state certain amount time matht_a count number cross initi interfac mathlambda_ altern simul may carri around state period time mathn_ number accumul configur store math phi_a fracn_t_a mathn_ number instanc mathlambda_ cross forward direct matht_a simul time system run around state note mathlambda_ cross either forward mathlambda_t lambda_ backward mathlambda_t lambda_ direct forward cross mark checkpoint see figur matht_a includ simul time around state therebi portion time spent around state b must exclud gener condit probabl comput use follow express math pleftlambda_n vert lambda_right prodlimits_in pleftlambda_i vert lambda_iright pleftlambda_vertlambda_right cdot pleftlambda_vertlambda_right dot pleftlambda_nvertlambda_nright mathpleftlambda_ivertlambda_iright comput initi larg number trial current interfac record number success trial reach next interfac success trial system reach next interfac store use checkpoint next interfac fail trajectori go way back state termin differ flavor forward flux method use uniqu protocol select checkpoint initi trial given interfac comput final probabl creat transit path analyz addit statist figur imagesforward_flux_imagepng align center alt forward flux sampl initi flux schemat represent comput initi flux use singl trajectori initi state simul run certain period time matht_a number forward cross record altern specifi number necessari checkpoint mathn_ run simul desir number checkpoint collect figur green circl show checkpoint use gener transit path rosenbluthlik forward flux sampl rbff rosenbluthlik forward flux sampl rbff method adapt rosenbluth method polym sampl simul rare event citerosenbluth rbff compar branch growth forward flux bgff citeallenescobedo contrast bgff singl checkpoint randomli select noniniti interfac instead initi trial checkpoint given interfac figur rbff first checkpoint mathlambda_ select mathk_ trial initi success run reach mathlambda_ store next one checkpoint mathlambda_ randomli chosen contrast branch growth checkpoint involv mathk_ trial initi mathlambda_ last procedur continu follow interfac state b reach trial fail algorithm repeat remain checkpoint mathlambda_ gener multipl transit path figur imagesforward_flux_imagepng align center alt rosenbluthlik forward flux sampl rosenbluthlik forward flux sampl rbff involv sequenti gener unbranch transit path avail checkpoint first interfac mathlambda_ singl checkpoint interfac mathlambda_i randomli mark mathk_i trial initi checkpoint may reach next interfac mathlambda_i success trial may return state fail trial rosenbluthlik forward flux sampl choos one checkpoint interfac independ number success number avail checkpoint interfac necessarili ident differ transit path mathp impli success transit path artifici deplet less success path therefor need enhanc extradeplet path reweight postprocess weight path mathp interfac mathlambda_i given math w_ib prodlimits_ji fracs_jpk_j maths_jp number success interfac mathj path mathp condit probabl comput use follow express math pleftlambda_nvertlambda_right prodlimits_in pleftlambda_i vert lambda_iright frac prod_insum_p w_ip s_ip k_i sum_p w_ip summat run transit path simul option paramet notat use ssage implement ff mainli drawn ref citeallen recommend refer review articl user unfamiliar terminolog run dff simul use ssage input file json format requir along gener input file design choic molecular dynam engin md engin conveni two file template_inputjson ff_input_generatorpi provid assist gener json file describ paramet option set template_inputjson file order success gener input file run dff simul warn current implement ff accept one cv follow paramet need set method json input file codeblock javascript type forwardflux follow option avail forward flux sampl flavor requir specifi flavor ff method ssage run avail option directforwardflux note current dff implement ssage rbff bgff avail futur releas trial requir array number trial spawn interfac length array match length array interfac left blank defin ff_input_generatorpi interfac requir array intermedi interfac link initi state final state b array either defin template_inputjson ff_input_generatorpi latter case valu interfac left blank template_inputjson file ninterfac option total number interfac connect initi state final state b inclus default warn minimum two interfac must defin ntarget option number configur gener provid user first interfac default computeinitialflux option specifi whether calcul initi flux perform paramet set true ssage would also gener userspecifi number initi configur ntarget first interfac comput initi flux user must provid initi configur state otherwis ssage would issu error paramet set fals user must provid necessari number initi configur separ file file name file content follow specif format format filenam lnndat n configur number ie ntarget first line configur file includ three number l n l interfac number set zero n configur number attempt number set zero rest line includ atom id correspond valu posit veloc format atom id x z vx vy vz atom id id atom x z coordin atom vx vy vz compon veloc x z direct pleas note store configur interfac follow similar format default true savetrajectori option flag determin ff trajectori save default true warn save trajectori thousand atom may requir larg amount storag space currentinterfac option specifi interfac calcul start continu paramet help restart ff calcul interfac initi state default outputdirectorynam option specifi directori name contain output ff calcul includ initi flux success fail configur commitor probabl trajectori output data relat comput initi flux store file initial_flux_valuedat data relat transit probabl store file commitor_probabilitiesdat default ffsoutput _ffs_tutori tutori tutori walk stepbystep user exampl provid ssage sourc code run forward flux method langevin particl twodimension potenti energi surfac use lammp exampl show prepar multiwalk simul use walker first sure compil ssage lammp navig examplesuserforwardfluxlammpslangevin subdirectori take moment observ inlammps_ff_test_d file familiar system simul next two file interest template_inputjson input file ff_input_generatorpi script file provid help setup sophist simul file modifi text editor choic custom input file tutori simpli observ leav ff_templatejson contain inform necessari fulli specifi walker ff_input_generatorpi use inform file gener new json along necessari lammp input file issu follow command gener file codeblock bash python ff_input_generatorpi produc file call inputwalkersjson along inlammps_ff_test_d inlammps_ff_test_d also open file verifi script suppos json input ssage binari everyth need perform simul simpli run codeblock bash mpiexec np ssage inputwalkersjson run quick ff calcul gener necessari output develop joshua lequieu hadi ramezanidakhel benjamin sikora vikram thapar _artificialneuralnetworksampl artifici neural network sampl introduct artifici neural network ann sampl free energi sampl method use ann gener onthefli adapt bia capabl rapidli resolv free energi landscap recent method propos sidki whitmer citesidki demonstr robust user input requir minim number paramet quit simpl use describ like basi function sampl algorithm proce sweep statist collect user specifi interv flexibl choic end sweep ann fit statist determin optim bia appli subsequ sweep proce free energi landscap converg detail inform method implement found public citesidki option paramet ann sampl select defin type ann method json input file support follow option topolog array integ length number hidden layer array defin architectur neural network ann sampl quit robust choic network architectur nonetheless good heurist ensur network train quickli perform well key rule use network singl hidden layer bias one cv two hidden layer bias two pleas take look exampl section detail network architectur grid grid object defin cv space discret nsweep integ defin length sweep iter typic valu rang depend size system slower system dynam longer sweep go heavili affect converg time method gener quit robust choic sweep length main consequ choic ann train time becom rel expens system cheap evalu weight doubl default defin much rel weight assign statist collect sweep default valu work fine case howev know free energi barrier larg small adjust speed converg temperatur doubl temperatur simul must specifi output_fil string default annout specifi name output file contain bia reweight histogram overwrite_output boolean default true set fals append sweep number output file name seri file creat time use user interest plot evolut bia time lower_bound array doubl nr cv long array defin minimum valu cv restraint upper_bound array doubl nr cv long array defin maximum valu cv restraint lower_bound_restraint array doubl nr cv long array defin spring constant lower bound cv restraint wish restrain cv particular interv set zero upper_bound_restraint array doubl nr cv long array defin spring constant upper bound cv restraint wish restrain cv particular interv set zero max_it integ default defin maximum number train iterationsepoch per sweep run larg network larg number cv made quit small sinc network continu improv system proce unless larg network cheap system leav alon prev_weight doubl default special featur allow ann sampl forget previou histori specifi fraction exampl want retain accumul data sweep set use sampl along cv know bad clear quasinonergod system allow ann method forget accumul data allow adapt effici newli access region phase space note unless realli know need use leav alon exampl input onlin repositori contain complet exampl analysi system cv along origin public provid good idea specifi network architectur repositori found httpsgithubcomhsidkyann_sampling_ one cv nacl distanc input follow codeblock javascript method type ann topolog nsweep temperatur grid lower upper number_point period fals lower_bound upper_bound lower_bound_restraint upper_bound_restraint two simultan cv dihedr angl adp input follow codeblock javascript method type ann topolog nsweep overwrite_output fals temperatur grid lower upper number_point period true true lower_bound upper_bound lower_bound_restraint upper_bound_restraint exampl higher dimens pleas check repositori link output ann sampl write either singl output file seri output file time file contain column correspond cv column contain unbias histogram estim final column contain bia format follow cv cv histogram bia file load visual easili mani script languag python matlab exampl load data python cv shown codeblock python load data x nploadtxtanndat xg npreshapex yg npreshapex zg npreshapex zg zg npmaxzg plot data fig pltfigurefigs pltcontourxg yg zg linewidth colorsk pltcontourfxg yg zg file call netstatedat also written contain neural network paramet network evalu python use ann librari tensorflow httpswwwtensorfloworg_ kera httpskerasio_ codeblock python kerasmodel import sequenti keraslay import dens activ import defin kera network param xshift xscale yshift yscale net sequenti opennetstatedat r f topolog layer intfreadlin arch intx x freadlinesplit scale shift xscale floatx x freadlinesplit xshift floatx x freadlinesplit yscale floatx x freadlinesplit yshift floatx x freadlinesplit weight bias rang layer b j rangearchi bappendfloatfreadlin b nparrayb w j rangearchiarchi wappendfloatfreadlin w nparraywreshapearchi archi paramsappendw paramsappendb netadddensearchi activationtanh input_dimarchi elif ilay netadddensearchi activationlinear els netadddensearchi activationtanh netset_weightsparam network evalu highresolut grid plot codeblock python defin new highresolut grid x nplinspacenppi nppi endpointtru nplinspacenppi nppi endpointtru xg yg npmeshgridx scale data xs npvstackxgflatten ygflattent xs xs xshiftxscal evalu network unscal data ys netpredictx ys ysyscal yshift zg ysreshap plot data pltfigurefigs zg zg npmaxzg pltcontourxg yg zg linewidth colorsk pltcontourfxg yg zg cb pltcolorbar cbset_labelg kjmol pltxlabelphi pltylabelpsi exampl also found onlin repositori httpsgithubcomhsidkyann_sampling_ develop hythem sidki warn pleas make sure cite paper citesidki use method _basisfunctionsampl basi function sampl introduct basi function sampl method variant continu wanglandau sampl method develop whitmer et al citewhitm bias pmf summat kroneck delta method kroneck delta approxim project local bias histogram truncat set orthogon basi function math int_xi f_ivecxi f_jvecxi wvecxi dvecxi delta_ijc_i project basi set system resolv properti kroneck delta continu differenti manner lend well toward md simul current version ssage support chebyshev fourier legendr polynomi defin weight function mathwxi implement specif method addit combin implement basi set use system advis period basi set eg fourier use period cv requir bf method appli bia sweep mathn histogram mathh_i updat everi mathj microst timestep histogram modifi unbias partit function estim mathtildeh_i exponenti current bia potenti mathphi_i math tildeh_ixi h_ixi ebeta phi_i weight function ad implement mathwt_j user defin effect strength appli bia chosen weight normal length interv math z_ixi sum_j wt_jtildeh_jxi final estim project truncat basi set set evalu coeffici basi set evalu process iter surfac converg determin overal updat coeffici math beta phi_ixi sum_jn alphai_j l_jxi alphai_j fracj int_ logz_ixil_jxidxi option paramet option ssage provid run basi function sampl order add bf json file method label bfsmethod basi function sampl requir use basi set defin defin object basis_funct follow properti type current either chebyshev fourier legendr polynomial_ord order polynomi case chebyshev legendr result order input valu method take th order intern fourier seri order total number coeffici includ sine cosin seri upper_bound exist chebyshev fourier seri upper bound cv lower_bound exist chebyshev fourier seri lower bound cv cv_restraint_spring_const strength spring keep system bound nonperiod system cv_restraint_maximum upper bound cv nonperiod system cv_restraint_minimum lower bound cv nonperiod system cycle_frequ frequenc updat project bia frequenc frequenc integr step almost alway set weight weight visit histogram step kept around valu cycle_frequ usual time note system higher chanc explod higher weight valu basis_filenam suffix name output file specifi output basisout temperatur temperatur simul toler converg criteria sum differ subsequ updat coeffici squar must less converg work convergence_exit boolean option let user choos system exit converg met requir run bf order use method properli thing must put json file grid requir run basi function sampl refer grid section order understand option avail grid implement input requir run method cycle_frequ frequenc basis_funct temperatur exampl input codeblock javascript method type bfsmethod basis_funct type fourier polynomial_ord upper_bound lower_bound type fourier polynomial_ord upper_bound lower_bound cv cycle_frequ basis_filenam exampl frequenc temperatur weight toler e convergence_exit true grid lower upper number_point period true true guidelin run bf gener good idea choos lower order polynomi initi excess number polynomi may creat unwant ring effect httpsenwikipediaorgwikirunges_phenomenon_ could result much slower converg higher order polynomi error project less number bin must increas order accur project surfac may also creat unwant ring effect httpsenwikipediaorgwikirunges_phenomenon_ good rule thumb simul least one order magnitud bin polynomi order system use requir nonperiod boundari condit typic good idea place bound approxim unit outsid grid boundari convergence_exit option avail user choos continu run past converg good heurist toler around _bfstutori tutori tutori provid refer run bf ssage multipl exampl provid examplesuserbasicfunc directori ssage tutori cover alanin dipeptid exampl examplesuserbasicfuncadp subdirectori two lammp input file titl inadp_bfs_exampl two json input file file work ssage one titl adp_bfs_walkersjson make use multipl walker lammp run exampl must made rigid molecul packag order issu follow command build directori codeblock bash make yesrigid make yesmolecul make use follow command run exampl codeblock bash mpiexec np ssage adp_bfs_walkersjson prompt ssage begin simul run success consol output current sweep number node point user elect read output inform sweep basisout basisout file output least column column refer cv valu project pmf basi set log histogram depend number cv chosen simul number cv column also correspond first cv column label import line graph purpos project pmf basi set project take log bias histogram bias histogram print read restart run subject chang plot pmf simpl plot tool cv valu project pmf column result free energi surfac simul free energi surfac return crude estim within first sweep take longer period time retriev fulli converg surfac refer imag converg alanin dipeptid exampl provid directori lammp json input file restartout hold coeffici valu bia project updat well bias histogram file entir use restart run develop joshua moller julian helfferich _gettingstart get start prerequisit tri build ssage make sure follow packag instal packag requir version packag name ubuntu repositori openmpi_ higher openmpicommon libopenmpidev gcc_ higher gcc cmake_ higher cmake python_ python _openmpi httpswwwopenmpiorg _gcc httpsgccgnuorg _cmake httpscmakeorg _python httpswwwpythonorg get sourc code two way get sourc code ssage download zip file github clone git repositori strongli recommend second method allow easili stay uptod latest version clone git repositori call codeblock bash git clone httpsgithubcomssagesprojectssagesgit build ssage ssage support number simul engin alreadi download engin sourc file gener step build ssage engin follow exampl assum engin call engin use respect cmake flag dengine_src codeblock bash mkdir build cd build cmake dengine_srcpathtoengin make differ support engin respect _src flag specifi sourc code path enginespecif step option consult refengin engin page provid indepth direct ssage support cmake flag includ dcmake_build_typ specifi compil dcmake_c_compil dcmake_cxx_compil possibl ssage autodownload sourc code lammp gromac done provid option dlammpsy lammp dgromacsy gromac cmake howev mani case necessari build ssage use local copi md engin sourc code exampl modifi fit special need lammp gromac support nativ codeblock bash mkdir build cd build cmake dlammpsy make codeblock bash mkdir build cd build cmake dgromacsy make set command automat download lammpsgromac build togeth ssage support engin build local copi md engin sourc code describ refengin engin section use build system limit connect want add user modif engin sourc code compil run ssage order run ssage call execut follow input file exampl input file call inputjson simpl singlecor job call codeblock bash ssage inputjson job run multipl thread call codeblock bash mpiexec np ssage inputjson np flag dictat total number processor simul run inputjson input file inform consult refinput file inputfil section advanc option case simpl step meet need find enginespecif option advanc inform build run ssage refengin engin section introduct welcom ssage extens advanc sampl packag might wonderingwhat ssage research past sever decad molecular simul emerg power tool investig wide rang physic phenomena molecular simul essenc comput microscop wherebi comput use look properti system difficult observ measur tradit experiment setup comparison simul correspond experiment system sometim challeng usual due factor length time scale explor simul molecular model must suffici tempor spatial accuraci resolv fastest time scale shortest length scale within system unfortun due comput constraint detail resolut limit length time number particl model simul typic simul system smaller analog experiment setup laboratori environ much shorter time durat experi recent advanc process power includ custombuilt comput architectur gpubas comput continu increas time length scale access molecular simul current stateoftheart simul abl analyz system millisecond math citepiana howev challeng aris obtain good statist molecular simul thermal fluctuat domin motion nanoscal result motion appear random ie brownian two molecular trajectori ident result statist meaning averag necessari order calcul thermodynam kinet quantiti interest system citefrenkelandsmit incred power thermodynam quantiti refer rel free energi system calcul way rel free energi character underli system behavior presenc thermallyinduc random nois perform necessari averag within simul challeng essenc requir averag compound issu time scale describ previous must long simul perform must perform prohibit larg number time order extract suffici statist therefor necessari develop effici techniqu calcul meaning averag simul advanc sampl method repres class simul techniqu seek improv improp averag acceler extract use properti eg free energi transit path simul heart advanc sampl method statist mechan field physic relat microscop phenomena eg motion particl macroscop observ eg temperatur pressur take advantag statist mechan advanc sampl method use appli systemat bia simul speed converg mathemat remov bia extract true underli behavior throughout past decad advanc sampl method becom wildli success becom essenti compon toolbox molecular simul despit demonstr util advanc sampl techniqu adopt fraction scientist work field one explan slow adopt technic advanc sampl method complic research group expertis requir order implement method worst case lead long stage code develop possibl lead unknown implement error insuffici valid even case advanc sampl method implement typic done specif problem mind custombuilt certain model applic specif necessit modif custombuilt advanc sampl code studi new system prevent distribut code research field result method implement differ member commun sadli molecular simul quit common reinvent wheel ssage answer problem citessag ssage softwar suit advanc gener ensembl simul free opensourc softwar packag allow user easili appli advanc sampl techniqu molecular system interest simpli put ssage wrapper convert molecular simul engin eg lammp gromac advanc sampl engin ssage contain librari wide use advanc sampl method use calcul everyth free energi transit pathway importantli ssage work mani wide use simul packag simpli ad top simul research alreadi run ssage implement highli modular way easili extend incorpor new method modifi exist one rigor test ensur accuraci calcul short ssage make advanc sampl method easi hope research orphan _replicaexchang replica exchang introduct option paramet tutori develop