whalemap collat display whale survey result doihttpsjosstheojorgpapersjossstatussvghttpsdoiorgjoss overview goal softwar rapidli effect collect share whale survey inform within research govern industri public sector hope improv survey effici increas public awar inform impact transpar manag decis system live whalemaporghttpswhalemaporg interact map avail herehttpswhalemaporgwhalemap check whalemap public josshttpsdoiorgjoss gener descript system continu read detail inform pleas report problem suggest via site issu page project structur data whalemap data track via git raw raw data clone directli data contributor never manual edit interim data platform coeherc whalemap format process process data use display r r script data process display report src shell script execut data clone process makefil map project depend structur facilit effici process make licens licens inform globalr shini app serverr shini app uir shini app data process workflow sync major remoat data sync use script srcget_remote_datash use rclone sync data remot repositori googl drive dropbox etc also call srcget_live_dcssh download acoust detect data data store dataraw process data contributor process common whalemap format see use custom r script rproc_r format observ effort data platform save datainterim combin track data file datainterim combin rproc_tracksr save dataprocessedtracksrd observ data file datainterim combin rproc_observationsr save dataprocessedobservationsrd repeat makefil map depend structur orchestr effici process entir dataset make command execut final step srcget_remote_datash updat dataset synchron cron job run srcget_remote_datash everi minut keep system date whalemap data format observ time utc time yyyymmdd hhmmss lat latitud decim degre lon longitud decim degre date utc date yyyymmdd yday day year year year yyyi platform type survey platform vessel plane slocum buoy rpa opportunist name name platform eg noaa_twin_ott dfo_corioli id uniqu survey identifi compris survey start date platform name eg _plane_noaa_twin_ott speci speci name right fin sei humpback blue score detect type score definit acoust possibl acoust definit visual possibl visual number number whale na acoust detect calv number calv na acoust detect track time utc time yyyymmdd hhmmss lat latitud decim degre lon longitud decim degre date utc date yyyymmdd yday day year year year yyyi platform type survey platform vessel plane slocum buoy rpa opportunist name name platform eg noaa_twin_ott dfo_corioli id uniqu survey identifi compris survey start date platform name eg _plane_noaa_twin_ott speed platform speed ms altitud platform altitud statu tabl script name platform process script eg proc__noaa_twin_otterr name name platform display statu tabl eg noaa nefsc survey sightingstrack url link url display statu tabl email_list path csv file list email notifi error process platform data report error catch perform makefil use script srcreport_errorsh srcremove_errorsh run time platformspecif process script run result process record statu tabl statustxt process success timestamp ad statu tabl process unsuccess error messag print statu tabl autogener email sent design email list associ platform use srcsend_email_alertsh statu tabl display shini app ad new platform updat srcget_remote_datash sync raw data write r script convert whalemap format save observ track datainterim updat makefil updat statustxt test run make view result shini app push chang whalemap server via github setup r list packag whalemap reli data wrangl tidyvers lubrid tool oce map rgdal maptool leaflet leafletextra sf shini shini shinydashboard shinybusi misc htmltool htmlwidget plotli rcolorbrew here output sessioninfo sessioninfo r version platform x_pclinuxgnu bit run ubuntu lt matrix product default bla usrliblibblaslibblasso lapack usrliblapackliblapackso local lc_ctypeen_cautf lc_numericc lc_timeen_cautf lc_collateen_cautf lc_monetaryen_cautf lc_messagesen_cautf lc_paperen_cautf lc_namec lc_addressc lc_telephonec lc_measurementen_cautf lc_identificationc attach base packag tool stat graphic grdevic util dataset method base attach packag rgeos_ rcolorbrewer_ forcats_ stringr_ dplyr_ purrr_ readr_ tidyr_ tibble_ tidyverse_ sf_ shinybusy_ leafletextras_ plotly_ ggplot_ shinydashboard_ oce_ gsw_ testthat_ lubridate_ maptools_ htmlwidgets_ htmltools_ rgdal_ sp_ leaflet_ shiny_ linux tool here list tool whalemap reli current version make gnu make rclone rclone v git git version pandoc pandoc shinyvers shini server v syntax exampl chmod make shell script execut add follow first line file binbash run line make execut chmod ux scriptnamesh rsync file sync transfer transfer whalemap rsync rtv filetxt hansenwhalemapvmsrvshinyserverwhalemap crontab autom task open crontab crontab e enabl edit crontab mean append vim run everi hour sh homehansenshinyserverwhalemapget_live_dcssh run everi min usual test sh homehansenshinyserverwhalemapget_live_dcssh server side exampl srvshinyserverwhalemapget_remote_datash quit save crontab x shini server reload shini server sudo systemctl reload shinyserv restart shini server sudo systemctl restart shinyserv cron mail delet cat devnul varmailhansenjohnson local cat devnul varmailhansen server git delet local commit git reset hard appli patch commit git filenam merg branch dev master httpsgitscmcombookenvgitbranchingbasicbranchingandmerg git checkout master git merg dev titl whalemap tool collat display whale survey result near realtim tag r oceanographi marin mammal conserv author name hansen johnson orcid affili name daniel morrison affili name christoph taggart affili affili name oceanographi depart dalhousi univers oxford street halifax nova scotia canada bh r index date februari bibliographi paperbib statement need baleen whale northwest atlant live highli urban ocean recoveri commerci whale imped anthropogen risk ocean industri pollut climat chang effect research conserv riskreduct action requir near realtim knowledg whale distribut measur use variou method includ visual survey vessel plane acoust survey autonom platform rapid collat dissemin whale detect survey effort critic challeng given number varieti survey organ methodolog work along east coast us canada long term databas whale survey data maintain north atlant right whale consortium narwcorghttpsnarwcorg crowdsourc report tool eg whale alerthttpwwwwhalealertorg whalemap dedic system specif design collat display avail near realtim whale detect survey effort use case vari wide exampl whalemap current use govern manag design implement riskmitig strategi member militari industri plan safe oper research coordin survey effort explor pattern whale distribut member gener public learn follow along whale conserv activ whalemap design sever specif goal incorpor whale detect survey effort survey method near realtim allow survey team easili contribut retain complet control data provid latest data accur userfriendli publicli access format oper transpar use opensourc tool limit supervis critic whalemap perform qualitycontrol take respons verac inform contribut provid longterm databas survey result allow access raw process data without approv data origin system whalemap system workflow separ data process visual compon figur follow provid brief overview addit detail well specif refer softwar use avail sourc code document data process survey team provid whalemap access remot repositori choic eg googl drive dropbox upload survey data whalemap curat write custom script extract detect effort data survey team convert common whalemap format method eas burden survey team allow team submit data nearli format provid format consist welldocu essenti rapid data collect survey team field typic lack time resourc reformat data schedul job regularli clone data remot repositori onto whalemap server use makefil dynam effici process data platform coerc common format format error remot data repositori automat flag contributor notifi ensur chang raw survey data quickli propag entir system allow survey team retain complet control data perform qualiti control need also guarante whalemap alway contain latest avail inform visual survey data process visual use two differ method first construct selfcontain html summari map contain suffici inform satisfi casual viewer typic last day survey result conveni embed variou webpag eg whalemaporghttpswhalemaporg brows without requir serversid process map dynam regener final step data process workflow alway contain latest avail inform second visual method interact onlin applic whalemaporgwhalemaphttpswhalemaporgwhalemap provid user numer tool filter latest process data select data display sever format includ interact map interact timeseri plot tabl summari statist conclus sinc launch whalemap constantli refin optim better serv overal goal provid common sourc near realtim whale survey data northwest atlant demonstr improv conserv outcom endang whale region optim research activ facilit dynam riskmitig measur engag ocean industri public whalemap also alreadi cite sever scientif public gervais koubrak baumgartn johnson kowarski awar equival softwar exist hope whalemap continu serv conserv commun perpetu system readili adapt benefit region face similar conserv challeng conceptu overview whalemap data process displayfigure_png acknowledg grate acknowledg support pamela emeri stephani ratel angelia vanderlaan hilari moorsmurphi mani colleagu fisheri ocean canada well tim cole elizabeth josephson leah crow christin khan daniel cholewiak other noaa northeast fisheri scienc center work would possibl without also thank mark baumgartn kim davi member taggart lab advic help convers indebt fantast commun open sourc develop construct mani tool whalemap reli referenc detail system document final give sincer thank mani survey team numer agenc continu place trust system prais tireless effort protect vulner speci support fund gener provid fisheri ocean canada natur scienc engin research council canada refer output pdf_document always_allow_html ye param start r sysdat stop r sysdat r setup echofals librari suppresspackagestartupmessageslibraryknitr suppresspackagestartupmessageslibrarytidyvers suppresspackagestartupmessageslibraryleaflet suppresspackagestartupmessageslibraryrgd suppresspackagestartupmessageslibraryhtmltool suppresspackagestartupmessageslibraryhtmlwidget suppresspackagestartupmessageslibrarymaptool suppresspackagestartupmessageslibrarylubrid suppresspackagestartupmessageslibraryoc suppresspackagestartupmessageslibraryleafletextra design prefix path pre test paramsdataframestart asdat stop asdat pre sourcepasteprerfunctionsr read data ob readrdspastepr dataprocessedobservationsrd trk readrdspastepr dataprocessedtracksrd loadpastepr dataprocessedtssrda loadpastepr dataprocessedgisrda defin speci list spp_list cright fin sei humpback blue renam time limit paramsstart paramsstop subset observ ob ob filterd date speci spp_list score cdefinit visualdefinit acoust name jasco_test isnalat isnalon ob subset_canadianob subset track trk trk filterd date name jasco_test isnalat isnalon trk subset_canadiantrk creat data tofrom messag ift data_rang paramsstop els data_rang pasteparamsstart paramsstop test printob begincent huge textbfwhalemap summari report huge textbfr data_rang bigskip larg textbfreport gener r systim textbfproduc dalhousi meoparwhal project dfo scienc maritim region endcent hrulefil figur locat larg whale observ r map echofals warningfals figheight figwidth figaligncent setup defin score color palett pal colorfactorlevel spp_list palett cred blue lightgray green darkslategrey defin function determin tracklin color getcolor functiontrk iftrkplatform slocum blue els iftrkplatform plane b els iftrkplatform vessel black els darkgrey combin latlon help determin plot limit inlat cobslat trklat inlon cobslon trklon basemap start basemap map leafletopt leafletoptionszoomcontrol fals attributioncontrol fals add ocean basemap addprovidertilesprovidersesrioceanbasemap add legend addlegendposit topleft titl speci opac pal pal valu spp_list add extra map featur addscalebarposit topright use noaa graticul addwmstil httpsgisngdcnoaagovarcgisservicesgraticulemapserverwmsserv layer cdegre grid degre grid option wmstileoptionsformat imagepng transpar true attribut null center focal region iflengthinlon map fitboundsmap map lng mininlon narm lng maxinlon narm lat mininlat narm lat maxinlat narm option listmaxzoom plot polygon add mpa map map addpolygonsdatacritical_habitat_zon fill fillopac stroke smoothfactor dasharray c option pathoptionsclick f weight color darkgreen fillcolor darkgreen plot ship lane map map addpolylinestss_lineslon tss_lineslat weight color grey smoothfactor option pathoptionsclick f addpolygonstss_polygonslon tss_polygonslat weight color grey fillcolor grey smoothfactor option pathoptionsclick f add track set track plot trkdf splittrk trkid add line namestrkdf purrrwalk functiondf map map addpolylinesdatatrkdfdfopac lnglon latlat weight smoothfactor color getcolortrkdfdf add definit detectionssight map map addcirclemarkersdata ob lon lat radiu fillopac stroke col black weight fillcolor palobsspeci show map iflengthinlon map r map_text echofals resultsasi show map text iflengthinlon catfor interact map go httpswhalemaporgwhalemap n catclearpag n els catno effort observ record period tabl number larg whale observ r spp_tabl echofals resultsasi count number speci sight vi obsobsscoredefinit visual vi obsisnaobsnumb ifnrowvi vi aggregatenumb speci data vi fun sum els vi dataframespeci levelsobsspeci number rep lengthlevelsobsspeci count acoust detect aco asdataframetableobsspeciesobsscoredefinit acoust merg sight acoust spp_tabl mergevi aco byx speci byy var alli true renam column colnamesspp_t cspeci visual_count acoustic_detect replac zero spp_tablevisual_countsisnaspp_tablevisual_count sort tabl alphabet spp_tablespp_tableorderascharacterspp_tablespeci decreas fals display tabl kablespp_t rownam fals align c visual count includ sight number whale record may includ duplic tabl platform record survey effort r effort echofals resultsasi display tabl messag ifnrowtrk catno platform record effort period els platform_t aggregateplatform name data trk fun uniqu kableplatform_t rownam fals align c tabl north atlant right whale sight r narw_sig echofals resultsasi select speci sig obsobsspeci right obsscor definit visual format tabl sig sigcdatetim lat lon number calv platform name sort time sig sigordersigtim format timestamp sigtim formatsigtim hm display tabl messag ifnrowsig catno right whale sight els kablesig rownam fals align c tabl north atlant right whale acoust detect r narw_det echofals resultsasi select speci det obsobsspeci right obsscor definit acoust format tabl det detcdatetim lat lon platform name sort time det detorderdettim format timestamp dettim formatdettim hm display tabl messag ifnrowdet catno right whale acoust detect els kabledet rownam fals align c