neuca neuralnetwork base cell annot tool img alignleft srcvignettesneuca_hexpng width height develop neuralnetwork base cell annot neuca rbioconductor tool cell type annot use singlecel rnaseq data supervis cell label assign method use exist scrnaseq data known label train neural networkbas classifi predict cell label singlecel rnaseq data interest neuca current avail bioconductor httpsbioconductororgpackagesneuca introduct fast advanc singl cell rna sequenc scrnaseq technolog enabl transcriptom studi heterogen tissu singl cell level initi import step analyz scrnaseq data accur annot cell label present neuralnetwork base cell annot method neuca close correl cell type exist neuca use cell type tree inform hierarch structur neural network improv annot accuraci featur select perform hierarch structur improv classif accuraci cell type correl high feedforward neural network adopt workflowvignettesworkflowpng neuca depend follow packag rbioconductor kera neuralnetwork interfac r limma linear model framework test marker singlecellexperi data organ format e probabl predict function prepar neuca input file singlecellexperi class scrnaseq data input neuca must object bioconductor singlecellexperi may need read correspond vignett creat singlecellexperi data exampl provid show pleas note comprehens guidanc singlecellexperi step load exampl scrnaseq data libraryneuca baron_scrna train scrnaseq dataset seg_scrna test scrnaseq dataset databaron_scrna dataseg_scrna step prepar train data singlecellexperi object baron_anno dataframebaron_true_cell_label rownam colnamesbaron_count baron_sc singlecellexperi assay listnormcount asmatrixbaron_count coldata baron_anno use gene name featur symbol rowdatabaron_scefeature_symbol rownamesbaron_sc remov featur duplic name baron_sc baron_sceduplicatedrownamesbaron_sc step b similarli prepar test data singlecellexperi object note true cell type label necessari cours often avail seg_anno dataframeseg_true_cell_label rownam colnamesseg_count seg_sc singlecellexperi assay listnormcount asmatrixseg_count coldata seg_anno use gene name featur symbol rowdataseg_scefeature_symbol rownamesseg_sc remov featur duplic name seg_sc seg_sceduplicatedrownamesseg_sc neuca train predict step train test data object singlecellexperi class train classifi neuca predict test dataset cell type process achiev one line code predictedlabel neucatrain baron_sc test seg_sc models big verbos fals neuca detect whether highlycorrel cell type exist train dataset automat determin gener neuralnetwork model adopt markerguid hierarch neuralnetwork adopt classif user option determin complex neuralnetwork use neuca specifi desir models argument big medium small potenti choic reflect larg medium small number node layer neuralnetwork respect predict cell type predictedlabel vector length number cell test dataset contain cell predict cell type view directli headpredictedlabel alpha gamma gamma gamma gamma alpha tablepredictedlabel predictedlabel alpha beta delta ductal endotheli gamma option true cell type label test dataset may evalu predict perform confus matrix tablepredictedlabel seg_true_cell_label seg_true_cell_label predictedlabel alpha beta delta ductal endotheli gamma alpha beta delta ductal endotheli gamma may also draw sankey diagram visual predict accuraci workflowvignettessankeypng session info r version platform x_appledarwin bit run maco big sur matrix product default bla libraryframeworksrframeworkversionsresourcesliblibrblasdylib lapack libraryframeworksrframeworkversionsresourcesliblibrlapackdylib local en_usutfen_usutfen_usutfcen_usutfen_usutf attach base packag parallel stat stat graphic grdevic util dataset method base attach packag networkd_ neuca_ singlecellexperiment_ summarizedexperiment_ biobase_ genomicranges_ genomeinfodb_ iranges_ svectors_ biocgenerics_ matrixgenerics_ matrixstats_ e_ limma_ keras_ biocstyle_ load via namespac attach rcpp_ xvector_ compiler_ biocmanager_ zlibbioc_ bitops_ baseenc_ class_ tools_ zeallot_ digest_ jsonlite_ evaluate_ lattice_ pkgconfig_ rlang_ igraph_ matrix_ delayedarray_ yaml_ xfun_ genomeinfodbdata_ stringr_ knitr_ htmlwidgets_ generics_ grid_ reticulate_ r_ rmarkdown_ bookdown_ magrittr_ whisker_ tfruns_ htmltools_ tensorflow_ stringi_ proxy_ rcurl_ titl neuca packag user guid author name ziyi li affili depart biostatist univers texa md anderson cancer center name hao feng affili depart popul quantit health scienc case western reserv univers email hxfcaseedu packag neuca output biocstylehtml_docu abstract neuralnetwork base cell annot neuca tool cell type annot use singlecel rnaseq data supervis cell label assign method use exist scrnaseq data known label train neural networkbas classifi predict cell label singlecel rnaseq data interest vignett vignetteindexentryneuca packag user guid vignetteengineknitrrmarkdown vignetteencodingutf introduct fast advanc singl cell rna sequenc scrnaseq technolog enabl transcriptom studi heterogen tissu singl cell level initi import step analyz scrnaseq data accur annot cell label present neuralnetwork base cell annot method neuca close correl cell type exist neuca use cell type tree inform hierarch structur neural network improv annot accuraci featur select perform hierarch structur improv classif accuraci cell type correl high feedforward neural network adopt neuca depend follow packag r cranpkgkera neuralnetwork interfac _r_ r biocpkglimma linear model framework test marker r biocpkgsinglecellexperi data organ format r cranpkg probabl predict function prepar neuca input file singlecellexperi class scrnaseq data input neuca must object _bioconductor_ r biocpkgsinglecellexperi may need read correspond vignett creat singlecellexperi data exampl provid show pleas note comprehens guidanc r biocpkgsinglecellexperi step load exampl scrnaseq data use two exampl dataset baron_scrna seg_scrna baron_scrna dropletindropbas singlecel rnaseq data gener pancreas baron et alhttpsdoiorgjcel around human mous pancreat cell four cadaver donor two strain mice sequenc seg_scrna smartseq base singlecel rnaseq dataset segerstolp et alhttpsdoiorgjcmet thousand human islet cell healthi type diabet donor total cell collect around cell donor subset two dataset cell type label cell includ exampl r eval true messag fals libraryneuca databaron_scrna dataseg_scrna step prepar train data singlecellexperi object r eval true messag fals baron_anno dataframebaron_true_cell_label rownam colnamesbaron_count baron_sc singlecellexperi assay listnormcount asmatrixbaron_count coldata baron_anno use gene name featur symbol rowdatabaron_scefeature_symbol rownamesbaron_sc remov featur duplic name baron_sc baron_sceduplicatedrownamesbaron_sc step b similarli prepar test data singlecellexperi object note true cell type label necessari cours often avail r eval true messag fals seg_anno dataframeseg_true_cell_label rownam colnamesseg_count seg_sc singlecellexperi assay listnormcount asmatrixseg_count coldata seg_anno use gene name featur symbol rowdataseg_scefeature_symbol rownamesseg_sc remov featur duplic name seg_sc seg_sceduplicatedrownamesseg_sc neuca train predict step train test data object singlecellexperi class train classifi neuca predict test dataset cell type process achiev one line code r eval true messag fals predictedlabel neucatrain baron_sc test seg_sc models big verbos fals baron_scrna use train scrnaseq dataset seg_scrna use test scrnaseq dataset neuca detect whether highlycorrel cell type exist train dataset automat determin gener neuralnetwork model adopt markerguid hierarch neuralnetwork adopt classif tune paramet neuralnetwork number layer node tunabl paramet user option determin complex neuralnetwork use neuca specifi desir models argument big medium small possibl choic reflect larg medium small number node layer neuralnetwork respect model size detail shown follow tabl experi big medium often produc high accuraci predict r eval true messag fals echofals libraryknitr librarykableextra df dataframecat csmall medium big layer c node c kabledf colnam c number layer number node hidden layer escap fals caption tune model size neuralnetwork classifi train kable_stylinglatex_opt stripe predict cell type predictedlabel vector length number cell test dataset contain cell predict cell type view directli r eval true headpredictedlabel tablepredictedlabel option true cell type label test dataset may evalu predict perform confus matrix r eval true tablepredictedlabel seg_true_cell_label may also draw sankey diagram visual predict accuraci r eval true messag fals echof librarynetworkd sourc repna chooselengthuniqueseg_true_cell_labellengthuniqueseg_true_cell_label target repna chooselengthuniqueseg_true_cell_labellengthuniqueseg_true_cell_label valu repna chooselengthuniqueseg_true_cell_labellengthuniqueseg_true_cell_label link dataframesourc target valu cfm tablepredictedlabel seg_true_cell_label id fori ncolcfm forj inrowcfm linksid pastecolnamescfmi _true linksid pasterownamescfmj _pred linksid cfmji id id node datafram namecpastecolnamescfm _true pasterownamescfm _pred linksidsourc matchlinkssourc nodesnam linksidtarget matchlinkstarget nodesnam p sankeynetworklink link node node sourc idsourc target idtarget valu valu nodeid name sinksrightfals p session info unnumb r sessioninfo echofals sessioninfo nameneuca aliasneuca titl neuralnetwork base cell annot neuca tool cell type annot use singlecel rnaseq data descript neuca supervis cell label assign method use exist scrnaseq data known label train neural networkbas classifi predict cell label data interest usag neucatrain test models big verbos fals argument itemtrain train scrnaseq dataset cell label alreadi known must object singlecellexperi class must contain cell label first column coldata itemtest test scrnaseq dataset cell label unknown must object singlecellexperi class itemmodels ordin variabl indic complex neuralnetwork must one follow big medium small itemverbos boolean variabl truefals indic whether addit inform train test process print detail close correl cell type exist neuca use cell type tree inform hierarch structur neural network improv annot accuraci featur select perform hierarch structur improv classif accuraci cell type correl high feedforward neural network adopt valu neuca return vector predict cell type output vector length number cell test dataset author hao feng hxfcaseedu note input singlecel rnaseq data train test object singlecellexperi class true cell type label train dataset store first column singlecellexperi coldata object exampl load exampl scrnaseq data baron_scrna train scrnaseq dataset seg_scrna test scrnaseq dataset databaron_scrna dataseg_scrna creat singlecellexperi object input neuca data alreadi singlecellexperi format baron_anno dataframebaron_true_cell_label rownam colnamesbaron_count baron_sc singlecellexperi assay listnormcount asmatrixbaron_count coldata baron_anno use gene name featur symbol rowdatabaron_scefeature_symbol rownamesbaron_sc remov featur duplic name baron_sc baron_sceduplicatedrownamesbaron_sc similarli seg data seg_anno dataframeseg_true_cell_label rownam colnamesseg_count seg_sc singlecellexperi assay listnormcount asmatrixseg_count coldata seg_anno use gene name featur symbol rowdataseg_scefeature_symbol rownamesseg_sc remov featur duplic name seg_sc seg_sceduplicatedrownamesseg_sc neuca train cell type predict predictedlabel neucatrain baron_sc test seg_sc models big verbos fals headpredictedlabel seg_sc ground true cell type store compar predict vs truth sumpredictedlabelcoldataseg_scelengthpredictedlabel namebaron_count aliasbaron_count aliasbaron_true_cell_label doctypedata titl singlecel rnaseq exampl dataset baron data descript baron_count matrix scrnaseq data row repres one gene column repres one cell baron_true_cell_label vector length column matrix contain true cell label cell order usagedatabaron_scrna format baron_count matrix gene express valu baron_true_cell_label vector true cell label cell exampl databaron_scrna dimbaron_count baron_count lengthbaron_true_cell_label headbaron_true_cell_label keyworddataset nameseg_count aliasseg_count aliasseg_true_cell_label doctypedata titl singlecel rnaseq exampl dataset seg data descript seg_count matrix scrnaseq data row repres one gene column repres one cell seg_true_cell_label vector length column matrix contain true cell label cell order usagedataseg_scrna format seg_count matrix gene express valu seg_true_cell_label vector true cell label cell exampl dataseg_scrna dimseg_count seg_count lengthseg_true_cell_label headseg_true_cell_label keyworddataset