stospa build statushttpstravisciorgbartoszbartmanskistospasvgbranchmasterhttpstravisciorgbartoszbartmanskistospa document statushttpsreadthedocsorgprojectsstospabadgeversionlatesthttpsstospareadthedocsioenlatestbadgelatest doihttpsjosstheojorgpapersjossstatussvghttpsdoiorgjoss c softwar packag stochast simul spatial extend system codebas complet refactor sinc previou version stospahttpsgithubcombartoszbartmanskistospa python bind also includ primari audienc stospa research wish model chemic biolog system use cme rdme framework document avail herehttpsstospareadthedocsioenlatest requir necessari c compil gcc clang cmake make ninja necessari pystospa c compil gcc clang cmake make ninja python pybind scikitbuild option matplotlib python exampl numpi python exampl boost boost branch stospa use doxygen build c document sphinx build python document instal two way use stospa python c instal pystospa use python interfac stospa need follow instal instruct found python section likewis compil c code need follow instruct c section python note scikitbuildhttpsgithubcomscikitbuildscikitbuild need instal instal pystospa done use follow command pip instal scikitbuild furthermor need compil c code assum depend met pip andor scikitbuild compil c part softwar us easi way pip instal pystospa hard way clone follow repositori git clone httpsgithubcombartoszbartmanskistospagit recurs follow cd stospa python setuppi instal way instal pystospa assum follow packag instal met scikitbuild setuptool wheel cmake c instal step follow clone repositori git clone httpsgithubcombartoszbartmanskistospagit recurs note recurs flag end command need compil pythonbind stospa go stospa root directori make build directori cd stospa mkdir build cd build compil cmake make command run one exampl execut contain current work directori project_dirbuild execut follow command examplescme_exampl gener cme_exampledat file current work directori exampl exampl avail exampl directori note run python exampl matplotlibhttpsmatplotliborg numpyhttpsnumpyorg packag need instal use follow command pip instal matplotlib numpi consid one exampl found exampl directori let us consid follow chemic reaction xrightarrowk emptyset happen rate k simul chemic system follow code within exampl directori c includ simulatorhpp int main creat voxel object argument vector number molecul size voxel stdvectorunsign initial_num number molecul speci doubl domain_s size domain cm stospavoxel vinitial_num domain_s creat reaction object argument reaction rate propens func stoichiometri vector doubl k auto propens const stdvectorunsign num_mol const doubl area return num_mol stdvectorint stoch stospareact rk propens add reaction voxel vadd_reactionr pass voxel reaction simul object stospasimul sv run simul argument path output file time step number step sruncme_exampledat first segment code defin domain system use singl voxel object specifiy input argument voxel object initialis voxel object follow c stdvectorunsign initial_num number molecul speci doubl domain_s size domain cm stospavoxel vinitial_num domain_s next creat reaction object specifi reaction rate k propens function stoichiometri vector decay reaction use creat reaction object segment c doubl k auto propens const stdvectorunsign num_mol const doubl area return num_mol stdvectorint stoch stospareact rk propens creat reaction object pass previous creat voxel object c vadd_reactionr final creat simul object whose run function use run simul c stospasimul sv sruncme_exampledat plot output simul use follow python code python import numpi np import matplotlibpyplot plt open file contain data data nploadtxtcme_exampledat time data time point num_a data number molecul plot data label axe fig ax pltsubplot axsteptim num_a labela axset_xlabeltim axset_ylabelnumb molecul axlegend figsavefigcme_examplesvg cme_exampledocssrccme_examplesvg data simul save space separ valu format first valu time follow number molecul voxel henc singl line data file look like v v v v vn vn repres particular time point vij repres number molecul speci j voxel exampl output code would return follow three voxel singl speci molecul output look like feedback report bug pleas submit bug issu httpsgithubcombartoszbartmanskistospaissu would greatli appreci oper system use andor environ use specifi report bug contribut anyon wish contribut project pleas submit pull request develop branch repositori softwar merg develop master branch new featur develop branch test guid submit pull request found httpshelpgithubcomengithubcollaboratingwithissuesandpullrequestscreatingapullrequest titl stospa c softwar packag stochast simul spatial extend system tag c stochast simul chemic master equat reactiondiffus master equat author name bartosz j bartmanski orcid affili multipl affili must quot name ruth e baker affili affili name mathemat institut univers oxford woodstock road oxford ox gg uk index date march bibliographi paperbib summari mathemat model complex biolog phenomena allow us understand contribut differ process observ behaviour mani phenomena involv reaction diffus molecul use socal reactiondiffus model describ mathemat reactiondiffus model often subdivid three type helland macroscop mesoscop microscop model describ system term concentr term macroscop model end spectrum microscop model describ system specifi posit often veloc molecul middl ground two scale cover mesoscop model stochast individuallevel detail includ without directli track posit everi singl molecul macroscal model ignor crucial detail stochast effect microscal model tend comput intens osbornevanliedekerk mesoscal model offer good balanc includ stochast effect without incur enorm comput overhead framework chemic master equat cme spatial extens reactiondiffus master equat rdme isaacsonisaacsonvankampen provid mesoscop model reaction diffus howev major case model built cmerdm framework analyt intract model behaviour must explor use stochast simul algorithm stospa c softwar packag stochast simul model construct use cme rdme framework softwar packag allow effici simul user friendli interfac includ function simul static grow domain timevari reaction rate primari audienc stospa research wish model chemic biolog system use cme rdme framework softwar stospa allow wide rang stochast simul within cme rdme framework within rdme framework simul independ mesh type henc simul run structur unstructur mesh exampl structur unstructur mesh seen autoreffigmesh furthermor stospa allow simul uniformli grow domain use extrand method volioti exampl mesh use within stospa rdme simul lefthand side exampl unstructur mesh righthand side exampl structur mesh labelfigmeshesfigsmeshespng core packag written c program languag make simul effici possibl number packag need use stospa intent kept small possibl make sure softwar use comput environ compil c code make softwar userfriendli applic program interfac api design simplic mind detail api found stospa document websit httpsstospareadthedocsio furthermor includ python bind allow simul run within python program languag pybind httpsgithubcompybindpybind use creat pystospa python bind stospa python interfac softwar packag save user recompil code everi simul make stospa easier use continu integr platform travisci httpstravisciorg use make sure chang codebas break function stospa instal function test linux osx oper system statu field cme rdme framework use model variou phenomena field chemistri epidemiolog system biolog goal behind make stospa facilit easi fast simul system model use cme rdme altern softwar packag use exampl urdm drawerturdm mesord fangemesord howev depend barrier instal use urdm proprietari softwar depend mesord larg number depend make challeng instal stochss drawertstochast anoth softwar packag provid docker contain web interfac howev docker contain requir special privileg run everi user may web interfac allow high throughput execut simul henc develop stospa reli upon depend possibl design easili instal furthermor softwar simul dynam uniformli grow domain use extrand method volioti altern instal code stospa host github httpsgithubcombartoszbartmanskistospa instal instruct contain readmemd file first way instal stospa involv download sourc code github repositori compil c code accord instruct readmemd file howev easier altern use python packag manag pip download python bind stospa pystospa httpspypiorgprojectpystospa instal appropri detail instal well inform contain document websit httpsstospareadthedocsioenlatest exampl follow exampl refer voxel subinterv domain system model mesh refer voxel organis space relat chemic master equat exampl first exampl let us consid follow chemic reaction xrightarrowk emptyset occur rate k domain omega cm cm simul chemic system follow code c includ simulatorhpp int main creat voxel object number molecul speci stdvectorunsign initial_num size domain cm doubl domain_s argument vector number molecul size voxel stospavoxel vinitial_num domain_s creat reaction object doubl k auto propens const stdvectorunsign num_mol const doubl area return num_mol stdvectorint stoch argument reaction rate propens func stoichiometri vector stospareact rk propens stoch add reaction voxel vadd_reactionr pass voxel reaction simul object stospasimul sv run simul argument path output file time step number step sruncme_exampledat first line code exampl make sure use stospa class main function first defin voxel object repres domain system c stdvectorunsign initial_num doubl domain_s stospavoxel vinitial_num domain_s place molecul speci domain size cm case singl voxel size cm next segment code creat lambda function repres propens function reaction object rate k propens function propens stoichiometri vector decreas number molecul one time decay reaction happen c doubl k auto propens const stdvectorunsign num_mol const doubl area return num_mol stdvectorint stoch stospareact rk propens though reaction propens function case would k number molecul wherea lambda function return number molecul interfac chosen repeat lambda function definit similar reaction appear exampl reaction happen multipl voxel lambda function reaction propens take two argument vector doubl vector repres number molecul doubl repres area voxel pass reaction object voxel c vadd_reactionr final run simul save output exampledat file everi step c stospasimul simv simruncme_exampledat see exampl output simul autoreffigcme_exampl python bind stospa call pystospa allow us run simul use python program languag python code case follow python import pystospa ss creat voxel object argument vector number molecul size voxel initial_num number molecul speci domain_s size domain cm v ssvoxelinitial_num domain_s creat reaction object argument reaction rate propens func stoichiometri vector k propens lambda num_mol area num_mol stoch r ssreactionk propens stoch add reaction voxel vadd_reactionr pass voxel reaction simul object sssimulatorv run simul argument path output file time step number step sruncme_exampledat similar interfac c code benefit need compil pystospa instal exampl simul output system model use cme framework singl speci molecul decay rate k labelfigcme_examplefigscme_examplepng reactiondiffus master equat exampl demonstr stospa use run simul within rdme framework exampl onedimension domain cm cm discretis voxel equal size cm use within rdme framework diffus model jump process describ seri reaction shown a_ stackreldrightleftharpoon a_ stackreldrightleftharpoon a_ stackreldrightleftharpoon stackreldrightleftharpoon a_ a_i number molecul voxel propens function diffus reaction follow form a_i molecul jump voxel either neighbour one c code system follow c includ simulatorhpp use namespac stospa int main creat vector voxel object argument vector number molecul size voxel stdvectorunsign initial_num doubl voxel_s first creat nine empti voxel stdvectorvoxel vs stdvectorvoxel voxel voxel_s add nonempti voxel begin vsinsertvsbegin voxelinitial_num voxel_s doubl diffus rate auto propens const stdvectorunsign num_mol const doubl area return num_mol stdvectorint stoch creat add reaction object unsign ivssiz add diffus jump right voxel voxel vsiadd_reactionreactiond propens stoch add diffus jump left voxel voxel vsiadd_reactionreactiond propens stoch pass voxel reaction simul object simul sv run simul argument path output file time step number step srunrdme_exampledat includ exampl directori stospa code somewhat similar chemic master equat exampl except voxel object also includ extra line use namespac stospa save us write stospa front everi stospa class start initialis voxel object make domain system first set variabl defin number molecul leftmost voxel size everi voxel initialis vector nine voxel object contain molecul slot addit voxel object begin vector molecul c stdvectorunsign initial_num doubl voxel_s first creat nine empti voxel stdvectorvoxel vs stdvectorvoxel voxel voxel_s add nonempti voxel begin vsinsertvsbegin voxelinitial_num voxel_s add reaction voxel assum voxel order posit xaxi ad diffus reaction one addit paramet reaction class constructor name diffusion_idx index neighbour voxel molecul jump diffus reaction happen c doubl diffus rate auto propens const stdvectorunsign num_mol const doubl area return num_mol stdvectorint stoch creat add reaction object unsign ivssiz add diffus jump right voxel voxel vsiadd_reactionreactiond propens stoch add diffus jump left voxel voxel vsiadd_reactionreactiond propens stoch final previou exampl run simul simul class instanc pass vector voxel object call simul class run function c simul sv srunrdme_exampledat take path file save data follow size timestep number step take finish simul state simul initi final time point shown autoreffigrdme_exampl molecul diffus expect exampl simul output system model use rdme framework molecul singl speci jump voxel rate cm compos whole domain system labelfigrdme_examplefigsrdme_examplepng grow domain stospa allow stochast simul uniformli grow domain exampl previou section extend simul grow domain defin domain system use omegat lt lt l_ ert cm voxel growth determinist accord h l_ ert n n number voxel doesnt chang cours simul previou exampl discretis domain omega equallys voxel l_ cm r henc code simul follow c includ simulatorhpp use namespac stospa int main defin lambda function repres domain growth function auto growth const doubl return exp creat vector voxel object argument vector number molecul size voxel stdvectorunsign initial_num doubl voxel_s first creat nine empti voxel stdvectorvoxel vs stdvectorvoxel voxel voxel_s growth add nonempti voxel begin vsinsertvsbegin voxelinitial_num voxel_s growth doubl diffus rate auto propens const stdvectorunsign num_mol const doubl area return num_mol stdvectorint stoch creat add reaction object unsign ivssiz add diffus jump right voxel voxel vsiadd_reactionreactiond propens stoch add diffus jump left voxel voxel vsiadd_reactionreactiond propens stoch pass voxel reaction simul object simul sv run simul argument path output file time step number step srunrdme_exampledat differ case case previou section main differ addit growth function lambda function c auto growth const doubl return exp initialis voxel object growth lambda function third argument comparison simul output static domain grow one seen autoreffiggrow molecul diffus space twice size initi domain end simul comparison simul grow domain static one labelfiggrowingfigsgrowingpng acknowledg bjb support engin physic scienc research council grant number epgx reb royal societi wolfson research merit award holder would like thank leverhulm trust research fellowship refer fill refer paperbib pystospa build statushttpstravisciorgbartoszbartmanskistospasvgbranchmasterhttpstravisciorgbartoszbartmanskistospa document statushttpsreadthedocsorgprojectsstospabadgeversionlatesthttpsstospareadthedocsioenlatestbadgelatest python bind c softwar packag stochast simul spatial extend system stospahttpsgithubcombartoszbartmanskistospa codebas complet refactor sinc previou version stospahttpsgithubcombartoszbartmanskistospa python bind also includ instal easi way pip instal pystospa hard way clone follow repositori git clone httpsgithubcombartoszbartmanskistospagit recurs follow cd stospa python setuppi instal way instal pystospa assum follow packag instal met scikitbuild setuptool wheel cmake exampl let consid follow chemic reaction rightarrow emptyset happen rate k python code simul follow import pystospa ss v ssvoxel r ssreaction lambda x x vadd_reactionr sssimulatorv srunexampledat import pystospa creat voxel reaction object v ssvoxel r ssreaction lambda x x add reaction object voxel object vadd_reactionr final pass voxel object contain list simul object sssimulatorv srunexampledat invok run function simul class run stochast simul save state everi second step feedback report bug pleas submit bug issu httpsgithubcombartoszbartmanskistospaissu would greatli appreci oper system use andor environ use specifi report bug contribut anyon wish contribut project pleas submit pull request develop branch repositori softwar merg develop master branch new featur develop branch test guid submit pull request found httpshelpgithubcomengithubcollaboratingwithissuesandpullrequestscreatingapullrequest stospa document master file creat sphinxquickstart thu jan adapt file complet like least contain root toctre direct stospa stochast simul spatial extend system c softwar packag stochast simul spatial extend system codebas complet refactor sinc previou version stospahttpsgithubcombartoszbartmanskistospa python bind also includ primari audienc stospa research wish model chemic biolog system use cme rdme framework toctre maxdepth caption content instal usag api feedback index refgenindex instal two way use stospa python c instal pystospa need follow instal instruct found python section likewis compil c code need follow instruct c section prerequisit necessari c compil gcc clang cmake make ninja necessari pystospa c compil gcc clang cmake make ninja python pybind scikitbuild option matplotlib run python exampl numpi run python exampl boost boost branch stospa use doxygen build c document sphinx build python document python instal note scikitbuild httpsgithubcomscikitbuildscikitbuild_ need instal instal pystospa done use follow command codeblock bash pip instal scikitbuild furthermor need compil c code assum depend met pip andor scikitbuild compil c part softwar us easi way codeblock bash pip instal pystospa hard way clone follow repositori codeblock bash git clone httpsgithubcombartoszbartmanskistospagit recurs follow codeblock bash cd stospa python setuppi instal way instal pystospa assum follow packag instal met scikitbuild setuptool wheel cmake c instal instal step follow clone repositori codeblock bash git clone httpsgithubcombartoszbartmanskistospagit recurs note recurs flag end command need compil pythonbind stospa go stospa root directori make build directori codeblock bash cd stospa mkdir build cd build compil codeblock bash cmake make command run exampl execut contain current work directori project_dirbuild execut follow command codeblock bash examplescme_exampl gener cme_exampledat file current work directori basic instal option instal use boost librari cover branch section anoth way instal execut setup_stospash script step long execut bash script branch three branch github repositori httpsgithubcombartoszbartmanskistospagit master c boost differ time store simul class implement gillespi algorithm httpspubsacsorgdoiabsja use next subvolum method involv keep time voxel master branch keep depend minimum need deal boost librari use standard c librari map store time voxel c branch updat time voxel use function avail c standard onward lastli boost branch use fibonacci heap boost librari voxel time differ perform notic case larg number voxel boost branch faster master branch boost branch pythonbind avail pypi instal use follow command first instal master branch pythonbind use follow codeblock bash pip instal pystospa instal boost pythonbind use codeblock bash pip instal pystospaboost hope choic reduc problem instal due depend issu doubt use master branch document compil document c api doxygen need compil python api get start guid doxygen sphinx need doxygen detect cmake gener c api document compil docsdoxgen call cmake build directori codeblock bash make docsdoxygen comprehens guid stospa recommend document use sphinx compil codeblock bash make docssphinx either document found build directorydoc test make sure packag instal correctli run unit test c code compil execut follow command build directori project_dirbuild codeblock bash make unittest testsunittest python bind stospa pystospa instal run unit test use follow command within test directori project_dirtest codeblock bash python test_pystospapi api python api automodul pystospa member c api autodoxygenindex project auto