dendro dendroplan dendro stand dna base evolutionari tree predict scrnaseq technolog r packag take scrnaseq data tumor relat somat tissu accur reconstruct phylogeni assign singl cell singl cell rna sequenc scrnaseq data subclon figur current phylogenet reconstruct framework specif design scrnaseq dataset due biolog dropout ie burst sequenc error technic dropout dendro perfectli tackl problem bayesian framework betabinomi achiev high cluster accuraci addit conduct singl cell rnaseq experi tumor sampl import project subclon detect power depend number cell sequenc coverag per cell facilit experi design develop tool dendroplan figur predict expect cluster accuraci dendro given sequenc paramet result research design experi paramet sequenc depth number cell base dendroplan predict manuscript dendro genet heterogen profil subclon detect singlecel rna sequencinghttpsgenomebiologybiomedcentralcomarticlessx question problem question problem use dendro dendroplan pleas feel free open new issu herehttpsgithubcomzhouziludendroissu also email maintain correspond packag contact inform shown develop maintain instal instal rrstudio instal packag latest version rhttpswwwrprojectorg r devtoolsinstall_githubzhouziludendro observ error biobas tri follow tri reinstal r requirenamespacebiocmanag quietli true installpackagesbiocmanag biocmanagerinstallbiobas version pipelin overview dendro packag includ two analysi tool dendro phylogenet tree construct real dataset tumor hematopoesi scrnaseq dendroplan help design experi predict accuraci dendro cluster given infer clonal tree structur cell number sequenc depth overal pipelin shown dendro pipelin p aligncent img srchttpsrawgithubusercontentcomzhouziludendromasterfigurepkg_figjpg width height p figur flowchart outlin procedur dendro dendro start scrnaseq raw data recommend star pass method map robust splice junction sna detect appli map bam file count total allel read count altern allel read cell c mutat posit g collect next step celltocel genet diverg matrix calcul use genet diverg evalu function dendro cluster cell pool cell cluster togeth reestim sna profil base reestim sna profil dendro gener parsimoni tree show evolut relationship subclon run dendro dendro r notebook stepbystep demonstr rich display avail herehttprawgithackcomzhouziludendromastervignettedendro_vignettehtml correspond rmd script avail herehttpsgithubcomzhouziludendroblobmastervignettedendro_vignettermd dendroplan pipelin p aligncent img srchttpsrawgithubusercontentcomzhouziludendromasterfigurepkg_figjpg width height p figur overal dendroplan pipelin analysi start design tree interest clade purpl clade exampl base tree model number cell sequenc depth sequenc error rate simul singl cell mutat profil scrna data sampl refer scrnaseq dataset given express level bulk phylogeni comput dendro compar underlin truth measur three statist adjust rand index global accuraci statist captur rate subclon specif statist puriti subclon specif statist run dendroplan dendroplan r notebook stepbystep demonstr rich display avail herehttprawgithackcomzhouziludendromastervignettedendroplan_vignettehtml correspond rmd script avail herehttpsgithubcomzhouziludendroblobmastervignettedendroplan_vignettermd citat zhou z xu b minn et al dendro genet heterogen profil subclon detect singlecel rna sequenc genom biol httpsdoiorgsx br genet heterogen profil singl cell rna sequenc githubhttpsgithubcomzhouziludendro develop maintain zilu zhouhttpsstatisticswhartonupenneduprofilezhouzilu zhouzilu pennmedicin dot upenn dot edu br genom comput biolog graduat group univers pennsylvania nanci r zhanghttpsstatisticswhartonupenneduprofilenzh br depart statist univers pennsylvania dendro mutat detect gatk dendro use follow approach origin paper gener initi mutat profil across gene cell write exampl scripthttpsgithubcomzhouziludendroblobmasterscriptmutation_detection_mapreducesh modifi one real data analysi want clarifi expert gatk tool howev given signific amount test failur follow pipelin work dendro see haplotypecal documenthttpssoftwarebroadinstituteorggatkdocumentationtooldocsorg_broadinstitute_gatk_tools_walkers_haplotypecaller_haplotypecallerphp inform question suggest problem question problem use dendro dendroplan pleas feel free open new issu herehttpsgithubcomzhouziludendroissu also email maintain correspond packag contact inform shown develop maintain pipelin overview initi sna detect inde one import step dendro pipelin state paper want maxim sensit detect moment lot fals posit call clean cluster pool step figur show detect pipelin user check exampl scripthttpsgithubcomzhouziludendroblobmasterscriptmutation_detection_mapreducesh togeth figur sidebysid p aligncent img srchttpsrawgithubusercontentcomzhouziludendromasterfigurepkg_figjpg width height p figur flowchart outlin procedur mutat detect fastq final gvcf use gatk erc gvcf approachhttpsgatkforumsbroadinstituteorggatkdiscussioncallingvariantsoncohortsofsamplesusingthehaplotypecalleringvcfmod number right correspond step shell script due great number cell tradit way call variant sampl sampl extrem slow luckili gatk erc gvcf mode util mapreduc like approach pleas check detail herehttpsgatkforumsbroadinstituteorggatkdiscussioncallingvariantsoncohortsofsamplesusingthehaplotypecalleringvcfmod script built upon erc gvcf mode togeht variant detect best approach rnaseq datahttpsgatkforumsbroadinstituteorggatkdiscussionthegatkbestpracticesforvariantcallingonrnaseqinfulldetail exampl script attach herehttpsgithubcomzhouziludendroblobmasterscriptmutation_detection_mapreducesh also provid r scripthttpsgithubcomzhouziludendroblobmasterscriptvcf_to_dendroinputr convert vcf file dendro input citat zhou z xu b minn et al dendro genet heterogen profil subclon detect singlecel rna sequenc genom biol httpsdoiorgsx develop maintain zilu zhouhttpsstatisticswhartonupenneduprofilezhouzilu zhouzilu pennmedicin dot upenn dot edu br genom comput biolog graduat group univers pennsylvania nanci r zhanghttpsstatisticswhartonupenneduprofilenzh br depart statist univers pennsylvania titl dendroplan vignett author zilu zhou date r sysdat abstract conduct singl cell rnaseq experi tumor sampl import project subclon detect power depend number cell sequenc coverag per cell facilit experi design develop tool dendroplan figur predict expect cluster accuraci dendro given sequenc paramet given tree structur target accuraci dendroplan comput necessari read depth number cell need base spikein procedur describ detail pleas check biorixv preprintwwwrstudiocom output rmarkdownhtml_docu theme unit highlight tango toc true vignett vignetteindexentryvignett titl vignetteengineknitrrmarkdown vignetteencodingutf bibliographi dendrobibtex r setup includ fals knitropts_chunkset collaps true comment instal instal packag latest version rhttpswwwrprojectorg r evalfals devtoolsinstall_githubzhouziludendro refer dataset deng et al deng prestor dendro packag question issu question problem use dendroplan pleas feel free open new issu herehttpsgithubcomzhouziludendroissu also email maintain packag contact inform zilu zhouhttpsstatisticswhartonupenneduprofilezhouzilu zhouzilu pennmedicin dot upenn dot edu br genom comput biolog graduat group upenn nanci r zhanghttpsstatisticswhartonupenneduprofilenzh nzh wharton dot upenn dot edu br depart statist upenn dendroplan pipelin overal pipelin figur illustr overal pipelin analysi start design tree interest clade purpl clade exampl base tree model number cell sequenc depth sequenc error rate simul singl cell mutat profil scrna data sampl refer scrnaseq dataset given express level bulk phylogeni comput dendro compar underlin truth measur three statist adjust rand index global accuraci statist captur rate subclon specif statist puriti subclon specif statist r outwidth px figalign center echofals knitrinclude_graphicshttpsrawgithubusercontentcomzhouziludendromasterfigurepkg_figjpg figur flowchart outlin procedur dendroplan load refer refer dataset deng et al deng great sequenc qualiti depth first let load dendroplan_ref check structur refer variabl ref r messagefals warningfals librarydendro datadendroplan_ref strref total potenti mutat loci across cell result simul tree maximum number cell maximum number mutat tree simul tree type paramet tree dendroplan abl simul show figur correspond k subtyp valu also includ r outwidth px figalign center echofals knitrinclude_graphicshttpsrawgithubusercontentcomzhouziludendromasterfigurepkg_figjpg figur exampl tree structur dendro simul correspond paramet number branch illustr index mutat probabl variabl lprob number node illustr index cell proport variabl kprob interest clade label star captur rate puriti measur specif star cluster k paramet indic number subclon k subclon form two type tree differeti subtyp paramet accuraci measur measur dendroplan result four statist explain adjust rand index adjust rand index measur similar two data cluster adjust chanc group element detail see herehttpsenwikipediaorgwikirand_index captur rate captur rate measur fals neg rate specif star clade cell specif clade mani detect algorithm puriti puriti measur fals posit rate specif star clade cell specif cluster detect mani actual true specif clade observ probabl one singl valu measur probabl observ clade multip simul round practic examp assum mutat site tree look like figur c mutat cell uniformli distribut r messagefals warningfals figwidth resdendrosimulationnrefrefksubtyp re result show exampl tree structur well statist confid interv ci exampl ii nd exampl want specifi similar tree custom cell proport mutat load want four cluster cell proport ie want one major subclon code need specifi paramet kprob also want mutat load unequ distribut branch cluster specif mutat lprobc r messagefals warningfals figwidth resdendrosimulationkprobclprobcnrefrefksubtyp re exampl tree show consist input exampl iii one import reason user use tool estim cluster accuraci given differ sequenc depth origin deng et al paper deng collect around bpread per cell mice result map read mutat site super high depth figur r outwidth px figalign center echofals knitrinclude_graphicshttpsrawgithubusercontentcomzhouziludendromasterfiguredeng_statjpg figur scrnaseq librari statist deng et al deng modifi origin paperhttpsciencesciencemagorgcontentscisuppldcdengsmpdf real life usual read per cell pretti good depth proport around map read per mutat site let chang read depth paramet rd see well dendro perform r resdendrosimulationrdnrefrefksubtyp re feel free play differ paramet detail function document found type dendrosimul r session info r sessioninfo sessioninfo refer titl dendro vignett author zilu zhou date r sysdat abstract dna base evolutionari tree predict scrnaseq technolog dendro statist framework take scrnaseq data tumor accur reconstruct phylogeni assign singl cell scrnaseq data subclon approach allow us cluster cell base genom profil account transcript burst technic dropout sequenc error benchmark silico mixtur spikein analysi make robust mutat profil infer subclon resolut perform dnarna joint analysi set cell examin relationship transcriptom variat mutat profil detail pleas check biorixv preprint link yetwwwrstudiocom output rmarkdownhtml_docu theme unit highlight tango toc true vignett vignetteindexentryvignett titl vignetteengineknitrrmarkdown vignetteencodingutf bibliographi dendrobibtex r setup includ fals knitropts_chunkset collaps true comment instal instal packag latest version rhttpswwwrprojectorg r evalfals devtoolsinstall_githubzhouziludendro question issu question problem use dendro pleas feel free open new issu herehttpsgithubcomzhouziludendroissu also email maintain packag contact inform zilu zhouhttpsstatisticswhartonupenneduprofilezhouzilu zhouzilu pennmedicin dot upenn dot edu br genom comput biolog graduat group upenn nanci r zhanghttpsstatisticswhartonupenneduprofilenzh nzh wharton dot upenn dot edu br depart statist upenn dendro analysi pipelin overal pipelin figur illustr overal pipelin dendro start scrnaseq raw data recommend star pass method map robust splice junction sna detect appli map bam file count total allel read count altern allel read cell c mutat posit g collect next step celltocel genet diverg matrix calcul use genet diverg evalu function dendro cluster cell poll cell cluster togeth reestim sna profil base reestim sna profil dendro gener parsimoni tree show evolut relationship subclon r outwidth px figalign center echofals knitrinclude_graphicshttpsrawgithubusercontentcomzhouziludendromasterfigurepkg_figjpg figur flowchart outlin procedur dendro separ analysi pipelin three stage subtask label right stage initi sna detect gatk start scrnaseq dataset first detect primari mutat gatk tool due larg amount cell mapreduc erc gvcf approach necessari detail illustr attach herehttpsgithubcomzhouziludendroblobmasterscriptvcf_to_dendroinputr gener vcf file dendro util inform number altern allel read count x number total allel read count n mutat profil matrix z z indic mutat cell loci x n z rm time c total number mutat loci c total number cell also provid exampl r script xnz matrix extract vcf load demo dataset mutat locu time cell gener use spikein r messagefals warningfals librarydendro datadendro_demo strdemo info indic mutat inform chromosom allel nucleitid posit label indic true label dont real data analysi cell mutat filter given x n z dendro first appli qualiti control qc default dendro filter mutat less cell detect rare cell detect common cell total read count deviat standard deviat check filtercellmut detail r messagefals warningfals demo_qc filtercellmutationdemoxdemondemozdemoinfodemolabelcutoffvaf cutoffsd two plot illustr two distribut left total number cell mutat right total number mutat cell red line indic filter threshold r messagefals warningfals strdemo_qc stage ii genet diverg matrix calcul dendro calcul genet diverg matrix check dendrodist detail r messagefals warningfals figwidth demo_qcdist dendrodistdemo_qcxdemo_qcndemo_qczshowprogressfals cluster genet diverg matrix let appli hierach cluster plot cluster result color known true label demo_qcclad allow user custom tree dendroclust inher argument plotphylo check dendroclust detail r messagefals warningfals figwidth demo_qcclust dendroclusterdemo_qcdistlabeldemo_qclabeltypefan let decid optim number cluster use intraclust diverg icd measur r messagefals warningfals demo_qcicd dendroicddemo_qcdistdemo_qcclust demo_qcoptk demo_qcdendro_label cutreedemo_qcclusterdemo_qcoptk decid optim number cluster identifi kink elbow point icd plot exampl optk crucial multipl elbow point smallest one robust let replot data dendro label r messagefals warningfals figwidth demo_qcclust dendroclusterdemo_qcdistlabeldemo_qcdendro_labeltypefan reestim mutat profil within cluster qc dendro reesim subclonelevel mutat profil pool read within read togeth maximum liklihood approach lilikelihood check dendrorecalcul detail r messagefals warningfals demo_clust dendrorecalculatedemo_qcxdemo_qcn demo_qcinfo demo_qcdendro_label clusternamecclusterclusterclust clusternam specifi cluster name given cluster order stage iii evolutionari tree construct given filter clusterlevel mutat profil construct neighborjoin tree use algorithm implement packag phangorn see dendrotre detail r messagefals warningfals dendrotreedemo_clusterz phylogenet tree cluster greater genet diverg compar cluster cluster consist data gener process analysi user could perform joint differenti express analysi differenti mutat analysi differ subclon group mutat profil across clone sore demo_clusterz differenti express analysi packag widespread two method person prefer seurat mast implementationhttpssatijalaborgseuratget_startedhtml seurat scddhttpsbioconductororgpackagesreleasebiochtmlscddhtml scdd gene set enrich analysi avail msigdb broad institutehttpsoftwarebroadinstituteorggseamsigdb gsea session info r sessioninfo sessioninfo refer namedendrosimul aliasdendrosimul titl simul dendro perform descript dendrosimul assess dendro perform given imaginari clonal tree cell number read depth etc see argument usag dendrosimulationkprob null lprob null filt n epi rd null ref k null subtyp rpt plot true mayb also usag object document argument itemkprob distribut cell subclon order probabl kprob see tutori default null indic uniform distribut cell itemlprob distribut mutat along branch tree order probabl lprob see tutori default null indic uniform distribut mutat itemfilt filt threashold indic mutat less filt mutat filter itemm indic number cell simul default itemn n indic number gene simul default itemepi sequenc error rare rna edit combin rate default accord illunima itemrd rd indic read depth overal sequenc default use data deng et al x read per cell itemref refer dataset x x matric indic two individu allel read count itemk kprob null decid total number subclon combin subtyp determin clonal tree structur default null itemsubtyp k two differ clonal tree structur determin one default itemrpt mani round simul want run gener estim confid interv default itemplot whether want plot simul exampl tree result valu summari statist matrix mean confid interv refer deng qiaolin et al singlecel rnaseq reveal dynam random monoallel gene express mammalian cell scienc author zilu zhou seealso object see also codelinkhelp exampl datadendroplan_ref resdendrosimulationrdnrefrefksubtyp add one standard keyword see file keyword r document directori keyword kwd use one rshowdockeyword keyword kwd __onli one__ keyword per line namedendrodist aliasdendrodist titl dendro specif genet diverg evalu function descript calcul celltocel diverg matrix given variant allel read count total allel read count estim mutat sequenc error rate method account transcript burst sequenc error betabinomi framework function linear number cell number mutat usag dendrodistx n z epi showprogress true mayb also usag object document argument itemx matrix contain variant allel read count across cell column loci row itemn matrix contain total allel read count across cell column loci row itemz mutat indic matrix mutat normal across cell column loci row itemepi sequenc error rare rna edit combin rate default accord illunima itemshowprogress whether show diverg calcul program larg divers cell popul function take time recommend track progress valu dist return object class dist see httpswwwrdocumentationorgpackagesstatsversionstopicsdist detail refer httpswwwrdocumentationorgpackagesstatsversionstopicsdist author zilu zhou exampl datadendro_demo demo_qc filtercellmutationdemoxdemondemozdemoinfodemolabel dist dendrodistdemo_qcxdemo_qcndemo_qczshowprogressfals add one standard keyword see file keyword r document directori keyword kwd use one rshowdockeyword keyword kwd __onli one__ keyword per line namefiltercellmut aliasfiltercellmut titl filter low express gene high dropout cell base read count descript function filter low express gene cutoffvaf high dropout cell cutoffsd base read count plot summari distribut usag filtercellmutationx n z info null label null cutoffvaf cutoffsd plot true argument itemx matrix contain variant allel read count across cell column loci row itemn matrix contain total allel read count across cell column loci row itemz mutat indic matrix mutat normal across cell column loci row iteminfo mutat loci inform matrix row number number loci column number option default null itemlabel integ vector decid label color type label assign due piror inform individu site default null color label itemcutoffvaf variant allel frequenc vaf sumzlengthz filter threshold variant variant allel frequenc less cutoffvaf rare greater cutoffvaf common filter default itemcutoffsd cell total express sumn filter threshold cell total express less meanncutoffsdsdn small greater meanncutoffsdsdn doubl triplet filter default itemplot true fals decid whether plot distribut cut red line default valu true valu list filter matrix itemxinput x filter itemninput n filter itemzinput z filter iteminfoinput info filter itemlabelinput label filter author zilu zhou exampl datadendro_demo demo_qc filtercellmutationdemoxdemondemozdemoinfodemolabel add one standard keyword see file keyword r document directori keyword kwd use one rshowdockeyword keyword kwd __onli one__ keyword per line namedendroclust aliasdendroclust titl dendro specif cluster method genet diverg matrix descript cluster cell base genet diverg matrix use hierach cluster method usag dendroclusterdist method wardd plot true label null argument itemdist dissimilar structur produc dist itemmethod submethod hclust default wardd statist integr itemplot true fals decid whether plot result default valu true itemlabel integ vector decid label color default null color label item arug inherit plotphylo ape exampl typefan circl cluster plot valu object class hclust describ tree produc cluster process check httpswwwrdocumentationorgpackagesstatsversionstopicshclust detail plottru hclust plot also display refer httpswwwrdocumentationorgpackagesstatsversionstopicshclust author zilu zhou exampl datadendro_demo demo_qc filtercellmutationdemoxdemondemozdemoinfodemolabel dist dendrodistdemo_qcxdemo_qcndemo_qczshowprogressfals clusterdendroclusterdistlabeldemo_qclabel add one standard keyword see file keyword r document directori keyword kwd use one rshowdockeyword keyword kwd __onli one__ keyword per line namedendrotre aliasdendrotre titl construct phylogenet tree descript method construct phylogenet tree neighbor join method implement phangorn suggest evolutionari relationship differ subclon usag dendrotreez_clust label_clust null argument itemz_clust mutat indic matrix mutat normal across subclon column loci row itemlabel_clust cluster label use color phylogenet tree node better track cell cluster option default null valu void phylogenet tree plot refer httpscranrprojectorgwebpackagesphangornindexhtml author zilu zhou exampl datadendro_demo demo_qc filtercellmutationdemoxdemondemozdemoinfodemolabel dist dendrodistdemo_qcxdemo_qcndemo_qczshowprogressfals clusterdendroclusterdistlabeldemo_qclabel icd dendroicddistclust dendro_label cutreeclust demo_clust dendrorecalculatedemo_qcxdemo_qcn demo_qcinfo demo_qcdendro_label clusternamecclusterclusterclust dendrotreedemo_clusterz add one standard keyword see file keyword r document directori keyword kwd use one rshowdockeyword keyword kwd __onli one__ keyword per line namedendrorecalcul aliasdendrorecalcul titl recalcul mutat profil cluster descript function calcul mutat profil cluster pool cell within cluster togeth cell within cluster mutat profil result robust estim base maximum likelihood approach loci mutat observ subclon remov usag dendrorecalculatex n info dendro_label clusternam null top null epi mayb also usag object document argument itemx matrix contain variant allel read count across cell column loci row itemn matrix contain total allel read count across cell column loci row iteminfo mutat loci inform matrix row number number loci column number option default null itemdendro_label integ vector decid label cluster cell estim dendrodist dendroclust itemclusternam label name cluster observ cell composit option default null itemtop sinc mani mutat may observ top ask mani top mutat site want select downstream analysi base margin likelihood option default null itemepi sequenc error rare rna edit combin rate default accord illunima itemm polidi maximum likelihood mutat estim default valu itemxan matrix contain variant allel read count across subclon column loci row itemnan matrix contain total allel read count across subclon column loci row itemzan mutat indic matrix mutat normal across subclon column loci row iteminfoinput info filter itemz_cluster_lgan likelihood matrix mutat infer across subclon column loci row refer li b et al likelihoodbas framework variant call de novo mutat detect famili plo genet p e author zilu zhou exampl demo_qc filtercellmutationdemoxdemondemozdemoinfodemolabel dist dendrodistdemo_qcxdemo_qcndemo_qczshowprogressfals clusterdendroclusterdistlabeldemo_qclabel icd dendroicddistclust dendro_label cutreeclust demo_clust dendrorecalculatedemo_qcxdemo_qcn demo_qcinfo demo_qcdendro_label clusternamecclusterclusterclust add one standard keyword see file keyword r document directori keyword kwd use one rshowdockeyword keyword kwd __onli one__ keyword per line