titl empir nonparametr copula model cort r packag tag r copula statist author name oskar lavernycorrespond author orcid x affili multipl affili must quot affili name institut camil jordan université lyon lyon franc index name scor se pari franc index date decembr bibliographi paperbib summari r packag cort implement objectori class method estim simul visual certain type nonparametr copula copula function describ depend structur given dataset given multivari random event without describ univari event margin statist sometim use separ margin distribut inflat money mortal popul depend structur sinc estim everyth separ usual easier copula broadli use financ actuari scienc geostatist biostatist mani field deal depend copula distribut function unit hypercub uniform margin call copula constraint henc packag classifi densiti estim softwar although estim copula widelytr subject perform estim avail literatur base restrict parametr estim vine copula naglerevad graphic model lipanda exampl potenti solut restrict assumpt classic densiti estim kernel wavelet satisfi margin copula constraint also exist sever treestructur piec wise constant densiti estim alway lead proper copula appli pseudoobserv true copula sampl new model implement packag tri solv issu note lot tool avail r copula model excel packag copula copcopcopcop tool howev focu parametr estim start bridg gap provid tool nonparametr estim statement need copula recurs tree cort design lavernydepend flexibl consist piec wise linear estim copula sklarfonct leverag patchwork copula formal duranteconverg specif piec wise constant densiti estim densiti estim tree ramdens patchwork structur impos grid estim datadriven construct grid recurs data minim chosen distanc copula space furthermor addit copula constraint make avail solut densiti estim unus estim concern depend guarante uniform margin r packag cort provid use implement model sever potenti refin allow fast comput cort tree parallel comput cort forest main featur implement packag cort algorithm nonparametr piec wise constant copula densiti estim implement recurs henc quit effici cort packag statist packag allow estim sever nonparametr copula model r although state art copula packag function estim empir copula provid structur set class allow estim empir copula checkerboard copula cort copula bag specif class exist bag cort model implement run parallel fasten comput use futur packag futur underli machineri comput written c rcpp rcpprcpprcpprcpp packag cort packag design use statistician need nonparametr view depend structur given dataset featur rich extens api call statist fit procedur plot function tool assess qualiti fit compli r standard exampl dataset includ packag mani vignett give exampl use case packag avail comprehens r archiv network cran acknowledg acknowledg contribut véroniqu maumedeschamp didier rullièr esterina masiello gave meaning insight perform code thank review fruit review articl packag code refer badg start cran statushttpswwwrpkgorgbadgesversioncorthttpscranrprojectorgpackagecort cran number downloadshttpscranlogsrpkgorgbadgesgrandtotalcorthttpscranlogsrpkgorgbadgesgrandtotalcort codecov test coveragehttpscodecovioghlrnvcortbranchmastergraphbadgesvghttpscodecovioghlrnvcortbranchmast doihttpszenodoorgbadgesvghttpszenodoorgbadgelatestdoi doihttpsjosstheojorgpapersjossstatussvghttpsdoiorgjoss tichttpsgithubcomlrnvcortworkflowsticbadgesvgbranchmasterhttpsgithubcomlrnvcortact badg end cort packag provid class method fit sever copula model classic empir checkerboard copula empir checkerboard copula known margin see cubero masiello maumedeschamp propos two model allow fit copula high dimens small number observ alway proper copula flexibl ad via possibl differenti checkerboard paramet dimens last model consist implement copula recurs tree algorithm aka cort includ localis dimens reduct fit copula recurs split copula domain see laverni maumedeschamp masiello rullièr final provid effici way mix copula allow bag algorithm forest gener way measur ddimension box given copula instal cort cranhttpscranrprojectorg instal stabl version r installpackagescort upstream develop version also instal r devtoolsinstall_githublrnvcort note instal github requir system compil window rtool maco xcode cli linux rbasedev debian vignett quit express give clear overview done packag code use pleas read detail report bug get support report bug feel free open issu github repositori support also provid chanel need contribut everi contribut welcom form pull request github repositori larg modif pleas open issu discuss first concern name convent camelcas function usual design class constructor class method snake_cas refer cubero masiello e maumedeschamp v copula checkertyp approxim applic quantil estim sum depend random variabl commun statist theori method issn x laverni maumedeschamp v masiello e rullièr depend structur estim use copula recurs tree arxiv preprint arxiv cort develop version cort minor improv fix improv document fix buggi autom test cortforest ad simul script document dataset clear pkgdown refer page clean vignett readm fix cort break chang infrastructur lighten box class remov unnecessari gener also remov cbcopula default comput pseudoobserv forest default weight tree turn option new featur core comput move rcpp code perform parallel comput possibl via furrr cortforest solver option number bootstrap resampl access paramet cort function add option forc checkerboard grid tree insid cort cortforest ad four exampl dataset paper minor improv fix remov depend magritr improv document clean code cort algorithm fix bug pvalu comput fix bug one leav tree fix bug pairscort dimens switch leav point fix bug pcopula valu cbcopula object cort first releas publish cran chang conform cran submiss recomend ad multiprocess option via furrr cort correct pass check everi ci plateform correct spell document cort finalis block api cort cort object lighter fasten pvalu comput move bootstrap rcpp ad vignett clayton exampl cort ad newsmd file track chang packag make workspac set travi appveyor github action pkgdowm merg code former empcop packag implement cort algorithm implement cortforest algorithm add mani method cort cortforest class test environ local r instal window x r ubuntu lt travisci r oldrel ubuntu lt travisci r devel ubuntu lt travisci r releas window server x build appveyor r releas window server x build appveyor r devel macoslatest github action r devel macoslatest github action r releas window latest github action r releas ubuntu latest github action r releas window x_wmingw winbuild r devel window server r sp rhub r devel debian linux rhub r devel ubuntu linux rhub r releas fedora linux rhub r devel r cmd check result note error warn cort ad newsmd file track chang packag tri make packag run travi target cran packag cort badg start travi build statushttpstravisciorglrnvcortsvgbranchmasterhttpstravisciorglrnvcort codecov test coveragehttpscodecovioghlrnvcortbranchmastergraphbadgesvghttpscodecovioghlrnvcortbranchmast appveyor build statushttpsciappveyorcomapiprojectsstatusgithublrnvcortbranchmastersvgtruehttpsciappveyorcomprojectlrnvcort badg end goal cort instal instal releas version cort cranhttpscranrprojectorg r installpackagescort exampl basic exampl show solv common problem r librarycort basic exampl code cort ad newsmd file track chang packag tri make packag run travi target cran packag titl empir checkerboard copula author oskar laverni date r sysdat bibliographi instreferencesbib output rmarkdownhtml_vignett fig_capt ye vignett vignetteindexentri empir checkerboard copula vignetteengineknitrrmarkdown vignetteencodingutf r setup includ fals librarycort knitropts_chunkset collaps true comment figwidth figheight empir checkerboard copula model copula defin cubero provid fast easi way model copula highdimension set column row dataset requir one paramet socal checkerboard paramet first section vignett set notat defin model second section discuss demonstr implement made packag definit empir checkerboard copula suppos dataset n iid observ ddiment copula pseudoobserv take checkerboard paramet integ divid n let consid ensembl multiindex mathcali mathbfi i_i_d subset index box b_mathbfi leftfracmathbfimfracmathbfimright partit space mathbbid let lambda dimensionunspecif lebesgu measur power mathbbr foral mathbbn foral xy mathbbrp lambdaleftxyright prodlimits_pd y_i x_i let furthermor mu hatmu respect true copula measur sampl hand classic deheuvel empir copula n iid observ copula dimens let foral r_ir_id margin rank variabl foral x mathcalid text let hatmux fracn sumlimits_kn mathbb_r_kl x_r_dkle x_d readi defin checkerboard copula c empir checkerboard copula hatc follow foral x cx sumlimits_mathbfiinmathcali md mub_mathbfi lambdamathbfxcap b_mathbfi md lambdab_mathbfi copula special form patchwork copula see durant result known inde copula converg true copula mesh size box goe zero etc packag give comprehens implement empir counterpart copula exactli express except mu true copula sampl replac deheuvel approxim hatmu foral x hatcx sumlimits_mathbfiinmathcali md hatmub_mathbfi lambdamathbfxcap b_mathbfi known result copula divid n see cubero case theoret assymptot avali next section discuss implement implement packag empir checkerboard copula implement cbcopula class class littl gener allow vector m_m_d instead singl valu m_i must divid n proper copula train thought follow express model foral x hatcx sumlimits_mathbfiinmathcali hatmub_mathbfi lambdamathbfxcap b_mathbfiprodlimits_pdm_p need provid dataset defin hatmu construct model matter vignett use lifecyclesav dataset follow pair depend plot rfigcappairsplot origin peusdoobserv data setse datalifecyclesav pseudo_data applylifecyclesavingsranktiesmethodmaxnrowlifecyclesav pairspseudo_datalowerpanelnul see variabl depend first fifth variabl seem margin independ dataset n row pick valu divid eg use function cbcopula build copula model sinc alreadi provid pseudo observ set pseudo true provid singl valu paramet set m_i equal valu default proper checkerboard copula r cop cbcopulax pseudo_datam pseudo true moment method exist copula calcul valu via pcopula method simul via rcopula method dcopula method give densiti exampl simul model r figcap pairsplot origin peusdoobserv data red simul pseudo_observ black simu rcopulan copula cop pairsrbindsimupseudo_data colcrepblacknrowsimureprednrowpseudo_data gap lowerpanelnullcex valu valu checkerboard paramet condit heavili copula see vignett convex mixtur mrandom checkerboard detail titl empir checkerboard copula known margin author oskar laverni date r sysdat output rmarkdownhtml_vignett fig_capt ye vignett vignetteindexentri empir checkerboard copula known margin vignetteengineknitrrmarkdown vignetteencodingutf r setup includ fals librarycort knitropts_chunkset collaps true comment figwidth figheight empir checkerboard copula known margin model copula use priori inform multidimension margin condit checkerboard construct rest copula vignett describ model first section discuss current implement second section empir checkerboard copula known margin preliminari notat first certain dimens data hand certain checkerboard paramet let consid ensembl multiindex mathcali mathbfi i_i_d subset index box b_mathbfi leftfracmathbfimfracmathbfimright partit space mathbbid denot set thoos box mathcalb_mathcali leftb_mathbfi mathbfi mathcaliright furthermor let choos p dimens would assign known copula set j subset j p let defin proper project box bj_mathbfi mathbfx p x_j leftfraci_jmfraci_jmright foral j j bj_mathbfi mathbfx p x_j leftfraci_jmfraci_jmright foral j notin j b_mathbfi bj_mathbfi time bj_mathbfi mathbfi mathcali tensor product understood take dimens mathbbid right order bj_mathbfi dimens end place dimens index j think dimens reorder j p let lambda dimensionunspecifi lebesgu measur power mathbbr foral mathbbn foral mathbfxmathbfi mathbbrp lambdaleftmathbfxmathbfyright prodlimits_pd y_i x_i let furthermor muj copula measur dimens p correspond known multivari margin associ margin j let also mu hatmu dimensionunspecif version true copula measur sampl hand respect classic deheuvel empir copula n iid observ copula dimens let foral r_ir_id margin rank variabl foral mathbfx mathcalid text let hatmux fracn sumlimits_kn mathbb_r_kl x_r_dkle x_d readi defin empir checkerboard copula known margin definit estim simul procedur empir copula known margin copula correspond follow simul procedur simul sampl known subcopula muj dimens p avali method depend known copula model let b_mathbfij project box contain sampl sampl one box b_mathbfi among box project b_mathbfij probabl weight frachatmub_mathbfihatmub_mathbfij project box b_mathbfij contain one empir data point hatmub_mathbfij neq fraclambdab_mathbfilambdab_mathbfij otherwis simul uniformli b_mathbfij algorithm simul first known part model dimens j condit checkerboard part ensur known copula respect downsid behavior checkerboard part may point outsid standard checkerboard box make part copula less spars true checkerboard becom sparser soon data fit known margin hand algorithm allow lot flexibl mainli follow point grid given mathcalb_mathcali taken arbitrarili md box volum soon partit mathbbid known copula restrict chose among pdimensionn copula estim checkerboard part turn flexibl patchwork construct chang independ copula one insid box see durantedurantedurantea go defin properli measur associ simul procedur aka empir checkerboard copula known margin let nu measur let mathbfu random vector drawn foral mathbfx mathbbid follow procedur numathbfx sumlimits_mathbfi mathcali mathbbpmathbfuj b_mathbfij cap mathbfxj mathbfuj b_mathbfij cap mathbfxj mathbbpmathbfuj b_mathbfij cap mathbfxj uncondit term easi handl sinc measur associ known copula mathbbpmathbfuj b_mathbfij cap mathbfxj mujb_mathbfij cap mathbfxj condit term treat accord algorithm fraclambdab_mathbfij cap mathbfxjlambdab_mathbfij insid box chosen probabl condit hatmub_mathbfij neq final get follow definit empir checkerboard copula paramet set known margin j follow measur muj copula correspond measur nu given nux sumlimits_mathbfi mathcali mujb_mathbfij cap mathbfxj fraclambdab_mathbfij cap mathbfxjlambdab_mathbfij left frachatmub_mathbfihatmub_mathbfij mathbb_hatmub_mathbfij neq fraclambdab_mathbfilambdab_mathbfij mathbb_hatmub_mathbfij right next section discuss current implement copula current implement packag implement empir checkerboard copula known margin cbkmcopula class constructor class take sever argument x pseudo_data mnrowx repes checkerboard paramet pseudofals pseudo_data alreadi given pseudo_observ form margins_numbersnul margin index associ known copula formerli note j known_copnul known copula appli thoos margin copula object right dimens exampl let take lifecyclesav data rfigcappairsplot origin peusdoobserv setse datalifecyclesav dataset applylifecyclesavingsranktiesmethodmaxnrowlifecyclesav pairsdatasetcollowerpanelnul let estim checkerboard copula margin precis consid known r known_margin c known_copula cbcopulax datasetknown_marginsm pseudo true construct ecbc known margin r cop cbkmcopulax datasetm pseudo truemargins_numb known_marginsknown_cop known_copula simul r figcappairsplot origin data red simul data good model black simu rcopulacop pairsrbindsimudatasetcolcrepblacknrowsimureprednrowdatasetgaplowerpanel nullcex see known margin respect whole point model let see exampl clearli wronglyspecifi copula known margin r figcappairsplot origin data red simul data wrong model black bad_known_copula cbcopulax datasetknown_marginsm pseudo true cop cbkmcopulax datasetm pseudo truemargins_numb known_marginsknown_cop bad_known_copula simu rcopulacop pairsrbindsimudatasetcolcrepblacknrowsimureprednrowdatasetgaplowerpanel nullcex exampl show sensit estim part model good behavior prior estim condit suffer depend insid known multidimension margin also depend involv one variabl thoos known margin checkerboard construct part copula harm part clearli independ r figcappairsplot origin data independ true_copula known_copula true_copula bad_known_copula dataset cbindrcopulatrue_copularcopulatrue_copula colnamesdataset cuvwx pairsdatasetlowerpanelnullcex r figcappairsplot origin data red simul data black independ case cop cbkmcopulax datasetm pseudo truemargins_numb cknown_cop true_copula simu rcopulacop pairsrbindsimudatasetcolcrepblacknrowsimureprednrowdatasetgaplowerpanel nullcex fit quit good titl convex mixtur mrandom checkerboard author oskar laverni date r sysdat output rmarkdownhtml_vignett fig_capt ye vignett vignetteindexentri convex mixtur mrandom checkerboard vignetteengineknitrrmarkdown vignetteencodingutf r setup includ fals librarycort knitropts_chunkset collaps true comment figwidth figheight introduct vignett demonstr checkerboard paramet use produc effici metamodel construct mrandom checkerboard copula base fit statist combin convex mixtur model use possibl m_i valu checkerboard copula aggreg valu optim quadrat loss resampl condit usual work lifecyclesav dataset r get data paramet setse df applylifecyclesavingsranknrowlifecyclesav ncoldf n nrowdf nb_replic number replic resampl nb_fold k valu kfold resampl method nb_cop number mrandom checkerboard copula test pairsdflowerpanel null fit function follow function propos fit r fitting_funct make_k_fold_sampl functiondatak nb_foldn_repeat sapplyn_repeatfunctionn shuffl data data datasamplenrowdata creat k fold fold cutseqnrowdatabreaksklabelsfals sapplykfunctioni test_index whichfoldsiarrindtru returnlisttrain datatest_index test datatest_index simplifyfals build_random_m functionhow_muchdim dnrow_data tsapplyhow_muchfunctioni m_po nrow_datanrow_datanrow_data samplem_posdreplacetru build_all_checkerboard functionsampled_datam lapplysampled_datafunctiond applymfunctionm_ cbcopulax dtrainm m_pseudotru sampl make_k_fold_samplesdfknb_foldn_repeatnb_repl rand_m build_random_mnb_copdnrowsamplestrain cop build_all_checkerboardsamplesrand_m let first calcul empir copula valu r pempcop functionpointsdatadf sapplynrowpointsfunctioni sumcolsumstdata pointsi nrowdata also need calcul error copula made compar empir copula benchmark r error functioncopij test samplesitest returnsumpcopulatestcop pempcoptest error sapplynb_replicatesnb_foldfunctioni sapplynb_copfunctionj errorcopsijij rmse_by_model sqrtrowmeanserror plotrmse_by_model point graph correspond rmse model recal valu use model r rand_m r convex_combin convexcombcopulaunlistcopsrecursivefalsealpha reprmse_by_modelnb_replicatesnb_fold simu rcopulaconvex_combin pairssimulowerpanel nullcex quit good compar dataset start process realli fast use cours use highdimension dataset paramet nb_fold nb_repeat nb_cop could optim furthermor multivari margin known thing could done use cbkmcopula instead cbcopula model titl copula recurs tree bibliographi instreferencesbib date r sysdat output rmarkdownhtml_vignett fig_capt ye vignett vignetteindexentri copula recurs tree vignetteengineknitrrmarkdown vignetteencodingutf introduct r setup includ fals librarycort knitropts_chunkset collaps true comment figwidth figheight vignett use cort algorithm fit copula given simul dataset base clayton copula simul show algorithm use produc bonafid copula describ paramet dataset first let creat plot dataset work well use gamma frailti model clayton copula itll work complet monoton archimedean gener done copula packag see therehttpsgithubcomcrancopulablobeafcbfabacccfdrclaytoncopularl follow code directli taken previou link copula packag r claytonfrailtymodel psi functiontalpha signalphat alpha gener rclayton functionndimalpha val matrixrunifn dim nrow n gam rgamman shape alpha rate gam matrixgam nrow n ncol dim psi logval gamalpha follow code simul dataset visualis r dataset setse n taken small reduc runtim vignett n_tree taken small reduc runtim vignett number_max_dim_forest taken small reduc runtim vignett data matrixnrownncold datac rclaytonnndimdalpha data runifn data data pairsdatacex clearli see second margin independ form rest follow use packag fit depend structur fit cort copula dataset run cort algorithm implement propos done via cortcort function pass first dataset variou paramet see cort detail list paramet note verbos level quit progress put see split decis algorithm make r run_cort setse model cortdataverbose_lvl look top output see first thing algorithm remov second dimens due independ test copula fit access numer method two plot function export model pair function implement low level class hierarchi henc work almost copula packag plot function implement cort rfigcappairsplot origin data black bottomleft corner versu simul model red topright corner pairsmodel rfigcapgray box repres project fit densiti red imput data point plotmodel see nois point bag version model access via cortforest class might abl correct problem gener roxygen edit hand pleas edit document rutilspip name alia titlepip oper usag lh rh descript see codemagrittrlinkmagrittrpip detail keywordintern gener roxygen edit hand pleas edit document rdatar doctypedata nameclayton_data aliasclayton_data titledataset clayton_data format matrix row column exampl section give code regener data need usag clayton_data descript dataset simul point dimension clayton copula eqntheta henc highli depend first third fourth margin second margin ad independ uniform draw lastli third margin flip induc neg depend structur detail dataset studi laverni v maumedeschamp e masiello rullièr exampl psi functiontalpha signalphat alpha gener rclayton functionndimalpha val matrixrunifn dim nrow n gam rgamman shape alpha rate gam matrixgam nrow n ncol dim psi logval gamalpha setseedkind mersennetwisternormalkind invers clayton_data matrixnrowncol clayton_datac rclaytonndimalpha clayton_data runif clayton_data clayton_data refer insertreflavernycort keyworddataset gener roxygen edit hand pleas edit document rcortr namecortclass aliascortclass aliascort titlecort copula usag cort x p_value_for_dim_r min_node_s pseudo_data fals number_max_dim null verbose_lvl slsqp_option null osqp_opt null n force_grid fals argument itemxth data must provid matrix row observ itemp_value_for_dim_reda p_valu local dimens reduct test itemmin_node_sizeth minimum number observ avail leaf initi split itempseudo_dataset true alreadi provid data copula space itemnumber_max_dimth maximum number dimens split occur default dimens itemverbose_lvlnumer set verbos output bigger set output get itemslsqp_optionsopt nloptrslsqp find breakpoint chang default itemosqp_optionsopt weight optim pass call osqposqpset null default itemnth number bootstrap sampl p_valu comput itemforce_gridset true forc breakpoint ncheckerboard grid valu instanc codecort class object repres fit copula use sever method queri classic rdpvcopula method constraint influenc etc besid return input paramet notabl slot item itemcodedata origin data itemcodedim dimens problem number column dataset itemcodef empir frequenc leav itemcodep fit probabl leaf itemcodea minimum point leav itemcodeb maximum point leav itemcodevol volum leav detail slot found refer descript cort class detail class implement cort algorithm fit multivari copula use piec constant densiti given dataset codex function produc estim copula dataset treeshap recurs partit unit hypercub codemin_node_s paramet control stop condit split procedur space split ran quadrat solver option tweak via codeosqp_opt paramet ensur weight respect copula condit model fit use classic rdpvcopula function comput respect random number gener densiti cdf volum function copula see laverni e masiello v maumedeschamp rullièr detail densiti estim procedur codevignettespackagecort exampl usecas exampl cortlifecyclesav refer insertreflavernycort gener roxygen edit hand pleas edit document rdatar doctypedata nameimpossible_data aliasimpossible_data titledataset impossible_data format matrix row column exampl section give code regener data need usag impossible_data descript simul densiti insid piecewis linear copula class appli function deqnhu u_ fracu_ fraci_u_ notin frac frac x uniform sampl take rank detail dataset studi laverni v maumedeschamp e masiello rullièr exampl setseedse kind mersennetwist normalkind invers x matrixrunif x tapplyx functionu ifu u u els ifu u u els u u returnu impossible_data applyxfunctionxreturnrankxtiesmethod max refer insertreflavernycort keyworddataset gener roxygen edit hand pleas edit document rconvexcombcopular nameconvexcombcopulaclass aliasconvexcombcopulaclass aliasconvexcombcopula titleconvex combin copula usag convexcombcopulacopula alpha rep lengthcopula argument itemcopulasa list copula dimens itemalphaa vector posit weight valu instanc codeconvexcombcopula class object repres copula result convex combinaison copula use sever method queri classic rdpvcopula method etc descript convexcombcopula class detail convexcombcopula class use build convex combin copula given posit weight rcopula pcopula function work copula assum work given copula combin convex way see correspond vignett detail implement exampl dataset applylifecyclesavingsranknrowlifecyclesav copula list cbcopuladatasetm cbcopuladatasetm alpha c cop convexcombcopulacopulasalpha gener roxygen edit hand pleas edit document rgenericsr namevcopula aliasvcopula aliasvcopulamatrixmatrixmethod aliasvcopulamatrixmatrixcopula titlecopula volum hyperbox usag vcopulau v copula smethodvcopulamatrixmatrixu v copula argument itemunumer matrix minimum point hyperrectangl one row per observ itemvnumer matrix maximum point hyperrectangl one row per observ itemcopulath copula comput measur box uv itemoth paramet pass method gener valu measur copula descript u must piecewis smaller v otherwis function return error detail method current implement main virtual class copula assum pcopula method avali given copula method could use copula packag assum pcopulaucop work function comput measur copula accord algorithm propos cherubini u romagnoli oct exampl cop cbcopulalifecyclesavingsm vcopulareprepcop vcopulareprepcop refer insertrefcherubinicort gener roxygen edit hand pleas edit document rcbkmcopular namecbkmcopulaclass aliascbkmcopulaclass aliascbkmcopula titlecheckerboard known margin usag cbkmcopula x repnrowx ncolx pseudo fals margins_numb null known_cop null argument itemxth data use itemmcheckerboard paramet itempseudoboolean default codefals set codetru alreadi provid pseudodata codex argument itemmargins_numbersnumer integ determin margin known copula itemknown_copcopula copula object repres known copula select margin valu instanc codecbkmcopula class object repres fit copula use sever method queri classic rdpvcopula method etc descript cbkmcopula contructor detail given empir data given known copula estim subvector data checkerboard known margin construct consist condit pattern checkerboard copula fit similar codecbcopula algorithm condit known margin see correspond vignett detail exampl dataset applylifecyclesavingsranknrowlifecyclesav known_copula cbcopuladatasetm cop cbkmcopulax dataset pseudo true margins_numb c known_cop known_copula gener roxygen edit hand pleas edit document rgenericsr rcortr rcortforestr namequad_norm aliasquad_norm aliasquad_normcortmethod aliasquad_normcortforestmethod titlequadrat norm model one usag quad_normobject smethodquad_normcortobject smethodquad_normcortforestobject argument itemobjectth copula object valu integr squar error quad_norm model descript current implement cort model comput l norm model sectionfunct item item codequad_normcortmethod method class cort item codequad_normcortforestmethod method class cortforest exampl cop cortcortimpossible_data quad_normcop gener roxygen edit hand pleas edit document rgenericsr rcortr namekendall_func aliaskendall_func aliaskendall_funccortmethod titlekendal function copula one usag kendall_funcobject smethodkendall_funccortobject argument itemobject tree itemt valu comput kendal function may vector evalu valu itemoth paramet pass method itemmth number simul valu quadrat product tree descript current implement cort model comput kendal cdf model point sectionfunct item item codekendall_funccortmethod method class cort exampl cop cortlifecyclesav kendall_funccop gener roxygen edit hand pleas edit document rdatar doctypedata namefuncdep_data aliasfuncdep_data titledataset funcdep_data format matrix row column exampl section give code regener data need usag funcdep_data descript depend structur construct appli function deqnhu_u_u_ u_sinpi u_fracu_pifracu_pifracu_ i_fracg u_sinpix_ i_frac u_ uniformli drawn dimension random vector dataset rank eqnhu detail dataset studi laverni v maumedeschamp e masiello rullièr exampl setseedse kind mersennetwisternormalkind invers x matrixrunif x sinpixxpi x xx sinpixxxpi funcdep_data applyxfunctionxreturnrankxtiesmethod max refer insertreflavernycort keyworddataset gener roxygen edit hand pleas edit document rgenericsr rcortr namebiv_rho aliasbiv_rho aliasbiv_rhocortmethod titlespearman rho matrix copula usag biv_rhocopula smethodbiv_rhocortcopula argument itemcopulath copula object valu densiti copula observ descript comput bivari spearmann rho matrix copula sectionfunct item item codebiv_rhocortmethod method class cort exampl cop cortlifecyclesav biv_rhocop gener roxygen edit hand pleas edit document rgenericsr rcortr namequad_prod_with_data aliasquad_prod_with_data aliasquad_prod_with_datacortmethod titlequadrat product data model one usag quad_prod_with_dataobject smethodquad_prod_with_datacortobject argument itemobjectth copula object valu quad_prod_with_data model descript current implement cort model comput quadrat product empir densiti data sectionfunct item item codequad_prod_with_datacortmethod method class cort exampl cop cortlifecyclesav quad_prod_with_datacop gener roxygen edit hand pleas edit document rgenericsr rconvexcombcopular rcortr rcortforestr rcbcopular rcbkmcopular namepcopula aliaspcopula aliaspcopulamatrixconvexcombcopulamethod aliaspcopulamatrixcortmethod aliaspcopulamatrixcortforestmethod aliaspcopulamatrixcbcopulamethod aliaspcopulamatrixcbkmcopulamethod titlecopula cdf usag pcopulau copula smethodpcopulamatrixconvexcombcopulau copula smethodpcopulamatrixcortu copula smethodpcopulamatrixcortforestu copula smethodpcopulamatrixcbcopulau copula smethodpcopulamatrixcbkmcopulau copula argument itemunumer matrix one row per observ itemcopulath copula object itemoth paramet pass method gener valu valu copula observ descript function return valu copula given point sectionfunct item item codepcopulamatrixconvexcombcopulamethod method cbcopula item codepcopulamatrixcortmethod method class cort item codepcopulamatrixcortforestmethod method class cortforest item codepcopulamatrixcbcopulamethod method cbcopula item codepcopulamatrixcbkmcopulamethod method cbcopula exampl cop cbcopulacortrecoveryourself_datam pcopularepcop pcopularepcop pcopularepcop gener roxygen edit hand pleas edit document rgenericsr rcortr namebiv_tau aliasbiv_tau aliasbiv_taucortmethod titlekendal tau matrix copula usag biv_taucopula smethodbiv_taucortcopula argument itemcopulath copula object valu densiti copula observ descript comput bivari kendal tau matrix copula sectionfunct item item codebiv_taucortmethod method class cort exampl cop cortcortfuncdep_data biv_taucop gener roxygen edit hand pleas edit document rdatar doctypedata namerecoveryourself_data aliasrecoveryourself_data titledataset recoveryourself_data format matrix row column exampl section give code regener data need usag recoveryourself_data descript dataset simpl test simul random sampl densiti insid piecewis copula class test whether estim recov use dimension sampl observ uniform unit hypercub appli follow function deqnhu u_ fracu_ i_u_ le frac i_u_ le frac i_frac le u_ detail dataset studi laverni v maumedeschamp e masiello rullièr exampl setseedse kind mersennetwist normalkind invers x matrixrunif recoveryourself_data tapplyx functionu ifu u u els ifu u u els ifu u u els u u returnu refer insertreflavernycort keyworddataset gener roxygen edit hand pleas edit document rgenericsr rconvexcombcopular rcortr rcortforestr rcbcopular rcbkmcopular namercopula aliasrcopula aliasrcopulanumericconvexcombcopulamethod aliasrcopulanumericcortmethod aliasrcopulanumericcortforestmethod aliasrcopulanumericcbcopulamethod aliasrcopulanumericcbkmcopulamethod titlecopula random gener usag rcopulan copula smethodrcopulanumericconvexcombcopulan copula smethodrcopulanumericcortn copula smethodrcopulanumericcortforestn copula smethodrcopulanumericcbcopulan copula smethodrcopulanumericcbkmcopulan copula argument itemnth number simul itemcopulath copula object itemoth paramet pass method gener valu matrix coden row repres random vector gener provid copula descript random number gener follow given copula function perform simul random vector follow copula sectionfunct item item codercopulanumericconvexcombcopulamethod method cbcopula item codercopulanumericcortmethod method class cort item codercopulanumericcortforestmethod method class cortforest item codercopulanumericcbcopulamethod method cbcopula item codercopulanumericcbkmcopulamethod method cbcopula exampl cop cbcopulacortclayton_datam xx rcopulacop gener roxygen edit hand pleas edit document rcortforestr namecortforestclass aliascortforestclass aliascortforest titlebag cort copula usag cortforest x p_value_for_dim_r n_tree compte_loo_weight fals min_node_s pseudo_data fals number_max_dim null verbose_lvl force_grid fals oob_weight true argument itemxth data must provid matrix row observ itemp_value_for_dim_reda p_valu localis dimens reduct test itemn_treesnumb tree itemcompte_loo_weightsdefault fals allow use automat reweight tree forest base leaveoneout consider itemmin_node_sizeth minimum number observ avali leaf initialis split itempseudo_dataset true alreadi provid data copula space itemnumber_max_dimth maximum number dimens split occur default dimens itemverbose_lvlverbos level default integ bigger integ bigger output level itemforce_gridboolean default fals set true forc breakpoint ncheckerboard grid everi tree itemoob_weightingboolean default true option weight tree oob criterion otherwis equal weight valu instanc codecortforest class object repres fit copula use sever method queri classic rdpvcopula method constraint influenc etc besid return input paramet notabl slot item itemcodetre list cort object repres fit tree forest itemcodeweight weigth tree itemcodeindex index data point select fit tree itemcodepmf densiti tree data point itemcodenorm_matrix matrix scalar product tree itemcodeoob_pmf densiti tree data point see fit itemcodeoob_kl outofbag kullbackleibl diverg tree itemcodeoob_is outofbag integr squar error tree detail slot found refer descript cortforest class detail class implement bag cort model outofbag error minimis weight see laverni v maumedeschamp e masiello rullièr detail densiti estim procedur codevignettespackagecort exampl usecas exampl cortforestlifecyclesavingsnumber_max_dimn_tre refer insertreflavernycort gener roxygen edit hand pleas edit document rcbcopular namecbcopulaclass aliascbcopulaclass aliascbcopula titlecheckerboard copula usag cbcopulax repnrowx ncolx pseudo fals argument itemxth data use itemmcheckerboard paramet itempseudoboolean default codefals set codetru alreadi provid pseudo data codex argument valu instanc codecbcopula class object repres fit copula use sever method queri classic rdpvcopula method etc descript cbcopula contructor detail cbcopula class comput checkerboard copula given checkerboard paramet eqnm describ cubero e masiello v maumedeschamp assymptot model given c genest j neslehova r bruno construct copula model follow start dataset eqnn iid observ eqnddimension copula pseudoobserv checkerboard paramet eqnmdivid eqnn consid ensembl multiindex eqni i_i_d subset index box deqnb_i leftfracimfracimright let eqnlambda dimensionunspecif lebesgu measur power eqnr deqnforal n foral xy rp lambdaleftxyright prodlimits_pd y_i x_i let furthermor eqnmu eqnhatmu respect true copula measur sampl hand classic deheuvel empir copula item item eqnn iid observ copula dimens eqnd let eqnforal r_ir_id margin rank variabl eqni item eqnforal x id let eqnhatmux fracn sumlimits_kn i_r_kl x_r_dkle x_d checkerboard copula eqnc empir checkerboard copula eqnhatc defin follow deqnforal x cx sumlimits_iin md mub_i lambdaxcap b_i eqnmd lambdab_i copula special form patchwork copula see f durant j fernández sánchez c sempi f durant j fernández sánchez j quesadamolina ubedaflor estim good properti alway copula checkerboard copula kind patchwork copula use independ copula fillin valu empir data provid creat copula provid data checkerboard paramet depend dimens data refer insertrefcuberoscort insertrefgenestcort insertrefdurantecort insertrefdurantecort gener roxygen edit hand pleas edit document rgenericsr rcortr nameloss aliasloss aliaslosscortmethod titleloss copula estim model one usag lossobject smethodlosscortobject argument itemobjectth copula object valu integr squar error loss model descript current implement cort model comput loss model sectionfunct item item codelosscortmethod method class cort exampl cop cortcortrecoveryourself_data losscop gener roxygen edit hand pleas edit document rgenericsr rcortr rcortforestr rcbcopular namedcopula aliasdcopula aliasdcopulamatrixcortmethod aliasdcopulamatrixcortforestmethod aliasdcopulamatrixcbcopulamethod titlecopula densiti usag dcopulau copula smethoddcopulamatrixcortu copula smethoddcopulamatrixcortforestu copula smethoddcopulamatrixcbcopulau copula argument itemunumer matrix one row per observ itemcopulath copula object itemoth paramet pass method gener valu densiti copula observ descript function return densiti given copula given observ sectionfunct item item codedcopulamatrixcortmethod method class cort item codedcopulamatrixcortforestmethod method class cortforest item codedcopulamatrixcbcopulamethod method cbcopula exampl cop cbcopulacortfuncdep_data dcopularepcop dcopularepcop dcopularepcop gener roxygen edit hand pleas edit document rgenericsr rcortr namequad_prod aliasquad_prod aliasquad_prodcortcortmethod titlequadrat product two copula one usag quad_prodobject other_tre smethodquad_prodcortcortobject other_tre argument itemobject tree itemother_tre tree valu quadrat product tree descript current implement cort model comput l quadrat product tree sectionfunct item item codequad_prodcortcortmethod method class cort exampl cop cortlifecyclesav allequalquad_prodcopcopquad_normcop gener roxygen edit hand pleas edit document rgenericsr rcortr rcortforestr nameconstraint_infl aliasconstraint_infl aliasconstraint_inflcortmethod aliasconstraint_inflcortforestmethod titleconstraint influenc model one usag constraint_inflobject smethodconstraint_inflcortobject smethodconstraint_inflcortforestobject argument itemobjectth copula object valu constraint influenc statist model descript current implement cort model comput constraint influenc model sectionfunct item item codeconstraint_inflcortmethod method class cort item codeconstraint_inflcortforestmethod method class cortforest exampl cop cortcortrecoveryourself_data constraint_inflcop gener roxygen edit hand pleas edit document rgenericsr rcortr nameproject_on_dim aliasproject_on_dim aliasproject_on_dimscortmethod titleproject smaller dimens copula implement usag project_on_dimsobject dim smethodproject_on_dimscortobject dim argument itemobject tree itemdimsth set dimens valu cort object descript current implement cort model comput cort object project smaller set dimens cort object sectionfunct item item codeproject_on_dimscortmethod method class cort exampl cop cortlifecyclesav project project_on_dimscopc