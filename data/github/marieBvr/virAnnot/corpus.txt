codaci badgehttpsapicodacycomprojectbadgegradecbaceabfchttpswwwcodacycommanualmariebvrvirannotutm_sourcegithubcomamputm_mediumreferralamputm_contentmariebvrvirannotamputm_campaignbadge_grad fund img srcdocssourceinra_logojpg width emspimg srcdocssourceubxlogopng width licens work licens creativ common attribut intern licensehttpscreativecommonsorglicensesbi virannot virannot build eas assembl blast search taxonom annot metagenom ng data use virologi team umr bfphttpwwwbordeauxaquitaineinrafrbfp laboratori inra virannot also take part euphresco project plant health bioinformat networkhttpsdoiorgzenodo see morehttpsgitlabcomahaegemanphbnwptrain design identifi virus plant metagenom data use assembl annot sequenc ncbi taxonomi link articlehttpsdoiorgpbiomesa document see document httpsvirannotdocsreadthedocsioenlatest pipelin gener scheme schemedocssourcediaintropng exampl execut creat directori experi mkdir test_virannot cd test_virannot copi exampl read file illumina adapt fasta file sampl id map file step paramet file cp pathtovirannotexamplesreadsfq cp pathtovirannotexamplesadaptersfa cp pathtovirannotexamplesmaptxt cp pathtovirannotexamplesstepyaml cp pathtovirannotexamplesparametersyaml modifi file fit configur exampl contain modul option avail must use templat analysi step readsoustract modul use bowti map read nucleotid sequenc samtool extract unmap pair correspond stepyaml section literalinclud examplesstepyaml line codeblock bash virannotpi maptxt stepyaml p parametersyaml n readsoustraction_phix step demultiplex modul use cutadapt demultiplex read librari also trim read adapt chimer read demultiplex step describ modul section correspond stepyaml section literalinclud examplesstepyaml line codeblock bash virannotpi maptxt stepyaml p parametersyaml n demultiplex step demultiplexhtml modul gather _demultiplexstatscsv file creat html report correspond stepyaml section literalinclud examplesstepyaml line codeblock bash virannotpi maptxt stepyaml p parametersyaml n demultiplexhtml output exampl raw html ifram src_staticstat_demultiplexindexhtml heightpx widthifram step diamond modul launch diamond similar search read produc xml file per sampl literalinclud examplesstepyaml line codeblock bash virannotpi maptxt stepyaml p parametersyaml n diamond step assembl modul simpli launch udba_ud newbler metaspad assembl sampl folder renam scaffold id move result fasta file literalinclud examplesstepyaml line test idba spade codeblock bash virannotpi maptxt stepyaml p parametersyaml n assembly_idba virannotpi maptxt stepyaml p parametersyaml n assembly_spad exampl idba assembl ds_ gtgtaaggtggtgaagg ds_ cctgcgaattgggccaa step map modul use bowti map read back assembl samtool count read per contig step file literalinclud examplesstepyaml line command codeblock bash virannotpi maptxt stepyaml p parametersyaml n map_idba virannotpi maptxt stepyaml p parametersyaml n map_spad output two column tabular file column sequenc id column number read exampl rn file produc ds_ ds_ ds_ ds_ ds_ ds_ ds_ step blast modul abl launch blast provid databas locali remot script blast_launchpi must present distant server parameteryaml modifi fit server step file literalinclud examplesstepyaml line command codeblock bash virannotpi maptxt stepyaml p parametersyaml n blast_nr virannotpi maptxt stepyaml p parametersyaml n blast_refvirtx virannotpi maptxt stepyaml p parametersyaml n blast_allvirtx virannotpi maptxt stepyaml p parametersyaml n blast_rp step blastecsv modul use xml file gener correspond blast modul taxonomi contain sqlite databas creat csv file contain match option taxonomi string sequenc codeblock bash virannotpi maptxt stepyaml p parametersyaml n blastecsv_nr virannotpi maptxt stepyaml p parametersyaml n blastecsv_refvirtx virannotpi maptxt stepyaml p parametersyaml n blastecsv_allvirtx exampl output ds_idbascaffoldtbltxall_vircsv algo query_id nb_read query_length access descript organ percentident nb_hsp queryoverlap hitoverlap evalu score tax_id taxonomi sequenc tblastx ds_ kx grapevin rupestri stem pit associ viru isol sk b complet genom grapevin rupestri stem pittingassoci viru e virusesssrna virusesbetaflexiviridaefoveavirusgrapevin rupestri stem pittingassoci viru gaacactatgaacgacaactggaaatctgagcacgctataaacacccacaaactcaaacgtagacaaagctttaactaagttattcataataatcacaccatgccaaacacttaagg step rpsecsv modul use rpstblastn xml file pfam taxonomi annot queri sequenc produc readabl csv file codeblock bash virannotpi maptxt stepyaml p parametersyaml n rpsecsv literalinclud examplesstepyaml line exampl output ds_idbascaffoldrpspfamcsv query_id query_length cdd_id hit_id evalu startq endq frame descript superkingdom rank famili genu ds_ pfam gnlcdd e pfam viral_helicas viral superfamili rna helicas helicas activ famili demonstr ntpase activ helicas multipl role differ stage viral rna replic dissect mutat analysi virus ssrna virusesunclassifi virus alphaflexiviridaevirgaviridaebetaflexiviridaetymoviridaebromovirida potexvirusallexiviruscarlavirustymovirustobamoviru step ecsvexcel modul take csv file creat compil singl excel file codeblock bash virannotpi maptxt stepyaml p parametersyaml n ecsvexcel literalinclud examplesstepyaml line exampl output ds_idbascaffoldxlsx imag ecsvexcelpng step ecsvkrona modul use csv file blastecsv modul creat krona html file codeblock bash virannotpi maptxt stepyaml p parametersyaml n ecsvkrona virannotpi maptxt stepyaml p parametersyaml n ecsvkrona_dmd exampl output krona raw html ifram src_statickrona_blastblastglobalkronahtml heightpx widthifram ifram src_statickrona_diamondglobal_krona_dmdhtml heightpx widthifram step automapp modul use blast csv annot file select refer sequenc map queri sequenc produc png ident plot align file fasta format codeblock bash virannotpi maptxt stepyaml p parametersyaml n automapper_nr virannotpi maptxt stepyaml p parametersyaml n automapper_allvirtx virannotpi maptxt stepyaml p parametersyaml n automapper_refseqtx exampl output dsds_automapper_nr raw html ifram src_staticresultsindexhtml heightpx widthifram step rpstree modul use rpsecsv result sampl cut group sequenc base identifi domain creat otu ident matrix tree nexu file png domain color sampleid codeblock bash virannotpi maptxt stepyaml p parametersyaml n rpstree raw html ifram src_staticrpstree_globalindexhtml heightpx widthifram step getresult modul simpli copi import result file result directori codeblock bash virannotpi maptxt stepyaml p parametersyaml n getresult prerequisit extern program ncbi blast suit ftpftpncbinlmnihgovblastexecutablesblastlatest sqlite httpswwwsqliteorg mummer httpmummersourceforgenet bowti httpbowtiebiosourceforgenetbowtieindexshtml cutadapt httpsgithubcommarcelmcutadapt ete tree httpetetoolkitorg idbaud httpsgithubcomloneknightpyidba drvm httpssourceforgenetprojectssbnhrifilesdrvm open grid schedul httpgridschedulersourceforgenet diamond httpsgithubcombbuchfinkdiamond sortmerna httpsbioinfoliflfrrnasortmerna printseqlit httpprinseqsourceforgenet samtool httpsamtoolssourceforgenet bcftool httpssamtoolsgithubiobcftool seqtk httpsgithubcomlhseqtk ncbi util httpswwwncbinlmnihgovbooksnbk extern databas ncbi nr nt ftpftpncbinlmnihgovblastdb ncbi taxonomi ftpftpncbinihgovpubtaxonomi pfam ftpftpebiacukpubdatabasespfamcurrent_releas rpsblast file fasta file smp file perl extern librari getoptlong filebasenam dbi datadump bioperl colorrgb listutil spreadsheetwriteexcel loglogperl dbdsqlite sqlsplitstat mathround stringrandom biosearchioblastxml bioseqio perl includ librari toolsfasta toolsfastq toolsblast toolstaxonomi loggerlogg python librari os call log random string argpars sy bio time glob shutil yaml csv importlib matplotlib instal add tool launcher folder path codeblock bash export pathpathtotoolspathtolauncherspath add lib folder perllib codeblock bash export perllibpathtolibperllib databas ncbi taxonomi homemad per domain pfam taxonomi store simpl sqlite databas schema imag taxo_sqlsvg ncbi taxonomi download extract ncbi taxonomi file codeblock bash wget ftpftpncbinlmnihgovpubtaxonomytaxdumptargz gunzip taxdumptargz tar xf taxdumptar wget ftpftpncbinihgovpubtaxonomyaccessiontaxidprotaccessiontaxidgz gunzip protaccessiontaxidgz wget ftpftpncbinihgovpubtaxonomyaccessiontaxidnucl_gbaccessiontaxidgz gunzip nucl_gbaccessiontaxidgz wget ftpftpncbinihgovpubtaxonomyaccessiontaxiddead_protaccessiontaxidgz gunzip dead_protaccessiontaxidgz cat protaccessiontaxid dead_protaccessiontaxid acctaxidprot wget ftpftpncbinihgovpubtaxonomyaccessiontaxidnucl_wgsaccessiontaxidgz gunzip nucl_wgsaccessiontaxidgz wget ftpftpncbinihgovpubtaxonomyaccessiontaxiddead_wgsaccessiontaxidgz gunzip dead_wgsaccessiontaxidgz cat nucl_wgsaccessiontaxid nucl_gbaccessiontaxid dead_wgsaccessiontaxid acctaxidnucl wget ftpftpncbinihgovpubtaxonomyaccessiontaxiddead_nuclaccessiontaxidgz gunzip dead_nuclaccessiontaxidgz wget ftpftpncbinihgovpubtaxonomygi_taxid_protdmpgz gunzip gi_taxid_protdmpgz option combin multipl accessiontaxid file simpl cat keep separ nucl prot access load two differ tabl launch loadtaxonomypl script creat sqlite databas script need two provid sqlite file taxonomyindexsql taxonomystructuresql describ databas strutur file virannotdb codeblock bash loadtaxonomypl struct taxonomystructuresql index taxonomyindexsql acc_prot acctaxidprot acc_nucl acctaxidnucl name namesdmp node nodesdmp gi_prot gi_taxid_protdmp pfam taxonomi pipelin modul rpsecsv rpstree need taxonom inform pfam domain work need extract inform load sqlite databas careful file download size mo download extract pfam fasta file codeblock bash ftpftpncbinihgovpubmmdbcddfastatargz tar xzf fastatargz mkdir pfam mv pfamfasta fasta cd pfam extract taxonom inform sequenc pfam domain store taxtxt file codeblock bash ls pfamfasta sed sfastagitaxonomypl taxtxt db taxonomytmpsqlit r bash creat file file taxtxt file codeblock bash listpathpl grep taxtxt idx comput taxonomi statist domain creat sql file load databas codeblock bash taxo_profile_to_sqlpl idx taxo_profilesql load databas codeblock bash sqlite taxonomytmpsqlit taxo_profilesql modifi path databas edit follow script codeblock bash toolsrpsecsvplmi db pathtotaxonomytmpsqlit toolskrona_newplmi db pathtotaxonomytmpsqlit toolsecsvkronaplmi db pathtotaxonomytmpsqlit toolsblastecsvplmi db pathtotaxonomytmpsqlit toolsrpstreeplmi db pathtotaxonomytmpsqlit toolsautomapperpl taxonomydatabas pathtotaxonomytmpsqlit ncbi blast databas ncbi non redund databas larg similar search use blast intens task recommand use databas comput cluster download ncbi nr et nt blast file codeblock bash wget ftpftpncbinlmnihgovblastdbnrtargz wget ftpftpncbinlmnihgovblastdbnttargz modifi parametersyaml fit configur server genotoul adress genotoultoulouseinrafr usernam stheil db nr bankblastdbnr nt bankblastdbnt reduc databas good choic limit comput ressourc drastic faster similar search exampl command use ncbi tool download sequenc reduc ncbi databas get viroid nucleotid sequenc genbank esearch db nucleotid queri txidorgan efetch format fasta viroids_nuclfna get virus nucleotid sequenc genbank esearch db nucleotid queri txidorgan efetch format fasta viruses_nuclfna creat blast db exampl makeblastdb viruses_nuclfna parse_seqid dbtype nucl download pfam file rpsblast codeblock bash wget ftpftpncbinihgovpubmmdbcddlittle_endianpfam_letargz wget ftpftpncbinihgovpubmmdbcddfastatargz wget ftpftpncbinihgovpubmmdbcddcddtargz use pfam domain fastatargz cddtargz contain file entir cdd databas either delet file pfam databas use complet cdd delet file pfam codeblock bash ls grep v pfam sed srm add bash correct download entir cdd databas codeblock bash wget ftpftpncbinihgovpubmmdbcddlittle_endiancdd_letargz paramet file parametersyaml defin path local remot binari databas templat provid exampl directori literalinclud examplesparametersyaml stepyaml defin step pipelin execut templat provid exampl directori step name correspond python modul launch step step name split base _ charact launch multipl instanc exampl might want launch blastx blastn step name could blast_n blast_x underscor matter use differanci two step special word bracket use substitut string file file file sampleid librari literalinclud examplesstepyaml _maptxt maptxt map file describ experi tabul file first line contain header start must contain least two column sampleid file templat provid exampl directori minimum maptxt file literalinclud examplesmaptxt add categori sampl use color sequenc tree rpstree modul one librari attribut multipl sampl shown exampl thu demultiplex step abl differenti sampl separ modul descript readsoustract readsoustract modul use bowti map read refer output directli pipe samtool bam convert pipe samtool select unmap pair read f f pipe continu bamtofastq tool creat two fastq file r r codeblock python def _create_cmd self cmd cmd selfparamsbinbowti p strselfn_cpu cmd x selfdb cmd selfi selfi cmd selfparamsbinsamtool view bs cmd selfparamsbinsamtool view u f f selfparamsbinbedtool bamtofastq fq selfo fq selfo logdebugcmd return cmd option r fastq file mandatori r fastq file mandatori db bowti databas r output fastq file r output fastq file sge bool n_cpu int number cpu use iter sampleid demultiplex imag demultiplex_png scale warn demultiplex procedur specifc sequenc method demultiplexpl script use cutadapt httpsgithubcommarcelmcutadapt_ demultiplex trim step step sequenc use sequenc technolog dsrna extract protocol extract sequenc protocol inform index common sequenc sampl id store maptxt file must tab delimit file script produc lot temporari file _step_ delet end execut step produc type file info match inform log execut inform fastq file option r fastq file mandatori r fastq file mandatori adapt fasta file adapt middl check mid middl read trim read exclud read min_qual trim read qualiti threshold polya trim polya tail min_len exclud read size threshold iter sampleid step index search imag demultiplex_png scale codeblock perl _launchcutadaptselffil selfindex tmp_file_prefix _step_rdkg dk step discard untrim read read contain index exclud keep trim read g search index error allow index sequenc search one index read index length consid match step common sequenc imag demultiplex_png scale codeblock perl _launchcutadaptselffilesself_commontmp_file_prefix _step_rkkgscalarkeysself_common kk keep read contain common part g search part sequenc error scalarkeysself_common search mani common part provid common part length consid match step common sequenc fragment imag demultiplex_png scale codeblock perl _launchcutadaptselffilesself_commontmp_file_prefix _step_rkkgscalarkeysself_common kk keep read contain common part g search part sequenc error scalarkeysself_common search mani common part provid common part length consid match step trim sequenc adapt imag demultiplex_png scale codeblock perl _launchcutadaptselffilesselfilluminaadaptertmp_file_prefix _step_rkkbscalarkeysselfilluminaadapt kk keep read contain common part b search adapt anywher read sequenc error scalarkeysselfilluminaadapt search mani adapt provid adapt length consid match step search hybrid read imag demultiplex_png scale step realli specif extract method sinc short dna fragment link togeth aspecif adapt ligat step illumina kit creat read compos two differ pcr product thu program search index sequenc middl read trim keep part exlud read research done provid index sequenc revers complement those sequenc middl search common tag middl read trim read exclud read codeblock perl _launchcutadaptselffileshtmp_file_prefix _step_rkkb kk keep read contain index kd middl option provid b search adapt anywher read sequenc error search one index read adapt length consid match step search polya option imag demultiplex_png scale illumina technolog sequenc matrix short compar sequenc length sequenc machin add bunch radom sequenc codeblock perl _launchcutadaptselffil h tmp_file_prefix _step_rkka kk keep read contain index kd middl option provid search end sequenc error search one index read polya length consid match assembl modul launch three assembl idba httpsgithubcomloneknightpyidba_ metaspad httpbioinfspbauruenspades_ newbler httpswikisutexasedudisplaybioiteamgsdenovoassembler_ singleend data foreach assembl modul convert read file proper format launch assembl separ directori renam scaffold identifi move result file sampl root directori option map modul use bowti samtool readpercontigpl script map read back assembl count scaffold number read align result simpl two column file scaffoldid nb_read use modul option contig fasta file contig map read mandatori r fastq file mandatori r fastq file mandatori ise singleton fastq file n_cpu int number cpu use sge bool use sge schedul bam bam file name rn output file name normal modul randomli select num read pairedfil option r fastq file mandatori r fastq file mandatori output r normal file mandatori output r normal file mandatori num int number read randomli select mandatori iter iter sampl librari n_cpu int number cpu use sge bool use sge schedul diamond modul launch diamond similar search read produc xml file simalar blast treat blastecsv modul option r fastq file mandatori r fastq file mandatori db valu defin parametersyaml file mandatori ise singleton fastq file n_cpu int number cpu use sge bool use sge schedul sensit bool more_sensit bool xml output file score report match score max_target_seq maximum match per queri sequenc evalu min evalu ident report match ident percent x qov queri overlap hov hit overlap diamondblast option csv file diamond result mandatori contig fasta file mandatori xml output file type blast type tblastxblastxblastnblastprpstblastn mandatori db valu defin parametersyaml file mandatori evalu min evalu server enkigenologinavaka valu defin parametersyaml file n_cpu int number cpu use tc number task launch time sge num_chunk number chunk split origin fasta file parallel execut max_target_seq maximum match per queri sequenc sge bool use sge schedul blast modul launch type blast local machin distant server modul develop local machin server easli modifi fit need modul mainli depend parametersyaml file blast_launchpi script present server want use modifi fit server configur option contig fasta file mandatori db valu defin parametersyaml file mandatori type blast type tblastxblastxblastnblastprpstblastn mandatori n_cpu int number cpu use tc number task launch time sge experiment work genotoul max_target_seq maximum match per queri sequenc num_chunk number chunk split origin fasta file parallel execut output file name server enkigenologinavaka curta valu defin parametersyaml file sge bool use sge schedul modul abl launch blast instanc distant server databas blast_launchpi script present server edit parametersyaml file fit configur script develop use two comput cluster avaka pb torqu genotoul sge cluster configur may modifi script adapt configur blastecsv modul pars blast xml output filter match differ criteria link access number ncbi taxonomi option b blast file input format xmlm output file name evalu min evalu fhit report first hit fhsp report first hsp pm r reduc taxonomi report consist rank vs report sequenc match viru viroid rn read number file creat map modul type blast type tblastxblastxblastnblastprpstblastn score report match score ident report match ident percent x qov queri overlap hov hit overlap pd pars descript use queri id store dscription field xml file sge bool use sge schedul ecsvexcel modul aggreg multipl ecsv file creat color xlsx file launch ecsvkronapl script option bint csv blast file outpuy file name r rpsblast csv file sge bool use sge schedul ecsvkrona modul launch ecsvkronapl script aggreg multipl ecsv file one krona html file option b int csv blast file id int id want correspond blast file x int xml blast file use file split speci link krona file output file name data bothreadscontigsnon r use reduc taxonomi c identitytaxidnon iter global sge bool use sge schedul rpsecsv modul launch rpsecsvpl script sampl modul pars xml file rpsblast creat csv file result option b rpsblast xml file contig fasta file sge bool use sge schedul output file name evalu evalu threshold rpstree modul launch rpstreepl script sampl provid modul gener oper taxonom unit otu base rpsblast result cdd motif contig cluster togeth base matrix distanc tree gener thank ete toolkit httpetetoolkitorg_ option pfam csv file rpsecsv contig fasta file ecsv csv file blastecsv output file name sge bool viral_port minimum percentag viral sequenc domain select min_prot minimum protein length includ tree perc percentag ident threshold set defin otu iter global rpsmerg modul launch rpsmerg script gener summari file merg otu result blast result rp result otu multipl contig correspond one randomli select option pfam csv file rpsecsv blastx csv file blastecsv rps_folder name output folder rpstree id sampl librari id csv output file iter global sge bool automapp modul launch automapperpl script everi sampl option contig fasta file ecsv csv file blastecsv r fastq file mandatori r fastq file mandatori output folder sge bool ref blast databas name blasthit take multipl csv blast file blastecsv draw histogram taxonomi option bint csv blast file blastecsv idint id associ blast file iter global sge bool output file name imag inra_logojpg align left scale imag ubxlogopng align right scale welcom virannot document virannot build eas assembl blast search taxonom annot metagenom multisampl dataset use virologi team umr bfp httpwwwbordeauxaquitaineinrafrbfp_ laboratori inra design identifi virus plant use assembl annot sequenc ncbi taxonomi nr nt must present locali andor distant server ncbi taxonomi load sqlite databas provid script blast step time consum step use larg comput cluster clearli advantag use two cluster curta httpsredminemciaunivbordeauxfr_ bordeaux univers genotoul httpwwwgenotoulfr_ toulous inra datacent pipelin gener scheme imag diaintropng guid toctre maxdepth prerequisit paramet modul execut