scpnmf dimension reduct method facilit gene select target gene profil learn spars gene encod singl cell introduct scpnmf method facilit gene select target gene profil learn spars gene encod singl cell compar exist gene select method scpnmf two advantag first select inform gene better distinguish cell type small number eg gene second enabl align new target gene profil data refer data lowdimension space help predict cell type new data instal scpnmf instal github follow code r r installpackagesdevtool librarydevtool install_githubjsbuclascpnmf usag detail info scpnmf method applic pleas check packag vignetteshttpshtmlpreviewgithubiohttpsgithubcomjsbuclascpnmfblobmaininstdocsscpnmfhtml follow code r r install_githubjsbuclascpnmf build_vignett true browsevignettesscpnmf contact question suggest scpnmf welcom pleas report issueshttpsgithubcomjsbuclascpnmfissu contact dongyuan song dongyuansonguclaedu kexin li aileenlikexinoutlookcom refer dongyuan song kexin li zachari hemming roy wollman jingyi jessica li scpnmf spars gene encod singl cell facilit gene select target gene profil bioinformat volum issu supplement_ juli page ii httpsdoiorgbioinformaticsbtab titl use scpnmf gene select data project author name dongyuan song affili bioinformat idp univers california lo angel name kexin li affili depart statist univers california lo angel date r biocstyledoc_d output biocstylehtml_docu highlight pygment toc true fig_width fig_height vignett vignetteindexentryscpnmf vignetteengineknitrrmarkdown vignetteencodingutf r echofals includefals knitropts_chunksettidi fals cach true dev png messag fals error fals warn true introduct r setup suppresspackagestartupmessageslibraryscpnmf suppresspackagestartupmessageslibrarysinglecellexperi suppresspackagestartupmessageslibraryumap suppresspackagestartupmessageslibraryggplot scpnmf method facilit gene select target gene profil learn spars gene encod singl cell compar exist gene select method scpnmf two advantag first select inform gene better distinguish cell type small number eg gene second enabl align new target gene profil data refer data lowdimension space help predict cell type new data manual demonstr use r githubpkgjsbuclascpnmf packag select inform gene project dataset limit gene number eg target gene profil lowdimension space set data use zheng dataset exampl zheng dataset store singlecellexperi object unlik singlecel method scpnmf requir normal eg normal cell librari size input data simpli raw logcount matrix row gene column cell r loaddata datazheng packag scpnmf input_zheng logcountszheng input data contain r diminput_zheng gene r diminput_zheng cell step pnmf first step run project nonneg matrix factor pnmf briefli pnmf take advantag pca nmf name tabl compar pnmf pca nmf methodoptim problemnonnegativitysparsitymutu exclusivenessnew data project pnmf minlimits_mathbfw mathbfx mathbfwmathbfwtmathbfx st mathbfwgeq ye high high ye pca minlimits_mathbfw mathbfx mathbfwmathbfwtmathbfx st mathbfwtmathbfw mathbfi low low ye nmf minlimits_mathbfw mathbfh mathbfx mathbfwmathbfh st mathbfwmathbfhgeq ye high high run pnmf algorithm k number low dimens key paramet need prespecifi user propos metric devortho normal differ wtw section scpnmf paper select k implement k_select function howev purpos save time well get stabl result recommend user directli set k typic scrnaseq data use k demonstr purpos r pnmf res_pnmf scpnmfpnmffunx input_zheng k methodeucdist tole maxit verbosen true w res_pnmfweight res_pnmfscor output list contain two matric weight matrix project matrix mathbfw score matrix lowdimension space mathbf mathbfwtmathbfx two output matric similar pca step ii basi select second main step scpnmf select inform base among k base found pnmf last stepi column mathbfw row mathbf main goal remov unwant variat cell eg variat irrelev cell type three main strategi function annot option datadriven basi select correl cell librari size multimod test design function strategi final show perform basi select regard strategi combin function function annot due nice interpret pnmf basi briefli repres funtion gene cluster user perform gene ontolog go analysi annoat basi decid base believ useless remov irrelev base option step sinc requir prior knowledg user demonstr function annot first five base set dim_us r annot res_annot scpnmfbasisannotatew w dim_us id_typ ensembl return_fig true plotres_annotationp_comp datadriven select correl cell librari size multimod test default basi select procedur scpnmf pure datadriven two basic assumpt basi highli correl cell librari size total logcount remov sinc research usual treat cell librari size unwant variat basi show strong multimod pattern kept sinc indic cell subpopul eg cell type structur follow function perform basi check user inspect check result set return_fig true r test res_test scpnmfbasistest x input_zheng return_fig true ncol mccore combin basi select function follow wrapper function select base automat r basisselect w_select scpnmfbasisselectw w xinput_zheng totest true toannot fals mccore colnamesw_select applic dimension reduct scpnmf work dimension reduct method empir result similar pca use umap plot visual reduc space cell dot color origin given cell type label r umap setse s_select tinput_zheng w_select cell_typ coldatazhengphenoid umap_select dataframeumaps_selectlayout cell_typ colnamesumap_select cumap umap cell_typ ggplotumap_select aesxumap yumap geom_points alpha aescolorcell_typ ggtitleumap plot theme_bw themeaspectratio plottitl element_textfac bold size hjust legendposit bottom guidescolor guide_legendoverridea listsiz applic ii inform gene select import applic scpnmf select inform gene often call highlyvari gene unsupervis way compar gene select method scpnmf work well small inform gene number budget set prespecifi gene number r infogen ig getinfogenew_select by_basi fals return_trunw true dim_us null printiginfogen return object ig contain inform gene vector new project matrix mathbfw_sm reli inform gene applic iii data project mathbfw_sm use project new data sinc use gene project work new dataset gene eg singlecel target gene profil illustr project work subset origin zheng data keep gene mimic structur new target gene profil data r project s_new getprojectioninput_zhengiginfogen igtrunw still use umap plot visual lowdimension space gene r umap setse cell_typ coldatazhengphenoid umap_new dataframeumaps_newlayout cell_typ colnamesumap_new cumap umap cell_typ ggplotumap_new aesxumap yumap geom_points alpha aescolorcell_typ ggtitleumap plot newli project data theme_bw themeaspectratio plottitl element_textfac bold size hjust legendposit bottom guidescolor guide_legendoverridea listsiz get help meet problem use scpnmf pleas report issueshttpsgithubcomjsbuclascpnmfissu question email usdongyuansonguclaedu session inform r sessioninfo refer gener roxygen edit hand pleas edit document rgetappr namegetinfogen aliasgetinfogen titleget inform gene usag getinfogenew by_basi fals return_trunw fals dim_us null argument itemwth weight matrix output pnmf itemmth userdefin inform gene number itemby_basisreturn inform gene basi itemreturn_trunwreturn truncat weight matrix itemdim_useth base column use select weight matrix codenul valu use base valu vector contain top inform gene descript get inform gene gener roxygen edit hand pleas edit document rbasisannotat namebasisannot aliasbasisannot titleannot base scpnmf usag basisannot w de_prop dim_us null id_typ symbol ont bp orgdb orghsegdb pvaluecutoff qvaluecutoff mingssiz maxgssiz simp fals return_fig fals cat_num word_num argument itemwth weight matrix scpnmf itemde_propth proport gene treat de gene go analysi itemdim_usewhich base annot itemid_typeth gene id type exampl offici gene symbol codesymbol see detail packag codeclusterprofil itemontwhich gene ontolog use one bp mf cc default bp itemorgdborgdb use itempvaluecutoffpvalu cutoff enrich test report default itemqvaluecutoffqvalu cutoff enrich test report default itemmingssizeminim size gene annot ontolog term test default itemmaxgssizemaxim size gene annot ontolog term test default itemsimpif simplifi go term default fals itemreturn_figif return visual plot default fals itemcat_numhow mani go term shown basi comparison plot itemword_numhow mani go term use word cloud plot descript perform gene ontolog go enrich analysi basi provid biolog interpret detail function annot weight matrix eqnw basi eqnw repres function gene cluster user use annot decid base kept analysi see detail go analysi codeclusterprofil author dongyuan song gener roxygen edit hand pleas edit document rdatar doctypedata namezheng aliaszheng titlea singelcellexperi object contain gene cell format singelcellexperi object row gene col cell sourc duo robinson soneson c systemat perform evalu cluster method singlecel rnaseq data fresearch usag zheng descript singelcellexperi object contain gene cell keyworddataset gener roxygen edit hand pleas edit document rpnmf_funcr namepnmffun aliaspnmffun titlefit pnmf model usag pnmffun x k tol maxit verbosen fals zerotol e method eucdist label null mu lambda seed argument itemxinput data matrix row repres featur gene column repres sampl cell itemkspecif factor rank number low dimens itemtola threshold would consid converg default e itemmaxiternumb max iter time default itemverbosena boolean valu indic whether print number iter itemzerotola threshold basi load would consid zero default e itemmethoda charact string indic method use one codeeucdist codekl codedpnmf itemlabela charact vector indic cluster type cell requir codemethod dpnmf itemmua numer valu control penalti term larger codemu repres haivier penal class distanc codedpnmf default itemlambdaa numer valu control magnituid within class distanc larger codelambda repres larger proport within class distanc total penalti term default itemseedrandom seed initi valu list compon describ itemcodeweightth basi model fit eqnw itemcodescoreth map score eqnwtx dimens reduc result descript fast project nonneg matrix factor realizatiton base euclidean distanc kl diverg discrimin pnmf detail given data matrix row featur column sampl function comput project nonneg matrix factor pnmf base differ object function choic euclidean distanc codeeucdist kl diverg codekl yang zhirong erkki oja discrimin pnmf codedpnmf guan naiyang et al codeeucdist suppos common one codekl similar klnmf poissonnmf may work better count data codedpnmf requir predefin label fit result pnmf share characterist pca nmf model return codebasi matrix similar load matrix pca howev notic unlik pca first pc alway repres largest variat basi vector equal pnmf refer item item yang z oja e linear nonlinear project nonneg matrix factor ieee transact neural network item guan n zhang x luo z tao yang x discrimin project nonneg matrix factor plo one e item urlhttpsgithubcomrichardbearepnmf author kexin li emailaileenlikexinoutlookcom dongyuan song emaildongyuansongguclaedu gener roxygen edit hand pleas edit document rbasistestr namebasistest aliasbasistest titledatadriven basi select usag basistest x return_fig fals adj_method bh mccore ncol argument itemsth score matrix scpnmf itemxth express matrix scpnmf itemreturn_figif return visual plot default fals itemadj_methodmultipl test correct method itemmccoresth number core use itemncolcolumn facet plot descript perform datadriven basi select remov useless base keep inform base contain two approach examin base correl cell librari size examin base multimod test author dongyuan song gener roxygen edit hand pleas edit document rbasisselectr namebasisselect aliasbasisselect titleperform basi select usag basisselect w null x null totest true cor_thr pval_thr return_fig fals adj_method bh mccore ncol toannot fals dim_us null argument itemwth weight matrix output pnmf itemsth score matrix output pnmf itemxth input gene cell logcount matrix itemtotestwheth select base pearson correl w cell librari size test multimod itemcor_threspearson correl w cell librari size cutoff default itempval_thresadjust pvalu cutoff test multimod default itemreturn_figwheth print scatter plot score vector cell librari size distribut score vector basi itemadj_methodpvalu correct method default bh itemmccoresth number core use function mclappli itemncolcolumn facet plot itemtoannotatewheth perform gene ontolog go enrich analysi basi itemdim_useth base column use select weight matrix codenul valu use base valu select weight matrix descript wrapper basi annot datadriven basi select gener roxygen edit hand pleas edit document rgetappr namegetproject aliasgetproject titleget data project usag getprojectionx w_sm argument itemxth input gene cell logcount matrix itemw_smth truncat select weight matrix valu k cell matrix repres lowdimension data project descript get data project