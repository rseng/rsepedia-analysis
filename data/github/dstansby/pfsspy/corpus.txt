pfsspylogologo_rectanglepng pfsspi doihttpszenodoorgbadgesvghttpszenodoorgbadgelatestdoi document statushttpsreadthedocsorgprojectspfsspybadgeversionstablehttpspfsspyreadthedocsioenstablebadgest build statushttpstravisciorgdstansbypfsspysvgbranchmasterhttpstravisciorgdstansbypfsspi codecovhttpscodecovioghdstansbypfsspybranchmastergraphbadgesvghttpscodecovioghdstansbypfsspi circlecihttpscirclecicomghdstansbypfsspysvgstylesvghttpscirclecicomghdstansbypfsspi potenti field sourc surfac model packag python packag base origin code anthoni yeat found httpsgithubcomantyeatespfss document full document packag found httpspfsspyreadthedocsio code conduct commun packag adopt sunpi code conduct pleas follow code conductcode_of_conductmd interact other within pfsspi commun pfsspi sunpi affili packag folow sunpi code conduct shown code conduct sunpi commun made member around globe divers set skill person experi differ commun experi success continu growth expect everyon commun follow guidelin interact other insid outsid commun goal keep posit inclus success grow commun member sunpi open member commun open collabor whether patch report issu ask help otherwis welcom interest join commun realis includ peopl varieti opinion background serv enrich commun accept wish take part activ foster environ anyon particip everyon make differ ensur particip heard feel confid freeli express opinion consider member commun consider peer develop user etc thought address effort other keep mind often labour complet simpli good commun attent commun whether person onlin tact approach differ view recogn work made everyon ensur proper acknowledgementcit origin author time author pledg explicit want work cite acknowledg respect member commun respect respect other posit skill commit effort respect volunt profession effort within commun respect process set forth commun work within pay particular attent new commun disagre courteou rais issu provid harass bullyingfre environ regardless sex sexual orient gender ident disabl physic appear bodi size race nation ethnic religion particular sexual languag imageri sexist racist otherwis exclusionari joke appropri treat outsid commun respect peopl within commun overal good appli code conduct commun situat onlin offlin includ mail list forum social media confer meet associ social event onetoon interact pledg help entir commun follow code conduct remain silent see violat code conduct take action member commun violat code contact confidentialsunpyorg email sent address treat strictest confid talk privat person part code conduct adapt astropyhttpwwwastropyorgcode_of_conducthtml python softwar fundationhttpswwwpythonorgpsfcodeofconduct code conduct licens sunpi commun code conduct licens creativ common attribut intern licens encourag commun relat use adapt code see fit titl pfsspi python packag potenti field sourc surfac model tag python astronomi solar physic author name david stansbi orcid affili name anthoni yeat orcid affili name samuel badman orcid x affili affili name mullard space scienc laboratori univers colleg london holmburi st mari surrey rh nt uk index name depart mathemat scienc durham univers durham dh le uk index name physic depart univers california berkeley ca usa index name space scienc laboratori univers california berkeley ca usa index date octob bibliographi paperbib summari magnet field play crucial role dynam evolut sun star common method use model magnet field solar stellar atmospher potenti field sourc surfac pfss model altschul schatten pfss equat assum zero electr current domain interest lead equat beginequ nabla cdot mathbfb nabla time mathbfb endequ solv spheric shell surfac star configur outer radiu call sourc surfac boundari condit given user specifi radial compon mathbfb inner boundari impos condit pure radial field sourc surfac mimic effect escap stellar wind histor either custom implement pfsspackhttpswwwlmsalcomderosapfsspack form part larger solarsoft librari solar physic freeland written interact data languag idl idl librari use perform pfss extrapol python becom major program languag within solar physic wider astronomi commun bobra need provid well document test function perform pfss extrapol within python ecosystem nich pfsspi fill pfsspi pfsspi python packag solv pfss equat carri common relat task trace magnet field line solut import variou magnet field data sourc visualis data pfss code implement finit differ solver base method ballegooijen given map radial magnet field inner boundari magnet vector potenti calcul grid equal space sinlatitud longitud lnradiu method tailor order achiev nabla time mathbfb machin precis detail exact numer scheme given onlin documentationhttpspfsspyreadthedocsio integr pfsspi design close integr packag astronom solar physic python ecosystem coordin awar input output map creat sunpi packag mumforda thesunpycommun pfsspi fulli integr coordin unit framework present astropi theastropycollabor make easi combin magnet field field line calcul pfsspi data sourc exampl autoreffig show magnet field line overplot extremeultraviolet imag larg activ region sun imag sun taken sdoaia angstrom select magnet field line trace pfss solut overplot white pfss solut field line trace done pfsspi global oscil network group gong photospher magnetogram input sourc surfac solar radii although select field line shown magnet field solv whole sunlabelfigpfsspypdf solar physic commun alreadi made use pfsspi number work interpret observ parker solar probe bale badman investig structur coron mass eject maguir draw link sun solar wind stansbi hope continu provid use resourc commun futur acknowledg david stansbi acknowledg stfc grant stn st anthoni yeat acknowledg stfc grant st refer cite use pfsspi work result public pleas cite journal open sourc softwar paper httpsdoiorgjoss readi made bibtex entri code bibtex articlestansbi doi joss url httpsdoiorgjoss year publish open journal volum number page author david stansbi anthoni yeat samuel badman titl pfsspi python packag potenti field sourc surfac model journal journal open sourc softwar use pfsspi intern find data exampl show find download load magnetogram test comparison numer output pfsspi analyt solut util use code doesnt involv pfss extrapol contribut pfsspi pfsspi commun packag contribut welcom anyon includ report bug request new featur along write code improv document report issu use pfsspi stumbl upon problem best way report open issue_ github issu tracker way help work around problem hope fix problem report issu pleas tri provid short descript issu small code sampl way attempt reproduc error also provid error output gener encount issu use inform debug issu request new featur function current avail pfsspi make featur request issue_ page pleas add much inform possibl regard new featur would like see improv documentaion someth doesnt make sens onlin document pleas open issue_ your comfort fix pleas open pull request pfsspi repositori _issu httpsgithubcomdstansbypfsspyissu contribut code code contribut pfsspi welcom would like submit contribut pleas open pull request pfsspi repositori review use addit merg main code branch new open sourc develop instruct link might use get start astropi dev workflow httpsdocsastropyorgenlatestdevelopmentworkflowdevelopment_workflowhtml_ astropi dev environ httpsdocsastropyorgenlatestdevelopmentworkflowget_devel_versionhtmlgetdevel_ astropi pull request exampl httpsdocsastropyorgenlatestdevelopmentworkflowgit_edit_workflow_exampleshtmlastropyfixexample_ synopt map fit convent fit common filetyp use store solar imag page fit metadata convent synopt map collect inform found taken coordin system solar imag data thompson keyword output crpix n refer pixel subtract along axi n count n integ valu refer centr pixel crval n coordin valu refer pixel along axi n cdelt n pixel space along axi n ctype n coordin axi label axi n pv i_ addit paramet need coordin system note crotan ignor short guid cylindr equal area project project latitud pixel equal space sinlatitud refer pixel equat facilit align solar rotat axi cdelt set pi time pixel space sinlatitud ctype either hglncea crlncea ctype either hgltcea crltcea pv _ set lonpol abbrevi heliograph longitud cylindr equal area etc system heliograph observ must also defin metadata api refer automodapi pfsspi automodapi pfsspygrid automodapi pfsspyfieldlin automodapi pfsspytrac automodapi pfsspyutil automodapi pfsspyanalyt numer method inform numer method use pfss calcul see downloadthi document manualnumerical_methodspdf instal pfsspi requir python sunpi instal pypi use code pip instal pfsspi instal pfsspi depend addit core depend two option depend numba streamtrac improv code perform instal code pip instal pfsspyperform improv perform numba pfsspi automat detect instal numba_ compil numer code speed pfss calcul enabl simpli instal numba_ use pfsspi normal streamlin trace pfsspi two streamlin tracer pure python pfsspytracingpythontrac fortran pfsspytracingfortrantrac fortran version significantli faster use streamtracer_ packag _numba httpsnumbapydataorg _instal numba httpnumbapydataorgnumbadoclatestuserinstallinghtml _streamtrac httpsgithubcomdstansbystreamtrac _changelog changelog new requir pfsspi depend python offici support python new exampl host new exampl compar pfsspi result analyt solut ad exampl galleri bug fix updat sunpi packag requir includ packag need use sunpi map trace field line point bound latitud ie latitud deg filter previous issu low trace step size bug fix fix compat map valid check sunpi updat changelog make clear pfsspi depend sunpi new requir pfsspi depend python sunpi depend matplotlib new featur max_step argument pfsspytracersfortrantrac default auto automat set maximum number step four time number step need span radial solar sourc surfac max_step still manual specifi number less step desir pfsspyfieldlinefieldlin __len__ method mean one n_field_lin lenmy_field_lin ad funcpfsspyutilsroll_map roll map longitud direct particularli help modifi gong map common longitud axi ad pfsspyanalyt submodul provid function sampl analyt solut pfss equat bug fix funcpfsspyutilscarr_cea_wcs_head work version sunpi gong synopt map automat observ inform correct assum earth observ load sunpymapmap plot set input map longer modifi place break chang interpret step_siz pfsspytracersfortrantrac correct step size rel radial cell size step size specifi pfsspi approxim equival step size pfsspi need adjust custom step size accordingli point field line bound ie solar surfac sourc surfac remov pfsspytracingfortrantrac funcpfsspypfss longer warn mean input data nonzero silent ignor monopol compon remov save load pfss solut longer possibl poorli test possibl broken interest save load ad new featur pfsspi pleas open new issu httpsgithubcomdstansbypfsspyissu two bug fix pfsspyutilscarr_cea_wcs_head refer pixel previous one pixel larg longitud latitud longitud coordin previous erron translat one degre fix releas improv document handl hmi map particular hmi map download exampl updat use polar fill data product data miss pole funcpfsspyutilsfix_hmi_meta ad fix metadata issu hmi map modifi metadata hmi map make fit compliant allow use pfsspi releas add citat inform document releas contain sourc accept joss paper describ pfsspi releas includ sever small fix respons review pfsspi journal open sourc softwar thank matthieu ancellin simon birrer help feedback perman code conduct file ad repositori inform contribut pfsspi ad doc exampl show perform differ magnet field tracer fix doc clearer option depend increas perform gong exampl data updat due updat data remot gong server bug fix fix messag error rais function pfsspyutil new featur pfsspyutil modul ad contain variou tool load work synopt map pfsspyoutput new pfsspyoutputbunit properti return astropyunitsunit input map ad methpfsspyoutputget_bvec sampl magnet field solut arbitrari coordin ad pfsspyfieldlinefieldlineb_along_flin properti sampl magnet field along trace field line ad guid numer method use pfsspi break chang al properti pfsspyoutput privat intend user access realli want access use _al privat api guarante stay return thing futur valueerror rais input data pfsspyinput nonfinit nan previous pfss comput would run fine output would consist entir nan behaviour chang monopol term ignor pfss calcul previous nonzero small monopol term would caus float point precis issu lead noisi result monopol term explicitli remov calcul input nonzero mean valu pfsspi issu warn data download exampl automat download cach sunpydatamanag mean file use run exampl download store sunpi data directori requir observ coordin inform gong map automat set locat earth time map header bug fix dateob fit keyword gong map correctli popul improv descript aia overplot exampl fix dateob keyword gong metadata previous store date time date time properli store drastic sped calcul sourc surfac solar surfac magnet field footpoint fix bug gong synopt map sourc map fail load alreadi load fix calcul pfsspycarr_cea_wcs_head clarifi docstr input shape must nlon nlat order ad valid pfsspyinput check input map cover whole solar surfac remov ghost cell pfsspyoutputbc chang shape return array one along axe correct shape pfsspyoutputbg docstr ad exampl show load adapt ensembl map sunpymapcompositemap sped field line expans factor calcul chang output map releas larg see transit leverag sunpi map object follow chang made pfsspyinput must take sunpymapgenericmap input boundari condit oppos numpi array convert numpi array sunpymapgenericmap helper function pfsspycarr_cea_wcs_head use map_dat datetim br nparray header pfsspycarr_cea_wcs_headermap_d brshape sunpymapmapbr header pfss_input pfsspyinputm pfsspyoutputsource_surface_br return sunpymapgenericmap instead array get data array use source_surface_brdata new pfsspyoutputsource_surface_pil return coordin polar invers line sourc surfac favour directli use plot function built sunpi follow plot function remov pfsspyinputplot_input instead pfsspyinput new pfsspyinputmap properti return sunpi map easili plot use sunpymapgenericmapplot pfsspyoutputplot_source_surfac map mathb_r sourc surfac obtain use pfsspyoutputsource_surface_br return sunpi map pfsspyoutputplot_pil coordin polar invers line sourc surfac obtain use pfsspyoutputsource_surface_pil plot use axplot_coordpil etc see exampl section exampl specifi trace seed order make specifi seed easier must astropycoordinatesskycoord object coordin intern transform carrington frame pfss solut trace make specifi coordin easier lonlatr coordin creat use seed astropycoordinatesskycoordlon lat r frameoutputcoordinate_fram convert old x z array use seed r lat lon pfsspycoordscartsph r r astropyconstantsr_sun lat lat nppi urad lon lon urad seed astropycoordinatesskycoordlon lat r frameoutputcoordinate_fram note latitud must rang mathpi pi gong adapt map sourc pfsspi come built sunpi map sourc gong adapt synopt map automat fix noncompli fit header valu use import pfsspi load fit file normal sunpi trace seed pfsspytracingtrac longer transform_se helper method replac pfsspytracingtracercoords_to_xyz pfsspytracingtracerxyz_to_coord new method convert astropycoordinatesskycoord object cartesian xyz coordin intern magnet field grid improv error thrown tri use classpfsspytracingfotrantrac without streamtrac modul instal fix layout issu document fix bug classpfsspytracingfotrantrac would overwrit magnet field valu pfsspyoutput time use reduc default step size pfsspytracingfortrantrac give resolv field line default new fortran field line tracer modpfsspytrac contain new tracer pfsspytracingfortrantrac requir use streamtrac httpsstreamtracerreadthedocsioenstable_ packag streamlin trace rapidli pythonwrap fortran code larg number field line result x speedup compar pfsspytracingpythontrac chang exist code use new tracer easi swap tracer pfsspytracerpythontrac tracer pfsspytracerfortrantrac notic issu new tracer pleas report httpsgithubcomdstansbypfsspyissu chang field line object pfsspyfieldlin pfsspyfieldlin move pfsspyfieldlinefieldlin pfsspyfieldlinefieldlin pfsspyfieldlinefieldlin longer source_surface_feet solar_feet properti instead move new pfsspyfieldlineopenfieldlin class open field line access pfsspyfieldlinefieldlin instanc use new pfsspyfieldlinefieldlinesopen_field_lin properti chang pfsspyoutput pfsspyoutputbg return array instead three array final index index vector compon see docstr inform fix bug pfsspyfieldlineis_open open field line incorrectli calcul close fix bug incorrectli set close line field polar instead correct valu zero fieldlinefootpoint remov favour new pfsspyfieldlinesolar_footpoint pfsspyfieldlinesource_surface_footpoint return singl footpoint close field line see api doc detail pfsspyfieldlin ad conveni class store collect field line mean conveni attribut pfsspyfieldlinessource_surface_feet use valu cach greatli speed repeat use api magnet field trace chang new modpfsspytrac modul contain pfsspytracingtrac class use perform trace code need chang fline outputtracex tracer pfsspytracingpythontrac tracertracex output fline tracerx addit x array contain multipl seed point trace take advantag parallel solver pfsspyfieldlin class longer inherit astropycoordinatesskycoord astropycoordinatesskycoord coordin store pfsspyfieldlinecoord attribut pfsspyfieldlineexpansion_factor return npnan instead none field line close pfsspyfieldlin pfsspyfieldlinefootpoint attribut return footpoint field line pfsspyinput pfsspyoutput take option keyword argument dtime store datetim magnet field measur made propag obstim attribut comput field line allow transform coordin system carrington frame pfsspyfieldlin longer overrrid skycoord __init__ matter user fieldlin object construct intern call pfsspyoutputtrac outputplot_source_surfac accept keyword argument given matplotlib control plot sourc surfac ad explanatori comment exampl correct dipol solut calcul ad pfsspycoordssphcart transform spheric cartesian coordin pfsspyoutputplot_pil accept keyword argument given matplotlib control style contour pfsspyfieldlineexpansion_factor cach calcul access multipl time imag logologo_rectanglesvg pfsspi document pfsspi python packag carri potenti field sourc surfac model commonli use magnet field model sun star note find bug suggest improv pleas rais issu httpsgithubcomdstansbypfsspyissu content toctre maxdepth instal auto_examplesindex pfsspi perform chang contribut numerical_method synoptic_fit includ citingrst