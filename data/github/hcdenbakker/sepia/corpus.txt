continu integrationhttpsgithubcomhcdenbakkersepiaactionsworkflowsrustymlbadgesvghttpsgithubcomhcdenbakkersepiaactionsworkflowsrustyml doihttpsjosstheojorgpapersjossstatussvghttpsdoiorgjoss sepia sepia taxonom read classifi written rust base extens kraken algorithm httpsgithubcomderrickwoodkraken henc name sepia like kraken cephalopod rust color pigment deriv ink sac reason wrote sepia creat softwar packag easili adapt novel taxonomi updat taxonomi eg gtdb alter novel algorithm data structur featur would like eg fast batch mode instal precompil binari download one precompil binari current maco linux herehttpsgithubcomhcdenbakkersepiareleas instal sourc instal rust httpswwwrustlangorg clone sepia repositori git clone httpsgithubcomhcdenbakkersepiagit compil sepia cargo rust compil cd sepia cargo build releas run sepia build index build index need collect refer file mask low complex region use ncbi dustmask httpswwwncbinlmnihgoviebtoolboxcpp_doclxrsourcesrcappdustmask mask folder tab delimit file path refer file taxonomi string refer file ref_demotxt file find exampl look like refer genom salmonella escherichia gtdb r associ taxonomi string format maskedsalmonella_enterica_maskedfasta d__bacteriap__proteobacteriac__gammaproteobacteriao__enterobacteralesf__enterobacteriaceaeg__salmonellas__salmonella enterica maskedsalmonella_enterica_c_maskedfasta d__bacteriap__proteobacteriac__gammaproteobacteriao__enterobacteralesf__enterobacteriaceaeg__salmonellas__salmonella enterica_c maskedsalmonella_enterica_e_maskedfasta d__bacteriap__proteobacteriac__gammaproteobacteriao__enterobacteralesf__enterobacteriaceaeg__salmonellas__salmonella enterica_ maskedsalmonella_enterica_d_maskedfasta d__bacteriap__proteobacteriac__gammaproteobacteriao__enterobacteralesf__enterobacteriaceaeg__salmonellas__salmonella enterica_d maskedsalmonella_bongori_maskedfasta d__bacteriap__proteobacteriac__gammaproteobacteriao__enterobacteralesf__enterobacteriaceaeg__salmonellas__salmonella bongori maskedescherichia_flexneri_maskedfasta d__bacteriap__proteobacteriac__gammaproteobacteriao__enterobacteralesf__enterobacteriaceaeg__escherichias__escherichia flexneri maskedescherichia_coli_maskedfasta d__bacteriap__proteobacteriac__gammaproteobacteriao__enterobacteralesf__enterobacteriaceaeg__escherichias__escherichia coli maskedescherichia_dysenteriae_maskedfasta d__bacteriap__proteobacteriac__gammaproteobacteriao__enterobacteralesf__enterobacteriaceaeg__escherichias__escherichia dysenteria maskedescherichia_coli_d_maskedfasta d__bacteriap__proteobacteriac__gammaproteobacteriao__enterobacteralesf__enterobacteriaceaeg__escherichias__escherichia coli_d maskedescherichia_albertii_maskedfasta d__bacteriap__proteobacteriac__gammaproteobacteriao__enterobacteralesf__enterobacteriaceaeg__escherichias__escherichia albertii maskedescherichia_coli_c_maskedfasta d__bacteriap__proteobacteriac__gammaproteobacteriao__enterobacteralesf__enterobacteriaceaeg__escherichias__escherichia coli_c maskedescherichia_marmotae_maskedfasta d__bacteriap__proteobacteriac__gammaproteobacteriao__enterobacteralesf__enterobacteriaceaeg__escherichias__escherichia marmota maskedescherichia_sp_maskedfasta d__bacteriap__proteobacteriac__gammaproteobacteriao__enterobacteralesf__enterobacteriaceaeg__escherichias__escherichia sp maskedescherichia_fergusonii_maskedfasta d__bacteriap__proteobacteriac__gammaproteobacteriao__enterobacteralesf__enterobacteriaceaeg__escherichias__escherichia fergusonii maskedescherichia_sp_maskedfasta d__bacteriap__proteobacteriac__gammaproteobacteriao__enterobacteralesf__enterobacteriaceaeg__escherichias__escherichia sp maskedescherichia_sp_maskedfasta d__bacteriap__proteobacteriac__gammaproteobacteriao__enterobacteralesf__enterobacteriaceaeg__escherichias__escherichia sp file place use build subcommand build index sepia build help build index usag sepia build option index index kmer kmer_siz minim minim ref ref_fil flag h help print help inform v version print version inform option c batch batch set size batch read process parallel default g gamma gamma gamma paramet use perfect hash function boom mode default valu index index k kmer kmer_siz set kmer size minim minim minim size default length minim minim unless indic otherwis default mode mode build krakenlik db sepia index perfect hash function boom default sepia r ref ref_fil set input file use p thread thread number thread use set one thread use demo build index salmonella escherichia refer use compact hash tabl data structur index use kraken default sepia sepia build r ref_demotxt k p c demo_index creat index call demo_index altern build index boom option creat smaller index perfect hash function index smaller perfect hash function amount ram need build consider larger one experiment element sepia index directoryfold find text file report potenti taxonom incongru call taxonomy_ambiguitiestxt user solv incongru necessari exampl s__hypnum_recurvatum rootk__viridiplantaep__bryophytac__bryopsidao__hypnalesf__hypnaceaeg__drepaniums__hypnum_recurvatum rootk__viridiplantaep__bryophytac__bryopsidao__hypnalesf__hypnaceaeg__hypnums__hypnum_recurvatum case speci name s__hypnum_recurvatum found two differ lineag genu g__drepanium expect genu g__hypnum clearli situat need correct may affect accuraci sepia classifi read belong either g__drepanium g__hypnum anoth exampl need correct g__gomphu rootk__metazoap__arthropodac__insectao__odonataf__gomphidaeg__gomphu rootk__fungip__basidiomycotac__agaricomyceteso__gomphalesf__gomphaceaeg__gomphu case genu g__gomphu found two lineag lineag lead famili dragonfli f__gomphida ii lineag lead famili ectomycorrhiz mushroom f__gomphacea happen quit often taxonomi cover differ nomenclatur code httpsenwikipediaorgwikinomenclature_cod combin one index taxonomi sepia encod way pose problem classifi read sepia classifi help classifi read use lca approach usag sepia classifi flag option index index prefix prefix queri queri flag h help print help inform h hll includ hll base estim cardinilati kmer duplic kmer interleav type sequenc data pe pairedend fastqgz se singleend fastqgz inter interleav pairedend fastqgz fasta read fasta format v version print version inform option c batch batch set size batch read process parallel default z compress_output compress_output gzip compress read classif file default true index index index use search n prefix prefix prefix output file q qualiti qualiti kmer nucleotid minimum phred score exclud analys default q queri queri queri filesfastqgz thread thread number thread use set maximum avail number thread use classifi read use classifi subcommand thank needletail sepia automat detect file fastq fasta file compress eg fastqgz two file given sepia assum file pair end use interleav pairedend file use flag otherwis sepia assum singl end file h use implement hyperloglog howev current implement slow still experiment perform read classif previous creat index default valu sepia classifi q your_data_fastqgz your_data_fastqgz demo_index n your_output_nam creat two file file summar analysi your_output_name_summarytxt file individu read classif your_output_name__classificationgz use follow command line sort grk your_output_name_summarytxt head see first line summari file sort number read rootcellular organismsbacteriaproteobacteriadeltaepsilon subdivisionsepsilonproteobacteriacampylobacteralescampylobacteraceaecampylobactercampylobact jejunicampylobact jejuni subsp jejuni rootcellular organismsbacteriaproteobacteriadeltaepsilon subdivisionsepsilonproteobacteriacampylobacteralescampylobacteraceaecampylobact rootcellular organismsbacteriaproteobacteriadeltaepsilon subdivisionsepsilonproteobacteriacampylobacteralescampylobacteraceaecampylobactercampylobact coli first column show complet taxonomi lineag second number read third averag kmer similar minim use approxim averag kmer similar read classifi taxon column one fourth column show sum length sequenc classifi taxon column one last column particularli help sequenc tachnolog produc read variabl length eg oxford nanopor look first line classif file zcat campy_kala_k_classificationgz head read rootcellular organismsbacteriaproteobacteriadeltaepsilon subdivisionsepsilonproteobacteriacampylobacteralescampylobacteraceaecampylobactercampylobact jejunicampylobact jejuni subsp jejuni read rootcellular organismsbacteriaproteobacteriadeltaepsilon subdivisionsepsilonproteobacteriacampylobacteralescampylobacteraceaecampylobactercampylobact jejunicampylobact jejuni subsp jejuni read rootcellular organismsbacteriaproteobacteriadeltaepsilon subdivisionsepsilonproteobacteriacampylobacteralescampylobacteraceaecampylobactercampylobact jejunicampylobact jejuni subsp jejuni first column show fastq header second classif read third number kmer read support classif third total number kmer use classif note total number kmer depend qualiti set q paramet default phred score set someth like q sequenc error heavi technolog like oxford nanopor script folder repositori find python script gener input krona plot classif file batch mode work larg indic eg gb load index ram usual take longer actual read clasif want use sepia batch sequenc data time effici use batch_classifi subcommand input subcommand tab delimit file point prefix use output file path input file my_fasta pathtomyfilefasta my_se_fastq pathtomyfilefastqgz my_pe_fastq pathtomyfile_fastqgz pathtomyfile_fastqgz run sepia batch mode sepia batch_classifi index demo_index queri my_tab_delimited_filetxt tag your_suffix suffix includ output file usual use show output file index use current batch function use interleav pair end file treat singl end file help function use h help get extens document sepia subcommand exampl get type sepia sepia h sepia henk c den bakker henkcdenbakkergmailcom perfect hash index base read classify usag sepia subcommand flag h help print help inform v version print version inform subcommand batch_classifi classifi batch sampl read build build index classifi classifi read use lca approach help print messag help given subcommand contribut thank contribut collabor environ request chang request chang pleas file issu andor pull request open issu repositori specif code submit would like suggest chang someth address open issu repositori submit pull request would like contribut pleas start discuss issu submit pull request involv rust pleas use cargo fmt andor cargo clippi make sure catch common mistak improv rust code