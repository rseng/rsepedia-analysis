doihttpszenodoorgbadgesvghttpszenodoorgbadgelatestdoi doihttpsjosstheojorgpapersjossstatussvghttpsdoiorgjoss jsuscep packag contain two standalon code written fortran ej_calc suscep ej_calc code use spin densiti obtain dft calcul determin isotrop exchang coupl paramagnet centr suscep code calcul temperatur depend magnet suscept use coupl constant usag instruct detail document code pleas visit httpsgithubcomwatsongrouptcdjsuscepwiki htmlheadheadbodi hcontributingh hbug report featur requestsh pif think youv found bug pleas report hrefhttpsgithubcomwatsongrouptcdjsuscepissuesissu trackera also propos idea new featur ask question design jsuscep poor document also consid bug pleas specif possibl ask improvementsp hcode contributionsh pwe welcom contribut toward improv extend packag manag github pull request extern contribut prefer hrefhttpsguidesgithubcomactivitiesforkingfork pulla workflow core develop use branch main repositoryp blockquot ol lifirst open issu discuss propos contribut discuss might includ chang fit jsuscep scope gener technic approachli limak project fork implement chang there liopen pull request merg chang main project detail discuss take place chang acceptedli ol blockquot titl jsuscep calcul magnet exchang coupl temperatur depend magnet suscept tag magnet ab initio densiti function theori author name swetanshu tandon orcid affili name wolfgang schmitt orcid affili name graem w watson orcid affili email watsongtcdi affili name school chemistri crann institut univers dublin triniti colleg dublin ireland index name amber centr univers dublin triniti colleg dublin ireland index date septemb bibliographi paperbib statement need field molecular magnet attract signific interest owe rise need miniatur magnet advanc field requir deep understand electron structur magnet comput approach play key role push limit nees deep understand magnet properti help make magnet smaller also instrument reason structur system difficult crystallis intermedi state catalyt process krewald molecular complex magnet interact paramagnet centr call isotrop exchang interact strong influenc magnet properti within framework densiti function theori dft use known broken symmetri approach interact quantifi coupl strength call jvalu coupl constant bsym bsym broken symmetri approach requir model multipl spin state use dft final solut obtain depend state model cremad cremad rajeshkumar vignesh mn remov depend state model procedur result larg number solut averag sensibl way addit problem singular solut also aris must identifi remov howev conveni way purpos packag provid mean accomplish arduou task addit packag also calcul temperatur depend magnet suscept therebi enabl comparison comput data experi although code like magpack magpack phi phi avail calcul magnet suscept packag provid onestop solut calcul coupl constant determin magnet suscept use coupl constant jsuscep packag essenti contain two standalon code written fortran ej_calc suscep code reli lapack librari lapack code ej_calc use data obtain dft calcul determin isotrop exchang coupl paramagnet centr complet programm hamiltonian code allow calcul number jvalu limit number state model employ spin densiti approach spin_den spin densiti obtain approach use calcul jvalu code calcul possibl solut base hamiltonian state model remov singular solut calcul averag set coupl constant standard deviat addit also calcul energi differ spin state rel use coupl constant comparison origin dft data suscep code calcul temperatur depend magnet suscept use coupl constant similar ej_calc hamiltonian flexibl number coupl constant provid calcul magnet suscept illustr use packag present exampl mn_ complex shown figur mn mn atom arrang octahedron result mn ci mn atom tran mn atom mn atom interact via cl phosphon bridg one requir jvalu account ci tran interact mn centr model state calcul jvalu result possibl solut use ej_calc final valu determin ciscoupl cm transcoupl respect mn use suscep code calcul temperatur depend suscept shown figur b packag use similar manner probe magnet properti mn_ complex mn structur mn_ complex b temperatur depend magnet suscept obtain use suscep code colour scheme mn dark blue p pink cl green c black n blue red hydrogen atom remov clarityplottif acknowledg author grate irish research council goipg scienc foundat ireland ia ia european research council cog fund author also acknowledg ichec comput resourc refer htmlheadheadbodi hcontributingh hbug report featur requestsh pif think youv found bug pleas report hrefhttpsgithubcomwatsongrouptcdjsuscepissuesissu trackera also propos idea new featur ask question design jsuscep poor document also consid bug pleas specif possibl ask improvementsp hcode contributionsh pwe welcom contribut toward improv extend packag manag github pull request extern contribut prefer hrefhttpsguidesgithubcomactivitiesforkingfork pulla workflow core develop use branch main repositoryp blockquot ol lifirst open issu discuss propos contribut discuss might includ chang fit jsuscep scope gener technic approachli limak project fork implement chang there liopen pull request merg chang main project detail discuss take place chang acceptedli ol blockquot bodyhtml htmlheadheadbodi hbasic detailsh pthi code written fortran requir one input file specifi followingp p number paramagnet centr systemp p number unpair electron centr p p coupl behaviour centr coupl strengthp p gvaluep p strength appli magnet field p p temperatur interv rang valu χ χt need determin p pthi code gener file contain valu χ χt product differ temperatur output also contain detail size hamiltonian matrix msubssub valu associ paramagnet centrep pp bodyhtml htmlheadheadbodi hwork exampleh pthi section describ one obtain necessari data requir prepar hrefhttpsgithubcomwatsongrouptcdjsuscepwikiexecutionformatoffil filea execut jsuscep use avail comput chemistri code hrefhttpsgaussiancomgaussiana exampl correspond system describ exampl exampl input file subsect hrefe_exampleej_calca hrefe_examplesuscepa manual procedur summaris followsp blockquot ol limodel ferromagnet broken symmetri state molecul investigationli liextract spin densiti data energi system gener output filesli lius spin densiti energi data prepar hrefhttpsgithubcomwatsongrouptcdjsuscepwikiexecutionformatoffil filea jsuscep ej_calcli lirun jsuscepli ol blockquot pbnoteb assum path util code describ exampl alreadi ad path variablep hmodel ferromagnet broken symmetri statesh pthe determin coupl constant gener reli use broken symmetri state essenti provid mean repres antiferromagnet state use singl determin comput chemistri code capabl model state p pthe procedur model broken symmetri state use hrefhttpsgaussiancomgaussiana softwar followingp blockquot ol liobtain crystallograph coordin gener model system investigatedli limodel ferromagnet state optimis geometryli lius ferromagnet state gener guess antiferromagnet state lianalys wavefunct ensur wavefunct stabl case instabl optimis wavefunct stabl lioptimis geometryli ol blockquot ponc ferromagnet antiferromagnet state optimis wavefunct use extract spin densiti data mulliken charg analysi carri hrefhttpsgaussiancomgaussiana default one also perform hrefhttpsgaussiancompopulationhirshfelda charg analysi hrefhttptheorycmutexaseduhenkelmancodebad badera charg analysi determin spin densitiesp person recommend use bader spin densiti pbnoteb sometim coupl constant also determin use crystallograph coordin without optimis instanc wavefunct optimis model ferromagnet antiferromagnet state geometri optimisedp pto explain procedur take exampl dimer mn complex shown figur font faceari helvetica sansserif sizea hrefrefshtmlibbi classshowtip libbylibbyafontpp p aligncenterimg srcimgmnjpg altmn structurebr bistructur mnsupivsupsubsub complex colour scheme mn dark blue c black n blue red hydrogen atom remov clarityibp br hferromagnet stateh pthe coordin complex obtain ccdc databas ccdc refer javyek font faceari helvetica sansserif sizea hrefrefshtmccdc classshowtip ccdcccdca font system model use pbe function conjunct sddall basi set effect core potenti mn atom g dp basi set c n h atom system divid fragment mn centr belong two separ fragment ligand environ includ separ fragment input file model ferromagnet state look like followingp pre nprocshar memmb chkferromagneticchk opt upbepbegen geomconnect pseudoread javyek mnfragment mnfragment ofrag c n h gdp __ mn sddall __ mn sddall pre br pthe first two line specifi number processor memori gb dedic run calcul third line specifi name checkpoint file store inform wavefunct fourth line specifi calcul specif term follow meaningp tabl classtg thead tr th classtglaxoptth th classtglaxoptimis geometr coordinatesth tr thead tbodi tr td classtglaxupbepb td td classtglaxus pbe functionaltd tr tr td classtglaxgentd td classtglaxus basi set describ bottom input filetd tr tr td classtglaxgeomconnect td td classtglaxspecifi explicit atom bond data via addit input sectiontd tr tr td classtglaxpseudoread td td classtglaxus effect core potenti describ bottom input filetd tr tbodi tabl pthe next line specifi titl line specifi charg multipl overal system variou fragment follow descript atom coordin connect inform basi set informationp pthe complet hrefhttpsgithubcomwatsongrouptcdjsuscepblobmasterexamplesgaussian_filesferromagneticcominputa file provid part repositoryp br pto run calcul use gaussian follow command use assum input file name ferromagneticcomp preg ferromagneticcom ferromagneticoutpr pthi gener file call ferromagneticout contain inform human readabl format anoth file call ferromagneticchk contain structur wavefunct inform binari form also gener p hantiferromagnet stateh pthe optimis ferromagnet state use gener guess antiferromagnet state hrefhttpsgithubcomwatsongrouptcdjsuscepblobmasterexamplesgaussian_filesantifer_guesscominputa file calcul guess look like followingp pre nprocshar memmb chkjavyek_antiferrochk upbepbegen guessonlyfrag geomconnect popminim pseudoread javyek mnfragment mnfragment ofrag c n h gdp mn sddall mn sddall pre br pthe term guessonlyfrag second line set guess calcul three fragment total number fragment specifi system term popminim control amount data written log file mandatori proper execut calcul execut assum input file name antifer_guesscom perform manner ferromagnet statep preg antifer_guesscom antifer_guessoutpr ponc guess wavefunct gener analys instabl use follow hrefhttpsgithubcomwatsongrouptcdjsuscepblobmasterexamplesgaussian_filesantifer_stabcominputa filep pre nprocshar memmb chkantiferrochk stableopt upbepbegen geomallcheck pseudoread guessread n c h gdp __ mn sddall __ mn sddall pre br pthi calcul read inform checkpoint file antiferrochk gener guess calcul term stableopt fourth line specifi calcul check stabil wavefunct optimis instabl found calcul updat inform checkpoint file antiferrochkp pthe execut assum input file name antifer_stabcom perform followsp preg antifer_stabcom antifer_staboutpr ponc wavefunct optimis use optimis geometri use follow hrefhttpsgithubcomwatsongrouptcdjsuscepblobmasterexamplesgaussian_filesantifer_optcominputa filep pre nprocshar memmb chkantiferrochk opt upbepbegen geomallcheck pseudoread guessread n c h gdp mn sddall mn sddall pre br pagain checkpoint file previou calcul read geometri optimisationp pthe execut assum input file name antifer_optcom perform followsp preg antifer_optcom antifer_optoutpr pbnoteb whenev run calcul make sure spin densiti metal centr close expect done look mullken spin densiti print default gaussian unexpect spin valu may indic problem wavefunct optimisationp hextract spin densiti energi datah ponc calcul complet one start extract data output file arrang data format requir hrefhttpsgithubcomwatsongrouptcdjsuscepwikiexecutionformatoffil filea b make sure spin densiti energi data extract correspond system optimisedbp pthe energi inform easili extract outlog file spin denisti one interest mulliken densiti may copi outlog file copi file proper format hrefhttpsgaussiancompopulationhirshfelda charg analysi one need includ pophirshfeld keyword optimis run ferromagnet broken symmetri statesp pgaussian perform bader analysi easili done use code provid hrefhttptheorycmutexaseduhenkelmancodebad henkelman groupa perform bader analysi one need make use chk file creat format checkpoint fchk file exampl calcul ferromagnet broken symmetri state complet one two chk file ferromagneticchk antiferrochk creat fchk file hrefhttpsgaussiancomformchkformchka util use asp pre formchk ferromagneticchk formchk antiferrochk pre ponc format checkpoint file obtain use gener cube file use hrefhttpsgaussiancomcubegencubegena util gaussian fchk file two cube file contain spin densiti total electron densiti gener asp pre cubegen spinscf ferromagneticfchk ferromagnetic_spincub cubegen densityscf ferromagneticfchk ferromagnetic_tot_dens_finecub cubegen spinscf antiferrofchk antiferro_spincub cubegen densityscf antiferrofchk antiferro_tot_dens_finecub pre pthe ferromagnetic_spincub antiferro_spincub file contain inform spin densiti file ferromagnetic_tot_dens_finecub antiferro_tot_dens_finecub contain inform total electron densiti p pthese cube file use perform bader analysi followp pre bader ferromagnetic_spin_finecub ref ferromagnetic_tot_dens_finecub bader antiferro_spin_finecub ref antiferro_tot_dens_finecub pre pthi gener file call acfdat contain bader spin densiti differ state must kept mind output file alway name acfdat bader code henc necessari execut bader code variou spin state perform way avoid overwrit output filesp ponc energi spin densiti inform obtain one creat hrefhttpsgithubcomwatsongrouptcdjsuscepwikiexecutionformatoffil filea resembl input file hrefhttpsgithubcomwatsongrouptcdjsuscepblobmasterexamplesej_calc_formexamplespin spina provid part repositori along hrefhttpsgithubcomwatsongrouptcdjsuscepwikiexecutionformatoffil filea hrefhttpsgithubcomwatsongrouptcdjsuscepwikiexecutionformatoffil filea hrefhttpsgithubcomwatsongrouptcdjsuscepwikiexecutionformatoffil filea use execut jsuscep inform requir hrefhttpsgithubcomwatsongrouptcdjsuscepwikiexecutionformatoffil filea hrefhttpsgithubcomwatsongrouptcdjsuscepwikiexecutionformatoffil filea primarili depend upon system consider requir calcul exampl detail file provid exampl input file subsect hrefe_exampleej_calca hrefe_examplesuscepa inform hrefhttpsgithubcomwatsongrouptcdjsuscepwikiexecutionformatoffil filea obtain execut ej_calc detail provid hrefe_exampleexampl input filesa section suscepp bodyhtml htmlheadheadbodi hexampl input filesh hexampl h pto understand construct input file let us take exampl dimer mn complex shown figur mn centr iv oxid state dsupsup spin configur font faceari helvetica sansserif sizea hrefrefshtmlibbi classshowtip libbylibbyafontp p aligncenterimg srcimgmnjpg altmn structurebr bistructur mnsupivsupsubsub complex colour scheme mn dark blue c black n blue red hydrogen atom remov clarityibp pthe mn centr complex interact via oxo group hamiltonian complex written followsp center font facecouri new courier monospac sizenbspnbspnbspnbspfonth jltssubsubssubsubgt center pthe input file use hamiltonian mention prepar describ follow addit paramet use complet file j cmsupsup gvalu field strength oerst temperatur rang k temperatur step k p h fileh pre magnet centr j valu hamiltonian hamiltonian end pre br phere number second line specifi magnet centr follow number jvalu detail hamiltonian h file addit parametersh pre spin g valu field strength temperatur rang step size pre br pthi file start specif spin centr exampl centr unpair electron mniv centr henc spin valu follow specif gvalu follow magnitud field strength oerst unit case suscept determin temperatur rang k k incrementsp pthi exampl input file result output file also provid separ file packag p h file jvaluesh pre j valu pre br pin file detail jvalu provid exampl jvalu requir magnitud jvalu cmsupsup follow term j valuesp hexampl h exampl correspond mnsubsub complex shown figur font faceari helvetica sansserif sizea hrefrefshtmli classshowtip liliafont p p aligncenterimg srcimgmnjpg altmn structurebr bistructur mnsupiiisupsubsub complex colour scheme mn dark blue c black n blue red hydrogen atom remov clarityibp pthe structur molecul suggest interact pair mn centr would similar henc hamiltonian system written followsp center font facecouri new courier monospac sizenbspnbspnbspnbspfonth jltssubsubssubsubgt ltssubsubssubsubgt ltssubsubssubsubgt center pthe input file use hamiltonian mention prepar describ follow addit paramet use complet file j cmsupsup gvalu field strength oerst temperatur rang k temperatur step k p h fileh pre magnet centr j valu hamiltonian hamiltonian end pre br phere number second line specifi magnet centr follow number jvalu detail hamiltonian h file addit parametersh pre spin g valu field strength temperatur rang step size pre br pthi file start specif spin centr exampl centr unpair electron mniii centr henc spin valu follow specif gvalu follow magnitud field strength oerst unit case suscept determin temperatur rang k k incrementsp pthi exampl input file result output file also provid separ file packag p h file jvaluesh pre j valu pre br pin file detail jvalu provid exampl jvalu requir magnitud jvalu cmsupsup follow term j valuesp hexampl h psimilar exampl describ ej_calc code exampl correspond mnsubsub coordin complex shown figur font faceari helvetica sansserif sizea hrefrefshtmtandon classshowtip tandontandonafont p p aligncenterimg srcimgmnjpg altmn structurebr bistructur mnsubsub complex colour scheme mn dark blue p pink cl green c black n blue red hydrogen atom remov clarityibp pthe mn centr complex interact via phosphon ligand central clsupsup ion mn centr complex tran ci neighbour one requir jvalu account ci tran interact mn centr font faceari helvetica sansserif sizea hrefrefshtmtandon classshowtip tandontandonafont p pin exampl four mn centr mn mn mn mn iv oxid state dsupsup spin configur other iii oxid state decreas overal symmetri complex therefor hamiltonian complex written followsp center font facecouri new courier monospac sizenbspnbspnbspnbspfonth jsubsubltssubsubssubsubgt jsubsubltssubsubssubsubgt jsubsub ltssubsubssubsubgt jsubsubltssubsubssubsubgt jsubsubltssubsubssubsubgt jsubsubltssubsubssubsubgt ltssubsubssubsubgt jsubsubltssubsubssubsubgt ltssubsubssubsubgt jsubsubltssubsubssubsubgt ltssubsubssubsubgt jsubsubltssubsubssubsubgt ltssubsubssubsubgt jsubsubltssubsubssubsubgt ltssubsubssubsubgt center br pin exampl mn centr mn mn mn iv oxid state other iii oxid state overal symmetri complex significantli reduc captur full electron pictur requir use follow hamiltonianp center font facecouri new courier monospac sizenbspnbspnbspnbspfonth jsubsubltssubsubssubsubgt jsubsubltssubsubssubsubgt jsubsubltssubsubssubsubgt jsubsub ltssubsubssubsubgt jsubsub ltssubsubssubsubgt jsubsub ltssubsubssubsubgt jsubsub ltssubsubssubsubgt jsubsub ltssubsubssubsubgt jsubsub ltssubsubssubsubgt jsubsub ltssubsubssubsubgt jsubsubltssubsubssubsubgt jsubsub ltssubsubssubsubgt jsubsub ltssubsubssubsubgt jsubsub ltssubsubssubsubgt jsubsub ltssubsubssubsubgtcent br p exampl mn centr iii oxid state jvalu requir account exchang interact mn centr hamiltonian complex thu written followsp center font facecouri new courier monospac sizenbspnbspnbspnbspfonth jsubsub ltssubsubssubsubgt ltssubsubssubsubgt ltssubsubssubsubgt ltssubsubssubsubgt ltssubsubssubsubgt ltssubsubssubsubgt ltssubsubssubsubgt ltssubsubssubsubgt ltssubsubssubsubgt ltssubsubssubsubgt ltssubsubssubsubgt ltssubsubssubsubgt jsubsub ltssubsubssubsubgt ltssubsubssubsubgt ltssubsubssubsubgtcent br input file contain hamiltonian spin densiti data result output file exampl provid packag pp bodyhtml htmlheadheadbodi hintroductionh pbriefli code calcul temperatur depend magnet suscept given system exchang coupl constant determin follow hamiltonian use fulfil purposefont faceari helvetica sansserif sizea hrefrefsboca classshowtip bocabocaafont p br p aligncenterimg srcimgonejpg alteq br p pwhere ijsubabsubi coupl constant magnet centr b iii iji repres particular msubssub term basi element issubasubssubbsubi term oper ibi repres appli magnet field gsubasub gyromagnet tensor μsubbsub unit bohr magneton first term account exchang coupl mn centr second term zeeman termp p basic work code involv set matrix possibl msubssub magnet spin quantum number state given system follow oper term matrix eq oper complet matrix diagonalis obtain eigenvalu use determin magnet suscept differ temperatur use van vleck equat detail implement procedur later p tabl border cellpad tr valigntoptdpjsubijsubptdtdnbspnbsptd tdpthe exchang coupl constantptdtr tr valigntoptdpssubxsubptdtdnbspnbsptd tdpthe spin operatorptdtr tabl p definit spin oper formal spin spin project spin densiti use sometim research exclud prefactor formula need kept mind use codep bodyhtml htmlheadheadbodi hfor developersh pthe key global variabl code defin belowp tabl classtg thead tr th classtgamwm variabl th th classtgamwm function th tr thead tbodi tr td classtglax dimens td td classtglax store number magnet centr td tr tr td classtglax no_of_j_v td td classtglax store total number uniqu jvalu defin hamiltonian td tr tr td classtglax totalspin td td classtglax store row column size spin hamiltonian matrix td tr tr td classtglax spin_mat_col td td classtglax store column size spin matrix td tr tr td classtglax j_mat_col td td classtglax store column size j valu matrix td tr tr td classtglax spin td td classtglax store valu ie total number unpair esupsup metal centr td tr tr td classtglax jval td td classtglax store differ jvalu use td tr tr td classtglax jmatx jmati td td classtglax store inform jvalu associ differ spin pair td tr tr td classtglax hamil td td classtglax store spin hamiltonian matrix td tr tr td classtglax g td td classtglax store isotrop gvalu td tr tr td classtglax b td td classtglax store magnet induct wb msupsup td tr tr td classtglax vac_perm td td classtglax store strength appli field td tr tr td classtglax field_str td td classtglax permeabl free space vacuum td tr tr tr td classtglax init_temp td td classtglax store minimum temperatur suscept measur td tr tr td classtglax fin_temp td td classtglax store maximum temperatur suscept measur td tr tr td classtglax step_siz td td classtglax store step size temperatur increment td tr td classtglax spinmat td td classtglax store possibl msubssub valu metal centr td tr tr td classtglax basi td td classtglax store possibl combin msubssub valu metal centr td tr tbodi tabl br pb initb subroutin read input file initialis global variablesp pb printerb subroutin print basic detail output filep pb spinmatformb subroutin determin msubssub valu paramagnet centrep pb formbasisb subroutin calcul basi use span hamiltonian matrix basi element compris msubssub valu paramagnet centrep pb checkpo updateposb subroutin helper subroutin subroutin formbasi cycl possibl combin msubssub valu paramagnet centresp pb hamilformb subroutin defin hamiltonian matrix use variou basi element oper element exchang operatorp pb kron_delb function use determin valu kroneck delta functionp pb diagb helper subroutin use matrix diagonalis use lapack libraryp pb zeemanb subroutin add zeeman term element hamiltonian matrixp pb suscep_calcb subroutin defin b matrix eq hrefb_theorytwenty_on classshowtip twenty_onea calcul matrix coeffici c matrix eq hrefb_theorytwenty_two classshowtip twenty_twoa calcul temperatur depend susceptibilityp pp bodyhtml htmlheadheadbodi hdescript output fileh pthe format output file followsp tabl classtg thead tr th classtgamwmoutput file sectionsth th classtgamwmdescriptionth tr thead tbodi tr td classtgoqnumb magnet centresnbspnbspnbspnbspnbspnbspbrtot number possibl interactionsnbspnbspnbspnbspnbspnbspbrinput obtain spin densiti filebrbrbrnumb spin densiti setsnbspnbspnbspnbspnbspnbspbrspin matrixbrbrbrbrtd td classtgoqdetail basic input paramet brthe inform obtain file brcontain spin densiti inform brare given heretd tr tr td classtgoqno j valu ask brinteract consid j valu brj nbspnbsp nbspnbsp nbspnbsp nbspnbsp nbspnbsp nbspnbsp nbspnbspnbsp nbspnbspnbsp br nbspnbspnbsp nbspnbspnbsp nbspnbspnbsp brj nbspnbspnbsp nbspnbspnbsp nbspnbspnbsp brcoeffici j valuesbrbrbrbrbrtd td classtgoqth interact account brjvalu provid brcoeffici associ jvalu brbase hamiltonian also giventd tr tr td classtgoqposs combin equat per set equat brconsid ie total number equat br cnbspnbspnbsp brsolv equat braverag j valuesbrref eqnbspnbspnbsp nonsingular solutionsnbspnbspnbsp j nbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbsp j brnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbsp nbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbsp brnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbsp nbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspbrbrbrbrbrtd td classtgoqth total possibl combin use brone equat refer brmention follow detailsbrof averag jvalu obtain brset set differ equat bruse referencetd tr tr td classtgoqremov solut jvalu deviat brthan standard deviat brstandard deviat percentag standard deviat bron differ jvaluesbrnonsingular equationsnbspnbspnbspj nbspnbspnbspj brbrbrbrtd td classtgoqinform standard deviat brjvalu cycl valid brsolut ensur brwithin standard deviat given heretd tr tr td classtgoqfin result brtotal nonsingular equationsnbspnbspnbspnbspnbspnbsp braverag jvalu cm standard deviat br nbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspj nbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspj brjvalnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbsp brstd dev brbrtd td classtgoqsummari resultstd tr tr td classtgoqcomparison energi cm electron state brcalcul dft brand energi obtain use averag jvalu brcalculatedbrnot follow energi assum first brenergi valu spin densiti file refer valu brdft energycmnbspnbspnbspnbspnbspcalcul energycmnbspnbspnbspnbspnbspnbspabsolut differencecm brnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbspnbsp nanbrbrbrbrtd td classtgoqa comparison energi differ brstate calcul use dft calcul bruse jvalu provid section brthi use check well coupl brconstant describ differ state brlarg differ two energi brvalu indic problem either model brstate hamiltonian usedtd tr tbodi tabl pp bodyhtml htmlheadheadbodi htheoryh pp pfor obtain n coupl constant least n spin configur need model principl x centr unpair electron maximum xx coupl constant total supxsup differ spin configur supxsup configur half would mirror imag other exampl mnsubsubsupiiisup system one maximum x coupl constant total number spin configur complex supsup maximum uniqu p pfor system paramagnet centr number configur avail requir calcul coupl constant use advantag sinc model state requir allow us remov depend calcul coupl constant state modelledfont faceari helvetica sansserif sizea hrefrefscremad classshowtip cremadescremadesa hrefrefscremad classshowtip cremadescremadesa hrefrefsrajeshkumar classshowtip rajeshkumarrajeshkumara hrefrefsvignesh classshowtip vigneshvignesha hrefrefstandon classshowtip tandontandonafont howev depend upon size system number state model one end larg number set solut coupl constant averag sensibl way problem address codep pwhen calcul r coupl constant use n n r spin configur first one configur use refer state determin energi relat flip spin remain n configur total nrnr ie supnsupcsubrsub set solut ie r coupl constant obtain sinc n model spin state use refer nnrnr ie nsupnsupcsubrsub set solut obtainedp pthi code take hamiltonian valu spin oper paramagnet centr model spin state energi model spin state input inform use calcul coupl constant mention earlier calcul r coupl constant use n n r spin configur total nsupnsupcsubrsub set coupl constant obtain set turn singular discard valid solut averag standard deviat calcul solut deviat three standard deviat discard standard deviat calcul cycl repeat selfconsist obtain p pthe coupl constant obtain way use determin energi possibl electron state supxsup x paramagnet centr achiev heisenberg dirac van vleck hamiltonian h sumsubijsub jsubijsubssubisubssubjsub use font faceari helvetica sansserif sizea hrefrefsheisenberg classshowtip heisenbergheisenberga hrefrefsdirac classshowtip diracdiraca hrefrefsvanvleck classshowtip vanvleckvanvleckafont spin oper valu paramagnet centr determin take averag spin oper valu differ electron state provid input two electron state consid degener differ energi two less cmsupsupp bodyhtml welcom jsuscep wiki hjsuscep documentationh htabl contentsh lia hrefjsuscepstrongjsuscepstronga li lia hrefinstallationstronginstal instructionsstronga li lia hrefexecutionstrongcod executionstronga li lia hrefcontributionstrongcontributingstronga li h ej_calc h ul lia hrefa_introductionstrongintroductionstronga li listronga hrefb_theorytheoryastrong listronga hrefc_basic_detailsbas detailsastrongli listronga hrefe_exampleexampl input filesastrongli listronga hreff_output_file_descriptiondescript output fileastrongli listronga hrefg_file_summarysummari input output filesastrongli listronga hrefh_developersfor developersastrong li ul li hsuscep h ul lia hrefa_introductionstrongintroductionstronga li listronga hrefb_theorytheoryastrong listronga hrefc_basic_detailsbas detailsastrongli listronga hrefe_exampleexampl input filesastrongli listronga hreff_output_file_descriptiondescript output fileastrongli listronga hrefg_limitationslimitationsastrongli listronga hrefh_developersfor developersastrong li ul li lia hrefworked_examplestrongwork examplestronga li lia hrefrefsstrongreferencesastrongli bodyhtml htmlheadheadbodi hcode execut ej_calch pthe execut need done two stepsp br pi first step execut ej_calc_form input file hrefformatoffilefilea hrefformatoffilefilea follow command use p preej_calc_form file filepr pit necessari run ej_calc_form produc singul file requir calcul coupl constant use ej_calc_spinp br pii follow execut ej_calc_spin asp preej_calc_spin file filepr br pa hrefformatoffilefilea contain definit hamiltonianp pa hrefformatoffilefilea contain valu spin oper paramagnet centr energi differ spin statesp pthe detail coupl constant print file file_formout file_spinout formal spin spin densiti respectivelyp pthe detail format hrefformatoffilefilea hrefformatoffilefilea provid later sectionp pp hcode execut susceph pthe execut suscep code requir three input file input file name hrefformatoffilefilea hrefformatoffilefilea hrefformatoffilefilea suscep code execut follow wayp presuscep file file filepr pa hrefformatoffilefilea contain definit hamiltonianp pa hrefformatoffilefilea contain addit inform jvalu requir calcul temperatur depend magnet susceptibilityp pa hrefformatoffilefilea contain magnitud jvalu use determin magnet susceptibilityp pthe temperatur depend magnet suscept print file fileoutp pthe detail format input file provid later sectionp hcode execut use scripth pfor eas bash script jsuscep also provid bin directori use execut code separ togeth describ belowp h ej_calc h pthe code ej_calc_spin execut use tag input file hrefformatoffilefilea hrefformatoffilefilea followsp prejsuscep file filepr pthe use tag lead execut either ej_calc_spin singul file exist work directori ej_calc_form ej_calc_spin singul file exist work directori p pto execut code ej_calc_form separ step one use f tag input file hrefformatoffilefilea hrefformatoffilefilea execut perform follow p prejsuscep f file filepr h suscep h pfor input file hrefformatoffilefilea hrefformatoffilefilea hrefformatoffilefilea code suscep execut follow prejsuscep file file filepr h combin execut h pboth ej_calc suscep code also execut one go three file requiredp blockquot ol lia hrefformatoffilefilea contain detail hamiltonianli lia hrefformatoffilefilea contain inform valu spin oper paramagnet centr energi differ spin statesli lia hrefformatoffilefilea contain addit inform jvalu requir calcul temperatur depend magnet susceptibilityli ol blockquot p although anoth file hrefformatoffilefilea gener requir execut suscep code combin execut code gener file automat execut perform follow p prejsuscep file file filepr pthe jvalu determin use ej_calc_spin code written file name jval use calcul temperatur depend magnet suscept p pthe usag inform script also access followsp prejsuscep hpre pthe follow inform display use h tagp pre jsuscep help execut ej_calc_spin jsuscep file file execut ej_calc_form jsuscep f file file execut suscep jsuscep file file file execut code togeth jsuscep file file file help jsuscep h inform expect within differ input file file contain detail hamiltonian file contain inform valu spin oper paramagnet centr energi differ spin state file contain addit inform jvalu requir calcul temperatur depend magnet suscept file contain magnitud jvalu use determin magnet suscept pre hformat input filesh hformat fileh pfile contain definit hamiltonian format file followsp pre magnet centr ltnumber paramagnet centresgt j valu ltnumber jvalu hamiltonian ltfirst interact associ first jvaluegt ltsecond interact associ first jvaluegt ltthird interact associ first jvaluegt ltfirst interact associ second jvaluegt ltsecond interact associ second jvaluegt ltthird interact associ first jvaluegt ltfirst interact associ third jvaluegt ltsecond interact associ third jvaluegt ltthird interact associ first jvaluegt hamiltonian end pre pthe first line state magnet centr second line specifi mani magnet centr number jvalu specifi hamiltonian specifiedp pthe spin interact singl jvalu specifi singl block spin interact differ jvalu separ line hamiltonian end need end preced p pbnoteb term magnet centr j valu hamiltonian hamiltonian end casesensitivep pexampl input file provid hrefe_exampleexampl input filesa subsect ej_calc section hrefe_exampleexampl input filesa subsect suscep sectionp br hformat fileh pfile contain inform valu spin oper paramagnet centr energi differ spin state format file followsp pre ltssubsubgt ltssubsubgt ltssubsubgt ltesubsubgt ltssubsubgt ltssubsubgt ltssubsubgt ltesubsubgt ltssubsubgt ltssubsubgt ltssubsubgt ltesubsubgt pre phere ltssubijsubgt denot spin oper valu jsupthsup paramagnet centr isupthsup electron state ltesubisubgt repres energi isupthsup state bhartreesbp pexampl input file provid hrefe_exampleexampl input filesa subsect ej_calc sectionp pp br hformat fileh pfile contain addit inform jvalu requir calcul temperatur depend magnet suscept format followsp pre spin ltspin first paramagnet centregt ltspin second paramagnet centregt ltspin third paramagnet centregt g valu ltg valuegt field strength ltfield strength oerstedgt temperatur rang ltminimum temperatur kelvingt ltmaximum temperatur kelvingt step size ltinterv temperatur incrementsgt pre pthi format file first line state spin spin number unpair electron paramagnet centr specifi follow definit g valu follow field strength oerst temperatur kelvin final term step size temperatur kelvinp pbnoteb term magnet centr spin j valu g valu hamiltonian field strength temperatur rang step size casesensitivep pexampl input file provid hrefe_exampleexampl input filesa subsect suscep sectionp br hformat fileh pthi file contain magnitud jvalu use determin magnet suscept format file shown belowp pre j valu ltst jvalu cmgt ltnd jvalu cmgt ltrd jvalu cmgt pre first line contain term j valu follow strength jvalu cmsupsup specifi separ line pbnoteb term j valu casesensitivep pexampl input file provid hrefe_exampleexampl input filesa subsect suscep sectionp pp bodyhtml bodyhtml htmlheadheadbodi hbasic detailsh pthi code written fortran two execut ej_calc_form ej_calc_spin calcul coupl constant use spin densiti requir use execut execut ej_calc_form follow execut ej_calc_spin execut requir two input file one specifi hamiltonian system studi inp file anoth contain definit spin oper ie spin densiti paramagnet centr energi system given spin statep pthe execut ej_calc_form make use formal spin valu determin jvalu ej_calc_spin use actual valu spin oper purpos done valu spin oper gener whole number difficult identifi singular set equat without use whole number sinc actual valu spin oper gener far nearest whole number highli unlik use spin oper remov singular ej_calc_form produc output file file contain coupl constant file bigg nrg_frm_jval_form singul ej_calc_spin produc output file file contain coupl constant nrg_frm_jval_spin detail coupl constant print file inform contain file describ follow discussionp pone start execut ej_calc_form round spin oper valu nearest whole number use correspond whole number valu spin oper identifi set equat singular discard store inform set file singul rare occas equat encount close singular therebi lead absurd noninfinit solut keep note equat detail print file bigg criteria identifi equat set coupl stronger cmsupsup consid big solut discard case coupl constant quit larg howev outlier remov eventu sinc end solut consid valid lie within standard deviat averag valu mention previous ej_calc_spin read singul file gener ej_calc_form calcul solut set found nonsingular ej_calc_formp pthe file nrg_frm_jval_form nrg_frm_jval_spin contain approxim energi possibl supxsup state x number paramagnet centr energi calcul use heisenberg dirac van vleck hamiltonian h sumsubijsub jsubijsubssubisubssubjsub font faceari helvetica sansserif sizea hrefrefsheisenberg classshowtip heisenbergheisenberga hrefrefsdirac classshowtip diracdiraca hrefrefsvanvleck classshowtip vanvleckvanvleckafont spin oper state defin take averag valu spin oper paramagnet centr provid input sinc variat valu spin oper differ spin state small energi obtain way serv reason approxim actual energi state true energi spin state cours obtain diagonalis full hamiltonian sinc diagonalis becom comput quit expens larg system method employ code provid inexpens way obtain decent approxim energi statesp pp bodyhtml htmlheadheadbodi hlimitationsh pthe determin suscept larg system limit avail memori ram size matrix contain msubssub element increas rapidli increas number unpair electron paramagnet centr total number element matrix contain msubssub element given unpair electron centr unpair electron centr unpair electron centr supsup exampl mnsupiiisupsubsub system matrix contain total supsup element mnsupiiisupsubsub system matrix contain total supsupsupsup element mnsupiiisupsubsub system matrix contain supsupsupsup element sinc calcul suscept requir exact diagonalis whole matrix matrix need store memori henc limitationp pp bodyhtml htmlheadheadbodi hfor developersh hworkflowh pthe ej_calc code divid modulesp p mainf control flow codep p initf declar global variabl read input file initi global variabl use inform obtain input filesp p modul_libf build hamiltonian base definit obtain input file form differ combin equat solv use lapack routin averag valid set jvalu standard deviat jvalu also determin use modulep p enrg_frm_jvalf calcul energi spin state use heisenberg dirac van vleck hamiltonian h sumsubijsub jsubijsubssubisubssubjsub font faceari helvetica sansserif sizea hrefrefsheisenberg classshowtip heisenbergheisenberga hrefrefsdirac classshowtip diracdiraca hrefrefsvanvleck classshowtip vanvleckvanvleckafont p br pa detail breakdown modul provid belowp hinitfh pthi modul defin global variablesp tabl classtg thead tr th classtgamwm variabl th th classtgamwm function th tr thead tbodi tr td classtglax num_mag_c td td classtglax store number metal centr configur td tr tr td classtglax no_of_j_v td td classtglax store total number jvalu defin system td tr tr td classtglax tot_interac td td classtglax store number possibl interact spin ie total number ss term td tr tr td classtglax num_spin_dens_set td td classtglax store number set spin densiti avail total number line spin densiti file td tr tr td classtglax tri nbsptd td classtglax help keep program run case equat set encount solv td tr tr td classtglax poss_comb td td classtglax store possibl combin equat ie supnsupcsubjsub term td tr tr td classtglax main_cntr td td classtglax keep track total nonsingular equationstd tr tr td classtglax start finish td td classtglax combin determin time taken program executiontd tr tbodi tabl br tabl classtg thead tr th classtgamwm array th th classtgamwm function th tr thead tbodi tr td classtglax hamil hamil td td classtglax combin keep track centr interact td tr tr td classtglax jpo td td classtglax keep track mani interact includ singl jvalu td tr tr td classtglax energi td td classtglax store energi electron configur td tr tr td classtglax tot_avg td td classtglax store averag jvalu set valid meet standard deviat criteria td tr tr td classtglax stddev td td classtglax store standard deviat differ jvalu td tr tr td classtglax std_per td td classtglax store percentag standard deviat differ jvalu td tr tr td classtglax spin td td classtglax store spin oper valu associ metal centr given spin oper file td tr tr td classtglax hamil td td classtglax store ss type weight term interact td tr tr td classtglax jval td td classtglax store total ss type coeffici associ jvalu td tr tr td classtglax jval_trkr td td classtglax store comput set jvalu td tr tr td classtglax singul td td classtglax ej_calc_spin store locat singular set equat identifi ej_calc_form essenti store data file singul td tr tbodi tabl br br hmodul_libfh pthi modul contain subroutin requir calcul possibl set jvalu determin valid one base standard deviat follow subroutin form part modulep pb jvalsb subroutin determin ss term term come given jvaluep pb solvb subroutin form possibl set equat solv local variabl use subroutin followsp tabl classtg thead tr th classtgamwm array th th classtgamwm function th tr thead tbodi tr td classtglax ctr td td classtglax allow separ henc evalu possibl combin td tr tr td classtglax loc_energi td td classtglax store energi local sinc chang set equat consid td tr tr td classtglax enrg_tb_slvd td td classtglax local copi global array energi td tr tr td classtglax enrg_tb_slvd td td classtglax store energi set equat solv one instanc td tr tr td classtglax enrg_tb_slvd td td classtglax ej_calc_form copi array enrg_tb_slvd td tr tr td classtglax loc_jval td td classtglax store coeffici jvalu local sinc chang set equat consid td tr tr td classtglax jval_tb_solvd td td classtglax local copi global array jval td tr tr td classtglax jval_tb_solvd td td classtglax store coeffici jvalu set equat solv one instanc td tr tr td classtglax jval_tb_solvd td td classtglax ej_calc_form copi array jval_tb_solvd td tr tbodi tabl br pin subroutin first electron state chosen refer state everi state chosen refer state new set equat form subtract refer state state state group possibl set r number jvalu one look set solv simultan linear equat use lapack librari routin dgesv lapack routin dgesv implement differ subroutin call simul_solv also perform basic check singular solut found singular valu jvalu given set set zero howev set found singular thorough screen set perform use lapack librari routin dgesvx implement subroutin simul_solv addit jvalu found larger cmsupsup given set equat detail set correspond jvalu obtain print file bigg case ej_calc_spin howev set determin nonsingular array singul gener singul file creat execut ej_calc_form solvedp br pb checkposb subroutin helper subroutin subroutin solv cycl possibl combin r number jvalu one look spin state n accur n spin state p pb simul_solvb subroutin also helper subroutin subroutin solv check ident pair equat automat make whole set singular pair found solut calcul use lapack librari routin dgesvp pb simul_solvb ej_calc_form subroutin also helper subroutin subroutin solv calcul solut set equat consid solvabl simul_solv use lapack librari routin dgesvx look set equat close singular reason use set found solvabl dgesv comput expens speed gain keep simul_solv simul_solv determin consid code still solv set equat within minut consid worth p pb soln_chkb ej_calc_form subroutin make sure code get stuck set equat p pb avrg_calcsb subroutin calcul averag valid set solut p pb std_devb subroutin calcul standard deviat valid set solut p pb std_devb subroutin check valid jvalu set within standard deviat remov p pb avrg_calcsb subroutin calcul new averag jvalu sinc elimin subroutin std_dev p pb final_printb subroutin print final set jvalu p pb backtrackb subroutin calcul energi use comput jvalu compar energi provid inputp br br henrg_frm_jvalfh pthi modul calcul energi spin state use coupl constant calcul modul_libf main local variabl use modul followsp tabl classtg thead tr th classtgamwm array th th classtgamwm function th tr thead tbodi tr td classtglax unp_elec td td classtglax store spin oper valu metal centr td tr tr td classtglax all_config td td classtglax store possibl spin configur spin state td tr tr td classtglax new_nrg td td classtglax store energi possibl spin state td tr tr td classtgamwm variabl td td classtgamwm function td tr tr td classtglax poss_comb td td classtglax store total possibl spin state td tr tbodi tabl br pthe follow subroutin form part modulep pb avg_spinb subroutin calcul averag spin oper case formal spin valu metal centr p pb all_poss_spinsb subroutin along subroutin update_spin form possibl spin configur store array all_config determin energi configur accord specifi hamiltonian store energi array new_nrg p pb sortb subroutin sort spin state basi increas energi use bubbl sort p pb swapb helper subroutin subroutin sort p pb prntb subroutin print sort energi nrg_frm_jval file p pb update_spinb helper subroutin subroutin all_poss_spin cycl possibl spin configurationsp pb std_devdb ej_calc_spin calcul standard deviat spin oper valu use calcul energi spin statesp br br bodyhtml htmlheadheadbodi hintroductionh pbriefli code calcul coupl constant use follow hamiltonian font faceari helvetica sansserif sizea hrefrefsheisenberg classshowtip heisenbergheisenberga hrefrefsdirac classshowtip diracdiraca hrefrefsvanvleck classshowtip vanvleckvanvleckafont p br font facecouri new courier monospac sizenbspnbspnbspnbspfonth sumsubijsub jsubijsubssubisubssubjsub pwhere term follow meaningsp tabl border cellpad tr valigntoptdpjsubijsubptdtdnbspnbsptd tdpthe exchang coupl constantptdtr tr valigntoptdpssubxsubptdtdnbspnbsptd tdpthe spin operatorptdtr tabl p definit spin oper formal spin spin project spin densiti use sometim research exclud prefactor formula need kept mind use codep bodyhtml htmlheadheadbodi hjsusceph p packag use calcul exchang coupl constant paramagnet centr influenc temperatur depend magnet suscept given systemp pthi packag contain two standalon code written fortran ej_calc suscep ej_calc code use spin densiti obtain dft calcul determin isotrop exchang coupl paramagnet centr suscep code calcul temperatur depend magnet suscept use coupl constant bodyhtml htmlheadheadbodi htheoryh pp pbmatrix elementsb matrix element construct use uncoupl basi compris spin element magnet spin quantum number msubssub valu magnet centr magnet centr n unpair electron magnet spin quantum number valu particular magnet centr rang n n consecut valu differ uniti total n valuesp pbhamiltonianb two major contributor isotrop exchang term zeeman term hamiltonian taken considerationp pisotrop exchang termfont faceari helvetica sansserif sizea hrefrefsboca classshowtip bocabocaafont p p aligncenterimg srcimgtwojpg alteq br p pwhere ijsubabsubi coupl constant magnet centr b iii iji repres particular msubssub term basi element issubasubssubbsubi oper andp p aligncenterimg srcimgthreejpg alteq br p pwhere issubasubi issubbsubi increment decrement oper defin follow p p aligncenterimg srcimgfour_sixjpg alteq br p br pzeeman termfont faceari helvetica sansserif sizea hrefrefsboca classshowtip bocabocaafont p p aligncenterimg srcimgsevenjpg alteq br p phere ibi repres appli magnet field gsubasub gyromagnet tensor μsubbsub unit bohr magnetonp p aligncenterimg srcimgeightjpg alteq br p pwhere δsubabsub kroeneck delta oper equal ab otherwis valu ibsubisubi gsubaisub repres valu magnet field gyromagnet tensor along given direct effect hamiltonian thu given p p aligncenterimg srcimgninejpg alteq br p pthe hamiltonian matrix thu repres p p aligncenterimg srcimgtenjpg alteq br p pwhere iasubisubi iasubjsubi repres element basi n total number element basi p pthe eigenvalu εsubisub henc energi level variou magnet state obtain diagonalis hamiltonian matrix eigenvalu obtain use plot magnet suscept respect temperatur calcul magnet suscept van vleck equat use isfont faceari helvetica sansserif sizea hrefrefskahn classshowtip kahnkahnafont p p aligncenterimg srcimgelevenjpg alteq br p pwhere iϵsubisubsupsupi iϵsubisubsupsupi first second deriv energi respect magnet induct μsubsub permeabl free space nsubasub avogadro number iki boltzmann constant iti temperatur p pbi taylor expans eigenvalu repres asfont faceari helvetica sansserif sizea hrefrefsboca classshowtip bocabocaafont p p aligncenterimg srcimgtwelvejpg alteq br p pwithp p aligncenterimg srcimgthirteenjpg alteq br p pbe coeffici determin obtain coeffici set eigenvalu iεsubimsubi gener use differ magnet field ibsubmsubi wherep p aligncenterimg srcimgfourteenjpg alteq br p pwhere n δ chosen equal bsubsub brthereforep p aligncenterimg srcimgfifteenjpg alteq br p pforp p aligncenterimg srcimgsixteenjpg alteq br p pin matrix formp p aligncenterimg srcimgseventeenjpg alteq br p porp p aligncenterimg srcimgeighteenjpg alteq br p pthe matrix coeffici calcul provid invers b exist followsp p aligncenterimg srcimgnineteenjpg alteq br p pbi assembl row togeth obtainp p aligncenterimg srcimgtwentyjpg alteq br p pie p p aligncenterimg srcimgtwenty_onejpg alteq br p pthu coeffici determin follow equationp p aligncenterimg srcimgtwenty_twojpg alteq br p pthese coeffici use calcul magnet suscept use van vleck equat given asp p aligncenterimg srcimgtwenty_threejpg alteq br p pp bodyhtml htmlheadheadbodi hreferencesh tabl border trtd valigntopbocatdtdboca r itemperatur depend magnet susceptibilityi itheoret foundat molecular magnetismi amsterdam elsevi oxford tdtr trtd valigntopbocatdtdboca r iclustersi itheoret foundat molecular magnetismi amsterdam elsevi oxford tdtr trtd valigntopccdctdtdgroom c r bruno j lightfoot p ward c ldquoth cambridg structur databaserdquo iacta cryst bi bb tdtr trtd valigntopcremadestdtdcremad e j cano e ruiz g rajaraman c j milio e k brechin ldquotheoret method enlighten magnet properti famili mnsubsub singlemolecul magnetsrdquo iinorg chemi bb tdtr trtd valigntopcremadestdtdcremad e cauchi j cano e ruiz ldquocan theoret method go beyond experiment data case molecular magnetismrdquo idalton transi bb tdtr trtd valigntopdiractdtddirac p ldquoquantum mechan manyelectron systemsrdquo iproc r soc lond ai bb tdtr trtd valigntopheisenbergtdtdheisenberg w ldquozur theori de ferromagnetismusrdquo iz physiki bb tdtr trtd valigntopkahntdtdkahn imagnet magnet susceptibilityi imolecular magnetismi usa vch publish inc tdtr trtd valigntoplibbytdtd libbi r j webb w e streib k folt j c huffman n hendrickson g christou ldquocryst structur magnet suscept dinuclear manganeseiv complex mnsubsubosubsubpicsubsubmecn pich picolin acidrdquo iinorg chemi bb tdtr trtd valigntoprajeshkumartdtdrajeshkumar h v annadata evangelisti k langley n f chilton k murray g rajaraman ldquotheoret studi polynuclear cusupiisupsubsubgdsupiiisupsubnsub cluster n toward understand larg magnetocalor effectrdquo iinorg chemi bb tdtr trtd valigntoptandontdtdtandon venkatesan w schmitt g w watson ldquoalter natur coupl chang oxid state mnsubsub cagerdquo idalton transi bb tdtr trtd valigntopvanvlecktdtdvanvleck j h ldquoa survey theori ferromagnetismrdquo irev mod physi bb tdtr trtd valigntopvigneshtdtdvignesh k r k langley k murray g rajaraman ldquowhat control magnet exchang interact mix homoval mnsubsub disclik cluster theoret perspectiverdquo ichem eur ji bb tdtr tr tabl bodi html htabl contentsh lia hrefjsuscepstrongjsuscepstronga li lia hrefinstallationstronginstal instructionsstronga li lia hrefexecutionstrongcod executionstronga li lia hrefcontributionstrongcontributingstronga li h ej_calc h ul lia hrefa_introductionstrongintroductionstronga li listronga hrefb_theorytheoryastrong listronga hrefc_basic_detailsbas detailsastrongli listronga hrefe_exampleexampl input filesastrongli listronga hreff_output_file_descriptiondescript output fileastrongli listronga hrefg_file_summarysummari input output filesastrongli listronga hrefh_developersfor developersastrong li ul li hsuscep h ul lia hrefa_introductionstrongintroductionstronga li listronga hrefb_theorytheoryastrong listronga hrefc_basic_detailsbas detailsastrongli listronga hrefe_exampleexampl input filesastrongli listronga hreff_output_file_descriptiondescript output fileastrongli listronga hrefg_limitationslimitationsastrongli listronga hrefh_developersfor developersastrong li ul li lia hrefworked_examplestrongwork examplestronga li lia hrefrefsstrongreferencesastronglihtmlheadheadbodi hsummari input output filesh pa summari input output file given belowp tabl classtg thead tr th classtgbtt filenam th th classtgbtt file type th th classtgbtt function th tr thead tbodi tr td classtgpki fileinp td td classtgpki input td td classtgpki contain inform total number paramagnet centr hamiltonian specifi relationship variou metal centr td tr tr td classtgpki file td td classtgpki input td td classtgpki contain spin densiti paramagnet centr differ spin state energi correspond state td tr tr td classtglax file_formoutfile_spinout td td classtglax output td td classtglax contain inform calcul coupl constant td tr tr td classtglax bigg td td classtglax output td td classtglax contain inform set equat yield jvalu gt cmsupsup td tr tr td classtglax singul td td classtglax output td td classtglax contain inform set equat singular produc ej_calc_form file requir proper execut execut ej_calc td tr tr td classtglax nrg_frm_jval_formnrg_frm_jv td td classtglax output td td classtglax contain approxim energi possibl supxsup state x number paramagnet centr td tr tbodi tabl pp bodyhtml htmlheadheadbodi hdescript output fileh pthe format output file followsp tabl classtg thead tr th classtgbttoutput file sectionsth th classtgbttdescriptionth tr thead tbodi tr td classtgpkynumb magnet centersnbspnbspnbspnbspnbspnbsp br g valu br temperatur rang use k brbrbrtd td classtgpkydetail input paramet hamiltonian usedtd tr tr td classtgpkyj valu cm pair actbrbrbrtd td classtgpkythi section specifi interact account given jvalu reflect input hamiltoniantd tr tr td classtgpkytemperaturenbspnbspnbspnbspnbspnbspnbspchinbspnbspnbspnbspnbspnbspchitempbrbrbrbrtd td classtgpkythi section give χ χt valu differ temperaturestd tr tbodi tabl pp bodyhtml htmlheadheadbodi hexampl input filesh hexampl h pto understand construct input file let us take exampl dimer mn complex shown figur mn centr iv oxid state dsupsup spin configur font faceari helvetica sansserif sizea hrefrefshtmlibbi classshowtip libbylibbyafontp p aligncenterimg srcimgmnjpg altmn structurebr bistructur mnsupivsupsubsub complex colour scheme mn dark blue c black n blue red hydrogen atom remov clarityibp pthe mn centr complex interact via oxo group hamiltonian complex written followsp center font facecouri new courier monospac sizenbspnbspnbspnbspfonth jltssubsubssubsubgt center pthi hamiltonian repres use follow input file p pre magnet centr j valu hamiltonian hamiltonian end pre p spin oper obtain use bader popul analysi energi obtain dft calcul dft calcul perform use pbe function conjunct sddall basi set effect core potenti mn atom g dp basi set c n h atom first two number line repres spin densiti two mn centr given spin configur last number line repres energi correspond state hartre follow exampl spin oper file mnsubsub systemp pre e e pre pa mn centr iv oxid state formal speak three electron dorbit reflect spin densiti valu close although bader spin analysi use determin spin valu possibl employ differ analysi scheme well eg mulliken hirshfeldp pthe energi given scientif notat nonscientif notat toop pthese exampl input file result output file also provid separ file packag examplesdirectoryp br hexampl h exampl correspond mnsubsub complex shown figur font faceari helvetica sansserif sizea hrefrefshtmli classshowtip liliafont p p aligncenterimg srcimgmnjpg altmn structurebr bistructur mnsupiiisupsubsub complex colour scheme mn dark blue c black n blue red hydrogen atom remov clarityibp pthe structur molecul suggest interact pair mn centr would similar henc hamiltonian system written followsp center font facecouri new courier monospac sizenbspnbspnbspnbspfonth jltssubsubssubsubgt ltssubsubssubsubgt ltssubsubssubsubgt center pthi hamiltonian repres use follow input file p pre magnet centr j valu hamiltonian hamiltonian end pre br pthe spin oper complex obtain use bader popul analysi energi obtain dft calcul similar manner mnsubsub complex describ exampl input file spin given p pre e e pre p first three number line repres spin densiti three mn centr given spin configur last number line repres energi correspond state hartre mn centr iii oxid state three unpair electron reflect spin densiti valu close p pthese exampl input file result output file also provid separ file packag examplesdirectoryp br hexampl h pthese exampl illustr use ej_calc calcul coupl constant highnuclear complex use differ oxid state mnsupiiisupsubsub coordin complex figur model font faceari helvetica sansserif sizea hrefrefshtmtandon classshowtip tandontandonafont p p aligncenterimg srcimgmnjpg altmn structurebr bistructur mnsubsub complex colour scheme mn dark blue p pink cl green c black n blue red hydrogen atom remov clarityibp pthe mn centr complex interact via phosphon ligand central clsupsup ion mn centr complex tran ci neighbour one requir jvalu account ci tran interact mn centresfont faceari helvetica sansserif sizea hrefrefshtmtandon classshowtip tandontandonafont p pin exampl four mn centr mn mn mn mn iv oxid state dsupsup spin configur other iii oxid state decreas overal symmetri complex therefor hamiltonian complex written followsp center font facecouri new courier monospac sizenbspnbspnbspnbspfonth jsubsubltssubsubssubsubgt jsubsubltssubsubssubsubgt jsubsub ltssubsubssubsubgt jsubsubltssubsubssubsubgt jsubsubltssubsubssubsubgt jsubsubltssubsubssubsubgt ltssubsubssubsubgt jsubsubltssubsubssubsubgt ltssubsubssubsubgt jsubsubltssubsubssubsubgt ltssubsubssubsubgt jsubsubltssubsubssubsubgt ltssubsubssubsubgt jsubsubltssubsubssubsubgt ltssubsubssubsubgt center br pthi hamiltonian repres use follow input file p pre magnet centr j valu hamiltonian hamiltonian end pre br pthe spin complex contain spin denisti valu energi complex differ statesp pre e e e e e e e e e e e e e e e e pre br pthese file along result output file provid packag p pin exampl mn centr mn mn mn iv oxid state other iii oxid state overal symmetri complex significantli reduc captur full electron pictur requir use follow hamiltonianp center font facecouri new courier monospac sizenbspnbspnbspnbspfonth jsubsubltssubsubssubsubgt jsubsubltssubsubssubsubgt jsubsubltssubsubssubsubgt jsubsub ltssubsubssubsubgt jsubsub ltssubsubssubsubgt jsubsub ltssubsubssubsubgt jsubsub ltssubsubssubsubgt jsubsub ltssubsubssubsubgt jsubsub ltssubsubssubsubgt jsubsub ltssubsubssubsubgt jsubsubltssubsubssubsubgt jsubsub ltssubsubssubsubgt jsubsub ltssubsubssubsubgt jsubsub ltssubsubssubsubgt jsubsub ltssubsubssubsubgtcent br p exampl mn centr iii oxid state jvalu requir account exchang interact mn centr hamiltonian complex thu written followsp center font facecouri new courier monospac sizenbspnbspnbspnbspfonth jsubsub ltssubsubssubsubgt ltssubsubssubsubgt ltssubsubssubsubgt ltssubsubssubsubgt ltssubsubssubsubgt ltssubsubssubsubgt ltssubsubssubsubgt ltssubsubssubsubgt ltssubsubssubsubgt ltssubsubssubsubgt ltssubsubssubsubgt ltssubsubssubsubgt jsubsub ltssubsubssubsubgt ltssubsubssubsubgt ltssubsubssubsubgtcent br input file contain hamiltonian spin densiti data result output file exampl provid packag pp bodyhtml htmlheadheadbodi hinstal instructionsh p compil fortran compil bla lapack librari requir instal code specifi compil relev compil specif option path bla lapack librari file makefileinclud present src directori relev option gnu intel fortran compil provid arch subdirectori p p bnoteb use gnu fortran compil ensur version newerp pfor fresh instal use follow commandp pre make pre pthi compil ej_calc suscep code place gener execut ej_calc_form ej_calc_spin suscep bin directori outsid src directoryp pfor clean instal use follow commandsp pre make clean make pre p instal complet either copymov content bin folder directori pathway path environ variabl add bin pathway p pin bash bin ad pathway ad path bashrc bash_profil file p pre export pathpathpath_to_jsuscep_directorybin pre pto load chang either restart termin use sourc command p pre sourc bashrc pre porp pre sourc bash_profil pre pto make sure path ad path variabl use follow command check correct path ad path variablep pre echo path pre htest codeh pthe test directori contain test verifi proper compil code run basic test use follow commandp pre make pre pthi run basic test depend upon machin whether compil specif optimis includ compil code execut test may take second minut purpos test suffici verifi valid codep p run comprehens test use follow commandp pre make larg pre pthi run longer test depend upon machin whether compil specif optimis includ compil code execut test may take anytim hour day pto run short comprehens test togeth use follow commandp pre make pre pone also test execut individu use one follow command depend upon code need testedp pre make test_ej_calc_form make test_ej_calc_spin make test_suscep pre pp bodyhtml