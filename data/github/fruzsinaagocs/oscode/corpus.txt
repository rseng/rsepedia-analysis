titl pyoscod fast solut oscillatori ode tag python c numer method ordinari differenti equat author name fruzsina julia agoc orcid affili multipl affili must quot affili name astrophys group cavendish laboratori j j thomson avenu cambridg cb uk index name kavli institut cosmolog madingley road cambridg cb ha uk index date octob bibliographi paperbib summari oscillatori differenti equat ubiquit physic chemistri beyond aris quantum mechan electr circuitri suspens system molecular dynam model gravit electromagnet wave numer solut system howev comput bottleneck tackl convent method avail numer librari present pyoscod generalpurpos numer routin solv class highli oscillatori ordinari differenti equat ode effici packag design solv equat describ singl harmon oscil timedepend frequenc damp term ie form beginequationlabeleqeom gammax omegax endequ frequenc omegax damp gammax term need explicit function x instead eg result anoth numer solut ode suppli sequenc omega_j gamma_j evalu x_i leq x_j leq x_f x_i x_f integr rang pyoscod written c come python wrapper python interfac design similar includ scipi scipi numer ode solut modul demonstr exampl whose output shown autoreffigairi python import numpi np import scipyspeci sp import pyoscod set airi equat exampl xy xs nplinspac ws npsqrtx gs npzeros_likex initi condit xi xf yi spairyxi dyi spairyxi get dens output follow point t_eval nplinspac solv equat solut pyoscodesolvex ws gs xi xf yi dyi t_evalt_ev numer solut airi equat xy pyoscod increas stepsiz pyoscod intern step orang dot due algorithm switch use rk method wkb approxim presenc highfrequ oscil orang segment show dens output solut point comput addit evalu term differenti equat labelfigairyexamplesimagesairypng statement need even term autorefeqeom chang slowli frequenc oscil solut high enough standard numer method struggl solv equat quickli tradit method trace everi oscil solut take mani step x enorm comput cost algorithm underli pyoscod publish oscod base rkwkbhandley detect solut oscillatori switch method base analyt approxim wentzelkramersbrillouin wkb suit oscillatori function otherwis use rungekutta rk method use wkb approxim allow algorithm skip sever wavelength oscil singl step reduc number step taken drastic adapt updat stepsiz keep local numer error within userspecifi toler pyoscod capabl produc solut estim arbitrari valu x intern step therefor use gener continu solut dens output denseoutput relat research softwar pyoscod develop motiv need significantli effici solver evolut earlyunivers quantum fluctuat perturb thought stretch macroscop scale phase acceler expans univers cosmic inflat later becom largescal structur see today understand origin structur therefor essenti model perturb understand physic involv inflat pyoscod use speed numer evolut quantum fluctuat earli univers enabl explor model beyond standard model cosmolog ppscurv serv inspir numer method aim extend rang oscillatori ode solv beyondrkwkb effici solut oscillatori ode longstand numer analysi problem mani exist method handl certain subclass equat exampl includ success method petzold petzold review petzoldreview mani refer therein iserl et al condondeanoiserl deanointegr condonetalcircuit bremer bremer code avail bremercod acknowledg thank luka hergt invalu discuss earli develop pyoscod ongo support construct algorithm would possibl without help guidanc handley mike hobson anthoni lasenbi support scienc technolog facil council stfc refer oscod oscillatori ordinari differenti equat solver imag httpscodecovioghfruzsinaagocsoscodebranchjosspapergraphbadgesvg target httpscodecovioghfruzsinaagocsoscod alt codecov statu imag httpstravisciorgfruzsinaagocsoscodesvgbranchmast target httpstravisciorgfruzsinaagocsoscod alt travi ci build statu imag httpsreadthedocsorgprojectsoscodebadgeversionlatest target httpsoscodereadthedocsioenlatestbadgelatest alt document statu imag httpsbadgesgitterimoscodehelpcommunitysvg target httpsgitterimoscodehelpcommunityutm_sourcebadgeutm_mediumbadgeutm_campaignprbadg alt chat gitter imag httpsimgshieldsiobadgelicensebsdclausebluesvg target httpsopensourceorglicensesbsdclaus alt bsd claus licens imag httpsimgshieldsiopypidmpyoscodecolorindigo target httpspypiorgprojectpyoscod alt pypi download imag httpsjosstheojorgpapersdcefbbefafacdastatussvg target httpsjosstheojorgpapersdcefbbefafacda alt joss statu imag httpszenodoorgbadgedoizenodosvg target httpsdoiorgzenodo alt zenodo doi content local oscod c tool python interfac solv oscillatori ordinari differenti equat effici design deal equat form imag httpsgithubcomfruzsinaagocsoscoderawmasterpyoscodeimagesoscillatorpng gamma friction term omega frequenc given array gamma imag httpsgithubcomfruzsinaagocsoscoderawmasterpyoscodeimagesgammapng omega imag httpsgithubcomfruzsinaagocsoscoderawmasterpyoscodeimagesomegapng oscod make use analyt approxim xt embed step procedur skip long region oscil give reduct comput time approxim valid frequenc chang slowli rel timescal integr therefor worth appli condit hold least part integr rang detail numer method use oscod see citation_ instal depend basic requir use c interfac c later eigen httpeigentuxfamilyorgindexphptitlemain_page__ headeronli librari includ sourc strictli necessari python depend automat instal use pip setuppi numpi httpspypiorgprojectnumpy__ option depend test scipi httpspypiorgprojectscipy__ pytest httpsdocspytestorgenstablegettingstartedhtml__ examplesplot matplotlib httpspypiorgprojectmatplotlib__ scipi httpspypiorgprojectscipy__ gener offlin document sphinx httpspypiorgprojectsphinx__ doxygen httpswwwdoxygennlindexhtml__ breath httpspypiorgprojectbreathe__ exhal httpspypiorgprojectexhale__ python pyoscod instal via pip code bash pip instal pyoscod via setuppi code bash git clone httpsgithubcomfruzsinaagocsoscod cd oscod python setuppi instal user code bash git clone httpsgithubcomfruzsinaagocsoscod cd oscod pip instal import pyoscod anywher omit user option wish instal global virtual environ difficulti check faq instal httpsgithubcomfruzsinaagocsoscodeinstallation__ section check thing work run test also ran travi continu integr code bash pytest test c oscod headeronli c packag requir instal code bash git clone httpsgithubcomfruzsinaagocsoscod includ relev header file c code code c includ solverhpp includ systemhpp quick start tri follow quick exampl avail exampl httpsgithubcomfruzsinaagocsoscodetreemasterexamples__ python introduct pyoscod intro_bind cosmolog exampl cosmology_bind scipi lectur notebook scipy_bind intro_bind imag httpsmybinderorgbadge_logosvg target httpsmybinderorgvghfruzsinaagocsoscodemasterfilepathexamplesintroduction_to_pyoscodeipynb cosmology_bind imag httpsmybinderorgbadge_logosvg target httpsmybinderorgvghfruzsinaagocsoscodemasterfilepathexamplescosmologyipynb scipy_bind imag httpsmybinderorgbadge_logosvg target httpsmybinderorgvghfruzsinaagocsoscodemasterfilepathexamplespyoscode_scipyipynb imag httpsgithubcomfruzsinaagocsoscoderawmasterpyoscodeimagesspectragif width c introduct oscod examplesburstcpp plot result burstcpp examplesplot_burstpi compil run code bash g g wall stdc c bursto burstcpp g g wall stdc burst bursto burst document document host readthedoc httpsoscodereadthedocsio__ build local copi document run code bash cd pyoscodedoc make html citat use oscod solv equat public pleas cite effici method solv highli oscillatori ordinari differenti equat applic physic system httpsdoiorgphysrevresearch__ dens output highli oscillatori numer solut httpsarxivorgabs__ contribut comment improv project welcom contribut open issu httpswwwgithubcomfruzsinaagocsoscodeissues__ report bug propos new featur make pull request help get help submit issu post messag gitter httpsgitterimoscodehelpcommunityutm_sourcebadgeutm_mediumbadgeutm_campaignprbadge__ faq instal eigen import error code bash pyoscode_pyoscodehpp fatal error eigendens file directori includ eigendens tri explicitli includ locat eigen librari via cplus_include_path environ variabl exampl code bash cplus_include_pathusrincludeeigen python setuppi instal user cplus_include_pathusrincludeeigen pip instal pyoscod usrincludeeigen replac systemspecif eigen locat thank mani thank handley luka hergt anthoni lasenbi mike hobson support advic regard algorithm behind oscod mani packag without part oscod eg test exampl wouldnt run nice smoothli thank develop make maintain opensourc project special thank goe dev exhal httpspypiorgprojectexhale__ make beauti c document possibl changelog set minim requir numpi version numpi drop python support instead support addit paper accept joss fix get correct numpi includ directori ad pyprojecttoml handl build depend numpi dens output array frequenc damp term need evenli space automat c document readthedoc eigen includ sourc pip instal first pip releas bug occur begin end integr coincid correct automat detect direct integr memori leak python interfac fix c document ad titl oscod c interfac use c interfac oscod sectnum overview document illustr one use oscod via c interfac usag oscod involv defin equat solv solv equat extract solut statist run next section cover complet refer see docc interfac referencecppdocsoscoderefer page exampl see exampl httpsgithubcomfruzsinaagocsoscodetreemasterexamples__ directori github defin equat equat oscod use solv form math ddotxt gammatdotxt omegatxt mathxt mathgammat mathomegat complex call matht independ variabl mathx depend variabl mathomegat frequenc term mathgammat friction firstderiv term defin equat via give frequenc mathomegat give firstderiv term mathgammat defin frequenc firstderiv term either done give function explicitli give sequenc evalu grid matht mathomega mathgamma explicit function mathomega mathgamma closedform function time defin code c includ solverhpp de_system solut defin stdcomplexdoubl gdoubl return stdcomplexdoubl wdoubl return stdpow tt feed solver via de_system class code c de_system sysw g solut solutionsi argument left mathomega mathgamma time seri sometim mathomega mathgamma result numer integr closedform function form case specifi grid oscod perform linear interpol given grid find valu timepoint import thing note oscod assum grid timepoint mathomega mathgamma evenli space grid evenli sampl set eventru call de_system speed linear interpol significantli timepoint grid need monoton increas timepoint grid need includ rang integr matht_imatht_f grid timepoint frequenc firstderiv term size speedeffici solver depend accur carri numer integr frequenc firstderiv term therefor grid fine need high enough typic mean linear interpol give mathomegat valu accur part math want oscod check whether grid sampl fine enough set check_gridtru call de_system defin grid use arraylik contain contigu memori eg eigenvector stdarray stdvector code c includ solverhpp de_system solut defin creat fine grid timepoint grid valu w g n stdvectordoubl tsn stdvectorstdcomplexdoubl wsn gsn fill grid forint tsi wsi stdsqrti gsi given solver feed pointer underli data de_system class code c de_system systsdata wsdata gsdata solut solutionsi argument left often mathomega mathgamma much easier perform linear interpol taken natur log option islogw islogg argument overload de_systemde_system constructor code c includ solverhpp de_system solut defin creat fine grid timepoint grid valu w g n stdvectordoubl tsn stdvectorstdcomplexdoubl logwsn gsn note log fill grid forint tsi logwsi gsi log want tell de_system w taken natur log g hasnt therefor islogwtru isloggfals de_system systsdata logwsdata gsdata true fals solut solutionsi argument left diy interpol problem linear interpol mathomega mathgamma natur log might simpli enough exampl user could carri cubic spline interpol feed mathomega mathgamma function de_system anoth exampl want linear interpol outsid oscod solutionsolv ran loop iter larg grid mathomega mathgamma requir depend paramet instead gener one could defin function make use underli vector independ paramet iter code c b c larg stdvector run k paramet differ run grid timepoint w g defin start tstart evenli space space tinc tstart tinc b c defin stdcomplexdoubl gdoubl int iintttstarttinc stdcomplexdoubl g kkai bi cik stdcomplexdoubl g kkai bi cik return gggttstarttincitinc solv equat equat solver defin instanc de_system class follow addit inform necessari solv initi condit mathxt_i mathdotxt_f rang integr matht_i matht_f option set timepoint dens output requir option order wkb approxim use order option rel toler rtole option absolut toler atol option initi step h_ option output file name full_output note follow option argument rtol atol toler local error global error solut guarante stay valu error per step rk regim oscillatori solut global error rise toler limit wkb regim global error usual stagnat initi step thought initi estim first stepsiz solver determin largest possibl step within given toler limit chang h_ necessari full output solv written filenam contain full_output specifi here exampl illustr usag variabl code c includ solverhpp de_system solut defin defin system de_system sy arg see previou exampl necessari paramet initi condit stdcomplexdoubl xstdcomplexdoubl dx rang integr doubl ti tf option paramet dens output requir follow point int n stdvector t_evaln forint t_evali order wkb approxim use int order toler doubl rtole atol initi step doubl h write solut file stdstring outfileoutputtxt solut solutionsi x dx ti tf t_evaldata order rtol atol h outfil solv equat solutionsolv weve also call solv method solut class carri integr inform solut solut written outputtxt use solut let break solut contain solutionsolv return instanc solut object return follow attribut time stdlist doubl timepoint solut determin suppli user rather intern step solver take list start matht_i end matht_f point alway guarante includ sol stdlist stdcomplexdoubl solut timepoint specifi time dsol stdlist stdcomplexdoubl first deriv solut timepoint specifi time wkb stdlist intbool type step take timepoint time step wkb rk sstep int total number accept step totstep int total number attempt step accept reject wkbstep int total number success wkb step x_eval stdlist stdcomplexdoubl dens output ie solut evalu point specifi t_eval option argument dx_eval stdlist stdcomplexdoubl dens output deriv solut evalut point specifi t_eval option argument pyoscod automodul pyoscod member undocmemb showinherit pyoscod document toctre maxdepth caption content introduct introduct python interfac refer pyoscod use c interfac oscod c interfac refer cppdocsoscoderefer titl introduct pyoscod oscillatori ordinari differenti equat solver imag httpscodecovioghfruzsinaagocsoscodebranchjosspapergraphbadgesvg target httpscodecovioghfruzsinaagocsoscod imag httpstravisciorgfruzsinaagocsoscodesvgbranchmast target httpstravisciorgfruzsinaagocsoscod alt travi ci build statu imag httpsreadthedocsorgprojectsoscodebadgeversionlatest target httpsoscodereadthedocsioenlatestbadgelatest alt document statu imag httpsbadgesgitterimoscodehelpcommunitysvg target httpsgitterimoscodehelpcommunityutm_sourcebadgeutm_mediumbadgeutm_campaignprbadg alt chat gitter imag httpsimgshieldsiobadgelicensebsdclausebluesvg target httpsopensourceorglicensesbsdclaus alt bsd claus licens content local oscod c tool python interfac solv oscillatori ordinari differenti equat effici design deal equat form math ddotxt gammatdotxt omegatxt mathgammat mathomegat given array oscod make use analyt approxim mathxt embed step procedur skip long region oscil give reduct comput time approxim valid frequenc mathomegat chang slowli rel timescal integr therefor worth appli condit hold least part integr rang detail numer method use oscod see citat section instal depend basic requir use c interfac c later eigen httpeigentuxfamilyorgindexphptitlemain_page__ headeronli librari includ sourc strictli necessari python depend automat instal use pip setuppi numpi httpspypiorgprojectnumpy__ option depend test scipi httpspypiorgprojectscipy__ pytest httpsdocspytestorgenstablegettingstartedhtml__ examplesplot matplotlib httpspypiorgprojectmatplotlib__ scipi httpspypiorgprojectscipy__ gener offlin document sphinx httpspypiorgprojectsphinx__ doxygen httpswwwdoxygennlindexhtml__ breath httpspypiorgprojectbreathe__ exhal httpspypiorgprojectexhale__ python pyoscod instal via pip code bash pip instal pyoscod via setuppi code bash git clone httpsgithubcomfruzsinaagocsoscod cd oscod python setuppi instal user import pyoscod anywher omit user option wish instal global virtual environ difficulti check faqs_ section check thing work run test also ran travi continu integr code bash pytest test c oscod headeronli c packag requir instal code bash git clone httpsgithubcomfruzsinaagocsoscod includ relev header file c code code c includ solverhpp includ systemhpp quick start tri follow quick exampl avail exampl httpsgithubcomfruzsinaagocsoscodetreemasterexamples__ python introduct pyoscod intro_bind cosmolog exampl cosmology_bind intro_bind imag httpsmybinderorgbadge_logosvg target httpsmybinderorgvghfruzsinaagocsoscodejosspaperfilepathexamplesintroduction_to_pyoscodeipynb cosmology_bind imag httpsmybinderorgbadge_logosvg target httpsmybinderorgvghfruzsinaagocsoscodejosspaperfilepathexamplescosmologyipynb imag httpsgithubcomfruzsinaagocsoscoderawmasterpyoscodeimagesspectragif width c introduct oscod examplesburstcpp plot result burstcpp examplesplot_burstpi compil run code bash g g wall stdc c bursto burstcpp g g wall stdc burst bursto burst document document host readthedoc httpsoscodereadthedocsio__ build local copi document run code bash cd pyoscodedoc make html citat use oscod solv equat public pleas cite effici method solv highli oscillatori ordinari differenti equat applic physic system httpsdoiorgphysrevresearch__ dens output highli oscillatori numer solut httpsarxivorgabs__ contribut comment improv project welcom contribut open issu httpswwwgithubcomfruzsinaagocsoscodeissues__ report bug propos new featur make pull request help get help submit issu post messag gitter httpsgitterimoscodehelpcommunityutm_sourcebadgeutm_mediumbadgeutm_campaignprbadge__ faq instal eigen import error code bash pyoscode_pyoscodehpp fatal error eigendens file directori includ eigendens tri explicitli includ locat eigen librari via cplus_include_path environ variabl exampl code bash cplus_include_pathusrincludeeigen python setuppi instal user cplus_include_pathusrincludeeigen pip instal pyoscod usrincludeeigen replac systemspecif eigen locat thank mani thank handley luka hergt anthoni lasenbi mike hobson support advic regard algorithm behind oscod mani packag without part oscod eg test exampl wouldnt run nice smoothli thank develop make maintain opensourc project special thank goe dev exhal httpspypiorgprojectexhale__ make beauti c document possibl changelog current version dens output array frequenc damp term need evenli space automat c document readthedoc eigen includ sourc pip instal first pip releas bug occur begin end integr coincid correct automat detect direct integr memori leak python interfac fix c document ad