titl pygrb pure python gammaray burst analysi packag tag python astrophys cosmolog gammaray burst gravit lens author name jame r paynter orcid affili affili name school physic univers melbourn parkvil victoria australia index date juli bibliographi paperbib introduct gammaray burst grb short intens burst low energi kev mev gamma radiat cosmolog origin transient natur make import probe univers structur sinc discoveri astronom sought model high energi emiss popular endur model although phenomenolog fastris exponentialdecay fred puls norri norri stadeltatauxi exp left xi left fract deltatau fractautdelta right right statement need analysi larg amount lightcurv requir download fit file relev server hand tire prospect grb observ burst transient sourc explor bats experi bats download fit file scientist would need unpack data file extract relev tabl construct lightcurv may want plot lightcurv public requir write softwar appropri repres data ultim may want look popul statist compar differ grb puls gap market softwar get research ground quickli pygrb come pygrb pygrb pure python open sourc pulsefit packag aim bring gammaray burst lightcurv fit analysi st centuri pygrb abl download prebin bats light curv bfit file addit tte_list timetag photon arriv time fit io function provid astropi astropi pygrb built top bilbi bayesian infer librari bilbi pygrb utilis dynesti dynesti nestl nestl nest sampl packag skill feroz multinest pygrb make visual appeal scientif instruct lightcurv four broadband energi channel bats data main featur pygrb abil fit analyt lightcurv model data particular bayesian model select allow user determin appropri puls parameteris particular burst avail puls parameteris gaussian puls fred puls fred variat residu fit addit possibl implement sinegaussian function bats trigger grb fred fit pygrbdocssourceimagesb___d_nl__rates_fpng ultim model select pygrb use determin two lightcurv statist ident would indic gravit lens event paczynski blae mao quit difficult compar grb lightcurv occur differ time due variabl gammaray background compar grb observ differ satellit anoth matter altogeth owe differ energi sensit time resolut detector geometri pygrb creat unifi abstract framework allow comparison gammaray burst base fit puls paramet rather visual binwis statist comparison lightcurv inher fraught opportun mishap present releas bats function avail howev due modular natur code includ addit grb catalogu simpl creat relev fetch preprocess modul futur releas allow easi comparison gammaray burst observ differ satellit pygrb open sourc commun activ encourag contribut function mani avail grb catalogu pygrb releas bsd claus licens sourc code may found httpsgithubcomjamespaynterpygrb altern packag may instal pypi via pip instal pygrb onlin document tutori exampl host httpspygrbreadthedocsio acknowledg would like thank rachel webster introduc problem gravit lens gammaray burst spawn project would like thank eric thrane introduc modern comput statist particularli bilbi whose shoulder packag stand addit would like thank julian carlin aman chokshi support journey novic programm publish develop refer joss doi pypi version travi coverag doc astropi imag httpsgithubcomjamespaynterpygrbblobmasterdocssourceimageslogopng align center alt pygrb logo inclusionmarkeronelinerstart gammaray burst grb lightcurv analysi packag inclusionmarkeronelinerend inclusionmarkerwhatitdoesstart introduct pygrb packag download gammaray burst grb fit file relev data archiv eg nasa hearsac moment bats httpsheasarcgsfcnasagovftpcomptondatabatse__ data download analys softwar although slight tweak grb satellit easili analys code abl creat lightcurv either prebin data timetag photonev data lightcurv may fit puls model analysi model fit done nest sampl power bilbi httpslscsoftdocsligoorgbilbyindexhtml__ dynesti httpsdynestyreadthedocsio__ andor nestl httpsgithubcomkbarbarynestle__ instal pygrb may instal manual clone repositori codeblock consol git clone httpsgithubcomjamespaynterpygrb cd pygrb pip instal r requirementstxt pip instal download compil version pypi httpspypiorgprojectpygrb__ codeblock consol pip instal pygrb instal pygrb depend take longer coupl minut import pygrb import pygrb inclusionmarkerwhatitdoesend inclusionmarkerpulsetypesstart puls type descript grb puls phenomenolog imag httpsgithubcomjamespaynterpygrbblobmasterdocssourceimagesequationsfredgif align center alt fred eqn exp xi left fract deltatau fractautdelta right inclusionmarkerpulsetypesend see document httpspygrbreadthedocsioenlatestuserpulseshtml__ role pythoncod languag python imag httpsgithubcomjamespaynterpygrbblobmasterdocssourceimagesbatse_trigger__rates_ratespng align center alt bats trigger usag inclusionmarkerusagestart say would like fit grb lightcurv determin puls paramet first must load relev modul codeblock python pygrbmainfitpuls import pulsefitt pygrbbackendmakemodel import create_model_from_key pythonpulsefitt class main workhors softwar codeblock python grb pulsefitt time datatyp discsc nsampl sampler nestl priors_pulse_start priors_pulse_end first argument specifi bats trigger analys case trigger time either specifi pythont pythonful tupl start end time case trigger action happen choos interv time pythonnsampl paramet determin mani live point nest sampler initi pythonsampl paramet use choos sampler pythonpriors_pulse_start pythonpriors_pulse_end paramet use set uniform interv program allow puls start time pythondatatyp paramet specifi kind data would like download analys typic pythondiscsc use pythontt better short grb data download store codedata pythoncreate_model_from_key allow us specifi puls model base simpl key simpl puls type fastris exponentialdecay fred puls utilis codeblock python key f model create_model_from_keykey final run model sampler codeblock python grbmain_multi_channelchannel model model data product store codeproduct inclusionmarkerusageend left lightcurv look like imag httpsgithubcomjamespaynterpygrbblobmasterdocssourceimagesb___d_nl__rates_fpng align center alt bats trigger see document httpspygrbreadthedocsioenlatestuserusagehtml__ hood imag httpsgithubcomjamespaynterpygrbblobmasterdocssourceimagespulse_fit_animationgif align center alt grb lightcurv fit anim typo anim two fraction take sign amplitud normalis factor see document httpspygrbreadthedocsioenlatestusersamplinghtml__ contribut pygrb opensourc softwar packag freeli avail bsd claus licens user may request new featur open github issue_ may contribut addit improv via pull request similarli run problem use pygrb requir technic support hesit request support github issue_ use pygrb work would like collabor grb gravit lens would will discuss email github issue_ incomplet list possibl improv includ support uneven bin size data gap includ compat grb catalogu publicli avail swift bat httpsswiftgsfcnasagovresultsbatgrbcat__ fermi gbm httpsheasarcgsfcnasagovftpfermidatagbmbursts__ konu wind httpsgcngsfcnasagovkonus_grbshtml__ includ capabl download plot grb spectra addit lightcurv increas coverag _github issu httpsgithubcomjamespaynterpygrbissu astropi imag httpimgshieldsiobadgepoweredbyastropyorangesvgstyleflat target httpwwwastropyorg alt astropi travi imag httpstraviscicomjamespaynterpygrbsvgbranchmast alt travi badg target httpstraviscicomjamespaynterpygrb coverag imag httpscodecovioghjamespaynterpygrbbranchmastergraphbadgesvg target httpscodecovioghjamespaynterpygrb alt codecov coverag statu doc imag httpsreadthedocsorgprojectspygrbbadgeversionlatest target httpspygrbreadthedocsioenlatestbadgelatest alt document statu pypi imag httpsbadgefuryiopypygrbsvg target httpsbadgefuryiopypygrb version imag httpsimgshieldsiopypipyversionspygrbsvg target httpspypiorgprojectpygrb joss imag httpsjosstheojorgpapersaffeecbaaaaastatussvg target httpsjosstheojorgpapersaffeecbaaaaa doi imag httpszenodoorgbadgesvg target httpszenodoorgbadgelatestdoi welcom pygrb document instruct use packag provid user document higher level api inform find api refer refuserdoc refapidoc _userdoc toctre maxdepth caption user document userreadm userusag userpuls usersampl useranalysi _apidoc toctre maxdepth caption api refer apipygrbbackend apipygrbfetch apipygrbmain apipygrbpostprocess apipygrbpreprocess indic tabl refgenindex refmodindex refsearch usag role pythoncod languag python figur imagesbatse_trigger__rates_ratespng figwidth width align center alt bats trigger bats trigger includ readmerst startaft inclusionmarkerusagestart endbefor inclusionmarkerusageend complet script tutori literalinclud examplesbasicpi name basicpi caption basicpi someth like follow print consol codeblock consol bilbi info singl likelihood evalu took e bilbi info use sampler nestl kwarg method multi npoint update_interv none npdim none maxit none maxcal none dlogz none decline_factor none rstate none callback function print_progress xfae step enlarg logz bilbi info sampl time bilbi info summari result nsampl log_noise_evid nan log_evid log_bayes_factor nan total number posterior sampl nsampl instanc length posterior chain access code block bottom page log_noise_evid use bilbi gravit wave infer irrelev pygrb pygrb poisson likelihood specifi addit nois model log_evid bayesian evid support data given specifi model bay factor comparison evid two model log_bayes_factor nan one model specifi comparison made pygrb model comparison extern inbuilt bilbi function error like follow ignor codeblock consol runtimewarn overflow encount multipli bad evalu likelihood real effect result unlik event happen consist may mean sampler stuck bad region paramet space restart sampler particular evalu fix problem creat three set file product directori nest sampl posterior chain store json file corner plot posterior higher data product lightcurv individu channel includ default analysi lightcurv fit residu test goodnessoffit put subdirectori base trigger number number live point file exampl found products_model_comparison_ figur imagesb___d_nl__rates_fpng figwidth width align center alt bats trigger bats trigger fred fit figur imagestriggerchanpng figwidth width align center alt bats trigger channel bats trigger fred puls fit singl channel channel green shade region sigma statist poisson uncertainti correlogram visualis autocorrel residu second panel good fit one expect point lie within confid interv interest note case sinusoid structur way end puls even though deviat fit larg probabl plot test diverg residu zero normal see residu normal distribut good approxim figur imagestriggerpostpng figwidth width align center alt bats trigger channel corner plot bats trigger fred puls fit singl channel channel posterior corner plot paramet space undersampl posterior histogram patchi matter sinc tutori illustr purpos answer initi question puls paramet may read straight posterior distribut access posterior chain json file follow code block could append end basicpi codeblock python pick channel analys channel creat right filenam open result_label fgrbfstringgrbclabelschannel open_result fgrboutdirresult_label_resultjson result bilbyresultread_in_resultfilenameopen_result channel paramet subscript _a paramet background_a posterior sampl access result object posterior_sampl resultposteriorparametervalu find median import numpi np posterior_samples_median npmedianposterior_sampl figur imageslogopng figwidth width align center alt pygrb logo includ readmerst startaft inclusionmarkerwhatitdoesstart endbefor inclusionmarkerwhatitdoesend note run pygrb implicitli import bilbi use bayesian infer sinc bilbi primarili use gravit wave infer import bilbi check instal gwpi lalsuit result follow warn instal codeblock consol bilbi warn gwpi instal current abl use prebuilt function bilbi warn lalsuit instal current abl use prebuilt function bilbi warn gwpi instal current abl use prebuilt function bilbi warn lalsuit instal current abl use prebuilt function bilbi warn gwpi instal current abl use prebuilt function bilbi warn lalsuit instal current abl use prebuilt function bilbi warn lalsuit instal current abl use prebuilt function effect run pygrb _sampl sampl figur imagespulse_fit_animationgif figwidth width align center alt grb lightcurv fit anim anim nest sampl converg channel bats trigger fred puls fit equat nest sampl anim read math stadeltatauxi exp left xi left fract deltatau fractautdelta right right photon count photon emiss stochast process mean number photon emit time interv matht math left nt right lambda mathleft nt right expect valu mathn integr time poisson rate mathlambda probabl distribut random variabl mathn math prnt n fraclambda tn elambda tn photon mathvecgammagamma_ gamma_ ldot gamma_n emit via homogen poisson process mathlambdatlambda interarriv time photon mathgamma_i mathgamma_i exponenti distribut interarriv time photon mathgamma_i mathgamma_ik follow gamma distribut math x sim gammak lambda mathk recov exponenti distribut math x sim exp lambda high energi detector like bats accumul photon discret multipl clock cycl sampl frequenc bats sampl frequenc khz clock cycl mathmu detector record photon arriv time timetag event tte nearest integ multipl clock cycl bats hardwar limit restrict first larg area detector lad event inclus detector shortest moder bright mathgammaray burst contain complet within tte data tte period exhaust bats count collect ms interv discrimin scienc data discsc mathsim second trigger figur imagestpng figwidth width align center alt bats trigger bats trigger short bright mathgammaray burst tte data cut event note pretrigg tte data avail lad posttrigg tte data avail trigger detector bats sum count trigger detector aboard satellit convert rate unit count per second divid integr time bin width use poisson statist pygrb convert rate back count multipli bin width forc integ take account detector deadtim see use rate rather count would underestim uncertainti radiat field sinc poisson distribut math sigma_textpoissonsim sqrtn true poisson process occur detector photon arriv time convolv respons detector result poisson distribut count spectrum due onboard sum across trigger detector forc appli poisson statist sum count rather count detector mathgammaray burst complet resolv tte data possibl analys count detector howev sinc pygrb main focu analysi discsc data prebin sum trigger detector yet implement entir possibl run program independ trigger detector tte data yet unifi jointlikelihood framework consid singl radiat field across detector dead time bats small dead time photon count approxim one clock cycl dead time proport energi incid photon particl event trigger count citejgragjesteland math tau sim alpha ln frace_gammae_ mathe_gamma energi incid photon mathe_ kev reset level detector mathalpha mathmu signal decay time citegeorlgrefenstett mean photon count true poisson process count rate approach sampl frequenc rather follow truncat poisson distribut poisson rate rate pass likelihood function sum individu puls specifi refpuls exampl rate two fred puls would math beginsplit sta_delta_tau_xi_a_delta_tau_xi_ a_ exp left xi_ left fract delta_tau_ fractau_tdelta_ right right a_ exp left xi_ left fract delta_tau_ fractau_tdelta_ right right endsplit background background default model constant suffici longest gammaray burst except period unusu high background variabl complex background model polynomi includ specifi rate function includ relev prior complet rate math beginsplit sta_delta_tau_xi_a_delta_tau_xi_ b a_ exp left xi_ left fract delta_tau_ fractau_tdelta_ right right a_ exp left xi_ left fract delta_tau_ fractau_tdelta_ right right endsplit likelihood rate function pass poisson likelihood sum specifi rate prior default prior paramet minimum maximum type unit mathdelta_i uniform second mathdelta_i mathdelta_i uniform second mathb math math loguniform count bin matha math math loguniform count bin mathtau math math loguniform second mathxi math math loguniform mathgamma math math loguniform mathnu math math loguniform mathdelta_textr uniform second matha_textr math math loguniform count bin mathtau_textr math math loguniform count bin mathomega math math loguniform mathvarphi mathpi mathpi uniform radian prior mathdelta_i mathdelta_textr determin length lightcurv pass pulsefitt read nest sampl reader refer follow link httpslscsoftdocsligoorgbilbybasicsofparameterestimationhtml httpsdynestyreadthedocsioenlatestoverviewhtml httpsdynestyreadthedocsioenlatestdynamichtml bats data type timetospil tt refer bats appendix g httpsheasarcgsfcnasagovdocscgronraappendix_ghtmlvbatseguestinvestigatorprogram_ bibliographi refsbib style unsrt applic gravit lens softwar packag creat intent discern similar look gammaray burst statist ident gammaray burst pair statist ident gammaray burst would indic gravit lens event materi present supplementari research paper current review script use pygrb packag allow reader reproduc result paper enough comput power toctre caption applic candid lens grb grb grbwalk grbext grbprior _puls puls type role pythoncod languag python standard gammaray burst look like figur imagesbatse_trigger__rates_ratespng figwidth width align center alt bats trigger bats trigger gaussian puls simpl puls parameteris one might imagin gaussian like use model emiss line eg quasar spectra equat gaussian puls math stadeltasigma exp left fracleft delta rightsigma right figur imagesb___d_nl__rates_gpng figwidth width align center alt bats trigger gaussian fit bats trigger gaussian fit howev immedi see puls parameteris catch fast rise grb puls slow decay residu consist structur fred puls standard puls parameteris use model gammaray burst fastris exponentialdecay fred curv math stadeltatauxi exp left xi left fract deltatau fractautdelta right right figur imagesb___d_nl__rates_fpng figwidth width align center alt bats trigger fred fit bats trigger fred fit fit better gaussian structur unaccount residu fredx puls tri extend fastris exponentialdecay model fredx math stadeltatauxigammanu exp left xigamma leftfract deltataurightgamma xinu leftfractautdeltarightnuright figur imagesb___d_nl__rates_xpng figwidth width align center alt bats trigger fredx fit bats trigger fredx fit element structur residu persist sinegaussian residu use sinegaussian residu function account residu math textrest a_textr exp left leftfractdelta_textr lambda_textresright right cosleftomega varphi right figur imagesb___d_nl__rates_xpng figwidth width align center alt bats trigger fred fit sinegaussian residu bats trigger fred fit sinegaussian residu implement yet model select script say would like fit model turn lightcurv creat model specifi list key gaussian fred fredx puls key follow codeblock python key g f x residu includ place lower case python follow puls appli residu must appli follow puls use standalon let add addit three puls fit residu list key codeblock python key gs fs xs complet list would look like codeblock python key g f x gs fs xs need convert key model nest sampl analysi codeblock python model_dict key key model_dictkey create_model_from_keykey model model key model model_dictitem final feed model turn sampler pythonmain_multi_channel function split model case test channel individu codeblock python model model grbmain_multi_channelchannel model model complet script tutori literalinclud examplesintermediatepi name intermediatepi caption intermediatepi model select script output set tabl look someth like follow residu model includ comput breviti channel model ln z error ln bf g f x channel model ln z error ln bf g f x channel model ln z error ln bf g f x channel model ln z error ln bf g f x tell us fredx model prefer case channel _prior role pythoncod languag python grb prior investig effect prior model select follow script test effect prior mathgamma mathnu model select compar model differ prior rang longer time period save two model dict differ name eg codeblock python key key_ key_ model_dictmodel create_model_from_keykey_ model_dictmodel create_model_from_keykey_ model model key model model_dictitem utlis prior test script literalinclud examplesgravlensnaturepriorspi name gravlensnaturepriorspi caption gravlensnaturepriorspi find _ role pythoncod languag python grb basic analysi figur imagestriggerpng figwidth width align center alt bats trigger fred len fit bats trigger fred len fit script compar two simplest puls model gravit lens event grb literalinclud examplesgravlensnaturebasicpi name gravlensnaturebasicpi caption gravlensnaturebasicpi channel model ln z error ln bf fl ff channel model ln z error ln bf fl ff channel model ln z error ln bf fl ff channel model ln z error ln bf fl ff total ln evid favour lens consid strong evid thu gammaray burst warrant investig figur imagesb__yl__delmu_deltpng figwidth width align center alt bats trigger magnif ratio time delay posterior histogram bats trigger magnif ratio time delay posterior histogram magnif ratio time delay concord one would expect gravit lens event figur imagesb__yl__masspng figwidth width align center alt bats trigger len mass posterior histogram bats trigger len mass posterior histogram infer len mass suggest intermedi mass black hole gravit deflector _ext role pythoncod languag python grb natur script figur imagestriggerpng figwidth width align center alt bats trigger fred len fit bats trigger fred len fit literalinclud examplesgravlensnaturepi name gravlensnaturepi caption gravlensnaturepi _walk role pythoncod languag python grb code walkthrough figur imagestriggerpng figwidth width align center alt bats trigger fred len fit bats trigger fred len fit walkthrough first attempt fit possibl combin puls type find strong major case lens model prefer model two individu puls import codeblock python import numpi np pygrbmainfitpuls import pulsefitt pygrbbackendmakemodel import create_model_from_key set pythonpulsefitt object codeblock python sampler dynesti nsampl grb pulsefitt time datatyp tte nsampl nsampl sampler sampler priors_pulse_start priors_pulse_end priors_td_lo priors_td_hi note rare instanc code choos fit small residu quit late nois gravit len nois case one fit len model better choic start time prior might pythonpriors_pulse_end set model fit lightcurv pythonlens_key singl puls gravit lens lightcurv duplic time delay rescal magnif ratio pythonnull_key two puls codeblock python lens_key fl fsl xl xsl null_key ff fsf xx xsx key lens_key null_key model_dict key key model_dictkey create_model_from_keykey model model key model model_dictitem run model fit code codeblock python model model grbmain_multi_channelchannel model model parallelis parallelis done use indic paramet use send one channel one model differ cpu cluster differ would chang last two line code codeblock python emphasizelin model x channel separ nest sampl run cheapli parallelis send run differ cpu lens_key fl fsl xl xsl null_key ff fsf xx xsx key lens_key null_key model_dict key key model_dictkey create_model_from_keykey model model key model model_dictitem indic nparang grb_split_array_job_to__channelsmodel model indic indic channel exampl slurm batch submiss script found devjam branch repositori sever day hpc hope job finish paramet longer job take pythonfsf pythonxsx model paramet may take week depend chosen pythonnsampl sampler keyword argument higher level analysi done pymethpygrbpostprocessmake_evidence_tablesget_evidence_from_model method codeblock python grbget_evidence_from_modelsmodel_dict model_dict creat plot gravit lens paramet use pythonlens_calc method codeblock python model model lens_bound grblens_calcmodel model lens_bound lens_bound creat follow two plot figur imagesb__yl__delmu_deltpng figwidth width align center alt bats trigger magnif ratio time delay posterior histogram bats trigger magnif ratio time delay posterior histogram magnif ratio time delay concord one would expect gravit lens event figur imagesb__yl__masspng figwidth width align center alt bats trigger len mass posterior histogram bats trigger len mass posterior histogram infer len mass suggest intermedi mass black hole gravit deflector _ role pythoncod languag python grb figur imagesbatse_trigger__rates_ratespng figwidth width align center alt bats trigger bats trigger literalinclud examplesgravlenspi name gravlenspi caption gravlenspi channel red model ln z error ln bf fl ff channel orang model ln z error ln bf fl ff channel green model ln z error ln bf fl ff channel blue model ln z error ln bf fl ff see bayesian evid strongli prefer two puls model note want fit two puls one fred one fredx know order would like fit eg two puls overlap need fx model xf model best fit model one higher bayesian evid order puls automat encod prior result unimod degener case eg ff pygrbpostprocess packag pygrbpostprocessabp modul automodul pygrbpostprocessabp member undocmemb showinherit pygrbpostprocessmake_evidence_t modul automodul pygrbpostprocessmake_evidence_t member undocmemb showinherit pygrbpostprocessplot_analysi modul automodul pygrbpostprocessplot_analysi member undocmemb showinherit pygrbpostprocessplot_gl_posterior modul automodul pygrbpostprocessplot_gl_posterior member undocmemb showinherit pygrbfetch packag pygrbfetchget_bats modul automodul pygrbfetchget_bats member undocmemb showinherit pygrbbackend packag pygrbbackendadmin modul automodul pygrbbackendadmin member undocmemb showinherit pygrbbackendmakekey modul automodul pygrbbackendmakekey member undocmemb showinherit pygrbbackendmakemodel modul automodul pygrbbackendmakemodel member undocmemb showinherit pygrbbackendmakeprior modul automodul pygrbbackendmakeprior member undocmemb showinherit pygrbbackendmultiprior modul automodul pygrbbackendmultiprior member undocmemb showinherit pygrbbackendrate_funct modul automodul pygrbbackendrate_funct member undocmemb showinherit pygrbbackendrateclass modul automodul pygrbbackendrateclass member undocmemb showinherit pygrbpreprocess packag pygrbpreprocessbatsepreprocess modul automodul pygrbpreprocessbatsepreprocess member undocmemb showinherit pygrbpreprocessgrb_class modul automodul pygrbpreprocessgrb_class member undocmemb showinherit pygrbpreprocessabstract modul automodul pygrbpreprocessabstract member undocmemb showinherit pygrbpreprocessgrb modul automodul pygrbpreprocessgrb member undocmemb showinherit pygrbpreprocesssimulated_grb modul automodul pygrbpreprocesssimulated_grb member undocmemb showinherit pygrbmain packag pygrbmainfitpuls modul automodul pygrbmainfitpuls member undocmemb showinherit