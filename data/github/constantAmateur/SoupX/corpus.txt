soupx r packag estim remov cell free mrna contamin droplet base singl cell rnaseq data problem packag attempt solv droplet base singl cell rnaseq experi also captur ambient mrna present input solut along cell specif mrna interest contamin ubiquit vari huge experi although around seem reason common there way know advanc contamin experi although solid tumour lowviabl cell tend produc higher contamin fraction sourc contamin mrna lyse cell input solut profil contamin experi specif produc batch effect even decid dont want use soupx correct method whatev reason least want know contamin data note v onward soupx includ option automat estim contamin fraction anticip prefer way use method vast major user function autoestcont depend cluster inform provid use x data map cellrang load automat otherwis must provid explicitli user use setclust instal latest stabl releas instal cran usual way run r installpackagessoupx want use latest develop version instal run r devtoolsinstall_githubconstantamateursoupxrefdevel final want use percel contamin estim almost certainli wont need instal branch stan r devtoolsinstall_githubconstantamateursoupxrefstan encount error say multtest unavail pleas instal manual bioconductor r biocmanagerinstallmulttest quickstart decontamin one channel x data map cellrang run r sc loadxpathtoyourcellrangeroutsfold sc autoestcontsc adjustcountssc manual load decontamin data r sc soupchanneltable_of_dropletstable_of_count sc setclusterssccluster_label sc autoestcontsc adjustcountssc contain correct matrix use place origin tabl count downstream analys document methodolog implement packag explain detail paperhttpsdoiorggigasciencegiaa detail vignett provid packag view herehttpsrawcdngithackcomconstantamateursoupxbdfefdbbabcfeinstdocpbmctutorialhtml cite soupx use soupx work pleas cite young md behjati soupx remov ambient rna contamin dropletbas singlecel rna sequenc data gigasci volum issu decemb giaabiorxiv httpsdoiorggigasciencegiaa frequent ask question im get error autoestcont unrealist estim automat estim contamin implement autoestcont make assumpt suffici divers raw data identifi marker gene gene commonli use estim contamin data either extrem homogen ie one cell type exampl cell line number cell low hundr less assumpt unlik hold situat think hard realli want includ data sever limit your sure best approach probabl manual specifi contamin fraction line would expect similar experi data still look contamin didnt soupx work first thing check provid cluster inform either cluster run setclust adjustcount load automat loadx cluster inform allow far contamin identifi safe remov second thing consid contamin rate estim look plausibl estim contamin rate part method requir user input prone error gener contamin rate less low usual moder high cours experi may vari expect base fresh tissu experi x platform final note soupx design tri err side throw real count case import remov contamin sure youv retain true count particularli true overremov remov express truli express gene unless set overremov someth extrem describ situat may want tri manual increas contamin rate set setcontaminationfract see improv result cant find good set gene estim contamin fraction gener gene set work best set gene highli specif cell type present data low frequenc think hb gene erythrocyt ig gene bcell tpsbtpsab mast cell etc tri anyth esoter usual good idea least tri commonli success gene set particularli hb gene fail plotmarkerdistribut function use get inspir describ vignett yield noth suggest tri rang correct see effect downstream analysi experi experi somewher contamin estimatenonexpressingcel cant find cell use estim contamin point assum chosen set set gene use estim contamin default behaviour x data look cell strong evid endogen express gene set cell exclud cluster cell strong evid endogen express conserv behaviour design stop overestim contamin fraction sometim make estim difficult cluster least one cell look bad option reclust data produc cluster fewer cell per cluster prefer option requir work user part make criteria declar cell genuin express gene set less strict seldom work usual cell threshold lot case tweak valu maximumcontamin andor pcut yield usabl result set clustersfals forc estimatenonexpressingcel consid cell independ go worth make criteria exclud cell permiss decreas maximumcontamin much reason changelog v loadx requir version seuratreadx strip numer suffix v first cran version code one signific chang tweak reach cran compat correct algorithm made time faster parallel option longer need remov also includ minor tweak v addit autoestcont function automat estim contamin fraction without need specifi set gene use estim number tweak bug fix v bug fix v ad helper function integr metadata soupchannel object integr cluster inform estim contamin calcul adjust count make adjustcount routin parallel v review method focu simplif code function use autom select gene contamin estim remov misus cluster use guid select cell set gene express default set use global estim rho hierarch bay routin ad share inform cell user use cell specif estim see note detail v pass r cmd check without warn error ad extra vignett estim contamin correctli chang argument interpolatecellcontamin function made monoton decreas lowess default interpol method number plot improv v ad lowess smooth interpol made default modifi variou function allow singl channel process natur way minor bug fix v integr estimatesoup class construct save memori load mani channel ad function use tfidf quickli estim marker minor bug fix document updat v updat document modifi plot function return sourc datafram v fairli major overhaul data structur use packag compat previou version v bug fix plot routin licens copyright c genom research ltd author matthew young mysangeracuk program free softwar redistribut andor modifi term gnu gener public licens version publish free softwar foundat program distribut hope use without warranti without even impli warranti merchant fit particular purpos see gnu gener public licens detail httpwwwgnuorglicens test environ local os x instal r ubuntu travisci r winbuild devel releas r cmd check result error warn note resubmiss resubmiss version correct issu caus soupx archiv specif set lazydatacompress flag descript xz caus packag fail size check flag set remov exampl nonexport function