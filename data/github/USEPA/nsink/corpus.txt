nsink readmemd gener readmermd pleas edit file badg start r build statushttpsgithubcomjhollistnsinkworkflowsrcmdcheckbadgesvghttpsgithubcomjhollistnsinkact codecov test coveragehttpscodecovioghjhollistnsinkbranchmaingraphbadgesvghttpscodecovioghjhollistnsinkbranchmain lifecycl stablehttpsimgshieldsiobadgelifecyclestablebrightgreensvghttpslifecyclerliborgarticlesstageshtmlst doihttpszenodoorgbadgedoizenodosvghttpsdoiorgzenodo doihttpsjosstheojorgpapersjossstatussvghttpsdoiorgjoss badg end statement need nsink packag r implement method describ kellogg et al httpsdoiorgjecoleng previou implement approach reli manual vector base approach time consum prepar approach use hybrid rastervector approach take rel littl time set new watersh reli readili avail data total run time vari rang minut hour depend option select previou version took week manual data manipul thu nsink develop satisfi need quicker implement nsink method describ kellogg et al httpsdoiorgjecoleng nsink function user function nsink packag nsink_get_huc_id function search name usg watersh boundari dataset hydrolog unit httpswwwusgsgovcoresciencesystemsngpnationalhydrographywatershedboundarydataset retriev digit hydrolog unit code huc nsink_get_data use accept huc id eg digit digit function download nhdplu ssurgo nlcd land cover nlcd impervi huc nsink_prep_data nsink need data common coordin refer system mutlipl nhdplu tabl differ portion ssurgo function complet data prepar step output data clip huc boundari nsink_calc_remov quantifi rel n remov across landscap key aspect nsink analysi nsink_calc_remov function take object return nsink_prep_data calcul rel n remov landscap sink see kellogg et al kellogggeospati detail rel n remov estim sink nsink_generate_flowpath function use combin flow determin topographi via flowdirect raster landbas portion flow path downstream flow along nhdplu stream network nsink_summarize_flowpath summar remov along specifi flow path requir rel n remov gener flow path function use return summari rel n remov along flow path sink nsink_generate_static_map function analyz n remov watersh scale summar result multipl flow path four static map return remov effici load index transport index deliveri index remov effici raster version nsink_calc_remov output load index n sourc base nlcd categori transport index heat map cumul rel n remov along flow path origin grid point densiti set user across watersh highlight gradient downstream n retent deliveri index result multipli load index transport index show potenti n deliveri differ sourc take account rel n remov water move downstream nsink_plot function plot raster list return nsink_generate_static_map nsink_build one driver behind develop nsink packag provid nsink analysi output could use broadli eg within gi nsink_build run complet nsink analysi output r object shapefil andor tiff nsink_load essenti invers nsink_build function function take folder file like creat nsink_build read r instal instruct time plan maintain nsink packag github packag thu wont avail directli cran may use install_github function remot packag instal code take care instal remot instal nsink github repositori r installpackagesremot remotesinstall_githubusepansink depend true build_vignett true load packag r librarynsink document exampl function document exampl document may access r via usual help function addit introduct nsink packag detail workflow document vignett r load packag librarynsink access packag level help helppackag nsink access introduct nsink vignett vignetteintro packag nsink contribut would like contribut nsink packag pleas first read contributinggithubcontributingmd short contribut happili accept either via suggest issueshttpsgithubcomusepansinkissu via pull request contributor coven code conduct pledg member contributor leader pledg make particip commun harassmentfre experi everyon regardless age bodi size visibl invis disabl ethnic sex characterist gender ident express level experi educ socioeconom statu nation person appear race religion sexual ident orient pledg act interact way contribut open welcom divers inclus healthi commun standard exampl behavior contribut posit environ commun includ demonstr empathi kind toward peopl respect differ opinion viewpoint experi give grace accept construct feedback accept respons apolog affect mistak learn experi focus best us individu overal commun exampl unaccept behavior includ use sexual languag imageri sexual attent advanc kind troll insult derogatori comment person polit attack public privat harass publish other privat inform physic email address without explicit permiss conduct could reason consid inappropri profession set enforc respons commun leader respons clarifi enforc standard accept behavior take appropri fair correct action respons behavior deem inappropri threaten offens harm commun leader right respons remov edit reject comment commit code wiki edit issu contribut align code conduct commun reason moder decis appropri scope code conduct appli within commun space also appli individu offici repres commun public space exampl repres commun includ use offici email address post via offici social media account act appoint repres onlin offlin event enforc instanc abus harass otherwis unaccept behavior may report commun leader respons enforc hollisterjeffepagov complaint review investig promptli fairli commun leader oblig respect privaci secur report incid enforc guidelin commun leader follow commun impact guidelin determin consequ action deem violat code conduct correct commun impact use inappropri languag behavior deem unprofession unwelcom commun consequ privat written warn commun leader provid clariti around natur violat explan behavior inappropri public apolog may request warn commun impact violat singl incid seri action consequ warn consequ continu behavior interact peopl involv includ unsolicit interact enforc code conduct specifi period time includ avoid interact commun space well extern channel like social media violat term may lead temporari perman ban temporari ban commun impact seriou violat commun standard includ sustain inappropri behavior consequ temporari ban sort interact public commun commun specifi period time public privat interact peopl involv includ unsolicit interact enforc code conduct allow period violat term may lead perman ban perman ban commun impact demonstr pattern violat commun standard includ sustain inappropri behavior harass individu aggress toward disparag class individu consequ perman ban sort public interact within commun attribut code conduct adapt contributor covenanthomepag version avail httpswwwcontributorcovenantorgversioncode_of_conducthtml commun impact guidelin inspir mozilla code conduct enforc ladderhttpsgithubcommozilladivers homepag httpswwwcontributorcovenantorg answer common question code conduct see faq httpswwwcontributorcovenantorgfaq translat avail httpswwwcontributorcovenantorgtransl titl nsink r packag flow path nitrogen remov estim tag r nitrogen nitrogen sink landscap gi date output github_docu author name jeffrey w hollist orcid affili name dorothi q kellogg orcid affili name qian leipar orcid affili name emili wilson orcid affili name cari chadwick orcid affili name david dickson orcid affili name arthur gold orcid affili name chester arnold affili bibliographi paperbib affili name u environment protect agenc atlant coastal environment scienc divis narragansett ri index name univers rhode island depart natur resourc scienc kingston ri index name univers connecticut center land use educ research storr ct index summari nsink packag estim cumul nitrogen n remov along specifi flow path base methodolog outlin kellogg et al kellogggeospati userspecifi watersh ie hydrolog unit code huc nsink download requir dataset public dataset unit state prepar data use summar n remov along flow path creat sever static map result nsink analysi may export standard geospati file use applic statement need excess n deliveri via surfac water downstream aquat resourc contribut impair water qualiti impact ecosystem servic includ harm algal bloom hab hypoxia rabalaisbeyond identifi landscap n sink ie area n effect remov aquat system analyz n deliveri watersh scale help watersh manag land use planner conserv organ theoret underpin identifi n sink reli decad research explain kellogg et al kellogggeospati prior nsink implement done casebycas data acquisit manipul mostli manual took week month complet singl digit huc effort requir analysi limit applic scale beyond pilot studi feasibl goal nsink address limit provid open sourc solut could run singl small watersh eg digit huc minut hour minim manual input nsink packag packag instal nsink packag avail httpsgithubcomusepansink may instal r follow r instal instal remot installpackagesremot instal nsink github remotesinstall_githubusepansink depend true build_vignett true packag detail nsink packag design around major step run nsink analysi includ function follow task prepar analysi get data prepar data analysi calcul rel n remov layer hydric soil lake stream run pointbas analysi calcul flow path summar rel n remov along flow path run hucbas analysi develop static map gener output dataset requir data abil run nsink analysi reli sever dataset contermin unit state limit approach nation dataset ensur scalabl nsink dataset avail locat unit state dataset nsink use nation hydrographi dataset plu version nhdplu soil survey geograph databas ssurgo nation land cover dataset nlcd land cover nation land cover dataset nlcd impervi surfac mooreus soilweb jinoveral dataset avail via applic program interfac api via direct download depend nsink packag depend sever exist r packag facilit spatial data handl data acquisit data manag data analysi data process detail tabl tabl r packag depend nsink packag packagetaskcit sfspatial data handl analysissfpap sf rasterspati data handl analysisrast starsspati data handl analysisstar fasterizespati data handl analysisfaster lwgeomspati data handl analysislwgeom gstatspati data handl analysisgstatpap gstatpap gstat spspatial data handl analysissppap spbook sp unitsunit transformationsunitspap unit feddatadata acquisitionfeddata httrdata acquisitionhttr dplyrdata manag analysisdplyr zoodata manag analysiszoopap zoo igraphdata manag analysisigraphpap igraph readrdata manag analysisreadr foreigndata manag analysisforeign rlangdata manag analysisrlang furrrparallel processingfurrr futureparallel processingfuturepap futur function current nsink provid export function facilit flow path analysi rel n remov nsink repositori httpsgithubcomusepansink r packag document contain detail document function pacakg also vignett outlin typic workflow run nsink analysi nsink packag upon instal vignett access r vignetteintro packag nsink acknowledg mani peopl contribut variou way develop nsink concept particular would like thank chet arnold cari chadwick david dickson emili wilson univers connecticut center land use educ research well peter august chri damon art gold univers rhode island depart natur resourc scienc uconn uri crew contribut tremend develop nsink concept addit grate stephen shiver michael dumel justin bousquin joe livolsi tim gleason wayn munn construct earli review paper lastli ken forshay us epa center environment solut emerg respons deserv thank shepherd develop nsink mani year view express articl author necessarili repres view polici us environment protect agenc mention trade name product servic impli endors us govern us environment protect agenc epa endors commerci product servic enterpris contribut identifi track number ord atlant coastal environment scienc divis offic research develop center environment measur model us environment protect agenc refer v chang final edit joss public zip longer requir use archiv pacakg use extract nhdplu z file ad contribut info readm bug fix impervi use na impervi percentag zero na rang zero broke remov estim fix v first real releas joss submiss contribut nsink outlin propos chang nsink fix typo fix typo spell mistak grammat error document directli use github web interfac long chang made _source_ file gener mean youll need edit roxygen commentshttpsroxygenrliborgarticlesroxygenhtml r rd file find r file gener rd read comment first line bigger chang want make bigger chang good idea first file issu make sure someon team agre need youv found bug pleas file issu illustr bug minim reprexhttpswwwtidyverseorghelpreprex also help write unit test need pull request process fork packag clone onto comput havent done recommend use usethiscreate_from_githubjhollistnsink fork true instal develop depend devtoolsinstall_dev_dep make sure packag pass r cmd check run devtoolscheck r cmd check doesnt pass cleanli good idea ask help continu creat git branch pull request pr recommend use usethispr_initbriefdescriptionofchang make chang commit git creat pr run usethispr_push follow prompt browser titl pr briefli describ chang bodi pr contain fix issuenumb userfac chang add bullet top newsmd ie first header code style use roxygenhttpscranrprojectorgpackageroxygen markdown syntaxhttpscranrprojectorgwebpackagesroxygenvignettesrdformattinghtml document use testthathttpscranrprojectorgpackagetestthat unit test contribut test case includ easier accept code conduct pleas note nsink project releas contributor code conductcode_of_conductmd contribut project agre abid term titl nsink output github_docu readmemd gener readmermd pleas edit file r includ fals knitropts_chunkset collaps true comment figpath manfiguresreadm outwidth badg start r build statushttpsgithubcomjhollistnsinkworkflowsrcmdcheckbadgesvghttpsgithubcomjhollistnsinkact codecov test coveragehttpscodecovioghjhollistnsinkbranchmaingraphbadgesvghttpscodecovioghjhollistnsinkbranchmain lifecycl stablehttpsimgshieldsiobadgelifecyclestablebrightgreensvghttpslifecyclerliborgarticlesstageshtmlst doihttpszenodoorgbadgedoizenodosvghttpsdoiorgzenodo doihttpsjosstheojorgpapersjossstatussvghttpsdoiorgjoss badg end statement need nsink packag r implement method describ kellogg et al httpsdoiorgjecoleng previou implement approach reli manual vector base approach time consum prepar approach use hybrid rastervector approach take rel littl time set new watersh reli readili avail data total run time vari rang minut hour depend option select previou version took week manual data manipul thu nsink develop satisfi need quicker implement nsink method describ kellogg et al httpsdoiorgjecoleng nsink function r lubridatetoday user function nsink packag nsink_get_huc_id function search name usg watersh boundari dataset hydrolog unit httpswwwusgsgovcoresciencesystemsngpnationalhydrographywatershedboundarydataset retriev digit hydrolog unit code huc nsink_get_data use accept huc id eg digit digit function download nhdplu ssurgo nlcd land cover nlcd impervi huc nsink_prep_data nsink need data common coordin refer system mutlipl nhdplu tabl differ portion ssurgo function complet data prepar step output data clip huc boundari nsink_calc_remov quantifi rel n remov across landscap key aspect nsink analysi nsink_calc_remov function take object return nsink_prep_data calcul rel n remov landscap sink see kellogg et al kellogggeospati detail rel n remov estim sink nsink_generate_flowpath function use combin flow determin topographi via flowdirect raster landbas portion flow path downstream flow along nhdplu stream network nsink_summarize_flowpath summar remov along specifi flow path requir rel n remov gener flow path function use return summari rel n remov along flow path sink nsink_generate_static_map function analyz n remov watersh scale summar result multipl flow path four static map return remov effici load index transport index deliveri index remov effici raster version nsink_calc_remov output load index n sourc base nlcd categori transport index heat map cumul rel n remov along flow path origin grid point densiti set user across watersh highlight gradient downstream n retent deliveri index result multipli load index transport index show potenti n deliveri differ sourc take account rel n remov water move downstream nsink_plot function plot raster list return nsink_generate_static_map nsink_build one driver behind develop nsink packag provid nsink analysi output could use broadli eg within gi nsink_build run complet nsink analysi output r object shapefil andor tiff nsink_load essenti invers nsink_build function function take folder file like creat nsink_build read r instal instruct time plan maintain nsink packag github packag thu wont avail directli cran may use install_github function remot packag instal code take care instal remot instal nsink github repositori r evalfals installpackagesremot remotesinstall_githubusepansink depend true build_vignett true load packag r evalfals librarynsink document exampl function document exampl document may access r via usual help function addit introduct nsink packag detail workflow document vignett r evalfals load packag librarynsink access packag level help helppackag nsink access introduct nsink vignett vignetteintro packag nsink contribut would like contribut nsink packag pleas first read contributinggithubcontributingmd short contribut happili accept either via suggest issueshttpsgithubcomusepansinkissu via pull request titl introduct nsink output rmarkdownhtml_vignett vignett vignetteindexentryintroduct nsink vignetteencodingutf vignetteengineknitrrmarkdown bibliographi nsinkbib csl ecologycsl r includ fals knitropts_chunkset eval true cach fals tidi fals comment warn fals messag fals loadsystemfiletestdatarda packagensink r setup echofals librarynsink packag nsink implement approach estim rel nitrogen remov along flow path approach detail kellogg et al kellogggeospati build peerreview literatur form review metaanalys ie mayermeta alexanderrol seitzingerdenitrif estim nitrogen n remov within three type landscap sink wetland stream lake along given flow path within huc basin nsink packag implement approach use publicli avail spatial data identifi flow path estim n remov landscap sink remov rate depend retent time influenc physic characterist identifi use publicli avail spatial data nation hydrographi dataset plu nhdplu soil survey geograph databas ssurgo nation land cover dataset nlcd land cover nation land cover dataset nlcd impervi surfac static map specifi huc basin gener n remov effici n load index n transport index n deliveri index map may use inform local decisionmak highlight area prone n leaki area contribut n remov nsink packag provid sever function set run nsink analysi specifi digit huc code requir data download prepar analysi hucwid nitrogen remov calcul flow path summar addit conveni function run requir function specifi huc includ detail step outlin vignett get data first step nsink process acquir data need analysi nsink packag util openli avail data sever us feder govern sourc dataset use digit huc id number select data download first step identifi huc id download data identifi huc id use nsink_get_huc_id function use digit huc name search huc match return data frame option return partial exact match r get_huc get huc id palmer show multipl match nsink_get_huc_idpalm niantic niantic_huc_id nsink_get_huc_idniant riverhuc_ niantic_huc_id huc id hand use nsink_get_data function download requir data data publicli avail sourc r lubridatetoday authent requir access sourc huc id requir user may specifi path store data well indic whether download data alreadi exist data directori also note file archiv ziphttpswwwziporg requir nsink_get_data extract nhd plu file r get_data_norun evalfals get data select huc niantic_download nsink_get_dataniantic_huc_id data_dir nsink_niantic_data addit download data function return basic inform download huc id download locat r get_data_return niantic_download prepar data data download sever addit data process step requir subset data huc set data common coordin refer system cr includ filter huc boundari mask data set huc boundari convert column name lower case creat new column harmon raster extent set data common cr nsink_prep_data function complet process step requir huc id specifi cr path data directori return list requir data subsequ nsink analys quick note cr near futur prefer way specifi cr valu either wellknown text wkt epsg codeshttpspatialreferenceorgrefepsg proj string eventu deprec current packag nsink reli differ stage implement chang proj nsink current work option proj string recomend vignett show exampl epsg code r prep_data evalfals epsg conu alber equal area aea prep data select huc niantic_data nsink_prep_dataniantic_huc_id project aea data_dir nsink_niantic_data calcul remov next step nsink process calcul rel nitrogen remov detail nitrogen remov estim calcul avail kellogg et al kellogggeospati nsink_calc_remov function take prepar data input return list three item raster_method item contain raster base approach calcul remov use static map remov land_remov repres land base nitrogen remov hydric soil area impervi surfac remov network_remov contain remov along nhd plu flow network remov calcul separ stream waterbodi eg lake reservoir r calc_remov evalfals calcul remov prep data niantic_remov nsink_calc_removalniantic_data gener summar flowpath use part nsink approach abil summar remov along length specifi flowpath nsink packag provid two function facilit process nsink_generate_flowpath function take point locat sf object prep data gener nsink_prep_data input return sf linestr flowpath start input point locat termin furthest downstream locat input nhd plu flowpath land gener flow direct grid flowpath intersect stream network flow determin flow along nhd plu stream network first creat sf point object r flowpath_start load sf packag librarysf start point pt c start_loc st_sfst_sfcst_pointcpt cr aea may also determin point locat interact plot data use locat function first creat simpl plot r flowpath_plot evalfals creat simpl plot plotst_geometryniantic_datahuc plotst_geometryniantic_datalak add col darkblu plotst_geometryniantic_datastream add col blue map made use interact select locat use x creat sf point object r interactive_loc evalfals select locat map start point pt unlistlocatorn convert sf point start_loc_int st_sfst_sfcst_pointpt cr aea point identifi use start locat flowpath r generate_flowpath evalfals niantic_fp nsink_generate_flowpathstart_loc niantic_data return valu flowpath_end portion flowpath land creat use flow direct grid flowpath_network portion flowpath nhd plu network occur upstream flowpath_end intersect network r thefp niantic_fp flowpath gener summar rel nitrogen remov along flowpath nsink_summarize_flowpath function take flowpath remov input data frame return segment identifi type percent remov associ segment rel remov total rel remov minimum n_out column r summarize_it evalfals niantic_fp_remov nsink_summarize_flowpathniantic_fp niantic_remov niantic_fp_remov minniantic_fp_removaln_out r summarize_show echofals niantic_fp_remov minniantic_fp_removaln_out static map individu flow path use specif applic often use look remov pattern across landscap nsink_generate_static_map function provid huc wide raster requir input prep data remov raster sampl densiti function return four separ raster removal_eff landscap wide estim rel nitrogen remov percentag loading_idx index rel nitrogen load land cover class deriv publish sourc transport_idx rel nitrogen transport sampl possibl flowpath given huc expens comput task nsink gener remov hotspot map base sampl flowpath final hotspot map interpol sampl refer nitrogen transport index samp_dens argument control number sampl flowpath gener delivery_idx deliveri index combin load index transport index repres area landscap deliv nitrogen outflow watersh r static_map evalfals niantic_static_map nsink_generate_static_mapsniantic_data niantic_remov static map made plot quickli nsink_plot sepcifi plot would like see map argument remov transport deliveri exampl nsink_plot r plots_fak evalfals nsink_plotniantic_static_map transport r plot echofals warningfals nsink_plotniantic_static_map transport conveni function build workflow describ includ basic function user may wish use nsink calcul base layer nsink analysi build applic outsid r conveni function download data prepar calcul remov gener static map includ facilit type analysi nsink_build function requir huc id coordin refer system sampl densiti output folder also need default locat option argument forc new download play sound signal build finish noth return r prep data file tif file written output folder use applic r build evalfals niantic_huc_id nsink_get_huc_idniant riverhuc_ aea nsink_buildniantic_huc_id aea samp_den refer gener roxygen edit hand pleas edit document rnsink_calc_removalr namensink_calc_remov aliasnsink_calc_remov titlecalcul nsink nitrogen remov percent usag nsink_calc_remov input_data off_network_lak null off_network_stream null off_network_canalsditch null argument iteminput_dataa list input dataset creat codelinknsink_prep_data itemoff_network_lakesopt argument set remov waterbodi part nhdplu hydrolog network default valu use th percentil remov lake huc anoth valu desir provid singl numer rang itemoff_network_streamsopt argument set remov stream part nhdplu hydrolog network default valu use median remov first order stream huc anoth valu desir provid singl numer rang itemoff_network_canalsditchesopt argument set remov canal ditch part nhdplu hydrolog network default valu use th percentil remov third order stream huc anoth valu desir provid singl numer rang valu list three item raster stack one layer nitrogen remov second layer type remov eg hydric soil lake stream polygon repres remov land polygon repres remov stream network includ stream remov lake remov descript start base data layer nhdplu ssurgo impervi surfac flow veloc time travel function calcul percentag nitrogen remov nitrogen remov method calcul hrefhttpsdoiorgjecolengkellogg et al function assum data download codelinknsink_get_data prepar codelinknsink_prep_data exampl dontrun librarynsink niantic_huc nsink_get_huc_idniant riverhuc_ niantic_data nsink_get_dataniantic_huc data_dir nsink_data aea niantic_nsink_data nsink_prep_dataniantic_huc project aea data_dir nsink_data remov nsink_calc_removalniantic_nsink_data refer kellogg q gold j cox addi k august p v geospati approach assess denitrif sink within lowerord catchment ecolog engin hrefhttpsdoiorgjecolenglink gener roxygen edit hand pleas edit document rnsink_generate_flowpathr namensink_generate_flowpath aliasnsink_generate_flowpath titlegener clean flowpath nsink usag nsink_generate_flowpathstarting_loc input_data argument itemstarting_locationan codelinksf point locat start point flowpath project must match project input_data iteminput_dataa list input data least fdr stream tot raster_templ may gener codelinknsink_prep_data valu codelinksf linestr object flowpath start codestarting_loc end ouflow huc descript function take xy locat start point gener flowpath use nsink nitrogen remov analysi flowpath combin flow direct deriv flowpath land plu nhdplu deriv streamreach flowpath exampl dontrun librarynsink niantic_huc nsink_get_huc_idniant riverhuc_ niantic_data nsink_get_dataniantic_huc data_dir nsink_data aea niantic_nsink_data nsink_prep_dataniantic_huc project aea data_dir nsink_niantic_data pt c start_loc st_sfst_sfcst_pointcpt cr aea fp nsink_generate_flowpathstart_loc niantic_nsink_data gener roxygen edit hand pleas edit document rnsink_prep_datar namensink_prep_fdr aliasnsink_prep_fdr titleprepar flow direct data nsink usag nsink_prep_fdrhuc_sf huc_rast data_dir argument itemhuc_sfan sf object watersh boundari dataset huc itemhuc_rastera raster object watersh boundari dataset huc itemdata_dirbas directori contain nsink data folder data may download codelinknsink_get_data function valu raster object flow direct huc_sf origin fdr project descript standard flow direct data transform data clip huc keywordintern gener roxygen edit hand pleas edit document rnsink_buildr namensink_write_static_map aliasnsink_write_static_map titlewrit static map file usag nsink_write_static_mapsstatic_map output_dir argument itemstatic_mapsa list static map output codelinknsink_generate_static_map itemoutput_diroutput folder save tif static map descript write static map tiff keywordintern gener roxygen edit hand pleas edit document rnsink_prep_datar namensink_prep_ssurgo aliasnsink_prep_ssurgo titleprepar ssurgo data nsink usag nsink_prep_ssurgohuc_sf data_dir argument itemhuc_sfan sf object watersh boundari dataset huc itemdata_dirbas directori contain nsink data folder data may download codelinknsink_get_data function valu sf object ssurgo data huc_sf hydric data ad descript standard impervi data transform data reduc column need keywordintern gener roxygen edit hand pleas edit document rutilsr namensink_fix_data_directori aliasnsink_fix_data_directori titlefix data directori usag nsink_fix_data_directorydata_dir argument itemdata_dirth data directori valu string normal path descript function take data directori check exist creat doesnt exist add trail slash normal path oper system keywordintern gener roxygen edit hand pleas edit document rnsink_plotr namensink_plot_transport aliasnsink_plot_transport titlensink plot function nitrogen transport index usag nsink_plot_transport transport_idx break c color cad abc acb cdcd ef fe fc f fae ef argument itemtransport_idxa transport index coderast creat via codelinknsink_generate_static_map itembreaksa vector valu specifi breakpoint break transport coderast must one number color itemcolorsa vector hexcod color descript function creat simpl plot preselect color palett although differ break color provid user meant quick mean visual remov effici keywordintern gener roxygen edit hand pleas edit document rutilsr namensink_get_plus_remotepath aliasnsink_get_plus_remotepath titleget remot path nhdplu compon usag nsink_get_plus_remotepath rpu compon cnhdsnapshot fdrfac eromextens wbdsnapshot nhdplusattribut argument itemrpurast process unit nhdplu avail nsinkwbd_lookup itemcomponentwhich compon download descript code modifi httpsgithubcomjstanhdrblobmasterrutilsr still need figur best way acknowledg jsta author includ gpl keywordintern gener roxygen edit hand pleas edit document rnsink_prep_datar namensink_prep_stream aliasnsink_prep_stream titleprepar stream data nsink usag nsink_prep_streamshuc_sf data_dir argument itemhuc_sfan sf object watersh boundari dataset huc itemdata_dirbas directori contain nsink data folder data may download codelinknsink_get_data function valu return sf object nhdplu stream huc_sf descript standard stream data transform data clip huc keywordintern gener roxygen edit hand pleas edit document rnsink_plotr namensink_plot_remov aliasnsink_plot_remov titlensink plot function remov effici usag nsink_plot_remov removal_eff break c color cdffbe argument itemremoval_effica remov effici coderast creat via codelinknsink_generate_static_map itembreaksa vector valu specifi breakpoint break remov coderast must one number color itemcolorsa vector hexcod color descript function creat simpl plot preselect color palett although differ break color provid user meant quick mean visual remov effici keywordintern gener roxygen edit hand pleas edit document rnsink_prep_datar namensink_prep_q aliasnsink_prep_q titleprepar flow data nsink usag nsink_prep_qdata_dir argument itemdata_dirbas directori contain nsink data folder data may download codelinknsink_get_data function valu tibbl flow data descript standard flow data erom tabl keywordintern gener roxygen edit hand pleas edit document rnsink_plotr namensink_plot aliasnsink_plot titlensink plot function list nsink static map usag nsink_plotstatic_map map cremov transport deliveri argument itemstatic_mapsa list coderast object creat via codelinknsink_generate_static_map list removal_eff delivery_idx transport_idx itemmapa charact either remov transport deliveri descript function creat simpl plot preselect color palett list static map creat codelinknsink_generate_static_map meant quick mean visual variou static map exampl dontrun librarynsink niantic_huc nsink_get_huc_idniant riverhuc_ niantic_data nsink_get_dataniantic_huc data_dir nsink_data aea niantic_nsink_data nsink_prep_dataniantic_huc project aea data_dir nsink_data remov nsink_calc_removalniantic_nsink_data static_map nsink_generate_static_mapsniantic_nsink_data remov samp_den nsink_plotstatic_map transport gener roxygen edit hand pleas edit document rnsink_plotr namensink_plot_deliveri aliasnsink_plot_deliveri titlensink plot function nitrogen deliveri index usag nsink_plot_deliveri delivery_idx break c color cffbebe faa argument itemdelivery_idxa deliveri index coderast creat via codelinknsink_generate_static_map itembreaksa vector valu specifi breakpoint break deliveri coderast must one number color itemcolorsa vector hexcod color descript function creat simpl plot preselect color palett although differ break color provid user meant quick mean visual deliveri index keywordintern gener roxygen edit hand pleas edit document rnsink_summarize_flowpathr namensink_generate_from_to_nod aliasnsink_generate_from_to_nod titlensink gener land node usag nsink_generate_from_to_nodesland_off_network argument itemland_off_networkth land network path descript code borrow httpswwwrspatialorgrspatialnetworkshtml keywordintern gener roxygen edit hand pleas edit document rnsink_prep_datar namensink_prep_lak aliasnsink_prep_lak titleprepar lake data nsink usag nsink_prep_lakeshuc_sf data_dir argument itemhuc_sfan sf object watersh boundari dataset huc itemdata_dirbas directori contain nsink data folder data may download codelinknsink_get_data function valu sf object nhdplu lake huc_sf descript standard lake data transform data clip huc renam column keywordintern gener roxygen edit hand pleas edit document rnsink_generate_static_mapsr namensink_generate_n_removal_heatmap aliasnsink_generate_n_removal_heatmap titlegener nitrogen remov heatmap usag nsink_generate_n_removal_heatmap input_data remov samp_den ncpu futureavailablecor seed argument iteminput_dataa list input dataset creat codelinknsink_prep_data itemremovalth remov raster stack remov list gener codelinknsink_calc_remov itemsamp_densa valu unit input data divid total area input huc use determin number point determin regular sampl calcul remov instanc valu would roughli equat point per everi meter itemncpunumb cpu use calcul flowpath remov larger ie greater number flowpath default number core avail minu one itemseedrandom seed ensur reproduc sampl point creation across run default set descript gener heatmap flowpath one segment complet contain within huc includ practic remov flowpath intersect stream network extend beyond huc rare keywordintern gener roxygen edit hand pleas edit document rnsink_prep_datar namensink_remove_openwat aliasnsink_remove_openwat titleremov open water portion huc usag nsink_remove_openwaterhuc_sf data_dir argument itemhuc_sfan sf object watersh boundari dataset huc itemdata_dirbas directori contain nsink data folder data may download codelinknsink_get_data function valu sf object huc without salt wateropen water area descript use ssurgo poli ssurgo musym ws check remov portion huc actual salt water account coastal huc larg area open water keywordintern gener roxygen edit hand pleas edit document rnsink_buildr namensink_build aliasnsink_build titlebuild requir dataset nsink usag nsink_build huc project output_dir normalizepathnsink_output winslash data_dir normalizepathnsink_data winslash forc fals samp_den year argument itemhuca charact digit huc id may search codelinknsink_get_huc_id itemprojectionproject use spatial data specifi either epsg code numer wkt string itemoutput_dirfold write process nsink file current process file overwritten output folder use run differ huc specifi separ output folder itemdata_dirfold hold download data data directori use hold data multipl huc data download alreadi exist folder itemforcelog valu use forc new download data alreadi exist file system itemsamp_densth codesamp_den control densiti point use creat nitrogen remov heat map area watersh sampl point separ codesamp_den valu unit input data larger valu fewer point itemyearyear argument pass feddata codelinkget_nlcd function default itempass codelinknsink_calc_remov network argument codeoff_network_lak codeoff_network_stream codeoff_network_canalsditch valu list provid detail huc use output locat dataset descript function wrapper around function run requir build full dataset need huc develop four static nsink map nitrogen load index nitrogen remov effeci nitrogen transport index nitrogen deliveri index primari purpos use nsink packag develop requir dataset nsink applic built outsid r eg arcgi take time complet download mb data process data creat output file exampl dontrun librarynsink aea nsink_buildnsink_get_huc_idniant riverhuc_ aea output_dir nsink_output data_dir nsink_data samp_den gener roxygen edit hand pleas edit document rutilsr nameget_nhd_plu aliasget_nhd_plu titlefunct download nhd file usag get_nhd_plu download_url data_dir normalizepathnsink_data winslash download_again fals argument itemdownload_urlurl download itemdata_dirth data dir itemforceforc new download descript function download nhd file keywordintern gener roxygen edit hand pleas edit document rnsink_calc_removalr namensink_calc_off_network_remov aliasnsink_calc_off_network_remov titlecalcul network waterbodi stream nitrogen remov usag nsink_calc_off_network_remov input_data off_network_lak off_network_stream off_network_canalsditch argument iteminput_dataa name list stream lake network_remov tot raster_templ itemoff_network_lakesopt argument set remov waterbodi part nhdplu hydrolog network default valu use th percentil remov lake huc anoth valu desir provid singl numer rang itemoff_network_streamsopt argument set remov stream part nhdplu hydrolog network default valu use median remov first order stream huc anoth valu desir provid singl numer rang itemoff_network_canalsditchesopt argument set remov canal ditch part nhdplu hydrolog network default valu use th percentil remov third order stream huc anoth valu desir provid singl numer rang valu raster vector network nitrogen remov descript calcul network waterbodi stream nitrogen remov keywordintern gener roxygen edit hand pleas edit document rnsink_calc_removalr namensink_calc_stream_remov aliasnsink_calc_stream_remov titlecalcul streambas nitrogen remov usag nsink_calc_stream_removalinput_data argument iteminput_dataa name list stream q tot raster_templ valu raster vector version stream base nitrogen remov descript calcul streambas nitrogen remov keywordintern gener roxygen edit hand pleas edit document rnsink_loadr namensink_load aliasnsink_load titleload exist nsink analysi folder usag nsink_loadinput_fold base_nam nsink_ project null argument iteminput_folderfold contain nsink file produc codelinknsink_build itembase_namea base name use assign object global environ itemprojectionan option cr specifi either epsg code numer wkt string use project return unknown itempass codelinknsink_calc_remov network argument codeoff_network_lak codeoff_network_stream codeoff_network_canalsditch valu creat sever list global environ would normal creat run nsink analysi includ codelinknsink_prep_data object codelinknsink_calc_remov object codelinknsink_generate_static_map object descript load exist nsink analysi folder exampl dontrun librarynsink aea nsink_buildnsink_get_huc_idniant riverhuc_ aea output_fold nsink_output samp_den nsink_loadinput_fold nsink_output base_nam nsink_ gener roxygen edit hand pleas edit document rnsink_prep_datar namensink_prep_data aliasnsink_prep_data titleprepar nsink data given huc usag nsink_prep_data huc project data_dir normalizepathnsink_data winslash year argument itemhuca charact string huc id use codelinknsink_get_huc_id look id name itemprojectioncr use pass ethier epsg code numer wkt charact must project cr geograph mani measur requir nsink analysi requir reliabl length area measur itemdata_dirbas directori contain nsink data folder data may download codelinknsink_get_data function itemyearth year nlcd impervi data retriev feddata codelinkget_nlcd function valu return list sf raster tabular object requir dataset plu huc descript addit local access requir dataset dataset need prepar function standard project extent clip dataset boundari specifi huc addit tabular dataset eg flow time travel etc includ output well exampl dontrun librarynsink aea niantic_huc nsink_get_huc_idniant riverhuc_ niantic_nsink_data nsink_prep_datahuc niantic_huc project aea data_dir nsink_data exampl use epsg code project epsg l niantic_nsink_data nsink_prep_datahuc niantic_huc project epsg data_dir nsink_data gener roxygen edit hand pleas edit document rnsink_prep_datar namensink_prep_lakemorpho aliasnsink_prep_lakemorpho titleprepar lake morpholog data nsink usag nsink_prep_lakemorphodata_dir argument itemdata_dirbas directori contain nsink data folder data may download codelinknsink_get_data function valu tibbl lake morpholog data descript standard lake morpholog lake morpholog tabl keywordintern gener roxygen edit hand pleas edit document rnsink_get_datar namensink_get_huc_id aliasnsink_get_huc_id titlelook huc id huc name usag nsink_get_huc_idhuc_nam exact fals argument itemhuc_namecharact string huc name partial huc name itemexactlog indic whether exact match valu data frame huc_ hu__nam match huc_nam descript function take huc name return match huc id default behavior select possibl match id without match case string exact match requir use codeexact argument exampl nsink_get_huc_idhuc_nam niantic river gener roxygen edit hand pleas edit document rnsink_generate_flowpathr namensink_get_flowlin aliasnsink_get_flowlin titleget flowlin intersect flowpath usag nsink_get_flowlineflowpath_end stream tot argument itemflowpath_endsan codesf linestr flowpath end gener codelinknsink_get_flowpath_end itemstreamsnhdplu stream codelinknsink_prep_data itemtotnhdplu time travel codelinknsink_prep_data provid node valu codesf object nhdplu flowlin occur raster flowpath intersect stream network descript extract flowlin intersect flowpath end use actual flowlin part flowpath instead simpli use raster deriv flowpath follow flowlin exactli keywordintern gener roxygen edit hand pleas edit document rnsink_summarize_flowpathr namensink_create_summari aliasnsink_create_summari titlecr nitrogen remov summari usag nsink_create_summaryland_remov network_remov argument itemland_removala data frame land base nitrogen remov via gener flowpath hydric remov raster itemnetwork_removala data frame stream network nitrogen remov via calcul stream lake remov valu data frame summar nitrogen remov along flowpath descript function take nitrogen remov remov type data frame land flowpath network creat data frame summar remov along flowpath keywordintern gener roxygen edit hand pleas edit document rutilsr namensink_run_z aliasnsink_run_z titlefind zip usag nsink_run_zzipfil destdir extract_again fals argument itemzipfileth zipfil extract itemdestdirwher put extract file itemforcewheth extract destin file alreadi exist descript code modifi httpsgithubcomjstanhdrblobmasterrutilsr httpsgithubcomjstanhdrblobmasterrgetr determin zip avail avail unzip z zipfil destin directori avoid need use archiv packag avail via github author joseph stachelek emailstachelmsuedu keywordintern gener roxygen edit hand pleas edit document rnsink_prep_datar namensink_prep_nlcd aliasnsink_prep_nlcd titleprepar nlcd data nsink usag nsink_prep_nlcdhuc_sf huc_rast data_dir year argument itemhuc_sfan sf object watersh boundari dataset huc itemhuc_rastera raster object watersh boundari dataset huc itemdata_dirbas directori contain nsink data folder data may download codelinknsink_get_data function itemyearth year nlcd impervi data retriev feddata codelinkget_nlcd function valu raster object nlcd huc_sf descript standard nlcd data project coorect cr standard file name keywordintern gener roxygen edit hand pleas edit document rnsink_calc_removalr namensink_calc_land_remov aliasnsink_calc_land_remov titlecalcul landbas nitrogen remov usag nsink_calc_land_removalinput_data argument iteminput_dataa name list ssurgo impervi lake raster_templ valu list raster vector version land base nitrogen remov descript calcul landbas nitrogen remov keywordintern gener roxygen edit hand pleas edit document rnsink_prep_datar namensink_prep_impervi aliasnsink_prep_impervi titleprepar impervi cover data nsink usag nsink_prep_impervioushuc_sf huc_rast data_dir year argument itemhuc_sfan sf object watersh boundari dataset huc itemhuc_rastera raster object watersh boundari dataset huc itemdata_dirbas directori contain nsink data folder data may download codelinknsink_get_data function itemyearth year nlcd impervi data retriev feddata codelinkget_nlcd function valu raster object impervi cover huc_sf descript standard impervi data project coorect cr standard file name keywordintern gener roxygen edit hand pleas edit document rnsinkr namensink aliasnsink titlensink packag implement flow path analysi nitrogen remov descript nsink approach base research outlin hrefhttpsdoiorgjecolengkellogg et al approach build peerreview literatur form review metaanalys ie hrefhttpsdoiorgdoijeqmay et al hrefhttpsdoiorgjxalexand et al hrefhttpsdoiorgdalawacoseitzing et al estim nitrogen n remov within three type landscap sink wetland stream lake along given flow path within huc basin codensink packag implement approach use publicli avail spatial data identifi flow path estim n remov landscap sink remov rate depend retent time influenc physic characterist identifi use publicli avail spatial data nation hydrographi dataset nhd watersh boundari dataset wbd nation land cover dataset nlcd soil survey geograph dataset ssurgo static map specifi huc basin gener n remov effici n load index n transport index n deliveri index map may use inform local decisionmak highlight area prone n leaki area contribut n remov refer kellogg q gold j cox addi k august p v geospati approach assess denitrif sink within lowerord catchment ecolog engin hrefhttpsdoiorgjecolenglink mayer p reynold jr k mccutchen canfield j metaanalysi nitrogen remov riparian buffer j environ qual hrefhttpsdoiorgdoijeqlink alexand r b boyer e w smith ra schwarz ge moor r b role headwat stream downstream water qualiti j water resouassoc hrefhttpsdoiorgjxlink seitzing p harrison ja hohlk jk bouwman af lowranc r peterson b tobia c van drecht g denitrif across landscap waterscap synthesi ecol appl hrefhttpsdoiorgdalawacolink gener roxygen edit hand pleas edit document rnsink_calc_removalr namensink_merge_remov aliasnsink_merge_remov titlemerg remov raster singl raster usag nsink_merge_removalremoval_rast argument itemremoval_rastersa name list land_remov stream_remov lake_remov raster_templ raster plu sf object huc valu raster landscap nitrogen remov descript merg remov raster singl raster keywordintern gener roxygen edit hand pleas edit document rnsink_generate_static_mapsr namensink_generate_static_map aliasnsink_generate_static_map titlegener nsink static map given huc usag nsink_generate_static_map input_data remov samp_den ncpu futureavailablecor seed argument iteminput_dataa list input dataset creat codelinknsink_prep_data itemremovalth remov raster stack remov list gener codelinknsink_calc_remov itemsamp_densa valu unit input data divid total area input huc use determin number point determin regular sampl calcul remov instanc valu would roughli equat point per everi meter itemncpunumb cpu use calcul flowpath remov larger ie greater number flowpath default number core avail minu one itemseedrandom seed ensur reproduc sampl point creation transport map default set valu function return list raster nitrogen remov effici nitrogen load index nitrogen transport index nitrogen deliveri index descript gener nsink static map given huc exampl dontrun librarynsink niantic_huc nsink_get_huc_idniant riverhuc_ niantic_data nsink_get_dataniantic_huc data_dir nsink_data aea niantic_nsink_data nsink_prep_dataniantic_huc project aea data_dir nsink_data remov nsink_calc_removalniantic_nsink_data static_map nsink_generate_static_mapsniantic_nsink_data removalsamp_den gener roxygen edit hand pleas edit document rnsink_calc_removalr namensink_calc_lake_remov aliasnsink_calc_lake_remov titlecalcul lakebas nitrogen remov usag nsink_calc_lake_removalinput_data argument iteminput_dataa name list stream lake tot lakemorpho raster_templ valu raster vector version lake base nitrogen remov descript calcul lakebas nitrogen remov keywordintern gener roxygen edit hand pleas edit document rutilsr namensink_get_closest aliasnsink_get_closest titleget closest usag nsink_get_closestv v argument itemvth first vector valu like length area featur itemvth second vector valu also like length area featur valu return vector length v index v closest absolut valu valu v descript function return index one vector closest absolut valu valu anoth vector usual use identifi closest lake stream area length respect anoth lake stream keywordintern gener roxygen edit hand pleas edit document rutilsr namensink_get_closest_lt aliasnsink_get_closest_lt titleget closest less usag nsink_get_closest_ltv v argument itemvth first vector valu like length area featur itemvth second vector valu also like length area featur valu return vector length v index v less closest absolut valu valu v descript function return index one vector closest less absolut valu valu anoth vector valu v less valu v next closest return usual use identifi closest lake stream area length respect anoth lake stream keywordintern gener roxygen edit hand pleas edit document rnsink_prep_datar namensink_prep_tot aliasnsink_prep_tot titleprepar time travel data nsink usag nsink_prep_totdata_dir argument itemdata_dirbas directori contain nsink data folder data may download codelinknsink_get_data function valu tibbl time travel data descript standard time travel nhdplu vaa tabl keywordintern gener roxygen edit hand pleas edit document rnsink_summarize_flowpathr namensink_group_land_off_network aliasnsink_group_land_off_network titlensink group land network usag nsink_group_land_off_networkland_removal_df argument itemland_removal_dfland network summari df descript nsink group land network keywordintern gener roxygen edit hand pleas edit document rnsink_buildr namensink_write_prepped_data aliasnsink_write_prepped_data titlewrit prep data file usag nsink_write_prepped_dataprepped_data output_dir argument itemprepped_dataa list prep data output codelinknsink_prep_data itemoutput_diroutput folder save process nsink file descript write data either shapefil vector data tiff raster data keywordintern gener roxygen edit hand pleas edit document rnsink_summarize_flowpathr namensink_create_segment_id aliasnsink_create_segment_id titlecr id uniqu valu vector usag nsink_create_segment_idsx argument itemxa vector valu creat uniqu id valu vector uniqu id descript function take vector valu creat uniqu id adjac ident valu keywordintern gener roxygen edit hand pleas edit document rnsink_generate_flowpathr namensink_get_flowpath_end aliasnsink_get_flowpath_end titleget flowpath begin end usag nsink_get_flowpath_endsflowpath stream tot argument itemflowpathan codesf linestr flowpath gener codelinknsink_generate_flowpath itemstreamsnhdplu stream codelinknsink_prep_data itemtotnhdplu time travel codelinknsink_prep_data provid node valu codesf object portion flowpath repres nhdplu flowlin descript flowpath land portion need gener flow direct grid function extract portion gener flowpath may issu network waterbodi may need find section without connect flowpath keywordintern gener roxygen edit hand pleas edit document rnsink_generate_static_mapsr namensink_generate_n_loading_index aliasnsink_generate_n_loading_index titlegener nitrogen load index usag nsink_generate_n_loading_indexinput_data argument iteminput_datalist input data descript function reclassifi nlcd data index nitrogen load index rang keywordintern gener roxygen edit hand pleas edit document rnsink_generate_flowpathr namensink_split_flowlin aliasnsink_split_flowlin titlesplit flowlin intersect flowpath usag nsink_split_flowlineflowpath_end flowpath_network argument itemflowpath_endsth end flowpath part network itemflowpath_networkth flowpath network valu codesf object nhdplu flowlin split fp end intersect flowlin descript take flowpath input keywordintern gener roxygen edit hand pleas edit document rnsink_summarize_flowpathr namensink_summarize_flowpath aliasnsink_summarize_flowpath titlesummar nitrogen remov along flowpath usag nsink_summarize_flowpathflowpath remov argument itemflowpatha flowpath summar nitrogen remov itemremovalth remov raster stack remov list gener codelinknsink_calc_remov valu data frame return summari nitrogen remov descript nitrogen remov vari along flowpath may includ differ land cover waterbodi type differ nitrogen reduct capabl function requir flowpath gener codelinknsink_generate_flowpath input return estim total flow path remov well remov type exampl dontrun librarynsink niantic_huc nsink_get_huc_idniant riverhuc_ niantic_data nsink_get_dataniantic_huc data_dir nsink_data aea niantic_nsink_data nsink_prep_dataniantic_huc project aea data_dir nsink_data remov nsink_calc_removalniantic_nsink_data pt c start_loc st_sfst_sfcst_pointcpt cr aea fp nsink_generate_flowpathstart_loc niantic_nsink_data flow_summari nsink_summarize_flowpathfp remov flow_summari gener roxygen edit hand pleas edit document rnsink_calc_removalr namensink_calc_removal_typ aliasnsink_calc_removal_typ titlecr remov type raster usag nsink_calc_removal_typeremoval_rast argument itemremoval_rastersa name list land_remov stream_remov lake_remov raster_templ raster plu sf object huc valu raster landscap nitrogen remov descript creat remov type raster keywordintern gener roxygen edit hand pleas edit document rnsink_get_datar namensink_get_data aliasnsink_get_data titleget nsink data given huc usag nsink_get_data huc data_dir normalizepathnsink_data winslash forc fals year argument itemhuca charact string huc identifi current run singl huc time packag develop use digit huc lightli test larger huc appear work certain case itemdata_dira directori store nsink data download default nsink_data insid current work directori creat doesnt exist may use multipl huc data doesnt current exist download itemforcelog determin file download alreadi exist local itemyearan argument pass feddata codelinkget_nlcd function default valu return list huc use directori data store descript requir dataset nsink analysi avail multipl onlin resourc function take huc input download local copi dataset place local directori insid directori new folder nhd plu raster process unit creat use folder data directori act cach imperfect though download new dataset alreadi download exampl dontrun librarynsink niantic_huc nsink_get_huc_idniant riverhuc_ nsink_get_datahuc niantic_huc data_dir nsink_data forc true