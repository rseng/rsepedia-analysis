coordinateclean v cran_status_badgehttpswwwrpkgorgbadgesversioncoordinatecleanerhttpscranlogsrpkgorgbadgescoordinateclean downloadshttpscranlogsrpkgorgbadgesgrandtotalcoordinatecleanerhttpscranlogsrpkgorgbadgesgrandtotalcoordinateclean rstudio mirror downloadshttpscranlogsrpkgorgbadgescoordinatecleanerhttpscranlogsrpkgorgbadgescoordinateclean project statu activ project reach stabl usabl state activ developedhttpswwwrepostatusorgbadgeslatestactivesvghttpswwwrepostatusorgact doihttpszenodoorgbadgedoizenodosvghttpsdoiorgzenodo ropensci peerreviewhttpsbadgesropensciorg_statussvghttpsgithubcomropenscisoftwarereviewissu autom flag common spatial tempor error biolog palaeontolog collect data use conserv ecolog palaeontolog specif includ test gener coordin valid countri provinc centroid capit coordin coordin biodivers institut spatial outlier tempor outlier coordinatecountri discord duplic coordin per speci assign locat gbif headquart urban area sea plain zero equal longitud latitud round coordin ddmm dddd coordin convers error larg tempor uncertainti fossil equal minimum maximum age fossil spatiotempor outlier fossil coordinateclean particularli use improv data qualiti use data gbif eg obtain rgbif httpsgithubcomropenscirgbif paleobiolog databas eg obtain paleobiodbhttpsgithubcomropenscipaleobiodb histor biogeographi eg biogeobearshttpscranrprojectorgpackagebiogeobear phytoolshttpscranrprojectorgpackagephytool autom conserv assess eg speciesgeocoderhttpsgithubcomazizkaspeciesgeocoderwiki conrhttpscranrprojectorgpackageconr speci distribut model eg dismohttpscranrprojectorgpackagedismo sdmhttpscranrprojectorgpackagesdm see scrubrhttpsgithubcomropensciscrubr taxizehttpsgithubcomropenscitax complementari taxonom clean biogeohttpsgithubcomcranbiogeo correct spatial coordin error see newshttpsgithubcomropenscicoordinatecleanerblobmasternewsmd updat inform instal stabl cran r installpackagescoordinateclean librarycoordinateclean development github r devtoolsinstall_githubropenscicoordinateclean librarycoordinateclean usag simpl exampl r simul exampl data minag runif exmpl dataframespeci samplelett size replac true decimallongitud runif min max decimallatitud runif min max min_ma minag max_ma minag runif dataset clean run recordlevel test rl clean_coordinatesx exmpl summaryrl plotrl dataset level dsl clean_datasetexmpl fossil fl clean_fossilsx exmpl taxon speci lon decimallongitud lat decimallatitud summaryfl altern exampl use pipe librarytidyvers cl exmpl cc_val cc_cap cd_ddmm cf_rangelon decimallongitud lat decimallatitud taxon speci document pipelin clean data global biodivers inform facil gbif paleobiolog databas paleobiodb avail herehttpsropenscigithubiocoordinatecleanerarticl contribut see contributinghttpsgithubcomropenscicoordinatecleanerblobmastercontributingmd document citat zizka silvestro andermann azevedo j duart ritter c edler farooq h herdean ariza scharn r svanteson wengtrom n zizka v antonelli coordinateclean standard clean occurr record biolog collect databas method ecolog evolut doix httpsgithubcomropenscicoordinateclean ropensci_footerhttpsropensciorgpublic_imagesropensci_footerpnghttpsropensciorg coordinateclean minor improv fix typo vignett fix cran warn rebuild vignett remov defunct function ad wordlist coordinateclean minor improv adapt descript file style coordinateclean minor improv precomput vignett need internet access coordinateclean minor improv fix bug occasion caus invalid polygon cc_coun cc_sea ad refer countri centroid sourc coordinateclean minor improv ad option adapt geograph extent plot method object class spatialvalid fix bug handl outlier test clean_coordin improv handl larg datafram plot method object class spatialvalid readapt default countri column name rnaturalearth column name coordinateclean minor improv adapt url format descript file coordinateclean minor improv fix bug cc_cen set altern refer ad ref_col argument cc_coun custom column iso code refer data adapt code chang sp rgdal defunct cleancoordin cleancoordinatesd cleancoordinatesfo fix issu input datafram unord rownam cc_outl fix ra found bug cc_outl coordinateclean minor improv address ra found bug cc_outl coordinateclean minor improv improv document cc_outl improv handl rownam cc_outl coordinateclean minor improv chang descript file coordinateclean minor improv improv error handl cc_sea cc_urb case default refer obtain web ad refer methodolog descript file coordinateclean minor improv recod cc_outl ad thin argument account sampl bia fix bug cc_outl test produc erron flag set mltpl extend exampl dataset coordin leveltest suit realist coordinateclean minor improv move vignett onlin document ad area column countryref dataset fix minor spell issu document coordinateclean minor improv ad citat reduc test time cran improv document cc_outl function coordinateclean minor improv url fix coordinateclean minor improv fix broken url cia factbook coordinateclean minor improv minor bugfix cc_cap correct duplic vignett index entri updat maintain email coordinateclean minor improv remov conveni function download data rnaturalearth first use compli cran guidelin coordinateclean major improv tutori outlier detect bookdown document tutori use custom gazett rasteris heurist cc_outl ad sampl correct cc_outl ad verifi option cc_inst transfer ropensci minor improv reduc packag size switch data download rnaturalearth urbanarea landmass fix issu name plotspatialvalid group function document webpag fix broken link help page improv document structur coordinateclean major improv chang consist name scheme function minor improv fix typo readm set download naturalearth default cc_urb reduc vignett memori use size enabl sf format custom refer ad speedup option cc_sea ad webpag httpsazizkagithubiocoordinateclean coordinateclean major improv adapt function argument name consist underscore_cas simplifi intern code structur wrapper function minor improv adapt packag ropensci review deprec defunct cleancoordin deprec replac clean_coordin cleancoordinatesd deprec replac clean_dataset cleancoordinatesfo deprec replac clean_fossil writepyr deprec replac write_pyr coordinateclean minor improv switch document namespac gener roxygen switch sappli vappli improv code readabl coordinateclean new featur minor improv adapt code ropensci guidelin bug fix deprec defunct contribut bug suggest featur request submit issu issu pagehttpsgithubcomazizkacoordinatecleanerissu sure includ r session inform reproduc exampl code contribut want contribut packag awesom pleas get touch zizkaalexandergmailcommailtozizkaalexandergmailcom version fix warn result unbalanc code chunk delimit one vignett previou version cran addit chang maintain email due chang institut note spell error descript spuriou opinion sinc flag last name latin abbrevi et al literatur refer packag remov cran due slow respons time respons time slow parent leav coordinateclean v build statushttpstravisciorgropenscicoordinatecleanersvgbranchmasterhttpstravisciorgropenscicoordinateclean codecoviohttpscodecoviogithubropenscicoordinatecleanergraphsbadgesvgbranchmasterhttpscodecoviogithubropenscicoordinateclean cran_status_badgehttpswwwrpkgorgbadgesversioncoordinatecleanerhttpscranrprojectorgpackagecoordinateclean downloadshttpscranlogsrpkgorgbadgesgrandtotalcoordinatecleanerhttpcranlogsrpkgorgbadgesgrandtotalcoordinateclean rstudio mirror downloadshttpscranlogsrpkgorgbadgescoordinatecleanerhttpcranlogsrpkgorgbadgescoordinateclean project statu activ project reach stabl usabl state activ developedhttpswwwrepostatusorgbadgeslatestactivesvghttpswwwrepostatusorgact doihttpszenodoorgbadgedoizenodosvghttpsdoiorgzenodo ropensci peerreviewhttpsbadgesropensciorg_statussvghttpsgithubcomropenscisoftwarereviewissu chang document coordinateclean version find three vignett clean point occurr record instanc wwwgbiforg fossil data use custom gazett packag addit inform datasetlevel clean identifi geograph outlier found herehttpsbesjournalsonlinelibrarywileycomdoifullx autom flag common spatial tempor error biolog palaeontolog collect data use conserv ecolog palaeontolog specif includ test gener coordin valid countri provinc centroid capit coordin coordin biodivers institut spatial outlier tempor outlier coordinatecountri discord duplic coordin per speci assign locat gbif headquart urban area sea plain zero equal longitud latitud round coordin ddmm dddd coordin convers error larg tempor uncertainti fossil equal minimum maximum age fossil spatiotempor outlier fossil coordinateclean particularli use improv data qualiti use data gbif eg obtain rgbif httpsgithubcomropenscirgbif paleobiolog databas eg obtain paleobiodbhttpsgithubcomropenscipaleobiodb histor biogeographi eg biogeobearshttpscranrprojectorgpackagebiogeobear phytoolshttpscranrprojectorgpackagephytool autom conserv assess eg speciesgeocoderhttpsgithubcomazizkaspeciesgeocoderwiki conrhttpscranrprojectorgpackageconr speci distribut model eg dismohttpscranrprojectorgpackagedismo sdmhttpscranrprojectorgpackagesdm see scrubrhttpsgithubcomropensciscrubr taxizehttpsgithubcomropenscitax complementari taxonom clean biogeohttpsgithubcomcranbiogeo correct spatial coordin error find detail comparison function coordinateclean scrubr biogeo herehttpsropenscigithubiocoordinatecleanerarticlescomparison_other_softwarehtml see newshttpsgithubcomropenscicoordinatecleanerblobmasternewsmd updat inform instal stabl cran r installpackagescoordinateclean librarycoordinateclean development use devtool r devtoolsinstall_githubropenscicoordinateclean librarycoordinateclean usag simpl exampl r simul exampl data minag runif exmpl dataframespeci samplelett size replac true decimallongitud runif min max decimallatitud runif min max min_ma minag max_ma minag runif dataset clean run recordlevel test rl clean_coordinatesx exmpl summaryrl plotrl dataset level dsl clean_datasetexmpl fossil fl clean_fossilsx exmpl taxon speci lon decimallongitud lat decimallatitud summaryfl altern exampl use pipe librarytidyvers cl exmpl cc_val cc_cap cd_ddmm cf_rangelon decimallongitud lat decimallatitud taxon speci document pipelin clean data global biodivers inform facil gbif paleobiolog databas paleobiodb avail herehttpsropenscigithubiocoordinatecleanerarticl contribut see contributinghttpsgithubcomropenscicoordinatecleanerblobmastercontributingmd document citat zizka silvestro andermann azevedo j duart ritter c edler farooq h herdean ariza scharn r svanteson wengtrom n zizka v antonelli coordinateclean standard clean occurr record biolog collect databas method ecolog evolut doix httpsgithubcomropenscicoordinateclean ropensci_footerhttpsropensciorgpublic_imagesropensci_footerpnghttpsropensciorg titl clean gbif data use biogeographi output rmarkdownhtml_vignett fig_capt true number_sect true self_contain bibliographi coordinatecleanerbib csl apacsl vignett vignetteindexentryclean gbif data use biogeographi vignetteengineknitrrmarkdown vignettesuggestsrgbif usepackageutfinputenc background big data aggreg global biodivers inform facil gbif wwwgbiforg vastli increas public avail speci occurr record gbif alon compris million record across taxonom group data provid via sourc revolution scientif biogeographi highli valuabl research howev issu exist concern data qualiti mostli data compris varieti differ collect method museum specimen scientif survey citizen scienc popul count conserv purpos genet barcod among other differ sourc museum herbaria collect individu research citizen scienc photo app digit edit variou peopl algorithm differ point time space tutori provid pipelin clean occurr record retriev gbif databas use coordinateclean meta data tutori includ major step consid necessari mean complet explicitli encourag explor data use tutori use data set occurr record singl speci lion panthera leo download gbif exampl gaug qualiti clean step alreadi good idea expect lion occur cours usual multispeci data set kind inform whole point autom clean easili follow tutori use data instead tutori assum global macroecolog analysi resolut km downstream analys rememb adjust test sensit analys coarser finer resolut tutori abl visual data identifi potenti problem use coordinateclean automat flag problemat record use gbif provid metadata improv coordin qualiti tailor downstream analys use autom clean algorithm coordinateclean identifi problemat contribut dataset identifi erron coordin coordinateclean clean_coordin function wrapper function around recordlevel test coordinateclean idea behind test use geograph gazett identifi record like erron imprecis base choic test common problem observ biolog collect databas maldonado includ assign countri centroid sea coordin outlier among other get overview individu test use clean_coordin via packag vignetteshttpsropenscigithubiocoordinateclean tutori assum occurr data format download gbif format might need adapt column name might need instal requir packag tutori use installpackag instal coordinateclean instal latest stabl version coordinateclean cran use installpackagescoordinateclean altern instal latest develop version github use devtool packag recommend latter stay uptod also make sure latest r version instal r installpackagesdevtool librarydevtool install_githubropenscicoordinateclean set librari data might need confirm instal rnaturalearth packag load coordinateclean r librarycountrycod librarycoordinateclean librarydplyr libraryggplot libraryrgbif librarysp obtain data gbif via rgbif dat occ_searchscientificnam panthera leo limit hascoordin dat datdata namesdat lot column select column interest dat dat dplyrselectspeci decimallongitud decimallatitud countrycod individualcount gbifid famili taxonrank coordinateuncertaintyinmet year basisofrecord institutioncod datasetnam remov record without coordin dat dat filterisnadecimallongitud filterisnadecimallatitud visual data map r plot data get overview wm bordersworld colourgray fillgray ggplot coord_fix wm geom_pointdata dat aesx decimallongitud decimallatitud colour darkr size theme_bw labelfigaloccurr record panthera leo obtain gbifgbifclgbifpng map clearli indic need prepar data want repres current day histor distribut lion use coordinateclean automat flag problemat record option use clean_coordin wrapper function first step run automat clean algorithm coordinateclean clean_coordin function wrapper around larg set autom clean step flag error common biolog collect includ sea coordin zero coordin coordin countri mismatch coordin assign countri provinc centroid coordin within citi area outlier coordin coordin assign biodivers institut switch test individu use logic flag modifi sensit individu test use rad argument provid custom gazett use ref argument see clean_coordin help use countri coordin mismatch test need convert countri iso iso format r convert countri code isoc isoc datcountrycod countrycodedatcountrycod origin isoc destin isoc flag problem dat dataframedat flag clean_coordinatesx dat lon decimallongitud lat decimallatitud countri countrycod speci speci test ccapit centroid equalgbif institut zero countri test default test coordin valid flag record test equal latlon flag record test zero coordin flag record test countri capit flag record test countri centroid flag record test countri ident flag record test gbif headquart flag record around copenhagen flag record test biodivers institut flag record flag record eq summaryflag plotflag lon decimallongitud lat decimallatitud labelfigautomatedrecord flag autom cleaninggbifclgbifpng val equ zer cap cen con gbf inst summari automat test flag record purpos tutori exclud flag record gener recommend explor r exclud problemat record dat_cl datflagssummari flag record dat_fl datflagssummari option b use magrittr pipe altern run test implement coordinateclean individu function connect use magrittr pipe oper directli result datafram compris clean record r avoid specifi function namesdat cdecimallongitud decimallatitud clean dat cc_val cc_equ cc_cap cc_cen cc_couniso countrycod cc_gbif cc_inst cc_sea cc_zero cc_outl cc_dupl way also add individu test result column initi datafram r dat as_tibbl mutatev cc_val valu flag sea cc_sea valu flag tempor outlier cc_outl function identifi geograph outlier record gbif migh also doubt tempor inform ie time collect problemat exampl analys rang dynam cf_age function use fossil clean also use check gbif record tempor outlier r flag cf_agex dat_cl lon decimallongitud lat decimallatitud taxon speci min_ag year max_ag year valu flag test tempor outlier taxon level flag record dat_clflag year dat_cl dat_clflag improv data qualiti use gbif metadata help lot unfortun unwant record remain especi within europ fig reffigautom mostli use occurr record uncrit ignor metadata gbif offer whole lot use metadata use refin qualiti dataset first well remov coordin low precis unsuit data sourc remov record precis km repres grain size downstream analysi recommend chose base downstream analys also exclud fossil interest recent distribut record unknown sourc deem reliabl enough r remov record low coordin precis histdat_clcoordinateuncertaintyinmet break labelfigautomateda histogram coordin precis datasetgbifclgbifpng r dat_cl dat_cl filtercoordinateuncertaintyinmet isnacoordinateuncertaintyinmet remov unsuit data sourc especi fossil respons major problem case tabledatbasisofrecord fossil_specimen human_observ machine_observ material_sampl observ preserved_specimen unknown dat_cl filterdat_cl basisofrecord human_observ basisofrecord observ basisofrecord preserved_specimen next step remov record suspici individu count gbif includ record absenc individu count suspici high occurr count might indic inappropri data data entri problem r individu count tabledat_clindividualcount r dat_cl dat_cl filterindividualcount isnaindividualcount filterindividualcount isnaindividualcount high count problem might also want exclud old record like unreli instanc record second world war often imprecis especi georeferenc base polit entiti addit old record might like area speci went extinct exampl due landus chang r age record tabledat_clyear r dat_cl dat_cl filteryear remov record second world war top geograph clean also want make sure includ speci level record record right taxon latter problem case one speci help larg dataset taxonom problem spell mistak name synonym sever problem well treat taxonom clean need check taxiz r packagehttpsdocsropensciorgtax taxonom name resolut servicehttpstnrsbiendataorg plant r tabledat_clfamili look good felida dat_cl dat_cl filterfamili felida tabledat_cltaxonrank also good speci subspeci exclud almost initi data point data clean gener pictur improv consider confin record mostli consid current day distribut speci interest fig reffigfin howev also lost quit number record gener onesizefitsital data qualiti geograph speci occurr record cours highest coordin precis desir accept strongli depend downstream analys speci distribut model usual high precis necessari eg km analys biogeograph reconstruct use tecton plate record might consid good enough qualiti long right contin anoth exampl conserv purpos might suffici know speci present within certain countri improv data qualiti use extern inform figur reffigfin show success autom clean howev three record within europ remain short inspect data suggest dubiou human observ five specimen potenti assign specimen locat fossil misclassifi metadata one option automat flag record rerun outlier test clean data howev would like also flag isol indian popul true presenc problemat flag record base fix longitud latitud first option altern exclud record outsid certain studi extent exampl easiest solut know lion occur high latitud r exclud base studi area dat_fin filterdat_cl decimallatitud flag record base speci natur rang case simpl latitudin longitudin border use altern use speci rang extern sourc refer flag record fall outsid rang amphibian bird mammal reptil intern union conserv natur iucn provid detail shape file speci natur distribut rang download free httpswwwiucnredlistorgresourcesspatialdatadownload coordinateclean implement straight forward way use rang flag record cc_iucn function sinc download iucn shape requir login approxim lion natur rang scratch exampl plant check botan countri world checklist select plant familieshttpwcspsciencekeworghomedo r creat simpl natur rang lion rang polygoncbindc c rang polygonslistrang id ca wg projlonglat datumwg no_def ellpswg towg rang spatialpolygonslistrang projstr crswg df dataframespeci cpanthera leo rownam ca nat_rang spatialpolygonsdataframerang data asdataframedf visual rang plo fortifynat_rang region defin polygon ggplot bordersworld colourgray fillgray geom_polygondata plo aesx long lat group group theme_bw themelegendposit none axistitl element_blank plot chunk clgbifgbifclgbifpng r run cc_iucn range_flag cc_iucnx dat_cl rang nat_rang lon decimallongitud lat decimallatitud valu flag test natur rang warn spprojstringrang cr object comment lost output warn spprojstringrang cr object comment lost output flag record dat_fin dat_clrange_flag labelfigfinalth dataset occurr lion differ clean phasesgbifclgbifpng identifi problemat data set type potenti problemat coordin caus bia identifi recordlevel relev metadata miss especi case erron record combin precis gpsbase point occurr dataset mix precis two import case coordin convers error base misinterpret degre sign decim delimit b data deriv raster data collect design eg presenc x km grid cell coordinateclean implement two algorithm identifi problem dataset level identifi dataset ddmm dddd convers error first run test erron data convers due misinterpret degre sign decim delimit use cd_ddmm function altern use clean_dataset wrapper see supplementari materi detail descript algorithm implement test control output function via valu argument r outddmm cd_ddmmdat_cl lon decimallongitud lat decimallatitud ds speci diagnost diff valu dataset plot chunk clgbifgbifclgbifpng look good test indic slightli higher fraction record decim expect random within expect rang thu test indic bia confirm diagnost plot case strong bia green point would cluster bottom left quarter plot test raster sampl second step use cd_round function identifi dataset signific proport coordin collect larg scale lattic design record might low precis might therefor problemat analys instanc presenc deriv degre grid nation atla might coars small scale speci distribut model r parmfrow c mar rep outround cd_rounddat_fin lon decimallongitud lat decimallatitud ds speci valu dataset graph test raster collect labelfigfinaldiagnost plot test raster sampl excess round left panel show histogram record distribut right panel show autocorrel plot upper panel show longitud lower panel show latitud logic flag head right panel indic binari flaggbifclgbifpng result look good dataset show raster collect scheme see supplementari materi exampl bias dataset test detect flag small scale low intens period longitud coordin howev entir dataset flag longitud latitud show pattern expect raster sampl modifi test sensit use variou argument see cd_round inform lion dataset rel small consist least way compris speci larger scale analys might need deal larger dataset compos larger varieti sourc refer titl comparison coordinateclean tool output rmarkdownhtml_vignett vignett vignetteindexentrycomparison coordinateclean tool vignetteengineknitrrmarkdown vignetteencodingutf background erron databas entri problemat geograph coordin central issu biogeographi set tool avail address differ dimens problem coordinateclean focus fast reproduc flag larg amount record addit function detect datasetlevel fossilspecif bias renviron scrubrhttpsgithubcomropensciscrubr biogeohttpscranrprojectorgpackagebiogeo offer clean approach complementari coordinateclean scrubr packag combin basic geograph clean compar cc_dupl cc_zero cc_count coordinateclean add option clean taxonom name see also taxizehttpsgithubcomropenscitax date inform biogeo includ basic autom geograph clean similar cc_val cc_count cc_outl rather focuss correct suspici coordin manual basi use environment inform tabl function function comparison coordinateclean scrubr biogeo function coordinateclean scrubr biogeo percent overlap miss coordin cc_val coord_incomplet missingvalsexclud coordin outsid cr cc_val coord_imposs duplic record cc_dupl dedup duplicatesexclud aim ident method differ coordin cc_zero coord_unlik ident lonlat cc_equ countri capit cc_cap polit unit centroid cc_cen coordin incongru addit locat inform cc_count coord_within errorcheck quickclean coordin assign gbif headquart cc_gbif coordin assign locat biodivers institut cc_inst coordin outsid natur rang cc_iucn spatial outlier cc_outl outlier biogeo use environment distanc coordin within ocean cc_sea coordin urban area cc_urb coordin convers error dc_ddmm round coordinatesraster collect dc_round precisioncheck biogeo test predefin raster fossil invalid age rang tc_equal fossil excess age rang tc_rang fossil tempor outlier tc_outl fossil pyrat interfac writepyr wrapper function run test cleancoordin cleancoordinatesd cleancoordinatesfo databas biodivers institut institut taxonom clean tax_no_epithet miss date date_miss add date date_cr date format date_standard reformat coordin annot larg set function correct coordin use guess environment distanc larg set function titl clean fossil data use biogeographi palaeontolog output rmarkdownhtml_vignett fig_capt true number_sect true citation_packag natbib vignett vignetteindexentryclean fossil data use biogeographi palaeontolog vignetteengineknitrrmarkdown usepackageutfinputenc vignettesuggestspaleobiodb background public avail fossil largescal analys rapidli increas mainli due increas databas effort data aggreg paleobiolog databas wwwpaleobiodborg neotoma wwwneotomadborg among other howev data qualiti issu particular old collect collect uncertain taxonomi andor bad preserv similar problem known biolog collect databas see supplementari materi relev fossil addit fossil might date wrongli low precis tutori present pipelin clean fossil data paleobiolog databas use biogeograph evolutionari analys focu identifi overli imprecis georeferenc andor date record combin autom clean use coordinateclean clean base metadata propos step mean exhaust keep mind good data depend entir downstream analys wrote tutori whole coordinateclean packag help identifi potenti problem quicker reproduc improv data qualiti larg dataset sake tutori mostli remov flag record dataset howev recommend doubl check individu instal coordinateclean instal latest stabl version coordinateclean current cran use installpackagescoordinateclean altern instal latest develop version github use devtool packag recommend latter stay uptod also make sure latest r version instal tutori relev rcode shown grey box result output line mark r installpackagesdevtool librarydevtool install_githubropenscicoordinateclean load requir librari first step load r librari requir tutori might need instal use installpackag r librarydplyr libraryggplot librarycoordinateclean librarycountrycod librarypaleobiodb load test dataset tutori use dataset vascular plant fossil last million year download paleobiolog databas use plaeobiodb packag tutori well limit data maximum record keep download time reason obtain data web mask paleobiolog databas use entir differ databas adapt column name script r load data dat paleobiodbpbdb_occurrencesbase_nam magnoliopsida vocab pbdb limit show ccoord phylo attr loc time rem rownamesdat null altern coordinateclean includ exampl dataset download paleobiodb specifi use one rest tutori visual record map first step visual record map get gener overview r plot data get overview wm bordersworld colourgray fillgray ggplot coord_fix wm geom_pointdata dat aesx lng lat colour darkr size theme_bw plot chunk unnamedchunkpbdbunnamedchunkpng coordinateclean coordinateclean includ suit autom test identifi problem common biolog palaebiolog databas spatial issu well first check coordin valid check coordin numer part latlon coordin refer system use cc_val r cl cc_valdat lat lat lon lng test coordin valid remov record look good test coordin equal longitud latitud use test argument specifi coordin flag absolut valu ident eg r cl cc_equcl lat lat lon lng test equal latlon remov record purpos tutori alway exclud flag record want explor mean possibl use valu flag argument valid function case output valu vector logic valu length dat true valid record fals flag record gener advis check flag record whenev possibl avoid dataloss fals flag r fl cc_equdat valu flag lat lat lon lng test equal latlon flag record extract check flag record fl_rec datfl headfl_rec occurrence_no record_typ collection_no taxon_nam taxon_rank taxon_no matched_nam matched_rank matched_no early_interv late_interv early_ag late_ag reference_no lng lat class class_no phylum phylum_no cc state geogscal early_ag late_ag cx_int_no early_int_no late_int_no genu genus_no famili family_no order order_no counti reid_no row length rownam well also test record ident close vicin centroid polit unit modifi buffer around centroid use buffer argument level test countri centroid provinc centroid use test argument case list geograph coordin consid problemat instanc list citi provid custom gazett use ref argument r fl cc_cencl lat lat lon lng valu flag test countri centroid flag record fl_rec clfl uniquefl_reccc jp level nz us cn ir kp au uk fr jp de ca ru ke zm eg cd za tz ug et mx cl clfl next test coordin within countri assign test bit tricki also flag record countri name countri column follow iso record assign differ polit landscap instanc record former western eastern germani need convert countri annot column cc iso iso advis doubl check record flag avoid unnecessari data loss see r adapt countri code iso countri test cs_ma gbr namescs_ma uk clcc_iso countrycodeclcc origin isoc destin isoc custom_match cs_ma cl cc_councl lat lat lon lng iso cc_iso test countri ident remov record next test record bear coordin host biodivers institut gbif headquart use institut databas coordinateclean countri centroid test chang buffer around institut buffer argument r cl cc_instcl lat lat lon lng test biodivers institut remov record cl cc_gbifcl lat lat lon lng test gbif headquart flag record around copenhagen remov record final test plain zero coordin eg r cl cc_zerocl lat lat lon lng test zero coordin remov record tempor issu spatial clean mostli ident step recent geograph record addit emphcoordinateclean includ three function test tempor dimens fossil fossil age usual defin maximum minimum rang base geolog strata first exclud record without date inform na test record equal minimum maximum rang unless data includ absolut date fossil like data entri error r cl clisnacllate_ag cl clisnaclearly_ag cl cf_equalcl min_ag late_ag max_ag early_ag test age valid remov record next look age rang max age min age record age rang date precis vari consider depend data avail date mani analys instanc pyrat imprecis date record suitabl let first look age rang test dataset r rang clearly_ag cllate_ag histrang break xlab date rang max age min age main plot chunk unnamedchunkpbdbunnamedchunkpng individu record date precis million year emphcoordinateclean offer two way flag record base age rang base absolut age eg age rang million year base age rang outlier detect entir dataset eg record much less precis date rest record base age rang outlier detect taxon level eg emphquercu record much less precis date emphquercu record second third approach combin offer flexibl absolut age limit need consider desir sensit run three variant illustr use data decid one suitabl depend downstream analys case tweak test sensit use mltpl argument r outlier dataset cl cf_rangecl taxon min_ag late_ag max_ag early_ag test tempor rang outlier dataset level remov record outlier per taxon cl cf_rangecl taxon taxon_nam min_ag late_ag max_ag early_ag test tempor rang outlier taxon level remov record absolut age limit cl cf_rangecl taxon taxon_nam min_ag late_ag max_ag early_ag method time max_rang test tempor rang outlier taxon level remov record rang clearly_ag cllate_ag histrang break xlab date rang max age min age main plot chunk unnamedchunkpbdbunnamedchunkpng final test outlier spacetim record either distant space time record dataset per taxon test base quantil outlier detect modifi use variou argument import care consid desir test sensit see cf_outl help r outlier dataset cl cf_outlcl taxon lat lat lon lng min_ag late_ag max_ag early_ag test spatiotempor outlier dataset level remov record outlier taxon cl cf_outlcl taxon taxon_nam lat lat lon lng min_ag late_ag max_ag early_ag test spatiotempor outlier taxon level remov record done check mani record flag total compar two dataset r nrowdat nrowcl test combin remov record want identifi flag record doubl check correct take look clean_fossil wrapper function far good significantli refin data need section look metadata refin note two differ way run coordinateclean connect function directli row use magrittr pipe oper r cl dat cc_vallat lat lon lng cc_equlat lat lon lng cc_cenlat lat lon lng cc_counlat lat lon lng iso cc cc_gbiflat lat lon lng cc_instlat lat lon lng cc_zerolat lat lon lng cf_equalmin_ag late_ag max_ag early_ag cf_rangetaxon taxon_nam min_ag late_ag max_ag early_ag cf_outltaxon taxon_nam lat lat lon lng min_ag late_ag max_ag early_ag altern use clean_fossil wrapper around qualiti test provid coordinateclean relev fossil data see cleancoordiantesfo help r adapt countri code iso countri test cs_ma gbr namescs_ma uk datcc countrycodedatcc origin isoc destin isoc custom_match cs_ma run autom test flag clean_fossilsx dat taxon taxon_nam min_ag late_ag max_ag early_ag valu spatialvalid headflag cl datflagssummari clean record fl_rec datflagssummari flag record verif improv data qualiti use metadata usual least type metadata provid fossil occurr case paleobiolog databas well explor see identifi problem basic taxonomi first well take short look taxonomi fossil taxonomi complex composit databas often taxonom issu extrem difficult resolv basic check test taxa dataset plant least identifi genu level r look ok tableclphylum spermatophyta taxonom level identif tablecltaxon_rank subclass speci genu class famili order subfamili requir taxonom level cours depend downstream analys exclud everyth genu speci reason approach pyrat analys r cl cl filtertaxon_rank cspeci genu spatial coordin paleobiolog databas includ inform basi geograph data mani record r tableclgeogscal small collect outcrop local area basin expect record roughli georeferenc precis still rel high mani record time check potenti problemat record time space definit advis check r minimum age tailtablecllate_ag ggplotcl geom_histogramaesx late_ag stat_bin use bin pick better valu binwidth plot chunk unnamedchunkpbdbunnamedchunkpng r maximum age tailtableclearly_ag ggplotcl geom_histogramaesx early_ag stat_bin use bin pick better valu binwidth plot chunk unnamedchunkpbdbunnamedchunkpng minimum maximum age look unproblemat still record larg tempor uncertainti least one case minimum maximum age seem revers might inform case analysi might problemat exclud record tempor uncertainti million year retain data arbitrari choic youll choos suitabl valu base plan analys addit metadata download data use paleobiolog databas web portal addit field check gener gaug data precis name basi precis georefer year public old public like imprecis preserv qualiti bad preserv increas taxonom uncertainti plant organ also taxonom uncertainti collect type might need adapt column name column relev taxa eg plant organ r tablecllatlng_basi tablecllatlng_precis tableclref_pubyr tableclcollection_typ tableclpreservation_qu tableclplant_organ cl filtercl preservation_qu poor conclus variou clean step outlin identifi potenti major caveat hope increas qualiti dataset exclud signific fraction record data qualiti delic issu especi fossil compound data base use individu record depend downstream analys hope find tutori use explor data download paleobiolog databas explor qualiti fossil dataset plot chunk unnamedchunkpbdbunnamedchunkpngplot chunk unnamedchunkpbdbunnamedchunkpng write result disk pyrat format want use fossil data estim speciat extinct rate correl environment factor biogeographi pyratehttpsgithubcomdsilvestropyr might use use write_pyr function coordinateclean write readytous pyrat input file clean dataset disk addit need assess speci extinct extant today provid via statu argument write_pyr want specifi path save file use path argument instead fname r replac blank taxon name cltaxon_nam gsubblank_ cltaxon_nam simul current statu soley demonstr purpos replac data mock_statu dataframetaxon_nam uniquecltaxon_nam statu samplecextinct extant size lengthuniquecltaxon_nam replac true add current statu fossil cl inner_joincl mock_statu taxon_nam write pyrat input disk write_pyratecl fname paleobiodb_angiosperm statu clstatu taxon taxon_nam min_ag late_ag max_ag early_ag titl use custom gazett output rmarkdownhtml_vignett vignett vignetteindexentryus custom gazett vignetteengineknitrrmarkdown vignettesuggestsrgbif usepackageutfinputenc coordinateclean identifi potenti erron geograph record coordin assign sea countr coordin countri capit urban area institut gbif headquart countri base comparison geograph gazett ie refer databas function includ default refer databas compil variou sourc default refer select suitabl region global analys also work smaller scale analys case differ refer might desir avail could instanc centroid small scale polit unit differ set urban area differ coastlin work coastal speci account coordinateclean function use gazett ref argument specifi custom gazett use case coastlin coastal speci demonstr applic custom gazett purpos cc_sea flag record sea sinc often repres erron undesir record terrestri organ standard gazett function fetch naturalearthdatacom scale howev often coordin avail public databas precis scale kilometr might lead overli critic flag coordin close coastlin problem especi coastal intertid speci illustr issu mangrov tree genu avicennia r librarycoordinateclean librarydplyr libraryggplot libraryrgbif librarysp libraryviridi download data gbif dat rgbifocc_searchscientificnam avicennia limit hascoordin dat datdata dat dat dplyrselectspeci name decimallongitud decimallongitud decimallatitud decimallatitud countrycod run default gazett outl cc_seadat valu flag ogr data sourc driver esri shapefil sourc cusersazmycyappdatalocaltemprtmpsrhhv layer ne_m_land featur field plo dataframedat outlier asfactoroutl plot result ggplot bordersfil grey geom_pointdata plo aesx decimallongitud decimallatitud col outlier scale_color_viridisdiscret name flag outlier coord_fix theme_bw themelegendposit bottom plot chunk cusgazcusgazcusgazpng larg number coastal record get flag case undesir function record wrong rather precis coordin resolut refer avoid problem use buffer refer avoid flag record close coast line flag record open ocean coordinateclean come one degre buffer refer buffland case narrow distanc true buffer necessari provid spatialpolygonsdatafram similar structur buffland via ref argument r buffer custom gazett databuffland plotbuffland plot chunk cusgazcusgazcusgazpng r run custom gazett outl cc_seadat valu flag ref buffland plo dataframedat outlier asfactoroutl plot result ggplot bordersfil grey geom_pointdata plo aesx decimallongitud decimallatitud col outlier scale_color_viridisdiscret name flag outlier coord_fix theme_bw themelegendposit bottom plot chunk cusgazcusgazcusgazpng titl global gazett biodivers institut output rmarkdownhtml_vignett bibliographi coordinatecleanerbib vignett vignetteindexentrya global gazett biodivers institut vignetteengineknitrrmarkdown vignetteencodingutf vignettesuggestscaret vignettesuggestsviridi vignettesuggestscountrycod vignettesuggeststidyvers r setup includefals messag f warn fals librarycaret librarycoordinateclean librarycountrycod librarydplyr libraryggplot librarymagrittr libraryrast libraryviridi r echo fals knitropts_chunkset figheight figwidth r echo f messag fals warn fals datainstitut institut filterinstitut isnadecimallongitud institutionssourc trimwsinstitutionssourc background geograph speci occurr record publicli avail aggreg databas global biodivers inform facil gbif either base collect specimen store museum univers botan garden herbarium zoo human observ eg veget survey citizen scienc project rel common error geograph inform record coordin assign physic locat institut host specimen reason error may includ among other individu escap horticultur specimen erron georefer physic locat well record base pictur taken laymen zoo botan garden record problemat condit locat repres speci natur habitat might fact differ consider identifi record coordinateclean includ novel georeferenc global databas biodivers institut defin institut gener concern biodivers research andor host collect live mount biolog specimen implement clean check use databas gazett cc_inst function institut argument clean_coordin function coordinateclean rpackag furthermor hope databas prove use beyond clean geograph record instanc assess sampl bias biolog collect data compil compil name biodivers institut six differ sourc bgcibotanicgardensconservationintern indexherbariorumtheglobalregistryofbiodiversityrepositori wikipedia globalbiodiveristyinformationfacil geonam georeferenc use googl map api via ggmap packag r kahl use institut name yield result institut address record yield result use opencag via opencag rpackag salmon georeferenc manual georeferenc institut could georeferenc automat c use www googl earth googleinc total databas compris almost georeferenc institut anoth entri georeferenc possibl either problem nonenglish name geograph ambigu spatial extent databas global acknowledg focu englishspeak countri countri use roman alphabet partli bia due data compil process hope bia overcom futur contribut databas research nonenglish speak nonroman alphabet countri gener acknowledg databas may complet creat webmask httpbiodiversityinstitutionssurgesh research easili submit institut comment exist institut webpag also includ overview institut includ dataset r fig echo f evalu warn f figshow plo institut plosourc factorplosourc level namessorttableplosourc ggplotdata plo geom_baraesx sourc xlabsourc ylabcount theme_bw data structur addit name geograph coordin institut databas includ inform type institut type eg herbarium univers sourc obtain name institut sourc precis coordin geocodingprecisionm geocodingissu well citi address avail citi address qualiti metadata might vari among differ sourc furthermor databas includ column identifi respect institut locat within protect area unepwcmcandiucn case world databas protect area id respect protect area wdpa shape file avail httpswwwprotectedplanetnet includ flag biodivers institut within protect area might might relev coordin clean depend downstream analys r fig echo f evalu warn f figshow number per km x km grid cell refer raster ra rasterrastercusersazmycydropbox idivresearch_projects_coordinatecleanercoordinatecleanerarticlesinstannual_ndvitif project wg crsprojlonglat ellpswg datumwg no_def behr crsprojcea lon_ lat_t x_ y_ datumwg ellpswg unitsm no_def select reproject institut abu institut dplyrselectspeci type decimallongitud decimallatitud filterisnadecimallongitud abub abu dplyrselectdecimallongitud decimallatitud spspatialpointsprojstr wg sptransformbehr abu abub rasterizera fun count rasterrastertopoint datafram ggplot geom_rasterdata abu aesx x fill loglay scale_fill_gradientlow blue mid yellow high red midpoint name number ofninstitutionsnlog xlablongitud ylablatitud theme_bw coord_fix themeaxistext element_blank axistick element_blank stripbackgroundelement_blank legendposit c r fig echo f evalu warn f figshow institut per contin cont institut mutatecontin countrycodecountri origin isoc destin contin sor cont group_bycontin summarizenumb n arrangenumb plo cont mutatecontin factorcontcontin level sorcontin filterisnacontin filterisnatyp ggplotdata plo geom_baraesx contin themeaxistext element_textangl size facet_wraptyp ncol ylabcount xlabinstitut type theme_bw r fig echo f evalu warn f figshow institut per countri sor institut group_bycountri summarizenumb n arrangenumb sor sornrowsor nrowsor sor sor mutatecountri countrycodecountrycodecountri origin isoc destin countrynameen plo institut filterisnacountri filtercountri sorcountri mutatecountri countrycodecountrycodecountri origin isoc destin countrynameen plo plo mutatecountri factorplocountri level sorcountri plocountri gsubunit kingdom great britain northern ireland uk plocountri plocountri gsubunit state america usa plocountri plo plo mutatecountri factorplocountri level csorcountri uk usa ggplotdata plo geom_baraesx countri themeaxistext element_textangl size ylabcount theme_bw themeaxistitlex element_blank data access databas opensourc avail r data file rda part coordinateclean packag either cranhttpscranrprojectorgwebpackagescoordinatecleanerindexhtml githubhttpsgithubcomropenscicoordinateclean ccbi licens acknowledg databas complet constantli improv feedback provid via github page emphcoordinateclean httpsgithubcomropenscicoordinateclean refer titl datasetlevel clean output rmarkdownhtml_vignett vignett vignetteindexentrydatasetlevel clean vignetteengineknitrrmarkdown vignetteencodingutf vignettesuggestscaret vignettesuggestsreadr r setup includefals messag f knitropts_chunksetecho true librarycaret librarycoordinateclean librarydplyr libraryggplot libraryknitr librarymagrittr libraryrast libraryreadr librarytidyr libraryviridi r echo fals function gener caption crossrefer fig local list capfunctionrefnam text centerfals colblack inlinefals refrefnam css_ctr center css_ctr textaligncent displayinlineblock width cap_txt pastespan stylecolor col css_ctr figur text span anchor pastea name refnam inlin pasteanchor cap_txt els listanchoranchor cap_txtcap_txt reffunctionrefnam linkfals checkreftru function put cross refer caption refer caption refnam pass figcap code chunk name cross refer hyperlink checkref refnam namesref stoppastefigref error refnam found link pastea href refnam figur refrefnam els pastefigur refrefnam ref_allfunct debug ref chunk replac default hook process plot achiev purpos lay autonumb caption function may gone knit_hookssetplot functionx option sti optionsfigalign default sti els sti past styletextalign optionsfigalign islistoptionsfigcap optionsfigcap list return function figcap str_caption optionsfigcapcap_txt str_anchr optionsfigcapanchor els optionsfigcap charact object hard code anchor str_caption optionsfigcap str_anchr pastefigur sti str_anchr img src opts_knitgetbaseurl pastex collaps figcapt str_caption figcaptionfigur sep chucnk read rmd file attempt extract label caption text use figur caption label use anchor scan document allow us creat cross refer caption actual appear get name rmd file rmdfn knitrcurrent_input filenam input document read line close connect rmdcon filermdfn open r rmdline readlinesrmdcon closermdcon pull occur least one back tick follow number charact follow figcap one line figscap_idx grepfigcap rmdline rmdline rmdlinesfigscap_idx get rid everyth start caption label presum caption label first argument figcap eg figcap figcapmy_label rmdlinessanspr subfigcap rmdline identifi everyth first quot match_data regexpr rmdlinessanspr reduc length one interest final quot attrmatch_data matchlength attrmatch_data matchlength extract fig_label regmatchesrmdlinessanspr match_data invertfals lengthfig_label test duplic anyduplicatedfig_label stopdupl caption label detect creat name list figur number ref aslistlengthfig_label namesref fig_label background problem biolog collect data appar individu record rather link properti entir data set cleancoordinatesd function use dataset properti flag three type potenti problem assumpt problem effect mani record dataset sourc necessarili erron convers coordin degre minut annot decim degre decim sign erron translat decim delimit eg problem observ particular older data set period decim data set aris coordin either round record raster format coordin repres raster cell centr problem repres low precis rather error also fatal undetect taken actual local exampl distribut model convers error degreeminut decimaldegre annot cd_ddmm background geograph coordin longitudelatitud coordin refer system note differ way common notat degre minut second ddmm eg decim degre dddd eg hybrid annot degre decim minut also sometim use eg howev analys use distribut data almost exclus reli machin readabl decimaldegre format therefor divers format challeng databas compris coordin record differ sourc potenti use differ annot format systemat error aris especi old data combin digit automat without appropri convers particular problem report repeatedli misinterpret degre sign decim delimit eg convert lead bias geograph occurr inform particular caveat identifi problem posthoc databas compil mani sourc bias record might mix unproblemat record instanc specimen certain herbarium might digit differ instanc way part record bias wherea other algorithm implement part studi present novel algorithm identifi data set potenti bias erron convers ddmm dddd due misinterpret degre sign decim delimit r fig echo f evalu warn f figshow figheight figwidth figcap figcapfig_analmat exampl analysi matric data set vari fraction ddmm dddd convers error error fraction percentag record convers error data set loadfil instanalyses_matrix_clean dat rasterdatt rastertopoint asdatafram mutatelay ifelselay na layer mutatelay ascharacterlay mutatelay parse_factorlay level cna mutat error fraction loadfil instanalyses_matrix_error_fraction_ dat rasterdatt rastertopoint asdatafram mutatelay ifelselay na layer mutatelay ascharacterlay mutatelay parse_factorlay level cna mutat error fraction loadinstanalyses_matrix_error_fraction_ dat rasterdatt rastertopoint asdatafram mutatelay ifelselay na layer mutatelay ascharacterlay mutatelay parse_factorlay level cna mutat error fraction loadinstanalyses_matrix_error_fraction_ dat rasterdatt rastertopoint asdatafram mutatelay ifelselay na layer mutatelay ascharacterlay mutatelay parse_factorlay level cna mutat error fraction dat bind_rowsdat dat dat dat datd factordatd level cerror fraction error fraction error fraction error fraction ggplotdata dat geom_rasteraesx x fill layer scale_fill_manualvalu cdarkgreen white scale_y_continuouslimitsc expand c scale_x_continuouslimitsc expand c xlab longitud decim ylablatitud decim theme_bw themelegendposit none facet_wrapd binomi test frequenc comparison describ main text base analysi matrix record distribut coordin decim longitudelatitud space r figreffig_analmat link true analysi matrix record number record cell presenceabs account cluster sampl ie larg number record similar decim like relat convers error rather multipl sampl locat coordin round see section test implement cd_ddmm function ddmm argument clean_dataset wrapper function input follow gener packag design datafram least three column includ decim longitud latitud data set identifi record name column specifi via lon lat ds argument three addit argument custom test particular modifi sensit fraction data set bias pvalu argument control cutoff pvalu signific onesid ttest diff argument control threshold differ ddmm test indic fraction record decim must outnumb record decim size analysi matrix adapt use matsiz argument simul use simul ass effect vari diff paramet b effect data set size perform ddmm test simul dataset speci occurr vari number record degre sampl cluster iter first draw random number n gammaalpha beta number record simul n latitud longitud coordin use k truncat normal distribut mu_i sim mathcalu sigma sim mathcalu ad bia replac sampl record decim sampl mathcalu analys simul data use cd_ddmm use diff paramet r figreffig_ddmm_diff link true show effect diff paramet sensit cd_ddmm test r figreffig_dataset_s link true effect dataset size gener test identifi presenc bia rate bia well dataset individu occurr record howev empir data recommend conserv diff threshold identifi dataset bia smaller bia rate might caus irregular sampl rather convers error howev advis diff threshold depend downstream analys higher diff valu might necessari r figreffig_ddmm_diff link true suggest manual check decim distribut flag dataset avoid data loss done easili visual inspect analys matrix set diagnost argument cd_ddmm true r fig echo f evalu warn f figshow messag f figheight figwidth figcap figcapfig_ddmm_diff effect diff paramet cd_ddmm test sensit test decreas higher diff valu mean higher fraction record erron coordin toler error fraction data set fraction record subject convers error fals positiveneg rate diff paramet loadinstsimulations_cd_ddmmrd dat plo simulations_cd_ddmm plot summari stat nonbia plo ploisnaplopass plo plo mutatebias ifelsebiasr f mutatecorrect pass bias rememb pass mean biasedtest pass summ plo group_bydiff biasrat summarizetrueposit sumbias pass trueneg sumbias pass falseposit sumbias pass falseneg sumbias pass sensit trueposit trueposit falseneg specif trueneg trueneg falseneg precis trueposit trueposit falseposit detectionr trueposit trueposit falseposit trueneg falseneg n n falsenegativer falseneg n truepositiver trueposit n truenegativer trueneg n falsepositiver falseposit n suma summ filterbiasr dplyrselectdiff falseposit falseposit n falsepositiver mutatefalsepositiver roundfalsepositiver summ summ dplyrselecttrueposit trueneg falseposit falseneg n precis specif detectionr sensit mutatefalsepositiver ifelsebiasr na falsepositiver mutatetruenegativer ifelsebiasr na truenegativer plot summari stat plosum gathersumm index valu diff biasrat diff threshold ggplotplosum geom_pointaesx biasrat valu group asfactordiff col asfactordiff geom_lineaesx biasrat valu group asfactordiff col asfactordiff scale_colour_viridisdiscret name diff threshold facet_wrapindex scale fix ylim xlabbia rate ylabrat theme_bw themelegendposit bottom r fig echo f evalu warn f figshow messag f figheight figwidth figcap figcapfig_dataset_s effect dataset size cd_ddmm test dataset less record flag poorli fals positiveneg rate dataset size datd cutdatdatasets break c plo dat plot summari stat nonbia plo ploisnaplopass plo plo mutatebias ifelsebiasr f mutatecorrect pass bias rememb pass mean biasedtest pass summ plo group_byd biasrat summarizetrueposit sumbias pass trueneg sumbias pass falseposit sumbias pass falseneg sumbias pass sensit trueposit trueposit falseneg specif trueneg trueneg falseneg precis trueposit trueposit falseposit detectionr trueposit trueposit falseposit trueneg falseneg n n falsenegativer falseneg n truepositiver trueposit n truenegativer trueneg n falsepositiver falseposit n summ summ dplyrselecttrueposit trueneg falseposit falseneg n precis specif detectionr sensit mutatefalsepositiver ifelsebiasr na falsepositiver mutatetruenegativer ifelsebiasr na truenegativer plot summari stat plosum gathersumm index valu biasrat diff threshold ggplotplosum geom_pointaesx biasrat valu group asfactord col asfactord geom_lineaesx biasrat valu group asfactord col asfactord scale_colour_viridisdiscret name number record dataset facet_wrapindex scale fix ylim xlabbia rate ylabrat theme_bw themelegendposit bottom expect failur rate simul suggest expect fals posit given diff pvalu constant low r resultsasi evalu echo f knitrkablesuma caption rate fals posit variou rate diff practic exampl convers error test implement cd_ddmm function easili run test line code default test requir two degre span test dataset avoid fals flag due habitat restrict instanc island patchi speci distribut instanc island forest grassland nevertheless consid cd_ddmm test tool identifi potenti problemat dataset rather automat filter recommend doubl check flag dataset use summari statist diagnost plot r echo evalu warn f messag f figheight figwidth figshow clean dataframespeci letter decimallongitud runif decimallatitud runif dataset clean problemat dataset lon sampl size replac true runif lat sampl size replac true runif bias dataframespeci letter decimallongitud lon decimallatitud lat dataset bias dat rbindclean bias diagnost plot small matrix due small dataset size visual parmfrow c cd_ddmmx dat diagnost true valu dataset mat_siz inspect geograph extent flag dataset exclud island patchi habitat minbiaseddecimallongitud maxbiaseddecimallongitud diagnost plot clearli show bias distribut decim bias dataset larg geograph extent exclud island patchi habitat caus distribut low coordin precis due raster sampl decim round cd_round background speci occurr record coordin often repres point occurr either deriv raster collect design eg presenceabs x km grid cell subject strong decim round relev metadata miss issu identifi record level especi record combin precis gpsbase point occurr data set mix precis howev knowledg coordin precis awar larg number imprecis record data set crucial downstream analys instanc coordin collect km x km raster might unsuit speci distribut model local region scale algorithm implement sensit algorithm present main text test custom base raster regular fraction bias record dataset geograph extent rasterregdistmin regdistmax number raster node regoutthresh r echo f evalu warn f figshow figheight figwidth figcap figcapfig_patterncoordin diagnost plot retriev cd_round two dataset record upper panel show unbia dataset lower panel show dataset record raster sampl two degre raster case left panel show distribut geograph coordin right panel show autocorrel plot green vertic line mark flag outlier red horizont line show flag common distanc logic head indic flag true flag fals flag test identifi bias dataset simd functionnrec k datarangemin datarangemax sigmin sigmax ere e nrep simul bia grid birang ere bistpt sampledatarangemindatarangemax birang size datarang datarangemax datarangemin ifdatarang birang datarangemax datarangemin birang bistpt datarangemin bilon bistpt repseq ere ere time roundnrec e birang ere bistpt sampledatarangemindatarangemax birang size datarang datarangemax datarangemin ifdatarang birang datarangemax datarangemin birang bistpt datarangemin bilat bistpt repseq ere ere time roundnrec e longitud simul data accord specif ndi k mu runifndi datarangemin datarangemax sig runifndi sigmin sigmax clean data cllon msmrtnormn roundnrec e mean mu sd sig lower datarangemin upper datarangemax latitud ndi k mu runifndi datarangemin datarangemax sig runifndi sigmin sigmax clean data cllat msmrtnormn roundnrec e mean mu sd sig lower datarangemin upper datarangemax add bias data inplon ccllon bilon inplat ccllat bilat inp dataframedecimallongitud inplon decimallatitud inplat dataset nrep result dataframedatasets nrec datarang pastedatarangemin datarangemax sep _ numberofse ndi seedmean pastemu collaps _ seedsigma pastesig collaps _ biasrat e biasr ere biasrang ere biasstart bistpt nrep nrep stringsasfactor f listinp result returnout run simul plu analys simul data simscl simdsnrec k datarangemin datarangemax sigmin sigmax e ere nrep bia simsbia simdsnrec k datarangemin datarangemax sigmin sigmax e ere nrep bia run test parmfrow c re cd_roundx simscl lon decimallongitud ds dataset test lon valu dataset re cd_roundx simsbia lon decimallongitud ds dataset test lon valu dataset simul simul dataset speci occurr vari number record degre sampl cluster iter first draw random number n sim gammaalpha beta number record simul n latitud longitud coordin use k truncat normal distribut mu_i sim mathcalu sigma sim mathcalu ad fraction rho bias record rho assum raster bia five node ie raster five row five column first sampl random coordin origin raster sampl four remain node resolut tau analys simul data use cd_round function paramet r figreffig_clustering_t_result link true show effect paramet sensit ds_ddmm test r fig echo f evalu warn f messag f figshow figheight figwidth figcap figcapfig_clustering_t_result effect paramet sensit ds_round test loadinstautocorrelation_simulationsrd plot summari stat nonbia plo ploisnaploflag plo plo mutatebias ifelsebiasr f mutatebias ifelsebiasr f mutatecorrect flag bias rememb flag mean biasedtest pass summ plo group_byoutlierthreshold biasrat summarizetrueposit sumbias flag trueneg sumbias flag falseposit sumbias flag falseneg sumbias flag sensit trueposit trueposit falseneg specif trueneg trueneg falseneg precis trueposit trueposit falseposit detectionr trueposit trueposit falseposit trueneg falseneg n n falsenegativer falseneg n truepositiver trueposit n truenegativer trueneg n falsepositiver falseposit n summ summ dplyrselecttrueposit trueneg falseposit falseneg n precis specif detectionr sensit mutatefalsepositiver ifelsebiasr na falsepositiver mutatetruenegativer ifelsebiasr na truenegativer plot summari stat plosum gathersumm index valu outlierthreshold biasrat outlier threshold ggplotplosum geom_pointaesx biasrat valu group asfactoroutlierthreshold col asfactoroutlierthreshold scale_colour_viridisdiscret name outlier threshold facet_wrapindex scale fix ylim xlabbia rate ylabrat theme_bw themelegendposit bottom practic exampl follow exampl illustr use cd_round r echo f evalu warn f figshow figheight figwidth messag f simul bia grid one degre resolut error record dataset simul bias fraction data grid resolut degre simul nonbias fraction data bi sampl size replac true mu runif sig runif cl rnormn mean mu sd sig lon ccl bi bi sampl size replac true mu runif sig runif cl rnormn mean mu sd sig lat ccl bi bias dataframedecimallongitud lon decimallatitud lat dataset bias simul unbias data lon runifn min max lat runifn min max clean dataframedecimallongitud lon decimallatitud lat dataset clean dat rbindbias clean run test longitud better visual parmfrow c cd_rounddat valu dataset test lon valu dataset output cd_round tabl indic number regular outlier ie raster node indic dataset flag addit diagnost plot clearli show raster pattern bias dataset confirm autom flag titl identifi geograph outlier output rmarkdownhtml_vignett vignett vignetteindexentryidentifi geograph outlier vignetteengineknitrrmarkdown vignettesuggestsrgbif usepackageutfinputenc r setup includefals knitropts_chunksetecho true problem geograph outlier isol occurr record distant record taxoni geograph outliersoften erron problemat might present data entri error switch coordin switch decim sign individu horticultur captiv far natur condit alien record outsid natur rang speci freak individu remnant histor conting mani analys record undesir need remov howev automat treatment record difficult record case might relev analys distancebas outlier detect major vote henc suscept uneven sampl speci albeit experi might geograph disjunct distribut instanc ocean island prone creat fals posit furthermor gener difficult defin speci rang end record consid outlier environment factor use inform decis geograph outlier howev record use environment base distribut model clean risk circular coordinateclean implement cc_outl test automat flag outlier record base geograph posit use interquartil rang outlier detect x iqrx q_ mltpl distanc matrix record speci experi test larg improv dataset unproblemat speci need care thought test implement coordinateclean default set test conserv flag record peripher satellit distribut common dataset relev analys outcom strongli recommend inspect flag record care tutori illustr potenti caveat cc_outl use two boundari case exampl speci strong sampl bia red squirrel eurasian lynx end present cc_iucn altern outlier detect dataset larg rang strong sampl bia r echo f warn f messag f librarycoordinateclean librarydplyr libraryggplot librarymagrittr libraryreadr libraryrgd libraryrgbif librarysp libraryviridi load exampl data local speed vignett build squ read_delimfil instcsv delim guess_max dplyrselectspeci specieskey decimallongitud decimallatitudecountrycod filterisnadecimallongitud filterisnadecimallatitud lnx read_delimfil instcsv delim guess_max dplyrselectspeci specieskey decimallongitud decimallatitud countrycod filterisnadecimallongitud filterisnadecimallatitud case european lynx eurasian lynx lynx lynx widespread eurasian carnivor global biodivers inform facil wwwgbiforg compris r nrowlnx record speci vast major europ record asia record north america south america european asian record correspond recent natur rang speci compar instanc herehttpwwwiucnredlistorgdetail american record doubt might correspond swap coordin individu captiv misidentif canada lynx lynx canadensi eurasian lynx extrem case outlier detect includ true erron outlier america also isol potenti valid record northern china cc_outl still help improv data set sinc larg dataset test automat use rasterbas distanc approxim calcul distanc matrix speci record test geograph outlier default first download occurr record lynx lynx wwwgbiforg use rgbif packag r warn f messag f collaps eval f load data gbif lnx rgbifocc_searchscientificnam lynx lynx limit hascoordin return data dplyrselectspeci key decimallongitud decimallongitud decimallatitud decimallatitud countrycod run default cc_outl test r warn f messag f collaps eval run basic coordin clean flag clean_coordinatesx lnx test ccapit centroid equal gbif institutionsseaszero lnx lnxflagssummari default outlier detect outl cc_outllnx valu flag plo dataframelnx outlier asfactoroutl visual occurr record ggplot bordersfil grey geom_pointdata plo aesx decimallongitud decimallatitud col outlier scale_color_viridisdiscret name flag outlier coord_fix theme_bw themelegendposit bottom default set outlier test flag r sumoutl outlier r nrowlnx record comparison natur rang speci show test perform quit well default set american record flag correctli outlier eurasian record flag howev potenti issu sinc three isol record asia also flag potenti outlier although like valid record case isol posit record error probabl rather due extrem low sampl data avail across larg part asia cc_outl offer two option improv result tweak test sensit account sampl intens tweak test sensit make outlier detect conserv use mltpl argument cc_outl well increas mltpl mean mean distanc record record must time interquantil rang mean distanc point r warn f messag f collaps outl_ cc_outllnx valu flag mltpl plo dataframelnx outlier asfactoroutl_ visual occurr record ggplot bordersfil grey geom_pointdata plo aesx decimallongitud decimallatitud col outlier scale_color_viridisdiscret name flag outlier coord_fix theme_bw themelegendposit bottom improv result dataset might accept analys tweak test sensit easi measur requir gener idea disjunct sampl dataset import fals flag record fals posit test compar fals retain record fals neg test downstream analys two isol record eastern asia remain problemat record repres extrem case due rare combin extrem larg distribut rang speci extrem spars sampl huge area correct sampl intens cc_outl enabl account uneven sampl countri level use sampling_thresh argument base assumpt area ie countri high sampl speci like record henc distanc correct occurr record next record speci small sampling_thresh avoid flag record countri low gener avail occurr record sampling_thresh larger zero cc_outl use densiti biolog occurr record avail countri global biodivers inform facil proxi sampl countri base statist distribut record densiti across countri flag record countri lower sampling_thr percentil never consid outlier instanc sampling_thresh equal record least dens sampl countri flag outlier r warn f messag f collaps run outlier test outl_samp cc_outllnx valu flag mltpl sampling_thresh visual occurr record plo dataframelnx outlier asfactoroutl_samp ggplot bordersfil grey geom_pointdata plo aesx decimallongitud decimallatitud col outlier scale_color_viridisdiscret name flag outlier coord_fix theme_bw themelegendposit bottom correct sampl record eastern china correctli assign entir natur rang lynx lynx includ dataset howev record bolivia fals includ dataset extrem case lynx illustr inher limit autom geograph outlier test sinc true error record bolivia less distant correct record northern china similar sampl condit case red squirrel red squirrel sciuru vulgari widespread throughout eurasia r nrowsqu record global biodivers inform facil wwwgbiforg sampl natur rang highli cluster europ record across asia addit dataset includ multipl record like erron america south africa bias sampl effort toward europ togeth larg distribut rang speci make use geograph outlier detect data clean challeng still cc_outl help improv data set sinc larg dataset test automat use rasterbas distanc approxim calcul distanc matrix speci record download occurr record wwwgbiforg run cc_outl default set r warn f messag f collaps eval f load data gbif squ rgbifocc_searchscientificnam lynx lynx limit hascoordin squ squdata dplyrselectspeci key decimallongitud decimallatitud countrycod hascoordin r warn f messag f collaps eval run basic coordin clean flag clean_coordinatesx squ test ccapit centroid equal gbif institutionsseaszero squ squflagssummari default outlier detect outl cc_outlsqu valu flag plo dataframesqu outlier asfactoroutl visual occurr record ggplot bordersfil grey geom_pointdata plo aesx decimallongitud decimallatitud col outlier scale_color_viridisdiscret name flag outlier coord_fix theme_bw themelegendposit bottom default test flag r sumflagssummari r nrowsqu record comparison natur rang show erron record america south africa identifi correctli unfortun strong sampl bia toward europ also let flag potenti correct east asian record use sampl thresh argument address avoid fals flag record eastern asia r warn f messag f collaps run outlier test outl_samp cc_outlsqu valu flag sampling_thresh visual occurr record plo dataframesqu outlier asfactoroutl_samp ggplot bordersfil grey geom_pointdata plo aesx decimallongitud decimallatitud col outlier scale_color_viridisdiscret name flag outlier coord_fix theme_bw themelegendposit bottom improv result significantli clean dataset seem good represent natur distribut sciuru vulgari howev similar exampl eurasian lynx result perfect sinc record korea japan flag outlier henc addit altern data clean method might necessari natur rang instead outlier detect exampl show potenti caveat cc_outl inclus record natur rang also peripheri eastern asian record squirrel exclus record outsid crucial downstream analys reason balanc type type ii error found approach identifi outlier record might appropri addit inform speci natur rang avail instanc intern union conserv natur httpwwwiucnredlistorgtechnicaldocumentsspatialdata case amphibian bird mammal reptil use cc_iucn function coordinateclean exclud record outsid rang cc_iucn directli accept iucn format r warn f messag f collaps load iucn rang red squirrel provid coordinateclean need download seper wwwiucnorg sq_rang readogrdsn inst layer species_ sq_rangedataspeci uniquesquspeci replac speci name gbif id synchron betwe record rang polygon run natur rang test rang cc_iucnx squ rang sq_rang valu flag plot result plo dataframesqu outlier asfactorrang nat_rang fortifysq_rang ggplot bordersfil grey geom_polygondata nat_rang aesx long lat group group fill green alpha col grey geom_pointdata plo aesx decimallongitud decimallatitud col outlier scale_color_viridisdiscret name flag outlier coord_fix theme_bw themelegendposit bottom inform avail rang gener adhoc cc_iucn appli multipl speci assum spatialpolygondatafram similar structur data provid iucn r warn f messag f collaps creat custom rang polygon lynx defin polygon shape lx_rang polygoncbindc c lx_rang polygonslistlx_rang id ca defin project wg projlonglat datumwg no_def lx_rang spatialpolygonslistlx_rang projstr crswg creat dataset format quirrel speci speci name case gbif id df dataframespeci rownam lx_rang spatialpolygonsdataframelx_rang data asdataframedf run natur rang test rang cc_iucnx lnx rang lx_rang valu flag plot result plo dataframelnx outlier asfactorrang nat_rang fortifylx_rang ggplot bordersfil grey geom_polygondata nat_rang aesx long lat fill green alpha col grey geom_pointdata plo aesx decimallongitud decimallatitud col outlier scale_color_viridisdiscret name flag outlier coord_fix theme_bw themelegendposit bottom cc_iucn support occurr record dataset rang polygon contain multipl speci instanc set occurr record mammal clean use iucn shape file contain mammal natur rang iucn custom polygon also combin structur adapt r warn f messag f collaps adapt structur lynx polygon lx_rangedata dataframetrepna ncolsq_rangedata rownam nameslx_rangedata namessq_rangedata combin rang nat_rang rbindsq_rang lx_rang combin record dat rbindsqu lnx run natur rang test rang cc_iucnx dat rang nat_rang valu flag gener roxygen edit hand pleas edit document rwrite_pyrat namewrite_pyr aliaswrite_pyr titlecr input file pyrat usag write_pyr x statu fname taxon accepted_nam min_ag min_ma max_ag max_ma trait null path getwd replic cutoff null random true argument itemxdatafram contain fossil record taxon name age geograph coordin itemstatusa vector charact string length codenrowx indic record dquoteextinct dquoteext itemfnamea charact string prefix use output file itemtaxoncharact string column taxon name default dquoteaccepted_nam itemmin_agecharact string column minimum age default dquotemin_ma itemmax_agecharact string column maximum age default dquotemax_ma itemtraita numer vector length codenrowx indic trait valu record option default null itempatha charact string give absolut path write output file default work directori itemreplicatesa numer number replic random age gener see detail default itemcutoffa numer specifi threshold exclud fossil occurr high tempor uncertainti ie wide tempor rang min_ag max_ag exampl cutoffnul default occurr kept data set cutoff occurr tempor rang myr higher exclud data set itemrandomlog specifi whether take random age mint maxt occurr midpoint age note option default true sever replic gener ie replic exampl random true default random fals use midpoint age valu pyrat input file work directori descript creat input necessari run pyrat base datafram fossil age deriv eg clean_fossil vector extinct statu sampl creat file work directori detail replic option allow user gener sever replic data set singl input file time redraw age occurr random uniform distribut boundari mint maxt replic analys differ run see pyrat command j combin result replic way account uncertainti true age fossil occurr exampl replic default gener data set replic gener random replic data set note see urlhttpsgithubcomdsilvestropyratewiki detail tutori pyrat pyrat input exampl minag runif exmpl dataframeaccepted_nam samplelett size replac true lng runif min max lat runif min max min_ma minag max_ma minag runif vector statu record make sure speci classifi either extinct extant otherwis function drop error statu samplecextinct extant size nrowexmpl replac true list speci statu samplecextinct extant size lengthlett replac true namesstatu letter statu statusexmplaccepted_nam dontrun write_pyratex exmplfnam test statu statu keywordfossil gener roxygen edit hand pleas edit document rcoordinatecleanerpackag doctypedata namebuffsea aliasbuffsea titleglob coastlin buffer degre sourc urlhttpwwwnaturalearthdatacomdownloadsmphysicalvector descript codespatialpolygonsdatafram global coastlin degre buffer extent coastlin altern refer codelinkcc_sea use identifi marin speci land without flag record estuari etc exampl databuffsea keywordgazett gener roxygen edit hand pleas edit document rcc_gbifr namecc_gbif aliascc_gbif titleidentifi record assign gbif headquart usag cc_gbif x lon decimallongitud lat decimallatitud speci speci buffer geod true verifi fals valu clean verbos true argument itemxdatafram contain geograph coordin speci name itemloncharact string column longitud coordin default dquotedecimallongitud itemlatcharact string column latitud coordin default dquotedecimallatitud itemspeciescharact string column speci ident requir verifi true itembuffernumer buffer around gbif headquart record flag problemat unit depend geod default itemgeodlog true radiu calcul base sphere buffer meter fals radiu calcul degre default itemverifylog true record flag record given speci flag close given refer fals distanc criterion itemvaluecharact string defin output valu see valu itemverboselog true report name test number record flag valu depend squotevalu argument either codedatafram contain record consid correct test dquoteclean logic vector dquoteflag true test pass fals test failedpotenti problemat default dquoteclean descript remov flag record within degre radiu around gbif headquart copenhagen dk detail recommend work record denmark copenhagen area exampl x dataframespeci decimallongitud c decimallatitud c cc_gbifx cc_gbifx valu flag seealso coordin codelinkcc_cap codelinkcc_cen codelinkcc_coun codelinkcc_dupl codelinkcc_equ codelinkcc_inst codelinkcc_iucn codelinkcc_outl codelinkcc_sea codelinkcc_urb codelinkcc_v codelinkcc_zero conceptcoordin keywordcoordin keywordclean gener roxygen edit hand pleas edit document rcc_instr namecc_inst aliascc_inst titleidentifi record vicin biodivers institut usag cc_inst x lon decimallongitud lat decimallatitud speci speci buffer geod true ref null verifi fals verify_mltpl valu clean verbos true argument itemxdatafram contain geograph coordin speci name itemloncharact string column longitud coordin default dquotedecimallongitud itemlatcharact string column latitud coordin default dquotedecimallatitud itemspeciescharact string column speci ident requir verifi true itembuffernumer buffer around institut record flag problemat decim degre default itemgeodlog true radiu around capit calcul base sphere buffer meter independ latitud fals radiu calcul assum planar coordin vari slightli latitud case buffer degre default true see httpsseethedatablogwordpresscom detail credit itemrefspatialpointsdatafram provid geograph gazett spatialpointsdatafram structur must ident codelinkinstitut default codelinkinstitut itemverifylog true record close institut flag record speci greater vicin radiu buffer verify_mltpl itemverify_mltplnumer indic factor radiu verifi exce radiu initi test default might suitabl geod true might larg otherwis itemvaluecharact string defin output valu see valu itemverboselog true report name test number record flag valu depend squotevalu argument either codedatafram contain record consid correct test dquoteclean logic vector dquoteflag true test pass fals test failedpotenti problemat default dquoteclean descript remov flag record assign locat zoo botan garden herbaria univers museum base global databas biodivers institut coordin locat relat dataentri error fals autom georefer individu captivityhorticultur detail note buffer radiu degre thu differ slightli differ latitud exampl x dataframespeci letter decimallongitud runif decimallatitud runif larg buffer demonstr use geod fals shorter runtim cc_instx valu flag buffer geod fals dontrun cc_instx valu flag buffer geod seealso coordin codelinkcc_cap codelinkcc_cen codelinkcc_coun codelinkcc_dupl codelinkcc_equ codelinkcc_gbif codelinkcc_iucn codelinkcc_outl codelinkcc_sea codelinkcc_urb codelinkcc_v codelinkcc_zero conceptcoordin keywordcoordin keywordclean gener roxygen edit hand pleas edit document rcoordinatecleanerpackag doctypedata namecountryref aliascountryref titlecountri centroid countri capit format data frame observ variabl describ itemisoiso code countri case provinc also refer countri itemisoiso code countri case provinc also refer countri itemadm_codeadm code countri provinc itemnamea factor name countri provinc itemtypeidentifi entri refer countri provinc level itemcentroidlonlongitud countri centroid itemcentroidlatlatitud countri centroid itemcapitalnam countri capit empti provinc itemcapitallonlongitud countri capit itemcapitallatlatitud countri capit itemarea_sqkmth area countri provinc itemuncertaintyradiusmetersth uncertainti countri centroid itemsourceth data sourc current avail urlhttpgeolocateorg sourc central intellig agenc emphth world factbook washington dc urlhttpswwwciagovtheworldfactbook urlhttpthematicmappingorgdownloadsworld_bordersphp urlhttpgeolocateorg descript codedatafram coordin countri provinc centroid countri capit refer codelinkclean_coordin codelinkcc_cen codelinkcc_cap function coordin base central intellig agenc world factbook urlhttpswwwciagovtheworldfactbook urlhttpthematicmappingorgdownloadsworld_bordersphp geoloc urlhttpgeolocateorg exampl datacountryref headcountryref keywordgazett gener roxygen edit hand pleas edit document rcc_outlr namecc_outl aliascc_outl titleidentifi geograph outlier speci distribut usag cc_outl x lon decimallongitud lat decimallatitud speci speci method quantil mltpl tdi valu clean sampling_thresh verbos true min_occ thin fals thinning_r argument itemxdatafram contain geograph coordin speci name itemloncharact string column longitud coordin default dquotedecimallongitud itemlatcharact string column latitud coordin default dquotedecimallatitud itemspeciescharact string column speci name default dquotespeci itemmethodcharact string defin method outlier select see detail one dquotedist dquotequantil dquotemad default dquotequantil itemmltplnumer multipli interquartil rang codemethod quantil median absolut deviat codemethod madto identifi outlier see detail default itemtdinumer minimum absolut distanc codemethod distanc record record speci identifi outlier km see detail default itemvaluecharact string defin output valu see valu itemsampling_threshnumer cut threshold sampl correct indic quantil sampl outlier ignor instanc codesampling_thresh record worst sampl countri flag outlier default sampl correct itemverboselog true report name test number record flag itemmin_occsminimum number geograph uniqu datapoint need speci test necessari reliabl outlier estim speci fewer min_occ record test output valu true default codemethod distanc consid lower threshold itemthinningforc raster approxim distanc calcul routin use speci record comput reason enforc smaller dataset recommend sampl uneven itemthinning_resth resolut spatial thin decim degre default valu depend squotevalu argument either codedatafram contain record consid correct test dquoteclean logic vector dquoteflag true test pass fals test failedpotenti problemat default dquoteclean descript remov flag record outlier geograph space accord method defin via codemethod argument geograph outlier often repres erron coordin exampl due data entri error imprecis georefer individu horticulturecapt detail method outlier identif depend codemethod argument dquoteoutli boxplot method use record flag outlier emphmean distanc record speci larger mltpl interquartil rang mean distanc record speci dquotemad median absolut deviat use case record flag outlier emphmean distanc record speci larger median mean distanc point plusminu mad mean distanc record speci mltpl dquotedist record flag outlier emphminimum distanc next record speci codetdi speci record uniqu locat random sampl record use distanc matrix calcul test skip speci fewer codemin_occ geograph uniqu record likelihood occurr record erron outlier link sampl effort given locat account sampling_cor option fetch number occurr record avail wwwgbiforg per countri proxi sampl effort outlier test mean distanc record weight log transform number record per squar kilometr countri see urlhttpsbesjournalsonlinelibrarywileycomdoifullx exampl explan outlier test note see urlhttpsropenscigithubiocoordinateclean detail tutori exampl x dataframespeci letter decimallongitud runif decimallatitud runif cc_outlx cc_outlx method quantil valu flag cc_outlx method distanc valu flag tdi cc_outlx method distanc valu flag tdi seealso coordin codelinkcc_cap codelinkcc_cen codelinkcc_coun codelinkcc_dupl codelinkcc_equ codelinkcc_gbif codelinkcc_inst codelinkcc_iucn codelinkcc_sea codelinkcc_urb codelinkcc_v codelinkcc_zero conceptcoordin keywordcoordin keywordclean gener roxygen edit hand pleas edit document rcoordinatecleanerpackag doctypedata namebuffland aliasbuffland titleglob coastlin buffer degre sourc urlhttpwwwnaturalearthdatacomdownloadsmphysicalvector descript codespatialpolygonsdatafram global coastlin degre buffer extent coastlin altern refer codelinkcc_sea use identifi speci sea without flag record mangrov marsh etc exampl databuffland keywordgazett gener roxygen edit hand pleas edit document rcf_ranger namecf_rang aliascf_rang titleidentifi fossil extrem age rang usag cf_rang x lon decimallongitud lat decimallatitud min_ag min_ma max_ag max_ma taxon accepted_nam method quantil mltpl size_thresh max_rang uniq_loc fals valu clean verbos true argument itemxdatafram contain fossil record taxon name age geograph coordin itemloncharact string column longitud coordin identifi uniqu record codeuniq_loc true default dquotedecimallongitud itemlatcharact string column longitud coordin default dquotedecimallatitud identifi uniqu record codeuniq_loc itemmin_agecharact string column minimum age default dquotemin_ma itemmax_agecharact string column maximum age default dquotemax_ma itemtaxoncharact string column taxon name dquot search outlier entir dataset otherwis per specifi taxon default dquoteaccepted_nam itemmethodcharact string defin method outlier select see detail either dquotequantil dquotemad default dquotequantil itemmltplnumer multipli interquartil rang codemethod quantil median absolut deviat codemethod mad identifi outlier see detail default itemsize_threshnumer minimum number record need dataset test default itemmax_rangenumer absolut maximum time interv min age max age relev codemethod dquotetim itemuniq_loclog true singl record per locat time point taxon codetaxon use outlier test default itemvaluecharact string defin output valu see valu itemverboselog true report name test number record flag valu depend squotevalu argument either codedatafram contain record consid correct test dquoteclean logic vector dquoteflag true test pass fals test failedpotenti problemat default dquoteclean descript remov flag record unexpectedli larg tempor rang base quantil outlier test note see urlhttpsropenscigithubiocoordinateclean detail tutori exampl minag runifn min max x dataframespeci cletter z lng crunifn min max lat crunifn min max min_ma minag max_ma minag crunifn min max cf_rangex valu flag taxon seealso fossil codelinkcf_ag codelinkcf_equ codelinkcf_outl conceptfossil keywordfossil keywordtempor keywordclean gener roxygen edit hand pleas edit document rcf_ager namecf_ag aliascf_ag titleidentifi fossil outlier age usag cf_age x lon decimallongitud lat decimallatitud min_ag min_ma max_ag max_ma taxon accepted_nam method quantil size_thresh mltpl replic flag_thresh uniq_loc fals valu clean verbos true argument itemxdatafram contain fossil record taxon name age geograph coordin itemloncharact string column longitud coordin identifi uniqu record codeuniq_loc true default dquotedecimallongitud itemlatcharact string column longitud coordin default dquotedecimallatitud identifi uniqu record codeuniq_loc itemmin_agecharact string column minimum age default dquotemin_ma itemmax_agecharact string column maximum age default dquotemax_ma itemtaxoncharact string column taxon name dquot search outlier entir dataset otherwis per specifi taxon default dquoteaccepted_nam itemmethodcharact string defin method outlier select see detail either dquotequantil dquotemad default dquotequantil itemsize_threshnumer minimum number record need dataset test default itemmltplnumer multipli interquartil rang codemethod quantil median absolut deviat codemethod mad identifi outlier see detail default itemreplicatesnumer number replic distanc matrix calcul see detail default itemflag_threshnumer fraction pass replic necessari pass test see detail default itemuniq_loclog true singl record per locat time point taxon codetaxon use outlier test default itemvaluecharact string defin output valu see valu itemverboselog true report name test number record flag valu depend squotevalu argument either codedatafram contain record consid correct test dquoteclean logic vector dquoteflag true test pass fals test failedpotenti problemat default dquoteclean descript remov flag record tempor outlier base interquantil rang detail outlier detect base interquantil rang test tempor distanc matrix among record calcul base singl point select random minimum maximum age record mean distanc point neighbour calcul sum distanc test interquantil rang flag outlier eqnx iqrx q_ mltpl test replic squoterepl time account date uncertainti record flag outlier flag fraction squoteflagthresh replic datasetstaxa compris squotesize_thresh record test distanc calcul euclidean distanc note see urlhttpsropenscigithubiocoordinateclean detail tutori exampl minag crunifn min max x dataframespeci cletter repz min_ma minag max_ma cminag runifn min max cf_agex valu flag taxon uniqu locat x dataframespeci cletter repz decimallongitud crunifn min max decimallatitud crunifn min max min_ma minag max_ma cminag runifn min max cf_agex valu flag taxon uniq_loc true seealso fossil codelinkcf_equ codelinkcf_outl codelinkcf_rang conceptfossil keywordcoordin keywordfossil keywordtempor keywordclean gener roxygen edit hand pleas edit document rcc_capr namecc_cap aliascc_cap titleidentifi coordin vicin countri capit usag cc_cap x lon decimallongitud lat decimallatitud speci speci buffer geod true ref null verifi fals valu clean verbos true argument itemxdatafram contain geograph coordin speci name itemloncharact string column longitud coordin default dquotedecimallongitud itemlatcharact string column latitud coordin default dquotedecimallatitud itemspeciescharact string column speci ident requir verifi true itembufferth buffer around capit coordin centr citi record flag problemat unit depend geod default kilometr itemgeodlog true radiu around capit calcul base sphere buffer meter independ latitud fals radiu calcul assum planar coordin vari slightli latitud case buffer degre default true see httpsseethedatablogwordpresscom detail credit itemrefspatialpointsdatafram provid geograph gazett spatialpointsdatafram structur must ident codelinkcountryref default codelinkcountryref itemverifylog true record flag record given speci flag close given refer fals distanc criterion itemvaluecharact string defin output valu see valu itemverboselog true report name test number record flag valu depend squotevalu argument either codedatafram contain record consid correct test dquoteclean logic vector dquoteflag true test pass fals test failedpotenti problemat default dquoteclean descript remov flag record within certain radiu around countri capit poorli georeferenc occurr record biolog databas often erron georeferenc capit note see urlhttpsropenscigithubiocoordinateclean detail tutori exampl x dataframespeci letter decimallongitud runif decimallatitud runif cc_capx cc_capx valu flag seealso coordin codelinkcc_cen codelinkcc_coun codelinkcc_dupl codelinkcc_equ codelinkcc_gbif codelinkcc_inst codelinkcc_iucn codelinkcc_outl codelinkcc_sea codelinkcc_urb codelinkcc_v codelinkcc_zero conceptcoordin keywordcoordin keywordclean gener roxygen edit hand pleas edit document rcc_duplr namecc_dupl aliascc_dupl titleidentifi duplic record usag cc_dupl x lon decimallongitud lat decimallatitud speci speci addit null valu clean verbos true argument itemxdatafram contain geograph coordin speci name itemloncharact string column longitud coordin default dquotedecimallongitud itemlatcharact string column latitud coordin default dquotedecimallatitud itemspeciesa charact string column speci name default dquotespeci itemadditionsa vector charact string addit column includ test duplic exampl collector name collector number itemvaluecharact string defin output valu see valu itemverboselog true report name test number record flag valu depend squotevalu argument either codedatafram contain record consid correct test dquoteclean logic vector dquoteflag true test pass fals test failedpotenti problemat default dquoteclean descript remov flag duplic record base speci name coordin well userdefin addit column true specimen duplic duplic speci make bulk record biolog collect databas undesir mani analys flag function former given enough addit inform exampl x dataframespeci letter decimallongitud samplex size replac true decimallatitud samplex size replac true collector bonpl collectornumb c collect repck wagfr p cc_duplx valu flag cc_duplx addit ccollector collectornumb seealso coordin codelinkcc_cap codelinkcc_cen codelinkcc_coun codelinkcc_equ codelinkcc_gbif codelinkcc_inst codelinkcc_iucn codelinkcc_outl codelinkcc_sea codelinkcc_urb codelinkcc_v codelinkcc_zero conceptcoordin keywordcoordin keywordclean gener roxygen edit hand pleas edit document rcd_roundr namecd_round aliascd_round titleidentifi dataset raster coordin usag cd_round x lon decimallongitud lat decimallatitud ds dataset reg_out_thresh reg_dist_min reg_dist_max min_unique_ds_s graph true test valu clean verbos true argument itemxdatafram contain geograph coordin speci name itemloncharact string column longitud coordin default dquotedecimallongitud itemlatcharact string column latitud coordin default dquotedecimallatitud itemdsa charact string column dataset record case codex treat singl dataset ident record default dquotedataset itemtnumer threshold outlier detect interquantil rang base test major paramet specifi sensit test lower valu equal higher detect rate valu recommend default itemreg_out_threshnumer threshold number equal distanc outlier point see detail default itemreg_dist_minnumer minimum detect distanc outlier degre minimum resolut grid flag default itemreg_dist_maxnumer maximum detect distanc outlier degre maximum resolut grid flag default itemmin_unique_ds_sizenumer minimum number uniqu locat valu test column dataset includ test default itemgraphslog true diagnost plot produc default true itemtestcharact string indic column test either dquotelat latitud dquotelon longitud dquoteboth latter case dataset flag test fail default dquoteboth itemvaluecharact string defin output valu see valu itemverboselog true report name test number record flag valu depend squotevalu argument either codedatafram summari statist flag dataset dquotedataset codedatafram contain record consid correct test dquoteclean logic vector dquoteflag true test pass fals test failedpotenti problemat default dquoteclean descript flag dataset period pattern indic raster lattic collect scheme often obtain eg atla data use combin autocorrel slidingwindow outlier detect identifi period pattern data see urlhttpsbesjournalsonlinelibrarywileycomdoifullx detail descript algorithm note see urlhttpsropenscigithubiocoordinateclean detail tutori exampl simul bia grid one degre resolut error record dataset simul bias fraction data grid resolut degre simul nonbias fraction data bi sampl size replac true mu runif sig runif cl rnormn mean mu sd sig lon ccl bi bi sampl size replac true mu runif sig runif cl rnormn mean mu sd sig lat ccl bi add bias data inp dataframedecimallongitud lon decimallatitud lat dataset test run test dontrun cd_roundinp valu dataset seealso dataset codelinkcd_ddmm conceptdataset keywordcoordin keyworddataset keywordclean keywordlevel gener roxygen edit hand pleas edit document rcc_sear namecc_sea aliascc_sea titleidentifi nonterrestri coordin usag cc_sea x lon decimallongitud lat decimallatitud ref null scale valu clean speedup true verbos true argument itemxdatafram contain geograph coordin speci name itemloncharact string column longitud coordin default dquotedecimallongitud itemlatcharact string column latitud coordin default dquotedecimallatitud itemrefa spatialpolygonsdatafram provid geograph gazett spatialpolygonsdatafram structur must ident rnaturalearthne_downloadscal type land categori physic default rnaturalearthne_downloadscal type land categori physic itemscaleth scale default refer download natur earth must one higher number equal higher detail default itemvaluecharact string defin output valu see valu itemspeeduplog use heurist speed analysi larg data set mani record per locat itemverboselog true report name test number record flag valu depend squotevalu argument either codedatafram contain record consid correct test dquoteclean logic vector dquoteflag true test pass fals test failedpotenti problemat default dquoteclean descript remov flag coordin outsid refer landmass use restrict dataset terrestri taxa exclud record open ocean depend refer see detail often record terrestri taxa found open ocean mostli due switch latitud longitud detail case flag record close coastlin recommend low precis refer dataset minor gp imprecis dataset might includ coast marshland speci want flag record open ocean consid use buffer landmass refer eg codelinkbuffland note see urlhttpsropenscigithubiocoordinateclean detail tutori exampl x dataframespeci letter decimallongitud runif decimallatitud runif cc_seax valu flag seealso coordin codelinkcc_cap codelinkcc_cen codelinkcc_coun codelinkcc_dupl codelinkcc_equ codelinkcc_gbif codelinkcc_inst codelinkcc_iucn codelinkcc_outl codelinkcc_urb codelinkcc_v codelinkcc_zero conceptcoordin keywordcoordin keywordclean gener roxygen edit hand pleas edit document rcc_zeror namecc_zero aliascc_zero titleidentifi zero coordin usag cc_zero x lon decimallongitud lat decimallatitud buffer valu clean verbos true argument itemxdatafram contain geograph coordin speci name itemloncharact string column longitud coordin default dquotedecimallongitud itemlatcharact string column latitud coordin default dquotedecimallatitud itembuffernumer buffer around point record flag problemat decim degre default itemvaluecharact string defin output valu see valu itemverboselog true report name test number record flag valu depend squotevalu argument either codedatafram contain record consid correct test dquoteclean logic vector dquoteflag true test pass fals test failedpotenti problemat default dquoteclean descript remov flag record either zero longitud latitud radiu around point zero longitud zero latitud problem often due erron dataentri georeferenc lead typic pattern high divers around equat note see urlhttpsropenscigithubiocoordinateclean detail tutori exampl x dataframespeci decimallongitud c decimallatitud c cc_zerox cc_zerox valu flag seealso coordin codelinkcc_cap codelinkcc_cen codelinkcc_coun codelinkcc_dupl codelinkcc_equ codelinkcc_gbif codelinkcc_inst codelinkcc_iucn codelinkcc_outl codelinkcc_sea codelinkcc_urb codelinkcc_v conceptcoordin keywordcoordin keywordclean gener roxygen edit hand pleas edit document rclean_datasetr nameclean_dataset aliasclean_dataset titlecoordin clean use dataset properti usag clean_dataset x lon decimallongitud lat decimallatitud ds dataset test cddmm period valu dataset verbos true argument itemxdatafram contain geograph coordin speci name itemloncharact string column longitud coordin default dquotedecimallongitud itemlatcharact string column latitud coordin default dquotedecimallatitud itemdsa charact string column dataset record case codex treat singl dataset ident record default dquotedataset itemtestsa vector charact string indic test run see detail test avail default cddmm period itemvaluea charact string defin output valu see valu default dquotedataset itemverboselog true report name test number record flag itemaddit argument pass codelinkcd_ddmm codelinkcd_round custom test sensit valu depend squotevalu argument describ itemdquotedataseta codedatafram test summari statist dataset codex itemdquotecleana codedatafram contain record dataset codex pass test itemdquoteflaggeda logic vector length row codex true test pass fals test failedpotenti problemat descript test problem associ coordin convers round base dataset properti includ test identifi contribut dataset potenti error convert ddmm dddd period data decim indic round raster basi link low coordin precis specif item item ddmm test erron convers degre minut format ddmm decim degre dddd format item period test period data indic imprecis coordin due round raster detail test base statist distribut coordin decim within dataset geograph distribut record identifi dataset potenti errorsbias three potenti error sourc identifi ddmm flag test particular pattern emerg geograph coordin degre minut annot transfer decim degre simpli replac degre symbol decim point kind problem observ older dataset first record paper use typewrit eg float point use symbol degre function use binomi test check record expect decim maximum obtain minut one degre minut number record higher certain proport period test use rate estim poisson process estim period decim dataset would expect exampl round data collect raster format proport number record decim full degre indic round thu low precis default valu empir optim gbif data probabl adapt note see urlhttpsropenscigithubiocoordinateclean detail tutori exampl creat test dataset clean dataframedataset repclean decimallongitud runifmin max n decimallatitud runifmin max n biaslong croundrunifmin max n roundrunifmin max n runifmin max n biaslat croundrunifmin max n roundrunifmin max n runifmin max n bia dataframedataset repbias decimallongitud biaslong decimallatitud biaslat test rbindclean bia dontrun run clean_dataset flag clean_datasettest check problem clean histtesttestdataset rownamesflagsflagssummari decimallongitud bias histtesttestdataset rownamesflagsflagssummari decimallongitud seealso codelinkcd_ddmm codelinkcd_round wrapper function codelinkclean_coordin codelinkclean_fossil conceptwrapp function keywordcoordin keywordclean keywordwrapp gener roxygen edit hand pleas edit document rclean_coordinatesr nameclean_coordin aliasclean_coordin aliassummaryspatialvalid aliasisspatialvalid titlegeograph clean coordin biolog collect usag clean_coordin x lon decimallongitud lat decimallatitud speci speci countri null test ccapit centroid equal gbif institut outlier sea zero capitals_rad centroids_rad centroids_detail inst_rad outliers_method quantil outliers_mtp outliers_td outliers_s range_rad zeros_rad capitals_ref null centroids_ref null country_ref null country_refcol iso_a inst_ref null range_ref null seas_ref null seas_scal urban_ref null valu spatialvalid verbos true report fals argument itemxdatafram contain geograph coordin speci name itemloncharact string column longitud coordin default dquotedecimallongitud itemlatcharact string column latitud coordin default dquotedecimallatitud itemspeciesa charact string vector length row x speci ident record null codetest must includ outlier duplic test itemcountriesa charact string column countri assign record three letter iso code default dquotecountrycod miss countri test skip itemtestsa vector charact string indic test run see detail test avail default ccapit centroid equal gbif institut outlier sea zero itemcapitals_radnumer radiu around capit coordin meter default itemcentroids_radnumer radiu around centroid coordin meter default itemcentroids_detaila codecharact string set squotecountri countri adm centroid test set squoteprovinc provinc adm centroid test default squoteboth iteminst_radnumer radiu around biodivers institut coordin metr default itemoutliers_methodth method use outlier test see detail itemoutliers_mtpnumer multipli interquartil rang outlier test null codeoutlierstd use default itemoutliers_tdnumer minimum distanc record record speci identifi outlier km default itemoutliers_sizenumer minimum number record dataset run taxonspecif outlier test default itemrange_radbuff around natur rang default itemzeros_radnumer radiu around degre default itemcapitals_refa codedatafram altern refer data countri capit test miss codecountryref dataset use altern must ident structur itemcentroids_refa codedatafram altern refer data centroid test null codecountryref dataset use altern must ident structur itemcountry_refa codespatialpolygonsdatafram altern refer countri test null codernaturalearthne_countriesmedium dataset use itemcountry_refcolth column name refer dataset contain relev iso code match default iso_a_eh refer iso code refer dataset see note iteminst_refa codedatafram altern refer data biodivers institut test null codeinstitut dataset use altern must ident structur itemrange_refa codespatialpolygonsdatafram speci natur rang requir includ rang test see codelinkcc_iucn detail itemseas_refa codespatialpolygonsdatafram altern refer sea test null rnaturalearthne_downloadscal type land categori physic dataset use itemseas_scaleth scale default landmass refer must one higher number equal higher detail default itemurban_refa codespatialpolygonsdatafram altern refer urban test null test skip see detail refer gazett itemvaluea charact string defin output valu see valu section detail one squotespatialvalid squotesummari squoteclean default squotecodespatialvalid itemverboselog true report name test number record flag itemreportlog charact true report file written work directori summar clean result charact path file written default fals valu depend output argument describ itemdquotespatialvalidan object class codespatialvalid similar x one column ad test true clean coordin entri fals potenti problemat coordin entri summari column fals test flag respect coordin itemdquoteflaggeda logic vector order input data summar result test true clean coordin fals potenti problemat least one test fail itemdquotecleana codedatafram similar x potenti problemat record remov descript clean geograph coordin multipl empir test flag potenti erron coordin address issu common biolog collect databas detail function need coordin formal valid accord wg data contain invalid coordin function stop return vector flag invalid record true nonproblemat coordin fals potenti problemat coordin item item capit test radiu around adm capit radiu codecapitals_rad item centroid test radiu around countri centroid radiu codecentroids_rad item countri test coordin countri indic countri column emphswitch default item duplic test duplic record check ident coordin speci vector provid ident coordin within speci first record flag duplic emphswitch default item equal test equal absolut longitud latitud item gbif test onedegre radiu around gbif headquart copenhagen denmark item institut test radiu around known biodivers institut codeinstiut radiu codeinst_rad item outlier test speci outlier record depend codeoutliers_mtp codeoutlierstd argument either flag record minimum distanc away record speci codeoutliers_td record outsid multipl interquartil rang minimum distanc next neighbour speci codeoutliers_mtp three differ method avail outlier test dquoteoutli boxplot method use record flag outlier emphmean distanc record speci larger mltpl interquartil rang mean distanc record speci dquotemad median absolut deviat use case record flag outlier emphmean distanc record speci larger median mean distanc point plusminu mad mean distanc record speci mltpl dquotedist record flag outlier emphminimum distanc next record speci codetdi item rang test record fall within provid natur rang polygon per speci basi see codelinkcc_iucn detail item sea test coordin fall ocean item urban test coordin urban area emphswitch default item valid check coordin correspond latlon coordin refer system test alway sinc record need pass test run item zero test plain zero equal latitud longitud radiu around point radiu codezerosrad note alway test coordin valid nonnumer miss coordin coordin exceed global extent lonlat wg see urlhttpsropenscigithubiocoordinateclean detail tutori country_refcol argument allow adapt function structur altern refer dataset instanc codernaturalearthne_countriesscal small default fail country_refcol iso_a work exampl exmpl dataframespeci samplelett size replac true decimallongitud runif min max decimallatitud runif min max test clean_coordinatesx exmpl test cequal dontrun run test test clean_coordinatesx exmpl test ccapit centroidsequ gbif institut outlier sea zero summarytest seealso wrapper function codelinkclean_dataset codelinkclean_fossil conceptwrapp function keywordcoordin keywordclean keywordwrapp gener roxygen edit hand pleas edit document rcc_urbr namecc_urb aliascc_urb titleidentifi record insid urban area usag cc_urb x lon decimallongitud lat decimallatitud ref null valu clean verbos true argument itemxdatafram contain geograph coordin speci name itemloncharact string column longitud coordin default dquotedecimallongitud itemlatcharact string column latitud coordin default dquotedecimallatitud itemrefa spatialpolygonsdatafram provid geograph gazett urban area see detail default rnaturalearthne_downloadscal medium type urban_area codespatialpolygonsdatafram structur must ident codernaturalearthne_download itemvaluecharact string defin output valu see valu itemverboselog true report name test number record flag valu depend squotevalu argument either codedatafram contain record consid correct test dquoteclean logic vector dquoteflag true test pass fals test failedpotenti problemat default dquoteclean descript remov flag record insid urban area base geograph gazett often record larg databas span substanti time period centuri old record might repres habitat today replac citi area note see urlhttpsropenscigithubiocoordinateclean detail tutori exampl dontrun x dataframespeci letter decimallongitud runif decimallatitud runif cc_urbx cc_urbx valu flag seealso coordin codelinkcc_cap codelinkcc_cen codelinkcc_coun codelinkcc_dupl codelinkcc_equ codelinkcc_gbif codelinkcc_inst codelinkcc_iucn codelinkcc_outl codelinkcc_sea codelinkcc_v codelinkcc_zero conceptcoordin keywordcoordin keywordclean gener roxygen edit hand pleas edit document rcc_equr namecc_equ aliascc_equ titleidentifi record ident latlon usag cc_equ x lon decimallongitud lat decimallatitud test absolut valu clean verbos true argument itemxdatafram contain geograph coordin speci name itemloncharact string column longitud coordin default dquotedecimallongitud itemlatcharact string column latitud coordin default dquotedecimallatitud itemtestcharact string defin coordin compar exactli dquoteident absolut scale ie dquoteabsolut default dquoteabsolut itemvaluecharact string defin output valu see valu itemverboselog true report name test number record flag valu depend squotevalu argument either codedatafram contain record consid correct test dquoteclean logic vector dquoteflag true test pass fals test failedpotenti problemat default dquoteclean descript remov flag record equal latitud longitud coordin either exact absolut equal coordin often indic data entri error exampl x dataframespeci letter decimallongitud runif decimallatitud runif cc_equx cc_equx valu flag seealso coordin codelinkcc_cap codelinkcc_cen codelinkcc_coun codelinkcc_dupl codelinkcc_gbif codelinkcc_inst codelinkcc_iucn codelinkcc_outl codelinkcc_sea codelinkcc_urb codelinkcc_v codelinkcc_zero conceptcoordin keywordcoordin keywordclean gener roxygen edit hand pleas edit document rcc_counr namecc_coun aliascc_coun titleidentifi coordin outsid report countri usag cc_coun x lon decimallongitud lat decimallatitud iso countrycod valu clean ref null ref_col iso_a verbos true argument itemxdatafram contain geograph coordin speci name itemloncharact string column longitud coordin default dquotedecimallongitud itemlatcharact string column latitud coordin default dquotedecimallatitud itemisoa charact string column countri assign record three letter iso code default dquotecountrycod itemvaluecharact string defin output valu see valu itemrefa spatialpolygonsdatafram provid geograph gazett spatialpolygonsdatafram structur must ident codernaturalearthne_countriesscal medium default codernaturalearthne_countriesscal medium itemref_colth column name refer dataset contain relev iso code match default iso_a_eh refer iso code refer dataset see note itemverboselog true report name test number record flag valu depend squotevalu argument either codedatafram contain record consid correct test dquoteclean logic vector dquoteflag true test pass fals test failedpotenti problemat default dquoteclean descript remov flag mismatch geograph coordin addit countri inform usual inform reliabl report specimen mismatch occur exampl latitud longitud switch note ref_col argument allow adapt function structur altern refer dataset instanc codernaturalearthne_countriesscal small default fail ref_col iso_a work default refer record flag fall outsid terrestri territori countri henc record territori water might flag see urlhttpsropenscigithubiocoordinateclean detail tutori exampl dontrun x dataframespeci letter decimallongitud runif decimallatitud runif countrycod ru cc_counx valu flaggednonterrestri record flag wrong seealso coordin codelinkcc_cap codelinkcc_cen codelinkcc_dupl codelinkcc_equ codelinkcc_gbif codelinkcc_inst codelinkcc_iucn codelinkcc_outl codelinkcc_sea codelinkcc_urb codelinkcc_v codelinkcc_zero conceptcoordin keywordcoordin keywordclean gener roxygen edit hand pleas edit document rcc_valr namecc_v aliascc_v titleidentifi invalid latlon coordin usag cc_val x lon decimallongitud lat decimallatitud valu clean verbos true argument itemxdatafram contain geograph coordin speci name itemloncharact string column longitud coordin default dquotedecimallongitud itemlatcharact string column latitud coordin default dquotedecimallatitud itemvaluecharact string defin output valu see valu itemverboselog true report name test number record flag valu depend squotevalu argument either codedatafram contain record consid correct test dquoteclean logic vector dquoteflag true test pass fals test failedpotenti problemat default dquoteclean descript remov flag nonnumer avail coordin well lat la lon lon flag detail test obligatori run test coordinateclean addit test run valid coordin note see urlhttpsropenscigithubiocoordinateclean detail tutori exampl x dataframespeci letter decimallongitud crunif na w decimallatitud runif cc_valx cc_valx valu flag seealso coordin codelinkcc_cap codelinkcc_cen codelinkcc_coun codelinkcc_dupl codelinkcc_equ codelinkcc_gbif codelinkcc_inst codelinkcc_iucn codelinkcc_outl codelinkcc_sea codelinkcc_urb codelinkcc_zero conceptcoordin keywordcoordin keywordclean gener roxygen edit hand pleas edit document rcd_ddmmr namecd_ddmm aliascd_ddmm titleidentifi dataset degre convers error usag cd_ddmm x lon decimallongitud lat decimallatitud ds dataset pvalu diff mat_siz min_span valu clean verbos true diagnost fals argument itemxdatafram contain geograph coordin speci name itemloncharact string column longitud coordin default dquotedecimallongitud itemlatcharact string column latitud coordin default dquotedecimallatitud itemdsa charact string column dataset record case codex treat singl dataset ident record default dquotedataset itempvaluenumer pvalu onesid ttest flag test pass ddmmpvalu diff must met default itemdiffnumer threshold differ ddmm test indic fraction record decim must outnumb record decim default itemmat_sizenumer size matrix binomi test must chang decim eg adapt dataset size gener better dataset record better dataset record higher valu also work reason well smaller dataset therefor default larg dataset tri itemmin_spannumer minimum geograph extent dataset test default itemvaluecharact string defin output valu see valu itemverboselog true report name test number record flag itemdiagnosticlog true plot analys matrix dataset valu depend squotevalu argument either codedatafram summari statist flag dataset dquotedataset codedatafram contain record consid correct test dquoteclean logic vector dquoteflag true test pass fals test failedpotenti problemat default dquoteclean descript test flag dataset signific fraction record subject common degre minut decim degre convers error degre sign recogn decim delimit detail degre sign recogn decim delimit coordin convers coordin decim possibl test use binomi test test signific proport record dataset subject problem test best adjust via diff argument lower codediff stricter test also scale dataset size empir dataset uniqu coordin record codediff proven reason flag dataset problemat record dataset problemat record dataset geograph uniqu record codediff recommend dataset record diff note see urlhttpsropenscigithubiocoordinateclean detail tutori exampl clean dataframespeci letter decimallongitud runif decimallatitud runif dataset fr cd_ddmmx clean valu flag problemat dataset lon sampl size replac true runif lat sampl size replac true runif prob dataframespeci letter decimallongitud lon decimallatitud lat dataset fr cd_ddmmx prob valu flag seealso dataset codelinkcd_round conceptdataset keywordcoordin keyworddataset keywordclean keywordlevel gener roxygen edit hand pleas edit document rcc_iucnr namecc_iucn aliascc_iucn titleidentifi record outsid natur rang usag cc_iucn x rang lon decimallongitud lat decimallatitud speci speci buffer valu clean verbos true argument itemxdatafram contain geograph coordin speci name itemrangea spatialpolygonsdatafram natur rang speci x must contain column name indic codespeci see detail itemloncharact string column longitud coordin default dquotedecimallongitud itemlatcharact string column latitud coordin default dquotedecimallatitud itemspeciesa charact string column speci name default dquotespeci itembuffernumer buffer around speci rang record flag problemat decim degre default itemvaluecharact string defin output valu see valu itemverboselog true report name test number record flag valu depend squotevalu argument either codedatafram contain record consid correct test dquoteclean logic vector dquoteflag true test pass fals test failedpotenti problemat default dquoteclean descript remov flag record outsid provid natur rang polygon per speci basi expect one entri per speci see exampl urlhttpswwwiucnredlistorgresourcesspatialdatadownload requir polygon structur detail download natur rang map suitabl format amphibian bird mammal reptil urlhttpswwwiucnredlistorgresourcesspatialdatadownload note buffer radiu degre thu differ slightli differ latitud note see urlhttpsropenscigithubiocoordinateclean detail tutori exampl requiresp x dataframespeci ca b decimallongitud runif decimallatitud runif range_species_a polygoncbindcc range_species_b polygoncbindcc range_a polygonslistrange_species_a id ca range_b polygonslistrange_species_b id cb rang spatialpolygonslistrange_a range_b df dataframespeci ca b rownam ca b rang spatialpolygonsdataframerang data asdataframedf cc_iucnx x rang rang buffer seealso coordin codelinkcc_cap codelinkcc_cen codelinkcc_coun codelinkcc_dupl codelinkcc_equ codelinkcc_gbif codelinkcc_inst codelinkcc_outl codelinkcc_sea codelinkcc_urb codelinkcc_v codelinkcc_zero conceptcoordin keywordcoordin keywordclean gener roxygen edit hand pleas edit document rclean_fossilsr nameclean_fossil aliasclean_fossil titlegeograph tempor clean record fossil collect usag clean_fossil x lon lng lat lat min_ag min_ma max_ag max_ma taxon accepted_nam test cagesequ centroid equal gbif institut spatiotemp temprang valid zero countri null centroids_rad centroids_detail inst_rad outliers_method quantil outliers_threshold outliers_s outliers_repl zeros_rad centroids_ref null country_ref null inst_ref null valu spatialvalid verbos true report fals argument itemxdatafram contain fossil record contain taxon name age geograph coordin itemloncharact string column longitud coordin default dquotedecimallongitud itemlatcharact string column latitud coordin default dquotedecimallatitud itemmin_agecharact string column minimum age default dquotemin_ma itemmax_agecharact string column maximum age default dquotemax_ma itemtaxoncharact string column taxon name dquot search outlier entir dataset otherwis per specifi taxon default dquoteaccepted_nam itemtestsvector charact string indic test run see detail test avail default ccentroid equal gbif institut temprang spatiotemp agesequ zero itemcountriesa charact string column countri assign record three letter iso code default dquotecountrycod miss countri test skip itemcentroids_radnumer radiu around centroid coordin meter default itemcentroids_detaila codecharact string set squotecountri countri adm centroid test set squoteprovinc provinc adm centroid test default squoteboth iteminst_radnumer radiu around biodivers institut coordin metr default itemoutliers_methodth method use outlier test see detail itemoutliers_thresholdnumer multipli interquantil rang outlier detect higher number conserv outlier test see codelinkcf_outl detail default itemoutliers_sizenumer minimum number record dataset run taxonspecif outlier test default itemoutliers_replicatesnumer number replic distanc matrix calcul see detail default itemzeros_radnumer radiu around degre default itemcentroids_refa codedatafram altern refer data centroid test null codecountryref dataset use altern must ident structur itemcountry_refa codespatialpolygonsdatafram altern refer countri test null codernaturalearthne_countriesmedium dataset use iteminst_refa codedatafram altern refer data biodivers institut test null codeinstitut dataset use altern must ident structur itemvaluea charact string defin output valu see valu section detail one squotespatialvalid squotesummari squoteclean default squotecodespatialvalid itemverboselog true report name test number record flag itemreportlog charact true report file written work directori summar clean result charact path file written default fals valu depend output argument describ itemdquotespatialvalidan object class codespatialvalid similar x one column ad test true clean coordin entri fals potenti problemat coordin entri summari column fals test flag respect coordin itemdquoteflaggeda logic vector order input data summar result test true clean coordin fals potenti problemat least one test fail itemdquotecleana codedatafram similar x potenti problemat record remov descript clean record multipl empir test flag potenti erron coordin timespan address issu common fossil collect databas individu test activ via test argument detail item item agesequ test equal minimum maximum age item centroid test radiu around countri centroid radiu codecentroids_rad item countri test coordin countri indic countri column emphswitch default item equal test equal absolut longitud latitud item gbif test onedegre radiu around gbif headquart copenhagen denmark item institut test radiu around known biodivers institut codeinstiut radiu codeinst_rad item spatiotemp test record outlier time space see detail item temprang test record unexpectedli larg tempor rang use quantilebas outlier test item valid check coordin correspond latlon coordin refer system test alway sinc record need pass test run item zero test plain zero equal latitud longitud radiu around point radiu codezeros_rad outlier detect squotespatiotemp base interquantil rang test first step distanc matrix geograph distanc among record calcul subsequ similar distanc matrix tempor distanc among record calcul base singl point select random minimum maximum age record mean distanc point neighbour calcul matric spatial tempor distanc scale rang sum distanc test interquantil rang flag outlier eqnx iqrx q_ mltpl test replic squoterepl time account tempor uncertainti record flag outlier flag fraction squoteflag_thresh replic datasetstaxa compris squotesizethresh record test note geograph distanc calcul geospher distanc dataset taxa fewer record approxim euclidean distanc datasetstaxa record datasetstaxa compris record skip note alway test coordin valid nonnumer miss coordin coordin exceed global extent lonlat wg see urlhttpsropenscigithubiocoordinateclean detail tutori exampl minag runif exmpl dataframeaccepted_nam samplelett size replac true lng runif min max lat runif min max min_ma minag max_ma minag runif test clean_fossilsx exmpl summarytest seealso wrapper function codelinkclean_coordin codelinkclean_dataset conceptwrapp function keywordcoordin keywordfossil keywordtempor keywordclean gener roxygen edit hand pleas edit document rcoordinatecleanerpackag doctypedata namepbdb_exampl aliaspbdb_exampl titleexampl data paleobiologydatabas format data frame observ variabl sourc item item paleobiolog databas urlhttpspaleobiodborg item sara varela javier gonzalez hernandez luciano fabri sgarbi paleobiodb download process data paleobiolog databas r packag version urlhttpscranrprojectorgpackagepaleobiodb descript dataset flower plant fossil occurr exampl data paleobiolog databas download use paleobiodb packag specifi vignett dquotecleaning_pbdb_fossils_with_coordinateclean exampl datainstitut strinstitut keywordgazett gener roxygen edit hand pleas edit document rcf_equalr namecf_equ aliascf_equ titleidentifi fossil equal min max age usag cf_equal x min_ag min_ma max_ag max_ma valu clean verbos true argument itemxdatafram contain fossil record taxon name age geograph coordin itemmin_agecharact string column minimum age default dquotemin_ma itemmax_agecharact string column maximum age default dquotemax_ma itemvaluecharact string defin output valu see valu itemverboselog true report name test number record flag valu depend squotevalu argument either codedatafram contain record consid correct test dquoteclean logic vector dquoteflag true test pass fals test failedpotenti problemat default dquoteclean descript remov flag record equal minimum maximum age note see urlhttpsropenscigithubiocoordinateclean detail tutori exampl minag runifn min max x dataframespeci letter min_ma minag max_ma minag runifn min max x rbindx dataframespeci z min_ma max_ma cf_equalx valu flag seealso fossil codelinkcf_ag codelinkcf_outl codelinkcf_rang conceptfossil keywordfossil keywordtempor keywordclean gener roxygen edit hand pleas edit document rcc_cenr namecc_cen aliascc_cen titleidentifi coordin vicin countri provinc centroid usag cc_cen x lon decimallongitud lat decimallatitud speci speci buffer geod true test ref null verifi fals valu clean verbos true argument itemxdatafram contain geograph coordin speci name itemloncharact string column longitud coordin default dquotedecimallongitud itemlatcharact string column latitud coordin default dquotedecimallatitud itemspeciescharact string column speci ident requir verifi true itembuffernumer buffer around provinc countri centroid record flag problemat unit depend geod default kilometr itemgeodlog true radiu around capit calcul base sphere buffer meter independ latitud fals radiu calcul assum planar coordin vari slightli latitud case buffer degre default true see httpsseethedatablogwordpresscom detail credit itemtesta charact string specifi detail test one cdquoteboth dquotecountri dquoteprovinc test countri provinc centroid itemrefspatialpointsdatafram provid geograph gazett spatialpointsdatafram structur must ident codelinkcountryref default codelinkcountryref itemverifylog true record flag record given speci flag close given refer fals distanc criterion itemvaluecharact string defin output valu see valu itemverboselog true report name test number record flag valu depend squotevalu argument either codedatafram contain record consid correct test dquoteclean logic vector dquoteflag true test pass fals test failedpotenti problemat default dquoteclean descript remov flag record within radiu around geograph centroid polit countri provinc poorli georeferenc occurr record biolog databas often erron georeferenc centroid note see urlhttpsropenscigithubiocoordinateclean detail tutori exampl x dataframespeci letter decimallongitud runif decimallatitud runif cc_cenx geod fals dontrun cc_instx valu flag buffer geod seealso coordin codelinkcc_cap codelinkcc_coun codelinkcc_dupl codelinkcc_equ codelinkcc_gbif codelinkcc_inst codelinkcc_iucn codelinkcc_outl codelinkcc_sea codelinkcc_urb codelinkcc_v codelinkcc_zero conceptcoordin keywordcoordin keywordclean gener roxygen edit hand pleas edit document rcoordinatecleanerpackag doctypepackag namecoordinatecleanerpackag aliascoordinatecleanerpackag aliascoordinateclean titlecoordinateclean descript autom clean occurr record biolog collect detail autom flag common spatial tempor error biolog paleontolog collect data use conserv ecolog paleontolog includ autom test easili flag exclud record assign countri provinc centroid open ocean headquart global biodivers inform facil urban area locat biodivers institut museum zoo botan garden univers furthermor identifi per speci outlier coordin zero coordin ident latitudelongitud invalid coordin also implement algorithm identifi data set signific proport round coordin especi suit larg data set see httpsropenscigithubiocoordinateclean detail tutori author alexand zizka daniel silvestro tobia andermann josu azevedo camila duart ritter daniel edler harith farooq andrei herdean maria ariza ruud scharn sten svantesson nikla wengstrom vera zizka gener roxygen edit hand pleas edit document rmethodsspatialvalidr nameplotspatialvalid aliasplotspatialvalid titleplot method class spatialvalid usag methodplotspatialvalid x lon decimallongitud lat decimallatitud bgmap null clean true detail fals pts_size font_siz zoom_f argument itemxan object class codespatialvalid codelinkclean_coordin itemloncharact string column longitud coordin default dquotedecimallongitud itemlatcharact string column latitud coordin default dquotedecimallatitud itembgmapan object class codespatialpolygonsdatafram use background map default ggplotbord itemcleanlog true nonflag coordin includ map itemdetailslog true occurr colorcod type flag itempts_sizenumer point size plot itemfont_sizenumer font size legend axe itemzoom_fnumer fraction expand plot area occurr record increas countri show background map itemdotsargu pass method valu plot record flag potenti erron codelinkclean_coordin descript set plot explor object class codespatialvalid plot visual flag clean_coordin exampl exmpl dataframespeci samplelett size replac true decimallongitud runif min max decimallatitud runif min max test clean_coordinatesexmpl speci speci test csea gbif zero verbos fals summarytest plottest seealso codelinkclean_coordin keywordvisualis gener roxygen edit hand pleas edit document rcoordinatecleanerpackag doctypedata nameinstitut aliasinstitut titleglob locat biodivers institut format data frame observ variabl sourc compil variou sourc item item global biodivers inform facil urlhttpswwwgbiforg item wikipedia urlhttpswwwwikipediaorg item geonam urlhttpswwwgeonamesorg item global registri biodivers repositori item index herbariorum urlhttpsweetgumnybgorgscienceih item botan garden conserv intern urlhttpswwwbgciorg descript global gazett biodivers institut variou sourc includ zoo museum botan garden gbif contributor herbaria univers collect exampl datainstitut strinstitut keywordgazett gener roxygen edit hand pleas edit document rcf_outlr namecf_outl aliascf_outl titleidentifi outlier record space time usag cf_outl x lon decimallongitud lat decimallatitud min_ag min_ma max_ag max_ma taxon accepted_nam method quantil size_thresh mltpl replic flag_thresh uniq_loc fals valu clean verbos true argument itemxdatafram contain fossil record taxon name age geograph coordin itemloncharact string column longitud coordin identifi uniqu record codeuniq_loc true default dquotedecimallongitud itemlatcharact string column longitud coordin default dquotedecimallatitud identifi uniqu record codeuniq_loc itemmin_agecharact string column minimum age default dquotemin_ma itemmax_agecharact string column maximum age default dquotemax_ma itemtaxoncharact string column taxon name dquot search outlier entir dataset otherwis per specifi taxon default dquoteaccepted_nam itemmethodcharact string defin method outlier select see detail either dquotequantil dquotemad default dquotequantil itemsize_threshnumer minimum number record need dataset test default itemmltplnumer multipli interquartil rang codemethod quantil median absolut deviat codemethod mad identifi outlier see detail default itemreplicatesnumer number replic distanc matrix calcul see detail default itemflag_threshnumer fraction pass replic necessari pass test see detail default itemuniq_loclog true singl record per locat time point taxon codetaxon use outlier test default itemvaluecharact string defin output valu see valu itemverboselog true report name test number record flag valu depend squotevalu argument either codedatafram contain record consid correct test dquoteclean logic vector dquoteflag true test pass fals test failedpotenti problemat default dquoteclean descript remov flag record fossil spatiotempor outlier base interquantil rang record flag either extrem time space detail outlier detect base interquantil rang test first step distanc matrix geograph distanc among record calcul subsequ similar distanc matrix tempor distanc among record calcul base singl point select random minimum maximum age record mean distanc point neighbour calcul matric spatial tempor distanc scale rang sum distanc test interquantil rang flag outlier eqnx iqrx q_ mltpl test replic squoterepl time account tempor uncertainti record flag outlier flag fraction squoteflagthr replic datasetstaxa compris squotesize_thresh record test note geograph distanc calcul geospher distanc dataset taxa fewer record approxim euclidean distanc datasetstaxa record datasetstaxa compris record skip note see urlhttpsropenscigithubiocoordinateclean detail tutori exampl minag crunifn min max x dataframespeci cletter repz lng crunifn min max lat crunifn min max min_ma minag max_ma cminag runifn min max cf_outlx valu flag taxon seealso fossil codelinkcf_ag codelinkcf_equ codelinkcf_rang conceptfossil keywordcoordin keywordfossil keywordtempor keywordclean