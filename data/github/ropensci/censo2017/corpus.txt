readmemd gener readmermd pleas edit file censo paquet r badg start project statu activ project reach stabl usabl state activ developedhttpslifecyclerliborgarticlesfigureslifecyclestablesvghttpslifecyclerliborgarticlesstageshtmlst lifecycl stablehttpsimgshieldsiobadgelifecyclematuringbluesvghttpswwwtidyverseorglifecyclest ghactionshttpsgithubcomropenscicensoworkflowsrcmdcheckbadgesvghttpsgithubcomropenscicensoact codecovhttpscodecovioghropenscicensobranchmaingraphbadgesvgtokenxicmgdhttpscodecovioghropenscicenso cran statushttpswwwrpkgorgbadgesversioncensohttpscranrprojectorgpackagecenso doihttpszenodoorgbadgedoizenodosvghttpsdoiorgzenodo buy coffeehttpsimgshieldsiobadgebuymeacoffeepachayellowhttpswwwbuymeacoffeecompachaviagithub statu ropensci softwar peer reviewhttpsbadgesropensciorg_statussvghttpsgithubcomropenscisoftwarereviewissu badg end acerca de prove un acceso convenient ma de millon de registro de la base de dato del censo lo dato fueron importado desd el dvd ofici del ine usando el convertidor redatamhttpsgithubcomdiscontinuosredatamconvert creado por pablo de grand adema se proporcionan lo mapa que acompanian esto dato esto mismo dato en dvd posteriorment quedaron dispon en la base de dato del inehttpswwwineclestadisticassocialescensosdepoblacionyviviendapoblacionyvivienda despu de la primera llamada librarycenso se le pedira al usuario que descargu la base usando censo_descargar_bas se pued modificar la ruta de descarga con la variabl de entorno censo_bbdd_dir la variabl de entorno se pued crear con usethisedit_r_environ la documentacion esta dispon en httpsdocsropensciorgcenso publico objetivo estudiant academico e investigador que necesiten un acceso convenient dato censal directament en r rstudio requerimiento de instalacion est paquet necesita gb libr para la crear la base de dato localment instalacion version establ installpackagescenso version de desarrollo installpackagesremot remotesinstall_githubropenscicenso valor agregado sobr lo archivo shp redatam del ine esta version de la base de dato del censo presenta alguna diferencia respecto de la origin que se obtien en dvd correspond una version duckdb derivada partir de lo microdato del censo en formato dvd la modificacion sobr lo archivo original que incluyen geometria detallada dispon en cartografia censohttpsgithubcomropenscicensocartografia consistio en unir todo lo archivo shp regional en una unica tabla por nivel eg en lugar de proveer r_mapa_comuna r_mapa_comuna combin la region en una unica tabla mapa_comuna lo cambio concreto respecto de la base origin son lo siguient nombr de columna en formato tidi eg comuna_ref_id en lugar de comuna_ref_id agregu lo nombr de la unidad geografica eg se incluy nom_comuna en la tabla comuna para facilitar lo filtro aniadi la variabl geocodigo la tabla de zona esto facilita mucho la union con la tabla de mapa en sql tambien inclui la observacion en la variabl zonaloc_ref_id esto se debio que era necesario para crear una llave foranea desd la tabla mapa_zona ver repositorio cartografia censohttpsgithubcomropenscicensocartografia vincular el geocodigo toda la zona del mapa estan present en lo dato del censo adema de lo dato del censo inclui la descripcion de la variabl en formato tabla en xml como se obtien del dvd la ventaja de esto es poder consultar rapidament lo que significan lo codigo de variabl su etiquetado por ejemplo r con la bbdd instalada librarycenso librarydplyr censo_tablavari filtervari p tibbl x tabla variabl descripcion tipo rango chr chr chr chr chr vivienda p tipo de vivienda integ censo_tablavariables_codificacion filtervari p tibbl x tabla variabl valor descripcion chr chr int chr vivienda p casa vivienda p departamento en edificio vivienda p vivienda tradicion indígena ruka pae pae u otra vivienda p pieza en casa antigua en conventillo vivienda p mediagua mejora rancho choza vivienda p móvil carpa casa rodant similar vivienda p otro tipo de vivienda particular vivienda p vivienda colectiva vivienda p operativo persona en tránsito es vivienda vivienda p operativo call es vivienda vivienda p valor perdido vivienda p aplica relacion de censo con chilemapa todo lo dato de esto repositorio contemplan region pue lo archivo del censo se entregan de esta forma est paquet esta orientado facilitar el acceso dato por su part chilemapashttpsdocsropensciorgcenso se centra unicament en lo mapa tambien usa la cartografia del dvd del censo para entregar mapa simplificado de menor detal ma liviano chilemapa cuenta con una transformacion de codigo para dar cuenta de la creacion de la region de niubl en resumen censo permit construir estadistica demografica chilemapa ayuda mostrarla en un mapa usando ggplot u otro paquet como tmap cita est trabajo si usa censo en trabajo academico u otro tipo de publicacion por favor usa la siguient cita mauricio varga censo base de dato de facil acceso del censo de chile chilean censu easi access databas r packag version httpsdocsropensciorgcenso entrada para bibtex manual titl censo base de dato de facil acceso del censo de chile chilean censu easi access databas author mauricio varga year note r packag version url httpsdocsropensciorgcenso doi zenodo contribucion para contribuir est proyecto debe estar de acuerdo con el codigo de conducta de ropenscihttpsropensciorgcodeofconduct es util contar con ma ejemplo mejora la funcion todo lo que ayud la comunidad si tien algo que aportar pued dejar un issu pull request agradecimiento mucha gracia juan correa por su asesoria como geografo experto aport si quier donar para aportar al desarrollo de est ma paquet open sourc pued hacerlo en buy coffeehttpswwwbuymeacoffeecompacha version add ropensci suggest mean great improv better document consist syntax depend duckdb version etc see httpsgithubcomropenscisoftwarereviewissu full detail version work duckdb remov databas use older censo version version move local databas locat accord cran request requir r use duckdb instead sqlite version add vignett rbuildignor compli cran polici regard suggest vignett avail ghpage output github_docu readmemd gener readmermd pleas edit file r includ fals knitropts_chunkset collaps true comment figpath manfiguresreadm outwidth censo paquet r badg start project statu activ project reach stabl usabl state activ developedhttpslifecyclerliborgarticlesfigureslifecyclestablesvghttpslifecyclerliborgarticlesstageshtmlst lifecycl stablehttpsimgshieldsiobadgelifecyclematuringbluesvghttpswwwtidyverseorglifecyclest ghactionshttpsgithubcomropenscicensoworkflowsrcmdcheckbadgesvghttpsgithubcomropenscicensoact codecovhttpscodecovioghropenscicensobranchmaingraphbadgesvgtokenxicmgdhttpscodecovioghropenscicenso cran statushttpswwwrpkgorgbadgesversioncensohttpscranrprojectorgpackagecenso doihttpszenodoorgbadgedoizenodosvghttpsdoiorgzenodo buy coffeehttpsimgshieldsiobadgebuymeacoffeepachayellowhttpswwwbuymeacoffeecompachaviagithub statu ropensci softwar peer reviewhttpsbadgesropensciorg_statussvghttpsgithubcomropenscisoftwarereviewissu badg end acerca de prove un acceso convenient ma de millon de registro de la base de dato del censo lo dato fueron importado desd el dvd ofici del ine usando el convertidor redatamhttpsgithubcomdiscontinuosredatamconvert creado por pablo de grand adema se proporcionan lo mapa que acompanian esto dato esto mismo dato en dvd posteriorment quedaron dispon en la base de dato del inehttpswwwineclestadisticassocialescensosdepoblacionyviviendapoblacionyvivienda despu de la primera llamada librarycenso se le pedira al usuario que descargu la base usando censo_descargar_bas se pued modificar la ruta de descarga con la variabl de entorno censo_dir la variabl de entorno se pued crear con usethisedit_r_environ la documentacion esta dispon en httpsdocsropensciorgcenso publico objetivo estudiant academico e investigador que necesiten un acceso convenient dato censal directament en r rstudio requerimiento de instalacion est paquet necesita gb libr para la crear la base de dato localment instalacion version establ installpackagescenso version de desarrollo installpackagesremot remotesinstall_githubropenscicenso valor agregado sobr lo archivo shp redatam del ine esta version de la base de dato del censo presenta alguna diferencia respecto de la origin que se obtien en dvd correspond una version duckdb derivada partir de lo microdato del censo en formato dvd la modificacion sobr lo archivo original que incluyen geometria detallada dispon en cartografia censohttpsgithubcomropenscicensocartografia consistio en unir todo lo archivo shp regional en una unica tabla por nivel eg en lugar de proveer r_mapa_comuna r_mapa_comuna combin la region en una unica tabla mapa_comuna lo cambio concreto respecto de la base origin son lo siguient nombr de columna en formato tidi eg comuna_ref_id en lugar de comuna_ref_id agregu lo nombr de la unidad geografica eg se incluy nom_comuna en la tabla comuna para facilitar lo filtro aniadi la variabl geocodigo la tabla de zona esto facilita mucho la union con la tabla de mapa en sql tambien inclui la observacion en la variabl zonaloc_ref_id esto se debio que era necesario para crear una llave foranea desd la tabla mapa_zona ver repositorio cartografia censohttpsgithubcomropenscicensocartografia vincular el geocodigo toda la zona del mapa estan present en lo dato del censo adema de lo dato del censo inclui la descripcion de la variabl en formato tabla en xml como se obtien del dvd la ventaja de esto es poder consultar rapidament lo que significan lo codigo de variabl su etiquetado por ejemplo r messagefals warningfals con la bbdd instalada librarycenso librarydplyr censo_tablavari filtervari p censo_tablavariables_codificacion filtervari p relacion de censo con chilemapa todo lo dato de esto repositorio contemplan region pue lo archivo del censo se entregan de esta forma est paquet esta orientado facilitar el acceso dato por su part chilemapashttpsdocsropensciorgcenso se centra unicament en lo mapa tambien usa la cartografia del dvd del censo para entregar mapa simplificado de menor detal ma liviano chilemapa cuenta con una transformacion de codigo para dar cuenta de la creacion de la region de niubl en resumen censo permit construir estadistica demografica chilemapa ayuda mostrarla en un mapa usando ggplot u otro paquet como tmap cita est trabajo si usa censo en trabajo academico u otro tipo de publicacion por favor usa la siguient cita mauricio varga censo base de dato de facil acceso del censo de chile chilean censu easi access databas r packag version httpsdocsropensciorgcenso entrada para bibtex manual titl censo base de dato de facil acceso del censo de chile chilean censu easi access databas author mauricio varga year note r packag version url httpsdocsropensciorgcenso doi zenodo contribucion para contribuir est proyecto debe estar de acuerdo con el codigo de conducta de ropenscihttpsropensciorgcodeofconduct es util contar con ma ejemplo mejora la funcion todo lo que ayud la comunidad si tien algo que aportar pued dejar un issu pull request agradecimiento mucha gracia juan correa por su asesoria como geografo experto aport si quier donar para aportar al desarrollo de est ma paquet open sourc pued hacerlo en buy coffeehttpswwwbuymeacoffeecompacha titl uso basico del paquet censo author mauricio varga date r sysdat output rmarkdownhtml_vignett vignett vignetteindexentryuso basico del paquet censo vignetteengineknitrrmarkdown vignetteencodingutf r setup includ fals knitropts_chunkset cach fals collaps true eval true comment introduccion est paquet se integra perfectament con el tidyvers con el que daremo un ejemplo muy basico para mostrar su principal funcion aproximacion de la poblacion con el grado de doctor en la region del bio bio se procedera obten una aproximacion usando dplyr ya que pued haber persona que sean de la comuna aparezcan censada en ella sin embargo cabe aclarar que para esta ocas haremo el filtro que corrig esto nuestra idea es manten el ejemplo lo ma simpl posibl primero que todo se cargan lo paquet necesario censo proporciona lo dato censal para poder generar la tabla grafico de est ejemplo dplyr facilta filtrar dato en una tabla unir distinta tabla en gener toda la tarea de limpieza transformacion de dato ggplot no permit graficar usando el concepto de gramatica de grafico es decir que podemo ir creando grafico incremental controlar lo eje titulo dema elemento por separado chilemapa no entrega mapa terrestr con topologia simplificada esto significa que est paquet al conten poligono que generan grafico tabla no permit un uso ma sencillo para lo que queremo realizar que es darl un complemento visual la información cargada desd censo r warningfals messagefals librarycenso librarydplyr libraryggplot librarychilemapa hay que realizar alguno cruce de tabla de manera de filtrar la region que no interesa comenzamo con la tabla zona generamo la provincia partir del geocodigo luego filtro para unir hasta llegar la tabla persona no interesa utilizar la variabl p cuya descripcion esta en la tabla variabl cuya codificacion aparec en la tabla variables_codificacion r warningfals messagefals evalfals nivel_educacional_biobio tblcenso_conectar zona mutat region substrascharactergeocodigo comuna substrascharactergeocodigo filterregion selectcomuna geocodigo zonaloc_ref_id inner_joinselecttblcenso_conectar vivienda zonaloc_ref_id vivienda_ref_id zonaloc_ref_id inner_joinselecttblcenso_conectar hogar vivienda_ref_id hogar_ref_id vivienda_ref_id inner_joinselecttblcenso_conectar persona hogar_ref_id nivel_educ p hogar_ref_id collect con lo anterior lo nivel educacional de la persona censada se pueden agrupar por comuna obten la cuenta proporcionada en base la suma total r warningfals messagefals evalfals nivel_educacional_biobio nivel_educacional_biobio group_bycomuna nivel_educ summarisecuenta n group_bycomuna mutateproporcion cuenta sumcuenta vemo lo dato ant de continuar r nivel_educacional_biobio creamo la variabl mapa_biobio haciendo un filtro para obten unicament lo dato de la region con codigo region del bio bio desd mapa_comuna luego de eso haremo un left join union de tabla manteniendo toda la fila de la tabla izquierda inici desd la tabla chilemapa dond obtendremo el mapa de la provincia la uniremo con lo dato coincident segon el codigo_comuna de la tabla censo r warningfals messagefals mapa_biobio mapa_comuna filtercodigo_region left_joinnivel_educacional_biobio ccodigo_comuna comuna ahora que cargamo toda la informacion necesaria en r desd la base de dato debemo cerrar la conexion sql important r warningfals messagefals censo_desconectar finalment procedemo generar el mapa primero creamo la variabl color en el que incluiremo lo codigo hexadecimal de lo color que utilizaremo al momento de crear el mapa luego de hecho esto utilizamo geom_sf del paquet ggplot que se usa para visualizar objeto de caracteristica simpl sf simpl featur geom_sf dibujara diferent objeto geometrico partir de una columna de tipo sf que debe estar present en lo dato seleccionamo el codigo_comuna geometri que contien lo poligono que componen cada region desd el mapa_biobio que creamo anteriorment volvemo hacer un left_join ahora de mapa_biobio seleccionando unicament codigo_comuna nivel_educ proporcion r figwidth warningfals messagefals color cdcaccdbccaaca g ggplot geom_sfdata mapa_biobio selectcodigo_comuna geometri left_join mapa_biobio filternivel_educ selectcodigo_comuna nivel_educ proporcion codigo_comuna aesfil proporcion geometri geometri size scale_fill_gradientncolour revcolor name porcentaj labstitl porcentaj de habitant con el grado de doctornpor comuna en la region del bio bio theme_minimalbase_s g nota el uso de tbl collect en la primera part se podra entend mejor leyendo por ejemplo crash cours postgresql r usershttpspachadevblogacrashcourseonpostgresqlforrus en la segunda part se usa censo_tabla ya que sql almacena la columna geometri de tipo poligono como cadena de texto mientra que r lee poligono sin problema en la tercera part hago un join entr el mapa completo la tabla con quien tienen el grado de doctor est paso aunqu pueda parec redundant es necesario si quiero mostrar la zona con doctor si lo omito se borran alguna zona del mapa el mapa que se genero usando la funcion de chilemapa podria haber generado con la cartografia oficial del censo ver repositorio cartografiascenso esta alternativa entrega un mayor nivel de detal pero requier mayor esfuerzo para leer la cartografia el tiempo requerido para generar lo mapa aumenta fuertement ejercicio para el usuario realizar un grafico similar al del ejemplo pero nivel de zona censal explorar la columna p en la tabla persona realizar un grafico que de cuenta de la poblacion efectiva de la comuna eg mejorando el problema de persona que podrian ser de la comuna en el ejemplo agregar dato al mapa sin usar chilemapa una forma de hacerlo es la siguient r warningfals messagefals evalfals mapa_biobio censo_tablamapa_comuna filterregion left_joinnivel_educacional_biobio comuna gener roxygen edit hand pleas edit document rcensopackag doctypepackag namecensopackag aliascenso aliascensopackag titlecenso base de dato de facil acceso del censo de chile chilean censu easi access databas descript prove un acceso convenient ma de millon de registro de la base de dato del censo lo dato fueron importado desd el dvd ofici del ine usando el convertidor redatam creado por pablo de grand esta paquet esta documentado intencionalment en castellano asciificado para que funcion sin problema en diferent plataforma provid conveni access million record chilean censu databas dataset import offici dvd provid chilean nation bureau statist use redatam convert creat pablo de grand addit includ map accompani dataset seealso use link item item urlhttpsdocsropensciorgcenso item report bug urlhttpsgithubcomropenscicensoissu author strongmaintain mauricio varga emailmavargasuccl hrefhttpsorcidorgorcid contributor item item juan correa contributor item maria paula calda ropensci review item fran van dune ropensci review item melina vidoni ropensci review item constanza manriquez revis independient de la vinieta review item instituto nacion de estadistica ine data contributor keywordintern gener roxygen edit hand pleas edit document rconnectr namecenso_conectar aliascenso_conectar titleconexion la base de dato del censo usag censo_conectardir censo_path argument itemdirla ubicacion de la base de dato en el disco por defecto es codecenso en la carpeta de dato del usuario de r la variabl de entorno codecenso_dir si el usuario la especifica descript devuelv una conexion la base de dato local esto correspond una conexion una base duckdb compat con dbi diferencia de codelinkcenso_tablacenso_tabla esta funcion es ma flexibl se pued usar con dbplyr para leer unicament lo que se necesita directament con dbi para usar comando sql exampl dontrun dbidblisttablescenso_conectar dbidbgetqueri censo_conectar select comuna provincia_ref_id gener roxygen edit hand pleas edit document rconnectr namecenso_tabla aliascenso_tabla titletabla completa de la base de dato del censo usag censo_tablatabla argument itemtablauna cadena de texto indicando la tabla extraer valu un tibbl descript devuelv una tabla completa de la base de dato para entregar dato filtrado previament se debe usar codelinkcenso_conectarcenso_conectar exampl dontrun censo_tablacomuna gener roxygen edit hand pleas edit document rdownloadr namecenso_descargar aliascenso_descargar titledescarga la base de dato del censo tu computador usag censo_descargarv null argument itemverla version descargar por defecto es la ultima version dispon en github se pueden ver toda la version en urlhttpsgithubcompachamaltesecensoreleas descript est comando descarga la base de dato completa como un unico archivo zip que se descomprim para crear la base de dato local si quier descargar la base de dato en tu home ejecuta usethisedit_r_environ para crear la variabl de entorno censo_dir con la ruta exampl dontrun censo_descargar gener roxygen edit hand pleas edit document rconnectr namecenso_desconectar aliascenso_desconectar titledesconecta la base de dato del censo usag censo_desconectar descript una funcion auxiliar para desconectars de la base de dato exampl censo_desconectar gener roxygen edit hand pleas edit document rcensopackag doctypedata namenivel_educacional_biobio aliasnivel_educacional_biobio titlepoblacion por nivel educacion en la region del bio bio format un tibbl con observacion en la siguient variabl describ itemcodecomunacodigo de comuna region itemcodenivel_educmaximo nivel educacion alcanzado ver la vinieta con lo link la descripcion de codigo itemcodecuentacantidad de persona censada en la comuna itemcodeproporcionporcentaj que representan la persona censada en la comuna descript proporciona la cuenta porcentaj por comuna de la persona de la region del bio bio de acuerdo al maximo nivel educacion que reportan eg primaria secundaria universitaria etc exampl nivel_educacional_biobio dontrun replicar el resultado usando dplyr directament con sql es ligerament distinto la vinieta que explican esta misma tabla nivel_educacional_biobio tblcenso_conectar zona mutat region substrascharactergeocodigo comuna substrascharactergeocodigo filterregion selectcomuna geocodigo zonaloc_ref_id inner_joinselecttblcenso_conectar vivienda zonaloc_ref_id vivienda_ref_id zonaloc_ref_id inner_joinselecttblcenso_conectar hogar vivienda_ref_id hogar_ref_id vivienda_ref_id inner_joinselecttblcenso_conectar persona hogar_ref_id nivel_educ p hogar_ref_id group_bycomuna nivel_educ summarisecuenta n group_bycomuna mutateproporcion cuenta sumcuenta arrangecomuna nivel_educ author elaboracion propia con base en dato desagregado del censo keyworddata gener roxygen edit hand pleas edit document rremov namecenso_eliminar aliascenso_eliminar titleelimina la base de dato del censo de tu computador usag censo_eliminarpreguntar true argument itempreguntarsi acaso se despliega un menu para confirmar la accion de borrar cualquier base del censo existent por defecto es verdadero descript elimina el directorio codecenso todo su contenido incluyendo version de la base de dato del censo creada con cualquier version de duckdb exampl dontrun censo_eliminar