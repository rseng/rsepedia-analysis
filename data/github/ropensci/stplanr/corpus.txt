contributor code conduct contributor maintain project pledg respect peopl contribut report issu post featur request updat document submit pull request patch activ commit make particip project harassmentfre experi everyon regardless level experi gender gender ident express sexual orient disabl person appear bodi size race ethnic age religion exampl unaccept behavior particip includ use sexual languag imageri derogatori comment person attack troll public privat harass insult unprofession conduct project maintain right respons remov edit reject comment commit code wiki edit issu contribut align code conduct project maintain follow code conduct may remov project team instanc abus harass otherwis unaccept behavior may report open issu contact one project maintain code conduct adapt contributor coven httpcontributorcovenantorg version avail httpcontributorcovenantorgvers readmemd gener readmermd pleas edit file stplanr hrefhttpsdocsropensciorgstplanrimg srcmanfigureslogopng alignright heighta build statushttpstravisciorgropenscistplanrsvgbranchmasterhttpstravisciorgropenscistplanr rstudio mirror downloadshttpscranlogsrpkgorgbadgesstplanrhttpsgithubcomrhubcranlogsapp httpscranlogsrpkgorgbadgesgrandtotalstplanrhttpscranrprojectorgpackagestplanr cran_status_badgehttpswwwrpkgorgbadgesversionstplanrhttpscranrprojectorgpackagestplanr lifecyclehttpsimgshieldsiobadgelifecyclematuringbluesvghttpslifecyclerliborgarticlesstageshtml httpsbadgesropensciorg_statussvghttpsgithubcomropenscisoftwarereviewissu rcmdcheckhttpsgithubcomropenscistplanrworkflowsrcmdcheckbadgesvghttpsgithubcomropenscistplanract stplanr packag sustain transport plan r provid function solv common problem transport plan model best get point point b overal aim provid reproduc transpar access toolkit help peopl better understand transport system inform polici outlin paperhttpsjournalrprojectorgarchiverjindexhtml packag potenti open sourc softwar transport plan gener publish r journalhttpsjournalrprojectorg initi work project fund depart transport dfthttpswwwgovukgovernmentorganisationsdepartmentfortransport part develop propens cycl tool pct web applic explor current travel pattern cycl potenti zone desir line rout rout network level see wwwpctbikehttpswwwpctbik click region tri basi method underli pct origindestin data use highlight mani short distanc trip made estim mani could switch cycl result help identifi cycleway need import compon sustain transport plan infrastructur engin polici designhttpswwwicevirtuallibrarycomdoiabsdfct see packag vignett eg via vignetteintroducingstplanr academ paper propens cycl tool pcthttpsdxdoiorgjtlu inform use readm provid basic much work support research undertaken leed institut transport studi itshttpsenvironmentleedsacuktransport stplanr use transport research practition need free open reproduc method work geograph data everywher key function data frame repres flow origin destin must combin georeferenc zone point gener meaning analys visualis flow origindestin od data stplanr facilit odlin take flow geograph data input output spatial data exampl data provid packag r librarystplanr let take look data r od_data_sampl typic form flow data tibbl x geo_cod geo_cod chr chr dbl e e e e e e cents_sf point repres origin destin geo_cod msoanm percent_fem avslop geometri e leed e leed e leed dataset combin follow r travel_network odlineflow od_data_sampl zone cents_sf w flowal maxflowal plottravel_network lwd w img srcmanfiguresreadmeplotpng width stplanr mani function work od data see stplanrodhttpsdocsropensciorgstplanrarticlesstplanrodhtml vignett detail packag also alloc flow road network eg cyclestreetsnethttpswwwcyclestreetsnetapi openstreetmap rout machin osrmhttpsgithubcomprojectosrmosrmbackend api interfac support route_ function route_cyclestreet route_osrm rout done use rang backend use latlon desir line input rout function illustr follow command calcul rout fleet street southwark street river thame blackfriar bridg london r libraryosrm data c openstreetmap contributor odbl httpwwwopenstreetmaporgcopyright rout osrm httpprojectosrmorg trip rout c c route_fun osrmrout returnclass sf common output sf mapviewmapviewtrip img srcmanfiguresreadmeunnamedchunkpng width also use place name found use googl map api r trip rout leed bradford route_fun osrmrout returnclass sf common output sf mapviewmapviewtrip img srcmanfiguresreadmeunnamedchunkpng width replic call multipl time l argument rout r desire_lin travel_network next well calcul rout r rout rout l desire_lin route_fun osrmrout returnclass sf mapviewmapviewrout mapviewmapviewdesire_lin color red img srcmanfiguresreadmeplotpng width result rout look someth like exampl examplerout overlin take seri routealloc line split uniqu segment aggreg valu overlap line repres traffic transport system demonstr follow code chunk r routesfoot desire_linesfoot rnet overlinerout attrib foot construct segment build geometri simplifi geometri aggreg flow rejoin segment linestr result rout network segment total calcul overlap part rout walk visualis follow r plotrnetfoot lwd rnetfoot img srcmanfiguresreadmeunnamedchunkpng width plot repres number walk trip made flow along particular segment transport network result shown polici applic exampl shown base tini demonstr dataset may seem particularli revolutionari citi scale howev type analysi use inform sustain transport polici describ paper describ propens cycl toolhttpswwwjtluorgindexphpjtluarticleview pct applic calcul cycl school potentialhttpswwwsciencedirectcomsciencearticlepii across england result gener stplanr part nation govern polici pct recommend tool local region author develop strateg cycl network cycl walk infrastructur strategi cwishttpswwwgovukgovernmentpublicationscyclingandwalkinginvestmentstrategi part infrastructur act httpswwwlegislationgovukukpgacontentsenact stplanr help dozen local author across uk answer question prioritis invest cycl essenc stplanr design support sustain transport polici mani research polici question function stplanr open sourc softwar librari packag help answer time climat health social crise import technolog sustain eg enabl open sourc commun licens contribut sustain futur instal instal stabl version use r installpackagesstplanr develop version instal use devtool r installpackagesdevtool alreadi instal devtoolsinstall_githubropenscistplanr librarystplanr stplanr depend rgdal tricki instal instal stplanr linux mac stplanr depend sf instal instruct mac ubuntu linux distro found httpsgithubcomrspatialsfinstal function help contribut current list avail function seen packag websit docsropensciorgstplanrhttpsdocsropensciorgstplanr follow command r lsfstrpackagestplanr true get intern help specif function use standard way r odlin contribut report bug request featur see issu trackerhttpsgithubcomropenscistplanrissu resourc tutori want learn use open sourc softwar reproduc sustain transport plan work great time learn transport plan rel new field applic r howev alreadi good resourc topic includ suggest welcom transport chapter geocomput r provid broad introduct geograph data perspect httpsgeocomprrobinlovelacenettransporthtml stplanr paper describ context packag develop httpsjournalrprojectorgarchiverjindexhtml pleas cite use stplanr work dodgr vignett provid introduct rout r httpsatfuturesgithubiododgr meta pleas report issu featur request question github issu trackerhttpsgithubcomropenscistplanrissu licens mit get citat inform stplanr r citationpackag stplanr project releas contributor code conducthttpsgithubcomropenscistplanrblobmasterconductmd particip project agre abid term rofooterhttpsropensciorgpublic_imagesgithub_footerpnghttpsropensciorg stplanr novemb rout check cr give appropri warn project packag suggest igraph rather depend make easier instal stplanr longer suggest stat packag stplanr longer suggest bench packag test pass internet unavail stplanr output line_via correct cr calc_catch deprec gener warn minor fix improv packag document stplanr bug fix relat rout function silent fail pbappli instal packag promot suggest import stplanr thank styler packag code stplanr adher consist style use arrow assign despit maintain default equal assign mani introduc accident new function rnet_group group rout network element overlin convert multilinestr geometri linestr automat rout network use sum_network_rout return linestr rout start end ie travel rout use route_loc fix l argument work new route_osrm function rnet_breakup_vertic way faster thank andrea gilardi other rnet_group gener function work sfnetwork object route_osrm provid easi access multimod rout bug rout function calcul bbox attribut fix stplanr new function line_breakup breaksup line minor document fix includ stplanr support sf object toptail_buff updat exampl test readm enabl test pass legaci version proj reduc vulner upcom upstream chang stplanr tweak document exampl cran test stplanr issu linepoint setup fix old mapshap line_match gclip function deprec maintain altern found packag sp object updat latest version sp sf object updat support recent cr encod deprec function includ od_aggreg onewayid gtfssldf od_radi remov stplanr new featur new interfac googl direct api via mapsapi packag new quiet argument overlin make less chatti stplanr bug fix rout fail datat instal stplanr bug fix bug spatiallinesnetwork fix thank andrea gilardi updat document find shortest path check start end argument short path calcul numer dodgr remov suggest back cran updat dplyr code prevent warn use dev version new featur improv rout allow save list raw output use datat faster perform avail fleet new route_rolling_ function ad route_rolling_gradi calcul roll gradient elev distanc data segment level route_rolling_averag calcul roll averag valu route_rolling_diff calcul roll differ valu next geo_toptail function sf implement new cl argument rout parallel rout new updat dataset repres od_data_sampl differ way od_data_lin od_data_rout route_graphhopp deprec old function use legaci sp dplyr code sp_aggreg od_aggreg deprec new workinprogress route_slop function stplanr bug fix document fix bug affect rout function call pbappli instal fix oneway deprec favour faster easiertomaintain function od_oneway also see indevelop od packag variou chang made accomod dev version dplyr stplanr chang compat r stplanr route_graphhopp work local graphhopp instanc see httpsgithubcomropenscistplanrpul old linerout function work rout function return sf object new rout function resili provid progress bar pbappli packag instal return result even rout fail tell rout fail packag fewer depend readr openxlsx lubrid remov deprec function buff_geo remov bug fix destin work argument linerout overlin accept sf object regardless name geometri column linepoint work sfc object stplanr new featur better error messag odlin fail due nonmatch id improv document odlin vignett httpsdocsropensciorgstplanrarticlesstplanrodhtmlnonmatchingid stplanr new featur famili new function includ route_split rnet_add_nod sln_add_nod ad new node rout rout network sfnetwork object close httpsgithubcomropenscistplanrissu updat vignett rout network solv httpsgithubcomropenscistplanrissu found httpsdocsropensciorgstplanrarticlesstplanrroutenetshtml fixhttpsgithubcomropenscistplanrcommitfbaaddafecceffc linepoint line_to_point function remov favour linepoint new function sln_clean_graph remov unconnect element sfnetwork object credit andrea gilardi see new function rnet_breakup_vertic linevertic break linestr repres rout network smaller segment prepar rout see function address pr detail bug fix bug route_dodgr associ exampl fix annoy messag print load remov andrea gilardi ad author deprec function relat road crash stat data remov stplanr stplanr logo see httpsgithubcomropenscistplanrissu line_to_point depreci favour odlin latter function name consist packag function linepointsn work sf object document fix see httpsgithubcomropenscistplanrissu variou improv made stplanrod vignett thank edward leigh url updat link stplanr new offici websit httpsdocsropensciorgstplanr stplanr new featur new function od_to_odmatrix odmatrix_to_od convert matrix form origindestin data new function od_oneway replac onewayid work better twice fast new od_id function provid rang way convert origindestin pair id singl id see stackoverflowhttpsstackoverflowcomquestionshowtoidentifyduplicatedorderedpairseffici issu trackerhttpsgithubcomropenscistplanrissu new vignett stplanrodhttpsdocsropensciorgstplanrarticlesstplanrodhtml provid detail document packag od data handl capabl stplanr fix document see httpsgithubcomropenscistplanrissu stplanr new featur new function od_aggregate_from od_aggregate_to provid easi way aggreg origindestin pair see httpsgithubcomropenscistplanrpul updat overlin faster better document updat route_dodgr function provid interfac dodgrhttpsgithubcomatfuturesdodgr packag accept wider rang input better websit updat function list see httpsropenscigithubiostplanrindexhtml sf method overlin updat call much faster overlin function updat document route_loc bug fix bug sum_network_rout fix see httpsgithubcomropenscistplanrissu stplanr new featur stplanr paper publish see httpsjournalrprojectorgarchiverjindexhtml stat function dl_stat depreci splitout new packag statshttpsgithubcomropenscistat route_dodgr implement new function overlin ad thank malcolm morgan faster overlin substanti refactor oper begun result fewer line code od function new stplanrod_coordslin function support sf route_dodgr ad new exampl dataset osm_net_exampl ad local rout purpos citat packag ad tri citationstplanr packag shini new websit thank maell httpsropenscigithubiostplanr packag loos import depend rgdal demot suggest bug fix issu route_graphhopp fix see httpsgithubcomropenscistplanrpul stplanr new featur variou chang support dplyr httpsgithubcomropenscistplanrpul bug fix fix httpsgithubcomropenscistplanrissu remov byvar argument overlin prepar overdu overhaul overlin function longer suggest tmap reduc instal time installpackag instal suggest packag default stplanr new featur new function route_loc new argument linerout time_sleep wait period rout request bug fix issu dl_stat see httpsgithubcomropenscistplanrissu make style consist see commithttpsgithubcomropenscistplanrcommitccffdfebbdababb variou small fix document style stplanr new featur new function line_via identifi intermediari point transport network bug fix bug associ spatiallinesnetwork fix see httpsgithubcomropenscistplanrissu stplanr new featur new function geo_length return numer vector line length sp sf object document route_graphhopp longer mention depreci bike profil see httpsgithubcomropenscistplanrissu route_osrm mention public api rout car see httpsgithubcomropenscistplanrissu updat introducingstplanr vignett show new function make robust stplanr new featur stplanr import lwgeom need sfst_length use spatiallinesnetwork plot behaviour updat sfnetwork object plot geometri default improv document spatiallinesnetwork plot spatial network bug fix bug sum_network_rout fix see httpsgithubcomropenscistplanrissu stplanr new featur releas sp demot depend import mean function attach namespac load run librarystplanr make less tie sp continu work support sf make easier packag work altern represent geograph data bug fix bug geo_select_aeqsf fix jakub nowosad pull httpsgithubcomropenscistplanrpul issu od_aggregatesf fix make much faster stplanr new featur largest releas sinc packag creat dozen chang support simpl featur see httpsgithubcomropenscistplanrpul detail support sf packag support new spatial class system function new function geo_bb superced bbpoli new function return polygon point matrix object determin output argument also allow bound box extend metr scale x dimens geo_cod use nominatim default find locat map new function od_coord take wide rang input data type return consist output repres od data data frame origin destin coordin use behind scene make function modular work progress plan next releas new gener rout function rout flexibl userfriendli exist linerout route_ function enhanc updat function name make use stplanr easier intuit stplanr new featur depend cull remov depend foreach doparallel route_cyclestreet also call correctli route_cyclestreet new geo_cod function replac depend rgooglemap bug fix see issu close last releas search term httpsgithubcomropenscistplanrissuesutfecqisaissuecloseda bug google_dist fix fix fail due break chang dplyr stplanr new featur new argument combin ad sum_network_rout run quicker see pullhttpsgithubcomropenscistplanrpul new exampl ad sum_network_rout weightfield find_network_nod see eg examplesum_network_rout detail new dataset l_poli addedhttpsgithubcomropenscistplanrcommitfbdedecfafea stplanr websit see ropenscigithubiostplanrhttpsropenscigithubiostplanr bug fix seriou bug spatiallinesnetwork fixedhttpsgithubcomropenscistplanrpul depreci _each dplyr function replac equival _at _all function stplanr new featur new vignett see vignettesstplanrpaperrmdhttpsgithubcomropenscistplanrblobmastervignettesstplanrpaperrmd vignettestplanrpap detail origin introducingstplanrhttpsgithubcomropenscistplanrblobmastervignettesstplanrrmd vignett updat provid basic introduct peopl new r spatial transport data linerout refactor improv error detect allow n_process argument thank nikolaib see pullhttpsgithubcomropenscistplanrpul detail line_match function ad wrapper around rgeosgdist find similar rout rcurl datat depend removedhttpsgithubcomropenscistplanrpul leaflet demot import suggest reduc instal time new function od_aggreg sp_aggreg addedhttpsgithubcomropenscistplanrpul enabl od data aggreg new geograph level bug fix fix viarout work httpsgithubcomropenscistplanrissu fix bidirect true return differ result line_bear futur plan new branch use sf testedhttpsgithubcomropenscistplanrpul may eventu transit use simpl featur class instead sp class stplanr new featur onewayid gener function mean handl spatial nonspati data new argument provid linerout allow specifi variabl joinbi also updat sensibl default new function od_id_ord put origindestin id order identifi way duplic split onewayid bug fix see issu trackerhttpsgithubcomropenscistplanrissuesqisaissueisaclos bug route_cyclestreet lead change_elev av_inclin wrong fix bug make variabl name space id column fail fix httpsgithubcomropenscistplanrissu stplanr new featur new argument destin ad odlin see exampleodlin exampl new dataset destin show od matrix destin convert spatial data new argument list_output allow rout inform save list allow save_raw true return spatial object pass route_ function tmap depend remov faster instal bug fix bug linerout fix variou improv document stplanr new featur new function reproject simpl wrapper around sptransform use crs_select_aeq convert spatial object geograph latlon coordin project coordin unit use variou spatial oper find length area object implement gproject function perform gi oper temporari project version spatial object addit line_bear return bear line base start end point addit angle_diff find angular differ line roughli parallel perpendicular bug fix linedf work line multipl vertic faster fix exampl use illustr od_dist work stplanr new featur updat osrm function support api v new paramet byvar overlin function allow disaggreg result group variabl see exampleoverlin faster implement odlin odlin plan replac origin issu found new implement new function ododf convert od data datafram origin destin feed odlin also use selfstand function new argument new_proj buff_geo allow result export coordin refer system cr new function gproject generalis concept buff_geo build crs_select_aeq allow gi queri conduct temporari project version spatial object geograph crss new function od_dist quickli calcul euclidean distanc od pair without convert spatial object bug fix bug fix onewayid captur line variou improv document code stplanr new featur interfac googl distanc matrix api dist_googl new transport plan api ad route_transportapi_publ test updat linerout allow accept differ rout funtion via new argument route_fun test test route_fun route_cyclestreet new function creat origindestin data frame pointodf spatiallinesdatafram pointsflow addit n_vertic is_linepoint identifi number vertic spatial object whether line realli point bug fix linerout refactor fold speed increas larg batch line stplanr new featur addit new class definit spatiallinesnetwork method plot summari function calc_network_rout find_network_nod allow fast rout calcul via igraph network analysi function function remov begin end line toptail toptailg helper function buff_geo crs_select_aeq linepoint ad function read uk stat data read_stats_ function download unzip recategoris data read_tabl function ad read australian od data decode_gl ad decod googl polylin function queri read data osrm servic gtfssldf ad import gtf rout spatiallinesdatafram stplanr publish cran updat reduc depend igraph seem binari version stplanr build success see httpsgithubcomropenscistplanrissu detail test environ local r instal r variou oss github action r winbuild devel httpswinbuilderrprojectorgdliea r cmd check result error warn note new releas leafletprovid extens leaflethttpsleafletjscom contain configur variou freesupwhatisfreesup tile provid usag leafletprovid providersprovid refer providervariantstr let say want add nice watercolorhttpsmapsstamencomwatercolor style stamen map pass stamenwatercolor ltilelayerproviderconstructor return ltilelayerhttpsleafletjscomreferencehtmltilelay instanc stamen watercolor tile layer javascript add stamen watercolor map ltilelayerproviderstamenwatercoloraddtomap protocol rel httpsurl leafletprovid tri use http page use http provid support forc use http pass force_http true option argument retina tile provid retina tile url need slightli adjust eg xpng add retina option url eg retinapng set retina valu option eg retina x leaflet detect retina screen lbrowserretina retina option pass tilelay set valu suppli otherwis replac empti string provid leafletprovid provid tile layer differ provid includ openstreetmap stamen esri openweathermap full list free use layer previewedhttpsleafletextrasgithubioleafletproviderspreviewindexhtml page show name use leafletprovidersj code use without depend provid requir registr addit provid freeb idwhatisfreeb use support layer requir registr formerli nokia order use layer must registerhttpsdeveloperherecom regist creat app_id app_cod pass ltilelayerprovid option javascript ltilelayerproviderhereterrainday app_id insert id app_cod insert id addtomap avail layershttpsleafletextrasgithubioleafletproviderspreviewfilterher mapbox order use mapbox map must registerhttpstilesmapboxcomsignup get map id access_token mapbox projectshttpswwwmapboxcomproject javascript ltilelayerprovidermapbox id id accesstoken access_tokenaddtomap esriarcgi order use arcgi map must registerhttpsdevelopersarcgiscomensignup abid term servicehttpsdevelopersarcgiscomenterm special syntax requir avail esri layershttpsleafletextrasgithubioleafletproviderspreviewfilteresri attribut work inspir httpsgistgithubcom origin creat stefan seelmannhttpsgithubcomseelmann mean free b idwhatisfreeb tri maintain leafletprovid way youll abl use layer includ without pay money doesnt mean limit appli alway check use layer anyth seriou want add layer yay go add leafletprovidersj long follow follow rule dont violat provid to exist includ link dont prepopul api key work key basic tile sourc exter librari etc owner hasnt ask us remov hasnt happen yet output github_docu readmemd gener readmermd pleas edit file r setup includ fals knitropts_chunkset collaps true comment figpath manfiguresreadm outwidth stplanr hrefhttpsdocsropensciorgstplanrimg srcmanfigureslogopng alignright heighta build statushttpstravisciorgropenscistplanrsvgbranchmasterhttpstravisciorgropenscistplanr rstudio mirror downloadshttpscranlogsrpkgorgbadgesstplanrhttpsgithubcomrhubcranlogsapp httpscranlogsrpkgorgbadgesgrandtotalstplanrhttpscranrprojectorgpackagestplanr cran_status_badgehttpswwwrpkgorgbadgesversionstplanrhttpscranrprojectorgpackagestplanr lifecyclehttpsimgshieldsiobadgelifecyclematuringbluesvghttpslifecyclerliborgarticlesstageshtml httpsbadgesropensciorg_statussvghttpsgithubcomropenscisoftwarereviewissu rcmdcheckhttpsgithubcomropenscistplanrworkflowsrcmdcheckbadgesvghttpsgithubcomropenscistplanract r echofals messagefals warningfals librarystplanr stplanr packag sustain transport plan r provid function solv common problem transport plan model best get point point b overal aim provid reproduc transpar access toolkit help peopl better understand transport system inform polici outlin paperhttpsjournalrprojectorgarchiverjindexhtml packag potenti open sourc softwar transport plan gener publish r journalhttpsjournalrprojectorg initi work project fund depart transport dfthttpswwwgovukgovernmentorganisationsdepartmentfortransport part develop propens cycl tool pct web applic explor current travel pattern cycl potenti zone desir line rout rout network level see wwwpctbikehttpswwwpctbik click region tri basi method underli pct origindestin data use highlight mani short distanc trip made estim mani could switch cycl result help identifi cycleway need import compon sustain transport plan infrastructur engin polici designhttpswwwicevirtuallibrarycomdoiabsdfct see packag vignett eg via vignetteintroducingstplanr academ paper propens cycl tool pcthttpsdxdoiorgjtlu inform use readm provid basic much work support research undertaken leed institut transport studi itshttpsenvironmentleedsacuktransport stplanr use transport research practition need free open reproduc method work geograph data everywher key function data frame repres flow origin destin must combin georeferenc zone point gener meaning analys visualis flow origindestin od data stplanr facilit odlin take flow geograph data input output spatial data exampl data provid packag r resultshid messagefals librarystplanr let take look data r od_data_sampl typic form flow data cents_sf point repres origin destin dataset combin follow r plot warningfals travel_network odlineflow od_data_sampl zone cents_sf w flowal maxflowal plottravel_network lwd w stplanr mani function work od data see stplanrodhttpsdocsropensciorgstplanrarticlesstplanrodhtml vignett detail packag also alloc flow road network eg cyclestreetsnethttpswwwcyclestreetsnetapi openstreetmap rout machin osrmhttpsgithubcomprojectosrmosrmbackend api interfac support route_ function route_cyclestreet route_osrm rout done use rang backend use latlon desir line input rout function illustr follow command calcul rout fleet street southwark street river thame blackfriar bridg london r evalfals echofals tmaptoolsgeocode_osmfleet street london tmaptoolsgeocode_osmsouthwark street london r libraryosrm trip rout c c route_fun osrmrout returnclass sf mapviewmapviewtrip also use place name found use googl map api r cycletrip messagefals warningfals evalfals echofals ifsysgetenvcyclestreet trip route_cyclestreetsbradford uk leed yorkshir plan balanc plottrip r trip rout leed bradford route_fun osrmrout returnclass sf mapviewmapviewtrip replic call multipl time l argument rout r desire_lin travel_network r echofals syssleep wait moment next well calcul rout r plot resultshid messagefals rout rout l desire_lin route_fun osrmrout returnclass sf mapviewmapviewrout mapviewmapviewdesire_lin color red result rout look someth like r rout echofals evalfals lwd desire_linesfoot rout routes_fast_sf plotroutesgeometri lwd lwd plotdesire_linesgeometri col green lwd lwd add true exampl examplerout overlin take seri routealloc line split uniqu segment aggreg valu overlap line repres traffic transport system demonstr follow code chunk r rnet warningfals routesfoot desire_linesfoot rnet overlinerout attrib foot result rout network segment total calcul overlap part rout walk visualis follow r plotrnetfoot lwd rnetfoot plot repres number walk trip made flow along particular segment transport network result shown r routesleaf evalfals echofals libraryleaflet pal leafletcolornumericpalett ylgnbu domain rnetal leafletdata rnet addprovidertilesprovidersopenstreetmapblackandwhit addpolylinesweight rnetal color palal opac addlegendp pal valu polici applic exampl shown base tini demonstr dataset may seem particularli revolutionari citi scale howev type analysi use inform sustain transport polici describ paper describ propens cycl toolhttpswwwjtluorgindexphpjtluarticleview pct applic calcul cycl school potentialhttpswwwsciencedirectcomsciencearticlepii across england result gener stplanr part nation govern polici pct recommend tool local region author develop strateg cycl network cycl walk infrastructur strategi cwishttpswwwgovukgovernmentpublicationscyclingandwalkinginvestmentstrategi part infrastructur act httpswwwlegislationgovukukpgacontentsenact stplanr help dozen local author across uk answer question prioritis invest cycl essenc stplanr design support sustain transport polici mani research polici question function stplanr open sourc softwar librari packag help answer time climat health social crise import technolog sustain eg enabl open sourc commun licens contribut sustain futur instal instal stabl version use r evalfals installpackagesstplanr develop version instal use devtool r evalfals installpackagesdevtool alreadi instal devtoolsinstall_githubropenscistplanr librarystplanr stplanr depend rgdal tricki instal instal stplanr linux mac stplanr depend sf instal instruct mac ubuntu linux distro found httpsgithubcomrspatialsfinstal funtion help contribut current list avail function seen packag websit docsropensciorgstplanrhttpsdocsropensciorgstplanr follow command r evalfals lsfstrpackagestplanr true get intern help specif function use standard way r evalfals odlin contribut report bug request featur see issu trackerhttpsgithubcomropenscistplanrissu r evalfals echofals aim explor depend desc readdcfdescript head dimnamesdesc field whichhead cdepend import suggest pkg pastedescfield collaps pkg gsubn pkg strsplitpkg installpackagesminicran libraryminicran tag stplanr pkgdeptag dg makedepgraphtag enhanc true setse plotdg legendposit c vertexs librarydiagramm diagrammervisnetworkdg visnetworkvisigraphdg resourc tutori want learn use open sourc softwar reproduc sustain transport plan work great time learn transport plan rel new field applic r howev alreadi good resourc topic includ suggest welcom transport chapter geocomput r provid broad introduct geograph data perspect httpsgeocomprrobinlovelacenettransporthtml stplanr paper describ context packag develop httpsjournalrprojectorgarchiverjindexhtml pleas cite use stplanr work dodgr vignett provid introduct rout r httpsatfuturesgithubiododgr meta pleas report issu featur request question github issu trackerhttpsgithubcomropenscistplanrissu licens mit get citat inform stplanr r citationpackag stplanr project releas contributor code conducthttpsgithubcomropenscistplanrblobmasterconductmd particip project agre abid term rofooterhttpsropensciorgpublic_imagesgithub_footerpnghttpsropensciorg creat cent dataset r cent rgdalreadogrdsn homerobinnpctpctbigdatacentsgeojson layer ogrgeojson librarygeojsonio load ropensci packag geojsonio rgdal fail cent geojsoniogeojson_readx repospctpctdatanationalcentsgeojson cr spcrsinitepsg crsuk spcrsinitepsg cent spsptransformx cent crsobj crsuk home geo_codel hb home spspatialpointsmatrixhom ncol projstr cr home spsptransformx home crsobj crsuk buf rgeosgbufferhom width check save point ok cent centsbuf plotbuf pointscent cent spsptransformx cent crsobj cr centsgeo_cod ascharactercentsgeo_cod librarydevtool use_datac overwrit true cents_sf sfst_as_sfcent devtoolsuse_datacents_sf cent rgdalreadogrdsn homerobinnpctpctbigdatacentsgeojson layer ogrgeojson librarygeojsonio load ropensci packag geojsonio rgdal fail cent geojsoniogeojson_readx repospctpctdatanationalcentsgeojson cr spcrsinitepsg crsuk spcrsinitepsg cent spsptransformx cent crsobj crsuk home geo_codel hb home spspatialpointsmatrixhom ncol projstr cr home spsptransformx home crsobj crsuk buf rgeosgbufferhom width check save point ok cent centsbuf plotbuf pointscent cent spsptransformx cent crsobj cr centsgeo_cod ascharactercentsgeo_cod librarydevtool use_datac overwrit true cents_sf sfst_as_sfcent devtoolsuse_datacents_sf r evalfals echofals sampl od data remotesinstall_githubitsleedspct librarypct od_data_al pctget_od sel_loc od_data_allgeo_cod cents_sfgeo_cod od_data_allgeo_cod cents_sfgeo_cod od_data_sampl od_data_allsel_loc od_data_lin odlineod_data_sampl cents_sf plotod_data_lin od_data_routes_fast routel od_data_lin route_fun cyclestreetsjourney plan fastest pryrobject_sizeod_data_routes_fast kb namesod_data_routes_fast od_data_rout od_data_routes_fastcncolod_data_routes_fast plotod_data_rout pryrobject_sizeod_data_rout kb usethisuse_dataod_data_rout overwrit true usethisuse_dataod_data_lin filesizedataod_data_routesrda kb fine systeml hal dataod_data_routesrda code show od_lnd c_lnd dataset creat r librarydplyr get nationwid od data od_al pctget_od nrowod_al od_allact od_allbicycl od_allfoot od_allal centroids_al pctget_centroids_ew sfst_transform z_london pctget_pct_zonesregion london selectgeo_cod foot nrowcentroids_al london pctpct_region filterregion_nam london centroids_london centroids_alllondon od_london od_al filtergeo_cod centroids_londonmsoacd filtergeo_cod centroids_londonmsoacd od_london od_al od_allgeo_cod centroids_londonmsoacd od_allgeo_cod centroids_londonmsoacd r aim creat reproduc od dataset od_lnd od_london selectmatchesrailnamemotocartaxhomela_act filtergeo_cod e top_n wt c_lnd centroids_london filtermsoacd codgeo_cod odgeo_cod z_lnd z_london filtergeo_cod c_lndmsoacd usethisuse_dataod_lnd usethisuse_datac_lnd usethisuse_dataz_lnd titl rout network stplanr output rmarkdownhtml_vignett vignett vignetteindexentryrout network stplanr vignetteengineknitrrmarkdown vignetteencodingutf vignett work progress watch space r includ fals knitropts_chunkset collaps true comment eval allccurlhas_internet requirenamespaceigraph quietli true r setup messagefals librarystplanr librarysf introduct rout network repres network highway cycleway footway way along transport happen get rout network data openstreetmap eg via osmdata r packag provid transport network data creat rout network overlap rout unlik rout segment geometri rout network appear stplanr use convert seri rout rout network use function overlin illustr r outwidth figshowhold figwidth messagefals librarystplanr librarysf sample_rout routes_fast_sf sample_routesvalu rep lengthout rnet overlinesample_rout attrib valu plotsample_routesvalu lwd sample_routesvalu main rout plotrnetvalu lwd rnetvalu main rout network figur show overlin break rout segment valu remov overlap segment form geograph aggreg figur show detail function work line see vignett sourc code reproduc plot r rnet messagefals warningfals outwidth figwidth figheight echofals knitrinclude_graphicsroutenetworkspng identifi rout network group rout network repres graph usual segment connect togeth mean graph connectedhttpsenwikipediaorgwikiconnectivity_graph_theoryconnected_graph show simpl network connect follow r touching_list st_intersectssample_rout g igraphgraphadjlisttouching_list igraphis_connectedg complex network may connect way shown exampl r evalfals piggybackpb_download_urlr_key_roads_testrd u httpsgithubcomropenscistplanrreleasesdownloadr_key_roads_testrd rnet_disconnect readrdsurlu touching_list sfst_intersectsrnet_disconnect g igraphgraphadjlisttouching_list igraphis_connectedg fals sfplotsfc_linestringrnet_disconnectedgeometri r echofals knitrinclude_graphicshttpsiimgurcomfpng element network clearli divid group identifi group follow r evalfals rnet_disconnectedgroup rnet_igrouprnet_disconnect spatiallinenetwork import featur rout network simultan spatial graph entiti dualiti captur sfnetwork object creat function spatiallinesnetwork r rnetrout sln spatiallinesnetworkrnet classsln sln spatial graph compon number line equal number graph edg r classslnsl nrowslnsl classslng lengthigraphedgeattributesslngweight classslnnb lengthuniqueunlistslnnb identicalslnslgeometri rnetgeometri r sln_node slnpointssln nrowsln_nod lengthslnnb r rnet_coordin sfst_coordinatesrnet setse x runifn min minrnet_coordin max maxrnet_coordin runifn min minrnet_coordin max maxrnet_coordin cr sfst_crsrnet xy_sf sfst_as_sfdataframen x coord cx cr cr xy_nod stplanrfind_network_nodessln sln x x rout rout network current run due issu dev version dplyr httpsgithubcomropenscistplanrissu r outwidth figshowhid plotrnetgeometri plotsln_nod add true xy_path sum_network_routessln sln start xy_nod end xy_nod sumvar length xy_path sum_network_linkssln sln start xy_nod end xy_nod plotrnetgeometri plotxy_sfgeometri add true plotxy_pathgeometri add true lwd ad new node new node ad network although done graph represent creat imagin want creat point half way along westerli rout segment network near coordin r netpoint new_point_coordin c p sfst_sfgeometri sfst_sfcsfst_pointnew_point_coordin cr cr identifi nearest point network point use split associ linestr r figshowhold outwidth sln_new sln_add_nodesln sln p p route_new route_localsln sln_new p xy_sf plotsln_new plotp add true plotroute_new lwd add true approach approach work rout network includ sdnahttpsgithubcomfiftysevendegreesofradsdna_open open sourc c librari analys rout network estim flow segment across network segment sfnetworkshttpsgithubcomluukvdmeersfnetwork r packag provid altern igraphsf spatial network class dodgrhttpsgithubcomatfuturesdodgr r packag provid function calcul distanc direct graph cpproutinghttpscranrprojectorgpackagecpprout packag rout c chapter geocomput rhttpsgeocomprrobinlovelacenettransporthtml provid context demonstr transport plan workflow r r messagefals warningfals outwidth figwidth figheight echofals evalfals show solut httpsgithubcomropenscistplanrissu librarytmap sample_rout routes_fast_sf sample_routesid nrowsample_rout sample_rout sample_routesisnasample_routesplan sample_rout routes_fast_sfc null sample_routestyp rout v n c route_list purrrmapn sample_rout route_list lapplyn functionx l sample_routesx ln x lvalu repv lengthout x l routes_al docallrbind route_list rnet_list purrrmaproute_list functionx rnet_list lapplyroute_list functionx l overlinex valu ln meanxn l rnet_al docallrbind rnet_list rnet_alltyp rout network all_rout rbindroutes_al rnet_al p sfst_centroidall_rout tmap_modeplot tm_shapeall_rout bbox tmaptoolsbball_rout tm_line col valu lwd palett orrd scale alpha break legendlwdshow fals label ascharact legendcolshow fals tm_textvalu tm_facetsbi cn type tm_layoutscal tmap_savem vignettesroutenetworkspng r evalfals echofals test code sample_rout sample_rout sample_rout sample_rout rnet overlinesample_rout attrib valu rnet overlinesample_rout attrib valu rnet overlinesample_rout attrib valu b bb tmaptoolsbbrnet ext rnetn rnettyp rout network sample_routesn sample_routestyp rout all_rout rbindrnet sample_rout tm_shapesample_rout bbox bb tm_linescol valu lwd valu palett magma scale alpha break b tm_layouttitl rout legendshow fals r tm_shapernet bbox bb tm_line col valu palett viridi scale alpha break b legendlwdshow fals label ascharact tm_shapesample_rout bbox bb tm_linescol valu lwd valu palett viridi scale alpha break b tm_layouttitl rout legendshow fals r tm_shapernet bbox bb tm_linescol valu palett viridi scale alpha break b tm_layoutlegendshow fals tm_shapesample_rout bbox bb tm_linescol valu lwd valu palett viridi scale alpha break b tm_layouttitl rout legendshow fals r tm_shapernet bbox bb tm_linescol valu palett viridi scale alpha break b tm_layoutlegendshow fals tmap_arrangem r r r nrow titl parallel rout perform stplanr output rmarkdownhtml_vignett vignett vignetteindexentryparallel rout perform stplanr vignetteengineknitrrmarkdown vignetteencodingutf r includ fals knitropts_chunkset eval fals collaps true comment code vignett provid basic introduct parallel rout rout someth highli parallelis rout calcul independ other code fairli selfexplanatori result shown code run reduc packag build time r setup librarystplanr librarysf librarydplyr librarytmap libraryparallel librarycyclestreet old route_cyclestreet function r rout l flowlines_sf dplyrfilt systim routes_route_cyclestreet lineroutel systim ncolroutes_route_cyclestreet nrowroutes_route_cyclestreet namesroutes_route_cyclestreet routes_route_cyclestreet_join dplyrinner_joinroutes_route_cyclestreet sfst_drop_geometryl systim rnet_go_dutch overlineroutes_route_cyclestreet_join systim tm_shapernet_go_dutch tm_lineslwd col break c palett viridi new rout function r rout systim routes_journey routel l route_fun cyclestreetsjourney ncolroutes_journey nrowroutes_journey systim namesroutes_journey rnet_go_dutch_journey overlineroutes_journey systim rnet_go_dutch_agg overlineroutes_journey systim tm_shapernet_go_dutch_agg tm_lineslwd col break c palett viridi new rout function parallel r rout systim load parallel stuff cl makeclusterdetectcor clusterexportcl cjourney systim routes_journey_par routel l route_fun cyclestreetsjourney cl cl multicor stopclustercl kill cluster systim systim namesroutes_journey_par rnet_go_dutch_journey overlineroutes_journey_par systim rnet_go_dutch_agg overlineroutes_journey_par systim tm_shapernet_go_dutch_agg tm_lineslwd col break c palett viridi parallel quiet plan r rout systim load parallel stuff libraryparallel librarycyclestreet cl makeclusterdetectcor clusterexportcl cjourney systim routes_journey_par routel l route_fun cyclestreetsjourney cl cl plan quietest multicor stopclustercl kill cluster systim systim namesroutes_journey_par rnet_go_dutch_journey overlineroutes_journey_par systim rnet_go_dutch_agg overlineroutes_journey_par systim tm_shapernet_go_dutch_agg tm_lineslwd col break c palett viridi test r routes_journey_aggreg routes_journey alreadi data data frame group_byid summariseal medianal sfst_castlinestr rnet_journey_dplyr routes_journey alreadi data data frame group_bynam distanc summariseal sumal systim tm_shapernet_journey_dplyr tm_lineslwd col break c palett viridi quit differ rnet_journey_go_dutch routes_journey group_bystart_longitud start_latitud finish_longitud finish_latitud summariseal sumal titl introduc stplanr author robin lovelac date r sysdat output rmarkdownhtml_vignett vignett vignetteindexentryintroduc stplanr vignetteengineknitrrmarkdown vignetteencodingutf bibliographi referencesbib stplanrcitationbib r includefals librarystplanr knitropts_chunksetev curlhas_internet introduct purpos vignett get uptospe basic provid use link transport research r stplanr initi develop answer practic question convert offici data travel behaviour geograph object plot map analys use method geograph inform system gi specif origindestin od data open dataset provid uk data servic wicid portal see wicidukdataserviceacukhttpswicidukdataserviceacuk use estim cycl potenti street level citi nation level project initi develop support propens cycl tool pct deploy nation web applic host wwwpctbike writtenup academ paper lovelace_propensity_ stplanr sinc grown includ wide rang function transport plan packag reviewedhttpsgithubcomropenscisoftwarereviewissu ropensci packag review process packag host site see websit docsropensciorgstplanrhttpsdocsropensciorgstplanr detail overview packag aim capabl contain longer vignettehttpsgithubcomropenscistplanrblobmastervignettesstplanrpaperrmd sinc publish r journal lovelace_stplanr_ instal stplanr your new program transport data recommend use stplanr interact integr develop environ ide rstudiohttpswwwrstudiocomproductsrstudiodownload broader guidanc r setup found effici r programminghttpscsgillespiegithubioefficientrsetuphtml gillespie_efficient_ rstudio educ pageshttpseducationrstudiocomlearnbeginn cranhttpscranrprojectorg r setup happi latest version instal follow r evalfals installpackagesstplanr instal develop version may new featur instal follow r evalfals remotesinstall_githubropenscistplanr load packag follow r librarystplanr stplanr contain mani dataset test demonstr r use transport plan name dataset load lazili namespac attach stplanr list r datapackag stplanrresult item complet list function packag found httpsdocsropensciorgstplanrreferenceindexhtml od data desir line rout transport data take mani form r appropri languag handl transport data readin data wide rang format eg packag foreign section focuss od dataset convers desir line rout foundat data type mani transport research applic stplanr also contain function analysi road traffic casualti data interfac variou rout api travel watersh analyi access googl travel matrix api origindestin od data simpli data follow form r od_eg readcsv text origin destin v v knitrkableod_eg exampl od tabl mean unit v unit v travel zone zone also movement repres zone dataset also repres od matrix row repres origin column destin howev multipl variabl eg mode transport prevent giant unwieldi spars matric long form repres much common imagin v repres total number peopl travel origin destin v repres number regularli cycl get good indic peopl cycl desir line level note good sourc open od data made avail wicidukdataserviceacukhttpswicidukdataserviceacuk websit extract use inform od dataset need abl place line map kind place desir line origin destin environ like pass answer question need geograph represent od tabl illustr convert od data desir line r one problem od data row tend geographi inher built could contain variabl call lat_origin lon_origin lat_destin lon_destin gener contain id geograph zone work need convert od data desir line desir line straight line origin destin repres peopl would go constrain rout network see figur lovelace_propensity_ show desir line creat well switch use real od data provid stplanr first three shown r headflowc show zone e e ie intrazon flow peopl travel work mode censu cycl equival number od pair e e make data geograph need anoth dataset also provid stplanr r headcents_sf cents_sf dataset spatial defin sf packag default plot method sf object creat map illustr r librarysf classcents_sf plotcents_sf stplanr creat desir line use odlin function link geograph nongeograph dataset togeth note function supersed function od packag case join nongeograph flow data geograph cents_sf data plot let take singl od pair e e fourth row repres tabl see work r flow_single_lin od_data_sampl select first line desire_line_singl odlineflow flow_single_lin zone cents_sf plot follow r plotdesire_line_singlegeometri lwd plotcents_sf add true cex follow command creat desir line longer km distanc via geo_length function omit intern flow via sel object repres dataset flowlin r l odlineflow flow zone cents_sf identifi intrazon flow sel_intra lareaofresid lareaofworkplac find distanc l_distanc geo_lengthl summaryl_dist sel_dist l_distanc sel sel_intra sel_dist l lsel creat geograph data object l visualis follow r evalfals plotl data setup chang visual appear desir line singl extra argument pass plot function let make width depend total number peopl travel along desir line r echofals l_bb sfst_bboxl l_bb na no_na_in_bb anyisnaasnumericl_bb knitropts_chunksetev no_na_in_bb r lwd lall meanlal plotst_geometryl lwd lwd anoth use visualis involv set colour rel number peopl cycl r plotlbicycl lwd lwd final convert desir line rout follow rout function use may requir api key work see cyclestreetshttpscranrprojectorgpackagecyclestreet packag document exampl r messagefals warningfals next line return fals code run has_internet curlhas_internet cs_key ncharsysgetenvcyclestreet has_internet cs_key r routel l route_fun cyclestreetsjourney r aggregaterc listr r fun mean els r routes_fast_sfsel rout contain inform origin destin addit spatial inform rout network rout plot way desir line plot r outwidth outheight evalfals plotrgeometri lwd lwd reset fals r outwidth outheight echofals evalfals altern show build r_sf st_sfl geometri st_as_sfcr requireosmdata build opqst_bboxl add_osm_featurekey build valu industri osmdata_sf plotr_sfbicycl lwd lwd reset fals plotst_geometrybuildingsosm_polygon col grey add true next stage aggreg line togeth creat rout network mani function describ stplanrpap vignettehttpsgithubcomropenscistplanrblobmastervignettesstplanrpaperrmd motiv settlement worldwid grown becom complex process plan adapt planner today specialist subfield emerg logist healthcar urban transport plan art plan becom scienc array specialist hardwar softwar like type plan new technolog chang mani way improv practic transport plan transport intervent new bridg port activ travel rout longer decid base intuit public sector polit author decis result long sociotechn process involv public consult costbenefit analys comput model visualis ongo digit revolut import last stage grown point transport plan highli technic process employ dozen softwar develop larg plan organ multibillion pound global transport plan consult industri support decisionmak process yet result labor unavail vast major citizen worldwid transport plan decis go best avail evid keep get made context aim stplanr provid access toolbox transport plan focu geograph data hope use practition research alik part ongo transit open sourc softwar take place tech industri motiv best avail evidencehttpswwwnaturecomarticlesnclim suggest futur civil depend abil transit away fossil fuel transport sector fastest grow sourc emiss sector repres major roadblock path toward zerocarbon economi transport system also major caus ill health enabl sedentari lifestyl caus numer road traffic casualti knowledg impact motiv word sustain packag name focus activ travel public transport mode stplanr intend encourag intervent reduc depend fossil fuel resourc stplanr focuss geograph data reason almost transport data spatial distribut bu stop rout pedestrian take home work contain spatial element repres spatial data formal class system mani advantag includ sensibl default plot spatial data map support rang geograph oper sf support common geograph data format use transport plan includ shapefil geojson file repres point line zone see stplanr packag transport plan lovelace_stplanr_ detail get best stplanr help strong understand spatial data r gener chapter open sourc book geocomput rhttpsgeocomprrobinlovelacenet provid introductori tutori basic spatial data r contain refer advanc tutori may come handi spatial data analysi skill progress inform geograph data transport applic found book see httpsgeocomprrobinlovelacenettransporthtml contribut welcom contribut whether file bug featur request issu trackerhttpsgithubcomropenscistplanrissu put pull request improv perform document simpli let us know your use stplanr work cite drop us email refer titl origindestin data stplanr output rmarkdownhtml_vignett author robin lovelac edward leigh vignett vignetteindexentryorigindestin data stplanr vignetteengineknitrrmarkdown vignetteencodingutf bibliographi referencesbib stplanrcitationbib r includ fals knitropts_chunkset collaps true comment eval fals has_webshot webshot installedpackag note updat version vignett call od avail od packag view follow r evalfals installpackagesod vignetteod introduct od data name suggest origindestin od data repres movement geograph space origin destin sometim also call flow datahttpswwwonsgovukcensuscensuscensusdataoriginanddestinationdata od dataset contain detail trip two geograph point commonli zone often repres zone centroid od dataset refer start end locat id column contain charact string zone id refer geograph featur separ geograph dataset origin destin locat sometim repres geograph coordin od dataset typic contain multipl non geograph attribut usual includ minimum number trip take place origin destin given time period eg typic work day addit attribut includ breakdown mode transport use trip usual singl mode captur trip made combin cycletrainwalk mode often count train trip addit disaggreg overal count may includ trip count differ time period mani od dataset omit inform one time period resid metadata whole data set rare inform path taken start end point typic job analyst use rout servic osrmhttpsgithubcomriatelabosrm googl direct apihttpssymbolixaugithubiogooglewayarticlesgooglewayvignettehtmlgoogledirectionsapi cyclestreetsnethttpsgithubcomrobinlovelacecyclestreet openrouteservicehttpsgithubcomgiscienceopenrouteservic assign model contain proprietari softwar saturnhttpssaturnsoftwarecouk visumhttpswwwptvgroupcomensolutionsproductsptvvisum identifi like rout refer shortest path algorithm generalis cost minimis algorithm account monetari plu time qualiti cost import od data despit rather dull name od dataset vital part modern world underpin analysi model influenc current futur transport system histor model od dataset drove use plan cardomin citi boyce_forecasting_ grow evid neg impact car domin howev strong argument transport model repurpos origindestin data part solut health perspect transport plan support od data analys primarili use proprietari softwar opaqu method fail road largest caus death young peopl worldwid kill millionhttpswwwwhointpublicationsiitem peopl year world_health_organization_global_ even ignor problem air pollut obes climat chang clear current transport system unsustain reason transport data analysi softwar import lovelace_stplanr_ purpos vignett introduc od data import compon mani transport plan model exampl base data function stplanr packag aim enabl use od data inform sustain transport plan exampl identifi desir line along polici could caus modal switch away car toward lower energi mode walk cycl public transport exampl od dataset od data access rang sourc see code download mani thousand od pair later vignett data carpentri may need od data readi analysi vignett cover clean od data assum know r come tidi data wickham_tidy_ row repres travel origin destin typic zone repres zone id column repres attribut number trip vehichl count mode straight line distanc may difficult convert number trip number vehicl count mode singl vehicl contain mani peopl car problem overcom survey differenti car driver car passeng distinct mode buse tram occup level unknown typic od data report singl stage trip multimod trip walkrailcycl repres combin mode repres new uniqu mode simpl term od data look like r setup messagefals librarystplanr librarydplyr od stplanrod_data_sampl selectmatchesrailnamemotocartaxhomela_ top_nn wt classod od next section discuss represent od data represent od data like data object od creat preced code chunk come specif context uk censushttpsukdataserviceacuklearninghubcensu question main job address workplac usual travel work longest part distanc usual journey work work mainli home underground metro light rail tram train object od data frame contain aggreg answer question see pctget_od detail implicitli geograph first two column refer geograph entiti contain coordin od coordin cover column contain attribut associ od pair typic count mani peopl travel mode transport od data repres number way outlin next section origindestin pair long form use way repres od data long data frame format describ increasingli format use offici statist agenc includ uk offic nation statist on provid origin destin data csv file typic first column zone code origin second column zone code destin case object od subsequ column contain attribut mean trip mode illustr see matrix represent subset data next section r od geo_cod refer origin geo_cod refer destin addit column repres addit attribut number trip time mode travel type person trip purpos od dataset contain column name repres mode travel train bu bicycl etc seen namesod mode column contain integ exampl data contain charact date data type take advantag flexibl data frame origin destin matric od matrix represent od data repres attribut column long form separ matrix instead row repres od pair row repres travel origin destin repres column stplanr function od_to_odmatrix convert long matrix form per column basi illustr r od_matrix od_to_odmatrixod classod_matrix od_matrix note row column name zone code cell row column od_matrix exampl report trip zone e zone e case peopl travel major od pair combin repres na od matric rel rudimentari data structur predat rs datafram class typic contain integ count provid small simpl dataset could use th centuri transport model softwar run limit th centuri hardwar although od matrix still sometim use inform refer od datadset long od pair represent recommend od matric becom unwieldi larg od dataset like spars mani empti cell repres na furthermor repres mani attribut matix format multipl list od matric od array must creat demonstr code chunk repres travel od pair mode bike r lapplycal bicycl functionx od_to_odmatrixodcgeo_cod geo_cod x function odmatrix_to_od convert od matric back conveni long form r odmatrix_to_odod_matrix inter intrazon flow common sometim problemat featur od data intrazon flow trip start end zone proport travel intrazon depend larg size zone use often use separ intrazon interzon flow outset demonstr r od_int od filtergeo_cod geo_cod od_intra od filtergeo_cod geo_cod intrazon od pair repres short trip size zone within trip take place sometim ignor od data analyi howev intrazon flow valuabl exampl measur amount localis transport activ sign local economi oneway line anoth subtli symetrichttpsicaciorgfilesdocumentsicc_proceedingsicc_extendedabstract_proceedingpdf origin destin point od data oneway flow hide extent bidirect flow plot type analysi illustr sampl od dataset r od_min od_data_samplec od_oneway od_onewayod_min note second dataset row instead function od_oneway aggreg oneway line produc bidirect flow default return sum numer column bidirect origindestin pair desir line previou represent od data implicitli geograph coordin contain data associ anoth object geograph typic zone zone centroid problemat mean multipl object file requir fulli repres data desir line represent overcom issu geograph line origin destin attribut long represent odlin convert long form od data desir line second argument zone centroid dataset contain zone id match id first second column od data illustr r z zones_sf classz l odlineflow od_int zone z preced code chunk creat zone object call z coordin use convert object od l geograph desir line desir line object store geograph simpl featur object number row object od one column r classl nrowod nrowl ncoll ncolod new column geometri column plot follow r plotlgeometri default plot l show attribut line r plotl line coordin refer system cr inherit zone data also plot interact map follow result shown webshot instal r libraryleaflet leaflet addtil addpolygonsdata l nonmatch id note od dataset may id match zone simul situat set third origin id od nomatch string zone id r errortru odgeo_cod nomatch odlineod z clean od data ensur id first two column match id first column zone data run odlin larger exampl commut trip london minim exampl dataset weve use far fine demonstr key concept od data advanc topic get idea possibl od data citi level help larger dataset use exampl dataset repres commut london access follow note code chunk evalu vignett start download million row could take minut run first use pct packag download offici data uk note addit activ column r evalfals librarydplyr get nationwid od data od_al pctget_od nrowod_al od_allact od_allbicycl od_allfoot od_allal centroids_al pctget_centroids_ew sfst_transform nrowcentroids_al london pctpct_region filterregion_nam london centroids_london centroids_alllondon od_london od_al filtergeo_cod centroids_londonmsoacd filtergeo_cod centroids_londonmsoacd od_london od_al od_allgeo_cod centroids_londonmsoacd od_allgeo_cod centroids_londonmsoacd r evalfals echofals aim creat reproduc od dataset od_lnd od_london selectmatchesrailnamemotocartaxhom filtergeo_cod e top_n wt z_lnd centroids_london filtermsoacd codgeo_cod odgeo_cod input od data od_london zone populationweight centroid cents_london case convert desir line r evalfals desire_lines_london odlineod_london centroids_london nrowdesire_lines_london even filer flow keep origin destin london still k flow lot plot well subset first contain interzon flow actual line intrazon flow line length essenti point second contain flow contain threshold level flow r evalfals min_trips_threshold desire_lines_int desire_lines_london filtergeo_cod geo_cod desire_lines_intra desire_lines_london filtergeo_cod geo_cod desire_lines_top desire_lines_int filteral min_trips_threshold nrowdesire_lines_top analysi dataset import know repres flow crude way calcul proport line trip cover dataset r evalfals nrowdesire_lines_top nrowdesire_lines_london sumdesire_lines_topal sumdesire_lines_londonal show line contain half total number trip plot origindestin data od dataset size plot desir line quick plot comput logic next stage plot eg sf plot method r evalfals plotdesire_lines_topal r echofals knitrinclude_graphicshttpsuserimagesgithubusercontentcomacafebdepng may disapoint result hay stack plot intuit illustr flow across citi overcom issu set aesthet emphas import flow eg line width sf plot system r evalfals lwd desire_lines_topal meandesire_lines_topal desire_lines_toppercent_dont_dr desire_lines_topcar_driv desire_lines_topal plotdesire_lines_toppercent_dont_dr lwd lwd break c r echofals knitrinclude_graphicshttpsuserimagesgithubusercontentcomeceeebeccbfdebfpng better still ideal code intuit write result still public qualiti instead make sens make dedic map packag tmap outlin visualis chapterhttpsgeocomprrobinlovelacenetadvmaphtml open sourc book geocomput r lovelace_geocomputation_ shown transport chapter book od flow visualis follow code r evalfals librarytmap desire_lines_top desire_lines_top arrangeact tm_shapelondon tm_border tm_shapedesire_lines_top tm_line palett plasma break c lwd scale titlelwd number trip alpha col activ titl activ travel legendlwdshow fals tm_scale_bar tm_layout legendbgalpha legendbgcolor white r echofals tmap_savelastvalu tmaplondonpng knitrinclude_graphicshttpsuserimagesgithubusercontentcomdcdafdeacfpng plot contain much inform provid visual overview transport pattern citi tell us monocentr citi flow go centr activ transport geograph depend domin central north citi limit uptak outskirt citi although citi centr domin mani small cluster flow outer region exampl near heathrow airport locat far west map plot od data way tell us much citi differ travel pattern use code visualis mobil pattern citi see section httpsgeocomprrobinlovelacenettransporthtmldesirelin geocomput r see result bristol polycentr citi lower averag percentag travel walk cycl r evalfals echofals saverdsod_al od_allrd piggybackpb_uploadod_allrd summari origin destin possibl group od data origin destin gain inform zone level code result plot exampl summaris number peopl depart zone mode r evalfals zones_london pctget_pct_zoneslondon selectgeo_cod origin_attribut desire_lines_top sfst_drop_geometri group_bygeo_cod summarize_ifisnumer sum dplyrrenamegeo_cod geo_cod origin_attribut zones_origin left_joinzones_london origin_attribut geo_cod plotzones_origin border na r echofals knitrinclude_graphicshttpsuserimagesgithubusercontentcomeadaffecbecpng observ number featur includ rail much common south reflect greater densiti local rail network short distanc stop south citi car dominat outer fring especial west taxi motorbik use intrigu cluster west perhap around wealthi kensington area taxi pattern quit differ calcul destin r evalfals destination_attribut desire_lines_top sfst_drop_geometri group_bygeo_cod summarize_ifisnumer sum dplyrrenamegeo_cod geo_cod mutate_atvarsmatchesgeo_al fun left_joinzones_london geo_cod plotdestination_attribut border na r echofals knitrinclude_graphicshttpsuserimagesgithubusercontentcomaeccdfpng read despit import origindestin dataset transport research surprisingli guid dedic work use open sourc softwar follow suggest base read suggest good resourc work od data let know section httpsgeocomprrobinlovelacenettransporthtmldesirelin geocomput r lovelace_geocomputation_ put od data wider context geograph transport data martin_origindestination_ describ method classifi od pair base demograph data keplerglhttpskeplergldemoukcommut websit provid nifti web applic visualis od data document open sourc microscop transport model softwar sumohttpssumodlrdeuserdocdemandimporting_od_matriceshtml describ way readingin od file format cover vignett excel introduct model visualis od data introductori vignettehttpsgithubcomrcartoflowsblobmastervignettesflowsrmd flow r packag summari summari stplanr provid mani function work od data od data import compon transport plan model use creativ skill could assist sustain transport plan global transit away fossil fuelshttpswwwseiorgwpcontentuploadsrealizingajustandequitabletransitionawayfromfossilfuelspdf mani thing done od data could support futur version packag suggest new featur otherwis get touch see stplanr issu tracker githubcomropenscistplanrhttpsgithubcomropenscistplanrissu applic repres file lines_carsrd repres top desir line msoamsoa level england wale number car km use travel work download readin plot follow r outwidth warningfals evalfals echofals u httpsgithubcomropenscistplanrreleasesdownloadlines_carsrd f filepathtempdir lines_carsrd downloadfileu f lines_car readrdsf plotlines_carscar_km lwd lines_carscar_km base estim averag energi use per km mj return trip made averag time per year circuiti estim total energi use high energi commut follow r evalfals echofals sumlines_carscar_km e repres petajoul pj top energi intens commut may seem like lot repres fraction uk total energi use mtoehttpsassetspublishingservicegovukgovernmentuploadssystemuploadsattachment_datafiledukes_pnpdf pj r echofals evalfals outtak test code demonstr bugfeatur sf librarysf matrixc ncol p st_polygonlistm matrixc na ncol p st_polygonlistm plotp l st_linestringm plotl plotp matrixc na ncol l st_linestringm plotl r echofals evalfals usethisuse_dataod_data_sampl aim get top flow car use multipli distanc subset flow n peopl drive od_car od_data_allod_data_allcar_driv cents_ew pctget_centroids_ew od_car od_car od_carsgeo_cod cents_ewmsoacd od_carsgeo_cod cents_ewmsoacd desire_lines_car odlineod_car cents_ew plotdesire_lines_car desire_lines_carseuclidean_distance_m asnumericsfst_lengthdesire_lines_car desire_lines_carscar_km desire_lines_carscar_driv desire_lines_carseuclidean_distance_m lines_car dplyrtop_ndesire_lines_car car_km summarylines_carscar_driv plotlines_carscar_km saverdslines_car lines_carsrd piggybackpb_uploadlines_carsrd refer titl stplanr packag transport plan author name robin lovelac affili univers leed address univers road ls jt uk email rlovelaceleedsacuk name richard ellison affili univers sydney address abercrombi street darlington nsw australia email richardellisonsydneyeduau abstract tool transport plan flexibl scalabl transpar stplanr packag demonstr provid home tool emphasi spatial transport data nonmotor mode stplanr facilit common transport plan task includ download clean transport dataset creat geograph desir line origindestin od data rout assign via spatiallinesnetwork class interfac rout servic cyclestreetsnet calcul rout segment attribut bear aggreg flow travel watersh analysi paper demonstr function use reproduc exampl real transport dataset broadli experi show open sourc softwar form basi reproduc transport plan workflow stplanr alongsid packag open sourc project could provid transpar democrat account altern current approach heavili reliant proprietari technic financi inaccess softwar bibliographi referencesbib stplanrcitationbib output rmarkdownhtml_vignett vignett vignetteindexentrystplanr packag transport plan vignetteengineknitrrmarkdown vignetteencodingutf r echofals knitropts_chunksetfigwidth figheight eval fals note paper peer review publish r journal pleas see publish version journalrprojectorghttpsjournalrprojectorgarchiverjindexhtml cite lovelace_stplanr_ introduct transport plan broadli defin process design evalu transport intervent willumsen_modelling_ usual ultim aim improv transport system econom social environment perspect inevit involv degre subject judgment intuit prolifer new transport dataset increas avail hardwar softwar make sens great potenti disciplin becom evidencebas scientif balmer_matsimt_ transport planner alway undertaken wide rang comput activ boyce_forecasting_ digit revolut demand grown beyond capabl singl monolith product divers task need democrat account public decis make suggest futureproof transport plan softwar flexibl abl handl wide rang data format scalabl abl work multipl geograph level singl street larg citi region robust reliabl test rang dataset abl work box rang realworld project open sourc reproduc ensur transpar encourag citizen scienc paper set demonstr open sourc softwar commandlin interfac cli provid foundat transport plan softwar meet criteria r provid strong basi progress direct alreadi contain function use common transport plan workflow greatli improv rs spatial abil bivand_applied_ work consolid extend recent packag build foundat number spatial packag develop appli domain includ diseas map model packag kim_spatialepi_ brown_diseasemapping_ spatial ecolog adehabitat famili packag calenge_package_ visualis packag spatialepi diseasemap rj howev littl prior work develop r function design specif transport plan notabl except travelrhttpsrforgerprojectorgprojectstravelr packag rforg last updat gtfsrhttpsgithubcomropenscigtfsr packag handl gener transit feed specif gtf data purpos stplanr provid toolbox rather specif solut transport plan emphasi spatial data activ mode emphasi time given recent emphasi sustain banister_sustainable_ big data zheng_big_ wider field transport plan major motiv lack r packag open sourc softwar gener transport applic may surpris given uqiqu transport problem mani peopl think thing could improv local transport network especi walk cycl wheelchair lack evid commun issu potenti solut other rs profici handl spatial tempor travel survey data describ transport system grow popular r appli domain jalal_overview_ moore_why_ anoth motiv growth open access dataset main purpos earli version packag process open origindestin data lovelace_propensity_ r alreadi use transport applic illustr recent research appli packag domain transport problem instanc efthymiou_use_ use r analys data collect onlin survey focus carshar bicycleshar electr vehicl efthymiou_use_ also use r collect analys transportrel data twitter use packag includ packag use download pars plot twitter data use method repeat result reproduc updat gener statist analys also conduct transportrel dataset use packag includ diana_studying_ cerin_walking_ despit rise use r transport research yet packag transport plan design r languag emphasi flexibl data process statist model suggest provid power environ transport plan research mani quantit method transport plan mani fit classic four stage transport model involv follow step willumsen_modelling_ trip gener estim trip freqenc origin distribut trip destin modal split trip walk cycl buse etc assign trip transport rout network would like add two stage big data age data process explor valid sequenc way transport model argu domin reduc innov howev certainli common approach provid use schema classifi kind task stplanr tackl access process data transport infrastructur behaviour stage analysi visualis transport network analysi origindestin od data visualis result desir line alloc desir line road guideway via rout servic aggreg rout estim total level flow segment throughout transport network develop model estim transport behaviour current variou scenario chang calcul catchment area affect transport infrastructur autom task assist research practition creat evid decis make data process analysi stage fast painless time dedic visualis decis make allow research focu problem rather clunki graphic user interfac gui adhoc script could generalis furthermor process made reproduc access eg via onlin visualis packag shini could help transport plan move away relianc black box waddell_urbansim_ empow citizen challeng decis made transport plan author base evid hollander_transport_ mani advantag use scriptabl interact open sourc languag r transport plan approach enabl reproduc research autom share code research reduc barrier innov anyon creat new featur benefit planner easier interact non domain expert lack dedic softwar integr softwar system illustr use gener javascript share interact map transport plan use publicli access propens cycl tool lovelace_propensity_ furthermor r strong user commun support newcom stplanr peer review thank commun surround ropensci advantag use r specif develop function describ paper excel geostatist capabl pebesma_software_ visualis packag eg tmap ggplot support logit model use model modal shift support mani format transport dataset store eg via rio packag packag structur function packag instal load usual way see packag readmehttpsgithubcomropenscistplanr depend access develop version r evalfals installpackagesstplanr r librarystplanr illustr messag emit stplanr load depend cranpkgsp mean spatial data class commonli use packag work gener r function summari aggreg illustr figur plot citepbivand_applied_ core function class packag core function structur around common type spatial transport data origindestin od data report number peopl travel origindestin pair type data explicitli spatial od dataset usual repres data frame repres movement space point geograph space exampl provid flow dataset line data one dimension linear featur surfac earth typic store spatiallinesdatafram rout data special type line alloc transport network rout typic result alloc straight desir line alloc rout network route_ function rout network repres mani overlap rout typic store spatiallinesdatafram eas use function focuss data type develop name prefix od_ line_ route_ respect select present tabl addit core function could develop prefix rn_ work rout network data g_ function geograph oper buffer creation latlon project data function current name buff_geo plan elicit feedback chang implement r echofals resultsasi messagefals stplanr_fun lspackagestplanr sel_cor greppattern od_line_route_ x stplanr_fun core_fun stplanr_funssel_cor argsnam core_fun fun_tabl readcsvfun_tablecsv stringsasfactor fals checknam fals knitrkablefun_t caption select function work gener od line rout data type tip hat concept type stabil eg implement cranpkgdplyr also plan make core function stplanr typest futur releas core function begin prefix list could follow cranpkgdplyr lead return object class input howev limit approach break exist function mean output object larger size necessari line_bear exampl need duplic spatial data contain input instead plan continu name function around type input data take open mind function inputoutput data class convent especi context new class system implement cranpkgsf class system develop data type option discuss final section common data type use stplanr assum data frame spatial dataset transport dataset divers therefor mani function adhock name rather attempt systemat descript stplanr function glean onlin manual illumin see work togeth part transport plan workflow workflow begin data access end visualis access process transport data gain access data often first stage transport research often long protract process thank becom easier thank open data movement packag tigri make data access within r easier citepwalker_tigris_ stplanr provid varieti differ function facilit import common data format use transport analysi r although transport analysi gener requir transportspecif dataset also typic reli heavili common sourc data includ censu data case stplanr also includ function may use involv transport research includ read_table_build function import data australian bureau statist ab uk stat road traffic casualti dataset brief exampl latter demonstr begin download data warn download mb data r evalfals dl_stat download extract stat road traffic casualti data data save tmprtmpppfeaccidentscsv data save tmprtmpppfecasualtiescsv data save tmprtmpppfevehiclescsv data save default directori determin tempdir readin clean read_stats_ function note call format_stats_ function intern clean dataset add correct label variabl r evalfals ac read_stats_ac ca read_stats_ca read_stats_v result dataset repres accid casualti vehicl level data respect merg made geograph illustr r evalfals librarydplyr ca_ac inner_joinca ac ca_cycl ca_ac filtercasualty_sever fatal isnalatitud selectag age_of_casualti mode casualty_typ longitud latitud ca_sp spatialpointsdataframecoord ca_cycl data ca_cycl casualti data clean subset includ seriou cycl crash convert spatial class system analys use geograph dataset type commonli use stplanr follow code exampl geograph subset dataset includ crash occur within bound box rout network datasethttpsgithubcomropenscistplanrblobmasterdataroute_networkrdarawtru provid stplanr version beyond use function bbpoli convert spatial dataset box repres rectangular spatialpolygonsdatafram r evalfals dataroute_network devtoolsinstall_githubropenscisplanrvers projstringca_sp projstringroute_network bb bbpolyroute_network projstringbb projstringroute_network ca_loc ca_spbb code chunk show import understand geograph data work transport data convert casualti data spatial data class ad coordin refer system cr transport planner research link import dataset back rout network perform gi oper result next code chunk exampl find fatal took place within rout network use function buff_geo r echofals bb bbpolyroute_network loadreqfilesrdata r messagefals rnet_buff_ geo_bufferroute_network width ca_buff ca_localrnet_buff_ visualis use base r graphic extend cranpkgsp illustr figur reffigfat provid good start analysi publicationqu plot interact plot design public engag recommend use dedic visualis packag work spatial data cranpkgtmap r fat figcaproad traffic fatal studi area download stplanr cross death happen within rout network repres circl outwidth figaligncent plotbb lti plotrnet_buff_ col grey add true pointsca_loc pch pointsca_buff cex creat geograph desir line perhap common type aggregatelevel transport inform origindestin od data present either matrix commonli long tabl od pair exampl type raw data provid see flow see dataset creat r dataflow packag stplanr headflowc although flow data display describ movement geograph space contain explicitli geograph inform instead coordin origin destin link separ geograph dataset also must load analys flow common problem solv function odlin geograph data set point repres centroid origin destin save spatialpointsdatafram geograph data r best repres spatial object use object engin explain close integr stplanr rs spatial packag especi sp defin spatial object system r datac packag stplanr asdataframec c use odlin combin flow cent join former latter visualis l object creat next section r warningfals l odlineflow flow zone cent data form much easier analys plot data command plotl possibl spatiallinesdatafram object also contain data per line also help visualis flow illustr figur reffiglines_rout alloc flow transport network common problem face transport research network alloc convert crow fli line illustr figur rout complex wind path peopl anim make avoid obstacl build make journey faster effici eg follow rout network difficult recent near imposs use free softwar size complex transport network complex realist rout algorithm need contextspecif rout engin inexperienc cyclist exampl would take differ rout heavi good vehicl stplanr tackl issu use rd parti api provid routealloc rout alloc undertaken coderoute_ function coderoute_cyclestreet linebreak coderoute_graphhopp alloc singl od pair repres text string geocod pair coordin two spatialpoint object repres origin destin illustr route_cyclestreet use cyclestreetsnet apihttpswwwcyclestreetsnetapi rout servic cyclist cyclist offer rang rout strategi primarili fastest quietest balanc base detail analysi cyclist wayfindingan api key need function work request purchas larg scale rout cyclestreetsnetapiapplyhttpswwwcyclestreetsnetapiappli see route_cyclestreet detail thank martin lucassmith simon nuttal make possibl r evalfals route_bl route_cyclestreetsfrom bradford leed route_c_c route_cyclestreetsc cent raw output rout api usual provid json geojson text string default route_cyclestreet save number key variabl includ length time hilli busy variabl gener cyclestreetsnet attribut data provid api user want save raw output save_raw argument use r evalfals route_bl_raw route_cyclestreetsfrom bradford leed save_raw true addit argument taken route_ function depend rout function question chang plan argument route_cyclestreet fastest quietest balanc exampl rout favour speed quiet balanc speed quiet save respect autom creation routealloc line mani desir line linerout function loop line wrap route_ function input output spatiallinesdatafram number dimens input dataset see right panel figur reffiglines_rout routes_fast lineroutel l route_fun route_cyclestreet result batch rout exercis illustr figur reffiglines_rout red line left hand panel differ hypothet straight desir line often use transport research highlight import routealloc function r lines_rout outwidth figcapvisualis travel desir line width proport number trip origin destin black rout alloc network red lefthand panel right hand panel show rout network dataset gener overlin figshowhold plotroute_network lwd plotl lwd lall add true linesroutes_fast col red routes_fastal lall rnet overlineroutes_fast fun sum rnetflow rnetal meanrnetal plotrnet lwd rnetflow meanrnetflow estim amount capac need segment transport network overlin function demonstr use divid line geometri uniqu segment aggreg overlap valu result illustr righthand panel figur reffiglines_rout use estim need improv transport network exampl inform decis build new bicycl path limit route_cyclestreet rout api includ specif one mode cycl singl region uk part europ overcom limit addit rout api ad function route_graphhopp route_transportapi_publ viarout interfac graphhopp transportapi open sourc rout machin osrm rout servic respect great advantag osrm allow run rout servic local server greatli increas rate rout gener short exampl find rout car bike new york oaxaca demonstr route_graphhopp collect geograph data rout variou mode anywher world output shown tabl reftabxtnyoa show function also save time distanc bike trip vertic distanc climb trip r evalfals outwidthtextwidth nyoaxaca route_graphhoppernew york oaxaca vehicl bike nyoaxaca route_graphhoppernew york oaxaca vehicl car rbindnyoaxacadata nyoaxacadata r evalfals echofals nytab rbindnyoaxacadata nyoaxacadata nytab cbindmod ccycl car nytab xtnyoa xtablenytab caption attribut data route_graphhopp function new york oaxaca cycl car label tabxtnyoa printxtablextnyoa includerownam fals plotnyoaxaca plotnyoaxaca add true col red nyoaxacadata nyoaxacadata time dist change_elev na calcul geograph attribut transport rout model travel catchment area access transport servic particularli import topic consid public transport activ travel frequent steep reduct use distanc access servic infrastructur increas result plan transport servic infrastructur frequent focus sever measur access includ distanc also travel time frequenc weight popul function stplanr intend provid method estim access measur well calcul popul access specif servic ie estim catchment area catchment area particular wide use measur access attempt quantifi like target group particular servic visualis geograph area cover servic instanc passeng often said will walk metr bu stop metr railway station citepelgeneidy_new_ although distanc may appear rel arbitrari found underestim true catchment area bu stop railway station citepelgeneidy_new_daniels_explaining_ nonetheless repres good albeit somewhat conserv start point catchment area determin mani case catchment area calcul basi straightlin crow fli distanc simplist rel appeal approach requir littl addit data straightforward understand stplanr provid function calcul catchment area use straightlin distanc calc_catch function function take spatialpolygonsdatafram contain popul data typic censu spatial layer contain geometri transport facil two layer overlay calcul statist desir catchment includ proport polygon account proport locat within catchment area illustr catchment area calcul stplanr contain sampl dataset store esri shapefil format commonli use format distribut gi layer togeth use calcul sampl catchment area one dataset smallsa contain popul data statist area sa zone sydney australia second contain hypothet cycleway align street sydney code unzip dataset read shapefil r loadshapefil resultshidemessagehid data_dir systemfileextdata packag stplanr unzipfilepathdata_dir smallsazip unzipfilepathdata_dir testcyclewayzip saincom assfread_sfsmallsashp spatial testcycleway assfread_sftestcyclewayshp spatial remov unzip file fileremovelistfilespattern smallsatestcycleway calcul catchment area straightforward addit specifi requir dataset vector contain column name calcul statist distanc requir sinc proport area assum project data unproject data automat project either common project one alreadi project specifi project emphasis choic project import effect result mean set local project recommend achiev accur result r calccatch resultshid catchm calc_catch polygonlay saincom targetlay testcycleway calccol ctotal distanc project austalb dissolv true look datafram associ spatialpolygonsdatafram return calc_catch function total popul within catchment area seen nearli peopl catchment area also plot spatial object use plot function use code result shown figur reffigcatchmentplot r catchmentplot figcapan metr catchment area red associ cycl path green use straightlin distanc sydney plotsaincom col light grey plotcatchm col rgb add true plottestcycleway col green add true simplist catchment area use straightlin distanc reason approxim rout taken walk cycl transport facil howev often case catchment area figur reffigcatchmentplot initi appear reason redshad catchment area includ area requir travel around bay access greencolour cycleway allow realist catchment area situat stplanr provid calc_network_catch function use principl calc_catch also take account transport network use calc_network_catch transport network need prepar use conjunct previou dataset prepar dataset involv use spatiallinesnetwork function creat network spatiallinesdatafram function combin spatiallinesdatafram graph network use cranpkgigraph packag provid basic rout function network use calcul shortest actual path within specif catchment distanc process involv follow code r echotru messagefals warningfals resultshid unzipfilepathdata_dir sydroadszip sydroad assfread_sf road spatial fileremovelistfilespattern road sydnetwork spatiallinesnetworksydroad network catchment calcul use similar method calc_catch minor chang specif includ spatiallinesnetwork use maximped paramet defin distanc distanc addit distanc network contrast distanc paramet base straightlin distanc calc_catch calc_network_catch function maximped paramet maximum valu unit network weight attribut practic gener distanc metr also travel time risk measur r warningfals netcatchm calc_network_catch sln sydnetwork polygonlay saincom targetlay testcycleway calccol ctotal maximped distanc project austalb calcul network catchment area use straightlin network catchment includ extract catchment popul plot origin catchment area togeth origin area result shown figur reffignetcatchplot r netcatchplot figcapa metr network catchment blue compar catchment area base euclidean distanc red associ cycl path green plotsaincom col light grey plotcatchm col rgb add true plotnetcatchm col rgb add true plottestcycleway col green add true model visualis model mode choic routealloc line allow estim rout distanc cirquiti rout distanc divid euclidean distanc variabl help model rate flow origin destin illustr lefthand panel figur reffigeuclidfastest code demonstr object gener stplanr use undertak analysi line_length function use find distanc meter latlon data ld_euclidean line_lengthl ld_rf routes_fastdatalength plotld_euclidean ld_rf xlab euclidean distanc ylab rout distanc ablinea b ablinea b col green ablinea b col red r echofals messagefals ld_euclidean line_lengthl ld_rf routes_fastlength left hand panel figur reffigeuclidfastest show expect strong correl euclidean d_e fastest rout d_rf distanc howev od pair proport higher rout distanc other illustr distanc black line plot repres emphcircu q ratio network distanc euclidean distanc citeplevinson_minimum_ q fracd_rfd_ extens concept cirquiti quiet divers factor qdf desir line citeplovelace_propensity_ ratio rout distanc quiet rout option d_rq fastest qdf fracd_rqd_rf thank quietest rout option provid route_cyclestreet estim averag valu metric follow r evalfals routes_slow lineroutel route_cyclestreet plan quietest r ld_rq routes_slowlength quietest rout distanc q meanld_rf ld_euclidean narm true qdf meanld_rq ld_rf narm true q qdf result show cycl path particularli direct studi region intern standard citepcrow_design_ hardli surprisingli given small size sampl short distanc cover q tend decreas decay rate distanc surpris qdf close uniti could impli quiet rout construct along direct therefor sensibl rout caution assumpt howev small sampl desir line time explor find quiet divers factor respect time qdf_t slightli larger r qdft meanroutes_slowtim routes_fasttim narm true model travel behaviour mani way estim flow origin destin includ spatial interact model fourstag transport model graviti model distanc decay stplanr aim eventu facilit creation mani type flow model present function model distanc decay someth would like add futur version stplanr distanc decay especi import concept sustain transport plan due physic limit abil peopl walk cycl larg distanc citepiacono_measuring_ explor relationship distanc proport trip made walk use object l gener stplanr r euclidwalk figcapeuclidean distanc walk trip evalfals lpwalk lonfoot lall plotld_euclidean lpwalk cex lall xlab euclidean distanc ylab proport trip foot r euclidfastest outwidth figcapeuclidean fastest rout distanc trip studi area left euclidean distanc vs proport trip made walk right echofals parmfrow c lgb spsptransforml crsobj spcrsinitepsg ld_euclidean rgeosglengthlgb byid ld_rf routes_fastdatalength plotld_euclidean ld_rf xlab euclidean distanc ylab rout distanc ablinea b ablinea b col green ablinea b col red lpwalk lonfoot lall plotld_euclidean lpwalk cex lall xlab euclidean distanc ylab proport trip foot base righthand panel figur reffigeuclidfastest clear neg relationship distanc trip proport trip made walk unsurpris beyond certain distanc around km accord data present figur walk usual seen slow mode consid accord academ literatur distanc decay nonlinear number function propos fit distanc decay curv citepmartinez_new_ rang option test two form compar abil linear logsquareroot function fit data contain l walk r lm lmpwalk d_euclidean data ldata weight lm lmpwalk d_rf data ldata weight lm glmpwalk d_rf id_rf data ldata weight famili quasipoissonlink log result regress model seen use summari surprisingli euclidean distanc better predictor walk rout distanc strong conclus drawn find small sampl desir line n result pure illustr kind possibl creat use stplanr conjuct rs model capabl see figur vreffigeuclidwalk r echofals evalfals summarylm summarylm summarylm r euclidwalk figcaprelationship euclidean distanc walk outwidth figaligncent plotld_euclidean lpwalk cex lall xlab euclidean distanc ylab proport trip foot l dataframed_euclidean d_rf lmp predictlm l lmp predictlm l lmp predictlm l linesld_euclidean lmp linesld_euclidean explmp col green linesld_euclidean explmp col red visualis visualis import aspect transport studi enabl research commun find research policymak ultim public may therefor come surpris stplanr contain function visualis instead user encourag make use exist spatial visualis tool r tmap leaflet ggmap citepcheshire_spatial_kahle_ggmap_ furthermor develop onlin applic framework shini easier ever make result transport analysi model project avail public exampl onlin interfac propens cycl tool pct result project gener use stplanr present zone desir line rout network level citeplovelace_propensity_ great potenti expand principl publicli access transport plan tool via web app perhap new r packag dedic visualis transport data futur direct travel paper demonstr great potenti r use transport plan rs flexibl power gi capabl citepbivand_applied_ free access make wellsuit need transport planner research especi want avoid high cost marketlead product rather reinvent wheel eg new class system stplanr build exist packag cranpkgsp class work common transport data format use see stplanr r transport plan gener addit tool transport planner cabinet understood one part wider movement make transport plan open democrat process develop movement includ increas avail open data citepnaumova_building_ rise open sourc product transport model sumohttpswwwdlrdetsendesktopdefaultaspxtabid_read matsimhttpswwwmatsimorg mitsimlab citepsaidallah_comparative_ stplanr focu gi oper rather microscop vehiclelevel behaviour complement softwar help make better use new open data sourc transport plan inher spatial activ stplanr occupi import nich transport plan softwar landscap focu spatial transport data great potenti develop stplanr mani direct desir develop includ addit function model modal split examampl function creat commonli distanc decay curv commonli found activ travel research citepmartinez_new_ improv comput effici exist function make method scalabl larg databas prioriti stplanr howev keep focu geograph function transport plan mani opportun direct includ function assess environ surround rout eg via integr indevelop osmdata packag function match differ gi rout perhap build hausdorf distanc algorithm implement cranpkgrgeo function gdistanc addit function routealloc travel eg via interfac opentripplann api function aggreg larg gp trace dataset eg raster cell anonymis analysisvisualis purpos creation class system spatial transport dataset repres spatial rout rout network perhap class name codesr codesrn shortterm prioriti would benefici coincid develop migrat cranpkgsf spatial class spatial data process capabl would increas rang transport plan task stplanr facilit plan develop activ use vital new function intuit r famous steep learn curv implement simpl concept consist name system citepbaath_state_ ensur type stabil greatli improv usabl packag reason much futur work stplanr go improv document userfriendli like much open sourc softwar stplanr openend project workinprogress set clear motiv develop transport plan capabl r believ current version stplanr provid major step direct compar avail coupl year ago much therefor welcom input packag prioriti lie evolv futur ensur welldevelop sustain creat opportun extend exist model data analysi data better handl typic travel survey format eg creat system repres travel survey worldwid merg trip individu household level data nonspati extens r transport plan could build fast group process function provid cranpkgdplyr interest potenti direct travel stplanr futur packag transport research would like contribut request new featur see httpsgithubcomrobinlovelacestplanr refer titl transport rout stplanr output rmarkdownhtml_vignett vignett vignetteindexentrytransport rout stplanr vignetteengineknitrrmarkdown vignetteencodingutf r includ fals knitropts_chunkset collaps true comment eval curlhas_internet r setup librarystplanr introduct rout process identifi rout enabl movement two geograph locat along shortest path base modespecif rout profil optim way base rout network data open rout engin reli openstreetmap osm data use exampl isl wight demonstr rout engin get osm data isl wight run follow command r evalfals remotesinstall_githubitsleedsgeofabrik librarygeofabrik roads_iow get_geofabriknam isl wight f gf_filenameisl wight filecopyf iowpbf optionsosrmserv http osrmprofil drive osrm rout servic openstreetmap rout machin osrm requir input network usual osm use osrm packag r libraryosrm system termin run follow command make osrm docker imagehttpshubdockercomrosrmosrmbackend work r enginebash evalfals docker run v pwddata osrmosrmbackend osrmextract p optcarlua dataiowpbf docker run v pwddata osrmosrmbackend osrmpartit dataiowosrm docker run v pwddata osrmosrmbackend osrmcustom dataiowosrm docker run p v pwddata osrmosrmbackend osrmrout algorithm mld dataiowosrm curl httpsroutevdrivingstepstru rout r singl rout r evalfals l pctwight_lines_ p linepointsl r osrmosrmroutesrc p dst p returnclass sf overview full plotr r echofals knitrinclude_graphicshttpsuserimagesgithubusercontentcomdceadfdpng find mani rout via rout function result someth like figur r evalfals routes_osrm routel l route_fun osrmrout returnclass sf overview full rnet_osrm overlineroutes_osrm attrib bicycl mapviewmapviewrnet_osrm lwd rnet_osrmbicycl r evalfals echofals systemtim routes_osrm routel l route_fun osrmrout returnclass sf overview full around rout per second saverdsroutes_osrm routes_osrmrd piggybackpb_uploadroutes_osrmrd r echofals knitrinclude_graphicshttpsuserimagesgithubusercontentcomdfcbeaffceapng r evalfals tidi f listfilespattern iow unlinkx f recurs true shut docker contain r evalfals enginezsh docker ps docker stop stupefied_hopp gener roxygen edit hand pleas edit document rroute_cyclestreetsr nameroute_cyclestreet aliasroute_cyclestreet titleplan singl rout cyclestreetsnet usag route_cyclestreet plan fastest silent true pat null base_url httpswwwcyclestreetsnet reporterror true save_raw fals argument itemfromtext string coordin numer vector codelength repres latitud longitud repres point earth itemtotext string coordin numer vector codelength repres latitud longitud repres point earth repres destin trip itemplantext strong either fastest default quietest balanc itemsilentlog default fals true hide request sent itempatth api key use default set null usual aquir automat helper api_pat itembase_urlth base url construct api request default set main server itemreporterrorsboolean valu truefals indic cyclestreet true default report error fals default itemsave_rawboolean valu return raw list json true fals default descript provid r interfac cyclestreetsnet cycl plan api rout planner made cyclist cyclist function return spatiallinesdatafram object repres estim fastest quietest balanc rout current work unit kingdom part continent europ though area may request contact cyclestreet see urlhttpswwwcyclestreetsnetapifor inform detail function use onlin rout servic cyclestreetsnet find rout suitabl cyclist origin destin requir internet connect cyclestreetsnet api key origin destin within uk variou area beyond run note codefrom codeto suppli charact string instead lonlat pair googl geocod servic use via codegeo_cod need api key code run load local save copi api key text string run function exampl ensur avail comput verbmytoken readlinesdropboxdotfilescyclestreetsapikeyrl syssetenvcyclestreet mytoken want api key avail futur session set use renviron file codeusethisedit_r_environ read renviron coderenviron exampl dontrun c geo_codele c geo_codebradford uk json_output route_cyclestreetsfrom plan quietest save_raw true strjson_output cyclestreet give rf_lb route_cyclestreetsfrom plan fastest rf_lbdata plotrf_lb rf_lblength distanc mile rf_lbtime time hour averag speed mph seealso linerout gener roxygen edit hand pleas edit document rodfunsr nameodmatrix_to_od aliasodmatrix_to_od titleconvert origindestin data wide long format usag odmatrix_to_ododmatrix argument itemodmatrixa matrix row column repres origin destin zone code cell repres flow zone descript function take matrix repres travel origin origin code coderownam matrix destin destin code codecolnam matrix return data frame repres origindestin pair detail function return data frame row order origin destin zone code valu name codeorig codedest codeflow exampl odmatrix od_to_odmatrixflow odmatrix_to_ododmatrix flow odmatrix_to_odod_to_odmatrixflow seealso od codelinkdist_googl codelinkodlin codelinkododf codelinkod_aggregate_from codelinkod_aggregate_to codelinkod_coordslin codelinkod_coord codelinkod_dist codelinkod_id codelinkod_oneway codelinkod_to_odmatrix codelinkpointsflow codelinkpointsodf conceptod gener roxygen edit hand pleas edit document rroute_funsr nameroute_rolling_diff aliasroute_rolling_diff titlereturn smooth differ vector valu usag route_rolling_diffx lag ab true argument itemxnumer vector smooth itemlagth window size smooth function default take mean valu includ valu itemabsshould absolut alway posit chang return true default descript function calcul simpl roll mean base r use calcul rout characterist mean distanc segment chang gradient exampl r od_data_routesod_data_routesroute_numb relev route_rolling_diffi lag route_rolling_diffi lag relevations_diff_ route_rolling_diffi lag relevations_diff_n route_rolling_diffi lag ab fals cumsumrdist rdistanc diff_above_mean relevations_diff_ meani diff_above_mean_n relevations_diff_n meani plotc cumsumrdist cy ylengthi ylim c linesc cumsumrdist cy ylengthi pointsd diff_above_mean pointsd diff_above_mean_n col blue ablineh meani seealso route_fun codelinkroute_average_gradi codelinkroute_rolling_averag codelinkroute_rolling_gradi codelinkroute_sequential_dist codelinkroute_slope_matrix codelinkroute_slope_vector conceptroute_fun gener roxygen edit hand pleas edit document rdatar doctypedata namel_poli aliasl_poli titlelin polygon format spatialpolygon usag datal_poli descript dataset repres road width test exampl dontrun l routes_fast l_poli geo_projectedl rgeosgbuff plotl_poli plotroutes_fast add true alloc road width relev line devtoolsuse_datal_poli keyworddataset gener roxygen edit hand pleas edit document rgooglefunctionsr namedist_googl aliasdist_googl titlereturn travel network distanc time use googl map api usag dist_googl google_api sysgetenvgoogledist g_unit metric mode cbicycl walk drive transit arrival_tim argument itemfromtwocolumn matrix data frame coordin repres latitud longitud origin itemtotwocolumn matrix data frame coordin repres latitud longitud destin itemgoogle_apistr valu contain googl api key use itemg_unitstext string either metric default imperi itemmodetext string specifi mode transport bicycl default walk drive transit itemarrival_timetim arriv date format descript return travel network distanc time use googl map api detail absent author googl api limit maximum simultan queri exampl return valu origin time destin sectiondetail estim travel time account road network see urlhttpsdevelopersgooglecommapsdocumentationdistancematrixoverview note current return json object return googl map api use origin destin exampl dontrun distanc one origin one destin c c dist_googlefrom mode walk support last test dist_googlefrom mode drive dist_googlefrom c c datac distanc origin destin dists_cycl dist_googlefrom cent cent dists_driv dist_googlec cent mode drive dists_tran dist_googlec cent mode transit dists_trans_am dist_googlec cent mode transit arrival_tim strptime format ymd hm tz bst find much longer shorter cycl take walk summarydists_cycledur dists_transdur differ travel arriv summarydists_trans_amdur dists_transdur odf pointsodfc odf cbindodf dist headodf flow pointsflowc show result durat thicker line shorter plotflow lwd meanodfdur odfdur dist_googlechereford cweobley leominst kington dist_googlechereford cweobley leominst kington mode transit arrival_tim strptime format ymd hm tz bst seealso od codelinkodlin codelinkododf codelinkod_aggregate_from codelinkod_aggregate_to codelinkod_coordslin codelinkod_coord codelinkod_dist codelinkod_id codelinkod_oneway codelinkod_to_odmatrix codelinkodmatrix_to_od codelinkpointsflow codelinkpointsodf conceptod gener roxygen edit hand pleas edit document roverlin namelinelabel aliaslinelabel titlelabel spatiallinesdatafram object usag linelabelssl attrib argument itemsla spatiallinesdatafram overlap element itemattriba text string correspond name variabl codesl descript function add label line plot use base graphic larg illustr purpos design publicationqu graphic seealso rnet codelinkspatiallinesnetwork codelinkcalc_catchment_sum codelinkcalc_catch codelinkcalc_moving_catch codelinkcalc_network_catch codelinkfind_network_nod codelinkgsect codelinkislin codelinkoverline_spati codelinkoverlin codelinkplotspatiallinesnetworkanymethod codelinkplotsfnetworkanymethod codelinkrnet_breakup_vertic codelinkrnet_group codelinkslnpoint codelinksum_network_link codelinksum_network_rout author barri rowlingson conceptrnet gener roxygen edit hand pleas edit document roverlin nameoverline_intersect aliasoverline_intersect titleconvert seri overlap line rout network usag overline_intersectionsl attrib fun sum argument itemslan codesf codelinestr object overlap element itemattribcharact column name sl aggreg itemfunnam list function summari attribut codesum default codelistsum sum averag mean summaris codeattribut sum mean descript function take overlap codelinestr store codesf object return rout network compos nonoverlap geometri aggreg valu exampl routes_fast_sfvalu sl routes_fast_sf attrib cvalu length rnet overline_intersectionsl sl attrib plotrnet lwd rnetvalu larger exampl sl routes_fast_sf rnet overline_intersectionsl sl attrib cvalu length plotrnet lwd rnetvalu rnet_sf overlineroutes_fast_sf attrib cvalu length plotrnet_sf lwd rnet_sfvalu even larger exampl shown take time run rnet overline_intersectionroutes_fast_sf attrib cvalu length rnet_sf overlineroutes_fast_sf attrib cvalu length buff_dist plotrnetgeometri lwd rnetvalu col grey plotrnet_sfgeometri lwd rnet_sfvalu add true gener roxygen edit hand pleas edit document rrouter nameroute_dodgr aliasroute_dodgr titlerout local data use dodgr packag usag route_dodgrfrom null null l null net null argument itemfroman object repres origin line provid first argument assign codel itemtoan object repres destin itemlonli need empti case spatial object repres desir line itemnetsf object repres rout network descript rout local data use dodgr packag exampl requirenamespacedodgr c geo_codepedal arm leed c geo_codegz next line use gener stplanrosm_net_exampl pt rbindfrom colnamespt cx net dodgrdodgr_streetnetpt pt expand osm_net_exampl netchighway name lane maxspe r route_dodgrfrom net osm_net_exampl plotosm_net_examplegeometri plotrgeometri add true col red lwd seealso rout codelinklinerouteretri codelinklinerout codelinkroute_loc codelinkroute_osrm codelinkroute_transportapi_publ codelinkrout conceptrout gener roxygen edit hand pleas edit document rnodefunsr namernet_add_nod aliasrnet_add_nod titleadd node rout network usag rnet_add_nodernet p argument itemrneta rout network type gener codeoverlin itempa point repres codesf object split coderout descript add node rout network exampl sample_rout routes_fast_sf null sample_routesvalu rep lengthout rnet overlinesample_rout attrib valu p sfst_sfcsfst_pointc cr sfst_crsrnet r_split route_splitrnet p plotrnetgeometri lwd rnetvalu col grey plotp cex add true plotr_split col nrowr_split add true lwd r_splitvalu gener roxygen edit hand pleas edit document rcatchmentarear namecalc_catch aliascalc_catch titlecalcul catchment area associ summari statist usag calc_catch polygonlay targetlay calccol distanc project pasteprojaea lat_ lat_ lat_ lon_ x_ y_ ellpsgr towg unitsm no_def retainareaproport fals dissolv fals quadseg null argument itempolygonlayera spatialpolygonsdatafram contain zone summari statist catchment variabl calcul smaller polygon increas accuraci result itemtargetlayera spatialpolygonsdatafram spatiallinesdatafram spatialpointsdatafram spatialpolygon spatiallin spatialpoint object contain specif facil catchment area calcul object contain one facil eg multipl cycl path aggreg catchment area calcul itemcalccolsa vector column name contain variabl polygonlay use calcul summari statist catchment area dissolv fals variabl origin spatialpolygonsdatafram zone fall partli entir within catchment area includ return spatialpolygonsdatafram adjust proport within catchment area itemdistancedefin size catchment area distanc around targetlay unit project default metr itemprojectionth projstr use defin project use calcul catchment area charact string austalb use australian alber equal area project ignor polygonlay project case targetlay convert project use polygonlay case result object reproject origin coordin system project polygon layer default alber equal area project reliabl result use local project eg australian alber equal area project itemretainareaproportionboolean valu true retain variabl result spatialpolygonsdatafram contain proport origin area within catchment area default fals itemdissolveboolean valu true collaps underli zone within catchment area singl region statist whole catchment area itemquadsegsnumb line segment use approxim quarter circl paramet pass buffer function default sp sf descript calcul catchment area associ summari statist sectiondetail calcul catchment area facil eg cycl path use straightlin distanc well summari statist variabl avail spatialpolygonsdatafram censu tract zone assum frequenc variabl evenli distribut throughout zone return spatialpolygonsdatafram exampl dontrun data_dir systemfileextdata packag stplanr unzipfilepathdata_dir smallsazip unzipfilepathdata_dir testcyclewayzip saincom assfread_sfsmallsashp spatial testcycleway assfread_sftestcyclewayshp spatial cway_catch calc_catch polygonlay saincom targetlay testcycleway calccol ctotal distanc project austalb dissolv true plotsaincom plotcway_catch add true col green plottestcycleway col red add true saincom sfread_sfsmallsashp testcycleway sfread_sftestcyclewayshp f listfil testcyclewaysmallsa fileremovef cway_catch calc_catch polygonlay saincom targetlay testcycleway calccol ctotal distanc project austalb dissolv true plotsaincomegeometri plottestcyclewaygeometri col red add true plotcway_catchtot add true seealso rnet codelinkspatiallinesnetwork codelinkcalc_catchment_sum codelinkcalc_moving_catch codelinkcalc_network_catch codelinkfind_network_nod codelinkgsect codelinkislin codelinklinelabel codelinkoverline_spati codelinkoverlin codelinkplotspatiallinesnetworkanymethod codelinkplotsfnetworkanymethod codelinkrnet_breakup_vertic codelinkrnet_group codelinkslnpoint codelinksum_network_link codelinksum_network_rout conceptrnet gener roxygen edit hand pleas edit document rrnet_groupr namernet_group aliasrnet_group aliasrnet_groupdefault aliasrnet_groupsfc aliasrnet_groupsf aliasrnet_groupsfnetwork titleassign segment rout network group usag rnet_grouprnet methodrnet_groupdefaultrnet methodrnet_groupsfc rnet cluster_fun igraphclust null asundirect true methodrnet_groupsf rnet cluster_fun igraphclust null asundirect true methodrnet_groupsfnetworkrnet cluster_fun igraphclust argument itemrnetan sf sfc sfnetwork object repres rout network itemargu pass method itemcluster_funth cluster function use variou cluster function avail codeigraph packag default codelinkigraphcomponentsigraphclust itemdopt distanc variabl use classifi segment close within certain distanc specifi code necessarili touch itemasundirectedcoerc graph creat intern undirect graph codelinkigraphasdirectedigraphasundirect true default enabl use wider rang cluter function valu input rnet sfsfc object return integ vector report group network element input sfnetwork object return sfnetwork object extra column call rnet_group repres group network element latter case connect spatial object deriv sfnetwork object descript function assign linestr featur mani codesf object form rout network group default function codeigraphclust use determin group membership verbigraphclust function use see exampl web page hrefhttpsigraphorgrdoccommunitieshtmligraphorgrdoccommunitieshtml inform web page follow cluster function avail detail verbcluster_edge_between cluster_fast_greedi cluster_label_prop verbcluster_leading_eigen cluster_louvain cluster_optim cluster_spinglass cluster_walktrap exampl rnet rnet_breakup_verticesstplanrosm_net_exampl rnetgroup rnet_grouprnet plotrnetgroup mapviewmapviewrnetgroup rnetgroup_m rnet_grouprnet plotrnetgroup_m rnetgroup_walktrap rnet_grouprnet igraphcluster_walktrap plotrnetgroup_walktrap rnetgroup_louvain rnet_grouprnet igraphcluster_louvain plotrnetgroup_louvain rnetgroup_fast_greedi rnet_grouprnet igraphcluster_fast_greedi plotrnetgroup_fast_greedi show sfnetwork implement sfn spatiallinesnetworkrnet sfn rnet_groupsfn plotsfnslrnet_group seealso rnet codelinkspatiallinesnetwork codelinkcalc_catchment_sum codelinkcalc_catch codelinkcalc_moving_catch codelinkcalc_network_catch codelinkfind_network_nod codelinkgsect codelinkislin codelinklinelabel codelinkoverline_spati codelinkoverlin codelinkplotspatiallinesnetworkanymethod codelinkplotsfnetworkanymethod codelinkrnet_breakup_vertic codelinkslnpoint codelinksum_network_link codelinksum_network_rout conceptrnet gener roxygen edit hand pleas edit document rrouter namerout aliasrout titleplan rout transport network usag rout null null l null route_fun cyclestreetsjourney wait n_print list_output fals cl null argument itemfroman object repres origin line provid first argument assign codel itemtoan object repres destin itemlonli need empti case spatial object repres desir line itemroute_funa rout function use convert straight line rout codelinkodlineodlin itemwaithow long wait rout second default use send request rate limit api itemn_printa number specifi frequent progress updat shown itemlist_outputif fals default assum spatial linestr object output set true save output list itemclclust itemargu pass rout function eg codelinkroute_cyclestreetsroute_cyclestreet descript take origin destin find optim rout return result spatial sf sp object definit optim depend rout function use exampl librarysf l od_data_lin donttest ifcurlhas_internet r_walk routel l route_fun route_osrm osrmprofil foot r_bike routel l route_fun route_osrm osrmprofil bike plotr_walkgeometri plotr_bikegeometri col blue add true r_bc routel l route_fun route_bikecitizen plotr_bc routel l route_fun route_bikecitizen wait libraryosrm r_osrm rout l l route_fun osrmrout returnclass sf nrowr_osrm plotr_osrm sln stplanrspatiallinesnetworkroute_network_sf calcul shortest path plotsln plotlgeometri add true r_local stplanrrout l l route_fun stplanrroute_loc sln sln plotr_localal add true lwd seealso rout codelinklinerouteretri codelinklinerout codelinkroute_dodgr codelinkroute_loc codelinkroute_osrm codelinkroute_transportapi_publ conceptrout gener roxygen edit hand pleas edit document rspatiallinesnetworkr namespatiallinesnetwork aliasspatiallinesnetwork titlecr object class spatiallinesnetwork sfnetwork usag spatiallinesnetworksl uselonglat fals toler argument itemsla spatiallin spatiallinesdatafram contain line use creat network itemuselonglata boolean valu indic data assum use wg latitudelongitud coordin codefals set use coordin system specifi spatiallin object itemtolerancea numer valu indic toler unit coordin system use toler match node descript creat new spatiallinesnetwork spatiallin sfnetwork sf object use rout analysi within r sectiondetail function use creat new spatiallinesnetwork exist spatiallin spatiallinesdatafram object typic use case repres transport network rout network analysi function function correspond spatiallinesnetwork class implement spatiallinesnetwork develop edzer pebesma present hrefhttpsrpubscomedzerrpub origin implement rewritten better support larg ie detail citys network provid addit method use conduct transport research follow initi exampl provid hrefhttpsrpubscomjanoskazjanoska exampl donttest dont test due issu depend sln_sf spatiallinesnetworkroute_network_sf plotsln_sf shortpath sum_network_routessln_sf sumvar length plotshortpathgeometri col red lwd add true refer pebesma e spatial network urlhttpsrpubscomedz janoska z find shortest path spatial network urlhttpsrpubscomjanoskaz seealso rnet codelinkcalc_catchment_sum codelinkcalc_catch codelinkcalc_moving_catch codelinkcalc_network_catch codelinkfind_network_nod codelinkgsect codelinkislin codelinklinelabel codelinkoverline_spati codelinkoverlin codelinkplotspatiallinesnetworkanymethod codelinkplotsfnetworkanymethod codelinkrnet_breakup_vertic codelinkrnet_group codelinkslnpoint codelinksum_network_link codelinksum_network_rout conceptrnet gener roxygen edit hand pleas edit document rroute_cyclestreetsr nameapi_pat aliasapi_pat titleretriev person access token usag api_patapi_nam forc fals argument itemapi_nametext string name api call eg cyclestreet graphhopp etc descript retriev person access token exampl dontrun api_patapi_nam cyclestreet keywordintern gener roxygen edit hand pleas edit document roverlin nameoverlin aliasoverlin aliasoverlin titleconvert seri overlap line rout network usag overlin sl attrib ncore simplifi true regionalis e quiet ifelsenrowsl true fals fun sum overlin sl attrib ncore simplifi true regionalis e quiet ifelsenrowsl true fals fun sum argument itemsla spatial object repres rout transport network itemattribcharact column name sl aggreg itemncoresinteg mani core use parallel process default itemsimplifylog true group final segment back line default true itemregionaliseinteg simplif regonalis use number segment exce valu itemquietshould function omit messag codenul default mean output shown codesl row itemfunnam list function summari attribut codesum default codelistsum sum averag mean summaris codeattribut sum mean valu codesf object repres rout network descript function take seri overlap line convert singl rout network function intend replac overlin significantli faster especi larg dataset howev also use memori detail function use estim amount transport flow rout segment level base input dataset rout servic exampl linestr geometri creat coderout function codeoverlin function break line mani straight segment look duplic segment attribut sum duplic segment simplifi true segment ident attribut recombin linestr follow argument appli codesf implement codeoverlin item item codencor number core use parallel process item codesimplifi final segment convert back longer line default set codetru codesimplifi fals result straight line segment consist vertic start end point result data frame mani row simplifi result see exampl item coderegionalis threshold number row regionalis use see detail codesf object regionalis break dataset x grid perform simplif across grid significantli reduc comput time larg dataset slightli increas final file size smaller dataset increas comput time slightli reduc memori usag may also use known limit method overlap segment differ length aggreg occur line stop halfway road typic error small artefact may remain within result data larg dataset nrowx memori usag signific case possibl overlin subset dataset rbind result togeth overlin produc final result multicor support enabl regionalis simplif stage help stage exampl sl routes_fast_sf slall flowlinesal rnet overlinesl sl attrib nrowsl nrowrnet plotrnet rnet_mean overlinesl call av_inclin fun listmean mean sum sum plotrnet_mean lwd rnet_meanall_sum meanrnet_meanall_sum rnet_sf_raw overlinesl attrib length simplifi fals nrowrnet_sf_raw summaryn_verticesrnet_sf_raw plotrnet_sf_raw rnet_sf_rawn nrowrnet_sf_raw plotrnet_sf_raw legaci implement base sp data sl routes_fast rnet overlinesl sl attrib length rnet overlinesl sl attrib length buff_dist plotrnet lwd rnetlength meanrnetlength plotrnet lwd rnetlength meanrnetlength refer morgan lovelac r travel flow aggreg nation scalabl method interact onlin visualis transport behaviour road network level environ plan b urban analyt citi scienc juli doi rowlingson b overlay line aggreg valu overlap segment reproduc question urlhttpsgisstackexchangecom see urlhttpsgisstackexchangecomquest seealso rnet codelinkspatiallinesnetwork codelinkcalc_catchment_sum codelinkcalc_catch codelinkcalc_moving_catch codelinkcalc_network_catch codelinkfind_network_nod codelinkgsect codelinkislin codelinklinelabel codelinkoverline_spati codelinkplotspatiallinesnetworkanymethod codelinkplotsfnetworkanymethod codelinkrnet_breakup_vertic codelinkrnet_group codelinkslnpoint codelinksum_network_link codelinksum_network_rout rnet codelinkspatiallinesnetwork codelinkcalc_catchment_sum codelinkcalc_catch codelinkcalc_moving_catch codelinkcalc_network_catch codelinkfind_network_nod codelinkgsect codelinkislin codelinklinelabel codelinkoverline_spati codelinkplotspatiallinesnetworkanymethod codelinkplotsfnetworkanymethod codelinkrnet_breakup_vertic codelinkrnet_group codelinkslnpoint codelinksum_network_link codelinksum_network_rout author barri rowlingson malcolm morgan conceptrnet gener roxygen edit hand pleas edit document rgeo_projectedr namegeo_length aliasgeo_length titlecalcul line length line geograph project cr usag geo_lengthshp argument itemshpa spatial line object descript take line repres sf sp class return numer valu repres distanc meter exampl lib_vers sfsf_extsoftvers lib_vers lib_vers geo_lengthroutes_fast geo_lengthroutes_fast_sf gener roxygen edit hand pleas edit document rodfunsr nameod_coordslin aliasod_coordslin titleconvert origindestin coordin desir line usag od_coordslineodc cr remove_dupl true argument itemodca data frame matrix repres coordin origindestin data first two column repres coordin origin typic longitud latitud point third fourth column repres coordin destin cr row repres travel origin destin itemcrsa number repres coordin refer system result default itemremove_duplicatesshould row duplic row remov codetru default descript convert origindestin coordin desir line exampl odf od_coordsl flowlines_sf odlin od_coordslineodf odlin od_coordslineodf cr plotodlin x_coord n dataframelappli functionx samplex_coord n replac true namesd cfx fy tx ty l od_coordslin plotl nrowl l_with_dupl od_coordslin remove_dupl fals plotl_with_dupl nrowl_with_dupl seealso od codelinkdist_googl codelinkodlin codelinkododf codelinkod_aggregate_from codelinkod_aggregate_to codelinkod_coord codelinkod_dist codelinkod_id codelinkod_oneway codelinkod_to_odmatrix codelinkodmatrix_to_od codelinkpointsflow codelinkpointsodf conceptod gener roxygen edit hand pleas edit document rroute_googl nameroute_googl aliasroute_googl titlefind shortest path use googl servic usag route_googlefrom mode walk key sysgetenvgoogl argument itemfroman object repres origin line provid first argument assign codel itemtoan object repres destin itemmodemod transport walk default bicycl transit drive itemkeygoogl key default codesysgetenvgoogl set codeusethisedit_r_environ itemargu pass rout function eg codelinkroute_cyclestreetsroute_cyclestreet descript find shortest path use googl servic see codemapsapi packag detail exampl dontrun univers leed pedal arm leed r routefrom route_fun cyclestreetsjourney plotr r_googl routefrom route_fun mapsapimp_direct fail r_googl route_googlefrom plotr_googl r_googl routefrom route_fun route_googl gener roxygen edit hand pleas edit document rodfunsr nameod_aggregate_to aliasod_aggregate_to titlesummari statist trip arriv destin zone od data usag od_aggregate_toflow attrib null fun sum col argument itemflowa data frame repres origindestin data first two column data frame correspond first column data zone thu codelinkcentsc first column geo_cod correspond first two column codelinkflowflow itemattribcharact column name sl aggreg itemfuna function summaris od data itemaddit argument pass codefun itemcolth column od dataset group default first column usual repres origin descript function take data frame od data return data frame report summari statist uniqu zone destin detail default set assum destin id column nd default summari statist codesum default codeattrib set summaris numer column exampl od_aggregate_toflow seealso od codelinkdist_googl codelinkodlin codelinkododf codelinkod_aggregate_from codelinkod_coordslin codelinkod_coord codelinkod_dist codelinkod_id codelinkod_oneway codelinkod_to_odmatrix codelinkodmatrix_to_od codelinkpointsflow codelinkpointsodf conceptod gener roxygen edit hand pleas edit document rrnetcleanr namernet_breakup_vertic aliasrnet_breakup_vertic titlebreak sf object linestr geometri usag rnet_breakup_verticesrnet verbos fals argument itemrnetan sf sfc object linestr geometri repres rout network itemverboseboolean true function print addit messag valu sf sfc object linestr geometri creat break input object descript function break linestr geometri multipl linestr use mainli preserv routabl codesfnetwork object creat use open street map data see detail hrefhttpsgithubcomropenscistplanrissuesstplanrissu hrefhttpsgithubcomropenscistplanrissuesstplanrissu detail linestr geometri brokenup one two follow condit met enumer item two linestr share point boundari point linestr see rnet_roundabout exampl item two linestr share point boundari linestr see rnet_cycleway_intersect exampl problem first exampl accord algorithm behind codelinkspatiallinesnetworkspatiallinesnetwork two linestr connect share least one point boundari road roundabout clearli connect real world correspond linestr object share two distinct boundari point fact open street map standard roundabout repres close circular linestr impli roundabout connect road accord codelinkspatiallinesnetworkspatiallinesnetwork definit reason road second exampl clearli connect real world share point boundari function use solv type problem exampl librarysf def_par parnoreadonli true parmar rep check geometri roundabout exampl dot repres boundari point linestr isol red point topleft boundari point roundabout share street plotst_geometryrnet_roundabout lwd col rainbownrowrnet_roundabout boundary_point st_geometrylinepointsrnet_roundabout points_col reprainbownrowrnet_roundabout plotboundary_point pch add true col points_col cex clean roundabout exampl rnet_roundabout_clean rnet_breakup_verticesrnet_roundabout plotst_geometryrnet_roundabout_clean lwd col rainbownrowrnet_roundabout_clean boundary_point st_geometrylinepointsrnet_roundabout_clean points_col reprainbownrowrnet_roundabout_clean plotboundary_point pch add true col points_col roundabout routabl sinc divid multipl piec one colour accord spatiallinesnetwork function connect check geometri overpass exampl exampl use test function creat spuriou intersect plotst_geometryrnet_overpass lwd col rainbownrowrnet_overpass boundary_point st_geometrylinepointsrnet_overpass points_col reprainbownrowrnet_overpass plotboundary_point pch add true col points_col cex moment network routabl sinc one underpass connect street check interact mapviewmapviewrnet_overpass clean network creat spuriou intersect road locat differ height rnet_overpass_clean rnet_breakup_verticesrnet_overpass plotst_geometryrnet_overpass_clean lwd col rainbownrowrnet_overpass_clean check interact mapviewmapviewrnet_overpass check geometri cycleway_intersect exampl black dot repres boundari point see two road connect accord spatiallinesnetwork function plot rnet_cycleway_intersectiongeometri lwd col rainbownrowrnet_cycleway_intersect cex plotst_geometrylinepointsrnet_cycleway_intersect pch add true check interact mapviewmapviewrnet_overpass clean rnet object plot result rnet_cycleway_intersection_clean rnet_breakup_verticesrnet_cycleway_intersect plot rnet_cycleway_intersection_cleangeometri lwd col rainbownrowrnet_cycleway_intersection_clean cex plotst_geometrylinepointsrnet_cycleway_intersection_clean pch add true pardef_par seealso rnet codelinkspatiallinesnetwork codelinkcalc_catchment_sum codelinkcalc_catch codelinkcalc_moving_catch codelinkcalc_network_catch codelinkfind_network_nod codelinkgsect codelinkislin codelinklinelabel codelinkoverline_spati codelinkoverlin codelinkplotspatiallinesnetworkanymethod codelinkplotsfnetworkanymethod codelinkrnet_group codelinkslnpoint codelinksum_network_link codelinksum_network_rout conceptrnet gener roxygen edit hand pleas edit document rdatar doctypedata namec aliasc aliascents_sf titlespati point repres home locat format spatial dataset row variabl usag datac descript point repres populationweight centroid medium super output area msoa zone within mile radiu home write packag detail item item geo_cod offici code zone item msoanm name zone name item percent_fem percent femal item avslop averag gradient zone cent gener data repositori pctdata httpsgithubcomnpctpctdata data access within pct repo httpsgithubcomnpctpct use follow code exampl dontrun cent plotcent keyworddataset gener roxygen edit hand pleas edit document rdatar doctypedata nameroute_network aliasroute_network aliasroute_network_sf titlespati line dataset repres rout network format spatial line dataset row column usag dataroute_network descript flow commut use differ segment road network repres codelinkflowlinesflowlin codelinkroutes_fastroutes_fast dataset exampl dontrun gener rout network route_network overlineroutes_fast fun sum route_network_sf sfst_as_sfroute_network seealso exampl data codelinkdestination_zon codelinkflow_dest codelinkflowlin codelinkflow codelinkroutes_fast codelinkroutes_slow conceptexampl data keyworddataset gener roxygen edit hand pleas edit document rodfunsr nameododf aliasododf titleextract coordin od data usag ododfflow zone argument itemflowa data frame repres origindestin data first two column data frame correspond first column data zone thu codelinkcentsc first column geo_cod correspond first two column codelinkflowflow itemzonesa spatial object repres origin destin separ destin object provid travel descript extract coordin od data detail origindestin od data often provid form line per od pair zone code trip origin first column zone code destin second column see hrefhttpsdocsropensciorgstplanrarticlesstplanrodhtmlcodevignettestplanrod detail codeododf creat origindestin data frame base data frame contain origin destin cone codeflow match first column spatial polygon point object codezon function return data frame coordin origin destin exampl dataflow datazon ododfflow zone seealso od codelinkdist_googl codelinkodlin codelinkod_aggregate_from codelinkod_aggregate_to codelinkod_coordslin codelinkod_coord codelinkod_dist codelinkod_id codelinkod_oneway codelinkod_to_odmatrix codelinkodmatrix_to_od codelinkpointsflow codelinkpointsodf conceptod gener roxygen edit hand pleas edit document rgeo_cod namegeo_cod aliasgeo_cod titleconvert text string point map usag geo_cod address servic nominatim base_url httpsmapsgooglecommapsapigeocodejson return_al fals pat null argument itemaddresstext string repres address want geocod itemservicewhich servic use nominatim default itembase_urlth base url queri itemreturn_allshould request return inform return googl map default codefals return two number longitud latitud order itempatth api key use default set null usual aquir automat helper api_pat descript gener latlong pair data use googl geoloc api exampl dontrun geo_codeaddress hereford geo_codel hb geo_codehereford return_al true need api key renviron geo_codehereford servic googl pat sysgetenvgoogl return_al true seealso node codelinknearest_googl conceptnod gener roxygen edit hand pleas edit document ras_sf_funr nameas_sf_fun aliasas_sf_fun aliasas_sp_fun titleconvert function support sfsp usag as_sf_funinput fun argument iteminputinput object sf sp object itemfuna function work spsf data itemargu pass codefun descript convert function support sfsp gener roxygen edit hand pleas edit document rline_breakupr nameline_breakup aliasline_breakup titlebreak line object shorter segment usag line_breakupl z argument itemlan sf object linestr geometri itemzan sf object codepolygon geometri number repres resolut grid cell use break linestr object valu sf object linestr geometri creat break input object descript function break linestr geometri smaller piec exampl librarysf z zones_sfgeometri l routes_fast_sfgeometri l_split line_breakupl z l l_split sfst_lengthl sumsfst_lengthl_split plotz plotl add true lwd col grey plotl_split add true col lengthl_split seealso line codelinkangle_diff codelinkgeo_toptail codelinkis_linepoint codelinklinedf codelinklinepoint codelinkline_bear codelinkline_midpoint codelinkline_sampl codelinkline_seg codelinkline_via codelinkmatslin codelinkn_sample_length codelinkn_vertic codelinkonewaygeo codelinkpointslin codelinktoptail_buff codelinktoptailg codelinkupdate_line_geometri conceptlin gener roxygen edit hand pleas edit document rline_sampl namen_sample_length aliasn_sample_length titlesampl integ number given continu vector line length probabl total n usag n_sample_lengthn l_length weight argument itemnsum integ valu return iteml_lengthsnumer vector line length itemweightsrel probabl sampl line descript sampl integ number given continu vector line length probabl total n exampl n l_length weight re n_sample_lengthn l_length weight sumr n l_length c weight c re n_sample_lengthn l_length weight sumr exampl n_sample_length c n_sample_length c l flowlin l_length line_lengthl n n_sample_length l_length weight lall seealso line codelinkangle_diff codelinkgeo_toptail codelinkis_linepoint codelinklinedf codelinklinepoint codelinkline_bear codelinkline_breakup codelinkline_midpoint codelinkline_sampl codelinkline_seg codelinkline_via codelinkmatslin codelinkn_vertic codelinkonewaygeo codelinkpointslin codelinktoptail_buff codelinktoptailg codelinkupdate_line_geometri conceptlin gener roxygen edit hand pleas edit document rquadrantsr namequadr aliasquadr titlesplit spatial object quadrant usag quadrantsp_obj number_out fals argument itemsp_objspati object itemnumber_outshould output number fals default descript split spatial object initi test spatialpolygon quadrant detail return charact vector ne se sw nw correspond northeast southeast quadrant respect number_out true return number respect exampl datazon sp_obj zone quad quadrantsp_obj plotsp_obj col factorquad pointsrgeosgcentroidsp_obj col white edg case eg use raster lead na sp_obj rasterrastertopolygonsrasterrasterncol nrow quad quadrantsp_obj plotsp_obj col factorquad seealso geo codelinkbbox_scal codelinkgeo_bb_matrix codelinkgeo_bb codelinkreproject conceptgeo gener roxygen edit hand pleas edit document rodfunsr namelinepoint aliaslinepoint aliaslinepointsn aliaslinevertic titleconvert spatial linestr object point usag linepointsl id repnrowl linepointsnl lineverticesl argument itemlan codesf object codespatiallinesdatafram older codesp packag itemidsvector id default codenrowl descript number point doubl number line codelinepoint close relat function codelinepointsn return point line vertic point correspond given line codei codeii last function codelinevertic return point vertic node input codel object compos linestr point return empti codesf object exampl l routes_fast_sf lpoint linepointsl plotlgeometri plotlpoint add true test vertic plotlgeometri lpoint linepointsnl plotlpointsgeometri add true extract intern vertic l_internal_vertic lineverticesl plotsfst_geometryl reset fals plotl_internal_vertic add true boundari point miss seealso line codelinkangle_diff codelinkgeo_toptail codelinkis_linepoint codelinklinedf codelinkline_bear codelinkline_breakup codelinkline_midpoint codelinkline_sampl codelinkline_seg codelinkline_via codelinkmatslin codelinkn_sample_length codelinkn_vertic codelinkonewaygeo codelinkpointslin codelinktoptail_buff codelinktoptailg codelinkupdate_line_geometri conceptlin gener roxygen edit hand pleas edit document rspatiallinesnetworkr namefind_network_nod aliasfind_network_nod titlefind graph node id closest node given coordin usag find_network_nodessln x null maxdist argument itemslnspatiallinesnetwork search itemxeith x longitud coordin valu vector x valu datafram matrix least two column first coordin x longitud valu second latitud valu name vector length two valu lat lon output geo_cod either singl result multipl use rbind also use itemyeith latitud coordin valu vector valu itemmaxdistth maximum distanc within match node coordin spatiallinesnetwork project distanc unit project longlat distanc metr default valu integ valu id node closest verbxi valu codena closest node codemaxdist verbxi codex vector return vector node id descript find graph node id closest node given coordin sectiondetail find node id closest point singl coordin pair set coordin spatiallinesnetwork exampl dataroutes_fast rnet overlineroutes_fast attrib length sln spatiallinesnetworkrnet find_network_nodessln seealso rnet codelinkspatiallinesnetwork codelinkcalc_catchment_sum codelinkcalc_catch codelinkcalc_moving_catch codelinkcalc_network_catch codelinkgsect codelinkislin codelinklinelabel codelinkoverline_spati codelinkoverlin codelinkplotspatiallinesnetworkanymethod codelinkplotsfnetworkanymethod codelinkrnet_breakup_vertic codelinkrnet_group codelinkslnpoint codelinksum_network_link codelinksum_network_rout conceptrnet gener roxygen edit hand pleas edit document rroute_funsr nameroute_rolling_averag aliasroute_rolling_averag titlereturn smooth averag vector usag route_rolling_averagex n argument itemxnumer vector smooth itemnth window size smooth function default take mean valu includ valu descript function calcul simpl roll mean base r use calcul rout characterist mean distanc segment chang gradient exampl od_data_routeselevationsod_data_routesroute_numb route_rolling_averagey route_rolling_averagey n route_rolling_averagey n route_rolling_averagey n seealso route_fun codelinkroute_average_gradi codelinkroute_rolling_diff codelinkroute_rolling_gradi codelinkroute_sequential_dist codelinkroute_slope_matrix codelinkroute_slope_vector conceptroute_fun gener roxygen edit hand pleas edit document rspatiallinesnetworkr doctypeclass namespatiallinesnetworkclass aliasspatiallinesnetworkclass titlean class repres typic transport network descript class use combin spatiallinesdatafram igraph object repres transport network use rout network analys sectionslot describ itemcodesla spatiallinesdatafram geometri attribut link network itemcodegth graph network correspond codesl itemcodenba list contain vector node connect node network itemcodeweightfielda charact vector contain variabl column name spatiallinesdatafram use weight network gener roxygen edit hand pleas edit document roverlin nameoverline_spati aliasoverline_spati titlespati aggreg rout repres sp class usag overline_spatialsl attrib fun sum nazero fals buff_dist argument itemslspatiallinesdatafram overlap line split number overlap featur itemattribcharact column name sl aggreg itemfunnam list function summari attribut codesum default codelistsum sum averag mean summaris codeattribut sum mean itemnazeroset whether aggreg valu valu zero remov itembuff_dista number specifi distanc meter buffer use crop line run oper distanc zero default touch nonoverlap line may aggreg descript function larg supersed sf implement still work particularli fast seealso rnet codelinkspatiallinesnetwork codelinkcalc_catchment_sum codelinkcalc_catch codelinkcalc_moving_catch codelinkcalc_network_catch codelinkfind_network_nod codelinkgsect codelinkislin codelinklinelabel codelinkoverlin codelinkplotspatiallinesnetworkanymethod codelinkplotsfnetworkanymethod codelinkrnet_breakup_vertic codelinkrnet_group codelinkslnpoint codelinksum_network_link codelinksum_network_rout conceptrnet gener roxygen edit hand pleas edit document rroute_bikecitizensr nameroute_bikecitizen aliasroute_bikecitizen titleget rout bikecitizen web servic usag route_bikecitizen null null base_url httpsmapbikecitizensnetapivlocationsroutejson cccode gbleed routing_profil balanc bike_profil citybik from_lat from_lon to_lat to_lon argument itemfroma numer vector repres start point itemtoa numer vector repres end point itembase_urlth base url rout itemcccodeth citi code rout itemrouting_profilewhat type rout use itembike_profilewhat type bike itemfrom_latlatitud origin itemfrom_lonlongitud origin itemto_latlatitud destin itemto_lonlongitud destin descript see hrefhttpsmapbikecitizensnetgbleedsbikecitizensnet interact version rout engin use bikecitizen exampl donttest ifcurlhas_internet route_bikecitizen ldf od_coordsstplanrod_data_lin r route_bikecitizensldf plotr gener roxygen edit hand pleas edit document rcatchmentarear namecalc_network_catch aliascalc_network_catch titlecalcul catchment area associ summari statist use network usag calc_network_catch sln polygonlay targetlay calccol maximped distanc project pasteprojaea lat_ lat_ lat_ lon_ x_ y_ ellpsgr towg unitsm no_def retainareaproport fals dissolv fals argument itemslnth spatiallinesnetwork use itempolygonlayera spatialpolygonsdatafram contain zone summari statist catchment variabl calcul smaller polygon increas accuraci result itemtargetlayera spatialpolygonsdatafram spatiallinesdatafram spatialpointsdatafram object contain specif facil zone catchment area calcul itemcalccolsa vector column name contain variabl polygonlay use calcul summari statist catchment area dissolv fals variabl origin spatialpolygonsdatafram zone fall partli entir within catchment area includ return spatialpolygonsdatafram adjust proport within catchment area itemmaximpedanceth maximum valu network weight attribut unit weight default itemdistancedefin addit catchment area around network unit project default metr itemprojectionth projstr use defin project use calcul catchment area charact string austalb use australian alber equal area project ignor polygonlay project case targetlay convert project use polygonlay case result object reproject origin coordin system project polygon layer default alber equal area project reliabl result use local project eg australian alber equal area project itemretainareaproportionboolean valu true retain variabl result spatialpolygonsdatafram contain proport origin area within catchment area default fals itemdissolveboolean valu true collaps underli zone within catchment area singl region statist whole catchment area descript calcul catchment area associ summari statist use network sectiondetail calcul catchment area facil eg cycl path use network distanc weight variabl well summari statist variabl avail spatialpolygonsdatafram censu tract zone assum frequenc variabl evenli distribut throughout zone return spatialpolygonsdatafram exampl dontrun data_dir systemfileextdata packag stplanr unzipfilepathdata_dir smallsazip exdir tempdir unzipfilepathdata_dir testcyclewayzip exdir tempdir unzipfilepathdata_dir sydroadszip exdir tempdir saincom readogrtempdir smallsa testcycleway readogrtempdir testcycleway sydroad readogrtempdir road sydnetwork spatiallinesnetworksydroad calc_network_catch sln sydnetwork polygonlay saincom targetlay testcycleway calccol ctotal maximped distanc project austalb dissolv true seealso rnet codelinkspatiallinesnetwork codelinkcalc_catchment_sum codelinkcalc_catch codelinkcalc_moving_catch codelinkfind_network_nod codelinkgsect codelinkislin codelinklinelabel codelinkoverline_spati codelinkoverlin codelinkplotspatiallinesnetworkanymethod codelinkplotsfnetworkanymethod codelinkrnet_breakup_vertic codelinkrnet_group codelinkslnpoint codelinksum_network_link codelinksum_network_rout conceptrnet gener roxygen edit hand pleas edit document rsloper nameroute_sequential_dist aliasroute_sequential_dist titlecalcul sequenti distanc sequenti coordin pair usag route_sequential_distm lonlat true argument itemmmatrix contain coordin elev itemlonlatar coordin lonlat order codetru default descript calcul sequenti distanc sequenti coordin pair exampl x c c cbindx route_sequential_distm seealso route_fun codelinkroute_average_gradi codelinkroute_rolling_averag codelinkroute_rolling_diff codelinkroute_rolling_gradi codelinkroute_slope_matrix codelinkroute_slope_vector conceptroute_fun gener roxygen edit hand pleas edit document rodfunsr namepointsflow aliaspointsflow titleconvert seri point geograph flow usag pointsflowp argument itempa spatial point object descript take seri geograph point convert spatial linestr object repres potenti flow spatial interact everi combin point exampl datac plotcent flow pointsflowc plotflow add true flow_sf pointsflowcents_sf plotflow_sf seealso od codelinkdist_googl codelinkodlin codelinkododf codelinkod_aggregate_from codelinkod_aggregate_to codelinkod_coordslin codelinkod_coord codelinkod_dist codelinkod_id codelinkod_oneway codelinkod_to_odmatrix codelinkodmatrix_to_od codelinkpointsodf conceptod gener roxygen edit hand pleas edit document rcatchmentarear namecalc_moving_catch aliascalc_moving_catch titlecalcul summari statist featur independ usag calc_moving_catch polygonlay targetlay calccol distanc project worldalb retainareaproport fals argument itempolygonlayera spatialpolygonsdatafram contain zone summari statist catchment variabl calcul smaller polygon increas accuraci result itemtargetlayera spatialpolygonsdatafram spatiallinesdatafram spatialpointsdatafram object contain specif facil zone catchment area calcul itemcalccolsa vector column name contain variabl polygonlay use calcul summari statist catchment area itemdistancedefin size catchment area distanc around targetlay unit project default metr itemprojectionth projstr use defin project use calcul catchment area charact string austalb use australian alber equal area project ignor polygonlay project case targetlay convert project use polygonlay case result object reproject origin coordin system project polygon layer default alber equal area project reliabl result use local project eg australian alber equal area project itemretainareaproportionboolean valu true retain variabl result spatialpolygonsdatafram contain proport origin area within catchment area default fals descript calcul summari statist featur independ sectiondetail calcul summari statist catchment area multipl facil zone use straightlin distanc variabl avail spatialpolygonsdatafram censu tract zone assum frequenc variabl evenli distribut throughout zone return origin sourc datafram addit column summari variabl exampl dontrun data_dir systemfileextdata packag stplanr unzipfilepathdata_dir smallsazip unzipfilepathdata_dir testcyclewayzip saincom readogr smallsa testcycleway readogr testcycleway calc_moving_catch polygonlay saincom targetlay testcycleway calccol ctotal distanc project austalb seealso rnet codelinkspatiallinesnetwork codelinkcalc_catchment_sum codelinkcalc_catch codelinkcalc_network_catch codelinkfind_network_nod codelinkgsect codelinkislin codelinklinelabel codelinkoverline_spati codelinkoverlin codelinkplotspatiallinesnetworkanymethod codelinkplotsfnetworkanymethod codelinkrnet_breakup_vertic codelinkrnet_group codelinkslnpoint codelinksum_network_link codelinksum_network_rout conceptrnet gener roxygen edit hand pleas edit document rtoptailr nametoptail_buff aliastoptail_buff titleclip begin end spatiallin edg spatialpolygon border usag toptail_buffl buff argument itemlan sf linestr object itembuffan sf polygon object act buffer itemargu pass rgeosgbuff descript take line remov start end point distanc determin nearest polygon border exampl l routes_fast_sf buff zones_sf r_toptail toptail_buffl buff nrowl nrowr_toptail plotzones_sfgeometri plotlgeometri add true plotr_toptailgeometri lwd add true seealso line codelinkangle_diff codelinkgeo_toptail codelinkis_linepoint codelinklinedf codelinklinepoint codelinkline_bear codelinkline_breakup codelinkline_midpoint codelinkline_sampl codelinkline_seg codelinkline_via codelinkmatslin codelinkn_sample_length codelinkn_vertic codelinkonewaygeo codelinkpointslin codelinktoptailg codelinkupdate_line_geometri conceptlin gener roxygen edit hand pleas edit document rgeo_projectedr namegeo_select_aeq aliasgeo_select_aeq titleselect custom project cr area interest usag geo_select_aeqshp argument itemshpa spatial object geograph wg coordin system descript function take spatial object geograph wg cr return custom project cr focuss centroid object function especi use use unit metr direct data collect anywher world detail function base stackexchang answer urlhttpsgisstackexchangecomquest exampl spbboxroutes_fast new_cr geo_select_aeqroutes_fast rf_project spsptransformroutes_fast new_cr spbboxrf_project line_length rgeosglengthrf_project byid true plotline_length rf_projectedlength shp zones_sf geo_select_aeqshp gener roxygen edit hand pleas edit document rdatar doctypedata nameod_data_rout aliasod_data_rout titleexampl segmentlevel rout data format data frame tibbl object descript see codedatarawgeneratedatarmd detail creat dataset show rout origin destin repres codeod_data_lin exampl od_data_rout keyworddataset gener roxygen edit hand pleas edit document ronewayr nameod_oneway aliasod_oneway titleaggreg od pair becom nondirect usag od_oneway x attrib namesxcvapplyxc isnumer true id namesx id namesx stplanrkey null argument itemxa data frame spatiallinesdatafram repres od matrix itemattriba vector column number name repres variabl aggreg default numer variabl select aggreg itemidopt assum first column text string refer name variabl contain uniqu id origin itemidopt assum second column text string refer name variabl contain uniqu id destin itemstplanrkeyopt key uniqu od pair regardless order eg gener codelinkod_id_max_minod_id_max_min codelinkod_id_szudzikod_id_szudzik valu codeoneway output data frame codesf data frame row contain result userselect attribut valu aggreg descript exampl sum total travel direct detail flow data often contain movement two direct point point b b problemat transport plan magnitud flow along rout mask flow direct largest flow either direct captur analysi exampl true extent travel heavili underestim od pair similar amount travel direct flow direct often repres overlap line ident geometri see codelinkflowlinesflowlin confus user difficult plot exampl od_min od_data_samplec od_oneway od_onewayod_min od_oneway_old onewayidod_min attrib old implement nrowod_oneway nrowod_min result fewer row sumod_minal sumod_onewayal total flow od_onewayod_min attrib attrib whichvapplyflow isnumer true flow_oneway od_onewayflow attrib attrib colsumsflow_onewayattrib colsumsflowattrib test colsum equal demonstr result oneway onewaygeo ident flow_oneway_geo onewaygeoflowlin attrib attrib flow_oneway_sf od_onewayflowlines_sf parmfrow c plotflow_oneway_geo lwd flow_oneway_geoal meanflow_oneway_geoal plotflow_oneway_sfgeometri lwd flow_oneway_sfal meanflow_oneway_sfal parmfrow c od_max_min od_onewayod_min stplanrkey od_id_characterod_min od_min corod_max_minal od_onewayal benchmark perform benchmarkcheck fals iter onewayidflowlines_sf attrib od_onewayflowlines_sf seealso od codelinkdist_googl codelinkodlin codelinkododf codelinkod_aggregate_from codelinkod_aggregate_to codelinkod_coordslin codelinkod_coord codelinkod_dist codelinkod_id codelinkod_to_odmatrix codelinkodmatrix_to_od codelinkpointsflow codelinkpointsodf conceptod gener roxygen edit hand pleas edit document rodfunsr nameodlin aliasodlin aliasodlin titleconvert origindestin data spatial line usag odlin flow zone destin null zone_cod nameszon origin_cod namesflow dest_cod namesflow zone_code_d na silent fals odlineflow zone argument itemflowa data frame repres origindestin data first two column data frame correspond first column data zone thu codelinkcentsc first column geo_cod correspond first two column codelinkflowflow itemzonesa spatial object repres origin destin separ destin object provid travel itemdestinationsa spatial object repres destin travel flow itemzone_codenam variabl codezon contain id zone default first column name zone itemorigin_codenam variabl codeflow contain id zone origin default first column name flow input dataset itemdest_codenam variabl codeflow contain id zone destin default second column name flow input dataset first column name destin set itemzone_code_dnam variabl codedestin contain id zone default first column name destin itemsilenttru default set true show match column descript origindestin od flow data often provid form line per flow zone code origin destin centroid tricki plot linkup geograph data function make task easier detail origindestin od data often provid form line per od pair zone code trip origin first column zone code destin second column see hrefhttpsdocsropensciorgstplanrarticlesstplanrodhtmlcodevignettestplanrod detail codeodlin creat spatial linestr object repres movement origin destin od pair take data frame contain origin destin cone codeflow match first column spatial polygon point object codezon exampl od_data stplanrflow l odlineflow od_data zone cents_sf plotsfst_geometrycents_sf plotl lwd lall meanlal add true l odlineflow od_data zone cent destin differ headdestin od_data flow_dest od_data flowlines_dest odlineod_data cents_sf destin destinations_sf flowlines_dest plotflowlines_dest seealso od codelinkdist_googl codelinkododf codelinkod_aggregate_from codelinkod_aggregate_to codelinkod_coordslin codelinkod_coord codelinkod_dist codelinkod_id codelinkod_oneway codelinkod_to_odmatrix codelinkodmatrix_to_od codelinkpointsflow codelinkpointsodf conceptod gener roxygen edit hand pleas edit document rgeo_projectedr namegeo_project aliasgeo_project aliasgproject titleperform gi function temporari project version spatial object usag geo_projectedshp fun cr silent argument itemshpa spatial object geograph wg coordin system itemfuna function perform project object eg rgeo sf packag itemcrsan option coordin refer system provid set automat codelinkgeo_select_aeqgeo_select_aeq itemsilenta binari valu print cr detail default true itemargu pass codefun eg codebyid true function codergeosglength descript function perform oper project data exampl lib_vers sfsf_extsoftvers lib_vers fail system earli version proj lib_vers shp routes_fast_sf geo_projectedshp sfst_buffer dist gener roxygen edit hand pleas edit document rspatiallinesnetworkr namesum_network_link aliassum_network_link titlesummaris link shortest path data usag sum_network_linkssln routedata argument itemslnth spatiallinesnetwork sfnetwork use itemroutedataa datafram first column contain node id start rout second column indic node id end rout addit column summaris link addit colum overlap rout count descript summaris link shortest path data sectiondetail find shortest path network specifi node return spatiallinesdatafram sf contain path summari statist one exampl sln_sf spatiallinesnetworkroute_network_sf plotsln_sf nodes_df datafram start repc end repc time weightfieldsln_sf field use determin shortest path librarysf shortpath_sf sum_network_linkssln_sf nodes_df plotshortpath_sfcount lwd shortpath_sfcount add true seealso rnet codelinkspatiallinesnetwork codelinkcalc_catchment_sum codelinkcalc_catch codelinkcalc_moving_catch codelinkcalc_network_catch codelinkfind_network_nod codelinkgsect codelinkislin codelinklinelabel codelinkoverline_spati codelinkoverlin codelinkplotspatiallinesnetworkanymethod codelinkplotsfnetworkanymethod codelinkrnet_breakup_vertic codelinkrnet_group codelinkslnpoint codelinksum_network_rout conceptrnet gener roxygen edit hand pleas edit document rlinefunsr nameline_length aliasline_length titlecalcul length line geograph cr usag line_lengthl byid true argument itemla spatial line object itembyidlog determin whether length return per object default true descript calcul length line geograph cr gener roxygen edit hand pleas edit document rodfunsr nameod_dist aliasod_dist titlequickli calcul euclidean distanc od pair usag od_distflow zone argument itemflowa data frame repres origindestin data first two column data frame correspond first column data zone thu codelinkcentsc first column geo_cod correspond first two column codelinkflowflow itemzonesa spatial object repres origin destin separ destin object provid travel descript common want know euclidean distanc origin destin od data calcul first convert od data spatiallin data eg codelinkodlineodlin howev slow overkil want know distanc function order magnitud faster detail note function assum zone centroid codec geograph latlon cr exampl dataflow datac od_distflow cent seealso od codelinkdist_googl codelinkodlin codelinkododf codelinkod_aggregate_from codelinkod_aggregate_to codelinkod_coordslin codelinkod_coord codelinkod_id codelinkod_oneway codelinkod_to_odmatrix codelinkodmatrix_to_od codelinkpointsflow codelinkpointsodf conceptod gener roxygen edit hand pleas edit document rlinefunsr nameline_midpoint aliasline_midpoint titlefind midpoint line usag line_midpointl argument itemla spatial line object descript wrapper around codelinkspatiallinesmidpointsspatiallinesmidpoint allow find midpoint line project latlong cr exampl dataroutes_fast line_midpointroutes_fast seealso line codelinkangle_diff codelinkgeo_toptail codelinkis_linepoint codelinklinedf codelinklinepoint codelinkline_bear codelinkline_breakup codelinkline_sampl codelinkline_seg codelinkline_via codelinkmatslin codelinkn_sample_length codelinkn_vertic codelinkonewaygeo codelinkpointslin codelinktoptail_buff codelinktoptailg codelinkupdate_line_geometri conceptlin gener roxygen edit hand pleas edit document rspatiallinesnetworkr doctypeclass namesfnetworkclass aliassfnetworkclass titlean class repres typic transport network descript class use combin sf layer igraph object repres transport network use rout network analys sectionslot describ itemcodesla sf line layer geometri attribut link network itemcodegth graph network correspond codesl itemcodenba list contain vector node connect node network itemcodeweightfielda charact vector contain variabl column name spatiallinesdatafram use weight network gener roxygen edit hand pleas edit document rodfunsr nameod_to_odmatrix aliasod_to_odmatrix titleconvert origindestin data long wide format usag od_to_odmatrixflow attrib name_orig name_dest argument itemflowa data frame repres flow origin destin itemattriba number charact string repres column contain attribut data interest codeflow data frame itemname_origa number charact string repres zone origin itemname_desta number charact string repres zone destin descript function take data frame repres travel origin origin code codename_orig typic st column destin destin code codename_dest typic second column return matrix cell valu codeattrib third column default repres travel origin destin exampl od_to_odmatrixflow od_to_odmatrixflow od_to_odmatrixflow attrib bicycl seealso od codelinkdist_googl codelinkodlin codelinkododf codelinkod_aggregate_from codelinkod_aggregate_to codelinkod_coordslin codelinkod_coord codelinkod_dist codelinkod_id codelinkod_oneway codelinkodmatrix_to_od codelinkpointsflow codelinkpointsodf conceptod gener roxygen edit hand pleas edit document rspatiallinesnetworkr namesum_network_rout aliassum_network_rout titlesummaris shortest path node network usag sum_network_rout sln start end sumvar weightfieldsln combin fals argument itemslnth spatiallinesnetwork sfnetwork use itemstartinteg node indic rout start itemendinteg node indic rout end itemsumvarscharact vector variabl calcul summari statist default valu codeweightfieldsln itemcombinationsboolean valu indic combin start end calcul true everi start node id rout everi end node id faster pass everi combin start end default codefals descript summaris shortest path node network sectiondetail find shortest path network specifi node return codespatiallinesdatafram codesf object linestr geometri contain path summari statist one start end argument must integ repres node index find node closest geograph point use codefind_nearest_nod start end node ident function return degener line two ident point see hrefhttpsgithubcomropenscistplanrissu exampl sln spatiallinesnetworkroute_network weightfieldsln field use determin shortest path shortpath sum_network_routessln start end sumvar length plotshortpath col red lwd plotsln add true sf object sln spatiallinesnetworkroute_network_sf weightfieldsln field use determin shortest path shortpath sum_network_routessln start end sumvar length plotsfst_geometryshortpath col red lwd plotsln add true find shortest path two coordin sfst_bboxslnsl start_coord c end_coord c plotsln plotsfst_pointstart_coord cex add true col red plotsfst_pointend_coord cex add true col blue node find_network_nodessln rbindstart_coord end_coord shortpath sum_network_routessln node node plotsfst_geometryshortpath col darkr lwd add true degener path sum_network_routessln start end seealso rnet codelinkspatiallinesnetwork codelinkcalc_catchment_sum codelinkcalc_catch codelinkcalc_moving_catch codelinkcalc_network_catch codelinkfind_network_nod codelinkgsect codelinkislin codelinklinelabel codelinkoverline_spati codelinkoverlin codelinkplotspatiallinesnetworkanymethod codelinkplotsfnetworkanymethod codelinkrnet_breakup_vertic codelinkrnet_group codelinkslnpoint codelinksum_network_link conceptrnet gener roxygen edit hand pleas edit document rgeofunctionsr namebbox_scal aliasbbox_scal titlescal bound box usag bbox_scalebb scale_factor argument itembbbound box object itemscale_factornumer vector determin much bound box grow shrink two number refer extend bound box x dimens respect valu output size input descript take bound box input output bound box differ size centr point exampl bb matrixc nrow bb bbox_scalebb scale_factor bb bbox_scalebb scale_factor c bb bbox_scalebb plotx bb bb pointsbb bb pointsbb bb pointsbb bb col red seealso geo codelinkgeo_bb_matrix codelinkgeo_bb codelinkquadr codelinkreproject conceptgeo gener roxygen edit hand pleas edit document rodfunsr namelinerouteretri aliaslinerouteretri titleconvert straight spatial linestr object flow data rout retri connect intermitt failur usag linerouteretrylin pattern error n_retri argument itemlinesa spatial linestr object itempatterna regex error messag must match retri default error ie retri error start error itemn_retrynumb time retri itemargu pass rout function eg codelinkroute_cyclestreetsroute_cyclestreet descript convert straight spatial linestr object flow data rout retri connect intermitt failur sectiondetail see codelinklineroutelinerout version retri error exampl dontrun dataflowlin rf_list linerouteretryflowlin pattern nonexistanceerror silent f seealso rout codelinklinerout codelinkroute_dodgr codelinkroute_loc codelinkroute_osrm codelinkroute_transportapi_publ codelinkrout conceptrout gener roxygen edit hand pleas edit document rgeo_projectedr namegeo_buff aliasgeo_buff titleperform buffer oper temporari project cr usag geo_buffershp dist null width null argument itemshpa spatial object geograph cr eg wg around buffer drawn itemdistth distanc metr buffer buffer simpl featur itemwidthth distanc metr buffer buffer sp object itemargu pass buffer see codergeosgbuff codesfst_buff detail descript function solv problem buffer circular use nonproject data detail requir recent version proj buffer codesf object geograph lonlat coordin also done hrefhttpsrspatialgithubioscod packag exampl lib_vers sfsf_extsoftvers lib_vers lib_vers buff_sf geo_bufferroutes_fast_sf dist plotbuff_sfgeometri geo_bufferroutes_fast_sfgeometri dist legaci sp object test buff_sp geo_bufferroutes_fast width classbuff_sp plotbuff_sp col red gener roxygen edit hand pleas edit document rdatar doctypedata nameroutes_slow aliasroutes_slow aliasroutes_slow_sf titlespati line dataset commut flow travel network format spatial line dataset row column usag dataroutes_slow descript simul travel rout alloc transport network repres quietest codelinkcentsc object codelinkodlineodlin see codelinkflowflow seealso exampl data codelinkdestination_zon codelinkflow_dest codelinkflowlin codelinkflow codelinkroute_network codelinkroutes_fast conceptexampl data keyworddataset gener roxygen edit hand pleas edit document rspatiallinesnetworkr namesummaryspatiallinesnetworkmethod aliassummaryspatiallinesnetworkmethod titleprint summari spatiallinesnetwork usag smethodsummaryspatiallinesnetworkobject argument itemobjectth spatiallinesnetwork itemargu pass relev summari function descript print summari spatiallinesnetwork exampl dataroutes_fast rnet overlineroutes_fast attrib length sln spatiallinesnetworkrnet summarysln gener roxygen edit hand pleas edit document rnodefunsr namesln_add_nod aliassln_add_nod titleadd node spatial line object usag sln_add_nodesln p argument itemslna spatial line codesfnetwork object creat codespatiallinesnetwork itempa point repres codesf object split coderout descript add node spatial line object exampl sample_rout routes_fast_sf null sample_routesvalu rep lengthout rnet overlinesample_rout attrib valu sln spatiallinesnetworkrnet p sfst_sfcsfst_pointc cr sfst_crsrnet sln_node slnpointssln sln_new sln_add_nodesln p rout route_localsln_new p sln_node plotsln plotsln_nod pch ascharacternrowsln_nod add true plotroutegeometri lwd add true gener roxygen edit hand pleas edit document rroute_funsr nameroute_rolling_gradi aliasroute_rolling_gradi titlecalcul roll averag gradient elev data segment level usag route_rolling_gradientelev distanc lag n ab true argument itemelevationselev eg provid codecyclestreet packag itemdistancesdist eg provid codecyclestreet packag itemlagth window size smooth function default take mean valu includ valu itemnth window size smooth function default take mean valu includ valu itemabsshould absolut alway posit chang return true default descript calcul roll averag gradient elev data segment level exampl r od_data_routesod_data_routesroute_numb relev distanc rdistanc route_rolling_gradienti distanc route_rolling_gradienti distanc ab fals route_rolling_gradienti distanc n route_rolling_gradienti distanc n relevations_diff_ route_rolling_diffi lag rrolling_gradi route_rolling_gradienti distanc n rrolling_gradi route_rolling_gradienti distanc n rrolling_gradi route_rolling_gradienti distanc n cumsumrdist rdistanc diff_above_mean relevations_diff_ meani parmfrow c plotc cumsumrdist cy ylengthi ylim c linesc cumsumrdist cy ylengthi pointsd diff_above_mean ablineh meani rg rrolling_gradi rgisnarg plotc c rg ylim c pointsc c rrolling_gradi col blue pointsc c rrolling_gradi col grey parmfrow c seealso route_fun codelinkroute_average_gradi codelinkroute_rolling_averag codelinkroute_rolling_diff codelinkroute_sequential_dist codelinkroute_slope_matrix codelinkroute_slope_vector conceptroute_fun gener roxygen edit hand pleas edit document rodfunsr nameod_aggregate_from aliasod_aggregate_from titlesummari statist trip origin zone od data usag od_aggregate_fromflow attrib null fun sum col argument itemflowa data frame repres origindestin data first two column data frame correspond first column data zone thu codelinkcentsc first column geo_cod correspond first two column codelinkflowflow itemattribcharact column name sl aggreg itemfuna function summaris od data itemaddit argument pass codefun itemcolth column od dataset group default first column usual repres origin descript function take data frame od data return data frame report summari statist uniqu zone origin detail default set default summari statist codesum first column od data assum repres zone origin default codeattrib set summaris numer column exampl od_aggregate_fromflow seealso od codelinkdist_googl codelinkodlin codelinkododf codelinkod_aggregate_to codelinkod_coordslin codelinkod_coord codelinkod_dist codelinkod_id codelinkod_oneway codelinkod_to_odmatrix codelinkodmatrix_to_od codelinkpointsflow codelinkpointsodf conceptod gener roxygen edit hand pleas edit document rdatar doctypedata namezon aliaszon aliaszones_sf titlespati polygon home locat flow analysi descript note recommend use codezones_sf data detail correspond codecents_sf data item item geo_cod offici code zone exampl librarysf zones_sf plotzones_sf keyworddataset gener roxygen edit hand pleas edit document rline_sampl nameline_sampl aliasline_sampl titlesampl n point along line densiti proport weight usag line_samplel n weight argument itemlth spatiallin object along creat sampl point itemnth total number point sampl itemweightsth rel probabl line sampl descript sampl n point along line densiti proport weight exampl l flowlin n l_length line_lengthl weight lall p line_samplel weight plotp p line_samplel weight lengthl plotp seealso line codelinkangle_diff codelinkgeo_toptail codelinkis_linepoint codelinklinedf codelinklinepoint codelinkline_bear codelinkline_breakup codelinkline_midpoint codelinkline_seg codelinkline_via codelinkmatslin codelinkn_sample_length codelinkn_vertic codelinkonewaygeo codelinkpointslin codelinktoptail_buff codelinktoptailg codelinkupdate_line_geometri conceptlin gener roxygen edit hand pleas edit document rroutetransportapir nameroute_transportapi_publ aliasroute_transportapi_publ titleplan singl rout transportapicom usag route_transportapi_publ silent fals region southeast mode na not_mod na argument itemfromtext string coordin numer vector codelength repres latitud longitud repres point earth itemtotext string coordin numer vector codelength repres latitud longitud repres point earth repres destin trip itemsilentlog default fals true hide request sent itemregionstr activ region use journey plan possibl valu southeast default tfl itemmodesvector charact string contain mode use default use mode itemnot_modesvector charact string contain mode use use codemod set descript provid r interfac transportapicom public transport api function return spatiallinesdatafram object repres public rout current work unit kingdom see urlhttpsdevelopertransportapicomdocumentationfor inform detail function use onlin rout servic transportapicom find public rout origin destin requir key access api note codefrom codeto suppli charact string instead lonlat pair googl geocod servic use via codegeo_cod note dedic transportapi packag httpsgithubcomitsleedstransportapi exampl dontrun plan public rout hereford leed rqh route_transportapi_publicfrom hereford leed plotrq_hfd aim plan public transport rout transportapi seealso linerout rout codelinklinerouteretri codelinklinerout codelinkroute_dodgr codelinkroute_loc codelinkroute_osrm codelinkrout conceptrout gener roxygen edit hand pleas edit document rcrsfunsr namereproject aliasreproject titlereproject latlong spatial object unit usag reprojectshp cr geo_select_aeqshp argument itemshpa spatial object geograph wg coordin system itemcrsan option coordin refer system provid set automat codelinkgeo_select_aeqgeo_select_aeq descript mani gi function eg find area exampl dataroutes_fast rf_aeq reprojectroutes_fast rf_osgb reprojectroutes_fast seealso geo codelinkbbox_scal codelinkgeo_bb_matrix codelinkgeo_bb codelinkquadr conceptgeo gener roxygen edit hand pleas edit document rspatiallinesnetworkr nameslnpoint aliasslnpoint titlegener spatial point repres node spatiallinesnetwork sfnetwork usag slnpointssln argument itemslnth spatiallinesnetwork sfnetwork use descript gener spatial point repres node spatiallinesnetwork sfnetwork exampl dataroutes_fast rnet overlineroutes_fast attrib length sln spatiallinesnetworkrnet sln_node slnpointssln plotsln plotsln_nod add true seealso rnet codelinkspatiallinesnetwork codelinkcalc_catchment_sum codelinkcalc_catch codelinkcalc_moving_catch codelinkcalc_network_catch codelinkfind_network_nod codelinkgsect codelinkislin codelinklinelabel codelinkoverline_spati codelinkoverlin codelinkplotspatiallinesnetworkanymethod codelinkplotsfnetworkanymethod codelinkrnet_breakup_vertic codelinkrnet_group codelinksum_network_link codelinksum_network_rout conceptrnet gener roxygen edit hand pleas edit document rspatiallinesnetworkr nameplotspatiallinesnetworkanymethod aliasplotspatiallinesnetworkanymethod titleplot spatiallinesnetwork usag smethodplotspatiallinesnetworkanyx compon sl argument itemxth spatiallinesnetwork plot itemcomponentth compon network plot valid valu sl geograph spatiallin represent graph graph represent itemargu pass relev plot function descript plot spatiallinesnetwork exampl sln spatiallinesnetworkroute_network plotsln plotsln compon graph seealso rnet codelinkspatiallinesnetwork codelinkcalc_catchment_sum codelinkcalc_catch codelinkcalc_moving_catch codelinkcalc_network_catch codelinkfind_network_nod codelinkgsect codelinkislin codelinklinelabel codelinkoverline_spati codelinkoverlin codelinkplotsfnetworkanymethod codelinkrnet_breakup_vertic codelinkrnet_group codelinkslnpoint codelinksum_network_link codelinksum_network_rout conceptrnet gener roxygen edit hand pleas edit document rnodefunsr namernet_get_nod aliasrnet_get_nod titleextract node rout network usag rnet_get_nodesrnet p null argument itemrneta rout network type gener codeoverlin itempa point repres codesf object split coderout descript extract node rout network exampl rnet_get_nodesroute_network_sf gener roxygen edit hand pleas edit document rloadabsr nameread_table_build aliasread_table_build titleimport format australian bureau statist ab tablebuild file usag read_table_builderdataset filetyp csv sheet removetot true argument itemdataseteith datafram contain origin data tablebuild charact string contain path unzip tablebuild file itemfiletypea charact string contain filetyp valid valu csv legacycsv xlsx default csv requir even dataset datafram use legacycsv csv file deriv earlier version tablebuild csv output csv version xlsx file current csv output tablebuild follow standard csv format itemsheetan integ valu contain index sheet xlsx file default itemremovetotala boolean valu true remov row column total default true descript import format australian bureau statist ab tablebuild file sectiondetail australian bureau statist ab provid customis tabl censu dataset format difficult use r contain row addit inform function import origin unzip tablebuild file csv xlsx format creat r datafram data exampl data_dir systemfileextdata packag stplanr read_table_builderfilepathdata_dir sapopulationcsv requirenamespaceopenxlsx read_table_builderfilepathdata_dir sapopulationxlsx filetyp xlsx sheet removetot true f filepathdata_dir sapopulationcsv sapop readcsvf stringsasfactor true header fals read_table_buildersapop conceptdata gener roxygen edit hand pleas edit document rodfunsr namepointsodf aliaspointsodf titleconvert seri point datafram origin destin usag pointsodfp argument itempa spatial point object descript take seri geograph point convert datafram repres potenti flow spatial interact everi combin point exampl datac df pointsodfc cents_centroid rgeosgcentroidc byid true df pointsodfcents_centroid df pointsodfcents_sf seealso od codelinkdist_googl codelinkodlin codelinkododf codelinkod_aggregate_from codelinkod_aggregate_to codelinkod_coordslin codelinkod_coord codelinkod_dist codelinkod_id codelinkod_oneway codelinkod_to_odmatrix codelinkodmatrix_to_od codelinkpointsflow conceptod gener roxygen edit hand pleas edit document rutilspip name alia titlepip oper usag lh rh descript see codemagrittr detail keywordintern gener roxygen edit hand pleas edit document rodfunsr namelinerout aliaslinerout titleconvert straight od data desir line rout usag linerout l route_fun stplanrroute_cyclestreet n_print list_output fals l_id na time_delay argument itemla spatial linestr object itemroute_funa rout function use convert straight line rout codelinkodlineodlin itemn_printa number specifi frequent progress updat shown itemlist_outputif fals default assum spatial linestr object output set true save output list iteml_idcharact string name id field input line data typic origin destin id past togeth absent row name straight line use itemtime_delaynumb second wait queri itemargu pass rout function eg codelinkroute_cyclestreetsroute_cyclestreet descript convert straight od data desir line rout sectiondetail see codelinkroute_cyclestreetsroute_cyclestreet rout function detail parallel implement avail version exampl dontrun run requir api key l flowlin r lineroutel rq lineroutel l plan quietest silent true rsc lineroutel l route_fun cyclestreetsjourney plotr plotr col red add true plotrq col green add true plotrsc plotl add plot singl line compar fastest quietest rout n plotln linesrn col red linesrqn col green seealso rout codelinklinerouteretri codelinkroute_dodgr codelinkroute_loc codelinkroute_osrm codelinkroute_transportapi_publ codelinkrout conceptrout gener roxygen edit hand pleas edit document rdatar doctypedata namedestination_zon aliasdestination_zon aliasdestin aliasdestinations_sf titleexampl destin data format spatial dataset featur usag datadestination_zon descript dataset repres trip destin differ geograph level origin store object codec exampl dontrun dataset construct see httpscowzgeodatasotonacukdownload downloadfil httpscowzgeodatasotonacukdownloadfilescowz_ew__bfczip cowz_ew__bfczip unzipcowz_ew__bfczip wz rastershapefilecowz_ew__bfcshp to_remov listfilespattern cowz fullnam true recurs true fileremoveto_remov projstringwz wz spsptransformwz projstringzon destination_zon wzzone plotdestination_zon devtoolsuse_datadestination_zon headdestination_zonesdata destin rgeosgcentroiddestin byid true destin spspatialpointsdataframedestin destination_zonesdata devtoolsuse_datadestin overwrit true destinations_sf sfst_as_sfdestin devtoolsuse_datadestinations_sf seealso exampl data codelinkflow_dest codelinkflowlin codelinkflow codelinkroute_network codelinkroutes_fast codelinkroutes_slow conceptexampl data keyworddataset gener roxygen edit hand pleas edit document rspatiallinesnetworkr nameweightfield aliasweightfield aliasweightfield aliasweightfieldspatiallinesnetworkmethod aliasweightfieldsfnetworkmethod aliasweightfieldspatiallinesnetworkanymethod aliasweightfieldsfnetworkanymethod aliasweightfieldspatiallinesnetworkcharactermethod aliasweightfieldsfnetworkcharactermethod titleget set weight field spatiallinesnetwork usag weightfieldx weightfieldx varnam valu weightfieldx varnam valu smethodweightfieldspatiallinesnetworkx smethodweightfieldsfnetworkx smethodweightfieldspatiallinesnetworkanyx valu smethodweightfieldsfnetworkanyx valu smethodweightfieldspatiallinesnetworkcharacterx varnam valu smethodweightfieldsfnetworkcharacterx varnam valu argument itemxspatiallinesnetwork use itemvarnameth name variabl setus itemvalueeith name variabl use weight field datafram vector contain weight use codevarnam pass replac function datafram contain multipl column column name codevarnam use otherwis first column use descript get set valu weight field spatiallinesnetwork sectiondetail function manipul valu weightfield spatiallinesnetwork chang valu weightfield weight graph network updat valu correspond variabl exampl sp object dataroutes_fast rnet overlineroutes_fast attrib length sln spatiallinesnetworkrnet weightfieldsln length weightfieldsln randomnum sampl size nrowslnsl replac true dataroutes_fast_sf rnet overlineroutes_fast_sf attrib length sln spatiallinesnetworkrnet weightfieldsln length slnslrandomnum sampl size nrowslnsl replac true weightfieldsln randomnum todo show differ make gener roxygen edit hand pleas edit document rnodefunsr nameroute_split_id aliasroute_split_id titlesplit rout base id coordin one vertic usag route_split_idr id null p null argument itemran codesf object one featur contain linestr geometri split itemidth index point number split itempa point repres codesf object split coderout descript split rout base id coordin one vertic exampl sample_rout routes_fast_sf r sample_rout id roundn_verticesr r_split route_split_idr id id plotrgeometri lwd col grey plotr_split col cred blue add true gener roxygen edit hand pleas edit document rdatar doctypedata nameod_data_lin aliasod_data_lin titleexampl desir line represent origindestin data uk censu format data frame tibbl object descript deriv codeod_data_sampl show movement point repres codecents_sf exampl od_data_lin keyworddataset gener roxygen edit hand pleas edit document rroute_funsr nameroute_average_gradi aliasroute_average_gradi titlereturn averag gradient across rout usag route_average_gradientelev distanc argument itemelevationselev eg provid codecyclestreet packag itemdistancesdist eg provid codecyclestreet packag descript function assum elev distanc unit exampl r od_data_routesod_data_routesroute_numb elev relev distanc rdistanc route_average_gradientelev distanc averag gradient seealso route_fun codelinkroute_rolling_averag codelinkroute_rolling_diff codelinkroute_rolling_gradi codelinkroute_sequential_dist codelinkroute_slope_matrix codelinkroute_slope_vector conceptroute_fun gener roxygen edit hand pleas edit document rdatar doctypedata namernet_roundabout aliasrnet_roundabout titleexampl roundabout data show problem spatiallinesnetwork object format sf object descript see codedatarawrnet_roundaboutr detail creat exampl rnet_roundabout keyworddataset gener roxygen edit hand pleas edit document rdatar doctypedata nameca_loc aliasca_loc titlespatialpointsdatafram repres road traffic death format spatialpointsdatafram row column usag dataca_loc descript dataset repres type data download clean use stplanr function repres small sampl variabl strip open data uk stat dataset keyworddataset gener roxygen edit hand pleas edit document rcatchmentarear namecalc_catchment_sum aliascalc_catchment_sum titlecalcul summari statist catchment area usag calc_catchment_sum polygonlay targetlay calccol distanc project pasteprojaea lat_ lat_ lat_ lon_ x_ y_ ellpsgr towg unitsm no_def retainareaproport fals quadseg na argument itempolygonlayera spatialpolygonsdatafram contain zone summari statist catchment variabl calcul smaller polygon increas accuraci result itemtargetlayera spatialpolygonsdatafram spatiallinesdatafram spatialpointsdatafram spatialpolygon spatiallin spatialpoint object contain specif facil catchment area calcul object contain one facil eg multipl cycl path aggreg catchment area calcul itemcalccolsa vector column name contain variabl polygonlay use calcul summari statist catchment area itemdistancedefin size catchment area distanc around targetlay unit project default metr itemprojectionth projstr use defin project use calcul catchment area charact string austalb use australian alber equal area project ignor polygonlay project case targetlay convert project use polygonlay case result object reproject origin coordin system project polygon layer default alber equal area project reliabl result use local project eg australian alber equal area project itemretainareaproportionboolean valu true retain variabl result spatialpolygonsdatafram contain proport origin area within catchment area default fals itemquadsegsnumb line segment use approxim quarter circl paramet pass buffer function default sp sf descript calcul summari statist catchment area sectiondetail calcul summari statist catchment area facil eg cycl path use straightlin distanc variabl avail spatialpolygonsdatafram censu tract zone assum frequenc variabl evenli distribut throughout zone return either singl valu calccol length name vector otherwis exampl dontrun data_dir systemfileextdata packag stplanr unzipfilepathdata_dir smallsazip unzipfilepathdata_dir testcyclewayzip saincom rgdalreadogr smallsa testcycleway rgdalreadogr testcycleway calc_catchment_sum polygonlay saincom targetlay testcycleway calccol ctotal distanc project austalb calc_catchment_sum polygonlay saincom targetlay testcycleway calccol ctotal distanc project austalb seealso rnet codelinkspatiallinesnetwork codelinkcalc_catch codelinkcalc_moving_catch codelinkcalc_network_catch codelinkfind_network_nod codelinkgsect codelinkislin codelinklinelabel codelinkoverline_spati codelinkoverlin codelinkplotspatiallinesnetworkanymethod codelinkplotsfnetworkanymethod codelinkrnet_breakup_vertic codelinkrnet_group codelinkslnpoint codelinksum_network_link codelinksum_network_rout conceptrnet gener roxygen edit hand pleas edit document rgooglefunctionsr namenearest_googl aliasnearest_googl titlegener nearest point rout network point use googl map api usag nearest_googlelat lng google_api argument itemlatnumer vector contain latitud coordin coordin map also accept datafram latitud first column longitud second column itemlngnumer vector contain longitud coordin coordin map itemgoogle_apistr valu contain googl api key use descript gener nearest point rout network point use googl map api sectiondetail retriev coordin node network map coordin pass function exampl dontrun nearest_googlelat lng google_api api_key_her seealso node codelinkgeo_cod conceptnod gener roxygen edit hand pleas edit document rnodefunsr nameroute_split aliasroute_split titlesplit rout two point near network usag route_splitr p argument itemran codesf object one featur contain linestr geometri split itempa point repres codesf object split coderout valu sf object featur descript split rout two point near network exampl sample_rout routes_fast_sf null r sample_rout p sfst_sfcsfst_pointc cr sfst_crsr plotrgeometri lwd col grey plotp add true r_split route_splitr p plotr_split col cred blue add true gener roxygen edit hand pleas edit document rsloper nameroute_slope_matrix aliasroute_slope_matrix titlecalcul gradient line segment matrix coordin usag route_slope_matrixm e lonlat true argument itemmmatrix contain coordin elev itemeelev unit x assum metr itemlonlatar coordin lonlat order codetru default descript calcul gradient line segment matrix coordin exampl x c c z c cbindx z plotx z ylim c type l gx route_slope_vectorx z gxi route_slope_matrixm lonlat fals ablineh lti pointsxlengthx gx col red pointsxlengthx gxi col blue titledist x coordin elev profil sub point show calcul gradient subsequ line seealso route_fun codelinkroute_average_gradi codelinkroute_rolling_averag codelinkroute_rolling_diff codelinkroute_rolling_gradi codelinkroute_sequential_dist codelinkroute_slope_vector conceptroute_fun gener roxygen edit hand pleas edit document rrnet_boundary_pointsr namernet_boundary_point aliasrnet_boundary_point aliasrnet_boundary_df aliasrnet_boundary_uniqu aliasrnet_boundary_points_lwgeom aliasrnet_duplicated_vertic titleget point beginn end linestr usag rnet_boundary_pointsrnet rnet_boundary_dfrnet rnet_boundary_uniquernet rnet_boundary_points_lwgeomrnet rnet_duplicated_verticesrnet n argument itemrnetan sf sfc object linestr geometri repres rout network itemnth minimum number time vertex must duplic return descript get point beginn end linestr exampl has_sfhead requirenamespacesfhead quietli true ifhas_sfhead rnet rnet_roundabout bp rnet_boundary_pointsrnet bp linepointsrnet slower version lwgeom bp rnet_boundary_points_lwgeomrnet slower version lwgeom bp rnet_boundary_uniquernet nrowbp nrowbp identicalsortsfst_coordinatesbp sortsfst_coordinatesbp identicalsortsfst_coordinatesbp sortsfst_coordinatesbp plotrnetgeometri plotbp add true gener roxygen edit hand pleas edit document rtoptailr nametoptailg aliastoptailg titleclip first last n metr spatiallin usag toptailgsl toptail_dist tail_dist null argument itemla spatiallin object itemtoptail_distth distanc metr top line either singl valu vector length spatiallin object tail_dist miss use tail distanc itemtail_distth distanc metr tail line either singl valu vector length spatiallin object descript take line remov start end point distanc determin user use geospheredisthaversin function requir coordin wg lnglat exampl dataroutes_fast rf routes_fast r_toptail toptailgsrf toptail_dist plotrf lwd plotr_toptail col red add true plotcent add true seealso line codelinkangle_diff codelinkgeo_toptail codelinkis_linepoint codelinklinedf codelinklinepoint codelinkline_bear codelinkline_breakup codelinkline_midpoint codelinkline_sampl codelinkline_seg codelinkline_via codelinkmatslin codelinkn_sample_length codelinkn_vertic codelinkonewaygeo codelinkpointslin codelinktoptail_buff codelinkupdate_line_geometri conceptlin gener roxygen edit hand pleas edit document rline_viar nameline_via aliasline_via titleadd geometri column repres rout via intermediari point usag line_vi p argument itemla spatial line object itempa spatial point object descript take origin destin b repres linestr codel gener extra geometri base point codep detail enumer item p p nearest point item p p p nearest point b item p b exampl librarysf l flowlines_sf p destinations_sf lv line_vi p lv librarymapview mapviewlv mapviewlvleg_orig col red plotlv lwd reset fals plotlvleg_orig col red lwd add true plotlvleg_via col black add true plotlvleg_dest col green lwd add true seealso line codelinkangle_diff codelinkgeo_toptail codelinkis_linepoint codelinklinedf codelinklinepoint codelinkline_bear codelinkline_breakup codelinkline_midpoint codelinkline_sampl codelinkline_seg codelinkmatslin codelinkn_sample_length codelinkn_vertic codelinkonewaygeo codelinkpointslin codelinktoptail_buff codelinktoptailg codelinkupdate_line_geometri conceptlin gener roxygen edit hand pleas edit document rspatiallinesnetworkr namesummarysfnetworkmethod aliassummarysfnetworkmethod titleprint summari sfnetwork usag smethodsummarysfnetworkobject argument itemobjectth sfnetwork itemargu pass relev summari function descript print summari sfnetwork exampl dataroutes_fast rnet overlineroutes_fast attrib length sln spatiallinesnetworkrnet summarysln gener roxygen edit hand pleas edit document rdatar doctypedata namernet_cycleway_intersect aliasrnet_cycleway_intersect titleexampl cycleway intersect data show problem spatiallinesnetwork object format sf object descript see codedatarawrnet_cycleway_intersect detail creat exampl rnet_cycleway_intersect keyworddataset gener roxygen edit hand pleas edit document roverlin nameislin aliasislin titledo intersect two geometri creat line usag islinesg g argument itemga spatial object itemga spatial object descript function requir codelinkoverlineoverlin identifi whether set line overlap beyond share point exampl dontrun rnet overlineroutes_fastc attrib length plotrnet linesroutes_fast col red line without overlap islinesroutes_fast routes_fast islinesroutes_fast routes_fast sf implement islinesroutes_fast_sf routes_fast_sf islinesroutes_fast_sf routes_fast_sf seealso rnet codelinkspatiallinesnetwork codelinkcalc_catchment_sum codelinkcalc_catch codelinkcalc_moving_catch codelinkcalc_network_catch codelinkfind_network_nod codelinkgsect codelinklinelabel codelinkoverline_spati codelinkoverlin codelinkplotspatiallinesnetworkanymethod codelinkplotsfnetworkanymethod codelinkrnet_breakup_vertic codelinkrnet_group codelinkslnpoint codelinksum_network_link codelinksum_network_rout conceptrnet gener roxygen edit hand pleas edit document rcyclestreetsr namenearest_cyclestreet aliasnearest_cyclestreet titlegener nearest point rout network point use cyclestreetsnet usag nearest_cyclestreetsshp null lat lng pat api_patcyclestreet argument itemshpa spatial object itemlatnumer vector contain latitud coordin coordin map also accept datafram latitud first column longitud second column itemlngnumer vector contain longitud coordin coordin map itempatth api key use default set null usual aquir automat helper api_pat descript gener nearest point rout network point use cyclestreetsnet sectiondetail retriev coordin node network map coordin pass function note dedic cyclestreet packag httpsgithubcomrobinlovelacecyclestreet exampl dontrun nearest_cyclestreet pat sysgetenvcyclestreet nearest_cyclestreetsc pat sysgetenvcyclestreet nearest_cyclestreetscents_sf pat sysgetenvcyclestreet gener roxygen edit hand pleas edit document rgeofunctionsr namegeo_bb aliasgeo_bb aliasbbpoli titleflex function gener bound box usag geo_bb shp scale_factor distanc output cpolygon point bb argument itemshpspati object sf sp packag itemscale_factornumer vector determin much bound box grow shrink two number refer extend bound box x dimens respect valu output size input itemdistancedist metr extend bound box itemoutputtyp object return polygon default descript take geograph object bound box input output bound box repres bound box corner point rectangular polygon exampl simpl featur implement shp routes_fast_sf shp_bb geo_bbshp distanc plotshp_bb col red reset fals plotgeo_bbroutes_fast_sf scale_factor col green add true plotgeo_bbroutes_fast_sf output point add true plotroutes_fast_sfgeometri add true seealso bb_scale geo codelinkbbox_scal codelinkgeo_bb_matrix codelinkquadr codelinkreproject conceptgeo gener roxygen edit hand pleas edit document rstplanrpackag doctypepackag namestplanrpackag aliasstplanrpackag aliasstplanr titlestrongstplanr sustain transport plan r descript stplanr packag provid function access analys data transport research includ origindestin analysi rout alloc model travel pattern sectioninterest function item item codelinkoverlineoverlin aggreg overlay rout line data intellig item codelinkcalc_catchmentcalc_catch creat catchment area show area serv destin item codelinkroute_cyclestreetsroute_cyclestreet find fastest rout cyclist two place seealso urlhttpsgithubcomropenscistplanr author robin lovelac emailrobxgmailcom keywordpackag gener roxygen edit hand pleas edit document rodfunsr nameod_coord aliasod_coord titlecr matric repres origindestin coordin usag od_coordsfrom null null l null argument itemfroman object repres origin line provid first argument assign codel itemtoan object repres destin itemlonli need empti case spatial object repres desir line descript function take wide rang input data type spatial line point text string return matrix coordin repres origin fx fy destin tx ty point exampl od_coordsfrom c c lonlat coordin od_coordsfrom cent cent spatial point od_coordscents_sf cents_sf sf point od_coordshereford leed geocod locat od_coordsflowlin od_coordsflowlines_sf seealso od codelinkdist_googl codelinkodlin codelinkododf codelinkod_aggregate_from codelinkod_aggregate_to codelinkod_coordslin codelinkod_dist codelinkod_id codelinkod_oneway codelinkod_to_odmatrix codelinkodmatrix_to_od codelinkpointsflow codelinkpointsodf conceptod gener roxygen edit hand pleas edit document rdatar doctypedata nameflow aliasflow titledata frame commut flow format data frame row column usag dataflow descript dataset repres commut flow work travel origin destin zone see codelinkcentsc data uk avail open data urlhttpswicidukdataserviceacuk detail variabl follow item item areaofresid id origin zone item areaofworkplac id destin zone item travel work flow mode item verb flow differ mode item id uniqu id flow although variabl name uniqu uk data data structur generalis typic flow data sourc key variabl origin destin id link codec georeferenc spatial object exampl dontrun dataset construct see httpsgithubcomnpctpct download repo flow readrdsrepospctpctdatanationalflowrd datac flowareaofresid centsgeo_cod flowareaofworkplac centsgeo_cod flow flowo subset flow studi area librarydevtool flowid pasteflowareaofresid flowareaofworkplac use_dataflow overwrit true convert flow spatial line dataset flowlin odlineflow flow zone cent use_dataflowlin overwrit true convert flow rout routes_fast lineroutel flowlin plan fastest routes_slow lineroutel flowlin plan quietest use_dataroutes_fast use_dataroutes_slow routes_fast_sf sfst_as_sfroutes_fast routes_slow_sf sfst_as_sfroutes_slow seealso exampl data codelinkdestination_zon codelinkflow_dest codelinkflowlin codelinkroute_network codelinkroutes_fast codelinkroutes_slow conceptexampl data keyworddataset gener roxygen edit hand pleas edit document rsloper nameroute_slope_vector aliasroute_slope_vector titlecalcul gradient line segment distanc elev vector usag route_slope_vectorx e argument itemxvector locat itemeelev unit x assum metr descript calcul gradient line segment distanc elev vector exampl x c e c route_slope_vectorx e seealso route_fun codelinkroute_average_gradi codelinkroute_rolling_averag codelinkroute_rolling_diff codelinkroute_rolling_gradi codelinkroute_sequential_dist codelinkroute_slope_matrix conceptroute_fun gener roxygen edit hand pleas edit document roverlin namegsect aliasgsect titlefunct split overlap spatiallin segment usag gsectionsl buff_dist argument itemslspatiallinesdatafram overlap line split number overlap featur itembuff_dista number specifi distanc meter buffer use crop line run oper distanc zero default touch nonoverlap line may aggreg descript divid spatiallinesdatafram object separ line new line object aggreg singl number aggreg line exampl lib_vers sfsf_extsoftvers lib_vers fail system earli version proj lib_vers sl routes_fast_sf rsec gsectionsl lengthrsec section plotrsec col seqlengthrsec rsec gsectionsl buff_dist lengthrsec featur issu plotrsec col seqlengthrsec dont test due issu sp class setup sl routes_fast rsec gsectionsl rsec_buff gsectionsl buff_dist plotsl lwd col nrowsl plotrsec col lengthrsec add true lwd plotrsec_buff col lengthrsec_buff add true lwd seealso rnet codelinkspatiallinesnetwork codelinkcalc_catchment_sum codelinkcalc_catch codelinkcalc_moving_catch codelinkcalc_network_catch codelinkfind_network_nod codelinkislin codelinklinelabel codelinkoverline_spati codelinkoverlin codelinkplotspatiallinesnetworkanymethod codelinkplotsfnetworkanymethod codelinkrnet_breakup_vertic codelinkrnet_group codelinkslnpoint codelinksum_network_link codelinksum_network_rout conceptrnet gener roxygen edit hand pleas edit document rodfunsr nameupdate_line_geometri aliasupdate_line_geometri titleupd line geometri usag update_line_geometryl nl argument itemla spatiallin object whose geometri modifi itemnla spatiallin object length codel provid new geometri descript take two spatiallin object updat geometri former latter retain data former exampl dataflowlin l flowlin nl routes_fast nrowl nrownl l lis_linepointl namesl namesroutes_fast l_newgeom update_line_geometryl nl plotl lwd lall meanlal plotl_newgeom lwd lall meanlal namesl_newgeom seealso line codelinkangle_diff codelinkgeo_toptail codelinkis_linepoint codelinklinedf codelinklinepoint codelinkline_bear codelinkline_breakup codelinkline_midpoint codelinkline_sampl codelinkline_seg codelinkline_via codelinkmatslin codelinkn_sample_length codelinkn_vertic codelinkonewaygeo codelinkpointslin codelinktoptail_buff codelinktoptailg conceptlin gener roxygen edit hand pleas edit document rroute_localr nameroute_loc aliasroute_loc titleplan rout local data usag route_localsln l null argument itemslnth spatiallinesnetwork sfnetwork use itemfroman object repres origin line provid first argument assign codel itemtoan object repres destin itemlonli need empti case spatial object repres desir line itemargu pass codesum_network_link descript function return shortest path locat near segement codespatiallinesnetwork exampl c c sln spatiallinesnetworkroute_network_sf r route_localsln plotsln plotrgeometri add true col red lwd plotcentsc add true r route_localsln sln cents_sf cents_sf plotrgeometri add true col blue lwd l flowlines_sf r route_local l sln sln plotrgeometri add true col blue lwd seealso rout codelinklinerouteretri codelinklinerout codelinkroute_dodgr codelinkroute_osrm codelinkroute_transportapi_publ codelinkrout conceptrout gener roxygen edit hand pleas edit document rodfunsr namelinedf aliaslinedf titleconvert geograph line object datafram coord usag linedfl argument itemla spatial line object descript function return data frame fx fy tx ty variabl repres begin end point spatial line featur respect exampl dataflowlin linedfflowlin begin end singl straight line linedfflowlin multipl line linedfroutes_fast begin end rout linedfroutes_fast_sf begin end rout seealso line codelinkangle_diff codelinkgeo_toptail codelinkis_linepoint codelinklinepoint codelinkline_bear codelinkline_breakup codelinkline_midpoint codelinkline_sampl codelinkline_seg codelinkline_via codelinkmatslin codelinkn_sample_length codelinkn_vertic codelinkonewaygeo codelinkpointslin codelinktoptail_buff codelinktoptailg codelinkupdate_line_geometri conceptlin gener roxygen edit hand pleas edit document rdatar doctypedata nameod_data_sampl aliasod_data_sampl titleexampl origindestin data uk censu format data frame tibbl object descript see codedatarawgeneratedatarmd detail creat exampl od_data_sampl keyworddataset gener roxygen edit hand pleas edit document rdatar doctypedata nameflow_dest aliasflow_dest titledata frame invent commut flow destin differ layer origin format data frame row column usag dataflow_dest descript data frame invent commut flow destin differ layer origin exampl dontrun dataset construct flow_dest flow flow_destsareaofworkplac samplex destinationswzcd size nrowflow flow_dest dplyrrenameflow_dest wzcd areaofworkplac devtoolsuse_dataflow_dest seealso exampl data codelinkdestination_zon codelinkflowlin codelinkflow codelinkroute_network codelinkroutes_fast codelinkroutes_slow conceptexampl data keyworddataset gener roxygen edit hand pleas edit document ronewayr nameod_id aliasod_id aliasod_id_szudzik aliasod_id_max_min aliasod_id_charact titlecombin two id valu creat singl id number usag od_id_szudzikx ordermatt fals od_id_max_minx od_id_characterx argument itemxa vector numer charact factor valu itemya vector numer charact factor valu itemordermatterslog order valu matter pair default fals descript combin two id valu creat singl id number detail od data common mani oneway flow b b use group singl id repres pair id without direction contain twoway bidirect valu verbod_id function take two vector equal length return vector id uniqu combin twoway flow item item szudzik pair function two vector equal length return vector id number function superse od_id_ord faster larg dataset exampl od_data_sampl id od_id_characterd duplicatedid od_id_szudzikd od_id_max_mind seealso od_oneway od codelinkdist_googl codelinkodlin codelinkododf codelinkod_aggregate_from codelinkod_aggregate_to codelinkod_coordslin codelinkod_coord codelinkod_dist codelinkod_oneway codelinkod_to_odmatrix codelinkodmatrix_to_od codelinkpointsflow codelinkpointsodf conceptod gener roxygen edit hand pleas edit document rtoptailr namegeo_toptail aliasgeo_toptail aliastoptail titleclip first last n metr spatiallin usag geo_toptail toptail_dist argument itemla spatiallin object itemtoptail_distth distanc metr top tail line either singl valu vector length spatiallin object itemargu pass rgeosgbuff descript take line remov start end point distanc determin user detail note codelinktoptailgstoptailg around time faster work data geograph crss due relianc geospher packag exampl lib_vers sfsf_extsoftvers lib_vers dont test due issu sp class setup lib_vers l routes_fast run sp class l routes_fast_sf l_top_tail geo_toptail l_top_tail plotsfst_geometryl_top_tail plotsfst_geometrygeo_toptail lwd add true seealso line codelinkangle_diff codelinkis_linepoint codelinklinedf codelinklinepoint codelinkline_bear codelinkline_breakup codelinkline_midpoint codelinkline_sampl codelinkline_seg codelinkline_via codelinkmatslin codelinkn_sample_length codelinkn_vertic codelinkonewaygeo codelinkpointslin codelinktoptail_buff codelinktoptailg codelinkupdate_line_geometri conceptlin gener roxygen edit hand pleas edit document rdatar doctypedata nameflowlin aliasflowlin aliasflowlines_sf titlespati line dataset commut flow format spatial line dataset row column descript flow data convers spatial format codelinkodlineodlin see codelinkflowflow seealso exampl data codelinkdestination_zon codelinkflow_dest codelinkflow codelinkroute_network codelinkroutes_fast codelinkroutes_slow conceptexampl data keyworddataset gener roxygen edit hand pleas edit document rspatiallinesnetworkr namesln_clean_graph aliassln_clean_graph titleclean spatial network return sln singl connect graph usag sln_clean_graphsln argument itemslna spatial line codesfnetwork object creat codespatiallinesnetwork valu sfnetwork object descript see httpsgithubcomropenscistplanrissu gener roxygen edit hand pleas edit document rline_viar namematslin aliasmatslin titleconvert matric line usag matslinemat mat cr na argument itemmatmatrix repres origin itemmatmatrix repres destin itemcrsnumb repres coordin system data eg descript convert matric line exampl matrixc ncol matrixc ncol l matslinem classl l lsf sfst_sfl cr classlsf plotlsf mapviewmapviewlsf seealso line codelinkangle_diff codelinkgeo_toptail codelinkis_linepoint codelinklinedf codelinklinepoint codelinkline_bear codelinkline_breakup codelinkline_midpoint codelinkline_sampl codelinkline_seg codelinkline_via codelinkn_sample_length codelinkn_vertic codelinkonewaygeo codelinkpointslin codelinktoptail_buff codelinktoptailg codelinkupdate_line_geometri conceptlin gener roxygen edit hand pleas edit document rlinefunsr nameline_bear aliasline_bear titlefind bear straight line usag line_bearingl bidirect fals argument itemla spatial line object itembidirectionalshould result return bidirect format default fals true line oposit direct would bear descript simpl wrapper around geospher function codelinkbearingbear return bear degre rel north line detail return boolean vector true mean associ line fact point distanc use remov data plot exampl lib_vers sfsf_extsoftvers lib_vers fail system earli version proj lib_vers bearings_sf__ line_bearingflowlines_sf bearings_sf__ line length nan bear bearings_sp__ line_bearingflowlin bearings_sp__ plotbearings_sf__ bearings_sp__ line_bearingflowlines_sf bidirect true line_bearingflowlin bidirect true seealso line codelinkangle_diff codelinkgeo_toptail codelinkis_linepoint codelinklinedf codelinklinepoint codelinkline_breakup codelinkline_midpoint codelinkline_sampl codelinkline_seg codelinkline_via codelinkmatslin codelinkn_sample_length codelinkn_vertic codelinkonewaygeo codelinkpointslin codelinktoptail_buff codelinktoptailg codelinkupdate_line_geometri conceptlin gener roxygen edit hand pleas edit document rspatiallinesnetworkr nameplotsfnetworkanymethod aliasplotsfnetworkanymethod titleplot sfnetwork usag smethodplotsfnetworkanyx compon sl argument itemxth sfnetwork plot itemcomponentth compon network plot valid valu sl geograph sf represent graph graph represent itemargu pass relev plot function descript plot sfnetwork exampl sln_sf spatiallinesnetworkroute_network_sf plotsln_sf seealso rnet codelinkspatiallinesnetwork codelinkcalc_catchment_sum codelinkcalc_catch codelinkcalc_moving_catch codelinkcalc_network_catch codelinkfind_network_nod codelinkgsect codelinkislin codelinklinelabel codelinkoverline_spati codelinkoverlin codelinkplotspatiallinesnetworkanymethod codelinkrnet_breakup_vertic codelinkrnet_group codelinkslnpoint codelinksum_network_link codelinksum_network_rout conceptrnet gener roxygen edit hand pleas edit document rlinefunsr namen_vertic aliasn_vertic titleretriev number vertic spatiallin spatialpolygon object usag n_verticesl argument itemla spatiallin spatalpolygon object descript return vector length number line number vertic per line polygon detail see urlhttpsgisstackexchangecomquest inform exampl n_verticesroutes_fast n_verticesroutes_fast_sf seealso line codelinkangle_diff codelinkgeo_toptail codelinkis_linepoint codelinklinedf codelinklinepoint codelinkline_bear codelinkline_breakup codelinkline_midpoint codelinkline_sampl codelinkline_seg codelinkline_via codelinkmatslin codelinkn_sample_length codelinkonewaygeo codelinkpointslin codelinktoptail_buff codelinktoptailg codelinkupdate_line_geometri conceptlin gener roxygen edit hand pleas edit document rgeofunctionsr namewritegeojson aliaswritegeojson titlewrit geojson easili usag writegeojsonshp filenam argument itemshpspati data object itemfilenamefil name output geojson descript provid userfriendli wrapper codesfst_writ note codegeojson_writ geojsonio packag provid function urlhttpsgithubcomropenscigeojsonio gener roxygen edit hand pleas edit document rdatar doctypedata nameosm_net_exampl aliasosm_net_exampl titleexampl openstreetmap road network format sf object descript exampl openstreetmap road network exampl osm_net_exampl keyworddataset gener roxygen edit hand pleas edit document rgeofunctionsr namegeo_bb_matrix aliasgeo_bb_matrix titlecr matrix repres spatial bound object usag geo_bb_matrixshp argument itemshpspati object sf sp packag descript convert rang spatial data format matrix repres bound box exampl geo_bb_matrixroutes_fast geo_bb_matrixroutes_fast_sf geo_bb_matrixc geo_bb_matrixc geo_bb_matrixsfst_coordinatescents_sf seealso geo codelinkbbox_scal codelinkgeo_bb codelinkquadr codelinkreproject conceptgeo gener roxygen edit hand pleas edit document rodfunsr namepointslin aliaspointslin titleconvert seri point matrix coordin line usag pointslinep argument itempa spatial point obect matrix repres coordin point descript simpl wrapper around codelinksplinessplin make creation codespatiallin object easi intuit exampl p matrix ncol librarysp l pointslinep plotl l pointslinec plotl p linepointsroutes_fast l pointslinep plotl l_sf pointslinecents_sf plotl_sf seealso line codelinkangle_diff codelinkgeo_toptail codelinkis_linepoint codelinklinedf codelinklinepoint codelinkline_bear codelinkline_breakup codelinkline_midpoint codelinkline_sampl codelinkline_seg codelinkline_via codelinkmatslin codelinkn_sample_length codelinkn_vertic codelinkonewaygeo codelinktoptail_buff codelinktoptailg codelinkupdate_line_geometri conceptlin gener roxygen edit hand pleas edit document rnodefunsr nameroute_nearest_point aliasroute_nearest_point titlefind nearest rout given point usag route_nearest_pointr p id_out fals argument itemrth input rout object nearest rout found itempth point whose nearest rout found itemid_outshould index match featur return codefals default descript function written dropin replac codesfst_nearest_featur work recent version geo exampl r routes_fast_sf null p sfst_sfcsfst_pointc cr sfst_crsr route_nearest_pointr p id_out true r_nearest route_nearest_pointr p plotrgeometri plotp add true plotr_nearest lwd add true gener roxygen edit hand pleas edit document ronewayr nameod_id_ord aliasod_id_ord titlegener order id od pair lowest alway first function slow larg dataset see szudzik_pair faster altern usag od_id_orderx id namesx id namesx argument itemxa data frame spatiallinesdatafram repres od matrix itemidopt assum first column text string refer name variabl contain uniqu id origin itemidopt assum second column text string refer name variabl contain uniqu id destin descript gener order id od pair lowest alway first function slow larg dataset see szudzik_pair faster altern exampl x dataframeid c id c od_id_orderx th line switch id id stplanrkey order gener roxygen edit hand pleas edit document rdatar doctypedata namernet_overpass aliasrnet_overpass titleexampl overpass data show problem spatiallinesnetwork object format sf object descript see codedatarawrnet_overpassr detail creat exampl rnet_overpass keyworddataset gener roxygen edit hand pleas edit document rlinefunsr nameangle_diff aliasangle_diff titlecalcul angular differ line predefin bear usag angle_diffl angl bidirect fals absolut true argument itemla spatial line object itemanglean angl degre rel north east west direct rotat ignor itembidirectionalshould result return bidirect format default fals true line oposit direct would bear itemabsoluteif true default posit valu return descript function design find line close parallel perpendicular predefin rout return result absolut contain inform direct turn ie valu clockwiseanticlockwis bidirect mean valu greater imposs detail build convent use codelinkbearingbear mani applic north defini east west exampl lib_vers sfsf_extsoftvers lib_vers fail system earli version proj lib_vers find rout go northsouth lines_sf odlineod_data_sampl zone zones_sf angle_difflines_sf angl angle_difflines_sf angl angle_diffflowlin angl bidirect true absolut true plotflowlin plotflowlinesa add true lwd col red eastwest plotflowlinesa add true lwd col green seealso line codelinkgeo_toptail codelinkis_linepoint codelinklinedf codelinklinepoint codelinkline_bear codelinkline_breakup codelinkline_midpoint codelinkline_sampl codelinkline_seg codelinkline_via codelinkmatslin codelinkn_sample_length codelinkn_vertic codelinkonewaygeo codelinkpointslin codelinktoptail_buff codelinktoptailg codelinkupdate_line_geometri conceptlin gener roxygen edit hand pleas edit document roverlin nameonewaygeo aliasonewaygeo titleaggreg flow becom nondirect geometri slow way usag onewaygeox attrib argument itemxa dataset contain linestr geometri itemattriba text string contain name line attribut aggreg numer vector column aggreg valu codeonewaygeo output spatiallinesdatafram singl line userselect attribut valu aggreg line distanc ie intrazon flow includ descript flow data often contain movement two direct point point b b problemat transport plan magnitud flow along rout mask flow direct largest flow either direct captur analysi exampl true extent travel heavili underestim od pair similar amount travel direct flow direct often repres overlap line ident geometri see codelinkflowlinesflowlin confus user difficult plot detail function aggreg direct flow nondirect flow potenti halv number line object reduc number overlap line zero exampl plotflowlin lwd flowlinesonfoot singlin onewaygeoflowlin attrib whichnamesflowlin onfoot plotsinglin lwd singlinesonfoot col red add true dontrun plotflowlin lwd flowlinesal singlelin onewaygeoflowlin attrib plotsinglelin lwd singlelinesal col red add true sumsinglelinesal sumflowlinesal nrowsinglelin singlelines_sf onewaygeoflowlines_sf attrib sumsinglelines_sfal sumflowlines_sfal summarysinglelinesal singlelines_sfal seealso line codelinkangle_diff codelinkgeo_toptail codelinkis_linepoint codelinklinedf codelinklinepoint codelinkline_bear codelinkline_breakup codelinkline_midpoint codelinkline_sampl codelinkline_seg codelinkline_via codelinkmatslin codelinkn_sample_length codelinkn_vertic codelinkpointslin codelinktoptail_buff codelinktoptailg codelinkupdate_line_geometri conceptlin gener roxygen edit hand pleas edit document rroute_osrmr nameroute_osrm aliasroute_osrm titleplan rout transport network use osrm server usag route_osrm osrmserv httpsroutingopenstreetmapd osrmprofil foot argument itemfroman object repres origin line provid first argument assign codel itemtoan object repres destin itemosrmserverth base url rout server getoptionosrmserv default itemosrmprofileth rout profil use eg car bike foot use routingopenstreetmapd test server getoptionosrmprofil default itemprofilewhich rout profil use one foot default bike car default open server descript function simplifi use geojson binari polylin format slower r interfac osrm rout servic compar excel codelinkosrmosrmrouteosrmosrmrout function use via codelinkrouterout function exampl donttest l od_data_lin lm od_coordsl lm lm ifcurlhas_internet r_foot route_osrmfrom r_bike route_osrmfrom osrmprofil bike r_car route_osrmfrom osrmprofil car plotr_footgeometri lwd col grey plotr_bik col blue add true plotr_car col red add true seealso rout codelinklinerouteretri codelinklinerout codelinkroute_dodgr codelinkroute_loc codelinkroute_transportapi_publ codelinkrout conceptrout gener roxygen edit hand pleas edit document rdeprecatedr namestplanrdeprec aliasstplanrdeprec titledeprec function stplanr descript function depreci remov gener roxygen edit hand pleas edit document rlinefunsr nameline_seg aliasline_seg titledivid spatiallin dataset regular segment usag line_segmentl n_segment segment_length na argument itemla spatial line object itemn_segmentsth number segment divid line itemsegment_lengthth approxim length segment output overid n_segment set descript divid spatiallin dataset regular segment exampl dataroutes_fast l routes_fast librarysp l_seg line_segmentl l n_segment plotl_seg col l_seggroup lwd seealso line codelinkangle_diff codelinkgeo_toptail codelinkis_linepoint codelinklinedf codelinklinepoint codelinkline_bear codelinkline_breakup codelinkline_midpoint codelinkline_sampl codelinkline_via codelinkmatslin codelinkn_sample_length codelinkn_vertic codelinkonewaygeo codelinkpointslin codelinktoptail_buff codelinktoptailg codelinkupdate_line_geometri conceptlin gener roxygen edit hand pleas edit document rdatar doctypedata nameroutes_fast aliasroutes_fast aliasroutes_fast_sf titlespati line dataset commut flow travel network format spatial line dataset row column usag dataroutes_fast descript simul travel rout alloc transport network repres fastest codelinkcentsc object codelinkodlineodlin see codelinkflowflow seealso exampl data codelinkdestination_zon codelinkflow_dest codelinkflowlin codelinkflow codelinkroute_network codelinkroutes_slow conceptexampl data keyworddataset gener roxygen edit hand pleas edit document rlinefunsr nameis_linepoint aliasis_linepoint titleidentifi line point usag is_linepointl argument itemla spatial line object descript od matric often contain intrazon flow origin point destin function help identifi intrazon od pair use criteria total number vertic fewer whether origin destin detail return boolean vector true mean associ line fact point distanc use remov data plot exampl dataflowlin islp is_linepointflowlin nrowflowlin sumislp remov invis linepoint nrowflowlinesislp seealso line codelinkangle_diff codelinkgeo_toptail codelinklinedf codelinklinepoint codelinkline_bear codelinkline_breakup codelinkline_midpoint codelinkline_sampl codelinkline_seg codelinkline_via codelinkmatslin codelinkn_sample_length codelinkn_vertic codelinkonewaygeo codelinkpointslin codelinktoptail_buff codelinktoptailg codelinkupdate_line_geometri conceptlin