content introductionintroduct citationcit installationinstal usageusag tutorialtutori referencesrefer introduct rkomic softwar suit includ python packag komic r packag rkomic two softwar packag facilit assembl circular downstream analys mitochondri genom trypanosomatid input komic read fastq format output maxicircl circular minicircl fasta format process rkomic pleas report issu question frederikvandenbroeck kuleuvenb read follow paper includ stepbystep tutori best use rkomic softwar suit geert schnaufer van den broeck f rkomic r packag process mitochondri minicircl assembl populationscal genom projectshttpsbmcbioinformaticsbiomedcentralcomarticless bmc bioinformat citat use komic pleas cite van den broeck f savil n imamura h sander mae cooper mateu jara adaui v arevalo j llanoscuenta garcia l cupolillo e mile berriman schnaufer cotton j dujardin jc ecolog diverg hybrid neotrop leishmania parasiteshttpswwwpnasorgcontentearli proceed nation academi scienc use rkomic pleas cite geert schnaufer van den broeck f rkomic r packag process mitochondri minicircl assembl populationscal genom projectshttpsbmcbioinformaticsbiomedcentralcomarticless bmc bioinformat instal komic follow depend need instal first megahithttpwwwmetagenomicswikitoolsassemblymegahit blasthttpsblastncbinlmnihgovblastcgicmdwebpage_typeblastdocsdoc_typedownload vsearchhttpsgithubcomtorognesvsearch depend instal instal latest version komic use pip pip instal githttpsgithubcomfrebiokomicsgit run komic supercomput may want look herehttpsvlaamssupercomputingcentrumvscdocumentationreadthedocshostedcomenlatestsoftwarepython_package_managementhtmlalternativestoconda setup local environ pip instal option usag usag komic command option requir argument get minim usag command use komic command get full help command use one komic command h komic command help avail command perform assembl circular polish assembl assembl minicircl use high qualiti read trimfq circular circular minicircl assembl polish reorient filter circular minicircl tutori first time use komic may want follow tutori use data provid github page sequenc read gener use whole genom sequenc leishmania peruviana isol lca follow file contain sequenc read align leishmania braziliensi refer genom see step wget httpsgithubcomfrebiokomicsblobmasterdatalca_fqgz wget httpsgithubcomfrebiokomicsblobmasterdatalca_fqgz extract unalign read bam file bam file sequenc read align nuclear refer genom first need extract unalign read ie read like origin mitochondri genom bam file use samtoolshttpwwwhtsliborg convert bam file fastq file use gatkhttpsgatkbroadinstituteorghcenu samtool view b f unmappedreadsbam readsbam gatk samtofastq unmappedreadsbam f readsfqgz f readsfqgz trim read highqual sequenc read fastq format recommend trim sequenc high qualiti use eg fastphttpsgithubcomopengenefastp fastp lca_fqgz lca_fqgz lca_trim_fqgz lca_trim_fqgz q u w cut_right cut_right_window_s cut_right_mean_qu l b might need chang set l minimum read length lower valu read shorter recommend keep b maximum read length bp illumina sequenc qualiti decreas increas number cycl ie longer read assembl mitochondri genom use komic assembl assembl mitochondri maxicircl minicircl use megahit komic assembl thread kmin kmax kstep lca_run lca_trim_fqgz lca_trim_fqgz grep lca_runmaxicirclesfasta grep c tmplca_runcsbcontigsfasta optim kmer length depend complex mitochondri genom also differ maxicircl minicircl minicircl recommend use high kmer valu close read length eg kmer read bp long maxicircl recommend use low kmer valu eg exampl follow kmer sweep strategi wherebi megahit run use follow klist maxicircl contig identifi use blast maxicircl sequenc leishmania braziliensi trypanosoma brucei equiperdum lewisi result maxicircl contig found file lca_runmaxicirclesfasta includ one contig length bp cover entir code region interest gener complet circular assembl maxicircl includ code diverg region pleas read van den broeck et al minicircl contig extract base presenc conserv sequenc block csb bp minicircl motif also known univers minicircl sequenc highli conserv across kinetoplastida speci ray default komic use known csb motif ggggttggtgta ggggttgatgta revers complement extract contig put minicircl origin result minicircl contig found file tmplca_runcsbcontigsfasta includ total minicircl contig seem like rather low number minicircl due fact includ low kmer valu let anoth assembl time use high kmer valu komic assembl thread kmin kmax kstep lca_run lca_trim_fqgz lca_trim_fqgz grep c tmplca_runcsbcontigsfasta yield better result assembl total minicircl contig circular mitochondri minicircl happi number assembl minicircl contig need circular minicircl contig komic use blast strategi identifi sequenc common start end given minicircl contig megablast run entir set minicircl contig low complex filter turn allow maximum evalu blast output process retain hit among minicircl contig avoid artifici dimer ident minimum bp overlap start end given contig whenev overlap found contig classifi circular duplic sequenc start contig remov komic circular lca_run tmplca_runcsbcontigsfasta grep c tmplca_runcircularizedfasta grep c _circular tmplca_runcircularizedfasta minicircl contig success circular polish circular minicircl final want align minicircl reorient minicircl contig base csbmer b put conserv sequenc block csb start circular minicircl contig c cluster contig base minimum percent ident eg use vsearch komic polish minident lca_run tmplca_runcircularizedfasta grep c lca_runminicirclesfasta check qualiti read depth assembl check qualiti assembl need calcul map statist one use metric proport nearperfect align csbcontain read serv proxi total number minicircl initi present within dna sampl note csb mer present within minicircl maxicircl recommend use csbread align maxicircl first let creat overlap end circular minicircl copi last bp circular contig start circular contig reason want make sure includ read align process use high percent ident includ read almost perfectli match minicircl see b read depth overlap end circular sequenc approxim half median read depth entir sequenc wget httpsgithubcomfrebiokomicsrawmasterkomicsfasta_extendpi chmod fasta_extendpi fasta_extendpi lca_runminicirclesextendedfasta lca_runminicirclesfasta map read extend minicircl eg use smalt bwa smalt index k lca_runminicirclesextendedfasta lca_runminicirclesextendedfasta smalt map f sam runmappedsam lca_runminicirclesextendedfasta lca_trim_fqgz lca_trim_fqgz run follow script get map depth stat wget httpsgithubcomfrebiokomicsrawmasterkomicsmapping_statssh chmod mapping_statssh mapping_statssh runmappedsam follow result tabl give detail overview map stat cat runmappedmappingstatssh number read b number map read c number read map qualiti number csbcontain read e number map csbcontain read f number csbcontain read map qualiti result show total read map minicircl read mq total read contain csb align minicircl rel high map qualiti tell us success assembl minicircl present within dna sampl follow result tabl give detail overview depth stat per minicircl contig cat runmappeddepthstatssh minicircl copi number estim standard median read depth per minicircl median genomewid read depth instanc know median genomewid read depth sampl equal assum diploidi mean haploid read depth equal median minicircl read depth rang henc minicircl copi number rang remov intermedi file happi final set maxicircl minicircl remov intermedi file rm r tmplca_run refer ray conserv sequenc block kinetoplast minicircl divers speci trypanosomeshttpsdxdoiorgfmcb molecular cellular biolog van den broeck et al mitonuclear genom challeng theori clonal trypanosoma congolens repli tibayrenc ayalahttpspubmedncbinlmnihgov molecular ecolog