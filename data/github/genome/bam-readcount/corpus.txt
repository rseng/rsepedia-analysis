bamreadcount testshttpsgithubcomseqfubamreadcountactionsworkflowstestsymlbadgesvgbranchsamtool coveragehttpscoverallsioreposseqfubamreadcountbadgesvgbranchsamtoolsservicegithub bamreadcount util run bam cram file gener lowlevel inform sequenc data specif nucleotid posit output includ observ base readcount summar map base qualiti stranded inform mismatch count posit within read see output section origin design help filter genom mutat call metric bamreadcount output also use input variant detect tool resolv ambigu variant caller content installationinstal usageusag tutorialtutori supportsupport contributingcontribut instal docker latest releas version bamreadcount avail docker imag dockerhubhttpshubdockercomrmgibiobamreadcount docker pull mgibiobamreadcount detail see dockerbamreadcounthttpsgithubcomgenomedockerbamreadcount repositori build requir c toolchain cmake detail see buildmdbuildmd git clone httpsgithubcomgenomebamreadcount cd bamreadcount mkdir build cd build cmake make execut binbamreadcount usag run argument commandlin help bamreadcount usag bamreadcount option bam_fil region gener metric bam_fil singl nucleotid posit exampl bamreadcount f reffa somebam avail option h help produc messag v version output version number q minmappingqu arg minimum map qualiti read use count b minbasequ arg minimum base qualiti posit use read count maxcount arg max depth avoid excess memori usag l sitelist arg file contain list region report readcount within f referencefasta arg refer sequenc fasta format printindividualmapq arg report map qualiti comma separ list p perlibrari report result librari w maxwarn arg maximum number warn type emit give unlimit number insertioncentr gener indel centric readcount read contain insert includ perbas count option region format samtool chromosomestartstop option l sitelist file tabsepar header one region per line chromosom start end cram support use cram file input refer specifi f overrid whatev cram header otherwis refer encod cram header lookup md ena use wrapperspars add bamreadcount count vcf vatoolshttpsgithubcomgriffithlabvatoolsblobmastervatoolsvcf_readcount_annotatorpi allow add readcount vcf modern variant caller addit detailshttpsvatoolsreadthedocsioenlatestvcf_readcount_annotatorhtml creat csv file brcparserhttpsgithubcomsridharbrcpars parser convert bamreadcount output comma seper long format file output output tabsepar header stdout one line per posit chr posit reference_bas depth basecountavg_mapping_qualityavg_basequalityavg_se_mapping_qualitynum_plus_strandnum_minus_strandavg_pos_as_fractionavg_num_mismatches_as_fractionavg_sum_mismatch_qualitiesnum_q_containing_readsavg_distance_to_q_start_in_q_readsavg_clipped_lengthavg_distance_to_effective_p_end one set separ field report base statist set read contain base field descript base base eg c count number read avg_mapping_qu mean map qualiti avg_basequ mean base qualiti avg_se_mapping_qu mean singl end map qualiti num_plus_strand number read plusforward strand num_minus_strand number read minusrevers strand avg_pos_as_fract averag posit read fraction calcul respect length clip valu normal center read base occur strictli center read valu occur strictli end approach valu avg_num_mismatches_as_fract averag number mismatch read per base avg_sum_mismatch_qu averag sum base qualiti mismatch read num_q_containing_read number read q run end avg_distance_to_q_start_in_q_read averag distanc posit fraction unclip read length start q run avg_clipped_length averag clip read length avg_distance_to_effective_p_end averag distanc prime end read fraction unclip read length perlibrari output p option output line set delimit result one librari chr posit reference_bas depth library__nam basecountavg_mapping_qualityavg_basequalityavg_se_mapping_qualitynum_plus_strandnum_minus_strandavg_pos_as_fractionavg_num_mismatches_as_fractionavg_sum_mismatch_qualitiesnum_q_containing_readsavg_distance_to_q_start_in_q_readsavg_clipped_lengthavg_distance_to_effective_p_end library_n_nam basecountavg_mapping_qualityavg_basequalityavg_se_mapping_qualitynum_plus_strandnum_minus_strandavg_pos_as_fractionavg_num_mismatches_as_fractionavg_sum_mismatch_qualitiesnum_q_containing_readsavg_distance_to_q_start_in_q_readsavg_clipped_lengthavg_distance_to_effective_p_end tutori learn best exampl brief tutori avail herehttpsgithubcomgenomebamreadcounttreemastertutori use bamreadcount identifi omicron sarscov variant concern raw sequenc data support support pleas search bamreadcounthttpswwwbiostarsorgpostsearchquerybamreadcount biostarshttpswwwbiostarsorg mani frequent ask question bamreadcount answer problem address pleas open github issu make biostar post contribut welcom contribut see contributinghttpsgithubcomgenomebamreadcountblobmastercontributingmd detail build instruct requir c toolchain cmake make debian linuxbas system ubuntu apt instal buildessenti cmake instal requir softwar build current fail os x requir librari includ repositori vendor see vendorreadmemdvendorreadmemd inform build make build directori mkdir build run cmake insid cd build cmake run make make build vendor librari well bamreadcount final binari move anywher binbamreadcount tri test cram cd testdata buildbinbamreadcount f randkfa twolibsortedcram test data small twolibrari test cram file testdatatwolibsortedcram associ refer testdatarandkfa refer encod cram sq snrandk ln medfaefebddcca urrandkfa bamreadcount run insid testdata directori find refer contribut welcom improv extens bug report bug fix bamreadcount bug report make bug report use pleas includ brief summari problem expect actual happen precis step reproduc problem minim bamcram file step run possibl fix featur addit direct pull request fine fork repositori creat new branch make pr repo invest time effort often best creat issu github repositori report bug andor propos chang well happi discuss detail feasibl buildcommon common build script use cc project intend make compil cmake handl depend slightli easier bamreadcount tutori novemb whohttpswwwwhoint classifiedhttpswwwwhointnewsitemclassificationofomicronbsarscovvariantofconcern sarscovhttpsenwikipediaorgwikisevere_acute_respiratory_syndrome_coronavirus_ varianthttpscovariantsorg bhttpscovariantsorgvariantskomicron variant concernhttpswwwwhointenactivitiestrackingsarscovvari voc design omicronhttpsenwikipediaorgwikiomicron variant note unusu larg number mutat includ spike proteinhttpsenwikipediaorgwikicoronavirus_spike_protein novemb tulio de oliveirahttpstwittercomtuliodna cerihttpsceriorgza postedhttpstwittercomtuliodnastatu linkhttpswwwncbinlmnihgovsratermprjna fastqhttpsenwikipediaorgwikifastq_format sequenc file first sequenc omicron case use bamreadcounthttpsgithubcomgenomebamreadcount along sarscov refer genomehttpswwwncbinlmnihgovnuccor common softwar explor mutat pleas note exercis would sure streetleg virolog depart requir dockerhttpswwwdockercom access unix command line although tool easili built local instead readytorun bash script contain command avail herescriptscommandssh docker setup docker command use similar argument allow us access file current work directori first defin alia common option rm remov contain exit w pwd set work directori current work directori v pwdpwd map current work directori insid contain alia dockercmddock run rm w pwd v pwdpwd run docker dockercmd imag arg comput run quickli ordinari laptop command take minut run docker contain also fairli small download quickli broadband connect use shell support alia format substitut full command dockercmd command line download refer fastq sarscov standard refer genom dockercmd curlimagescurl nc_fa httpseutilsncbinlmnihgoventrezeutilsefetchfcgidbnuccoreidnc_rettypefasta ceri fastq via sra case cerikrispk use sra tool download convert fastq sra format url httpstracencbinlmnihgovtracessrarunsrr dockercmd ncbisratool fastqdump splitfil origfmt srr index align bwa samtool bwahttpsgithubcomlhbwa align sequenc samtoolshttpwwwhtsliborg convert sort index align index refer genom dockercmd seqfualpinebwa bwa index nc_fa align sequenc dockercmd seqfualpinebwa bwa mem nc_fa srr_fastq srr_fastq cerikrispksam convert bam remov sam output dockercmd seqfualpinesamtool samtool view b cerikrispksam cerikrispkbam rm cerikrispksam sort bam remov unsort bam dockercmd seqfualpinesamtool samtool sort cerikrispkbam cerikrispksortedbam rm cerikrispkbam index sort bam dockercmd seqfualpinesamtool samtool index cerikrispksortedbam run bamreadcount protein region readi run bamreadcount focu spike protein genbank referencehttpswwwncbinlmnihgovgen give coordin refer genom specifi rang restrict bamreadcount output could specifi map base qualiti filter run wide open see get w show warn bamreadcount like complain miss sm tag everi read f specifi refer genom dockercmd mgibiobamreadcount w f nc_fa cerikrispksortedbam nc_ cerikrispkbrctsv quick look output bamreadcount output discuss detail quickli scan bamreadcount output see look like variant exampl nc_ c g n tacatg posit read delet tacatg tacatg bamreadcount provid lot inform base indel exampl good averag map qualiti read count forward revers read show variant split indic strand bia averag distanc locu end read indic mostli one end read sequenc qualiti align artifact may issu sign variant may technic artifact hard read raw bamreadcount output pars bamreadcount output bamreadcount output design easi pars output format tabsepar four field overal data posit follow one field base indel turn separ variabl number field depend presenc indel detail see httpsgithubcomgenomebamreadcountoutput best illustr python pars code dictionari perbas data field python perbaseindel data field base_field base str count int avg_mapping_qu float avg_basequ float avg_se_mapping_qu float num_plus_strand int num_minus_strand int avg_pos_as_fract float avg_num_mismatches_as_fract float avg_sum_mismatch_qu float num_q_containing_read int avg_distance_to_q_start_in_q_read float avg_clipped_length float avg_distance_to_effective_p_end float code pars output line line python open bamreadcount output file read line line note output header consum everi line openargsbam_readcount_output in_fh line in_fh strip newlin end line line linestrip field tabsepar split list field linesplitt first four field contain overal inform posit chrom field chromosomerefer name posit intfield posit base reference_bas field refer base depth intfield depth coverag remain field data base indel iter baseindel base_data_str field store perbaseindel data dict base_data split baseindel data base_valu base_data_stringsplit iter field baseindel data note reli python keep key order base_field enumeratebase_fieldskey store field data convert appropri data type base_database_field base_fieldsbase_fieldbase_valuesi someth base_data store filter etc pars exampl exampl omicron data could look variant print data everi base nonzero count meet minimum coverag threshold minimum frequenc total depth well also print avg_pos_as_fract average_basequ use later python skip zerodepth base depth continu skip refer base base count base_databas reference_bas base_datacount continu calcul allel frequenc vaf base count vaf base_datacount depth filter minimum depth vaf depth argsmin_cov vaf argsmin_vaf output count vaf data well avg_pos_as_fract printtjoin strx x chrom posit reference_bas base_databas f vaf depth base_datacount base_dataavg_basequ base_dataavg_pos_as_fract here full scriptscriptsparse_brcpi let tri run omicron data download script dockercmd curlimagescurl parse_brcpi httpsrawgithubusercontentcomgenomebamreadcountmastertutorialscriptsparse_brcpi run python imag count line output dockercmd pythonalpin python parse_brcpi cerikrispkbrctsv wc l result variant base count unfilt data seem noisi let filter requir read coverag minimum vaf run filter count line output dockercmd pythonalpin python parse_brcpi mincov minvaf cerikrispkbrctsv wc l result seem manag start let take look dockercmd pythonalpin python parse_brcpi mincov minvaf cerikrispkbrctsv chrom posit ref base vaf depth count avg_pos_as_fract nc_ c nc_ tacatg nc_ c nc_ g gtgtttatt nc_ att nc_ gagccagaa nc_ g nc_ c nc_ c nc_ g nc_ g nc_ g nc_ nc_ c nc_ c nc_ g nc_ c nc_ nc_ nc_ c nc_ c might miss variant filter got look like pretti clean highvaf candid compar writeup omicronhttpscovariantsorgvariantskomicron covariantshttpscovariantsorg look like weve found sever characterist omicron variant havent gone first six enough identifi omicron list covari present av del ti delyd delni in use posit list bamreadcount let output filter result file dockercmd pythonalpin python parse_brcpi mincov minvaf cerikrispkbrctsv cerikrispkbrcfiltered_tabletsv mung tabl tabsepar headerless posit list field chromosom start end well use posit filter tabl specifi singlebas region region could size past cut f cerikrispkbrcfiltered_tabletsv cut f cerikrispkbrcfiltered_tabletsv cut f cerikrispkbrcfiltered_tabletsv grep v chrom cerikrispkvariant_position_listtsv result tabsepar nc_ nc_ nc_ nc_ nc_ nc_ nc_ nc_ nc_ nc_ nc_ nc_ nc_ nc_ nc_ nc_ nc_ nc_ nc_ nc_ nc_ suppli list bamreadcount l argument l list region report w show warn bamreadcount like complain miss sm tag everi read f specifi refer genom dockercmd mgibiobamreadcount l cerikrispkvariant_position_listtsv w f nc_fa cerikrispksortedbam nc_ cerikrispkbrcvariant_positionstsv bamreadcount output contain specifi region nc_ c c g n ctatac ctataca nc_ c g n tacatg nc_ c c g n nc_ g c g n gtgtttatt nc_ c g n att nc_ c g n gagccagaa nc_ g c g n nc_ c c g n nc_ c g n nc_ c g n nc_ g c g n nc_ c g n nc_ c g n nc_ c g n nc_ c c g n nc_ g c g n nc_ c c g n nc_ c g n nc_ c g n nc_ c c g n nc_ c c g n posit report bamreadcount posit bamreadcount report region specifi protein base wc l cerikrispkbrctsv bamreadcount report posit nonzero coverag one caveat delet longer base bamreadcount report indel start base follow delet base two exampl first tacatg delet posit read show refer start delet follow base report coverag base nc_ c g n tacatg nc_ c g n nc_ c c g n catgtc nc_ c g n nc_ c g n nc_ g c g n differ delet gtgtttatt posit case everi read except one read last posit show delet report coverag other zero nc_ g c g n gtgtttatt nc_ c g n nc_ g c g n nc_ c g n nc_ c g n nc_ c g n nc_ c g n nc_ c g n nc_ c g n addit note avg_basequ set delet region region list provid follow base delet shown includ list use bamreadcount statist let process bamreadcount output minimum coverag minimum vaf dockercmd pythonalpin python parse_brcpi cerikrispkbrctsv cerikrispkbrcparsedtsv wrote bamreadcount stat avg_pos_as_fract average_basequ output ive creat script plot vaf script requir addit librari wont run via minim python docker contain avail herescript vaf_vs_avg_basequalitypngplotsvaf_vs_avg_basequalitypng vaf_vs_avg_pos_as_fractionpngplotsvaf_vs_avg_pos_as_fractionpng coverag wed gener expect see low vaf posit read error unless posit systemat bia look vaf vs avg_basequ look like nearli vaf average_basequ except four variant average_basequ recal indel field set sinc data base probabl four indel discuss earlier look vaf vs vaf_vs_avg_pos_as_fract less clear metric approach zero variant averag found either end read approach one variant averag found center read read qualiti issu aris end read often use filter nois look spread throughout rang statist although highervaf variant interest highervaf variant found middl rang could sampl posit variant count vendor librari licens see packag licens inform url httpsgithubcomsamtoolssamtoolsreleasesdownloadsamtoolstarbz httpswwwzlibnetzlibtargz httpssourcewareorgpubbzipbziptargz httpstukaaniorgxzxztargz httpscurlhaxxsedownloadcurltargz httpstlsmbedorgdownloadmbedtlsapachetgz boostbamrctargz custom subset boost librari makefiledisable_curlpatch current use enabl disabl build curl note chose mbedtlsapachetgz libcurl ssl support addit depend use via http queri ena cram registri refer hash instead libcurl anoth good option might wolfssl tinycurl distribut build lighter curl librari