highlight shell contribut contribut welcom greatli appreci everi littl bit help credit alway given contribut mani way type contribut report bug report bug httpsgithubcomjohannesbuchnerbxaissu report bug pleas includ oper system name version sherpa xspec version detail local setup might help troubleshoot detail step reproduc bug fix bug look github issu bug anyth tag bug help want open whoever want implement implement featur look github issu featur anyth tag enhanc help want open whoever want implement write document bxa could alway use document whether part offici bxa doc docstr even web blog post articl tutori notebook demonstr use bxa also appreci submit feedback best way send feedback file issu httpsgithubcomjohannesbuchnerbxaissu propos featur explain detail would work keep scope narrow possibl make easier implement rememb volunteerdriven project contribut welcom get start readi contribut here set bxa local develop fork bxa repo github clone fork local git clone gitgithubcomjohannesbuchnerbxagit creat branch local develop git checkout b nameofyourbugfixorfeatur make chang local check chang still allow exampl run cd examplesxspec pythonpathpythonpath bash runallsh commit chang push branch github git add git commit detail descript chang git push origin nameofyourbugfixorfeatur submit pull request github websit pull request guidelin submit pull request check meet guidelin pull request includ test cover exampl pull request add function doc updat put new function function docstr add featur list readmerst pull request work uptod python version check httpstravisciorgjohannesbuchnerbxapull_request make sure test pass support python version deploy remind maintain deploy make sure chang commit includ entri historyrst run bumpvers patch possibl major minor patch git push git push tag travi deploy pypi test pass releas note make ultranest default remov multinest circumv xspec numer interpol issu lepsilon paramet make multinest option allow ultranest ad pca background model replac outdat progressbar tqdm ad pca background model ad galact absorpt fetcher ad gener agn fit script ad chandra background model ad swift background model python support ad corner plot ad conveni function plot ad chandra background model ad acceler model simpl multinest interfac xspec sherpa base pyblocx code bayesian xray analysi bxa bxa connect xray spectral analysi environ xspecsherpa nest sampl algorithm ultranest bayesian paramet estim model comparison bxa provid follow featur paramet estim arbitrari dimens involv find best fit comput error bar comput margin probabl distribut parallelis mpi plot spectral model vs data best fit solut posterior sampl compon model select comput evid consid model readi use bay factor unlik likelihoodratio limit nest model model discoveri visual deviat model data quantilequantil qq plot qqplot requir bin comprehens residu give idea introduc complex model may test model select bxa shine especi systemat analys larg dataset compar multipl model analys low count dataset realist model robust unsupervis fit algorithm explor even complic paramet space autom fashion user need initialis good start point algorithm httpsjohannesbuchnergithubioultranestmethodhtml_ automat run converg slow sampl care complic paramet space encount allow build autom analysi pipelin imag httpsimgshieldsiopypivbxasvg target httpspypipythonorgpypibxa imag httpscoverallsioreposgithubjohannesbuchnerbxabadgesvg target httpscoverallsiogithubjohannesbuchnerbxa imag httpsimgshieldsiobadgedocspublishedoksvg target httpsjohannesbuchnergithubiobxa alt document statu imag httpsimgshieldsiobadgegithubjohannesbuchnerfbxabluesvgstyleflat target httpsgithubcomjohannesbuchnerbxa alt github repositori use bxa dr antoni georgakaki dr angel ruiz noa athen dr mike anderson mpa munich dr franz bauer charlott simmond puc jonathan quirola vásquez santiago dr stéphane paltani dr carlo ferrigno isdc geneva dr zhu liu nao beij dr georgio vasilopoulo yale new dr francesca civano dr aneta siemiginowska cfasao cambridg dr teng liu adam malyali riccardo arcodia sophia waddel torben simm mpe garch dr sibasish laha dr alex markowitz ucsd san diego dr arash bahramian curtin univers perth dr peter boorman u southampton southampton asu pragu httpsuiadsabsharvardedusearchqcitationsbibcodeaaaabfullabxasortdatedesccbibcodedescp__ document bxa document httpjohannesbuchnergithubiobxa_ host httpjohannesbuchnergithubiobxa instal first need either sherpa_ xspec_ instal environ load bxa instal easili use pip conda pip instal bxa want instal home directori instal pip instal bxa user follow command yield error messag python c import ultranest python c import xspec sherpa may need instal python basic packag packag manag exampl yum instal ipython pythonmatplotlib scipi numpi matplotlib aptget instal pythonnumpi pythonscipi pythonmatplotlib ipython bxa requir follow python packag request corner astropi hpi cython scipi tqdm download automat instal also pipconda sourc code avail httpsgithubcomjohannesbuchnerbxa altern download instal git clone httpsgithubcomjohannesbuchnerbxa cd bxa python setuppi instal want instal current user python setuppi instal user support oper system bxa run oper system support ciaosherpa httpscxccfaharvardeduciaowatchouthtmlinstall_ heasoftxspec httpsheasarcgsfcnasagovlheasoftissueshtml_ support systemat test everi bxa releas travi ci httpstraviscicomgithubjohannesbuchnerbxa_ ubuntu linux run sherpa load packag jbuchnerd sherpa welcom sherpa cxc model fit packag ciao sherpa version tuesday june sherpa import bxasherpa bxa sherpa bxabxasolv xspec start python ipython jbuchnerd ipython import xspec import bxaxspec bxa bxabxasolv use bxa see document page perform analys sever exampl includ _ultranest httpjohannesbuchnergithubioultranest _sherpa httpcxcharvardedusherpa _xspec httpheasarcgsfcnasagovdocsxanaduxspec code see code repositori page httpsgithubcomjohannesbuchnerbxa_ _cite cite bxa correctli refer accompan paper buchner et al httpwwwaandaorgarticlesaaabsaaaahtml_ give introduct detail discuss methodolog statist foot suggest give credit develop sherpaxspec ultranest softwar exampl analys xray spectra use analysi softwar bxa refbuchn connect nest sampl algorithm ultranest refultranest fit environ ciaosherpa reffruscion bibtex entri bxa contribut xray spectral analysi methodolog model comparison model discoveri experi design model discoveri qqplot buchner et al aa paper avail arxiv httparxivorgabsarxiv_ bibtex entri httpsuiadsabsharvardeduabsaaabexportcitation_ ultranest see httpsjohannesbuchnergithubioultranestissueshtmlhowshouldiciteultranest sherpa see sherpa_ xspec see xspec_ fit bxa xagnfitt tool automat fit xray spectra agn fit sourc spectrum obscur agn compon powerlaw reprocess toru structur warm mirror compon powerlaw thompson scatter within open angl stellar process compon apec whose luminos remain e erg three absorb milki way absorpt addit featur use multinest global paramet space explor algorithm deal mani paramet get stuck local minima redshift uncertain uncertainti propag give fix valu background spectrum approxim automat empir model extract inform compar default xspec wstat even sourc count see eg simmond produc paramet posterior distribut describ uncertainti agn luminos loguniform uninform prior column densiti n_h loguniform uninform prior powerlaw photon index inform prior redshift fix usersuppli apec temperatur loguniform uninform prior apec normalis loguniform uninform prior toru open angl paramet ctkcover tortheta uniform uninform prior prepar data need spectrum pipha file associ rmf arf background file check keyword set correctli use fixkeywordspi script see bxa repositori make sure src point arf rmf background file python fixkeywordspi pn_srcfit pn_bgdfit pn_rmffit pn_arffit set galact n_h creat file next spectrum file extent nh put galact column densiti sourc exampl echo e combined_srcpinh also use galpi script see bxa repositori automat fetch nhtot valu httpwwwswiftacukanalysisnhtot radec set python galpi pn_srcfit give redshift inform creat file next spectrum file extent z put sourc redshift exampl echo combined_srcpiz know redshift dont creat file redshift uncertainti probabl distribut store two column cumul probabl uniformli sampl correspond redshift exampl redshift could cdfstep numpylinspac z scipystatsnorm cdfcdfstep numpysavetxtcombined_srcpiz numpytransposecdfstep z final file like testsrc folder combined_srcpi combined_srcpinh galact nh combined_srcpiz redshift inform combined_srcarf combined_srcrmf combined_bkgarf option combined_bkgpi combined_bkgrmf option use need instal docker comput necessari softwar ciao sherpa multinest bxa contain imag automat download first go directori spectrum cd testsrc option allow docker contain show stuff screen xhost localdock inspect format confighostnam johannesbuchnerbxa_absorb xdockerargsv tmpxunixtmpxunix e displaydisplay run docker docker run xdockerarg v pwdoptexampl e filenamecombined_srcpi e elo e ehi ti johannesbuchnerbxa_absorb argument mean follow v argument mount local directori virtual machin v pwdoptexampl connect optexampl folder insid contain host machin folder pwd folder current otherwis contain read file e argument set environ variabl e filenamecombined_srcpi set file analys e elo e ehi set energi rang kev use ti get interact termin johannesbuchnerbxa_absorb name contain imag run intern initialis contain similar virtual machin complet separ ubuntu linux instal insid insid run command optciaobinciaosh sherpa optscriptsfitagnpi load ciao run sherpa want replac edit fit script add docker run command v mydirectoryscriptsoptscript ti replac optscript folder script folder sherpa script set sourc model paramet prior background fit final multinest run constrain paramet output file combined_srcpi_out_ import one paramsjson contain paramet name post_equal_weightsdat contain posterior sampl column paramet result plot paramet distribut multinest_marginalspi tool pymultinest repositori help python pymultinestmultinest_marginalspi combined_srcpiout_withapec_ altern also use cornerpi plot tool modifi behaviour chang redshift alter z file see disabl apec compon set environ variabl e withapec chang fitagnpi script altogeth edit script folder pass v mydirectoryscriptsoptscript give absolut path script directori bxasherpa exampl script folder contain simpl complex exampl bxa invok spectral analysi pleas refer httpsjohannesbuchnergithubiobxa full document includ instal bxa test data test data includ spectral file examplefilefak repres athena observ absorb agn correspond respons spectrum look someth like imag xspecreferenceoutputdatagif simpl analysi look file example_simplestpi contain load data set model paramet rang run bxa fit specifi prior see httpsjohannesbuchnergithubiobxa understand code see httpsjohannesbuchnergithubioultranest understand output fit engin exampl faq page httpsjohannesbuchnergithubioultranestissueshtml_ expect output python example_simplestpi read rmf file athenapp_ir_bc_wfi_withfilter_fovarcmin_avgrsp ultranest sampl live point prior monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl e e z like e itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl e e e z like e itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl e e e z like e itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl e e e z like e itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl e e e z like e itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl e e e z like e itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl e e e z like e itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl e e e z like e itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl e e e z like e itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl e e e z like e itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl e e e z like e itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl e e e z like e itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl e e e z like e itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl e e e z like e itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl e e e z like e itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl e e e z like e itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl e e e z like e itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl e e e z like e itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl e e e z like e itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl e e e z like e itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl e e e z like e itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl e e e z like e itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl e e e z like e itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl e e e z like e itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl e e e z like e itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl e e e z like e itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl e e e z like e itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl z like itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl z like itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl z like itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl z like itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl z like itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl z like itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl z like itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl z like itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl z like itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl z like itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl z like itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl z like itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl z like itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl z like itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl z like itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl z like itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl z like itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl z like itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl z like itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl z like itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl z like itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl z like itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl z like itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl z like itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl z like itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl z like itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl z like itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl z like itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl z like itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl z like itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl z like itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl z like itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl z like itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl z like itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl z like itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl z like itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl z like itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl z like itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl z like itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl z like itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl z like itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl z like itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl z like itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl z like itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl z like itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl z like itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl z like itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl z like itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl z like itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl z like itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl z like itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl z like itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl z like itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl z like itev eff n monomod volum exp expect volum exp qualiti ok mypowgamma mypowampl ultranest explor le ultranest likelihood function evalu ultranest write sampl result disk ultranest write sampl result disk done ultranest logz ultranest posterior uncertainti strategi satisfi kl nat need nat ultranest evid uncertainti strategi satisfi dlogz need ultranest logz error budget singl bs tail total requir ultranest done iter logz singl instanc logz bootstrap logz tail logz insert order u test converg true correl inf iter mypowgamma mypowampl output file find simplest simplest simplestdebuglog simplestplot simplestplotscornerpdf simplestplotstracepdf simplestplotsrunpdf simplestinfo simplestinfopost_summarycsv simplestinforesultsjson simplestresult simplestresultspointshdf simplestextra simplestchain simplestchainsruntxt simplestchainsweighted_post_untransformedtxt simplestchainsequal_weighted_posttxt simplestchainsweighted_posttxt simplest outputfiles_basenam defin script import file plotscornerpdf imag referenceoutputcornerpng plot paramet constraint uncertainti correl photon index paramet hit edg paramet space uncertainti tini hint poor model inforesultsjson summari paramet uncertainti estim lnz infopost_summarycsv summari paramet uncertainti csv chainsequal_weighted_posttxt contain posterior sampl row model paramet vector iter set model pyxspec someth comput flux luminos exampl probabl want plot fit well set best fit tri modifi model inform see httpsjohannesbuchnergithubiobxasherpaanalysishtml exampl exampl pca background use swift data file swiftintervalpcpi first store galact nh valu e text file swiftintervalpcpinh run python example_pcabackgroundpi load nh swiftintervalpcpinh expect someth like e set galact nh unit ecm² bxafitt info pcafitterfor id bxafitt info load pca inform homeuserbinciaootslibpythonsitepackagesbxasherpabackgroundswift_xrt_json bxafitt info fit background id use pca method bxafitt info background count deconvolut bxafitt info fit initi pca decomposit e e e e e e e e e e e bxafitt info fit first full fit done bxafitt info fit paramet bxafitt info fit stat bxafitt info fit second full fit zero bxafitt info fit paramet bxafitt info fit stat bxafitt info fit use zerofit paramet stat paramet stat paramet stat paramet stat paramet stat paramet stat paramet stat paramet stat paramet stat paramet stat paramet stat background pca fit aic result stat ncomp aic increas paramet paramet aic final choic paramet aic ad gaussian largest remain discrep kev need count place gaussian kev power gaussian chang neg good signific reject creat prior function run bxa ultranest sampl live point prior ultranest info sampl live point prior monomod volum exp expect volum exp qualiti ok srclevel srcphoindex srcnh srcredshift pcalognorm ze likee e itev eff n logz singl instanc logz bootstrap logz tail logz srclevel srcphoindex srcnh srcredshift pcalognorm exampl empir background model differ prior redshift free paramet run python example_automatic_background_modelpi call singlefitt bxafitt info singlefitterfor id store swiftintervalpc bxafitt info prepare_stag id bxafitt info prepare_stag id done bxafitt info prepare_stag id bxafitt info prepare_stag id done bxafitt info fit_stag id bxafitt info fit_stag id fine fit bxafitt info fit_stag id fit bxafitt info fit_stag id stage done bxafitt info prepare_stag id bxafitt info prepare_stag id done bxafitt info fit_stag id bxafitt info fit_stag id fine fit bxafitt info fit_stag id fit bxafitt info fit_stag id stage done bxafitt info prepare_stag id bxafitt info prepare_stag id done bxafitt info fit_stag id bxafitt info fit_stag id fine fit bxafitt info fit_stag id fit bxafitt info fit_stag id stage done bxafitt info prepare_stag id bxafitt info prepare_stag id done bxafitt info fit_stag id bxafitt info fit_stag id fine fit bxafitt info fit_stag id fit bxafitt info fit_stag id stage done bxafitt info prepare_stag id bxafitt info prepare_stag id done bxafitt info fit_stag id bxafitt info fit_stag id fine fit bxafitt info fit_stag id fit bxafitt info fit_stag id stage done bxafitt info prepare_stag id bxafitt info prepare_stag id done bxafitt info fit_stag id bxafitt info fit_stag id fine fit bxafitt info fit_stag id fit bxafitt info fit_stag id stage done bxafitt info background fit complet freez background param load nh swiftintervalpcpinh expect someth like e set galact nh unit ecm² apply_rmfapply_arf xszpowerlwsrc xszwabsabso xswabsgalabso boxddip_ xsbknpowerpbknpl_ gaussdgauss_ gaussdgauss_ gaussdgauss_ gaussdgauss_ param type valu min max unit srcphoindex thaw srcredshift frozen srcnorm thaw e absonh thaw atom cm absoredshift frozen galabsonh thaw atom cm dip_xlow frozen dip_xhi frozen dip_ampl frozen pbknpl_phoindx frozen pbknpl_break frozen kev pbknpl_phoindx frozen pbknpl_norm frozen e gauss_fwhm frozen gauss_po frozen gauss_ampl frozen e gauss_fwhm frozen gauss_po frozen gauss_ampl frozen e gauss_fwhm frozen gauss_po frozen gauss_ampl frozen e gauss_fwhm frozen gauss_po frozen gauss_ampl frozen e creat prior function run bxa ultranest sampl live point prior ultranest info sampl live point prior monomod volum exp expect volum exp qualiti ok srclevel srcphoindex srcnh galnh z like itev eff n logz singl instanc logz bootstrap logz tail logz srclevel srcphoindex srcnh galnh compar model python model_comparepi superfit wabs_noz model comparison model superfit logz xxx rule model wabs_noz logz good last like model use normal uniform model prior assum cut log rule model bewar caveat logz differ logbay factor deriv threshold simul data full document see httpsjohannesbuchnergithubiobxasherpaanalysishtml pleas explor folder demo script exampl go chandra folder run xagnfitterpi httpsjohannesbuchnergithubiobxaxagnfitterhtml_ folder bxaxspec exampl script folder contain simpl complex exampl bxa invok spectral analysi pleas refer httpsjohannesbuchnergithubiobxa full document includ instal bxa gener test data gener test data xspec use command genxspec produc spectral file examplefilefak repres athena observ absorb agn expect output genxspec xspec spectrum look someth like imag referenceoutputdatagif simpl analysi look file example_simplestpi contain load data set model paramet rang run bxa fit specifi prior plot posterior predict convolv respons plot model posterior predict convolv make qq plot see httpsjohannesbuchnergithubiobxa understand code see httpsjohannesbuchnergithubioultranest understand output fit engin exampl faq page httpsjohannesbuchnergithubioultranestissueshtml_ expect output python example_simplestpi default fit statist set cstatist appli current newli load spectra spectrum use spectral data file examplefilefak spectrum net count rate ctss spectrum e e assign data group plot group notic channel telescop athena instrument wfi channel type pi exposur time sec use fit statist cstat use respons rmf file athenapp_ir_bc_wfi_withfilter_fovarcmin_avgrsp sourc channel ignor spectrum channel notic spectrum model powerlaw sourc activeon model model compon paramet unit valu par comp powerlaw phoindex powerlaw norm ________________________________________________________________________ fit statist cstatist e use bin test statist chisquar e use bin warn chisquar may valid due bin zero varianc spectrum number null hypothesi probabl e degre freedom current data model fit yet fit statist cstatist e use bin test statist chisquar e use bin warn chisquar may valid due bin zero varianc spectrum number null hypothesi probabl e degre freedom current data model fit yet fit statist cstatist e use bin test statist chisquar e use bin warn chisquar may valid due bin zero varianc spectrum number null hypothesi probabl e degre freedom current data model fit yet uniform prior phoindex jeffrey prior norm e e note paramet span mani dex doublecheck limit reason run analysi ultranest resum store point monomod volum exp expect volum exp qualiti ok phoindex lognorm z like e itev effinf n monomod volum exp expect volum exp qualiti correl length phoindex lognorm z like e itev effinf n monomod volum exp expect volum exp qualiti correl length phoindex lognorm z like itev effinf n monomod volum exp expect volum exp qualiti correl length phoindex lognorm ultranest explor le itev effinf n ultranest likelihood function evalu ultranest write sampl result disk ultranest write sampl result disk done ultranest logz ultranest posterior uncertainti strategi satisfi kl nat need nat ultranest evid uncertainti strategi satisfi dlogz need ultranest logz error budget singl bs tail total requir ultranest done iter logz singl instanc logz bootstrap logz tail logz insert order u test converg fals correl iter phoindex lognorm run analysi done creat plot posterior predict data bin plot save plot creat plot posterior predict save plot creat quantilequantil plot save plot output file find simplest simplest simplestdebuglog simplestconvolved_posteriorpdf simplestchainfit simplestplot simplestplotscornerpdf simplestplotstracepdf simplestplotsrunpdf simplestunconvolved_posteriorpdf simplestinfo simplestinfopost_summarycsv simplestinforesultsjson simplestqq_model_deviationspdf simplestresult simplestresultspointshdf simplestextra simplestchain simplestchainsruntxt simplestchainsweighted_post_untransformedtxt simplestchainsequal_weighted_posttxt simplestchainsweighted_posttxt simplest outputfiles_basenam defin script import file unconvolved_posteriorpdf imag referenceoutputunconvolved_posteriorpng model powerlaw uncertainti narrow see explan plot see httpsjohannesbuchnergithubiobxaxspecanalysishtml convolved_posteriorpdf imag referenceoutputconvolved_posteriorpng model data convolv respons red mean data poorli fit model model clearli exampl lower energi xray overpredict explan plot see httpsjohannesbuchnergithubiobxaxspecanalysishtml plotscornerpdf imag referenceoutputcornerpng plot paramet constraint uncertainti correl photon index paramet hit edg paramet space uncertainti tini anoth hint poor model explan plot see httpsjohannesbuchnergithubiobxaxspecanalysishtml qq_model_deviationspdf imag referenceoutputqq_model_deviationspng qq plot httpsenwikipediaorgwikiqeq_plot_ red curv far line bottom right indic model produc mani count data tickmark indic problem accumul kev explan plot see httpsjohannesbuchnergithubiobxaxspecanalysishtml inforesultsjson summari paramet uncertainti estim lnz infopost_summarycsv summari paramet uncertainti csv chainsequal_weighted_posttxt contain posterior sampl row model paramet vector iter set model pyxspec someth comput flux luminos exampl exampl example_advanced_priorspi show absorb powerlaw fit better also demonstr specifi custom prior function run python example_advanced_priorspi examplefilefak absorb spectral file output folder command line argument conveni analys mani sourc example_custom_runpi final add emiss line run python example_custom_runpi examplefilefak line compar model python model_comparepi absorb simplest line model comparison model simplest logz xxx rule model absorb logz xxx rule model line logz good last like model use normal uniform model prior assum cut log rule model bewar caveat logz differ logbay factor deriv threshold simul data full document see httpsjohannesbuchnergithubiobxaxspecanalysishtml pleas explor folder demo script includ contributingrst includ historyrst obscur activ galact nuclei script fit activ galact nuclei provid xagnfitterpi httpsgithubcomjohannesbuchnerbxablobmasterexamplessherpaxagnfitterpy_ method use buchner buchner simmond featur maximum inform extract low count regim bayesian infer background model provid robust uncertainti estim paramet includ obscur column densiti nh photon index gamma restfram intrins accret luminos etc redshift fix unknown come probabl distribut photoz realist nuclear obscur model uxclumpi extend highest comptonthick column densiti clumpi confus lineofsight inclin view angl paramet fit object local univers well correct galact absorpt option add apec mathl erg contamin compon set withapec fit multipl observ simultan strongli recommend use xagnfitt httpsgithubcomjohannesbuchnerbxablobmasterexamplessherpaxagnfitterpy_ script instead hard ratio xagnfitterpi script includ verbatim literalinclud examplessherpaxagnfitterpi exampl run tri run agn spectrum provid examplessherpachandra folder output look someth like withapec modeldirhomedownloadsspecmodel python xagnfitterpi read arf file cdfsms_arf sherpaastroio info read arf file cdfsms_arf read rmf file cdfsms_rmf sherpaastroio info read rmf file cdfsms_rmf read arf background file cdfsms_arf sherpaastroio info read arf background file cdfsms_arf read rmf background file cdfsms_rmf sherpaastroio info read rmf background file cdfsms_rmf read background file cdfsms__bkgpi sherpaastroio info read background file cdfsms__bkgpi solar abund vector set wilm wilm j allen mccray r apj abund set zero element includ paper cross section tabl set vern verner ferland korista yakovlev load nh pinh expect someth like e set galact nh unit ecm² combin compon link paramet set redshift creat prior set sourc background model bxafitt info pcafitterfor id bxafitt info load pca inform homeuserbinciaootslibpythonsitepackagesbxasherpabackgroundchandra_json bxafitt info fit background id use pca method bxafitt info background count deconvolut bxafitt info fit initi pca decomposit e e e e e e e e e e e bxafitt info fit first full fit done bxafitt info fit paramet tbvab version cosmic absorpt grain h modifi wilm allen mccray apj question joern wilm joernwilmssternwarteunierlangend joernwilmsfaud httppulsarsternwarteunierlangendewilmsresearchtbab pleas notic get model describ paper also set abund abund wilm note routin ignor current cross section set alway use verner cross section baselin bxafitt info fit stat bxafitt info fit second full fit zero bxafitt info fit paramet bxafitt info fit stat bxafitt info fit use zerofit paramet stat paramet stat paramet stat paramet stat paramet stat paramet stat paramet stat paramet stat paramet stat paramet stat paramet stat background pca fit aic result stat ncomp aic increas paramet final choic paramet aic ad gaussian largest remain discrep kev need count place gaussian kev power e gaussian chang neg good signific reject run bxa ultranest sampl live point prior ultranest info sampl live point prior monomod volum exp expect volum exp qualiti ok srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm ze likee e itev eff n monomod volum exp expect volum exp qualiti ok srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like e itev eff n monomod volum exp expect volum exp qualiti ok srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like e itev eff n monomod volum exp expect volum exp qualiti ok srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like e itev eff n monomod volum exp expect volum exp qualiti ok srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like e itev eff n monomod volum exp expect volum exp qualiti ok srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like e itev eff n monomod volum exp expect volum exp qualiti ok srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like e itev eff n monomod volum exp expect volum exp qualiti ok srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like e itev eff n monomod volum exp expect volum exp qualiti ok srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like e itev eff n monomod volum exp expect volum exp qualiti ok srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like e itev eff n monomod volum exp expect volum exp qualiti ok srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like e itev eff n monomod volum exp expect volum exp qualiti ok srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like e itev eff n monomod volum exp expect volum exp qualiti ok srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like e itev eff n monomod volum exp expect volum exp qualiti ok srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like e itev eff n monomod volum exp expect volum exp qualiti ok srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like e itev eff n monomod volum exp expect volum exp qualiti ok srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like e itev eff n monomod volum exp expect volum exp qualiti ok srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like e itev eff n monomod volum exp expect volum exp qualiti ok posit degeneraci srcnh srclevel rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like e itev eff n monomod volum exp expect volum exp qualiti ok posit degeneraci srcnh srclevel rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like e itev eff n monomod volum exp expect volum exp qualiti ok posit degeneraci srcnh srclevel rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like e itev eff n monomod volum exp expect volum exp qualiti ok posit degeneraci srcnh srclevel rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like e itev eff n monomod volum exp expect volum exp qualiti ok posit degeneraci srcnh srclevel rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like e itev eff n monomod volum exp expect volum exp qualiti ok posit degeneraci srcnh srclevel rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like e itev eff n monomod volum exp expect volum exp qualiti ok posit degeneraci srcnh srclevel rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like e itev eff n monomod volum exp expect volum exp qualiti ok posit degeneraci srcnh srclevel rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like e itev eff n monomod volum exp expect volum exp qualiti ok posit degeneraci srcnh srclevel rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti ok posit degeneraci srcnh srclevel rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti ok posit degeneraci srcnh srclevel rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti ok posit degeneraci srcnh srclevel rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti ok posit degeneraci srcnh srclevel rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti ok posit degeneraci srcnh srclevel rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti ok posit degeneraci srcnh srclevel rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti ok posit degeneraci srcnh srclevel rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti ok posit degeneraci srcnh srclevel rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti ok posit degeneraci srcnh srclevel rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti ok posit degeneraci srcnh srclevel rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti ok posit degeneraci srcnh srclevel rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti ok posit degeneraci srcnh srclevel rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti ok posit degeneraci srcnh srclevel rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti ok posit degeneraci srcnh srclevel rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti ok posit degeneraci srcnh srclevel rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti ok posit degeneraci srcnh srclevel rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti ok posit degeneraci srcnh srclevel rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti ok posit degeneraci srcnh srclevel rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti ok posit degeneraci srcnh srclevel rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti correl length posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti correl length posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti correl length posit degeneraci torusphoindex srclevel rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti correl length posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti correl length posit degeneraci torusphoindex srclevel rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti correl length posit degeneraci torusphoindex srclevel rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti correl length posit degeneraci torusphoindex srclevel rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti correl length posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti correl length posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti correl length posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti correl length posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti correl length posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti correl length posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti correl length posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti correl length posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti correl length posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti correl length posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti correl length posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti correl length posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti correl length posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti correl length posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti correl length posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti correl length posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho posit degeneraci srcnh torusphoindex rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti correl length posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho posit degeneraci srcnh torusphoindex rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti correl length posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho posit degeneraci srcnh torusphoindex rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti correl length posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho posit degeneraci srcnh torusphoindex rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti correl length posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho posit degeneraci srcnh torusphoindex rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti correl length posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho posit degeneraci srcnh torusphoindex rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti correl length posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho posit degeneraci srcnh torusphoindex rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti correl length posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho posit degeneraci srcnh torusphoindex rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti correl length posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho posit degeneraci srcnh torusphoindex rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti correl length posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho posit degeneraci srcnh torusphoindex rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti correl length posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho posit degeneraci srcnh torusphoindex rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti correl length posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho posit degeneraci srcnh torusphoindex rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti correl length posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho posit degeneraci srcnh torusphoindex rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti correl length posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho posit degeneraci srcnh torusphoindex rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti correl length posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho posit degeneraci srcnh torusphoindex rho posit degeneraci srcsoftscatnorm srcnh rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti correl length posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho posit degeneraci srcnh torusphoindex rho posit degeneraci srcsoftscatnorm srcnh rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti correl length posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho posit degeneraci srcnh torusphoindex rho posit degeneraci srcsoftscatnorm srcnh rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti correl length posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho posit degeneraci srcnh torusphoindex rho posit degeneraci srcsoftscatnorm srcnh rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti correl length posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho posit degeneraci srcnh torusphoindex rho posit degeneraci srcsoftscatnorm srcnh rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti correl length posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho posit degeneraci srcnh torusphoindex rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti correl length posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho posit degeneraci srcnh torusphoindex rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti correl length posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho posit degeneraci srcnh torusphoindex rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti correl length posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho posit degeneraci srcnh torusphoindex rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti ok posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho posit degeneraci srcnh torusphoindex rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti ok posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho posit degeneraci srcnh torusphoindex rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti ok posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho posit degeneraci srcnh torusphoindex rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti ok posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho posit degeneraci srcnh torusphoindex rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti ok posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho posit degeneraci srcnh torusphoindex rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti ok posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho posit degeneraci srcnh torusphoindex rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti ok posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho posit degeneraci srcnh torusphoindex rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti ok posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho posit degeneraci srcnh torusphoindex rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti ok posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho posit degeneraci srcnh torusphoindex rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti ok posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho posit degeneraci srcnh torusphoindex rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti ok posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho posit degeneraci srcnh torusphoindex rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti ok posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho posit degeneraci srcnh torusphoindex rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti ok posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho posit degeneraci srcnh torusphoindex rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti ok posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho posit degeneraci srcnh torusphoindex rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti ok posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho posit degeneraci srcnh torusphoindex rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti ok posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho posit degeneraci srcnh torusphoindex rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti ok posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho posit degeneraci srcnh torusphoindex rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti ok posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho posit degeneraci srcnh torusphoindex rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti ok posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho posit degeneraci srcnh torusphoindex rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti ok posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho posit degeneraci srcnh torusphoindex rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti ok posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho posit degeneraci srcnh torusphoindex rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti ok posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho posit degeneraci srcnh torusphoindex rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti ok posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho posit degeneraci srcnh torusphoindex rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti ok posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho posit degeneraci srcnh torusphoindex rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti ok posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho posit degeneraci srcnh torusphoindex rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti ok posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho posit degeneraci srcnh torusphoindex rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti ok posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho posit degeneraci srcnh torusphoindex rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti ok posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho posit degeneraci srcnh torusphoindex rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti ok posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho posit degeneraci srcnh torusphoindex rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti ok posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho posit degeneraci srcnh torusphoindex rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm z like itev eff n monomod volum exp expect volum exp qualiti ok posit degeneraci torusphoindex srclevel rho posit degeneraci srcnh srclevel rho posit degeneraci srcnh torusphoindex rho srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm ultranest explor le itev eff n ultranest info explor le ultranest likelihood function evalu ultranest info likelihood function evalu ultranest write sampl result disk ultranest info write sampl result disk ultranest write sampl result disk done ultranest info write sampl result disk done ultranest logz ultranest info logz ultranest posterior uncertainti strategi satisfi kl nat need nat ultranest info posterior uncertainti strategi satisfi kl nat need nat ultranest evid uncertainti strategi satisfi dlogz need ultranest info evid uncertainti strategi satisfi dlogz need ultranest logz error budget singl bs tail total requir ultranest info logz error budget singl bs tail total requir ultranest done iter ultranest info done iter logz singl instanc logz bootstrap logz tail logz insert order u test converg fals correl iter srclevel torusphoindex srcnh srcsoftscatnorm pcalognorm plot spectrum calcul intrins flux distribut model spectra warn clear convolv model apply_rmfapply_arf xstablemodeltoru xstablemodelscat apply_rmfapply_arfpca dataset sherpauiutil warn clear convolv model apply_rmfapply_arf xstablemodeltoru xstablemodelscat apply_rmfapply_arfpca dataset save distribut plot data produc follow output file find multiple_out_zspec_ multiple_out_zspec_ multiple_out_zspec_debuglog multiple_out_zspec_plot multiple_out_zspec_plotscornerpdf multiple_out_zspec_plotstracepdf multiple_out_zspec_plotsrunpdf multiple_out_zspec_info multiple_out_zspec_infopost_summarycsv multiple_out_zspec_inforesultsjson multiple_out_zspec_result multiple_out_zspec_resultspointshdf multiple_out_zspec_extra multiple_out_zspec_chain multiple_out_zspec_chainsruntxt multiple_out_zspec_chainsweighted_post_untransformedtxt multiple_out_zspec_chainsequal_weighted_posttxt multiple_out_zspec_chainsweighted_posttxt multiple_out_zspec_bkg_txtgz multiple_out_zspec_intrinsic_photonfluxdistgz multiple_out_zspec_src_txtgz multiple_out_zspec_ prefix use z redshift file provid contain singl number import file plotscornerpdf plot paramet constraint uncertainti correl inforesultsjson summari paramet uncertainti estim lnz infopost_summarycsv summari paramet uncertainti csv chainsequal_weighted_posttxt contain posterior sampl row model paramet vector iter set model pyxspec someth comput flux luminos exampl multiple_out_zspec_intrinsic_photonfluxdistgz contain posterior distribut redshift photon energi flux see step script code conveni featur content local fix fit keyword sourc background arf rmf file refer fit header keyword fixkeywordspi httpsgithubcomjohannesbuchnerbxablobmasterfixkeywordspy_ script adjust keyword fixkeywordspi srcpi bkgpi rmfrmf arfarf also fix arfrmf start energi bound zero invalid instead small number galact absorpt galact column densiti direct sourc often need httpswwwswiftacukanalysisnhtotdonhtotphp provid lookup servic galpi httpsgithubcomjohannesbuchnerbxablobmastergalpy_ script fetch valu galpi srcpi store srcpinh also give script multipl spectral file avoid duplic request acceler slow model model slow convolut worthwhil cach produc interpol grid sherpa cach arbitrari model provid cachedmodel use wrapper autoclass bxasherpacachedmodelcachedmodel noindex automat product interpol model possibl rebinnedmodel autoclass bxasherparebinnedmodelrebinnedmodel noindex xspec chain file bxa run pyxspec also provid chain fit file compat mcmc featur xspecpyxspec xspec error propag tool thu use bxa fit xspec one load xspec chain load pathtomychainfit parallelis bxa support parallelis mpi messag pass interfac allow scale infer laptop way comput cluster use instal mpipi run python script mpiexec mpiexec np python myscriptpi modif script need howev may want run plot postanalysi rank analysi mani data set mani model trivial parallelis script accept command line argument unix tool make j xarg maxarg maxproc help run code parallel verbos want make fit quiet set verbosefals call run find instruct reduc output ultranest fit engin httpsjohannesbuchnergithubioultranestissueshtmlhowdoisuppresstheoutput_ code insid xsilenc contain disabl xspec chatter bxaxspecsolv import xsilenc xsilenc someth model discoveri model right one data question answer statist way gener idea model could fit better test model signific model select first point quantilequantil plot provid unbin less noisi altern residu plot imag absorbedqq_model_devi imag absorbedconvolved_posterior qq plot exampl left correspond spectrum comparison right plot energi number count observ lower energi plot one axi predict axi model data agre perfectli would straight line devianc indic possibl misfit exampl almost perfect fit see offset grow kev remain higher energi indic data count model growth sshape probabl gaussian see cumul densiti function httpsenwikipediaorgwikinormal_distribution_ refer appendix accompan paper cite_ exampl sherpa bxa begin load bxa session sherpa load import bxasherpa bxa _sherpaprior defin prior defin background model sourc model usual sherpa defin prior free paramet exampl three paramet want vari param xsapecmyapecnorm param xspowerlawmypowerlawnorm param xspowerlawmypowerlawphoindex list paramet paramet param param param list prior transform prior bxacreate_uniform_prior_forparam bxacreate_loguniform_prior_forparam bxacreate_gaussian_prior_forparam prior make singl function priorfunct bxacreate_prior_functionprior make sure set paramet minimum maximum valu appropri priori reason valu limit use defin uniform loguniform prior freez paramet want investig bxa modifi paramet specifi hint find thaw paramet model paramet p get_modelpar pfrozen plink none also defin prior function transform unit variabl unto valu need paramet see ultranest document prior httpsjohannesbuchnergithubioultranestpriorshtml_ detail concept script examplessherpaexample_automatic_background_modelpi httpsgithubcomjohannesbuchnerbxablobmasterexamplessherpaexample_automatic_background_modelpy_ give exampl custom prior function limited__ api inform autofunct bxasherpacreate_jeffreys_prior_for autofunct bxasherpacreate_uniform_prior_for autofunct bxasherpacreate_gaussian_prior_for autofunct bxasherpacreate_prior_funct _sherpapriorpredictivecheck prior predict check check prior model okay work creat flipbook prior sampl pick random sampl prior paramet prior_funct zipparamet prior parameterv prior_functionnumpyrandomuniform make plot plot_model plot_sourc etc repeat time look plot shape number count expect look like reason represent prior expect _sherparun run analysi need specifi prefix call outputfiles_basenam file store see pymultinest document option solver bxabxasolverpriorpriorfunct parametersparamet outputfiles_basenam myoutput result solverrunresumetru api inform autoclass bxasherpabxasolv member run _sherpaanalys paramet posterior plot credibl interv model paramet histogram margin paramet distribut plot myoutputsplotscornerpdf figur absorbedcorn scale also plot use corner triangl getdist pass resultssampl inform corner librari use see httpscornerreadthedocsioenlatest error propag resultssampl provid access posterior sampl similar markov chain use propag error everi row chain comput quantiti interest make histogram result comput mean standard deviat preserv structur uncertainti multipl mode degeneraci etc bxa also allow comput flux correspond paramet estim give correct probabl distribut flux distanc inform fix valu distribut later infer correct luminos distribut dist solverget_distribution_with_fluxeslo hi numpysavetxtout prefix disttxt dist api inform automethod bxasherpabxasolverget_distribution_with_flux noth r row resultssampl set paramet valu current sampl p v zipparamet row pval v rappendlistrow calc_photon_fluxloelo hiehi calc_energy_fluxloelo hiehi loop use comput obscurationcorrect restfram luminos modifi nh paramet energi rang comput flux _sherpamodel includ model_comparisonrst _sherpadesign includ experiment_designrst _sherpaqq includ model_discoveryrst qq function qq modul allow creat plot easili export cumul function file autofunct bxasherpaqqqq_export noindex refer refaccompan paper cite give introduct detail discuss methodolog recommend xray spectral analysi good valid result experienc user xspec sherpa alreadi use continu background model parameter albeit necessarili physic instead subtract use binwis background xspec default commonli extract region near sourc use estim background use cstatcash poisson likelihood instead chi gaussian likelihood use unbin spectra except perhap visual albeit use qqplot without loss resolut beyond alreadi accept practic recommend estim valu uncertainti use bayesian infer softwar mcmc method instead contoursearch fisher matrix step approxim instead local optim benefit global search deal multipl solut error propag easi use posterior sampl similar markov chain preserv structur error depend paramet etc compar model use comput evid softwar instead likelihood ratio test invalid nonnest model bayesian model select base evid z resolv number limit current method easi softwar see refaccompan paper cite detail discuss comparison xspec bxa document show use bxa pyxspec_ begin import bxa python session heasoft load literalinclud examplesxspecexample_simplestpi line load data defin background model sourc model usual pyxspec_ _pyxspec httpsheasarcgsfcnasagovxanaduxspecpythonhtml _xspecprior defin prior defin background model sourc model usual xspec defin prior free paramet exampl literalinclud examplesxspecexample_simplestpi line taken examplesxspecexample_simplestpi httpsgithubcomjohannesbuchnerbxablobmasterexamplesxspecexample_simplestpy_ make sure set paramet minimum maximum valu appropri priori reason valu limit use defin uniform loguniform prior freez paramet want investig bxa modifi paramet specifi also defin prior function transform unit variabl unto valu need paramet see ultranest document prior httpsjohannesbuchnergithubioultranestpriorshtml_ detail concept script examplesxspecexample_advanced_priorspi httpsgithubcomjohannesbuchnerbxablobmasterexamplesxspecexample_advanced_priorspy_ give exampl custom prior function my_custom_prior api inform autofunct bxaxspeccreate_uniform_prior_for autofunct bxaxspeccreate_loguniform_prior_for autofunct bxaxspeccreate_gaussian_prior_for autofunct bxaxspeccreate_custom_prior_for prior predict check check prior model okay work creat flipbook prior sampl predict pick random sampl prior import numpi bxaxspecsolv import set_paramet prior_funct bxacreate_prior_functiontransform valu prior_functionnumpyrandomuniformsizelentransform set_parameterstransform valu printset paramet valu make plot repeat time look plot shape number count expect look like reason represent prior expect _xspecrun run analysi run fit store result specifi output folder literalinclud examplesxspecexample_simplestpi line autoclass bxaxspecbxasolv noindex return result contain posterior sampl bayesian evid also report screen _xspecanalys paramet posterior plot credibl interv model paramet histogram margin paramet distribut plot myoutputsplotscornerpdf figur absorbedcorn scale also plot use corner triangl getdist pass resultssampl inform corner librari use see httpscornerreadthedocsioenlatest model check function also need scipi instal follow code creat plot convolv posterior model literalinclud examplesxspecexample_simplestpi line figur absorbedconvolved_posterior exampl convolv spectrum data posterior sampl solut paramet taken put model line plot region darker line end thu like data point adapt bin contain least count error bar creat ask model count rate produc amount count poisson process invers incomplet gamma function provid answer probabl rang use color data point intent purpos ignor color color intend aid discoveri discrep use custom good fit measur procedur gof modul tree bin built ie first layer everi bin merg second everi bin merg etc count bin compar poisson process model worst case ie least like probabl whole tree consid bin lowest probabl merg kept final multipli number node tree comparison lead random chanc probabl bin math point mark orang reach math mark red ok ignor color comput use otherwis follow code creat plot unconvolv posterior literalinclud examplesxspecexample_simplestpi line figur absorbedunconvolved_posterior exampl unconvolv spectrum posterior sampl solut paramet taken put model line plot region darker line end thu like plot model paramet found data use function automethod bxaxspecbxasolverposterior_predictions_unconvolv automethod bxaxspecbxasolverposterior_predictions_convolv automethod bxaxspecsinningbin noindex error propag resultssampl provid access posterior sampl similar markov chain use propag error everi row chain comput quantiti interest make histogram result comput mean standard deviat preserv structur uncertainti multipl mode degeneraci etc continu xspec chain file compat xspec chain command written outputfiles_basenamechainfit xspec load use chain load httpsheasarcgsfcnasagovxanaduxspecmanualxschainhtml_ set paramet comput flux estim _xspecmodel includ model_comparisonrst _xspecdesign includ experiment_designrst _xspecqq includ model_discoveryrst xspec qq function qq modul allow creat plot easili literalinclud examplesxspecexample_simplestpi line autofunct bxaxspecqqqq refer refaccompan paper cite give introduct detail discuss methodolog experi design want evalu whether plan experi detect featur constrain paramet ie determin discriminatori power futur configurationssurveysmiss simul spectra use appropri respons case experi constrain paramet analys check fraction posterior sampl lie insideoutsid region interest case experi distinguish two model model select case sourc redshift rang luminos etc distinguish comput grid spectra model select point grid pcabas background model advantag use background spectral model inform extract lowcount data correl bin instrument behaviour known page describ machinelearn approach deriv empir background model publish simmond et al aa httpsuiadsabsharvardeduabsaaasabstract_ chandraaci xmmepic swiftxrt nustarfpma rxte larg archiv background spectra use deriv princip compon pca empir describ background variat bxa includ pca model fit specif background spectrum pca model train logcount space avoid neg count pca model oper detector channel thu never pass respons pca model limit well describ addit compon gaussian emiss line reason fitter also tri ad gaussian line locat strongest fit mismatch fit keep increas complex first number pca compon gaussian long aic akaik inform criterion improv sherpa set sourc model set_model use bxasherpabackgroundpca import auto_background convmodel get_modelid bkg_model auto_backgroundid set_full_modelid get_responseidmodel bkg_model get_bkg_scaleid autofunct bxasherpabackgroundpcaauto_background full exampl fit obscur activ galact nuclei avail httpsgithubcomjohannesbuchnerbxablobmasterexamplessherpaxagnfitterpi xspec xspec two step first fit background spectrum outsid xspec use autobackgroundmodelfitbkgpi script find httpsgithubcomjohannesbuchnerbxatreemasterautobackgroundmodel give instruct load pca model xspec creat new pca model see httpsgithubcomjohannesbuchnerbxatreemasterautobackgroundmodelcreateamodel fit bad judg qq plot background fit produc show energi problem may spectrum somehow differ typic spectra tri anoth method eg empir background model fall back wstat statist bxa packag subpackag toctre maxdepth bxasherpa bxaxspec modul content automodul bxa member undocmemb showinherit empir background model advantag use background spectral model inform extract lowcount data correl bin instrument behaviour known pymodbxasherpabackground modul includ handcraft model empir describ background spectra chandraaci xmmepic swiftxrt requir extract background spectrum ab initio predict mixtur powerlaw gaussian line mekal fit background bestfit model use fit sourc option background paramet overal normalis vari sourc fit may also interest pca model pcabackgroundmodels_ chandraaci xmmepic swiftxrt nustarfpma rxte observ empir model xmmepic exampl xmm avail httpsgithubcomjohannesbuchnerbxablobmasterexamplessherpaxmmfitpi autofunct bxasherpabackgroundxmmget_pn_bkg_model noindex autofunct bxasherpabackgroundxmmget_mos_bkg_model noindex xmm model develop richard sturm mpe citat maggi p et al aa aa httpsuiadsabsharvardeduabsaaamabstract_ empir model swiftxrt chandraaci exampl swiftxrt avail httpsgithubcomjohannesbuchnerbxablobmasterexamplessherpaswiftfitpi first defin background want use want store intermedi result store intermediari fit inform usual name spectral file filenam mybackgroundspecfil creat fitter desir type spectrum bxasherpabackgroundmodel import swiftxrtbackground chandrabackground bxasherpabackgroundfitt import singlefitt fitter singlefitterid filenam swiftxrtbackground fitter singlefitterid filenam chandrabackground final run background fit fitterfitplottru chandra model develop johann buchner mpe citat buchner et al aa httpsuiadsabsharvardeduabsaaababstract_ swiftxrt model develop johann buchner puc citat buchner et al mnra httpsuiadsabsharvardeduabsmnrasbabstract_ autoclass bxasherpabackgroundmodelsswiftxrtbackground noindex autoclass bxasherpabackgroundmodelsswiftxrtwtbackground noindex autoclass bxasherpabackgroundmodelschandrabackground noindex fit bad tri anoth method eg pca model fall back wstat statist api toctre maxdepth bxa model comparison examplesxspecmodel_comparepi show exampl model select keep mind model prior would like use case multipl model want find one best one use follow examplesmodel_comparepi pick model highest evid case simpler complex model want find complex justifi follow examplesmodel_comparepi keep model certain threshold case multipl model could correct interest paramet margin model use posterior sampl model weigh rel probabl model weight explnz exampl output jbuchnerd python model_comparepi absorb line simplest model comparison model simplest logz xxx rule model absorb logz xxx rule model line logz good last like model use normal uniform model prior assum cut log rule model jbuchnerd probabl secondbest model absorb math time less like model line exce threshold lot claim detect iron line mont carlo simul spectra recommend deriv bay factor threshold prefer fals select rate find exampl appendix buchner httpsuiadsabsharvardeduabsaaababstract_ ultranest tutori httpsjohannesbuchnergithubioultranestexamplesinemodelcomparisonhtml_ bxasherpabackground packag submodul bxasherpabackgroundfitt modul automodul bxasherpabackgroundfitt member undocmemb showinherit bxasherpabackgroundmodel modul automodul bxasherpabackgroundmodel member undocmemb showinherit bxasherpabackgroundpca modul automodul bxasherpabackgroundpca member undocmemb showinherit bxasherpabackgroundxmm modul automodul bxasherpabackgroundxmm member undocmemb showinherit modul content automodul bxasherpabackground member undocmemb showinherit welcom bxa document includ readmerst usag start note docbest practic bestpractis current common maximum likelihood analysi fit bayesian analysi usag similar sherpa xspec concept defin prior transform unit cube paramet space refin sherpa sherpaprior refin xspec xspecprior run analysi refin sherpa sherparun refin xspec xspecrun analys result get margin distribut comput evid model refin sherpa sherpaanalys refin xspec xspecanalys model comparison refin sherpa sherpamodel refin xspec xspecmodel experi design refin sherpa sherpadesign refin xspec xspecdesign model discoveri quantilequantil qq plot refin sherpa sherpaqq refin xspec xspecqq toctre maxdepth caption content sherpaanalysi xspecanalysi conveni backgroundmodel pcabackgroundmodel xagnfitt contribut histori modul indic tabl refgenindex refmodindex refsearch bxasherpa packag subpackag toctre maxdepth bxasherpabackground submodul bxasherpacachedmodel modul automodul bxasherpacachedmodel member undocmemb showinherit bxasherpagalab modul automodul bxasherpagalab member undocmemb showinherit bxasherpainvgauss modul automodul bxasherpainvgauss member undocmemb showinherit bxasherpaprior modul automodul bxasherpaprior member undocmemb showinherit bxasherpaqq modul automodul bxasherpaqq member undocmemb showinherit bxasherparebinnedmodel modul automodul bxasherparebinnedmodel member undocmemb showinherit bxasherpasolv modul automodul bxasherpasolv member undocmemb showinherit modul content automodul bxasherpa member undocmemb showinherit bxaxspec packag submodul bxaxspecgof modul automodul bxaxspecgof member undocmemb showinherit bxaxspecprior modul automodul bxaxspecprior member undocmemb showinherit bxaxspecqq modul automodul bxaxspecqq member undocmemb showinherit bxaxspecsin modul automodul bxaxspecsin member undocmemb showinherit bxaxspecsolv modul automodul bxaxspecsolv member undocmemb showinherit modul content automodul bxaxspec member undocmemb showinherit machinelearn pca background model advantag use background spectral model inform extract lowcount data correl bin instrument behaviour known page describ machinelearn approach deriv empir background model publish simmond et al aa httpsuiadsabsharvardeduabsaaasabstract_ chandraaci xmmepic swiftxrt nustarfpma rxte larg archiv background spectra use deriv princip compon pca empir describ background variat bxa includ pca model fit specif background spectrum pca model train logcount space avoid neg count pca model oper detector channel thu never pass respons pca model limit well describ addit compon gaussian emiss line reason fitter also tri ad gaussian line locat strongest fit mismatch fit keep increas complex first number pca compon gaussian long aic akaik inform criterion improv sherpa set sourc model set_model use bxasherpabackgroundpca import auto_background convmodel get_modelid bkg_model auto_backgroundid set_full_modelid get_responseidmodel bkg_model get_bkg_scaleid autofunct bxasherpabackgroundpcaauto_background full exampl fit obscur activ galact nuclei avail httpsgithubcomjohannesbuchnerbxablobmasterexamplessherpaxagnfitterpi xspec xspec two step precomput bestfit continuum model fit background spectrum outsid xspec use autobackgroundmodelfitbkgpi script find httpsgithubcomjohannesbuchnerbxatreemasterautobackgroundmodel need json file folder give instruct load pca model xspec use result atabl dummi unit respons matrix fitbkgpi step give instruct load xspec creat new pca model new instrument survey creat model python autobackgroundmodel__init__pi bkgpha bkgpha bkgpha result file telescopejson telescope_instrumentjson fit model want fit specif sourc obtain background model two differ way use xspec precomput background model python autobackgroundmodelfitbkgpi bkgpha srcpha make file bkgphabstatout estim perchannel count rate use sherpa use autobackground featur see examplessherpaexample_automatic_backgroundpi new model json file need instal bxa folder probabl locallibpythonsitepackagesbxasherpabackground