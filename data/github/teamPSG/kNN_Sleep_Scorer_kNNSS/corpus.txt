knearest neighbor classifierbas sleep stage knnss welcom knnss softwar knnss matlab packag autom sleep stage score use knearest neighbor algorithm compar autom sleep score packag main advantag simplic use physiolog relev humaninterpret featur code document follow joss public doihttpsjosstheojorgpapersjossstatussvghttpsdoiorgjoss licens sourc code form subject term mozilla public licens v copi mpl distribut file obtain one httpmozillaorgmpl use knnss compat depend knnss test matlab rb ra softwar use signal process toolbox statist machin learn toolbox matlab also function chronux toolboxhttpchronuxorg use calcul spectral properti data see list file european data format edf httpswwwedfplusinfo file read use brett shoelson brettshoelsonmathworkscom edfread function hjorth paramet calcul hjorth function written aloi schloegl aschloeglieeeorg part biosigtoolboxhttpbiosigsfnet github project selfcontain download requir chronux toolbox file list change_row_to_columnm dpsschkm getfgridm getparamsm mtfftcm mtspecgramcm mtspectrumcm folder content example_data directori contain three subdirectori intermr initi empti intermedi file gener execut test script store rawdata contain polysomnographyc record thoma kilduff laboratori sri intern edf format subfold edf contain raw record subfold fft store associ manual sleep score use train classifi test predict efficaci function_librari directori store necessari matlab function requir knnss function input output describ detail function header use matlab help read detail function list highlevel purpos function found readm folder software_verif set script test code system folder detail descript see readm folder joss_pap contain manuscript submit journal open sourc softwar journal paper provid background softwar summari work applic refer instal function store function_librari folder simpli ad folder matlab function path take care instal altern check content software_verif folder toplevel input output knnss read raw electrophysiolog data file current european data format matlab file support see generate_statespacem function_librari see addit format ad manual score read togeth data typic text file come mani format algorithm finish predict label output matlab structur type variabl contain cell array string field string correspond predict label get help inform pleas hesit contact tamá kiss kisst wignerhu thank contribut thank help make packag better use code run bug problem pleas open issu question comment suggest sent via github send email tamá kiss kisst wignerhu contribut code welcom sinc repositori follow standard open sourc protocol pleas use basic github workflowhttpsguidesgithubcomintroductionflow suggest modif addit tldr fork repositori clone machin make chang push work back fork github open pull requesthttpshelpgithubcomengithubcollaboratingwithissuesandpullrequestsaboutpullrequest review chang discuss accept merg main project pleas restrict commit one modif per commit ideal form legibl commit histori pull request pleas describ clearli concis motiv featur develop also pleas tri keep code easili readabl tidi use smart indentinghttpswwwmathworkscomhelpmatlabmatlab_progimprovecodereadabilityhtml feel write help function greatli improv understand code function pleas follow matlab basic structur help text add help programhttpswwwmathworkscomhelpmatlabmatlab_progaddhelpforyourprogramhtml code conduct pleas polit detail version pleas see contributor coven code conducthttpswwwcontributorcovenantorgversioncode_of_conduct repositori exampl dataset folder two subfold rawdata folder store abridg version two dataset allow user assess softwar capabl one male trace amineassoci receptor taar knockout mice file name start tko describ detail schwartz et al httpsdoiorgfphar male spraguedawley rat file name start collect sleep neurobiolog laboratori sri internationalhttpswwwsricom edf subfold contain electrophysiolog record european data formathttpswwwedfplusinfo associ fft folder present correspond state design assign sec record epoch intermr initi empti folder store result intermedi calcul like featur tabl file featur manual score partit train test set well train classifi folder need store intermedi result temporarili avoid multipl recalcul highlevel function descript knnss readm describ function knnss packag use detail descript mandatori option input function well output found function header toplevel function generate_statespacem first function use process chain load raw data cut epoch calcul featur describ epoch also load manual score associ raw data label epoch use manual score option featur data sinc calcul time consum save matlab file function written modular mind featur includ calcul implement separ function valu pass generate_statespac merg save unifi featur file exampl use shown firststepm script softwareverif folder train_one_modelm function use featur calcul generate_statespacem train knearest neighbor knn classifi function gather featur inform multipl experi could differ subject use merg data train singl classifi experi way gener classifi creat use across multipl experi use present secondstepm script softwareverif folder train_many_modelsm similarli train_one_modelm function use precalcul featur valu train knn classifi differ train_one_modelm train classifi experi get individu classifi accur given subject howev gener well model train multipl subject condit use present secondstepm script softwareverif folder evaluate_model_goodnessm function calcul confus matric manual automat determin label set display set measur describ well classifi perform helper function function chronux toolboxhttpchronuxorg use spectrum calcul change_row_to_columnm helper routin transform array column vector need routin chronux dpsschkm helper function calcul taper getfgridm helper function get frequenc grid associ given fft base comput getparamsm helper function convert structur param variabl use variou routin chronux mtfftcm multitap fourier transform continu data mtspecgramcm multitap timefrequ spectrum continu process mtspectrumcm multitap spectrum continu process helper function edfreadm read european data format file matlab function written brett shoelson phd brettshoelsonmathworkscom canonize_fieldnamem function attempt creat properli format field name confusionperformancemetricsm function convert confus matrix differ preform metric includ sen fpr spc acc ppv npr detail see wikipedia page confus matrixhttpsenwikipediaorgwikiconfusion_matrix estimate_feature_goodnessm function use filter methodshttpsenwikipediaorgwikifeature_selectionfilter_method select featur use classifi train dissimilar hjorthm calcul hjorth parametershttpsenwikipediaorgwikihjorth_paramet activ mobil complex function part biosigtoolboxhttpbiosigsfnet written aloi schloegl aschloeglieeeorg select_featuresm pair estimate_feature_goodnessm function use wrapper methodhttpsenwikipediaorgwikifeature_selectionwrapper_method sequenti featur select find best featur use train classifi flag_outliersm function find outlier featur tabl use median mad metric_band_powerm function calcul power given frequenc band use multitap power estim preprocess_featuresm featur preprocess perform function call fit classifi predict new data preprocess step includ remov data artifact miss data segment remov manual select epoch normal log transform train_classifierm function train knn classifi code test knnss system outlin short exampl store directori guid typic step sleep stage score two independ dataset work one record transgen mice control rat see readm example_data folder inform data begin pleas edit parrootdir variabl setupm file specifi folder knnss place setupm set path data function use supervis classif method first step take calcul featur describ epoch time window record firststepm script also featur combin manual score form train set manual score exampl simplifi label merg featur calcul save file sinc calcul might quit time consum case mani long record calcul featur plu manual score partit train test set former use label featur space knn classifi latter serv test reliabl predict model fit take place secondstepm script fit store matlab file two type model one hand use train_one_model function data mice combin singl train set use train classifi hand train_many_model label one separ classifi anim model use data train set creat previou step predict unseen part data test set happen thirdstepm type model test singl model use consecut predict data anim subsequ data anim predict dedic classifi well sinc rapid eye movement rem sleep epoch scarc last step singl model deflat remov number nonrem sleep epoch success test softwar output three name figur similar one sinc featur select random part result might slightli vari transgen mous data predict accuraci turn shown fig output figur mouseexampleresultfigmousepng rat data pleas see fig perform output figur ratexampleresultfigratpng titl autom sleep stage score use knearest neighbor classifi tag supervis cluster polysomnographi power spectrum matlab author name tamá kiss orcid affili name stephen morairti orcid affili name michael schwartz orcid x affili name thoma kilduff orcid affili name derek l buhl orcid affili name dmitri volfson orcid affili affili name global research develop pfizer inc groton ct usa index name depart comput scienc wigner research centr physic budapest hungari index name center neurosci sri intern menlo park ca usa index name current affili takeda pharmaceut inc cambridg usa index date may bibliographi paperbib polysomnograph sleep stage score mani featur sleep exist rapid eye movement rem sleep nonrem sleep stage well underli physiolog mechan control sleep conserv across differ mammalian speci sleep research import understand impact diseas circadian biolog optim wake perform advanc treatment sleep disord narcolepsi shift work disord non sleepwak disord neurodegen diseas given evolutionari related mammalian speci sleep architectur chang therein may provid reliabl translat biomark pharmacolog engag proofofmechan clinic studi key physiolog indic sleep includ electroencephalographi eeg electrocorticographi electrooculographi eog electromyographi emg polysomnographi psg simultan collect measur typic perform special sleep laboratori determin wake sleep stage someon ie wake rem sleep nonrem sleep broken stage reli judgment train profession score data base standard criteria record stage human psg set forth aasmm disagr individu record might aris due differ instrument subject opinion individu score stage anim sleep studi show even greater variabl robert laboratori use method best suit individu need eg electroderefer posit muscl choic emg implant use eog etc technic differ make difficult compar studi variabl score sleep stage make even challeng although numer score algorithm exist unreli especi follow drug treatment nearli half centuri psg studi gold standard score sleep architectur remain complet thorough examin psg signal score second epoch anim studi second epoch human studi make difficult screen drug anim studi cumbersom implement larg clinic trial applic advantag expedit tediou process visual analyz psg signal object score procedur number sleep stage algorithm develop anim stephensonbastianinibargervladimir human subject penzelgunnzhang review recent fiorillo faust howev computerbas method typic test data obtain healthi subject control anim perform assess case subject sleep disord follow drug treatment boostaniallocca furthermor score sleep hundr anim typic preclin drug discoveri effort often becom bottleneck potenti sourc subject affect research outcom paper present autom approach intend elimin potenti issu initi applic approach basic discoveri research experi conduct larg cohort rodent expect result translat higherord mammal even human build featur classic extract eeg emg data machin learningbas classif psg approach capabl stage sleep multipl speci control drugtreat condit facilit detect treatmentinduc chang manipul eg genet use human interpret featur calcul eeg emg import understand drug mechan predict treatment outcom biomark even translat biomark exampl one featur use algorithm power theta frequenc band call eeg_theta code hz hz rang known increas theta activ togeth low emg activ relev featur call emg_high emg_rm hallmark rem sleep see figurehttpsenwikipediaorgwikirapid_eye_movement_sleepmediafilenormal_eeg_of_mousepng wikirem howev theta power also associ phenomena like anxieti john thu eeg_theta featur besid use sleep score also use biomark drug effect multipl softwar applic develop address problem autom sleep stage score compar review boostani found best result could achiev entropi wavelet coeffici along random forest classifi chosen featur classifi respect anoth recent method miladinov use cuttingedg machin learn method combin convolut neural networkbas architectur produc domain invari predict integr hidden markov model constrain state dynam base upon known sleep physiolog method also build machin learn techniqu base interpret featur use simpler algorithm classif make ideal choic broader commun well sleep expert might familiar complex machin learn approach furthermor chose constrain number identifi sleepwak state probabl transit one state anoth other found drug intervent harvey diseas process mooij tend chang amount time spent differ sleep stage transit probabl well final method supervis method requir train set might seem disadvantag nonsupervis method found drug treatment patholog condit result sleep stage observ healthi control thu algorithm must train new stage brief softwar descript softwar packag implement matlab avail download github knnss automat sleep stage consist classic consecut step machin learningbas sleep score algorithm autoreffigmethod first offlin store eeg emg data load memori allow uniform process timeseri data segment consecut second nonoverlap epoch correspond manual score epoch second featur extract raw signal epoch featur consist power contain physiologicallyrelev frequenc band well hjorth paramet eeg emg data third featur undergo preprocess step includ follow oper unus epoch contain much nois contain signal remov featur transform use logarithm function make featur distribut gaussianlik therebi facilit subsequ machin classif final featur normal median wake valu within anim enabl usabl algorithm across laboratori wake period identifi run algorithm use manuallyscor train set experi perform given period expect compris extend period wake follow featur extract combin filter wrapper methodbas featur select step appli step ensur featur predict valu chosen also help prevent overfit classif knearest neighbor classifi use data preprocess follow procedur describ summari train use knearest neighbor algorithm predict sleep stage labelslabelfigmethodfigpng algorithm use predict sleep stage mice autoreffigefficm rat autoreffigefficr nonhuman primat data shown predict accuraci found depend number paramet input data includ consist manual score physiolog signal well amount artifact furthermor rel frequenc predict label influenc efficaci rare label harder predict code github knnss accompani paper contain abridg version two dataset one male trace amineassoci receptor taar knockout mice describ detail schwartz autoreffigefficm male spraguedawley rat collect sleep neurobiolog laboratori sri intern autoreffigefficr rodent dataset receiv oral dose waterbas vehicl solut three label predict wake w nonrem sleep nr rem sleep r predict efficaci calcul howev note number stage train depend elabor manual score model first use train singl classifi merg train data anim autoreffigefficm autoreffigefficr individu model train one anim autoreffigefficm b autoreffigefficr b github repositori includ addit inform predict accuraci includ detail valu true fals posit rate well method deal imbalanc data estim predict accuraci transgen mous data state wake w nonrem nr rem r anim point plot true fals posit rate calcul red cross denot mean sem train data merg one singl classifi train predict sleep stage anim b individu classifi train anim separatelylabelfigefficmfigpng state label predict way rat data set github script run predict accuraci repres autoreffigefficr show similar result estim predict accuraci rat data predict figur set autoreffigefficmlabelfigefficrfigpng acknowledg tk dv dlb full time employe sharehold pfizer inc develop softwar packag work support pfizer inc sri intern author contribut dv tk develop softwar sm ms tsk dlb contribut data develop test author took part debug test softwar author wrote contribut write manuscript refer