whdenovo costeffect approach diploid assembl singl sampl trio includ follow step construct sequenc graph illumina align long read graph partit long read two haplotyp instal conda instal conda instal c shilpagarg whdenovo data simul simul illumina data whdenovo simul illumina nbpfasta het outillumina show file youll need pacbio data simul whdenovo test simul pacbio data whdenovo simul pacbio samplefastq coverag outpacbio mom_hapfasta mom_hapfasta dad_hapfasta dad_hapfasta child_hapfasta child_hapfasta assembl trio case whdenovo partit illumina illumina_child_fq illumina illumina_child_fq pacbio pacbio_momfasta pacbio_dadfasta pacbio_childfasta p ped thread outpath lowc int highc int eg whdenovo partit illumina _illumina_k_childhetcov_fq illumina _illumina_k_childhetcov_fq pacbio _pacbio_k__pacbio_momfasta _pacbio_k__pacbio_dadfasta _pacbio_k__pacbio_childfasta p ped testsimu lowc highc individu case whdenovo partit illumina illumina_who_fq illumina illumina_who_fq pacbio pacbio_whofasta thread outpath assembl genom partit read given partitionpi conda activ flye whdenovo assembl f soninputreadsfa pathtooutputhpread pathtooutputhpread assembl k pacbionano wish use assembl partit read remov assembl argument may need activ virtual environ result valid valid partit simul data whdenovo valid p outpath f pacbio_whofasta valid partit real data ground truth classif whdenovo valid p outpath taggedreadstxt exampl taggedreadstxt testhaplotaggedreadstxt includ hp tag ps tag haplotag bam file acknowledg support depend bfchttpsgithubcomlhbfc spadeshttpcabspburusoftwarespad vghttpsgithubcomvgteamvg graphalignerhttpsgithubcommaickraugraphalign citat graphbas approach diploid genom assembl linkhttpsdoiorgbioinformaticsbti haplotypeawar de novo assembl relat individu use pedigre sequenc graph linkhttpsdoiorgbioinformaticsbtz pypihttpsimgshieldsiopypivwhatshapsvghttpspypipythonorgpypiwhatshap build statushttpssemaphorecicomapivwhatshapwhatshapbranchesmastershields_badgesvghttpssemaphorecicomwhatshapwhatshap instal biocondahttpsimgshieldsiobadgeinstallwithbiocondabrightgreensvghttpbiocondagithubiorecipeswhatshapreadmehtml whatshap logohttpsbitbucketorgrepoajxbdimageswhatshap_logopng whatshap softwar phase genom variant use dna sequenc read also call readbas phase haplotyp assembl especi suitabl long read work also well short read document inform cite whatshap pleas visit whatshap homepagehttpswhatshapreadthedocsio whatshap_logo_textsvg logo edit text syntax font need instal whatshap_logosvg logo text convert path whatshap_logo_smallsvg top part logo without text chang v use ps tag instead hp tag default store phase inform appli phase hapcutvcf subcommand ps also use tool standard accord vcf specif incorpor genotyp likelihood phase framework request use option distrustgenotyp genotyp chang cost correspond input genotyp likelihood chang genotyp written output vcf behavior distrustgenotyp finetun ad option includehomozyg defaultgq glregular changedgenotypelist correctli handl case process vcf two disjoint famili v speed allel detect add unphas subcommand remov phase vcf file hp ps tag pipe notat add option tag phase subcommand allow choos whether readbackedphasingcompat hp tag standard ps tag use describ phase output vcf manag version version httpsgithubcomwarnerpythonversioneer_ mean whatshap version program version vcf header includ git commit hash whatshap gbafa add subcommand haplotag tag read bam file haplotyp fix bug realign around variant end chromosom would lead assertionerror v phase pedigre block connect read phase base genotyp connect per default behavior turn use option nogenetichaplotyp implement allel detect realign detect allel variant seen read queri align two haplotyp posit result better qualiti phase especi lowqual read pacbio enabl refer provid current limit score allel comput sideeffect new allel detect also phase insert delet mnp complex variant ad option chromosom work specif chromosom use constant recombin rate per default allow use ped without use genmap whatshap becom command subcommand need run whatshap phase phase vcf add stat subcommand print statist phase vcf v use ped phase pedigre pedmec algorithm phase sampl multisampl vcf drop support python requir least python v first releas avail via pypi therefor instal via pip instal whatshap januari trio phase implement branch septemb pwhatshap implement branch april creat haplotypespecif bam file februari smart read select januari abil read multipl bam file merg fli decemb logo unit test novemb cython wrapper c code done abil write phase vcf use hp tag june repositori whatshap refactor creat april whatshap algorithm introduc recomb imag httpsimgshieldsiopypivwhatshapsvgbranchmast target httpspypipythonorgpypiwhatshap imag httpssemaphorecicomapivwhatshapwhatshapbranchesmastershields_badgesvg target httpssemaphorecicomwhatshapwhatshap imag httpsbitbucketorgrepoajxbdimageswhatshap_logopng scale whatshap whatshap softwar phase genom variant use dna sequenc read also call haplotyp assembl especi suitabl long read work also well short read use whatshap pleas cite murray patterson tobia marschal nadia pisanti leo van iersel leen stougi gunnar w klau alexand schönhuth whatshap weight haplotyp assembl futuregener sequenc read httpdxdoiorgcmb_ journal comput biolog pp get selfarchiv version httpsbioinfmpiinfmpgdehomepagepublicationsphpaccountmarschal_ version whatshap find result develop focus make softwar easi straightforward use whatshap open sourc softwar mit licens welcom contribut pedigre phase whatshap capabl use pedigre inform individu improv phase result drastic reduc need coverag preprint avail biorxiv readbas phase relat individu shilpa garg marcel martin tobia marschal doi httpdxdoiorg_ parallel version pwhatshap parallel core dynam program algorithm describ aldinucci bracciali marschal patterson n pisanti torquati highperform haplotyp assembl httpdxdoiorg__ proceed th intern meet comput intellig method bioinformat biostatist cibb current implement found branch parallel httpsbitbucketorgwhatshapwhatshapbranchparallel_ document bitbucket page httpsbitbucketorgwhatshapwhatshap_ read document onlin httpswhatshapreadthedocsio_ offlin document avail doc subdirectori repositori download tar distribut mail list run public mail list httpslistscwinlmailmanlistinfowhatshap_ pleas dont hesit post question comment variou note step variant rediscov bam file may fail variant caller use type realign freebay would better integr variant caller get inform appli indel support right anyway input format hapcompass httpwwwbrowneduresearchistrail_labresourceshapcompass_manualhtmlsec allel detect realign whatshap detect allel read contain variant posit aligin part read two possibl haplotyp haplotyp align better win allel detect realign enabl refer paramet use commandlin realign version detect slightli fewer allel old algorithm typic justifi old algorithm gave wrong result realign howev correctli detect haplotyp equal good refus choos align algorithm use edit distanc moment allow us detect allel correctli time allow us make use base qualiti fact weight algorithm degener unweight one fix need better align algorithm exampl realign work insert next snp haplotyp ref ccttagt alt cctcagt align report bam file ref ccttagt queri cctcaagt second align one expect base thu variant would detect realign queri alt haplotyp get alt cctcagt queri cctcaagt align lower cost therefor detect allel read probabl altern one ambigu previous detect incorrectli ref tgctttaagg alt tgctttcagg queri tgccttcaagg two possibl align ref tgctttaagg queri tgccttcaagg alt tgctttcagg queri tgccttcaagg cost two therefor correct allel unclear includ changesrst develop develop document whatshap develop instal develop make sure instal cython tox also recommend use virtualenv sequenc command work git clone httpsbitbucketorgwhatshapwhatshap cd whatshap virtualenv p python venv venvbinpip instal cython nose tox venvbinpip instal e run whatshap like activ virtualenv omit venvbin part venvbinwhatshap help test run like venvbintox develop instal altern altern want use virtualenv follow git clone httpsbitbucketorgwhatshapwhatshapgit cd whatshap python setuppi build_ext binwhatshap requir cython pysam pyvcf instal instal python version ubuntu ubuntu come one default python version order test whatshap python version use deadsnak repositori ensur follow packag sudo aptget instal buildessenti pythonsoftwareproperti get instal desir python version exampl python sudo addaptrepositori ppafkrulldeadsnak sudo aptget updat sudo aptget instal pythondev pythonsetuptool pip virtualenv avail instal sinc essenti use sudo instal systemwid also instal home omit sudo ad user option instead sudo easy_instal pip sudo pip instal virtualenv debug one way get backtrac gdb assum bug occur run test gdb python gdb run nose get sigsegv let gdb print backtrac gdb bt make releas first time attempt upload distribut pypi creat configur file name pypirc home directori follow content distutil indexserv pypi pypi usernamemyusernam passwordmypassword see also blog post get start pypi httppeterdownscompostsfirsttimewithpypihtml_ particular note password need doubl password must put quotat mark even contain space set correct version number changelog ensur list chang uptod ensur uncommit chang work copi run tox ensur test pass tag current commit version number must v prefix git tag v creat distribut targz file ensur autogener version number tarbal expect python setuppi sdist upload distribut pypi tarbal must regener sinc upload requir preced sdist python setuppi sdist upload push tag git push tag updat bioconda recip httpsgithubcombiocondabiocondarecipesblobmasterrecipeswhatshapmetayaml_ probli easiest edit recip via web interfac send pull request ensur list depend requir section recip sync setuppi file sinc version bump pull request need review bioconda develop soon test pass proper permiss merg directli someth went wrong fix problem follow instruct increment revis version number go version xy xy chang version alreadi upload ad new subcommand follow instruct whatshapexamplepi user guid run whatshap like whatshap phase phasedvcf inputvcf inputbam phase inform ad vcf file way compat gatk readbackedphas hp tag denot set phase variant variant belong vcf file also gzipcompress featur limit whatshap support phase variant diploid genom support variant type snv singlenucleotid variant insert delet mnp multipl adjac snv complex variant complex variant fall categori structur variant exampl variant tgca aac structur variant phase refer sequenc provid use refer snv insert delet phase variant input vcf mark heterozyg genotyp appropri coverag use input core phase algorithm algorithm could determin variant phase inform ad variant output vcf variant left unphas two reason either variant type support phase algorithm could make phase decis case inform input vcf simpli copi output vcf unchang recommend workflow best phase result obtain sequenc sampl pacbio illumina illumina highqual variant call pacbio long read map read refer make sure assign read read group rg header line bam file whatshap support vcf file multipl sampl order determin read belong sampl use sampl name sm read group singl sampl incorrect read group header run whatshap ignorereadgroup instead call variant sampl use accur read typic illumina read result set variant call reason confid know variant caller use yet recommend freebay fast open sourc easi use case need standard vcf file input whatshap next step run whatshap vcf file highconfid variant call obtain previou step longest read typic pacbio read phase work best long read whatshap use read cover least two heterozyg variant call even pairedend matepair read somewhat help multipl set read combin provid multipl bam file command line represent phase inform vcf whatshap support two way store phase inform vcf file standardscompli ps tag hp tag use gatk readbackedphas tool run whatshap phase select format use set tagp taghp use small vcf file exampl follow unphas look like fileformatvcfv chrom po id ref alt qual filter info format sampl sampl chr gt chr c g gt chr g gt chr gt chr g gt note sampl heterozyg shown loci express gt field phase repres pipe notat gt field phase order allel haplotyp separ pipe symbol instead slash fileformatvcfv chrom po id ref alt qual filter info format sampl sampl chr gt chr c g gt chr g gt chr gt chr g gt allel one haplotyp sampl g haplotyp c g g swap one zero gt field would result vcf file equival inform phase repres ps phase set tag pipe notat problem variant vcf file phase vcf specif httpsgithubcomsamtoolshtsspecs_ introduc ps tag solv ps uniqu identifi phase set set variant phase rel usual multipl phase set file variant belong phase set need consecut file fileformatvcfv chrom po id ref alt qual filter info format sampl sampl chr gtpspq chr c g gtpspq chr g gtpspq chr gtpspq chr g gtpspq vcf contain two phase set name name arbitrari whatshap choos posit leftmost variant phase set name variant phase set variant differ phase set configur typic seen pairedend matepair read use phase case whatshap phase set ident connect compon variant connect graph two variant graph connect read exist cover exampl also show usag pq tag phase qualiti whatshap current add tag phase repres hp tag gatk readbackedphas tool use differ way repres phase variant principl combin pipe notat ps tag gt field left unchang inform ad separ hp tag haplotyp identifi instead file encod inform exampl fileformatvcfv chrom po id ref alt qual filter info format sampl sampl chr gthp chr c g gthppq chr g gthppq chr gthppq chr g gthppq note readbackedphas add pq first variant phase sethaplotyp group probabl mean phase qualiti interpret rel previou first variant set readbackedphas phase indel discuss gatk forum topic httpsgatkforumsbroadinstituteorgdiscuss httpsgatkforumsbroadinstituteorgdiscuss trust variant caller whatshap trust variant caller made right decis whether variant heterozyg homozyg use option distrustgenotyp assumpt soften optim solut could involv switch variant heterozyg homozyg current option enabl switch occur variant simpli appear unphas chang genotyp vcf done use option fewer variant phase note switch homozyg variant heterozyg never possibl sinc heterozyg variant consid phase _phasingpedigre phase pedigre whatshap take advantag pedigre inform obtain much better phase turn pedigre mode run whatshap like whatshap phase ped pedigreep phasedvcf inputvcf inputbam pedigreep plinkcompat ped file describ relationship sampl inputvcf multisampl vcf individu phase read individu one bam file whatshap match base sampl name provid read group like default singleindividu mode ped file format whatshap recogn plinkcompat ped file httppngumghharvardedupurcellplinkdatashtml_ ped file whitespac space tab delimit file least six column whatshap check column count use column individu id column patern id column matern id column ignor line start consid comment ignor empti line also ignor defin singl trio suffici singl row ped file child mother father necessari includ dummi row individu whose parent unknown current get warn chang exampl defin trio field famili individual_id paternal_id maternal_id sex phenotyp famili the_child father mother quartet note multipl consecut space fine field famili individual_id paternal_id maternal_id sex phenotyp famili one_child father mother famili other_child father mother import name ped file must match sampl name vcf bam file pedigre phase paramet phase pedigre mode requir cost recombin event per default whatshap assum constant recombin rate across chromosom phase recombin rate cmmb chang provid option recombr default valu cmmb suitabl human genom order use regionspecif recombin rate genet map file provid via option genmap whatshap expect threecolumn text file like posit combined_ratecmmb genetic_mapcm first header line ignor three column expect give pysic posit bp local recombin rate given posit posit given previou row cmmb cumul genet distanc start chromosom cm exampl taken genom genet map provid shapeit httpsmathgenstatsoxacukgenetics_softwareshapeitshapeithtmlgmap_ sinc genet map file provid inform one chromosom genmap option combin chromosom instal requir whatshap implement c python need c compil python later correspond python header file python slightli faster ubuntu make sure packag buildessenti pythondev instal instal whatshap instal pip pip instal user whatshap instal whatshap homelocalbin add homelocalbin path run tool export pathhomelocalbinpath whatshap help instal conda whatshap also avail conda packag bioconda channel httpsbiocondagithubio_ conda instal c bioconda whatshap question answer whatshap use refer panel refer panel use populationbas phaser like beagl shapeit although consid integr whatshap take advantag refer panel right case popul data suggest produc populationbas phase use beagl httpsfacultywashingtonedubrowningbeaglebeaglehtml_ shapeit httpsmathgenstatsoxacukgenetics_softwareshapeitshapeithtml_ etc readbas phase use whatshap separ compareintegr result postprocess step illumina data lead good readbas phase illumina pairedend data ideal readbas phase sinc pair heterozyg snp bridg read pair howev whatshap attempt produc long haplotyp block possibl run whatshap henc tell phaseinform input data take look number size produc haplotyp block larg canshould pedigre pedigreeawar readbas phase ie use option codep pedigre mode whatshap intend intermediates pedigre runtim core phase step linear matht matht number trio relationship number children pedigre recommend use pedigre matht pedigre readdata unnecessari case anyway highqual phase obtain genet haplotyp method like merlin httpcsgsphumicheduabecasismerlintourhaplotypinghtml_ includ readmerst tabl content toctre maxdepth instal guid faq develop note chang indic tabl refgenindex refmodindex refsearch part whatshap describ differ articl pleas choos appropri citat depend use case use whatshap tool marcel martin murray patterson shilpa garg sarah fischer nadia pisanti gunnar w klau alexand schoenhuth tobia marschal whatshap fast accur readbas phase biorxiv doi httpsdoiorg_ refer core whatshap phase algorithm murray patterson tobia marschal nadia pisanti leo van iersel leen stougi gunnar w klau alexand schönhuth whatshap weight haplotyp assembl futuregener sequenc read journal comput biolog pp doi cmb httpdxdoiorgcmb_ get selfarchiv pdf httpsbioinfmpiinfmpgdehomepagepublicationsphpaccountmarschal_ refer pedigreephas algorithm pedmec problem shilpa garg marcel martin tobia marschal readbas phase relat individu bioinformat ii doi bioinformaticsbtw httpsdoiorgbioinformaticsbtw_ whatshap genotyp algorithm describ jana ebler marina hauk trevor pesout tobia marschal benedict paten haplotypeawar genotyp noisi long read biorxiv doi httpsdoiorg_ hapchat algorithm altern mec solver abl handl higher coverag use whatshap phase algorithmhapchat describ paper stefano beretta murray patterson simon zaccaria gianluca della vedova paola bonizzoni hapchat adapt haplotyp assembl effici leverag high coverag long read bmc bioinformat doi httpsdoiorgs_ parallel core dynam program algorithm pwhatshap describ aldinucci bracciali marschal patterson n pisanti torquati highperform haplotyp assembl proceed th intern meet comput intellig method bioinformat biostatist cibb doi _ httpdxdoiorg__ pwhatshap current integr main whatshap sourc code avail branch parallel httpsbitbucketorgwhatshapwhatshapbranchparallel_ git repositori chang master branch integr hapchat algorithm altern mec solver avail whatshap phase algorithmhapchat contribut hapchat team see httpsdoiorg v issu haplotag work chromosom miss vcf ad option mergeread help high coverag data phase pedigre ensur haplotyp order paternal_allelematernal_allel output vcf seem common convent also use g test case use pytest instead nose discontinu v issu fix haplotag command would tag read incorrectli issu use barcod inform bx tag run haplotag x genom link read data issu allow combin ped sampl work subset sampl pedigre ad usepedsampl phase sampl mention ped file ignor sampl input vcf v new subcommand genotyp haplotypeawar genotyp see httpsdoiorg detail method support cram file addit bam issu longer creat bamcram index exist safer run multipl whatshap instanc parallel need creat index exampl samtool index run whatshap issu read mark duplic input bamcram file ignor issu adapt chang interfac pysam issu handl read group miss sampl sm tag correctli v fix compil problem distinguish gcc clang v ad fullgenotyp regenotyp given variant base read ad option whatshap compar switcherrorb write bed file switch error posit ad whatshap compar plotblocks plot histogrom block size ad option longestblocktsv output positionwis stat longest joint haplotyp block ad option whatshap compar tsvmultiway write result multiway comparison tabsepar file ad option chromosom whatshap stat whatshap compar comput blockwis ham distanc whatshap stat comput n phase block fix compil issu os x clang detect unsort vcf chromosom name mismatch bam vcf fix crash whatshap compar encounter unphas vcf expand document v use ps tag instead hp tag default store phase inform appli phase hapcutvcf subcommand ps also use tool standard accord vcf specif incorpor genotyp likelihood phase framework request use option distrustgenotyp genotyp chang cost correspond input genotyp likelihood chang genotyp written output vcf behavior distrustgenotyp finetun ad option includehomozyg defaultgq glregular changedgenotypelist correctli handl case process vcf two disjoint famili v speed allel detect add unphas subcommand remov phase vcf file hp ps tag pipe notat add option tag phase subcommand allow choos whether readbackedphasingcompat hp tag standard ps tag use describ phase output vcf manag version version httpsgithubcomwarnerpythonversioneer_ mean whatshap version program version vcf header includ git commit hash whatshap gbafa add subcommand haplotag tag read bam file haplotyp fix bug realign around variant end chromosom would lead assertionerror v phase pedigre block connect read phase base genotyp connect per default behavior turn use option nogenetichaplotyp implement allel detect realign detect allel variant seen read queri align two haplotyp posit result better qualiti phase especi lowqual read pacbio enabl refer provid current limit score allel comput sideeffect new allel detect also phase insert delet mnp complex variant ad option chromosom work specif chromosom use constant recombin rate per default allow use ped without use genmap whatshap becom command subcommand need run whatshap phase phase vcf add stat subcommand print statist phase vcf v use ped phase pedigre pedmec algorithm phase sampl multisampl vcf drop support python requir least python v first releas avail via pypi therefor instal via pip instal whatshap januari trio phase implement branch septemb pwhatshap implement branch april creat haplotypespecif bam file februari smart read select januari abil read multipl bam file merg fli decemb logo unit test novemb cython wrapper c code done abil write phase vcf use hp tag june repositori whatshap refactor creat april whatshap algorithm introduc recomb variou note step variant rediscov bam file may fail variant caller use type realign freebay would better integr variant caller get inform appli indel support right anyway input format hapcompass httpwwwbrowneduresearchistrail_labresourceshapcompass_manualhtmlsec allel detect realign whatshap detect allel read contain variant posit aligin part read two possibl haplotyp haplotyp align better win allel detect realign enabl refer paramet use commandlin realign version detect slightli fewer allel old algorithm typic justifi old algorithm gave wrong result realign howev correctli detect haplotyp equal good refus choos align algorithm use edit distanc moment allow us detect allel correctli time allow us make use base qualiti fact weight algorithm degener unweight one fix need better align algorithm exampl realign work insert next snp haplotyp ref ccttagt alt cctcagt align report bam file ref ccttagt queri cctcaagt second align one expect base thu variant would detect realign queri alt haplotyp get alt cctcagt queri cctcaagt align lower cost therefor detect allel read probabl altern one ambigu previous detect incorrectli ref tgctttaagg alt tgctttcagg queri tgccttcaagg two possibl align ref tgctttaagg queri tgccttcaagg alt tgctttcagg queri tgccttcaagg cost two therefor correct allel unclear includ changesrst develop whatshap sourc code bitbucket httpsbitbucketorgwhatshapwhatshap_ whatshap develop python cython c develop instal develop make sure instal cython tox also recommend use virtualenv sequenc command work git clone httpsbitbucketorgwhatshapwhatshap cd whatshap python venv venv sourc venvbinactiv pip instal e dev last command instal also develop depend cython use pip instal e omit next run whatshap like whatshap help develop instal use conda use bioconda httpsbiocondagithubio_ conveni develop whatshap separ environ conda creat n whatshapdev python pysam pyvcf pyfaidx xopen cython pytest sphinxissu sourc activ whatshapdev git clone httpsbitbucketorgwhatshapwhatshap cd whatshap pip instal e last command instal whatshap conda environ name whatshapdev execut whatshap run latest version clone run test virtual environ run test current python version like pytest whenev chang cython code pyx file need rerun pip instal e step order compil option run test support python version run tox httpstoxreadthedocsio_ creat separ virtual environ python version instal whatshap run test also test document gener sphinx run like tox tox instal system need insid virtual environ howev need test python version instal system see instruct ubuntu instal python version ubuntu ubuntu come one default python version order test whatshap older newer python version follow instruct enabl deadsnak repositori httpslaunchpadnetdeadsnakesarchiveubuntuppa_ done ensur follow packag sudo apt instal buildessenti pythonsoftwareproperti get instal desir python version make sure instal dev packag exampl python sudo apt updat sudo apt instal pythondev debug one way get backtrac gdb assum bug occur run test gdb python gdb run pytest get sigsegv let gdb print backtrac gdb bt wrap c class whatshap phase algorithm written c mani core data structur read class make c class usabl python use cython wrap class definit spread across multipl file add new attribut method exist class add new class chang need made differ place let us look read class follow place code may need chang read class chang extend srcreadcpp implement class c srcreadh header class declar also normal c whatshapcpppxd cython declar class repeat use cython syntax time subset inform srcreadh file duplic requir cython read h file would need full c parser note cpppxd file contain definit h header would cleaner separ pxd file lead problem link compil file whatshapcorepxd contain declar cython class wrap c class note class read file name c class c one distinct made prefix c class cpp name modul declar c class read declar cpppxd wrap cython class read store c class attribut name thisptr add new class need ad file modifi exist one probabl need chang file whatshapcorepyx cython implement wrapper class name read python wrapper class cppread name c class ad yet c code requir extra code wrap consid write implement cython instead see readselectpyx exampl start python modul transfer cython make faster cython code mere wrapper contain implement write document document locat doc subdirectori written restructuredtext format httpdocutilssourceforgenetdocsuserrstquickrefhtml_ translat sphinx httpwwwsphinxdocorg_ html format document host read doc httpsreadthedocsorg_ theori built automat whenev commit made document master branch visibl httpswhatshapreadthedocsioenlatest httpswhatshapreadthedocsioenlatest_ document recent releas version visibl httpswhatshapreadthedocsioenst httpswhatshapreadthedocsioenstable_ howev connect bitbucket read doc never work well particular project build actual need trigger manual solv problem gener document local ensur instal sphinx addon necessari build documant run pip instal e dev take care go doc directori run make open doc_buildhtmlindexhtml browser theme use bit differ one read doc use make releas first time attempt upload distribut pypi creat configur file name pypirc home directori follow content distutil indexserv pypi pypi usernamemyusernam passwordmypassword see also blog post get start pypi httppeterdownscompostsfirsttimewithpypihtml_ particular note password need doubl password must put quotat mark even contain space set correct version number changelog ensur list chang uptod ensur uncommit chang work copi run tox ensur test pass tag current commit version number must v prefix git tag v creat distribut targz file ensur autogener version number tarbal expect python setuppi sdist upload distribut pypi tarbal must regener sinc upload requir preced sdist twine upload distwhatshapxyztargz may need instal twine tool run command push tag git push tag updat bioconda recip httpsgithubcombiocondabiocondarecipesblobmasterrecipeswhatshapmetayaml_ probli easiest edit recip via web interfac send pull request ensur list depend requir section recip sync setuppi file sinc version bump pull request need review bioconda develop soon test pass proper permiss merg directli someth went wrong fix problem follow instruct increment revis version number go version xy xy chang version alreadi upload ad new subcommand follow instruct whatshapexamplepi _userguid user guid whatshap readbas phase tool typic case expect vcf file variant individu bam cram file sequenc read individu whatshap use sequenc read reconstruct haplotyp write input vcf augment phase inform basic commandlin run whatshap whatshap phase phasedvcf inputvcf inputbam read use variant call creat input vcf need one use phase recommend highqual short read use variant call phase done long read see refth recommend workflow recommendedworkflow input vcf multisampl vcf whatshap haplotyp sampl individu input must contain read sampl refmultipl bamcram file provid multiplebamfil even differ technolog want phase sampl individu relat use refpedigre phase phasingpedigre mode improv result mode whatshap longer pure readbas phase tool errorpron read pacbio nanopor strongli recommend enabl realign mode provid refer fasta format whatshap phase refer reffasta phasedvcf inputvcf inputbam also phase indel ad option indel whatshap add phase inform input vcf file write output vcf file refse understand phase inform repres phasing_in_vcf vcf file also gzipcompress featur limit whatshap support phase variant diploid genom support variant type snv singlenucleotid variant insert delet mnp multipl adjac snv complex variant complex variant fall categori structur variant exampl variant tgca aac structur variant phase refer sequenc provid use refer snv insert delet phase variant input vcf mark heterozyg genotyp appropri coverag use input core phase algorithm algorithm could determin variant phase inform ad variant output vcf variant left unphas two reason either variant type support phase algorithm could make phase decis case inform input vcf simpli copi output vcf unchang subcommand whatshap come follow subcommand subcommand descript phase phase variant vcf whatshap algorithm stat print phase statist compar compar two phase hapcutvcf convert hapcut output format vcf unphas remov phase inform vcf file haplotag tag read haplotyp haplofasta write haplotyp fasta format phase vcf genotyp genotyp variant fulli document manual yet get help subcommand name subcommand run whatshap subcommand help _recommendedworkflow recommend workflow best phase result obtain sequenc sampl pacbio illumina illumina highqual variant call pacbio long read map read refer make sure assign read read group rg header line bamcram file whatshap support vcf file multipl sampl order determin read belong sampl use sampl name sm read group singl sampl incorrect read group header run whatshap ignorereadgroup instead call variant sampl use accur read typic illumina read result set variant call reason confid know variant caller use yet recommend freebay fast open sourc easi use case need standard vcf file input whatshap next step run whatshap vcf file highconfid variant call obtain previou step longest read typic pacbio read phase work best long read whatshap use read cover least two heterozyg variant call even pairedend matepair read somewhat help multipl set read combin provid multipl bamcram file command line _inputdatarequir input data requir whatshap need correct metadata vcf bamcram input file figur read belong sampl exampl assum give whatshap vcf file start like fileformatvcfv chrom po id ref alt qual filter info format samplea sampleb chr gt whatshap see two sampl name samplea sampleb expect find read sampl somewher bamcram file file provid happen read belong sampl must rg tag time read group must occur header bamcram file correct sampl name exampl header might look like hd vn socoordin sq sn ln rg id smsamplea rg id smsampleb rg header line often contain field pl platform lb librari name whatshap use sm attribut header individu align file tag read group exampl align bamcram file come samplea would tag rgz also describ sambam specif httpssamtoolsgithubiohtsspecs_ perfectli fine multipl read group singl sampl rg ida smsamplea rg idb smsamplea rg id smsampleb metadata correct whatshap complain find read sampl chanc metadata bamcram andor vcf file incorrect follow option edit sampl name vcf header set correct read group info bamcram file exampl picard tool addorreplacereadgroup remap read pass correct metadataset option map tool use ignorereadgroup option whatshap case whatshap ignor read group metadata bamcram input file assum read come sampl want phase mode phase singl sampl time input vcf file contain one sampl need specifi one phase use samplethe_sample_nam _multiplebamfil use multipl input bamcram file whatshap support read multipl bam cram file provid bam cram file want use commandlin read across file specif sampl use phase sampl use combin read multipl technolog exampl nanopor read one bam file pacbio read anoth cram file run phase like whatshap phase phasedvcf inputvcf nanoporebam pacbiocram need make sure read group inform refi accur file inputdatarequir _vcfsasread use phase vcf instead bamcram file possibl provid phase vcf file instead bamcram file whatshap treat haplotyp block refphas set phaseset describ read exampl phase vcf contain chromosomes haplotyp chromosom would give rise two read read use read phase algorithm combin normal sequenc read best solut take read account comput _selectionandmerg read select merg whatshap multipl way reduc coverag input allow faster runtim way attempt minim amount inform lost process default behaviour ensur maximum coverag via read select heurist extract subset read inform phase option step done select merg subset read togeth form superread accord probabilist model like subset read appear togeth haplotyp p_ differ haplotyp p_d default featur activ howev activ specifi mergeread flag run whatshap phase model parameter follow four paramet paramet descript errorr probabl nucleotid wrong maximumerrorr maximum error edg merg graph threshold threshold ratio p_sp_d merg two set negativethreshold threshold ratio p_dp_ merg two set specifi respect flag errorr maximumerrorr threshold negativethreshold note default shown exampl run whatshap phase _phasing_in_vcf represent phase inform vcf whatshap support two way store phase inform vcf file standardscompli ps tag hp tag use gatk readbackedphas tool run whatshap phase select format use set tagp taghp use small vcf file exampl follow unphas look like fileformatvcfv chrom po id ref alt qual filter info format sampl sampl chr gt chr c g gt chr g gt chr gt chr g gt note sampl heterozyg shown loci express gt field phase repres pipe notat gt field phase order allel haplotyp separ pipe symbol instead slash fileformatvcfv chrom po id ref alt qual filter info format sampl sampl chr gt chr c g gt chr g gt chr gt chr g gt allel one haplotyp sampl g haplotyp c g g swap one zero gt field would result vcf file equival inform _phaseset phase repres ps phase set tag pipe notat problem variant vcf file phase vcf specif httpsgithubcomsamtoolshtsspecs_ introduc ps tag solv ps uniqu identifi phase set set variant phase rel usual multipl phase set file variant belong phase set need consecut file fileformatvcfv chrom po id ref alt qual filter info format sampl sampl chr gtpspq chr c g gtpspq chr g gtpspq chr gtpspq chr g gtpspq vcf contain two phase set name name arbitrari whatshap choos posit leftmost variant phase set name variant phase set variant differ phase set configur typic seen pairedend matepair read use phase case whatshap phase set ident connect compon variant connect graph two variant graph connect read exist cover exampl also show usag pq tag phase qualiti whatshap current add tag phase repres hp tag gatk readbackedphas tool use differ way repres phase variant principl combin pipe notat ps tag gt field left unchang inform ad separ hp tag haplotyp identifi instead file encod inform exampl fileformatvcfv chrom po id ref alt qual filter info format sampl sampl chr gthp chr c g gthppq chr g gthppq chr gthppq chr g gthppq note readbackedphas add pq first variant phase sethaplotyp group probabl mean phase qualiti interpret rel previou first variant set readbackedphas phase indel discuss gatk forum topic httpsgatkforumsbroadinstituteorgdiscuss httpsgatkforumsbroadinstituteorgdiscuss trust variant caller whatshap trust variant caller made right decis whether variant heterozyg homozyg use option distrustgenotyp assumpt soften optim solut could involv switch variant heterozyg homozyg current option enabl switch occur variant simpli appear unphas chang genotyp vcf done use option fewer variant phase note switch homozyg variant heterozyg never possibl sinc heterozyg variant consid phase _phasingpedigre phase pedigre phase multipl sampl individu relat parentchild trio possibl provid whatshap ped file describ pedigre whatshap use pedigre read infer combin much better phase turn pedigre mode run whatshap like whatshap phase ped pedigreep phasedvcf inputvcf inputbam pedigreep plinkcompat ped file describ relationship sampl inputvcf multisampl vcf individu phase read individu one bamcram file whatshap match base sampl name provid read group like default singleindividu mode result vcf file phasedvcf haplotyp allel child given paternalmatern ie first allel one inherit father second one allel inherit mother ped file format whatshap recogn plinkcompat ped file httppngumghharvardedupurcellplinkdatashtml_ ped file whitespac space tab delimit file least six column whatshap check column count use column individu id column patern id column matern id column ignor line start consid comment ignor empti line also ignor defin singl trio suffici singl row ped file child mother father necessari includ dummi row individu whose parent unknown current get warn chang exampl defin trio field famili individual_id paternal_id maternal_id sex phenotyp famili the_child father mother quartet note multipl consecut space fine field famili individual_id paternal_id maternal_id sex phenotyp famili one_child father mother famili other_child father mother import name ped file must match sampl name vcf bamcram file pedigre phase paramet phase pedigre mode requir cost recombin event per default whatshap assum constant recombin rate across chromosom phase recombin rate cmmb chang provid option recombr default valu cmmb suitabl human genom order use regionspecif recombin rate genet map file provid via option genmap whatshap expect threecolumn text file like posit combined_ratecmmb genetic_mapcm first header line ignor three column expect give pysic posit bp local recombin rate given posit posit given previou row cmmb cumul genet distanc start chromosom cm exampl taken genom genet map provid shapeit httpsmathgenstatsoxacukgenetics_softwareshapeitshapeithtmlgmap_ sinc genet map file provid inform one chromosom genmap option combin chromosom creat phase refer fasta format reconstruct two haplotyp phase vcf describ bcftool consensu command use part bcftool httpwwwhtsliborg_ input expect refer fasta file either index bcf compress index vcf file work uncompress vcf output whatshap produc proceed follow bgzip phasedvcf tabix phasedvcfgz bcftool consensu h f referencefasta phasedvcfgz haplotypefasta bcftool consensu h f referencefasta phasedvcfgz haplotypefasta referencefasta refer fasta format phasedvcf phase vcf afterward haplotypefasta haplotypefasta contain two haplotyp note problem input vcf bcftool version may give error messag instead creat file ident input referencefasta precaut may want make sure two haplotyp fasta file inde differ input refer fasta visual phase result sometim help visual inspect phase result look genom browser step assum use integr genom viewer igv gtf haplotyp block whatshap creat gtf file phase vcf file describ haplotyp block phase result phasedvcf run whatshap stat gtfphasedgtf phasedvcf whatshap print statist phase vcf also creat file phasedgtf open phasedvcf phasedgtf igv order inspect haplotyp block structur exampl four haplotyp block clear variant connect imag _staticgtfpng haplotyp block interleav nest matepair pairedend read use phase gtf track note block appear exon connect horizont line shown screenshot color read often lot interest also show read along variant run whatshap haplotag subcommand phase vcf file tag read bam file hpi hpi depend haplotyp belong also add ps tag describ haplotyp block read align read alignmentsbam run whatshap haplotag haplotaggedbam refer referencefasta phasedvcf alignmentsbam haplotag command redetect allel read way main phase command sinc avail refer influenc done use refer phase command als use refer use x genom bam file haplotag read bx tag per default assign read belong read cloud haplotyp featur switch use ignorelinkedread flag input vcf may phase program whatshap long phase info record ps hp tag also read input bam file one use phase even phase use one set read assign haplotyp entir differ set read sampl command creat bam file haplotaggedbam tag read open igv visual haplotyp block right click bam track choos color align tag type ps click ok exampl look like color read alon easi see four haplotyp block imag _statichaplotaggedpspng also visual haplotyp assign choos color align tag type hp addit may want also sort align hp tag use option sort align rightclick context menu impress look like read color red belong one haplotyp one blue belong gray read could tag usual dont cover heterozyg variant imag _statichaplotaggedhppng genotyp variant besid phase whatshap also regenotyp variant given vcf file contain variant posit comput genotyp likelihood three genotyp output vcf file togeth genotyp predict genotyp run use follow command whatshap genotyp genotypedvcf inputvcf inputbam predict genotyp store output vcf use gt tag gl tag provid logscal likelihood comput genotyp algorithm phase provid refer sequenc strongli recommend order enabl realign mode whatshap genotyp refer reffasta genotypedvcf inputvcf inputbam _instal instal instal whatshap easiest use conda instal conda first ensur conda miniconda anaconda instal made proper set enabl bioconda channel follow bioconda instal instruct httpsbiocondagithubioinstallconda_ whatshap instal command conda instal whatshap conda enabl bioconda use command conda instal c bioconda c condaforg whatshap instal pip pip instal need instal depend pip instal whatshap implement c python need c compil python later correspond python header file python slightli faster ubuntu instal packag buildessenti pythondev take care requir depend whatshap instal pip pip instal user whatshap instal whatshap homelocalbin add homelocalbin path run tool export pathhomelocalbinpath whatshap help altern also instal whatshap virtual environ familiar instal unreleas develop version reason want use recent develop version whatshap instal follow way instruct creat virtual environ directori whatshapenv contain whatshap simpli delet directori uninstal softwar whatshap version may instal locat remain unaffect python venv whatshapenv whatshapenvbinpip instal cython whatshapenvbinpip instal githttpsbitbucketorgwhatshapwhatshap run whatshap like whatshapenvbinwhatshap version see version number like gebc mean version git commit ahead version question answer whatshap use refer panel refer panel use populationbas phaser like beagl shapeit although consid integr whatshap take advantag refer panel right case popul data suggest produc populationbas phase use beagl httpsfacultywashingtonedubrowningbeaglebeaglehtml_ shapeit httpsmathgenstatsoxacukgenetics_softwareshapeitshapeithtml_ etc readbas phase use whatshap separ compareintegr result postprocess step illumina data lead good readbas phase illumina pairedend data ideal readbas phase sinc pair heterozyg snp bridg read pair howev whatshap attempt produc long haplotyp block possibl run whatshap henc tell phaseinform input data take look number size produc haplotyp block larg canshould pedigre pedigreeawar readbas phase ie use option codep pedigre mode whatshap intend intermediates pedigre runtim core phase step linear matht matht number trio relationship number children pedigre recommend use pedigre matht pedigre readdata unnecessari case anyway highqual phase obtain genet haplotyp method like merlin httpcsgsphumicheduabecasismerlintourhaplotypinghtml_ includ readmerst tabl content toctre maxdepth instal guid faq develop note howtocit chang indic tabl refgenindex refmodindex refsearch imag httpsimgshieldsiopypivwhatshapsvgbranchmast target httpspypipythonorgpypiwhatshap imag httpssemaphorecicomapivwhatshapwhatshapbranchesmastershields_badgesvg target httpssemaphorecicomwhatshapwhatshap imag httpsimgshieldsiobadgeinstallwithbiocondabrightgreensvg target httpbiocondagithubiorecipeswhatshapreadmehtml imag httpsbitbucketorgrepoajxbdimageswhatshap_logopng whatshap whatshap softwar phase genom variant use dna sequenc read also call readbas phase haplotyp assembl especi suitabl long read work also well short read pleas refcit us use whatshap howtocit featur accur result martin et al whatshap fast accur readbas phase httpsdoiorg_ work well illumina pacbio oxford nanopor type read phase snv indel even complex variant tcg agaa pedigre phase mode use read relat individu trio improv result reduc coverag requir garg et al readbas phase relat individu httpsdoiorgbioinformaticsbtw_ whatshap refeasi instal instal refeasi use userguid pass vcf one bam file get phase vcf support multisampl vcf produc standardcompli vcf output default desir get output compat readbackedphas open sourc mit licens document bitbucket page httpsbitbucketorgwhatshapwhatshap_ read document onlin httpswhatshapreadthedocsio_ offlin document avail doc subdirectori repositori download tar distribut mail list run public mail list httpslistscwinlmailmanlistinfowhatshap_ pleas dont hesit post question comment _howtocit cite includ citationrst