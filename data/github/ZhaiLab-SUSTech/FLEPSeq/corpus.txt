flepseq analysi pipelin flepseq toolset use analyz sequenc data gener either nanopor pacbio use flepseq method exampl script plote httpsnbviewerjupyterorggithubzhailabsustechflepseqblobmasterscriptflepfigure_exampleipynb refer httpswwwnaturecomarticless jia j long zhang h et al posttranscript splice nascent rna contribut widespread intron retent plant nat plant httpsdoiorg softwar packag requir minknow minion softwar httpscommunitynanoporetechcomdownload requir nanopor sequenc guppi v httpscommunitynanoporetechcomdownload requir nanopor data basecal cc httpsgithubcompacificbiosciencescc requir pacbio data analysi lima httpsgithubcompacificbiosciencesbarcod requir pacbio data analysi minimap httpsgithubcomlhminimap samtool httpwwwhtsliborg blast httpsftpncbinlmnihgovblastexecutablesblastlatest requir nanopor data analysi python follow packag pysam httpsgithubcompysamdeveloperspysam ont_fast_api httpsgithubcomnanoporetechont_fast_api panda httpspandaspydataorg numpi httpsnumpyorg matplotlib httpsmatplotliborg joblib httpsgithubcomjoblibjoblib click httpsclickpalletsprojectscomenx r follow packag tidyvers httpswwwtidyverseorg optpars httpscranrprojectorgwebpackagesoptparseindexhtml step step workflow script deposi script directori use help view help inform nanopor data analysi pipelin nanopor basecal use minknow perform realtim basecal sequenc use gpu version guppi speed basecal sequenc minknow guppi avail via nanopor commun site httpscommunitynanoporetechcom commandlin run guppi basecal follow guppy_basecal raw_fast_dir out_fast_dir c dna_r_bps_haccfg recurs fast_out disable_p qscore_filt devic cudaal convert fastq file fasta format python fastqdirfastapi indir pathtofastq_pass allfasta use minimap map read refer genom minimap ax splice secondaryno genomefasta allfasta tmpsam caution organ short intron arabidopsi might better use paramet g set max intron length exampl g also set number_of_thread use thread speed samtool sort mappedbam tmpsam samtool index mappedbam rm tmpsam option remov rrna trna deriv read python filter_rrna_bampi inbam mappedbam inb rrnatrnaetcb cleanbam samtool index cleanbam find adapt read python adapterfinderpi inbam cleanbam inseq allfasta adapterresulttxt thread identifi polya tail estim length python polyacallerpi inadapt adapterresulttxt summari sequencing_summarytxt fastdir fast_dir polya_tailresulttxt thread extract read inform pipelin produc tabl contain intron retent inform pol ii posit python extract_read_infopi inbam cleanbam inb libexon_intron_posreprb read_inforesulttxt merg analysi result rscript merge_read_infor type nanopor inreadinfo read_inforesulttxt inadapt adapterresulttxt inpolya polya_tailresulttxt readinfotxt analyz splice kinet python prepare_data_for_splice_kineticspi inreadinfo readinfotxt inb libexon_intron_posreprb readintronpossplicingtxt rscript plot_intron_splicing_kineticsr inrelpo readintronpossplicingtxt inreadinfo readinfotxt inintron libselect_intronstxt readsplicing_kineticstxt pdf readsplicing_kineticspdf calcul intron retent ratio polyadenyl transcript rscript cal_polya_transcript_irr inrelpo readintronpossplicingtxt inreadinfo readinfotxt outrna mrnaincompletely_spliced_ratiotxt outintron intronunspliced_ratiotxt pacbio data analysi pipelin gener highli accur singlemolecul consensu read use cc timeconsum step pacbio data analysi data use subread requir h gener consensu sequenc hifiread intel xeon cpu ghz cc numthread minrq reportfil ccsreport inputsubreadsbam ccsbam remov adapt use lima echo primer_pnaagcagtggtatcaacgcagagtacattgatggtgcctacagnprimer_pnaagcagtggtatcaacgcagagtacatgggn primerfasta lima j ccsbam primerfasta limabam isoseq peekguess python lima_bamfastapi infil limaprimer_pprimer_pbam allfasta use minimap map read refer genom remov rrna trna deriv read step nanopor pipelin identifi polya tail estim length python pacbio_find_polyapi inbam cleanbam inseq allfasta polya_tailresulttxt extract read inform step nanopor pipelin merg analysi result rscript merge_read_infor type pacbio inreadinfo read_inforesulttxt inpolya polya_tailresulttxt readinfotxt analyz splice kinet calcul intron retent ratio polyadenyl transcript step nanopor pipelin illumina data analysi pipelin use hisat map read refer genom hisat x lib_pathath_hisat_genom p minintronlen maxintronlen dta time rfastqgz rfastqgz hisatsam samtool sort hisatbam hisatsam samtool index hisatbam rm hisatsam use picard remov pcr duplic read java jar soft_pathpicardjar markdupl remove_duplicatestru sorting_collection_size_ratio ihisatbam ohisatmarkdumpbam mhisatmarkdumptxt samtool index hisatmarkdumpbam calcul unsplic splice ratio intron python ascallerpi hisatmarkdumpbam irratiotxt file_intron_po libintron_posreprtxt strand_flag min_overlap strandspecif librari set strand_flag rightmost end fragment first sequenc set strand_flag leftmost end fragment first sequenc output import output readinfotxt gener merge_read_infor plain file seprat tab includ import column read_core_id mrna retention_intron polya_length type type valu elong splicing_intermedi elongating__mapping_low_accuraci elongating_lost polya polya__not_in_last_exon polya_lost ps column readinfotxt file column use script develop read_core_id dedfeabceedechr gener extract_read_infopi chr chr chromatin name read_start align start base read_end align end read_strand align strand read_exon_total_num total number read exon mrna atg mrna name mrna_intron_num total intron number mrna mrna_start mrna_end mrna_strand mrna_length mrna_po end posit read rel end mrna base mrna_po end poistion read rel end mrna base rel_mrna_po see indic wrong annot map rel_mrna_po mrna_po rel_mrna_po see indic wrong annot map rel_mrna_po mrna_po total_coverag total coverag length mrna f_read_exon_num see f_feature_typ intron f_feature_num f_feature_length f_po f_po l_read_exon_num l_feature_typ exon l_feature_num l_feature_length l_po l_po end_typ see retention_intron retain intron seprat intron number order mrna mrna retention_intron_num total number retain intron span_intron_num total number intron read overlap first span intron f_feature_num last span intron l_feature_num gener polyacallerpi pacbio_find_polyapi polya_start_raw polya_end_raw polya_scor gener nanopor data polya_start_raw raw signal event index potenti polya region polya_end_raw raw signal event index potenti polya region polya_start_bas polya_end_bas polya_length polya_scor polya_start_raw polya_end_raw gener adapterfinderpi nanopor data read_align_strand rna_strand read_length read total length primer_typ rf genome_align_start genome_align_end primer_scor polya_typ shown f_primer_typ r f_primer_start f_align_end r_primer_typ f r_primer_start r_align_start gener merge_read_infor end_alignment_scor nanopor data end_polya_typ endss_typ type elong inform use script develop read_core_id due one read may map multipl posit merg read id map inform repres align read_id fabcbfaedfddbab read_core_id fabcbfaedfddbabchr note logic read_core_id may also uniqu thu need remov duplic merg step read exon exon inform read bam file base th column cigar string consid n repres intron junction cigar string consid indel split read exon junction exon intron exon intron exon intron exon gene exon intron read cigar mnm read_exonbp bp read_exonbp mrna_po mrna_po rel_mrna_po rel_mrna_po dont care align direct read havent identifi adapt posit thu dont know orign mrna strand read gene length l repes gene mrna po mrna po gene mrna po mrna_po rel_mrna_po rel_mrna_po exon intron mrna read mrna_po mrna_po rel_mrna_po rel_mrna_po inconsist result read arabidopsi rel_mrna_po mrna_po indic wrong map wrong transcript annot pipelin consid repres transcript remov merg step mainli due altern splice mismap polya tri set less max intron length map step suitabl genom long intron also remov two side map read exon base polya inform f_featur l_featur exon intron exon intron exon mrna read f_featur end featur overlap read exampl first exon exon thu f_feature_typ exon f_feature_num first read exon read overlap thu f_read_exon_num f_po f_po posit read exon rel exon valu like mrna_po mrna_po l_featur end featur overlap read exampl second intron intron thu l_feature_typ intron l_feature_num second read exon read overlap thu l_read_exon_num intron retent intron overlap read f_featur would retent may affect ss b l_featur transcript hasnt finish retent c inner coverage_ratio retent end_typ mrna read end_typ end_typ end_typ end_typ end read overlap first exon end read overlap last exon noend end noend end primeradapt primer_p aagcagtggtatcaacgcagagtacatggg primer_p aagcagtggtatcaacgcagagtacattgatggtgcctacag primer_typ f mean primer_p r mean primer_p f_ indic read r_ indic read note f may f r r may f r genom read f_primerr_prim b read r_primerf_prim f_align_end r_align_start genome_align_start genome_align_end coordin read f_align_end r_align_start genome_align_start genome_align_end coordin adapt f_primer_start r_primer_start r_primer_start first two base r_primer map read exampl aagggagagagag read f_primerggagagagag one end primer type align n b f primer primer_start primer_f_max_start uf c r primer primer_start primer_r_max_start uur primer_r_max_start primer_start primer_r_max_start ur read adapt type base primer type end exampl fr indic primer f primer f kind primer type assign score also predict rna_strand primer type score reliabl end_typ end_polya_typ end_typ mrna read end_typ end_typ end_typ end_typ end read overlap first exon end read overlap last exon noend end noend end polya_typ polya polya_length polya polya_length end_polya_typ end_typ end_typ end_typ end_typ polya_typ polya_typ gener ircallerpi output tabsper file includ clolumn intron_id atg_intron chr_name chr intron_start base intron_end intron_strand intron_coverage_ratio b ab c iratio unsplic ratio intron sratio splice ratio intron oratio ratio altern splice oratio oratio o_typ o_count o_typ o_count other_o oooo b ab c column store count read specif read type gene structur c altern splice b ab b c ab iratio b aba b ab c sratio ca b ab c oratio oa b ab c altern splice format altern splice type oxxxstartend startend x x one valu mean splice annot splice site mean splice downstream splice site upstream splice site mean splice upstream splice site downstream splice site x splice site x splice site x exon skip one valu e e x care exon skip occur inner annot intron nubmer e mean number skip exon startend mean junction posit read overlap annot intron one read multipl junction posit sperat consid intron multipl altern splice type frequent type mark second frequent type mark type count ratio recor oratio o_ratio o_count o_count o_typ o_count column inforamt type recor other_o column typecounttypecout format exampel altern splice type gene structur inner inner inner right inner outer outer outer gene structur right inner oe exon skip oe right inner exon skip outer inner oe oe outer outer exon skip