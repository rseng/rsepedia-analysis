titl sisyph python packag simul system interact meanfield particl high effici tag python gpu particl meanfield selforgan swarm author name antoin diez affili affili name depart mathemat imperi colleg london south kensington campu london sw az uk index date june bibliographi docbiblio_sisyphebib summari past decad studi system particl becom import part mani research area theoret physic appli biolog comput mathemat one main motiv mathemat biolog model larg anim societi emerg complex pattern simpl behavior rule eg flock bird fish school ant coloni etc microscop world particl system use model wide rang phenomena collect motion spermatozoa anarch develop cancer cell within perspect least three import reason conduct larg scale comput simul particl system first numer experi essenti calibr model test influenc paramet control environ instanc renown vicsek model vicsek_novel_ minim model flock exhibit complex behavior studi numer particular chate_collective_ secondli particl simul use check valid macroscop model describ statist behavior particl system model usual base partial differenti equat pde deriv use phenomenolog consider often difficult justifi mathemat degond_continuum_ dimarco_selfalignment_ degond_bulk_ final inspir model biolog ever grow literatur design algorithm base simul artifici particl system solv tough optim problem kennedy_particle_ pinnau_consensusbased_ totzeck_trends_ grassi_particle_ construct new effici markov chain mont carlo method del_moral_measurevalued_ del_moral_mean_ doucet_sequential_ cappe_population_ clarte_collective_ simul system particl also core molecular dynam leihmkuhl although present librari specif written purpos sisyph librari build recent advanc hardwar softwar effici simul larg scale interact meanfield particl system gpu cpu versatil objectori python interfac librari design simul comparison new classic manyparticl model collect dynam mathemat activ matter physic enabl ambiti numer experi lead novel conjectur result statement need major difficulti simul system particl high comput cost typic quadrat number particl prevent larg scale experi implement sisyph base recent librari origin develop machin learn purpos significantli acceler tensor array comput name pytorch packag paszke_pytorch_ keop librari charlier_kernel_ gpu sisyph librari speed tradit python lowlevel implement one three order magnitud system sever million particl addit best knowledg modelspecif packag motsch_vicsek_microflat_ avail sisyph librari includ within common framework implement mani classic model variant well recent model implement previous avail model detail exampl galleri document directli taken literatur collect dynam mathemat activ matter physic moreov sisyph librari design way new custom model easili ad order facilit studi comparison model research perspect develop sisyph librari initi motiv studi bodyori particl giacomin_alignment_ formal deriv macroscop pde model particl system lead novel conjectur postul exist class socal bulk topolog state degond_bulk_ quantit comparison theoret predict numer simul particl system suitabl regim particl confirm exist new state matter studi physic properti observ numer experi readili explain pde model ongo work typic exampl typic model implement sisyph librari variant vicsek model introduc degond_continuum_ defin system n stratonovich stochast differenti equat beginequationlabeleqsd mathrmdxi_t c_ vi_t mathrmdt quad mathrmdvi_t sigma mathsfpvi_tcircji_tmathrmdtmathrmdbi_t endequ posit time particl index iinldotsn vector xi_tinmathbbrd orient veloc unit vector vi_tinmathbbrd vi_t coeffici c_ speed particl assum constant matrix mathsfpvi_t i_d vi_totim vi_t orthogon project matrix plane orthgon vi_t bi_t_t independ brownian motion sigma diffus coeffici model level nois quantiti ji_tinmathbbrd call target orient particl tri adopt vicsek model introduc degond_continuum_ beginequationlabeleqtarget ji_t fracsum_jn kxj_txi_tvj_tbigsum_jn kxj_txi_tvj_tbig endequ kernel kinftytoinfti smooth nonneg function vanish infin model visual percept particl vicsek model vision particl depend distanc target given autorefeqtarget particl tri adopt averag orient neighbor typic flock behavior comput timecontinu system given autorefeqsd need discret first vicsek model natur discret method geometr eulermaruyama scheme kloeden piggott gener discret method depend model consid illustr exampl galleri time step expens oper comput target given autorefeqtarget requir mathcalon oper n particl total simul cost thu mathcalont total number iter within framework keop librari sisyph base comput target autorefeqtarget call kernel oper effici carri use symbol definit ntime n interact matrix whose ijentri kxj_txi_t comput target understood symbol matrixvector product interact matrix vector orient acknowledg develop librari would possibl without help jean feydi constant support preciou advic project initi pierr degond grown mani discuss refer simul system interact meanfield particl high effici p aligncent img srcdoc_staticballpng altlogo width p pleas visit websitehttpssisyphereadthedocsioenlatest full document sisyph librari build recent advanc hardwar softwar effici simul larg scale interact particl system gpu cpu implement base recent librari origin develop machin learn purpos significantli acceler tensor array comput name pytorchhttpsgithubcompytorchpytorch packag keopshttpswwwkerneloperationsiokeopsindexhtml librari versatil objectori python interfac well suit comparison new classic manyparticl model enabl ambiti numer experi lead novel conjectur sisyph librari speed tradit python lowlevel implement one three order magnitud system sever million particl p aligncent img srcdoc_staticmillgif altmil p citat use sisyph research paper pleas cite joss publicationhttpsjosstheojorgpapersjoss articlediez doi joss url httpsdoiorgjoss year publish open journal volum number page author antoin diez titl sisyph python packag simul system interact meanfield particl high effici journal journal open sourc softwar diez sisyph python packag simul system interact meanfield particl high effici journal open sourc softwar httpsdoiorgjoss doihttpsjosstheojorgpapersjossstatussvghttpsdoiorgjoss instal requir python packag numpi scipi pytorch version pykeop version use pip termin type pip instal sisyph googl colab easiest way get work version sisyph use free virtual machin provid googl colabhttpscolabresearchgooglecom new colab notebook navig editnotebook set select gpu hardwar acceler dropdown instal pykeop colab specif first type pip instal pykeopscolab instal sisyph type pip instal sisyph test instal python termin type python import sisyph sisyphetest_sisyph p aligncent img srcdoc_staticbandgif altband p contribut contribut make sisyph grow warmli welcom exampl possibl ongo develop includ follow implement new model implement complex boundari condit model nonflat manifold improv visual method current basic visual function reli matplotlibhttpsmatplotliborg implement contribut made open issu github repositori via pull request contact directli author author antoin diezhttpsantoinediezgitlabio imperi colleg london acknowledg develop librari would possibl without help jean feydyhttpswwwjeanfeydycom constant support preciou advic project initi pierr degondhttpssitesgooglecomsitedegond grown mani discuss contribut thank interest sisyph contribut make librari grow warmli welcom exampl contribut exampl possibl ongo develop welcom contribut includ follow implement new model implement complex boundari condit model nonflat manifold improv visual method current basic visual function reli matplotlibhttpsmatplotliborg implement submit chang find bug unexpect behaviour pleas open issu github add new featur librari pleas send pull request clear descript done work model would like includ sisyph happi discuss beforehand either directli github email first exampl exampl variou model tutori basic featur instal requir python packag numpi scipi pytorch version pykeop version note order work version pykeop may necessari instal upgrad cmake cmake discuss httpsgithubcomgetkeopskeopsissues_ instal use pip termin type codeblock bash pip instal sisyph googl colab easiest way get work version sisyph use free virtual machin provid googl colab httpscolabresearchgooglecom_ new colab notebook navig editnotebook set select gpu hardwar acceler dropdown instal pykeop colab specif first type codeblock bash pip instal pykeopscolab instal sisyph type codeblock bash pip instal sisyph sourc altern clone git repositori httpsgithubcomantoinediezsisyphe_ locat choic test instal follow test function check configur run simul system bodyori particl see exampl galleri simul use main featur sisyph librari complex system nontrivi boundari condit samplingbas interact mechan blockspars reduct method nontrivi initi condit moreov model theoret wellunderstood httpsarxivorgabs_ provid theoret baselin check accuraci output simul warn function mainli intend run gpu run function cpu take long time see quick test procedur python termin type codeblock python import sisyph sisyphetest_sisyph fresh environ return codeblock consol welcom test function creat system bodyori particl mill configur cf exampl galleri test consid success comput mill speed within rel error rang around theoret valu run test may take minut check configur pykeop initi build folder dtypefloat langtorch rootcachepykeopscpython done pykeop compil libkeopstorchbebcc rootcachepykeopscpython formula sum_reductionsqnormx alias x vi vj dtype float pykeop compil pybind templat libkeops_template_ebb rootcachepykeopscpython done done pykeop torch bind work done sampl initi condit done creat model done run simul pykeop compil libkeopstorchaaf rootcachepykeopscpython formula sum_reductionstepvar sumsquarevar var stepminusvar var var var var stepvar var var var var var alias var var var var var var var dtype float done progressdon check result done sisyph work core function librari automat continu test github workflow base modul modsisyphetestquick_test test function includ basic comput simpl exampl comput simpl local averag variou situat small scale simul note unlik function methsisyphetest_sisyph test function check accuraci output simul check code run without error possibl use pytest packag httpsdocspytestorgenx_ run test manual python termin type codeblock python import pytest sisyphetest import quick_test retcod pytestmainquick_test__file__ benchmark compar fortran implement httpsgithubcomsmotschvicsek_microflat_ due s√©bastien motsch use verlet list method doubl precis float number run nextgen httpsysnewsmaicacukcomputecluster_ comput cluster imperi colleg london cpu version sisyph doubl precis tensor float blocksparsereduct method bsr run intel macbook pro ghz intel core processor go memori gpu version sisyph singl precis tensor float without refblocksparsereduct method tutobsr bsr run gpu cluster httpsysnewsmaicacukgpucomputing_ imperi colleg london use nvidia gtx ti gpu gpu version sisyph doubl precis tensor float without refblocksparsereduct method tutobsr bsr run gpu cluster httpsysnewsmaicacukgpucomputing_ imperi colleg london use nvidia gtx ti gpu note choic singl doubl precis tensor automat made accord float point precis input tensor run classvicsek sisyphemodelsvicsek model squar period box fix paramet mathl mathnu mathsigma mathcr mathdt variou choic mathn mathr simul run unit time ie iter valu mathn three valu mathr test correspond dilut regim moder regim dens meanfield regim particl uniformli scatter box averag number neighbour three regim respect mathsim mathsim mathsim regim strong effect effici verlet list blockspars reduct method tabl total comput time given second except exceed hour best time indic bold worst time ital fortran sisyph sisyph sisyph sisyph sisyph cpu bsr gpu gpu bsr gpu gpu bsr r n k r r r n k r r r h n r h h r h gpu implement least time faster dilut regim outperform method three order magnitud meanfield regim larg valu mathn without blockspars reduct method gpu implement suffer quadrat complex blockspars reduct method less sensit densiti particl tradit verlet list method come price higher memori cost see reftutobsr allow run larg scale simul even cpu cpu perform critic affect precis floatingpoint format simul doubl precis tensor shown note paramet blockspars reduct method chosen use method methbest_blocksparse_paramet sisypheparticlesparticlesbest_blocksparse_paramet see reftutobsr guidelin exampl gpu best number cell respect mathsim mathsim mathsim mathn mathn mathn sisyph mathsim mathsim mathsim sisyph note number cell automat cap mathlr last case sisyph mathr maxim number cell depend memori avail exampl case sisyph gpu bsr mathn mathr obtain follow script codeblock python import time import math import torch import sisyphemodel model sisyphedisplay import save dtype torchcudafloattensor replac follow line doubl precis tensor dtype torchcudadoubletensor n l dt nu sigma r c r type initi condit determin float point precis po ltorchrandntypedtyp vel torchrandnntypedtyp vel veltorchnormveldimreshapen simu modelsvicsek po po vel vel v r sigma sigma nu nu interaction_radiu r box_siz l dt dt block_sparse_reduct true number_of_cel simu__next__ gpu warmup timetim data savesimu e timetim print background motiv imag _staticcorridorgif scale alt corridor align center scope applic past decad studi system particl becom import part mani research area theoret physic appli biolog comput mathemat current research trend includ follow sinc joint effort biologist physicist comput graphic scientist recent mathematician propos accur model larg selforgan anim societi motiv differ commun larg independ commmon goal abl explain reproduc emerg complex pattern simpl interact rule typic exampl complex system includ flock bird httpsenwikipediaorgwikiflock_birds_ fish school httpsenwikipediaorgwikishoaling_and_schooling_ herd mammal httpswwwyoutubecomwatchviflzcetj_ ant coloni httpsenwikipediaorgwikiant_colony_ seem reason consid none anim accut conscious whole system organ rather follow simpl behavior pattern stay close group collid anoth individu copi attitud close neighbour etc model often call swarm model collect dynam model citevicsek_collective_ degond_mathematical_ albi_vehicular_ naldi_particle_ microscop world full complex system made mani simpl entiti coloni bacteria citewensink_mesoscale_ natur exampl reminisc macroscop anim societi describ complex pattern also emerg system nonliv particl bodi actual complex selforgan assembl cell dictat everi aspect life brain work thank commun billion neuron citefournier_toy_ andreis_mckeanvlasov_ reproduct base competit million spermatozoa citecreppy_turbulence_ sometim death sadli caus relentless divis cancer cell unlik previou model commun particl base visual percept rather chemic agent physic geometr constraint etc complet differ side ever grow number method comput mathemat base simul system particl pioneer particl swarm optim method httpsenwikipediaorgwikiparticle_swarm_optimization_ citekennedy_particle_ shown biologicallyinspir artifici system particl use solv tough optim problem follow idea swarm intellig optim algorithm propos recent citepinnau_consensusbased_ totzeck_numerical_ grassi_particle_ totzeck_trends_ sinc begin particl system also core filter httpsenwikipediaorgwikiparticle_filter_ citecrisan_survey_ doucet_sequential_ kantas_overview_ del_moral_feynmankac_ del_moral_mean_ sampl httpsenwikipediaorgwikimonte_carlo_method_ method citecappe_population_ clarte_collective_ recent particlebas interpret citemei_mean_ chizat_global_ rotskoff_trainability_ de_bortoli_quantitative_ sirignano_mean_ train task neural network lead new theoret converg result need simul particl system beyond selfexplanatori applic particlebas algorithm comput mathemat simul system particl also crucial model tool physic biolog one hand field experi use collect data trigger new model idea hand numer simul becom necessari test idea calibr model numer experi conduct identifi mechan abl produc specif phenomena control environ citechate_collective_ theoret side direct mathemat studi particl system rapidli becom incred difficult inspir kinet theori gase httpsenwikipediaorgwikikinetic_theory_of_gases_ mani mesoscop macroscop model propos model averag statist behavior particl system rather individu motion particl citetoner_flocks_ degond_continuum_ naldi_particle_ within framework particl system rather seen fluid decrib partial differenti equat httpsenwikipediaorgwikipartial_differential_equation_ pde reminisc theori fluid dynam httpsenwikipediaorgwikifluid_dynamics_ pde model easili theoret numer tractabl howev cheke valid model alway easi sometim postul base phenomenolog consider order design good model often necessari go backandforth pde model numer simul underli particl system develop sisyph librari initi motiv studi classbodyori particl sisypheparticlesboparticl citegiacomin_alignment_ formal deriv macroscop pde model particl system lead novel conjectur postul exist class socal bulk topolog state citedegond_bulk_ quantit comparison theoret predict numer simul particl system httpsfigsharecomprojectsbulk_topological_states_in_a_new_collective_dynamics_model_ suitabl regim math particl confirm exist new state matter studi physic properti observ numer experi readili explain pde model ongo work meanfield particl system current model implement sisyph librari belong famili meanfield model mean motion particl influenc averag behavior whole system vicsek model httpsenwikipediaorgwikivicsek_model_ citevicsek_novel_ degond_continuum_ cuckersmal model citecucker_mathematics_ ha_emergence_ naldi_particle_ two popular exampl meanfield model particl tri move averag direct motion neighbour produc socal flock behavior mathemat point view mathemat point view meanfield particl system mathn particl defin markov process mathmathbbrdn gener mathmathcall_n whose action test function mathvarphi_n form math mathcall_nvarphi_nxldotsxn sum_in l_mu_mathbfxndiamond_i varphi_n xldotsxn mathmathbfxn xldotsxnin mathbbrdn math mu_mathbfxn fracnsum_in delta_xi socal empir measur oper mathl_mu_mathbfx_n depend empir measur act onevari test function mathmathbbrd given oper mathl test function mathvarphi_n notat mathldiamond_i varphi_n denot function math ldiamond_i varphi_n xldotsxn mathbbrdn mapsto lxmapstovarphi_nx_ldotsxixxildotsxnxiin mathbbr dynam meanfield system depend oper mathl_mu_mathbfx_n typic either diffus oper httpsenwikipediaorgwikidiffusion_process_ citedegond_continuum_ ha_emergence_ jump oper httpsenwikipediaorgwikijump_process_ citedimarco_selfalignment_ andreis_mckeanvlasov_ first case meanfield particl system altern defin system mathn coupl stochast differenti equat httpsenwikipediaorgwikistochastic_differential_equation_ form math mathrmdxi_t bxi_tmu_mathcalxn_tmathrmdt sigmaxi_tmu_mathcalxn_tmathrmd bi_tquad iinldotsn math mu_mathcalxn_t fracnsum_in delta_xi_t mathbi_t_t mathn independ brownian motion coeffici mathb mathsigma call drift diffus coeffici case coeffici linear quasilinear mean form math bxi_tmu_mathcalxn_t tildebleftxi_t fracnsum_jn kxi_txj_tright two given function mathtildebmathbbrdtimesmathbbrntomathbbrd mathkmathbbrdtimesmathbbrdto mathbbrn particl initi statist independ shown mathntoinfti particl mathxi_t converg toward independ copi solut socal mckeanvlasov diffus process citemckean_propagation_ sznitman_topics_ meleard_asymptotic_ defin stochast differenti equat math mathrmdoverlinex_t boverlinex_tf_tmathrmdt sigmaoverlinex_tf_tmathrmd b_t mathb_t_t brownian motion mathf_t law process mathoverlinex_t satisfi fokkerplanck partial differenti equat math partial_t f_t nablacdotbxf_tf_t fracsum_ijn partial_x_ipartial_x_ja_ijxf_tf_t mathxx_ldotsx_din mathbbrd mathasigmasigmamathrmt phenomenon call propag chao follow terminolog introduc kac citekac_foundations_ mckean_propagation_ sznitman_topics_ meleard_asymptotic_ hauray_kacs_ note popular exampl meanfield particl system stochast cuckersmal model citecucker_mathematics_ ha_emergence_ naldi_particle_ particl defin posit mathxi_t inmathbbrd veloc mathvi_tinmathbbrd evolv accord system mathn stochast differenti equat math mathrmdxi_t vi_tmathrmdtquad mathrmdvi_t fracnsum_in kxj_txi_tvj_tvi_tmathrmdt mathrmdbi_t mathkinftytoinfti observ kernel model visual percept particl exampl function mathk smooth function vanish infin commun particl base distanc motion particl follow newton law motion addit stochast term term mathvj_tvi_t relax forc quadrat potenti tend align veloc particl mathi particl mathj simul meanfield particl system comput exampl timecontinu need discret use instanc one classic numer scheme httpsenwikipediaorgwikieuleremaruyama_method_ stochast differenti equat difficulti lie evalu empir measur timestep numer scheme exampl cuckersmal model forc exert particl sum mathn small relax forc order mathn total number oper requir thu order mathmathcalon particl sinc mathn particl total time complex algorithm thu mathmathcalont matht total number iter numer scheme quadrat cost main bottleneck simul meanfield particl system explain document keop librari httpswwwkerneloperationsiokeopsintroductionwhy_using_keopshtml_ evalu mathn forc time matht math f_it fracnsum_in kxj_txi_tvj_tvi_t quad iinldotsn call kernel oper understood discret convolut oper matrixvector product matrix distanc mathk_ij_ijinldotsn mathk_ij kxj_txi_t vector veloc mathvj_tvi_t_jinldot n mathn larg say mathn oper costli even arraybas program languag matlab mathntim n kernel matrix mathk_ij_ij would simpli fit memori lower level languag fortran c oper implement effici two nest loop significantli higher global code effort less versatil past decad sever workaround propos popular method includ lowrank decomposit httpsenwikipediaorgwikilowrank_matrix_approximations_ kernel matrix fastmultipol method citegreengard_fast_ treat differ short longrang interact verlet list method httpsenwikipediaorgwikiverlet_list_ base grid decompost spatial domain reduc problem shortrang interact subset particl system random batch method citejin_random_ base stochast approxim interact randomli sampl subset batch particl system comput method requir signific amount work either term code justifi approxim procedur sisyph librari present implement base recent librari origin develop machin learn purpos significantli acceler tensor array comput name pytorch httpsgithubcompytorchpytorch_ packag keop httpswwwkerneloperationsiokeopsindexhtml_ librari citecharlier_kernel_ use keop framework kernel matrix symbol matrix defin mathemat formula approxim requir comput interact time discret sisyph librari speed tradit python lowlevel cpu implement one three order magnitud system sever million particl although librari mainli intend use gpu implement fulli function cpu signific gain effici moreov versatil objectori python interfac well suit comparison studi new classic manyparticl model aspect fundament applic order conduct ambiti numer experi systemat framework even particl complex structur significantli reduc comput cost refer bibliographi sisyph document master file creat sphinxquickstart thu apr adapt file complet like least contain root toctre direct simul system interact meanfield particl high effici imag _staticballpng scale alt ball align center sisyph librari build recent advanc hardwar softwar effici simul larg scale interact particl system gpu cpu implement base recent librari origin develop machin learn purpos significantli acceler tensor array comput name pytorch httpsgithubcompytorchpytorch_ packag keop httpswwwkerneloperationsiokeopsindexhtml_ librari versatil objectori python interfac well suit comparison new classic manyparticl model enabl ambiti numer experi lead novel conjectur sisyph librari speed tradit python lowlevel implement one three order magnitud system sever million particl project host github httpsgithubcomantoinediezsisyphe_ permiss mit licens httpsenwikipediaorgwikimit_license_ br pypi version joss paper doc badg imag _staticmillgif scale alt mill align center citat use sisyph research paper pleas cite joss public httpsjosstheojorgpapersjoss_ articlediez doi joss url httpsdoiorgjoss year publish open journal volum number page author antoin diez titl sisyph python packag simul system interact meanfield particl high effici journal journal open sourc softwar diez sisyph python packag simul system interact meanfield particl high effici journal open sourc softwar httpsdoiorgjoss contribut contribut make sisyph grow warmli welcom exampl possibl ongo develop includ follow implement new model implement complex boundari condit model nonflat manifold improv visual method current basic visual function reli matplotlib httpsmatplotliborg_ implement contribut made open issu github repositori via pull request contact directli author imag _staticbandgif scale alt band align center author antoin diez httpsantoinediezgitlabio_ imperi colleg london acknowledg develop librari would possibl without help jean feydi httpswwwjeanfeydycom_ constant support preciou advic project initi pierr degond httpssitesgooglecomsitedegond_ grown mani discuss tabl content toctre maxdepth backgroundrst toctre maxdepth installationrst toctre maxdepth benchmarkrst toctre maxdepth caption tutori exampl _auto_tutorialsindex _auto_examplesindex toctre maxdepth caption api apiapi_particl apiapi_model apiapi_kernel apiapi_sampl apiapi_display apiapi_toolbox indic tabl refgenindex refmodindex refsearch pypi version imag httpsimgshieldsiopypivsisyphecolorblu target httpspypiorgprojectsisyph joss paper imag httpsjosstheojorgpapersjossstatussvg target httpsdoiorgjoss doc badg imag httpsreadthedocsorgprojectssisyphebadgeversionlatest target httpssisyphereadthedocsioenlatestbadgelatest alt document statu br raw html br orphan _sphx_glr__auto_examples_sg_execution_tim comput time total execut time _auto_exampl file refsphx_glr__auto_examples_plot_bandspi plot_bandspi mb refsphx_glr__auto_examples_plot_bo_millingpi plot_bo_millingpi mb refsphx_glr__auto_examples_plot_millingpi plot_millingpi mb refsphx_glr__auto_examples_plot_sphere_bandspi plot_sphere_bandspi mb refsphx_glr__auto_examples_plot_volume_exclusionpi plot_volume_exclusionpi mb edit file automat gener sphinxgalleri make chang edit sourc python file _auto_examplesplot_millingpi line number given html note class sphxglrdownloadlinknot click refher sphx_glr_download__auto_examples_plot_millingpi download full exampl code rstclass sphxglrexampletitl _sphx_glr__auto_examples_plot_millingpi _examplemil mill exampl mill behaviour gener python sourc line first standard import gener python sourc line codeblock default import os import sy import time import math import torch import numpi np matplotlib import pyplot plt import sisyphemodel model sisyphedisplay import display_kinetic_particl use_cuda torchcudais_avail dtype torchcudafloattensor use_cuda els torchfloattensor gener python sourc line mill dorsogna et al model let us creat instanc attractionrepuls model introduc r dorsogna l chuang l bertozzi l chay selfpropel particl softcor interact pattern stabil collaps phi rev lett vol particl system satisfi ode math fracmathrmdxi_tmathrmdt vi_t math fracmathrmdvi_tmathrmdt alphabetavi_tvi_t fracmnnabla_xisum_jn uxi_txj_t mathu mors potenti math ur c_amathrmerell_ac_rmathrmerell_r gener python sourc line codeblock default n mass l ca la cr lr alpha beta v mathsqrtalphabeta po ltorchrandntypedtyp vel torchrandnntypedtyp vel veltorchnormveldimreshapen vel vvel dt simu modelsattractionrepulsionpospo velvel interaction_radiusmathsqrtmass box_sizel propuls alpha friction beta ca ca la la cr cr lr lr dtdt p isaveragetru gener python sourc line run simul unit time plot frame ode system solv use rungekutta numer scheme gener python sourc line codeblock default frame timetim op display_kinetic_particlessimufram e timetim rstclass sphxglrhorizont imag _auto_examplesimagessphx_glr_plot_milling_png alt selfpropuls attractionrepuls paramet n alpha beta ca la cr lr time class sphxglrmultiimg imag _auto_examplesimagessphx_glr_plot_milling_png alt selfpropuls attractionrepuls paramet n alpha beta ca la cr lr time class sphxglrmultiimg imag _auto_examplesimagessphx_glr_plot_milling_png alt selfpropuls attractionrepuls paramet n alpha beta ca la cr lr time class sphxglrmultiimg imag _auto_examplesimagessphx_glr_plot_milling_png alt selfpropuls attractionrepuls paramet n alpha beta ca la cr lr time class sphxglrmultiimg imag _auto_examplesimagessphx_glr_plot_milling_png alt selfpropuls attractionrepuls paramet n alpha beta ca la cr lr time class sphxglrmultiimg imag _auto_examplesimagessphx_glr_plot_milling_png alt selfpropuls attractionrepuls paramet n alpha beta ca la cr lr time class sphxglrmultiimg imag _auto_examplesimagessphx_glr_plot_milling_png alt selfpropuls attractionrepuls paramet n alpha beta ca la cr lr time class sphxglrmultiimg imag _auto_examplesimagessphx_glr_plot_milling_png alt selfpropuls attractionrepuls paramet n alpha beta ca la cr lr time class sphxglrmultiimg imag _auto_examplesimagessphx_glr_plot_milling_png alt selfpropuls attractionrepuls paramet n alpha beta ca la cr lr time class sphxglrmultiimg imag _auto_examplesimagessphx_glr_plot_milling_png alt selfpropuls attractionrepuls paramet n alpha beta ca la cr lr time class sphxglrmultiimg rstclass sphxglrscriptout codeblock none progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress gener python sourc line print total simul time averag time per iter gener python sourc line codeblock default printtot time stre second printaverag time per iter stressimuiter second rstclass sphxglrscriptout codeblock none total time second averag time per iter second gener python sourc line mill vicsek model let us creat instanc asynchronuo vicsek model bound cone vision bound angular veloc introduc costanzo c k hemelrijk spontan emerg mill vortex state vicseklik model j phi appl phi gener python sourc line codeblock default n r l nu sigma kappa nusigma c angvel_max nu po ltorchrandntypedtyp vel torchrandnntypedtyp vel veltorchnormveldimreshapen dt gener python sourc line add option target gener python sourc line codeblock default target name normalis paramet option bounded_angular_veloc angvel_max angvel_max dt nu simumodelsasynchronousvicsekposposvelvel vc jump_ratenukappakappa interaction_radiusr box_sizel vision_anglemathpi axi none boundary_conditionsperiod varianttarget optionsopt sampling_methodprojected_norm gener python sourc line run simul unit time plot frame gener python sourc line codeblock default sphinx_gallery_thumbnail_numb frame timetim op display_kinetic_particlessimufram e timetim rstclass sphxglrhorizont imag _auto_examplesimagessphx_glr_plot_milling_png alt asynchron vicsek normalis paramet n r jump rate kappa v time class sphxglrmultiimg imag _auto_examplesimagessphx_glr_plot_milling_png alt asynchron vicsek normalis paramet n r jump rate kappa v time class sphxglrmultiimg imag _auto_examplesimagessphx_glr_plot_milling_png alt asynchron vicsek normalis paramet n r jump rate kappa v time class sphxglrmultiimg imag _auto_examplesimagessphx_glr_plot_milling_png alt asynchron vicsek normalis paramet n r jump rate kappa v time class sphxglrmultiimg imag _auto_examplesimagessphx_glr_plot_milling_png alt asynchron vicsek normalis paramet n r jump rate kappa v time class sphxglrmultiimg imag _auto_examplesimagessphx_glr_plot_milling_png alt asynchron vicsek normalis paramet n r jump rate kappa v time class sphxglrmultiimg imag _auto_examplesimagessphx_glr_plot_milling_png alt asynchron vicsek normalis paramet n r jump rate kappa v time class sphxglrmultiimg imag _auto_examplesimagessphx_glr_plot_milling_png alt asynchron vicsek normalis paramet n r jump rate kappa v time class sphxglrmultiimg imag _auto_examplesimagessphx_glr_plot_milling_png alt asynchron vicsek normalis paramet n r jump rate kappa v time class sphxglrmultiimg imag _auto_examplesimagessphx_glr_plot_milling_png alt asynchron vicsek normalis paramet n r jump rate kappa v time class sphxglrmultiimg rstclass sphxglrscriptout codeblock none progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress gener python sourc line print total simul time averag time per iter gener python sourc line codeblock default printtot time stre second printaverag time per iter stressimuiter second rstclass sphxglrscriptout codeblock none total time second averag time per iter second rstclass sphxglrtime total run time script minut second _sphx_glr_download__auto_examples_plot_millingpi html contain sphxglrfooter class sphxglrfooterexampl contain sphxglrdownload sphxglrdownloadpython downloaddownload python sourc code plot_millingpi plot_millingpi contain sphxglrdownload sphxglrdownloadjupyt downloaddownload jupyt notebook plot_millingipynb plot_millingipynb html rstclass sphxglrsignatur galleri gener sphinxgalleri httpssphinxgallerygithubio_ edit file automat gener sphinxgalleri make chang edit sourc python file _auto_examplesplot_bandspi line number given html note class sphxglrdownloadlinknot click refher sphx_glr_download__auto_examples_plot_bandspi download full exampl code rstclass sphxglrexampletitl _sphx_glr__auto_examples_plot_bandspi band classic vicsek model squar period domain known httpsarxivorgabs_ produc bandlik structur dilut regim structur also appear meanfield regim showcas effici sisyph librari simul meanfield classvicsek sisyphemodelsvicsek model target methmax_kappa sisypheparticleskineticparticlesmax_kappa math particl gener python sourc line first standard import gener python sourc line codeblock default import os import sy import time import math import torch import numpi np matplotlib import pyplot plt use_cuda torchcudais_avail dtype torchcudafloattensor use_cuda els torchfloattensor gener python sourc line set paramet creat instanc vicsek model gener python sourc line codeblock default import sisyphemodel model n l dt nu sigma kappa nusigma r c po ltorchrandntypedtyp vel torchrandnntypedtyp vel veltorchnormveldimreshapen simumodelsvicsekposposvelvel vc sigmasigmanunu interaction_radiusr box_sizel boundary_conditionsperiod variant name max_kappa paramet kappa_max option numerical_schemeproject dtdt block_sparse_reductiontru gener python sourc line check mean field regim gener python sourc line codeblock default nneigh simunumber_of_neighbour printth isol particl strnneighminitem neighbour printth least isol particl strnneighmaxitem neighbour rstclass sphxglrscriptout codeblock none isol particl neighbour least isol particl neighbour gener python sourc line set block spars paramet optim valu gener python sourc line codeblock default fastest nb_cell average_simu_tim simulation_tim simubest_blocksparse_paramet pltplotnb_cellsaverage_simu_tim pltshow imag _auto_examplesimagessphx_glr_plot_bands_png alt plot band class sphxglrsingleimg rstclass sphxglrscriptout codeblock none progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress gener python sourc line creat function comput center mass system toru gener python sourc line codeblock default def center_of_massparticl cos_po torchcosmathpi l particlespo sin_po torchsinmathpi l particlespo average_co cos_possum average_sin sin_possum center torchatanaverage_sin average_co center l mathpi torchremaindercent mathpi return center gener python sourc line let us save posit veloc k particl center mass system unit time gener python sourc line codeblock default sisyphedisplay import save frame timetim data savesimuframespo velcenter_of_mass nsave save_filefals e timetim rstclass sphxglrscriptout codeblock none progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress gener python sourc line print total simul time averag time per iter gener python sourc line codeblock default printtot time stre second printaverag time per iter stressimuiter second rstclass sphxglrscriptout codeblock none total time second averag time per iter second gener python sourc line end simul plot particl evolut center mass gener python sourc line codeblock default sphinx_gallery_thumbnail_numb f pltfigur figsiz frame rangelendatafram x dataposframecpu dataposframecpu u datavelframecpu v datavelframecpu ax fadd_subplotfram pltquiverxyuv axset_xlimxmin xmaxsimulcpu axset_ylimymin ymaxsimulcpu axset_titletimestrdataframesfram center datacenter_of_mass center_x center_i c center center_xappendc center_yappendc f pltfigur pltplotdatatimecenter_x pltylabelxcoordin center mass pltxlabeltim f pltfigur pltplotdatatimecenter_i pltylabelycoordin center mass pltxlabeltim pltshow rstclass sphxglrhorizont imag _auto_examplesimagessphx_glr_plot_bands_png alt time time time time class sphxglrmultiimg imag _auto_examplesimagessphx_glr_plot_bands_png alt plot band class sphxglrmultiimg imag _auto_examplesimagessphx_glr_plot_bands_png alt plot band class sphxglrmultiimg gener python sourc line still meanfield regim gener python sourc line codeblock default nneigh simunumber_of_neighbour printth isol particl strnneighminitem neighbour printth least isol particl strnneighmaxitem neighbour rstclass sphxglrscriptout codeblock none isol particl neighbour least isol particl neighbour rstclass sphxglrtime total run time script minut second _sphx_glr_download__auto_examples_plot_bandspi html contain sphxglrfooter class sphxglrfooterexampl contain sphxglrdownload sphxglrdownloadpython downloaddownload python sourc code plot_bandspi plot_bandspi contain sphxglrdownload sphxglrdownloadjupyt downloaddownload jupyt notebook plot_bandsipynb plot_bandsipynb html rstclass sphxglrsignatur galleri gener sphinxgalleri httpssphinxgallerygithubio_ edit file automat gener sphinxgalleri make chang edit sourc python file _auto_examplesplot_volume_exclusionpi line number given html note class sphxglrdownloadlinknot click refher sphx_glr_download__auto_examples_plot_volume_exclusionpi download full exampl code rstclass sphxglrexampletitl _sphx_glr__auto_examples_plot_volume_exclusionpi volum exclus gener python sourc line model introduc motsch peurichard shortrang repuls heleshaw problem model tumor growth j math biolog vol gener python sourc line first standard import gener python sourc line codeblock default import os import sy import time import math import torch import numpi np matplotlib import pyplot plt import sisyphemodel model sisyphedisplay import scatter_particl use_cuda torchcudais_avail dtype torchcudafloattensor use_cuda els torchfloattensor gener python sourc line repuls forc particl disk fix random radiu particl repel overlap forc exert particl locat mathx_j radiu mathr_j particl locat mathx_i radiu mathr_i math f fracalphar_i nabla_x_i uleftfracx_i x_jr_i r_jright potenti math us log textfor textand us textfor initi particl cluster small region strong overlap gener python sourc line codeblock default n rmin rmax r rmaxrmintorchrandntypedtypermin l po dtorchrandntypedtypedtorchtensorlltypedtyp dt simu modelsvolumeexclusionpospo interaction_radiusr box_sizel alpha division_r death_rat dtdt gener python sourc line run simul unit time use adapt timestep ensur energi attr system decreas gener python sourc line codeblock default sphinx_gallery_thumbnail_numb frame timetim scatter_particlessimufram e timetim rstclass sphxglrhorizont imag _auto_examplesimagessphx_glr_plot_volume_exclusion_png alt volum exclus paramet n alpha divis rate death rate time class sphxglrmultiimg imag _auto_examplesimagessphx_glr_plot_volume_exclusion_png alt volum exclus paramet n alpha divis rate death rate time class sphxglrmultiimg imag _auto_examplesimagessphx_glr_plot_volume_exclusion_png alt volum exclus paramet n alpha divis rate death rate time class sphxglrmultiimg imag _auto_examplesimagessphx_glr_plot_volume_exclusion_png alt volum exclus paramet n alpha divis rate death rate time class sphxglrmultiimg imag _auto_examplesimagessphx_glr_plot_volume_exclusion_png alt volum exclus paramet n alpha divis rate death rate time class sphxglrmultiimg imag _auto_examplesimagessphx_glr_plot_volume_exclusion_png alt volum exclus paramet n alpha divis rate death rate time class sphxglrmultiimg imag _auto_examplesimagessphx_glr_plot_volume_exclusion_png alt volum exclus paramet n alpha divis rate death rate time class sphxglrmultiimg imag _auto_examplesimagessphx_glr_plot_volume_exclusion_png alt volum exclus paramet n alpha divis rate death rate time class sphxglrmultiimg imag _auto_examplesimagessphx_glr_plot_volume_exclusion_png alt volum exclus paramet n alpha divis rate death rate time class sphxglrmultiimg imag _auto_examplesimagessphx_glr_plot_volume_exclusion_png alt volum exclus paramet n alpha divis rate death rate time class sphxglrmultiimg imag _auto_examplesimagessphx_glr_plot_volume_exclusion_png alt volum exclus paramet n alpha divis rate death rate time class sphxglrmultiimg imag _auto_examplesimagessphx_glr_plot_volume_exclusion_png alt volum exclus paramet n alpha divis rate death rate time class sphxglrmultiimg imag _auto_examplesimagessphx_glr_plot_volume_exclusion_png alt volum exclus paramet n alpha divis rate death rate time class sphxglrmultiimg rstclass sphxglrscriptout codeblock none progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress gener python sourc line print total simul time averag time per iter gener python sourc line codeblock default printtot time stre second printaverag time per iter stressimuiter second rstclass sphxglrscriptout codeblock none total time second averag time per iter second gener python sourc line note funni behaviour particl cluster size gener python sourc line repuls forc random birth random death system time particl die constant rate give birth new particl rate new particl ad next parent radiu gener python sourc line codeblock default n rmin rmax r rmaxrmintorchrandntypedtypermin l po dtorchrandntypedtypedtorchtensorlltypedtyp dt simu modelsvolumeexclusionpospo interaction_radiusr box_sizel alpha division_r death_rat dtdt nmax gener python sourc line run simul unit time use adapt timestep ensur energi attr sisyphemodelsvolumeexclusion system decreas gener python sourc line codeblock default frame timetim scatter_particlessimufram e timetim rstclass sphxglrhorizont imag _auto_examplesimagessphx_glr_plot_volume_exclusion_png alt volum exclus paramet n alpha divis rate death rate time class sphxglrmultiimg imag _auto_examplesimagessphx_glr_plot_volume_exclusion_png alt volum exclus paramet n alpha divis rate death rate time class sphxglrmultiimg imag _auto_examplesimagessphx_glr_plot_volume_exclusion_png alt volum exclus paramet n alpha divis rate death rate time class sphxglrmultiimg imag _auto_examplesimagessphx_glr_plot_volume_exclusion_png alt volum exclus paramet n alpha divis rate death rate time class sphxglrmultiimg imag _auto_examplesimagessphx_glr_plot_volume_exclusion_png alt volum exclus paramet n alpha divis rate death rate time class sphxglrmultiimg imag _auto_examplesimagessphx_glr_plot_volume_exclusion_png alt volum exclus paramet n alpha divis rate death rate time class sphxglrmultiimg imag _auto_examplesimagessphx_glr_plot_volume_exclusion_png alt volum exclus paramet n alpha divis rate death rate time class sphxglrmultiimg imag _auto_examplesimagessphx_glr_plot_volume_exclusion_png alt volum exclus paramet n alpha divis rate death rate time class sphxglrmultiimg imag _auto_examplesimagessphx_glr_plot_volume_exclusion_png alt volum exclus paramet n alpha divis rate death rate time class sphxglrmultiimg imag _auto_examplesimagessphx_glr_plot_volume_exclusion_png alt volum exclus paramet n alpha divis rate death rate time class sphxglrmultiimg imag _auto_examplesimagessphx_glr_plot_volume_exclusion_png alt volum exclus paramet n alpha divis rate death rate time class sphxglrmultiimg imag _auto_examplesimagessphx_glr_plot_volume_exclusion_png alt volum exclus paramet n alpha divis rate death rate time class sphxglrmultiimg imag _auto_examplesimagessphx_glr_plot_volume_exclusion_png alt volum exclus paramet n alpha divis rate death rate time class sphxglrmultiimg rstclass sphxglrscriptout codeblock none progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress gener python sourc line print total simul time averag time per iter gener python sourc line codeblock default printtot time stre second printaverag time per iter stressimuiter second rstclass sphxglrscriptout codeblock none total time second averag time per iter second rstclass sphxglrtime total run time script minut second _sphx_glr_download__auto_examples_plot_volume_exclusionpi html contain sphxglrfooter class sphxglrfooterexampl contain sphxglrdownload sphxglrdownloadpython downloaddownload python sourc code plot_volume_exclusionpi plot_volume_exclusionpi contain sphxglrdownload sphxglrdownloadjupyt downloaddownload jupyt notebook plot_volume_exclusionipynb plot_volume_exclusionipynb html rstclass sphxglrsignatur galleri gener sphinxgalleri httpssphinxgallerygithubio_ edit file automat gener sphinxgalleri make chang edit sourc python file _auto_examplesplot_sphere_bandspi line number given html note class sphxglrdownloadlinknot click refher sphx_glr_download__auto_examples_plot_sphere_bandspi download full exampl code rstclass sphxglrexampletitl _sphx_glr__auto_examples_plot_sphere_bandspi boundari cluster disk classic meanfield vicsek model bound disk domain gener python sourc line first standard import gener python sourc line codeblock default import os import sy import time import torch import numpi np matplotlib import pyplot plt sisyphedisplay import display_kinetic_particl use_cuda torchcudais_avail dtype torchcudafloattensor use_cuda els torchfloattensor gener python sourc line set paramet creat instanc vicsek model gener python sourc line codeblock default import sisyphemodel model n l dt nu sigma kappa nusigma r c center torchtensorlltypedtypereshap radiu l po ltorchrandntypedtyp poscentersum radiu outsum posout ltorchrandoutsumtypedtyp poscentersum radiu vel torchrandnntypedtyp vel veltorchnormveldimreshapen simumodelsvicsekposposvelvel vc sigmasigmanunu interaction_radiusr box_sizel boundary_conditionsspher variant name max_kappa paramet kappa_max option numerical_schemeproject dtdt block_sparse_reductiontru gener python sourc line set block spars paramet optim valu gener python sourc line codeblock default fastest nb_cell average_simu_tim simulation_tim simubest_blocksparse_paramet pltplotnb_cellsaverage_simu_tim pltshow imag _auto_examplesimagessphx_glr_plot_sphere_bands_png alt plot sphere band class sphxglrsingleimg rstclass sphxglrscriptout codeblock none progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress gener python sourc line run simul plot particl gener python sourc line codeblock default sphinx_gallery_thumbnail_numb frame timetim op display_kinetic_particlessimu frame n_dispmax e timetim rstclass sphxglrhorizont imag _auto_examplesimagessphx_glr_plot_sphere_bands_png alt vicsekmax_kappa paramet n r nu sigma v time class sphxglrmultiimg imag _auto_examplesimagessphx_glr_plot_sphere_bands_png alt vicsekmax_kappa paramet n r nu sigma v time class sphxglrmultiimg imag _auto_examplesimagessphx_glr_plot_sphere_bands_png alt vicsekmax_kappa paramet n r nu sigma v time class sphxglrmultiimg imag _auto_examplesimagessphx_glr_plot_sphere_bands_png alt vicsekmax_kappa paramet n r nu sigma v time class sphxglrmultiimg imag _auto_examplesimagessphx_glr_plot_sphere_bands_png alt vicsekmax_kappa paramet n r nu sigma v time class sphxglrmultiimg imag _auto_examplesimagessphx_glr_plot_sphere_bands_png alt vicsekmax_kappa paramet n r nu sigma v time class sphxglrmultiimg imag _auto_examplesimagessphx_glr_plot_sphere_bands_png alt vicsekmax_kappa paramet n r nu sigma v time class sphxglrmultiimg imag _auto_examplesimagessphx_glr_plot_sphere_bands_png alt vicsekmax_kappa paramet n r nu sigma v time class sphxglrmultiimg imag _auto_examplesimagessphx_glr_plot_sphere_bands_png alt vicsekmax_kappa paramet n r nu sigma v time class sphxglrmultiimg rstclass sphxglrscriptout codeblock none progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress gener python sourc line print total simul time averag time per iter gener python sourc line codeblock default printtot time stre second printaverag time per iter stressimuiter second rstclass sphxglrscriptout codeblock none total time second averag time per iter second rstclass sphxglrtime total run time script minut second _sphx_glr_download__auto_examples_plot_sphere_bandspi html contain sphxglrfooter class sphxglrfooterexampl contain sphxglrdownload sphxglrdownloadpython downloaddownload python sourc code plot_sphere_bandspi plot_sphere_bandspi contain sphxglrdownload sphxglrdownloadjupyt downloaddownload jupyt notebook plot_sphere_bandsipynb plot_sphere_bandsipynb html rstclass sphxglrsignatur galleri gener sphinxgalleri httpssphinxgallerygithubio_ edit file automat gener sphinxgalleri make chang edit sourc python file _auto_examplesplot_bo_millingpi line number given html note class sphxglrdownloadlinknot click refher sphx_glr_download__auto_examples_plot_bo_millingpi download full exampl code rstclass sphxglrexampletitl _sphx_glr__auto_examples_plot_bo_millingpi bodyori mill gener python sourc line model introduc p degond diez na bulk topolog state new collect dynam model arxiv gener python sourc line first standard import gener python sourc line codeblock default import os import sy import time import math import torch import numpi np matplotlib import pyplot plt import sisyphemodel model sisyphedisplay import save use_cuda torchcudais_avail dtype torchcudafloattensor use_cuda els torchfloattensor gener python sourc line bodyori particl initi perpendicular twist system compos bodyori particl initi uniformli scatter period box bodyorient twist bodi orient particl posit mathxyz initi math leftbeginarrayccc cospi z sinpi z sinpi z cospi zendarrayright gener python sourc line codeblock default sisypheiniti import cyclotron_twist_z n l r nu c kappa po bo cyclotron_twist_znlkappadtyp simu modelsboasynchronousvicsekposposbobo vc jump_ratenukappakappa interaction_radiusr box_sizel boundary_conditionsperiod variant name normalis paramet option sampling_methodvonmis block_sparse_reductiontru number_of_cel gener python sourc line run simul unit time save azimuth angl mean direct motion defin math varphi mathrmargomegaiomega pi mathomega omegaomegaomega mean direct motion particl veloc mathomega_i_leq ileq n math omega fracsum_in omega_isum_in omega_i gener python sourc line codeblock default frame timetim data savesimuframesphisave_filefals e timetim rstclass sphxglrscriptout codeblock none progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress gener python sourc line print total simul time averag time per iter gener python sourc line codeblock default printtot time stre second printaverag time per iter stressimuiter second rstclass sphxglrscriptout codeblock none total time second averag time per iter second gener python sourc line plot azimuth angl mathvarphi gener python sourc line codeblock default pltplotdatatimedataphi pltxlabeltim pltylabelazimuth angl imag _auto_examplesimagessphx_glr_plot_bo_milling_png alt plot bo mill class sphxglrsingleimg rstclass sphxglrscriptout codeblock none text azimuth angl rstclass sphxglrtime total run time script minut second _sphx_glr_download__auto_examples_plot_bo_millingpi html contain sphxglrfooter class sphxglrfooterexampl contain sphxglrdownload sphxglrdownloadpython downloaddownload python sourc code plot_bo_millingpi plot_bo_millingpi contain sphxglrdownload sphxglrdownloadjupyt downloaddownload jupyt notebook plot_bo_millingipynb plot_bo_millingipynb html rstclass sphxglrsignatur galleri gener sphinxgalleri httpssphinxgallerygithubio_ orphan _sphx_glr__auto_exampl exampl exampl variou model raw html div classsphxglrthumbcontain tooltipth classic vicsek model squar period domain known lthttpsarxivorgab html figur _auto_examplesimagesthumbsphx_glr_plot_bands_thumbpng alt band refsphx_glr__auto_examples_plot_bandspi raw html div toctre hidden _auto_examplesplot_band raw html div classsphxglrthumbcontain tooltipbodyori mill html figur _auto_examplesimagesthumbsphx_glr_plot_bo_milling_thumbpng alt bodyori mill refsphx_glr__auto_examples_plot_bo_millingpi raw html div toctre hidden _auto_examplesplot_bo_mil raw html div classsphxglrthumbcontain tooltipexampl mill behaviour html figur _auto_examplesimagesthumbsphx_glr_plot_milling_thumbpng alt mill refsphx_glr__auto_examples_plot_millingpi raw html div toctre hidden _auto_examplesplot_mil raw html div classsphxglrthumbcontain tooltipa classic meanfield vicsek model bound disk domain html figur _auto_examplesimagesthumbsphx_glr_plot_sphere_bands_thumbpng alt boundari cluster disk refsphx_glr__auto_examples_plot_sphere_bandspi raw html div toctre hidden _auto_examplesplot_sphere_band raw html div classsphxglrthumbcontain tooltipvolum exclus html figur _auto_examplesimagesthumbsphx_glr_plot_volume_exclusion_thumbpng alt volum exclus refsphx_glr__auto_examples_plot_volume_exclusionpi raw html div toctre hidden _auto_examplesplot_volume_exclus raw html div classsphxglrcleardiv html contain sphxglrfooter class sphxglrfootergalleri contain sphxglrdownload sphxglrdownloadpython downloaddownload exampl python sourc code _auto_examples_pythonzip _auto_examples_auto_examples_pythonzip contain sphxglrdownload sphxglrdownloadjupyt downloaddownload exampl jupyt notebook _auto_examples_jupyterzip _auto_examples_auto_examples_jupyterzip html rstclass sphxglrsignatur galleri gener sphinxgalleri httpssphinxgallerygithubio_ orphan _sphx_glr__auto_tutorials_sg_execution_tim comput time total execut time _auto_tutori file refsphx_glr__auto_tutorials_plot_b_targetsoptionspi plot_b_targetsoptionspi mb refsphx_glr__auto_tutorials_plot_a_particlesmodelspi plot_a_particlesmodelspi mb refsphx_glr__auto_tutorials_plot_c_boundaryconditionspi plot_c_boundaryconditionspi mb refsphx_glr__auto_tutorials_plot_d_blocksparsepi plot_d_blocksparsepi mb refsphx_glr__auto_tutorials_plot_e_kernelspi plot_e_kernelspi mb edit file automat gener sphinxgalleri make chang edit sourc python file _auto_tutorialsplot_c_boundaryconditionspi line number given html note class sphxglrdownloadlinknot click refher sphx_glr_download__auto_tutorials_plot_c_boundaryconditionspi download full exampl code rstclass sphxglrexampletitl _sphx_glr__auto_tutorials_plot_c_boundaryconditionspi _tuto_boundarycondit tutori boundari condit particl system defin rectangular box whose dimens specifi attribut attrl sisypheparticlesparticlesl boundari condit specifi attribut attrbc sisypheparticlesparticlesbc one follow list size mathd contain dimens either period wall reflect boundari condit string open boundari condit string period period boundari condit string spheric reflect boundari condit sphere diamet mathl enclos squar domain mathld gener python sourc line instanc let us simul vicsek model elong rectangular domain mathl_xtimesl_i period boundari condit mathxdimens reflect boundari condit mathydimens first standard import gener python sourc line codeblock default import time import torch sisyphemodel import vicsek sisyphedisplay import display_kinetic_particl use_cuda torchcudais_avail dtype torchcudafloattensor use_cuda els torchfloattensor gener python sourc line paramet model gener python sourc line codeblock default n r c nu sigma dt variant name max_kappa paramet kappa_max gener python sourc line spatial domain boundari condit initi condit gener python sourc line codeblock default lx ly l lx ly bc po torchrandntypedtyp po lpo po lpo vel torchrandnntypedtyp vel veltorchnormveldimreshapen simu vicsek po posdetachclon vel veldetachclon v c sigma sigma nu nu interaction_radiu r box_siz l boundary_conditionsbc dt dt variant variant block_sparse_reduct true number_of_cel gener python sourc line final run simul unit time gener python sourc line codeblock default sphinx_gallery_thumbnail_numb frame timetim op display_kinetic_particlessimu frame ordertru figsiz e timetim rstclass sphxglrhorizont imag _auto_tutorialsimagessphx_glr_plot_c_boundaryconditions_png alt vicsekmax_kappa paramet n r nu sigma v time class sphxglrmultiimg imag _auto_tutorialsimagessphx_glr_plot_c_boundaryconditions_png alt vicsekmax_kappa paramet n r nu sigma v time class sphxglrmultiimg imag _auto_tutorialsimagessphx_glr_plot_c_boundaryconditions_png alt vicsekmax_kappa paramet n r nu sigma v time class sphxglrmultiimg imag _auto_tutorialsimagessphx_glr_plot_c_boundaryconditions_png alt vicsekmax_kappa paramet n r nu sigma v time class sphxglrmultiimg imag _auto_tutorialsimagessphx_glr_plot_c_boundaryconditions_png alt vicsekmax_kappa paramet n r nu sigma v time class sphxglrmultiimg imag _auto_tutorialsimagessphx_glr_plot_c_boundaryconditions_png alt vicsekmax_kappa paramet n r nu sigma v time class sphxglrmultiimg imag _auto_tutorialsimagessphx_glr_plot_c_boundaryconditions_png alt vicsekmax_kappa paramet n r nu sigma v time class sphxglrmultiimg imag _auto_tutorialsimagessphx_glr_plot_c_boundaryconditions_png alt vicsekmax_kappa paramet n r nu sigma v time class sphxglrmultiimg imag _auto_tutorialsimagessphx_glr_plot_c_boundaryconditions_png alt vicsekmax_kappa paramet n r nu sigma v time class sphxglrmultiimg imag _auto_tutorialsimagessphx_glr_plot_c_boundaryconditions_png alt vicsekmax_kappa paramet n r nu sigma v time class sphxglrmultiimg imag _auto_tutorialsimagessphx_glr_plot_c_boundaryconditions_png alt vicsekmax_kappa paramet n r nu sigma v time class sphxglrmultiimg imag _auto_tutorialsimagessphx_glr_plot_c_boundaryconditions_png alt vicsekmax_kappa paramet n r nu sigma v time class sphxglrmultiimg imag _auto_tutorialsimagessphx_glr_plot_c_boundaryconditions_png alt vicsekmax_kappa paramet n r nu sigma v time class sphxglrmultiimg imag _auto_tutorialsimagessphx_glr_plot_c_boundaryconditions_png alt vicsekmax_kappa paramet n r nu sigma v time class sphxglrmultiimg imag _auto_tutorialsimagessphx_glr_plot_c_boundaryconditions_png alt vicsekmax_kappa paramet n r nu sigma v time class sphxglrmultiimg imag _auto_tutorialsimagessphx_glr_plot_c_boundaryconditions_png alt plot c boundarycondit class sphxglrmultiimg rstclass sphxglrscriptout codeblock none progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress gener python sourc line print total simul time averag time per iter gener python sourc line codeblock default printtot time stre second printaverag time per iter stressimuiter second rstclass sphxglrscriptout codeblock none total time second averag time per iter second gener python sourc line simul produc small cluster move left right right left step order paramet correspond collis two cluster move opposit direct rstclass sphxglrtime total run time script minut second _sphx_glr_download__auto_tutorials_plot_c_boundaryconditionspi html contain sphxglrfooter class sphxglrfooterexampl contain sphxglrdownload sphxglrdownloadpython downloaddownload python sourc code plot_c_boundaryconditionspi plot_c_boundaryconditionspi contain sphxglrdownload sphxglrdownloadjupyt downloaddownload jupyt notebook plot_c_boundaryconditionsipynb plot_c_boundaryconditionsipynb html rstclass sphxglrsignatur galleri gener sphinxgalleri httpssphinxgallerygithubio_ edit file automat gener sphinxgalleri make chang edit sourc python file _auto_tutorialsplot_a_particlesmodelspi line number given html note class sphxglrdownloadlinknot click refher sphx_glr_download__auto_tutorials_plot_a_particlesmodelspi download full exampl code rstclass sphxglrexampletitl _sphx_glr__auto_tutorials_plot_a_particlesmodelspi tutori particl model gener python sourc line particl system instanc one class defin modul modsisypheparticl particl basic class classsisypheparticlesparticl defin particl system posit kinet particl class classsisypheparticleskineticparticl defin particl system posit veloc bodyori particl class classsisypheparticlesboparticl defin particl system posit bodyorient rotat matric mathso store quaternion model subclass particl class sever exampl defin modul modsisyphemodel exampl let us creat instanc vicsek model classsisyphemodelsvicsek subclass classsisypheparticleskineticparticl first standard import gener python sourc line codeblock default import time import torch gener python sourc line cuda avail comput done gpu cpu otherwis type tensor simpl doubl precis defin type initi condit throughout document work singl precis tensor gener python sourc line codeblock default use_cuda torchcudais_avail dtype torchcudafloattensor use_cuda els torchfloattensor gener python sourc line take initi mathn particl uniformli scatter box size mathl uniformli sampl direct motion gener python sourc line codeblock default n l po ltorchrandntypedtyp vel torchrandnntypedtyp vel veltorchnormveldimreshapen gener python sourc line defin interact radiu mathr speed particl mathc drift diffus coeffici respect mathnu mathsigma gener python sourc line codeblock default r c nu sigma gener python sourc line take small discretis time step gener python sourc line codeblock default dt gener python sourc line final defin instanc vicsek model paramet gener python sourc line codeblock default sisyphemodel import vicsek simu vicsek po po vel vel v c sigma sigma nu nu interaction_radiu r box_siz l dt dt gener python sourc line note boundari condit period default see reftuto_boundarycondit gener python sourc line far noth comput particl implement python iter order comput next time step algorithm call method meth__next__ method increment iter counter one updat relev quantiti posit veloc call method methupd sisyphemodelsvicsekupd defin model gener python sourc line codeblock default printcurr iter strsimuiter simu__next__ printcurr iter strsimuiter rstclass sphxglrscriptout codeblock none current iter current iter gener python sourc line longer time interv use method modul modsisyphedisplay instanc let us fix list time frame gener python sourc line codeblock default frame gener python sourc line use method methsisyphedisplaydisplay_kinetic_particl simul run last time list datafram method also display scatter plot particl system time specifi list final comput plot order paramet gener python sourc line codeblock default sisyphedisplay import display_kinetic_particl timetim op display_kinetic_particlessimu frame ordertru e timetim rstclass sphxglrhorizont imag _auto_tutorialsimagessphx_glr_plot_a_particlesmodels_png alt vicseknormalis paramet n r nu sigma v time class sphxglrmultiimg imag _auto_tutorialsimagessphx_glr_plot_a_particlesmodels_png alt vicseknormalis paramet n r nu sigma v time class sphxglrmultiimg imag _auto_tutorialsimagessphx_glr_plot_a_particlesmodels_png alt vicseknormalis paramet n r nu sigma v time class sphxglrmultiimg imag _auto_tutorialsimagessphx_glr_plot_a_particlesmodels_png alt vicseknormalis paramet n r nu sigma v time class sphxglrmultiimg imag _auto_tutorialsimagessphx_glr_plot_a_particlesmodels_png alt vicseknormalis paramet n r nu sigma v time class sphxglrmultiimg imag _auto_tutorialsimagessphx_glr_plot_a_particlesmodels_png alt vicseknormalis paramet n r nu sigma v time class sphxglrmultiimg imag _auto_tutorialsimagessphx_glr_plot_a_particlesmodels_png alt plot particlesmodel class sphxglrmultiimg rstclass sphxglrscriptout codeblock none progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress gener python sourc line print total simul time averag time per iter gener python sourc line codeblock default printtot time stre second printaverag time per iter stressimuiter second rstclass sphxglrscriptout codeblock none total time second averag time per iter second rstclass sphxglrtime total run time script minut second _sphx_glr_download__auto_tutorials_plot_a_particlesmodelspi html contain sphxglrfooter class sphxglrfooterexampl contain sphxglrdownload sphxglrdownloadpython downloaddownload python sourc code plot_a_particlesmodelspi plot_a_particlesmodelspi contain sphxglrdownload sphxglrdownloadjupyt downloaddownload jupyt notebook plot_a_particlesmodelsipynb plot_a_particlesmodelsipynb html rstclass sphxglrsignatur galleri gener sphinxgalleri httpssphinxgallerygithubio_ edit file automat gener sphinxgalleri make chang edit sourc python file _auto_tutorialsplot_d_blocksparsepi line number given html note class sphxglrdownloadlinknot click refher sphx_glr_download__auto_tutorials_plot_d_blocksparsepi download full exampl code rstclass sphxglrexampletitl _sphx_glr__auto_tutorials_plot_d_blocksparsepi _tutobsr tutori blockspars reduct mani case interact radiu mathr much smaller size domain consequ sum local averag see reftuto_averag contain small fraction non zero term gain effici follow classic strategi subdivid domain fix number cell size least mathr particl given cell look contigu cell comput local averag dimens mathd mathd contigu cell includ cell practic implement call verlet list method howev implement differ classic one adapt blockspars reduct method httpswwwkerneloperationsiokeops_auto_examplespytorchplot_grid_cluster_pytorchhtml_ implement keop httpswwwkerneloperationsiokeopsindexhtml_ librari illustr gain effic vicsek model note method suboptim moder number particl rule thumb blockspars reduct method becom use system least math particl gener python sourc line set benchmark first standard import gener python sourc line codeblock default import copi import time import torch matplotlib import pyplot plt use_cuda torchcudais_avail dtype torchcudafloattensor use_cuda els torchfloattensor gener python sourc line let mathn particl uniformli scatter box size mathl interact radiu mathr uniformli sampl veloc gener python sourc line codeblock default sisyphemodel import vicsek n l r po ltorchrandntypedtyp vel torchrandnntypedtyp vel veltorchnormveldimreshapen simuvicsekposposvelvel v sigmanu interaction_radiusr box_sizel simu__next__ gpu warmup rstclass sphxglrscriptout codeblock none posit tensor devicecuda veloc tensor devicecuda gener python sourc line without blockspars reduct let us comput simul time iter gener python sourc line codeblock default simu_copi copydeepcopysimu make new deepcopi timetim k rang simu_copy__next__ e timetim simulation_tim es printaverag simul time without blockspars reduct strsimulation_tim second rstclass sphxglrscriptout codeblock none averag simul time without blockspars reduct second gener python sourc line blockspars reduct first turn attribut attrblockspars sispypheparticlesparticlesblockspars gener python sourc line codeblock default simublockspars true gener python sourc line need defin maximum number cell set keyword argument number_of_cel instanc class classsisypheparticlesparticl creat number cell strong influenc effici method chosen wise optim valu known priori recommand use method methbest_blocksparse_paramet sisypheparticlesparticlesbest_blocksparse_paramet time iter simul variou number cell automat choos best one test number cell power dimens mathd math math gener python sourc line codeblock default ncell_min ncell_max fastest nb_cell average_simu_tim simulation_tim simubest_blocksparse_parametersncell_min ncell_max step nb_call rstclass sphxglrscriptout codeblock none progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress gener python sourc line plot averag simul time function squar root number cell print best gener python sourc line codeblock default pltplotnb_cellsaverage_simu_tim pltxlabelsquar root number cell pltylabelsimul time printaverag simul time blockspars reduct straverage_simu_timemin second imag _auto_tutorialsimagessphx_glr_plot_d_blocksparse_png alt plot blockspars class sphxglrsingleimg rstclass sphxglrscriptout codeblock none averag simul time blockspars reduct second gener python sourc line experi one million particl gener python sourc line codeblock default n l r po ltorchrandntypedtyp vel torchrandnntypedtyp vel veltorchnormveldimreshapen simuvicsekposposvelvel v sigmanu interaction_radiusr box_sizel block_sparse_reductionfals simu_copi copydeepcopysimu make new deepcopi timetim k rang simu_copy__next__ e timetim simulation_tim es printaverag simul time without blockspars reduct strsimulation_tim second rstclass sphxglrscriptout codeblock none averag simul time without blockspars reduct second gener python sourc line blockspars reduct gener python sourc line codeblock default simublockspars true fastest nb_cell average_simu_tim simulation_tim simubest_blocksparse_paramet nb_call rstclass sphxglrscriptout codeblock none progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress gener python sourc line plot averag simul time function squar root number cell print best gener python sourc line codeblock default pltplotnb_cellsaverage_simu_tim pltxlabelsquar root number cell pltylabelsimul time printaverag simul time blockspars reduct straverage_simu_timemin second imag _auto_tutorialsimagessphx_glr_plot_d_blocksparse_png alt plot blockspars class sphxglrsingleimg rstclass sphxglrscriptout codeblock none averag simul time blockspars reduct second gener python sourc line note optim paramet chosen initi may stay optim cours simul may case particular strong concentr particl gener python sourc line work cell size number cell cell rectangular shape length cell along dimens smaller interact radiu mathr maximum number cell thu equal math n_mathrmmax prod_kd leftlfloor fracl_kr rightrfloor mathl_k length rectangular domain along dimens mathk correspond rectangular cell length along dimens mathk equal math varepsilon_k fracl_kleftlfloor fracl_kr rightrfloor number cell demand mathn_ exce mathn_mathrmmax chosen valu otherwis first comput typic length math varepsilon_ leftfracprod_kd l_kn_rightd length cell along dimens mathk set math varepsilon_k fracl_kleftlfloorfracl_kvarepsilon_rightrfloor particular squar domain mathl_kl mathk mathn_ power mathd exactli mathn_ squar cell length mathln_d gener python sourc line blockspars paramet initialis method methbest_blocksparse_paramet sisypheparticlesparticlesbest_blocksparse_paramet defin three attribut use speed comput given number cell comput method methcompute_blocksparse_paramet sisypheparticlesparticlescompute_blocksparse_paramet attrcentroid sisypheparticlesparticlescentroid coordin center cell attrkeep sisypheparticlesparticleskeep squar booltensor indic whether two cell contigu attrep sisypheparticlesparticleskeep length cell along dimens particl cluster cell use method methuniform_grid_separ sisyphetoolboxuniform_grid_separ note drawback method high memori cost need store boolean mask attrkeep sisypheparticlesparticleskeep consequ unlik classic verlet list method optim number cell often maximum one exampl present document optim number cell alway smaller math rstclass sphxglrtime total run time script minut second _sphx_glr_download__auto_tutorials_plot_d_blocksparsepi html contain sphxglrfooter class sphxglrfooterexampl contain sphxglrdownload sphxglrdownloadpython downloaddownload python sourc code plot_d_blocksparsepi plot_d_blocksparsepi contain sphxglrdownload sphxglrdownloadjupyt downloaddownload jupyt notebook plot_d_blocksparseipynb plot_d_blocksparseipynb html rstclass sphxglrsignatur galleri gener sphinxgalleri httpssphinxgallerygithubio_ orphan _sphx_glr__auto_tutori tutori basic featur raw html div classsphxglrthumbcontain tooltiptutori particl model html figur _auto_tutorialsimagesthumbsphx_glr_plot_a_particlesmodels_thumbpng alt tutori particl model refsphx_glr__auto_tutorials_plot_a_particlesmodelspi raw html div toctre hidden _auto_tutorialsplot_a_particlesmodel raw html div classsphxglrthumbcontain tooltipmani use local averag see tuto_averag predefin may directli use html figur _auto_tutorialsimagesthumbsphx_glr_plot_b_targetsoptions_thumbpng alt tutori target option refsphx_glr__auto_tutorials_plot_b_targetsoptionspi raw html div toctre hidden _auto_tutorialsplot_b_targetsopt raw html div classsphxglrthumbcontain tooltipth particl system defin rectangular box whose dimens specifi att html figur _auto_tutorialsimagesthumbsphx_glr_plot_c_boundaryconditions_thumbpng alt tutori boundari condit refsphx_glr__auto_tutorials_plot_c_boundaryconditionspi raw html div toctre hidden _auto_tutorialsplot_c_boundarycondit raw html div classsphxglrthumbcontain tooltipin mani case interact radiu r much smaller size domain consequ html figur _auto_tutorialsimagesthumbsphx_glr_plot_d_blocksparse_thumbpng alt tutori blockspars reduct refsphx_glr__auto_tutorials_plot_d_blocksparsepi raw html div toctre hidden _auto_tutorialsplot_d_blockspars raw html div classsphxglrthumbcontain tooltipsimul swarm model requir expens meanfield convolut oper form html figur _auto_tutorialsimagesthumbsphx_glr_plot_e_kernels_thumbpng alt tutori kernel averag refsphx_glr__auto_tutorials_plot_e_kernelspi raw html div toctre hidden _auto_tutorialsplot_e_kernel raw html div classsphxglrcleardiv html contain sphxglrfooter class sphxglrfootergalleri contain sphxglrdownload sphxglrdownloadpython downloaddownload exampl python sourc code _auto_tutorials_pythonzip _auto_tutorials_auto_tutorials_pythonzip contain sphxglrdownload sphxglrdownloadjupyt downloaddownload exampl jupyt notebook _auto_tutorials_jupyterzip _auto_tutorials_auto_tutorials_jupyterzip html rstclass sphxglrsignatur galleri gener sphinxgalleri httpssphinxgallerygithubio_ edit file automat gener sphinxgalleri make chang edit sourc python file _auto_tutorialsplot_b_targetsoptionspi line number given html note class sphxglrdownloadlinknot click refher sphx_glr_download__auto_tutorials_plot_b_targetsoptionspi download full exampl code rstclass sphxglrexampletitl _sphx_glr__auto_tutorials_plot_b_targetsoptionspi tutori target option mani use local averag see reftuto_averag predefin may directli use simul new classic model tutori showcas basic usag target method simul variant vicsek model gener python sourc line exampl variant vicsek model abstract form vicsek model read math mathrmdxi_t c_ vi_t mathrmd math mathrmdvi_t sigmamathsfpvi_tcirc ji_t mathrmdt mathrmd bi_t mathc_ speed mathmathsfpv orthogon project orthogon plane mathv mathsigma diffus coeffici drift coeffici mathji_t call target synchron asynchron vicsek model target center sampl distribut comparison classic target shown gener python sourc line first standard import gener python sourc line codeblock default import time import torch import pprint matplotlib import pyplot plt sisyphemodel import vicsek sisyphedisplay import display_kinetic_particl use_cuda torchcudais_avail dtype torchcudafloattensor use_cuda els torchfloattensor gener python sourc line classic nonnormalis vicsek model target math ji_t kappafracsum_jn kxj_txi_tvj_tsum_jn kxj_txi_tvj_t paramet model gener python sourc line codeblock default n l po ltorchrandntypedtyp vel torchrandnntypedtyp vel veltorchnormveldimreshapen r c nu sigma dt gener python sourc line choic target implement keyword argument variant classic normalis target given follow dictionari gener python sourc line codeblock default variant name normalis paramet simu vicsek po posdetachclon vel veldetachclon v c sigma sigma nu nu interaction_radiu r box_siz l dt dt variant variant block_sparse_reduct true number_of_cel gener python sourc line final run simul unit time gener python sourc line codeblock default frame timetim op display_kinetic_particlessimu frame ordertru e timetim rstclass sphxglrhorizont imag _auto_tutorialsimagessphx_glr_plot_b_targetsoptions_png alt vicseknormalis paramet n r nu sigma v time class sphxglrmultiimg imag _auto_tutorialsimagessphx_glr_plot_b_targetsoptions_png alt vicseknormalis paramet n r nu sigma v time class sphxglrmultiimg imag _auto_tutorialsimagessphx_glr_plot_b_targetsoptions_png alt vicseknormalis paramet n r nu sigma v time class sphxglrmultiimg imag _auto_tutorialsimagessphx_glr_plot_b_targetsoptions_png alt vicseknormalis paramet n r nu sigma v time class sphxglrmultiimg imag _auto_tutorialsimagessphx_glr_plot_b_targetsoptions_png alt vicseknormalis paramet n r nu sigma v time class sphxglrmultiimg imag _auto_tutorialsimagessphx_glr_plot_b_targetsoptions_png alt vicseknormalis paramet n r nu sigma v time class sphxglrmultiimg imag _auto_tutorialsimagessphx_glr_plot_b_targetsoptions_png alt vicseknormalis paramet n r nu sigma v time class sphxglrmultiimg imag _auto_tutorialsimagessphx_glr_plot_b_targetsoptions_png alt vicseknormalis paramet n r nu sigma v time class sphxglrmultiimg imag _auto_tutorialsimagessphx_glr_plot_b_targetsoptions_png alt vicseknormalis paramet n r nu sigma v time class sphxglrmultiimg imag _auto_tutorialsimagessphx_glr_plot_b_targetsoptions_png alt vicseknormalis paramet n r nu sigma v time class sphxglrmultiimg imag _auto_tutorialsimagessphx_glr_plot_b_targetsoptions_png alt vicseknormalis paramet n r nu sigma v time class sphxglrmultiimg imag _auto_tutorialsimagessphx_glr_plot_b_targetsoptions_png alt vicseknormalis paramet n r nu sigma v time class sphxglrmultiimg imag _auto_tutorialsimagessphx_glr_plot_b_targetsoptions_png alt plot b targetsopt class sphxglrmultiimg rstclass sphxglrscriptout codeblock none progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress gener python sourc line print total simul time averag time per iter gener python sourc line codeblock default printtot time stre second printaverag time per iter stressimuiter second rstclass sphxglrscriptout codeblock none total time second averag time per iter second gener python sourc line plot histogram angl direct motion gener python sourc line codeblock default angl torchatansimuvelsimuvel angl anglecpunumpi h plthistangl bin pltxlabelangl pltshow imag _auto_tutorialsimagessphx_glr_plot_b_targetsoptions_png alt plot b targetsopt class sphxglrsingleimg gener python sourc line initi cluster phase system selforgan uniform flock gener python sourc line nonnormalis vicsek model target math ji_t fracfracnsum_jn kxj_txi_tvj_tfrackappafrackappa_fracnsum_jn kxj_txi_tvj_t defin correspond dictionari gener python sourc line codeblock default kappa_ variant name max_kappa paramet kappa_max kappa_ simu vicsek po posdetachclon vel veldetachclon v c sigma sigma nu nu interaction_radiu r box_siz l dt dt variant variant block_sparse_reduct true number_of_cel gener python sourc line final run simul unit time gener python sourc line codeblock default frame timetim op display_kinetic_particlessimu frame ordertru e timetim rstclass sphxglrhorizont imag _auto_tutorialsimagessphx_glr_plot_b_targetsoptions_png alt vicsekmax_kappa paramet n r nu sigma v time class sphxglrmultiimg imag _auto_tutorialsimagessphx_glr_plot_b_targetsoptions_png alt vicsekmax_kappa paramet n r nu sigma v time class sphxglrmultiimg imag _auto_tutorialsimagessphx_glr_plot_b_targetsoptions_png alt vicsekmax_kappa paramet n r nu sigma v time class sphxglrmultiimg imag _auto_tutorialsimagessphx_glr_plot_b_targetsoptions_png alt vicsekmax_kappa paramet n r nu sigma v time class sphxglrmultiimg imag _auto_tutorialsimagessphx_glr_plot_b_targetsoptions_png alt vicsekmax_kappa paramet n r nu sigma v time class sphxglrmultiimg imag _auto_tutorialsimagessphx_glr_plot_b_targetsoptions_png alt vicsekmax_kappa paramet n r nu sigma v time class sphxglrmultiimg imag _auto_tutorialsimagessphx_glr_plot_b_targetsoptions_png alt vicsekmax_kappa paramet n r nu sigma v time class sphxglrmultiimg imag _auto_tutorialsimagessphx_glr_plot_b_targetsoptions_png alt vicsekmax_kappa paramet n r nu sigma v time class sphxglrmultiimg imag _auto_tutorialsimagessphx_glr_plot_b_targetsoptions_png alt vicsekmax_kappa paramet n r nu sigma v time class sphxglrmultiimg imag _auto_tutorialsimagessphx_glr_plot_b_targetsoptions_png alt vicsekmax_kappa paramet n r nu sigma v time class sphxglrmultiimg imag _auto_tutorialsimagessphx_glr_plot_b_targetsoptions_png alt vicsekmax_kappa paramet n r nu sigma v time class sphxglrmultiimg imag _auto_tutorialsimagessphx_glr_plot_b_targetsoptions_png alt vicsekmax_kappa paramet n r nu sigma v time class sphxglrmultiimg imag _auto_tutorialsimagessphx_glr_plot_b_targetsoptions_png alt plot b targetsopt class sphxglrmultiimg rstclass sphxglrscriptout codeblock none progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress gener python sourc line print total simul time averag time per iter gener python sourc line codeblock default printtot time stre second printaverag time per iter stressimuiter second rstclass sphxglrscriptout codeblock none total time second averag time per iter second gener python sourc line plot histogram angl direct motion gener python sourc line codeblock default angl torchatansimuvelsimuvel angl anglecpunumpi h plthistangl bin pltxlabelangl pltshow imag _auto_tutorialsimagessphx_glr_plot_b_targetsoptions_png alt plot b targetsopt class sphxglrsingleimg gener python sourc line system selforgan strongli cluster flock bandlik structur gener python sourc line nemat vicsek model target math ji_t kappa vi_tcdot overlineomegai_toverlineomegai_t mathoverlineomegai_t unit eigenvector associ maxim eigenvalu averag qtensor math qi_t fracnsum_jn kxj_txi_tleftvj_totim vj_t fracd i_dright defin correspond dictionari gener python sourc line codeblock default variant name nemat paramet simu vicsek po posdetachclon vel veldetachclon v c sigma sigma nu nu interaction_radiu r box_siz l dt dt variant variant block_sparse_reduct true number_of_cel gener python sourc line final run simul unit time color code indic angl direct motion mathpi mathpi gener python sourc line codeblock default frame timetim op display_kinetic_particlessimu frame ordertru colortru e timetim rstclass sphxglrhorizont imag _auto_tutorialsimagessphx_glr_plot_b_targetsoptions_png alt vicseknemat paramet n r nu sigma v time class sphxglrmultiimg imag _auto_tutorialsimagessphx_glr_plot_b_targetsoptions_png alt vicseknemat paramet n r nu sigma v time class sphxglrmultiimg imag _auto_tutorialsimagessphx_glr_plot_b_targetsoptions_png alt vicseknemat paramet n r nu sigma v time class sphxglrmultiimg imag _auto_tutorialsimagessphx_glr_plot_b_targetsoptions_png alt vicseknemat paramet n r nu sigma v time class sphxglrmultiimg imag _auto_tutorialsimagessphx_glr_plot_b_targetsoptions_png alt vicseknemat paramet n r nu sigma v time class sphxglrmultiimg imag _auto_tutorialsimagessphx_glr_plot_b_targetsoptions_png alt vicseknemat paramet n r nu sigma v time class sphxglrmultiimg imag _auto_tutorialsimagessphx_glr_plot_b_targetsoptions_png alt vicseknemat paramet n r nu sigma v time class sphxglrmultiimg imag _auto_tutorialsimagessphx_glr_plot_b_targetsoptions_png alt plot b targetsopt class sphxglrmultiimg rstclass sphxglrscriptout codeblock none progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress progress gener python sourc line print total simul time averag time per iter gener python sourc line codeblock default printtot time stre second printaverag time per iter stressimuiter second rstclass sphxglrscriptout codeblock none total time second averag time per iter second gener python sourc line plot histogram angl direct motion gener python sourc line codeblock default sphinx_gallery_thumbnail_numb angl torchatansimuvelsimuvel angl anglecpunumpi h plthistangl bin pltxlabelangl pltshow imag _auto_tutorialsimagessphx_glr_plot_b_targetsoptions_png alt plot b targetsopt class sphxglrsingleimg gener python sourc line two mode separ angl mathpi indic two group equal size move opposit direct nemat flock gener python sourc line target dictionari sever target implement complet list avail target found dictionari target attrtarget_method sisypheparticlesparticlestarget_method gener python sourc line codeblock default pprintpprintsimutarget_method rstclass sphxglrscriptout codeblock none max_kappa bound method kineticparticlesmax_kappa sisyphemodelsvicsek object xefbe mean_field bound method kineticparticlesmean_field sisyphemodelsvicsek object xefbe mors bound method particlesmorse_target sisyphemodelsvicsek object xefbe motsch_tadmor bound method kineticparticlesmotsch_tadmor sisyphemodelsvicsek object xefbe nemat bound method kineticparticlesnemat sisyphemodelsvicsek object xefbe normalis bound method kineticparticlesnormalis sisyphemodelsvicsek object xefbe overlapping_repuls bound method particlesoverlapping_repulsion_target sisyphemodelsvicsek object xefbe quadratic_potenti bound method particlesquadratic_potential_target sisyphemodelsvicsek object xefbe gener python sourc line custom target ad dictionari target use method methadd_target_method sisypheparticlesparticlesadd_target_method target readili use simul use method methcompute_target sisypheparticlesparticlescompute_target gener python sourc line option custom target also defin appli option modifi exist target see refexamplemil rstclass sphxglrtime total run time script minut second _sphx_glr_download__auto_tutorials_plot_b_targetsoptionspi html contain sphxglrfooter class sphxglrfooterexampl contain sphxglrdownload sphxglrdownloadpython downloaddownload python sourc code plot_b_targetsoptionspi plot_b_targetsoptionspi contain sphxglrdownload sphxglrdownloadjupyt downloaddownload jupyt notebook plot_b_targetsoptionsipynb plot_b_targetsoptionsipynb html rstclass sphxglrsignatur galleri gener sphinxgalleri httpssphinxgallerygithubio_ edit file automat gener sphinxgalleri make chang edit sourc python file _auto_tutorialsplot_e_kernelspi line number given html note class sphxglrdownloadlinknot click refher sphx_glr_download__auto_tutorials_plot_e_kernelspi download full exampl code rstclass sphxglrexampletitl _sphx_glr__auto_tutorials_plot_e_kernelspi _tuto_averag tutori kernel averag simul swarm model requir expens meanfield convolut oper form math ji fracnsum_jn kxjxi uj mathleq ileq n mathxi_leq leq n posit particl mathuj_leq jleq n given vector mathk observ kernel typic mathkxixj equal mathxi mathxj distanc smaller fix interact distanc otherwis kernel defin modul modsisyphekernel show simpl applic case gener python sourc line linear local averag first standard import gener python sourc line codeblock default import time import math import torch matplotlib import pyplot plt use_cuda torchcudais_avail dtype torchcudafloattensor use_cuda els torchfloattensor gener python sourc line let mathn particl uniformli scatter box size mathl interact radiu mathr gener python sourc line codeblock default n l r po ltorchrandntypedtyp gener python sourc line also assum particl bound cone vision around axi defin unit vector default behaviour full vision angl equal mathpi case axi datanon object take cone vision angl mathpi around axi sampl uniformli classsisypheparticleskineticparticl default axi veloc gener python sourc line codeblock default angl mathpi axi torchrandnntypedtyp axi axistorchnormaxisdimreshapen gener python sourc line let us creat instanc particl system paramet gener python sourc line codeblock default sisypheparticl import particl particl particl po po interaction_radiu r box_siz l vision_angl angl axi axi gener python sourc line note default system oper defin period boundari condit gener python sourc line simpl applic comput number neighbour particl print number neighbour first particl oper alreadi implement method funcnumber_of_neighbour sisypheparticlesparticlesnumber_of_neighbour simpli correspond averag math ni_mathrmneigh sum_jn kxjxi gener python sourc line codeblock default nneigh particlesnumber_of_neighbour nneigh intnneighitem printth first particl see strnneigh particl rstclass sphxglrscriptout codeblock none first particl see particl gener python sourc line custom object meanfield averag comput use method funclinear_local_averag sisypheparticlesparticleslinear_local_averag exampl let us comput center mass neighbour particl first defin quantiti mathu want averag sinc work toru two sine cosin spatial coordin gener python sourc line codeblock default cos_po torchcosmathpi l particlespo sin_po torchsinmathpi l particlespo gener python sourc line comput two mean field averag ie standard convolut mathn particl center mass along dimens argument complex number whose coordin averag cosin sine gener python sourc line codeblock default average_co average_sin particleslinear_local_averagecos_po sin_po center_x torchatanaverage_sin average_co center_x l mathpi torchremaindercenter_x mathpi center_i torchatanaverage_sin average_co center_i l mathpi torchremaindercenter_i mathpi center_of_mass torchcatcenter_xreshapen center_yreshapen dim rstclass sphxglrscriptout codeblock none pykeop compil libkeopstorchdcdc dataandcachepykeopscpython formula sum_reductionstepvar sumsquarevar var stepminusvar var var var var stepvar var var var var stepvar sumvar var stepminusvar var var var var stepvar var var var var var sqrtsumsquarevar var stepminusvar var var var var stepvar var var var var var alias var var var var var var var var var dtype float done gener python sourc line method funclinear_local_averag sisypheparticlesparticleslinear_local_averag default observ kernel classlazytensor size mathnn whose mathij compon equal particl mathj belong cone vision particl mathi otherwis retriev index particl belong cone vision first particl use knearestneighbour reduct httpswwwkerneloperationsiokeops_auto_tutorialsknnplot_knn_mnisthtmlsphxglrautotutorialsknnplotknnmnistpy_ provid keop httpswwwkerneloperationsiokeopsindexhtml_ librari gener python sourc line codeblock default sisyphekernel import lazy_interaction_kernel interaction_kernel lazy_interaction_kernel particlespo particlespo particlesr particlesl boundary_condit particlesbc vision_angl particlesangl axi particlesaxi k_ij interaction_kernel neigh k_ijargkminnneigh dim printth index neighbour first particl printneigh rstclass sphxglrscriptout codeblock none pykeop compil libkeopstorchafa dataandcachepykeopscpython formula argkmin_reductionvar stepvar sumsquarevar var stepminusvar var var var var stepvar var var var var stepvar sumvar var stepminusvar var var var var stepvar var var var var var sqrtsumsquarevar var stepminusvar var var var var stepvar var var var var alias var var var var var var var var var dtype float done index neighbour first particl tensor devicecuda gener python sourc line final fanci display comput plot full particl system black first particl orang neighbour blue center mass neighbour red gener python sourc line codeblock default xall particlesposcpunumpi yall particlesposcpunumpi x particlesposneighcpunumpi particlesposneighcpunumpi x particlespositem particlespositem xc center_of_massitem yc center_of_massitem fig ax pltsubplotsfigs axscatterxal yall cblack axscatterx axscatterx axscatterxc yc cred axaxi l l axset_aspectequ imag _auto_tutorialsimagessphx_glr_plot_e_kernels_png alt plot e kernel class sphxglrsingleimg gener python sourc line nonlinear averag case need comput nonlinear averag form math ji fracnsum_jn kxjxi buivj mathui_leq leq n mathvj_leq j leq n given vector mathb given function binari formula mathb written classlazytensor comput method funcnonlinear_local_averag sisypheparticlesparticlesnonlinear_local_averag instanc let us comput local mean squar distanc math ji fracsum_jn kxjxi xjxisum_jn kxjxi case use function funcsisyphekernelslazy_xy_matrix defin custom binari formula given two vector mathxxi_leq ileq mathi yj_leq jleq n respect size mathmd mathnd mathxi matrix mathmnd lazytensor whose mathij compon vector mathyjxi gener python sourc line codeblock default sisyphekernel import lazy_xy_matrix def bxi k_ij lazy_xy_matrixxyparticlesl return k_ij sum x particlespo particlespo mean_square_dist nnneighreshapen particlesnonlinear_local_averagebxi gener python sourc line sinc particl uniformli scatter box theoret valu math msd_ fracint_r int_pi r mathrmdrmathrmdthetaint_r int_pi r mathrmdrmathrmdtheta fracr gener python sourc line codeblock default printtheoret valu strr printexperiment valu strmean_square_distitem rstclass sphxglrscriptout codeblock none theoret valu experiment valu rstclass sphxglrtime total run time script minut second _sphx_glr_download__auto_tutorials_plot_e_kernelspi html contain sphxglrfooter class sphxglrfooterexampl contain sphxglrdownload sphxglrdownloadpython downloaddownload python sourc code plot_e_kernelspi plot_e_kernelspi contain sphxglrdownload sphxglrdownloadjupyt downloaddownload jupyt notebook plot_e_kernelsipynb plot_e_kernelsipynb html rstclass sphxglrsignatur galleri gener sphinxgalleri httpssphinxgallerygithubio_ kernel currentmodul sisyphekernel autosummari lazy_xy_matrix lazy_interaction_kernel lazy_overlapping_kernel lazy_mors lazy_quadrat automodul sisyphekernel membersdisplay currentmodul sisyphedisplay autosummari save display_kinetic_particl scatter_particl automodul sisyphedisplay membersparticl system currentmodul sisypheparticl autosummari particl kineticparticl boparticl automodul sisypheparticl memberstoolbox currentmodul sisyphetoolbox autosummari automodul sisyphetoolbox membersmodel currentmodul sisyphemodel autosummari asynchronousvicsek vicsek synchronousvicsek boasynchronousvicsek volumeexclus attractionrepuls automodul sisyphemodel memberssampl currentmodul sisyphesampl autosummari uniform_sphere_rand uniform_angle_rand vonmises_rand uniformball_unitquat_rand vonmises_quat_rand automodul sisyphesampl member