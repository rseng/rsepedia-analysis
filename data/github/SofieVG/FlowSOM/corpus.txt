flowsom use selforgan map visual interpret cytometri data citat use flowsom packag pleas use follow citat sofi van gassen britt callebaut mari j van helden bart n lambrecht piet demeest tom dhaen yvan saey flowsom use selforgan map visual interpret cytometri data cytometri volum p doi cytoa get packag check releaseshttpsgithubcomsaeyslabflowsomreleas obtain latest releasehttpsgithubcomsaeyslabflowsomreleaseslatest instal packag use devtool librari devtoolsinstall_githubsaeyslabflowsom build_vignett true gener roxygen edit hand pleas edit document r_plotfunctionsr nameplotlabel aliasplotlabel titleplotlabel usag plotlabel fsom label maxnodes textsiz textcolor black argument itemfsomflowsom object gener codelinkflowsom itemlabelsa vector label everi node itemmaxnodesizedetermin maximum nodes default itemtextsizes geom_text default geom_text itemtextcolorcolor geom_text default black itemaddit argument pass codelinkplotflowsom valu noth return plot drawn node repres label descript plot label cluster detail plot flowsom grid tree node label especi use show metaclust number exampl read file build selforgan map minim span tree filenam systemfileextdata fc packageflowsom ff flowcorereadfcsfilenam ff flowcorecompensateff flowcorekeywordffspil ff flowcoretransformff flowcoretransformlistcolnamesflowcorekeywordffspil flowcorelogicletransform flowsomr flowsomff scale true colstous c nclu seed plot node id plotlabel flowsomr flowsomresmetaclust seealso codelinkplotstar codelinkplotvari codelinkplotflowsom codelinkplotmark codelinkplotnumb codelinkplotpi codelinkquerystarplot codelinkplotsd gener roxygen edit hand pleas edit document r_readinputr namereadinput aliasreadinput titleread fcsfile flowfram usag readinput input pattern fc compens fals spillov null transform fals totransform null transformfunct flowcorelogicletransform transformlist null scale fals scaledcent true scaledscal true silent fals argument iteminputa flowfram flowset array path file directori itempatternif input array file directorynam select file contain pattern itemcompensatelog data need compens itemspilloverspillov matrix compens codenul compens codetru look codespil descript fc file itemtransformlog data need transform itemtotransformcolumn name indic need transform ignor codetransformlist given codenul transform codetru column name codespil descript fc file use itemtransformfunctiondefault logicletransform itemtransformlisttransformlist appli sampl itemscalelog data need rescal itemscaledcenterse codelinkscal itemscaledscalese codelinkscal itemsilentif codetru progress updat print default codefals valu flowsom object contain data use input buildsom function descript take input return flowsom object contain matrix preprocess data compens transform scale exampl read file filenam systemfileextdata fc packag flowsom flowsomr readinputfilenam compens true transform true scale true read flowfram object ff flowcorereadfcsfilenam ff flowcorecompensateff flowcorekeywordffspil ff flowcoretransformff flowcoretransformlistcolnamesflowcorekeywordffspil flowcorelogicletransform flowsomr readinputff scale true build selforgan map minim span tree flowsomr buildsomflowsomr colstous c flowsomr buildmstflowsomr appli metaclust metacl metaclusteringflowsomresmapcod metaclustering_consensu max get metaclust per cell flowsomclust metaclflowsomresmapmap seealso codelinkscal codelinkbuildsom gener roxygen edit hand pleas edit document r_buildsomr namegetclust aliasgetclust titleget cluster label individu cell usag getclustersfsom argument itemfsomflowsom object gener flowsom function buildsom function valu vector label everi cell descript get cluster label individu cell exampl filenam systemfileextdata fc packag flowsom flowsomr flowsomfilenam compens true transform true scale true colstous c nclu cluster_label getclustersflowsomr gener roxygen edit hand pleas edit document r_plotfunctionsr namequerystarplot aliasquerystarplot titlequerystarplot usag querystarplot fsom queri plot true colorpalett flowsom_color backgroundcolor ca argument itemfsomflowsom object gener codelinkbuildmst itemqueryarray contain high low specifi column name flowsom data itemplotif true plot gradient score node shown itemcolorpalettecolorpalett use color star pie marker either function array specifi color itembackgroundcolorscolor use node high score plot default red itemaddit argument pass codelinkplotflowsom valu list contain id select node individu score node score marker node descript queri certain cell type detail identifi node tree resembl certain profil high low marker express exampl file systemfileextdata fc packageflowsom flowsomr flowsomfil compens true transform true scale true colstous c nclu silent fals xdim ydim queri ccd high cd cd low tcrb cd high cd query_r querystarplotflowsomr queri equalnodes true celltyp factorrepunlabel level cunlabel cd cell celltypesquery_resselect cd cell plotstarsflowsomr backgroundvalu celltyp backgroundcolor cffffff caaa seealso codelinkplotstar codelinkplotvari codelinkplotflowsom codelinkplotlabel codelinkplotnumb codelinkplotmark codelinkplotpi codelinkplotsd gener roxygen edit hand pleas edit document r_buildsomr namegetclustercv aliasgetclustercv titleget cv valu cluster usag getclustercvsfsom argument itemfsomflowsom object gener flowsom function buildsom function valu matrix coeffici variat valu marker filenam systemfileextdata fc packag flowsom flowsomr flowsomfilenam compens true transform true scale true colstous c nclu cv getclustercvsflowsomr descript get cv valu cluster gener roxygen edit hand pleas edit document r_plotfunctionsr nameparselayout aliasparselayout titleparselayout usag parselayoutfsom layout argument itemfsomflowsom object itemlayoutmst grid matrixdatafram column row per cluster valu datafram column row per cluster descript parselayout gener roxygen edit hand pleas edit document r_deprecatedr nameplotgroup aliasplotgroup titleplotgroup usag plotgroupsfsom group threshold null pthreshold argument itemfsomflowsom object gener codelinkbuildmst itemgroupsgroup result gener codelinkcountgroup itemthresholdrel differ group node colour itempthresholdthreshold pvalu wilcoxtest node colour null threshold ignor itemaddit argument pass codelinkplotflowsom valu vector contain label assign node group except first descript plot differ group detail plot flowsom tree node repres star chart indic mean marker valu size node rel mean percentag cell present exampl run flowsom filenam systemfileextdata fc packageflowsom fsom flowsomfilenam compens true transform true scale true colstous c nclu ff flowcorereadfcsfilenam make addit file without cluster doubl amount cluster select cwhichgetclustersfsom whichfsommetaclust whichgetclustersfsom whichfsommetaclust ff_tmp ffselect flowcorewritefcsff_tmp fileff_tmpfc compar file doubl amount cluster featur getfeaturesfsom cfilenam ff_tmpfc level cluster type percentag stat groupstatsfeaturescluster_percentag group listallcel cfilenam without_ydtcel cff_tmpfc fold_chang statsfold chang fold_changes_label factorifelsefold_chang underrepres compar group ifelsefold_chang overrepres compar group level c underrepres compar group overrepres compar group fold_changes_labelisnafold_changes_label gr_ plotstarsfsom titl cell nodes statsmedian allcel list_insteadof_ggarrang true gr_ plotstarsfsom titl group nodes statsmedian without_ydtcel backgroundvalu fold_changes_label backgroundcolor cwhite red blue list_insteadof_ggarrang true p ggpubrggarrangeplotlist clistgr_tre gr_ height c p seealso codelinkplotstarscodelinkplotvari codelinkplotflowsomcodelinkplotlabelscodelinkplotnumb codelinkplotmarkercodelinkplotpiescodelinkquerystarplot codelinkplotsd gener roxygen edit hand pleas edit document r_buildsomr namepur aliaspur titlecalcul mean weight cluster puriti usag purityrealclust predictedclust weight true argument itemrealclustersarray real cluster valu itempredictedclustersarray predict cluster valu itemweightedlog mean weight depend number poin predict cluster valu mean puriti score worst score number cluster score descript calcul mean weight cluster puriti exampl gener random data exampl realclust sampl replac true predictedclust sampl replac true calcul fmeasur purityrealclust predictedclust gener roxygen edit hand pleas edit document r_buildsomr namegetmetaclust aliasgetmetaclust titleget metaclust label individu cell usag getmetaclustersfsom meta null argument itemfsomflowsom object gener flowsom function buildsom function itemmetametaclust label flowsom cluster null fsom argument gener flowsom function fsommetaclust use valu vector label everi cell descript get metaclust label individu cell exampl filenam systemfileextdata fc packag flowsom flowsomr flowsomfilenam compens true transform true scale true colstous c nclu metacluster_label getmetaclustersflowsomr metacluster_label getmetaclustersflowsomr meta flowsomresmetaclust gener roxygen edit hand pleas edit document r_plotfunctionsr namequerymultipl aliasquerymultipl titlequerymultipl usag querymultiplefsom celltyp plotfil querymultiplepdf argument itemfsomflowsom object itemcelltypesdescript cell type name list one name vector per cell type contain highlow valu itemplotfilepath pdf file save plot default querymultiplepdf codenul plot gener itemaddit argument pass codelinkquerystarplot valu label everi flowsom cluster unknown one celltyp name list select querystarplot descript function take name list multipl cell type everi item name vector valu highlow name correspond marker channel eg gener parse_markert exampl file systemfileextdata fc packag flowsom ff flowcorereadfcsfil use wrapper function build flowsom object save flowsomr metaclust save flowsomresmetaclust flowsomr flowsomff compens true transform true scale true colstous c nclu silent fals xdim ydim celltyp listcd cell cpecya high apccya high pacif bluea high b cell cpecya high nk cell cpea high pecya low apccya low query_r querymultipleflowsomr celltyp query_multiplepdf gener roxygen edit hand pleas edit document r_plotfunctionsr nameaddnod aliasaddnod titleaddnod usag addnod p nodeinfo null valu null lim null colorpalett null fillcolor white showlegend true label argument itempggplot object itemnodeinfodatafram everi node x size valu null datafram ggplot object reus itemvaluesvalu use color node default null case node fill fillcolor itemlimth limit color scale use valu null itemcolorpalettecolorpalett color node use valu null vector color color function itemfillcolorfix fill node color default white itemshowlegendboolean default true itemlabeltitl legend itemaddit argument pass geom_circl valu return noth plot node descript function plot node seealso codelinkplotflowsom codelinkplotmark codelinkplotvari codelinkaddlabel codelinkaddbackground codelinkaddpi codelinkaddstar codelinkaddstarspi gener roxygen edit hand pleas edit document r_deprecatedr namegetmfi aliasgetmfi titleget mfi valu cluster usag getmfisfsom colsus fals prettycolnam fals argument itemfsomflowsom object gener flowsom function buildsom function itemcolsusedlog report column use build som default fals itemprettycolnameslog report pretti column name instead standard column name default fals valu matrix median valu marker descript get mfi valu cluster exampl filenam systemfileextdata fc packageflowsom flowsomr flowsomfilenam compensatetruetransformtru scaletruecolstousecnclu mfi getclustermfisflowsomr gener roxygen edit hand pleas edit document r_buildmstr namebuildmst aliasbuildmst titlebuildmst usag buildmstfsom silent fals tsne fals argument itemfsomflowsom object gener codelinkbuildsom itemsilentif codetru progress updat print itemtsneif codetru altern tsne layout comput well valu flowsom object contain mst descript descript build minim span tree detail add minim span tree descript flowsom object exampl read file build selforgan map filenam systemfileextdata fc packageflowsom flowsomr readinputfilenam compensatetru transform true scale true flowsomr buildsomflowsomr colstous c build minim span tree flowsomr buildmstflowsomr seealso codelinkbuildsom codelinkplotstar gener roxygen edit hand pleas edit document r_plotfunctionsr nameaddlabel aliasaddlabel titleaddlabel usag addlabel p label hjust layout null textsiz textcolor black argument itempggplot object itemlabelslabel ad node itemhjusthorizont adjust label default center itemlayoutdatafram x column null datafram ggplot object reus itemtextsizes geom_text default geom_text itemtextcolorcolor geom_text default black itemaddit paramet pass geom_text valu return ggplot object label ad descript addlabel seealso codelinkplotlabel codelinkplotnumb gener roxygen edit hand pleas edit document r_deprecatedr namequery_multipl aliasquery_multipl titlequery_multipl usag query_multiplefsom cell_typ pdf_name query_multiplepdf argument itemfsomflowsom object itemcell_typesdescript cell type name list one name vector per cell type contain highlow valu itempdf_namepath pdf file save figur itemaddit argument pass codelinkquerystarplot valu label everi flowsom cluster unknown one celltyp name list select querystarplot descript function take name list multipl cell type everi item name vector valu highlow name correspond marker channel eg gener parse_markert exampl file systemfileextdata fc packageflowsom ff flowcorereadfcsfil use wrapper function build flowsom object save flowsomr metaclust save flowsomresmetaclust flowsomr flowsomffcompens true transform truescal true colstous c nclu silent fals xdim ydim cell_typ listcd cell cpecya high apccya high pacif bluea high b cell cpecya high nk cell cpea high pecya low apccya low query_r querymultipleflowsomr cell_typ query_multiplepdf seealso codelinkquerystarplot gener roxygen edit hand pleas edit document r_flowsomr nameflowsom aliasflowsom titlerun flowsom algorithm usag flowsom input pattern fc compens fals spillov null transform fals totransform null transformfunct flowcorelogicletransform transformlist null scale fals scaledcent true scaledscal true silent true colstous null nclu maxmeta null import null seed null argument iteminputa flowfram flowset array path file directori itempatternif input array file directorynam select file contain pattern itemcompensatelog data need compens itemspilloverspillov matrix compens null compens true look spill descript fc file itemtransformlog data need transform transform given codetransformfunct itemtotransformcolumn name indic need transform ignor codetransformlist given codenul transform codetru column name codespil descript fc file use itemtransformfunctiondefault logicletransform itemtransformlisttransformlist appli sampl itemscalelog data need rescal default fals itemscaledcenterse codelinkscal itemscaledscalese codelinkscal itemsilentif codetru progress updat print itemcolstousemark channel indic use build som default null column use build flowsom object itemnclusexact number cluster metaclust ignor maxmeta specifi default itemmaxmetamaximum number cluster tri metaclust codenul default one option comput codenclu itemimportancearray numer valu paramet scale accord import itemseedset seed reproduc result itemopt pass som function xdim ydim rlen mst alpha radiu init distf valu codelist two item first flowsom object contain inform see vignett detail inform object second metaclust node grid wrapper function codelinkreadinput codelinkbuildsom codelinkbuildmst codelinkmetaclust execut separ may provid option descript method run gener flowsom workflow scale data use consensu metaclust default exampl read file filenam systemfileextdata fc packag flowsom flowsomr flowsomfilenam compens true transform true scale true colstous c nclu read flowfram object ff flowcorereadfcsfilenam ff flowcorecompensateff flowcorekeywordffspil ff flowcoretransformff flowcoretransformlistcolnamesflowcorekeywordffspil flowcorelogicletransform flowsomr flowsomff scale true colstous c nclu plot result plotstarsflowsomr backgroundvalu flowsomresmetaclust get metaclust per cell flowsomclust getmetaclustersflowsomr seealso codelinkscal codelinkreadinput codelinkbuildsom codelinkbuildmst codelinkmetaclust gener roxygen edit hand pleas edit document r_plotfunctionsr nameflowsom_color aliasflowsom_color titleflowsom default color usag flowsom_colorsn argument itemnnumb color gener valu array n color descript flowsom default color gener roxygen edit hand pleas edit document r_plotfunctionsr nameplotsd aliasplotsd titleplotsd usag plotsdfsom marker null argument itemfsomflowsom object gener codelinkflowsom itemmarkerif markerchannel given sd marker shown otherwis maximum ratio use itemaddit argument pass codelinkplotflowsom valu noth return plot drawn node colour depend standard deviat descript plot flowsom grid tree colour standard deviaton exampl read file build selforgan map minim span tree filenam systemfileextdata fc packag flowsom flowsomr readinputfilenam compens true transform true scale true flowsomr buildsomflowsomr colstous c flowsomr buildmstflowsomr plotsdflowsomr seealso codelinkplotstar codelinkplotvari codelinkplotflowsom codelinkplotlabel codelinkplotnumb codelinkplotmark codelinkplotpi codelinkquerystarplot gener roxygen edit hand pleas edit document r_buildsomr nameinitialize_kwsp aliasinitialize_kwsp titleselect k well spread point x usag initialize_kwspx xdim ydim argument itemxmatrix row repres point itemxdimx dimens grid itemydimi dimens grid valu array contain select select row descript select k well spread point x exampl point matrix ncol select initialize_kwsppoint gener roxygen edit hand pleas edit document r_plotfunctionsr nameparseedg aliasparseedg titleparseedg usag parseedgesfsom argument itemfsomflowsom object gener codelinkflowsom valu datafram consist start end coordin edg descript pars edg detail function pars graph edg flowsom object datafram seealso codelinkplotflowsom codelinkparsenodes codelinkparsearc codelinkparsequeri codelinkparsesd codelinkaddmst gener roxygen edit hand pleas edit document r_deprecatedr namemetaclustermfi aliasmetaclustermfi titlemetaclustermfi usag metaclustermfisfsom argument itemfsomresult call flowsom function valu metaclust mfi descript comput median fluoresc intens metaclust exampl filenam systemfileextdata fc packageflowsom ff flowcorereadfcsfilenam ff flowcorecompensateffffdescriptionspil ff flowcoretransformff flowcoretransformlistcolnamesffdescriptionspil flowcorelogicletransform flowsomr flowsomffscaletruecolstousecmaxmeta mfi getmetaclustermfisflowsomr gener roxygen edit hand pleas edit document r_plotfunctionsr nameaddannot aliasaddannot titleaddannot usag addannot p fsom layout fsommstl cl null mcl null clcustomlabel null mclcustomlabel null hjust argument itempplot add annot use type star pleas use plot fals codelinkplotflowsom itemfsomflowsom object goe plot itemlayoutlayout use default fsommstl itemclclust annot cl cluster annot itemmclmetaclust annot mcl metaclust annot itemclcustomlabelsclust label use annot itemmclcustomlabelsmetaclust label use annot itemhjustlabel adjust default itemargu pass geom_text_repel valu updat plot descript add annot flowsom plot exampl identifi file fc flowcorereadfcssystemfileextdata fc packag flowsom build flowsom object flowsomr flowsomfc scale true compens true transform true totransform colstous c nclu seed p plotstarsflowsomr backgroundvalu flowsomresmetaclust list_insteadof_ggarrang true addannotationp flowsomr cl c mcl c gener roxygen edit hand pleas edit document r_plotfunctionsr nameparsesd aliasparsesd titleparsesd pars sd flowsom object usag parsesdfsom marker null argument itemfsomflowsom object gener codelinkflowsom itemmarkerif marker given sd marker shown otherwis maximum ratio use valu vector contain sd descript calcul standard deviaton flowsom object seealso codelinkplotflowsom codelinkparseedg codelinkparsenodes codelinkparsearc codelinkparsequeri codelinkplotsd gener roxygen edit hand pleas edit document r_deprecatedr nameplotnod aliasplotnod titleplotnod plot star chart usag plotnod fsom id marker fsommapcolsus colorpalett grdevicescolorramppalettecf blue fff cyan ffff yellow fff red f main pasteclust id argument itemfsomflowsom object gener codelinkbuildmst first element list return codelinkflowsom itemidid node plot check plotnumb get id itemmarkersarray marker use default marker use build tree itemcolorpalettecolorpalett use marker itemmaintitl plot valu noth return plot drawn node repres star chart indic median fluoresc intens descript plot star chart indic median marker valu singl node exampl read file build selforgan map minim span tree filenam systemfileextdata fc packageflowsom flowsomr flowsomfilenam compensatetruetransformtru scaletruecolstousecnclu deprec current possibl anymor plot individu node alon necessari zoom node approxim exager size node plotstarsflowsomr nodes c rep maxnodes seealso codelinkplotstarscodelinkplotnumb codelinkflowsom gener roxygen edit hand pleas edit document r_metaclusteringr namemetaclustering_consensu aliasmetaclustering_consensu titlemetaclust usag metaclustering_consensusdata k seed null argument itemdatamatrix contain data cluster itemknumb cluster itemseedse pass consensusclusterplu valu numer array indic cluster datapoint descript cluster data use hierarch consensu cluster k cluster exampl read file build selforgan map minim span tree filenam systemfileextdata fc packag flowsom flowsomr readinputfilenam compens truetransform true scale true flowsomr buildsomflowsomrescolstous c flowsomr buildmstflowsomr appli consensu metaclust metacl metaclustering_consensusflowsomresmapcod k seealso codelinkmetaclust gener roxygen edit hand pleas edit document r_buildsomr namegetclustermfi aliasgetclustermfi titleget mfi valu cluster usag getclustermfisfsom colsus fals prettycolnam fals argument itemfsomflowsom object gener flowsom function buildsom function itemcolsusedlog report column use build som default fals itemprettycolnameslog report pretti column name instead standard column name default fals valu matrix median valu marker descript get mfi valu cluster exampl filenam systemfileextdata fc packag flowsom flowsomr flowsomfilenam compens true transform true scale true colstous c nclu mfi getclustermfisflowsomr gener roxygen edit hand pleas edit document r_buildsomr nameinitialize_pca aliasinitialize_pca titlecr grid first pca compon usag initialize_pcadata xdim ydim argument itemdatamatrix row repres point itemxdimx dimens grid itemydimi dimens grid valu array contain select select row descript creat grid first pca compon exampl point matrix ncol select initialize_pcapoint gener roxygen edit hand pleas edit document r_metaclusteringr namegetmetaclustercv aliasgetmetaclustercv titlegetmetaclustercv usag getmetaclustercvsfsom argument itemfsomresult call flowsom function valu metaclust cv descript comput coeffici variat metaclust exampl filenam systemfileextdata fc packag flowsom ff flowcorereadfcsfilenam ff flowcorecompensateff flowcorekeywordffspil ff flowcoretransformff flowcoretransformlistcolnamesflowcorekeywordffspil flowcorelogicletransform flowsomr flowsomff scale true colstous c nclu cv getmetaclustercvsflowsomr gener roxygen edit hand pleas edit document r_buildsomr namegetpercentag aliasgetpercentag titlegetpercentag usag getpercentagesfsom level metaclust argument itemfsomflowsom object itemlevelcharact string either cluster metaclust default valu name vector percentag descript get percentag number cell cluster metaclust exampl read file build selforgan map minim span tree filenam systemfileextdata fc packag flowsom ff flowcorereadfcsfilenam ff flowcorecompensateff flowcorekeywordffspil ff flowcoretransformff flowcoreestimatelogicleff flowcorecolnamesff flowsomr flowsomff scale true colstous c nclu seed getpercentagesflowsomr getpercentagesflowsomr level cluster gener roxygen edit hand pleas edit document r_plotfunctionsr nameplotvari aliasplotvari titleplotvari usag plotvari fsom variabl variablenam colorpalett flowsom_color lim null argument itemfsomflowsom object itemvariablea vector contain valu everi cluster itemvariablenamelabel show legend itemcolorpalettecolorpalett use function vector itemlimlimit scale itemaddit argument pass codelinkplotflowsom eg view backgroundvalu equalnodes descript plot variabl node detail plot flowsom grid tree colour node valu given variabl exampl build flowsom model filenam systemfileextdata fc packag flowsom flowsomr flowsomfilenam compens true transform true scale fals colstous c nclu seed plot random valu rand runifflowsomresmapnnod plotvariableflowsomr variabl rand variablenam random seealso codelinkplotstar codelinkquerystarplot codelinkplotflowsom codelinkplotlabel codelinkplotnumb codelinkplotmark codelinkplotpi codelinkplotsd gener roxygen edit hand pleas edit document r_flowsomr nameprintflowsom aliasprintflowsom titleprint flowsom object usag methodprintflowsomx argument itemxflowsom object print inform itemfurth argument use descript print flowsom object exampl filenam systemfileextdata fc packag flowsom flowsomr flowsomfilenam compens true transform true scale true colstous c nclu printflowsomr gener roxygen edit hand pleas edit document r_metaclusteringr namemetaclust aliasmetaclust titlemetaclust usag metaclusteringdata method max seed null argument itemdatamatrix contain data cluster itemmethodclust method use itemmaxmaximum number cluster tri itemseedse pass given cluster method itemextra paramet pass along valu numer array indic cluster datapoint descript cluster data automat number cluster determin sever algorithm exampl read file build selforgan map minim span tree filenam systemfileextdata fc packag flowsom flowsomr readinputfilenam compens truetransform true scale true flowsomr buildsomflowsomrescolstous c flowsomr buildmstflowsomr appli metaclust metacl metaclusteringflowsomresmapcod metaclustering_consensu max get metaclust per cell flowsomclust metaclflowsomresmapmap seealso codelinkmetaclustering_consensu gener roxygen edit hand pleas edit document r_buildsomr namegetcount aliasgetcount titlegetcount usag getcountsfsom level metaclust argument itemfsomflowsom object itemlevelcharact string either cluster metaclust default valu name vector count descript get count number cell cluster metaclust exampl read file build selforgan map minim span tree filenam systemfileextdata fc packag flowsom ff flowcorereadfcsfilenam ff flowcorecompensateff flowcorekeywordffspil ff flowcoretransformff flowcoreestimatelogicleff flowcorecolnamesff flowsomr flowsomff scale true colstous c nclu seed getcountsflowsomr getcountsflowsomr level cluster gener roxygen edit hand pleas edit document r_plotfunctionsr nameplotflowsom aliasplotflowsom titleplotflowsom usag plotflowsom fsom view mst nodes fsommappctg maxnodes refnodes maxnodes equalnodes fals backgroundvalu null backgroundcolor null backgroundlim null titl null argument itemfsomflowsom object creat codelinkflowsom itemviewpref view option mst grid matrix matrixdatafram consist coordin given coord default mst itemnodesizesa vector contain nodes automat scale maxnodes transform sqrt default fsommstsiz itemmaxnodesizedetermin maximum nodes default itemrefnodesizerefer nodes nodes scale default maxnodes itemequalnodesizeif codetru node equal maxnodes codefals default node scale number cell cluster itembackgroundvaluesvalu use background color either numer valu someth made factor eg cluster itembackgroundcolorscolorpalett use background color either function array specifi color itembackgroundlimonli use backgroundvalu numer default min max backgroundvalu itemtitletitl plot valu ggplot object base layer flowsom plot descript base layer plot flowsom result detail base layer flowsom plot choos layout mst grid coordin choos background color node size extend eg codelinkaddstar codelinkaddlabel codelinkaddpi exampl locat file file system fcs_file systemfileextdata fc packag flowsom build flowsom model flowsomr flowsomfcs_fil scale true compens true transform true totransform colstous c nclu seed plot background color plotflowsomflowsomr backgroundvalu flowsomresmetaclust layout mfi getclustermfisflowsomresgetchannelsflowsomr ccd cd plotflowsomflowsomr view mfi maxnodes backgroundvalu flowsomresmetaclust adapt node size plotflowsomflowsomr nodes view grid seealso codelinkplotstar codelinkplotvari codelinkplotmark codelinkplotlabel codelinkplotnumb codelinkplotpi codelinkquerystarplot codelinkplotsd gener roxygen edit hand pleas edit document r_buildmstr nameflowsomsubset aliasflowsomsubset titleflowsomsubset usag flowsomsubsetfsom id argument itemfsomflowsom object gener codelinkbuildmst itemidsarray contain id keep valu flowsom object conta updat data medianvalu grid descript flowsom subset detail take subset flowsom object exampl read two file artifici split file subset filenam systemfileextdata fc packag flowsom ff flowcorereadfcsfilenam flowcorekeywordfffil file ff flowcorereadfcsfilenam flowcorekeywordfffil file flowsomr flowsomflowcoreflowsetcff ff compens true transform true scale true colstous c maxmeta see metadata subset flowsomresmetadata use second file without chang map fsom flowsomsubsetflowsomr flowsomresmetadata flowsomresmetadata seealso codelinkbuildmst gener roxygen edit hand pleas edit document r_buildmstr nametestoutli aliastestoutli titletestoutli usag testoutliersfsom madallow fsomrefer null plotfil null argument itemfsomflowsom object itemmadallowednumb median absolut deviat allow default itemfsomreferenceflowsom object use refer null default origin fsom object use itemplotfileif codenul default plot creat filepath given pdf plot written correspond file valu new flowsom object descript test cell far cluster center detail everi cluster distanc cell cluster center use label cell deviat far outlier threshold chosen median distanc codemadallow time median absolut deviat distanc exampl build flowsom result filenam systemfileextdata fc packag flowsom ff flowcorereadfcsfilenam flowsomr flowsomff compens true transform true scale true colstous c maxmeta map new data outlier_report testoutliersflowsomr seealso codelinkflowsomsubset want get subset current data instead new dataset gener roxygen edit hand pleas edit document r_plotfunctionsr nameparsearc aliasparsearc titleparsearc usag parsearcsx arcvalu archeight argument itemxx coordin node itemyy coordin node itemarcvaluesa name vector frequenc node divid itemarcheightsth height arc valu datafram readi use ggplot consist coordin center radiu angl star valu descript pars star detail function pars flowsom object datafram star valu ggplot seealso codelinkplotflowsom codelinkparseedg codelinkparsenodes codelinkparsequeri codelinkparsesd gener roxygen edit hand pleas edit document r_buildmstr namenmetaclust aliasnmetaclust titlenmetaclust usag nmetaclustersfsom argument itemfsomflowsom object valu number metaclust descript extract number metaclust flowsom object exampl build flowsom result filenam systemfileextdata fc packag flowsom ff flowcorereadfcsfilenam flowsomr flowsomff compens true transform true scale true colstous c maxmeta nmetaclustersflowsomr gener roxygen edit hand pleas edit document r_buildsomr namegetfeatur aliasgetfeatur titlegetfeatur usag getfeatur fsom file level ccluster metaclust type count mfi null filenam null silent fals argument itemfsomflowsom object gener flowsom function buildsom function itemfileseith vector fc file path fc file itemlevellevel interest default ccluster metaclust also one itemtypetyp featur extract default count vector count percentag andor mfi itemmfivector channel marker mfi valu must return mfi codetyp itemfilenamesan option vector filenam use rownam count matric null default either path use numer vector itemsilentlog codetru print progress messag default codefals valu matrix featur per popul type combin descript map fc file exist flowsom object exampl build flowsom result filenam systemfileextdata fc packag flowsom ff flowcorereadfcsfilenam ff flowcorecompensateff flowcorekeywordffspil ff flowcoretransformff flowcoretransformlistcolnamesflowcorekeywordffspil flowcorelogicletransform flowsomr flowsomff scale true colstous c nclu map new data count getfeaturesfsom flowsomr level cluster file cff ff featur getfeaturesfsom flowsomr file cff ff type ccount percentag mfi mfi apca filenam cff_ ff_ gener roxygen edit hand pleas edit document r_readinputr nameaddflowfram aliasaddflowfram titleadd flowfram data variabl flowsom object usag addflowframefsom flowfram argument itemfsomflowsom object construct readinput function itemflowframeflowfram add flowsom object valu flowsom object data ad descript add flowfram data variabl flowsom object seealso codelinkreadinput gener roxygen edit hand pleas edit document r_plotfunctionsr nameparsenodes aliasparsenodes titleparsenodes usag parsenodesizenodes maxnodes refnodes argument itemnodesizesa vector nodes itemmaxnodesizedetermin maximum nodes itemrefnodesizerefer nodes nodes scale default maxnodes valu vector return consist node size descript pars node size detail function pars map flowsom object node size rel abund cell per cluster scale node size rel abund cell per cluster seealso codelinkplotflowsom codelinkparseedg codelinkautomaxnodes codelinkparsearc codelinkparsequeri codelinkparsesd gener roxygen edit hand pleas edit document r_plotfunctionsr nameplotstar aliasplotstar titleplotstar usag plotstar fsom marker fsommapcolsus colorpalett flowsom_color list_insteadof_ggarrang fals argument itemfsomflowsom object gener codelinkbuildmst itemmarkersmark plot pars getchannel itemcolorpalettecolorpalett use itemlist_insteadof_ggarrangeif fals default plot legend combin ggarrang true seper element return list allow custom itemaddit argument pass codelinkplotflowsom valu noth return plot drawn node repres star chart indic median fluoresc intens reset layout back plot end descript plot star chart detail plot flowsom grid tree node repres star chart indic median marker valu exampl read file build selforgan map minim span tree filenam systemfileextdata fc packag flowsom flowsomr flowsomfilenam compens true transform true scale true colstous c plot star indic mfi cell present node plotstarsflowsomr seealso codelinkplotmark codelinkplotvari codelinkplotflowsom codelinkplotlabel codelinkplotnumb codelinkplotpi codelinkquerystarplot codelinkplotsd gener roxygen edit hand pleas edit document r_buildmstr namenclust aliasnclust titlenclust usag nclustersfsom argument itemfsomflowsom object valu number cluster descript extract number cluster flowsom object exampl build flowsom result filenam systemfileextdata fc packag flowsom ff flowcorereadfcsfilenam flowsomr flowsomff compens true transform true scale true colstous c maxmeta nclustersflowsomr gener roxygen edit hand pleas edit document r_metaclusteringr nameupdatemetaclust aliasupdatemetaclust titleupdatemetaclust usag updatemetaclust fsom newlabel null clusterassign null levelord null argument itemfsomresult call flowsom function itemnewlabelsopt name vector name origin metaclust name valu replac use renam merg metaclust itemclusterassignmentopt either name vector name cluster number charact vector length nclustersfsom use assign cluster exist new metaclust itemlevelorderopt vector show prefer order fsom metaclust level valu updat flowsom object descript adapt metaclust level use renam metaclust split merg exist metaclust add metaclust andor reorder level metaclust exampl filenam systemfileextdata fc packag flowsom ff flowcorereadfcsfilenam ff flowcorecompensateff flowcorekeywordffspil ff flowcoretransformff flowcoretransformlistcolnamesflowcorekeywordffspil flowcorelogicletransform flowsomr flowsomff scale true colstous c nclu seed plotstarsflowsomr backgroundvalu flowsomresmetaclust getcountsflowsomr merg mc mc flowsomr updatemetaclustersflowsomr newlabel c plotstarsflowsomr backgroundvalu flowsomresmetaclust getcountsflowsomr split cluster metaclust order metaclust level flowsomr updatemetaclustersflowsomr clusterassign c debri levelord cdebri ascharacterc plotstarsflowsomr backgroundvalu flowsomresmetaclust plotnumbersflowsomr level metaclust getcountsflowsomr gener roxygen edit hand pleas edit document r_plotfunctionsr nameplotdimr aliasplotdimr titleplotdimr usag plotdimr fsom colstous fsommapcolsus colorbi metaclust ctotal null dimr rtsnertsn extractlayout functiondimr dimredi label true returnlayout fals seed null titl null argument itemfsomflowsom object gener codelinkbuildmst itemcolstouseth column use dimension reduct default fsommapcolsus itemcolorbydefin dimension reduct color metaclust default cluster markerchannelindex itemctotalth total amount cell use dimension reduct default cell itemdimreda dimension reduct function default rtsnertsn altern datafram matrix either equal number row fsom originalid column recommend put ctotal null provid matrix ensur dimr correspond subsampl flowsom data ctotal cell seed itemextractlayouta function extract coordin result dimr default functiondimreddimredi itemlabelif label true default label ad plot itemreturnlayoutif true function return datafram layout dimr origin id plot default fals itemseeda seed reproduc itemtitlea titl plot itemaddit argument pass dimr valu dimension reduct plot made ggplot descript plot dimension reduct detail plot dimension reduct fsomdata exampl file systemfileextdata fc packageflowsom flowsomr flowsomfil compens true transform true scale true colstous c nclu silent fals xdim ydim plotdimredflowsomr ctotal seed titl tsne plotdimredflowsomr ctotal colorbi cd seed titl tsne gener roxygen edit hand pleas edit document r_deprecatedr nameplotclustersd aliasplotclustersd titleplotclustersd usag plotclustersd fsom marker marker node col ff maxbgpoint pchbackground pchcluster main xlab fsomprettycolnamesmark ylab fsomprettycolnamesmark xlim cminfsomdata marker maxfsomdata marker ylim cminfsomdata marker maxfsomdata marker argument itemfsomflowsom object gener codelinkbuildmst itemmarkermark plot xaxi itemmarkermark plot yaxi itemnodesnod cell plot red itemcolcolor cell select node order array itemmaxbgpointsmaximum number background point plot itempchbackgroundcharact use background cell itempchclustercharact use cell cluster itemmaintitl plot itemxlablabel x axi itemylablabel axi itemxlimlimit x axi itemylimlimit axi itemoth paramet pass plot valu noth return plot drawn cell plot black cell select node red descript plot node scatter plot detail plot scatter plot cell fsomdata plot black select node plot red node grid index start left bottom first go right eg x grid node top left index exampl deprec use plotdscatt instead read file build selforgan map minim span tree filenam systemfileextdata fc packag flowsom flowsomr readinputfilenam compens true transform true scale true flowsomr buildsomflowsomr colstous c flowsomr buildmstflowsomr plot cell dontrun plotdscattersflowsomr c cluster seealso codelinkplotnumb codelinkplotcent codelinkbuildmst gener roxygen edit hand pleas edit document r_buildsomr namesom aliassom titlebuild selforgan map usag som data xdim ydim rlen mst alpha c radiu statsquantilenhbrdist c init fals initf initialize_kwsp distf silent fals code null import null argument itemdatamatrix contain train data itemxdimwidth grid itemydimhight grid itemrlennumb time loop train data mst itemmstnumb time build mst itemalphastart end learn rate itemradiusstart end radiu iteminitiniti cluster center nonrandom way iteminitfus given initi function init default initialize_kwsp itemdistfdist function manhattan euclidean chebyshev cosin itemsilentif fals print statu updat itemcodesclust center start itemimportancearray numer valu paramet scale accord import valu list contain paramet set result descript build selforgan map refer code strongli base codekohonen packag r wehren lmc buyden self superorganis map r kohonen packag j stat softw seealso codelinkbuildsom gener roxygen edit hand pleas edit document r_buildsomr namegroupstat aliasgroupstat titlegroupstat usag groupstatsfeatur group argument itemfeaturesfeatur matrix gener codelinkgetfeatur eg percentag matrix itemgroupsnam list file patient id per group match rownam codematrix valu matrix median per group pvalu raw benjamini hochberg correct one log result wilcox test fold log fold chang median group descript calcul statist group base codelinkgetfeatur output exampl build flowsom result filenam systemfileextdata fc packag flowsom ff flowcorereadfcsfilenam ff flowcorecompensateff flowcorekeywordffspil ff flowcoretransformff flowcoretransformlistcolnamesflowcorekeywordffspil flowcorelogicletransform flowsomr flowsomff scale true colstous c nclu creat new data illustr output gener new fc file cell metaclust practic would gener new file use differ file differ group flowcorewritefcsffsamplenrowff file ff_tmpfc flowcorewritefcsffsamplenrowff file ff_tmpfc flowcorewritefcsffsamplenrowff file ff_tmpfc ff_tmp ffc whichflowsomresmapmap whichflowsomresmetaclust whichflowsomresmapmap whichflowsomresmetaclust flowcorewritefcsff_tmpsamplenrowff_tmp file ff_tmpfc flowcorewritefcsff_tmpsamplenrowff_tmp file ff_tmpfc get count matrix percentag getfeaturesfsom flowsomr file cff_tmpfc ff_tmpfc ff_tmpfc ff_tmpfc ff_tmpfc type percentag perform statist group listgroup cff_tmpfc ff_tmpfc ff_tmpfc group cff_tmpfc ff_tmpfc mc_stat groupstatspercentagesmetacluster_percentag group c_stat groupstatspercentagescluster_percentag group process fold chang vector fold_chang c_statsfold chang fold_chang factorifelsefold_chang underrepres compar group ifelsefold_chang overrepres compar group level c underrepres compar group overrepres compar group fold_changesisnafold_chang show figur fold chang gr_ plotstarsflowsomr titl group nodes c_statsmedian group list_insteadof_ggarrang true gr_ plotstarsflowsomr titl group nodes c_statsmedian group backgroundvalu fold_chang backgroundcolor cwhite red blue list_insteadof_ggarrang true p ggpubrggarrangeplotlist clistgr_tre gr_ height c ggplotggsavegroups_foldchangespdf p width p valu p plotvariableflowsomr titl wilcox test group vs group variabl c_statsp valu ggplotggsavegroups_pvaluespdf p volcano plot p ggplotggplotdataframelog p valu cc_stat mc_stat log fold chang cc_stat mc_stat checknam fals ggplotaesx log fold chang log p valu ggplotxlim ggplotylim ggplotgeom_point gener roxygen edit hand pleas edit document r_flowsomr nameplotfilescatt aliasplotfilescatt titleplotfilescatt usag plotfilescatt input channel null ymargin null ylabel cmarker quantil null name null group null color null legend fals maxpoint ncol null nrow null silent fals plotfil filescatterspng argument iteminputeith flowset flowfram output codelinkaggregateflowfram function vector path point fc file itemchannelsvector channel marker need plot null default channel input plot itemymarginopt paramet specifi margin yaxi itemylabeldetermin label yaxi marker andor channel default marker itemquantilesif provid default null numer vector valu quantil indic plot itemnamesopt paramet provid filenam codenul default filenam number duplic filenam made uniqu itemgroupsopt paramet specifi group file length codeinput id codenul default file plot color itemcoloropt paramet provid color length number group codegroup codenul itemlegendlog paramet specifi whether group level display default codefals itemmaxpointstot number data point plot per channel default itemncolnumb column final plot option itemnrownumb row final plot option itemsilentif fals print updat everi time start process new file default fals itemplotfilepath png file default filescatterspng codenul output list ggplot valu list ggplot object codeplot codefals otherwis codefileplot plot creat descript make scatter plot per channel provid file exampl preprocess filenam systemfileextdata fc packag flowsom ff flowcorereadfcsfilenam ff flowcorecompensateff flowcorekeywordffspil ff flowcoretransformff flowcoretransformlistcolnamesflowcorekeywordffspil flowcorelogicletransform flowcorewritefcsff file ff_tmpfc flowcorewritefcsff file ff_tmpfc flowcorewritefcsff file ff_tmpfc make plot plotfilescattersinput cff_tmpfc ff_tmpfc ff_tmpfc channel cpacif bluea alexa fluor pecya maxpoint gener roxygen edit hand pleas edit document r_buildsomr namedistmst aliasdistmst titlecalcul distanc matrix use minim span tree neighbourhood usag distmstx argument itemxmatrix row repres point valu distanc matrix descript calcul distanc matrix use minim span tree neighbourhood gener roxygen edit hand pleas edit document r_deprecatedr namegetcv aliasgetcv titleget cv valu cluster usag getcvsfsom argument itemfsomflowsom object gener flowsom function buildsom function valu matrix coeffici variat valu marker filenam systemfileextdata fc packageflowsom flowsomr flowsomfilenam compensatetruetransformtru scaletruecolstousecnclu cv getclustercvsflowsomr descript get cv valu cluster gener roxygen edit hand pleas edit document r_plotfunctionsr nameparsequeri aliasparsequeri titleparsequeri usag parsequeryfsom queri argument itemfsomflowsom object gener codelinkflowsom itemqueryarray contain high low specifi column name flowsom data valu list contain id select node individu score node score marker node descript pars queri detail identifi node tree resembl certain profil high low marker express seealso codelinkplotflowsom codelinkparseedg codelinkparsenodes codelinkparsearc codelinkquerystarplot codelinkparsesd gener roxygen edit hand pleas edit document r_flowsomr namegetflowjolabel aliasgetflowjolabel titleprocess flowjo workspac file usag getflowjolabel file wspfile group sampl celltyp null getdata fals argument itemfilesth fc file interest itemwspfileth flowjo wsp file read itemgroupth flowjo group pars default sampl itemcelltypescel type use final label cell correspond subset gate name flowjo itemgetdataif true flowfram return well itemextra argument pass cytomlflowjo_to_gatingset valu function return list everi file contain list first element matrix matrix contain filter result specifi gate second element manual vector assign one label cell one file given one list return instead list list descript read flowjo workspac file use codelinkflowworkspac librari return list matrix contain gate result vector label cell set specifi gate exampl identifi file fcs_file systemfileextdata fc packag flowsom wspfile systemfileextdata gatingwsp packag flowsom specifi cell type interest assign one label per cell celltyp cb cell gd cell cd cell cd cell nk cell nk cell pars flowjo workspac gatingresult getflowjolabelsfcs_fil wspfile celltyp celltyp getdata true check number cell assign gate colsumsgatingresultmatrix build flowsom tree flowsomr flowsomgatingresultflowfram colstous c nclu seed plot pie indic percentag cell type present node plotpiesflowsomr gatingresultmanu backgroundvalu flowsomresmetaclust seealso codelinkplotpi gener roxygen edit hand pleas edit document r_plotfunctionsr namescalestarheight aliasscalestarheight titlescalestarheight usag scalestarheightsdata nodes argument itemdatamedianvalu relev marker extrac flowsom object itemnodesizesa vector return codeparsenodes valu datafram consist scale valu star star scale maximum star descript scale starheight detail function scale star valu node size seealso codelinkplotflowsom codelinkparsenodes codelinkautomaxnodes gener roxygen edit hand pleas edit document r_plotfunctionsr nameflowsommari aliasflowsommari titleflowsommari usag flowsommaryfsom plotfil flowsommarypdf argument itemfsomflowsom object gener codelinkflowsom itemplotfilenam pdf file gener default flowsommarypdf codenul list ggplot return valu return summari flowsom object descript function plot summari flowsom object includ tabl metaclust data flowsom tree grid view metaclust label marker express file distribut present cluster per metaclust percentag tsne plot mfi per metaclust exampl identifi file fc flowcorereadfcssystemfileextdata fc packag flowsom build flowsom object flowsomr flowsomfc scale true compens true transform true totransform colstous c nclu seed flowsommaryflowsomr gener roxygen edit hand pleas edit document r_plotfunctionsr nameplotnumb aliasplotnumb titleplotnumb usag plotnumbersfsom level cluster maxnodes argument itemfsomflowsom object itemlevelcharact string either cluster metaclust itemmaxnodesizedetermin maximum nodes default see codelinkplotflowsom option itemaddit argument pass codelinkplotlabel codelinkplotflowsom valu noth return plot drawn node label cluster id descript plot cluster id cluster detail plot flowsom grid tree node cluster id exampl read file build selforgan map minim span tree filenam systemfileextdata fc packag flowsom ff flowcorereadfcsfilenam ff flowcorecompensateff flowcorekeywordffspil ff flowcoretransformff flowcoreestimatelogicleff flowcorecolnamesff flowsomr flowsomff scale true colstous c nclu seed plot node id plotnumbersflowsomr plotnumbersflowsomr metaclust plotnumbersflowsomr view grid plotnumbersflowsomr maxnodes equalnodes true seealso codelinkplotstar codelinkplotvari codelinkplotflowsom codelinkplotlabel codelinkplotmark codelinkplotpi codelinkquerystarplot codelinkplotsd gener roxygen edit hand pleas edit document r_plotfunctionsr nameupdateflowsom aliasupdateflowsom titleupdateflowsom usag updateflowsomfsom argument itemfsomflowsom object gener codelinkbuildmst codelinkflowsom valu flowsom object descript updat old flowsom object new one check flowsom object detail determin whether fsom input class flowsom return flowsom object metaclust object insid fsom seealso codelinkplotflowsom gener roxygen edit hand pleas edit document rutilspip name alia titlepip oper usag lh rh descript see codemagrittrlinkmagrittrpip detail keywordintern gener roxygen edit hand pleas edit document r_plotfunctionsr nameplotmanualbar aliasplotmanualbar titleplotmanualbar usag plotmanualbar fsom fc null manualvector manualord null color null list_insteadof_plot fals argument itemfsomflowsom object gener codelinkflowsom codelinknewdata cluster metaclsut plot order factor level itemfcsfc file map flowsom object default null itemmanualvectorvector cell label eg obtain manual gate itemmanualorderopt vector uniqu cell label fix order cell label shown itemcolorsopt color vector length number unqu cell label itemlist_insteadof_plotsif codefals default return multipl plot codetru return list ggplot object valu either plot ggplot object list return descript function plot manual label per flowsom metaclust barplot exampl identifi file fcs_file systemfileextdata fc packag flowsom wsp_file systemfileextdata gatingwsp packag flowsom specifi cell type interest assign one label per cell celltyp cb cell gd cell cd cell cd cell nk cell nk cell pars flowjo workspac libraryflowworkspac gatingresult getflowjolabelsfcs_fil wsp_file celltyp celltyp build flowsom object flowsomr flowsomfcs_fil scale true compens true transform true totransform colstous c nclu seed make barplot manual label pdfplotmanualbarspdf plotmanualbarsfsom flowsomr fc fcs_file manualvector gatingresultmanu manualord ccelltyp unlabel color cfd bf ba bfc cff fe ddd devoff gener roxygen edit hand pleas edit document r_plotfunctionsr nameaddstar aliasaddstar titleaddstar usag addstarsp fsom marker fsommapcolsus colorpalett null argument itempggplot object itemfsomflowsom object gener codelinkbuildmst itemmarkersdetermin marker plot default fsommapcolsus itemcolorpalettecolorpalett use color either function array specifi color valu ggplot object star ad descript function plot star seealso codelinkplotflowsom codelinkaddlabel codelinkaddnod codelinkaddbackground codelinkplotstar codelinkaddpi codelinkparsearc gener roxygen edit hand pleas edit document r_buildsomr namesaveclusterstofc aliassaveclusterstofc titlewrit flowsom cluster result origin fc file usag saveclusterstofc fsom originalfil preprocessedfil null selectioncolumn null silent fals outputdir suffix _flowsomfc argument itemfsomflowsom object gener buildsom itemoriginalfilesfc file extend itempreprocessedfilesfc file correspond input flowsom null default originalfil use itemselectioncolumncolumn fc file indic origin cell id null default select made itemsilentif fals default print extra output itemoutputdirdirectori save fc file default current work directori itemsuffixsuffix ad filenam default _flowsomfc valu save extend fc file originalname_flowsomfc descript write flowsom cluster result origin fc file exampl filenam systemfileextdata fc packag flowsom flowsomr flowsomfilenam compens true transform true scale true colstous c nclu saveclusterstofcsflowsomr filenam gener roxygen edit hand pleas edit document r_deprecatedr nameplotcent aliasplotcent titleplotcent usag plotcentersfsom marker marker mst true argument itemfsomflowsom object gener codelinkbuildmst itemmarkermark show xaxi itemmarkermark show yaxi itemmsttyp visual plot tree els plot grid valu noth return scatter plot drawn node grid indic descript plot cluster center plot detail plot flowsom node scatter plot data exampl read file build selforgan map minim span tree filenam systemfileextdata fc packageflowsom flowsomr readinputfilenam compensatetruetransformtru scaletru flowsomr buildsomflowsomrescolstousec flowsomr buildmstflowsomr plot center plot plotdscattersflowsomr channelpair listcfscassca cluster listseq_lennclustersflowsomr maxpoint plotfil null seealso codelinkplotstarscodelinkplotpi codelinkplotmarkercodelinkbuildmst gener roxygen edit hand pleas edit document r_deprecatedr nameget_channel aliasget_channel titleget_channel usag get_channelsff marker argument itemffth flowfram interest itemmarkersvector marker channel interest valu correspond channel name descript get channel name array marker given flowfram exampl read flowfram filenam systemfileextdata fc packageflowsom ff flowcorereadfcsfilenam getchannelsff cfsca cd fitca getmarkersff cfsca cd fitca seealso codelinkget_mark gener roxygen edit hand pleas edit document r_plotfunctionsr nameaddbackground aliasaddbackground titleaddbackground usag addbackground p backgroundvalu backgroundcolor null backgroundlim null argument itempggplot object itembackgroundvaluesvector valu plot background node itembackgroundcolorscolorpalett backgroundcolor itembackgroundlimbackground limit use ensur consist colorpalett plot null default automat adapt data valu return noth plot background descript function plot background seealso codelinkplotflowsom codelinkaddlabel codelinkaddnod codelinkaddpi codelinkaddstar gener roxygen edit hand pleas edit document r_metaclusteringr namefmeasur aliasfmeasur titlef measur usag fmeasurerealclust predictedclust silent fals argument itemrealclustersarray contain real cluster label sampl itempredictedclustersarray contain predict cluster label sampl itemsilentlog fals default print inform precis recal valu f measur score descript comput f measur two cluster result exampl gener random data exampl realclust samplereplac true predictedclust sampl replac true calcul fmeasur fmeasurerealclusterspredictedclust gener roxygen edit hand pleas edit document r_deprecatedr namemetaclustercv aliasmetaclustercv titlemetaclustercv usag metaclustercvsfsom argument itemfsomresult call flowsom function valu metaclust cv descript comput coeffici variat metaclust exampl filenam systemfileextdata fc packageflowsom ff flowcorereadfcsfilenam ff flowcorecompensateffffdescriptionspil ff flowcoretransformff flowcoretransformlistcolnamesffdescriptionspil flowcorelogicletransform flowsomr flowsomffscaletruecolstousec nclu cv getmetaclustercvsflowsomr gener roxygen edit hand pleas edit document r_plotfunctionsr nameplotpi aliasplotpi titleplotpi usag plotpi fsom celltyp colorpalett grdevicescolorramppalettecwhit f blue fff cyan ffff yellow fff red f argument itemfsomflowsom object gener codelinkflowsom itemcelltypesarray factor indic celltyp itemcolorpalettecolor palett use itemaddit argument pass codelinkplotflowsom valu ggplot plot descript plot comparison cluster detail plot flowsom grid tree pie indic anoth cluster manual gate result exampl identifi file fcs_file systemfileextdata fc packag flowsom wsp_file systemfileextdata gatingwsp packag flowsom specifi cell type interest assign one label per cell celltyp cb cell gd cell cd cell cd cell nk cell nk cell pars flowjo workspac gatingresult getflowjolabelsfcs_fil wsp_file celltyp celltyp check number cell assign gate colsumsgatingresultmatrix build flowsom tree flowsomr flowsomfcs_fil scale true compens true transform true totransform colstous c nclu seed plot pie indic percentag cell type present node plotpiesflowsomr gatingresultmanu backgroundvalu flowsomresmetaclust seealso codelinkplotstar codelinkplotvari codelinkplotflowsom codelinkplotlabel codelinkplotnumb codelinkplotmark codelinkquerystarplot codelinkplotsd gener roxygen edit hand pleas edit document r_plotfunctionsr nameautomaxnodes aliasautomaxnodes titleautomaxnodes usag automaxnodesizelayout overlap argument itemlayoutcoordin node itemoverlapparamet determin much overlap neg node smaller valu return maxnodes overlap descript calcul node size detail function calcul minimum distanc node use adapt maxnodes better plot seealso codelinkplotflowsom codelinkscalestarheight codelinkparsenodes gener roxygen edit hand pleas edit document r_deprecatedr nameget_mark aliasget_mark titleget_mark usag get_markersff marker argument itemffth flowfram interest itemmarkersvector marker channel interest valu correspond marker name descript get marker name given flowfram avail desc na default channel name exampl read flowfram filenam systemfileextdata fc packageflowsom ff flowcorereadfcsfilenam getchannelsff cfsca cd fitca getmarkersff cfsca cd fitca seealso codelinkget_channel gener roxygen edit hand pleas edit document r_plotfunctionsr nameaddpi aliasaddpi titleaddpi usag addpiesp fsom celllabel layout null colorpalett null argument itempggplot object itemfsomflowsom object gener codelinkbuildmst itemcelllabelsarray factor indic cell label itemlayoutcoordin node use datafram ggplot object null itemcolorpalettecolorpalett use color either function array specifi color valu ggplot object pie ad descript function plot pie seealso codelinkplotflowsom codelinkaddlabel codelinkaddnod codelinkaddbackground codelinkplotpi codelinkaddstar codelinkparsearc gener roxygen edit hand pleas edit document r_flowsomr nameaggregateflowfram aliasaggregateflowfram titleaggreg multipl fc file togeth usag aggregateflowfram filenam ctotal channel null writeoutput fals outputfil aggregatefc keepord fals silent fals argument itemfilenamescharact vector contain full path fc file aggreg itemctotaltot number cell write output file itemchannelschannelsmark keep aggreg default null take channel first file itemwriteoutputwheth write result flowfram file default fals itemoutputfileful path output file default aggregatefc itemkeeporderif true random subsampl order way origin order file default fals itemsilentif fals print updat everi time start process new file default fals itemaddit argument pass readfc valu function return anyth write file codectot cell codeoutputfil descript aggreg multipl fc file analyz simultan new fc file written contain codectot cell codeceilingctotalnfil cell file two new column ad column indic origin file index noisi version better plot opportun index plu minu valu exampl defin filenam filenam systemfileextdata fc packag flowsom exampl sampl time cell ff_new aggregateflowframescfilenam filenam seealso codelinkceil gener roxygen edit hand pleas edit document r_metaclusteringr namegetmetaclustermfi aliasgetmetaclustermfi titlegetmetaclustermfi usag getmetaclustermfisfsom colsus fals prettycolnam fals argument itemfsomresult call flowsom function itemcolsusedlog report column use build som default fals itemprettycolnameslog report pretti column name instead standard column name default fals valu metaclust mfi descript comput median fluoresc intens metaclust exampl filenam systemfileextdata fc packag flowsom ff flowcorereadfcsfilenam ff flowcorecompensateff flowcorekeywordffspil ff flowcoretransformff flowcoretransformlistcolnamesflowcorekeywordffspil flowcorelogicletransform flowsomr flowsomff scale true colstous c nclu mfi getmetaclustermfisflowsomr gener roxygen edit hand pleas edit document r_flowsomr namegetmark aliasgetmark titlegetmark usag getmarkersobject channel exact true argument itemobjectth flowfram flowsom object interest itemchannelsvector marker channel interest also accept index channel object itemexactif true default grep pattern extend start q end e exact match possibl valu correspond marker name descript get marker name array channel given flowfram flowsom object avail desc na default channel name codelinkgrep use look marker regex ad exampl read flowfram filenam systemfileextdata fc packag flowsom ff flowcorereadfcsfilenam getchannelsff cfsca cd fitca getmarkersff cfsca cd fitca seealso codelinkgetchannel gener roxygen edit hand pleas edit document r_plotfunctionsr nameplotstarlegend aliasplotstarlegend titleplotstarlegend usag plotstarlegendmark color starheight argument itemmarkersvector marker use legend itemcolorscolorpalett legend vector function itemstarheightstar height default valu return noth plot legend flowsom star plot descript plot star legend detail function make legend flowsom star plot exampl plotstarlegendccd cd cd flowsom_color seealso codelinkplotflowsom gener roxygen edit hand pleas edit document r_buildmstr namenewdata aliasnewdata titlenewdata usag newdata fsom input madallow compens null spillov null transform null totransform null transformfunct null transformlist null scale null scaledcent null scaledscal null silent fals argument itemfsomflowsom object iteminputa flowfram flowset array path file directori itemmadalloweda warn gener distanc new data point closest cluster center big comput base typic distanc point origin dataset assign cluster threshold set median madallow mad default itemcompensatelog data need compens null valu origin flowsom call use itemspilloverspillov matrix compens null valu origin flowsom call use itemtransformlog data need transform null valu origin flowsom call use itemtotransformcolumn name indic need transform null valu origin flowsom call use itemtransformfunctionif null valu origin flowsom call use itemtransformlistif null valu origin flowsom call use itemscalelog data need rescal null valu origin flowsom call use itemscaledcenterse codelinkscal null valu origin flowsom call use itemscaledscalese codelinkscal null valu origin flowsom call use itemsilentlog codetru print progress messag default codefals valu new flowsom object descript map new data flowsom grid detail new data map exist flowsom object input similar readinput function new flowsom object creat grid new map node size mean valu preprocess step compens tranform scale happen file specifi origin flowsom call scale paramet origin grid use exampl build flowsom result filenam systemfileextdata fc packag flowsom ff flowcorereadfcsfilenam ff flowcorecompensateff flowcorekeywordffspil ff flowcoretransformff flowcoretransformlistcolnamesflowcorekeywordffspil flowcorelogicletransform flowsomr flowsomff scale true colstous c nclu map new data fsom newdataflowsomr ff seealso codelinkflowsomsubset want get subset current data instead new dataset gener roxygen edit hand pleas edit document r_plotfunctionsr nameaddmst aliasaddmst titleaddmst usag addmstp fsom argument itempggplot object itemfsomflowsom object gener codelinkflowsom valu return noth plot mst flowsom mst view descript function plot mst seealso codelinkplotflowsom codelinkparseedg codelinkaddstarspi codelinkaddlabel codelinkaddnod codelinkaddbackground codelinkaddpi codelinkaddstar gener roxygen edit hand pleas edit document r_plotfunctionsr namegg_color_hu aliasgg_color_hu titlegg_color_hu usag gg_color_huen argument itemnnumb color valu array hexadecim color valu descript helper function get ggplot color gener roxygen edit hand pleas edit document r_deprecatedr nameupdatenodes aliasupdatenodes titleupdatenodes usag updatenodes fsom count null reset fals transform sqrt maxnodes shift scale null argument itemfsomflowsom object gener codelinkbuildmst itemcountabsolut cell count sampl itemresetlog codetru node get size itemtransformtransform function use eg squar root let count correspond area node instead radiu itemmaxnodesizemaximum node size rescal default itemshiftshift count default itemscalesc count default maximum valu minu shift shift scale set default largest node maxnodes empti node size valu updat flowsom object descript updat nodes flowsom object detail add size properti graph base cellcount node exampl read file build selforgan map minim span tree filenam systemfileextdata fc packageflowsom flowsomr readinputfilenam compensatetruetransformtru scaletru flowsomr buildsomflowsomrescolstousec flowsomr buildmstflowsomr give node size plotstarsflowsomr equalnodes true node size rel amount cell assign node plotstarsflowsomr seealso codelinkbuildmst gener roxygen edit hand pleas edit document r_flowsomr namemanualvector aliasmanualvector titlesummaris gate matrix one vector includ cell type interest usag manualvectormanualmatrix celltyp argument itemmanualmatrixmatrix contain boolean valu indic everi gate column whether cell row part itemcelltypescel type use summari vector other ignor cell fall one gate get label unknown order import valu factor one label everi cell descript extract compens transform data gate label gener roxygen edit hand pleas edit document r_plotfunctionsr nameaddscal aliasaddscal titleaddscal usag addscal p valu null color null limit null showlegend true labellegend type fill argument itempggplot object itemvaluesvalu use fill itemcolorscolor use vector function itemlimitslimit use scale itemshowlegendboolean whether show legend itemlabellegendlabel show titl legend itemtypefil default color valu ggplot object scale ad descript addscal gener roxygen edit hand pleas edit document r_flowsomr namegetchannel aliasgetchannel titlegetchannel usag getchannelsobject marker exact true argument itemobjectth flowfram flowsom object interest itemmarkersvector marker channel interest also accept index marker found object itemexactif true default grep pattern extend start q end e exact match possibl valu correspond channel name descript get channel name array marker given flowfram flowsom object avail name codelinkgrep use look marker regex ad exampl read flowfram filenam systemfileextdata fc packag flowsom ff flowcorereadfcsfilenam getchannelsff cfsca cd fitca getmarkersff cfsca cd fitca seealso codelinkgetmark gener roxygen edit hand pleas edit document r_buildsomr namebuildsom aliasbuildsom titlebuild selforgan map usag buildsomfsom colstous null silent fals outliermad argument itemfsomflowsom object contain data construct codelinkreadinput function itemcolstousemark channel indic use build som itemsilentif codetru progress updat print itemoutliermadnumb mad cell consid outlier see also codelinktestoutli itemopt pass som function xdim ydim rlen mst alpha radiu init distf import valu flowsom object contain som result use input codelinkbuildmst function descript build som base data contain flowsom object exampl read file filenam systemfileextdata fc packag flowsom flowsomr readinputfilenam compens true transform true scale true build selforgan map eg gridsiz x present dataset time use mst neighbourhood calcul flowsomr buildsomflowsomr colstous c xdim ydim rlen build minim span tree appli metaclust flowsomr buildmstflowsomr metacl metaclusteringflowsomresmapcod metaclustering_consensu max refer code strongli base codekohonen packag r wehren lmc buyden self superorganis map r kohonen packag j stat softw seealso codelinkreadinput codelinkbuildmst gener roxygen edit hand pleas edit document r_deprecatedr namecountgroup aliascountgroup titlecalcul differ cell count group usag countgroupsfsom group plot true silent fals argument itemfsomflowsom object gener buildsom itemgroupslist contain array file name group itemplotlog true make starplot individu file itemsilentlog true print progress messag valu distanc matrix descript calcul differ cell count group exampl setse filenam systemfileextdata fc packageflowsom flowsomr flowsomfilenam compens true transform true scale true colstous c nclu ff flowcorereadfcsfilenam make addit file without cluster doubl amount cluster select cwhichgetclustersflowsomr whichflowsomresmetaclust whichgetclustersflowsomr whichflowsomresmetaclust ff_tmp ffselect flowcorewritefcsff_tmp fileff_tmpfc compar file doubl amount cluster featur getfeaturesflowsomr cfilenam ff_tmpfc level cluster type percentag stat groupstatsfeaturescluster_percentag group listallcel cfilenam without_ydtcel cff_tmpfc seealso groupstat gener roxygen edit hand pleas edit document r_plotfunctionsr nameplotmark aliasplotmark titleplotmark usag plotmark fsom marker refmark fsommapcolsus titl getmarkersfsom marker colorpalett flowsom_color lim null argument itemfsomflowsom object itemmarkera vector markerschannel plot itemrefmarkersi use determin rel scale marker plot default marker use cluster itemtitlea vector custom titl plot default marker name itemcolorpalettecolorpalett use function vector itemlimlimit scale itemaddit argument pass codelinkplotflowsom eg view backgroundvalu equalnodes valu ggplot figur return everi cluster color accord mfi valu specifi marker descript plot comparison cluster detail plot flowsom grid tree colour node valu specif marker exampl build flowsom model filenam systemfileextdata fc packag flowsom flowsomr flowsomfilenam compens true transform true scale fals colstous c nclu seed plot one marker plotmarkerflowsomr cd plotmarkerflowsomr cd colorpalett cgrey red plot marker plotmarkerflowsomr c use specif limit one column use cluster relev marker choic plotmarkerflowsomr fsca lim c exampl addit flowsom plot option plotmarkerflowsomr cd view grid equalnodes true backgroundvalu backgroundcolor cwhite red seealso codelinkplotstar codelinkplotvari gener roxygen edit hand pleas edit document r_deprecatedr nameplotoverviewd aliasplotoverviewd titleplotoverviewd usag plotoverviewdfsom markerlist metaclust color null ff argument itemfsomflowsom object gener codelinkflowsom use flowsom object gener codelinkbuildmst need wrap list listflowsom fsom metaclust metaclust itemmarkerlistlist element pair marker name itemmetaclustersmetaclust interest itemcolorsnam vector color valu metaclust null default colorbrew pair interpol itemffflowfram use refer marker name itemoth paramet pass plotclustersd valu noth return plot drawn everi markerpair everi metaclust individu cell color center flowsom cluster indic blue cross descript plot metaclust scatter plot detail write multipl scatter plot png file cell fsomdata plot black select metaclust plot color exampl deprec use plotdscatt instead read file build selforgan map minim span tree filenam systemfileextdata fc packag flowsom flowsomr flowsomfilenam compens true transform true scale true colstous c nclu seed plot cell markers_of_interest listcfsca ssca ccd cd ctcrb tcryd ccd cd metaclusters_of_interest recommend write png dontrun pngmarkeroverviewpng width lengthmarkers_of_interest height lengthmetaclusters_of_interest plotdscattersflowsomr channelpair markers_of_interest metaclust metaclusters_of_interest devoff seealso codelinkplotclustersd gener roxygen edit hand pleas edit document r_buildsomr namemapdatatocod aliasmapdatatocod titleassign nearest node datapoint usag mapdatatocodescod newdata distf argument itemcodesmatrix node som itemnewdatadatapoint assign itemdistfdist function manhattan euclidean chebyshev cosin valu array nearest node id datapoint descript assign nearest node datapoint gener roxygen edit hand pleas edit document r_plotfunctionsr nameplotdscatt aliasplotdscatt titleplotdscatt usag plotdscatt fsom channelpair cluster null metaclust null maxbgpoint sizebgpoint maxpoint sizepoint xlim null ylim null densiti true center true color null plotfil dscatterplotspng argument itemfsomflowsom object creat codelinkflowsom itemchannelpairslist element pair channel marker name itemclustersvector list combin multipl cluster one plot cluster interest itemmetaclustersvector list combin multipl metaclust one plot metaclust interest itemmaxbgpointsmaximum number background cell plot itemsizebgpointss background cell itemmaxpointsmaximum number metaclust cell plot itemsizepointss metaclust cell itemxlima vector lower upper limit xaxi itemylima vector lower upper limit yaxi itemdensitydefault codetru color metaclust point accord densiti set codefals use plain color itemcentersdefault codetru show cluster center itemcolorcolor cell select node order list codenul default ggplot color index metaclust number use itemplotfileif filepath png given default dscatterplotspng plot plot correspond png file codenul list ggplot object return valu codeplot codetru noth return plot drawn background cell plot grey cell select node color codeplot codefals ggplot object list return descript function draw scatter plot flowsom metaclust detail plot multipl scatter plot png file subset fsomdata plot grey select cluster metaclust plot color exampl identifi file fc flowcorereadfcssystemfileextdata fc packag flowsom build flowsom object flowsomr flowsomfc scale true compens true transform true totransform colstous c nclu seed make scatter plot cluster metaclust interest plotdscattersfsom flowsomr channelpair listcpecya pecya cpetexa reda pacif bluea cluster c metaclust listc densiti fals plotdscattersfsom flowsomr channelpair listcpetexa reda pacif bluea metaclust listc densiti fals color listcr green gener roxygen edit hand pleas edit document r_plotfunctionsr nameaddstarspi aliasaddstarspi titleaddstarspi usag addstarspiesp arc colorpalett showlegend true argument itempggplot object itemarcsdatafram contain data plot pie star itemcolorpalettea vector color color function itemshowlegendboolean whether show legend valu return noth plot star pie descript function plot star pie seealso codelinkplotflowsom codelinkaddlabel codelinkaddnod codelinkaddbackground codelinkaddpi codelinkaddstar codelinkparsearc codelinkplotstar codelinkplotpi