readmemd gener readmermd pleas edit file spectroscopi analysi tool spant img srcmanfigureslogopng alignright width r build statushttpsgithubcommartinspantworkflowsrcmdcheckbadgesvghttpsgithubcommartinspantact doihttpsjosstheojorgpapersjossstatussvghttpsdoiorgjoss httpcranlogsrpkgorgbadgesspanthttpcranrstudiocomwebpackagesspantindexhtml cran_status_badgehttpwwwrpkgorgbadgesversionspanthttpscranrprojectorgpackagesp coverag statushttpscoverallsioreposgithubmartinspantbadgesvgbranchmasterhttpscoverallsiogithubmartinspantbranchmast overview spant provid full suit tool build autom analysi pipelin magnet reson spectroscopi mr data follow featur algorithm includ advanc fullyautom metabolit fit algorithm abfit httpsonlinelibrarywileycomdoimrm robust retrospect frequenc phase correct rat httpsonlinelibrarywileycomdoiabsmrm flexibl data type support singl voxel dynam spectroscop imag data type raw data import individu coil dynam measur eg support import individu fid siemen twix format data public qualiti plot extens set preprocess step phase coilcombin zerofil hsvd filter quantum mechan base simul experiment design basisset gener set metabolit macromolecul lipid paramet typic brain analys voxel registr anatom imag partial volum concentr correct basic instal download instal latest version r httpscloudrprojectorg packag manag use recent linux distribut eg sudo apt instal rbase also strongli recommend instal rstudio desktop httpsrstudiocomproductsrstudiodownload provid modern environ interact data analysi r rstudio instal open rstudio applic type follow consol lower left panel instal latest stabl version spant r installpackagessp depend true develop version github requir devtool packag r installpackagesdevtool devtoolsinstall_githubmartinsp ref devel depend true document quick introduct basic analysi workflow httpsmartingithubiospantarticlesspantintrohtml short tutori httpsmartingithubiospantarticl function refer httpsmartingithubiospantrefer spant librari load librarysp type spant consol instruct access offlin document note offlin help avail function quickli shown rstudio use function_nam eg read_mr ubuntu instal cran packag need compil linux therefor may need ensur addit system librari instal spant may instal clean instal ubuntu follow command past termin ubuntu sudo apt instal rbase libcurlopenssldev libfontconfigdev libharfbuzzdev libfribididev libtiffdev mkdir p rx_pclinuxgnulibrari rscript e installpackagessp depend true ubuntu instal ubuntu sudo apt instal rbase libcurlopenssldev libfontconfigdev libharfbuzzdev libfribididev libtiffdev mkdir p rx_pclinuxgnulibrari rscript e installpackagessp depend true anaconda environ instal firstli instal anaconda standard way platform httpsdocsanacondacomanacondainstallindexhtml creat text file call spant_requirementsyml contain follow conda name spant channel condaforg r depend rbase ressenti rabind rplyr rforeach rpracma rstringr rsignal rmatrixcalc rminpacklm rnnl rrutil rgraphicsqc rexpm rsmoother rreadr rmagrittr rptw rmmand rrnifti rrniftyreg rfield rmass rnumderiv rnloptr rirlba rtibbl rjsonlit rviridislit rshini rminiui rknitr rrmarkdown rtestthat rragg rdoparallel creat activ environ conda conda env creat f spant_requirementsyml conda activ spant start r instal spant usual way r installpackagessp depend true big thank jo√£o mc teixeirahttpsgithubcomjoaomcteixeira figur method instal spant new function ad recon_twix_d reconstruct basic phase encod twix mrsi data file name argument read_mr permit glob eg read_mrsdcm improv plot metabolit map contain infinit valu improv ge pfile reader bug fix twix mrsi voxel dimens get_mrsid_seg return partial volum map well data frame improv error handl spec_op function apodise_xi appli multicoil dynam dataset spant packag publish journal open sourc softwar spant r packag magnet reson spectroscopi analysi joss basi result hsvd function mrs_data object complet model signal output hsvd function imag function xaxi updat consist plot method minor refactor simul code depend swap complexplu exmp packag spant ad unit test read write lcm basi format file ad fwhm estim tcr tcho abfit ad water suppress effici water fwhm measur diagnost output svs_h_brain_analysi ad get_head_dyn get_tail_dyn return first last dynam scan within dataset fix ci error improv instal instruct remov comb_csv_result function reduc number requir packag spant ad glycerol simul paramet eg get_mol_parasglyc bug fix read_ima_ function improv baselin stackplot set bl_lti paramet remov norm_mr function replac scale_spec simpl data scale task eg scale base integr spectral region ad spec_op function perform simpl summari oper spectral segment chang name scale_mr function scale_mrs_amp ad mean_mrs_list function improv lcm raw basi reader contribut alex craven spant abfit frequenc shift limit specifi ppm rather hz improv consist field strength naa linewidth estim output abfit naag absent use braino phantom scan warn given spectra mathemat combin timefrequ domain sum_mr function ad simplifi combin spectra within pipe scale_mr function ad simplifi scale spectrum within pipe add_nois function ad simplifi gener simul data pipe hsvd_filt function accept frequenc rang ppm unit give option return model rather filter data bug fix hsvd_filt function max_damp argument ignor sv refer scan found twix file remov default bug fix read listdata one coil element use spant ad hg citrat simul paramet eg get_mol_parashg better print output molecular definit ad metabolit basi simul vignett bug fix set ppm refer read lcmodel raw file bug fix abfit crlb calcul combin signal eg tnaa tcr spant option ad allow extra inform attach mrs_data fit_result object data frame new function combine_fit_xxx work multipl fit result contain within list structur basi set nois region check valid abfit ad spant_abfit_benchmark function tent function perform standard h brain analys svs_h_brain_analysi svs_h_brain_batch_analysi improv support lcmodel analys spant fix nifti mr readerwrit ortho show correct label orient ra ortho_int function renam ortho_int argument order chang plot_voi_overlay plot_voi_overlay_seg consist ortho regress fix partial volum segment plot echo time paramet store meta structur abfit perform phase paramet search prefit stage improv reliabl may disabl prefit_phase_search fit option spant nifti mr reader writer use header extens metadata thank jon clayden ad extens readwrit support rnifti packag default plot gridlin ydirect plot line thicker colour blue opac option ad plot function alpha bug fix comb_coil sv data bug fix siemen geometri inform chang order argument write_mr write_mrs_nifti improv consist function intern function ortho use plot voxel locat mri intern dicom reader function ad tent support siemen philip dicom mr format ad intern chang way orient inform handl spant ad gridplot function new function ad sampl ad signal space project method mrsi geometri inform read siemen twix file github action use continu integr instead travi appveyor ad precomp function avoid repeat comput mrs_datamat function collaps dimens dynam default mrs_data object store nucleu ad reader old varian format fidprocpar data spant ad write_mr function guess output format file extens specifi argument write_mrs_xxx function depreci read_mr function tri guess format file extens ad json sidecar nifti mr export function ad option read mr data nifti file json sidecar use read_mr function chang default crop_spec region ppm spant bug fix ge p file reader ad downsample_mr function tent function write_mrs_nifti write mr data nifti format file evalu purpos spant ad option abfit allow metabolit amplitud neg ahat_calc_method remov lsei packag depend spant ad option plot baselin trace stackplotmrs_data ad conveni function read write mrs_data rd format spant ad get_fit_t function combin fit tabl fit_result object singl datafram ppm function appli fit result object bug fix plot_slice_fit_int ad option specifi denomin ad option specifi denomin plot_slice_fit spant ad option display progress bar fit_mr function better conform write r extens noninteract use chang test toler accommod differ osx spant perform improv hsvd water filter abfit unit test run simul data improv consist differ platform improv fit amplitud scale code improv check mrs_data process function ad preprocess step vignett spant improv ppm label abfit plot result bug fix plot_slice_fit use fit mask data updat unit test ad vignett manual adjust abfit baselin smooth updat introduct vignett bug fix imag stackplot function mask mr data bug fix use rat mask mr data chang prepar r spant abfit analysi method ad default mrs_fit function ad reader lcmodel raw format data ad read_mri_dyn_dir function read dynam mr export siemen scanner bug fix mrsi voxel segment calcul bug fix siemen ima format reader sv data option colourbar ad ortho function spant ad asc bhb cho peth ser simul paramet ad ker option get_mrsi_voi function ad append_basi function combin two basi set object align function accept one refer frequenc spant ad function grid shift mrsi data xy direct better plottingfit support mask data set data point na bug fix interact voxel select posit indic ad mask_xi mask voxel centr rectangular region minor chang improv parallel process support spant snr defin max data point divid standard deviat nois nb factor two remov inlin upcom terminolog paper default rat method improv work multidimension dataset ad norm_mr function normalis intens spectral data ad bc_constant function correct spectral baselin constant offset ad re_weight function appli resolut enhanc weight fid perform improv apodise_xi function sd function work mrs_data ad mrsi support siemen ima format spant bug fix use auto_phas function singl spectrum bug fix comb_coil return unaverag data request ad option combin metabolit signal stackplot fit object adjust plot margin ad comb_fit function ad collapse_to_dyn function mrs_fit object rda reader extract geometri inform spant ad option omit basi signal chang label name combin lipid mm signal stackplot fit object ad auto_phas function zeroth order phasecorrect simpl spectra ad get_subset function aid mrsi slice ad decimate_mr function ad fit_amp function quickli extract amplitud estim fit object bug fix int_spec function sim_basi function argument updat accept acq_par object spant variou bug fix siemen twix reader rat tdsr function use mean spectrum default refer ad option remov x axi mrs_data plot ad ylim y_scale option fit plot ad oper magrittr packag ad interpol option calc_spec_snr ad hline vline option imagemrs_data spant fit result stackplot option display label ad option revers eddi current correct improv ge pfile reader diff function appli mrs_data object complex function im mod arg conj appli mrs_data object default simul glc naag improv spant ad mar argument plot command tdfd fdtd give warn use data alreadi target domain improv document format consist fix spell error ad rat method spant name inbuilt puls sequenc function start seq_ make easier find ad new function simul follow mr sequenc cpmg megapress steam slaser slaser sequenc kindli contribut pierregil henri bug fix get_mol_nam function stackplot function accept label argument timedomain plot def_acq_para function accept argument overrid default ad sourc field molpara object cite origin valu option restor plot par default magrittr pipe oper export spant updat plot mode one im mod arg updat int_spec function use im mod ad function replic data across particular dimens ad conveni function simul normal look h brain mr data phase shift function accept vector input spant ad new function frequenc drift correct ad support siemen ima twix sv data ad support ge pfile sv data ad apply_ax fn support read spm style segment result spm_pvecategor spant interact plot function ad fit result plot_fit_slice_int bug fix append dynam result bug fix read list data file without refer data bug fix append_dyn function basismrs_data function extend allow summat basi element set individu amplitud ad shift function manual frequenc shift adjust ad initi unit test autom coveral check spant default brain press basi simul fit_mr function basi argument isnt specifi ad calc_peak_info function simpl singlet analys crop_spec function maintain origin frequenc scale basi set use analys ad fit result object bug fix simul basi set one element lb function use basisset object bug fix spar_sdat reader nonlocalis mr appveyor use test window compat john muschelli spant bug fix sparsdat sv voxel dimens mrsi support ad philip sparsdat data fit plot default full spectral rang unless xlim specifi fit plot allow x z coil dynam indic specifi ad option subtract baselin fit plot spant ad stackplot method fit object ad function regist visualis sv volum imag perform partial volum correct philip list data also read nois scan calc_coil_noise_cor calc_coil_noise_sd function ad aid coil combin document updat plot method ad simul method userland spant ad siemen rda format reader ad philip list data format reader ad bruker paravis format reader ad propack option hsvd base filter ad coil combin function bug fix incorrect ppm scale fit plot fs hz bug fix varpro analyt jacobian calcul spant first public releas contribut spant develop contribut spant welcom gener take form bug reportsfeatur request document suggest code chang via pull request bug reportsfeatur request pleas report bug make featur request via httpsgithubcommartinspantissu file issu import thing includ minim reproduc exampl quickli verifi problem figur fix document would like help new user particular apect mr data process analysi pleas consid contribut short document r markdown format ad packag exampl pleas see doc folder main github repositori function refer document deriv roxygen code comment best contribut via pull request describ pull request contribut chang spant follow step creat branch git make chang push branch github issu pull request pr discuss pull request iter either accept pr decid good fit spant your familiar git github pleas start read httprpkgshadconzgithtml pleas use follow style httpadvrhadconzstylehtml pleas ensur check pass devtoolscheckarg cascran consid ad one unit test repositori test directori confirm expect behavior devtoolstest ci check set run follow push master branch use github action see httpsorchidgithubioactions_sandbox detail test environ window r linux ubuntu r r cmd check result error warn note note import includ nondefault packag downstream depend current downstream depend packag titl spant r packag magnet reson spectroscopi analysi tag r spectroscopi mr nmr medic imag neuroimag author name martin wilson orcid affili affili name centr human brain health school psycholog univers birmingham birmingham uk index date august bibliographi paperbib summari magnet reson spectroscopi mr allow measur small molecul metabolit bodi without use harm radiat base basic principl technolog behind magnet reson imag mri modern mri scanner also capabl acquir mr make techniqu highli suit number clinic applic oz despit success mr research environ clinic translat proven slow due number technic practic reason challeng associ reliabl data process analysi particular import wilsona spant spectroscopi analysi tool packag develop provid opensourc implement tradit modern mr process analysi techniqu routin analysi near aid develop valid comparison new algorithm analysi pipelin statement need tradit mr analysi domin use proprietari softwar either suppli scanner manufactur offlin tool lcmodel provench jmrui naressi recent year steadili increas trend toward use opensourc method earli exampl includ tarquin reynold wilson aqs poullet trend set continu recent transit lcmodel opensourc licens acceler develop new opensourc method packag vespa soher gannet edden fida simpson osprey oeltzschner suspect rowland fslmr clarkea avail mrshub httpsmrshuborg new commun orient softwar share support platform recent develop nifti mr file format clarkeb aid data share interoper set enhanc ecosystem opensourc mr analysi tool vast major recent develop opensourc mr analysi tool written either matlab python whilst languag strength weak r particularli suit interact explor batch process larg complex dataset typic mr neuroimag studi exampl acquisit storag high dimension dataset includ three spatial axe chemic shift coil axe becom common mr typic studi scan may acquir multipl timepoint multipl particip split across one group eg control treatment requir singl subject group level analys spant packag develop combin tradit modern mr data process techniqu strength r includ plottingvisu statist machin learn data wrangl furthermor spant may use conveni combin mr result imag modal due avail wide rang r packag focus imag process muschelli support nifti data format whitcher clayden spant also support major common mr vendor data format allow complet pipelin develop raw timedomain sampl metabolit quantiti deriv spectral fit spant part mrshub demonstr accept interest mr commun time write spant use develop valid two new mr spectroscopi analysi algorithm rat wilsonb abfit wilson also use studi cancer franco alzheim diseas montal psychosi fisher confirm suitabl mr method research clinic studi acknowledg particular thank go dr jonathan clayden dr robert w cox work rnifti packag clayden nifti standard httpsniftinimhnihgov substanti expand capabl spant refer output github_docu readmemd gener readmermd pleas edit file r setup echo fals knitropts_chunkset collaps true comment figpath readm figwidth figheight dev ragg_png spectroscopi analysi tool spant img srcmanfigureslogopng alignright width r build statushttpsgithubcommartinspantworkflowsrcmdcheckbadgesvghttpsgithubcommartinspantact doihttpsjosstheojorgpapersjossstatussvghttpsdoiorgjoss httpcranlogsrpkgorgbadgesspanthttpcranrstudiocomwebpackagesspantindexhtml cran_status_badgehttpwwwrpkgorgbadgesversionspanthttpscranrprojectorgpackagesp coverag statushttpscoverallsioreposgithubmartinspantbadgesvgbranchmasterhttpscoverallsiogithubmartinspantbranchmast overview spant provid full suit tool build autom analysi pipelin magnet reson spectroscopi mr data follow featur algorithm includ advanc fullyautom metabolit fit algorithm abfit httpsonlinelibrarywileycomdoimrm robust retrospect frequenc phase correct rat httpsonlinelibrarywileycomdoiabsmrm flexibl data type support singl voxel dynam spectroscop imag data type raw data import individu coil dynam measur eg support import individu fid siemen twix format data public qualiti plot extens set preprocess step phase coilcombin zerofil hsvd filter quantum mechan base simul experiment design basisset gener set metabolit macromolecul lipid paramet typic brain analys voxel registr anatom imag partial volum concentr correct basic instal download instal latest version r httpscloudrprojectorg packag manag use recent linux distribut eg sudo apt instal rbase also strongli recommend instal rstudio desktop httpsrstudiocomproductsrstudiodownload provid modern environ interact data analysi r rstudio instal open rstudio applic type follow consol lower left panel instal latest stabl version spant r cran eval fals installpackagessp depend true develop version github requir devtool packag r github eval fals installpackagesdevtool devtoolsinstall_githubmartinsp ref devel depend true document quick introduct basic analysi workflow httpsmartingithubiospantarticlesspantintrohtml short tutori httpsmartingithubiospantarticl function refer httpsmartingithubiospantrefer spant librari load librarysp type spant consol instruct access offlin document note offlin help avail function quickli shown rstudio use function_nam eg read_mr ubuntu instal cran packag need compil linux therefor may need ensur addit system librari instal spant may instal clean instal ubuntu follow command past termin ubuntu instal eval fals sudo apt instal rbase libcurlopenssldev libfontconfigdev libharfbuzzdev libfribididev libtiffdev mkdir p rx_pclinuxgnulibrari rscript e installpackagessp depend true ubuntu instal ubuntu instal eval fals sudo apt instal rbase libcurlopenssldev libfontconfigdev libharfbuzzdev libfribididev libtiffdev mkdir p rx_pclinuxgnulibrari rscript e installpackagessp depend true anaconda environ instal firstli instal anaconda standard way platform httpsdocsanacondacomanacondainstallindexhtml creat text file call spant_requirementsyml contain follow conda yml eval fals name spant channel condaforg r depend rbase ressenti rabind rplyr rforeach rpracma rstringr rsignal rmatrixcalc rminpacklm rnnl rrutil rgraphicsqc rexpm rsmoother rreadr rmagrittr rptw rmmand rrnifti rrniftyreg rfield rmass rnumderiv rnloptr rirlba rtibbl rjsonlit rviridislit rshini rminiui rknitr rrmarkdown rtestthat rragg rdoparallel creat activ environ conda eval fals conda env creat f spant_requirementsyml conda activ spant start r instal spant usual way r conda eval fals installpackagessp depend true big thank jo√£o mc teixeirahttpsgithubcomjoaomcteixeira figur method instal output github_docu indexmd gener indexrmd pleas edit file r setup echo fals knitropts_chunkset collaps true comment figpath readm figwidth figheight spectroscopi analysi tool spant travi build statushttpstravisciorgmartinspantsvgbranchmasterhttpstravisciorgmartinsp appveyor build statushttpsciappveyorcomapiprojectsstatusgithubmartinspantbranchmastersvgtruehttpsciappveyorcomprojectmartinsp httpcranlogsrpkgorgbadgesspanthttpcranrstudiocomwebpackagesspantindexhtml cran_status_badgehttpwwwrpkgorgbadgesversionspanthttpscranrprojectorgpackagesp overview spant provid full suit tool build autom analysi pipelin magnet reson spectroscopi mr data follow featur includ raw data importexport flexibl data type support singl voxel dynam spectroscop imag data type public qualiti plot extens set preprocess step phase coilcombin zerofil hsvd filter quantum mechan base simul experiment design basisset gener set metabolit macromolecul lipid paramet typic brain analys varpro base fit interfac tarquin lcmodel metabolit quantit voxel registr anatom imag partial volum concentr correct instal instal stabl version spant cran r cran eval fals installpackagessp depend true develop version github requir devtool packag r github eval fals installpackagesdevtool devtoolsinstall_githubmartinsp titl spant megapress gaba analysi report output html_document r setup includ fals knitropts_chunksetecho true librarysp edit spectrum r ed_spec echo fals plotzfanal_resultsed_gaba xlim c frequenc drift r freq_drift echo fals plotresshift xlab dynam ylab frequenc shift hz editoff spectrum r ed_off_spec echo fals plotzfanal_resultsed_off xlim c editon spectrum r ed_on_spec echo fals plotzfanal_resultsed_on xlim c editoff fit r ed_off_fit echo fals plotanal_resultsed_off_fit xlim c style typetextcss tabl width style r tabl echo fals knitrkablecolnamescamplitudetanal_resultsed_off_fitresultsformatmarkdown titl common preprocess step output rmarkdownhtml_vignett vignett vignetteindexentrycommon preprocess step vignetteengineknitrrmarkdown vignetteencodingutf r includ fals libraryragg knitropts_chunkset collaps true comment figwidth figheight dev ragg_png read raw data plot load spant packag r messag fals librarysp load exampl data preprocess r fname systemfileextdata philips_spar_sdat_wssdat packag spant mrs_data read_mrsfnam format spar_sdat plot spectral region ppm r plotmrs_data xlim c appli degre phase adjust plot r mrs_data_p phasemrs_data plotmrs_data_p xlim c appli hz guassian line broaden r mrs_data_lb lbmrs_data plotmrs_data_lb xlim c zero fill data twice origin length plot r mrs_data_zf zfmrs_data plotmrs_data_zf xlim c appli hsvd filter residu water region plot togeth origin data r mrs_data_filt hsvd_filtmrs_data stackplotlistmrs_data mrs_data_filt xlim c y_offset col cblack red label corigin filter appli ppm frequenc shift plot togeth origin data r mrs_data_shift shiftmrs_data ppm stackplotlistmrs_data mrs_data_shift xlim c y_offset col cblack red label corigin shift multipl process command may conveni combin pipe oper r mrs_data_proc mrs_data hsvd_filt lb zf plotmrs_data_proc xlim c titl basi simul output rmarkdownhtml_vignett vignett vignetteindexentrybasi simul vignetteengineknitrrmarkdown vignetteencodingutf r includ fals libraryragg knitropts_chunkset collaps true comment figwidth figheight dev ragg_png basi simul basi simul necessari step modern mr analysi vignett explain achiev spant advis follow exampl given metabolit simul vignettespantmetabolitesimulationhtml follow guid load spant packag r messag fals librarysp basi set collect signal fit mr data spant start list molecular definit contain relev inform signal chemic shift jcoupl valu r mol_list listget_mol_paraslac get_mol_parasnaa get_mol_parascr get_mol_parasgpc next step convert chemic properti collect signal spant basis_set object sim_basi function fit signal paramet eg sampl frequenc puls sequenc eg echotim must match mr data acquisit protocol r basi sim_basismol_list pul_seq seq_slaser_id acq_para def_acq_parasn fs ft e te te te stackplotbasi xlim c y_offset label basisnam h mr broad reson lipid macromolecul often includ addit metabolit r mol_list_mm appendmol_list listget_mol_parasmm ft e basis_mm sim_basismol_list_mm pul_seq seq_slaser_id acq_para def_acq_parasn fs ft e te te te stackplotbasis_mm xlim c y_offset label basis_mmnam note field strength often requir simul broad reson linewidth usual specifi ppm spant also includ function sim_basis_h_brain sim_basis_h_brain_press produc commonli use set basi signal r sim_basis_h_brain stackplotxlim c y_offset label name basi set export use lcmodel write_basi function sim_basis_h_brain option lcm_compat remov signal usual gener within lcmodel packag r sim_basis_h_brainlcm_compat true stackplotxlim c y_offset label name titl abfit baselin option output rmarkdownhtml_vignett vignett vignetteindexentryabfit baselin option vignetteengineknitrrmarkdown vignetteencodingutf r includ fals libraryragg knitropts_chunkset collaps true comment figwidth figheight dev ragg_png introduct good baselin estim prerequisit accur metabolit quantit default mr analysi algorithm spant abfit design find accur baselin estim automat adapt level baselin flexibl match data complex process inevit balanc act baselin smooth result greater bia flexibl result greater varianc therefor abfit number fit option adjust baselin accord user prefer vignett common adjust demonstr default analysi load spant analysi packag r setup messag fals librarysp read exampl dataset file simul match basi set r read_data fname systemfileextdata philips_spar_sdat_wssdat packag spant mrs_data read_mrsfnam format spar_sdat basi sim_basis_h_brain_pressmrs_data run default abfit analysi plot result r abfit_default result hide fit_r fit_mrsmrs_data basi plotfit_r fit look good smooth baselin signific signal residu top trace nois level find automat determin level baselin smooth inspect result tabl fit_r object r abfit_bl_valu fit_resres_tabbl_ed_pppm baselin flexibl found r roundfit_resres_tabbl_ed_pppm ed per ppm ed effect dimens analog number spline function requir per ppm whilst autom fit look reason first glanc let tri convinc cant better manual adjust algorithm custom analys chang default behaviour abfit achiev suppli option structur fit_mr function abfit_opt function gener default fit option may modifi suppli argument manual specifi baselin flexibl set auto_bl_flex option fals set bl_ed_pppm option desir level greater valu result baselin flexibl let tri valu ed ppm r abfit_flex result hide opt abfit_optsauto_bl_flex fals bl_ed_pppm fit_r fit_mrsmrs_data basi opt opt plotfit_r baselin clearli flexibl result slightli improv residu howev baselin featur like due instabl nois rather true spectral featur next analysi let investig ed pppm r abfit_stiff result hide opt abfit_optsauto_bl_flex fals bl_ed_pppm fit_r fit_mrsmrs_data basi opt opt plotfit_r much smoother almost linear baselin come cost broad unmodel signal residu ultim result bias metabolit level altern manual specifi fix level baselin flexibl adjust criterion use autom estim aic_smoothing_factor set smaller valu default encourag flexibl baselin whilst still adapt broad spectral featur r abfit_a result hide opt abfit_optsaic_smoothing_factor fit_r fit_mrsmrs_data basi opt opt plotfit_r inform visualis individu spline compon use baselin model save result object r abfit_bsplin result hide opt abfit_optsexport_sp_fit true fit_r fit_mrsmrs_data basi opt opt stackplotfit_r omit_sign basisnam default number spline function abfit per ppm may verifi plot let tri increas r abfit_bspline_mor result hide opt abfit_optsexport_sp_fit true bl_comps_pppm fit_r fit_mrsmrs_data basi opt opt stackplotfit_r omit_sign basisnam clearli densiti spline function increas howev baselin smooth remain close default gener principl abfit deriv pspline specifi number baselin model spline function reli penalti factor encourag smooth r abfit_bl_value_more_splin fit_resres_tabbl_ed_pppm inspect automat determin level baselin flexibl show ed per ppm valu remain close default analysi despit chang spline function densiti precis desir behaviour titl metabolit simul output rmarkdownhtml_vignett vignett vignetteindexentrymetabolit simul vignetteengineknitrrmarkdown vignetteencodingutf r includ fals libraryragg knitropts_chunkset collaps true comment figwidth figheight dev ragg_png simpl simul load spant packag r messag fals librarysp output list predefin molecul avail simul r messag fals get_mol_nam get print spin system myoinositol r messag fals in get_mol_parasin printin simul plot simul tesla puls acquir sequenc seq_pulse_acquir appli hz linebroaden plot r messag fals sim_molin ft e n lb plotxlim c puls sequenc may simul includ seq_cpmg_id seq_mega_press_id seq_press_id seq_slaser_id seq_spin_echo_id seq_steam_id note sequenc assum chemic shift displac neglig next simul ms spinecho sequenc plot r messag fals ins_sim sim_molin seq_spin_echo_id ft e n te ins_sim lb plotxlim c final simul rang echotim plot result togeth see phase evolut r messag fals figheight sim_fn functiont te_sim sim_molin seq_spin_echo_id ft e n te te lbte_sim te_val seq lapplyte_v sim_fn stackploty_offset xlim c label pastete_v ms see basi simulationspantbasissimulationhtml vignett combin simul basi set mr analysi custom molecul simpl signal requir jcoupl evolut exampl singlet approxim macromolecul lipid reson get_uncoupled_mol function may use exampl simul two broad gaussian reson ppm differ amplitud r messag fals get_uncoupled_mollip c ch h c c c sim_mol plotxlim c molecul arent defin within spant need adjust match particular scan may manual defin construct mol_paramet object follow code defin imaginari molecul base lactat addit second spin group contain singlet ppm whilst molecul could defin singl group comput effici split non jcoupl spin system way note lineshap set lorentzian lorentzgauss factor lg width hz gener good idea simul reson narrow lineshap expect see experiment data far easier make reson broader narrow r messag fals nucleus_a reph chem_shift_a c j_coupling_mat_a matrix j_coupling_mat_a j_coupling_mat_a j_coupling_mat_a spin_group_a listnucleu nucleus_a chem_shift chem_shift_a j_coupling_mat j_coupling_mat_a scale_factor lw lg nucleus_b ch chem_shift_b c j_coupling_mat_b matrix spin_group_b listnucleu nucleus_b chem_shift chem_shift_b j_coupling_mat j_coupling_mat_b scale_factor lw lg sourc text includ refer origin chemic shift jcoupl valu custom_mol listspin_group listspin_group_a spin_group_b name cu sourc sourc full_nam custom molecul classcustom_mol mol_paramet next step output molecul definit format text plot r messag fals printcustom_mol custom_mol sim_mol lb zf plotxlim c happi new molecul correct pleas consid contribut packag think other would benefit titl introduct spant output rmarkdownhtml_vignett vignett vignetteindexentryintroduct spant vignetteengineknitrrmarkdown vignetteencodingutf r includ fals libraryragg knitropts_chunkset collaps true comment figwidth figheight dev ragg_png read raw data plot load spant packag r messag fals librarysp get path data file includ spant r fname systemfileextdata philips_spar_sdat_wssdat packag spant read file save workspac mrs_data r mrs_data read_mrsfnam format spar_sdat output basic inform data r printmrs_data plot spectral region ppm r plotmrs_data xlim c basic preprocess appli hsvd filter residu water region align spectrum tnaa reson ppm r mrs_proc hsvd_filtmrs_data mrs_proc alignmrs_proc plotmrs_proc xlim c basi simul simul typic basi set short te brain analysi print basic inform plot r figheight basi sim_basis_h_brain_pressmrs_proc printbasi stackplotbasi xlim c label basisnam y_offset perform abfit analysi process data mrs_proc r result hide fit_r fit_mrsmrs_proc basi plot fit result r plotfit_r extract estim amplitud fit_r print ratio totalcreatin column format r amp fit_ampsfit_r printtamp ampstcr unscal amplitud crlb error estim fit diagnost snr given result tabl r fit_resres_tab spectral snr r fit_resres_tabsnr linewidth tnaa reson ppm r fit_resres_tabtnaa_lw gener roxygen edit hand pleas edit document rfit_displayr namestackplotfit_result aliasstackplotfit_result titleplot fit result object class codefit_result individu basi set compon shown usag methodstackplotfit_result x xlim null y_offset dyn x_po y_po z_po coil n null sub_bl fals label fals label_nam null sig_col black restore_def_par true omit_sign null combine_lipmm fals combine_metab fals mar null show_grid true grid_nx null grid_ni na argument itemxfit_result object itemxlimth rang valu display xaxi eg xlim c itemy_offsetsepar basi signal yaxi direct valu itemdynth dynam index plot itemx_posth x index plot itemy_posth index plot itemz_posth z index plot itemcoilth coil element number plot itemnsingl index element plot overrid indic given itemsub_blsubtract baselin data fit logic itemlabelsprint signal label right side plot itemlabel_namesprovid charact vector signal name replac default determin basi set itemsig_colcolour individu signal compon itemrestore_def_parrestor default plot par valu plot made itemomit_signalsa charact vector basi signal name remov plot itemcombine_lipmmcombin basi signal name start lip mm itemcombine_metabcombin basi signal name start lip mm itemmaropt adjust plot margin see par itemshow_gridplot gridlin behind data logic default true itemgrid_nxnumb cell grid x direct null grid align tick mark correspond default axi ie tickmark comput axtick na grid line drawn correspond direct itemgrid_nya itemfurth argument plot method descript plot fit result object class codefit_result individu basi set compon shown gener roxygen edit hand pleas edit document rmrs_data_procr nameget_subset aliasget_subset titleextract subset mr data usag get_subset mrs_data x_set null y_set null z_set null dyn_set null coil_set null fd_set null td_set null argument itemmrs_datamr data object itemx_setx indic includ output default itemy_seti indic includ output default itemz_setz indic includ output default itemdyn_setdynam indic includ output default itemcoil_setcoil indic includ output default itemfd_setfrequ domain data indic includ output default itemtd_settimedomain indic includ output default valu select subset mr data descript extract subset mr data gener roxygen edit hand pleas edit document rbasis_setr nameshift_basi aliasshift_basi titleappli frequenc shift basi set signal usag shift_basisbasi shift argument itembasisth basi appli shift itemshiftsa vector frequenc shift appli ppm unit must length basi element valu modifi basi set object descript appli frequenc shift basi set signal gener roxygen edit hand pleas edit document rmrs_data_procr namef aliasf titlereturn sampl frequenc hz mr dataset usag fsmrs_data argument itemmrs_datamr data valu sampl frequenc hz descript return sampl frequenc hz mr dataset gener roxygen edit hand pleas edit document rqm_simulationr nameacquir aliasacquir titlesimul puls sequenc acquisit usag acquiresi rec_phas tol e detect null argument itemsysspin system object itemrec_phasereceiv phase degre itemtolignor reson amplitud threshold itemdetectdetect nuclei valu list reson amplitud frequenc descript simul puls sequenc acquisit gener roxygen edit hand pleas edit document rqm_simulationr nameget_h_brain_basis_paras_v aliasget_h_brain_basis_paras_v titlereturn list codemol_paramet object suitabl h brain mr analys usag get_h_brain_basis_paras_vft metab_lw null lcm_compat fals argument itemfttransmitt frequenc hz itemmetab_lwlinewidth metabolit signal hz itemlcm_compatwhen true lipid mm crch molecul exclud output valu list codemol_paramet object descript return list codemol_paramet object suitabl h brain mr analys gener roxygen edit hand pleas edit document rspantr namedef_f aliasdef_f titlereturn default sampl frequenc hz usag def_f valu sampl frequenc hz descript return default sampl frequenc hz gener roxygen edit hand pleas edit document rmrs_data_procr namemax_mr aliasmax_mr titleappli max oper mr dataset usag max_mrsmrs_data argument itemmrs_datamr data valu mr data follow max oper descript appli max oper mr dataset gener roxygen edit hand pleas edit document rratsr namerat aliasrat titlerobust align target spectrum rat usag rat mrs_data ref null xlim c max_shift p_deg sp_n sp_deg max_t basis_typ poli rescale_output true phase_corr true argument itemmrs_datamr data correct itemrefopt mr data use refer mean dynam use argument suppli itemxlimopt frequenc rang perform optimis set null use full rang itemmax_shiftmaximum allow frequenc shift hz itemp_degpolynomi degre use baselin model neg valu disabl baselin model itemsp_nnumb spline function note true number sp_n sp_deg itemsp_degdegre spline function itemmax_ttrunc fid longer max_t reduc time taken set null use entir fid itembasis_typemay one poli spline itemrescale_outputrescal bl_matched_spec bl output improv consist dynam scan itemphase_corrappli phase correct addit frequenc true default valu list contain correct data phase shift valu unit degre hz respect descript robust align target spectrum rat gener roxygen edit hand pleas edit document rmrs_data_ior nameread_mr aliasread_mr titleread mr data file usag read_mr fname format null ft null fs null ref null n_ref_scan null full_fid fals omit_svs_ref_scan true verbos fals extra null argument itemfnamefilenam dpt format mr data itemformatstr describ data format must one follow spar_sdat rda dicom twix pfile list_data paravi dpt lcm_raw rd nifti varian specifi format guess filenam extens itemfttransmitt frequenc hz requir list_data format itemfssampl frequenc hz requir list_data format itemrefrefer valu ppm scale requir list_data format itemn_ref_scansoverrid number water refer scan detect file header ge pfile itemfull_fidexport data point includ start fid default fals twix format itemomit_svs_ref_scansremov refer scan sometim save sv twix data default true itemverboseprint data file inform default fals itemextraan option data frame provid addit variabl use subsequ analysi step eg id group variabl valu mr data object descript read mr data file exampl fname systemfileextdata philips_spar_sdat_wssdat packag spant mrs_data read_mrsfnam printmrs_data gener roxygen edit hand pleas edit document rqm_simulationr namesim_mol aliassim_mol titlesimul codemol_paramet object usag sim_mol mol pul_seq seq_pulse_acquir ft def_ft ref def_ref fs def_f n def_n xlim null argument itemmolcodemol_paramet object itempul_seqpuls sequenc function use itemfttransmitt frequenc hz itemrefrefer valu ppm scale itemfssampl frequenc hz itemnnumb data point spectral dimens itemxlimppm rang limit signal simul itemextra paramet pass puls sequenc function valu codemrs_data object descript simul codemol_paramet object gener roxygen edit hand pleas edit document rmrs_data_procr namencoil aliasncoil titlereturn total number coil element mr dataset usag ncoilsmrs_data argument itemmrs_datamr data descript return total number coil element mr dataset gener roxygen edit hand pleas edit document rmol_parametersr nameget_uncoupled_mol aliasget_uncoupled_mol titlegener codemol_paramet object simpl spin system one reson usag get_uncoupled_mol name chem_shift nucleu scale_factor lw lg full_nam null argument itemnameabbrevi name molecul itemchem_shiftchem shift reson ppm itemnucleusnucleu h p itemscale_factormultipl scale factor itemlwlinewidth hz itemlglorentzgauss lineshap paramet itemfull_namelong name molecul option valu mol_paramet object descript gener codemol_paramet object simpl spin system one reson gener roxygen edit hand pleas edit document rabfitr namebbas aliasbbas titlegener spline basi slightli adapt spline knot penalti eiler usag bbasen number deg argument itemnnumb data point itemnumbernumb spline function itemdegsplin degre deg linear deg quadrat deg cubic valu spline basi matrix descript gener spline basi slightli adapt spline knot penalti eiler gener roxygen edit hand pleas edit document rsvs_batch_fitr namesvs_h_brain_batch_analysi aliassvs_h_brain_batch_analysi titlebatch interfac standard sv h brain analysi pipelin usag svs_h_brain_batch_analysi metab_list w_ref_list null mri_seg_list null mri_list null output_dir_list null extra null argument itemmetab_listlist file path mrs_data object contain mr metabolit data itemw_ref_listlist file path mrs_data object contain mr water refer data itemmri_seg_listlist file path nifti object contain segment mri data itemmri_listlist file path nifti object contain anatom mri data itemoutput_dir_listlist directori path output fit result itemextraa data frame number row metab_list contain addit inform attach fit result tabl itemaddit option pass svs_h_brain_analysi function valu list fit_result object descript batch interfac standard sv h brain analysi pipelin gener roxygen edit hand pleas edit document rmrs_data_procr nameest_noise_sd aliasest_noise_sd titleestim standard deviat nois segment mrs_data object usag est_noise_sdmrs_data n offset p_order argument itemmrs_datamr data object itemnnumb data point taken end array use estim itemoffsetnumb final point exclud calcul itemp_orderpolynomi order fit data estim standard deviat valu standard deviat array descript estim standard deviat nois segment mrs_data object gener roxygen edit hand pleas edit document rmrs_data_procr namedownsample_mrs_td aliasdownsample_mrs_td titledownsampl mr signal factor remov everi data point timedomain note signal outsid new sampl frequenc alias usag downsample_mrs_tdmrs_data argument itemmrs_datamr data object valu downsampl data descript downsampl mr signal factor remov everi data point timedomain note signal outsid new sampl frequenc alias gener roxygen edit hand pleas edit document rmrs_data_procr namehsvd_vec aliashsvd_vec titlehsvd complex vector usag hsvd_veci fs comp irlba true max_damp argument itemytim domain signal filter vector itemfssampl frequenc itemcompsnumb lorentzian compon use model itemirlbaopt use irlba svd logic itemmax_dampmaximum allow damp factor default valu ensur result model damp valu basi matrix signal tabl descript hsvd method describ barkhuijsen h de beer r van ormondt improv algorithm nonit timedomain model fit exponenti damp magnet reson signal j magn reson gener roxygen edit hand pleas edit document rprecompr nameset_precomp_verbos aliasset_precomp_verbos titleset verbos precomput function usag set_precomp_verboseverbos na argument itemverbosecan true fals descript set verbos precomput function gener roxygen edit hand pleas edit document rimage_regr namespm_pvecategor aliasspm_pvecategor titleconvert spm style segment file singl categor imag numer valu map csf gm wm usag spm_pvecategoricalfnam argument itemfnameani segment file eg c_my_tnii valu nifti object descript convert spm style segment file singl categor imag numer valu map csf gm wm gener roxygen edit hand pleas edit document ramp_scalingr nameapply_pvc aliasapply_pvc titleconvert default lcmtarquin concentr scale molal unit partial volum correct usag apply_pvcfit_result p_vol te tr argument itemfit_resulta codefit_result object appli partial volum correct itemp_volsa numer vector partial volum itemteth mr te itemtrth mr tr valu codefit_result object rescal result tabl descript convert default lcmtarquin concentr scale molal unit partial volum correct gener roxygen edit hand pleas edit document rmrs_data_procr namepg_extrap_xi aliaspg_extrap_xi titlepapoulisgerchberg pg algorithm method kspace extrapol usag pg_extrap_xi mrs_data img_mask null kspace_mask null intensity_thresh iter argument itemmrs_datamr data object itemimg_maska boolean matrix voxel strong signal extrapol must twice dimens input data itemkspace_maska boolean matrix kspace point sampl typic circl mrsi default full rectangular area kspace cover input data must match xy dimens input data itemintensity_threshus defin img_mask base strength signal voxel default intens greater maximum ignor img_mask specifi argument itemitersnumb iter perform valu extrapol codemrs_data object descript pg method describ haupt ci schuff n weiner mw maudsley aa remov lipid artifact h spectroscop imag data extrapol magn reson med may extrapol perform expand kspace coverag factor aim reduc gibb ring gener roxygen edit hand pleas edit document rmrs_data_procr nameremrs_data aliasremrs_data titleappli oper mr dataset usag methodremrs_dataz argument itemzmr data valu mr data follow oper descript appli oper mr dataset gener roxygen edit hand pleas edit document rmrs_data_procr namesub_mean_dyn aliassub_mean_dyn titlesubtract mean dynam spectrum dynam seri usag sub_mean_dynsmrs_data argument itemmrs_datadynam mr data valu subtract data descript subtract mean dynam spectrum dynam seri gener roxygen edit hand pleas edit document rqm_simulationr namesim_basis_h_brain aliassim_basis_h_brain titlesimul basisset suitabl h brain mr analysi acquir press sequenc note ideal puls assum usag sim_basis_h_brain pul_seq seq_press_id acq_para def_acq_para xlim c lcm_compat fals argument itempul_seqpuls sequenc function use itemacq_paraslist acquisit paramet mrs_data object see codelinkdef_acq_para itemxlimrang frequenc simul ppm itemlcm_compatexclud lipid mm signal use default lcmodel option itemextra paramet pass puls sequenc function valu basi object descript simul basisset suitabl h brain mr analysi acquir press sequenc note ideal puls assum gener roxygen edit hand pleas edit document rutilsr nameift_shift_mat aliasift_shift_mat titleperform ifft ifftshift matrix column replac shift ifft usag ift_shift_matmat_in argument itemmat_inmatrix input valu output matrix descript perform ifft ifftshift matrix column replac shift ifft gener roxygen edit hand pleas edit document rbasis_setr namesort_basi aliassort_basi titlesort basisset element alphabet usag sort_basisbasi argument itembasisinput basi valu sort basi descript sort basisset element alphabet gener roxygen edit hand pleas edit document rmrs_data_ior namewrite_mr aliaswrite_mr titlewrit mr data object file usag write_mrsmrs_data fname format null argument itemmrs_dataobject written file itemfnameth filenam output itemformatstr describ data format must one follow nifti dpt lcm_raw rd specifi format guess filenam extens descript write mr data object file gener roxygen edit hand pleas edit document rspantr namedef_ref aliasdef_ref titlereturn default refer valu ppm scale usag def_ref valu refer valu ppm scale descript return default refer valu ppm scale gener roxygen edit hand pleas edit document rabfitr nameabfit_opt aliasabfit_opt titlereturn list option abfit analysi usag abfit_opt init_damp maxit max_shift max_damp max_phas lambda null ppm_left ppm_right zp true bl_ed_pppm auto_bl_flex true bl_comps_pppm export_sp_fit fals max_asym max_basis_shift max_basis_damp maxiters_pr algo_pr nlopt_ln_neldermead min_bl_ed_pppm null max_bl_ed_pppm auto_bl_flex_n pre_fit_bl_ed_pppm remove_lip_mm_prefit fals pre_align true max_pre_align_shift pre_align_ref_freq c noise_region c optimal_smooth_criterion maic aic_smoothing_factor anal_jac true pre_fit_ppm_left pre_fit_ppm_right phi_optim fals phi_init max_dphi max_basis_shift_broad max_basis_damping_broad ahat_calc_method lh_pnnl prefit_phase_search true freq_reg null output_all_para fals argument iteminit_dampinginiti valu gaussian global damp paramet hz poorli shim high field data may benefit larger valu itemmaxitersth maximum number iter run detail fit itemmax_shiftth maximum allow shift appli optimis phase fit ppm itemmax_dampingmaximum permit valu global damp paramet hz itemmax_phaseth maximum absolut permit valu global zeroord phase term degre note prefit_phase_search option constrain term itemlambdamanu set baselin smooth paramet itemppm_leftdownfield frequenc limit fit rang ppm itemppm_rightupfield frequenc limit fit rang ppm itemzpzero pad data twice origin length fit itembl_ed_pppmmanu set baselin smooth paramet ed per ppm itemauto_bl_flexautomat determin level baselin smooth itembl_comps_pppmsplin basi densiti signal per ppm itemexport_sp_fitadd fit spline function fit result itemmax_asymmaximum allow valu asymmetri paramet itemmax_basis_shiftmaximum allow frequenc shift individu basi signal ppm itemmax_basis_dampingmaximum allow lorentzian damp factor individu basi signal hz itemmaxiters_premaximum iter coars prefit itemalgo_preoptimis method coars prefit itemmin_bl_ed_pppmminimum valu candid baselin flexibl analys ed per ppm itemmax_bl_ed_pppmminimum valu candid baselin flexibl analys ed per ppm itemauto_bl_flex_nnumb candid baselin analys perform itempre_fit_bl_ed_pppmlevel baselin flexibl use coars fit stage algorithm ed per ppm itemremove_lip_mm_prefitremov broad signal coars fit stage algorithm itempre_alignperform prealign step coars fit itemmax_pre_align_shiftmaximum allow shift prealign step ppm itempre_align_ref_freqsa vector promin spectral frequenc use prealign step ppm itemnoise_regionspectr region estim nois level ppm itemoptimal_smooth_criterionmethod determin optim smooth itemaic_smoothing_factormodif factor aic calcul itemanal_jacus analyt approxim jacobian detail fit stage itempre_fit_ppm_leftdownfield frequenc limit fit rang coars fit stage algorithm ppm itempre_fit_ppm_rightupfield frequenc limit fit rang coars fit stage algorithm ppm itemphi_optimappli optimis frequenc depend phase term itemphi_initiniti valu frequenc depend phase term ms itemmax_dphimaximum allow chang initi frequenc depend phase term ms itemmax_basis_shift_broadmaximum allow shift broad signal basi ppm determin base name begin lip mm itemmax_basis_damping_broadmaximum allow lorentzian damp broad signal basi hz determin base name begin lip mm itemahat_calc_methodmethod calcul metabolit amplitud may one lh_pnnl ls itemprefit_phase_searchperform search optim phase prefit stage algorithm itemfreq_regfrequ shift paramet itemoutput_all_parasinclud fit paramet fit tabl eg individu shift damp factor basi set element valu full list option descript return list option abfit analysi exampl opt abfit_optsppm_left noise_region c gener roxygen edit hand pleas edit document rbasis_setr namewrite_basis_tqn aliaswrite_basis_tqn titlegener basi file use tarquin usag write_basis_tqnbasis_fil metab_data opt null argument itembasis_filefilenam basi file gener itemmetab_datamr data object match gener basi paramet itemoptslist option pass tarquin descript gener basi file use tarquin exampl dontrun write_basis_tqntestbasismrs_datacecho gener roxygen edit hand pleas edit document rspantr nameset_lcm_cmd aliasset_lcm_cmd titleset command run lcmodel commandlin program usag set_lcm_cmdcmd argument itemcmdpath binari descript set command run lcmodel commandlin program gener roxygen edit hand pleas edit document rinteractive_plottingr nameortho_int aliasortho_int titledisplay interact orthograph project plot nifti object usag ortho_int underlay overlay null xyz null zlim null zlim_ol null alpha argument itemunderlayunderlay imag shown grayscal itemoverlayopt overlay imag itemxyzx z slice coordin display itemzlimunderlay intens limit itemzlim_oloverlay intens limit itemalphatranspar overlay itemoth option pass ortho function descript display interact orthograph project plot nifti object gener roxygen edit hand pleas edit document rmrs_data_procr namefdtd aliasfdtd titletransform frequencydomain data timedomain usag fdtdmrs_data argument itemmrs_datamr data frequencydomain represent valu mr data timedomain represent descript transform frequencydomain data timedomain gener roxygen edit hand pleas edit document rmrs_data_procr nameappend_coil aliasappend_coil titleappend mr data across coil dimens assum match across dimens usag append_coil argument itemmr data object argument list mr data object valu singl mr data object input object concaten togeth descript append mr data across coil dimens assum match across dimens gener roxygen edit hand pleas edit document rmrs_data_procr namendyn aliasndyn titlereturn total number dynam scan mr dataset usag ndynsmrs_data argument itemmrs_datamr data descript return total number dynam scan mr dataset gener roxygen edit hand pleas edit document rutilsr nameapply_ax aliasapply_ax titleappli function specifi array axe usag apply_axesx axe fun argument itemxan array itemaxesa vector axe appli fun itemfunfunct appli itemopt argument fun valu array descript appli function specifi array axe exampl z array dim c apply_axesz fft fftz apply_axesz sum sumz gener roxygen edit hand pleas edit document rfittingr nameread_tqn_result aliasread_tqn_result titleread csv result gener tarquin usag read_tqn_resultresult_f remove_rc true argument itemresult_ftarquin result file itemremove_rcsomit row column slice id output valu list amplitud crlb diagnost descript reader csv result gener tarquin exampl dontrun result read_tqn_resultsystemfileextdataresultcsvpackagesp gener roxygen edit hand pleas edit document rmrs_data_procr namesecond aliassecond titlereturn time scale vector match fid mr data object usag secondsmrs_data argument itemmrs_datamr data valu time scale vector unit second descript return time scale vector match fid mr data object gener roxygen edit hand pleas edit document rmrs_data_procr nameget_fp aliasget_fp titlereturn first timedomain data point usag get_fpmrs_data argument itemmrs_datamr data valu first timedomain data point descript return first timedomain data point gener roxygen edit hand pleas edit document rfit_displayr nameget_fit_map aliasget_fit_map titleget data array fit result usag get_fit_mapfit_r name argument itemfit_rescodefit_result object itemnamenam quantiti plot eg tnaa descript get data array fit result gener roxygen edit hand pleas edit document rmrs_data_procr namenx aliasnx titlereturn total number x locat mr dataset usag nxmrs_data argument itemmrs_datamr data descript return total number x locat mr dataset gener roxygen edit hand pleas edit document rmrs_write_niftir namewrite_mrs_nifti aliaswrite_mrs_nifti titlewrit mr data object file nifti format usag write_mrs_niftimrs_data fname argument itemmrs_dataobject written file itemfnameth filenam output nifti mr data descript write mr data object file nifti format gener roxygen edit hand pleas edit document rspantr nameset_def_acq_para aliasset_def_acq_para titleset default acquisit paramet usag set_def_acq_para ft getoptionspantdef_ft fs getoptionspantdef_f n getoptionspantdef_n ref getoptionspantdef_ref nuc getoptionspantnuc argument itemfttransmitt frequenc hz itemfssampl frequenc hz itemnnumb data point spectral dimens itemrefrefer valu ppm scale itemnucreson nucleu descript set default acquisit paramet gener roxygen edit hand pleas edit document rmrs_data_procr nameint_spec aliasint_spec titleintegr spectral region usag int_specmrs_data xlim null freq_scal ppm mode argument itemmrs_datamr data itemxlimspectr rang integr default full rang itemfreq_scaleunit xlim ppm hz point itemmodespectr mode im mod cplx valu array integr valu descript see spec_op function complet set spectral oper gener roxygen edit hand pleas edit document rpulse_sequencesr nameseq_pulse_acquir aliasseq_pulse_acquir titlesimpl puls acquir sequenc ideal puls usag seq_pulse_acquirespin_param ft ref argument itemspin_paramsspin system definit itemfttransmitt frequenc hz itemrefrefer valu ppm scale valu list reson amplitud frequenc descript simpl puls acquir sequenc ideal puls gener roxygen edit hand pleas edit document rmrs_data_procr namerm_dyn aliasrm_dyn titleremov subset dynam scan usag rm_dynsmrs_data subset argument itemmrs_datadynam mr data itemsubsetvector contain indic dynam scan remov valu mr data without specifi dynam scan descript remov subset dynam scan gener roxygen edit hand pleas edit document rmrs_data_procr nametdfd aliastdfd titletransform timedomain data frequencydomain usag tdfdmrs_data argument itemmrs_datamr data timedomain represent valu mr data frequencydomain represent descript transform timedomain data frequencydomain gener roxygen edit hand pleas edit document rutilsr namesim_brain_h aliassim_brain_h titlesimul mr data similar appear normal brain default usag sim_brain_h acq_para def_acq_para type normal_v pul_seq seq_press_id xlim c full_output fals amp null argument itemacq_paraslist acquisit paramet mrs_data object see codelinkdef_acq_para itemtypetyp spectrum normal implement current itempul_seqpuls sequenc function use itemxlimrang frequenc simul ppm itemfull_outputwhen fals default output simul mr data true output list contain mr data basi set object correspond amplitud itemampsa vector basi amplitud may specifi modifi output spectrum itemextra paramet pass puls sequenc function valu see full_output option descript simul mr data similar appear normal brain default gener roxygen edit hand pleas edit document rqm_simulationr namegen_f_xi aliasgen_f_xi titlegener fxi product oper specifi phase usag gen_f_xysi phase detect null argument itemsysspin system object itemphasephas angl degre itemdetectdetect nuclei valu product oper matrix descript gener fxi product oper specifi phase gener roxygen edit hand pleas edit document rmrs_data_procr namelb aliaslb aliaslbmrs_data aliaslbbasis_set titleappli linebroaden apodis mr data basi object usag lbx lb lg methodlbmrs_datax lb lg methodlbbasis_setx lb lg argument itemxinput mrs_data basis_set object itemlbamount linebroaden hz itemlglorentzgauss lineshap paramet valu linebroaden data descript appli linebroaden apodis mr data basi object gener roxygen edit hand pleas edit document rmrs_data_procr namekspaceimg_xi aliaskspaceimg_xi titletransform mrsi data kspace imag space xy direct usag kspaceimg_xymrs_data argument itemmrs_datad mrsi data valu mrsi data imag space descript transform mrsi data kspace imag space xy direct gener roxygen edit hand pleas edit document rabfitr namecalc_ed_from_lambda aliascalc_ed_from_lambda titlecalcul effect dimens spline smoother lambda usag calc_ed_from_lambdaspline_basi deriv_mat lambda argument itemspline_basissplin basi itemderiv_matderiv matrix itemlambdasmooth paramet valu effect dimens valu descript calcul effect dimens spline smoother lambda gener roxygen edit hand pleas edit document rmrs_data_procr namecalc_spec_snr aliascalc_spec_snr titlecalcul spectral snr usag calc_spec_snr mrs_data sig_region c noise_region c p_order interp_f full_output fals argument itemmrs_dataan object class codemrs_data itemsig_regiona ppm region defin maximum signal valu estim itemnoise_regiona ppm region defin nois level estim itemp_orderpolynomi order fit nois region estim standard deviat iteminterp_finterpol factor improv detect highest signal valu itemfull_outputoutput signal nois snr valu separ valu array snr valu descript snr defin maximum signal valu divid standard deviat nois detail mean nois valu subtract maximum signal valu reduc dc offset bia polynomi detrend fit second order default appli nois region nois standard deviat estim gener roxygen edit hand pleas edit document rmrs_data_procr nameppm aliasppm aliasppmmrs_data aliasppmfit_result titlereturn ppm scale mr dataset fit result usag ppmx ft null ref null fs null n null methodppmmrs_datax ft null ref null fs null n null methodppmfit_resultx ft null ref null fs null n null argument itemxmr dataset fit result itemfttransmitt frequenc hz appli object fit result itemrefrefer valu ppm scale appli object fit result itemfssampl frequenc hz appli object fit result itemnnumb data point spectral dimens appli object fit result valu ppm scale descript return ppm scale mr dataset fit result gener roxygen edit hand pleas edit document rmrs_data_procr namerep_dyn aliasrep_dyn titlerepl scan dynam dimens usag rep_dynmrs_data time argument itemmrs_datamr data replic itemtimesnumb time replic valu replic data object descript replic scan dynam dimens gener roxygen edit hand pleas edit document rmrs_data_procr nameinv_even_dyn aliasinv_even_dyn titleinvert even number dynam scan start usag inv_even_dynsmrs_data argument itemmrs_datadynam mr data valu dynam mr data invert even number scan descript invert even number dynam scan start gener roxygen edit hand pleas edit document rmrs_data_procr namemean_dyn aliasmean_dyn titlecalcul mean dynam data usag mean_dynsmrs_data argument itemmrs_datadynam mr data valu mean dynam data descript calcul mean dynam data gener roxygen edit hand pleas edit document rfittingr namefit_mr aliasfit_mr titleperform fit base analysi mr data usag fit_mr metab basi null method abfit w_ref null opt null parallel fals time true progress text extra metabextra argument itemmetabmetabolit data itembasisbasi class object charact vector basi file lcmodel basi format itemmethodabfit default varpro varpro_p tarquin lcmodel itemw_refwat refer data concentr scale option itemoptsopt pass analysi method itemparallelperform analys parallel true fals itemtimemeasur time taken analysi complet true fals itemprogressopt pass plyralpli function display progress bar fit default valu text set none disabl itemextraan option data frame provid addit variabl use subsequ analysi step eg id group variabl valu mr analysi object descript note tarquin lcmodel requir packag instal function set_tqn_cmd set_lcm_cmd respect need use specifi locat softwar packag detail fit approach describ follow refer abfit wilson adapt baselin fit h mr spectroscopi analysi magn reson med varpro van der veen jw de beer r luyten pr van ormondt accur quantif vivo p nmr signal use variabl project method prior knowledg magn reson med tarquin wilson reynold g kauppinen r arvan n peet c constrain leastsquar approach autom quantit vivo h magnet reson spectroscopi data magn reson med lcmodel provench sw estim metabolit concentr local vivo proton nmr spectra magn reson med exampl fname systemfileextdata philips_spar_sdat_wssdat packag spant sv read_mrsfnam dontrun basi sim_basis_h_brain_presssv fit_result fit_mrssv basi gener roxygen edit hand pleas edit document ramp_scalingr namescale_amp_ratio aliasscale_amp_ratio titlescal fit amplitud ratio signal amplitud usag scale_amp_ratiofit_result name argument itemfit_resulta result object gener fit itemnameth signal name use denomin usual tcr tnaa valu codefit_result object rescal result tabl descript scale fit amplitud ratio signal amplitud gener roxygen edit hand pleas edit document rmrs_data_procr nameconv_mr aliasconv_mr titleconvolv two mr data object usag conv_mrsmrs_data conv argument itemmrs_datamr data convolv itemconvconvolut data store mrs_data object valu convolv data descript convolv two mr data object gener roxygen edit hand pleas edit document rmrs_data_procr nameget_tail_dyn aliasget_tail_dyn titlereturn last scan dynam seri usag get_tail_dynsmrs_data n argument itemmrs_datadynam mr data itemnth number dynam scan return valu last scan dynam seri descript return last scan dynam seri gener roxygen edit hand pleas edit document rmrs_data_displayr nameplot_bc aliasplot_bc titleconveni function plot baselin estim origin data usag plot_bcorig_data bc_data argument itemorig_datath origin data itembc_datath baselin correct data itemoth argument pass stackplot function descript conveni function plot baselin estim origin data gener roxygen edit hand pleas edit document rmrs_data_procr nameback_extrap_ar aliasback_extrap_ar titleback extrapol timedomain data point use autoregress model usag back_extrap_ar mrs_data extrap_pt pred_pt null method burg rem_add true argument itemmrs_datamrs_data object itemextrap_ptsnumb point extrapol itempred_ptsnumb point base extrapol itemmethodcharact string specifi method fit model must one string default argument first charact suffici default burg itemrem_addremov addit point end fid maintain origin length dataset default true itemaddit argument specif method see ar valu back extrapol data descript back extrapol timedomain data point use autoregress model gener roxygen edit hand pleas edit document ramp_scalingr namescale_amp_water_ratio aliasscale_amp_water_ratio titlescal metabolit amplitud ratio unsuppress water amplitud usag scale_amp_water_ratiofit_result ref_data argument itemfit_resulta result object gener fit itemref_dataa water refer mr data object itemaddit argument get_td_amp function valu codefit_result object rescal result tabl descript scale metabolit amplitud ratio unsuppress water amplitud gener roxygen edit hand pleas edit document rutilsr nameft_shift aliasft_shift titleperform fft ffshift vector usag ft_shiftvec_in argument itemvec_invector input valu output vector descript perform fft ffshift vector gener roxygen edit hand pleas edit document rmrs_data_displayr nameprintmrs_data aliasprintmrs_data titleprint summari mrs_data paramet usag methodprintmrs_datax full fals argument itemxmrs_data object itemfullprint paramet default fals itemfurth argument descript print summari mrs_data paramet gener roxygen edit hand pleas edit document rspantr namecheck_tqn aliascheck_tqn titlecheck tarquin binari run usag check_tqn descript check tarquin binari run gener roxygen edit hand pleas edit document rmrs_data_procr namealign aliasalign titlealign spectra refer frequenc use convolut base method usag align mrs_data ref_freq zf_factor lb max_shift ret_df fals mean_dyn fals argument itemmrs_datadata align itemref_freqrefer frequenc ppm unit one frequenc may specifi itemzf_factorzero fill factor increas align resolut itemlblin broaden appli refer signal itemmax_shiftmaximum allow shift hz itemret_dfreturn frequenc shift addit align data logic itemmean_dynsalign mean spectrum appli shift dynam valu align data object descript align spectra refer frequenc use convolut base method gener roxygen edit hand pleas edit document rbasis_setr nameread_basis_ac aliasread_basis_ac titleread basi file lcmodel basi format test usag read_basis_acbasis_fil ref def_ref sort_basi true argument itembasis_filepath basi file itemrefassum ppm refer valu itemsort_basissort basi set base signal name valu basi object descript read basi file lcmodel basi format test gener roxygen edit hand pleas edit document rmrs_data_procr namedecimate_mrs_fd aliasdecimate_mrs_fd titledecim mr signal half origin sampl frequenc filter frequenc domain sampl usag decimate_mrs_fdmrs_data argument itemmrs_datamr data object valu decim data half origin sampl frequenc descript decim mr signal half origin sampl frequenc filter frequenc domain sampl gener roxygen edit hand pleas edit document rspantr namedef_nuc aliasdef_nuc titlereturn default nucleu usag def_nuc valu number data point spectral dimens descript return default nucleu gener roxygen edit hand pleas edit document rdatar doctypedata namespant_mpress_drift aliasspant_mpress_drift titleexampl megapress data signific b drift format object class codemrs_data length usag spant_mpress_drift descript exampl megapress data signific b drift keyworddataset gener roxygen edit hand pleas edit document rqm_simulationr namezero_nzoc aliaszero_nzoc titlezero nonzeroord coher usag zero_nzocsi rho argument itemsysspin system object itemrhodens matrix valu densiti matrix descript zero nonzeroord coher gener roxygen edit hand pleas edit document rspantr nameget_tqn_cmd aliasget_tqn_cmd titleprint command run tarquin commandlin program usag get_tqn_cmd descript print command run tarquin commandlin program gener roxygen edit hand pleas edit document rmrs_data_procr namefd_conv_filt aliasfd_conv_filt titlefrequencydomain convolut base filter usag fd_conv_filtmrs_data k ext argument itemmrs_datamr data filter itemkwindow width data point itemextpoint separ linear extrapol descript frequencydomain convolut base filter gener roxygen edit hand pleas edit document rbasis_setr namesim_basis_tqn aliassim_basis_tqn titlesimul basi file use tarquin usag sim_basis_tqn fs def_f ft def_ft n def_n ref def_ref opt null argument itemfssampl frequenc itemfttransmitt frequenc itemnnumb data point itemrefchem shift refer itemoptslist option pass tarquin descript simul basi file use tarquin exampl dontrun write_basis_tqntestbasismrs_datacecho gener roxygen edit hand pleas edit document rfit_displayr namefit_rescsv aliasfit_rescsv titlewrit fit result tabl csv file usag fit_rescsvfit_r fname unscal fals argument itemfit_resfit result object itemfnamefilenam csv file itemunscaledoutput unscal result tabl default fals descript write fit result tabl csv file gener roxygen edit hand pleas edit document rqm_simulationr nameget_h_brain_basis_paras_v aliasget_h_brain_basis_paras_v titlereturn list codemol_paramet object suitabl h brain mr analys usag get_h_brain_basis_paras_vft metab_lw null lcm_compat fals argument itemfttransmitt frequenc hz itemmetab_lwlinewidth metabolit signal hz itemlcm_compatwhen true lipid mm crch molecul exclud output valu list codemol_paramet object descript return list codemol_paramet object suitabl h brain mr analys gener roxygen edit hand pleas edit document rmrs_data_procr namesum_dyn aliassum_dyn titlecalcul sum data dynam usag sum_dynsmrs_data argument itemmrs_datadynam mr data valu sum data dynam descript calcul sum data dynam gener roxygen edit hand pleas edit document rmrs_data_procr namecrop_xi aliascrop_xi titlecrop mrsi dataset xy direct usag crop_xymrs_data x_dim y_dim argument itemmrs_datamr data object itemx_dimx dimens output length itemy_dimi dimens output length valu select subset mr data descript crop mrsi dataset xy direct gener roxygen edit hand pleas edit document rmrs_data_procr namerep_mr aliasrep_mr titlerepl scan given dimens usag rep_mr mrs_data x_rep y_rep z_rep dyn_rep coil_rep warn true argument itemmrs_datamr data replic itemx_repnumb x replic itemy_repnumb replic itemz_repnumb z replic itemdyn_repnumb dynam replic itemcoil_repnumb coil replic itemwarnprint warn data dimens chang valu replic data object descript replic scan given dimens gener roxygen edit hand pleas edit document rmrs_data_procr nameauto_phas aliasauto_phas titleperform zerothord phase correct base minimis squar differ real magnitud compon spectrum usag auto_phasemrs_data xlim null ret_phas fals argument itemmrs_dataan object class codemrs_data itemxlimfrequ rang default unit ppm includ phase itemret_phasereturn phase valu logic valu mr data object phase valu option descript perform zerothord phase correct base minimis squar differ real magnitud compon spectrum gener roxygen edit hand pleas edit document rutilsr namecalc_sd_poli aliascalc_sd_poli titleperform polynomi fit subtract return standard deviat residu usag calc_sd_polyy degre argument itemyarray itemdegreepolynomi degre valu standard deviat fit residu descript perform polynomi fit subtract return standard deviat residu gener roxygen edit hand pleas edit document rmrs_data_procr nameargmrs_data aliasargmrs_data titleappli arg oper mr dataset usag methodargmrs_dataz argument itemzmr data valu mr data follow arg oper descript appli arg oper mr dataset gener roxygen edit hand pleas edit document rqm_simulationr namespin_si aliasspin_si titlecr spin system object puls sequenc simul usag spin_sysspin_param ft ref argument itemspin_paramsan object describ spin system properti itemfttransmitt frequenc hz itemrefrefer valu ppm scale valu spin system object descript creat spin system object puls sequenc simul gener roxygen edit hand pleas edit document rmrs_data_procr namegrid_shift_xi aliasgrid_shift_xi titlegrid shift mrsi data xy dimens usag grid_shift_xymrs_data x_shift y_shift argument itemmrs_datamrsi data spatial domain itemx_shiftshift appli xdirect unit voxel itemy_shiftshift appli ydirect unit voxel valu shift data descript grid shift mrsi data xy dimens gener roxygen edit hand pleas edit document rvarpro__parar namevarpro__para_opt aliasvarpro__para_opt titlereturn list option varpro base fit free paramet item item zeroth order phase correct item global damp item global frequenc shift usag varpro__para_opt nstart init_damp maxit max_shift max_damp anal_jac fals bl_smth_pt argument itemnstartposit timedomain start fit unit data point iteminit_dampingstart valu global gaussian linebroaden term measur hz itemmaxitersmaximum number levmar iter perform itemmax_shiftmaximum global shift allow measur hz itemmax_dampingmaximum damp allow fwhm measur hz itemanal_jacopt use analyt numer jacobian logic itembl_smth_ptsnumb data point use baselin smooth calcul valu list option descript return list option varpro base fit free paramet item item zeroth order phase correct item global damp item global frequenc shift gener roxygen edit hand pleas edit document rspantr namedef_acq_para aliasdef_acq_para titlereturn option modifi use input argument list default acquisit paramet usag def_acq_para ft getoptionspantdef_ft fs getoptionspantdef_f n getoptionspantdef_n ref getoptionspantdef_ref nuc getoptionspantdef_nuc argument itemftspecifi transmitt frequenc hz itemfsspecifi sampl frequenc hz itemnspecifi number data point spectral dimens itemrefspecifi refer valu ppm scale itemnucspecifi reson nucleu valu list contain follow element item item ft transmitt frequenc hz item fs sampl frequenc hz item n number data point spectral dimens item ref refer valu ppm scale item nuc reson nucleu descript return option modifi use input argument list default acquisit paramet gener roxygen edit hand pleas edit document rmrs_data_procr namemask_xy_mat aliasmask_xy_mat titlemask mrsi dataset xy dimens usag mask_xy_matmrs_data mask valu na argument itemmrs_datamr data object itemmaskmatrix boolean valu specifi voxel mask valu true indic voxel remov itemvalueth valu set mask data usual na valu mask dataset descript mask mrsi dataset xy dimens gener roxygen edit hand pleas edit document rmol_parametersr nameget_mol_nam aliasget_mol_nam titlereturn charact array name may use codeget_mol_para function usag get_mol_nam valu charact array name descript return charact array name may use codeget_mol_para function gener roxygen edit hand pleas edit document rmrs_data_procr nameecc aliasecc titleeddi current correct usag eccmetab ref rev fals argument itemmetabmr data correct itemrefrefer dataset itemrevrevers correct valu correct data time domain descript appli eddi current correct use klose method detail vivo proton spectroscopi presenc eddi current klose u magn reson med apr gener roxygen edit hand pleas edit document rqm_simulationr nameget_h_brain_basis_paras_v aliasget_h_brain_basis_paras_v titlereturn list codemol_paramet object suitabl h brain mr analys usag get_h_brain_basis_paras_vft metab_lw null lcm_compat fals argument itemfttransmitt frequenc hz itemmetab_lwlinewidth metabolit signal hz itemlcm_compatwhen true lipid mm crch molecul exclud output valu list codemol_paramet object descript return list codemol_paramet object suitabl h brain mr analys gener roxygen edit hand pleas edit document rmrs_data_procr namephas aliasphas titleappli phase paramet mr data usag phasemrs_data zero_ord first_ord argument itemmrs_datamr data itemzero_orderzeroth order phase term degre itemfirst_orderfirst order frequenc depend phase term ms valu mr data appli phase paramet descript appli phase paramet mr data gener roxygen edit hand pleas edit document rimage_regr nameplot_voi_overlay aliasplot_voi_overlay titleplot volum imag overlay usag plot_voi_overlaymri voi export_path null zlim null argument itemmriimag data nifti object path data file itemvoivolum data nifti object path data file itemexport_pathopt path save imag png format itemzlimunderlay intens limit itemaddit argument ortho function descript plot volum imag overlay gener roxygen edit hand pleas edit document rbenchmarkr namespant_abfit_benchmark aliasspant_abfit_benchmark titlesimul fit spectra abfit benchmark purpos basic time perform metric print usag spant_abfit_benchmarknoise_rep return_r fals opt abfit_opt argument itemnoise_repsnumb spectra fit differ nois sampl itemreturn_resreturn list fit_result object itemoptsabfit option structur descript simul fit spectra abfit benchmark purpos basic time perform metric print gener roxygen edit hand pleas edit document ramp_scalingr namescale_amp_molar aliasscale_amp_molar titleappli water refer scale fit result object yield metabolit quantiti millimolar mm unit mollitr usag scale_amp_molarfit_result ref_data w_att w_conc argument itemfit_resulta result object gener fit itemref_datawat refer mr data object itemw_attwat attenu factor default itemw_concassum water concentr default default valu correspond typic white matter set gray matter phantom measur itemaddit argument get_td_amp function valu codefit_result object rescal result tabl descript see lcmodel manual section watersc detail assumpt relev refer gener roxygen edit hand pleas edit document rmrs_data_procr nameapodise_xi aliasapodise_xi titleapodis mrsi data xy direct kspace filter usag apodise_xymrs_data func ham w argument itemmrs_datamrsi data itemfuncmust ham gaussian itemwth reciproc standard deviat gaussian function valu apodis data descript apodis mrsi data xy direct kspace filter gener roxygen edit hand pleas edit document rmrs_data_procr namecomb_metab_ref aliascomb_metab_ref titlecombin refer metabolit mrs_data object usag comb_metab_refmetab ref argument itemmetabmetabolit mrs_data object itemrefrefer mrs_data object valu combin metabolit refer mrs_data object descript combin refer metabolit mrs_data object gener roxygen edit hand pleas edit document rmrs_data_procr namesim_zero aliassim_zero titlesimul mrs_data object contain complex zero valu sampl usag sim_zerof def_f ft def_ft n def_n ref def_ref dyn argument itemfssampl frequenc hz itemfttransmitt frequenc hz itemnnumb data point spectral dimens itemrefrefer valu ppm scale itemdynsnumb dynam scan gener valu mrs_data object descript simul mrs_data object contain complex zero valu sampl gener roxygen edit hand pleas edit document rmrs_data_procr namemean_mrs_list aliasmean_mrs_list titlereturn mean list mrs_data object usag mean_mrs_listmrs_list argument itemmrs_listlist mrs_data object valu mean codemrs_data object descript return mean list mrs_data object gener roxygen edit hand pleas edit document rmrs_data_procr namemodmrs_data aliasmodmrs_data titleappli mod oper mr dataset usag methodmodmrs_dataz argument itemzmr data valu mr data follow mod oper descript appli mod oper mr dataset gener roxygen edit hand pleas edit document rutilsr namecirc_mask aliascirc_mask titlecr logic circular mask span full extent n x n matrix usag circ_maskd n offset argument itemddiamet mask itemnnumb matrix row column itemoffsetoffset mask centr matrix dimens unit valu logic n x n mask matrix descript creat logic circular mask span full extent n x n matrix gener roxygen edit hand pleas edit document rmrs_data_procr nametd_conv_filt aliastd_conv_filt titletimedomain convolut base filter usag td_conv_filtmrs_data k ext argument itemmrs_datamr data filter itemkwindow width data point itemextpoint separ linear extrapol descript timedomain convolut base filter describ marion ikura bax improv solvent suppress onedimension twodimension nmr spectra convolut timedomain data j magn reson gener roxygen edit hand pleas edit document rmrs_data_procr nameget_seg_ind aliasget_seg_ind titleget indic data point lie two valu end x start usag get_seg_indscal start end argument itemscaleful list valu itemstartsmallest valu subset itemendlargest valu subset valu set indic descript get indic data point lie two valu end x start gener roxygen edit hand pleas edit document rfit_displayr namencoord aliasncoord titleprint fit coordin singl index usag ncoordn fit_r argument itemnfit index itemfit_rescodefit_result object descript print fit coordin singl index gener roxygen edit hand pleas edit document rmrs_data_procr namescale_spec aliasscale_spec titlescal mrs_data spectral region usag scale_spec mrs_data xlim null oper sum freq_scal ppm mode mean_dyn true argument itemmrs_datamr data itemxlimspectr rang integr default full rang itemoperatorcan sum default mean l max min maxmin itemfreq_scaleunit xlim ppm hz point itemmodespectr mode im mod cplx itemmean_dynsmean dynam scan appli oper scale valu appli individu dynam valu normalis data descript scale mrs_data spectral region gener roxygen edit hand pleas edit document rmrs_read_imar nameread_ima_coil_dir aliasread_ima_coil_dir titleread directori contain siemen mr ima file combin along coil dimens note coil id infer sort file name check consist requir two directori usag read_ima_coil_dirdir extra null argument itemdirdata directori path itemextraan option data frame provid addit variabl use subsequ analysi step eg id group variabl valu mrs_data object descript read directori contain siemen mr ima file combin along coil dimens note coil id infer sort file name check consist requir two directori gener roxygen edit hand pleas edit document rimage_regr nameget_mrs_affin aliasget_mrs_affin titlegener affin nifti gener usag get_mrs_affinemrs_data x_po y_po z_po argument itemmrs_datainput data itemx_posx_posit coordin itemy_posy_posit coordin itemz_posz_posit coordin valu affin matrix descript gener affin nifti gener gener roxygen edit hand pleas edit document rmrs_data_procr namemean_dyn_block aliasmean_dyn_block titlecalcul mean adjac dynam scan usag mean_dyn_blocksmrs_data block_siz argument itemmrs_datadynam mr data itemblock_sizenumb adjac dynam scan averag valu dynam data averag block descript calcul mean adjac dynam scan gener roxygen edit hand pleas edit document rutilsr namelwbeta aliaslwbeta titlecovert linewidth hz equival beta valu timedomain ie x expt beta usag lwbetalw argument itemlwlinewidth hz valu beta damp valu descript covert linewidth hz equival beta valu timedomain ie x expt beta gener roxygen edit hand pleas edit document rspantr namecheck_lcm aliascheck_lcm titlecheck lcmodel run usag check_lcm descript check lcmodel run gener roxygen edit hand pleas edit document rutilsr nameelliptical_mask aliaselliptical_mask titlecr ellipt mask store matrix logic valu usag elliptical_maskxn yn x xr yr angl argument itemxnnumb pixel x dimens itemynnumb pixel dimens itemxcentr ellips x direct unit pixel itemycentr ellips direct unit pixel itemxrradiu x direct unit pixel itemyrradiu direct unit pixel itemangleangl rotat degre valu logic mask matrix dimens fov_yn x fov_xn descript creat ellipt mask store matrix logic valu gener roxygen edit hand pleas edit document rimage_regr nameget_voi_cog aliasget_voi_cog titlecalcul centr graviti imag contain usag get_voi_cogvoi argument itemvoinifti object valu triplet xyz coordin descript calcul centr graviti imag contain gener roxygen edit hand pleas edit document rmrs_data_displayr nameplot_slice_map aliasplot_slice_map titleplot slice dimension array usag plot_slice_map data zlim null mask_map null mask_cutoff interp slice dyn coil ref denom null horizont fals argument itemdatad array valu plot itemzlimsmallest largest valu plot itemmask_mapmatch map logic valu indic correspond valu plot itemmask_cutoffminimum valu plot percentag maximum iteminterpmap interpol factor itemsliceth slice index plot itemdynth dynam index plot itemcoilth coil element number plot itemrefrefer index plot itemdenommap use denomin itemhorizontaldisplay colourbar horizont logic descript plot slice dimension array gener roxygen edit hand pleas edit document rmrs_data_procr namesim_reson aliassim_reson titlesimul mr data object contain set simul reson usag sim_reson freq amp lw lg phase freq_ppm true acq_para def_acq_para fp_scale true back_extrap_pt sum_reson true argument itemfreqreson frequenc itemampreson amplitud itemlwlin width hz itemlglorentzgauss lineshap paramet itemphasephas degre itemfreq_ppmfrequ given ppm unit set true otherwis hz assum itemacq_paraslist acquisit paramet see codelinkdef_acq_para itemfp_scalemultipli first data point itemback_extrap_ptsnumb data point back extrapol itemsum_resonancessum reson default true otherwis return dynam mrs_data object valu mr data object descript simul mr data object contain set simul reson exampl sim_data sim_resonancesfreq lw gener roxygen edit hand pleas edit document rmrs_data_displayr namegridplot aliasgridplot titlearrang spectral plot grid usag gridplotx argument itemxobject plot itemargu pass method descript arrang spectral plot grid gener roxygen edit hand pleas edit document rmrs_read_twixr nameread_siemens_txt_hdr aliasread_siemens_txt_hdr titleread text format header found siemen ima twix data file usag read_siemens_txt_hdrinput version vd argument iteminputfil name read raw data itemversionsoftwar version vb vd valu list paramet valu descript read text format header found siemen ima twix data file gener roxygen edit hand pleas edit document rfittingr namefit_diag aliasfit_diag titlecalcul diagnost inform object class codefit_result usag fit_diagsx amp null argument itemxcodefit_result object itemampsknown metabolit amplitud valu datafram diagnost inform descript calcul diagnost inform object class codefit_result gener roxygen edit hand pleas edit document rmrs_data_procr namenz aliasnz titlereturn total number z locat mr dataset usag nzmrs_data argument itemmrs_datamr data descript return total number z locat mr dataset gener roxygen edit hand pleas edit document rmrs_data_procr namefp_phase_correct aliasfp_phase_correct titleperform zeroth order phase correct base phase first data point timedomain usag fp_phase_correctmrs_data ret_phas fals argument itemmrs_datamr data correct itemret_phasereturn phase valu logic valu correct data list correct data option phase valu descript perform zeroth order phase correct base phase first data point timedomain gener roxygen edit hand pleas edit document rspantr namedef_ft aliasdef_ft titlereturn default transmitt frequenc hz usag def_ft valu transmitt frequenc hz descript return default transmitt frequenc hz gener roxygen edit hand pleas edit document rdicom_readerr namedicom_read aliasdicom_read titlea simpl dicom reader usag dicom_read input tag listsop_class_uid endian littl debug fals argument iteminputeith file path raw binari object itemtagsa name list tag extract file eg tag listspec_data fe pat_nam itemendiancan littl big itemdebugprint debug inform littl big valu list structur input tag code replac correspond data raw format descript note reader basic use dicom dictionari tri convert data correct datatyp robust sophist reader use orodicom packag gener roxygen edit hand pleas edit document rmrs_data_procr nameset_td_pt aliasset_td_pt titleset number timedomain data point truncat zerofil appropri usag set_td_ptsmrs_data pt argument itemmrs_datamr data itemptsnumb data point valu mr data pt data point descript set number timedomain data point truncat zerofil appropri gener roxygen edit hand pleas edit document rmrs_data_procr namereson_tablemrs_data aliasreson_tablemrs_data titlegener mrs_data tabl singl lorentzian reson usag reson_tablemrs_data reson_t acq_para def_acq_para back_extrap_pt argument itemreson_tablea produc hsvd function itemacq_paraslist acquisit paramet see itemback_extrap_ptsnumb data point back extrapol codelinkdef_acq_para valu mrs_data object descript gener mrs_data tabl singl lorentzian reson gener roxygen edit hand pleas edit document rpulse_sequencesr nameseq_pulse_acquire_p aliasseq_pulse_acquire_p titlesimpl puls acquir sequenc ideal puls usag seq_pulse_acquire_pspin_param ft ref argument itemspin_paramsspin system definit itemfttransmitt frequenc hz itemrefrefer valu ppm scale valu list reson amplitud frequenc descript simpl puls acquir sequenc ideal puls gener roxygen edit hand pleas edit document rmrs_data_procr namefp_phas aliasfp_phas titlereturn phase first data point timedomain usag fp_phasemrs_data argument itemmrs_datamr data valu phase valu degre descript return phase first data point timedomain gener roxygen edit hand pleas edit document rfittingr namecomb_fit_t aliascomb_fit_t titlecombin fit data point singl data frame usag comb_fit_tablesfit_r inc_basis_sig fals inc_indic true argument itemfit_resa singl fit_result object iteminc_basis_sigsinclud individu fit basi signal output tabl default fals iteminc_indicesinclud indic x coil output default true gener use sv analysi valu data frame contain fit data point descript combin fit data point singl data frame gener roxygen edit hand pleas edit document rmrs_data_procr nameimmrs_data aliasimmrs_data titleappli im oper mr dataset usag methodimmrs_dataz argument itemzmr data valu mr data follow im oper descript appli im oper mr dataset gener roxygen edit hand pleas edit document rbenchmarkr namespant_simulation_benchmark aliasspant_simulation_benchmark titlesimul typic metabolit basi set benchmark time metric print complet usag spant_simulation_benchmarksim_rep n argument itemsim_repsnumb time simul basi set itemnnumb fid data point simul descript simul typic metabolit basi set benchmark time metric print complet gener roxygen edit hand pleas edit document rmrs_data_procr nameinterleave_dyn aliasinterleave_dyn titleinterleav first second half dynam seri usag interleave_dynsmrs_data argument itemmrs_datadynam mr data valu interleav data descript interleav first second half dynam seri gener roxygen edit hand pleas edit document rmrs_data_procr namesum_mr aliassum_mr titlesum two mrs_data object usag sum_mrsa b forc fals argument itemafirst mrs_data object sum itembsecond mrs_data object sum itemforceset true forc mrs_data object sum even differ timefrequ domain valu b descript sum two mrs_data object gener roxygen edit hand pleas edit document rmrs_data_procr namebc_ aliasbc_ titlebaselin correct use al method usag bc_alsmrs_data lambda p argument itemmrs_datamrs_data object itemlambdalambda paramet itempp paramet valu baselin correct data descript baselin correct use al method gener roxygen edit hand pleas edit document rimage_regr nameget_mrsid_seg aliasget_mrsid_seg titlecalcul partial volum estim voxel mrsi dataset usag get_mrsid_segmrs_data mri_seg ker argument itemmrs_datad mrsi data multipl voxel xy dimens itemmri_segmri data valu correspond segment class must mm isotrop resolut itemkermrsi psf kernel xy direct compat mmand packag eg mmandshapekernelc type box valu data frame partial volum estim individu segment map descript localis assum perfect z direct determin ker input xy direct gener roxygen edit hand pleas edit document rmrs_data_procr nameappend_dyn aliasappend_dyn titleappend mr data across dynam dimens assum match across dimens usag append_dyn argument itemmr data object argument list mr data object valu singl mr data object input object concaten togeth descript append mr data across dynam dimens assum match across dimens gener roxygen edit hand pleas edit document rtdsrr nametdsr aliastdsr titletimedomain spectral registr usag tdsrmrs_data ref null xlim c max_t argument itemmrs_datamr data correct itemrefopt mr data use refer mean dynam use argument suppli itemxlimopt frequenc rang perform optimis set null use full rang itemmax_ttrunc fid longer max_t reduc time taken valu list contain correct data phase shift valu unit degre hz respect descript implement method publish near et al mrm gener roxygen edit hand pleas edit document rmrs_data_procr namesum_coil aliassum_coil titlecalcul sum across receiv coil element usag sum_coilsmrs_data argument itemmrs_datamr data split across receiv coil element valu sum across coil element descript calcul sum across receiv coil element gener roxygen edit hand pleas edit document rspantr namedef_n aliasdef_n titlereturn default number data point spectral dimens usag def_n valu number data point spectral dimens descript return default number data point spectral dimens gener roxygen edit hand pleas edit document rspantr nameget_lcm_cmd aliasget_lcm_cmd titleprint command run lcmodel commandlin program usag get_lcm_cmd descript print command run lcmodel commandlin program gener roxygen edit hand pleas edit document rmrs_data_procr namerecon_twix_d_mrsi aliasrecon_twix_d_mrsi titlereconstruct mrsi data twix file load read_mr usag recon_twix_d_mrsitwix_mr argument itemtwix_mrsraw dynam data valu reconstruct data descript reconstruct mrsi data twix file load read_mr gener roxygen edit hand pleas edit document rqm_simulationr nameget_h_brain_basis_para aliasget_h_brain_basis_para titlereturn list codemol_paramet object suitabl h brain mr analys usag get_h_brain_basis_parasft metab_lw null lcm_compat fals argument itemfttransmitt frequenc hz itemmetab_lwlinewidth metabolit signal hz itemlcm_compatwhen true lipid mm crch molecul exclud output valu list codemol_paramet object descript return list codemol_paramet object suitabl h brain mr analys gener roxygen edit hand pleas edit document rmrs_data_procr nameget_slic aliasget_slic titlereturn singl slice larger mrsi dataset usag get_slicemrs_data z_po argument itemmrs_datamrsi data itemz_posth z index extract valu mr data descript return singl slice larger mrsi dataset gener roxygen edit hand pleas edit document rmrs_data_procr nameget_td_amp aliasget_td_amp titlereturn array amplitud deriv fit initi point time domain extrapol back usag get_td_ampmrs_data nstart nend method spline argument itemmrs_datamr data itemnstartfirst data point fit itemnendlast data point fit itemmethodmethod measur amplitud one spline exp valu array amplitud descript return array amplitud deriv fit initi point time domain extrapol back gener roxygen edit hand pleas edit document rmrs_data_procr namecalc_coil_noise_cor aliascalc_coil_noise_cor titlecalcul nois correl coil element usag calc_coil_noise_cornoise_data argument itemnoise_datacodemrs_data object one fid coil element valu correl matrix descript calcul nois correl coil element gener roxygen edit hand pleas edit document rbasis_setr namemrs_databasi aliasmrs_databasi titleconvert mrs_data object basi object basi signal spread across dynam dimens mr data usag mrs_databasismrs_data name argument itemmrs_datamrs_data object basi signal spread across dynam dimens itemnameslist name correspond basi signal valu basi set object descript convert mrs_data object basi object basi signal spread across dynam dimens mr data gener roxygen edit hand pleas edit document rmrs_data_procr nameni aliasni titlereturn total number locat mr dataset usag nymrs_data argument itemmrs_datamr data descript return total number locat mr dataset gener roxygen edit hand pleas edit document rutilsr namegausswin_d aliasgausswin_d titlecr two dimension gaussian window function store matrix usag gausswin_dxn yn x xw yw argument itemxnnumb pixel x dimens itemynnumb pixel dimens itemxcentr window function x direct unit pixel note integ valu appli itemycentr window function direct unit pixel note integ valu appli itemxwth reciproc standard deviat gaussian window x direct itemywth reciproc standard deviat gaussian window direct valu matrix dimens fov_yn x fov_xn descript creat two dimension gaussian window function store matrix gener roxygen edit hand pleas edit document rmol_parametersr nameget_mol_para aliasget_mol_para titleget codemol_paramet object name molecul usag get_mol_parasnam argument itemnameth name molecul itemargu pass molecul definit function descript get codemol_paramet object name molecul gener roxygen edit hand pleas edit document rmrs_data_procr namecalc_coil_noise_sd aliascalc_coil_noise_sd titlecalcul nois standard deviat coil element usag calc_coil_noise_sdnoise_data argument itemnoise_datacodemrs_data object one fid coil element valu array standard deviat descript calcul nois standard deviat coil element gener roxygen edit hand pleas edit document rmrs_data_procr namehsvd aliashsvd titlehsvd mrs_data object usag hsvdmrs_data comp irlba true max_damp argument itemmrs_datamrs_data object decompos itemcompsnumb lorentzian compon use model itemirlbaopt use irlba svd logic itemmax_dampmaximum allow damp factor valu basi matrix signal tabl descript hsvd method describ barkhuijsen h de beer r van ormondt improv algorithm nonit timedomain model fit exponenti damp magnet reson signal j magn reson gener roxygen edit hand pleas edit document rpulse_sequencesr nameseq_press_id aliasseq_press_id titlepress sequenc ideal puls usag seq_press_idealspin_param ft ref te te argument itemspin_paramsspin system definit itemfttransmitt frequenc hz itemrefrefer valu ppm scale itemtet sequenc paramet second tetet itemtet sequenc paramet second valu list reson amplitud frequenc descript press sequenc ideal puls gener roxygen edit hand pleas edit document rpulse_sequencesr nameseq_slaser_id aliasseq_slaser_id titleslas sequenc ideal puls usag seq_slaser_idealspin_param ft ref te te te argument itemspin_paramsspin system definit itemfttransmitt frequenc hz itemrefrefer valu ppm scale itemtefirst echo time exc st echo second itemtesecond echo time nd echo th echo second itemtethird echo time th echo th echo second valu list reson amplitud frequenc descript slaser sequenc ideal puls gener roxygen edit hand pleas edit document rimage_regr nameresample_img aliasresample_img titleresampl imag match target imag space usag resample_imgsourc target interp l argument itemsourceimag data nifti object itemtargetimag data nifti object iteminterpinterpol paramet see nifyreglinear definit valu resampl imag data nifti object descript resampl imag match target imag space gener roxygen edit hand pleas edit document rimage_regr nameget_mrsi_voxel_xy_psf aliasget_mrsi_voxel_xy_psf titlegener mrsi voxel psf codemrs_data object usag get_mrsi_voxel_xy_psfmrs_data target_mri x_po y_po z_po argument itemmrs_datamr data itemtarget_mriopt imag data match intend volum space itemx_posx voxel coordin itemy_posi voxel coordin itemz_posz voxel coordin valu volum data nifti object descript gener mrsi voxel psf codemrs_data object gener roxygen edit hand pleas edit document rmrs_data_procr namefp_scal aliasfp_scal titlescal first timedomain data point mrs_data object usag fp_scalemrs_data scale argument itemmrs_datamr data itemscalesc valu default valu scale mrs_data object descript scale first timedomain data point mrs_data object gener roxygen edit hand pleas edit document rmrs_data_procr namemeanmrs_data aliasmeanmrs_data titlecalcul mean spectrum mrs_data object usag methodmeanmrs_datax argument itemxobject class mrs_data itemoth argument pass colmean function valu mean mrs_data object descript calcul mean spectrum mrs_data object gener roxygen edit hand pleas edit document rmrs_data_procr nameconjmrs_data aliasconjmrs_data titleappli conj oper mr dataset usag methodconjmrs_dataz argument itemzmr data valu mr data follow conj oper descript appli conj oper mr dataset gener roxygen edit hand pleas edit document rmrs_data_procr nameget_even_dyn aliasget_even_dyn titlereturn even number dynam scan start usag get_even_dynsmrs_data argument itemmrs_datadynam mr data valu dynam mr data contain even number scan descript return even number dynam scan start gener roxygen edit hand pleas edit document rpulse_sequencesr nameseq_spin_echo_ideal_p aliasseq_spin_echo_ideal_p titlespin echo sequenc ideal puls usag seq_spin_echo_ideal_pspin_param ft ref te argument itemspin_paramsspin system definit itemfttransmitt frequenc hz itemrefrefer valu ppm scale itemteecho time second valu list reson amplitud frequenc descript spin echo sequenc ideal puls gener roxygen edit hand pleas edit document rmrs_data_procr namel_reg aliasl_reg titleperform l regularis artefact suppress usag l_reg mrs_data thresh b e na xlim na thresh_xlim null argument itemmrs_datainput data artefact suppress itemthreshthreshold paramet extract lipid signal mrs_data base spectral integr thresh_xlim region magnitud mode itembregularis paramet itemaset spectra contain artefact basi signal thresh paramet ignor specifi itemxlimspectr limit ppm restrict reconstruct rang default full spectral width itemthresh_xlimspectr limit ppm integr threshold map valu l reconstruct mrs_data object descript perform l regularis artefact suppress use method propos bilgic et al jmri gener roxygen edit hand pleas edit document rfit_displayr nameprintfit_result aliasprintfit_result titleprint summari object class codefit_result usag methodprintfit_resultx argument itemxcodefit_result object itemfurth argument descript print summari object class codefit_result gener roxygen edit hand pleas edit document rqm_simulationr namegen_f aliasgen_f titlegener f product oper usag gen_fsi op detect null argument itemsysspin system object itemopoper one x z p itemdetectdetect nuclei valu f product oper matrix descript gener f product oper gener roxygen edit hand pleas edit document rutilsr nameisdef aliasisdef titlecheck object defin null usag isdefx argument itemxobject test null valu logic valu descript check object defin null gener roxygen edit hand pleas edit document rimage_regr nameget_voi_seg_psf aliasget_voi_seg_psf titlereturn white matter gray matter csf composit volum usag get_voi_seg_psfpsf mri_seg argument itempsfvolum data nifti object itemmri_segseg brain volum nifti object valu vector partial volum express percentag descript return white matter gray matter csf composit volum gener roxygen edit hand pleas edit document rmrs_data_procr namedownsample_mrs_fd aliasdownsample_mrs_fd titledownsampl mr signal factor use fft brickwal filter usag downsample_mrs_fdmrs_data argument itemmrs_datamr data object valu downsampl data descript downsampl mr signal factor use fft brickwal filter gener roxygen edit hand pleas edit document rmrs_data_procr nameget_odd_dyn aliasget_odd_dyn titlereturn odd number dynam scan start usag get_odd_dynsmrs_data argument itemmrs_datadynam mr data valu dynam mr data contain odd number scan descript return odd number dynam scan start gener roxygen edit hand pleas edit document rutilsr namecrossprod_d aliascrossprod_d titlecomput vector cross product vector x adapt httpstackoverflowcomquestionswhatisrscrossproductfunct usag crossprod_dx argument itemxvector length itemyvector length valu vector cross product x descript comput vector cross product vector x adapt httpstackoverflowcomquestionswhatisrscrossproductfunct gener roxygen edit hand pleas edit document rmrs_data_procr nameget_sh_dyn aliasget_sh_dyn titlereturn second half dynam seri usag get_sh_dynsmrs_data argument itemmrs_datadynam mr data valu second half dynam seri descript return second half dynam seri gener roxygen edit hand pleas edit document rmrs_data_procr nameset_mask_xy_mat aliasset_mask_xy_mat titleset mask voxel mrsi dataset given spectrum usag set_mask_xy_matmrs_data mask mask_mrs_data argument itemmrs_datamrsi data object itemmaskmatrix boolean valu specifi voxel set valu true indic voxel set mask_mrs_data itemmask_mrs_datath spectral data assign mask voxel valu updat dataset descript set mask voxel mrsi dataset given spectrum gener roxygen edit hand pleas edit document rinteractive_plottingr nameortho aliasortho titledisplay orthograph project plot nifti object usag ortho underlay overlay null xyz null zlim null zlim_ol null alpha col_ol viridisliteviridi orient_lab true rescal crosshair true ch_lwd colourbar true bg black mar c smallplot c argument itemunderlayunderlay imag shown grayscal itemoverlayopt overlay imag itemxyzx z slice coordin display itemzlimunderlay intens limit itemzlim_oloverlay intens limit itemalphatranspar overlay itemcol_olcolour palett overlay itemorient_labdisplay orient label default true itemrescalerescal factor underlay overlay imag itemcrosshairsdisplay crosshair default true itemch_lwdcrosshair linewidth itemcolourbardisplay colourbar overlay default true itembgplot background colour itemmarplot margin itemsmallplotsmallplot option posit colourbar descript display orthograph project plot nifti object gener roxygen edit hand pleas edit document rmrs_data_displayr nameplotmrs_data aliasplotmrs_data titleplot method object class mrs_data usag methodplotmrs_data x dyn x_po y_po z_po coil fd true x_unit null xlim null y_scale fals x_ax true mode lwd null bti null label restore_def_par true mar null xaxis_lab null xat null xlab true yat null ylab true show_grid true grid_nx null grid_ni na col null alpha null argument itemxobject class mrs_data itemdynth dynam index plot itemx_posth x index plot itemy_posth index plot itemz_posth z index plot itemcoilth coil element number plot itemfddisplay data frequencydomain default timedomain logic itemx_unitsth unit use xaxi one ppm hz point second itemxlimth rang valu display xaxi eg xlim c itemy_scaleopt display yaxi valu logic itemx_axopt display xaxi valu logic itemmoderepresent complex number plot one im mod arg itemlwdplot linewidth itembtyopt draw box around plot see par itemlabelcharact string add top left plot window itemrestore_def_parrestor default plot par valu plot made itemmaropt adjust plot margin see par itemxaxis_labxaxi label itemxatxaxi tick label valu itemxlabsxaxi tick label itemyatyaxi tick label valu itemylabsyaxi tick label itemshow_gridplot gridlin behind data logic default true itemgrid_nxnumb cell grid x direct null grid align tick mark correspond default axi ie tickmark comput axtick na grid line drawn correspond direct itemgrid_nya itemcolset line colour eg col rgb itemalphaset line transpar eg alpha transpar overrid transpar level set col itemoth argument pass plot method descript plot method object class mrs_data gener roxygen edit hand pleas edit document rmrs_data_displayr namestackplot aliasstackplot titleproduc plot multipl trace usag stackplotx argument itemxobject plot itemargu pass method descript produc plot multipl trace gener roxygen edit hand pleas edit document rpulse_shapesr nameget_guassian_puls aliasget_guassian_puls titlegener gaussian puls shape usag get_guassian_pulseangl n trunc argument itemanglepuls angl degre itemnnumb point gener itemtruncpercentag truncat factor descript gener gaussian puls shape gener roxygen edit hand pleas edit document rinteractive_plottingr nameplot_slice_map_int aliasplot_slice_map_int titleplot interact slice map data array voxel select display correspond spectrum usag plot_slice_map_int mrs_data map null xlim null slice zlim null mask_map null denom null mask_cutoff interp mode y_scale fals ylim null coil fd true argument itemmrs_dataspectr data itemmaparray valu plot default integr modulu full spectral width itemxlimspectr region plot itemsliceth slice index plot itemzlimsmallest largest valu plot itemmask_mapmatch map logic valu indic correspond valu plot itemdenommap use denomin itemmask_cutoffminimum valu plot percentag maximum iteminterpmap interpol factor itemmoderepresent complex spectrum plot one im mod arg itemy_scaleopt display yaxi valu logic itemylimintens rang plot itemcoilcoil element plot itemfddisplay data frequencydomain default timedomain logic descript plot interact slice map data array voxel select display correspond spectrum gener roxygen edit hand pleas edit document rmrs_data_displayr nameimagemrs_data aliasimagemrs_data titleimag plot method object class mrs_data usag methodimagemrs_data x xlim null mode col null plot_dim null x_po null y_po null z_po null dyn coil restore_def_par true y_tick null vline null hline null argument itemxobject class mrs_data itemxlimth rang valu display xaxi eg xlim c itemmoderepresent complex number plot one im mod arg itemcolcolour map use default viridi itemplot_dimth dimens display yaxi one dyn x z coil null null default spectra collaps dynam dimens display itemx_posth x index plot itemy_posth index plot itemz_posth z index plot itemdynth dynam index plot itemcoilth coil element number plot itemrestore_def_parrestor default plot par valu plot made itemy_ticksa vector indic specifi place tick mark itemvlinedraw vertic line valu vline itemhlinedraw horizont line valu hline itemoth argument pass plot method descript imag plot method object class mrs_data gener roxygen edit hand pleas edit document rmrs_data_procr namedecimate_mrs_td aliasdecimate_mrs_td titledecim mr signal filter time domain downsampl usag decimate_mrs_tdmrs_data q n ftype iir argument itemmrs_datamr data object itemqinteg factor downsampl default itemnfilt order use downsampl itemftypefilt type iir fir valu decim data descript decim mr signal filter time domain downsampl gener roxygen edit hand pleas edit document rimage_regr nameplot_voi_overlay_seg aliasplot_voi_overlay_seg titleplot volum overlay segment brain volum usag plot_voi_overlay_segmri_seg voi export_path null argument itemmri_segseg brain volum nifti object itemvoivolum data nifti object itemexport_pathopt path save imag png format itemaddit argument ortho function descript plot volum overlay segment brain volum gener roxygen edit hand pleas edit document rbasis_setr nameread_basi aliasread_basi titleread basi file lcmodel basi format usag read_basisbasis_fil ref def_ref sort_basi true argument itembasis_filepath basi file itemrefassum ppm refer valu itemsort_basissort basi set base signal name valu basi object descript read basi file lcmodel basi format gener roxygen edit hand pleas edit document rbasis_setr namewrite_basi aliaswrite_basi titlewrit basi object lcmodel basi format file usag write_basisbasi basis_fil fwhmba argument itembasisbasi object export itembasis_filepath basi file gener itemfwhmbaparamet use lcmodel descript write basi object lcmodel basi format file gener roxygen edit hand pleas edit document rutilsr doctypeimport namereexport aliasreexport alia alia aliasreadnifti aliaswritenifti titleobject export packag keywordintern descript object import packag follow link see document describ itemmagrittrcodelinkmagrittrexposit codelinkmagrittrpip itemrnifticodelinkrniftireadnifti codelinkrniftiwritenifti gener roxygen edit hand pleas edit document rutilsr nameget_d_psf aliasget_d_psf titleget point spread function psf phase encod mrsi scan usag get_d_psffov mat_siz sampl circ ham fals argument itemfovfield view mm itemmat_sizeacquisit matrix size interpol itemsamplingcan either circ circular rect rectangular itemhammingshould ham kspace weight appli default fals valu matrix psf mm resolut descript get point spread function psf phase encod mrsi scan gener roxygen edit hand pleas edit document rbasis_setr nameappend_basi aliasappend_basi titlecombin pair basi set object usag append_basisbasis_a basis_b argument itembasis_afirst basi itembasis_bsecond basi valu combin basi set object descript combin pair basi set object gener roxygen edit hand pleas edit document rmrs_data_procr nameget_voxel aliasget_voxel titlereturn singl voxel larger mr dataset usag get_voxelmrs_data x_po y_po z_po dyn coil argument itemmrs_datamr data itemx_posth x index plot itemy_posth index plot itemz_posth z index plot itemdynth dynam index plot itemcoilth coil element number plot valu mr data descript return singl voxel larger mr dataset gener roxygen edit hand pleas edit document rmrs_data_procr nameinv_odd_dyn aliasinv_odd_dyn titleinvert odd number dynam scan start usag inv_odd_dynsmrs_data argument itemmrs_datadynam mr data valu dynam mr data invert odd number scan descript invert odd number dynam scan start gener roxygen edit hand pleas edit document rutilsr namelwalpha aliaslwalpha titlecovert linewidth hz equival alpha valu timedomain ie x expt alpha usag lwalphalw argument itemlwlinewidth hz valu beta damp valu descript covert linewidth hz equival alpha valu timedomain ie x expt alpha gener roxygen edit hand pleas edit document rmrs_data_procr nameft_dyn aliasft_dyn titleappli fourier transform dynam dimens usag ft_dynmrs_data ft_shift fals argument itemmrs_datamr data dynam dimens timedomain itemft_shiftappli ft shift output default fals valu transform mr data descript appli fourier transform dynam dimens gener roxygen edit hand pleas edit document rfittingr namecomb_fit_list_fit_t aliascomb_fit_list_fit_t titlecombin fit data point list fit singl data frame usag comb_fit_list_fit_t fit_list add_extra true harmonise_ppm true inc_basis_sig fals inc_indic true add_res_id true argument itemfit_listlist fit_result object itemadd_extraadd variabl extra data frame output true itemharmonise_ppmensur ppm scale fit ident first iteminc_basis_sigsinclud individu fit basi signal output tabl default fals iteminc_indicesinclud indic x coil output default true gener use sv analysi itemadd_res_idadd res_id column output distinguish dataset valu data frame contain fit data point descript combin fit data point list fit singl data frame gener roxygen edit hand pleas edit document rqm_simulationr namesim_basi aliassim_basi titlesimul basi set object usag sim_basi mol_list pul_seq seq_pulse_acquir acq_para def_acq_para xlim null argument itemmol_listlist codemol_paramet object itempul_seqpuls sequenc function use itemacq_paraslist acquisit paramet mrs_data object see codelinkdef_acq_para itemxlimppm rang limit signal simul itemextra paramet pass puls sequenc function valu basi object descript simul basi set object gener roxygen edit hand pleas edit document rpulse_sequencesr nameseq_spin_echo_id aliasseq_spin_echo_id titlespin echo sequenc ideal puls usag seq_spin_echo_idealspin_param ft ref te argument itemspin_paramsspin system definit itemfttransmitt frequenc hz itemrefrefer valu ppm scale itemteecho time second valu list reson amplitud frequenc descript spin echo sequenc ideal puls gener roxygen edit hand pleas edit document rutilsr namerectangular_mask aliasrectangular_mask titlecr rectangular mask store matrix logic valu usag rectangular_maskxn yn x xw yw angl argument itemxnnumb pixel x dimens itemynnumb pixel dimens itemxcentr rectangl x direct unit pixel itemycentr rectangl direct unit pixel itemxwwidth x direct unit pixel itemywwidth direct unit pixel itemangleangl rotat degre valu logic mask matrix dimens fov_yn x fov_xn descript creat rectangular mask store matrix logic valu gener roxygen edit hand pleas edit document rspantr doctypepackag namespantpackag aliassp aliasspantpackag titlesp spectroscopi analysi tool descript spant provid set tool read visualis process magnet reson spectroscopi mr data detail get start spant take look introduct vignett codevignettespantintro packagesp full list vignett codebrowsevignettespackag spant full list function codehelppackag spant help_typ html onlin version document avail urlhttpsmartingithubiosp seealso use link item item urlhttpsmartingithubiosp item urlhttpsgithubcommartinsp item report bug urlhttpsgithubcommartinspantissu author strongmaintain martin wilson emailmartinpipegrepcouk hrefhttpsorcidorgorcid contributor item item yong wang contributor item john muschelli contributor gener roxygen edit hand pleas edit document rimage_regr namenifti_flip_lr aliasnifti_flip_lr titleflip x data dimens order nifti imag correspond flip mri data leftright direct assum data save neurolog format check fslorient program usag nifti_flip_lrx argument itemxnifti object process valu nifti object revers x data direct descript flip x data dimens order nifti imag correspond flip mri data leftright direct assum data save neurolog format check fslorient program gener roxygen edit hand pleas edit document rmrs_data_procr nameapply_mr aliasapply_mr titleappli function across given dimens mr data object usag apply_mrsmrs_data dim fun data_onli fals argument itemmrs_datamr data itemdimsdimens appli function itemfunnam function itemargu function itemdata_onlyreturn array rather mr data object descript appli function across given dimens mr data object gener roxygen edit hand pleas edit document rmrs_data_procr namemean_dyn_pair aliasmean_dyn_pair titlecalcul pairwis mean across dynam data set usag mean_dyn_pairsmrs_data argument itemmrs_datadynam mr data valu mean dynam data adjac dynam pair descript calcul pairwis mean across dynam data set gener roxygen edit hand pleas edit document rinteractive_plottingr nameplot_slice_fit_int aliasplot_slice_fit_int titleplot slice mrsi fit result object usag plot_slice_fit_int fit_r map null map_denom null slice zlim null interp xlim null argument itemfit_rescodefit_result object itemmapfit result valu display colour map specifi charact string array numer valu default tnaa itemmap_denomfit result valu divid map argument specifi charact string eg tcr array numer valu itemsliceslic plot z direct itemzlimrang valu plot iteminterpinterpol factor itemxlimspectr plot limit x axi descript plot slice mrsi fit result object gener roxygen edit hand pleas edit document rpulse_sequencesr nameseq_steam_id aliasseq_steam_id titlesteam sequenc ideal puls usag seq_steam_idealspin_param ft ref te tm argument itemspin_paramsspin system definit itemfttransmitt frequenc hz itemrefrefer valu ppm scale itemtesequ paramet second itemtmsequ paramet second valu list reson amplitud frequenc descript steam sequenc ideal puls gener roxygen edit hand pleas edit document rmrs_data_procr namesd aliassd titlecalcul standard deviat spectrum mrs_data object usag sdx narm argument itemxobject class mrs_data itemnarmremov na valu valu sd mrs_data object descript calcul standard deviat spectrum mrs_data object gener roxygen edit hand pleas edit document rutilsr nameft_shift_mat aliasft_shift_mat titleperform fft fftshift matrix column replac shift fft usag ft_shift_matmat_in argument itemmat_inmatrix input valu output matrix descript perform fft fftshift matrix column replac shift fft gener roxygen edit hand pleas edit document rmrs_data_procr namepeak_info aliaspeak_info titlesearch highest peak spectral region return frequenc height fwhm usag peak_info mrs_data xlim c interp_f scale ppm mode real argument itemmrs_dataan object class codemrs_data itemxlimfrequ rang default unit ppm search highest peak iteminterp_finterpol factor default x itemscaleth unit use frequenc scale one ppm hz point itemmodespectr mode real imag mod valu list array contain highest peak frequenc height fwhm unit ppm hz descript search highest peak spectral region return frequenc height fwhm gener roxygen edit hand pleas edit document rqm_simulationr namesim_basis_h_brain_press aliassim_basis_h_brain_press titlesimul basisset suitabl h brain mr analysi acquir press sequenc note ideal puls assum usag sim_basis_h_brain_press acq_para def_acq_para xlim c lcm_compat fals te te argument itemacq_paraslist acquisit paramet mrs_data object see codelinkdef_acq_para itemxlimrang frequenc simul ppm itemlcm_compatexclud lipid mm signal use default lcmodel option itemtet press sequenc te te te itemtet press sequenc valu basi object descript simul basisset suitabl h brain mr analysi acquir press sequenc note ideal puls assum gener roxygen edit hand pleas edit document rmrs_data_procr nameimgkspace_xi aliasimgkspace_xi titletransform mrsi data kspace xy direct usag imgkspace_xymrs_data argument itemmrs_datad mrsi data valu kspace data descript transform mrsi data kspace xy direct gener roxygen edit hand pleas edit document rpulse_sequencesr nameseq_mega_press_id aliasseq_mega_press_id titlemegapress sequenc ideal localis puls gaussian shape edit puls usag seq_mega_press_id spin_param ft ref ed_freq te te bw step argument itemspin_paramsspin system definit itemfttransmitt frequenc hz itemrefrefer valu ppm scale itemed_freqedit puls frequenc ppm itemtet sequenc paramet second tetet itemtet sequenc paramet second itembwedit puls bandwidth hz itemstepsnumb hard puls use approxim edit puls valu list reson amplitud frequenc descript megapress sequenc ideal localis puls gaussian shape edit puls gener roxygen edit hand pleas edit document rmrs_data_procr namemrs_datavec aliasmrs_datavec titleconvert mrs_data object vector usag mrs_datavecmrs_data dyn x_po y_po z_po coil argument itemmrs_datamr data object itemdyndynam index itemx_posx index itemy_posi index itemz_posz index itemcoilcoil element index valu mr data vector descript convert mrs_data object vector gener roxygen edit hand pleas edit document rmrs_data_procr namesdmrs_data aliassdmrs_data titlecalcul standard deviat spectrum mrs_data object usag methodsdmrs_datax narm fals argument itemxobject class mrs_data itemnarmremov na valu valu sd mrs_data object descript calcul standard deviat spectrum mrs_data object gener roxygen edit hand pleas edit document rimage_regr nameget_mrsi_voi aliasget_mrsi_voi titlegener mrsi voi codemrs_data object usag get_mrsi_voimrs_data target_mri null map null ker mmandboxkernel argument itemmrs_datamr data itemtarget_mriopt imag data match intend volum space itemmapopt voi intens map itemkerkernel rescal map data target_mri valu volum data nifti object descript gener mrsi voi codemrs_data object gener roxygen edit hand pleas edit document rmrs_data_procr namespec_op aliasspec_op titleperform mathemat oper spectral region usag spec_op mrs_data xlim null oper sum freq_scal ppm mode argument itemmrs_datamr data itemxlimspectr rang integr default full rang itemoperatorcan sum default mean l max min maxmin itemfreq_scaleunit xlim ppm hz point itemmodespectr mode im mod cplx valu array integr valu descript perform mathemat oper spectral region gener roxygen edit hand pleas edit document rimage_regr nameget_mrsi_voxel aliasget_mrsi_voxel titlegener mrsi voxel codemrs_data object usag get_mrsi_voxelmrs_data target_mri x_po y_po z_po argument itemmrs_datamr data itemtarget_mriopt imag data match intend volum space itemx_posx voxel coordin itemy_posi voxel coordin itemz_posz voxel coordin valu volum data nifti object descript gener mrsi voxel codemrs_data object gener roxygen edit hand pleas edit document rvarpro_basicr namevarpro_basic_opt aliasvarpro_basic_opt titlereturn list option basic varpro analysi usag varpro_basic_optsmethod fd_re nnl true argument itemmethodon td fd fd_re itemnnlsrestrict basi amplitud nonneg valu valu full list option descript return list option basic varpro analysi gener roxygen edit hand pleas edit document rmrs_data_procr nameset_ref aliasset_ref titleset ppm refer valu eg ppm valu hz usag set_refmrs_data ref argument itemmrs_datamr data itemrefrefer valu ppm scale descript set ppm refer valu eg ppm valu hz gener roxygen edit hand pleas edit document rmrs_data_procr namematmrs_data aliasmatmrs_data titleconvert matrix spectral point column dimens dynam row dimens mrs_data object usag matmrs_data mat fs def_f ft def_ft ref def_ref nuc def_nuc fd fals argument itemmatdata matrix itemfssampl frequenc hz itemfttransmitt frequenc hz itemrefrefer valu ppm scale itemnucreson nucleu itemfdflag indic matrix frequenc domain logic valu mrs_data object descript convert matrix spectral point column dimens dynam row dimens mrs_data object gener roxygen edit hand pleas edit document rmrs_data_procr namere_weight aliasre_weight titleappli weight fid enhanc spectral resolut usag re_weightingmrs_data alpha argument itemmrs_datadata enhanc itemreresolut enhanc factor rise exponenti factor itemalphaalpha factor guassian decay valu resolut enhanc mrs_data descript appli weight fid enhanc spectral resolut gener roxygen edit hand pleas edit document rmrs_data_procr nameadd_nois aliasadd_nois titleadd nois mrs_data object usag add_noisemrs_data sd fd true argument itemmrs_datadata add nois itemsdstandard deviat nois itemfdgener nois sampl frequencydomain true timedomain fals requir sinc absolut valu standard deviat nois sampl chang data fourier transform valu mrs_data object addit normal distribut nois descript add nois mrs_data object gener roxygen edit hand pleas edit document rmrs_data_procr namebc_const aliasbc_const titleremov constant baselin offset base refer spectral region usag bc_constantmrs_data xlim argument itemmrs_datamr data itemxlimspectr rang contain flat baselin region measur offset valu baselin correct data descript remov constant baselin offset base refer spectral region gener roxygen edit hand pleas edit document rmrs_data_procr namezero_fade_spec aliaszero_fade_spec titlefad spectrum zero frequenc domain multipl tanh function note oper distort data point end fid usag zero_fade_specmrs_data start_ppm end_ppm argument itemmrs_datadata fade itemstart_ppmstart point fade ppm unit itemend_ppmend point fade ppm unit valu modifi mrs_data object descript fade spectrum zero frequenc domain multipl tanh function note oper distort data point end fid gener roxygen edit hand pleas edit document rmrs_data_procr namescale_mrs_amp aliasscale_mrs_amp titlescal mrs_data object scalar vector amplitud usag scale_mrs_ampmrs_data amp argument itemmrs_datadata scale itemampmultipl factor must length equal nspecmrs_data valu mrs_data object multipli amplitud scale factor descript scale mrs_data object scalar vector amplitud gener roxygen edit hand pleas edit document rprecompr nameset_precomp_mod aliasset_precomp_mod titleset precomput mode usag set_precomp_modemod na argument itemmodecan one default overwrit clean disabl descript set precomput mode gener roxygen edit hand pleas edit document rmrs_data_displayr namegridplotmrs_data aliasgridplotmrs_data titlearrang spectral plot grid usag methodgridplotmrs_data x row na col na mar c oma c bti restore_def_par true argument itemxobject class mrs_data itemrowsnumb grid row itemcolsnumb grid column itemmaropt adjust plot margin see par itemomaout margin area itembtyopt draw box around plot see par itemrestore_def_parrestor default plot par valu plot made itemoth argument pass plot method descript arrang spectral plot grid gener roxygen edit hand pleas edit document rmrs_data_procr namemask_dyn aliasmask_dyn titlemask mr dataset dynam dimens usag mask_dynsmrs_data mask argument itemmrs_datamr data object itemmaskvector boolean valu specifi dynam mask valu true indic spectrum remov valu mask dataset descript mask mr dataset dynam dimens gener roxygen edit hand pleas edit document rmrs_data_procr namecomb_coil aliascomb_coil titlecombin coil data base first data point refer signal usag comb_coil metab ref null nois null scale true scale_method sig_noise_sq sum_coil true noise_region c average_ref_dyn true ref_pt_index argument itemmetabmr data contain metabolit data itemrefmr data contain refer data option itemnoisemr data nois scan option itemscaleopt rescal coil element base first data point logic itemscale_methodon sig_noise_sq sig_nois sig itemsum_coilssum coil element final step logic itemnoise_regionth spectral region ppm estim nois itemaverage_ref_dynstak mean refer scan dynam dimens use itemref_pt_indextimedomain point use estim phase scale valu valu mr data descript default element phase scale prior summat refer signal given mean dynam signal use instead gener roxygen edit hand pleas edit document rmrs_data_procr namehz aliashz titlereturn frequenc scale mr dataset hz usag hzmrs_data fs null n null argument itemmrs_datamr data itemfssampl frequenc hz itemnnumb data point spectral dimens valu frequenc scale descript return frequenc scale mr dataset hz gener roxygen edit hand pleas edit document rmrs_data_ior nameread_mrs_tqn aliasread_mrs_tqn titleread mr data use tarquin softwar packag usag read_mrs_tqnfnam fname_ref na format id na group na argument itemfnameth filenam contain mr data itemfname_refa second filenam contain refer mr data itemformatformat mr data one follow siemen philip ge dcm dpt rda lcm varian bruker jmrui_txt itemidopt id string itemgroupopt group string valu mr data object descript read mr data use tarquin softwar packag exampl fname systemfileextdataphilips_spar_sdat_wssdatpackagesp dontrun mrs_data read_mrs_tqnfnam formatphilip gener roxygen edit hand pleas edit document rmrs_data_procr namessp aliasssp titlesign space project method lipid suppress usag sspmrs_data comp xlim c argument itemmrs_datamr data object itemcompsth number spatial compon use itemxlimspectr rang ppm cover lipid signal valu lipid suppress codemrs_data object descript signal space project method describ tsai sy lin yr lin hy lin fh reduct lipid contamin mr spectroscopi imag use signal space project magn reson med mar gener roxygen edit hand pleas edit document rmrs_data_procr namevecmrs_data aliasvecmrs_data titleconvert vector mrs_data object usag vecmrs_data vec fs def_f ft def_ft ref def_ref nuc def_nuc dyn fd fals argument itemvecth data vector itemfssampl frequenc hz itemfttransmitt frequenc hz itemrefrefer valu ppm scale itemnucreson nucleu itemdynsrepl data across dynam dimens itemfdflag indic matrix frequenc domain logic valu mrs_data object descript convert vector mrs_data object gener roxygen edit hand pleas edit document rmrs_read_imar nameread_ima_dyn_dir aliasread_ima_dyn_dir titleread directori contain siemen mr ima file combin along dynam dimens note coil id infer sort file name check consist requir usag read_ima_dyn_dirdir extra null argument itemdirdata directori path itemextraan option data frame provid addit variabl use subsequ analysi step eg id group variabl valu mrs_data object descript read directori contain siemen mr ima file combin along dynam dimens note coil id infer sort file name check consist requir gener roxygen edit hand pleas edit document rprecompr nameprecomp aliasprecomp titlesav function result file load subsequ call avoid repeat comput usag precompfil fun argument itemfilefil name write result itemfunfunct run itemargu pass fun descript save function result file load subsequ call avoid repeat comput gener roxygen edit hand pleas edit document rfit_displayr nameplot_slice_fit aliasplot_slice_fit titleplot slice mrsi fit result object usag plot_slice_fit fit_r map map_denom null slice zlim null interp argument itemfit_rescodefit_result object itemmapfit result valu display colour map specifi charact string array numer valu default tnaa itemmap_denomfit result valu divid map argument specifi charact string eg tcr array numer valu itemsliceslic plot z direct itemzlimrang valu plot iteminterpinterpol factor descript plot slice mrsi fit result object gener roxygen edit hand pleas edit document rmrs_data_procr nameget_acq_para aliasget_acq_para titlereturn acquisit paramet mr data object usag get_acq_parasmrs_data argument itemmrs_datamr data valu list acquisit paramet descript return acquisit paramet mr data object gener roxygen edit hand pleas edit document rutilsr namebetalw aliasbetalw titlecovert beta valu timedomain equival linewidth hz x expi beta usag betalwbeta argument itembetabeta damp valu valu linewidth valu hz descript covert beta valu timedomain equival linewidth hz x expi beta gener roxygen edit hand pleas edit document rmrs_data_procr namearraymrs_data aliasarraymrs_data titleconvert dimension array mrs_data object array dimens order dummi x z dynam coil fid usag arraymrs_data data_array fs def_f ft def_ft ref def_ref nuc def_nuc fd fals argument itemdata_arrayd data array itemfssampl frequenc hz itemfttransmitt frequenc hz itemrefrefer valu ppm scale itemnucnucleu reson transmitt frequenc itemfdflag indic matrix frequenc domain logic valu mrs_data object descript convert dimension array mrs_data object array dimens order dummi x z dynam coil fid gener roxygen edit hand pleas edit document rmrs_data_procr nameis_fd aliasis_fd titlecheck chemic shift dimens mr data object frequenc domain usag is_fdmrs_data argument itemmrs_datamr data valu logic valu descript check chemic shift dimens mr data object frequenc domain gener roxygen edit hand pleas edit document rutilsr namemvifftshift aliasmvifftshift titleperform ifftshift matrix column replac shift result usag mvifftshiftx argument itemxmatrix input valu output matrix descript perform ifftshift matrix column replac shift result gener roxygen edit hand pleas edit document rutilsr namerep_array_dim aliasrep_array_dim titlerepeat array given dimens usag rep_array_dimx rep_dim n argument itemxarray itemrep_dimdimens extend itemnnumb time repeat valu extend array descript repeat array given dimens gener roxygen edit hand pleas edit document rmrs_data_procr namecalc_peak_info_vec aliascalc_peak_info_vec titlecalcul fwhm peak vector intens valu usag calc_peak_info_vecdata_pt interp_f argument itemdata_ptsinput vector iteminterp_finterpol factor improv fwhm estim valu vector x posit highest data point maximum peak valu axi fwhm unit data point descript calcul fwhm peak vector intens valu gener roxygen edit hand pleas edit document rmrs_data_procr namediff_mr aliasdiff_mr titleappli diff oper mr dataset fidspectr dimens usag diff_mrsmrs_data argument itemmrs_datamr data itemaddit argument diff function valu mr data follow diff oper descript appli diff oper mr dataset fidspectr dimens gener roxygen edit hand pleas edit document rmrs_data_procr namecollapse_to_dyn aliascollapse_to_dyn aliascollapse_to_dynsmrs_data aliascollapse_to_dynsfit_result titlecollaps mr data concaten spectra along dynam dimens usag collapse_to_dynsx rm_mask fals methodcollapse_to_dynsmrs_datax rm_mask fals methodcollapse_to_dynsfit_resultx rm_mask fals argument itemxdata object collaps mrs_data fit_result object itemrm_maskedremov mask dynam output valu collaps data spectra fit concaten along dynam dimens descript collaps mr data concaten spectra along dynam dimens gener roxygen edit hand pleas edit document rfittingr namecomb_fit_list_result_t aliascomb_fit_list_result_t titlecombin fit result tabl list fit result usag comb_fit_list_result_tablesfit_list add_extra true add_res_id true argument itemfit_lista list fit_result object itemadd_extraadd variabl extra data frame output true itemadd_res_idadd res_id column output distinguish dataset valu data frame combin fit result tabl addit id column differenti data set variabl extra data frame may option ad result descript combin fit result tabl list fit result gener roxygen edit hand pleas edit document rmrs_data_procr namemrs_datamat aliasmrs_datamat titleconvert mrs_data object matrix spectral point column dimens dynam row dimens usag mrs_datamatmrs_data collaps true argument itemmrs_datamr data object list mr data object itemcollapsecollaps dimens along dynam dimens eg x mrsi grid would first collaps across dynam scan valu mr data matrix descript convert mrs_data object matrix spectral point column dimens dynam row dimens gener roxygen edit hand pleas edit document rqm_simulationr nameqn_st aliasqn_st titleget quantum coher matrix spin system usag qn_statessi argument itemsysspin system object valu quantum coher number matrix descript get quantum coher matrix spin system gener roxygen edit hand pleas edit document rvarpror namevarpro_opt aliasvarpro_opt titlereturn list option varpro base fit usag varpro_opt nstart init_g_damp maxit max_shift max_g_damp max_ind_damp anal_jac true bl_smth_pt argument itemnstartposit timedomain start fit unit data point iteminit_g_dampingstart valu global gaussian linebroaden term measur hz itemmaxitersmaximum number levmar iter perform itemmax_shiftmaximum shift allow element basi set measur hz itemmax_g_dampingmaximum permit global gaussian linebroaden itemmax_ind_dampingmaximum permit lorentzian linebroaden element basi set measur hz itemanal_jacopt use analyt numer jacobian logic itembl_smth_ptsnumb data point use baselin smooth calcul valu list option descript return list option varpro base fit exampl varpro_optsnstart gener roxygen edit hand pleas edit document rmrs_data_procr nameget_head_dyn aliasget_head_dyn titlereturn first scan dynam seri usag get_head_dynsmrs_data n argument itemmrs_datadynam mr data itemnth number dynam scan return valu first scan dynam seri descript return first scan dynam seri gener roxygen edit hand pleas edit document rfittingr nameread_lcm_coord aliasread_lcm_coord titleread lcmodel format coord file contain fit inform usag read_lcm_coordcoord_f argument itemcoord_fpath coord file valu list contain tabl fit point result structur contain signal amplitud error fit diagnost descript read lcmodel format coord file contain fit inform gener roxygen edit hand pleas edit document rmrs_data_procr namecalc_spec_diff aliascalc_spec_diff titlecalcul sum squar differ two mrs_data object usag calc_spec_diffmrs_data ref null xlim c argument itemmrs_datamrs_data object itemrefrefer mrs_data object calcul differ itemxlimspectr limit perform calcul valu array sum squar differ valu descript calcul sum squar differ two mrs_data object gener roxygen edit hand pleas edit document rmrs_data_procr namemax_mrs_interp aliasmax_mrs_interp titleappli max oper interpol mr dataset usag max_mrs_interpmrs_data interp_f argument itemmrs_datamr data iteminterp_finterpol factor valu array maximum valu real descript appli max oper interpol mr dataset gener roxygen edit hand pleas edit document rimage_regr nameresample_voi aliasresample_voi titleresampl voi match target imag space use nearestneighbour interpol usag resample_voivoi mri argument itemvoivolum data nifti object itemmriimag data nifti object valu volum data nifti object descript resampl voi match target imag space use nearestneighbour interpol gener roxygen edit hand pleas edit document rimage_regr nameget_voi_seg aliasget_voi_seg titlereturn white matter gray matter csf composit volum usag get_voi_segvoi mri_seg argument itemvoivolum data nifti object itemmri_segseg brain volum nifti object valu vector partial volum express percentag descript return white matter gray matter csf composit volum gener roxygen edit hand pleas edit document rmrs_data_procr namezf_xi aliaszf_xi titlezerofil mrsi data kspace xy direct usag zf_xymrs_data factor argument itemmrs_datamrsi data itemfactorzerofil factor factor return dataset twice origin point xy direct factor smaller one permit factor return half kspace point xy direct valu zerofil data descript zerofil mrsi data kspace xy direct gener roxygen edit hand pleas edit document rsvs_batch_fitr namesvs_h_brain_analysi aliassvs_h_brain_analysi titlestandard sv h brain analysi pipelin usag svs_h_brain_analysi metab basi null w_ref null mri_seg null mri null output_dir null extra null decim null rats_corr true ecc fals comb_dyn true hsvd_filt fals scale_amp true te null tr null preproc_onli fals method abfit opt null argument itemmetabfilepath mrs_data object contain mr metabolit data itembasisbasi set object use analysi itemw_reffilepath mrs_data object contain mr water refer data itemmri_segfilepath nifti object contain segment mri data itemmrifilepath nifti object contain anatom mri data itemoutput_dirdirectori path output fit result itemextradatafram one row contain addit inform attach fit result tabl itemdecimateopt decim input data factor two default valu null perform decim unless spectral width greater ppm itemrats_corropt perform rat correct default true itemeccopt perform water refer base eddi current correct default fals itemcomb_dynsopt combin dynam scan default true itemhsvd_filtopt appli hsvd water remov default fals itemscale_ampsopt scale metabolit amplitud estim default true itemtemetabolit mr data echo time second itemtrmetabolit mr data repetit time second itempreproc_onlyonli perform preprocess step omit fit preprocess metabolit data return case itemmethodanalysi method use see fit_mr help itemoptsopt pass analysi method valu fit_result mrs_data object depend preproc_onli option descript standard sv h brain analysi pipelin gener roxygen edit hand pleas edit document rfittingr nameread_tqn_fit aliasread_tqn_fit titleread csv fit result gener tarquin usag read_tqn_fitfit_f argument itemfit_ftarquin fit file valu data frame fit data point descript reader csv fit result gener tarquin exampl dontrun fit read_tqn_fitsystemfileextdatafitcsvpackagesp gener roxygen edit hand pleas edit document rmrs_data_procr namesim_nois aliassim_nois titlesimul mrs_data object contain simul gaussian nois usag sim_nois sd fs def_f ft def_ft n def_n ref def_ref dyn fd true argument itemsdstandard deviat nois itemfssampl frequenc hz itemfttransmitt frequenc hz itemnnumb data point spectral dimens itemrefrefer valu ppm scale itemdynsnumb dynam scan gener itemfdreturn data frequencydomain true timedomain fals valu mrs_data object descript simul mrs_data object contain simul gaussian nois gener roxygen edit hand pleas edit document rfit_displayr nameplotfit_result aliasplotfit_result titleplot fit result object class codefit_result usag methodplotfit_result x dyn x_po y_po z_po coil xlim null data_onli fals label null plot_sig null n null sub_bl fals mar null restore_def_par true ylim null y_scale fals show_grid true grid_nx null grid_ni na argument itemxfit_result object itemdynth dynam index plot itemx_posth x index plot itemy_posth index plot itemz_posth z index plot itemcoilth coil element number plot itemxlimth rang valu display xaxi eg xlim c itemdata_onlydisplay process data logic itemlabelcharact string add top left plot window itemplot_sigsa charact vector signal name add plot itemnsingl index element plot overrid indic given itemsub_blsubtract baselin data fit logic itemmaropt adjust plot margin see par itemrestore_def_parrestor default plot par valu plot made itemylimrang valu display yaxi eg ylim c itemy_scaleopt display yaxi valu logic itemshow_gridplot gridlin behind data logic default true itemgrid_nxnumb cell grid x direct null grid align tick mark correspond default axi ie tickmark comput axtick na grid line drawn correspond direct itemgrid_nya itemfurth argument plot method descript plot fit result object class codefit_result gener roxygen edit hand pleas edit document rabfitr nameabfit_opts_v__ aliasabfit_opts_v__ titlereturn list option abfit analysi maintain compar analys perform version earlier spant usag abfit_opts_v__ argument itemargu pass linkabfit_opt valu full list option descript return list option abfit analysi maintain compar analys perform version earlier spant gener roxygen edit hand pleas edit document rmrs_data_procr namecrop_td_pt aliascrop_td_pt titlecrop codemrs_data object data point timedomain usag crop_td_ptsmrs_data start null end null argument itemmrs_datamr data itemstartstart data point default itemendend data point default last save point valu crop codemrs_data object descript crop codemrs_data object data point timedomain gener roxygen edit hand pleas edit document rmrs_data_procr namezf aliaszf aliaszfmrs_data aliaszfbasis_set titlezerofil mr data time domain usag zfx factor methodzfmrs_datax factor methodzfbasis_setx factor argument itemxinput mrs_data basis_set object itemfactorzerofil factor factor return dataset twice origin data point valu zerofil data descript zerofil mr data time domain gener roxygen edit hand pleas edit document rmrs_data_procr namemedian_dyn aliasmedian_dyn titlecalcul median dynam data usag median_dynsmrs_data argument itemmrs_datadynam mr data valu median dynam data descript calcul median dynam data gener roxygen edit hand pleas edit document rpulse_sequencesr nameseq_cpmg_id aliasseq_cpmg_id titlecpmg style sequenc ideal puls usag seq_cpmg_idealspin_param ft ref te echo argument itemspin_paramsspin system definit itemfttransmitt frequenc hz itemrefrefer valu ppm scale itemteecho time second itemechoesnumb echo valu list reson amplitud frequenc descript cpmg style sequenc ideal puls gener roxygen edit hand pleas edit document rmrs_data_procr namenspec aliasnspec titlereturn total number spectra mr dataset usag nspecmrs_data argument itemmrs_datamr data descript return total number spectra mr dataset gener roxygen edit hand pleas edit document rmrs_data_procr nameset_lw aliasset_lw titleappli linebroaden mrs_data object achiev specifi linewidth usag set_lwmrs_data lw xlim c argument itemmrs_datadata itemlwtarget linewidth unit ppm itemxlimregion search peak obtain linewidth estim valu linebroaden data descript appli linebroaden mrs_data object achiev specifi linewidth gener roxygen edit hand pleas edit document rmrs_data_displayr namestackplotmrs_data aliasstackplotmrs_data titlestackplot plot method object class mrs_data usag methodstackplotmrs_data x xlim null mode x_unit null fd true col null alpha null x_offset y_offset plot_dim null x_po null y_po null z_po null dyn coil bti null label null lab_cex right_marg null bl_lti null restore_def_par true show_grid null grid_nx null grid_ni na lwd null argument itemxobject class mrs_data itemxlimth rang valu display xaxi eg xlim c itemmoderepresent complex number plot one im mod arg itemx_unitsth unit use xaxi one ppm hz point second itemfddisplay data frequencydomain default timedomain logic itemcolset colour line eg col rgb itemalphaset line transpar eg alpha transpar overrid transpar level set col itemx_offsetsepar plot xaxi direct valu default valu itemy_offsetsepar plot yaxi direct valu itemplot_dimth dimens display yaxi one dyn x z coil null null default spectra collaps dynam dimens display itemx_posth x index plot itemy_posth index plot itemz_posth z index plot itemdynth dynam index plot itemcoilth coil element number plot itembtyopt draw box around plot see par itemlabelsadd label data item itemlab_cexlabel size itemright_margchang size right plot margin itembl_ltylinetyp baselin trace default valu null result baselin plot itemrestore_def_parrestor default plot par valu plot made itemshow_gridplot gridlin behind data logic default true itemgrid_nxnumb cell grid x direct null grid align tick mark correspond default axi ie tickmark comput axtick na grid line drawn correspond direct itemgrid_nya itemlwdplot linewidth itemoth argument pass matplot method descript stackplot plot method object class mrs_data gener roxygen edit hand pleas edit document rutilsr namemvfftshift aliasmvfftshift titleperform fftshift matrix column replac shift result usag mvfftshiftx argument itemxmatrix input valu output matrix descript perform fftshift matrix column replac shift result gener roxygen edit hand pleas edit document rbasis_setr namebasismrs_data aliasbasismrs_data titleconvert basi object mrs_data object basi signal spread across dynam dimens usag basismrs_databasi sum_el fals amp null shift null argument itembasisbasi set object itemsum_elementsreturn sum basi element logic itemampsa vector scale factor appli basi element itemshiftsa vector frequenc shift ppm appli basi element valu mrs_data object basi signal spread across dynam dimens sum descript convert basi object mrs_data object basi signal spread across dynam dimens gener roxygen edit hand pleas edit document rutilsr nameift_shift aliasift_shift titleperform iffshift ifft vector usag ift_shiftvec_in argument itemvec_invector input valu output vector descript perform iffshift ifft vector gener roxygen edit hand pleas edit document rmrs_data_procr nameget_metab aliasget_metab titleextract metabolit compon mrs_data object usag get_metabmrs_data argument itemmrs_datamr data valu metabolit compon descript extract metabolit compon mrs_data object gener roxygen edit hand pleas edit document rmrs_data_procr namemask_xi aliasmask_xi titlemask mrsi dataset xy direct usag mask_xymrs_data x_dim y_dim argument itemmrs_datamr data object itemx_dimx dimens output length itemy_dimi dimens output length valu mask mr data descript mask mrsi dataset xy direct gener roxygen edit hand pleas edit document ramp_scalingr namescale_amp_molal_pvc aliasscale_amp_molal_pvc titleappli partial volum correct fit result object usag scale_amp_molal_pvcfit_result ref_data p_vol te tr argument itemfit_resultresult object gener fit itemref_datawat refer mr data object itemp_volsa numer vector partial volum itemteth mr te second itemtrth mr tr second itemaddit argument get_td_amp function valu codefit_result object rescal result tabl descript appli partial volum correct fit result object gener roxygen edit hand pleas edit document rmrs_data_procr nameget_dyn aliasget_dyn titleextract subset dynam scan usag get_dynsmrs_data subset argument itemmrs_datadynam mr data itemsubsetvector contain indic dynam scan return valu mr data contain subset request dynam descript extract subset dynam scan gener roxygen edit hand pleas edit document rmrs_data_procr nameget_ref aliasget_ref titleextract refer compon mrs_data object usag get_refmrs_data argument itemmrs_datamr data valu refer compon descript extract refer compon mrs_data object gener roxygen edit hand pleas edit document rmrs_data_procr nameget_fh_dyn aliasget_fh_dyn titlereturn first half dynam seri usag get_fh_dynsmrs_data argument itemmrs_datadynam mr data valu first half dynam seri descript return first half dynam seri gener roxygen edit hand pleas edit document rmrs_data_procr namecrop_spec aliascrop_spec titlecrop codemrs_data object base frequenc rang usag crop_specmrs_data xlim c scale ppm argument itemmrs_datamr data itemxlimrang valu crop spectral dimens eg xlim c itemscaleth unit use frequenc scale one ppm hz point valu crop codemrs_data object descript crop codemrs_data object base frequenc rang gener roxygen edit hand pleas edit document rimage_regr nameget_svs_voi aliasget_svs_voi titlegener sv acquisit volum codemrs_data object usag get_svs_voimrs_data target_mri argument itemmrs_datamr data itemtarget_mriopt imag data match intend volum space valu volum data nifti object descript gener sv acquisit volum codemrs_data object gener roxygen edit hand pleas edit document rmrs_data_procr namenpt aliasnpt titlereturn number data point mr dataset usag nptsmrs_data argument itemmrs_datamr data valu number data point descript return number data point mr dataset gener roxygen edit hand pleas edit document rimage_regr namereslice_to_mr aliasreslice_to_mr titlereslic nifti object match orient mr data usag reslice_to_mrsmri mr argument itemmrinifti object reslic itemmrsmrs_data object target orient valu reslic imag data descript reslic nifti object match orient mr data gener roxygen edit hand pleas edit document rmrs_data_procr namehsvd_filt aliashsvd_filt titlehsvd base signal filter usag hsvd_filt mrs_data xlim c comp irlba true max_damp scale hz return_model fals argument itemmrs_datamr data filter itemxlimfrequ rang filter default unit hz chang ppm use scale argument itemcompsnumb lorentzian compon use model itemirlbaopt use irlba svd logic itemmax_dampmaximum allow damp factor itemscaleeith hz ppm set frequenc unit xlim itemreturn_modelbi default filter spectrum return set return_model true return hsvd model data valu filter data model depend return_model argument descript hsvd base signal filter describ barkhuijsen h de beer r van ormondt improv algorithm nonit timedomain model fit exponenti damp magnet reson signal j magn reson gener roxygen edit hand pleas edit document rmrs_data_procr nameshift aliasshift titleappli frequenc shift mr data usag shiftmrs_data shift unit ppm argument itemmrs_datamr data itemshiftfrequ shift ppm default itemunitsof shift ppm hz valu frequenc shift mr data descript appli frequenc shift mr data gener roxygen edit hand pleas edit document rfittingr namefit_amp aliasfit_amp titleextract fit amplitud object class codefit_result usag fit_amp x inc_index fals sort_nam fals append_common_h_comb true argument itemxcodefit_result object iteminc_indexinclud column voxel index itemsort_namessort basi set name alphabet itemappend_common_h_combappend commonli use h metabolit combin eg tnaa naa naag valu datafram amplitud descript extract fit amplitud object class codefit_result gener roxygen edit hand pleas edit document rspantr nameset_tqn_cmd aliasset_tqn_cmd titleset command run tarquin commandlin program usag set_tqn_cmdcmd argument itemcmdpath binari descript set command run tarquin commandlin program