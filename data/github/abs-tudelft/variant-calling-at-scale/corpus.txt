variant call scale variant call scale scalabl parallel effici implement next gener sequenc data preprocess variant call workflow design tightli integr preprocess workflow stage use spark builtin function sort read coordin mark duplic effici cluster scale deepvari cpuonli cpugpu cluster also integr workflow infraturctur approach use follow infraturctur x slurm base clusterhttpsgithubcomabstudelftsvcallblobmainreadmemdslurmbasedclust like cartesiushttpsuserinfosurfsaranlsystemscartesiusdescript dutch supercomput x googl gcp clusterhttpsgithubcomabstudelftsvcallblobmainreadmemdgooglegcpdataprocclust dataprochttpscloudgooglecomdataproc amazon aw cloud alibaba cloud microsoft azur method approach use follow purpos apach spark base cluster scale preprocess bwamem sort markdupl output multipl bam file base choromosom region apach spark base cluster scale variant call bwamem sort markdupl deepvariantoctopu output singl vcf apach spark base cluster scale preprocess bwamem sort markdupl bam merg output singl sortedmkdup bam file apach spark base cluster scale variant call deepvariantoctopu input sortedmkdup bam output singl vcf file align x bwamem bwamem bowti x minimap variant caller x deepvari x octopu strelka gatk haplotypecal freebay slurm base cluster apach arrow depend c librarieshttpsgithubcomapachearrowtreemastercpp c bind use glibhttpsgithubcomapachearrowtreemasterc_glib plasma object storehttpsgithubcomapachearrowtreemastercppsrcplasma sharedmemori blob store part c codebas python librarieshttpsgithubcomapachearrowtreemasterpython instal requir ubuntu apach spark singularityhttpssylabsiodoc contain configur build instal singularityhttpssylabsiodoc contain download singular scripthttpsgithubcomabstudelftarrowgentreemastersingular gener singular imag imag contain arrow relat packg necessari buildingcompil bwamem enter gener imag use command sudo singular shell image_namesimg googl gcp dataproc cluster follow step requir testrun workflow run variant call workflow creat custom oper system imag instal prerequisit applic use gcp dataproc cluster creat gcp dataproc cluster gcp filestor instanc dataproc cluster creation mount filestor node download refer queri giab benchmark truth dataset final step run differ part workflow gcp consol custom imag creation gcp dataproc cluster creat bucket insid gcp storagehttpsconsolecloudgooglecomstorag store custom imag like gsuserimag open httpsconsolecloudgooglecom use gcloud config set project project_id chang differ project insid cloud shell run git clone httpsgithubcomtahashmicustomimag cd customimag python generate_custom_imagepi imagenam bwacustom dataprocvers ubuntu customizationscript bwa_standalonesh zone asiaeasta gcsbucket gsuserimag shutdowninstancetimersec nosmoketest creat custom imag use googl gcp dataproc cluster instanc set gcp dataproc cluster master worker node sudo aptget updat sudo aptget instal nfscommon sudo mkdir p mntfs_share sudo mount fs_share mntfs_share sudo chmod gorw mntfs_share df h typenf node mkdir p mntfs_sharedrefer cd mntfs_sharedrefer download refer genom wget ftpftpncbinlmnihgovgenomesallgcagca__grchseqs_for_alignment_pipelinesucsc_idsgca__grch_no_alt_analysis_setfnagz gunzip gca__grch_no_alt_analysis_setfnagz mv gca__grch_no_alt_analysis_setfna grchfa wget ftpftpncbinlmnihgovgenomesallgcagca__grchseqs_for_alignment_pipelinesucsc_idsgca__grch_no_alt_analysis_setfnafai mv gca__grch_no_alt_analysis_setfnafai grchfafai download queri data mkdir p mntfs_sharedqueryerr cd mntfs_sharedqueryerr wget ftpftpgenomesebiacukvolftpphasedatanasequence_readerr_filtfastqgz gunzip err_filtfastqgz mv err_filtfastq err_fastq wget ftpftpgenomesebiacukvolftpphasedatanasequence_readerr_filtfastqgz gunzip err_filtfastqgz mv err_filtfastq err_fastq creat output dir mkdir p mntfs_sharedqueryerrarrow sudo chmod gorw mntfs_sharedqueryerrarrow cd mntfs_sharedqueryerr mkdir bam sudo chmod gorw bam cd mntfs_sharedqueryerrbam mkdir output sudo chmod gorw output cd mntfs_share download vcfmerg script httpsgistgithubcomtahashmiafdbacba wget httpsgistgithubcomtahashmiafdbacba sudo chmod x mntfs_sharedqueryerrvcfmergesh standalon preprocess cluster fastq data stream bwa everi cluster node bwa output pipe sambamba perform sort duplic remov option also avail enabl sort data pipe stage well final output samtool merg use produc singl bam output readi stream analysi dataproc cluster bwa align sambamba sort sambamba duplic remov option samtool merg bam custom imag need use dataproc cluster follow stepshttpsgithubcomabstudelftsvcallblobmainreadmemdcustomimagecreationongcpdataprocclust creat one creat networkattach storag system use googl comput engin instanc storag filestor give name like fs instanc idnam fsshare file share name creat perfrom follow stepshttpsgithubcomabstudelftsvcallblobmainreadmemdsettingupgcpdataprocclust make gcp dataproc cluster readi run workflow upload script file bucket run follow command gcp consol shell taha_ahmad_pk_cloudshel organicpoetri gcloud dataproc job submit pyspark regionuscentr clusterclust propertiessparkpysparkpythonusrbinpythonsparkpysparkdriverpythonusrbinpythonsparkexecutormemorygsparkdrivermemorygsparknumexecutorssparkexecutorcor gsbucket_taha_pkscriptsbwastandalonepi markdup ye ref mntfs_sharedreferencegrchfa path mntfs_sharedqueryerr node core align bwa singl node bwa align sambamba sort sambamba duplic remov option time bwa mem mntfs_sharedreferencegrchfa mntfs_sharedqueryerrerr_fastq mntfs_sharedqueryerrerr_fastq devstdout usrlocalbinsambambalinuxamdstat view f bam devstdin devstdout usrlocalbinsambambalinuxamdstat sort mntfs_sharedqueryerrbamserrbam devstdin time usrlocalbinsambambalinuxamdstat markdup r mntfs_sharedqueryerrbamserrbam mntfs_sharedqueryerrbamserr_mdbam variant caller support variant caller support region specif variant call integr workflow show use octopushttpsgithubcomluntergroupoctopu latest accuratefast variant caller use case demonstr feasibl integr variant caller approach download octopu singular contain gcp filestor cd mntfs_share sudo singular pull dockerdancookeoctopu repeat part run follow command insid gcp consol chang vcaller octopu gcloud dataproc job submit pyspark regionuscentr clusterclust propertiessparkpysparkpythonusrbinpythonsparkpysparkdriverpythonusrbinpythonsparkexecutormemorygsparkdrivermemorygsparknumexecutorssparkexecutorcor gsbucket_taha_pkscriptsbwapi part ref mntfs_sharedreferencegrchfa path mntfs_sharedqueryhg node core align bwa vcaller octopu repeat part merg vcf gener accuraci result use happi output like deepvari type filter truthtot truthtp truthfn querytot queryfp queryunk fpgt metricrecal metricprecis metricfrac_na metricf_scor truthtotaltitv_ratio querytotaltitv_ratio truthtotalhet_hom_ratio querytotalhet_hom_ratio indel nan nan indel pass nan nan snp snp pass octopu type filter truthtot truthtp truthfn querytot queryfp queryunk fpgt metricrecal metricprecis metricfrac_na metricf_scor truthtotaltitv_ratio querytotaltitv_ratio truthtotalhet_hom_ratio querytotalhet_hom_ratio indel nan nan indel pass nan nan snp snp pass