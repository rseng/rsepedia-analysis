omicwa celltypespecif diseas associ test bulk omic experi instal r order instal recent version installpackagesdevtool devtoolsinstall_githubfumigithubomicwa build_vignett true instal cran archiv possibl version older github installpackagesomicwa uninstal packag removepackagesomicwa usag libraryomicwa vignetteintro packag omicwa inform pleas cite takeuchi f kato n nonlinear ridg regress improv celltypespecif differenti express analysi bmc bioinformat httpsdoiorg titl introduct omicwa output rmarkdownhtml_vignett vignett vignetteindexentryintroduct omicwa vignetteengineknitrrmarkdown vignetteencodingutf r includ fals knitropts_chunkset collaps true comment instal r eval fals installpackagesdevtool devtoolsinstall_githubfumigithubomicwa encount depend error sva packag instal bioconductor r eval fals requirenamespacebiocmanag quietli true installpackagesbiocmanag biocmanagerinstallsva usag omicwa packag celltypespecif diseas associ test use bulk tissu data input packag accept dna methyl data epigenomewid associ studi ewa well gene express data differenti gene express analys main function ctassoc r setup libraryomicwa see descript r ctassoc analyz dna methyl let load sampl data r datagsesmal x gsesmallx w gsesmallw gsesmal yseq breviti c gsesmallc see descript r gsesmal convent way use ordinari linear regress r result ctassocx w c c test full resultcoeffici recommend nonlinear regress ridg regular dna methyl use logit function normal test option nlslogit r result ctassocx w c c test nlslogit regular true printresultcoeffici n first line show result cpg site cg line show basal methyl level cd actual cd cell plogi cell type methyl line show cdspecif effect diseas e logit scale sinc pvalu signific line show effect sexf femal compar male e small pvalu e sinc sexf covari uniform effect across cell type celltyp column na analyz gene express let load sampl data r datagtexsmal x gtexsmallx w gtexsmallw gtexsmal yseq breviti c gtexsmallc see descript r gtexsmal convent way use ordinari linear regress r result ctassocx w c c test full resultcoeffici recommend nonlinear regress ridg regular dna methyl use log function normal test option nlslog r result ctassocx w c c test nlslog regular true printresultcoeffici n first line show result transcript ensg line show basal express level granulocyt exp line show granulocytesspecif effect age e log scale sinc pvalu signific line show effect sexf femal compar male e pvalu sinc sexf covari uniform effect across cell type celltyp column na analyz mqtl qtl analys use ctcisqtl function instead ctassoc speed comput perform linear ridg regress thu statist test almost ident ctassoctest nlsident regular true analyz linear scale associ analysi perform row row x see descript r ctcisqtl let load sampl data r datagsesmal x gsesmallx xpo gsesmallxpo w gsesmallw gsesmal ypo gsesmallypo c gsesmallc x xseq breviti xpo xposseq yseq ypo yposseq see descript r gsesmal analyz mqtl r ctcisqtlx xpo w ypo c c result store file r head readtablefilepathtempdir ctcisqtlouttxt header true sep first line show result associ snp rs cpg site cg line show cdtspecif effect snp sinc pvalu signific gener roxygen edit hand pleas edit document rgsesmallr doctypedata namegsesmal aliasgsesmal titlesmal subset gse dataset geo format object class codelist length sourc hrefhttpswwwncbinlmnihgovgeoqueryacccgiaccgsegeo usag datagsesmal descript dataset includ sampl subset cpg site snp within chr select origin ewa dataset dna methyl measur cell estim proport cdt cdt nk cell save w exampl datagsesmal x gsesmallx xpo gsesmallxpo w gsesmallw gsesmal ypo gsesmallypo c gsesmallc x xseq breviti xpo xposseq yseq ypo yposseq ctcisqtlx xpo w ypo c c seealso ctcisqtl keyworddataset gener roxygen edit hand pleas edit document rgsesmallr doctypedata namegsesmal aliasgsesmal titlesmal subset gse dataset geo format object class codelist length sourc hrefhttpswwwncbinlmnihgovgeoqueryacccgiaccgsegeo usag datagsesmal descript dataset includ rheumatoid arthriti case control subset cpg site randomli select origin ewa dataset exampl datagsesmal x gsesmallx w gsesmallw gsesmal yseq breviti c gsesmallc result ctassocx w c c resultcoeffici seealso ctassoc keyworddataset gener roxygen edit hand pleas edit document rrrsr namerrsfit aliasrrsfit titlefit reducedrank ridg regress given rank shrinkag penalti usag rrsfiti x nrank minncoli ncolx lambda coefsvd fals argument itemya matrix respons n q itemxa matrix covari n p itemnrankan integ specifi desir rank itemlambdatung paramet ridg penalti itemcoefsvdlog indic need svd coeffient matrix int output valu coderrr object list consist itemcoefcoeffici rr itemcoeflscoeffici least squar itemfittedfit valu rr itemfittedlsfit valu least squar itemaright singular matrix itemadsigular valu vector itemnrankrank fit rrr descript fit reducedrank ridg regress given rank shrinkag penalti modif rrsfit rrpack version order handl extrem larg q ncoli gener q q matrix avoid exampl matrixrnorm x matrixrnorm rfit rrsfiti x refer mukherje zhu j reduc rank ridg regress kernal extens mukherje chen k wang n zhu j degre freedom reducedrank estim multivari regress emphbiometrika gener roxygen edit hand pleas edit document rgtexsmallr doctypedata namegtexsmal aliasgtexsmal titlesmal subset gtex dataset format object class codelist length sourc hrefhttpsgtexportalorggtex usag datagtexsmal descript dataset includ gene express measur whole blood sampl subset gene randomli select origin dataset exampl datagtexsmal x gtexsmallx w gtexsmallw gtexsmal yseq breviti c gtexsmallc result ctassocx w c c resultcoeffici seealso ctassoc keyworddataset gener roxygen edit hand pleas edit document rctcisqtlr namectcisqtl aliasctcisqtl titlecelltypespecif qtl analysi usag ctcisqtl x xpo w ypo c null maxposdiff e outdir tempdir outfil ctcisqtlouttxt argument itemxmatrix vector snp genotyp snp x sampl itemxposvector physic posit x itemwmatrix cell type composit sampl x cell type itemymatrix vector bulk omic measur marker x sampl itemyposvector physic posit itemcmatrix vector covari sampl x covari x xpo w ypo c numer itemmaxposdiffmaximum posit differ comput cisqtl associ analysi perform row x row within limit sinc limit posit function need run separ chromosom itemoutdiroutput directori itemoutfileoutput file valu estim statist pvalu written specifi file descript celltypespecif qtl analysi detail function analys qtl eqtl mqtl pqtl statist test almost ident codectassoctest nlsident regular true associ analysi perform row row x usual former methylationexpress marker latter snp cope larg number combin test limit pair whose posit within differ specifi codemaxposdiff ie limit cisqtl detail function perform linear ridg regress wherea codectassoctest nlsident regular true actual nonlinear regress eqnf ident normal transform order speed comput first paramet eqnalpha_h j eqngamma_j l fit ordinari linear regress assum eqnbeta_h j k next eqnbeta_h j k fit test linear ridg regress see document linkomicwasctassoc exampl donttest datagsesmal x gsesmallx xpo gsesmallxpo w gsesmallw gsesmal ypo gsesmallypo c gsesmallc x xseq breviti xpo xposseq ctcisqtlx xpo w ypo c c seealso ctassoc gener roxygen edit hand pleas edit document romicwasr namectassoc aliasctassoc titlecelltypespecif associ test usag ctassoc x w c null test full regular fals numcor chunksiz seed argument itemxmatrix vector trait sampl x trait itemwmatrix cell type composit sampl x cell type itemymatrix vector bulk omic measur marker x sampl itemcmatrix vector covari sampl x covari x w c numer itemteststatist test appli either codeful codemargin codenlsident codenlslog codenlslogit codepropdiffident codepropdifflog codepropdifflogit codereducedrankridg itemregularizewheth appli tikhonov ie ridg regular eqnbeta_h j k regular paramet chosen automat accord unbias version lawless wang effect codenl codepropdiff test itemnumcoresnumb cpu core use full margin propdiff test run serial thu numcor ignor itemchunksizeth size job cpu core one batch mani core limit memori memori failur decreas numcor andor chunksiz itemseedse random number gener valu list one element name coeffici element give estim statist pvalu tibbl format order transform estim eqnalpha_h j origin scale appli codeplog codetest nlslogit codeexp codetest nlslog estim eqnbeta_h j k codetest nlslog natur logarithm foldchang log numer converg fail codena return marker descript celltypespecif associ test detail let index eqnh cell type eqni sampl eqnj marker cpg site gene eqnk trait celltypespecif effect eqnl trait uniform effect across cell type input data eqnx_i k eqnc_i l eqnw_i h eqny_j eqnc_i l omit eqnx_i k eqnc_i l valu two type trait show effect celltypespecif respect thu call eqnx_i k eqnc_i l trait covari give rough idea strictli correct eqnw_i h repres cell type composit eqny_j repres marker level methyl gene express tissu sampl cell type proport eqnw_i h proport cell type bulk tissu measur imput beforehand marker level eqny_j bulk tissu measur provid input paramet estim celltypespecif trait effect eqnbeta_h j k tissueuniform trait effect eqngamma_j l basal marker level eqnalpha_h j cell type first describ convent linear regress model marker eqnj sampl eqni maker level specif cell type eqnh deqnalpha_h j sum_k beta_h j k x_i k repres valu rather mean model probabl distribut celltypespecif express bulk tissu marker level averag weight eqnw_i h deqnmu_j sum_h w_i h alpha_h j sum_k beta_h j k x_i k sum_l gamma_j l c_i l statist model deqny_j mu_j epsilon_j deqnepsilon_j n sigma_j error marker level noramlli distribut varianc eqnsigma_j independ among sampl codeful model linear regress deqny_j sum_h alpha_h j w_i h sum_h k beta_h j k w_i h x_i k sum_l gamma_j l c_i l error codemargin model test trait associ one cell type eqnh linear regress deqny_j sum_h alpha_h j w_i h sum_k beta_h j k w_i h x_i k sum_l gamma_j l c_i l error nonlinear model simultan analyz cell type composit linear scale differenti expressionmethyl loglogit scale normal function natur logarithm eqnf log gene express eqnf logit methyl convent linear regress formul defin eqnf ident function three model name codenlslog codenlslogit codenlsident denot invers function eqnf eqng eqng exp gene express eqng logist methyl mean normal marker level marker eqnj sampl eqni becom deqnmu_j fsum_h w_i h g alpha_h j sum_k beta_h j k x_i k sum_l gamma_j l c_i l statist model deqnfy_j mu_j epsilon_j deqnepsilon_j n sigma_j error marker level noramlli distribut varianc eqnsigma_j independ among sampl ridg regress aim cope multicollinear interact term eqnw_i h x_i k ridg regress fit minim residu sum squar rss plu eqnlambda sum_h k beta_h j k eqnlambda regular paramet propdiff test tri cope multicollinear roughli speak use meancent eqnw_i h obtain instead eqnbeta_h j k deviat eqnbeta_h j k averag across cell type accordingli null hypothesi chang origin null hypothesi eqnbeta_h j k null hypothesi center eqnbeta_h j k sum_i h w_i h beta_h j k sum_i h w_i h becom difficult detect signal major cell type eqnbeta_h j k would close averag across cell type test codepropdifflog codepropdifflogit includ addit preprocess step convert eqny_j eqnfy_j apart preprocess comput perform linear scale preprocess distort linear depend variabl center eqnw_i h actual think codepropdiffident better exampl donttest datagsesmal x gsesmallx w gsesmallw gsesmal c gsesmallc result ctassocx w c c resultcoeffici refer lawless j f wang p simul studi ridg regress estim commun statist theori method urlhttpsdoiorg seealso ctcisqtl