test environ local os x installx_ darwin r winbuild releas old releas develop r cmd check result error warn note downstream depend current downstream depend packag resubmiss resubmiss version address comment gregor seyer pleas start descript packag packag name titl similar done pleas alway write packag name softwar name api applic program interfac name singl quot titl descript eg cinmetr done refer describ method packag pleas add descript field descript file form author year doi author year arxiv author year isbn avail httpshttp space doi arxiv http angl bracket autolink want add titl well pleas put quot titl done pleas add small execut exampl rdfile illustr use export function also enabl automat test done cinmetr cinmetr r packag goal cinmetr packag provid differ method calcul chromosom instabl cin metric literatur appli cancer data set includ cancer genom atla titl cinmetr author vishal h oza date dec output rmarkdownhtml_vignett vignett vignetteindexentrycinmetr vignetteengineknitrrmarkdown vignetteencodingutf r includ fals knitropts_chunkset collaps true comment cinmetr goal cinmetr packag provid differ method calcul chromosom instabl cin metric literatur appli cancer data set includ cancer genom atla r setup librarycinmetr dataset provid cinmetr packag mask copi number variat data breast cancer uniqu sampl select randomli tcga r dimmaskcnv_brca altern download entir dataset tcga use tcgabiolink packag r run librarytcgabiolink querymaskcnvhgbrca gdcqueryproject tcgabrca datacategori copi number variat datatyp mask copi number segment legacyfals gdcdownloadqueri querymaskcnvhgbrca maskcnvbrca gdcpreparequeri querymaskcnvhgbrca summarizedexperi fals maskcnvbrca dataframemaskcnvbrca stringsasfactor fals taitest taicnvdata maskcnvbrca endnot run total aberr index tai calcul total aberr index tai baumbusch lo et alhttpswwwncbinlmnihgovpmcarticlespmc measur abund genom size copi number chang tumour defin weight sum segment mean bary_s_i biolog also interpret absolut deviat normal copi number state averag genom locat total aberr index frac sumr_i d_i cdot bary_s_i sumr_i d_i bary_s_i ge log_ r taitest taicnvdata maskcnv_brca headtaitest modifi total aberr index taimodifi calcul modifi total aberr index use sampl valu instead aberr copi number state thu remov direction score modifi total aberr index frac sumr_i d_i cdot bary_s_i sumr_i d_i r modifiedtaitest taimodifiedcnvdata maskcnv_brca headmodifiedtaitest copi number aberr cna calcul total number copi number aberr cna davidson jm et alhttpsjournalsplosorgplosonearticleidjournalpon defin segment copi number outsid predefin rang log_ le bary_s_i le log_ contigu adjac independ cna ident copi number purpos adapt rang bary_s_i ge log_ slightli larger origin metric similar number break point come caveat adjac segment need differ segment mean valu total copi number aberr sumr_i n_i beginalign bary_s_i ge log_ bary_s_i bary_s_i ge d_i ge endalign r cnatest cnacnvdata maskcnv_brca headcnatest count alter base segment countingbaseseg calcul number alter base defin sum length segment d_i absolut segment mean bary_s_i greater biolog valu thought quantifi numer chromosom instabl also simpler represent much genom alter run issu sequenc coverag affect fraction genom alter number alter base sumr_i d_i bary_s_i ge r basesegtest countingbasesegmentscnvdata maskcnv_brca headbasesegtest count number break point countingbreakpoint calcul number break point defin number segment n_i absolut segment mean greater doubl account break point biolog valu thought quantifi structur chromosom instabl number break point sumr_i n_i cdot bary_s_i ge r breakpointstest countingbreakpointscnvdata maskcnv_brca headbreakpointstest fraction genom alter fga calcul fraction genom alter fga chin sf et alhttpspubmedncbinlmnihgov measur take sum number base alter divid genom length cover g genom length cover calcul sum length probe affeymetrix array calcul exclud sex chromosom fraction genom alter frac sumr_i d_i g bary_s_i ge r fractiongenometest fgacnvdata maskcnv_brca headfractiongenometest cinmetr cinmetr calcul tai cna number alter base segment number break point fraction genom alter return singl data frame r cinmetricstest cinmetricscnvdata maskcnv_brca headcinmetricstest titl manuscript_figur author vishal oza date output html_document r librarycinmetr librarytcgabiolink librarytidyvers libraryggpubr librarycorrplot librarycomplexheatmap librarycircl librarycowplot librarygrid librarygridextra r download cnv brca data tcga prepar input data frame querymaskcnvhgbrca gdcqueryproject tcgabrca datacategori copi number variat datatyp mask copi number segment legacyfals gdcdownloadqueri querymaskcnvhgbrca maskcnvbrca gdcpreparequeri querymaskcnvhgbrca summarizedexperi true maskcnvbrca dataframemaskcnvbrca stringsasfactor fals r run cinmetr brca data frame cinmetricstest cinmetricscnvdata maskcnvbrca modtai taimodifiedcnvdata maskcnvbrca cinmetricstest inner_joincinmetricstest modtai csample_id copi true headcinmetricstest cinmetricsdata cinmetricstest pivot_longersample_id names_to cinmetr values_to valu separatesample_id cpatient type separatetyp ctumour cinmetricsdatatumour asnumericstr_removecinmetricsdatatumour cinmetricsdata cinmetricsdata mutatetyp case_whentumour tumour tumor tumour tumour normal r plot cinmetr calcul brca figur cinmetricsdata mutatevalu logvalu ggstripchart x cinmetr valu combin true merg true ylab xlab color type size fill type fontlabel c bold black shape type palett simpson alpha add mean_sd addparam listsiz alpha group type color black orient horiz order cfga base_seg break_point cna modified_tai tai posit position_jitterdodg fontxytext size color black face bold figur ggparfigur main cinmetr distribut brca ylab logmetr fontmain c bold black fonti c bold black fontx c bold black legend c legendtitl sampl type fontlegend c bold black ggexportfilenam figurepdf r calcul correl cinmetr plot heatmap cincorrdf cinmetricstest separatesample_id cpatient type separatetyp ctumour cincorrdftumour asnumericstr_removecincorrdftumour cincorrdf cincorrdf mutatetyp case_whentumour tumour tumor tumour tumour normal col_simpson colorrampc cfdb ffffff fd ht_optheatmap_column_names_gp gparfontfac bold fontsiz heatmap_row_names_gp gparfontfac bold fontsiz heatmap_column_title_gp gparfontfac bold fontsiz legend_bord black legend_labels_gp gparfontfac bold fontsiz heatmap_bord true normalheatmap cincorrdf filtertyp normal select cor method spearman heatmapnam rho col col_simpson column_titl normal sampl row_names_sid left show_row_dend true tumorheatmap cincorrdf filtertyp tumor select cor method spearman heatmapcol col_simpson show_heatmap_legend fals column_titl tumour sampl show_row_nam fals row_dend_sid right combinedheatmap normalheatmap tumorheatmap finalheatmap gridgrabexprdrawcombinedheatmap column_titl spearman correl cinmetr row_dend_sid right column_title_gp gparfontfac bold fontsiz plot save figur pdf format pdffigpdf width height open new pdf file plot_gridfigur finalheatmap nrow ncol align hv axi tb rel_width c label cab devoff close file plot save figur jpeg format jpegfigjpeg width height unit re open new pdf file plot_gridfigur finalheatmap nrow ncol align hv axi tb rel_width c label cab devoff close file gener roxygen edit hand pleas edit document rcin_metricsr namefga aliasfga titlefract genom alter usag fgacnvdata segmentmean numprob na genomes argument itemcnvdatadatafram contain follow column sampl start end num_prob segment_mean itemsegmentmeannumer valu minimum segment_mean cutoff threshold default itemnumprobesnumb probe itemgenomesizes genom deriv affymetrix array probe default calcul base hg exclud sex chromosom valu fraction genom alter descript fraction genom alter look fraction genom deviat diploid state fga calcul fraction genom alter fga chin sf et alhttpswwwncbinlmnihgovpubm measur take sum number base alter divid genom length cover g genom length cover calcul sum length probe affeymetrix array calcul exclud sex chromosom deqn fraction genom alter frac sumr_i d_i g bary_s_i ge exampl fgacnvdata maskcnv_brca gener roxygen edit hand pleas edit document rcin_metricsr namecna aliascna titlecopi number aberr usag cna cnvdata segmentmean log numprob na segmentdist minsegs argument itemcnvdatadatafram contain follow column sampl start end num_prob segment_mean itemsegmentmeannumer valu minimum segment_mean cutoff threshold default itemnumprobesnumb probe itemsegmentdistanceseg distanc threshold itemminsegsizeminimum segment size valu number copi number aberr segment descript calcul number copi number aberr detail copi number aberr cna hrefhttpsjournalsplosorgplosonearticleidjournalponedavidson jm et al defin segment copi number outsid predefin rang deqnlog_ le bary_s_i le log_ contigu adjac independ cna ident copi number purpos adapt rang deqnbary_s_i ge log_ slightli larger origin nearli ident countingbreakpoint except one calcul break adjac segment differ segment mean eqng deqntot copi number aberr sumr_i n_i bary_s_i ge log_ bary_s_i bary_s_i ge d_i ge exampl cnacnvdata maskcnv_brca seealso codelinkcountingbreakpoint gener roxygen edit hand pleas edit document rcin_metricsr namecinmetr aliascinmetr titlecinmetr usag cinmetr cnvdata segmentmean_tai segmentmean_cna log segmentmean_base_seg segmentmean_break_point segmentmean_fga numprob na segmentdistance_cna minsegsize_cna genomesize_fga argument itemcnvdatadatafram contain follow column sampl start end num_prob segment_mean itemsegmentmean_tainumer valu minimum segment_mean cutoff threshold total aberr index calcul default itemsegmentmean_cnanumer valu minimum segment_mean cutoff threshold copi number aberr calcul default itemsegmentmean_base_segmentsnumer valu minimum segment_mean cutoff threshold base segment calcul default itemsegmentmean_break_pointsnumer valu minimum segment_mean cutoff threshold break point calcul default itemsegmentmean_fganumer valu minimum segment_mean cutoff threshold fraction genom alter calcul default itemnumprobesnumb probe itemsegmentdistance_cnaseg distanc threshold itemminsegsize_cnaminimum segment size itemgenomesize_fgas genom deriv affymetrix array probe default calcul base hg exclud sex chromosom valu chromosom instabl metric descript calcul cinmetr given datafram exampl cinmetricscnvdata maskcnv_brca gener roxygen edit hand pleas edit document rcin_metricsr namecountingbreakpoint aliascountingbreakpoint titlecountingbreakpoint usag countingbreakpointscnvdata segmentmean numprob na argument itemcnvdatadatafram contain follow column sampl start end num_prob segment_mean itemsegmentmeannumer valu minimum segment_mean cutoff threshold default itemnumprobesnumb probe valu number break point uniqu sampl descript break point calcul take cnv data singl patient first filter segment mean specifi minimum number probe cover area count number row data multipli repres break point end segment deqn number break point sumr_i n_i cdot bary_s_i ge gener roxygen edit hand pleas edit document rcin_metricsr nametaimodifi aliastaimodifi titlemodifi total aberr index usag taimodifiedcnvdata segmentmean numprob na argument itemcnvdatadatafram contain follow column sampl start end num_prob segment_mean itemsegmentmeannumer valu minimum segment_mean cutoff threshold default itemnumprobesnumb probe valu averag length weight segment mean uniqu sampl descript modifi total aberr index calcul take sum length segment time segment mean sampl divid sum length sampl detail modifi total aberr index use sampl valu instead aberr copi number state thu remov direction score deqn modifi total aberr index frac sumr_i d_i cdot bary_s_i sumr_i d_i exampl taimodifiedcnvdata maskcnv_brca seealso codelinktai gener roxygen edit hand pleas edit document rcin_metricsr namecountingbaseseg aliascountingbaseseg titlecountingbaseseg usag countingbasesegmentscnvdata segmentmean numprob na argument itemcnvdatadatafram contain follow column sampl start end num_prob segment_mean itemsegmentmeannumer valu minimum segment_mean cutoff threshold default itemnumprobesnumb probe valu number base segment uniqu sampl descript function count alter base segment detail alter base segment calcul take cnv data singl patient first filter segment mean specifi minimum number probe cover area calcul sum length segment particular patient output deqn number alter base sumr_i d_i bary_s_i ge exampl countingbasesegmentscnvdata maskcnv_brca gener roxygen edit hand pleas edit document rcin_metricsr nametai aliastai titletot aberr index usag taicnvdata segmentmean numprob na argument itemcnvdatadatafram contain follow column sampl start end num_prob segment_mean itemsegmentmeannumer valu minimum segment_mean cutoff threshold default itemnumprobesnumb probe valu averag length weight segment mean uniqu sampl descript total aberr index calcul take sum length segment time segment mean sampl divid sum length sampl detail total aberr index tai hrefhttpswwwncbinlmnihgovpmcarticlespmcbaumbusch lo et al measur abund genom size copi number chang tumour defin weight sum segment mean deqn total aberr index frac sumr_i d_i cdot bary_s_i sumr_i d_i bary_s_i ge log_ exampl taicnvdata maskcnv_brca gener roxygen edit hand pleas edit document rdatar doctypedata namemaskcnv_brca aliasmaskcnv_brca titlebreast cancer data tcga data releas gdc product data releas date juli mask copi number variat data breast cancer uniqu sampl select randomli tcga format object class datafram sourc urlhttpsportalgdccancergov usag datamaskcnv_brca descript breast cancer data tcga data releas gdc product data releas date juli mask copi number variat data breast cancer uniqu sampl select randomli tcga exampl datamaskcnv_brca donttesttai taimaskcnv_brca refer koboldt fulton r mclellan et al natur urlhttpswwwnaturecomarticlesnatur keyworddataset