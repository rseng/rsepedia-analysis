titl maxsmooth deriv constrain function fit tag python astrophys cosmolog author name harri j bevin orcid affili affili name astrophys group cavendish laboratori jjthomson avenu cambridg cb unit kingdom index date juli bibliographi paperbib summari maxsmooth optimis routin written python support version geq fit deriv constrain function dcf data dcf famili function deriv cross zero band interest two special case dcf maxim smooth function msf deriv order geq constrain complet smooth function csf geq constrain altern constrain arbitrari set deriv refer model partial smooth function due constrain natur dcf produc perfectli smooth fit data reveal nonsmooth signal interest residu statement need develop maxsmooth motiv problem foreground model global cm experi edges_lb leda sara reach global cm cosmolog studi spin temperatur hydrogen ga rel magnitud compar cosmic microwav background cosmic dawn cd epoch reionis eor cd eor first star form properti hydrogen ga chang interact radiat star furlanetto pritchard barkana goal global cm experi detect structur sky averag radio spectrum nu mhz howev signal interest expect approxim leq mk mask foreground time brighter cohen cohen model remov foreground essenti detect global cm signal dcf provid power altern unconstrain polynomi accur model smooth synchrotronfreefre emiss foreground galaxi extragalact radio sourc illustr abil maxsmooth produc mock cm experi data model remov foreground use msf add mock foreground nu gaussian nois standard deviat k gaussian signal amplitud k central frequenc mhz standard deviat mhz figur show residu bottom panel green fit remov msf data top panel compar inject signal bottom panel red remov foreground directli recov inject signal rather smooth baselin subtract version see remnant signal residu see bevin detail exampl top panel mock cm data use illustr abil maxsmooth bottom panel residu green remov msf model cm foreground data show clear remnant signal red jointli fit msf signal model find accur recov signal see bevinsexamplepng maxsmooth applic experi signal interest separ compar high magnitud smooth signal foreground maxsmooth dcf fit routin basinhop basinhop neldermead neldermead practic cm cosmolog msfcd msfedg howev maxsmooth employ quadrat program via cvxopthttpspypiorgprojectcvxopt rapidli effici fit dcf constrain fracdmydxmgeq textnormalor fracdmydxmleq exampl dcf maxsmooth librari given sum_kn a_k xk x independ depend variabl respect n order fit power n librari intend extend futur contribut user find use quadrat program make maxsmooth approxim two order magnitud quicker basinhoppingneldermead approach maxsmooth rephras condit pm_m fracdmydxm leq pm appli given produc set sign space differ combin constrain posit neg deriv sign space associ minimum found use quadrat program maxsmooth identifi optimum combin sign mathbf summaris minimis problem min_asfracmathbfatmathbfqmathbfamathbfqtmathbfa mathrmstmathbfgsa leq mathbf minimis chi mathbfgsa stack matrix deriv evalu mathbfa matrix paramet optimis mathbfq mathbfq given mathbfq mathbfphitmathbfphitextnormaland mathbfqtmathbfytmathbfphi mathbfphi matrix basi function evalu mathbfi column matrix depend data discret space search entireti quickli effici sign navig algorithm invok use maxsmooth reduc fit time divis paramet space sign space allow complet explor compar basinhoppingneldermead base algorithm sign navig approach use cascad algorithm identifi candid optimum mathbf mathbfa algorithm start randomli gener mathbf individu sign flip lowest order deriv first object function decreas valu sign associ lower chi valu becom optimum set process repeat chi stop decreas follow limit explor neighbour sign space identifi true global minimum time taken fit polynomi data follow approxim xa power law use maxsmooth quadrat program method comparison method base basinhop neldermead routin show result use later method n method begin fail without adjust routin paramet n find maximum differ optimum maxsmooth chi valu basinhop result figur taken bevinstimespng document maxsmooth avail readthedocsmaxsmoothreadthedocsio code found githubhttpsgithubcomhtjbmaxsmooth code also pip instal pypihttpspypiorgprojectmaxsmooth continu integr perform travishttpstraviscicomgithubhtjbmaxsmooth circlecihttpscirclecicomghhtjbmaxsmooth associ code coverag found codecovhttpscodecovioghhtjbmaxsmooth acknowledg discuss applic softwar provid eloy de lera acedo handley anastasia fialkov author support scienc technolog facil council stfc via grant number stt refer