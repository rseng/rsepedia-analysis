robust backfit matia salibian robust backfit algorithm r packag rbf avail cran herehttpscranrprojectorgpackagerbf implement robust backfit algorithm propos boent martinez salibianbarrera boent g martinez salibianbarrera robust estim addit model use backfit journal nonparametr statist taylor franci doi httpsdoiorg paper softwar packag appear journal open sourc softwarehttpsjosstheojorg found doihttpsjosstheojorgpapersjossstatussvghttpsdoiorgjoss repositori contain develop version rbf may differ slightli one avail cran cran version updat appropri packag repositori instal within r use follow code assum devtoolshttpscranrprojectorgpackagedevtool packag avail r devtoolsinstall_githubmsalibianrbf exampl longish exampl rbf work use air qualiti data interest predict ozon term three explanatori variabl solarr wind temp r libraryrbf dataairqu pairsairqu cozon solarr wind temp pch colgray cex manfiguresintropng follow bandwidth obtain via robust leaveoneout crossvalid procedur describ paper robust predict error measur use mu sigma mu sigma mestim locat scale predict error respect code copi r bandwidth select leaveoneout crossvalid without outlier take long time comput approx minut run r intelr coretm cpu ghz cc completecasesairqu x asmatrix airqualitycc csolarr wind temp asvector airqualitycc ozon c h sdx h sdx h sdx hh expandgridh h h nh nrowhh rmspe repna nh jbest cvbest inf leaveoneout n nrowx fori nh leaveoneout cv loop pred repna n forj n tmp tri backfrobi x point xj window hhi epsilon e degre type tukey subset cj classtmp tryerror predsj rowsumstmppredict tmpalpha predr pred tmpre robstattmlocscalempredr narmtru rmspei tmpremu tmpredisp rmspei cvbest jbest cvbest rmspei printrecord printci rmspei bandw hhjbest set optim valu r bandw c use robust backfit algorithm fit addit model use tukey bisquar loss default tune constant loss function remov case miss entri r cc completecasesairqu fitful backfrobozon solarr wind temp dataairqu subsetcc windowsbandw degre typetukey display fit one per addit compon care axi limit store use later r limcl limrob matrix x fitfullxp forj fit fitfullalpha rowsumsfitfullgmatrixj limrobj cminr maxr plotr xj typep pch colgray xlabcolnamesxj ylab cex oo orderxj linesxooj fitfullgmatrixooj lwd colblu img srcmanfiguresshowfitspng width img srcmanfiguresshowfitspng width img srcmanfiguresshowfitspng width note plot could also obtain use plot method r plot compon plotfitful comput display classic backfit fit bandwidth chosen via leaveoneout cv r librarygam x aircomplet cozon solarr wind temp c hh expandgrida nh nrowhh jbest cvbest inf n nrowx fori nh fi rep n forj n tmp gamozon losolarr spanhhi lowind spanhhi lotemp spanhhi datax subsetcj fij asnumericpredicttmp newdataxj typerespons ss meanxozon fi ifss cvbest jbest cvbest ss printci ss hhjbest optim bandwidth solarr wind temp respect plot partial residu classic robust fit overlaid r aircomplet airqual completecasesairqu librarygam fitgam gamozon losolarr span lowind span lotemp span dataaircomplet plot fit robust classic x asmatrix aircomplet csolarr wind temp asvector aircomplet ozon fit predictfitgam typeterm alphagam attrfit constant forj fitfullyp fitfullalpha rowsumsfitfullgmatrixj plotr xj typep pch colgray xlabcolnamesxj ylab oo orderxj linesxooj fitfullgmatrixooj lwd colblu linesxooj fitsooj lwd colmagenta img srcmanfiguresclassicfitspng width img srcmanfiguresclassicfitspng width img srcmanfiguresclassicfitspng width identifi potenti outier look residu robust fit use function boxplot r rero residualsfitful ouro boxplotrero colgrayout inro lengthrero rero ouro pointsrep lengthinro reroinro pch cex colr manfiguresoutlierspng highlight suspici observ scatter plot r cs repgray nrowaircomplet csinro red os nrowaircomplet os cosinro osinro pairsaircompleteo cozon solarr wind temp pch colcso cex manfiguresshowoutspng partial residu plot r forj fitfullyp fitfullalpha rowsumsfitfullgmatrixj plotr xj typep pch colgray xlabcolnamesxj ylab pointsreinro xinroj pch colr cex oo orderxj linesxooj fitfullgmatrixooj lwd colblu linesxooj fitsooj lwd colmagenta img srcmanfiguresshowoutspng width img srcmanfiguresshowoutspng width img srcmanfiguresshowoutspng width comput classic backfit algorithm data without potenti outlier identifi robust fit optim smooth paramet nonrobust fit recomput use leaveoneout crossvalid clean data set note fit robust nonrobust almost ident r run classic backfit algorithm without outlier airclean aircompleteinro fitgam gamozon losolarr span lowind span lotemp span dataairclean fit predictfitgam typeterm alphagam attrfit constant dd aircompleteinro csolarr wind temp forj fitfullyp fitfullalpha rowsumsfitfullgmatrixj plotr xj typep pch colgray xlabcolnamesxj ylab pointsreinro xinroj pch colr cex oo orderddj linesddooj fitsooj lwd colmagenta oo orderxj linesxooj fitfullgmatrixooj lwd colblu img srcmanfiguresbothoncleanpng width img srcmanfiguresbothoncleanpng width img srcmanfiguresbothoncleanpng width final compar predict accuraci obtain fit interest predict well possibl outlier data evalu qualiti predict use trim mean squar predict error effect measur predict accuraci data use alphatrim mean squar function r tm functiona alpha alpha proport trim sorta nalastna n floor lengtha alpha return meanan narmtru use run fold cv compar trim mean squar predict error robust fit classic one note bandwidth kept fix optim valu estim r dd airqual dd ddcompletecasesdd cozon solarr wind temp run kfold cv fold k n nrowdd store trim tmspe robust gam also tmspero tmspegam vectornumer setse ii nk forrun tmpro tmpgam vectornumer n ii sampleii forj k fitful backfrobozon solarr wind temp pointddiij windowsbandw epsilon degre typetukey subset iij data dd tmpro ii j rowsumsfitfullpredict fitfullalpha fitgam gamozon losolarr span lowind span lotemp span dataddiij tmpgam ii j predictfitgam newdataddiij typerespons tmsperorun tm ddozon tmpro alpha tmspegamrun tm ddozon tmpgam alpha boxplot see robust fit consist fit vast major data better classic one r boxplottmspero tmspegam namescrobust classic colctomato gray main ylimc manfigurespredpng saniti check compar predict accuraci robust nonrobust fit use clean data set recomput optim bandwidth robust fit use leaveoneout cross valid note bandwidth kept fix use run fold crossvalid comput trim regular mean squar predict error fit r aq airqual aq aqcompletecasesaq cozon solarr wind temp airclean aq inro bandw c k n nrowairclean mspero mspegam tmspero tmspegam vectornumer setse ii nk forrun tmpro tmpgam vectornumer n ii sampleii forj k fitful tri backfrobozon solarr wind temp pointaircleaniij windowsbandw epsilon degre typetukey subset iij data airclean classfitful tryerror tmpro ii j rowsumsfitfullpredict fitfullalpha fitgam gamozon losolarr span lowind span lotemp span dataairclean subset iij tmpgam ii j predictfitgam newdataaircleaniij typerespons tmsperorun tm aircleanozon tmpro alpha msperorun mean aircleanozon tmpro narmtru tmspegamrun tm aircleanozon tmpgam alpha mspegamrun mean aircleanozon tmpgam narmtru boxplot trim regular mean squar predict error crossvalid run see major run estim provid similar predict error note natur expect robust method perform slightli wors classic one model deviat occur boxplot show robust backfit estim loss predict accuraci fact small r boxplottmspero tmspegam namescrobust classic colrepctomato gray maintrim mspe clean data boxplotmspero mspegam namescrobust classic colrepctomato gray mainnontrim mspe clean data img srcmanfiguresboxplotcleanpredictionspng width img srcmanfiguresboxplotcleanpredictionspng width rbf add vignett fix output method summari print add formula output print method fix problem predict argument point function backfcl updat readm file link joss paper titl robust backfit author matia salibian date r formatsysd output github_docu r setup includefals knitropts_chunksetecho true warningfals messagefals figwidth figheight figpath manfigur robust backfit algorithm r packag rbf avail cran herehttpscranrprojectorgpackagerbf implement robust backfit algorithm propos boent martinez salibianbarrera boent g martinez salibianbarrera robust estim addit model use backfit journal nonparametr statist taylor franci doi httpsdoiorg paper softwar packag appear journal open sourc softwarehttpsjosstheojorg found doihttpsjosstheojorgpapersjossstatussvghttpsdoiorgjoss repositori contain develop version rbf may differ slightli one avail cran cran version updat appropri packag repositori instal within r use follow code assum devtoolshttpscranrprojectorgpackagedevtool packag avail r devtoolsinstall_githubmsalibianrbf exampl longish exampl rbf work use air qualiti data interest predict ozon term three explanatori variabl solarr wind temp r intro libraryrbf dataairqu pairsairqu cozon solarr wind temp pch colgray cex follow bandwidth obtain via robust leaveoneout crossvalid procedur describ paper robust predict error measur use mu sigma mu sigma mestim locat scale predict error respect code copi r robustleaveoneout evalfals bandwidth select leaveoneout crossvalid without outlier take long time comput approx minut run r intelr coretm cpu ghz cc completecasesairqu x asmatrix airqualitycc csolarr wind temp asvector airqualitycc ozon c h sdx h sdx h sdx hh expandgridh h h nh nrowhh rmspe repna nh jbest cvbest inf leaveoneout n nrowx fori nh leaveoneout cv loop pred repna n forj n tmp tri backfrobi x point xj window hhi epsilon e degre type tukey subset cj classtmp tryerror predsj rowsumstmppredict tmpalpha predr pred tmpre robstattmlocscalempredr narmtru rmspei tmpremu tmpredisp rmspei cvbest jbest cvbest rmspei printrecord printci rmspei bandw hhjbest set optim valu r bandw bandw c use robust backfit algorithm fit addit model use tukey bisquar loss default tune constant loss function remov case miss entri r rbfone cc completecasesairqu fitful backfrobozon solarr wind temp dataairqu subsetcc windowsbandw degre typetukey display fit one per addit compon care axi limit store use later r showfit figshowhold outwidth limcl limrob matrix x fitfullxp forj fit fitfullalpha rowsumsfitfullgmatrixj limrobj cminr maxr plotr xj typep pch colgray xlabcolnamesxj ylab cex oo orderxj linesxooj fitfullgmatrixooj lwd colblu note plot could also obtain use plot method r plotmethod evalfals plot compon plotfitful comput display classic backfit fit bandwidth chosen via leaveoneout cv r gamloo evalfals librarygam x aircomplet cozon solarr wind temp c hh expandgrida nh nrowhh jbest cvbest inf n nrowx fori nh fi rep n forj n tmp gamozon losolarr spanhhi lowind spanhhi lotemp spanhhi datax subsetcj fij asnumericpredicttmp newdataxj typerespons ss meanxozon fi ifss cvbest jbest cvbest ss printci ss hhjbest optim bandwidth solarr wind temp respect plot partial residu classic robust fit overlaid r classicfit figshowhold outwidth aircomplet airqual completecasesairqu librarygam fitgam gamozon losolarr span lowind span lotemp span dataaircomplet plot fit robust classic x asmatrix aircomplet csolarr wind temp asvector aircomplet ozon fit predictfitgam typeterm alphagam attrfit constant forj fitfullyp fitfullalpha rowsumsfitfullgmatrixj plotr xj typep pch colgray xlabcolnamesxj ylab oo orderxj linesxooj fitfullgmatrixooj lwd colblu linesxooj fitsooj lwd colmagenta identifi potenti outier look residu robust fit use function boxplot r outlier figwidth figheight rero residualsfitful ouro boxplotrero colgrayout inro lengthrero rero ouro pointsrep lengthinro reroinro pch cex colr highlight suspici observ scatter plot r showout cs repgray nrowaircomplet csinro red os nrowaircomplet os cosinro osinro pairsaircompleteo cozon solarr wind temp pch colcso cex partial residu plot r showout figshowhold outwidth forj fitfullyp fitfullalpha rowsumsfitfullgmatrixj plotr xj typep pch colgray xlabcolnamesxj ylab pointsreinro xinroj pch colr cex oo orderxj linesxooj fitfullgmatrixooj lwd colblu linesxooj fitsooj lwd colmagenta comput classic backfit algorithm data without potenti outlier identifi robust fit optim smooth paramet nonrobust fit recomput use leaveoneout crossvalid clean data set note fit robust nonrobust almost ident r bothonclean figshowhold outwidth run classic backfit algorithm without outlier airclean aircompleteinro fitgam gamozon losolarr span lowind span lotemp span dataairclean fit predictfitgam typeterm alphagam attrfit constant dd aircompleteinro csolarr wind temp forj fitfullyp fitfullalpha rowsumsfitfullgmatrixj plotr xj typep pch colgray xlabcolnamesxj ylab pointsreinro xinroj pch colr cex oo orderddj linesddooj fitsooj lwd colmagenta oo orderxj linesxooj fitfullgmatrixooj lwd colblu final compar predict accuraci obtain fit interest predict well possibl outlier data evalu qualiti predict use trim mean squar predict error effect measur predict accuraci data use alphatrim mean squar function r pred tm functiona alpha alpha proport trim sorta nalastna n floor lengtha alpha return meanan narmtru use run fold cv compar trim mean squar predict error robust fit classic one note bandwidth kept fix optim valu estim r pred cachetru dd airqual dd ddcompletecasesdd cozon solarr wind temp run kfold cv fold k n nrowdd store trim tmspe robust gam also tmspero tmspegam vectornumer setse ii nk forrun tmpro tmpgam vectornumer n ii sampleii forj k fitful backfrobozon solarr wind temp pointddiij windowsbandw epsilon degre typetukey subset iij data dd tmpro ii j rowsumsfitfullpredict fitfullalpha fitgam gamozon losolarr span lowind span lotemp span dataddiij tmpgam ii j predictfitgam newdataddiij typerespons tmsperorun tm ddozon tmpro alpha tmspegamrun tm ddozon tmpgam alpha boxplot see robust fit consist fit vast major data better classic one r pred boxplottmspero tmspegam namescrobust classic colctomato gray main ylimc saniti check compar predict accuraci robust nonrobust fit use clean data set recomput optim bandwidth robust fit use leaveoneout cross valid note bandwidth kept fix use run fold crossvalid comput trim regular mean squar predict error fit r predclean cachetru aq airqual aq aqcompletecasesaq cozon solarr wind temp airclean aq inro bandw c k n nrowairclean mspero mspegam tmspero tmspegam vectornumer setse ii nk forrun tmpro tmpgam vectornumer n ii sampleii forj k fitful tri backfrobozon solarr wind temp pointaircleaniij windowsbandw epsilon degre typetukey subset iij data airclean classfitful tryerror tmpro ii j rowsumsfitfullpredict fitfullalpha fitgam gamozon losolarr span lowind span lotemp span dataairclean subset iij tmpgam ii j predictfitgam newdataaircleaniij typerespons tmsperorun tm aircleanozon tmpro alpha msperorun mean aircleanozon tmpro narmtru tmspegamrun tm aircleanozon tmpgam alpha mspegamrun mean aircleanozon tmpgam narmtru boxplot trim regular mean squar predict error crossvalid run see major run estim provid similar predict error note natur expect robust method perform slightli wors classic one model deviat occur boxplot show robust backfit estim loss predict accuraci fact small r boxplotcleanpredict figshowhold outwidth boxplottmspero tmspegam namescrobust classic colrepctomato gray maintrim mspe clean data boxplotmspero mspegam namescrobust classic colrepctomato gray mainnontrim mspe clean data titl exampl author martínez salibian date r sysdat output rmarkdownhtml_vignett vignett vignetteindexentryexampl vignetteengineknitrrmarkdown vignetteencodingutf r setup includefals knitropts_chunkset collaps true comment vignett vignett discuss properti robust backfit estim addit model illustr use packag rbf implement estim origin propos boent g martinez salibianbarrera see also martinez salibianbarrera analyz two data set first one show robust robust backfit estim small proport larg outlier present train set compar obtain standard backfit algorithm second exampl illustr robust estim interpret automat detect downweight potenti outlier train set also compar predict accuraci robust classic backfit algorithm robust estim addit model use backfit journal nonparametr statist taylor franci doi httpsdoiorg r packag rbf avail cran herehttpscranrprojectorgpackagerbf implement robust backfit algorithm propos boent martinez salibianbarrera repositori contain develop version rbf may differ slightli one avail cran cran version updat appropri packag repositori instal within r use follow code assum devtoolshttpscranrprojectorgpackagedevtool packag avail r devtoolsinstall_githubmsalibianrbf charg r session follow command r librari libraryrbf r packag download start see procedur work boston exampl consid wellknown boston hous price data harrinson rubinfeld dataset use exampl model addit model härdle et data avail mass packag contain n observ variabl measur censu district boston metropolitan area follow analysi härdle et use follow explanatori variabl crim per capita crime rate town x_ indu proport nonretail busi acr per town x_ nox nitric oxid concentr part per million x_ rm averag number room per dwell x_ age proport owneroccupi unit built prior x_ di weight distanc five boston employ center x_ tax fullvalu properti tax rate per x_ ptratio pupilteach ratio town x_ black bk bk proport peopl afrom american descent town x_ lstat percent lower statu popul x_ respons variabl medv median valu owneroccupi home usd propos addit model mu sum_j g_jlogx_j epsilon mu mathbbr g_j unknown smooth function epsilon random error first load data transform explanatori variabl requir model r read dataset databoston packagemass dd boston c dd namesdd medv log dd namesdd medv next load rbf packag r loadpckg libraryrbf robust backfit estim addit compon comput use robust kernelbas local polynomi regress model fit specifi use standard formula notat r also need specifi follow argument window bandwidth kernel estim degre degre polynomi use kernel local regress default type specifi robust loss function option huber tukey default huber kernelbas estim bandwidth select import step exampl follow härdle et al select bandwidth h_j le j le proport standard deviat correspond explanatori variabl logx_j specif set h_j hatsigma_j r bandwidth bandw applydd namesdd medv sd readi comput robust backfit estim r robustfit robustfit backfrobmedv data dd degre type huber window bandw inform fit obtain use summari method r summari summaryrobustfit note summari output includ robust version rsquar coeffici comput r_robfracsum_in rholefty_iwidehatawidehatsigmarightsum_in rholeftr_iwidehatsigmarightsum_in rholefty_iwidehatawidehatsigmaright rho loss function use mkernel smoother determin argument type call backfrob widehata robust locat estim model without explanatori variabl yaepsilon present r_iy_iwidehatmusum_jp widehatg_jx_ij rho loss function type argument plot method use visual estim addit compon hatg_j display correspond partial residu r_ijy_ihatmusum_kneq ihatg_kx_ik quad le le quad le j le r plot outwidth plotrobustfit default backfrob comput fit valu train set predict differ specif point desir pass point use argumen point exampl obtain predict valu point po given averag log transform explanatori variabl use follow command note step impli refit whole model r pred po colmeansdd namesdd medv robustfit backfrobmedv data dd degre type huber window bandw point po valu estim compon evalu correspond coordin po return predict element r showpr robustfitpredict order illustr behaviour robust fit outlier present data artif introduc atyp valu respons variabl r outlier dd dd ddmedv rep calcul robust estim use contamin data set note expect similar obtain origin train set r robustplotswithoutli robustfitnew backfrobmedv data dd degre type huber window bandw point po summaryrobustfitnew robustfitnewpredict output verifi predict point po fit similar magnitud outlier affect scale partial residu plot compar fit plot robust estim addit compon train origin contamin data set without includ partial residu green dash line robust estim comput origin data set blue solid line robust estim comput contamin data set see inde set estim addit compon similar r robustplot warningfals outwidth forj namex namesddj namey bquotepastehatgj oo orderddj plotddooj robustfitnewgmatrixooj typel lwd colblu lti xlabnamex ylabnamey linesddooj robustfitgmatrixooj lwd colgreen lti easi see use classic backfit estim fit obtain train set contain outlier dramat differ one obtain origin data set use packag gam comput standard backfit algorithm base local kernel regress smoother bandwidth use comput classic estim proport standard deviat explanatori variabl use slightli larger coeffici avoid numer issu local fit set h_j widehatsigma_j le j le r gam warningfals librarygam fitgam gammedv locrim span loindu span lonox span lorm span loag span lodi span lotax span loptratio span loblack span lolstat span datadd fit predictfitgam typeterm fitgamnew gammedv locrim span loindu span lonox span lorm span loag span lodi span lotax span loptratio span loblack span lolstat span datadd fitsnew predictfitgamnew typeterm plot standard backfit estim calcul origin boston data set shown orang dash line obtain contamin train set shown purpl solid line r gamplot outwidth forj oo orderddj namex namesddj namey bquotepastehatgj plotddooj fitsnewooj typel lwd colpurpl lti xlabnamex ylabnamey linesddooj fitsooj lwd coldarkorang lti airqual exampl airqual data set contain daili air qualiti measur new york region may septemb chamber et al interest model mean ozon lqlq mboxo_rqrq concentr function potenti explanatori variabl solar radianc frequenc band lqlq solarrrqrq wind speed lqlq windrqrq temperatur lqlq temprqrq focu complet entri data set r scatterplot outwidth dataairqu cc completecasesairqu aircomplet airqualitycc cozon solarr wind temp pairsaircomplet cozon solarr wind temp pch colgray scatter plot suggest relationship ozon variabl linear propos use addit regress model form beginequ labeleqozonemodel mboxozonemug_mboxsolarrg_mboxwindg_mboxtemp varepsilon endequ fit model use robust local linear kernel mestim tukey bisquar loss function choic set use argument degre typetukey call function backfrob model specifi standard formula notat r argument window vector bandwidth use kernel smoother estim optim valu use robust leaveoneout crossvalid approach see boent et al robust predict error measur use mu sigma mu sigma mestim locat scale predict error respect r robustcv warningfals evalfals libraryrbf bandwidth select leaveoneout crossvalid without outlier take long time comput approx minut run r intelr coretm cpu ghz c h sdaircomplet h sdaircomplet h sdaircomplet hh expandgridh h h nh nrowhh rmspe repna nh jbest cvbest inf n nrowaircomplet fori nh leaveoneout cv loop pred repna n forj n tmp tri backfrobozon solarr wind temp point aircompletej window hhi epsilon e data aircomplet degre type tukey subset cj classtmp tryerror predsj rowsumstmppredict tmpalpha tmpre robstattmlocscalempr aircompleteozon narmtru rmspei tmpremu tmpredisp rmspei cvbest jbest cvbest rmspei bandw hhjbest result bandwidth r bandw bandw c use robust backfit algorithm fit addit model use tukey bisquar loss default tune constant loss function optim bandwidth r fitful fitful backfrobozon solarr wind temp window bandw epsilon e degre type tukey subset cc data airqual visual explor estim addit function plot correspond partial residu use method plot r plotfitful outwidth plotfitful use r packag gam comput classic addit model estim model optim bandwidth calcul use leaveoneout crossvalid r gamcv warningfals evalfals librarygam c hh expandgrida nh nrowhh jbest cvbest inf n nrowaircomplet fori nh fi rep n forj n tmp gamozon losolarr spanhhi lowind spanhhi lotemp spanhhi data aircomplet subsetcj fij asnumericpredicttmp newdataaircompletej typerespons ss meanaircompleteozon fi ifss cvbest jbest cvbest ss hhjbest var var var optim bandwidth solarr wind temp respect use comput backfit estim r fitgam fitgam gamozon losolarr span lowind span lotemp span data aircomplet classic magenta dash line robust blue solid line fit shown follow plot togeth partial residu obtain robust fit r plotrobgam outwidth x asmatrix aircomplet csolarr wind temp asvector aircomplet ozon fit predictfitgam typeterm forj fitfullyp fitfullalpha rowsumsfitfullgmatrixj plotr xj typep pch colgray xlabcolnamesxj ylab oo orderxj linesxooj fitfullgmatrixooj lwd colblu lti linesxooj fitsooj lwd colmagenta lti two fit differ mainli estim effect wind speed temperatur classic estim g_mboxtemp consist lower robust counterpart mboxtemp ge wind speed nonrobust estim hatg_mboxwind suggest higher effect ozon concentr low wind speed one given robust estim opposit differ higher speed sinc residu robust fit gener use detect presenc atyp observ train data plot boxplot residu obtain robust fit possibl outli point indic red circl observ r boxplot outwidth rero residualsfitful ouro boxplotrero colgrayout inro lengthrero rero ouro pointsrep lengthinro reroinro pch colr inro highlight suspici observ scatter plot r scatterplotpoint outwidth cs repgray nrowaircomplet csinro red os nrowaircomplet os cosinro osinro pairsaircompleteo cozon solarr wind temp pch colcso note suspect atyp observ particularli extrem directli evid scatter plot howev show import effect estim compon addit model partial residu correspond point also visual red plot estim curv r plotoutr outwidth plot fit robust classic x asmatrix aircomplet csolarr wind temp asvector aircomplet ozon fit predictfitgam typeterm forj fitfullyp fitfullalpha rowsumsfitfullgmatrixj plotr xj typep pch colgray xlabcolnamesxj ylab pointsreinro xinroj pch colr oo orderxj linesxooj fitfullgmatrixooj lwd colblu lti linesxooj fitsooj lwd colmagenta lti investig whether differ robust nonrobust estim due outlier recomput classic fit remov ran similar leaveoneout crossvalid experi select span univari smoother r cvgamclean evalfals airclean aircompleteinro cozon solarr wind temp c hh expandgrida nh nrowhh jbest cvbest inf n nrowairclean fori nh fi rep n forj n tmp gamozon losolarr spanhhi lowind spanhhi lotemp spanhhi dataairclean subsetcj fij asnumericpredicttmp newdataaircleanj typerespons ss meanaircleanozon fi ifss cvbest jbest cvbest ss hhjbest var var var use optim bandwidth comput nonrobust fit r fitgam airclean aircompleteinro cozon solarr wind temp fitgam gamozon losolarr span lowind span lotemp span dataairclean follow plot show estim curv obtain classic estim use lqlq cleanrqrq data togeth robust one comput whole data set outlier highlight red r finalplot outwidth fit predictfitgam typeterm dd aircompleteinro csolarr wind temp forj fitfullyp fitfullalpha rowsumsfitfullgmatrixj plotr xj typep pch colgray xlabcolnamesxj ylab pointsreinro xinroj pch colr oo orderddj linesddooj fitsooj lwd colmagenta lti oo orderxj linesxooj fitfullgmatrixooj lwd colblu lti note fit close intuit interpret robust fit automat downweight potenti outlier produc estim similar classic one appli lqlq cleanrqrq observ predict comparison final compar predict accuraci obtain fit interest predict well possibl outlier data evalu qualiti predict use trim mean squar predict error effect measur predict accuraci data use alphatrim mean squar function r pred tm functiona alpha alpha proport trim sorta nalastna n floor lengtha alpha return meanan narmtru use run fold cv compar trim mean squar predict error robust fit classic one note bandwidth kept fix optim valu estim r pred warningfals evalfals dd airqual dd ddcompletecasesdd cozon solarr wind temp run kfold cv fold k n nrowdd store trim tmspe robust gam also tmspero tmspegam vectornumer setse ii nk forrun tmpro tmpgam vectornumer n ii sampleii forj k fitful backfrobozon solarr wind temp pointddiij window bandw epsilon e degre type tukey subset iij data dd tmpro ii j rowsumsfitfullpredict fitfullalpha fitgam gamozon losolarr span lowind span lotemp span data ddiij tmpgam ii j predictfitgam newdataddiij typerespons tmsperorun tm ddozon tmpro alpha tmspegamrun tm ddozon tmpgam alpha boxplot see robust fit consist fit vast major data better classic one boxplot predict error labelfigpredpredpng width saniti check compar predict accuraci robust nonrobust fit use clean data set recomput optim bandwidth robust fit use leaveoneout cross valid note bandwidth kept fix use run fold crossvalid comput trim regular mean squar predict error fit r predclean cachetru warningfals evalfals aq airqual aq aqcompletecasesaq cozon solarr wind temp airclean aq inro bandw c k n nrowairclean mspero mspegam tmspero tmspegam vectornumer setse ii nk forrun tmpro tmpgam vectornumer n ii sampleii forj k fitful tri backfrobozon solarr wind temp pointaircleaniij window bandw epsilon e degre type tukey subset iij data airclean classfitful tryerror tmpro ii j rowsumsfitfullpredict fitfullalpha fitgam gamozon losolarr span lowind span lotemp span data airclean subset iij tmpgam ii j predictfitgam newdataaircleaniij typerespons tmsperorun tm aircleanozon tmpro alpha msperorun mean aircleanozon tmpro narmtru tmspegamrun tm aircleanozon tmpgam alpha mspegamrun mean aircleanozon tmpgam narmtru boxplot trim regular mean squar predict error crossvalid run see major run estim provid similar predict error note natur expect robust method perform slightli wors classic one model deviat occur boxplot show robust backfit estim loss predict accuraci fact small trim mspe lqlq cleanrqrq data labelfigtmspecleantmspecleanpng width nontrim mspe lqlq cleanrqrq data labelfignontmspecleannontmspecleanpng width bibliographi boent g martinez salibianbarrera robust estim addit model use backfit journal nonparametr statist doi httpsdoiorg chamber j cleveland w kleiner b tukey graphic method data analysi nd edit chapman hall doi httpsdoiorg härdle w müller sperlich werwatz nonparametr semiparametr model springer doi httpsdoiorg harrinson rubinfeld l hedon price demand clean air j environ econom manag doi httpsdoiorg martinez salibianbarrera rbf r packag comput robust backfit estim addit model journal open sourc softwar doi josshttpsdoiorgjoss gener roxygen edit hand pleas edit document rrbffnr namebackfcl aliasbackfcl titleclass backfit usag backfcl formula data subset point null window epsilon e degre prob null maxit argument itemformulaan object class codeformula one coerc class symbol descript model fit itemdataan option data frame list environ object coercibl linkasdatafram data frame contain variabl model found codedata variabl taken codeenvironmentformula typic environ function call itemsubsetan option vector specifi subset observ use fit process itempointmatrix point predict comput return itemwindowsvector bandwidth local polynomi smoother one per explanatori variabl itemepsilonconverg criterion maximum allow rel differ consecut estim itemdegreedegre local polynomi smoother default code local constant itemprobvector probabl observ respons length n default codenul case ignor itemmaxitmaximum number iter algorithm valu list follow compon itemalphaestim intercept itemgmatrix matrix estim addit compon n p itempredict matrix estim addit compon point list argument codepoint descript function comput standard backfit algorithm addit model detail function comput standard backfit algorithm addit model use squar loss function local polynomi smoother exampl dataairqu tmp backfclozon solarr wind temp dataairqu subsetcompletecasesairqu windowsc degre refer hasi tj tibshirani rj gener addit model chapman hall london author matia salibianbarrera emailmatiasstatubcca alejandra martinez gener roxygen edit hand pleas edit document rrbffnr namesummarybackf aliassummarybackf aliassummarybackfcl aliassummarybackfrob titlesummari addit model fit use backfit usag methodsummarybackfobject argument itemobjectan object class codebackf result call codelinkbackfcl codelinkbackfrob itemaddit argument current ignor descript summari method class codebackf detail function return estim intercept also fivenumb summari mean residu classic robust estim classic estim also return rsquar robust estim return robust version rsquar estim residu standard error author alejandra merced martinez emailale_m_martinezhotmailcom gener roxygen edit hand pleas edit document rrbffnr nameformulabackf aliasformulabackf titleaddit model formula usag methodformulabackfx argument itemxan object class codebackf result call codelinkbackfcl codelinkbackfrob itemaddit argument current ignor valu model formula descript descript addit model formula extract object class codebackf author alejandra merced martinez emailale_m_martinezhotmailcom gener roxygen edit hand pleas edit document rrbffnr namepredictbackf aliaspredictbackf titlefit valu object class codebackf usag methodpredictbackfobject argument itemobjectan object class codebackf result call codelinkbackfcl codelinkbackfrob itemaddit argument current ignor valu vector fit valu descript function return fit valu given covari origin sampl addit model use classic robust backfit approach comput codelinkbackfcl codelinkbackfrob author alejandra merced martinez emailale_m_martinezhotmailcom gener roxygen edit hand pleas edit document rrbffnr namefittedvaluesbackf aliasfittedvaluesbackf titlefit valu object class codebackf usag fittedvaluesbackfobject argument itemobjectan object class codebackf result call codelinkbackfcl codelinkbackfrob itemaddit argument current ignor valu vector fit valu descript function return fit valu given covari origin sampl addit model use classic robust margin integr procedur estim comput codebackfcl codebackfrob author alejandra merced martinez emailale_m_martinezhotmailcom gener roxygen edit hand pleas edit document rrbffnr nameresidualsbackf aliasresidualsbackf titleresidu object class codebackf usag methodresidualsbackfobject argument itemobjectan object class codebackf result call codelinkbackfcl codelinkbackfrob itemaddit argument current ignor valu vector residu descript function return residu fit addit model use classic robust backfit estim comput codelinkbackfcl codelinkbackfrob author alejandra merced martinez emailale_m_martinezhotmailcom gener roxygen edit hand pleas edit document rrbffnr namepsihub aliaspsihub titlederiv huber loss function usag psihuberr k argument itemra vector real number itemka posit tune constant valu vector length codex descript function evalu first deriv huber loss function detail function evalu first deriv huber loss function exampl x seq length psihuberrx k author matia salibianbarrera emailmatiasstatubcca alejandra martinez gener roxygen edit hand pleas edit document rrbffnr namebackfrob aliasbackfrob titlerobust backfit usag backfrob formula data subset window point null epsilon e degre sigmahat null prob null maxit kh kt type huber argument itemformulaan object class codeformula one coerc class symbol descript model fit itemdataan option data frame list environ object coercibl linkasdatafram data frame contain variabl model found codedata variabl taken codeenvironmentformula typic environ function call itemsubsetan option vector specifi subset observ use fit process itemwindowsvector bandwidth local polynomi smoother one per explanatori variabl itempointmatrix point predict comput return itemepsilonconverg criterion maximum allow rel differ consecut estim itemdegreedegre local polynomi smoother default code local constant itemsigmahatestim residu standard error codenul default use linkmad residu obtain local median itemprobvector probabl observ respons length n default codenul case ignor itemmaxitmaximum number iter algorithm itemkhtun constant hubertyp loss function itemkttun constant tukeytyp loss function itemtypeon either codetukey codehub valu list follow compon itemalphaestim intercept itemgmatrix matrix estim addit compon n p itempredict matrix estim addit compon point list argument codepoint itemsigmahat estim residu standard error descript function comput robust backfit algorithm addit model detail function comput robust backfit algorithm addit model use robust local polynomi smoother exampl dataairqu tmp backfrobozon solarr wind temp dataairqu subsetcompletecasesairqu windowsc degre refer boent g martinez salibianbarrera robust estim addit model use backfit journal nonparametr statist httpsdoiorg author matia salibianbarrera emailmatiasstatubcca alejandra martinez namerbfpackag aliasrbfpackag aliasrbf doctypepackag titl robust backfit algorithm addit model descript robust backfit algorithm addit model detail tabularl packag tab rbfcr type tab packagecr version tab cr date tab cr licens tab gpl cr author matia salibianbarrera alejandra martinez maintain matia salibianbarrera matiasstatubcca refer boent g martinez salibianbarrera robust estim addit model use backfit journal nonparametr statist httpsdoiorg keyword robust backfit gener roxygen edit hand pleas edit document rrbffnr nameplotbackf aliasplotbackf titlediagnost plot object class codebackf usag methodplotbackfx ask fals np argument itemxan object class codebackf result call codelinkbackfcl codelinkbackfrob itemasklog valu codetru graphic devic prompt confirm go next pagescreen output itemwhichvector indic explanatori variabl partial residu plot generaetd default avail explanatori variabl itemaddit argument current ignor descript plot method object class codebackf exampl tmp backfrobozon solarr wind temp dataairqu subsetcompletecasesairqu windowsc degre plottmp author alejandra merced martinez emailale_m_martinezhotmailcom gener roxygen edit hand pleas edit document rrbffnr namepsitukey aliaspsitukey titlederiv tukey bisquar loss function usag psitukeyr k argument itemra vector real number itemka posit tune constant valu vector length codex descript function evalu first deriv tukey bisquar loss function detail function evalu first deriv tukey bisquar loss function exampl x seq length psitukeyrx k author matia salibianbarrera emailmatiasstatubcca alejandra martinez gener roxygen edit hand pleas edit document rrbffnr namedeviancebackf aliasdeviancebackf titledevi object class codebackf usag methoddeviancebackfobject argument itemobjectan object class codebackf result call codelinkbackfcl codelinkbackfrob itemaddit argument current ignor valu real number descript function return devianc fit addit model use one three classic robust margin integr estim comput codelinkbackfcl codelinkbackfrob author alejandra merced martinez emailale_m_martinezhotmailcom gener roxygen edit hand pleas edit document rrbffnr nameprintbackf aliasprintbackf titleprint margin integr procedur usag methodprintbackfx argument itemxan object class codebackf result call codelinkbackfcl codelinkbackfrob itemaddit argument current ignor valu real number descript default print method codebackf object author alejandra merced martinez emailale_m_martinezhotmailcom gener roxygen edit hand pleas edit document rrbffnr namekepan aliaskepan titleepanechnikov kernel usag kepanx argument itemxa vector real number valu vector length codex entri code x codex otherwis descript function evalu epanechnikov kernel detail function evalu epanechnikov kernel exampl x seq length kepanx author matia salibianbarrera emailmatiasstatubcca alejandra martinez