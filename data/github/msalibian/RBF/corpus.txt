robust backfit matia salibian robust backfit algorithm r packag rbf avail cran herehttpscranrprojectorgpackagerbf implement robust backfit algorithm propos boent martinez salibianbarrera boent g martinez salibianbarrera robust estim addit model use backfit journal nonparametr statist taylor franci doi httpsdoiorg paper softwar packag appear journal open sourc softwarehttpsjosstheojorg found doihttpsjosstheojorgpapersjossstatussvghttpsdoiorgjoss repositori contain develop version rbf may differ slightli one avail cran cran version updat appropri packag repositori instal within r use follow code assum devtoolshttpscranrprojectorgpackagedevtool packag avail r devtoolsinstall_githubmsalibianrbf exampl longish exampl rbf work use air qualiti data interest predict ozon term three explanatori variabl solarr wind temp r libraryrbf dataairqu pairsairqu cozon solarr wind temp pch colgray cex manfiguresintropng follow bandwidth obtain via robust leaveoneout crossvalid procedur describ paper robust predict error measur use mu sigma mu sigma mestim locat scale predict error respect code copi r bandwidth select leaveoneout crossvalid without outlier take long time comput approx minut run r intelr coretm cpu ghz cc completecasesairqu x asmatrix airqualitycc csolarr wind temp asvector airqualitycc ozon c h sdx h sdx h sdx hh expandgridh h h nh nrowhh rmspe repna nh jbest cvbest inf leaveoneout n nrowx fori nh leaveoneout cv loop pred repna n forj n tmp tri backfrobi x point xj window hhi epsilon e degre type tukey subset cj classtmp tryerror predsj rowsumstmppredict tmpalpha predr pred tmpre robstattmlocscalempredr narmtru rmspei tmpremu tmpredisp rmspei cvbest jbest cvbest rmspei printrecord printci rmspei bandw hhjbest set optim valu r bandw c use robust backfit algorithm fit addit model use tukey bisquar loss default tune constant loss function remov case miss entri r cc completecasesairqu fitful backfrobozon solarr wind temp dataairqu subsetcc windowsbandw degre typetukey display fit one per addit compon care axi limit store use later r limcl limrob matrix x fitfullxp forj fit fitfullalpha rowsumsfitfullgmatrixj limrobj cminr maxr plotr xj typep pch colgray xlabcolnamesxj ylab cex oo orderxj linesxooj fitfullgmatrixooj lwd colblu img srcmanfiguresshowfitspng width img srcmanfiguresshowfitspng width img srcmanfiguresshowfitspng width note plot could also obtain use plot method r plot compon plotfitful comput display classic backfit fit bandwidth chosen via leaveoneout cv r librarygam x aircomplet cozon solarr wind temp c hh expandgrida nh nrowhh jbest cvbest inf n nrowx fori nh fi rep n forj n tmp gamozon losolarr spanhhi lowind spanhhi lotemp spanhhi datax subsetcj fij asnumericpredicttmp newdataxj typerespons ss meanxozon fi ifss cvbest jbest cvbest ss printci ss hhjbest optim bandwidth solarr wind temp respect plot partial residu classic robust fit overlaid r aircomplet airqual completecasesairqu librarygam fitgam gamozon losolarr span lowind span lotemp span dataaircomplet plot fit robust classic x asmatrix aircomplet csolarr wind temp asvector aircomplet ozon fit predictfitgam typeterm alphagam attrfit constant forj fitfullyp fitfullalpha rowsumsfitfullgmatrixj plotr xj typep pch colgray xlabcolnamesxj ylab oo orderxj linesxooj fitfullgmatrixooj lwd colblu linesxooj fitsooj lwd colmagenta img srcmanfiguresclassicfitspng width img srcmanfiguresclassicfitspng width img srcmanfiguresclassicfitspng width identifi potenti outier look residu robust fit use function boxplot r rero residualsfitful ouro boxplotrero colgrayout inro lengthrero rero ouro pointsrep lengthinro reroinro pch cex colr manfiguresoutlierspng highlight suspici observ scatter plot r cs repgray nrowaircomplet csinro red os nrowaircomplet os cosinro osinro pairsaircompleteo cozon solarr wind temp pch colcso cex manfiguresshowoutspng partial residu plot r forj fitfullyp fitfullalpha rowsumsfitfullgmatrixj plotr xj typep pch colgray xlabcolnamesxj ylab pointsreinro xinroj pch colr cex oo orderxj linesxooj fitfullgmatrixooj lwd colblu linesxooj fitsooj lwd colmagenta img srcmanfiguresshowoutspng width img srcmanfiguresshowoutspng width img srcmanfiguresshowoutspng width comput classic backfit algorithm data without potenti outlier identifi robust fit optim smooth paramet nonrobust fit recomput use leaveoneout crossvalid clean data set note fit robust nonrobust almost ident r run classic backfit algorithm without outlier airclean aircompleteinro fitgam gamozon losolarr span lowind span lotemp span dataairclean fit predictfitgam typeterm alphagam attrfit constant dd aircompleteinro csolarr wind temp forj fitfullyp fitfullalpha rowsumsfitfullgmatrixj plotr xj typep pch colgray xlabcolnamesxj ylab pointsreinro xinroj pch colr cex oo orderddj linesddooj fitsooj lwd colmagenta oo orderxj linesxooj fitfullgmatrixooj lwd colblu img srcmanfiguresbothoncleanpng width img srcmanfiguresbothoncleanpng width img srcmanfiguresbothoncleanpng width final compar predict accuraci obtain fit interest predict well possibl outlier data evalu qualiti predict use trim mean squar predict error effect measur predict accuraci data use alphatrim mean squar function r tm functiona alpha alpha proport trim sorta nalastna n floor lengtha alpha return meanan narmtru use run fold cv compar trim mean squar predict error robust fit classic one note bandwidth kept fix optim valu estim r dd airqual dd ddcompletecasesdd cozon solarr wind temp run kfold cv fold k n nrowdd store trim tmspe robust gam also tmspero tmspegam vectornumer setse ii nk forrun tmpro tmpgam vectornumer n ii sampleii forj k fitful backfrobozon solarr wind temp pointddiij windowsbandw epsilon degre typetukey subset iij data dd tmpro ii j rowsumsfitfullpredict fitfullalpha fitgam gamozon losolarr span lowind span lotemp span dataddiij tmpgam ii j predictfitgam newdataddiij typerespons tmsperorun tm ddozon tmpro alpha tmspegamrun tm ddozon tmpgam alpha boxplot see robust fit consist fit vast major data better classic one r boxplottmspero tmspegam namescrobust classic colctomato gray main ylimc manfigurespredpng saniti check compar predict accuraci robust nonrobust fit use clean data set recomput optim bandwidth robust fit use leaveoneout cross valid note bandwidth kept fix use run fold crossvalid comput trim regular mean squar predict error fit r aq airqual aq aqcompletecasesaq cozon solarr wind temp airclean aq inro bandw c k n nrowairclean mspero mspegam tmspero tmspegam vectornumer setse ii nk forrun tmpro tmpgam vectornumer n ii sampleii forj k fitful tri backfrobozon solarr wind temp pointaircleaniij windowsbandw epsilon degre typetukey subset iij data airclean classfitful tryerror tmpro ii j rowsumsfitfullpredict fitfullalpha fitgam gamozon losolarr span lowind span lotemp span dataairclean subset iij tmpgam ii j predictfitgam newdataaircleaniij typerespons tmsperorun tm aircleanozon tmpro alpha msperorun mean aircleanozon tmpro narmtru tmspegamrun tm aircleanozon tmpgam alpha mspegamrun mean aircleanozon tmpgam narmtru boxplot trim regular mean squar predict error crossvalid run see major run estim provid similar predict error note natur expect robust method perform slightli wors classic one model deviat occur boxplot show robust backfit estim loss predict accuraci fact small r boxplottmspero tmspegam namescrobust classic colrepctomato gray maintrim mspe clean data boxplotmspero mspegam namescrobust classic colrepctomato gray mainnontrim mspe clean data img srcmanfiguresboxplotcleanpredictionspng width img srcmanfiguresboxplotcleanpredictionspng width rbf add vignett fix output method summari print add formula output print method fix problem predict argument point function backfcl updat readm file link joss paper