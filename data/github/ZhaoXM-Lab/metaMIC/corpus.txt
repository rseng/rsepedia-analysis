metam referencefre misassembl identif correct metagenom assembl metam fulli autom tool identifi correct misassembl metagenom assembl follow three step firstli metam extract variou type featur align pairedend sequenc read assembl contig secondli featur extract first step use input random forest classifi identifi misassembl metagenom assembl thirdli metam local misassembl breakpoint misassembl contig correct misassembl split part breakpoint requir instal make sure depend instal access path prepar depend python httpswwwpythonorgdownload pandashttpspandaspydataorg numpyhttpsnumpyorg pysamhttpspypiorgprojectpysam biopythonhttpspypiorgprojectbiopython bwa httpssourceforgenetprojectsbiobwafil samtool httpssourceforgenetprojectssamtoolsfilessamtool jellyfishhttpwwwcbcbumdedusoftwarejellyfish scikitlearnhttpsscikitlearnorgst scipyhttpswwwscipyorg instal python modul panda numpi pysam conda instal c bioconda panda numpi pysam biopython pip instal pysam panda numpi biopython download instal samtool bwa jellyfish conda instal c bioconda samtool bwa jellyfish wget httpsgithubcomsamtoolssamtoolsreleasesdownloadsamtoolstarbz tar jxvf samtoolstarbz cd samtool configur make make instal export pathpwdpath wget httpssourceforgenetprojectsbiobwafileslatestdownloadbwatarbz tar jxvf bwatarbz cd bwa make export pathpwdpath wget httpwwwcbcbumdedusoftwarejellyfishjellyfishtargz tar zxvf jellyfishtargz cd jellyfish configur make make instal export pathpwdbinpath instal instal metam via git git clone httpsgithubcomzhaoxmlabmetamicgit instal download train modelshttpszenodoorgrecordykm_omyzzti cd metam python setuppi instal metam h download model metam download_model quick start first map pairedend read assembl contig bwa index contig_fil bwa mem contig_fil read read samtool view h q f b samtool sort bam_fil gener pileup file samtool mpileup c f contig_fil bam_fil awk n pileup_fil run metam metagenom step extract featur output file feature_matrixwindow_fea_matrixtxtfeature_matrixcontig_fea_matrixtxt metam extract_featur bam bam_fil c contig_fil output_dir pileup pileup_fil meta step misassembl breakpoint identif correct output directori must output_dir output file metamic_corrected_contigsfa misassembly_breakpointtxt anomaly_scoretxt metam predict c contig_fil output_dir megahit meta isol genom step extract featur output file feature_matrixwindow_fea_matrixtxt metam extract_featur bam bam_fil c contig_fil output_dir pileup pileup_fil singl step misassembl breakpoint identif correct output directori must output_dir output file metamic_corrected_contigsfa misassembly_breakpointtxt anomaly_scoretxt metam predict c contig_fil output_dir singl train new dataset want gener new train model novel dataset contig label name new train model provid step contig_fea_matrixtxt use train dataset step extract featur output file feature_matrixwindow_fea_matrixtxtfeature_matrixcontig_fea_matrixtxt metam extract_featur bam bam_fil c contig_fil output_dir pileup pileup_fil meta step gener new train model output directori must output_dir format contig_label file contigt contigt contigt contigt metam train output_dir new_model_nam label contig_label detail usag metam read docshttp exampl exampl data rsphaeroides_pileupout rsphaeroidesbam velvet_ctgfasta cd exampl sh downloadsh metam extract_featur pileup rsphaeroides_pileupout bam rsphaeroidesbam c velvet_ctgfasta singl test metam predict c velvet_ctgfasta test singl output output folder contain misassembl score contig metamic_contig_scoretxt metagenom predict misassembl breakpoint misassembl contig misassembly_breakpointtxt anomali score posit contig anomaly_scoretxt fasta file correct contig metamic_corrected_contigsfa intermedi file detail output read docshttp complet option list metam usag metam h referencefre misassembl identif correct metagenom assembl option argument h help show help messag exit metam subcommand extract_featur extract featur input predict predict train train model usag metam extract_featur h thread bam bamfil r read r read p read c assembl output pileup pileup mode l min_length samtool samtool jellyfish jellyfish option argument h help show help messag exit thread thread thread maximum number thread default bam bamfil index bam file align r read read r read read p read r read smart pair ignor fastaq c assembl contig assembl fasta file assembl contig output output output output directori metam result pileup pileup path pileup file samtool mpileup mode mode mode appli singl genomicmetagenom assembl metasingl l min_length mlen min_length minimum contig length default bp samtool samtool path samtool jellyfish jellyfish path jellyfish usag metam predict h output mode c assembl assembl l min_length split_length nb break_count rb break_ratio anomaly_thr option argument h help show help messag exit output output output output directori metam result mode mode mode appli singl genomicmetagenom assembl metasingl c assembl contig assembl fasta file assembl contig assembl assembl assembl assemblerspecif model usertrain model use assembl fasta file megahitidba_udnew train model specifi user l min_length mlen min_length minimum contig length default bp split_length slen split_length minimum length split fragment default bp nb break_count threshold read breakpoint count correct misassembl metagenom rb break_ratio threshold read breakpoint ratio correct misassembl metagenom anomaly_thr threshold anomali score correct misassembl metagenom usag metam train h output label label assembl thread option argument h help show help messag exit output output output output directori metam result label label misassembl label contig train assembl assembl assembl assembl name directori train model thread thread thread maximum number cpu default