scaid scaid unsupervis cluster framework singlecel rnaseq data reveal put rare cell type million neural cell dataset global cluster obtain cluster within minut map put cell type three differ subpopul neural stempregenitor cell identifi prime differ development stage overview overviewfiguresoverviewpng tabl content introductionintroduct installationinstal requir packagesrequiredinstal installinstal exampl usageexampleusag preprocessingpreprocess aideaid rphkmeansrphkmean biolog analysisbiologicalanalysi exampl resultsexamplesresult scalabilityscal citationcitationrefer maintenancemainten introduct three main part cluster framework aid embed cluster rphkmean biolog analysi aid autoencoderimput distancepreserv embed novel deep learn architectur learn good represent singlecel data account biolog nois rphkmean random project hash base kmean algorithm novel algorithm improv detect rare cell type biolog analysi biolog analyt code pack r packag scaid instal requir instal aid rphkmean implement python biolog analyt code r python tensorflow numpi scipi scikit_learn tqdm seaborn r parallel gmp ggplot instal aid pleas refer httpsgithubcomtinglabsaidehttpsgithubcomtinglabsaid detail rphkmean pleas refer httpsgithubcomtinglabsrph_kmeanshttpsgithubcomtinglabsrph_kmean detail scaid r packag r requiredevtool setwdwher scaid folder locat installscaid exampl usag demo provid demohttpsgithubcomtinglabsscaidetreemasterdemo folder show detail data preprocess embed aid cluster rphkmean two dataset mous bladder mous retina also given preprocess preprocess singlecel data accept provid normal logtransform optim perform python input configur n cell row gene column aid python load data small medium size dataset hundr thousand cell import panda pd import numpi np make sure final input n cell row gene col sc_data pdread_csvsingle_cell_datasetcsv index_col sc_data sc_datavaluesastypefloat type npndarray configur aid paramet aid import aid aideconfig config aideconfig may tune follow paramet default valu usual suffici configpretrain_step_num pretrain step configae_drop_out_r dropout rate configalpha paramet determin portion ae loss vs md encod loss configearly_stop true earli stop maximum step number minimum step number run aid encod aidenam sc_test save_fold sc_test_fold sc_embed encoderfit_transformsc_data configconfig save embed npsavetxtsc_embeddingtxt sc_embed rphkmean python rph_kmean import rphkmean case n_cluster alreadi known clt rphkmeansn_init n_cluster clt_label cltfit_predictsc_embed case n_cluster unknown order automat detect number cluster implement weight bic valu determin optim k base kneedl point import note pleas set paramet max_point smaller number small dataset ie less cell max_point default cell rph algorithm stop reduc number cell max_point word rph perform dataset smaller max_point max_point default rph_kmean import select_k_with_b kmax set maximum number k explor optimal_k _ _ select_k_with_bicsc_embed kmaxkmax point_reducer_kwargsmax_pointmax_point clt rphkmeansn_init n_clustersoptimal_k max_point max_point run rphkmean optimal_k get cluster result clt_label cltfit_predictsc_embed output result npsavetxtclt_labelstxt clt_label biolog analysi r libraryscaid load origin data cluster result sc_data readcsvsingle_cell_datasetcsv header rownam row gene col cell sc_cluster readtableclt_labelstxtv evalu wilcox rank sum test log fold chang valu eval_gene_mark store_markersgene_expression_data sc_cluster thread gene_nam rownamesgene_expression_data return list marker cluster specifi threshold cluster_markers_list curate_markerseval_gene_mark gene_nam wilcox_threshold logfc_threshold cell type assign probabl accord marker databas panglao_marker_list preprocess list marker neural immun cell type return cluster row cell type col matrix celltype_prob calculate_celltype_probcluster_markers_list panglao_marker_list type jacc celltype_id rowmaxscelltype_prob enrich probabl base hypergeometr distribut compar celltype_id ensur number marker gene detect statist signific n_gene nrowgene_expression_data return cluster row cell type col matrix pvalu entri enrichment_prob calculate_enrichment_probcluster_markers_list panglao_marker_list n_gene type jacc visual marker gene exampl marker list selected_marker_gen csox aldoc ccnd olig olig gene_expression_subset gene_expression_datamatchtolowerselected_marker_gen tolowerrownmaesgene_expression_data process data plot processed_mark process_marker_expressiongene_expression_subset sc_cluster specifi cell type order gene order wish plot cell_level uniquesc_clust gene_level selected_marker_gen marker_plot plot_marker_expressionprocessed_mark gene_levelsgene_level cell_levelscell_level exampl result annot label pbmc neural dataset includ folder predict label rdata file includ predict annot label dataset br br follow figur show result pbmc k dataset million neural dataset p aligncent img srcfigurespbmcpng altpbmc titlepbmc aligncent height img src figuresneuralpng altneur titleneur aligncent height p scalabl time taken cluster million cell roughli gene less minut use gb memori file illustr sc_cluster code result cluster experi use aid rphkmean baselin code result cluster experi use baselin tool eg dca magic scscope scdeepclust demo demo data preprocess embed aid cluster rphkmean scaid r packag biolog analysi figur figur readm citat refer scaid cluster largescal singlecel rnaseq data reveal put rare cell type nar genom bioinformat refer zheng g x et al massiv parallel digit transcript profil singl cell natur commun doincomm genom x j c b million brain cell e mice franzen gan l bjorkegren j l panglaodb web server explor mous human singlecel rna sequenc data databas oxford mainten there question problem regard scaid pleas feel free contact ken xie kkxiegmailcom huang yu yuhuangcstfoxmailcom thank sc_cluster singl cell cluster experi use aid reduc dimens cellgen matrix use rphkmean cluster aidehttpsgithubcomtinglabsaid autoencoderimput distancepreserv embed combin multidiment scale md autoencod ae techniqu aim preserv distanc imput data gener ae reduc dimens rphkmeanshttpsgithubcomtinglabsrph_kmean variant kmean algorithm initi center produc point reduct process use random project rp one local sensit hash lsh techniqu file illustr result dim_origin_clt_eval_pap output dim_origin_clt_evalpi dim_reduce_eval_pap output dim_reduce_clt_evalpi data_explain_pap basic infom data embed_mem_use_pap memori run aid pca src readerpi read data raw file preprocesspi data preprocess dim_origin_clt_evalpi data preprocess cluster dim_reduce_clt_evalpi data preprocess dimens reduct cluster data upload raw m_neuron m_neurons_filtered_gene_bc_matrices_hh sc_brain l_allloom scdeepclust pbmc_k pbmc_kh shekhar_mouse_retina shekhar_mouse_retinah x_pbmc x_pbmch mouse_bladder_cel mouse_bladder_cellh mouse_es_cel mouse_es_cellh worm_neuron_cel worm_neuron_cellh demo demo analyz mous bladder small data cell gene mous retina larg data cell gene includ recommend data preprocess embed aid cluster rphkmean two dataset locat data folder run result locat aide_for_bladd folder aide_for_retina folder respect aid rphkmean default hyperparamet use demo small data code analyz mous bladder dataset provid smallpi simpli run script python smallpi run log follow pretrain begin step batch loss step batch loss step batch loss step batch loss pretrain end step global step batch loss reconstruct md l loss step global step valid loss reconstruct md l loss min val loss improv step global step batch loss reconstruct md l loss step global step batch loss reconstruct md l loss improv earli stop train end total step type embed class numpyndarray shape embed data type embed float rphkmean n_init ari nmi rphkmean n_init ari nmi kmean init kmean n_init ari nmi kmean init kmean n_init ari nmi show histori loss aid histori lossaide_for_bladderlosspng larg data eg cell_num code analyz mous retina dataset provid largepi simpli run script python largepi run log follow pretrain begin step batch loss step batch loss step batch loss step batch loss pretrain end step global step batch loss reconstruct md l loss step global step valid loss reconstruct md l loss min val loss improv step global step batch loss reconstruct md l loss step global step batch loss reconstruct md l loss improv earli stop train end total step type embed class numpyndarray shape embed data type embed float rphkmean n_init ari nmi rphkmean n_init ari nmi kmean init kmean n_init ari nmi kmean init kmean n_init ari nmi show histori loss aid histori lossaide_for_retinalosspng