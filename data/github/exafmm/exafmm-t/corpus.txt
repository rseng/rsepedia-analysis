titl exafmm highperform fast multipol method librari c python interfac tag c python fast multipol method lowrank approxim high perform comput author name tingyu wang orcid affili name rio yokota orcid affili name lorena barba orcid affili affili name georg washington univers index name tokyo institut technolog index date juli bibliographi paperbib summari exafmm opensourc librari fast multipol algorithm provid highperform evalu nbodi problem three dimens c python interfac new implement recent mani across decad work research group goal year produc reusabl standard code intric algorithm new headeronli cc implement easier extend still competit stateoftheart code includ pybind python interfac pybind fast multipol method fmm introduc year ago greengardrokhlin mean reduc complex nbodi problem mathcalon mathcalon use hierarch approxim longrang interact two major variant hierarch nbodi algorithm exist treecod fmm algebra analogu also exist hmatrix method origin develop fast evalu gravit potenti field found mani applic differ field exampl integr formul problem model ellipt partial differenti equat reinterpret nbodi interact way nbodi algorithm applic acoust electromagenet fluid dynam present version exafmm implement socal kernelindepend variant fmm yingkernelindependentadaptivefast support comput potenti forc laplac lowfrequ helmholtz modifi helmholtz aka yukawa kernel user add nonoscillatori kernel modest program effort statement need past three decad plethora fast nbodi implement emerg mention notabl one context bonsai bedorfsparseoctreegravit gravit treecod run entir gpu hardwar changa jetleymassivelyparallelcosmolog also treecod use charm autom dynam load balanc scalfmm agullotask implement blackbox fmm kernelindepend variant base interpol come option use starpu runtim system handl heterogen task schedul tbfmm bramastbfmmgenericparallel taskbas fmm librari featur gener c design support variou type tree structur kernel heavi use c templat pvfmm malhotrapvfmmparallelkernel comput particl volum potenti use kernelindepend fmm kifmm yingkernelindependentadaptivefast first version exafmm focus lowaccuraci optim implement dualtre travers barbayokotafigshar yokotabarbaa yokotafmmbaseddu gpuenabl use cuda parallel mpi exploit multithread use openmp despit effort remain challeng fmm commun wellestablish opensourc softwar packag analog fftw fast fourier transform deliv compel perform standard easytous interfac alpha version exafmm long complex hard maintain length partli due focu fast execut led special treatment lowp evalu extens handcod optim emphasi achiev high perform led poor reusabl maintain current version use kernelindepend variant method higher perform high accuraci higher truncat order p keep focu maintain stay close standard clean function interfac shallow inherit conserv use class instead fixat fastest focu ballpark competit perform python api abil call jupyt notebook make softwar valuabl mani applic featur softwar design exafmmt design standard lean first use c stl contain depend matur math librari bla lapack fftw second exafmmt moder objectori name usag encapsul inherit polymorph conserv even minim code core librari consist around line code order magnitud shorter mani fmm packag exafmmt concis highli optim achiev competit perform work combin techniqu optim sever past effort top multithread use openmp speed pp oper nearrang interact use simd vector sseavxavx compat appli cach optim propos pvfmm malhotrapvfmmparallelkernel improv perform ml oper farrang interact addit exafmmt also allow user precomput store translat oper benefit applic requir iter fmm evalu singlenod perform exafmmt par stateoftheart packag mention ran benchmark solv laplac nbodi problem million randomli distribut particl workstat core intel ix cpu took second obtain digit accuraci potenti respect exafmmt also rel easi extend ad new kernel requir user creat deriv fmm class provid kernel function last least offer highlevel python api support python applic thank pybind stl contain automat convert pythonn data structur sinc python use duck type expos overload function differ python object avoid name collis keep clean interfac chose creat python modul kernel exafmmt python packag instead ad suffix function class name identifi type applic recent integr exafmmt bemppcl opensourc boundari element method bem packag python betck whose predecessor bem smigajsolvingboundaryintegr enabl mani acoust electromagnet applic bem applic comput domin dens matrixvector multipl matvec iter exafmmt reduc time memori cost matvec linear complex thu make bemppcl feasibl solv largescal problem upcom paper demonstr capabl perform bemppexafmm biomolecular electrostat simul includ solv problem scale viru wanget showcas calcul paper submit obtain surfac electrostat potenti zika viru model million atom million boundari element point runtim hour cpu node acknowledg softwar build effort decad directli receiv support grant lab uk us includ epsrc grant epe nsf grant oci nsf career oac ccf support includ faculti startup fund boston univers georg washington univers nvidia via hardwar donat refer exafmmt build statushttpstraviscicomexafmmexafmmtsvgbranchmasterhttpstraviscicomexafmmexafmmt statushttpsjosstheojorgpapersfaabcaeefbdddcceccstatussvghttpsjosstheojorgpapersfaabcaeefbdddccecc cite exafmm highperform fast multipol method librari c python interfac tingyu wang rio yokota lorena barba journal open sourc softwar doijoss exafmmt kernelindepend fast multipol method librari solv nbodi problem provid c python api use pybindhttpsgithubcompybindpybind creat python bind c code exafmmt aim deliv compel perform simpl code design userfriendli interfac current support potenti forc calcul laplac lowfrequ helmholtz modifi helmholtz yukawa kernel addit user easili add nonoscillatori kernel exafmmt framework document full document avail herehttpsexafmmgithubioexafmmt pleas use github issueshttpsgithubcomexafmmexafmmtissu track bug request contribut exafmmt pleas review contributinghttpsgithubcomexafmmexafmmtblobmastercontributingmd contribut guidelin contribut exafmmt pleas first fork repositori push chang fork submit pull request pr minor fix pleas make sure code pass current testshttpsexafmmgithubioexafmmtcompilehtmlinstallexafmmt submit pr contribut introduc new featur pleas also go checklist add unit test sourc file test folder add compil instruct testsmakefileam sinc use autotool new function class doxygen style docstr branch merg master travi ci automat gener new document push ghpage branch could follow intructionshttpsexafmmgithubioexafmmtdocumentationhtml build document local histori bit histori project start pyfmmhttpsgithubcombarbagrouppyfmm serial prototyp python follow petfmm petscbas parallel code heavi templat cruzpetfmm third effort gemsfmmhttpsgithubcombarbagroupgemsfmm serial code cuda kernel execut gpu yokotagem anoth student group felt exafmmalphahttpsgithubcomexafmmexafmmalpha overus class inherit inadequ applic collabor reus kernel implement anoth tree construct fmmtlhttpsgithubcomcceckafmmtl first author paper began work exafmmalpha point mission clear simplifi aim reusabl work led sixth implement fmm group still call exafmmhttpsgithubcomexafmmexafmm present havent publish new version exafmm call exafmmt aim bring fmm broader audienc increas scientif impact version exafmmt histori branch gpu vanillaml kernel laplaceki helmholtzki yukawaki period simd vech thread openmp loop openmp task mpi none gpu pp ml build autoconf wrapper none plot none exafmm histori branch dev learn kernel laplac laplaceki helmholtz stoke period ye simd vech thread openmp task mpi hot global histogram sort gpu build autoconf wrapper none plot python exafmmalpha exafmmbeta histori branch develop sc kernel laplac helmholtz biotsavart van der waal period ye simd agner vectorclass thread openmp cilk tbb mthread mpi orb bisect octsect gpu separ code bonsai hack build autoconf cmake wrapper charmm gromac gener md petiga plot none exafmmalphaold vortex_method exafmmalpha histori branch none kernel laplac van der waal biot savart stretch gaussian period ye simd none thread quark mpi orb global nth_element gpu offload kernel build makefil wrapper mr compat md plot vtk old_fmm_bem histori mid late branch none kernel laplac laplac gn helmholtz period simd none thread none mpi allgath let gpu offload kernel build makefil wrapper none plot none old_fmm_vortex histori earli mid branch none kernel laplac biot savart stretch transposemix gaussian period ye shear channel simd none thread none mpi allgath let gpu offload kernel build makefil wrapper none plot none fmm code askithttppadasicesutexasedulibaskit bosnsaihttpsgithubcomtreecodebonsai changahttpsgithubcomnbodyshopchangawikichanga fdpshttpsgithubcomfdpsfdp kifmmhttpscsnyueduharperkifmmddocumentationindexhtml kifmm newhttpsgithubcomjeewhanchoikifmmhybriddoubleonli modylashttpsgithubcomrioyokotalabmodyla pkifmmhttpsgithubcomroynalnarutofmm_rpy_browniantreemasterpkifmm pepchttpwwwfzjuelichdeiasjscenaboutusorganisationcomputationalsciencesimlabsslppsoftwarepepc_nodehtml pfalconhttpspfalconlipfr pvfmmhttpsgithubcomdmalhotrapvfmm salmon treecodehttpsgithubcomrioyokotalabsalmon_treecod scafacoshttpwwwscafacosd scalfmmhttppeoplebordeauxinriafrcoulaudsoftwaresscalfmmhtml todo ml cach optim nonuniform distribut tingyu reviv vanilla ml branch tingyu mm lp gpu elket compar exafmm vs exafmmt rio long term gpu kernel mpi stoke exampl c exampl three major class exafmmt bodyt class bodi particl nodet class node octre fmm fmm class choic templat paramet depend data type potenti set real_t realvalu kernel ex laplac modifi helmholtz set complex_t complexvalu kernel ex helmholtz exafmmt use doubl precis default ie real_t complex_t map doubl stdcomplexdoubl respect want use singl precis still use real_t complex_t code add dfloat compil flag predefin macro float true exafmmt type class function exafmm_t namespac api document found last section let solv laplac nbodi problem exampl first need creat sourc target creat sourc target randomli distribut cube type bodi stl vector bodi codeblock cpp use exafmm_treal_t stdrandom_devic rd stdmt genrd random number gener stduniform_real_distribut dist int ntarget int nsourc exafmm_tbodiesreal_t sourcesnsourc int insourc sourcesiibodi sourcesiq distgen charg int sourcesixd distgen locat exafmm_tbodiesreal_t targetsntarget int intarget targetsiibodi int targetsixd distgen locat next need creat fmm instanc fmm laplac kernel set order expans ncrit use former control accuraci latter balanc workload nearfield farfield codeblock cpp int p expans order int ncrit max number bodi per leaf exafmm_tlaplacefmm fmmp ncrit build balanc octre variabl node repres tree whose type node stl vector node facilit creat list evalu also store vector leaf node leaf vector nonleaf node nonleaf type nodeptr stl vector node codeblock cpp exafmm_tget_boundssourc target fmmx fmmr exafmm_tnodeptrsreal_t leaf nonleaf exafmm_tnodesreal_t node exafmm_tbuild_treereal_tsourc target leaf nonleaf fmm exafmm_tbalance_treereal_tnod sourc target leaf nonleaf fmm next build list precomput invari matric codeblock cpp exafmm_tinit_rel_coord comput possibl rel posit node fmm oper exafmm_tset_colleaguesnod find colleagu node exafmm_tbuild_listnod fmm creat list fmm oper fmmml_setupnonleaf extra setup ml oper final use fmm evalu potenti gradient codeblock cpp fmmupward_passnod leaf fmmdownward_passnod leaf downward pass calcul potenti gradient store leaf node tree comput error l norm compar direct summat codeblock cpp stdvectorreal_t error fmmverifyleaf stdcout potenti error error n gradient error error n exampl found examplescpp folder python exampl simplic name python packag exafmm separ modul kernel exafmmlaplac exafmmhelmholtz exafmmmodified_helmholtz compar c interfac exafmmt python interfac expos highlevel api step tree construct list construct precomput merg one function call setup also evalu requir call one function evalut python exampl jupyt notebook laplac httpsnbviewerjupyterorggithubexafmmexafmmtblobmasterexamplespythonlaplaceipynb__ helmholtz httpsnbviewerjupyterorggithubexafmmexafmmtblobmasterexamplespythonhelmholtzipynb__ modifi helmholtz httpsnbviewerjupyterorggithubexafmmexafmmtblobmasterexamplespythonmodified_helmholtzipynb__ build document exafmmt depend doxygen sphinx breath gener document facili gener c api document use exhal sphinx extens autom launch doxygen call sphinx creat document base doxygen xml output build document local need instal doxygen packag manag instal depend use pip instal r docsrequirementstxt use follow command codeblock bash cd doc make html html document gener docs_buildhtml directori also set travi ci automat deploy document github page exafmmt document master file creat sphinxquickstart mon apr adapt file complet like least contain root toctre direct includ introrst toctre caption content maxdepth compil exampl document toctre caption api refer maxdepth apilibrary_root instal depend c compil support openmp c standard newer gnu make bla lapack fftw httpwwwfftworgdownloadhtml_ gfortran note gnu intel compil test compil use llvm clang support yet recommend instal openbla standard build also includ full lapack librari fortran code exafmmt gfortran requir autotool macro help configur bla lapack librari use follow command instal depend ubuntu codeblock bash aptget updat aptget instal libopenblasdev libfftwdev gfortran modifi command accordingli run linux distribut instal exafmmt section necessari user want use exafmmt c applic python user skip next section refinstal exafmmt python packag exafmmt use autotool buildsystem go root directori exafmmt configur build codeblock bash cd exafmmt configur default configur script use advanc simd instruct set avail cpu enabl doubl precis option use configur help see avail option configur compil run exafmmt test codeblock bash make check root directori repo option instal header configur locat codeblock bash make instal instal exafmmt python packag exafmmt reli pybind httpsgithubcompybindpybind_ gener python bind requir python x instal python packag need first instal openbla choic bla librari addit aforement depend instal exafmmt python environ use pip codeblock bash pip instal githttpsgithubcomexafmmexafmmtgit exafmmt exafmmt opensourc fast multipol method fmm librari simul nbodi interact implement kernelindepend fmm provid c python api use pybind httpsgithubcompybindpybind__ creat python bind c sourc code exafmmt current sharedmemori implement use openmp aim deliv competit perform simpl code design also follow featur offer highlevel api python use c stl contain support singl doubleprecis vector nearrang interact cach optim farrang interact