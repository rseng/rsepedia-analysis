readmemd gener readmermd pleas edit file ppdiag badg start r build statushttpsgithubcomowenwardppdiagworkflowsrcmdcheckbadgesvghttpsgithubcomowenwardppdiagact cran statushttpswwwrpkgorgbadgesversionppdiaghttpscranrprojectorgpackageppdiag lifecycl stablehttpsimgshieldsiobadgelifecyclestablebrightgreensvghttpslifecyclerliborgarticlesstageshtml codecov test coveragehttpscodecovioghowenwardppdiagbranchmaingraphbadgesvghttpscodecovioghowenwardppdiagbranchmain doihttpsjosstheojorgpapersjossstatussvghttpsdoiorgjoss badg end ppdiag r packag provid collect tool use assess fit tempor point process data current includ simul data specifi point process fit specifi point process model data evalu fit point process model data use sever diagnost tool instal instal releas version ppdiag cranhttpscranrprojectorg r installpackagesppdiag current develop version packag avail githubhttpsgithubcomowenwardppdiag r installpackagesremot remotesinstall_githubowenwardppdiag exampl illustr basic function packag simul data specifi hawk process examin diagnost result fit homogen poisson process data r libraryppdiag hp_obj pp_hplambda alpha beta sim_hp pp_simulatehp_obj end sim_hp readili evalu fit homogen poisson process data r est_hpp fithppsim_hp est_hpp homogen poisson process lambda event pp_diagest_hpp event sim_hp img srcmanfiguresreadmefit_hpppng width raw residu e pearson residu e onesampl kolmogorovsmirnov test data r pvalu altern hypothesi twosid r hp_est fithpev sim_hp pp_diaghp_est event sim_hp img srcmanfiguresreadmefit_hppng width raw residu pearson residu onesampl kolmogorovsmirnov test data r pvalu altern hypothesi twosid markov modul hawk process exampl particularli use complex point process markov modul hawk process mmhp simul event model examin fit simpler point process data r q matrixc ncol byrow true mmhp_obj pp_mmhpq delta c lambda lambda alpha beta mmhp_obj markov modul hawk process lambda lambda alpha beta q delta mmhp_event pp_simulatemmhp_obj n easili fit homogen poisson process visualis good fit r est_hpp fithppev mmhp_eventsev pp_diagest_hppmmhp_eventsev img srcmanfiguresreadmefit_hpp_to_mmhppng width raw residu pearson residu onesampl kolmogorovsmirnov test data r pvalu altern hypothesi twosid similarli hawk process r est_hp fithpev mmhp_eventsev pp_diagest_hpmmhp_eventsev img srcmanfiguresreadmefit_hp_to_mmhppng width raw residu pearson residu onesampl kolmogorovsmirnov test data r pvalu altern hypothesi twosid compar true point process model r pp_diagmmhp_obj mmhp_eventsev img srcmanfiguresreadmefit_mmhppng width raw residu pearson residu onesampl kolmogorovsmirnov test data r pvalu altern hypothesi twosid get help contribut pleas file issu herehttpsgithubcomowenwardppdiagissu similarli would delight anyon would like contribut packag ad point process kernel function feel free take look herehttpsgithubcomowenwardppdiagblobmaincontributingmd reach question refer sun et al ppdiag diagnost tool tempor point process journal open sourc softwar httpsdoiorgjoss wu et al diagnost visual point process model event time social network appli model techniqu data analysi ed dimotikali karagrigori c parpoula ch skiada httpsdoiorgch ppdiag small updat aros joss review process ad print method point process object tidi return inform diagnost function also updat citat descript publish version contributor code conduct contributor maintain project pledg respect peopl contribut report issu post featur request updat document submit pull request patch activ commit make particip project harassmentfre experi everyon regardless level experi gender gender ident express sexual orient disabl person appear bodi size race ethnic age religion exampl unaccept behavior particip includ use sexual languag imageri derogatori comment person attack troll public privat harass insult unprofession conduct project maintain right respons remov edit reject comment commit code wiki edit issu contribut align code conduct project maintain follow code conduct may remov project team instanc abus harass otherwis unaccept behavior may report open issu contact packag maintainerogwcolumbiaedu code conduct adapt contributor covenanthttpcontributorcovenantorg version avail httpswwwcontributorcovenantorgversioncodeofconducthtml contribut ppdiag develop bug report potenti problem exist code address file issu give brief detail possibl small reproduc exampl would like fix bug small fix feel free go ahead direct pull request larger issu might better proceed discuss would delight anyon interest contribut packag get involv also potenti addit would extend includ diagnost test point process differ hawk kernel function contribut pleas look exist code feel free file issu discuss potenti addit pleas note ppdiag releas contributor code conductcode_of_conductmd contribut project agre abid term test environ local window r ubuntu github action r maco latest github action r winbuild devel releas r cmd check result error warn output github_docu readmemd gener readmermd pleas edit file r includ fals knitropts_chunkset collaps true comment figpath manfiguresreadm outwidth ppdiag badg start r build statushttpsgithubcomowenwardppdiagworkflowsrcmdcheckbadgesvghttpsgithubcomowenwardppdiagact cran statushttpswwwrpkgorgbadgesversionppdiaghttpscranrprojectorgpackageppdiag lifecycl stablehttpsimgshieldsiobadgelifecyclestablebrightgreensvghttpslifecyclerliborgarticlesstageshtml codecov test coveragehttpscodecovioghowenwardppdiagbranchmaingraphbadgesvghttpscodecovioghowenwardppdiagbranchmain doihttpsjosstheojorgpapersjossstatussvghttpsdoiorgjoss badg end ppdiag r packag provid collect tool use assess fit tempor point process data current includ simul data specifi point process fit specifi point process model data evalu fit point process model data use sever diagnost tool instal instal releas version ppdiag cranhttpscranrprojectorg r evalfals installpackagesppdiag current develop version packag avail githubhttpsgithubcomowenwardppdiag r evalfals installpackagesremot remotesinstall_githubowenwardppdiag exampl illustr basic function packag simul data specifi hawk process examin diagnost result fit homogen poisson process data r exampl libraryppdiag hp_obj pp_hplambda alpha beta sim_hp pp_simulatehp_obj end sim_hp readili evalu fit homogen poisson process data r fit_hpp est_hpp fithppsim_hp est_hpp pp_diagest_hpp event sim_hp r fit_hp hp_est fithpev sim_hp pp_diaghp_est event sim_hp markov modul hawk process exampl particularli use complex point process markov modul hawk process mmhp simul event model examin fit simpler point process data r mmhp exampl q matrixc ncol byrow true mmhp_obj pp_mmhpq delta c lambda lambda alpha beta mmhp_obj mmhp_event pp_simulatemmhp_obj n easili fit homogen poisson process visualis good fit r fit_hpp_to_mmhp est_hpp fithppev mmhp_eventsev pp_diagest_hppmmhp_eventsev similarli hawk process r fit_hp_to_mmhp est_hp fithpev mmhp_eventsev pp_diagest_hpmmhp_eventsev compar true point process model r fit_mmhp pp_diagmmhp_obj mmhp_eventsev get help contribut pleas file issu herehttpsgithubcomowenwardppdiagissu similarli would delight anyon would like contribut packag ad point process kernel function feel free take look herehttpsgithubcomowenwardppdiagblobmaincontributingmd reach question refer sun et al ppdiag diagnost tool tempor point process journal open sourc softwar httpsdoiorgjoss wu et al diagnost visual point process model event time social network appli model techniqu data analysi ed dimotikali karagrigori c parpoula ch skiada httpsdoiorgch titl ppdiag diagnost tool tempor point process output rmarkdownhtml_vignett author salli sun owen g ward xiaoxi zhao jing wu tian zheng vignett vignetteindexentryppdiag diagnost tool tempor point process vignetteencodingutf vignetteengineknitrrmarkdown editor_opt markdown wrap r includ fals knitropts_chunkset collaps true comment setse make reproduc r setup remotesinstall_githubowenwardppdiag libraryppdiag vignett provid introduct function avail ppdiag evalu fit univari tempor point process achiev current includ rang function allow user simul data rang common univari point process fit rang univari point process data fit point process data evalu abil point process captur tempor structur present data class creat class point process model includ packag current homogen poisson process pp_hpplambda creat hpp object rate paramet lambda r hpp_obj pp_hpplambda hpp_obj hawk process pp_hplambda alpha beta event null creat hp object r hp_obj pp_hplambda alpha beta hp_obj markov modul poisson process pp_mmpplambda lambda alpha beta q delta creat mmpp object r q matrixc ncol byrow true mmpp_obj pp_mmppq delta c lambda c mmpp_obj markovmodul hawk process pp_mmhplambda lambda alpha beta q delta creat mmhp object r mmhp_obj pp_mmhpq delta c lambda lambda alpha beta mmhp_obj simul data simul data given point process use function pp_simulatepp_obj first argument specifi one point process remain argument specifi either number event simul length observ period possibl event exampl simul event specifi end time r hpp_event pp_simulatehpp_obj end hpp_event altern specifi number event wish simul r hp_event pp_simulatehp_obj start n hp_event return simul event specifi point process markov modul process state time state also return scenario specifi number event simul current r mmhp_event pp_simulateobject mmhp_obj n mmhp_event fit point process complet includ function fit homogen poisson hawk process data fit markov modul model complex although describ procedur includ vignett fithpphpp_ev return object class hpp estim mle homogen poisson process hpp_event r fit_hpp fithpphpp_ev fit_hpp similarli fithphp_ev return object class hp estim three paramet hawk process hp_event use constroptim ensur return solut one obtain satisfi stationari condit hawk process r hp_event pp_simulatehp_obj n fit_hp fithphp_ev fit_hplambda fit_hpalpha fit_hpbeta diagnos fit point process data main goal packag provid user tool examin fit specifi point process data sever method use assess good fit point process tempor data packag allow user visual inspect estim intens point process examin fit intens along distribut rescal interev time help identifi caus lack fit examin distribut rescal interev time utilis time rescal theorem examin residu process estim point process particular comput raw pearson residu given point process fit data visual intens function drawhppintensityhpp event plot intens homogen poisson process rfigwidthfigheight drawhppintensityfit_hpp event hpp_event color red similarli drawhpintensityhp event plot intens hawk process rfigwidthfigheight drawhpintensityfit_hp event hp_event plot fit intens input event set fittru rfigwidthfigheight drawhpintensityev hp_event fit true similarli drawunimmhpintensitymmhp mmhp_event plot intens markov modul hawk process similar function markov modul poisson process requir point process object output pp_simul describ latent process rfigwidthfigheight drawunimmhpintensitymmhp_obj mmhp_event visual intens good fit jointli main goal packag provid tool diagnos fit given point process data includ sever function intensityqqplot display estim intens given point process along qqplot rescal interev time togeth often use identifi issu model fit chosen point process r intensityqqplot figwidth figheight intensityqqplotobject fit_hp event hp_event r intqqpot mmhp evalfals give error current intensityqqplotobject mmhp_obj markov_st mmhp_event residu analysi pp_residu return raw pearson residu fit specifi point process given event r mmhp_residu pp_residualobject mmhp_obj event mmhp_eventsev pp_residualobject fit_hp event hp_event overal summari fit final pp_diag summaris graphic numer fit specifi point process data given point process comput residu raw pearson obtain fit point process data perform good fit test base rescal interev time display graphic summari diagnost r ppdiag hp figwidth figheight pp_diagobject fit_hp event hp_event homogen poisson process pp_diagobject event give diagnost model includ qq plot ks plot correspond ks test along raw pearson residu one function rfigwidthfigheight pp_diaghpp_objhpp_ev pp_residualobject event return raw pearson residu r pp_residualhpp_objhpp_ev intensityqqplotobject event give qqplot intens plot rfigwidthfigheight intensityqqplothpp_obj hpp_event hawk process pp_diagobject event give diagnost model includ qq plot ks plot ks test raw pearson residu one function rfigwidthfigheight pp_diaghp_objhp_ev pp_residualobject event give raw pearson residu r pp_residualhp_objhp_ev intensityqqplotobject event give qqplot intens plot rfigwidthfigheight intensityqqplothp_obj hp_event mmhp rfigwidthfigheight pp_diagmmhp_objmmhp_eventsev titl fit markov modul point process model output rmarkdownhtml_vignett author owen g ward vignett vignetteindexentryfit markov modul point process model vignetteengineknitrrmarkdown vignetteencodingutf r includ fals knitropts_chunkset collaps true eval fals comment setse make reproduc optionsrmarkdownhtml_vignettecheck_titl fals r setup libraryppdiag libraryrstan librarycmdstanr librarytidyvers librarybayesplot function fit standard hawk poisson point process data includ ppdiag howev current includ fit algorithm markov modul point process reli use rstan recent cmdstanr perform bayesian infer model paramet provid instruct fit model easili use conjunct diagnost tool ppdiag instal rstan cmdstanr instruct instal rstan found httpsgithubcomstandevrstanwikirstangettingstart instruct instal cmdstanr found httpsmcstanorgcmdstanrarticlescmdstanrhtml mention link differ rstan cmdstanr experi cmdstanr seem mayb reliabl less prone crash troubl instal use stan lot great help avail httpsdiscoursemcstanorg someon els probabl alreadi answer question stan code mmppmmhp first includ stan code fit markov modul model tempor point process r mmppstancod mmpp_stan_cod data intlow num_ev maximum number event pair window maxunlistlapplyreturn_dfeventtimeslength vectornum_ev time_matrix includ termin time last entri paramet reallow lambda baselin rate pair reallow c baselin rate pair reallowerupp w ctmc transit rate reallowerupp w ctmc transit rate transform paramet reallow q reallow q q lambdaw q lambdaw model real integ placehold variabl calcul integr row_vector forwardnum_ev forward variabl forwardbackward algorithm row_vector forward_termin row_vector probs_num_ev probabl vector transit state activ state row_vector probs_num_ev probabl vector transit state inact state vectornum_ev interev prior c lognorm w beta w beta lambda gamma interev time_matrix prepar forward algorithm log probabl markov transit logp_ijt forn num_ev probs_n logqqqqqqexpqqintereventn probs_n logqqqqqqexpqqintereventn probs_n logm_expprobs_n probs_n logm_expprobs_n consid n integ intereventlambda forward log_sum_expprobs_ loglambdac integc forward log_sum_expprobs_ loglambda integ ifnum_ev forn num_ev integ intereventnlambda forwardn log_sum_expforwardn probs_n loglambdac integc forwardn log_sum_expforwardn probs_n loglambda integ integ intereventnum_eventslambda forward_termin log_sum_expforwardnum_ev probs_num_ev integc forward_termin log_sum_expforwardnum_ev probs_num_ev integ target log_sum_expforward_termin r mmhpstancod mmhp_stan_cod data intlow num_ev number event vectornum_ev time_matrix includ termin time last entri paramet reallow lambda baselin rate pair reallow w_lambda reallow upper w_q ctmc transit rate reallow upper w_q reallow alpha reallow beta_delta reallowerupp delta_ piniti state transform paramet reallow lambda reallow q reallow q row_vector log_delta reallow beta lambda lambdaw_lambda q lambdaw_q q lambdaw_q log_delta logdelta_ log_delta logdelta_ beta alphabeta_delta model real integ placehold variabl calcul integr row_vector forwardnum_ev forward variabl forwardbackward algorithm row_vector forward_termin forward variabl termin time row_vector probs_num_ev probabl vector transit state activ state row_vector probs_num_ev probabl vector transit state inact state row_vector int_num_ev integr lambda state transit activ state row_vector int_num_ev integr lambda state transit inact state real rnum_ev record variabl hawk process vectornum_ev interev real k real k real k real k real k real k prior w_lambda gamma alpha gammalognorm beta_delta lognormalnorm delta_ beta w_q beta w_q beta lambda gamma interev time_matrix ifnum_ev event occur period prepar forward calcul probs_ logqqqqqqexpqqinterev probs_ logqqqqqqexpqqinterev probs_ logm_expprobs_ probs_ logm_expprobs_ r k expqqinterev k expqqintereventqq k expqqintereventqq int_ qlambdaqqlambdainterev qlambdaqqlambdakinterev lambdalambdaqqk lambdalambdaqqkqqexpprobs_ int_ qlambdalambdaqqinterev lambdaqqlambdaqkinterev lambdalambdaqk lambdalambdaqqkqqexpprobs_ int_ qqlambdaqlambdainterev qlambdaqqlambdakinterev lambdalambdaqk qqlambdalambdakqqexpprobs_ int_ qqlambdalambdaqinterev qqlambdalambdaqkinterev lambdalambdaqqk lambdalambdaqqkqqexpprobs_ forward_termin log_sum_explog_delta probs_ int_ forward_termin log_sum_explog_delta probs_ int_ target log_sum_expforward_termin target lambdaintereventdelta_lambdaintereventdelta_ els event occur prepar forward algorithm log probabl markov transit logp_ijt forn num_ev chang probs_n logqqqqqqexpqqintereventn probs_n logqqqqqqexpqqintereventn probs_n logm_expprobs_n probs_n logm_expprobs_n r hawk r forn num_ev rn expbetaintereventnrn integr lambda forn num_ev k expqqintereventn k expqqintereventnqq k expqqintereventnqq k rnexpbetaintereventnbeta k rnexpbetaqqintereventnexpbetaintereventnbetaqq k rnexpqqbetaintereventnqqbeta int_n qlambdaqqlambdaintereventn qlambdaqqlambdakintereventn lambdalambdaqqk lambdalambdaqqk alphakqqk alphaqqk alphaqqkqqexpprobs_n int_n qlambdalambdaqqintereventn lambdaqqlambdaqkintereventn lambdalambdaqk lambdalambdaqqk alphaqkqqk alphaqk alphaqqkqqexpprobs_n int_n qqlambdaqlambdaintereventn qlambdaqqlambdakintereventn lambdalambdaqk qqlambdalambdak alphaqkqqk alphaqk alphaqqkqqexpprobs_n int_n qqlambdalambdaqintereventn qqlambdalambdaqkintereventn lambdalambdaqqk lambdalambdaqqk alphaqqkk alphaqqk alphaqqkqqexpprobs_n consid n forward loglambda log_sum_expprobs_int_log_delta forward loglambda log_sum_expprobs_int_log_delta ifnum_ev forn num_ev forwardn log_sum_expforwardn probs_n int_n loglambdaalpharn forwardn log_sum_expforwardn probs_n int_n loglambda forward_termin log_sum_expforwardnum_ev probs_num_ev int_num_ev forward_termin log_sum_expforwardnum_ev probs_num_ev int_num_ev lot place max_nm nm got rid target log_sum_expforward_termin fit model rstan demonstr use model simul data model fit includ stan model r simmmpp q matrixc ncol byrow true mmpp_obj pp_mmppq q lambda c delta c sim_mmpp pp_simulatemmpp_obj n also show run model use rstan mmpp exampl r rstanmmpp mmpp_data listnum_ev lengthsim_mmppev first event start time time_matrix diffcsim_mmppev sim_mmppend interev arriv time mmpp_rstan stanmodel_cod mmpp_stan_cod data mmpp_data chain mmpp_sim rstanextractmmpp_rstan fit model evalu sever way includ tool bayesplot packag import ensur fit reason r mmppplot bayesplotmcmc_histasmatrixmmpp_rstan par clambda c use result fit function ppdiag want extract estim paramet achiev use posterior mean desir posterior quantiti extract object r mmpppost mmpp_post lapplymmpp_sim mean similarli fit mmhp model simul data also r simmmhp q matrixc ncol byrow true mmhp_obj pp_mmhpq q lambda lambda alpha beta delta c sim_mmhp pp_simulatemmhp_obj n mmhp_data listnum_ev lengthsim_mmhpev first event start time time_matrix diffcsim_mmhpev sim_mmhpend interev arriv time r rstanmmhp mmhp_rstan stanmodel_cod mmhp_stan_cod data mmhp_data chain mmhp_sim rstanextractmmhp_rstan mmhp_post lapplymmhp_sim mean r plotdrawsmmhp bayesplotmcmc_histasmatrixmmhp_rstan par clambda lambda alpha beta fit model cmdstanr also fit model use cmdstanr includ code fit exampl run r mmppfit evalfals mmpp_file write_stan_filemmpp_stan_cod mmpp_stan cmdstan_modelstan_fil mmpp_file fit_mmpp mmpp_stansampledata mmpp_data seed chain parallel_chain refresh similarli fit mmhp model cmdstanr r compilemmhp evalfals mmhp_file write_stan_filemmhp_stan_cod mmhp_stan cmdstan_modelstan_fil mmhp_file fit_mmhp mmhp_stansampledata mmhp_data seed chain parallel_chain refresh use stan output ppdiag obtain estim fit stan model pass paramet estim ppdiag evalu model fit r mmppppdiag figwidth mmpp_fit_obj pp_mmpplambda mmpp_postlambda c mmpp_postc q matrix cmmpp_postq mmpp_postq mmpp_postq mmpp_postq nrow ncol byrow pp_diagmmpp_fit_obj event sim_mmppev r mmhpppdiag figwidth mmhp_fit_obj pp_mmhplambda mmhp_postlambda lambda mmhp_postlambda alpha mmhp_postalpha beta mmhp_postbeta q matrix cmmhp_postq mmhp_postq mmhp_postq mmhp_postq nrow ncol byrow pp_diagmmhp_fit_obj event sim_mmhpev gener roxygen edit hand pleas edit document rpp_diagr namepp_diag aliaspp_diag aliaspp_diagdefault aliaspp_diaghp aliaspp_diagmmhp aliaspp_diagmmpp aliaspp_diaghpp titlesummaris diagnost point process model usag pp_diagobject event methodpp_diagdefaultobject event methodpp_diaghpobject event methodpp_diagmmhpobject event methodpp_diagmmppobject event methodpp_diaghppobject event argument itemobjecta point process model itemeventsev time valu invis return null output plot summari diagnost consol descript gener diagnost tool differ point process model includ quantilequantil plot ks plot raw residu pearson residu exampl hpp_obj pp_hpplambda event pp_simulatehpp_obj end pp_diaghpp_obj event gener roxygen edit hand pleas edit document rdrawhpintensityr namedrawhpintens aliasdrawhpintens titledraw intens hawk process usag drawhpintens hp null event int_titl hawk intens start end maxev histori null color add fals fit fals plot_ev true verbos fals argument itemhpobject paramet hawk process itemeventsth event time happen state itemint_titletitl intens plot itemstartth start time current state itemendth end time current state itemhistoryth past event time itemcolorspecifi default plot color itemist number use drawunimmhpintens itemaddwheth add hawk intens exist plot use drawunimmhpintens itemfita boolean indic whether fit new hp event itemplot_eventsind whether event plot itemverbosewheth output inform messag run valu return valu intens plot hawk process descript draw intens hawk process exampl setse hp_obj pp_hplambda alpha beta event pp_simulatehp_obj start end drawhpintensityhp_obj event gener roxygen edit hand pleas edit document rpp_residualr namepp_residu aliaspp_residu titlecomput raw pearson residu point process model usag pp_residualobject event start end maxev step argument itemobjectpoint process model contain paramet itemeventsvector event time itemstartstart observ period default itemendend observ period default final event itemstepsnumb step numer integr need valu raw pearson residu descript comput raw pearson residu point process model exampl q matrixc ncol byrow true x pp_mmhpq delta c lambda lambda alpha beta pp_simulatex n pp_residualx event yevent gener roxygen edit hand pleas edit document rpp_compensatorr namepp_compens aliaspp_compens aliaspp_compensatordefault aliaspp_compensatormmpp aliaspp_compensatorhp aliaspp_compensatormmhp aliaspp_compensatorhpp titlecompens point process usag pp_compensatorobject event methodpp_compensatordefaultobject event methodpp_compensatormmppobject event methodpp_compensatorhpobject event methodpp_compensatormmhpobject event methodpp_compensatorhppobject event argument itemobjecta point process model itemeventsev time first valu valu compens vector rescal interev time descript comput compens includ point process exampl hpp_obj pp_hpplambda event pp_simulatehpp_obj end comp pp_compensatorhpp_obj event gener roxygen edit hand pleas edit document rpp_mmhpr namepp_mmhp aliaspp_mmhp titlecr markovmodul hawk processmmhp object usag pp_mmhplambda lambda alpha beta q null delta null event null argument itemlambdaintens homogen poisson process itemlambdabas intens hawk process itemalphajump size increas intens hawk process itembetaexponenti decreas intens hawk process itemqtransit probabl matrix itemdeltainiti state probabl itemeventsvector contain event time note first event time zero altern event could specifi null mean data ad later eg simul valu mmhp object descript creat markovmodul hawk processmmhp model accord given paramet lambda lambda alpha beta event time transit probabl matrix event time event miss mean data ad latereg simul exampl q matrixc ncol byrow true pp_mmhpq delta c lambda lambda alpha beta gener roxygen edit hand pleas edit document rdrawunimmhpintensityr namedrawunimmhpintens aliasdrawunimmhpintens titledraw intens markovmodul hawk processmmhp usag drawunimmhpintens mmhp simul int_titl intens mmhp leg_loc topright color add fals argument itemmmhpa mmhp object includ state state_tim event lambda lambda beta alpha itemsimulationth simul markovmodul hawk processmmhp itemint_titletitl plot itemleg_locationloc legend move need itemcolora specif default plot color itemaddlog true add alreadi exist plot na start new plot take default limit logscal xaxi previou plot taken fals warn differ valu suppli graphic devic open valu return valu intens plot markovmodul hawk process descript take mmhp object draw intens accordingli exampl q matrixc ncol byrow true x pp_mmhpq delta c lambda lambda alpha beta pp_simulatex n drawunimmhpintensityx gener roxygen edit hand pleas edit document rpp_mmppr namepp_mmpp aliaspp_mmpp titlecr markovmodul poisson processmmpp object usag pp_mmpplambda c q event null delta null argument itemlambdaparamet poisson process itemcth proport intens intens itemqtransit probabl matrix itemeventsvector contain event time note first event often specifi zero altern event could specifi null mean data ad later eg simul itemdeltainiti state probabl valu mmpp object descript creat markovmodul poisson processmmpp model accord given paramet lambda c q q event time event time tau miss mean data ad latereg simul exampl q matrixc ncol byrow true pp_mmppq q lambda c delta c gener roxygen edit hand pleas edit document rpp_qqexpr namepp_qqexp aliaspp_qqexp titleplot qqplot rescaledintereventtim fit point process usag pp_qqexpr argument itemrrescaledintereventtim itemoth argument plot valu return valu quantilequantil plot rescaledintereventtim descript gener quantilequantil plot rescaledintereventtim independ ident distribut exponenti random variabl rate true point process gener roxygen edit hand pleas edit document rmmhp_event_stat namemmhp_event_st aliasmmhp_event_st titleestim latent state event mmhp usag mmhp_event_st param listlambda lambda alpha beta q event start argument itemparamsth paramet chosen mmhp itemeventsth event time itemstartth start observ valu probabl state activ state event along like state descript given mmhp object event mmhp infer like state markov process event time along probabl activ state exampl q matrixc ncol byrow true mmhp_obj pp_mmhpq delta c lambda lambda alpha beta evalu fake event time ppdiagmmhp_event_stateparam mmhp_obj event c keywordintern gener roxygen edit hand pleas edit document rmmpp_event_stat namemmpp_event_st aliasmmpp_event_st titleestim latent state event mmpp usag mmpp_event_stateparam listlambda c q event start argument itemparamsth paramet chosen mmpp itemeventsth event time itemstartth start observ valu probabl state activ state event along like state descript given mmpp object event mmpp infer like state markov process event time along probabl activ state exampl q matrixc ncol byrow true mmpp_obj pp_mmppq delta c lambda c evalu fake event time ppdiagmmpp_event_stateparam mmpp_obj event c keywordintern gener roxygen edit hand pleas edit document rpp_hppr namepp_hpp aliaspp_hpp titlecr homogen poisson process object usag pp_hpplambda event null argument itemlambdar poisson process itemeventsev time option valu hpp object descript creat homogen poisson object accord given paramet lambda event event miss mean data ad latersimul process exampl pp_hpplambda gener roxygen edit hand pleas edit document rpp_ksplotr namepp_ksplot aliaspp_ksplot titlek plot empir theoret cdf curv fit point process usag pp_ksplotr argument itemrrescaledintereventtim itemoth argument plot valu return valu ks plot rescaledintereventtim exponenti cdf curv descript plot empir cdf plot rescaledintereventtim exponenti cdf refer curv gener roxygen edit hand pleas edit document rrawresidualr namerawresidu aliasrawresidu titlecomput raw residu point process model usag rawresidualobject event start end step argument itemobjectpoint process model contain paramet itemeventsvector event time itemstartstart observ period default itemendend observ period default final event itemstepsnumb step numer integr need valu raw residu descript comput raw residu point process specifi paramet event exampl q matrixc ncol byrow true x pp_mmhpq delta c lambda lambda alpha beta pp_simulatex n keywordintern gener roxygen edit hand pleas edit document rfithpr namefithp aliasfithp titledetermin mle hawk process numer usag fithpev end maxev vec c argument itemeventsev time itemendend observ period start default last event itemvecvector initi paramet valu valu hp object indic maximum likelihood paramet valu lambdaalphabeta hawk process nonconvex problem uniqu solut guarante descript determin mle hawk process numer exampl hp_obj pp_hplambda alpha beta sim pp_simulatehp_obj start n fithpsim gener roxygen edit hand pleas edit document rpp_simulat namepp_simul aliaspp_simul aliaspp_simulatedefault aliaspp_simulatehpp aliaspp_simulatehp aliaspp_simulatemmpp aliaspp_simulatemmhp titlesimul event tempor point process usag pp_simulateobject start end n null verbos fals methodpp_simulatedefaultobject start end n null verbos fals methodpp_simulatehppobject start end n null verbos fals methodpp_simulatehpobject start end n null verbos fals methodpp_simulatemmppobject start end n null verbos fals methodpp_simulatemmhpobject start end n null verbos fals argument itemobjectpoint process model object type hpp hp mmhp mmpp itemstartstart time event simul use markov modul model itemendend time event simul use markov modul model itemnnumb event simul requir markov modul model option otherwis itemverbosewheth output inform messag run valu vector event time model markov modul model also return detail underli latent process descript current avail point process homogen poisson hawk exponenti kernel mmhp mmpp exampl hpp_obj pp_hpplambda pp_simulatehpp_obj n gener roxygen edit hand pleas edit document rfithppr namefithpp aliasfithpp titlefit homogen poisson process event data usag fithppev end maxev argument itemeventsvector contain event time itemendend observ period start default last event valu hpp object contain event estim paramet descript comput maximum likelihood estim rate homogen poisson process given event exampl pois_i pp_hpplambda event pp_simulatepois_i end fithppev gener roxygen edit hand pleas edit document rpearsonresidualr namepearsonresidu aliaspearsonresidu titlecomput pearson residu point process model usag pearsonresidualobject event start end step argument itemobjectpoint process model itemeventsvector event time itemstartstart observ period default itemendtermin time default final event itemstepsnumb step numer integr need valu pearson residu descript comput pearson residu point process specifi paramet event exampl q matrixc ncol byrow true x pp_mmhpq delta c lambda lambda alpha beta pp_simulatex n ppdiagpearsonresidualmmhpx event yevent keywordintern gener roxygen edit hand pleas edit document rnegloglikr namenegloglik aliasnegloglik titlecomput neg log likelihood point process model usag negloglikobject event end argument itemobjectpoint process object contain paramet itemeventsvector contain event time itemendth end time event time valu scalar indic neg log likelihood descript comput neg log likelihood point process model model specifi time event simul time event keywordintern gener roxygen edit hand pleas edit document rpp_hpr namepp_hp aliaspp_hp titlecr hawk process object usag pp_hplambda alpha beta event null argument itemlambdainiti intens start time itemalphajump size increas intens itembetaexponenti decay intens itemeventsvector contain event time note first event time zero altern event could specifi null mean data ad later eg simul valu hp object descript creat hawk process exponenti kernel accord given paramet lambda alpha beta event event miss mean data ad latersimul process exampl pp_hplambda alpha beta gener roxygen edit hand pleas edit document rintensityqqplotr nameintensityqqplot aliasintensityqqplot aliasintensityqqplotdefault aliasintensityqqplothp aliasintensityqqplothpp aliasintensityqqplotmmpp aliasintensityqqplotmmhp titledraw intens fit point process qqplot rescal event usag intensityqqplotobject event markov_st methodintensityqqplotdefaultobject event markov_st methodintensityqqplothpobject event markov_st null methodintensityqqplothppobject event markov_st null methodintensityqqplotmmppobject event markov_statesev markov_st methodintensityqqplotmmhpobject event markov_statesev markov_st argument itemobjectparamet model hp hpp mmhp itemeventsev time itemmarkov_statesonli mmhp mmpp markov state simul output valu return valu intens qqplot singl plot descript draw intens qq plot model gener roxygen edit hand pleas edit document rfithpr namenegloglik_hp aliasnegloglik_hp titlefit hawk process exponenti kernel event data usag negloglik_hpvec event end maxev argument itemvecvector contain initi valu object paramet lambdaalphabeta optim itemeventsvector contain event time itemendth end time event time descript comput neg log likelihood paramet valu hawk process keywordintern gener roxygen edit hand pleas edit document rhawkes_max_intensityr namehawkes_max_intens aliashawkes_max_intens titlemax intens hawk process usag hawkes_max_intensityobject event argument itemobjecthawk process object contain paramet hawk process itemeventsev hawk process valu max intens descript max intens hawk process keywordintern gener roxygen edit hand pleas edit document rdrawunimmppintensityr namedrawunimmppintens aliasdrawunimmppintens titledraw intens markovmodul poisson processmmpp usag drawunimmppintens mmpp simul add fals color fit fals int_titl intens plot mmpp argument itemmmppa mmpp object includ transit probabl matrix lambda delta c itemsimulationth simul markovmodul poisson processmmpp itemaddlog true add alreadi exist plot na start new plot take default limit logscal xaxi previou plot taken fals warn differ valu suppli graphic devic open itemcolora specif default plot color itemfita boolean indic whether fit event provid itemint_titletitl plot valu return valu intens plot markovmodul poisson process descript take mmpp object draw intens accordingli exampl q matrixc ncol byrow true x pp_mmppq delta c lambda c pp_simulatex n drawunimmppintensityx gener roxygen edit hand pleas edit document rinterpolate_mmhp_latentr nameinterpolate_mmhp_lat aliasinterpolate_mmhp_lat titleinterpol latent process mmhp usag interpolate_mmhp_latentparam event zt argument itemparamsparamet mmhp mmhp object itemeventsev includ assum start itemztinf latent state event valu list state markov process zhat includ initi state time transit time xhat descript interpol latent process mmhp exampl q matrixc ncol byrow true mmhp_obj pp_mmhpq delta c lambda lambda alpha beta ppdiaginterpolate_mmhp_lat param mmhp_obj event c zt c keywordintern gener roxygen edit hand pleas edit document rdrawhppintensityr namedrawhppintens aliasdrawhppintens titledraw intens homogen poisson process usag drawhppintens hpp null event int_titl homogen poisson process start end maxev color red plot_ev true fit fals add fals verbos fals argument itemhppobject homogen poisson process itemeventsev time input itemint_titleth plot titl itemstartstart event itemendend event itemcolora specif default plot color itemplot_eventsa boolean indic whether input event plot itemfita boolean indic whether fit hpp use pass object itemaddwheth add hpp intens exist plot itemverbosewheth output inform messag run valu return valu intens plot homogen poisson process descript draw intens homogen poisson process exampl pois_i pp_hpplambda drawhppintensitypois_i event pp_simulatepois_i end gener roxygen edit hand pleas edit document rmmpp_latentr namemmpp_lat aliasmmpp_lat titleestim latent process mmpp usag mmpp_latentparam listlambda c q event zt start argument itemparamsparamet mmpp mmpp object itemeventsev includ assum start itemztinf latent state event valu list state markov process zhat time transit time xhat descript estim latent process mmpp exampl q matrixc ncol byrow true mmpp_obj pp_mmppq delta c lambda c ppdiagmmpp_latentparam mmpp_obj event c zt c keywordintern