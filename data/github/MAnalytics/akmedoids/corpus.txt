titl akmedoid r packag gener directionallyhomogen cluster longitudin data set date januari bibliographi paperbib affili index name crime wellb big data centr manchest metropolitan univers author affili name monsuru adepeju orcid affili name samuel langton orcid affili name jon bannist orcid x tag anchor kmedoid kmean crime longitudin cluster longterm trend statement need social behaviour scienc longitudin cluster wide use identifi group individu trend correspond certain development process time whilst popular cluster techniqu kmean suit identifi spheric cluster genofali curman littl attempt modifi method identifi altern form cluster repres linear growth time ie directionallyhomogen cluster address shortcom introduc anchor kmedoid packag refer akmedoid implement medoidbas expect maximis mem procedur within classic kmean cluster framework packag includ function assist manipul longitudin data set prior cluster procedur visualis solut postprocedur potenti applic area akmedoid includ criminolog transport epidemiolog brain imag design implement previou studi taken advantag variou function characterist longitudin data order extract theoret empir interest cluster subject exampl includ use fourier basi tarpey coeffici bspline deriv estim boor schumak anchor cluster routin better captur presum development process develop anchor kmedoid akmedoid cluster packag employ ordinari least squar ol trend line subject bespok expectationmaximis procedur specif captur longterm linear growth criminolog identifi slowchang trend help unravel placebas characterist drive crimerel event street gun homicid across geograph space griffith date explor trend deploy exist techniqu name kmean curman andresen groupbas trajectori model weisburd chavez bannist suit spheric cluster genofali sensit techniqu shortterm fluctuat outlier longitudin dataset make difficult extract cluster base underli longterm trend akmdeoid tailor scenario main cluster function akmedoid packag implement medoidbas expect maximis mem procedur integr certain key modif classic kmean routin first approxim longitudin trajectori use ol regress second anchor initialis process medoid observ deploy medoid observ new anchor iter expectationmaximis procedur celeux converg similar fashion classic kmean routin reli distancebas similar vector observ scale invari implement ensur impact shortterm fluctuat outlier minimis final group augment raw trajectori visualis order provid clearer delin longterm linear trend subject trajectori given l number iter comput complex cluster routin classic kmean algorithm ie olkn k specifi number cluster n number individu trajectori optim number cluster given data may determin use averag silhouett rousseeuw calinski harabasz criterion calinski full demonstr provid packag vignett deploy akmedoid examin longterm rel exposur crime r rmanual encourag use packag outsid criminolog cluster cluster represent main cluster function akmedoid akclustr function captur direct homogen cluster within given longitudin dataset use procedur detail crime inequ studi packag includ prop function convert absolut rate measur individu trajectori rel measur time packag includ print_akstat plot_akstat function gener properti cluster visual cluster respect particular plot_akstat function draw ggplot librari ggplot order visual result cluster either line arealstack graph format acknowledg grate acknowledg econom social research council esrc fund understand inequ project grant refer esp research conduct refer readmemd gener readmermd pleas edit file akmedoid badg start badg end r packag analyz cluster longitudin data descript akmedoid packag advanc cluster longitudin dataset order identifi cluster trajectori similar longterm linear trend time provid improv cluster identif compar classic kmean algorithm packag also includ set function address common data issu miss entri outlier prior conduct advanc longitudin data analysi one key object packag facilit easi replic recent paper examin small area inequ crime drop adepeju et al mani function provid akmedoid packag may appli longitudin data gener inform usabl check detail cranhttpscranrprojectorgwebpackagesakmedoidsindexhtml instal cran r consol type installpackagesakmedoid libraryakmedoid librari librarytidyr libraryggplot warn packag ggplot built r version libraryreshap warn packag reshap built r version libraryreadr instal develop version packag type remotesinstall_githubmanalyticsakmedoid pleas report instal problem issu exampl usag given longitudin dataset follow exampl akmedoid could use extract cluster trajectori similar longterm trend time use simul dataset name simulatedrda store data directori gener artifici dataset simul data set compris three cluster distinct mean direct chang time group contain trajectori dircreateinput creat folder warn dircreateinput input alreadi exist function creat longitudin nois noise_fn functionx time rnormlengthtim mean x function simul trajectori group sim_group functiongr_baselin sd time intcp_error rgamma shape scalesd intercept error mean_traj gr_baselin intcp_error traj mean_traj noise_fnintcp_error time time step t_step c increas group i_gr null fori seq_len i_gr rbindi_gr sim_groupgr_baselinet_step sd timet_step stabl group s_gr null fori seq_len s_gr rbinds_gr sim_groupgr_baselinereplengtht_step sd timet_step decreas group d_gr null fori seq_len d_gr rbindd_gr sim_groupgr_baselin t_step sd timet_step combin group simul dataframerbindi_gr s_gr d_gr add group label simul dataframecbindidnrowsimul simul colnamessimul cid ncolsimul save data set simul readrwrite_csvsimul inputexamplesimulatedcsv visualis artifici dataset import alreadi save simul data import_simul read_csvfileinputexamplesimulatedcsv preview data headimport_simul tibbl x id dbl dbl dbl dbl dbl dbl dbl dbl dbl dbl dbl dbl variabl dbl dbl dbl dbl dbl dbl dbl dbl dbl dbl convert wideformat long simulated_long melttimport_simul idvarscid simulated_long simulated_long dplyrfilterxid dplyrrenametimex idx simulated_long dataframecbindsimulated_long group crepincreas repstabl repdecreas reorder level simulated_longtim factorsimulated_longtim level c ggplotsimulated_long aesx time valu groupid colorgroup geom_points geom_lin scale_color_manualvaluescef theme_light img srcmanfiguresreadmeunnamedchunkpng width perform cluster use akmedoid perform cluster analysi use akmedoid packag output akclustrimport_simul id_fieldtru verbos fals kc crit silhouett quality_plottru geom_smooth use formula x img srcmanfiguresreadmeunnamedchunkpng width remark entir output print consol type output check optim cluster size type outputoptimal_k show qualiti plot plotoutputqltyplot user may decid examin plot post cluster document r consol type akmedoid help packag packag page cran herehttpscranrprojectorgwebpackagesakmedoidsindexhtml packag refer manual herehttpscranrprojectorgwebpackagesakmedoidsakmedoidspdf packag vignett herehttpscranrprojectorgwebpackagesakmedoidsvignettesakmedoidsvignettehtml support contribut support bug report send email hrefmailtomonsuuryahoocom classemailmonsuuryahoocoma open issu herehttpsgithubcommanalyticsakmedoidsissu code contribut akmedoid also welcom refer rousseeuw p j silhouett graphic aid interpret valid cluster analysi journal comput appli mathemat linkhttpswwwbibsonomyorgbibtexbcfcfcdfda caliński j harabasz dendrit method cluster analysi commun statisticstheori method linkhttpswwwtandfonlinecomdoiab adepeju langton bannist j anchor kmedoid novel adapt kmean refin measur instabl exposur crime journal comput social scienc revis titl newsmd author geomad date th april output html_document akmedoid packag updat version v updat ad new sampl dataset use function exampl dataset includ clustr simul torisk traj_w_spac ad detail descript field dataset see format section dataset document chang citat adepeju et al adepeju et al base newli publish articl upon akmedoid packag base modifi name function eg akmedoidsclust chang akclustr statprint chang print_akstat popul chang popl ad two new function name remove_rows_n plot_akstat see document detail ensur name function lower case eg dataimput chang data_imput outlierdetect chang outlier_detect etc modifi exampl elbow_point function reduc run time faith monsuru test environ local os window r debian linux rdevel r winbuild devel releas r r cmd check result error warn note akmedoid packag updat th march new version v updat akmedoid packag updat version v updat ad new sampl dataset use function exampl dataset includ clustr simul torisk traj_w_spac ad detail descript field dataset see format section dataset document chang citat adepeju et al adepeju et al base newli publish articl upon akmedoid packag base modifi name function eg akmedoidsclust chang akclustr statprint chang print_akstat popul chang popl ad two new function name remove_rows_n plot_akstat see document detail ensur name function lower case eg dataimput chang data_imput outlierdetect chang outlier_detect etc modifi exampl elbow_point function reduc run time faith monsuru output github_docu output md_document readmemd gener readmermd pleas edit file r includ fals knitropts_chunkset collaps true comment figpath manfiguresreadm outwidth akmedoid badg start badg end r packag analyz cluster longitudin data descript akmedoid packag advanc cluster longitudin dataset order identifi cluster trajectori similar longterm linear trend time provid improv cluster identif compar classic kmean algorithm packag also includ set function address common data issu miss entri outlier prior conduct advanc longitudin data analysi one key object packag facilit easi replic recent paper examin small area inequ crime drop adepeju et al mani function provid akmedoid packag may appli longitudin data gener inform usabl check detail cranhttpscranrprojectorgwebpackagesakmedoidsindexhtml instal cran r consol type r echotru messagefals evaltru installpackagesakmedoid libraryakmedoid librari librarytidyr libraryggplot libraryreshap libraryreadr instal develop version packag type remotesinstall_githubmanalyticsakmedoid pleas report instal problem issu exampl usag given longitudin dataset follow exampl akmedoid could use extract cluster trajectori similar longterm trend time use simul dataset name simulatedrda store data directori gener artifici dataset simul data set compris three cluster distinct mean direct chang time group contain trajectori r echotru messagefals evaltru dircreateinput creat folder function creat longitudin nois noise_fn functionx time rnormlengthtim mean x function simul trajectori group sim_group functiongr_baselin sd time intcp_error rgamma shape scalesd intercept error mean_traj gr_baselin intcp_error traj mean_traj noise_fnintcp_error time time step t_step c increas group i_gr null fori seq_len i_gr rbindi_gr sim_groupgr_baselinet_step sd timet_step stabl group s_gr null fori seq_len s_gr rbinds_gr sim_groupgr_baselinereplengtht_step sd timet_step decreas group d_gr null fori seq_len d_gr rbindd_gr sim_groupgr_baselin t_step sd timet_step combin group simul dataframerbindi_gr s_gr d_gr add group label simul dataframecbindidnrowsimul simul colnamessimul cid ncolsimul save data set simul readrwrite_csvsimul inputexamplesimulatedcsv visualis artifici dataset r echotru messagefals evaltru import alreadi save simul data import_simul read_csvfileinputexamplesimulatedcsv preview data headimport_simul convert wideformat long simulated_long melttimport_simul idvarscid simulated_long simulated_long dplyrfilterxid dplyrrenametimex idx simulated_long dataframecbindsimulated_long group crepincreas repstabl repdecreas reorder level simulated_longtim factorsimulated_longtim level c ggplotsimulated_long aesx time valu groupid colorgroup geom_points geom_lin scale_color_manualvaluescef theme_light perform cluster use akmedoid perform cluster analysi use akmedoid packag r echotru messagetru evaltru output akclustrimport_simul id_fieldtru verbos fals kc crit silhouett quality_plottru remark entir output print consol type output check optim cluster size type outputoptimal_k show qualiti plot plotoutputqltyplot user may decid examin plot post cluster document r consol type akmedoid help packag packag page cran herehttpscranrprojectorgwebpackagesakmedoidsindexhtml packag refer manual herehttpscranrprojectorgwebpackagesakmedoidsakmedoidspdf packag vignett herehttpscranrprojectorgwebpackagesakmedoidsvignettesakmedoidsvignettehtml support contribut support bug report send email monsuuryahoocom open issu herehttpsgithubcommanalyticsakmedoidsissu code contribut akmedoid also welcom refer rousseeuw p j silhouett graphic aid interpret valid cluster analysi journal comput appli mathemat linkhttpswwwbibsonomyorgbibtexbcfcfcdfda caliński j harabasz dendrit method cluster analysi commun statisticstheori method linkhttpswwwtandfonlinecomdoiab adepeju langton bannist j anchor kmedoid novel adapt kmean refin measur instabl exposur crime journal comput social scienc revis titl guid measur longterm inequ exposur crime microarea level use akmedoid packag author author adepeju langton bannist j big data centr manchest metropolitan univers manchest bh date date r sysdat output rmarkdownhtml_vignett dev png output word_docu default always_allow_html ye pdf_document default always_allow_html ye fig_capt ye bibliographi referencesbib abstract akmedoid packag advanc set rfunction longitudin cluster longterm trajectori determin optim solut base calińskiharabasz criterion caliński harabasz packag also includ set function address common data issu miss entri outlier prior conduct advanc longitudin data analysi one key object packag facilit easi replic recent paper examin small area inequ crime drop see adepeju et al document creat provid guid toward accomplish object mani function provid akmedoid packag may appli longitudin data gener vignett vignetteindexentrya guid measur longterm inequ exposur crime microarea level use akmedoid packag vignetteengineknitrrmarkdown usepackageutfinputenc style typetextcss htitl fontsiz px lineheight color black textalign center hsubtitl fontsiz px lineheight color black textalign center hauthor header author data header use fontsiz px fontfamili arial color black textalign center hdate header author data header use fontsiz px fontfamili arial time serif color black textalign center habstract header author data header use fontsiz px fontfamili arial time serif color black textalign center hinstitut header author data header use fontsiz px fontfamili arial time serif color black textalign center bodi td fontsiz px coder fontsiz px pre fontsiz px h header fontsiz px color darkblu h header fontsiz px color darkblu h header fontsiz px fontfamili time new roman time serif color darkblu style r setup includ fals knitropts_chunkset collaps true comment r function includefals function caption referenc imag fig local ref list list capfunctionrefnam text refrefnam pastefigur text sep reffunctionrefnam refrefnam introduct longitudin cluster analysi ubiquit social behavior scienc investig development process phenomenon time exampl commonli use techniqu area includ groupbas trajectori model gbtm nonparametr kmean method whilst kmean number benefit gbtm relax statist assumpt gener implement render sensit outlier shortterm fluctuat minimis abil identifi longterm linear trend data crime place research exampl identif longterm linear trend may help develop theoret understand crimin victim within geograph space weisburd griffith order address sensit problem advanc novel techniqu name anchor kmedoid akmedoid implement three key modif exist longitudin kmean approach first approxim trajectori use ordinari least squar regress ol second anchor initialis process median observ deploy medoid observ new anchor iter expectationmaxim procedur celeux modif ensur impact shortterm fluctuat outlier minim link final group back origin trajectori clearer delin longterm linear trend trajectori obtain facilit easi use akmedoid opensourc packag use r encourag use packag outsid criminolog appropri outlin main cluster function demonstr use data manipul function assist data prepar work demonstr use small exampl dataset allow user get clear understand oper function r evaltru echofals includefals installpackageskableextra requireknitr librarygdtool librarykableextra libraryclustercrit librarydplyr r echofals includefals col c col cdata_imputationr prop outlier_detectw_spac remove_rows_n col cdata imput longitudin data convers count rate convers count rate proport outlier detect replacementwhitespac remov incomplet row remov col ccalcul miss entri na inf null longitudin data accord specifi methodcalcul rate observ count associ denomin data convert count rate observ proport identifi outlier observ data replac remov themremov lead trail whitespac longitudin data remov row contain na inf entri tble dataframecol col col col tble tble r tabl resultsasi echofals tidyoptslistwidthcutoff knitrkabletbl caption tabl data manipul function colnam csnfunctiontitledescript kable_stylingfull_width f column_spec bold border_right column_spec width em background white column_spec width em background white column_spec width em background white row_spec bold color white background de data manipul tabl show main data manipul function descript function help address common data issu prior analysi well basic data manipul task convert longitudin data count proport measur per crime inequ paper akmedoid first implement order demonstr util function provid simul dataset traj call type traj r consol load akmedoid librari data_imput function calcul miss entri data accord chosen method function recogn three kind data entri miss na inf null option whether consid miss valu function provid replac option miss entri use two method first arithmet method use mean minimum maximum valu correspond row column miss valu second regress method use ol regress line estim miss valu use regress method miss data point deriv valu regress line remain observ data point retain origin valu function termin trajectori one observ use traj dataset demonstr regress method estim miss valu r evalfals instal akmedoid packag installpackagesdevtool devtoolsinstall_githubmanalyticsakmedoid r evaltru load packag libraryakmedoid r evaltru import preview first row traj object datatraj headtraj row nrowtraj column ncoltraj first column traj object id uniqu field mani applic necessari preserv id column order allow link output extern dataset spatial locat data function akmedoid provid option recognis first column input dataset uniqu field data_imput function use imput miss data point traj object follow r evaltru imp_traj data_imputationtraj id_field true method replace_with fill_zero fals imp_traj imp_trajcompletedata view first row headimp_traj r fig echofals figwidthfigheightfigaligncent figcapfigcapfig data imput regress parmarc paradj parmfrowc devnew dat asdataframetraj t_name asvectortraj dat datncoldat ifknrowdat headdat fork seq_lennrowdat k suppresswarningsasnumericascharacterdatk x seq_lenlengthi known dataframex known_ dataframeknownisnaknownisinfiniteknown known_ dataframeknownisnaknownisinfiniteknown train avail data use linear regress modellm lmi x data known_ use predict valu remov data newi predictmodellm newdata dataframex known_ l_pred predictmodellm newdata datafram line add origin data datk known_ newi add predict point origin data devnew plot col optionsrglusenul true plot knownx knowni typeo mainpastetraj_idt_namek sep fontmain iflengthnewyplot element linesl_pr ltydot colr lwd pointsknown_ newi col red point legend plot_color cblackr text cobserv point predict point optionsrglusenul true parxpdtru legendcenterlegend text textwidth maxsapplytext strwidth colplot_color pch cex horiz fals parxpdfals line legend plot_color cblackr text cline join observ point regress line predict miss point optionsrglusenul true plotnew parxpdtru legendcenterlegend text textwidth maxsapplytext strwidth colplot_color lwd cex ltyc horiz fals parxpdfals argument method refer regress techniqu argument replace_with refer linear option current avail option figur r figreffig graphic illustr method approxim miss valu traj object estim popul data use data_imput function obtain denomin inform eg popul estim normal count local area within citi noncensu year problemat longitudin studi challeng pose signific drawback accur estim variou measur crime rate populationatrisk infecti diseas assum limit amount denomin inform avail altern way obtain miss data point interpol andor extrapol miss popul inform use avail data point data_imput function use perform task key step toward use function purpos creat matrix contain avail field miss field arrang appropri order entri miss field fill either na null demonstr task sampl popul dataset two avail data field correspond input matrix construct shown r evaltru import popul data datapopl preview data headpopl nrowpopl row ncolpopl column correspond input dataset prepar follow save popul r echofals creat matrix row column traj data pop asdataframematrix nrowpopl ncoltraj colnamespop namestraj pop asvectorascharacterpopl pop asvectorascharacterpopl pop asvectorascharacterpopl list_ c foru_ seq_lenlengthlist_ u_ poplist_u_ na headpop popul pop miss valu estim follow use regress method data_imput function r evaltru pop_imp_result data_imputationpopul id_field true method replace_with fill_zero fals pop_imp_result pop_imp_resultcompletedata view first row headpop_imp_result given two data point row regress method simpli gener miss valu fit straight line avail data point higher number avail data point trajectori better estim miss point figur r figreffig illustr estim process ii rate function given longitudin data mtime n associ denomin data stime n rate function convert longitudin data rate measur eg count per resid longitudin denomin data may contain differ number row need number column must includ id uniqu field first column row sort particular order rate measur ie output contain row whose id match dataset demonstr util function use imp_traj object estim popul data pop_imp_result r evaltru exampl estim crime per resid crime_per__peopl ratesimp_traj denominpop_imp_result id_fieldtru multipli view full output crime_per__peopl crime_per__peoplerates_estim check number row nrowcrime_per__peopl output observ number row output data impli location_id match two dataset unmatch id ignor note calcul rate often return output cell entri inf na valu due calcul error charact valu data therefor recommend user rerun data_imput function gener rate measur especi larg data matrix iii prop function given longitudin data prop function convert data point ie entri cell proport sum correspond column use crime_per__peopl estim deriv proport crime per peopl entri follow r evaltru proport crime per resid prop_crime_per_peopl propscrime_per__peopl id_field true scale digit view full output prop_crime_per_peopl quick check sum column proport measur add colsumsprop_crime_per_peoplencolprop_crime_per_peopl line demonstr adepeju et al use proport measur demonstr main cluster function packag iv outlier_detect function function aim allow user identifi outlier observ longitudin data replac remov accordingli first step toward identifi outlier data visual data user decid cutoff valu isol outlier outlier_detect function provid two option quantil method isol observ valu higher specifi quantil data valu distribut ii manual method user specifi cutoff valu replace_with argument use determin whether outlier valu replac mean valu row mean valu column outlier locat user also option simpli remov trajectori contain outlier valu decid whether trajectori contain outlier count argument allow user set horizont threshold ie number outlier valu must occur trajectori order trajectori consid outlier observ demonstr util outlier_detect function use imp_traj data v w_space function given matrix suspect contain whitespac function remov whitespac return clean data whitespac white charact often introduc data entri instanc wrongli press spacebar exampl neither equat whitespac exist also result systemat error data record devic vi remove_rows_n function function remov row na inf entri found r fig echotru figwidthfigheightfigaligncent figcapfigcapfig identifi outlier plot data use ggplot librari libraryggplot libraryreshap convert wide data format stack format plot manual instead use melt function reshap imp_traj_long meltimp_traj idlocation_id coln colnamesimp_trajlengthcolnamesimp_traj code_ repimp_trajlocation_id ncolimp_traj d_bind null forv seq_lenncolimp_traj d_bind cd_bind asnumericimp_trajv code dataframelocation_idsascharactercode_ variabl dataframevariableascharacterrepcoln eachlengthimp_trajlocation_id valuedataframevalu asnumericd_bind imp_traj_long bind_colscod variablevalu view first row headimp_traj_long plot function p ggplotimp_traj_long aesxvari yvalu grouplocation_id colorlocation_id geom_point geom_lin optionsrglusenul true printp figur r figreffig output plot function base figur r figreffig assum observ x x x trajectori id e outlier set threshold argument case set count suffic trajectori clearli separ rest trajectori r fig echotru figwidthfigheightfigaligncent figcapfigcapfig replac outlier mean observ imp_traj_new outlier_detectimp_traj id_field true method threshold count replace_with imp_traj_new imp_traj_newoutliers_replac optionsrglusenul true printimp_traj_new imp_traj_new_long meltimp_traj_new idlocation_id coln colnamesimp_traj_newlengthcolnamesimp_traj_new code_ repimp_traj_newlocation_id ncolimp_traj_new d_bind null forv seq_lenncolimp_traj_new d_bind cd_bind asnumericimp_traj_newv code dataframelocation_idsascharactercode_ variabl dataframevariableascharacterrepcoln eachlengthimp_traj_newlocation_id valuedataframevalu asnumericd_bind imp_traj_new_long bind_colscod variablevalu plot function optionsrglusenul true p ggplotimp_traj_new_long aesxvari yvalu grouplocation_id colorlocation_id geom_point geom_lin optionsrglusenul true printp set replace_with replac outlier point mean row observ function gener output replot figur r figreffig vii function pleas see akmedoid user manual remain data manipul function data cluster tabl show two main function requir carri longitudin cluster gener descript statist result group relev function akclustr print_akstat akclustr function cluster trajectori accord similar longterm trend print_akstat function extract descript chang statist cluster former also gener qualiti plot best cluster solut longterm trend trajectori defin term set ol regress line allow cluster function classifi final group term slope rise stabl fall key benefit implement allow cluster process ignor shortterm fluctuat actual trajectori focu longterm linear trend adepeju colleagu appli techniqu crime concentr research measur longterm inequ exposur crime findgrain spatial scale r fig echofals figcapfigcapfig pastelongtim linear trend rel proport p crime exposur three inequ trend trajectori crime exposur fall faster crime exposur fall rate crime exposur fall slower increas rel citywid trend sourc adepeju et al sep outwidth figaligncent knitrinclude_graphicsinequalitypng implement inform conceptu inequ framework shown figur r figreffig said akmedoid deploy measur count rate limit criminolog rather field aim cluster longitudin data base longterm trajectori map result trend line group origin trajectori variou perform statist gener addit use trend line akmedoid make two modif expectationmaximis cluster routin celeux first akmedoid implement anchor medianbas initialis strategi cluster begin purpos behind step give algorithm theoreticallydriven start point tri ensur heterogen trend slope end differ cluster khan steinley second instead recomput centroid base mean distanc trajectori trend line cluster center median cluster select use next centroid becom new anchor current iter expectationmaximis step celeux strategi implement order minim impact outlier iter continu object function maximis r echofals includefals col c col cakclustrprint_akstat plot_akstat col canchor kmedoid clusteringdescript chang statist cluster plot cluster group col ccluster trajectori k number group accord similar longterm trend determin best solut base silhouett width measur calinskiharabasz criteriongener descript chang statist group also plot group perform gener differ plot cluster group tble dataframecol col col col tble tble r tabl resultsasi echofals tidyoptslistwidthcutoff knitrkabletbl caption tabl data cluster function colnam csnfunctiontitledescript kable_stylingfull_width f column_spec bold border_right column_spec width em background white column_spec width em background white column_spec width em background white row_spec bold color white background de r fig echotru figwidthfigheightfigaligncent figcapfigcapfig trajectori crime proport time visual proport data view first row headprop_crime_per_peopl prop_crime_per_people_melt meltprop_crime_per_peopl idlocation_id coln colnamesprop_crime_per_peoplelengthcolnamesprop_crime_per_peopl code_ repprop_crime_per_peoplelocation_id ncolprop_crime_per_peopl d_bind null forv seq_lenncolprop_crime_per_peopl d_bind cd_bind prop_crime_per_peoplev prop_crime_per_people_melt dataframecbindlocation_idsascharactercode_ variabl repcoln eachlengthprop_crime_per_peoplelocation_id valued_bind plot function optionsrglusenul true p ggplotprop_crime_per_people_melt aesxvari yvalu grouplocation_id colorlocation_id geom_point geom_lin optionsrglusenul true printp follow section provid work exampl cluster akclustr function use prop_crime_per_peopl object function gener cluster solut set k valu determin optim valu k print_akstat function appli gener descript summari chang statist cluster prop_crime_per_peopl object plot r figreffig akclustr function dataset trajectori figur r figreffig repres proport crime per resid locat time goal first extract inequ trend line figur r figreffig cluster accord similar slope akclustr function user set k valu may integ vector length two specifi minimum maximum number cluster loop latter case akclustr function employ either silhouett rousseeuw calinski_harabasz score calinski genolini determin best cluster solut word determin k valu optim specifi criterion verbos argument use control process messag function execut follow r echotru includetru cluster akobj akclustrprop_crime_per_peopl id_field true method linear k c crit calinski_harabasz verbosetru order preview variabl quality_plot object type r echotru messagetru evaltru namesakobj descript variabl follow traj return input data set use cluster id_field indic whether input data set includ id field solut list cluster solut k valu qualitycriterion qualiti criterion specifi optimal_k optim valu k determin qualiti criterion qualitycritlist estim qualiti cluster solut k valu qltyplot plot qualitycritlist red vertic line indic optim valu k access optim solut qualitycritlist view graphic set quality_plot argument true also plot may still access cluster print variabl akobjqltyplot r fig echofals figcapfigcapfig cluster perform differ valu k outwidth figaligncent knitrinclude_graphicscaliharapng figur r figreffig best valu k highest k therefor determin best solut recommend determin base either qualiti criteria use complementarili user judgment relat problem hand given valu k group membership label cluster solut extract enter k k variabl akobjsolutionsk eg r echotru includetru group cluster akobjsolut k solut also note index group membership correspond trajectori object prop_crime_per_peopl input function membership label group membership trajectori eee object prop_crime_per_peopl ii print_akstat function properti ie descript chang statist cluster solut ie solut valu k k gener use special print function print_akstat print function take input akobject class eg akobj descript statist show group membership perform term share proport measur captur time chang statist show inform regard direct varianc group relat refer direct trajectori cluster analysi result group often reclassifi larger class base slope decreas stabl increas class weisburd andresen et al slope group angl made medoid group rel refer line r refer argument specifi repres mean trajectori medoid trajectori horizont line slope respect let vartheta_ vartheta_n repres angular deviat group medoid lowest slope neg highest posit slope respect r fig echofals figcapfigcapfig quantil subdivis mostdiverg group n_quant outwidth figaligncent knitrinclude_graphicsnquantpng subdivid slope specifi number equal interv quantil specif interv within group medoid fall determin specif made use n_quant argument figur r figreffig illustr quantil subdivis n_quant addit slope composit trajectori found group quantil locat group medoid use categor group larger class refer user packag user manual detail paramet use current exampl function ran follow r echotru includetru specifi optim solut outputoptimal_k ie k use stack type graph prpti print_akstatsakobj k show_plot fals prpti r fig echofals evalfals includefals figcapfigcapfigsgroup membership outwidth figaligncent knitrinclude_graphicstraj_perfmpng iii plot_akstat function printout repres properti ie descript chang properti cluster note show_plot argument print_akstat function set true produc plot group trajectori repres group direct chang time howev plot_akstat design gener differ perform plot group see group trajectori direct chang time r echotru includetru figwidthfigheightfigaligncent optionsrglusenul true plot_akstatsakobj k typelin y_scalingfix b proport chang group chang time r echotru includetru figwidthfigheightfigaligncent optionsrglusenul true plot_akstatsakobj k refer n_quant typestack context longterm inequ studi broad conclus made statist properti plot regard rel crime exposur area repres group class adepeju et al exampl whilst rel crime exposur declin group b studi area rel crime exposur risen group e area rel crime exposur said stabl group c area base close proxim refer line medoid group fall within stve quantil see figur r figreffig essenc determin group b belong decreas class group e belong increas class import state propos classif method simpli advisori may devis differ approach interpret depend research question data r fig echofals evalfals includefals figcapfigcapfig group qualiti time outwidth figaligncent knitrinclude_graphicstraj_perfmpng chang argument typelin typestack qualiti plot gener instead see figur r figreffig note plot make use function within ggplot librari wickham custom visual recommend user deploy ggplot librari directli r echofals includefals col c col cgroup n n proptim proptimet chang chang traj traj qtlstth col cgroup membershp size nooftrajectori size proport ob time proport ob time absolut chang proport time timet chang proport time time trajectori posit slope trajectori neg slope posit group medoid quantil subdivis tble dataframecol col col tble tble r tabl resultsasi echofals tidyoptslistwidthcutoff knitrkabletbl caption tabl field descript cluster output colnam csnfielddescript kable_stylingfull_width f column_spec bold border_right column_spec width em background white column_spec width em background white row_spec bold color white background de conclus akmedoid packag develop order aid replic placebas crime inequ investig conduct adepeju meanwhil util function packag limit criminolog rather applic longitudin dataset gener packag updat regular basi add function exist function add new function carri longitudin data analysi encourag user report bug encount use packag fix immedi welcom contribut packag acknowledg accordingli refer gener roxygen edit hand pleas edit document rprint_akstatsr nameprint_akstat aliasprint_akstat titledescript chang statist usag print_akstatsak_object k refer n_quant show_plot fals argument itemak_objectan output codelinkakclustr function object contain individu trajectori cluster solut specifi valu codek also includ optim valu codek base criterion specifi differ valu codek codetraj itemkinteg codek cluster gener solut itemreferencenumer specifi refer line direct group measur option code slope mean trajectori code slope medoid trajectori code slope horizont line ie slope default code itemn_quantnumer number equal interv quantil creat refer line coder medoid codem mostdiverg group side coder default code mean quartil subdivis side coder scenario function return quartil medoid group fall result use categor group class exampl group fall within codest quartil may classifi stabl group adepeju et al itemshow_plotstru fals provid trajectori group plot pleas see codeplot_akstat function plot option default codefals valu plot show group membership size proport statist descript function perform two task gener descript chang statist group particularli suit output form codelinkakclustr function ii gener plot group perform detail gener plot trajectori group given codeak_object class codeakclustr function function show plot cluster group plot compon draw codeplot_akstat function exampl datatraj trajectri data_imputationtraj id_field true method replace_with fill_zero fals printtrajectrycompletedata trajectri propstrajectrycompletedata id_field true aksolut akclustrtrajectri id_field true method linear k c critcalinski_harabasz print_akstatsaksolut k show_plotsfals refer code adepeju et al anchor kmedoid novel adapt kmedoid refin measur inequ exposur crime across micro place doi code wickham h eleg graphic data analysi springverlag new york gener roxygen edit hand pleas edit document rremove_rows_nr nameremove_rows_n aliasremove_rows_n titleremov row contain na andor inf entri usag remove_rows_ntraj id_fieldtru remov argument itemtrajdatafram numer longitudin data row repres individu trajectori observ column show observ consecut time point itemid_fieldnumer charact whether first column codetraj uniqu codeid field default codefals codetru function recognis second column first time step itemremoveinteg type miss entri remov code na code inf code defaultcod valu matrix complet observ descript function remov row na inf entri found function also abl remov record inf entri distinguish popular naomit function r detail given matrix datafram contain na inf entri function return row complet observ exampl datatraj remove_rows_ntraj id_fieldtru remov gener roxygen edit hand pleas edit document rplot_akstatsr nameplot_akstat aliasplot_akstat titleplot cluster group usag plot_akstat ak_object k refer n_quant type line y_scale fix argument itemak_objectan output codelinkakclustr function object contain individu trajectori cluster solut specifi valu codek also includ optim valu codek base criterion specifi differ valu codek codetraj itemkinteg codek cluster gener solut itemreferencenumer specifi refer line direct group measur option code slope mean trajectori code slope medoid trajectori code slope horizont line ie slope default code itemn_quantnumer number equal interv quantil creat refer line coder medoid codem mostdiverg group side coder default code mean quartil subdivis side coder scenario function return quartil medoid group fall result use categor group class exampl group fall within codest quartil may classifi stabl group adepeju et al itemtypecharact plot type avail option codelin codestack itemy_scalingcharact work codetypelin codey_sc set vertic scale cluster panel option codefix use uniform scale panel codefre use variabl scale panel valu plot show group membership size proport statist descript take ak_object codeakclustr input produc either line plot stack histogram detail gener plot cluster group plot gener codeshow_plot argument codeprint_akstat function draw function codeggplot librari custom visualis recommend user deploy codeggplot directli codewickham h exampl datatraj trajectri data_imputationtraj id_field true method replace_with fill_zero fals printtrajectrycompletedata trajectri propstrajectrycompletedata id_field true aksolut akclustrtrajectri id_field true method linear k c critcalinski_harabasz plot_akstatsaksolut k typelin y_scalingfix plot_akstatsaksolut k refer n_quant typestack refer code adepeju et al anchor kmedoid novel adapt kmedoid refin measur inequ exposur crime across micro place doi code wickham h eleg graphic data analysi springverlag new york gener roxygen edit hand pleas edit document rpropsr nameprop aliasprop titleconvers count rate proport usag propstraj id_field true scale digit argument itemtrajmatrix numer longitudin data row repres individu trajectori observ column show observ consecut time point itemid_fieldnumer charact whether first column codetraj uniqu codeid field default codefals codetru function recogn second column first time step itemscalenumer scale proport measur default code itemdigitsnumer specifi number digit approxim output default code valu datafram proport measur descript function convert count rate proport detail given matrix observ count rate function convert observ proport equival sum column word observ divid sum column locat ie codeprop cell valu sumcorrespond column exampl trajectri data_imputationtraj id_field true method replace_with fill_zero fals fill miss valu trajectri propstrajectrycompletedata id_field true scale digit printtrajectri gener roxygen edit hand pleas edit document rdatar doctypedata nameclustr aliasclustr titlesampl label cluster group format datafram contain one variabl item item label alphabet label cluster usag clustr descript datafram alphabet label repres optim solut traj dataset base akclust function keyworddataset gener roxygen edit hand pleas edit document rdatar doctypedata nametorisk aliastorisk titletimeatrisk adjud toronto youth data sampl format datafram follow variabl item item timeatrisk per year age item timeatrisk per year age item timeatrisk per year age item timeatrisk per year age item timeatrisk per year age item timeatrisk per year age item timeatrisk per year age item timeatrisk per year age item timeatrisk per year age item timeatrisk per year age item timeatrisk per year age item timeatrisk per year age item timeatrisk per year age item timeatrisk per year age item timeatrisk per year age item timeatrisk per year age item timeatrisk per year age item timeatrisk per year age item timeatrisk per year age item timeatrisk per year age item timeatrisk per year age item timeatrisk per year age item timeatrisk per year age item timeatrisk per year age item timeatrisk per year age item timeatrisk per year age item timeatrisk per year age item timeatrisk per year age item timeatrisk per year age item timeatrisk per year age item timeatrisk per year age usag torisk descript reallif timeatrisk per year individu age toronto ontario canada data obtain r packag crimcv inform pleas see nielsen j crimcv groupbas model longitudin data r packag version url httpscranrprojectorgpackagecrimcv keyworddataset gener roxygen edit hand pleas edit document ralpha_labelr namealpha_label aliasalpha_label titlenumer id alphabet id usag alpha_labelx argument itemxa vector numer id valu vector alphabet id descript function transform list numer id alphabet id detail given vector numer cluster id alpha_label convert id correspond alphabet combin alphabet id greater exampl datatorisk setse pick random cluster center toriskrunifnrowtorisk assign individu nearest centr numeric_label kmlaffectindivctorisk center modenumeric_label transform numer cluster label alphabet alphab_label alpha_labelnumeric_label modealphab_label gener roxygen edit hand pleas edit document relbow_pointr nameelbow_point aliaselbow_point titledetermin elbow point curv usag elbow_pointx argument itemxvector x coordin point curv itemyvector coordin point curv valu indic optim k valu determin elbow point point descript given list x coordin curv function determin elbow point curv detail highlight maximum curvatur identifi elbow point credit githubcomagentlan exampl gener curv x runif min max expx rnorm plotx plot elbow point ablinevelbow_pointxyy colblu pch cex gener roxygen edit hand pleas edit document rratesr namer aliasr titleconvers count rate usag ratestraj denomin id_field multipli argument itemtrajmatrix numer longitudin eg observ count data codem x n row repres individu trajectori observ column show observ consecut time step itemdenominmatrix numer longitudin denomin data column traj coden itemid_fieldnumer charact default codetru first column traj denomin object must uniqu codeid field codefals function termin assumpt column codetraj codedenominat correspond column column repres time point respect object itemmultipliernumer quantifi ratio codetrajdenomin express default code valu object compris four output variabl name common_id individu id present traj trajectori data denomin denomin data ii ids_unique_to_traj_data individu id uniqu trajectori data ie present denomin data iii ids_unique_to_denom_data individu id uniqu denomin data ie present trajectori data iv datafram rate estim note individu id rates_estim use rate estim descript calcul rate observ count denomin data exampl traj data_imputationtraj id_field true method replace_with fill_zero fals pop popl read denomin data pop asdataframematrix nrowpopl ncoltraj colnamespop namestrajcompletedata pop asvectorascharacterpop pop asvectorascharacterpop pop asvectorascharacterpop list_ c vector miss year fill miss field na foru_ seq_lenlengthlist_ poplist_u_ na estim miss field pop_imp_result data_imputationpop id_field true method replace_with fill_zero fals calcul rate ie crime per popul crime_r ratestrajcompletedata denominpop_imp_resultcompletedata id_fieldtru multipli gener roxygen edit hand pleas edit document rdata_imputationr namedata_imput aliasdata_imput titledata imput longitudin data usag data_imputationtraj id_field fals method replace_with fill_zero fals verbosetru argument itemtrajcodematrix numer longitudin data row repres individu trajectori observ column show observ consecut time point itemid_fieldnumer charact whether first column codetraj uniqu codeid field default codefals codetru function recognis second column first time step itemmethodan integ indic method calcul miss valu option code codearithmet method code coderegress method default code codearithmet method itemreplace_withan integ indic techniqu base specifi codemethod calcul miss entri code codearithmet method codereplace_with option code mean valu correspond column code minimum valu correspond column code maximum valu correspond column code mean valu correspond row code minimum valu correspond row code maximum valu correspond row code regress method avail option codereplace_with code codelinear regress method fit linear regress line trajectori miss entri estim miss data valu regress line note miss data point deriv new valu regress line rest data point retain origin valu function termin trajectori one observ default code mean valu correspond column itemfill_zerostru fals whether consid zero code miss valu code regress method use default codefals itemverboseto suppress print output messag consol default codetru valu datafram miss valu codena codeinf codenul imput accord specifi techniqu descript function fill miss entri codena codeinf codenul matrix datafram accord specifi method default code consid valu detail given matrix datafram miss valu indic codena codeinf codenul function imput miss valu use either estim correspond row column use regress method estim miss valu exampl use exampl traj dataset imp_data data_imputationtraj id_field true method replace_with fill_zero fals verbosefals gener roxygen edit hand pleas edit document routlier_detectr nameoutlier_detect aliasoutlier_detect titleoutli detect replac usag outlier_detecttraj id_field fals method threshold count replace_with verbosetru argument itemtrajmatrix numer longitudin data row repres individu trajectori observ column show observ consecut time point itemid_fieldnumer charact whether first column codetraj uniqu codeid field default codefals codetru function recogn second column first time step itemmethodinteg numer indic method identifi outlier option code quantil method codedefault code manual method codemanu method requir userdefin valu itemthresholdnumer cutoff valu outlier codemethod paramet set codequantil codethreshold numer vector probabl code whilst codemethod set code codemanu codethreshold could numer vector itemcountinteg numer indic number observ trajectori must exceed codethreshold order trajectori consid codeoutli default code itemreplace_withinteg numer indic techniqu use calcul replac outlier observ remain observ row column outlier observ locat use calcul replac replac option code mean valu column code mean valu row code remov row trajectori complet data default valu code option itemverboseto suppress output messag consol default codetru valu datafram outlier observ replac remov descript function identifi outlier observ trajectori allow user replac observ remov trajectori entir detail given matrix function identifi outlier exceed threshold replac outlier estim calcul use observ either row column outlier observ locat option also provid remov trajectori contain outlier data exampl datatraj trajectri data_imputationtraj id_fieldtru method replace_with verbosefals trajectri propstrajectrycompletedata id_fieldtru outp outlier_detecttrajectri id_field true method threshold count replace_with verbosetru outp outlier_detecttrajectri id_field true method threshold count replace_with verbosetru gener roxygen edit hand pleas edit document rdatar doctypedata namepopl aliaspopl titlesimul popul data format datafram follow variabl item item location_id charact id sampl censu unit popul obtain item census_ popul estim sampl locat censu year item census_ popul estim sampl locat censu year usag popl descript sampl simul popul data use denomin variabl traj dataset contain data two consecut censu year keyworddataset gener roxygen edit hand pleas edit document rdatar doctypedata namesimul aliassimul titlesimul longitudin dataset format datafram follow variabl item item x valu across locat time step item x valu across locat time step item x valu across locat time step item x valu across locat time step item x valu across locat time step item x valu across locat time step item x valu across locat time step item x valu across locat time step item x valu across locat time step item x valu across locat time step item x valu across locat time step item x valu across locat time step item x valu across locat time step item x valu across locat time step item x valu across locat time step item x valu across locat time step item x valu across locat time step item x valu across locat time step item x valu across locat time step item x valu across locat time step item x valu across locat time step usag simul descript contain simul trajectori belong one three predefin group name decreas b stabl c increas group keyworddataset gener roxygen edit hand pleas edit document rdatar doctypedata nametraj aliastraj titlesampl longitudin dataset format datafram follow variabl item item location_id charact id sampl locat valu obtain item x valu time step ie year item x valu time step ie year item x valu time step ie year item x valu time step ie year item x valu time step ie year item x valu time step ie year item x valu time step ie year item x valu time step ie year item x valu time step ie year usag traj descript simul longitudin dataset contain trajectori miss valu codena codeinf codenul keyworddataset gener roxygen edit hand pleas edit document rw_spacesr namew_spac aliasw_spac titlewhitespac remov usag w_spacestraj removeboth verbosetru argument itemtrajmatrix numer longitudin data row repres individu trajectori observ column show observ consecut time point itemremovecharact type whitespac remov left lead right trail lead trail whitespac default itemverboseto suppress output messag consol default codetru valu matrix whitespac remov descript function remov lead trail whitespac data detail given matrix suspect contain whitespac function remov type whitespac specifi return clean data whitespac white charact often introduc data data entri instanc wrongli press spacebar exampl neither whitespac exist also result systemat error data record devic exampl datatraj_w_spac w_spacestraj_w_spac removeboth verbosetru refer urlhttpsenwikipediaorgwikiwhitespace_charact gener roxygen edit hand pleas edit document rakclustrr nameakclustr aliasakclustr titleanchor kmedoid cluster usag akclustrtraj id_field fals method linear k c critsilhouett verbos true quality_plotfals argument itemtrajmatrix numer longitudin data row repres individu trajectori observ column show observ consecut time step itemid_fieldnumer charact whether first column codetraj uniqu codeid field default codefals codetru function recogn second column first time point itemmethodcharact parametr initi strategi current avail method codelinear method set codelinear use timedepend linear regress line result group order order increas slope itemkinteg vector numer either exact integ number cluster vector length two specifi minimum maximum number cluster examin best solut determin either case minimum number cluster code default codec itemcritcharact string specifi type criterion use assess qualiti cluster solut codek vector two valu default codecritsilhouett use averag silhouett width coderousseeuw p j use codesilhouett criterion optim valu codek determin elbow point curv valid criterion calinski_harabasz codecaliński harabasz j maximum score repres point optim determin optim codek function rerun use exact optim valu codek itemverboseto suppress output messag consol cluster default codetru itemquality_plotwheth show plot qualiti criteria across differ valu codek default codefals valu gener codeakobject consist cluster solut specifi valu codek also graphic plot qualiti score cluster solut descript given list trajectori function method function cluster trajectori codek number group vector two number given function determin best solut option base calińskiharabasz criterion detail function work first approxim trajectori base chosen parametr form eg linear partit origin trajectori base form group similar fashion kmean cluster codegenolini et al key distinct codeakmedoid compar exist longitudin approach initi start point well subsequ cluster center iter progress base select observ medoid oppos centroid exampl datatraj trajectri data_imputationtraj id_field true method replace_with fill_zero fals trajectri propstrajectrycompletedata id_field true printtrajectri output akclustrtrajectri id_field true method linear k c critcalinski_harabasz verbos fals quality_plotfals printoutput refer code genolini c et al kml kmld r packag cluster longitudin data journal statist softwar url httpwwwjstatsoftorgvi code rousseeuw p j silhouett graphic aid interpret valid cluster analysi j comput appl math code caliński harabasz j dendrit method cluster analysi commun stat gener roxygen edit hand pleas edit document rdatar doctypedata nametraj_w_spac aliastraj_w_spac titlesampl longitudin dataset contain whitespac format datafram follow variabl item item location_id charact id sampl locat valu obtain item x valu time step ie year item x valu time step ie year item x valu time step ie year item x valu time step ie year item x valu time step ie year item x valu time step ie year item x valu time step ie year item x valu time step ie year item x valu time step ie year usag traj_w_spac descript longitudin dataset trail lead whitespac exampl trail whitespac cell lead whitespac cell keyworddataset