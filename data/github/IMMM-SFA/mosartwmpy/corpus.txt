buildhttpsgithubcomimmmsfamosartwmpyactionsworkflowsbuildymlbadgesvghttpsgithubcomimmmsfamosartwmpyactionsworkflowsbuildyml codecovhttpscodecovioghimmmsfamosartwmpybranchmaingraphbadgesvgtokenipoymbhttpscodecovioghimmmsfamosartwmpi doihttpsjosstheojorgpapersjossstatussvghttpsdoiorgjoss doihttpszenodoorgbadgesvghttpszenodoorgbadgelatestdoi mosartwmpi mosartwmpi python translat mosartwm model water rout reservoir manag written fortran origin code found iwmmhttpsgithubcomimmmsfaiwmm esmhttpsgithubcomesmprojectesm mosart river rout compon larger suit earthscienc model motiv rewrit larg develop conveni run debug ad new capabl becom increasingli difficult due complex codebas lack familiar fortran version aim intuit lightweight well document still highli interoper quick start check jupyt notebook tutorialhttpsgithubcomimmmsfamosartwmpyblobmainnotebookstutorialipynb get start ensur python avail consid use virtual environmenthttpsgithubcompyenvpyenv see doc herehttpsmosartwmpyreadthedocsioenlatestvirtualenvhtml brief tutori instal mosartwmpi shell pip instal mosartwmpi altern instal via conda shell conda instal c condaforg mosartwmpi download sampl input dataset span may run follow select option tutori download unpack input current directori option specifi path download extract instead current directori shell python mosartwmpydownload set defin merger mosartwmpyconfig_defaultsyaml user specifi file overrid default set creat configyaml file defin simul chose altern download directori step need updat path point data configyaml yaml simul name tutori start_dat end_dat grid path inputdomainsmosartnc land path inputdomainslandnc runoff read_from_fil true path inputrunoffrunoff__nc water_manag enabl true demand read_from_fil true path inputdemanddemand__nc reservoir enable_istarf true paramet path inputreservoirsreservoirsnc depend path inputreservoirsdependency_databaseparquet streamflow path inputreservoirsmean_monthly_reservoir_flowparquet demand path inputreservoirsmean_monthly_reservoir_demandparquet mosartwmpi implement basic model interfacehttpscsdmscoloradoeduwikibmi defin csdm drive familiar accustom bmi launch simul open python shell run follow python mosartwmpi import model path configur yaml file config_fil configyaml initi model mosart_wm model mosart_wminitializeconfig_fil advanc model one timestep mosart_wmupd advanc simulationend_d specifi configyaml mosart_wmupdate_untilmosart_wmget_end_tim model input input mosartwmpi consist mani file defin characterist discret grid river network surfac subsurfac runoff water demand damsreservoir current grid data expect provid spatial resolut runoff input provid time resolut timestep select runoff closest time past current demand input read monthli also pad closest time past effort way robust demand handl damsreservoir requir four differ input file physic characterist averag monthli flow expect simul period averag monthli demand expect simul period databas map grand id grid cell id allow extract water damreservoir input file gener raw grand data raw elev data raw istarf data use provid utilitymosartwmpyutilitiescreate_grand_parametersmd best way understand expect format input file examin sampl input provid download util python mosartwmpydownload model output default key model variabl output monthli basi daili averag resolut outputsimul namesimul name_year_monthnc see configur file exampl modifi output mosartwmpystatestatepi file state variabl name altern certain model output deem import access use bmi interfac method exampl python mosartwmpi import model mosart_wm model mosart_wminiti get list model output variabl mosart_wmget_output_var_nam get flatten numpyndarray valu output variabl suppli mosart_wmget_value_ptrsupply_water_amount visual model instanc plot current valu certain input output variabl avail modelget_output_var_nam modelget_input_var_nam python mosartwmpi import model config_fil configyaml mosart_wm model mosart_wminitializeconfig_fil _ rang mosart_wmupd mosart_wmplot_variableoutgoing_water_volume_transport_along_river_channel log_scaletru river transporthttpsgithubcomimmmsfamosartwmpyrawmaindocs_staticriver_transportpng use provid util function output simul plot well plot storag inflow outflow particular grand dam python mosartwmpi import model mosartwmpyplottingplot import plot_reservoir config_fil configyaml mosart_wm model mosart_wminitializeconfig_fil mosart_wmupdate_until plot_reservoir modelmosart_wm grand_id start end grand couleehttpsgithubcomimmmsfamosartwmpyrawmaindocs_staticgrand_coulee__png plot particular output variabl defin configyaml time python mosartwmpi import model mosartwmpyplottingplot import plot_vari config_fil configyaml mosart_wm model mosart_wminitializeconfig_fil mosart_wmupdate_until plot_vari modelmosart_wm variableriver_discharge_over_land_liq start end log_scaletru cmapwinter_r river network tileshttpsgithubcomimmmsfamosartwmpyrawmaindocs_staticriver_without_tiles__png cartopi scipi geoview instal tile display along plot python plot_vari modelmosart_wm variableriver_discharge_over_land_liq start end log_scaletru cmapwinter_r tilesstamenwatercolor river network tileshttpsgithubcomimmmsfamosartwmpyrawmaindocs_staticriver_with_tiles__png model coupl common use case mosartwmpi run coupl output commun land model clm see exampl drive mosartwmpi runoff coupl model check jupyt notebook tutorialhttpsgithubcomimmmsfamosartwmpyblobmainnotebookstutorialipynb test valid run test valid make sure download sample_input valid dataset use download util python mosartwmpydownload execut test run testsh python unittest discov mosartwmpytest repositori root execut valid run model simul includ year note output directori run python mosartwmpyvalid repositori root ask simul output directori think moment open figur sever plot repres nmae normal mean absolut error percentag spatial sum sever key variabl compar simul valid scenario use plot assist determin chang made code caus unintend deviat valid scenario nmae across time caus deviat nonzero nmae indic numer differ simul valid scenario might caus chang made code altern run simul differ configur paramet ie larger timestep fewer iter etc plot spatial sum assist determin chang overal magnitud chang wish merg code chang intent caus signific deviat valid scenario pleas work maintain creat new valid dataset issu httpsgithubcomimmmsfamosartwmpyissu new issu httpsgithubcomimmmsfamosartwmpyissuesnewchoos new pull request httpsgithubcomimmmsfamosartwmpycompar im httpsimpnnlgov contribut ___ __i found bug__ nice sleuth check bug alreadi report search exist github issu find match consid ad addit detail exist ticket open new issu sure includ clear titl descript along much detail possibl code sampl log messag demonstr bug quit help __i fix bug__ first thank open new pull request fix ensur descript clearli outlin bug solut includ issu number applic __i creat new feature__ your best consid open new issu describ use case new featur offer platform discuss critiqu open new pull request clear document methodolog sure includ new unit test appropri im team truli appreci encourag commun involv togeth titl mosartwmpi python implement mosartwm coupl hydrolog rout water manag model tag python hydrolog water manag multisector dynam reservoir model author name travi thurber orcid affili name chri r vernon orcid affili name ning sun orcid affili name sean w turner orcid affili name jim yoon orcid affili name nathali voisin orcid x affili affili name pacif northwest nation laboratori richland wa usa index date march bibliographi paperbib summari mosartwmpi python implement model scale adapt river transport water manag mosartwm new version retain function legaci model written fortran provid new featur enhanc user experi extens mosart largescal riverrout model use studi riverin dynam water energi biogeochemistri cycl across local region global scale liphys wm compon introduc voisinimprov repres river regul reservoir storag releas oper divers reservoir releas alloc sector water demand reservoir releas independ calibr use longterm mean monthli inflow reservoir longterm mean monthli demand associ reservoir reservoir goal flood control irrig recreat etc gener monthli prereleas rule storag target set individu reservoir howev releas updat annual interannu variabl dri wet year daili environment constraint flow minimum releas minimummaximum storag level wm model allow evalu impact water manag multipl river basin global continent scale consist represent human oper full domain statement need mosartwm often util hydrolog compon larger suit earthscienc model doecode_ context mosartwm quit effici streamlin run support highperform comput hpc cluster howev learn use extend test complex codebas written domain knowledg impli lowerlevel program languag may greatli increas turnaround time error rate set execut novel experi broaden code access use program languag python second util languag github octoverse_ provid access option learn contribut scienc comput platform mosartwmpi design bridg gap domain scientist want perform softwar still extend futur research need new user may expertis within hydrolog scienc wish integr process workflow quickli becom capabl conduct handson experiment educ purpos refactor mosartwm python amelior steep learn curv fortran version provid easi learn use modifi interfac mosartwmpi also built interoper mind implement commun surfac dynam model system csdm basic model interfac bmi peckhamcompon huttonbas offer familiar set control oper model leverag bmi mosartwmpi readili coupl earth system model perform crossdomain experi target audienc mosartwmpi data scientist hydrologist wish rapidli prototyp test develop novel model capabl relat reservoir water demand mosartwmpi access github httpsgithubcomimmmsfamosartwmpi walkthrough key function use found tutorialhttpsmosartwmpyreadthedocsioenlatest model result valid histor simul httpsdoiorgwr valid util includ code state field addit mosartwmpi ancestor mosartwm sever model commonli use hydrolog model excel differ process commun land model clm httpsdoiorgm focus tradit water cycl ie precipit evapor well plant soil chemistri runoff output clm use input mosartwmpi statemod statemod focus water alloc base legal constraint water right well suppli demand modflow modflow focus solv complex groundwat flow properti threedimension grid glofrim hochglofrim focus provid framework coupl model implement bmi across multiscal grid instanc coupl meteorolog model water cycl model river rout model hydrodynam model context mosartwmpi focus interact river rout reservoir manag water demand function model input mosartwmpi consist channel reservoir geometri groundwat subsurfac runoff ie rain ice melt water demand runoff popul local stream river channel gener flow toward ocean autoreffigflow mani locat along main channel reservoir collect store water releas portion storag downstream time variou societ use ie hydroelectr drink water flood control irrig water also consum directli channel tributari irrig nonirrig use river basin flow continent unit state output mosartwmpylabelfigflowfigure_png width ongo research opensourc softwar mosartwmpi promot collabor commun model develop meet scientif object two exampl potenti extend codebas current underway part us depart energi integr multisector multiscal model im basic research project agent base model abm accur simul irrig demand base econom variou crop type abm yoon improv reservoir oper modul accur simul reservoir releas base datadriven harmon function reservoir futur plan experi studi uncertainti character quantif hess model base perturb key paramet acknowledg research support us depart energi offic scienc part research multisector dynam earth environment system model program pacif northwest nation laboratori oper doe battel memori institut contract deacrl view opinion express paper author alon refer valid file download place directori ignor git output file place subfold directori ignor git conveni input file place directori ignor git create_grand_parameterspi util method gener four damreservoir relat input file expect mosartwmpi grand_reservoir_parametersnc damreservoir physic behavior paramet grand_average_monthly_flowparquet mean monthli flow across reservoir expect simul period grand_average_monthly_demandparquet mean monthli demand reservoir water expect simul period grand_dependency_databaseparquet map grand id grid cell id allow extract water sever dataset requir perform oper grand reservoir shapefil ie grand_v_httpglobaldamwatchorggrand output data previou mosartwmpi simul water manag disabl cover desir simul time period monthli demand input use simul mosartwmpi grid river network file elev data cover mosartwmpi domain parquet format data upscal within util method necessari instanc hydroshedshttpswwwhydroshedsorgdownload voidfil elev istarf dataset datadriven reservoir coeffici ie istarf vhttpszenodoorgrecord note reservoir paramet depend databas provid tutori reason robust degre grid use case would suffici simpli updat mean flow demand file appropri simul necessari data collect run util create_grand_paramet instal along mosartwmpi script ask locat dataset desir output locat complet control script examin method signaturecreate_grand_parameterspi invok directli pythonbuildhttpsgithubcomimmmsfamosartwmpyactionsworkflowsbuildymlbadgesvghttpsgithubcomimmmsfamosartwmpyactionsworkflowsbuildyml codecovhttpscodecovioghimmmsfamosartwmpybranchmaingraphbadgesvgtokenipoymbhttpscodecovioghimmmsfamosartwmpi doihttpsjosstheojorgpapersjossstatussvghttpsdoiorgjoss doihttpszenodoorgbadgesvghttpszenodoorgbadgelatestdoi mosartwmpi mosartwmpi python translat mosartwm model water rout reservoir manag written fortran origin code found iwmmhttpsgithubcomimmmsfaiwmm esmhttpsgithubcomesmprojectesm mosart river rout compon larger suit earthscienc model motiv rewrit larg develop conveni run debug ad new capabl becom increasingli difficult due complex codebas lack familiar fortran version aim intuit lightweight well document still highli interoper quick start check jupyt notebook tutorialhttpsgithubcomimmmsfamosartwmpyblobmainnotebookstutorialipynb get start ensur python avail consid use virtual environmenthttpsgithubcompyenvpyenv see doc herehttpsmosartwmpyreadthedocsioenlatestvirtualenvhtml brief tutori instal mosartwmpi shell pip instal mosartwmpi altern instal via conda shell conda instal c condaforg mosartwmpi download sampl input dataset span may run follow select option tutori download unpack input current directori option specifi path download extract instead current directori shell python mosartwmpydownload set defin merger mosartwmpyconfig_defaultsyaml user specifi file overrid default set creat configyaml file defin simul chose altern download directori step need updat path point data configyaml yaml simul name tutori start_dat end_dat grid path inputdomainsmosartnc land path inputdomainslandnc runoff read_from_fil true path inputrunoffrunoff__nc water_manag enabl true demand read_from_fil true path inputdemanddemand__nc reservoir enable_istarf true paramet path inputreservoirsreservoirsnc depend path inputreservoirsdependency_databaseparquet streamflow path inputreservoirsmean_monthly_reservoir_flowparquet demand path inputreservoirsmean_monthly_reservoir_demandparquet mosartwmpi implement basic model interfacehttpscsdmscoloradoeduwikibmi defin csdm drive familiar accustom bmi launch simul open python shell run follow python mosartwmpi import model path configur yaml file config_fil configyaml initi model mosart_wm model mosart_wminitializeconfig_fil advanc model one timestep mosart_wmupd advanc simulationend_d specifi configyaml mosart_wmupdate_untilmosart_wmget_end_tim model input input mosartwmpi consist mani file defin characterist discret grid river network surfac subsurfac runoff water demand damsreservoir current grid data expect provid spatial resolut runoff input provid time resolut timestep select runoff closest time past current demand input read monthli also pad closest time past effort way robust demand handl damsreservoir requir four differ input file physic characterist averag monthli flow expect simul period averag monthli demand expect simul period databas map grand id grid cell id allow extract water damreservoir input file gener raw grand data raw elev data raw istarf data use provid utilitymosartwmpyutilitiescreate_grand_parametersmd best way understand expect format input file examin sampl input provid download util python mosartwmpydownload model output default key model variabl output monthli basi daili averag resolut outputsimul namesimul name_year_monthnc see configur file exampl modifi output mosartwmpystatestatepi file state variabl name altern certain model output deem import access use bmi interfac method exampl python mosartwmpi import model mosart_wm model mosart_wminiti get list model output variabl mosart_wmget_output_var_nam get flatten numpyndarray valu output variabl suppli mosart_wmget_value_ptrsupply_water_amount visual model instanc plot current valu certain input output variabl avail modelget_output_var_nam modelget_input_var_nam python mosartwmpi import model config_fil configyaml mosart_wm model mosart_wminitializeconfig_fil _ rang mosart_wmupd mosart_wmplot_variableoutgoing_water_volume_transport_along_river_channel log_scaletru river transporthttpsgithubcomimmmsfamosartwmpyrawmaindocs_staticriver_transportpng use provid util function output simul plot well plot storag inflow outflow particular grand dam python mosartwmpi import model mosartwmpyplottingplot import plot_reservoir config_fil configyaml mosart_wm model mosart_wminitializeconfig_fil mosart_wmupdate_until plot_reservoir modelmosart_wm grand_id start end grand couleehttpsgithubcomimmmsfamosartwmpyrawmaindocs_staticgrand_coulee__png plot particular output variabl defin configyaml time python mosartwmpi import model mosartwmpyplottingplot import plot_vari config_fil configyaml mosart_wm model mosart_wminitializeconfig_fil mosart_wmupdate_until plot_vari modelmosart_wm variableriver_discharge_over_land_liq start end log_scaletru cmapwinter_r river network tileshttpsgithubcomimmmsfamosartwmpyrawmaindocs_staticriver_without_tiles__png cartopi scipi geoview instal tile display along plot python plot_vari modelmosart_wm variableriver_discharge_over_land_liq start end log_scaletru cmapwinter_r tilesstamenwatercolor river network tileshttpsgithubcomimmmsfamosartwmpyrawmaindocs_staticriver_with_tiles__png model coupl common use case mosartwmpi run coupl output commun land model clm see exampl drive mosartwmpi runoff coupl model check jupyt notebook tutorialhttpsgithubcomimmmsfamosartwmpyblobmainnotebookstutorialipynb test valid run test valid make sure download sample_input valid dataset use download util python mosartwmpydownload execut test run testsh python unittest discov mosartwmpytest repositori root execut valid run model simul includ year note output directori run python mosartwmpyvalid repositori root ask simul output directori think moment open figur sever plot repres nmae normal mean absolut error percentag spatial sum sever key variabl compar simul valid scenario use plot assist determin chang made code caus unintend deviat valid scenario nmae across time caus deviat nonzero nmae indic numer differ simul valid scenario might caus chang made code altern run simul differ configur paramet ie larger timestep fewer iter etc plot spatial sum assist determin chang overal magnitud chang wish merg code chang intent caus signific deviat valid scenario pleas work maintain creat new valid dataset