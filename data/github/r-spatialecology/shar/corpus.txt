titl shar r packag analyz specieshabitat associ use point pattern analysi tag r open sourc softwar spatial point pattern analysi gammatest pattern reconstruct torustransl test randomizedhabitat procedur author name maximilian h k hesselbarthcorrespond author orcid affili affili name depart ecosystem model univers goettingen buesgenweg goettingen index name depart ecolog evolutionari biolog univers michigan n univers ave ann arbor michigan usa index date bibliographi paperbib summari studi specieshabitat associ one approach reveal import abiot process shape spatial distribut speci even though r program languag offer mani packag spatial point pattern analysi current comprehens packag specif design analyz specieshabitat associ shar packag build wide use r packag spatial analys provid easi straightforward way uncov specieshabitat associ discret environment data statement need specieshabitat associ result certain speci special certain environment condit tilman typic result cluster individu suitabl habitat harm comita thu analyz specieshabitat associ help understand import abiot process shape spatial distribut speci garzonlopez howev sinc biotic process eg competit limit dispers also lead cluster individu analys specieshabitat associ need control potenti biotic process result violat independ assumpt similar statist test chi test ordin method canon correspond analysi plotkin harm spatial autocorrel environment condit could also violat independ assumpt previous mention statist test harm exampl previou research shown violat independ assumpt chi test result ie possibl falseposit specieshabitat associ conserv method provid shar packag plotkin harm ecologist use spatial distribut ecolog object infer underli process shape distribut spatial pattern act memori process shape velazquez spatial point pattern contain fulli map locat term xy coordin individu object normal twodimension studi area assum object locat describ discret point wiegand velazquez exampl mani studi use individu tree locat infer process determin distribut velazquez exampl includ gopher mound klaa gorilla nest funwigabga fairi circl getzin bacteria leav essera spatstat packag baddeley allow ecologist access mani method spatial point pattern analysi summari function null model simul simul heterogen point process model use show import abiot process continu environment data getzin howev even though mani ecolog studi specieshabitat associ use discret environment data found literatur john garzonlopez guo yang du furniss spatstat use reveal associ without larger program effort user inlabru packag provid approach analyz import abiot process mostli continu environment data use bayesian spatial model bachl fgeo packag lepor allow visual analyz forest divers includ specieshabitat associ fgeo design specif handl forestgeo data httpsforestgeosiedu furthermor includ subset method avail analyz specieshabitat associ thu shar packag develop provid comprehens tool set analyz specieshabitat associ spatial point pattern method shar packag design discret environment data advantag assumpt data characterist order make shar packag access mani peopl possibl build two commonli use r packag spatial data name spatstat raster packag hijman methodolog background analyz specieshabitat associ potenti interdepend object locat environment condit need broken random data null model within field spatial point pattern analysi two relat approach break potenti depend plotkin harm requir spatial locat object well discret raster data environment condit first approach simul null model data random environment data keep object locat stabl achiev shift raster data around toru toru translat test use random walk algorithm randomizedhabitat procedur harm second approach random object locat keep environment data stabl achiev fit point process model object locat gamma test plotkin use simul anneal approach pattern reconstruct kirkpatrick two approach differ random null model data control potenti biotic process preserv spatial structur data plotkin wiegand result similar result final specieshabitat associ present speci found certain habitat data often expect compar random null model data plotkin harm given characterist method posit associ one habitat inevit lead neg associ least one habitat vice versa yamada use packag analyz specieshabitat associ straightforward shar packag two object need quantifi specieshabitat associ name spatstat object includ object locat within studi area raster object discret habitat class howev method requir fulli map data sens na cell environment data allow simultan area accommod locat point pattern eg water bodi within forest area need reflect observ window point pattern toru translat method na valu allow random environment data either translate_rast randomize_rast use former number random null model data automat determin number row column raster object later number random must specifi use n_random argument torus_tran translate_rasterrast landscape_discret random_walk randomize_rasterrast landscape_discret n_random altern random object locat either fit_point_process reconstruct_pattern reconstruct_pattern_mark use case number random must specifi use n_random argument order preserv spatial structur input detail possibl sever option present acknowledg exampl input object locat cluster heterogen distribut studi area gamma_test fit_point_processpattern species_a n_random process cluster reconstruct reconstruct_patternpattern species_a n_random method cluster lastli input data random null model data use test signific specieshabitat associ present results_habitat_associ function automat detect part data random use ident either use random approach results_habitat_associationpattern species_a raster random_walk significance_level input random raster quantil threshold neg posit habitat count lo hi signific ns ns ns neg ns shar packag also provid sever util plot function gener plot function plot null model data calculate_energi calcul differ input object locat random null model data object locat classify_habitat classifi continu environment data discret habitat function pleas see function articl shar homepag httpsrspatialecologygithubioshar parallel one major drawback shar packag comput time relat random method null model data case especi pattern reconstruct even though point pattern analysi studi use less null model random velazquez howev sinc random null model data independ could paral use avail framework futur bengtsson parallel rcoreteam packag shar packag allow run code parallel intern limit user specif parallel framework short exampl simul null model data parallel use futur packag pleas see parallel articl shar homepag httpsrspatialecologygithubioshar howev present approach could use parallel framework well acknowledg support provid german research associ dfg research train group scale problem statist grant number mhkh thank sebastian hanss und marco sciaini help develop shar packag katrina munsterman bridget shayka samantha iliff comment earlier draft manuscript thoma etherington lionel hertzog provid valuabl feedback review process improv manuscript shar packag refer readmemd gener readmermd pleas edit file shar speci habitat associ r img srcmanfigureslogopng alignright alt width badg start ci develop cran licens rcmdcheckhttpsgithubcomrspatialecologysharactionsworkflowsrcmdcheckyamlbadgesvghttpsgithubcomrspatialecologysharactionsworkflowsrcmdcheckyaml project statushttpswwwrepostatusorgbadgeslatestactivesvghttpswwwrepostatusorgact cran statushttpswwwrpkgorgbadgesversionsharhttpscranrprojectorgpackageshar josshttpsjosstheojorgpapersbcacbebdbstatussvghttpsjosstheojorgpapersbcacbebdb codecovhttpscodecovioghrspatialecologysharbranchmaingraphbadgesvgtokenxmoabshttpscodecovioghrspatialecologyshar lifecycl stablehttpsimgshieldsiobadgelifecyclestablebrightgreensvghttpswwwtidyverseorglifecyclest cran logshttpcranlogsrpkgorgbadgesgrandtotalsharhttpcranrstudiocomwebpackagessharindexhtml licens gpl vhttpsimgshieldsiobadgelicensegplvbluesvghttpswwwgnuorglicensesgpl badg end specieshabitat associ r r packag analyz specieshabitat associ therefor inform locat speci need point pattern environment condit raster map order analys data signific habitat associ either locat data environment data random ntime count within habitat compar random data observ data posit neg associ present observ count higher lower random count use quantil threshold method mainli describ plotkin et al harm et al wiegand moloney shar mainli base spatstathttpspatstatorg baddeley et al rasterhttpsrspatialorgrast hijman packag citat shar packag part academ work cite packag acknowledg use public pleas cite follow paper hesselbarth mhk shar r packag analyz specieshabitat associ use point pattern analysi journal open sourc softwar httpsdoiorgjoss get bibtex entri pleas use citationshar instal instal releas version shar cranhttpscranrprojectorgwebpackagessharindexhtml r installpackagesshar develop version githubhttpsgithubcomrspatialecologyshar r installpackagesremot remotesinstall_githubrspatialecologyshar also automat instal nonbas r packag depend name follow packag classint raster spatstatcor spatstatgeom use shar r libraryshar libraryspatstat libraryrast setse shar come buildin exampl data set species_a species_b exemplari locat speci eg tree pppobject spatstat packag landscap contain exemplari continu environment data howev method depend discret data therefor need classifi data first howev method requir fulli map data sens na cell environment data allow simultan area accommod locat point pattern eg water bodi within forest area need reflect observ window point pattern toru translat method na valu allow r landscape_classifi classify_habitatsrast landscap n style fisher two possibl random environment data describ harm et al first shift habitat map cardin direct around toru second one assign habitat valu empti map use random walk algorithm function return list random raster observ one inform method pleas click herehttpsrspatialecologygithubioshararticlesarticlesbackgroundhtml r torus_tran translate_rasterrast landscape_classifi random_walk randomize_rasterrast landscape_classifi n_random plot random raster use plot function specifi number raster well color palett use discret environment data r col_palett cff bbff cff dcff fdeff plottorus_tran n col col_palett random point pattern either use gamma test describ plotkin et al pattern reconstruct kirkpatrick et al tscheschel stoyan r gamma_test fit_point_processpattern species_b process cluster n_random take time reconstruct reconstruct_patternpattern species_b n_random e_threshold cours sever util function exampl plot summari function observ pattern simul envelop random pattern sf random observ pattern pp use plot function r plotreconstruct pp img srcmanfiguresreadmeplotrandom_patternpng width height styledisplay block margin auto anoth util function allow calcul differ observ pattern random pattern also call energi use summari function r calculate_energyreconstruct return_mean true data creat species_a neg associ habitat species_b posit associ habitat reflect result given characterist method posit associ one habitat inevit lead neg associ least one habitat vice versa yamada et al exampl high amount individu point posit associ habitat simultan mean less individu point present habitat furthermor pleas awar due random null model data result might slightli differ differ random approach eg fit_point_process vs translate_rast even repetit approach thu exact lo hi threshold might slightli differ rerun exampl howev count observ data ident gener result trend similar r significance_level results_habitat_associationpattern species_a raster torus_tran significance_level significance_level input random raster quantil threshold neg posit habitat break count lo hi signific na ns na ns na ns na neg na ns results_habitat_associationpattern reconstruct raster landscape_classifi significance_level significance_level input random pattern quantil threshold neg posit habitat break count lo hi signific na neg na neg na neg na ns na posit contribut code conduct contribut shar highli welcom appreci includ form feedback bug report featur requestssuggest gener question usag pleas note shar packag releas contributor code conductcode_of_conductmd contribut project agre abid term see contribut project pleas see contribut guidelinescontributingmd refer baddeley rubak e turner r spatial point pattern methodolog applic r chapman hallcrc press london isbn harm ke condit r hubbel sp foster rb habitat associ tree shrub ha neotrop forest plot journal ecolog httpsdoiorgjx hijman rj raster geograph data analysi model r packag version httpscranrprojectorgpackagerast kirkpatrick gelatt cdjr vecchi mp optim simul anneal scienc httpsdoiorgscienc plotkin jb pott md lesli n manokaran n lafranki jv ashton ps speciesarea curv spatial aggreg habitat special tropic forest journal theoret biolog httpsdoiorgjtbi tscheschel stoyan statist reconstruct random point pattern comput statist data analysi httpsdoiorgjcsda wiegand moloney ka handbook spatial pointpattern analysi ecolog chapman hallcrc press boca raton isbn yamada tomita itoh yamakura ohkubo kanzaki tan ashton ps habitat associ sterculiacea tree bornean rain forest plot journal veget scienc httpsdoiorgjtbx shar improv improv classify_habitat variabl ad break argument results_habitat_associ ad classint_to_vector helper function shar improv bugfix plotrd_pat plotrd_mar ad intern sample_random function use plot shar improv better document combin reconstruct_pattern_homo reconstruct_pattern_clust reconstruct_pattern_hetero reconstruct_pattern replac plot_randomized_ function gener plot method ad warn error na valu present new function list_to_random function parallel articl ad joss paper refer shar improv reconstruct_pattern_homo argument specifi number point window reconstruct_pattern_mark allow differ number point pattern marked_pattern argument shar improv includ new spatstat packag structur use gpl licens shar improv add logo updat mit licens renam master main branch shar improv use energy_df get energi print avail updat test stabl progress print shar improv calcul energi print slow shar improv print method object possibl specifi interv r reconstruct function new function plot_energi plot energi iter reconstruct pattern reconstruct_pattern_hetero allow reconstruct heterogen pattern renameingstructur reconstruct_pattern split three function reconstruct_pattern_homo reconstruct_pattern_hetero reconstruct_pattern_clust reconstruct_mark call reconstruct_pattern_mark shar improv anneal probabl specifi reconstruct shar improv easier user experi class use specifi provid input results_habitat_associ check extent input ident reconstruct_mark calculate_energi use weight summari function bugfix bug calculate_energi reconstruct mark shar improv better structur vignett ad contributingmd tri fix fail test older r version new function allow translat raster n step shar improv plot_randomized_pattern use envelop plot random summari function plot_randomized_pattern includ quantum bar plot_randomized_pattern return plot press enter calculate_engeri also calcul energi mark reconstruct improv warn messag bugfix explicitli c compil new function plot_randomized_pattern plot random raster shar improv minor speed improv reconstruct_pattern reconstruct_mark calculate_energi start pattern ident n_random reloc process differ random summari function calcul step rmax bugfix new function rcpp_sampl faster rcpp implement sampl shar improv replac cat messag print consol default set n_random comp_fast argument equal true number point exceed threshold reconstruct_pattern stop energi decreas n iter reconstruct_mark stop energi decreas n iter plot_randomized_pattern also plot point pattern bugfix bug fit_point_process point present could remov simul pattern bug reconstruct_pattern point present could remov simul pattern shar first submiss cran contributor coven code conduct pledg member contributor leader pledg make particip commun harassmentfre experi everyon regardless age bodi size visibl invis disabl ethnic sex characterist gender ident express level experi educ socioeconom statu nation person appear race religion sexual ident orient pledg act interact way contribut open welcom divers inclus healthi commun standard exampl behavior contribut posit environ commun includ demonstr empathi kind toward peopl respect differ opinion viewpoint experi give grace accept construct feedback accept respons apolog affect mistak learn experi focus best us individu overal commun exampl unaccept behavior includ use sexual languag imageri sexual attent advanc kind troll insult derogatori comment person polit attack public privat harass publish other privat inform physic email address without explicit permiss conduct could reason consid inappropri profession set enforc respons commun leader respons clarifi enforc standard accept behavior take appropri fair correct action respons behavior deem inappropri threaten offens harm commun leader right respons remov edit reject comment commit code wiki edit issu contribut align code conduct commun reason moder decis appropri scope code conduct appli within commun space also appli individu offici repres commun public space exampl repres commun includ use offici email address post via offici social media account act appoint repres onlin offlin event enforc instanc abus harass otherwis unaccept behavior may report commun leader respons enforc mhkhesselbarthgmailcom complaint review investig promptli fairli commun leader oblig respect privaci secur report incid enforc guidelin commun leader follow commun impact guidelin determin consequ action deem violat code conduct correct commun impact use inappropri languag behavior deem unprofession unwelcom commun consequ privat written warn commun leader provid clariti around natur violat explan behavior inappropri public apolog may request warn commun impact violat singl incid seri action consequ warn consequ continu behavior interact peopl involv includ unsolicit interact enforc code conduct specifi period time includ avoid interact commun space well extern channel like social media violat term may lead temporari perman ban temporari ban commun impact seriou violat commun standard includ sustain inappropri behavior consequ temporari ban sort interact public commun commun specifi period time public privat interact peopl involv includ unsolicit interact enforc code conduct allow period violat term may lead perman ban perman ban commun impact demonstr pattern violat commun standard includ sustain inappropri behavior harass individu aggress toward disparag class individu consequ perman ban sort public interact within commun attribut code conduct adapt contributor covenanthomepag version avail httpswwwcontributorcovenantorgversioncode_of_conducthtml commun impact guidelin inspir mozilla code conduct enforc ladderhttpsgithubcommozilladivers homepag httpswwwcontributorcovenantorg answer common question code conduct see faq httpswwwcontributorcovenantorgfaq translat avail httpswwwcontributorcovenantorgtransl contribut shar outlin propos chang shar sever way contribut project want know contribut open sourc project like one see open sourc guidehttpsopensourceguidehowtocontribut code conduct pleas note shar project releas contributor code conductcode_of_conductmd contribut project agre abid term contribut ask question interrobang brows documentationhttpsrspatialecologygithubioshar see find solut still stuck open issu githubhttpsgithubcomrspatialecologysharissu github well tri best address question often lead better document discoveri bug want ask question privat contact packag maintain mhkhesselbarthatgmailcommailtomhkhesselbarthgmailcom pleas tri includ reproduc exampl use exampl reprexhttpsreprextidyverseorg packag propos idea bulb take look documentationhttpsrspatialecologygithubioshar issu githubhttpsgithubcomrspatialecologysharissu list see isnt includ suggest yet pleas open new issu cant promis implement idea help explain detail would work keep scope narrow possibl report bug bug report issu githubhttpsgithubcomrspatialecologysharissu fix good bug report make easier us pleas includ content utilssessioninfo detail local setup might help troubleshoot detail step reproduc bug pleas tri includ reproduc exampl use exampl reprexhttpsreprextidyverseorg packag improv document book good document make differ help improv welcom use roxygenhttpscranrprojectorgpackageroxygen markdown syntaxhttpscranrprojectorgwebpackagesroxygenvignettesrdformattinghtml document pull request process arrow_up_down tri follow github flowhttpsguidesgithubcomintroductionflow develop fork repohttpsgithubcomrspatialecologyshar clone comput learn process see guidehttpsguidesgithubcomactivitiesfork dont forget pull new chang start work open rstudio project file rproj instal develop depend eg use devtoolsinstall_dev_dep make sure packag pass r cmd check run devtoolscheck creat new git branch use name briefli describ propos chang make chang write code test code bonu point ad unit test use testthathttpstestthatrliborg packag document code see function document check code devtoolscheck aim error warn note commit push chang submit pull requesthttpsguidesgithubcomactivitiesforkingmakingapullrequest new code follow tidyvers style guidehttpsstyletidyverseorg refer contributingmd adapt herehttpsgistgithubcompeterdesmeteabdcafcdafebfec herehttpsgithubcomrlibusethisblobmaininsttemplatestidycontributingmd detail chang pleas see newsmd shar improv exist function shar bug fix shar improv gener packag structur shar improv exist function shar updat spatstat depend shar minor improv new licens shar improv exist function shar minor improv exist function shar new function renameingsplit function shar improv exist function shar improv gener packag structur shar minor bugfix shar bugfix improv exist function well new function shar bugfix improv exist function review cran submiss thank pleas omit redund r done suggest refer method add descript field form author year doi ad method mainli base plotkin et al doijtbi harm et al doijx descript field thank see run test arch ok run test arch x ok togeth alreadyv min cran threshold packag check pl simplifi test case run less import test condit env var set defin machin test run faster check winbuilderrproject run test arch ok run test arch x ok renam packag shar shar test environ window r maco mojav r httpswinbuilderrprojectorg devel releas r cmd check result error warn note revers depend current revers depend output github_docu readmemd gener readmermd pleas edit file r setup includ fals knitropts_chunkset collaps true figpath manfiguresreadm shar speci habitat associ r img srcmanfigureslogopng alignright alt width badg start ci develop cran licens rcmdcheckhttpsgithubcomrspatialecologysharactionsworkflowsrcmdcheckyamlbadgesvghttpsgithubcomrspatialecologysharactionsworkflowsrcmdcheckyaml project statushttpswwwrepostatusorgbadgeslatestactivesvghttpswwwrepostatusorgact cran statushttpswwwrpkgorgbadgesversionsharhttpscranrprojectorgpackageshar josshttpsjosstheojorgpapersbcacbebdbstatussvghttpsjosstheojorgpapersbcacbebdb codecovhttpscodecovioghrspatialecologysharbranchmaingraphbadgesvgtokenxmoabshttpscodecovioghrspatialecologyshar lifecycl stablehttpsimgshieldsiobadgelifecyclestablebrightgreensvghttpswwwtidyverseorglifecyclest cran logshttpcranlogsrpkgorgbadgesgrandtotalsharhttpcranrstudiocomwebpackagessharindexhtml licens gpl vhttpsimgshieldsiobadgelicensegplvbluesvghttpswwwgnuorglicensesgpl badg end specieshabitat associ r r packag analyz specieshabitat associ therefor inform locat speci need point pattern environment condit raster map order analys data signific habitat associ either locat data environment data random ntime count within habitat compar random data observ data posit neg associ present observ count higher lower random count use quantil threshold method mainli describ plotkin et al harm et al wiegand moloney shar mainli base spatstathttpspatstatorg baddeley et al rasterhttpsrspatialorgrast hijman packag citat shar packag part academ work cite packag acknowledg use public pleas cite follow paper hesselbarth mhk shar r packag analyz specieshabitat associ use point pattern analysi journal open sourc softwar httpsdoiorgjoss get bibtex entri pleas use citationshar instal instal releas version shar cranhttpscranrprojectorgwebpackagessharindexhtml r installcran eval fals installpackagesshar develop version githubhttpsgithubcomrspatialecologyshar r installgithub eval fals installpackagesremot remotesinstall_githubrspatialecologyshar also automat instal nonbas r packag depend name follow packag classint raster spatstatcor spatstatgeom use shar r importlib messag fals warn fals libraryshar libraryspatstat libraryrast setse shar come buildin exampl data set species_a species_b exemplari locat speci eg tree pppobject spatstat packag landscap contain exemplari continu environment data howev method depend discret data therefor need classifi data first howev method requir fulli map data sens na cell environment data allow simultan area accommod locat point pattern eg water bodi within forest area need reflect observ window point pattern toru translat method na valu allow r environmentaldata landscape_classifi classify_habitatsrast landscap n style fisher two possibl random environment data describ harm et al first shift habitat map cardin direct around toru second one assign habitat valu empti map use random walk algorithm function return list random raster observ one inform method pleas click herehttpsrspatialecologygithubioshararticlesarticlesbackgroundhtml r habitat_random eval fals torus_tran translate_rasterrast landscape_classifi random_walk randomize_rasterrast landscape_classifi n_random plot random raster use plot function specifi number raster well color palett use discret environment data r plot_habitatrandom eval fals col_palett cff bbff cff dcff fdeff plottorus_tran n col col_palett random point pattern either use gamma test describ plotkin et al pattern reconstruct kirkpatrick et al tscheschel stoyan r patternrandom eval fals gamma_test fit_point_processpattern species_b process cluster n_random take time reconstruct reconstruct_patternpattern species_b n_random e_threshold cours sever util function exampl plot summari function observ pattern simul envelop random pattern sf random observ pattern pp use plot function r plotrandom_pattern figalign center outheight outwidth messag fals plotreconstruct pp anoth util function allow calcul differ observ pattern random pattern also call energi use summari function r calculateenergi messag fals calculate_energyreconstruct return_mean true data creat species_a neg associ habitat species_b posit associ habitat reflect result given characterist method posit associ one habitat inevit lead neg associ least one habitat vice versa yamada et al exampl high amount individu point posit associ habitat simultan mean less individu point present habitat furthermor pleas awar due random null model data result might slightli differ differ random approach eg fit_point_process vs translate_rast even repetit approach thu exact lo hi threshold might slightli differ rerun exampl howev count observ data ident gener result trend similar r result significance_level results_habitat_associationpattern species_a raster torus_tran significance_level significance_level results_habitat_associationpattern reconstruct raster landscape_classifi significance_level significance_level contribut code conduct contribut shar highli welcom appreci includ form feedback bug report featur requestssuggest gener question usag pleas note shar packag releas contributor code conductcode_of_conductmd contribut project agre abid term see contribut project pleas see contribut guidelinescontributingmd refer baddeley rubak e turner r spatial point pattern methodolog applic r chapman hallcrc press london isbn harm ke condit r hubbel sp foster rb habitat associ tree shrub ha neotrop forest plot journal ecolog httpsdoiorgjx hijman rj raster geograph data analysi model r packag version httpscranrprojectorgpackagerast kirkpatrick gelatt cdjr vecchi mp optim simul anneal scienc httpsdoiorgscienc plotkin jb pott md lesli n manokaran n lafranki jv ashton ps speciesarea curv spatial aggreg habitat special tropic forest journal theoret biolog httpsdoiorgjtbi tscheschel stoyan statist reconstruct random point pattern comput statist data analysi httpsdoiorgjcsda wiegand moloney ka handbook spatial pointpattern analysi ecolog chapman hallcrc press boca raton isbn yamada tomita itoh yamakura ohkubo kanzaki tan ashton ps habitat associ sterculiacea tree bornean rain forest plot journal veget scienc httpsdoiorgjtbx titl get start author maximilian hk hesselbarth date r sysdat output rmarkdownhtml_vignett vignett vignetteindexentryget start vignetteencodingutf vignetteengineknitrrmarkdown editor_opt chunk_output_typ consol r setup includ fals knitropts_chunkset collaps true comment r importlib messag fals warn fals libraryshar libraryspatstat libraryrast setse design core shar function simul null model data random either environment data ie raster data locat speci ie point pattern data null data use analys signific specieshabitat associ present addit function visual analys result avail well util function method mainli describ harm et al plotkin et al wiegand moloney method necessari complementari rather differ approach result preprocess input data function design discret habitat class follow case continu data avail classifi discret class classify_habitat provid sever way classifi data fisherjenk algorithm fisher jenk caspal r classify_habitat landscape_discret classify_habitatsrast landscap n style fisher random environment data two function random environment data translate_rast randomize_rast first function toru translat raster shift habitat map four cardin direct possibl rectangular observ area result n_random rasternrowlandscap rasterncollandscap random raster function random environment data use randomwalk algorithm number random raster specifi use n_random argument howev method requir fulli map data sens na cell environment data allow simultan area accommod locat point pattern eg water bodi within forest area need reflect observ window point pattern toru translat method na valu allow r randomize_rast eval fals torus_tran translate_rasterrast landscape_discret random_walk randomize_rasterrast landscape_discret n_random random locat data random locat data ie point pattern either fit_point_process reconstruct_pattern avail first fit either poisson process cluster process data differ solut spatstat packag number point alway ident second function reconstruct spatial characterist data use pattern reconstruct tscheschel stoyan advantag point pattern describ simpl point process model function number pattern specifi n_random argument r randomize_pp eval fals gamma_test fit_point_processpattern species_b process cluster n_random take time reconstruct reconstruct_patternpattern species_b n_random e_threshold method cluster analys result import function analys result results_habitat_associ function compar observ data null model data abl show signific specieshabitat associ function work random environment data random locat data pleas awar due random null model data result might slightli differ differ random approach eg fit_point_process vs translate_rast even repetit approach howev count observ data ident gener result trend similar r result results_habitat_associationpattern species_a raster random_walk results_habitat_associationpattern reconstruct raster landscape_discret also possibl visual random data use plot function r plot figalign center outheight outwidth messag fals plotrandom_walk plotreconstruct ask fals random point pattern data also possibl show differ term energi tscheschel stoyan pattern r energi messag fals calculate_energypattern gamma_test return_mean true calculate_energypattern reconstruct return_mean true refer fisher wd group maximum homogen journal american statist associ httpsdoiorg harm ke condit r hubbel sp foster rb habitat associ tree shrub ha neotrop forest plot journal ecolog httpsdoiorgjx jenk gf caspal fc error choropleth map definit measur reduct annal associ american geograph httpsdoiorgjtbx plotkin jb pott md lesli n manokaran n lafranki jv ashton ps speciesarea curv spatial aggreg habitat special tropic forest journal theoret biolog httpsdoiorgjtbi tscheschel stoyan statist reconstruct random point pattern comput statist data analysi httpsdoiorgjcsda wiegand moloney ka handbook spatial pointpattern analysi ecolog chapman hallcrc press boca raton isbn titl parallel author maximilian hk hesselbarth date r sysdat output rmarkdownhtml_vignett vignett vignetteindexentryparallel vignetteencodingutf vignetteengineknitrrmarkdown editor_opt chunk_output_typ consol r includ fals knitropts_chunkset collaps true comment shar packag buildin parallel howev mani r framework allow run code parallel highperform cluster see eg futur httpscranrprojectorgpackagefutur clustermq httpscranrprojectorgpackageclustermq rslurm httpscranrprojectorgpackagerslurm thu shar provid util function facilit usag togeth parallel framework follow exampl illustr use futur packag random pattern use fit_point_process parallel use avail core local machin similarli core idea follow code could use run shar high perform cluster first need load requir packag includ futur futureappli r loadpackag messag fals warn fals libraryshar libraryspatstat libraryrast libraryfutur libraryfutureappli futur packag allow run code parallel use line code set futur plan multisess packag automat resolv follow futur parallel importantli approach need one random per core n_random set simplifi true return point pattern result list random point pattern r parallel futureplanmultisess fitted_list futureapplyfuture_lapplyx fun functioni sharfit_point_processpattern sharspecies_b n_random return_input fals simplifi true verbos fals futurese next use list_to_random function convert list random pattern rd_pat object work function shar packag r convertlist fitted_rd sharlist_to_randomizedlist fitted_list observ sharspecies_b lastli creat object use analys specieshabitat associ present usual r result landscape_classifi sharclassify_habitatsrast landscap n style fisher results_habitat_associationpattern fitted_rd raster landscape_classifi cours idea use random raster data well furthermor parallel framework could use titl analys climat nich cormu domestica author zeke marshal date r sysdat output rmarkdownhtml_vignett vignett vignetteindexentryanalys climat nich cormu domestica vignetteengineknitrrmarkdown vignetteencodingutf editor_opt chunk_output_typ consol r setup includ fals knitropts_chunkset collaps true comment outlin vignett demonstr use shar analys speci occurr data obtain global biodivers inform facil gbifhttpswwwgbiforg environment raster data obtain climat research unit cruhttpswwwueaacukgroupsandcentresclimaticresearchunit entir r gamma test approach detail vignettebackground use distribut tree speci cormu domestica europ select tree toler wide rang condit favor warm mild climat occur subtrop dri forest temper continent fao ecolog zone cormu domestica commonli found southern europ though natur rang uncertain owe cultiv distribut roman empir de rigo et al rotach load requir packag r packag messagefals warningfals librarydplyr data wrangl librarymagrittr nonbas r pipe function libraryrgbif retriev speci occurr data libraryrnaturalearth retriev geograph data librarygetcrucldata retriev climat raster data librarysf spatial data oper libraryrast spatial data oper libraryterra spatial data oper libraryshar specieshabitat associ analysi libraryspatstat spatial point pattern analysi librarypatchwork compos multipl plot download occurr data retriev speci occurr data r packag rgbif chamberlain boettig use provid interfac access gbif databas r gbif echotru messagefals warningfals retriev key cormu domestica key rgbifname_backbonenam cormu domestica kingdom plant retriev occurr re rgbifocc_searchtaxonkey asnumerickeyusagekey limit creat simpl data frame contain uniqu identifi id latitud lat longtitud lon data_simp dataframeid resdatakey lat resdatadecimallatitud lon resdatadecimallongitud dplyrfilterisnalat isnalon download map data spatial polygon data world obtain rnaturalearth packag south map restrict european region spatstat packag requir geospati data format project coordin system data therefor convert geograph coordin system httpsepsgio project coordin system httpsepsgio shar function fit_point_process requir spatial point pattern ppp object bound within observ window class owin creat r map echotru messagefals warningfals retriev data rnaturalearth worldmap rnaturalearthne_countriesreturnclass sf scale sfst_transformcr sfst_cr manual establish bound box eur_box sfst_sfcsfst_pointc sfst_pointc cr sfst_transformcr sfst_cr crop world map includ polygon within europ extent eur sfst_cropx worldmap eur_box defin observ window eur_owin spatstatgeomasowineurgeometri download climat data environment variabl select demonstr purpos mean temperatur june period data obtain getcrucldata packag spark provid access dataset describ new et al r cru_data echotru messagefals warningfals download data raster brick getcrucldata packag mean temperatur tmn data mb cru_data getcrucldataget_cru_stackpr fals pre_cv fals rd fals tmp true dtr fals reh fals tmn fals tmx fals sunp fals fr fals wnd fals elv fals cach fals prepar landscap raster climat data obtain restrict european region classifi habitat base temperatur rang achiev set lower upper bound rang fixedbreak argument classify_habitat function r landscape_ra echotru messagefals warningfals select temperatur variabl month june tmp_raster_jun cru_datatmpjun crop tmp raster tmp_raster_jun_eur terracropx tmp_raster_jun cxmin xmax ymin ymax reproject raster tmp_raster_jun_eur_ rasterprojectrastertmp_raster_jun_eur cr classifi landscap landscape_classifi sharclassify_habitatsrast tmp_raster_jun_eur_ return_break true style fix fixedbreak c r land_plot echofals messagefals warningfals figretinafals outwidth dpi raster_unclassed_df terraasdataframetmp_raster_jun_eur_ xy true dplyrrenamevalu jun dplyrmutatetyp unclassifi raster_classed_df terraasdataframelandscape_classifiedrast xy true dplyrrenamevalu layer dplyrmutatetyp classifi plot_unclass ggplotggplot ggplotgeom_rasterdata raster_unclassed_df map ggplotaesx x fill valu ggplotgeom_sfdata eurgeometri map ggplota colour black fill na size ggplottheme_minim ggplotxlablabel null ggplotylablabel null ggplotlabsfil null ggplotscale_fill_distillerpalett rdbu navalu transpar ggplotthemepanelgridmajor ggplotelement_linecolour ccc linetyp dash size panelbackground ggplotelement_rectfil ffff panelbord ggplotelement_rectfil na text ggplotelement_texts axistextx ggplotelement_texts axistexti ggplotelement_texts plotmargin ggplotmargint top margin r right margin b bottom margin l legendposit bottom legendposit c legenddirect horizont legendjustif center legendtext ggplotelement_texts legendkeyheight ggplotunit cm legendkeywidth ggplotunit cm plot_class ggplotggplot ggplotgeom_rasterdata raster_classed_df map ggplotaesx x fill factorvalu ggplotgeom_sfdata eurgeometri map ggplota colour black fill na size ggplottheme_minim ggplotxlablabel null ggplotylablabel null ggplotlabsfil null ggplotscale_fill_brewerpalett rdbu direct navalu transpar guid ggplotguide_legend ggplotthemepanelgridmajor ggplotelement_linecolour ccc linetyp dash size panelbackground ggplotelement_rectfil ffff panelbord ggplotelement_rectfil na text ggplotelement_texts axistextx ggplotelement_texts axistexti ggplotelement_blank ggplotelement_texts plotmargin ggplotmargint top margin r right margin b bottom margin l legendposit bottom legendposit c legenddirect horizont legendjustif center legendtext ggplotelement_texts legendkeyheight ggplotunit cm legendkeywidth ggplotunit cm plot_unclass plot_class prepar occurr data occurr data prepar shar function fit_point_process call yield random occurr data within observ window requir results_habitat_associ function r occ_prep echotru messagefals warningfals convert occurr data simpl featur object data_sf sfst_as_sfdata_simp coord clon lat cr restrict occurr within european region reproject data data_sf_eur_ sfst_cropx data_sf cxmin xmax ymin ymax sfst_transformcr sfst_cr extract coordin matrix sf occurr object data_sf_eur_coord sfst_coordinatesdata_sf_eur_ creat spatial point pattern object contain occurr data data_sf_eur_ppp spatstatgeomaspppx data_sf_eur_coord w eur_owin fit point pattern process data rand_pattern sharfit_point_processpattern data_sf_eur_ppp n_random r occ_plot echofals messagefals warningfals figretinafals outwidth dpi recon_occ_df asdataframerand_patternrandomizedrandomized_ dplyrmutatetyp randomis occurr real_occ_df data_sf_eur_coord asdatafram dplyrrenamex x dplyrmutatetyp real occurr real_occ_plot ggplotggplot ggplotgeom_sfdata eurgeometri map ggplota colour black fill white size ggplotgeom_pointreal_occ_df map ggplotaesx x size stroke shape color red ggplottheme_minim ggplotxlablabel null ggplotylablabel null ggplotthemepanelgridmajor ggplotelement_linecolour ccc linetyp dash size panelbackground ggplotelement_rectfil ffff panelbord ggplotelement_rectfil na text ggplotelement_texts axistextx ggplotelement_texts axistexti ggplotelement_texts plotmargin ggplotmargint r b l recon_occ_plot ggplotggplot ggplotgeom_sfdata eurgeometri map ggplota colour black fill white size ggplotgeom_pointrecon_occ_df map ggplotaesx x size stroke shape color red ggplottheme_minim ggplotxlablabel null ggplotylablabel null ggplotthemepanelgridmajor ggplotelement_linecolour ccc linetyp dash size panelbackground ggplotelement_rectfil ffff panelbord ggplotelement_rectfil na text ggplotelement_texts axistextx ggplotelement_texts axistexti ggplotelement_blank ggplotelement_texts plotmargin ggplotmargint r b l real_occ_plot recon_occ_plot result analysi function results_habitat_associ call result analysi show cormu domestica posit associ locat experi mean june temperatur c c habitat c c habitat furthermor cormu domestica neg associ locat classifi temperatur r model_run echotru messagefals warningfals establish signific level sig_level run analysi result sharresults_habitat_associationpattern rand_pattern raster landscape_classifiedrast break landscape_classifiedbreak significance_level sig_level dplyrarrangehabitat result refer chamberlain sa boettig c r python rubi client gbif speci occurr data peerj preprint ev doipeerjpreprintsv de rigo caudullo g houston durrant sanmiguelayanz j european atla forest tree speci model data inform forest tree speci european atla forest tree speci peaa doi new lister hulm makin highresolut data set surfac climat global land area climat research pp doicr rotach p euforgen technic guidelin genet conserv use servic tree sorbu domestica biovers intern south rnaturalearth world map data natur earth httpsdocsropensciorgrnaturalearth websit httpsgithubcomropenscirnaturalearth spark getcrucldata use explor cru cl v climatolog element r journal open sourc softwar doijoss titl public record date r sysdat output rmarkdownhtml_vignett vignett vignetteindexentrypubl record vignetteengineknitrrmarkdown vignetteencodingutf tri maintain list public use shar packag use shar work would love hear pleas open issu githubhttpsgithubcomrspatialecologysharissu drop us emailmailtomhkhesselbarthgmailcom add work list shar packag part academ work cite packag acknowledg use public pleas cite follow paper hesselbarth mhk shar r packag analyz specieshabitat associ use point pattern analysi journal open sourc softwar httpsdoiorgjoss get bibtex entri pleas use citationshar list public workinprogress titl background author maximilian hk hesselbarth date r sysdat output rmarkdownhtml_vignett vignett vignetteindexentrybackground vignetteengineknitrrmarkdown vignetteencodingutf specieshabitat associ present speci special smallscal environment condit tilman pacala common within suitabl habitat comita et al harm et al follow specieshabitat associ show import abiot process spatial pattern plant popul garzonlopez et al mainli two method found literatur analys smallscal specieshabitat associ name gammatest plotkin et al torustransl test harm et al method requir data locat plant spatstatppp point pattern environment condit classifi discret habitat rasterrast show signific specieshabitat associ method random one compon locat plant well habitat like autocorrel spatial structur must kept random data wiegand moloney method compar abund within habitat observ data random null model data count preset threshold eg th th quantil neg posit associ respect present r overviewmethod echo fals outheight outwidth figalign center knitrinclude_graphicsmethods_overviewpng random environment data follow two method random environment data ie rasterlay data keep point pattern data fix torustranslationtest torustransl test harm et al shift habitat map four cardin direct around toru possibl squar raster use method shar use translate_rast randomizedhabitat procedur randomzehabitat procedur harm et al also possibl nonsquar raster random habitat use randomwalk algorithm use method shar use randomize_rast r randomwalk echo fals outheight outwidth figalign center knitrinclude_graphicsrandom_walkgif random point pattern data contrastingli two method describ follow two method random point pattern data keep environment data fix r gammavsreconstrut echo fals outheight outwidth figalign center knitrinclude_graphicsgamma_vs_reconstructionpng gammatest gammatest plotkin et al random data fit point process model observ data simul n random point pattern use fit point process model howev method work point pattern describ theoret point process model use method shar use fit_point_process pattern reconstruct pattern reconstruct tscheschel stoyan random point pattern use simul anneal kirkpatrick et al allow random also complex point pattern without theoret point process model use method shar use reconstruct_pattern r patternreconstruct echo fals outheight outwidth figalign center knitrinclude_graphicspattern_reconstructiongif refer comita ls condit r hubbel sp development chang habitat associ tropic tree journal ecolog httpsdoiorgjx garzonlopez cx jansen pa bohlman sa ordonez olff h effect sampl scale pattern habitat associ tropic tree journal veget scienc httpsdoiorgjv harm ke condit r hubbel sp foster rb habitat associ tree shrub ha neotrop forest plot journal ecolog httpsdoiorgjx kirkpatrick gelatt cdjr vecchi mp optim simul anneal scienc httpsdoiorgscienc plotkin jb pott md lesli n manokaran n lafranki jv ashton ps speciesarea curv spatial aggreg habitat special tropic forest journal theoret biolog httpsdoiorgjtbi tilman pacala sw mainten speci rich plant commun ricklef schluter ed speci divers ecolog commun univers chicago press chicago pp isbn tscheschel stoyan statist reconstruct random point pattern comput statist data analysi httpsdoiorgjcsda wiegand moloney ka handbook spatial pointpattern analysi ecolog chapman hallcrc press boca raton isbn titl reconstruct multipl pattern author maximilian hk hesselbarth date r sysdat output rmarkdownhtml_vignett vignett vignetteindexentryhow reconstruct multipl pattern vignetteencodingutf vignetteengineknitrrmarkdown editor_opt chunk_output_typ consol r setup includ fals knitropts_chunkset collaps true comment case want reconstruct sever pattern eg differ point time repeat census avail use follow code pleas awar maximum number iter set max_run keep comput time low exampl appli case valu increas r loadpackag messag fals warn fals libraryshar libraryspatstat libraryrast case want creat spatial characterist straightforward use lappli r severalpattern creat list pattern list_pattern listspecies_a species_b reconstruct pattern list result lapplylist_pattern functionx reconstruct_patternpattern x n_random max_run verbos fals result nest list includ random includ observ pattern n provid input pattern r resultspati get mean energi lapplyresult functionx calculate_energypattern x verbos fals anoth possibl would first reconstruct n time spatial characterist afterward reconstruct mark time n spatial reconstruct firstli reconstruct spatial characterist n time observ pattern need case put return_input fals r reconstructpattern reconstruct spatial strucutr reconstructed_pattern reconstruct_patternspecies_a n_random max_run return_input fals verbos fals secondli reconstruct numer mark observ pattern spatial reconstruct pattern use lappli combin reconstruct_pattern_mark r reconstructmark get select mark input numer mark species_a_mark subsetspecies_a select dbh reconstruct mark time input pattern result_mark lapplyreconstructed_patternrandom functionx reconstruct_pattern_markspattern x marked_pattern species_a_mark max_run n_random verbos fals result nest list dimens provid input pattern reconstruct r resultmark get energi lapplyresult_mark functionx calculate_energypattern x verbos fals gener roxygen edit hand pleas edit document rclassint_to_vectorr nameclassint_to_vector aliasclassint_to_vector titleclassint_to_vector usag classint_to_vectorx digit null argument itemxclassinterv object itemdigitsinteg digit use round valu vector descript convert classinterv vector detail return charact vector break codeclassinterv object codedigit null result round exampl dontrun classint_to_vectorx landscape_classifiedbreak digit keywordintern gener roxygen edit hand pleas edit document rtranslate_rasterr nametranslate_rast aliastranslate_rast titletranslate_rast usag translate_rast raster steps_x null steps_i null return_input true simplifi fals verbos true argument itemrasterrasterlay discret habitat class itemsteps_x steps_yinteg number step cell raster translat correspond direct null possibl combin use result n raster itemreturn_inputlog origin input data return itemsimplifylog raster return coden_random codereturn_input fals itemverboselog progress report print valu rd_ra descript toru translat detail toru translat test describ harm et al raster shift four cardin direct step equal raster resolut cell exit extent one side enter extent opposit side method allow na valu present rasterlay exampl dontrun landscape_classifi classify_habitatslandscap n style fisher landscape_random translate_rasterlandscape_classifi landscape_random_sub translate_rasterlandscape_classifi steps_x steps_i refer harm ke condit r hubbel sp foster rb habitat associ tree shrub ha neotrop forest plot journal ecolog httpsdoiorgjx seealso codelinkrandomize_rast gener roxygen edit hand pleas edit document rdatar doctypedata namelandscap aliaslandscap titleexampl landscap random cluster neutral landscap model format rasterlay object sourc simul neutral landscap model r httpsgithubcomropenscinlmr usag landscap descript exampl map show landscapetool function gener codenlmrnlm_fbm algorithm keyworddataset gener roxygen edit hand pleas edit document rplotrd_patr nameplotrd_pat aliasplotrd_pat titleplotrd_pat usag methodplotrd_pat x sf n null prob c comp_fast ask true verbos true argument itemxrd_pat bject random pattern itemwhatcharact specifi plot summari function point pattern codewhat sf actual pattern codewhat pp itemninteg number vector id random pattern plot see detail section inform itemprobsvector quantil random data use envelop construct itemcomp_fastinteg threshold summari function estim comput fast way itemasklog user ask press return second summari function plot use codewhat sf itemverboselog progress report print itemnot use valu void descript plot method rd_pat object detail function plot pair correl function nearest neighbour function observ pattern reconstruct pattern simul envelop larg pattern codecomp_fast true decreas comput demand edg correct use pair correl function estim base ripley kfunction inform see codelinkestimate_pcf_fast also possibl plot n random pattern observ pattern use codewhat pp coden singl number coden random pattern sampl plot coden vector correspond pattern plot exampl dontrun pattern_random fit_point_processspecies_a n_random plotpattern_random pattern_recon reconstruct_patternspecies_b n_random max_run method hetero plotpattern_recon seealso codelinkreconstruct_pattern cr codelinkfit_point_process gener roxygen edit hand pleas edit document rdatar doctypedata namegamma_test aliasgamma_test titlegamma test format rd_pat object usag gamma_test descript random data speci b use gamma test keyworddataset gener roxygen edit hand pleas edit document rlist_to_randomizedr namelist_to_random aliaslist_to_random titlelist_to_random usag list_to_randomizedlist observ null argument itemlistlist itemobservedobserv valu rd_pat rd_ra descript convert list rd_ object detail convert list random point pattern raster layer rd_ object use function packag main purpos util function allow easi parallel random approach inform pleas see parallel articl exampl dontrun fit_list lapplyx fun functioni fit_point_processpattern species_a n_random simplifi true return_input fals verbos fals list_to_randomizedlist fit_list observ species_a seealso codelinkrandomize_rast cr codelinktranslate_rast cr codelinkreconstruct_pattern gener roxygen edit hand pleas edit document rdatar doctypedata namereconstruct aliasreconstruct titlereconstruct format rd_pat object usag reconstruct descript random data speci b use pattern reconstruct keyworddataset gener roxygen edit hand pleas edit document rdatar doctypedata namespecies_b aliasspecies_b titlespeci b format spatstat ppp object usag species_b descript speci posit associ habitat codelandscap pleas awar posit associ one habitat inevit lead neg associ habitat yamada et al refer yamada tomita itoh yamakura ohkubo kanzaki tan ashton ps habitat associ sterculiacea tree bornean rain forest plot journal veget scienc keyworddataset gener roxygen edit hand pleas edit document restimate_pcf_fastr nameestimate_pcf_fast aliasestimate_pcf_fast titleestimate_pcf_fast usag estimate_pcf_fastpattern argument itempatternppp object point pattern itemargu pass codelinkkest codelinkpcffv valu fvobject descript fast estim pair correl function detail function estim pair correl function base estim ripley kfunction make comput faster estim pair correl function directli wrapper around codelinkkest codelinkpcffv exampl pcf_species_b estimate_pcf_fastspecies_a refer chiu sn stoyan kendal ws meck j stochast geometri applic rd ed wiley seri probabl statist john wiley son inc chichest uk isbn ripley bd model spatial pattern journal royal statist societi seri b methodolog httpsdoiorgjtbx stoyan stoyan h fractal random shape point field john wiley son chichest isbn seealso codelinkkest cr codelinkpcffv gener roxygen edit hand pleas edit document rsharpackag doctypepackag nameshar aliasshar aliassharpackag titlepackag descript descript analys specieshabitat associ r therefor inform locat speci need environment condit test signific habitat associ one two compon random method mainli base plotkin et al doijtbi harm et al doijx seealso use link item item urlhttpsrspatialecologygithubioshar item report bug urlhttpsgithubcomrspatialecologysharissu author strongmaintain maximillian hk hesselbarth emailmhkhesselbarthgmailcom hrefhttpsorcidorgorcid author item item marco sciaini emailmarcosciainiposteonet hrefhttpsorcidorgorcid contributor item item zeke marshal emaileezmleedsacuk hrefhttpsorcidorgorcid contributor item thoma etherington emailtethaucklanduniacnz hrefhttpsorcidorgxorcid contributor keywordintern gener roxygen edit hand pleas edit document rreconstruct_pattern_heteror namereconstruct_pattern_hetero aliasreconstruct_pattern_hetero titlereconstruct_pattern_hetero usag reconstruct_pattern_hetero pattern n_random e_threshold max_run no_chang inf anneal comp_fast weight c r_length return_input true simplifi fals verbos true plot fals argument itempatternppp object pattern itemn_randominteg number random iteme_thresholddoubl minimum energi stop reconstruct itemmax_runsinteg maximum number iter codee_threshold reach itemno_changeinteg number iter reconstruct stop energi decreas itemannealingdoubl probabl keep reloc point even energi decreas itemcomp_fastinteg threshold summari function estim comput fast way itemweightsvector weight use calcul energi first number refer gestr second number pcfr itemr_lengthinteg number interv coder coder rmax summari function evalu itemreturn_inputlog origin input data return itemsimplifylog pattern return coden_random codereturn_input fals itemverboselog progress report print itemplotlog pcfr function plot updat optim valu rd_pat descript pattern reconstruct heterogen pattern exampl dontrun input_pattern spatstatcorerpoispplambda functionx exp x nsim pattern_recon reconstruct_pattern_heteroinput_pattern n_random max_run refer kirkpatrick gelatt cdjr vecchi mp optim simul anneal scienc httpsdoiorgscienc tscheschel stoyan statist reconstruct random point pattern comput statist data analysi httpsdoiorgjcsda wiegand moloney ka handbook spatial pointpattern analysi ecolog chapman hallcrc press boca raton isbn keywordintern gener roxygen edit hand pleas edit document rplotrd_marr nameplotrd_mar aliasplotrd_mar titleplotrd_mar usag methodplotrd_mar x sf n null prob c comp_fast ask true verbos true argument itemxrd_mar object random pattern itemwhatcharact specifi plot summari function point pattern codewhat sf actual pattern codewhat pp itemninteg number vector id random pattern plot see detail section inform itemprobsvector quantil random data use envelop construct itemcomp_fastinteg threshold summari function estim comput fast way itemasklog user ask press return second summari function plot use codewhat sf itemverboselog progress report print itemnot use valu void descript plot method rd_pat object detail function plot pair correl function nearest neighbour function observ pattern reconstruct pattern simul envelop larg pattern codecomp_fast true decreas comput demand edg correct use pair correl function estim base ripley kfunction inform see codelinkestimate_pcf_fast also possibl plot n random pattern observ pattern use codewhat pp coden singl number coden random pattern sampl plot coden vector correspond pattern plot exampl dontrun pattern_recon reconstruct_patternspecies_a n_random max_run simplifi true return_input fals marks_sub spatstatgeomsubsetpppspecies_a select dbh marks_recon reconstruct_pattern_markspattern_recon marks_sub n_random max_run plotmarks_recon seealso codelinkreconstruct_pattern cr codelinkfit_point_process gener roxygen edit hand pleas edit document rcreate_neighbourhoodr namecreate_neighbourhood aliascreate_neighbourhood titlecreate_neighbourhood usag create_neighbourhoodcel matrix direct argument itemcellsmatrix cell id focal cell itemmatrixmatrix cell locat itemdirectionsinteg cell neighbourhood rule rook case queen case valu matrix descript creat neighbourhood detail get cell id neighbour cell neighbourhoood rule specifi either rook case neighbour queen case neighbour exampl dontrun mat matrix nrow ncol cell_id rbindcbind cbind create_neighbourhoodcell_id mat seealso codelinkrandomize_rast keywordintern gener roxygen edit hand pleas edit document rprintrd_patr nameprintrd_pat aliasprintrd_pat titleprintrd_pat usag methodprintrd_patx digit argument itemxrd_pat object random pattern itemdigitsinteg number decim place round itemargu pass codecat valu void descript print method rd_pat object detail print method random pattern creat codereconstruct_pattern_ exampl pattern_random fit_point_processspecies_a n_random printpattern_random dontrun pattern_recon reconstruct_patternspecies_b n_random max_run method hetero printpattern_recon seealso codelinkreconstruct_pattern cr codelinkfit_point_process gener roxygen edit hand pleas edit document rcalculate_energyr namecalculate_energi aliascalculate_energi titlecalculate_energi usag calculate_energi pattern weight c return_mean fals comp_fast verbos true argument itempatternlist reconstruct pattern itemweightsvector weight use calcul energi first number refer gestr second number pcfr itemreturn_meanlog mean energi return itemcomp_fastinteg threshold summari function estim comput fast way itemverboselog progress report print valu vector descript calcul mean energi detail function calcul mean energi deviat observ pattern reconstruct pattern inform see tscheschel stoyan wiegand moloney pair correl function nearest neighbour distanc function use describ pattern larg pattern codecomp_fast true decreas comput demand edg correct use pair correl function estim base ripley kfunction inform see codelinkestimate_pcf_fast exampl pattern_random fit_point_processspecies_a n_random calculate_energypattern_random calculate_energypattern_random return_mean true dontrun marks_sub spatstatgeomsubsetpppspecies_a select dbh marks_recon reconstruct_pattern_markspattern_randomrandom marks_sub n_random max_run calculate_energymarks_recon return_mean fals refer kirkpatrick gelatt cdjr vecchi mp optim simul anneal scienc httpsdoiorgscienc tscheschel stoyan statist reconstruct random point pattern comput statist data analysi httpsdoiorgjcsda wiegand moloney ka handbook spatial pointpattern analysi ecolog chapman hallcrc press boca raton isbn seealso codelinkplot_energi cr codelinkreconstruct_pattern cr codelinkfit_point_process gener roxygen edit hand pleas edit document rprintrd_rasr nameprintrd_ra aliasprintrd_ra titleprintrd_ra usag methodprintrd_rasx argument itemxrd_ra object random raster itemargu pass codecat valu void descript print method rd_ra object detail print method random pattern creat codelinkrandomize_rast codelinktranslate_rast exampl dontrun landscape_classifi classify_habitatslandscap n style fisher landscape_random randomize_rasterlandscape_classifi n_random printlandscape_random seealso codelinkrandomize_rast cr codelinktranslate_rast gener roxygen edit hand pleas edit document rdatar doctypedata namespecies_a aliasspecies_a titlespeci format spatstat ppp object usag species_a descript speci neg associ habitat codelandscap pleas awar neg associ one habitat inevit lead posit associ habitat yamada et al refer yamada tomita itoh yamakura ohkubo kanzaki tan ashton ps habitat associ sterculiacea tree bornean rain forest plot journal veget scienc keyworddataset gener roxygen edit hand pleas edit document rreconstruct_pattern_marksr namereconstruct_pattern_mark aliasreconstruct_pattern_mark titlereconstruct_pattern_mark usag reconstruct_pattern_mark pattern marked_pattern n_random e_threshold max_run no_chang inf anneal r_length return_input true simplifi fals verbos true plot fals argument itempatternppp object pattern itemmarked_patternppp object mark pattern see detail section inform itemn_randominteg number random iteme_thresholddoubl minimum energi stop reconstruct itemmax_runsinteg maximum number iter codee_threshold reach itemno_changeinteg number iter reconstruct stop energi decreas itemannealingdoubl probabl keep reloc point even energi decreas itemr_lengthinteg number interv coder coder rmax summari function evalu itemreturn_inputlog origin input data return itemsimplifylog pattern return coden_random codereturn_input fals itemverboselog progress report print itemplotlog pcfr function plot updat optim valu rd_mar descript pattern reconstruct mark pattern detail function random numer mark point pattern use pattern reconstruct describ tscheschel stoyan wiegand moloney therefor unmark well mark pattern must provid unmark pattern must spatial characterist observ window number point mark one see codereconstruct_pattern_ codelinkfit_point_process mark must numer markcorrel function use summari function two randomli chosen mark switch iter chang kept deviat observ reconstruct pattern decreas codespatstat set coder_length default howev lower valu decreas comput time increas bumpi summari function exampl dontrun pattern_recon reconstruct_patternspecies_a n_random max_run simplifi true return_input fals marks_sub spatstatgeomsubsetpppspecies_a select dbh marks_recon reconstruct_pattern_markspattern_recon marks_sub n_random max_run refer kirkpatrick gelatt cdjr vecchi mp optim simul anneal scienc httpsdoiorgscienc tscheschel stoyan statist reconstruct random point pattern comput statist data analysi httpsdoiorgjcsda wiegand moloney ka handbook spatial pointpattern analysi ecolog chapman hallcrc press boca raton isbn seealso codelinkfit_point_process cr codelinkreconstruct_pattern gener roxygen edit hand pleas edit document rreconstruct_patternr namereconstruct_pattern aliasreconstruct_pattern titlereconstruct_pattern usag reconstruct_pattern pattern method homo n_random e_threshold max_run no_chang inf anneal comp_fast n_point null window null weight c r_length return_input true simplifi fals verbos true plot fals argument itempatternppp object pattern itemmethodcharact specifi method either codehomo codeclust codehetero itemn_randominteg number random iteme_thresholddoubl minimum energi stop reconstruct itemmax_runsinteg maximum number iter codee_threshold reach itemno_changeinteg number iter reconstruct stop energi decreas itemannealingdoubl probabl keep reloc point even energi decreas itemcomp_fastinteg threshold summari function estim comput fast way itemn_pointsinteg number point simul itemwindowowin object window simul pattern itemweightsvector weight use calcul energi first number refer gestr second number pcfr itemr_lengthinteg number interv coder coderrmax summari function evalu itemreturn_inputlog origin input data return itemsimplifylog pattern return coden_random codereturn_inputfals itemverboselog progress report print itemplotlog pcfr function plot updat optim valu rd_pat descript pattern reconstruct detail function random observ pattern use pattern reconstruct describ tscheschel stoyan wiegand moloney algorithm shift point new locat keep chang deviat observ reconstruct pattern decreas pair correl function nearest neighbour distanc function use describ pattern larg pattern coden comp_fast pair correl function estim ripley kfunction without edg correct decreas comput time inform see codelinkestimate_pcf_fast reconstruct stop automat n step energi decreas number step control codeno_chang set codeno_chang inf default never stop automat weight must sumweight weight summari function ident use codeweight c codespatstat set coder_length default howev lower valu decreas comput time increas bumpi summari function argument coden_point codewindow use codemethodhomo subsectionmethodhomo algorithm start random pattern subsectionmethodclust algorithm start random cluster pattern subsectionmethodhetero algorithm start random heterogen pattern exampl dontrun pattern_recon reconstruct_patternspecies_b n_random max_run refer kirkpatrick gelatt cdjr vecchi mp optim simul anneal scienc httpsdoiorgscienc tscheschel stoyan statist reconstruct random point pattern comput statist data analysi httpsdoiorgjcsda wiegand moloney ka handbook spatial pointpattern analysi ecolog chapman hallcrc press boca raton isbn seealso codelinkcalculate_energi cr codelinkreconstruct_pattern_mark gener roxygen edit hand pleas edit document rrandomize_rasterr namerandomize_rast aliasrandomize_rast titlerandomize_rast usag randomize_rast raster n_random direct return_input true simplifi fals verbos true argument itemrasterrasterlay discret habitat class itemn_randominteg number random itemdirectionsinterg cell neighbourhood rule rook case queen case itemreturn_inputlog origin input data return itemsimplifylog raster return coden_random codereturn_input fals itemverboselog progress report print valu rd_ra descript randomizedhabitat procedur detail function random habitat map discret class rasterlay propos harm et al randomizedhabitat procedur algorithm start empti habitat map start assign random neighbour cell habitat increas order abund observ map modifi procedur slightli increas probabl jump nonneighbour cell current patch becom larger case rasterlay contain na cell need reflect observ window point pattern well ie point locat possibl area exampl dontrun landscape_classifi classify_habitatslandscap n style fisher landscape_random randomize_rasterlandscape_classifi n_random refer harm ke condit r hubbel sp foster rb habitat associ tree shrub ha neotrop forest plot journal ecolog httpsdoiorgjx seealso codelinktranslate_rast gener roxygen edit hand pleas edit document rprintrd_marr nameprintrd_mar aliasprintrd_mar titleprintrd_mar usag methodprintrd_marx digit argument itemxrd_mar object random pattern itemdigitsinteg number decim place round print itemargu pass codecat valu void descript print method rd_mar object detail print method random pattern creat codelinkreconstruct_pattern_mark exampl dontrun pattern_recon reconstruct_patternspecies_a n_random max_run simplifi true return_input fals marks_sub spatstatgeomsubsetpppspecies_a select dbh marks_recon reconstruct_pattern_markspattern_recon marks_sub n_random max_run printmarks_recon seealso codelinkreconstruct_pattern_mark gener roxygen edit hand pleas edit document rsample_randomizedr namesample_random aliassample_random titlesample_random usag sample_randomizedrandom n null verbos true argument itemrandomizedlist random raster pattern itemninteg number vector id random pattern plot itemverboselog progress report print valu list descript sampl random list detail get list coden random raster pattern coden singl number coden random element sampledt coden vector correspond element return exampl dontrun sample_randomizedrandom reconstructionrandom n c keywordintern gener roxygen edit hand pleas edit document rdatar doctypedata namerandom_walk aliasrandom_walk titlerandom walk format rd_ra object usag random_walk descript random codelandscap use habitat random algorithm keyworddataset gener roxygen edit hand pleas edit document rreconstruct_pattern_homor namereconstruct_pattern_homo aliasreconstruct_pattern_homo titlereconstruct_pattern_homo usag reconstruct_pattern_homo pattern n_random e_threshold max_run no_chang inf anneal n_point null window null comp_fast weight c r_length return_input true simplifi fals verbos true plot fals argument itempatternppp object pattern itemn_randominteg number random iteme_thresholddoubl minimum energi stop reconstruct itemmax_runsinteg maximum number iter codee_threshold reach itemno_changeinteg number iter reconstruct stop energi decreas itemannealingdoubl probabl keep reloc point even energi decreas itemn_pointsinteg number point simul itemwindowowin object window simul pattern itemcomp_fastinteg threshold summari function estim comput fast way itemweightsvector weight use calcul energi first number refer gestr second number pcfr itemr_lengthinteg number interv coder coder rmax summari function evalu itemreturn_inputlog origin input data return itemsimplifylog pattern return coden_random codereturn_input fals itemverboselog progress report print itemplotlog pcfr function plot updat optim valu rd_pat descript pattern reconstruct homogen pattern exampl dontrun pattern_recon_a reconstruct_pattern_homospecies_a n_random max_run pattern_recon_b reconstruct_pattern_homospecies_a n_point n_random max_run refer kirkpatrick gelatt cdjr vecchi mp optim simul anneal scienc httpsdoiorgscienc tscheschel stoyan statist reconstruct random point pattern comput statist data analysi httpsdoiorgjcsda wiegand moloney ka handbook spatial pointpattern analysi ecolog chapman hallcrc press boca raton isbn keywordintern gener roxygen edit hand pleas edit document rclassify_habitatsr nameclassify_habitat aliasclassify_habitat titleclassify_habitat usag classify_habitatsrast return_break fals argument itemrasterrasterlay continu environment valu itemreturn_breakslog break return well itemargu pass codeclassinterv valu rasterlay descript classifi habitat detail classifi rasterlay coderast packag continu valu n discret class codecut function use classifi raster use codeincludelowest true inform classif method see codeclassinterv codeclassint packag andor provid refer help page codeclassinterv also includ possibl argument find break eg differ style number class fix break etc exampl landscape_classifi classify_habitatslandscap n style fisher landscape_classifi classify_habitatslandscap style fix fixedbreak c return_break true refer armstrong mp xiao n bennett da use genet algorithm creat multicriteria class interv choropleth map annal associ american geograph httpsdoiorg dent bd cartographi themat map design th ed wcbmcgrawhil boston usa isbn fisher wd group maximum homogen journal american statist associ httpsdoiorg jenk gf caspal fc error choropleth map definit measur reduct annal associ american geograph httpsdoiorgjtbx jiang b headtail break new classif scheme data heavytail distribut profession geograph httpsdoiorg slocum ta mcmaster rb kessler fc howard hh themat cartographi geovisu rd ed ed prentic hall seri geograph inform scienc pearson prentic hall upper saddl river usa isbn wand p databas choic histogram binwidth american statistician httpsdoiorg seealso codelinkclassinterv gener roxygen edit hand pleas edit document rresults_habitat_associationr nameresults_habitat_associ aliasresults_habitat_associ titleresults_habitat_associ usag results_habitat_associ pattern raster significance_level break null digit null verbos true argument itempatternppp object origin point pattern data rd_pat rd_mar object random point pattern itemrasterrasterlay origin discret habitat data rd_ra object random environment data itemsignificance_leveldoubl signific level itembreaksvector break habitat class itemdigitsinteg digit use round itemverboselog messag print valu datafram descript result habitat associ detail function show signific habitat associ compar number point within habitat observ data random data describ plotkin et al harm et al signific posit associ present observ count habitat certain threshold random count respect case rasterlay contain na cell need reflect observ window point pattern well ie point locat possibl area codebreak null default habitat label break return vector codebreak provid order increas habitat valu break includ well exampl landscape_classifi classify_habitatslandscap n style fisher species_a_random fit_point_processspecies_a n_random results_habitat_associationpattern species_a_random raster landscape_classifi refer harm ke condit r hubbel sp foster rb habitat associ tree shrub ha neotrop forest plot journal ecolog httpsdoiorgjx plotkin jb pott md lesli n manokaran n lafranki jv ashton ps speciesarea curv spatial aggreg habitat special tropic forest journal theoret biolog httpsdoiorgjtbi seealso codelinkreconstruct_pattern cr codelinkfit_point_process gener roxygen edit hand pleas edit document rextract_pointsr nameextract_point aliasextract_point titleextract_point usag extract_pointsrast pattern argument itemrasterrasterlay environment data itempatternppp object point pattern valu datafram descript extract point detail function extract number point within discret habitat exampl dontrun landscape_classifi classify_habitatslandscap n style fisher extract_pointsrast landscape_classifi pattern species_b seealso codelinkresults_habitat_associ keywordintern gener roxygen edit hand pleas edit document rdatar doctypedata nametorus_tran aliastorus_tran titletoru tran format rd_ra object usag torus_tran descript toru translat classifi codelandscap keyworddataset gener roxygen edit hand pleas edit document rreconstruct_pattern_clusterr namereconstruct_pattern_clust aliasreconstruct_pattern_clust titlereconstruct_pattern_clust usag reconstruct_pattern_clust pattern n_random e_threshold max_run no_chang inf anneal comp_fast weight c r_length return_input true simplifi fals verbos true plot fals argument itempatternppp object pattern itemn_randominteg number random iteme_thresholddoubl minimum energi stop reconstruct itemmax_runsinteg maximum number iter codee_threshold reach itemno_changeinteg number iter reconstruct stop energi decreas itemannealingdoubl probabl keep reloc point even energi decreas itemcomp_fastinteg threshold summari function estim comput fast way itemweightsvector weight use calcul energi first number refer gestr second number pcfr itemr_lengthinteg number interv coder coder rmax summari function evalu itemreturn_inputlog origin input data return itemsimplifylog pattern return coden_random codereturn_input fals itemverboselog progress report print itemplotlog pcfr function plot updat optim valu rd_pat descript pattern reconstruct cluster pattern exampl dontrun pattern_recon reconstruct_pattern_clusterspecies_b n_random max_run refer kirkpatrick gelatt cdjr vecchi mp optim simul anneal scienc httpsdoiorgscienc tscheschel stoyan statist reconstruct random point pattern comput statist data analysi httpsdoiorgjcsda wiegand moloney ka handbook spatial pointpattern analysi ecolog chapman hallcrc press boca raton isbn keywordintern gener roxygen edit hand pleas edit document rplot_energyr nameplot_energi aliasplot_energi titleplot_energi usag plot_energypattern col null argument itempatternrd_pat rd_mar object random pattern itemcolvector color must length coden_random valu void descript plot energi pattern reconstruct detail function plot decreas energi time ie iter help identifi chosen codemax_run reconstruct suffici codepattern object must creat use codereconstruct_pattern_ exampl dontrun pattern_recon reconstruct_patternspecies_a n_random max_run plot_energypattern_recon marks_sub spatstatgeomsubsetpppspecies_a select dbh marks_recon reconstruct_pattern_markspattern_reconrandom marks_sub n_random max_run plot_energymarks_recon seealso codelinkreconstruct_pattern cr codelinkfit_point_process gener roxygen edit hand pleas edit document rplotrd_rasr nameplotrd_ra aliasplotrd_ra titleplotrd_ra usag methodplotrd_rasx n null col verbos true nrow ncol argument itemxrd_ra object random raster itemninteg number vector id random raster plot see detail section inform itemcolvector color palett use plot itemverboselog messag print itemnrow ncolinteg number row column plot grid itemnot use valu void descript plot method rd_ra object detail function plot random raster coden singl number coden random raster sampl plot coden vector correspond raster plot codecol nrow ncol pass codeplot exampl dontrun landscape_classifi classify_habitatslandscap n style fisher landscape_random randomize_rasterlandscape_classifi n_random plotlandscape_random seealso codelinkrandomize_rast cr codelinktranslate_rast gener roxygen edit hand pleas edit document rfit_point_processr namefit_point_process aliasfit_point_process titlefit_point_process usag fit_point_process pattern n_random process poisson return_input true simplifi fals verbos true argument itempatternppp object point pattern itemn_randominteg number random itemprocesscharact specifi point process model use either codepoisson codeclust itemreturn_inputlog origin input data return itemsimplifylog pattern return coden_random codereturn_input fals itemverboselog progress report print valu rd_pat descript fit point process random data detail function random observ point pattern fit point process data simul coden_random pattern use fit point process possibl choos poisson process thoma cluster process model inform point process model see eg wiegand moloney exampl pattern_fit fit_point_processpattern species_a n_random refer plotkin jb pott md lesli n manokaran n lafranki jv ashton ps speciesarea curv spatial aggreg habitat special tropic forest journal theoret biolog httpsdoiorgjtbi wiegand moloney ka handbook spatial pointpattern analysi ecolog chapman hallcrc press boca raton isbn