eigen tensor tensor multidimension array element element typic scalar complex type string also support toc tensor class manipul tensor one follow class namespac eigen class tensordata_typ rank class use creat tensor alloc memori class templat tensor datatyp float int tensor rank rank number dimens exampl rank matrix tensor class resiz exampl assign tensor differ size tensor tensor resiz match new valu constructor tensordata_typ ranksiz size constructor tensor constructor must pass rank integ indic size instanc along rank dimens creat tensor rank size tensor own memori hold float point valu x x tensorfloat t_d resiz t_d assign tensor differ size rank t_d tensorfloat constructor tensordata_typ ranksize_array constructor size constructor specifi array valu instead explicitli list paramet array type use eigenarrayeigenindex array construct automat initi list creat tensor string rank size tensorstr t_d class tensorfixedsizedata_typ sizess size class use tensor fix size size known compil time fix size tensor provid fast comput dimens known compil fixeds tensor resiz total number element fix size tensor small enough tensor data held onto stack caus heap alloc free creat x tensor float tensorfixedsizefloat size t_x class tensormaptensordata_typ rank class use creat tensor top memori alloc own anoth part code allow view piec alloc memori tensor instanc class memori data store tensormap resiz memori data store constructor tensormaptensordata_typ rankdata size size constructor tensor constructor must pass pointer storag data rank size attribut storag larg enough hold data map tensor int top stackalloc storag int storag x x x tensormapint t_dstorag storag view differ tensor also pass size array tensormapint t_dstorag also map fixeds tensor get view fixeds tensor tensorfloat size t_x tensormapfloat t_t_x class tensorref see assign tensorref access tensor element data_typ tensorindex index return element posit index index tensor tensor must pass mani paramet rank tensor express use lvalu set valu element specifi posit valu return datatyp tensor set valu element posit tensorfloat t_d t_d f initi element random valu int int j j j int k k k t_di j k random valu print element tensor int loginfo t_di tensorlayout tensor librari support layout colmajor default rowmajor default column major layout current fulli support therefor recommend attempt use row major layout moment layout tensor option specifi part type specifi explicitli column major assum tensorfloat colmajor col_major equival tensorfloat tensormaptensorfloat rowmajor row_majordata argument express must use layout attempt mix differ layout result compil error possibl chang layout tensor express use swap_layout method note also revers order dimens tensorfloat colmajor col_major tensorfloat rowmajor row_major tensorfloat col_major_result col_major ok layout match tensorfloat col_major_result row_major compil simpl layout swap col_major_result row_majorswap_layout eigen_assertcol_major_resultdimens eigen_assertcol_major_resultdimens swap layout preserv order dimens arrayint shuffl col_major_result row_majorswap_layoutshuffleshuffl eigen_assertcol_major_resultdimens eigen_assertcol_major_resultdimens tensor oper eigen tensor librari provid vast librari oper tensor numer oper addit multipl geometri oper slice shuffl etc oper avail method tensor class case oper overload exampl follow code comput elementwis addit two tensor tensorfloat set valu tensorfloat set valu set element wise sum tensorfloat code look easi enough import understand express actual ad valu tensor express instead construct tensor oper object class tensorcwisebinaryopscalar_sum refer tensor small c object know add valu express assign tensor addit actual perform technic happen overload oper tensor class mechan comput tensor express allow lazi evalu optim make tensor librari fast cours tensor oper nest express f actual repres approxim tree oper tensorcwisebinaryopscalar_sumt tensorcwiseunaryopscalar_mult f tensor oper c auto tensor oper creat tensor oper c auto keyword intuit mean consid line code tensorfloat auto first line alloc tensor contain result addit second line actual tree tensor oper comput addit fact tensor get valu element tensorfloat cout ok print valu auto cout compil error use auto get tensor result instead nonevalu express use auto delay evalu unfortun singl underli concret type hold nonevalu express henc use auto case want hold nonevalu express need result set tensor comput assign result tensor capabl hold onto either normal tensor fix size tensor tensormap exist piec memori follow work auto tensorfloat result could also resultt cout result tensormapfloat resulta float enough space size cout result tensorfixedsizefloat sizess result cout result need result keep oper around even reus addit oper long keep express oper comput perform one way comput expt f auto auto f auto texp tensorfloat result anoth way exactli effici previou one tensorfloat result fexp control express evalu sever way control express evalu assign tensor tensorfixeds tensormap use eval method assign tensorref assign tensor tensorfixeds tensormap common way evalu express assign tensor exampl auto declar make intermedi valu oper tensor caus express evalu assign tensor result caus evalu oper auto oper auto f oper auto texp oper tensorfloat result oper evalu know rank size oper valu assign oper tensorfixeds instead tensor bit effici know result xx tensor tensorfixedsizefloat result simiarli assign express tensormap caus evalu like tensor type tensorfixeds tensormap resiz rank size express assign call eval comput larg composit express sometim want tell eigen intermedi valu express tree worth evalu ahead time done insert call eval method express oper previou exampl could written tensorfloat result fexp want comput ahead time write tensorfloat result teval fexp semant call eval equival materi valu express temporari tensor right size code effect eval know size tensorfixedsizefloat tmp tensorfloat result tmp fexp note return valu eval oper follow code may think evalu oper evalu yet auto teval use anoth express still evalu auto fexp valu evalu assign oper tensor use intermedi tensor repres tx tensorfloat result exampl call eval make differ perform case make huge differ express broadcast express caus xmaximum express evalu mani time tensor x tensor x xmaximumdepth_dimreshapedimsdbroadcastbcast betaexp insert call eval maximum reshap call guarante maximum comput greatli speedsup execut tensor x xmaximumdepth_dimevalreshapedimsdbroadcastbcast betaexp exampl tensor use express assign alias problem evalu done right order updat increment evalu result bogu result tensor ysumdepth_dimreshapedimsdbroadcastbcast insert call eval sum reshap express ensur sum comput updat done ysumdepth_dimevalreshapedimsdbroadcastbcast note eval around full right hand side express need gener comput ith valu right hand side assign left hand side howev assign express valu shuffl would need forc eval correct ad eval call right hand side yshuffl ysumdepth_dimevalreshapedimsdbroadcastbcastev assign tensorref need access element valu express avoid materi valu full tensor use tensorref tensorref small wrapper class eigen oper provid overload oper let access individu valu express tensorref conveni oper provid way access individu element creat tensorref express express evalu yet tensorreftensorfloat ref fexp use ref access individu element express evalu fli float at_ ref cout ref use tensorref need subset valu express tensorref comput valu access howev note go access valu much faster materi result tensor first case full tensor result would larg may save memori access tensorref alway dont count control express evalu tensor librari provid sever implement variou oper contract convolut implement optim differ environ singl thread cpu multi thread cpu gpu use cuda addit implement may ad later choos implement use devic call choos implement explicitli default implement use singl thread cpu use default implement optim recent intel cpu take advantag sse avx fma instruct work ongo tune librari arm cpu note need pass compilerdepend flag enabl use sse avx instruct exampl follow code add two tensor use default singlethread cpu implement tensorfloat tensorfloat b tensorfloat c b choos differ implement insert devic call assign result technic c reason requir tensor result declar mean know size result eigentensorfloat c cdevic b call devic must last call left oper must pass devic call eigen devic object present three devic use defaultdevic threadpooldevic gpudevic evalu defaultdevic exactli insert devic call defaultdevic my_devic cdevicemy_devic b evalu thread pool creat eigen threadpooldevic eigenthreadpooldevic my_devic number thread use use devic evalu express eigentensorfloat c cdevicemy_devic acontractb dot_product_dim evalu gpu present bit complic use thread pool devic need creat gpu devic also need explicitli alloc memori tensor cuda api refer datatyp document tensor method oper mention datatyp tensortyp specif tensortypedimens act like array int int size attribut index like array access individu valu use repres dimens tensor see dimens tensortypeindex act like int use index tensor along dimens see oper dimens size tensortypescalar repres datatyp individu tensor element exampl tensorfloat scalar type float see setconst oper use pseudo type indic tensor oper return method indic text type dimens tensor oper return evalu oper evalu exampl assign tensor access valu result tensor also access valu tensorref builtin tensor method usual c method act tensor immedi oper provid delay evalu result unless specifi otherwis method list avail tensor class tensor tensorfixeds tensormap metadata int numdimens constant valu indic number dimens tensor also known tensor rank eigentensorfloat cout dim anumdimens dim dimens dimens return arraylik object repres dimens tensor actual type dimens result tensortypedimens eigentensorfloat const eigentensorfloat dimens adimens cout dim size dsize dim dim dim size dim dim use c compil use auto simplifi code const auto adimens cout dim size dsize dim dim dim size dim dim index dimensionindex n return nth dimens tensor actual type dimens result tensortypeindex alway use like int eigentensorfloat int dim adimens cout dim dim dim index size return total number element tensor product tensor dimens actual type size result tensortypeindex alway use like int eigentensorfloat cout size asiz size get dimens oper oper provid dimens directli eg tensorreslicingop oper defer calcul dimens oper evalu need access dimens defer oper wrap tensorref see assign tensorref provid dimens dimens tensorref also wrap plain tensor type use idiom templat context underli object could either raw tensor defer oper eg slice tensor case templat code wrap object tensorref reason dimension remain agnost underli type constructor tensor creat tensor specifi size number argument must equal rank tensor content tensor initi eigentensorfloat cout numrow adimens numcol adimens endl numrow numcol tensorfixeds creat tensor specifi size number argument size templat paramet determin rank tensor content tensor initi eigentensorfixedsizefloat size cout rank arank endl rank cout numrow adimens numcol adimens endl numrow numcol tensormap creat tensor map exist array data data must freed tensormap discard size data must larg enough accomod coeffici tensor float data eigentensormapfloat adata cout numrow adimens numcol adimens endl numrow numcol cout endl content initi new tensor new tensorfixeds creat memori alloc hold tensor element memori initi similarli new tensormap creat top noniniti memori memori content initi use one method initi tensor memori immedi effect tensor return tensor result tensor oper delay evalu tensortyp setconstantconst scalar val set element tensor constant valu val scalar type data store tensor pass valu convert type return tensor case want chain anoth call asetconstantf cout constant endl endl endl constant note setconst use tensor element type copi constructor oper eigentensorstr asetconstantyolo cout string tensor endl endl endl string tensor yolo yolo yolo yolo yolo yolo tensortyp setzero fill tensor zero equival setconstantscalar return tensor case want chain anoth call asetzero cout zero endl endl endl zero tensortyp setvaluesinitializer_list fill tensor explicit valu specifi stdinitializer_list type initi list depend type rank tensor tensor rank n initi list must nest n time deepli nest list must contain p scalar tensor type p size last dimens tensor exampl tensorfixedsizefloat initi list must contain list float setvalu return tensor case want chain anoth call eigentensorfloat asetvaluesf f f f f f cout endl endl endl list short correspond element tensor chang valid level nest exampl follow code set valu first row tensor eigentensorint asetconst asetvalu cout endl endl endl tensortyp setrandom fill tensor random valu return tensor case want chain anoth call asetrandom cout random endl endl endl random custom setrandom provid random number gener templat argument asetrandommyrandomgener myrandomgener must struct follow member function scalar index tensortypescalar tensortypeindex see struct uniformrandomgener tensorfunctorsh exampl custom number gener use setrandom struct myrandomgener default copi constructor need myrandomgener myrandomgeneratorconst myrandomgener return random valu use element_loc locat entri set tensor typic ignor scalar operatoreigendenseindex element_loc eigendenseindex unus const return randomli gener valu type gener sever number time typenam internalpacket_traitsscalartyp packetop eigendenseindex packet_loc eigendenseindex unus const return packet randomli gener valu also use one random number gener part tensor librari uniformrandomgener normalrandomgener data access tensor tensorfixeds tensorref class provid follow accessor access tensor coeffici const scalar operatorconst arrayindex numindic indic const scalar operatorindex firstindex indextyp otherindic scalar operatorconst arrayindex numindic indic scalar operatorindex firstindex indextyp otherindic number indic must equal rank tensor moreov accessor avail tensor express order access valu tensor express express must either evalu wrap tensorref scalar data const scalar data const return pointer storag tensor pointer const tensor const allow direct access data layout data depend tensor layout rowmajor colmajor access usual need special case exampl mix eigen tensor code librari scalar type data store tensor eigentensorfloat float a_data adata a_data f cout tensor oper method document return non evalu tensor oper chain appli anoth tensor oper valu return method chain oper evalu lazili typic assign tensor see control express evalu detail evalu oper constantconst scalar val return tensor type dimens origin tensor element valu val use exampl want add subtract constant tensor multipli everi element tensor scalar eigentensorfloat asetconstantf eigentensorfloat b aconstantf eigentensorfloat c b bconstantf cout endl endl endl cout b endl b endl endl cout c endl c endl endl b c oper random return tensor type dimens current tensor element random valu exampl use add random valu exist tensor gener random valu custom manner setrandom eigentensorfloat asetconstantf eigentensorfloat b arandom cout endl endl endl cout b endl b endl endl b unari element wise oper oper take singl input tensor argument return tensor type dimens tensor appli request oper appli element independ oper oper return tensor type dimens origin tensor contain opposit valu origin tensor eigentensorfloat asetconstantf eigentensorfloat b cout endl endl endl cout b endl b endl endl b oper sqrt return tensor type dimens origin tensor contain squar root origin tensor oper rsqrt return tensor type dimens origin tensor contain invers squar root origin tensor oper squar return tensor type dimens origin tensor contain squar origin tensor valu oper invers return tensor type dimens origin tensor contain invers origin tensor valu oper exp return tensor type dimens origin tensor contain exponenti origin tensor oper log return tensor type dimens origin tensor contain natur logarithm origin tensor oper ab return tensor type dimens origin tensor contain absolut valu origin tensor oper powscalar expon return tensor type dimens origin tensor contain coeffici origin tensor power expon type expon scalar alway type tensor coeffici exampl integ expon use conjunt tensor integ valu use cast lift restrict exampl comput cubic root int tensor eigentensorint asetvalu eigentensordoubl b acastdoublepow cout endl endl endl cout b endl b endl endl b oper oper scalar scale multipli coeffici input tensor provid scale oper cwisemaxscalar threshold todo oper cwiseminscalar threshold todo oper unaryexprconst customunaryop func todo binari element wise oper oper take two input tensor argument input tensor type dimens result tensor dimens tensor appli unless otherwis specifi also type request oper appli pair element independ oper operatorconst otherderiv return tensor type dimens input tensor contain coeffici wise sum input oper operatorconst otherderiv return tensor type dimens input tensor contain coeffici wise differ input oper operatorconst otherderiv return tensor type dimens input tensor contain coeffici wise product input oper operatorconst otherderiv return tensor type dimens input tensor contain coeffici wise quotient input oper support integ type oper cwisemaxconst otherderiv return tensor type dimens input tensor contain coeffici wise maximum input oper cwiseminconst otherderiv return tensor type dimens input tensor contain coeffici wise mimimum input oper logic oper follow logic oper support well operatorconst otherderiv operatorconst otherderiv operatorconst otherderiv operatorconst otherderiv operatorconst otherderiv operatorconst otherderiv operatorconst otherderiv operatorconst otherderiv return tensor boolean valu select selectconst thenderiv thentensor const elsederiv elsetensor select coefficientwis ternari oper tensor equival ifthenels oper tensorbool tensorfloat tensorfloat els tensorfloat result ifselectthen els argument must dimens also dimens result tensor must type boolean els tensor must type also type result coeffici result equal correspond coeffici tensor correspond valu tensor true result coeffici come els tensor contract tensor contract gener matrix product multidimension case creat matric use tensor rank eigentensorint asetvalu eigentensorint b asetvalu comput tradit matrix product arrayindexpairint product_dim indexpair eigentensorint ab acontractb product_dim comput product transpos matric arrayindexpairint transpose_product_dim indexpair eigentensorint atbt acontractb transposed_product_dim reduct oper reduct oper return tensor fewer dimens origin tensor valu return tensor comput appli reduct oper slice valu origin tensor specifi dimens along slice made eigen tensor librari provid set predefin reduct oper maximum sum let defin addit oper implement method reductor templat reduct dimens reduct oper take singl paramet type tensortypedimens alway specifi array int call reduct dimens valu indic dimens input tensor reduct done paramet mani element rank input tensor element must less tensor rank indic one dimens reduc dimens input tensor occur reduct dimens implement remov duplic order valu reduct dimens affect result code may execut faster list dimens increas order exampl reduct along one dimens creat tensor dimens eigentensorint asetvalu reduc along second dimens eigenarrayint dim dimens reduc use maximum oper result tensor one dimens size dimens first nonreduc dimens eigentensorint b amaximumdim cout endl endl endl cout b endl b endl endl b exampl reduct along two dimens eigentensorfloat eigencolmajor asetvaluesf f f f f f f f f f f f f f f f f f f f f f f f tensor dimens reduc along first result tensor singl dimens size last dimens note pass array reduct dimens directli maximum call eigentensorfloat eigencolmajor b amaximumeigenarrayint cout b endl b endl endl b reduct along dimens special case pass paramet reduct oper origin tensor reduc along dimens result scalar repres zerodimens tensor eigentensorfloat asetvaluesf f f f f f f f f f f f f f f f f f f f f f f f reduc along dimens use sum oper eigentensorfloat b asum cout b endl b endl endl b oper sumconst dimens new_dim oper sum reduc tensor use sum oper result valu sum reduc valu oper meanconst dimens new_dim oper mean reduc tensor use mean oper result valu mean reduc valu oper maximumconst dimens new_dim oper maximum reduc tensor use maximum oper result valu largest reduc valu oper minimumconst dimens new_dim oper minimum reduc tensor use minimum oper result valu smallest reduc valu oper prodconst dimens new_dim oper prod reduc tensor use prod oper result valu product reduc valu oper allconst dimens new_dim oper reduc tensor use oper cast tensor bool check whether element true run element rather shortcircuit may significantli ineffici oper anyconst dimens new_dim oper reduc tensor use oper cast tensor bool check whether element true run element rather shortcircuit may significantli ineffici oper reduceconst dimens new_dim const reduc reduc reduc tensor use userdefin reduct oper see sumreduc tensorfunctorsh inform implement reduct oper scan oper scan oper return tensor dimens origin tensor oper perform inclus scan along specifi axi mean comput run total along axi given reduct oper reduct oper correspond summat comput prefix sum tensor along given axi exampl dd comment line creat tensor dimens eigentensorint asetvalu scan along second dimens use summat eigentensorint b acumsum result tensor size input cout endl endl endl cout b endl b endl endl b oper cumsumconst index axi perform scan sum consecut entri oper cumprodconst index axi perform scan multipli consecut entri convolut oper convolveconst kernel kernel const dimens dim return tensor output convolut input tensor kernel along specifi dimens input tensor dimens size dimens output tensor part convolut reduc formula output_dim_s input_dim_s kernel_dim_s requir input_dim_s kernel_dim_s dimens size dimens part convolut remain perform convolut depend length stride input tensor dimens along convolut comput first dimens shortest stride colmajor wherea rowmajor shortest stride last dimens comput convolut along second third dimens tensorfloat datalayout input tensorfloat datalayout kernel tensorfloat datalayout output inputsetrandom kernelsetrandom eigenarrayptrdiff_t dim specifi second third dimens convolut output inputconvolvekernel dim int int j j j int k k k int l l l const float result outputijkl const float expect inputijkl kernel inputijkl kernel inputijkl kernel inputijkl kernel verify_is_approxresult expect geometr oper oper return tensor differ dimens origin tensor use access slice tensor see differ dimens pad tensor addit data oper reshapeconst dimens new_dim return view input tensor reshap specifi new dimens argument new_dim array index valu rank result tensor equal number element new_dim product size new dimens array must equal number element input tensor increas rank input tensor introduc new dimens size tensorfloat input arrayint three_dim tensorfloat result inputreshapethree_dim decreas rank input tensor merg dimens arrayint one_dim tensorfloat result inputreshapeone_dim oper move data input tensor result content reshap tensor depend data layout origin tensor exampl happen reshap colmajor tensor one dimens eigentensorfloat eigencolmajor asetvaluesf f f f f f eigenarrayeigendenseindex one_dim eigentensorfloat eigencolmajor b areshapeone_dim cout b endl b endl b happen tensor rowmajor eigentensorfloat eigenrowmajor asetvaluesf f f f f f eigenarrayeigendenseindex one_dim eigentensorfloat eigenrowmajor b areshapeone_dim cout b endl b endl b reshap oper lvalu word use left side assign oper previou exampl rewritten follow eigentensorfloat eigencolmajor asetvaluesf f f f f f eigenarrayeigendenseindex two_dim eigentensorfloat eigencolmajor b breshapetwo_dim cout b endl b endl b note b reshap instead assign done reshap view b oper shuffleconst shuffl shuffl return copi input tensor whose dimens reorder accord specifi permut argument shuffl array index valu size rank input tensor must contain permut rank ith dimens output tensor equal size shuffleith dimens input tensor exampl shuffl dimens left tensorfloat input set valu input tensorfloat output inputshuffl eigen_assertoutputdimens eigen_assertoutputdimens eigen_assertoutputdimens indic output tensor shuffl accordingli formul indic input tensor exampl one assert code snippet eigen_assertoutput input gener one assert eigen_assertoutput indicesshufflei input indicesi shuffl oper result lvalu mean assign word use left side assign oper let rewrit previou exampl take advantag featur shuffl dimens left tensorfloat input set valu input tensorfloat output outputshuffl input oper strideconst stride stride return view input tensor stride skip stride element along dimens argument stride array index valu dimens result tensor ceilinput_dimensionsi stridesi exampl happen stride tensor eigentensorint asetvalu eigenarrayeigendenseindex stride eigentensorint b astridestrid cout b endl b endl b possibl assign tensor stride tensorfloat input set valu input tensorfloat output outputstrid input oper sliceconst startindic offset const size extent return subtensor given tensor dimens slice made coeffici store offseti offseti extentsi input tensor eigentensorint asetvalu eigenarrayint offset eigenarrayint extent eigentensorint slice asliceoffset extent cout endl endl cout slice endl slice endl slice oper chipconst index offset const index dim chip special kind slice subtensor given offset dimens dim return tensor one fewer dimens input tensor dimens dim remov exampl matrix chip would either row column input matrix eigentensorint asetvalu eigentensorint row_ achip eigentensorint col_ achip cout endl endl cout row_ endl row_ endl row_ cout col_ endl col_ endl col_ possibl assign valu tensor chip sinc chip oper lvalu exampl eigentensorint asetvalu eigentensorint b bsetzero bchip cout endl endl cout b endl b endl b oper reverseconst reversedimens revers return view input tensor revers order coeffici along subset dimens argument revers array boolean valu indic whether order coeffici revers along dimens oper preserv dimens input tensor exampl happen revers first dimens tensor eigentensorint asetvalu eigenarraybool reversetru fals eigentensorint b areverserevers cout endl endl b endl b endl b oper broadcastconst broadcast broadcast return view input tensor input replic one mani time broadcast argument specifi mani copi input tensor need made dimens eigentensorint asetvalu eigenarrayint bcast eigentensorint b abroadcastbcast cout endl endl b endl b endl b oper concatenateconst otherderiv axi axi todo oper padconst paddingdimens pad return view input tensor input pad zero eigentensorint asetvalu eigenarraypairint int pad pad make_pair pad make_pair eigentensorint b apadpad cout endl endl b endl b endl b oper extract_patchesconst patchdim patch_dim return tensor coeffici patch extract input tensor patch dimens specifi patch_dim return tensor one greater dimens input tensor use index patch patch index output tensor depend data layout input tensor patch index last dimens colmajor layout first dimens rowmajor layout exampl given follow input tensor eigentensorfloat datalayout tensor tensorsetvaluesf f f f f f f f f f f f cout tensor endl tensor endl tensor six x patch extract index use follow code eigentensorfloat datalayout patch eigenarrayptrdiff_t patch_dim patch_dim patch_dim patch tensorextract_patchespatch_dim int k k k cout patch index k endl int int j j j datalayout colmajor cout patchi j k els cout patchk j cout endl code result follow output data layout colmajor patch index patch index patch index patch index patch index patch index code result follow output data layout rowmajor note set patch colmajor index differ patch index patch index patch index patch index patch index patch index oper extract_image_patchesconst index patch_row const index patch_col const index row_strid const index col_strid const paddingtyp padding_typ return tensor coeffici imag patch extract input tensor expect dimens order follow depend data layout input tensor number addit dimens n colmajor st dimens channel size nd dimens row size r rd dimens column size c thnth dimens time video batch bulk process rowmajor revers order colmajor stnth dimens time video batch bulk process nth dimens column size c nth dimens row size r nth dimens channel size return tensor one greater dimens input tensor use index patch patch index output tensor depend data layout input tensor patch index th dimens colmajor layout th last dimens rowmajor layout exampl given follow input tensor follow dimens size depth row column batch tensorfloat tensor tensorfloat rowmajor tensor_row_major tensorswap_layout x imag patch extract index use follow code patch colmajor patch index secondtolast dimens tensorfloat twod_patch twod_patch tensorextract_image_patch twod_patchdimens twod_patchdimens twod_patchdimens twod_patchdimens twod_patchdimens patch rowmajor patch index second dimens tensorfloat rowmajor twod_patch_row_major twod_patch_row_major tensor_row_majorextract_image_patch twod_patch_row_majordimens twod_patch_row_majordimens twod_patch_row_majordimens twod_patch_row_majordimens twod_patch_row_majordimens special oper oper castt return tensor type dimens origin tensor return tensor contain valu origin tensor convert type eigentensorfloat eigentensorint b acastint use exampl need elementwis divis tensor integ current support tensor librari easili cast tensor float divis eigentensorint asetvalu eigentensorint b acastfloat aconstantcastfloatcastint cout endl endl endl cout b endl b endl endl b oper eval todo represent scalar valu scalar valu often repres tensor size rank would logic user friendli use tensor rank instead exampl tensort nmaximum current return tensort similarli inner product tensor contract return tensor futur oper might updat return tensor instead limit number tensor dimens current limit use compil support cxx limit older compil indexlist class requir cxx compliant compil use array indic instead dont access modern compil gpu float point valu properli test optim complex integ valu known broken gpu tri use youll like end trigger static assert failur eigen_static_assertpackets you_made_a_programming_mistak imag httpstravisciorgpopgenmethodssmcppsvgbranchmast target httpstravisciorgpopgenmethodssmcpp smc program estim size histori popul whole genom sequenc data content depth quick start guid follow instal instructions_ convert vcf smc input format vcfsmc_ smc vcfsmc mydatavcfgz outchrsmcgz chr popss command pars data contig chr sampl member popul pop run independ contig dataset produc one smc output file per contig fit model use estimate_ smc estim analysi e outexamplechrsmcgz first mandatori argument e pergener mutat rate remain argument data file gener previou step depend sampl size machin fit procedur take minut hour fit model store json format analysismodelfinaljson visual result use plot_ smc plot plotpdf analysismodelfinaljson smc also estim plot joint demographi pair popul see split_ _latest releas httpsgithubcompopgenmethodssmcppreleaseslatest instal instruct begin v smc distribut docker imag anaconda support discontinu run latest version program type docker run rm v pwdmnt terhorstsmcpplatest argument run specif version program chang latest version follow version number exampl run v type docker run rm v pwdmnt terhorstsmcppvers argument docker unavail exampl cluster environ admin privileg user report success use singularity_ instead _singular httpssylabsioguidesuserguid build instruct smc requir follow librari execut order compil run python greater c compil gcc later exampl gmp_ ration field comput mpfr_ least version extend precis calcul gsl_ gnu scientif librari ubuntu debian linux librari requir may instal use commmand sudo aptget instal pythondev libgmpdev libmpfrdev libgsldev os x easiest way instal use homebrew_ brew instal mpfr gmp gsl instal requir smc may built run pip instal githttpsgithubcompopgenmethodssmcpp altern git clone repositori run usual python setuppi instal must clone download sourc tarbal work _homebrew httpbrewsh _gmp httpgmpliborg _mpfr httpmpfrorg _gsl httpswwwgnuorgsoftwaregsl note os x user version clang ship mac os x current support openmp_ order build smc os x must use compil gcc brew instal gcc ccgcc cxxg python setuppi instal _openmp httpopenmporg virtual environ smc pull fair number python depend prefer keep separ main python instal root access system may wish instal smc insid virtual environment_ first creat activ virtual environ virtualenv p python desir locat sourc desir locationbinactiv instal smc describ _virtual environ httpdocspythonguideorgenlatestdevvirtualenv usag smc compris sever subcommand access use syntax smc subcommand subcommand one follow vcfsmc subcommand convert biallel diploid vcf data format use smc requir argument index vcf file httpwwwhtsliborgdoctabixhtml_ output file append gz extens caus output compress estimate_ command read compress uncompress data sourc contig name call vcfsmc_ process singl contig vcf contain multipl contig process via multipl separ run list popul sampl popul id follow commasepar list sampl id column name vcf two popul support exampl convert contig chr vcfgz use sampl na na popul ceu save chrsmcgz use smc vcfsmc vcfgz chrsmcgz chr ceunana option argument smc reli crucial notion pair distinguish lineag see paper detail terminolog ident distinguish lineag set use option specifi sampl form distinguish pair accept sampl id first allel taken sampl second sampl form distinguish pair use one haplotyp na use exampl smc vcfsmc na na vcfgz chrsmcgz chr ceunana note first second allel mean unphas data data phase make sens specifi singl individu eg na na _mask mask specifi bedformat mask file whose posit mark miss data across sampl output smc data set use delin larg uncal region eg centromer often omit vcf file without addit inform provid mask way distinguish miss region long run homozygos finergrain control miss data set individu posit sampl miss genotyp also work fine point mask save user troubl emit million row miss observ vcf missingcutoff c altern mask automat treat run homozgos longer c base pair miss typic c set high filter legitim long run homozy base inform recent demographi fairli crude approach filter recommend use case use mask possibl composit likelihood vari vcf creat distinct data set estim use form composit likelihood exampl follow command creat three data set contig chr myvcfgz vari ident distinguish individu treat remain two sampl undistinguish codeblock bash smc vcfsmc nai nai myvcfgz outitxt chr na na na done pass data set estimate_ smc estim output mutat rate outtxt smc treat file outtxt independ evolv sequenc ie chromosom likelihood simpli product smc likelihood data set exampl data set gener chromosom differ distinguish individu differ independ assumpt violat lead socal composit likelihood advantag approach incorpor genealog inform addit distinguish individu analysi potenti lead improv estim sinc portion comput memori requir smc scale linearli total analyz sequenc length gener advis composit rel small number individu practic gener use individu depend genom length sampl size etc found lead improv estim without caus signific degeneraci likelihood caveat vcfsmc target common usecas may suffici user particular awar ancestr allel assum refer allel filter qual column ignor indel structur variant nonsnp data ignor site contain multipl entri vcf first entri ignor site present vcf assum homoyzg ancestr across sampl see masking_ wish implement custom convers smc data format see input data format_ descript estim command fit popul size histori data basic usag smc estim mutat rate data file data file requir argument pergener mutat rate scientif notat accept use eg e place one smcformat data file gener vcfsmc_ exampl option argument specifi directori store final estim well intermedi file debug output default ie current work directori polarizationerror ident ancestr allel known option use specifi prior polar error p emiss probabl entri csfsab comput p csfsab p csfsa nb default set ie ident ancestr allel known unfold alia polarizationerror ancestr allel known outgroup say option use unfold sf comput probabl incorrect usag featur may lead erron result number argument concern technic aspect fit procedur exist see pass h option estim cv command similar estimate_ differ use crossvalid obtain sensibl model paramet use estim syntax option command nearli ident estimate_ smc cv mutat rate data file data file option fold paramet use specifi number fold use perform kfold cross valid default set higher case data import cv command part origin paper particular peerreview although prove use context manual paramet tune may still necessari plot command plot fit size histori basic usag smc plot plotpng modeljson modeljson modelnjson modeljson fit model produc estim requir argument output filenam output format determin extens pdf png jpeg etc one jsonformat smc model output estimate_ option argument g set gener time year use scale xaxi given plot coalesc unit logi plot yaxi log scale c produc csvformat tabl contain data use gener plot split command fit twopopul clean split model use margin estim produc estimate_ use split first estim popul margin use estim smc vcfsmc myvcfgz datapopsmcgz contig popind_ind_ smc vcfsmc myvcfgz datapopsmcgz contig popind_ind_ smc estim pop mu datapopsmcgz smc estim pop mu datapopsmcgz next creat dataset contain joint frequenc spectrum popul smc vcfsmc myvcfgz datapopsmcgz contig popind_ind_ popind_ind_ smc vcfsmc myvcfgz datapopsmcgz contig popind_ind_ popind_ind_ final run split refin margin estim estim joint demographi smc split split popmodelfinaljson popmodelfinaljson datasmcgz smc plot jointpdf splitmodelfinaljson posterior command export option visual posterior distribut time recent common ancestor tmrca distinguish pair given data set output file result numpysavezoutput hidden_statesh filegamma file_sitessit hs vector length indic breakpoint use discret hidden tmrca distinguish pair breakpoint chosen probabl coalesc within interv uniform respect fit model site vector length l contain posit decod perform data set file due intern archtectur smc one entri per row data set gamma array dimens x l whose entri gammam ell give averag posterior probabl coalesc interv hsm hsm site interv sitesel sitesel gammasit entri data set decod requir argument model fit smc model ie modelfinaljson output estimate_ output file name save posterior decod array format shown data one data set smc format ie output vcfsmc_ option argument heatmap plotpngpdfjpg also produc heatmap posterior decod output format given extens start end e region much longer cm heatmap look pretti noisi option use narrow specif region chromosom colorbar also add colorbar show scale heatmap cite command print plain bibtexformat citat inform accompani paper_ consol _accompani paper httpwwwnaturecomngjournalvaopncurrentng tip use smc smc sever regular paramet affect qualiti fit obtain use estimate_ split_ default set prove use analyz high coverag human sequenc data hundr individu type data like need experi differ valu paramet order obtain good estim thin paramet control frequenc full csf emit see paper detail decreas valu paramet caus likelihood depend strongli frequenc spectrum inform undistinguish portion sampl potenti lead accur result recent past howev decreas much lead degeneraci likelihood sinc correl undistinguish portion ancestr recombin graph ignor default valu sampl size n logn note differ version earlier empir work well sampl size order n may need experi bit spline control function form use fit model default valu recent version piecewis better match output pmsmc enabl cubic spline use paper use spline cubic spline pchip detail differ cubic pchip spline see httpsblogsmathworkscomclevesplinesandpchipsccbdfbdbbeaed_ timepoint command specifi start end time point model accept two number tk specifi start end time point model gener specifi smc use heurist calcul model time point point automat regularizationpenalti rp paramet penal curvatur estim size histori default valu paramet lower valu penalti shrink estim size histori toward line estim exhibit much oscil tri decreas valu paramet note behavior differ version earlier ftol paramet specifi threshold stop em algorithm rel improv loglikelihood becom small default valu e toler epsilon xx new old estim algorithm termin loglikx loglikx loglikx epsilon increas valu epsilon caus optim stop earlier potenti prevent overfit knot paramet specifi number spline knot use underli represent size histori default valu use fewer knot lead smoother fit howev underspecifi paramet may smooth interest featur size histori use diagnost understand final output smc sequenc intermedi estim modeliterkjson save estim output directori plot get sens whether optim overfit requir addit regular frequent ask question binari instal die error messag importerror liblibcso version glibc_ found requir fix user redhatcento cluster commonli report error due glibc version mismatch system build server use creat binari instal abl creat binari older version glibc option either upgrad glibc system would probabl requir upgrad oper system b build smc follow build instructions_ pleas note link differ version glibc runtim support like caus random crash smc claim popul crash recent past what go typic due long run homozygos roh data aris one sever reason popul legitim experienc recent crash lead inbreed one select sweep occur uncal region vcf mark run vcfsmc_ repres real signal filter use option vcfsmc_ andor c option estimate_ get estim recombin rate modelfinaljson output file contain field name rho n rho estim populationsc recombin rate per basepair convert unit gener multipli n encount troubl smc activ develop may encount difficulti tri use alway make sure upgrad latest version httpsgithubcompopgenmethodssmcppreleaseslatest_ bug encount may alreadi fix work believ encount bug softwar unexpect crash high memori usag etc pleas file issu httpsgithubcompopgenmethodssmcppissues_ bug tracker would like assist interpret result pleas email directli best tri help pleas understand limit time respond inquiri case receiv faster respons includ much detail possibl data set sampl size contig etc system applic debugtxt log file save smc output directori specifi estim command file format input data format data file ascii text option gzip format line data file follow span u n u n explan column span give number contigu base observ occur henc gener snp greater one stretch nonsegreg site three column dun popul give genotyp distinguish individu genotyp distinguish individu known set next column u total number deriv allel found remaind undistinguish sampl site final column n haploid sampl size number nonmiss observ undistinguish portion sampl exampl consid follow set genotyp set contigu base three diploid individu one popul dist n n n distinguish individu row one indic individu homozyg ancestr allel integ indic individu possess copi deriv allel n indic miss genotyp posit final column seven indic individu three possess ancestr allel one chromosom miss observ chromosom would code vcf smc format input file data file also includ custom metadata header addit inform popul reason advis pleas use includ vcfsmc_ tool order translat vcf smc format output data format upon complet smc write jsonformat httpsenwikipediaorgwikijson_ model file analysi directori file humanread contain variou paramet relat fit procedur