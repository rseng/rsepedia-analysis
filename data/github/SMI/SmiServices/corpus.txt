changelog notabl chang project document file format base keep changeloghttpskeepachangelogcomen project adher semant versioninghttpssemverorgspecvhtml chang sinc previou releas found newsnew directori raw git diff seen hereunreleas next featur httpsgithubcomsmismiservicespul ja ctpanonymis refactor reduc memori footprint issu simplifi rabbitmq messag handl stop creat temporari copi input file longer need epcc environ without lustr fs per issu add check input file readabl extant hope fix issu httpsgithubcomsmismiservicespul rkm add equ automat implement equal member class httpsgithubcomsmismiservicespul rkm updat rdmp packag replac systemdatasqlcli microsoftdatasqlcli replac usag codebas bugfix httpsgithubcomsmismiservicespul howff clean python code lint run pylint httpsgithubcomsmismiservicespul tznind fix bug dispos csvdestin instanc begun write output httpsgithubcomsmismiservicespul tznind fix edg case identifiermapp dicom tag illeg multipl patientid field meta httpsgithubcomsmismiservicespul rkm add precommit codespel fix current spell mistak httpsgithubcomsmismiservicespul rkm fixup regex codespel config httpsgithubcomsmismiservicespul rkm specifi dotnet sdk version globaljson httpsgithubcomsmismiservicespul rkm bump langvers httpsgithubcomsmismiservicespul rkm add check error messag miss coveral token httpsgithubcomsmismiservicespul rkm fix set replic mongodb window ci pipelin remov httpsgithubcomsmismiservicespul rkm remov nationalpacsaccessionnumb metadata bugfix httpsgithubcomsmismiservicespul tznind improv log fix yaml option respect isidentifiablereview featur httpsgithubcomsmismiservicespul tznind ad support specifi isidentifi cli option yaml config file instead command line command line alway take preced specifi httpsgithubcomsmismiservicespul tznind ad custom theme isidentifiablereview use flag theme mythemeyaml httpsgithubcomsmismiservicespul tznind ad help cancel button custom pattern dialog review httpsgithubcomsmismiservicespul tznind ad isidentifiablereview set main yaml config httpsgithubcomsmismiservicespul tznind ad rule manag isidentifi review bugfix httpsgithubcomsmismiservicespul rkm fix call releas changelog script httpsgithubcomsmismiservicespul rkm requir ci test pass packag run httpsgithubcomsmismiservicespul rkm dont upload coverag tag build httpsgithubcomsmismiservicespul tznind fix bug open corrupt report isidentifiablereview crash applic httpsgithubcomsmismiservicespul tznind replac use globalcolorschem proper static member terminalgui propag correctli window without set manual httpsgithubcomsmismiservicespul rkm fix coverag task alway run even previou task fail doc httpsgithubcomsmismiservicespul tznind refresh document isidentifiablereview featur httpsgithubcomsmismiservicespul tznind ad parallelis load process isidentifiablereview rule view bugfix httpsgithubcomsmismiservicespul howff open csv file readonli httpsgithubcomsmismiservicespul tznind isidentifiablereview ad usc usesystemconsol altern display driver base systemconsol remov modal dialog could caus error open previous complet report ad label current open file fix ignoreupd label ad spinner indic load next report sequenti mode take fix bug ctrlq ignoreupd custom pattern rulesview result hard crash httpsgithubcomsmismiservicespul tznind fix bug multipl enumer load larg failur report isidentifiablereview meta httpsgithubcomsmismiservicespul rkm add code coverag httpsgithubcomsmismiservicespul rkm move use script azurepipelinesscript util updat utilsreadmemd httpsgithubcomsmismiservicespul rkm fixup coverag variabl pushespr bugfix httpsgithubcomsmismiservicespul tznind fix review tree view refreshasync code featur httpsgithubcomsmismiservicespul rkm improv cli user experi immedi verifi config file globalopt weve load somewhat valid improv visibl except messag cli exit bugfix httpsgithubcomsmismiservicespul rkm switch order annot extractimagescliopt fix runtim except meta httpsgithubcomsmismiservicespul rkm remov net core runtim azur pipelin build featur httpsgithubcomsmismiservicespul rkm replac java extractorcli c extractimag servic _breaking_ exist script document _breaking_ chang extractorclopt extractimagesopt yaml config httpsgithubcomsmismiservicespul rkm upgrad project relat ci script net httpsgithubcomsmismiservicespul tznind updat rdmp dicom plugin bugfix httpsgithubcomsmismiservicespul rkm add nugetconfig file fix flaki issu azur ci runner ref httpsgithubcomnugethomeissu httpsgithubcomactionsvirtualenvironmentsissu httpsgithubcomsmismiservicespul rkm fixup current lgtm alert httpsgithubcomsmismiservicespul rkm revert hacki method fix nuget cach azur window agent httpsgithubcomsmismiservicespul rkm remov workaround window agent azur ci sinc fix upstream ref httpsgithubcomactionsvirtualenvironmentsissu bugfix httpsgithubcomsmismiservicespul rkm fix remov check prevent modal specifi extract key httpsgithubcomsmismiservicespul rkm cohortextractor databas queri crash execut log httpsgithubcomsmismiservicespul howff sever improv python code handl unusuallyformat sr document httpsgithubcomsmismiservicespul rkm fix reportnewlin incorrectli set preescap string fix doc httpsgithubcomsmismiservicespul howff isidentifiablereview document updat featur httpsgithubcomsmismiservicespul tznind improv isidentifi review tab base navig better pattern gener overlap failur part fix sequenti mode alway show failur cover exist updat rule fix tree view adapt new rule ad eg use interact process mani failur httpsgithubcomsmismiservicespul tznind ad modalityspecificrejectoropt bugfix httpsgithubcomsmismiservicespul rkm fix log directori name singleentrypoint app fix httpsgithubcomsmismiservicespul howff fix python packag run repo root dir httpsgithubcomsmismiservicespul howff minor fix python compat eg semehr use python use uniqu temporari directori input output file enabl extract mongodb studyd field filepath index httpsgithubcomsmismiservicespul howff reword cohortextractor loginfo messag patient reject meta httpsgithubcomsmismiservicespul rkm add note releas document alert mattermost channel featur httpsgithubcomsmismiservicespul tznind isidentifiablereview ad progress load larg file cancel support group outstand failur column fix rule flag ident classifi differ input column httpsgithubcomsmismiservicespul rkm convert singl entrypoint app break exist script process refer old applic httpsgithubcomsmismiservicespul howff improv python script test document httpsgithubcomsmismiservicespul howff improv test sr anonymis standalon stub httpsgithubcomsmismiservicespul tznind ad abil ignor multipl failur identifi review bugfix httpsgithubcomsmismiservicespul tznind fix consensusrul run httpsgithubcomsmismiservicespul ja reduc memori consumpt nerd httpsgithubcomsmismiservicespul rkm normalis isidentifiablereview namespac match applic httpsgithubcomsmismiservicespul howff call garbag collector report progress everi record process databas sourc isidentifi httpsgithubcomsmismiservicespul howff creat python packag call smiservic wheel creat renam import new packag name remov refer pythonpath replac path rel import independ current directori fix python test httpsgithubcomsmismiservicespul howff sranontool updat handl output latest semehr anonymis ignor nonetyp annot httpsgithubcomsmismiservicespul tznind fix layout main window longer obscur classificationtyp httpsgithubcomsmismiservicespul tznind fix tree view lose select index updatingignor failur tree view httpsgithubcomsmismiservicespul howff silenc deprec warn newer python note azur pipelin test meta httpsgithubcomsmismiservicespul rkm prevent addit languag pack includ publish packag reduc overal packag size bit httpsgithubcomsmismiservicespul rkm manual updat csvhelper fodicom httpsgithubcomsmismiservicespul rkm check clobber file packag build httpsgithubcomsmismiservicespul rkm replac legaci securitycodescan securitycodescanv httpsgithubcomsmismiservicespul rkm chang track pr chang news fragment file add script autoupd changelog file httpsgithubcomsmismiservicespul rkm remov temporari refer badmedicin ad httpsgithubcomsmismiservicespul httpsgithubcomsmismiservicespul howff add azur pipelin test packag python script fix httpsgithubcomsmismiservicespul howff fix ctp log chang httpsgithubcomsmismiservicespul rkm standardis log setup program entri across whole solut break yaml config chang requir remov smi_logs_root variabl yaml config remov tracelog cli option yaml config invoc isidentifi requir yaml config ensur log properli configur httpsgithubcomsmismiservicespul rkm simplifi branch workflow drop develop fix httpsgithubcomsmismiservicespul rkm fix bug newlin would never correctli pars config option cohortpackag httpsgithubcomsmismiservicespul tznind fix consensusrul run depend bump csvhelper bump hicrdmpplugin bump hicrdmpplugintest bump magicknetqanycpu bump securitycodescan bump systemdrawingcommon bump systemioabstract bump systemioabstractionstestinghelp bump jansi bump junit fix httpsgithubcomsmismiservicespul fixup window packag build ad ad total job durat extract report header isidentifiablereview rule review screen ad csv input support isidentifi use verb file command line updat microservic audit perform queri cumul affect row queri execut etc ad f option dicomtagread read singl zipdicom file ad python librari code chang clarifi cli help text format cohortpackag ctp call extern program anonymis structur report requir addit defaultyaml ctpanonymiseroptionssranontool ad break exist program consolid systemioabstractionstestinghelp packag refer smicommontest packag tidi common csproj option directorybuildprop file src test project replac travisci appveyor build azur pipelin fix cohortpackag dont tri creat jobid file recreat exist report cohortpackagertest fix flaki test caus nunit setupteardown code run test parallel cohortpackagertest fix flaki test caus use mongodb databas name run test parallel fix exist ctpanonymis test updat sranontool chang fix execut name updatevalu microservic depend bump csvhelper bump hicrdmpdicom bump hicrdmpplugin bump hicrdmpplugintest bump magicknetqanycpu bump microsoftnettestsdk bump moq bump nunit bump nunitxmltestlogg bump systemioabstract bump systemioabstractionstestinghelp bump yamldotnet ad ad new command line applic triggerupd detect issu updatevaluesmessag eg echi map chang ad new servic updatevalu propag chang eg echi map chang throughout deploy databas tabl consensusrul combin rule eg socketrul see isidentifi readmemd detail ad runtim total failur count isidentifi log ad nosuffixprojectpathresolv gener anonym imag path name contain default behaviour use set cohortextractoroptionsprojectpathresolvertyp microservicescohortextractorexecutionprojectpathresolversnosuffixprojectpathresolv identifi extract nosuffixprojectpathresolv use valid report creat either combin singl report split packsrcmicroservicesmicroservicescohortpackagerreadmemd report includ csv suitabl postprocess configur yaml config also specifi cli recreat report extract ad jobcompletedat valid report isidentifi add support ignor ocr output less n charact length isidentifi add test case burnedin imag text chang updat doc make keyword link relev doc reduc memori usag longrun microservic even net assum ram plenti valid report written project report directori instead central report directori fix fix mismatch javac messag extractionmod extractionfilecopi copi file rel extract root global filesystem root fix implement minimum ocr length report depend bump csvhelper bump systemioabstract bump moq bump systemioabstractionstestinghelp bump csvhelper bump jetbrainsannot bump jacksondataformatyaml bump jacksondatabind fix miss json field ctp output remov refer mongodbdriv smicommonmongodbcsproj sinc caus version conflict output packag ad break add identifi extract support new servic filecopi sit place ctp identifi extract copi sourc file output dir chang mongodb extract schema backward compat test rabbitmq extract config refactor queue servic config file need updat add securitycodescanhttpssecuritycodescangithubio tool build chain net code add filter extract support specifi run extractorcli file reject filter appli cohortextractor true default identifi extract ad cach valu look nlprulesbas isidentifi tool ad new rejector throw valu eg patient id whose id store databas tabl set rejectcolumninfo option yaml enabl ad check querytoexecuteresult rejectreason null reject true chang break environ variabl longer requir previou set appear configur file environ variabl smi_logs_root globaloptionslogsroot environ variabl mongo_service_password mongodboptionspassword remov isidentifiable_numthread didnt work correctli anyway extract report group pixeldata separ sort length isidentifi review symbol rule factori support digit charact mode eg use digit leav charact verbatim isidentifi review symbol option build regex build captur group match fail part input string full problemvalu exampl mr head would return dddddd fix fix extract output directori projidextractionsextractnam depend bump fodicomdraw bump fodicomnetcor bump hicbadmedicinedicom bump hicdicomtypetransl bump hicfansisql bump hicrdmpdicom bump hicrdmpplugin bump hicrdmpplugintest bump microsoftcodeanalysiscsharpscript bump microsoftextensionscachingmemori bump microsoftnettestsdk bump mongodbdriv bump systemioabstract bump systemioabstractionstestinghelp bump terminalgui set publishtrim fals fix bug miss assembl prod ad dicomdirectoryprocessor tagread support zip archiv express notat mydrivemyfoldermyzipzipsomesubdirmydcm requir command line f zip chang improv extract report summaris verif failur start mongodb replic mode travi build switch selfcontain net binari avoid depend host runtim packag nationalpacsaccessionnumb allow null messag depend bump hicrdmpplugin bump mongodbdriv bump systemioabstract bump systemioabstractionstestinghelp bump jacksondataformatyaml chang updat extract report humanread add cli option cohortpackag allow exist report recreat ad runset file nunit allow configur test output fix issu travisci nunittestadapt v caus test output spill k line depend bump hicfansisql bump hicrdmpdicom bump hicrdmpplugin bump magicknetqanycpu bump microsoftextensionscachingmemori bump systemioabstract bump systemioabstract bump systemioabstractionstestinghelp bump comfasterxmljacksondataformatjacksondataformatyaml bump orgmockitomockitocor ad ad imag extract blacklist rejector configur blacklist option specifi list catalogu id catalogu list must includ one column studyinstanceuid seriesinstanceuid sopinstanceuid record referenc tabl blacklist uid found studyinstanceuid seriesinstanceuid sopinstanceuid allow blacklist entir studi specif imag break config live system may need updat chang extract directori gener projnameimagerequestsextractnam fix mvp servic httpsdevazurecomsmiopsmvpservice_workitemsedit fix fix isidentifi rule order order file detect rule directori goe ignorerulesreportrulessocketrul adjust log handl ctp anonymis use smilog setup isidentifi casesensit rule implement properti bufix fodicom imag handl race condit releas mode build issu chang refactor whitelistrul inherit isidentifiablerul affect serial parent properti replac ifclassif casesensit replac ifpatterncasesensit ifpartpatterncasesensit also fix serial bug bump commandlinepars bump csvhelper bump hicbadmedicinedicom bump hicdicomtypetransl bump hicrdmpdicom bump hicrdmpplugin bump magicknetqanycpu bump microsoftcodeanalysiscsharpscript bump microsoftextensionscachingmemori bump mongodbdriv bump stackexchangeredi bump systemioabstract bump yamldotnet bump fodicomdraw pin fodicomnetcor fix fix null check bug cohortpackag file match extract filter ad ad terminalgui version ad dataisidentifiablerul chang break promot pt modal collect mongodb break renam redishost redisconnectionstr config option clariti updat net core support dec sinc support end last year switch cohortextractor use batch messag produc simplifi travi build script fail integr test ci requir servic avail instead skip specifi langvers project file upgrad commandlinepars upgrad csvhelper upgrad hicrdmpdicom upgrad jetbrainsannot upgrad magicknetqanycpu upgrad microsoftcodeanalysiscsharpscript betafin upgrad mongodbdriv upgrad stackexchangeredi upgrad systemdrawingcommon upgrad systemioabstract upgrad yamldotnet fix fix log directori java servic ad ad undo featur isidentifiablereview java microservic log smi_logs_root chang upgrad hicdicomtypetransl includ upgrad fodicom upgrad fodicomdraw upgrad hicrdmpdicom chang updat cohortpackag new extract design consum messag ctp fail anonymis isidentifi verif add support extract modal remov final check anonymis file isidentifi handl alreadi refactor test start refactor core rabbitmqadapt code allow unit test ad isidentifiablereview consid rule captur group perform redact eg handl custom rule like ninewel isidentifiablereview add comment timeus rule file eg tznind pm isidentifiablereview check custom pattern match origin failur isidentifi microservic start servic start servic verb allow take addit option start servic fileyaml isidentifi longer read rulesyaml current directori command line option rulesdirectori go alreadi exist rulesfil read yaml file given directori howev run microservic yaml file specifi datadirectori rulesdirectori implicitli subdirectori call isidentifiablerul yaml file read chang isidentifiablereview tri isol problem word gener suggest updat regex rule eg suggest ninewel instead ninewel spike ct improv usabl isidentifiablereview break updat rabbitmq extract config match extract plan v refactor java except handl use thread tessdirectori option isidentifi expect tesseract model file exist longer download demand ad support outsourc classif eg nlp process via tcp enter socketrul rulesyaml isidentifi nlp text classif outsourc via tcp servic configur stanfordn implement written javasrcmicroservicesukacdundeehicnerdreadmemd new cohortextractor yaml config option projectpathresolvertyp determin folder structur extract imag ad scriptutilsrabbitmqconfigtesterrabbitmqconfigtesterpi verifi rabbitmq config file ad dynamicrejector take cohort extract rule script file csharp code ad new applic review isidentifi output file fix correct gethashcod implement messagehead class add clean shutdown hook identifiermapp clean worker thread updat travi config java librari instal shell script resolv travi stabil issu adjust batch worker queue repliesack worker thread commit asynchron allow elast batch size qosprefetch set control maximum batch size parallel cap chang batch rabbitmq messagesack identifiermapp avoid content messag publish persist ad ad unit test accessiondirectorylist part dicomdirectoryprocessor test chang make perform counter redisswapp atom threadsafeti clean thread use thread mode rabbitmqadapt use explicit thread rather task queue identifiermapp ad ad randomis retri delay dicomrelationalmapp set minimum wait durat fix fix dle payload state wrong retri batch half complet consum ad lock produc send messag identifiermapp ad ad memori cach last valu use redi wrapper identifierswapp ad parallel marshal backend queri improv throughput identifierswapp ad temporari flag rabbitmqadapt parallel enabl identifiermapp ad new mode dicomdirectoryprocessor allow read list access directori chang pin fodicom v ad ad option dicomfiles properti etl pipelin add templat yaml columnnam dicomfiles allownul true type csharptyp systemint ad new microservic isidentifi scan person identifi inform databas dicom file ad support custom rule isidentifi enter rulesyaml rule appli order appear file rule appli classifi ie allow whitelist rule ad redisswapp cach answer swapper set redishost option yaml use chang updat rdmp dicom plugin refactor java except handl use thread chang rabbitmqadapt improv handl timeout connect startup ad improv log identifierswapp chang guid swapper longer limit input identifi maximum charact fix fix dicomrelationalmapp clean stage tabl remnant previous fail load lead crash fix raw stage migrat list column explicitli previous use select could caus problem raw stage column order somehow differ ad ad setsleeptimem control messag dicomreprocessor chang updat rdmpdicom nuget packag ad improv travi deploy read sminlogconfig build ad better cli argument descript dicomreprocessor ad error log rabbitmq bad ack respons previous basicreturn testidentifiableimageexchang basicreturn exchang testidentifiableimageexchang rout key reprocess replycod no_rout ad new swapper tablelookupwithguidfallbackswapp perform lookup substitut alloc guid lookup miss ad travi ci build deploy servic chang make except startup clearer updat latest rdmp api tablelookupswapp throw consist error provid tabl exist setup previous would error dbm specif error messag lookup time fix fix freez condit exchang map queue identifiermapp load fansi databas implement front startup ad improv unit integr test document fix config file dependabot test dicomfil skiplargetag option close httpsdevazurecomsmiopsmvpservice_workitemsedit chang c depend bump hicdicomtypetransl bump hicrdmpplugin rc bump newtonsoftjson bump rabbitmqcli bump systemioabstract bump mongodbdriv java depend bump jacksondatabind first stabl releas import repositori privat smipluginhttpsgithubcomhicservicessmiplugin repo ad forguididentifierswapp automat creat map databas exist server referenc previous tabl automat creat chang updat rdmpdicom httpsgithubcomhicservicesrdmpdicomblobmasterchangelogmd updat rdmpcore httpsgithubcomhicservicesrdmpblobdevelopchangelogmd remov anonym mappingtablenam must fulli specifi pass valid eg mydbmytbl previous skip databas portion support unreleas httpsgithubcomsmismiservicescomparevmast httpsgithubcomsmismiservicescomparevv httpsgithubcomsmismiservicescomparevv httpsgithubcomsmismiservicescomparevv httpsgithubcomsmismiservicescomparevv httpsgithubcomsmismiservicescomparevv httpsgithubcomsmismiservicescomparevv httpsgithubcomsmismiservicescomparevv httpsgithubcomsmismiservicescomparevv httpsgithubcomsmismiservicescomparevv httpsgithubcomsmismiservicescomparevv httpsgithubcomsmismiservicescomparevv httpsgithubcomsmismiservicescomparevv httpsgithubcomsmismiservicescomparevv httpsgithubcomsmismiservicescomparevv httpsgithubcomsmismiservicescomparevv httpsgithubcomsmismiservicescomparevv httpsgithubcomsmismiservicescomparevv httpsgithubcomsmismiservicescomparevv httpsgithubcomsmismiservicescomparevv httpsgithubcomsmismiservicescomparevv httpsgithubcomsmismiservicescomparevv httpsgithubcomsmismiservicescomparevv httpsgithubcomsmismiservicescomparevv httpsgithubcomsmismiservicescomparevv httpsgithubcomsmismiservicescomparevv httpsgithubcomsmismiservicescomparevv httpsgithubcomsmismiservicescomparevv httpsgithubcomsmismiservicescomparevv httpsgithubcomsmismiservicescomparevv httpsgithubcomsmismiservicescomparevv httpsgithubcomsmismiservicescomparevv httpsgithubcomsmismiservicescomparevv httpsgithubcomsmismiservicescomparevv httpsgithubcomsmismiservicescomparevv httpsgithubcomsmismiservicescomparevv httpsgithubcomsmismiservicescomparevv httpsgithubcomsmismiservicescomparevv httpsgithubcomsmismiservicescomparevv httpsgithubcomsmismiservicescomparevv httpsgithubcomsmismiservicescomparev httpsgithubcomsmismiservicescompar httpsgithubcomsmismiservicescompar httpsgithubcomsmismiservicesreleasestag isidentifi srcmicroservicesmicroservicesisidentifiablereadmemd socketrul srcmicroservicesmicroservicesisidentifiablereadmemdsocketrul img srchttpsavatarsgithubusercontentcomu contributor smi servic epcchttpsgithubcomepc andrew brookshttpsgithubcomhowff alli humehttpsgithubcomallyhum ruairidh macleodhttpsgithubcomrkm bianca prodanhttpsgithubcombpro former paul grahamhttpsgithubcompjgraham hichttpsgithubcomhicservic dougla hardyhttpsgithubcomdhardyh thoma nindhttpsgithubcomtznind leandro trammahttpsgithubcomtallmari jame sutherlandhttpsgithubcomja former trevor carpenterhttpsgithubcomtrevorcarpent httpsgithubcommaabdelatif independ packag use risk assess common packag nuget viru scan nuget site packag wide use activ maintain open sourc packag sourc code licens purpos commandlinepars githubhttpsgithubcomcommandlineparsercommandlin mithttpsopensourceorglicensesmit command line argument pars csvhelper githubhttpsgithubcomjoshclosecsvhelp mspl apach httpsgithubcomjoshclosecsvhelperblobmasterlicensetxt write report csv report equ githubhttpsgithubcomthedmiequ httpswwwnugetorgpackagesequ mithttpsopensourceorglicensesmit automat equal function fodicomnetcor githubhttpsgithubcomfodicomfodicom msplhttpsopensourceorglicensesmspl hicdicomtypetransl githubhttpsgithubcomhicservicesdicomtypetransl gpl httpswwwgnuorglicensesgplhtml translat dicom type c databas type hicfansisql githubhttpsgithubcomhicservicesfansisql gpl httpswwwgnuorglicensesgplhtml databas abstract layer hicrdmpdicom githubhttpsgithubcomhicservicesrdmpdicom gpl httpswwwgnuorglicensesgplhtml rdmp plugin contain data load pipelin compon imag read dicom file etc hicrdmpplugin githubhttpsgithubcomhicservicesrdmp gpl httpswwwgnuorglicensesgplhtml interact rdmp object base class plugin compon etc jetbrainsannot mithttpsopensourceorglicensesmit static analysi tool magicknetqanycpu githubhttpsgithubcomdlemstramagicknet apach licens vhttpsgithubcomdlemstramagicknetblobmasterlicensetxt net librari imagemagickhttpsimagemagickorgindexphp microsoftcodeanalysiscsharpscript githubhttpsgithubcomdotnetroslyn mithttpsopensourceorglicensesmit support dynam rule cohort extract logic microsoftextensionscachingmemori githubhttpsgithubcomdotnetextens apach httpswwwnugetorgpackagesmicrosoftextensionscachingmemorylicens cach id map retriev redismysql nlog githubhttpsgithubcomnlognlog bsd clausehttpsgithubcomnlognlogblobdevlicensetxt flexibl user configur log newtonsoftjson githubhttpsgithubcomjamesnknewtonsoftjson mithttpsopensourceorglicensesmit serial object sharingtransmiss rabbitmqcli githubhttpsgithubcomrabbitmqrabbitmqdotnetcli apach licens v mpl httpsgithubcomrabbitmqrabbitmqdotnetclientblobmasterlicens handl messag microservic securitycodescanv githubhttpssecuritycodescangithubio lgpl httpsopensourceorglicenseslgplhtml scan code secur issu build stackexchangeredi githubhttpsgithubcomstackexchangestackexchangeredi mithttpsopensourceorglicensesmit requir redisswapp stanfordnlpcorenlp github pageshttpssergeytihongithubiostanfordnlpnet gnu vhttpsgithubcomsergeytihonstanfordnlpnetblobmasterlicensetxt name organis detect text systemdrawingcommon githubhttpsgithubcomdotnetcorefx mithttpsopensourceorglicensesmit support read pixel data systemioabstract githubhttpsgithubcomsystemioabstractionssystemioabstract mithttpsopensourceorglicensesmit make file system inject test systemiofilesystem githubhttpsgithubcomdotnetcorefx mithttpsopensourceorglicensesmit file io terminalgui githubhttpsgithubcommigueldeicazagu mithttpsopensourceorglicensesmit consol gui librari tesseract githubhttpsgithubcomcharleswtesseract apach licens vhttpsgithubcomcharleswtesseractblobmasterlicensetxt optic charact recognit dicom pixel data yamldotnet githubhttpsgithubcomaaubryyamldotnet mithttpsopensourceorglicensesmit load configur file fodicomdraw githubhttpsgithubcomfodicomfodicom msplhttpsopensourceorglicensesmspl support librari read dicom pixel data coverallsio githubhttpsgithubcomcoverallsnetcoverallsnet gnuhttpsgithubcomcoverallsnetcoverallsnetlicens upload dot net coverag report coverallsio opencov githubhttpsgithubcomopencoveropencov mit compatiblehttpsgithubcomopencoveropencoverblobmasterlicens calcul code coverag test ci statu coverag statushttpscoverallsioreposgithubsmismiservicesbadgesvghttpscoverallsiogithubsmismiservic githubhttpsimgshieldsiogithublicensesmismiservic total alertshttpsimgshieldsiolgtmalertsgsmismiservicessvglogolgtmlogowidthhttpslgtmcomprojectsgsmismiservicesalert os ci pipelin window build statushttpsdevazurecomsmiopspublic_apisbuildstatussmiserviceswindowsbranchnamemasterhttpsdevazurecomsmiopspublic_buildlatestdefinitionidbranchnamemast linux build statushttpsdevazurecomsmiopspublic_apisbuildstatussmiserviceslinuxbranchnamemasterhttpsdevazurecomsmiopspublic_buildlatestdefinitionidbranchnamemast version smi servic content introductionintroduct overviewoverview glossari terminologyglossaryorterminolog background contextbackgroundandcontext goal technic requirementsgoalsandtechnicalrequir scopeoutofscop assumptionsassumpt solutionssolut deliver solut designdeliverablesolutiondesign test plantestplan monitor alert planmonitoringandalertingplan releas rollout deploy planreleaserolloutanddeploymentplan rollback planrollbackplan associ documentationassociateddocument considerationsfurtherconsider human resourc requirementshumanresourcerequir secur considerationssecurityconsider legal ethic considerationslegalandethicalconsider access considerationsaccessibilityconsider support considerationssupportconsider futur workfuturework residu work estim timelinesresidualworkestimatesandtimelin open questionsopenquest end matterendmatt relat workrelatedwork acknowledgmentsacknowledg microservicesmicroservic data load microservicesdataloadmicroservic imag extract microservicesimageextractionmicroservic sln overivewslnoverview buildingbuild runningrun dependenciesdepend scalabilityscal introduct overview smi servic suit tool design deliv scalabl dicom imag index cohort build extract anonymis sub set eg research extract transform load tool etl imag data loaddiagramdocsimagessmiflowsvg problem address enabl link dicom metadata clinic data eg electron health record ehr context develop load anonymis metadata year scottish nation clinic imag data petabyt follow process solv suit robust parallel load dicom metadata relat databas link ehr data anonymis dicom metadata within relat databas cohort build link relat databas tabl ehr data eg biochemistri result prescript etc produc anonym dicom imag file subset repositori stakehold like interact suit includ research coordin build research extract data analyst load data verifi anonymis etc glossari terminolog rdmp term see rdmp glossaryhttpsgithubcomhicservicesrdmpblobdevelopdocumentationcodetutorialsglossarymd dicom specif term see dicom tag browserhttpsdicominnoliticscomciod dicom specif dicom tag keyvalu pair assist understand proven dicom imag contain inform patientid patientag studydescript etc dicom specif describ tag requir option tag specif datatyp date text float etc specif support tree structur tag call sequenc sequenc contain subtag also sequenc result tree data structur tag also support multipl element ie array datatyp call multipl background context histor dicom imag held clinic pac imag informat platform xnat smiservic function standalon side side tool uniqu featur smiservic abil present larg imag dataset index flat tabl relat databas mysql sql server postgr oracl link cohortsehr dataset worthi addit sinc allow cohort build extract use exist tool data analyst familiar r sql script rdmp cohort builderhttpsgithubcomhicservicesrdmp etc goal technic requir goal load dicom metadata build cohort extract anonym imag subset requir dotnet rabbitmq rdmp mongodb relat databas info set smiservic see deploymentdeploy smiservic benefit run cluster mani vm run mani copi servic parallel file system eg beegfshttpsenwikipediaorgwikibeegf lustrehttpswwwlustreorg scope smiservic support imag workflow eg run imag algorithm also api extern commun eg dicom queri retriev fhirhl etc imag metadata produc smiservic queri use mongodb queri sql imag metadata relat databas cohort creat use standard cohort build tool eg rdmp cohort builder r sql specif cohort build cover document cover elsewher document tool assumpt smiservic assum databas server optimis properli resourc store volum imag metadata anticip etl robust deal outag databas stabil issu eg lock collis errod system perform solut design larg imag collect ie billion imag support flexibl schema definit tag requir cohort build imag file path load therefor success usag tool requir basic understand dicom tag signific appropri larg bodi imag justifi use solut deliver solut design microservic design compon self contain singl respons decoupl process allow easier mainten testabl number copi servic run time allow scalabl parallel process commun servic rabbitmq rabbitmq one popular open sourc messag broker support highscal highavail requir data promot sequenti place file system databas etc promot carri one servic type chain exampl promot dicom tag data mongodb document store involv processdirectori dicomtagread mongodbpopul servic sinc tag data promot excess storag overhead associ data exist multipl place within system duplic place support specif user process see technolog chosen base suitabl process loaddiagramdocsimagesprocessessvg user process descript applic etl schedul user use command line tool pick specif directori imag load mongodb processdirectori data explor user explor full dicom metadata identifi anonymis requir use tag cohort build trigger promot subset imag relat databas eg modal ct mongo command line mongodb compass etc dicomreprocessor anonymis verif user review report effect mongodbrel databas anonymis pipelin creat new anonymisationredact rule system fail correctli redact tag data isidentifiablereview cohort build user view link ehr data relat databas data produc extract imag subset archiv fit specif research project eg ct head scan patient prescript drug x r sql rdmp extractimag mongodb chosen data explor process document store mean abl store full tree structur dicom metadata mongodb improv access speed metadata tag allow aggreg search activ mongodb design scale well support shard replic number dicom file held grow beyond singl db instanc capabl slowest part etl read dicom file disk even parallel file system use mongodb allow done per imag regardless subsequ process downstream pixel data tag load mongodb sinc would inflat storag process requir less use task data explor relat databas chosen anonym tag store sinc format commonli use ehr dataset cohort build tool abil directli link anonym dicom metadata research studi list ehr dataset held relat databas core design requir smiservic data load servic wrap rdmp data load engin support mysql sql server oracl postgr addit allow tailor corruptdupl data load use rdmp load also allow tailor load process deploy expand upon cohort build tabl schema time new tag identifi use cohort build implicit dicom specif hierarch layout tag patient studi seri imag dicom imag file contain complet tag list studyseri mean tag data replic file imag level tag uniqiu use rdmp imag plugin rdmp dicom allow automat aggreg patientstudyseri level tag result far smaller tabl cohort build improv queri perform need queri imag level tag exact tag requir cohort build process vari time may known outset reason etl microservic support schema long tabl column name match known dicom tag assist schema build standalon applic dicom templat builder creat order protect patient privaci tag data relat databas anonym support sever servic design choic cohort build schema creat contain tag low volum identifi data eg studydescript patientnam identifi data detect use isidentifi tool identifi data summaris redact use isidentifiablereview tool patientid substitut anonym identifi etl servic identifiermapp user process ensur step undertaken correctli call anonymis verif error recoveri handl rabbitmq servic fail acknowledg success process messag automat requeu sent differ servic messag process sever attempt sent dead letter queue evalu later servic subscrib control queue allow safe shutdown servic eg system mainten error prone section etl entri relat databas primari key collis corrupt data must reconcil eg imag studi contain conflict definit studydescript rdmp dicom contain sever modul design mitig issu inform found rdmp dicom data load documentationhttpsgithubcomhicservicesrdmpdicomblobdevelopdocumentationdataloadmd use microservic ensur scalabl error recoveri also provid degre futur proof requir emerg new step etl handl rdmp new microservic slot load chain addit step need given deploy cut eg remov identifiermapp step etl edit smiservic configur file configur servic come three place command argument given servic startup yaml configur filedatamicroserviceconfigsdefaultyaml rdmp test plan smiservic rdmp contain autom unit integr test test automat run code commit repositori new featur written pull request independ test approv pull request develop work project branch extern collabor fork user test servic done use docker imagehttpsgithubcomjassmideploy tool badmedicinedicom creat gener synthet test dicom imag badmedicinedicom use gener imag test servic includ support gener placehold pixel data file size model help non function test hardwar architect smiservic deploy cohort build test gener synthet ehr data sibl tool badmedicin use seed badmedicinedicom relat databas tabl csv file synthet medic gener eg biochemistri prescrib demographi code coverag metric collect host coverallshttpscoverallsiogithubsmismiservic show proport line code codebas cover autom test also allow visualis part codebas less coverag ensur complex area suit untest autom alert gener pull request substanti lower code coverag add lot code without test static analysi codebas perform lgtmhttpslgtmcomprojectsgsmismiservicesalert identifi common code error miss null check autom alert gener pull request error detect manual test debug integrationunit test requir relev tool depend instal test decor attribut indic dependenciesif requir includ requiresrelationaldb microsoft sql server mysql requiresmongodb mongodb requiresrabbit rabbitmq server test respect attribut run servic exist testdevelop environ connect stringsport servic found testdatabasestxt relat databas defaultyaml rabbitmq mongodb mongoyaml rabbityaml relationaldatabasesyaml set rdmp platform databas see httpsgithubcomhicservicesrdmpblobmasterdocumentationcodetutorialstestsmd monitor alert plan smiservic rdmp use nlog log number addit system incorpor smiservic loggingaudit health run servic monitor use rabbitmq admin consol messag sent servic guid associ record load relat databas includ guid servic act tag data etl see log imessageheadersrccommonsmicommonreadmemdloggingthroughtheimessagehead anonymis effect verifi use isidentifi visualis use isidentifiablereview etl activ audit hierarch rdmp log databas includ run durat record count error messag load etc releas rollout deploy plan latest binari download github releas pagehttpsgithubcomsmismiservicesreleaseslatest releas changelog describ chang made codebas addit bugfix etc changelog entri includ link git diff show code chang technic descript chang data load microservic wrap rdmp dle therefor import ensur rdmp guicli client platform databas maintain compat version binari ship smiservic rdmp updat backward compat nativ support run old client new version platform databas depend manag dependabothttpsgithubblogkeepallyourpackagesuptodatewithdependabot automat gener pull request updat avail rdmp dicom compat issu surfac autom integr test pull request easiest way consum smiservic docker imagehttpsgithubcomjassmideploy adaptablescal setup use exist infrastructur databas etc need instal rabbitmq instal mongodb instal relat databas mysql sqlserver postgr oracl instal rdmphttpsgithubcomhicservicesrdmp setup platform databas sql server servic place import queue definitionsdatarabbitmqconfig rabbitmq via admin web interfac command line make chang vhost etc desir download softwar asset latest smiservic releasehttpsgithubcomsmismiservicesreleas unzip appropri servic eg smiservicesvlinuxxtgz configur defaultyaml updat credenti match rabbitmq mongodb instanc ignor rdmp redi etc remov test prefix queue name rollback plan smiservic releas backward compat releas self contain execut packag roll back earlier version softwar involv delet new binari restor old one break chang smiservic expect major version number increment consist semant versioninghttpssemverorg case changelog describ chang rollback associ document smiservic depend contain document follow link packag name help packag statu hictypeguesserhttpsgithubcomhicservicestypeguess build test packagehttpsgithubcomhicservicestypeguesseractionsworkflowsdotnetymlbadgesvghttpsgithubcomhicservicestypeguesseractionsworkflowsdotnetyml coverag statushttpscoverallsioreposgithubhicservicestypeguesserbadgesvgbranchmasterhttpscoverallsiogithubhicservicestypeguesserbranchmast total alertshttpsimgshieldsiolgtmalertsghicservicestypeguessersvglogolgtmlogowidthhttpslgtmcomprojectsghicservicestypeguesseralert nuget badgehttpsbuildstatsinfonugethictypeguesserhttpsbuildstatsinfonugethictypeguess fansisqlhttpsgithubcomhicservicesfansisql net corehttpsgithubcomhicservicesfansisqlactionsworkflowsdotnetcoreymlbadgesvghttpsgithubcomhicservicesfansisqlactionsworkflowsdotnetcoreyml total alertshttpsimgshieldsiolgtmalertsghicservicesfansisqlsvglogolgtmlogowidthhttpslgtmcomprojectsghicservicesfansisqlalert nuget badgehttpsbuildstatsinfonugethicfansisqlhttpswwwnugetorgpackageshicfansisql dicomtypetranslationhttpsgithubcomhicservicesdicomtypetransl net corehttpsgithubcomhicservicesdicomtypetranslationactionsworkflowsdotnetcoreymlbadgesvghttpsgithubcomhicservicesdicomtypetranslationactionsworkflowsdotnetcoreyml total alertshttpsimgshieldsiolgtmalertsghicservicesdicomtypetranslationsvglogolgtmlogowidthhttpslgtmcomprojectsghicservicesdicomtypetranslationalert nuget badgehttpsbuildstatsinfonugethicdicomtypetranslationhttpsbuildstatsinfonugethicdicomtypetransl rdmphttpsgithubcomhicservicesrdmp build statushttpsgithubcomhicservicesrdmpworkflowsbuildbadgesvghttpsgithubcomhicservicesrdmpactionsqueryworkflowabuild coverag statushttpscoverallsioreposgithubhicservicesrdmpbadgesvgbranchdevelophttpscoverallsiogithubhicservicesrdmpbranchdevelop total alertshttpsimgshieldsiolgtmalertsghicservicesrdmpsvglogolgtmlogowidthhttpslgtmcomprojectsghicservicesrdmpalert nuget badgehttpsbuildstatsinfonugethicrdmppluginhttpsbuildstatsinfonugethicrdmpplugin rdmpdicomhttpsgithubcomhicservicesrdmpdicom build statushttpsgithubcomhicservicesrdmpdicomactionsworkflowsdotnetcoreymlbadgesvghttpsgithubcomhicservicesrdmpdicomactionsworkflowsdotnetcoreyml total alertshttpsimgshieldsiolgtmalertsghicservicesrdmpdicomsvglogolgtmlogowidthhttpslgtmcomprojectsghicservicesrdmpdicomalert nuget badgehttpsbuildstatsinfonugethicrdmpdicomhttpsbuildstatsinfonugethicrdmpdicom dicom templat builder build statushttpstravisciorghicservicesdicomtemplatebuildersvgbranchmasterhttpstravisciorghicservicesdicomtemplatebuild total alertshttpsimgshieldsiolgtmalertsghicservicesdicomtemplatebuildersvglogolgtmlogowidthhttpslgtmcomprojectsghicservicesdicomtemplatebuilderalert consider human resourc requir set smiservic deploy larg volum imag data requir number staff skill follow area parallel file system setup optimis databas administr mongodb chosen relat databas deploy configur skill yamlhttpsyamlorg infrastructur manag set vm server instanc etc run smiservic design use staff background cohort build data analysi familiar sql benefici requir analyst sql abstract librari method gui applic eg rdmp cohort builder task load identifi data disk understand mongodb requir knowledg mongodb queri languag appropri govern train work identifi data eg nh contract secur consider smiservic design run secur offlin environ network firewal prevent interact vm server outsid world web frontend manag consol design extern access user interact tool suit done secur vpn via ssh secur remot desktop graphic applic smiservic reli secur environ deploy databas access permiss file permiss configur appropri user oper system possibl connect string credenti use integr secur ie user account credenti usernamepassword smiservic also support suppli password environ variabl accept solut suppli password configur file directli file protect non root user ie appropri file access permiss legal ethic consider smiservic user must appropri govern permiss access data user handl etl anonymis process must approv view identifi inform cohort build take place anonymis relat databas therefor may requir lower level govern approv access consider smiservic command line tool written dotnet work window linux termin bash powershel etc access termin typic good inbuilt compat addon control text size convert text speech etc command run rdmp window gui client also run directli command linehttpsgithubcomhicservicesrdmpblobdevelopdocumentationcodetutorialsrdmpcommandlinemd allow script altern access rout rdmp also featur termin user interfac tui mirror design gui client rdmp termin user interfacedocsimagesrdmptuipng isidentifiablereview rdmp tui support specifi altern colour scheme text contrast color use access issu user support consider support user smiservic via github issueshttpsgithubcomsmismiservicesissu ticket also rais rdmp issu seem relat specif microservic compon suit futur work residu work estim timelin smiservic featur complet load link cohort build extract anonym imag futur work focu improv better pixel anonymis support natur languag process nlp structur report cohort build project specif uid anonymis featur directli implement smiservic repositori may consum extern pluggabl resourc eg rdmp cohort builder plugin open question outstand question featur debat seen github issueshttpsgithubcomsmismiservicesissu github discussionshttpsgithubcomsmismiservicesdiscuss page smiservic repositori end matter relat work mani imag process tool relat databas backend support export interchang format csv xl queri api mean tool xnat orthanchttpswwworthancservercom pac server alreadi part cohort build process howev slow cumbersom especi larg linkag oper involv multipl dataset exampl answer question mani patient head ct within month prescrib drug x subsequ hospitalis within month ct studyd answer question use dicom qr queri backend schema would complex slow larg cohort would also like involv multipl step eg run cfind queri retriev studi date load ehr relat databas smiservic improv upon approach load imag archiv singl anonym index tabl per modal aggreg tabl contain studi seri level inform format fastest queryabl represent larg scale linkag extract acknowledg contributor smiservic repositori seen github contributor pagehttpsgithubcomsmismiservicesgraphscontributor contributor upstream dependenciespackagesmd seen correspond section repositori work fund pictur programm year programm work fund medic research council mrc addit support engin physic scienc research council epsrc part health data research uk hdr uk author acknowledg support farr institut health informat research dunde univers medic school work support medic research council mrc grant mrm pi andrew morri wellcom trust grant wt scottish health informat programm ship pi andrew morri ship collabor univers aberdeen dunde edinburgh glasgow st andrew inform servic divis nh scotland project also support mrc epsrc grant mr chief scientist offic scottish govern health social care director via leverag grant made farr scotland project also support scottish govern imag ai grant award work support health data research uk receiv fund hdr uk ltd hdr fund uk mrc engin physic scienc research council econom social research council depart health social care england chief scientist offic scottish govern health social care director health social care research develop divis welsh govern public health agenc northern ireland british heart foundat bhf wellcom trust microservic microservic follow design patternsrccommonsmicommonreadmemd follow microservic written microservic loos coupl usual read write singl kind messag queue exchang implement support one type smicommonmessagesimessag microservic configur configur filedatamicroserviceconfigsdefaultyaml control queue provid control microservic runtim support limit number commandsdocscontrolqueuesmd data load microservic loaddiagramdocsimagesloadmicroservicespng microservic consol app descript processdirectori command line applic find dicom file disk queue execut rabbitmqsrccommonsmicommonmessagesaccessiondirectorymessagec dicomtagread open queu dicom file disk convert jsonsrccommonsmicommonmessagesdicomfilemessagec also creat summari record whole seriessrccommonsmicommonmessagesseriesmessagec identifiermapp option replac patientid dicom tag dicomfilemessag use specifi map tabl mongodbpopul persist dicom tag data dicomfilemessag andor seriesmessag mongodb databas document store dicomrelationalmapp persist dicom tag data file path dicomfilemessag relat databasehttpsgithubcomhicservicesrdmpblobdevelopdocumentationcodetutorialsfaqmddatabas etl pipelin control rdmp data load configur dicomreprocessor run mongodb queri databas popul mongodbpopul convert result back dicomfilemessag reload dicomrelationalmapp imag extract microservic extractiondiagramdocsimagesextractionmicroservicespng microservic consol app descript isidentifi evalu data prepar extract person identifi data pii see also isidentifiablereview extractimag read uid csv file gener extractionrequestmessag audit messag extractionrequestinfomessag cohortextractor look seriesinstanceuid extractionrequestmessag relat databas lookup resolv physic imag file locat gener extractfilemessag audit messag extractfilecollectioninfomessag ctpanonymis microservic wrapper ctphttpsgithubcomjohnperryctp anonymis imag specifi extractfilemessag copi specifi output directori gener audit messag extractedfilestatusmessag cohortpackag record audit messag determin job complet audit log system audit system descript nloghttpnlogprojectorg microservic log activ nlog manifest log fileconsoleserv etc configur appconfig file messag auditsrccommonsmicommonreadmemdlog everi messag sent microservic uniqu guid associ messag issu respons input messag first messag chain list legaci messag guid maintain list output part nlog log data load auditsrcmicroservicesmicroservicesdicomrelationalmapperreadmemdauditth final messag guid everi file identifi load record relat databas imag tabl addit valid data load id field record updat take place eg due reprocess file result persist record creat shadow archiv tabl extract audit mongodbsrcmicroservicesmicroservicescohortpackagerreadmemd cohortpackag respons audit extract info messag extract servic record imag request imag anonymis complet current implement iextractjobstor cohortextractor audit obsolet interfac iauditextract previous exist record linkag result patient releas identifi fatal error log microservic crash log fatal error shut log messag fatal error log exchang todo nobodi listen current quarantin todo doesnt exist yet sln overview apart microservic document follow librari class also includ solut project name path descript dicom file tester applic applic test dicom file compat dicomjson dicom variou databas type convers back basic take file push variou convert see break dicom repopul applic see microservicesimageextractionmicroservic dicom templat builder applic gui tool build modal databas schema templat support view explor dicom tag file smimongodbcommon reusabl librari contain method interact mongodb build build c project build requir net core sdkhttpsdotnetmicrosoftcomdownloaddotnetcor compat version specifi globaljsonglobaljson file build entir solut project root run bash dotnet build r rid _the rid argument option use want build differ platform eg r linuxx build linux window machin see herehttpsdocsmicrosoftcomenusdotnetcoreridcatalog info runtim identifiers_ build individu subproject bash cd srcmicroservicesmicroservicesdicomtagread dotnet build automat rebuild depend project chang well build java project build java project requir java jdk openjdk recommend maven ctp depend first need manual instal linux bash cd libjava installdatsh window bash cd libjava installdatbat project built test return top level directori run bash mvn f srccommoncomsmimicroservicesparentpomxml clean test compil run test project full test suit requir local rabbitmq server howev skip pass punittest entir test suit skip instead run compil pass dskiptest build singl project depend bash mvn f srccommoncomsmimicroservicesparentpomxml test pl comsmimicroservicesctpanonymis note maven pass ntp command order hide larg volum messag relat download depend run applic servic runnabl smi program avail either binari distribut srcapplicationsapplicationssmirunnerbin directori develop local see smirunn readmesrcapplicationsapplicationssmirunnerreadmemd inform develop c project develop requir visual studio later simpli open smiservicessln file run test isidentifi stanford ner classifi requir download includ script bash cd datastanfordn downloadsh java project develop requir java jdk maven precommit repo use precommit manag automat run seri linter code formatt clone repo chang directori run setup precommit consol pip instal precommit precommit instal run check everi commit also run manual time consol precommit run hook allfil file file list run precommit local option sinc also run pr remov precommit repo clone simpli run consol precommit uninstal note version c project share releas version control sharedassemblyinfocssrcsharedassemblyinfoc file java project version independ set pom file howev practic follow releas version repo overal scalabl servic repositori success use load medic imag data captur scotland nation pac archiv scalabl handl parallel process execut use rabbitmq allow slow process eg read dicom tag file disk run instanc faster process less scalabl larg oper eg linkag cohort identif done within dbm layer rabbitmq httpswwwrabbitmqcom dbm httpsgithubcomhicservicesrdmpblobdevelopdocumentationcodetutorialsglossarymddbm dicom glossarymddicom dicom tag glossarymddicomtag isidentifi srcmicroservicesmicroservicesisidentifiablereadmemd isidentifiablereview srcapplicationsapplicationsisidentifiablereviewerreadmemd dicomfilemessag srccommonsmicommonmessagesdicomfilemessagec seriesmessag srccommonsmicommonmessagesseriesmessagec extractionrequestmessag srccommonsmicommonmessagesextractionextractionrequestmessagec extractionrequestinfomessag srccommonsmicommonmessagesextractionextractionrequestinfomessagec extractfilemessag srccommonsmicommonmessagesextractionextractfilemessagec extractfilecollectioninfomessag srccommonsmicommonmessagesextractionextractfilecollectioninfomessagec extractedfilestatusmessag srccommonsmicommonmessagesextractionextractedfilestatusmessagec rdmp httpsgithubcomhicservicesrdmp processdirectori srcapplicationsapplicationsdicomdirectoryprocessorreadmemd dicomtagread srcmicroservicesmicroservicesdicomtagreaderreadmemd identifiermapp srcmicroservicesmicroservicesidentifiermapperreadmemd mongodbpopul srcmicroservicesmicroservicesmongodbpopulatorreadmemd dicomrelationalmapp srcmicroservicesmicroservicesdicomrelationalmapperreadmemd dicomreprocessor srcmicroservicesmicroservicesdicomreprocessorreadmemd extractimag srcapplicationsapplicationsextractimagesreadmemd cohortextractor srcmicroservicesmicroservicescohortextractorreadmemd ctpanonymis srcmicroservicescomsmimicroservicesctpanonymiserreadmemd cohortpackag srcmicroservicesmicroservicescohortpackagerreadmemd precommit httpsprecommitcom extractimag srcapplicationsapplicationsextractimagesreadmemd dicom specif httpswwwdicomstandardorg rdmp dicom httpsgithubcomhicservicesrdmpdicom dicom templat builder httpsgithubcomhicservicesdicomtemplatebuild badmedicinedicom httpsgithubcomhicservicesbadmedicinedicom badmedicin httpsgithubcomhicservicesbadmedicin nlog httpsnlogprojectorg changelog changelogmd xnat httpswwwxnatorg smi servic contribut guidelin todo glossari dicom dicom digit imag commun medicin intern standard format store medic imag standard dicom file contain pixel data imag tag data dicom tag imag store dicom format includ metadata inform tag tag includ inform patient well inform devic use scan set modal etc tag requir file consid valid other option format includ support tree data structur sequenc array multipl tag either part standard sethttpsdicominnoliticscomciod invent devic manufactur privat tag adher standard vari wide manufactur healthboard time load dicom imag larg space taken pixel data sinc tag data use gener cohort load load context smi repositori mean extract dicom tag data persist along rel file path imag databas load may also includ typic data load oper eg summar error detect anonymis etc dicom dicom tag data dicomtag test smi microservic use rabbitmq mongodb sql server mysql test run automat travi cihttpstravisciorgsmismiservic see travisymltravisyml connect string set depend need set connect string follow file commit repositori testdatabasestxttestscommonsmicommonteststestdatabasestxt relationaldatabasesyamltestscommonsmicommontestsrelationaldatabasesyaml mongoyamltestscommonsmicommontestsmongoyaml rabbityamltestscommonsmicommontestsrabbityaml test involv rdmphttpsgithubcomhicservicesrdmp requir rdmp databas set uphttpsgithubcomhicservicesrdmpblobdevelopdocumentationcodetutorialstestsmddatabasetest sql server exampl run linux travi follow command use latest version url wget httpsgithubcomhicservicesrdmpreleasesdownloadvrdmpclilinuxxzip unzip rdmpcli rdmpclilinuxxzip true ignor exit code sinc unzip return warn dont care cd rdmpcli chmod x rdmp rdmp instal localhost test_ u sa p yourstrongpasswrd add basi new dicomanonymis microservic use place exist java ctp servic support pluggabl anonymis idicomanonymis interfac implement provid pr treat build warn error fix disabl exist one also remov unus systemsecurityaccesscontrol packag allow newer minor sdk version build sln globaljson specifi minimum version use ci fix jobid creat extract complet fix deprec python collect import py updat ci script pull tessdata file new branch name main master ensur control exchang exist extractimageshosttest news file directori contain file describ chang sinc previou releas smiservic releas built file automat combin main changelogchangelogmd delet file name news file name form txt prtypemd eg txt featuremd type one featur chang bugfix doc remov meta note ensur file name _pr_ number rather associ _issue_ number quick tip get recent issu pr number follow onelin add one determin new one pr long your quick consol curl httpsapigithubcomrepossmismiservicesissuessortcreateddirectiondescper_pagepag jq number file contain short descript patch one line markdown either toplevel sentenc md fix foobar detail requir multipl line format sublist md fix foobar requir user chang xyz fix error file extract command rerun cancel fix current ci issu restrict creation controlexchang requiresrabbit test decor remov refer systemdrawingcommon fix issu erron strip root path empti string globalopt ensur python version use ci run exactli specifi alway convert phi xml regardless annotation_mod set add miss refer nlog smi python librari use function python requir deepmerg pika pydicom pymongo pyyaml xmletre come python instal run python setuppi bdist_wheel creat smi_services_pythonpynoneanywhl run python setuppi instal instal includ depend python sitepackag whether global insid current virtualenv note version number read assemblyinfoc parent directori test test modul pytest smiservicespi test modul individu exampl python pytest smiservicedicompi python pytest smiservicedicomtextpi python pytest smiservicestructuredreportpi usag exampl smi_root osenviron smi_rootlibpython syspathappendospathjoinosenvironsmi_root lib python smiservic import mongo smiservic import rabbit smiservic import dicom smiservic import dicomtext smiservic import structuredreport sr dicompi mostli lowlevel function read dicom file use dicomtext modul dicomtextpi provid dicomtext class assist pars dicom structur report also function redact text given set annot use pydicom librari intern typic usag dicomtext dicomdicomtextdcmnam read raw dicom file dicomtextpars analys text insid contentsequ xmldictlist knowtatorannotation_xml_to_dictxmletreeelementtreeparsexmlfilenamegetroot dicomtextredactxmldictlist redact pars text use annot dicomtextwriteredacted_dcmnam write redact dicom file write_redacted_text_into_dicom_fil rewrit second file redact text knowtatorpi provid function pars xml file contain annot output semehr anonymis input ehost file typic name knowtatorxml format annot mention idanontxt annot idsemehrsemehrannot span end start spannedtext year oldspannedtext creationdatew novemb creationd annot classment idanontxt mentionclass idsemehr_sensitive_info year oldmentionclass classment function annotation_xml_to_dict pars xml return suitabl python dict also contain function write xml file use test convert phi file mongopi simpl wrapper around pymongo specif smi provid smipymongocollect class typic usag mongodb mongosmipymongocollectionmongo_host mongodbsetimagecollectionsr mongojson mongodbdicomfilepathtojsonpathfil printmongo mongojson rabbitpi python interfac smi rabbitmq messag system provid class smimessag inherit taskspecif class ctp_start_messag isidentifiable_start_messag provid class rabbitproduc rabbitconsum sampl function send_ctp_start_messag get_ctp_output_messag test one known problem use rabbitmq python lack data type particular concept differ bit bit integ pika librari tri effici construct messag use bit integ valu fit c java program written explicitli expect bit integ crash given bit one pika librari current way request bit integ data type determin dynam omit timestamp field messag structuredreportpi provid function sr_pars pars python dict contain dicom structur report return content usabl string dict read dicom file use pydicom obtain mongodb databas repres data similar differ format ie vr tag util function use dicomtext modul pars structur report read dicom file manual extract json dicom_raw pydicomdcmreadfilenam dicom_raw_json dicom_rawto_json_dictnon read json mongodb mongodb mongosmipymongocollectionmongo_host mongodbsetimagecollectionsr mongojson mongodbdicomfilepathtojsonargsinput method use structuredreport modul srsr_parsedicom_raw_json document_nam output_fd srsr_parsemongojson document_nam output_fd method use pydicom walk method def decodefilenam dicom_raw pydicomdcmreadfilenam def dataset_callbackdataset data_el data_elementvr sq fals elif data_elementvr sh cs fals elif data_elementvr lo print strdata_elementvalu els print strdata_elementvalu recurs valu insid contentsequ content_sequence_item dicom_rawcontentsequ content_sequence_itemwalkdataset_callback method use pydicom recurse_tre method def decodefilenam def recurse_treetre dataset parent data_el dataset node_id could use uniqu refer node_id parent hexiddata_el isinstancedata_elementvalu str useless data type sh eg _offi cs eg contain data_elementvr sh cs fals elif data_elementvr lo lo like head print strdata_elementvalu els ut text da date pn name print strdata_elementvalu els nonstr valu useless sequenc handl anyway fals print val node_id strdata_elementvalu data_elementvr sq sequenc dataset enumeratedata_elementvalu item_id node_id stri sq_item_descript data_elementnamereplac sequenc xxx item_text dformatsq_item_descript print seq item_id item_text recurse_treetre dataset item_id dicom_raw pydicomdcmreadfilenam dicom_rawdecod xxx decod utf recurs valu insid contentsequ recurs whole dicom pass dicom_raw second param content_sequence_item dicom_rawcontentsequ recurse_treenon content_sequence_item method use dicomtext modul read origin dicomtext dicomtextdicomtextinput dicomtextpars redact given input_xml file xmlroot xmletreeelementtreeparseargsinput_xmlgetroot xmldictlist knowtatorannotation_xml_to_dictxmlroot dicomtextredactxmldictlist dicomtextwrite_redacted_text_into_dicom_fileargsoutput_dcm first instal moment manual instal dat depend local maven repo build find run installdatbat installdatsh linux tri build first time maven command insid eclips set run configur otherwis smipluginjavamicroservic directori command build project mvn clean packag append dskiptest want build without run test chang skiptest option smipluginjavamicroservicespomxml file true build singl project mvn clean packag pl microservicesextractorcl build extractorcl program well requir microservicescommon project exampl maven flag use plproject arg commadelimit list specifi reactor project build instead project project specifi groupidartifactid rel path alsomak project list specifi also build project requir list run first cd one microservic directori java jar targetportablejar command line option wish suppli microservic packag deploy archiv back smipluginjavamicroservic build project run mvn assemblysinglecreatedeploy creat zip archiv target directori contain resourc jar need deploy microservic anoth machin config java microservic share yaml config file c microservic document found heremicroservicesmicroservicescommonoptionsrabbitmqconfigoptionsmd log note use logback java log file consol logback seem best successor logj see excel resourc learn httpsstackifycomlogginglogback properli set log across microservic use follow method file smilogbackconfigxml copi smipluginjavamicroservicesr output target directori begin main method microservic call smiloggingsetup helper class configur everyth everi class program creat logger object privat static final logger _logger loggerfactorygetloggermyclassclass implement log messag appropri everyth log file info warn error also log consol microservic host content implement hostimplementingahost implement consumerimplementingaconsum logginglog rule microservic clubrulesofmicroserviceclub first rulethefirstrul second rulethesecondrul class diagramclassdiagram implement host first load instanc globalopt programc base class specifi configur option csharp public class program public static int mainstr arg var option new globaloptionsfactoryload next need decid queue want read want write exampl let assum want consum singl queue consum option avail globaopt fatalloggingproduceropt instanc creat base host class csharp public class program public static int mainstr arg var option new globaloptionsfactoryload use defaultyaml file var consumeropt optionsmyhostopt dont realli need work need updat defaultyamldatamicroserviceconfigsdefaultyaml yaml stuff myhostopt also put follow subclass avoid cram mani thing root level queuenam myqueuenam consumertag myqueuetag qosprefetchcount autoack fals option may need stuff brand new host also add relev bit globalopt csharp public class globalopt snip lot code region allopt stuff public myhostopt myhostopt get set endregion new class new option public class myhostopt consumeropt option go consumeropt inherit next creat deriv class microservicehost class take option need job csharp public class myhost microservicehost privat readonli consumeropt _consumeropt public myhostglobalopt option bool loadsmilogconfig true baseopt loadsmilogconfig load option need check need _consumeropt optionsmyhostopt consum new myconsumerconsumeropt see next section implement public overrid void start rabbitmqadapterstartconsumer_consumeropt consum final creat instanc microservicehostbootstrapp class handl construct connect issu constructionstartup microservicehost csharp public class program public static int mainstr arg var option new globaloptionsfactoryload var bootstrapp new microservicehostbootstrapp new cohortpackagerhostopt return bootstrappermain expect result stage run program meaning give sensibl log complain miss exchang rabbitmq server explor chang yaml file creat resolv exchangesqueu get error relat consum null comment rememb proceed next section see implement iconsum implement consum consum class listen rabbitmq queue someth base messag appear creat new class deriv consum abstract class csharp public class myconsum consum add paramet requir public myconsum constructor setup protect overrid void processmessageimplimessagehead header imodel model basicdelivereventarg basicdelivereventarg deseri messag deliveri argument mymessag messag safedeserializetomessagehead delivereventarg messag return work ack nack depend result ifsuccess ackhead delivereventarg els errorandnackhead delivereventarg messag except processmessageimpl method process must either ack errorandnack imessagehead contain proven inform messag dequeu use log see must also suppli produc new messag ensur messag audit chain kept tact log microservic deriv microservicehost class ensur standard log config appli log configur load nlog configur file specifi filesystemoptionslogconfigfil config variabl exist empti string otherwis file sminlogconfig current directori configur detail file base consol base log happen level process ignor etc mean get logger time call csharp var logger nloglogmanagergetcurrentclasslogg mean log level trace debug info etc exactli defin nlog standard httpsgithubcomnlognlogwikiconfigurationfileloglevel trace log level reserv fine grain timingperform code lowest level log oper messag therefor debug trace log disabl unless cli option tracelog provid log imessagehead addit use log method log routin event log messag specif event via imessagehead csharp protect overrid void processmessageimplimessagehead header imodel model basicdelivereventarg basicdelivereventarg var logger logmanagergetcurrentclasslogg headerlogloggerloglevelwarn messag cap call lower log header mean guid messag guid previou messag chain appear log eg class diagramimagesmessageguidlogspng log header recommend whenev audit fact relat specif content messag eg couldnt open file referenc dicomfilemessag log header automat happen send acknowledg messag result view everi messag system sent relationship tree knock messag see imag rule microservic club first rule first rule microservic club loglevelfat mean game log level instead call fatal method csharp protect overrid void processmessageimplimessagehead header imodel model basicdelivereventarg basicdelivereventarg var logger logmanagergetcurrentclasslogg headerlogloggerloglevelwarn messag cap call lower fatalran memori new insufficientmemoryexcept errorandnackheadermodelbasicdelivereventargssometh went wrong new exceptionwhat went wrong ackhead model basicdelivereventarg fatal method consum microservicehost caus current microservic shutdown cleanli log fatalerrormessag rabbitmq fatal messag exchang see fatalloggingproduceropt processmessageimpl throw unhandl except fatal shutdown automat occur second rule second rule microservic club dont nack messag without give reason facilit consumererrorandnack method log error nlog nack messag csharp protect overrid void processmessageimplimessagehead header imodel model basicdelivereventarg basicdelivereventarg errorandnackheadermodelbasicdelivereventargssometh went wrong new exceptionwhat went wrong class diagram class diagramimagesclassdiagrampng fixm probabl obsolet rabbitmq config option configur set store yaml file default set option store defaultyaml file yaml rabbitopt rabbitmqhostnam localhost rabbitmqhostport rabbitmqvirtualhost rabbitmqusernam guest rabbitmqpassword guest rabbitmqcontrolexchangenam controlexchang fatalloggingexchang fatalloggingexchang filesystemopt filesystemroot ctemp extractroot ctemp rdmpoption server localhostsqlexpress cataloguedb rdmp_catalogu exportdb rdmp_dataexport mongodatabas dicomstoreopt hostnam localhost port databasenam dicom seriescollect seri imagecollect imag extractionstoreopt hostnam localhost port databasenam extract dicomrelationalmapperopt guid ffaffcedbc queuenam anonymousimagequeu consumertag dicomrelationalmapp qosprefetchcount autoack fals loadmetadataid databasenamertyp guiddatabasenam cohortextractoropt queuenam requestqueu consumertag cohortextractor qosprefetchcount autoack fals allcatalogu true onlycatalogu list id catalogu extract ascend order ignor allcatalogu true also doabl singl line auditortyp smicohortextractorauditnullauditextract requestfulfillertyp smicohortextractorexecutionrequestfulfillersfromcataloguesextractionrequestfulfil write produc exchang extractfilesproduceropt label extractfil exchangenam extractfileexchang audit extractfilesinfoproduceropt label extractfilesinfo exchangenam filecollectioninfoexchang cohortpackageropt jobwatchertickr extractrequestinfoopt queuenam requestinfoqueu consumertag cohortpackag qosprefetchcount autoack fals extractfilesinfoopt queuenam filecollectioninfoqueu consumertag cohortpackag qosprefetchcount autoack fals anonimagestatusopt queuenam filestatusqueu consumertag cohortpackag qosprefetchcount autoack fals dicomreprocessoropt processingmod imagereprocess queryscriptpath scriptsabcdtxt identimageproduceropt label imag exchangenam identifiableimageexchang tagpromotionproduceropt label tagpromot exchangenam tagpromotionexchang dicomtagreaderopt queuenam accessiondirectoryqueu consumertag tagread qosprefetchcount autoack fals nackifanyfileerror true imageproduceropt label imageproduc exchangenam imageexchang seriesproduceropt label seriesproduc exchangenam seriesexchang identifiermapperopt queuenam identifiableimagequeu consumertag identifiermapp qosprefetchcount autoack fals anonimagesproduceropt label anonimag exchangenam anonymousimageexchang mappingconnectionstr serverlocalhostsqlexpressintegr securitytrueiniti catalogmappingdatabas mappingdatabasetyp microsoftsqlserv mappingtablenam mappingt swapcolumnnam chi replacementcolumnnam echi swappertyp smiidentifiermapperexecutionforguididentifierswapp mongodbpopulatoropt seriesqueueconsumeropt queuenam mongoseriesqueu consumertag mongodbpopul qosprefetchcount autoack fals imagequeueconsumeropt queuenam mongoimagequeu consumertag mongodbpopul qosprefetchcount autoack fals mongodbflushtim failedwritelimit processdirectoryopt accessiondirectoryproduceropt label anonimag exchangenam accessiondirectoryexchang use c simpli use static load method globalopt class receiv strongli type object set default load defaultyaml file load method overload accept filenam string without yaml extens load exist use want overrid set command line argument pass globalopt instanc specif host bootstrapp sequenc csharp privat static int mainstr arg var option new globaloptionsfactoryload parserdefaultparseargumentsarg cli var option new globaloptionsfactoryloadcliyamlfil var bootstrapp new microservicehostbootstrapp new dicomtagreaderhostopt return bootstrappermain java complet develop test product multipl yaml file folder develop work debug better simpli edit defaultyaml match develop environ ci build build script replac defaultyaml content testyaml file import keep sync add remov properti product readi build replac defaultyaml productionyaml content although file also edit deploy use command line argument load file import keep sync mainli relat ad properti avoid except pars edit yaml file yaml syntax refer abund onlin yaml basic sequenc keyvalu pair separ colon indent meaning indent line properti previou outdent line dash indic array element although use squar bracket well see want add one option exist section need creat correspond properti globalopt class everyth strongli type error properti yaml file match class viceversa instead allow creat new microservic put specif set new toplevel element yaml file isidentifi review primari author thomashttpsgithubcomtznind content overviewoverview setup installationsetupinstal usageusag review output isidentifi redact databas manag rulebas overview identifi review cross platform text base ui manag anonymis process pii detect remov serv manag consol rulesbas isidentifi downstream process valid resultsredact databas screenshotimagesrolepng _the review process potenti pii_ activ undertaken use review review output isidentifi redact databas manag rulebas setup instal applic run sub verb smi see smirunn see applic help run smi isidentifiablereview help follow part global yaml config file interact tool yaml section purpos isidentifiableopt filesdirectori find current rulesbas isidentifi process use manag rulebas isidentifiablereviewerglobalopt command line option purpos isidentifiablerevieweropt allow overrid yaml file load runtim argument eg tabl redact report load usag review output isidentifi isidentifi tool appli nlp rule base identifi pii data databas sampl output file includ examplereportexamplereportcsv includ open report use f somefilecsv command line option fileopen report load iter report sequenti use sequenti tab get overview issu encount aggreg frequenc tree view tab screenshotimagesscreenshotpng _sequenti view_ sequenti view oper one failur time show full string top failur highlight green bottom left classif failur person organis date etc bottom right column dicom tag failur found import check column exampl ignor hospit name column institutionnam updat column studydescript next prev button move sequenti failur ie next skip failur match exist rule screenshotoftreeimagestreepng _tree view show pii detect aggreg uniqu fail valu column pii found_ tree view sort failur number occurr tree view show categori rule categori failur also show list conflict rule failur match ignor updat rule instanc potenti pii found isidentifi term failur exist anonymis process fail strip pii failur either fals posit genuin case pii make decis failur whether ignor report reportignor review report mark either ignor fals posit updat pii need redact result new rule ad either newrulesyaml ignor redlistyaml updat rule written appli automat futur report load elimin lead make duplic decis use ignor updat display move onto next failur skip match exist rule conceptu rule slightli differ isidentifi rule isidentifi first use rule spot known pii use nlpner tool attempt find pii final use whitelist rule ignor known fals posit ideal rule finetun reduc work review exampl review show failur due manufactureragfa would wise manual edit isidentifi rule review rule differ use filter isidentifi output either ignor redact failur report syntax rule file look similar use differ effect futur run isidentifi futur review menu option custom pattern menu tick provid opportun edit ignoreupd rule save allow make fine adjust exact pattern redact note bracket pattern redact add remov necessari exampl full string john smith hospitalmri head date detect could still redact hospit name well edit pattern john smith hospitaldddddddd ie ad name bracket custom pattern window provid sever option edit pattern x clear current type pattern f creat regex pattern match full input valu g creat regex pattern match fail part replac digit regex wildcard c replac charact regex wildcard dc replac digit charact regex wildcard redact databas failur report process either ignor report rule gener redact databas done run applic use u flag sinc may sever server databas process use tool necessari indic updat command run done put connect string target file yaml name server connectionstr serverlocalhostusernamerootpasswordzombi databasetyp mysql _exampl target file_ follow flag combin success redact databas flag exampl purpos f f examplereportcsv indic isidentifi output report redact must complet review process report u u missescsv indic want updat databas file valu must includ report cover rule gener review process output complet review process correctli file empti execut complet ztemptargetsyaml path file contain connect string dmb type relat databas server tabl requir redact bash smiex isidentifiablereview f examplereportcsv u missescsv ztemptargetsyaml _exampl redact command_ manag rulebas time number rule isidentifi review increas benefici move ignor rule upstream review isidentifi rulebas especi commonli encount report reduc number fals posit size report file rule manag tab provid visualis control rule use isidentifi tool analys rule review review rule period review rule base ensur mistak identifi candid push upstream analys rulesmanagerscreenshotimagesrulesmanagerpng _rule manag view_ key function delet remov rule rulesbas enter open menu interact rule highlight isidentifi microservicesmicroservicesisidentifiablereadmemd pii httpsenwikipediaorgwikipersonal_data smirunn applicationssmirunn manag rulebas managingtherulebas review process reviewingtheoutputofisidentifi review output isidentifi reviewingtheoutputofisidentifi redact databas redactingthedatabas queue set imag extract base dicom uid file smirunn cli applic serv singl entri point c applic servcic smiservic repo usag run help show list servic link main readm servic consol smi help smi copyright smi project triggerupd see releas version httpsgithubcomsmismiservicestreemastersrcapplicationsapplicationstriggerupd servic run previous pass specif set paramet verb consol smi dicomtagread fooyaml consol smi isidentifi db defaultyaml support new app servic order add new app servic runner first creat csproj normal appropri applic microservic directorynamespac might use first creat consol project main entrypoint etc eas initi test stabl chang librari project specifi outputtypelibraryoutputtyp csproj file add project smirunn process add refer project smirunn csproj add new serviceverbserviceverbsc add new verb programprogramc add one static array allservic allappl add case statement point program entri point sranontool sranontool set program assist anonymis dicom structur report requir python packag requir pydicom pymongo deepmerg python librari requir smiservic python librari see srccommonsmi_common_python extern tool requir smiservic ctp anonymis semehrcogstack anonymis test stub dcmjson test option dcmtk packag jq test option diff test instal script requir depend need found via path pythonpath copi script smi_rootscript instal python librari smiservic smi_rootlibpython virtualenv ensur python packag depend instal systemwid virtualenv host machin modifi defaultyaml file section ctpanonymiseropt add sranontool pathtosranontoolsh ensur defaultyaml file contain necessari filesystemopt loggingoptionslogsroot mongodatabas rabbitopt etc instal semehrcogstack anonymis current use follow directori may symbol link optsemehrcogstack contain script optsemehrdatainput_doc raw text copi anonymis optsemehrdataanonymis output anonym text xml file optgcpbioyodi uml dictionari optgcpgcp java librari old semehr anonymis requir python script requir python includ new semehr anonymis use test stub data directori requir python requir usag part ctp configur ctp call script sranontoolsh detect dicom file sr modal tag edit defaultyaml ctp call script two option inputdcm raw dicom file anonymis outputdcm dicom file ctp alreadi anonymis script extract text inputdcm file anonymis write redact text outputdcm file must alreadi exist standalon usag script sranontoolsh call three compon ctp_dicomtotextpi extract text raw dicom file format suitabl semehrcogstack clinical_doc_wrapperpi compon within semehrcogstack anonymis text ctp_xmltodicompi redact text raw dicom file write redact text output dicom file usag e virtualenv semehr_dir read_fromdcm write_intodcm e option use activ virtual environ sourc binactiv script default set pythonpath smi_rootlibpython semehr directori optsemehr chang option test set call ctp ctp_dicomtotextpi program use part sranontool pipelin use standalon extract document bulk later semehr process usag defaultyaml inputdcm outfil semehruniqu defaultyaml may specifi configur paramet spread across multipl yaml file inputdcm full path input dicom file partial path extract mongodb studyd extract record day mongodb output full path output text file directori multipl file semehruniqu extract studyd mongodb ignor document sopinstanceuid alreadi semehr mongodb databas intend allow reprocess document previous fail without reprocess whole day mongodb configur read yaml file need mongodatabas dicomstoreopt semehrstoreopt former read dicom document dicomimage_sr databasecollect latter check sopinstanceuid alreadi semehrsemehr_result databasecollect exampl ctp_dicomtotextpi pathtofiledcm outputtxt ctp_dicomtotextpi accnumfiledcm outputtxt smi_dataloadyaml ctp_dicomtotextpi output_dir smi_dataloadyaml clinical_doc_wrapperpi script perform anonymis usag semehr_dir input_doc anonymis stub version must call current directori locat script read file datainput_doc directori input file write slightli modifi file name dataanonymis directori basic text header metadata remov plu write file name plu knowtatorxml append contain annot xml format semehr version requir python test stub requir python note script longer use new semehr anonymis test stub program requir current directori best suit test given test dicom file fake anonymis word baker option use specifi semehr directori instead optsemehr use test option present origin anonymiserpi script perform anonymis usag anonymiserpi pathtoanonymisation_taskjson must call current directori locat script templat configur file typic anonymisationconf directori follow element modifi run anonymis text_data_pathsemehr_input_dir anonymisation_outputsemehr_output_dir extracted_phisemehr_output_dirphi grouped_phi_outputsemehr_output_dirphi_group logging_filesemehr_output_dirlog annotation_modefals temporari fals knowtat xml output fix ctp_xmltodicompi usag defaultyaml inputdcm x inputxml outputdcm defaultyaml may specifi configur paramet spread across multipl yaml file inputdcm full path raw dicom file x inputxml full path xml file contain annot outputdcm full path anonymis dicom file must alreadi exist redact text written test test subdirectori run ctp_sranontool_testpi semehr_dir filedcm p pattern_to_redact defaultyaml read reporthtmldcm run script check output match expect print success exit success exit output expect default semehr_dir optsemehr filedcm reporthtmldcm public sampl file manual edit includ html fragment p pattern_to_redact baker suit exampl dicom file defaultyaml datamicroserviceconfigsdefaultyaml triggerupd primari author thoma nindhttpsgithubcomtznind content overviewoverview setup installationsetupinstal exchang queue settingsexchangeandqueueset configconfig expectationsexpect aliasesalias class diagramclassdiagram overview triggerupd app consol app run termin rather microservic run forev app issu updat messag design consumpt updatevalu microservic applic use verb system eg triggerupd mapper triggerupd mongo setup instal clone project build nuget depend automat download edit yamldefault configur environ run triggerupdatesex mapper somed f patientid commandlin issu messag updat live databas chang map exchang queue set readwrit type config set write updatevaluesmessag triggerupdatesopt config yaml section purpos rabbitopt describ locat rabbit server send messag identifiermapperopt describ locat map tabl use mapper verb command triggerupdatesopt exchang name updatevaluesmessag sent detect updat argument vari verb use triggerupd mapper help see requir argument expect error log normal microservicehostcommonsmicommonreadmemdlog alias use map updat possibl certain corner case sequenc result cross map especi alias permit alias chang time initi lookup tabl privat releas b _ani live databas valu b releas identifi _ updat lookup tabl fact ab privat releas b _trigger updat point merg live database_ alia establish lookup success updat revers alia eg revert back initi state class diagram class diagramimagesclassdiagrampng updatevalu microservic microservicesupdatingmicroservicesupdatevaluesreadmemd processdirectori primari author alli humehttpsgithubcomallyhum content overviewoverview setup installationsetupinstal exchang queue settingsexchangeandqueueset configconfig expectationsexpect class diagramclassdiagram directori scan modesdirectoryscanmod overview processdirectori app consol app run termin rather microservic run forev app search specifi directori find directori contain dicom file directori found contain least dicom file result accessiondirectorymessag creat behaviour scan chang f option see directoryscanmod directori specifi directori process program termin setup instal clone project build nuget depend automat download edit yamldefault configur environ run processdirctoryex commandlin top level directori argument exchang queue set readwrit type config set write accessiondirectorymessag processdirectoryoptionsaccessiondirectoryproduceropt config yaml section purpos rabbitopt describ locat rabbit server send messag filesystemopt describ root locat imag program ever load directori provid command line argument must subdirectori root order file name express rel path downstream microservic processdirectoryopt exchang name accessiondirectorymessag sent find subdirectori dicom file argument command line option purpos directori root requir directori imag archiv begin folder discoveri f directori search format option directori scan mode use see expect error log normal microservicehostcommonsmicommonreadmemdlog class diagram class diagramimagesclassdiagrampng directori scan mode specifi f cli argument option defaultexecutiondirectoryfindersbasicdicomdirectoryfinderc perform gener recurs scan file program look insid subdirectori directori contain least file scan mode search dicom file extens specifi filesystemoptionsdicomsearchpattern config option pacsexecutiondirectoryfinderspacsdirectoryfinderc perform scan assum file locat insid particular directori structur pac directori structur form rootyyyymmddaccdicom acc repres access directori directori found match pattern accessiondirectorymessag produc note scan mode actual assert file insid access directori listexecutiondirectoryfindersaccessiondirectorylisterc receiv file contain list access directori path access directori path structur expect form rootyyyymmddacc path match pattern exist directori whether contain dicom file check path meet requir accessiondirectorymessag produc note input file path pass way directori path pass oper mode cohort packag primari author ruairidh macleodhttpsgithubcomrkm content overviewoverview setup installationsetupinstal queue settingsqueueset configconfig expectationsexpect reportsreport overview collect inform regard extract job monitor filesystem anonymis file persist inform mongodb collect produc valid report extract suitabl review research coordin extract file releas see report sectionreport report creat automat extract detect complet also manual recreat cli pass r recreatereport flag correspond extract guid setup instal clone project build nuget depend automat download setup yaml file configur environ run cohortpackagerex yaml config exchang queue set readwrit type config set readextractrequestmessagedicomreprocessoroptionsextractrequestinfoopt readextractrequestinfomessagedicomreprocessoroptionsextractfilesinfoopt readextractfilestatusmessag dicomreprocessoroptionsanonimagestatusopt config yaml section purpos jobwatchertickratehow often filesystem check anonymis file second expect error log normal microservicehostcommonsmicommonreadmemdlog report extract complet report creat detail error valid failur relat set file produc current format combin singl file use smaller extract manual review format markdown smi extract valid report testprojextract job info job submit job complet job extract id cbcecaeff extract tag seriesinstanceuid extract modal unspecifi request identifi count identifi extract filter extract ye report content verif failur summari full detail block file anonymis failur verif failur summari tag scanopt total occurr valu foo occurr full detail tag scanopt total occurr valu foo occurr seriesanondcm seriesanondcm block file id seri x reject blah anonymis failur file seriesanondcm couldnt anonymis end report split pack directori file use larger extract script review process read extern analysi tool file current produc extract readmemd summari inform extract markdown smi extract valid report testprojextract job info job submit job complet job extract id faadfabdaabcab extract tag seriesinstanceuid extract modal unspecifi request identifi count identifi extract filter extract ye file includ readmemd file pixel_data_summarycsv pixel_data_fullcsv pixel_data_word_length_frequenciescsv tag_data_summarycsv tag_data_fullcsv file content block file anonymis failur block file id seri x reject blah anonymis failur file seriesanondcm couldnt anonymis end report pixel_data_fullcsv full detail potenti pii contain dicom pixel data postanonymis ocr scan csv tagnamefailurevalu filepath pixeldatamr foobarpathtofiledcm pixel_data_summarycsv summari detail potenti pii contain dicom pixel data postanonymis ocr scan csv tagnamefailurevalueoccurrencesrelativefrequencyintagrelativefrequencyinreport pixeldatamr foobar pixel_data_word_frequenciescsv frequenc analysi word length contain dicom pixel data postanonymis ocr scan csv wordlengthcountrelativefrequencyinreport tag_data_fullcsv full detail potenti pii contain dicom tag data postanonymis ner scan csv tagnamefailurevaluefilepath scanoptionsfooseriesanondcm tag_data_summarycsv summari detail potenti pii contain dicom tag data postanonymis ner scan csv tagnamefailurevalueoccurrencesrelativefrequencyintagrelativefrequencyinreport scanoptionsfoo note identifi extract anonymis appli combin report support format markdown smi extract valid report testprojextract job info job submit job complet job extract id fecbaeaff extract tag studyinstanceuid extract modal mr request identifi count identifi extract ye filter extract ye report content miss file list file select input id could found miss file list studyorigdcm end report mongodb popul primari author ruairidhhttpsgithubcomrkm content overviewoverview setup installationsetupinstal exchang queue settingsexchangeandqueueset configconfig expectationsexpect class diagramclassdiagram overview store dicom tag data dicomfilemessag andor seriesmessag mongodb databas document store setup instal instal mongodbhttpsdocsmongodbcommanualinstal step specif environ option instal gui compasshttpswwwmongodbcomproductscompass easili work mongodb clone project build nuget depend automat download edit yamldefault configur environ ensur mongodb run run mongodbpopulatorex commandlin exchang queue set readwrit type config set read dicomfilemessag mongodbpopulatoroptionsimagequeueconsumeroptionsqueuenam read seriesmessag mongodbpopulatoroptionsseriesqueueconsumeroptionsqueuenam config yaml section purpos rabbitopt describ locat rabbit server send messag mongodatabas contain connect string databas name write tag data mongodbpopulatoropt queue name read messag error threshold often push mongo command line option purpos clioption allow overrid yaml file load expect error log normal microservicehostcommonsmicommonreadmemdlog data failur state oper receiv corrupt messag program send nack requeu flag set fals indic rabbitmq send messag dead letter exchang analysi environment failur state oper loss mongodb connect program attempt reconnect send warn messag everi x minut connect recov connect found minut nack messag receiv enter paus state send fatal error similar class diagram class diagramimagesclassdiagrampng dicomrelationalmapp primari author thomashttpsgithubcomtznind content overviewoverview setup installationsetupinstal queue settingsqueueset configconfig expectationsexpect ad tagsaddingtag auditaudit class diagramclassdiagram overview run rdmp data load configur loadmetadata batch dicomfilemessag load dicom tag data relat databas mysql microsoft sql server design work mani imag perform load configur configur main rdmp client setup instal rdmp imag dataset load setup instal setup rmdphttpsgithubcomhicservicesrdmpinstal instal rdmpdicom plugin setup imag tableshttpsgithubcomhicservicesrdmpdicomtreedevelopusingplugin ensur json sourc select pipelin clone repositori build nuget depend automat download edit yamldefault configur environ run dicomrelationalmapp test setup order run databas test rdmp platform api schema chang need creat test_ platform databaseshttpsgithubcomhicservicesrdmpblobmasterdocumentationcodetutorialstestsmd databasecreationex bin directori test project referenc hicrdmpplugintest queue set readwrit type config set read dicomfilemessag dicomrelationalmapperoptionsqueuenam config yaml section purpos rabbitopt describ locat rabbit server send messag rdmpoption describ locat microsoft sql server rdmp platform databas keep track load configur avail dataset tabl etc dicomrelationalmapperopt queue read dicomfilemessag id loadmetadata load configur load configur sequenc step modifyclean data loadabl final live tabl loadmetadata design modifi rmdp user interfac persist loadmetadata tabl relat tabl rdmp platform databas command line option purpos clioption allow overrid yaml file load expect dicomrelationalmapp expect robust abl load dicom file given input input anonymis imag anoth servic know imag process load logic reli loadmetadata configur customis rdmp applic error log normal microservicehostcommonsmicommonreadmemdlog data failur state dicom file valid dcm file testloadingoneimage_singlefilemessag ignor imag file process rest directori empti directori invalid messag automat nack requ flag fals testdodgydirectori dicom data corrupt miss primari key tag conflict etc data batch fail exe stop accept new messag someon resolv problem current system behaviour assum dicom rel process build system resolv collis make sens load configur rel easili therefor problem aris load caus crash rare requir fix appli across board environment failur state oper loss rabbitmq connect load progress data load complet process crash basicack leav messag unacknowledg repeat process stale messag instanc introduc duplic oper loss microsoft sql server connect load data load batch fail messag nack live data integr maintain sinc final load step appli transact stagingl merg oper data load error eg corrupt file file system data load batch fail messag nack rawstag left avail diagnosticsdebug ad tag relat databas tabl initi schema box base imag templatehttpsgithubcomhicservicesrdmpdicomblobdevelopdocumentationdataloadmdimaget system gone live data analyst still abl add new tag exist databas tabl rdmp user interfac use tag promotionhttpsgithubcomhicservicesrdmpdicomblobdevelopdocumentationdataloadmdimaget audit addit log nlog like microservic data load audit rdmp relat log databas includ fact mani record load updat insert problem encount load metadata logsimagesloadmetadatalogstpng order improv traceabl imag tabl everi set imag databas tabl studi seri imag field messageguid contain guid input messag dicomrelationalmapp result record part batch guid trace back file logsmicroservicescommonreadmemdlog see microservic act result record final live databas final tabl studi seri imag validfrom dataloadrunid field record load batch last part execut event load fail eg due primari key collis raw stage databas contain data work load left intact debug case messag batch nack extra fieldsimagesloadbubblespng class diagram class diagramimagesclassdiagrampng ctpanonymis primari author paul graham httpsgithubcompjgraham content overviewoverview setup installationsetupinstal queue settingsexchangeandqueueset configconfig expectationsexpect overview ctp anonymis app rabbitmqbas tool anonymis dicom imag data launch command line consum rabbitmq queue receiv directori name dicom file anonymis use ctp dicom anonymizerhttpsmircwikirsnaorgindexphptitlethe_ctp_dicom_anonym produc output anonymis filenam anoth rabbitmq queue choic field etc anonymis determin provid anonymis script file setup instal anonymis instal via maven per java app clone project git run maven instal see herehttpsgithubcomsmismiservicesblobmastersrccommoncomsmimicroservicesparentreadmemd detail exchang queue set readwrit type config set read extractfilemessag ctpanonymiseroptionsanonfileconsumeropt write extractfilestatusmessagectpanonymiseroptionsextractfilestatusproduceropt extractfilemessag content includ name directori dicom file anonymis file anonymis extractfilestatusmessag messag produc indic success otherwis config java c microservic anonymis use yaml config file document herehttpsgithubcomsmismiservicesblobmastersrccommonsmicommonoptionsrabbitmqconfigoptionsmd particular anonymis use rabbitopt locat rabbitmq host etc filesystemopt root directori file discoveredanonymis ctpanonymiseropt config anonymis consum produc cli option switch requir purpos yaml configi allow overrid yaml file use anon scripta ye anonymis script file use anonymis script base exampl provid ctp restrict exampl exclud field may includ userdefin text current anonymis script view herehttpsgithubcomsmismiservicesblobmasterdatactpctpwhitelistscript file dicomwhitelistscript note ctp also support pixel anonymis moment exploit expect dicom file process rabbitmq statu messagehttpsgithubcomsmismiservicesblobmastersrcmicroservicescomsmimicroservicesctpanonymisersrcmainjavaorgsmictpanonymisermessagesextractedfilestatusmessagejava produc indic success otherwisehttpsgithubcomsmismiservicesblobmastersrcmicroservicescomsmimicroservicesctpanonymisersrcmainjavaorgsmictpanonymiserutilextractedfilestatusjava anonymis unsuccess anonymis attempt tag either retri retri statu messag also includ detail path anonymis file project number job id etc structur report anonymis procedur anonymis structur report sr modal ctp proceed normal remov almost tag may contain pii extract text origin dicom file pass extern anonymis process insert redact text ctp output file thu reconstruct text content part dicom anonym text requir extern tool configur sranontool yaml full path tool unless current directori tool call inputdcm outputdcm inputdcm raw origin dicom file outputdcm output ctp tool call dicom file modal tag equal sr failur execut tool result complet failur ctp anonymis process file even though ctp may success remov pii file proceed insert redact text identifiermapp primari author thomashttpsgithubcomtznind content overviewoverview setup installationsetupinstal exchang queue settingsexchangeandqueueset configconfig expectationsexpect class diagramclassdiagram overview servic take serial dicom file dicomfilemessag messag use iswapidentifi replac top level dicomtagpatientid tag anonym represent patientid messag nack iswapidentifi return null messag nack reason provid string getsubstitutionforstr toswap string reason setup instal clone project build nuget depend automat download edit yamldefault configur environ pick implement iswapidentifi eg microservicesidentifiermapperexecutionidentifierswapp enter full type name defaultyaml identifiermapperoptionsswappertyp specifi map tabl databas detail mappingconnectionstr connect string use connect map server mappingdatabasetyp either microsoftsqlserv mysqlserv mappingtablenam tabl map server contain identifi map tabl identifiableanonym swapcolumnnam column mappingtablenam contain expect identifi input valu replac replacementcolumnnam column mappingtablenam contain replac valu decid want use redisredi cach tableconnect string detail dispos iswapidentifi chosen might ignor complet might manual creat map tabl eg forguididentifierswapp exchang queue set readwrit type config set read dicomfilemessag identifiermapperoptionsqueuenam write dicomfilemessag identifiermapperoptionsanonimagesproduceropt expect receiv control messag inform refresh map tabl config yaml section purpos rabbitopt describ locat rabbit server send messag identifiermapperopt describ locat map tabl eg chieupi type respons map queueexchang set command line option purpos clioption allow overrid yaml file load redi use iswapp implement consult larg map databas eg million may benefit use redi cach databas instal redi set redishost option config file eg yaml identifiermapperopt swappertyp microservicesidentifiermapperexecutionswapperstablelookupswapp redishost localhost lookup result cach redi server success lookup miss updat lookup tabl manual flush redi server desir expect identifi alloc handl chosen iswapidentifi field consid dicomtagpatientid patient identifi field load downstream process ensur integr map tabl appropri schema eg null primari key prevent mani map blank map etc data load time job iswapidentifi handl data failur state dicom file doesnt contain dicomtagpatientid nack test_blankpatientidentifi patientid found iswapidentifi nack test_nomatchingidentifierfound environment failur state oper loss rabbitmq connect special logic oper loss access map tabl except thrown iswapidentifi caught trigger fatal consum class diagram class diagramimagesclassdiagrampng dicomreprocessor primari author ruairidh macleodhttpsgithubcomrkm content overviewoverview setup installationsetupinstal configconfig queue settingsqueueset expectationsexpect class diagramclassdiagram overview pull document mongodb collect republish rabbitmq dicomfilemessag futur option run tagpromot mode select tag republish setup instal clone project build nuget depend automat download setup yaml file configur environ run normal load pipelin mongodb record run dotnet dicomreprocessordl config c collect option config requir follow field default yaml config rabbitopt mongodatabasesdicomstoreopt dicomreprocessoropt exchang queue consum messag none write messag dicomreprocessoroptionsreprocessingproduceropt expect error log normal microservicehostcommonsmicommonreadmemdlog class diagram class diagramimagesclassdiagrampng isidentifi primari author thomashttpsgithubcomtznind content overviewoverview setupsetup invocationinvoc rulesrul basic rulesbasicrul socket rulessocketrul consensu rulesconsensusrul white list ruleswhitelistrul exchang queue settingsexchangeandqueueset expectationsexpect class diagramclassdiagram overview servic evalu data person identifi valu eg name sourc data verieti place eg databas file system setup run isidentifi must first build microservic download requir data model ner ocr rule must place suitabl directori data rule suppli smiservic data directori download follow download requir run softwar file destin window script linux script tesseract data file pixel ocr modelshttpsgithubcomtesseractocrtessdatarawmasterengtraineddata datatessdata downloadpsdatatessdatadownloadp downloadshdatatessdatadownloadsh stanford ner classifiershttpnlpstanfordedusoftwarestanfordnerzip datastanfordn downloadpsdatastanfordnerdownloadp downloadshdatastanfordnerdownloadsh _requir nerdaemon_ invoc isidentifi run one sever mode microservic host process dicom file name rabbitmq messag interact process dicom file directori dicom file interact process everi row everi column databas tabl run servic use dotnet isidentifiabledl servic defaultyaml option run file use dotnet isidentifiabledl dir pathdir pattern dcm option run databas use dotnet isidentifiabledl db databas tabl p dbtype option exampl bash dotnet publish cd srcmicroservicesmicroservicesisidentifiablebinanycpudebugnetcoreapp gener help list mode dotnet isidentifiabledl help specif help given mode eg db dotnet isidentifiabledl db help exampl command evalu imag cmassiveimagearch would follow dotnet isidentifiabledl dir cmassiveimagearch storereport output anonymis data resourceresourceprimarykeyproblemfieldproblemvaluepartwordspartclassificationspartoffset cmassiveimagearchivedoidcmiso_ir isoorgan cmassiveimagearchivedoidcmmathworksmathworksorgan cmassiveimagearchivedoidcmmatlabmatlabperson cmassiveimagearchivedoidcmddsmddsmperson cmassiveimagearchivedoidcmiso_ir isoorgan cmassiveimagearchivedoidcmmatlabmatlabperson cmassiveimagearchivedoidcmddsmddsmperson cmassiveimagearchivedoidcmiso_ir isoorgan cmassiveimagearchivedoidcmmathworksmathworksorgan cmassiveimagearchivedoidcmmatlabmatlabperson cmassiveimagearchivedoidcmddsmddsmperson cmassiveimagearchivedoicalctest_p__left_ccdcmiso_ir isoorgan cmassiveimagearchivedoicalctest_p__left_ccdcmmathworksmathworksorgan cmassiveimagearchivedoicalctest_p__left_ccdcmmatlabmatlabperson cmassiveimagearchivedoicalctest_p__left_ccdcmddsmddsmperson run pixel data ocr pass tessdirectori flag dotnet isidentifiabledl dir cmassiveimagearch storereport tessdirectori esmiservicesdatatessdata directori must name tessdata contain file name engtraineddata rule rule use customis way failur handl failur fragment text imag contain identifi data either ignor fals posit report rule come box eg chipostcoded rest must configur rule rulesyaml file three class rule basicrul socketrul whitelistrul see detail appli order valu ignor basic rule pass rule valu fail socketrul eg ner daemon label person subsequ whitelist rule ignor ignor rule go whitelistrul section intend whitelist fragment nerd incorrectli report failur rule read one yaml file file zero one set basicrul plu zero one set whitelistrul basicrul file merg form singl set basicrul similarli whitelistrul run servic mode microservic host rule read yaml file found isidentifiablerul directori insid data directori data directori path defin program yaml file specifi use key isidentifiableoptionsdatadirectori run file databas mode yaml file option use command line option rulesdirectori need specifi path isidentifiablerul directori basic rule either result valu report ignor ie pass downstream classifi rule appli column eg ignor modal column valu match regex regex specifi use ifpattern regex case sensit determin casesensit properti default fals yaml basicrul report valu contain digit privateidentifi ifpattern action report privateidentifi run classifi modal column action ignor ifcolumn modal socket rule outsourc classif separ applic eg nerdaemon ad socket rule yaml socketrul host port tcp protocol start isidentifi send word classif ie sender word sentenc servic expect respond classif bit word problemat take format respond classificationoffsetoffend word respond decid offend section none begin send doubl null termin indic origin word sentenc fulli process sender send next valu requir valid respond consensu rule two rule want cooper determin whether data identifi eg nlp name entiti recogn use consensusrul rule requir subrul agre whether report ignor given cell valu disagr rule appli ruleactionnon ie take action configur consensu rule use follow yaml yaml consensusrul rule socketrul host port socketrul host port consensu rule specif design intersect two match rule eg nlp classif one rule flag someth identifi ignor must agre white list rule white list rule last chanc filter final output rule allow discard rule base whole string specif fail part action white list rule must ignor intend allow valu previous report ignor fals posit constraint must match order rule ignor valu soon valu match white list rule white list rule need unlik basicrul whose pattern match full valu field column dicom tag whitelist rule two pattern ifpattern behaviour ifpartpattern match substr fail featur allow context specifi see second exampl whitelist rule also match failur classif privateidentifi locat person organ money percent date time pixeltext postcod exampl siemen report person found manufactur column yaml whitelistrul action ignor person ifcolumn manufactur ifpartpattern siemen exampl seem like name brian ignor occur exact phrase mr brian skull use yaml ifpartpattern brian ifpattern mr brian skull note need specifi ifpattern text chang mean exchang queue set order run microservic call servic option readwrit type config set read extractfilemessag isidentifiableoptionsqueuenam write isidentifiablemessag isidentifiableoptionsisidentifiableproduceroptionsexchangenam config yaml section purpos rabbitopt describ locat rabbit server send messag isidentifiableopt describ iclassifi run classifi model store key datadirectori specifi path data directori key classifiertyp specifi classifi run typic microservicesisidentifiableservicetesseractstanforddicomfileclassifi expect todo data failur state todo environment failur state todo class diagram class diagramisidentifiablepng name entiti recognit daemon primari author jame sutherlandhttpsgithubcomja python author andrew brook content backgroundbackground setupsetup runningrun background standalon process design classifi text string sent isidentifiablemicroservicesisidentifiablereadmemdsocketrul applic accept tcp connect localhost port return classif result expect isidentifi microservic two implement one java use stanford corenlphttpsstanfordnlpgithubiocorenlp librari one python use spacyhttpsspacyio librari stanford corenlp ner algorithmhttpsstanfordnlpgithubiocorenlpnerhtmldescript recogn name person locat organ misc numer money number ordin percent tempor date time durat set entiti class ad regexn annot use suppli regexn pattern file add support finegrain addit entiti class addit annot current use python version recognis differ set entiti differ languag model recognis drug diseas cell etc although requir name entiti tri map entiti type name match return corenlp use consensusrul isidentifi setup setup requir java version run jar file document caus disconnect termin initialis run daemon develop use also skip termin ctrlc consol finish python program requir yaml configur file determin log file locat also requir spaci option scispaci packag instal global virtual environ environ must also requir spaci languag model instal note spaci version eg scispaci version must use feb spaci v use new architectur scispaci caught yet least ner run java jar nerdjar shutdown fuser k term n tcp python version ner_daemon_spacypi yaml defaultyaml model en_core_web_md port yaml must loggingopt logsroot port differ nerd run parallel model en_core_web_md default en_core_sci_md scispaci warn return entiti type use find pii en_ner_bionlpcg_md en_ner_bccdr_md scispaci model drug diseas addit spaci model use much larger eg en_core_web_lg dicomtagread primari author ruairidh macleodhttpsgithubcomrkm content overviewoverview setup installationsetupinstal exchang queue settingsexchangeandqueueset configconfig expectationsexpect class diagramclassdiagram overview open dicom file found accessiondirectorymessag directori convert json dicomfilemessag also creat summari record whole seri seriesmessag setup instal clone project build nuget depend automat download edit defaultyaml configur environ exchang queue set readwrit type config set read accessiondirectorymessag dicomtagreaderoptionsqueuenam write dicomfilemessag dicomtagreaderoptionsimageproduceropt write seriesmessag dicomtagreaderoptionsseriesproduceropt config yaml section purpos rabbitopt describ locat rabbit server send messag filesystemopt describ root locat imag program load accessiondirectorymessag process microservic assum refer imag rel root dicomtagreaderopt contain name seri imag exchang serial imag tag data written command line option switch purpos clioption yamlfil allow overrid yaml file load expect error log normal microservicehostcommonsmicommonreadmemdlog class diagram class diagramimagesclassdiagrampng cohort extractor primari author thomashttpsgithubcomtznind content overviewoverview setup installationsetupinstal exchang queue settingsexchangeandqueueset configconfig fulfil rejector expectationsexpect class diagramclassdiagram overview servic servic extractionrequestmessag request extract given set imag identifi key tag eg seriesinstanceuid collect eg seriesinstanceuid valu job cohort extractor identifi imag correspond specifi key valu request eg seriesinstanceuid gener output messag downstream process respons anonymis imag multipl dataset match imag sourc eg mr ct could even resid differ server dataset identifi distinguish one anoth rdmp icatalogu exist alreadi part data load process see dicomrelationalmapp setup instal clone project build nuget depend automat download edit yamldefault configur environ pick implement iauditextract eg microservicescohortextractorauditnullauditextract enter full type name defaultyaml auditortyp pick implement iextractionrequestfulfil eg microservicescohortextractorexecutionrequestfulfillersfromcataloguesextractionrequestfulfil enter full type name defaultyaml requestfulfillertyp specifi map rdmp catalogu databas option specifi list catalogu id cataloguestoextractfrom set use depend iextractionrequestfulfil valu might ignor exchang queue set readwrit type config set read extractionrequestmessag cohortextractoroptionsqueuenam write extractfilemessag cohortextractoroptionsextractfilesproduceropt write extractfilecollectioninfomessag cohortextractoroptionsextractfilesinfoproduceropt command line option purpos clioption allow overrid yaml file load config yaml section purpos rabbitopt describ locat rabbit server send messag rdmpoption describ locat microsoft sql server rdmp platform databas keep track load configur avail dataset extract imag tabl etc cohortextractoropt catalogu extract class instanti extract command line option purpos clioption allow overrid yaml file load fulfil set imag __could__ extract control iextractionrequestfulfil current recommend implement fromcataloguesextractionrequestfulfil fulfil look one tabl multi tabl join catalogu search provid extract key eg seriesinstanceuid x match record report eg x uid found avail imag result set subset reject made row level decis extract particular imag handl rejector configur fulfil option yaml yaml onlycatalogu requestfulfillertyp microservicescohortextractorexecutionrequestfulfillersfromcataloguesextractionrequestfulfil rejector record match fulfil pass irejector configur class make last minut decis row row level either extract forbid specif provid reason extract imag current recommend implement dynamicrejector use dynam rejector edit option yaml follow yaml rejectortyp microservicescohortextractorexecutionrequestfulfillersdynamicdynamicrejector use dynamicrejector also requir configur file dynamicrulestxt execut directori binari exampl provid see dynamicrulestxt rule written c index field appear record return fulfil expect match request criteria handl iextractionrequestfulfil audit handl iauditextract extract destin handl iprojectpathresolv data failur state file match given tag x valu patient id substitut other todo environment failur state oper loss rabbitmq connect special logic oper loss access catalogu except thrown iswapidentifi caught trigger fatal consum class diagram class diagramimagesclassdiagrampng rejector rejector fulfil fulfil dynamicrulestxt dynamicrulestxt dynamicrejector executionrequestfulfillersdynamicdynamicrejectorc fromcataloguesextractionrequestfulfil executionrequestfulfillersfromcataloguesextractionrequestfulfillerc updat valu primari author thomashttpsgithubcomtznind content overviewoverview setup installationsetupinstal exchang queue settingsexchangeandqueueset configconfig expectationsexpect class diagramclassdiagram overview servic servic updatevaluesmessag request updat concept eg patientid one tabl messag describ singl queri although multipl valu updat setup instal clone project build nuget depend automat download edit yamldefault configur environ option specifi list tableinfo id tableinfostoupd otherwis current configur tableinfo use exchang queue set readwrit type config set read updatevaluesmessag updatevaluesoptionsqueuenam command line option purpos clioption allow overrid yaml file load config yaml section purpos rabbitopt describ locat rabbit server pull messag rdmpoption describ locat microsoft sql server rdmp platform databas keep track load configur avail dataset extract imag tabl etc updatevaluesopt tabl updat timeout etc command line option purpos clioption allow overrid yaml file load expect messag process result one updat sql statement run may run differ server differ dbm oracl mysql sql server postgr ensur rel consist whole system updat given fact data failur state tabl exist contain updat field tableinfo rdmp map non exist tabl eg databas server shutdown tabl renameddelet environment failur state oper loss rabbitmq connect special logic class diagram class diagramimagesclassdiagrampng azur pipelin build note directori contain azur pipelin definit file use test smiservic pipelin current follow pipelin linux test packagehttpsdevazurecomsmiopspublic_builddefinitionid defin hereazurepipelineslinuxyml run c java test linux build tag also packag set servic upload github releas window test packagehttpsdevazurecomsmiopspublic_builddefinitionid defin hereazurepipelineswindowsyml window run reduc set test sinc servic avail see creat github releasehttpsdevazurecomsmiopspublic_builddefinitionid defin hereazurepipelinescreateghreleaseyml run automat tag master creat github releas pipelin publish packag directori content dockercompos dockercompos file lockfil see job job definit script script use pipelin step individu task step definit yml toplevel pipelin definit varsjson variabl pipelin note yaml file use templat extens tmplyml variabl variabl pipelin load varsjson file start run often combin predefin variableshttpsdocsmicrosoftcomenusazuredevopspipelinesbuildvari servic servic linux provid ubuntu window provid window rabbitmq docker mongodb docker preinstal mssql docker sqllocaldbhttpsdocsmicrosoftcomenussqldatabaseengineconfigurewindowssqlserverexpresslocaldbviewsqlserverv mariadb docker redi docker unavail docker use docker contain run extern servic wherev possibl current mean linux sinc azur window os current doesnt support wsl run linux contain option could investig window eg see similar discuss herehttpsgithubcomopensafelyjobrunnerissu dockercompos file refer latest tag imag pipelin run howev replac specif imag digest version use dockerlockhttpsgithubcomsafewatersdockerlock tool dockercompos file use cach key enabl repeat build cach cachehttpsdocsmicrosoftcomenusazuredevopspipelinesreleasecachingviewazuredevop task use multipl case speedup build reus previous builtdownload asset restor base key valu contain refer file hash gener final key note set x bash task may interfer vso syntax ap interpret stdout contain string command caus problem variabl set twice wrong quot escap see httpsgithubcommicrosoftazurepipelinestasksissu httpsgithubcommicrosoftazurepipelinestasksissu httpsdevelopercommunityvisualstudiocomcontentproblempipelinevariableincorrectlyinsertssinglequotehtml deal variabl contain path separ across multipl platform ie linux window tricki variabl predefin ap correct separ current os use bash task safe enough either os use linux separ combin path long alway quot howev variabl also use part cach path may need manual recreat windowsstyl separ use vsotasksetvari variablefoobar syntax requir variabl name lowercas document explicitli result command found error uppercas name use util ci build script buildartefactspi creat packag app repo createreleasechangelogpi creat changelog text upload github releas page dotnetbuildbash build dotnet servic releas mode installctpbash instal requir lib ctp runjavatestsbash run java test rundotnettestspi run dotnet test releas mode gener coverag report updatechangelogpi updat changelog news file util rabbitmqtidyqueu automat delet control queue consum delet host due crash rabbitmq dump queue allow dump messag rabbitmq queue json file download herehttpsgithubcomdubekrabbitmqdumpqueu rabbitmq tidi queue util languag go delet control queue properli clean servic crash build download instal gohttpsgolangorgdl associ build tool build local system bash go build build window linux run windowsbuildforlinuxbatwindowsbuildforlinuxbat script build elf binari amdlinux gener need appropri set goarch goo build anoth system unset afterward ensur get return back default valu system usag run build output node rabbitmq server todo move old rdmp test project exist todo separ integr test propos chang summaris propos chang includ note review type chang type chang code introduc tick appli bugfix nonbreak chang fix issu new featur nonbreak chang add function break chang fix featur would caus exist function work expect documentationonli updat none choic appli case ensur messag head commit sourc branch prefix skip ci checklist open pr confirm review contributinghttpsgithubcomsmismiservicesblobmastercontributingmd guidelin repositori ensur pr branch sync target branch ie automat mergeabl updat relev api document creat updat test relev creat newshttpsgithubcomsmismiservicesblobmasternewsreadmemd file note must includ chang follow file defaultyaml rabbitmq server configur globaloptionsc list contributorshttpsgithubcomsmismiservicesblobmastercontributorsmd file request review one repositori maintain issu relev tag issu expect resolv pr eg close issuenumb todo move dicom file common resourc smi servic configur todo add doc rabbitmq configur reset server follow complet reset state rabbitmq instanc includ remov user vhost exchang queue vhost messag find instal folder default appear cprogram filesrabbitmq serverrabbitmq_serversbin window run follow rabbitmqctlbat stop_app rabbitmqctlbat reset rabbitmqctlbat start_app also run resetrabbitmqp script includ directori linux remov bat extens command run sudo upload broker defnint linux exchang queue definit upload use curl bash curl u guestguest xpost hcontenttypeapplicationjson dfullpathtodefaultextractconfigjson httpapidefinit delet vhost bash curl u guestguest xdelet httpapivhostsnam filter default exchang rabbitmq predefin exchang cant remov manag ui filter tick regex checkbox next search box exchang tab use regex regex amq filter control queue microservic control queue filter default display follow regex regex control note develop smiservic gener local html coverag report follow process describ herehttpsdocsmicrosoftcomenusdotnetcoretestingunittestingcodecoveragetabslinuxgeneratereport consol dotnet tool updat g dotnetreportgeneratorglobaltool utilsrundotnettestspi reportgener reporttypeshtml targetdirhtmlcov reportscoveragecoveragecoberturaxml write report file htmlcovindexhtml host local webpag use python consol python httpserver directori htmlcov serv http port http name descript name descript foreach catalogueitem name descript end microservic control queue describ servic control via rabbitmq messag content commandscommand send messagesendingamessag implement new control command handlerimplementinganewcontrolcommandhandl control queue cleanupcontrolqueuesandcleanup command command sent publish messag controlexchang specifi config rabbitoptionsrabbitmqcontrolexchangenam specif rout key allow easili send rabbitmq web manag page via cli rabbitmq messag rout key use control servic receiv messag current format rout key smicontrolwhowhat name servic defin action note key must specifi lowercas current defin action gener servic stop stop servic ping log pong messag use debug dicomreprocessor setsleeptimem set sleep time batch also requir new valu set messag bodi identifiermapp refresh refresh cach use cohortpackag processjob check progress job complet send messag messag sent either via web ui via cli see detail either case follow appli field must exactli match name microservic process eg identifiermapp rout key lowercas use keyword control servic specif servic messag includ pid end rout key current way control specif servic instanc rather servic certain type exampl rout key text smicontrolallstop stop servic smicontroldicomtagreaderstop stop dicomtagread servic smicontrolidentifiermapperrefresh refresh identifiermapp servic pid note servic may take time finish current oper exit reciev shutdown command via web ui rabbitmq manag interfac httprabbit host click exchang control exchang expand publish messag box enter messag info requir content enter payload box plain text exampl testimagescontrolqueuepublishpng via cli todo implement new control command handler implement class contain method follow signatur c void mycontrolhandlerstr action string messag instanti class regist event host must subclass microservicehost c var controlclass new mycontrolclass addcontrolhandlercontrolclassmycontrolhandl that pass full rout key control messag address specif microservic type ie part rout key match microservic name messag content control queue cleanup actual implement control queue work follow servic start creat new queue name servic name process id bind queue global controlexchang two bind creat smicontrolal match send rout key smicontrolprocess_nam match servic type rout key shutdown rmq connect close control queue automat delet server creation control queue perform singl adhoc connect part standard consum process _reasons_ one consequ microservic crash _after_ control queue creat _before_ actual subscript queue start ie point startup rabbitmqadapterstartconsum call control queue may automat delet isnt realli issu caus visual clutter rabbitmq manag interfac dangl queue manual delet tidyqueuesutilsrabbitmqtidyqueu util tool smi servic document document smiservic platform hope contain enough inform run instanc servic platform current deploy nation safe document may specif refer environ softwar deploy environ though pleas open issuehttpsgithubcomsmismiservicesissu anyth isnt clear content control servicescontrollingtheservic todotodo control servic servic control send messag rabbitmq control exchang specif rout key see main doccontrolqueuesmd todo figur document safe import old privat repo extract describ buildinstalltest procedur deploy product main doc httpsgithubcomsmismiservicestreemastersrcmicroservicescomsmimicroservicesctpanonymis httpsgithubcomsmismiservicestreereleaseimageextractionmicroservic see also extractionrefactor branch httpsgithubcomsmismiservicestreefeatureextractionrefactoringdocsextract doc httpsuoesharepointcomsitessmishareddocumentsformsallitemsaspx httpsgitecdfedacuksmismiserviceopsblobmasterplanningextractionflag httpsgithubcomhicservicessmipluginblobmasterdocumentationimagesextractionmicroservicespng build see elsewher document build java program prerequisit test rabbitmq instanc requir run test version insid docker contain sudo docker run hostnam myrabbit name somerabbitmgt p p p p p p rabbitmqmanag extractimag consol exampl csv file cat extractmecsv _eof seriesinstanceuidfoo _eof edit defaultyaml rabbitopt filesystemopt could programmat yq_linux_amd write inplac filesystemoptionsfilesystemroot tmp although current version yq lose comment unnecessari quot login rabbit localhost creat exchang testrequestexchang testrequestinfoexchang add bind exchang queue testxxx projectnum rmdir tmpprojectnumtmp program give error dir alreadi exist interact answer creat messag run noninteract smi extractimag defaultyaml p projectnum extractmecsv two messag creat keytagseriesinstanceuidextractionidentifiersextractionjobidentifierbbcbedaabeaaprojectnumberextractiondirectorytmpjobsubmittedattz keytagseriesinstanceuidkeyvaluecountextractionjobidentifierbbcbedaabeaaprojectnumberextractiondirectorytmpjobsubmittedattz cohortextractor requir mysql instanc describ yet creat messag contain field dicomfilepath path origin file extractiondirectori extract directori rel extract root outputpath output path anonymis file rel extract directori see srcsmiservicessrccommonsmicommonmessagesextractionextractfilemessagec inherit extractmessag guid extractionjobidentifi string projectnumb string extractiondirectori datetim jobsubmittedat ctpanonymis cd srcsmiservicessrcmicroservicescomsmimicroservicesctpanonymisertarget whitelist requir avail old repo httpsrawgithubusercontentcomhicservicessmiplugindevelopdocumentationanondicomwhitelistscript httpsrawgithubusercontentcomhicservicessmiplugindevelopdocumentationanondicomwhitelistscriptnew possibl ident content apart whitespacenewlin new repo directori smiservicessrcapplicationscomsmiapplicationsextractorclianonscripttxt smiservicessrcmicroservicescomsmimicroservicesctpanonymisersrctestresourcesdicomanonymizerscript havent yet determin one correct edit defaultyaml rabbitopt filesystemopt login rabbit httplocalhost creat exchang testcontrolexchang testfatalloggingexchang testfilestatusexchang queue testextractfilequeu check need add bind exchang queue copi input file directori rel root defaultyaml cp srcsmiservicessrcmicroservicescomsmimicroservicesctpanonymisersrctestresourcesimagedcm tmp creat fake messag send testcontrolexchang python pip instal pika usrbinenv python msg_json dicomfilepath imagedcm extractiondirectori tmpextractiondir outputpath outputdcm extractionjobidentifierbbcbedaabeaa projectnumb extractiondirectorytmp jobsubmittedattz hdrmessageguid originalpublishtimestamp producerexacutablenametestpi producerprocessid import pika connect pikablockingconnectionpikaconnectionparameterslocalhost channel connectionchannel exchangetestcontrolexchang make bind straight routing_key queue channelbasic_publishexchang routing_keytestextractfilequeu bodymsg_json propertiespikabasicpropertiescontent_typeapplicationjson headershdr run java jar ctpanonymiserportablejar dicomwhitelistscriptnew defaultyaml output written tmptmpoutputdcm exampl log file logsyyyymmddhhmmsslog success messag publish testfilestatusexchang contain dicomfilepathimagedcmanonymisedfilenameoutputdcmstatusextractionjobidentifierbbcbedaabeaaprojectnumberextractiondirectorytmpjobsubmittedattz isidentifi see netcoreapp branch isidentifi httpsgithubcomhicservicesisidentifiabletreenetcoreapp chang requir build run dotnet core linux time merg master data flow background document describ flow dicom tag pixel data smiservic system exampl deploy scenario actual implement tailor accord need tag flow variou zonesimagesdataflowsvg flow tag pixel data smi codebas key entiti purpos disk origin dicom file kept unchang disk mongo databas dicom tag except pixel data store json format pixel algorithm valid product readi algorithm run identifi dicom pixel data output result use cohort build relat databas nlp algorithm valid product readi algorithm run identifi free text data eg dose report structur report output result use cohort build relat databas relat databas tag use cohort build easili reliabl anonymis eg tag cohort build tag use cohort build studyseri level eg tag research zone ctp dicom imag tag anonymis ctp includ technic tag load relat use cohort build date tag anonymis patient id eg origin tag research zone nlp dicom file contain full clinic report eg dose report structur report report would need anonymis dedic nlp tool free text report redact someth ctp set high proport clinic report content would need remain file free text research activ eg smiservic releas process step cut new releas smiservic follow develop done via simpl branch workflow merg master via review pr master therefor contain latest review chang sinc previou releas ci check alway pass possibl push master directli releas workflow checkout new releas branch master updat changelog etc per open releas pr updat merg tag push master trigger pipelin azur devop creat github releas pipelin push artefact releas pass creat normal releas review open pr check approv merg includ releas check news filenews_fil present merg pr sinc previou releas checkout latest master commit list merg pr sinc last releas eg consol git checkout master git pull git log onelin previous_tag grep vp dependabotbumpprecommitci grep p ec merg pull request smifeatureextractionfix ae merg pull request smifeaturetriggerupd fcfe merg pull request smifeaturevalueupdat f merg pull request smifeatureconsensustidyup eca merg pull request smifeatureconsensusrul db merg branch master develop eed merg pull request smifeatureisidentifiablemorelog cfed merg pull request smifeaturenoansuffix ddfa merg pull request smifeatureupdatedoc bac merg branch master develop go pr check accur news filenews_fil entri creat miss file need identifi next releas version determin look previou releas decid new code releas major minor patch chang per semverhttpssemverorg eg previou releas v new nonbreak featur news file directori next releas bev definit break often subject though ask member project your unsur ensur latest commit master branch creat new releas branch consol git fetch git statu branch master branch date originmast noth commit work tree clean git checkout b releasev switch new branch releasev updat changelogchangelogmd new releas involv run utilsupdatechangelogpi script review diff check obviou error updat file referenc version see exampl check previou releas pr time write readmemd bump version header srcsharedassemblyinfoc bump version properti commit chang push new branch open pr branch titl releas version request review tznind rkm chang need includ releas pr merg releas branch master wait pr review merg checkout master pull merg commit tag releas eg consol git tag v git push origin v delet releas branch wait azur pipelin build releas check built binari ad releaseshttpsgithubcomsmismiservicesreleas page intern ping mattermost develop channel let everyon know releas avail start longrun task creat hotfix releas hotfix small patch creat respons showstopp bug previou releas process similar except branch name hotfixv pr titl hotfix version link news_fil newsreadmemd data load __all data demo synthet gener baddicom__ content backgroundbackground mongodb relationaldb preparationprepar publish binariespublishbinari mongodb load microservicesmongodbloadingmicroservic dicomdirectoryprocessordicomdirectoryprocessor dicomtagreaderdicomtagread dead letter exchangedeadletterexchang dicomtagread continueddicomtagreadercontinu mongodbpopulatormongodbpopul relationaldb load microservicesrelationaldbloadingmicroservic dicomreprocessordicomreprocessor identifiermapperidentifiermapp dicomrelationalmapperdicomrelationalmapp instal rdmpinstallingrdmp pick schemapickingtheschema build loadbuildingtheload dicomrelationalmapp continueddicomrelationalmappercontinu background document describ step requir setup data load microservic use load collect dicom imag microservic design execut parallel scale support hundr million dicom imag file data load process popul two databas mongo db identifi relat db anonym mongodb mongo db databas store non pixel dicom tag file path dicom imag use understand data modal date rang imag type etc serv input sourc subsequ relat databas mongodb use design store wide mani column tree structur eg dicom tag valu represent sq sequenc relationaldb relat db eg sql server mysql oracl postgr store tag requir cohort creation imag extract eg studyd patientid modal studydescript etc relationaldb load imag fit releas anonymis anonymis tag load includ perform identifi substitut eg patientid relat databas use allow easier link tradit ehr data eg prescrib biochemistri etc held safehaven prepar download baddicom use gener test imag disk baddicomex ctemptestdicom test file file explor windowsimagesdataloadingtestfilespng ensur mongo db run eg cprogram filesmongodbserverbin mongod ensur rabbitmq run eg cprogram filesrabbitmq serverrabbitmq_serversbin rabbitmqserverbat start ensur target dbm run eg emysqlwinxbin mysqld delet rabbitmq exchang queue httpqueue follow instruct list httpsstackoverflowcoma publish binari microservic run dotnet publish r winx eg esmiservicessrcapplicationsapplicationsdicomdirectoryprocessor dotnet publish r winx mongodb load microservic follow process respons load mongodb dicomdirectoryprocessor run dicomdirectoryprocessor directori creat test dicom file eg esmiservicessrcapplicationsapplicationsdicomdirectoryprocessorbinanycpudebugnetcoreappwinx dicomdirectoryprocessorex ctemptestdicom may caus follow error fail construct host systemiofilenotfoundexcept could find log configur current directori sminlogconfig copi modifi need sminlogconfig binari directori run applic time see fail construct host systemapplicationexcept given control exchang found server testcontrolexchang creat exchang creat exchangeimagesdataloadingtestcontrolexchangepng exchang send runtim messag eg shutdown servic run see error relat anoth miss exchang probabl testaccessiondirectoryexchang creat follow exchang testaccessiondirectoryexchang testfatalloggingexchang run see error fataldicomdirectoryprocessorhostcould confirm messag publish timeoutsystemapplicationexcept could confirm messag publish timeout queue associ output exchang creat queue testaccessiondirectoryqueu creat exchangeimagesdataloadingtestaccessiondirectoryqueuepng bind testaccessiondirectoryexchang exchang queue testaccessiondirectoryqueu bind exchang queueimagesdataloadingbindexchangepng done see output program like ps esmiservicessrcapplicationsapplicationsdicomdirectoryprocessorbinanycpudebugnetcoreappwinx dicomdirectoryprocessorex ctemptestdicom bootstrapp main call construct host infodicomdirectoryprocessorhosthost logger creat smi log config infodicomdirectoryprocessorhoststart dicomdirectoryprocessor infodicomdirectoryprocessorhostcr basic directori finder bootstrapp host construct start aux connect bootstrapp host aux connect start call start infobasicdicomdirectoryfinderstart directori scan ctemptestdicom infobasicdicomdirectoryfinderdirectori scan finish infobasicdicomdirectoryfindertot messag sent infobasicdicomdirectoryfinderlargest stack size infobasicdicomdirectoryfinderaverag newdirinfo ms enumfil ms firstordef ms foundnewdir ms enumdir ms pushdir ms infodicomdirectoryprocessorhosthost stop call directori scan complet infodicomdirectoryprocessorhosthost stop complet bootstrapp host start bootstrapp exit main messag per folder test dicom directori messag queuedimagesdataloadingafteraccessiondirectorypng use getmessag rabbit mq interfac see messag contain exampl messag output queueimagesdataloadingpeekaccessiondirectorypng that right work get __directori listing__ rabbitmq basic creat exchang queue much easier get rest servic run see chang exchangequeu name edit defaultyaml ensur rabbitmq server correct entri dicomtagread publish run dicomtagread copi across sminlogconfig need eg esmiservicessrcmicroservicesmicroservicesdicomtagreaderbinanycpudebugnetcoreappwinx dicomtagreaderex result error testidentifiableseriesexchang creat follow exchang testidentifiableseriesexchang testidentifiableimageexchang caus old friend could confirm messag publish timeout notic also queue messag still consum less messag testaccessiondirectoryqueu one messag consumedimagesdataloadinglostmessagespng _rabbitmq queue graph less messag avail processing_ messag process nack return process queue prevent bad messag get serv repeatedli consum degrad system perform prevent messag loss set dead letter exchang dead letter exchang creat intern exchang queue dead letter deadletterexchang deadletterqueu creat polici queue send nack messag exchang configur dead letter exchang policyimagesdataloadingdeadletterexchangepng run dicomtagread forc anoth failur still bound output queue success process messag result lost messag sent dead letter queue dead letter queue show messag wait fail messag input queue remain messagesimagesdataloadingdeadletterexchangeaftererrorpng _the unprocess messag resid dead letter queue_ dicomtagread continu creat output queue tag reader exchang make sure bind correct exchang testidentifiableseriesexchang testidentifiableseriesqueu testidentifiableimageexchang testidentifiableimagequeu produc follow output bootstrapp main call construct host infodicomtagreaderhosthost logger creat smi log config infodicomtagreaderhoststart dicomtagread bootstrapp host construct start aux connect infoserialtagreaderstopwatch implement ishighresolut true frequenc tickss bootstrapp host aux connect start call start bootstrapp host start bootstrapp exit main infoserialtagreadersend dicomfilemessag infoserialtagreadersend seriesmessag infoserialtagreadersend dicomfilemessag infoserialtagreadersend seriesmessag infoserialtagreadersend dicomfilemessag infoserialtagreadersend seriesmessag binari exit default wait messag use ctrlc trigger shutdown binari infoserialtagreaderlock releas messag process infoserialtagreaderaverag rate enumer dir per acc messag file process send messag overal infodicomtagreaderhosthost stop call ctrlc press infodicomtagreaderhosthost stop complet execut queue look like output queue messag per imag messag per seriesimagesdataloadingafterdicomtagreaderpng _output queue success run dicomtagreader_ peek messag testidentifiableimageexchang see json represent dicom imag tag pixel data exchang testidentifiableimageexchang timestamp delivery_mod header messageguid afadfbbecdc originalpublishtimestamp parent bbeaecfcbefcc producerexecutablenam dicomtagread producerprocessid content_encod utf content_typ applicationjson payload byte encod string dicomfilepathtestdicomsdcmstudyinstanceuidseriesinstanceuidsopinstanceuiddicomdatasetvrcsvaloriginalprimaryaxialvruivalvruivalvrdavalvrdavalvrdavalvrtmvalvrtmvalvrtmvalvrcsvalctvrcsvalctvrlovalct thorax abdo pelvrpnvalluca pricevrlovalvrdavalvrasvalyvrlov foggyley place brechin edzel angu dd esvrdsvrdsvalvrdsvrisvalvrisvalvrisvalvrisvalvrfdvalvrflvaldvruivalevruivalvrisvalvrisvalvrdsvalvrdsvrisvalvrisvalvrusvalvrcsvrusvalvrisvalvrusvalvrusvalvrdsvalvrusvalvrusvalvrusvalvrusvalvrcsvalnovrcsvalvrdsvalvrcsvaliso__vrshvalfevrob _a json serial dicom dataset rabbitmq __synthet test data__ made baddicom tool_ mongodbpopul next microservic respons persist dicom tag data mongodb databas instal launch mongodb compa eg cuserstznindappdatalocalmongodbcompasscommunitymongodbcompasscommunityex mongodb instanc blank contain imag dataset least mongo db compass show user databasesimagesdataloadingmongodbcompassatstartpng publish run mongodbpopul make sure copi across sminlogconfig requir esmiservicessrcmicroservicesmicroservicesmongodbpopulatorbinanycpudebugnetcoreappwinx mongodbpopulatorex give follow error expect queue testmongoseriesqueu exist mongodbpopul design read output dicomtagread output also fork relat databas load servic load databas simultan let stick load mongodb alway start relationaldb load mongo collect anyway open defaultyaml exe directori mongodbpopul set queuenam entri mongodbpopulatoropt testidentifiableseriesqueu testidentifiableimagequeu yaml mongodbpopulatoropt seriesqueueconsumeropt queuenam testidentifiableseriesqueu qosprefetchcount autoack fals imagequeueconsumeropt queuenam testidentifiableimagequeu qosprefetchcount autoack fals mongodbflushtim second failedwritelimit _the mongodbpopul section defaultyaml look like this_ run mongodbpopul result follow bootstrapp main call construct host infomongodbpopulatorhosthost logger creat smi log config infomongodbpopulatorhoststart mongodbpopul bootstrapp host construct start aux connect bootstrapp host aux connect start call start infomongodbpopulatorhoststart consum bootstrapp host start bootstrapp exit main infomongodbpopulatorhostconsum success start infomicroservicesmongodbpopulatorexecutionmongodbadapterattempt bulk write document dicomseri infoimagemessageprocessorqueu contain messag write infomicroservicesmongodbpopulatorexecutionmongodbadapterattempt bulk write document dicomimage_ct mongodb instanc new collect image_ct seri queue also fulli drain messag mongo db compass show imag databasesimagesdataloadingmongodbcompassatendpng _mongo db mongodbpopul run_ relationaldb load microservic follow microservic respons load relationaldb anonymis tag data file path downstream cohort creation linkag extract process dicomreprocessor applic respons fetch record mongodb collect queu process rabbitmq publish run dicomreprocessor make sure copi across sminlogconfig requir esmiservicessrcmicroservicesmicroservicesdicomreprocessorbinanycpudebugnetcoreappwinx dicomreprocessorex display follow help prompt error requir option c collectionnam miss usag normal scenario dicomreprocessor collectionnam image_ct add miss paramet name collect load mongodbpopul eg image_ct dicomreprocessorex c image_ct autorun give us error basicreturn exchang testidentifiableimageexchang rout key reprocess replycod no_rout dicomreprocessor design feed imag identifi mongodb number downstream process load relationaldb one end requir rabbitmq exchang handl rout key ie differ destin queue sinc want send messag one queue creat fanout exchang destin creat new fanout exchang destin queue testdicomreprocessorexchang fanout testdicomreprocessorqueu edit defaultyaml set dicomreprocessoropt use new exchang yaml dicomreprocessoropt processingmod imagereprocess reprocessingproduceropt exchangenam testdicomreprocessorexchang maxconfirmattempt give follow success output see imag messag testdicomreprocessorqueu bootstrapp main call construct host infodicomreprocessorhosthost logger creat smi log config infodicomreprocessorhoststart dicomreprocessor infodicomreprocessorhostdocu reprocess testdicomreprocessorexchang vhost rout key reprocess bootstrapp host construct start aux connect bootstrapp host aux connect start call start infosmicommonmongodbmongoqueryparserno queri specifi fetch record collect infomongodbreaderus maxdegreeofparallel infomongodbreaderbatch size unspecifi infomongodbreadersleep ms batch infomongodbreaderstart reprocess oper infomongodbreaderreprocess finish cancel time elaps infodicomreprocessorhosttot messag sent infodicomreprocessorhosttot fail reprocess infodicomreprocessorhostaverag document process per second infomongodbreadercancel run queri infodicomreprocessorhosthost stop call reprocess complet infodicomreprocessorhosthost stop complet bootstrapp host start bootstrapp exit main identifiermapp next compon load identifiermapp job anonymis patientid tag json extract dicomreprocessor chang occur messag rabbit written output queue prepar load relationaldb point origin dicom file disk open chang publish run identifiermapp make sure copi across sminlogconfig requir esmiservicessrcmicroservicesmicroservicesidentifiermapperbinanycpudebugnetcoreappwinx identifiermapperex amongst error messag follow interest bit infosmicommonhelpersmicroserviceobjectfactorysuccess construct type microservicesidentifiermapperexecutionswappersforguididentifierswapp infoidentifiermapperhostcal setup swapper fail construct host systemargumentexcept mappingtablenam contain databaseus sectionmappingt identifiermapp use strategi pattern determin identifi substitut follow implement provid box forguididentifierswapp tablelookupswapp use forguididentifierswapp doesnt requir us creat identiif map front open defaultyaml edit identifiermapperopt set eg yaml identifiermapperopt queuenam testdicomreprocessorqueu qosprefetchcount autoack fals anonimagesproduceropt exchangenam testanonymousimageexchang maxconfirmattempt mappingconnectionstr serverlocalhostsqlexpressintegr securitytrueiniti catalogmappingdatabas mappingdatabasetyp microsoftsqlserv mappingtablenam mappingdatabasemappingt timeoutinsecond swapcolumnnam patientid replacementcolumnnam guidpatientid swappertyp microservicesidentifiermapperexecutionswappersforguididentifierswapp allowregexmatch fals make sure queuenam set output queue dicomreprocessor eg testdicomreprocessorqueu mappingconnectionstr correct sql server instanc creat output exchang queue testanonymousimageexchang testanonymousimagequeu run identifiermapp new yaml set complet written messag output queue testanonymousimagequeu bootstrapp main call construct host infoidentifiermapperhosthost logger creat smi log config infoidentifiermapperhoststart identifiermapp infoidentifiermapperhostnot pass swapper creat one type microservicesidentifiermapperexecutionswappersforguididentifierswapp infosmicommonhelpersmicroserviceobjectfactorysuccess construct type microservicesidentifiermapperexecutionswappersforguididentifierswapp infoidentifiermapperhostcal setup swapper infomicroservicesidentifiermapperexecutionswappersforguididentifierswapperguid map tabl exist creat infomicroservicesidentifiermapperexecutionswappersforguididentifierswapperguid map tabl exist mappingt infomicroservicesidentifiermapperexecutionswappersforguididentifierswappercheck column patientid infomicroservicesidentifiermapperexecutionswappersforguididentifierswappercheck column guidpatientid bootstrapp host construct start aux connect bootstrapp host aux connect start call start bootstrapp host start bootstrapp exit main look sql server databas see persist record anonmis map ensur patient consist identifi time alias gener sql server tabl contain map identifiersimagesdataloadingsqlserveridentifiermappermappingtablepng notic patientid primari key column prevent alias ever form multipl swapper execut parallel without risk alias eg due race condit lookup perform singl atom transact select exist insert peek messag testanonymousimagequeu see new patientid tag valu exchang testanonymousimageexchang timestamp delivery_mod header messageguid cbfeebadbdabcbec originalpublishtimestamp parent bfdfbafadaadaceedfabecbfaedfeeccbedddfeba producerexecutablenam identifiermapp producerprocessid content_encod utf content_typ applicationjson payload byte encod string dicomfilepathtestdicomsdcmstudyinstanceuidseriesinstanceuidsopinstanceuiddicomdatasetvrcsvaloriginalprimaryaxialvruivalvruivalvrdavalvrdavalvrdavalvrtmvalvrtmvalvrtmvalvrcsvalctvrcsvalctvrlovalct headvrpnvaltommi moorevrlovalffeadcfbfevrdavalvrasvalyvrlov tulloch court arbroath east lunan angu dd ruvrdsvrdsvalvrdsvrisvalvrisvalvrisvalvrisvalvrfdvalvrflvaldvruivalevruivalvrisvalvrisvalvrdsvalvrdsvrisvalvrisvalvrusvalvrcsvrusvalvrisvalvrusvalvrusvalvrdsvalvrusvalvrusvalvrusvalvrusvalvrcsvalnovrcsvalvrdsvalvrcsvaliso__vrshvalfevrob critic section json vrlovalffeadcfbf patientid tag dicom see valu guid assign swapper dicomrelationalmapp dicomrelationalmapp respons load relationaldb json serial dicom imag rabbitmq input queue load research readi relat databas without introduc duplic complic highli depend user requir eg desir tabl schema aggregatecomput column etc ensur maximum flexibl dicomrelationalmapp wrap rdmp data load engin use rdmpdicom plugin instal rdmp order set data load run need instal rdmp done window client follow instruct rdmp user manual altern use command line clienthttpsgithubcomhicservicesrdmpreleas download unzip latest cli packag oper system eg rdmpcliwinxzip run instal command need use sql authent use u p flag rdmpex instal localhostsqlexpress test_ creat databas requir rdmp run includ run data load rdmp platform databas instal localhost sql serverimagesdataloadingrdmpplatformdatabasespng edit databasesyaml rdmp cli directori connect string correct server eg yaml catalogueconnectionstr serverlocalhostsqlexpressdatabasetest_cataloguetrusted_connectiontru dataexportconnectionstr serverlocalhostsqlexpressdatabasetest_dataexporttrusted_connectiontru next download latest rdmpdicom plugin version compat rdmp binari see releas note plugin version compat exampl rdmpdicomnupkghttpsgithubcomhicservicesrdmpdicomreleasestagv add plugin rdmp cli pack command window clienthttpsgithubcomhicservicesrdmpblobdevelopdocumentationcodetutorialsimagesaddplugincontextmenupng rdmp pack file cuserstzninddownloadsrdmpdicomnupkg find command createnewimagingdatasetsuit list run rdmp cmd listsupportedcommand confirm rdmp rdmpdicom plugin correctli instal dont see command tri run logstartup see error pick schema relationaldb schema want dbm support rdmp dicomrelationalmapp load tabl configur popul column name dicom tag eg patientid studyd seriesd etc defin singl larg tabl tabl differ level granular eg studi seri imag uniqu record load ie studi tabl would contain entri per studi per imag rampant duplic schema defin yaml number exist templateshttpsgithubcomhicservicesdicomtypetranslationtreemastertempl pick altern build use dicom templat builder download ctithttpsrawgithubusercontentcomhicservicesdicomtypetranslationmastertemplatesctit templat copi content yaml validatorhttpwwwyamllintcom ensur problem leadingtrail whitespac etc download build load pick schema need run createnewimagingdatasetsuit command rdmp done window clienthttpsgithubcomhicservicesrdmpdicomblobdevelopdocumentationdataloadmd altern run rdmp consol gui rdmp gui press f access menu select r run locat createnewimagingdatasetsuit command run creat suit command list rdmp guiimagesdataloadingrdmpguicreatesuitepng enter serverdatabas name want tabl creat __make sure select creat database__ databas alreadi exist creat target databas rdmp guiimagesdataloadingrdmpguicreatedatabasepng select project directori directori disk must exist load script ad later rdmp load requir load folder regardless whether actual use select dicomdatasetcollectionsourc dicomsourcetyp enter ct_ prompt tabl prefix select ctit templat file prompt pick templat file rdmp guiimagesdataloadingrdmpguitemplatefilepng enter ye persistentraw allow parallel load enter ye createload run refresh f refresh f open tree f tree search loadmetadata load creat rdmp guiimagesdataloadingrdmpguiopentreepng select smi imag load ct show oper creat load load creat rdmp gui detailimagesdataloadingrdmpguiloadcreatedpng take note id load case see search open load check load exit f quit q run command line check rdmp dle l command check sql server see tabl archiv tabl match templat imag tabl archiv tablesimagesdataloadingrdmpalldatabasespng dicomrelationalmapp continu publish run dicomrelationalmapp make sure copi across sminlogconfig requir valid load configur rdmp refer defaultyaml need set connect string rdmp databas yaml rdmpoption catalogueconnectionstr serverlocalhostsqlexpressintegr securitytruedatabasetest_catalogu dataexportconnectionstr serverlocalhostsqlexpressintegr securitytruedatabasetest_dataexport next set id load creat eg also make sure set minimumbatchs yaml dicomrelationalmapperopt guid ffaffcedbc queuenam testanonymousimagequeu qosprefetchcount autoack fals loadmetadataid databasenamertyp guiddatabasenam minimumbatchs useinsertintoforrawmigr true retryonfailurecount retrydelayinsecond runcheck true run dicomrelationalmapp eg esmiservicessrcmicroservicesmicroservicesdicomrelationalmapperbinanycpudebugnetcoreappwinx dicomrelationalmapperex finish execut produc copiou log see entri along line infomicroservicesdicomrelationalmapperexecutionparalleldlehostmigr tabl imagingdbdboct_imaget stage imagingdb insert updat _success load imag relat databas imag ran two batch sequenc one _ live tabl follow rough equivel final state studi level tagsimagesdataloadingfinalstudytablepng _final live studi tabl contain aggreg tag data studi level_ final state imag levelimagesdataloadingfinalimagetablepng _final live imag tabl contain entri image_ notic column relativefilearchiveuri contain imag path origin load testdicomsdcm testdicomsdcm testdicomsdcm testdicomsdcm testdicomsdcm sminlogconfig dataloggingsminlogconfig baddicom httpsgithubcomhicservicesbadmedicinedicomreleas mongodb mongodb relationaldb relationaldb mongodbpopul mongodbpopul dicomreprocessor dicomreprocessor patientid httpsdicominnoliticscomciodsrtplanpati strategi pattern httpsenwikipediaorgwikistrategy_pattern forguididentifierswapp srcmicroservicesmicroservicesidentifiermapperexecutionswappersforguididentifierswapperc tablelookupswapp srcmicroservicesmicroservicesidentifiermapperexecutionswapperstablelookupswapperc rdmp httpsgithubcomhicservicesrdmp rdmpdicom httpsgithubcomhicservicesrdmpdicom rdmp user manual httpsgithubcomhicservicesrdmpresearchdatamanagementplatform dbm httpsgithubcomhicservicesrdmpblobdevelopdocumentationcodetutorialsglossarymddbm dicom templat builder httpsgithubcomhicservicesdicomtemplatebuild note copi rough spec document last updat imag extract flag refactor __version __ initi dataset publish ct imag imagetyp like originalprimari copi intern catalogu initi method control imag valid extract import howev research inform data includ exclud cohort gener also disabl certain imag extract due dodgi corrupt data document describ propos chang catalogu schema extract process allow also includ chang bugfix discov test metadata catalogu chang imag file tabl discuss deal manag separ tabl modal gener idea singl tabl contain dicom file path inform relat specif file rather piec metadata use store flag specif imag deem extract schema might look someth like sopinstanceuid varchar null primari key relativefilearchiveuri varchar null extractableflag bit default true extractablereason text default null case imag load extract pipelin previous mark extract flag remain unset reset default wont need also mark imag extract mongodb way aid rc team could also add extract flag seriesstudi level would indic everi imag seri seri studi disabl could automat gener part store procedur imag manual disabl extract whitelist rule tabl part definit extract would consist simpl tabl contain rule use determin imag allow extract imag would consid extract result appli rule row dicom tag true row current rule would someth like imagetyp modal like originalprimari eq ct like originalprimari eq mr exact syntax decid exampl given imag would extract match filter imagetyp like originalprimari modal ct imagetyp like originalprimari modal mr would evolv time perform mani rule order rule etc fairli easi deal applic layer easi calcul imag extract databas queri manag ad new column extract chang major softwarerel howev realli creat short extract guid rc use includ valid identifi format permit id request file ie sopinstanceuid imageid note use extract flag cohortextractor extract cohortextractor start load tabl whitelist rule queri catalogu normal return set file path match identifi given messag appli extract rule return data firstli check extractableflag set appli rule load whitelist emit messag extract imag normal also emit audit messag anyth extract record cohortpackag requir messag updat asid would also like refactor output directori format match extractrooteupistudyinstanceuidseriesinstanceuiddcm standard mean need dicom uid matter one use key extract would mean need join across tabl get inform requir extract imag studyseriessopinstanceuid filepath extract info cohortpackag cohortpackag need handl messag dont expect anonymis imag produc abl provid summari number imag requestedextractableextract gener sort report extract reason count audit lso need abl determin extract contain specif imag request