chang log format base keep changeloghttpskeepachangelogcomen project adher semant versioninghttpssemverorgspecvhtml v ad freuddiffractionstaticstructurefactordirect class unstabl use comput static structur factor sk sampl reciproc space vector python support document exampl test pytest use clangformat precommit hook add relat tool section document fix freuddiffractiondiffractionpattern normal chang sk n ad error check r_min r_max argument freuddensityrdf freudlocalityneighborlist freudlocalityneighborqueri freuddensitylocaldens class cmake build system use refer tbb target chang reorgan test static structur factor class move utilhistogramtax utilax use new flake plugin flakeforc lint cython code v ad freuddiffractionstaticstructurefactordeby class unstabl use comput static structur factor sk use deby formula fix updat lambda function captur refer ensur compat c fix boxcontain run linear time onum_point fix compil pass compil optim flag build type releasewithdoc major perf regress sinc v fix upgrad auditwheel cibuildwheel ensur rpath patch properli libfreudso linux wheel v fix ad miss git submodul sourc distribut v ad ad option wrap unwrap make_absolut make_fract method box steinhardt solidliquid class expos raw qlmi array steinhardt class support comput order paramet multipl l chang improv plot diffractionpattern wheel built cibuildwheel fix fixedimprov k valu vector diffractionpattern improv need fix incorrect comput steinhardt averag quantiti affect previou version freud fix document formula steinhardt class fix broken arxiv link bibliographi v ad comput method diffractionpattern class reset argument fix document readthedoc build render v chang neighborlist filter method optim tbb support remov use deprec tbb featur ad new precommit hook black isort pyupgrad test framework use pytest v fix python build window msvc broken due unrecogn cmake compil option fix broken document overrid scikitbuild option rpath linux set correctli find tbb librari global search path box imag calcul return zero imag z valu fix wrong attribut name environmentclusterplot v ad box class method contain determin particl membership box neighborlist class expos num_point num_query_point attribut comput method gaussiandens class valu argument support precommit hook python support chang neighborlist rais valueerror instead runtimeerror provid invalid constructor argument freud build use scikitbuild requir cmake deprec freudordertransl fix sourc distribut includ cython sourc file hexat order paramet unweight normal number neighbor instead symmetri order k particl ij normal vector exclud voronoi neighborlist comput numer stabil reason memori leak makedefaultnlist function neighborlist alloc freed v ad support garnett custom neighborlist creat set point use from_point distanc calcul automat box class method compute_dist compute_all_dist calcul distanc array point queri point hexat comput minkowski structur metric use weightedtru along voronoi neighborlist exampl ad cluster densiti environ order modul modul exampl integr doctest ensur date api spherevoxel class densiti modul comput grid voxel occupi sphere freuddiffractiondiffractionpattern class unstabl use comput diffract pattern chang cython requir depend option cython cpp file remov instanc gaussiandens comput system previous comput system fix histogram bin locat comput numer stabl way improv error handl cubat input paramet pmft properli normal pair correl function tend uniti ideal ga pmftxyt use correct orient point query_point differ gaussiandens gaussian normal system correct remov python longer support python requir v ad neighborqueri object creat neighborlist neighbor sort bond distanc localdescriptor comput take option maximum number neighbor comput particl fix correct calcul neighbor distanc voronoi neighborlist ad finit toler ensur stabil voronoi neighborlist comput v ad box class method center_of_mass center periodicawar center mass shift point center origin chang make_random_box system method longer overwrit numpi global random number gener state face_orient argument pmftxyz renam equiv_orient must provid mx array number symmetr equival particl orient improv document queri mode voronoi class use smarter heurist voro block size result signific perform gain larg system fix from_box method correctli pass user provid dimens from_matrix call correctli recogn ovito datacollect object from_system correct clusterproperti calcul center mass specif system set z posit gsd system from_system pmftxi pmftxyz index queri orient use queri point index instead point index v ad rewrot develop document match convent logic version code fix automat convers system variou data sourc mybind deploy work freud v minor error freudexampl correct v ad abil specifi systemlik object contain box set point comput neighborlist queri argument accept equal foot comput method involv neighbor find via neighbor argument extens new document includ tutori new user refer section crucial topic standard method preprocess argument pair comput new intern managedarray object allow data persist improv index c intern thread storag use standard managedarray object c histogram class standard ndimension bin simplifi write new method upper bound r_max option number neighbor queri lower bound r_min option queri steinhardt support l c bondhistogramcomput class encapsul logic histogrambas method pmft accept quaternion well angl orient clusterproperti comput radiu gyrat gyrat tensor cluster freuddata modul gener exampl particl system option normal rdf use small system plot method neighborqueri box object ad support read system data directli mdanalysi garnett gsd hoomdblu ovito variou valid test chang comput object perform neighbor comput use neighborqueri intern neighborbas comput method accept neighborqueri systemlik object first argument comput object perform neighbor comput loop neighborbond object renam ref_point point point query_point clarifi usag bond vector direction standard comput use alway query_point point standard name variou common paramet across freud search distanc r_max accumul perform comput resetfals array return python persist even comput object destroy resiz array class attribut store c member access via getter wrap python properti code freudcommon move freudutil neighborqueri object requir z point box renam sever box method boxparticlebuff localityperiodicbuff cluster find connect compon neighbor graph cluster cutoff distanc given queri argument refactor renam attribut cluster clusterproperti modul correlationfunct complex input perform necessari conjug valu comput updat gaussiandens constructor accept tupl width instead distinct signatur rdf bin center strictli center bin rdf longer perform parallel accumul cumul count provid perform gain substanti complex code matchenv split separ class differ type comput capabl perform class use vstyle api voronoi class rewritten use voro vastli improv perform correct edg case improv voronoi plot code cubat use standard librari random function instead saru remov repo api sever order paramet standard solidliquid order paramet complet rewritten fix sever bug simplifi c code steinhardt use queri argument pmftxyd renam pmftxi remov unus orient pmftxyz pmftxi pmftxi pmftxyz includ phase space volum coordin implicitli integr one angl pmftxi three angl pmftxyz document use automodul instead autoclass citat includ use bibtex sphinxcontribbibtex fix remov neighbor exclus logic class depend entir local modul comput class requir system check dimension input box linkcel nearest neighbor queri properli check largest distanc found proceed next shell localdens use correct number pointsqueri point rdf longer forc first bin pcf first two bin cumul count steinhardt use threadstorag class properli reset memori need remov freudutil modul python longer support python requir linkcel longer expos intern cell list data structur cubat longer return perparticl tensor constant r tensor v chang localwl return valu real instead complex fix fix miss condonshortley phase affect localwl steinhardt wl comput miss factor caus result thirdord wl steinhardt order paramet incorrect shown lack rotat invari problem introduc v reduc variou compil warn possibl bound linkcel access rdf plot use provid ax object v chang optim perform rotationalautocorrel ad new test case two differ set point fix fix bug result localqlnear localwlnear class wrongli use hard instead soft cutoff may result incorrect number neighbor would caus incorrect result especi system averag nth nearestneighbor distanc smaller rmax problem introduc v fix duplic neighbor found linkcel neighborqueri method correct data localql localwl document exampl repeat cubat order paramet comput use correct number replic repeat call localqlcomputenorm properli reset underli data clarifi document localbondproject msd v ad ad plot method ipythonjupyt png represent mani class attributeerror rais one tri access attribut yet comput ad freudparallelgetnumthread method new exampl integr simul visual workflow chang remov extra c includ speed build c style base clangformat refactor c handl threadloc storag solliq order paramet comput parallel tbb optim perform voronoi sever box properti given numpi array instead tupl box method handl multipl vector parallel tbb eigen use matrix diagon fix call setnumthread work correctli even parallel comput method alreadi call fix segfault chain call neighborqueri api correct exclude_ii logic remov remov outdat computenlist function localdescriptor v ad new neighbor queri api enabl reus queri data structur see neighborqueri class aabbqueri aabb treebas neighbor find ad public api abil dynam select queri method base struct argument comput object __repr__ __str__ method defin neighborlist access array particl indic via __getitem__ particlebuff support differ buffer size x z box makecoordin makefract getimag support array multipl point chang use constant memoryview prevent error readonli input localql parallel tbb optim perform rotationalautocorrel nematicorderparamet use selfadjointeigensolv improv stabil ad build flag cython debug linkcel comput cell neighbor ondemand cach result signific speedup fix correct type y_max argument pmftxyd int float reduc log verbos array convers fix number thread set upon exit numthread context manag correct quaternion array size ad miss default document empti particlebuff return valid array shape concaten wheel built numpi improv backward compat v ad freshli updat readm document homepag move githubhttpsgithubcomglotzerlabfreud new msdmsd class comput meansquar displac new orderrotationalautocorrel class cython memoryview use convert c cython new improv freud logo internalonli aabb tree faster mani larg system api unstabl chang improv modul document especi pmft refactor intern localql relat class upgrad readthedoc configur fix improv cubaticorderparamet handl unus seed fix box error nearestneighbor remov longdeprec method class remov bond modul remov v ad build test window via appveyor though offici unsupport fix multipl userreport issu setuppi resolv c error handl cleanli python except fix bug solliq box paramet document correct neighborlist variou minor compil error window resolv v fix linux wheel push real pypi server instead test server maco deploy pyenv requir patch version specifi v fix error python version maco automat deploy v ad pypi build automat deploy mac linux chang maco deploy target instead ensur tbb compat unwrap posit imag vector minor document fix fix tbb includ alway detect correctli setuppi v ad exampl notebook shown document mani unit test ad new class freudenvironmentlocalbondproject freud avail python packag index pypi freudanalysi chang document revis sever modul new class freudboxparticlebuff adapt previou voronoibuff includ support triclin box bond pmft modul verifi system dimension match coordin system use minor optim array reduc across thread necessari fix numpi array length correctli ducktyp box remov intern use deprec code c code use uint chang unsign int improv compil compat deprec freudlocalitylinkcel computecelllist replac comput remov kspace modul remov v ad codecov track test coverag properti ad matchenv angularsepar cubaticnemat order paramet voronoi chang freud use cython setuppi instead cmake instal properti get function offici way access comput result interfac modul improv significantli densityfloatcf densitycomplexcf order paramet document improv mani comput method use point orient ref_point ref_orient provid reset method renam reset fix kspace modul miss factor pi volum calcul ftsphere deprec get function deprec setter method deprec reduc method call intern userfac method deprec remov gaussiandensityresetdens call intern v ad allow specif rmin localwl previous possibl localql new environ modul contain class split order modul box ducktyp method accept box argument convert boxlik object freudboxbox object pythoncython code valid flake continu integr chang refactor localql localwl steinhardt order paramet matchenv use bimap instead boostbimap boost shared_array replac stdshared_ptr replac boost geometri standard contain brute forc registr code nearestneighbor automat use ref_point point point provid boxunwrap boxwrap return vector updat everyth true order paramet move order modul environ modul use lambda function parallel_for correlationfunct test longer depend nose python unittest use instead vastli improv document clariti correct across modul docstr googl format develop guid offer guidanc modul author fix fix localdescriptor produc nan case fix cython pass c default argument force_res neighborlistres standard freudcommonconvert_array error messag remov boost longer need build run freud remov undocu shapesplit modul remov extra argument transorderparam c v ad allow specif maximum number neighbor use comput localdescriptor chang use default neighbor list localdescriptor requir specifi precomput argument updat improv test clean angularsepar modul document v fix memori issu nlist resolv v ad voronoi neighborlist includ period neighbor voronoi neighborlist comput weight accord facet area box modul expos getimagevec voronoi modul comput return cell volumesarea chang cluster modul support box argument comput method refactor c code reduc extran includ refactor pmft code refactor box modul remov unus method resolv bug kspaceanalyzesfactord deprec box modul getcoordin favor duplic boxmakecoordin remov remov deprec api complexwrdf floatwrdf v ad ad nemat order paramet ad option rmin argument densityrdf ad credit file wrote develop guid ad python interfac box period chang variou bug fix code clean fix compiletim warn ensur pep complianc everywher minim boost depend mani document rewrit wrote develop guid made test determinist seed rng remov deprec box api warn standard numpi usag v ad gener neighbor list interfac set circleci continu integr set document readthedoc ad bumpvers support variou bug fix ad pythonstyl properti access data fix issu voronoi neighbor list v trajectori modul remov box constructor api updat pmftxyz api updat take quaternion face_orient sensibl default valu nearestneighbor overexpand box fix strict rmax mode ad abil get wrap vector ad minor updat capi return full list c addit bond modul addit local environ match v replac boostshared_array stdshared_ptr c move tbb templat class lambda express move trajectorybox boxbox trajectori deprec fix bond order diagram allow global local orient correl ad pythonlevel voronoi calcul fix issu compil os x includ conda python instal ad code comput bond particl variou coordin system v pmft fix issu involv bin angl correctli pmft fix issu r prevent computeaccumul call nonflatten array pmft updat xyz api allow simpler symmetr orient suppli pmft updat pmftxyd api pmft histogram properli normal allow comparison system without need zero system fsph ad librari calcul spheric harmon via cython local descriptor use fsph updat api parallel ad default behavior setnumthread ad context manag v add compil flag c featur ad saru rng specif cubat order paramet avail cubat order paramet rank tensor struct environ matchingclust environ shape awar fourier transform structur factor calcul ad deprec warn use python w check warn ad chang log move document sphinx document improv c wrap move boost cython itercel avail python x pmft xy xyz symmetri api updat r x viz remov compat cython chang log prior v freud contributor agreement term appli contribut freud open sourc project project own manag regent univers michigan michigan set intellectu properti right grant michigan contribut materi contribut behalf compani term also mean compani identifi agre bound term fill inform request provid signatur term contribut mean sourc code object code patch tool sampl graphic specif manual document materi post submit project respect worldwid copyright copyright applic registr contribut herebi assign michigan joint ownership extent assign becom invalid ineffect unenforc herebi grant michigan perpetu irrevoc nonexclus worldwid nocharg royaltyfre unrestrict licens exercis right copyright includ michigan option right sublicens right third parti multipl level sublicense licens arrang agre michigan thing relat contribut us sole owner one us make deriv work contribut one make deriv work made sole owner deriv work agre assert moral right contribut us license transfere agre may regist copyright contribut exercis ownership right associ agre neither us duti consult obtain consent pay render account use distribut contribut respect patent licens without payment third parti herebi grant michigan perpetu irrevoc nonexclus worldwid nocharg royaltyfre licens make made use sell offer sell import otherwis transfer contribut whole part alon combin includ product work materi aris project contribut submit michigan option sublicens right third parti multipl level sublicense licens arrang except set keep right titl interest contribut right grant michigan term effect date first submit contribut michigan even submiss took place date sign term contribut michigan make avail licens also made avail suitabl free softwar foundat open sourc initi approv licens respect contribut repres origin work legal grant right set term best knowledg violat third parti copyright trademark patent intellectu properti right author sign contract behalf compani identifi term govern law state michigan applic us feder law choic law rule appli make contribut electron sign agre term freud contributor agreement bysapnghttpslicensebuttonsnetlbysaxpng base sun contributor agreement version document licens creativ common attributionshar alik unport licens httpscreativecommonsorglicensesbysa contribut welcom via pull request first contact _freud_ develop prior begin work ensur plan mesh well plan develop direct standard set project implement code submit pull request multipl develop andor user review request chang make comment lead develop merg master branch review complet approv featur implement function gener flexibl fashion _freud_ librari provid lot flexibl user pull request provid someth applic varieti usecas one thing might need research speak lead develop write code help make design choic allow flexibl degrad perform exist code path new function activ expens code path request user slow exist code add depend absolut necessari order make _freud_ wide avail possibl tri keep number depend minimum need featur present extern librari follow follow step add _freud_ simpl modul would benefit exampl ad simpl tensor math cubat order paramet add via submodul code exist extern exampl _fsph_ spheric harmon contact _freud_ develop inquir librari youd like depend fit overal designgo _freud_ version control base work correct branch use oneflowhttpswwwendoflineblogcomoneflowagitbranchingmodelandworkflow model develop new featur bug fix develop branch base master hotfix critic bug need releas fast develop branch base latest tag releas propos singl set relat chang chang propos singl topic branch pull request relat dont propos mani chang review becom challeng multipl new featur loos coupl complet separ topic branch ok branch featur base featur long made clear featur merg review featur better merg featur featur temporari integr branch test keep chang minimum avoid whitespac chang use separ pull request propos fix spell grammar etc agre contributor agreement contributor must agre contributor agreement contributoragreementmdcontributoragreementmd pull request merg sourc code use consist style import consist style throughout sourc code follow sourc convent defin document code document code comment add comment code develop understand compil without warn chang compil without warn test write unit test new function _freud_ test automat unit test execut second specif test requir long amount time pleas alert _freud_ develop requir test optedout regular unittest high level featur test python python test attempt cover option user select valid test addit unit test develop run researchscal analysi use new function ensur behav intend user document write user document user document user face script command document docstr googl formathttpssphinxcontribnapoleonreadthedocsioenlatestexample_googlehtml includ exampl use new function add develop credit develop need credit work updat credit documentationdocsourcereferencecreditsrst refer develop contribut code updat chang log add short concis entri describ chang changelogmdchangelogmd lennardjon sampl data script ljpi gener sampl gsd dcd file use hoomdblu data gener use hoomd steinhardt averag order paramet valid data file folder come robin van damm collabor permiss two refer code repositoryhttpsgithubcomarvdeeminkowskistructuremetricscalcul anoth implement label gc use comput steinhardt order paramet minkowski structur metric valid data file folder come repositoryhttpsgithubcomarvdeeminkowskistructuremetricscalculatortreemastertestlattic work robin van damm data descript averag nonaverag output minkowski structur metric match steinhardt bond order paramet simpl cubic sc facecent cubic fcc hexagon closepack hcp lattic whose valu report tabl ref bcc match steinhardt case definit neighbour differ two two refer valu minkowski structur metric bcc lattic report ref section iic lattic file use either unit cell larg lattic either dat gsd format provid result mickel et al doi dietz et al doi physrev licens mit licens copyright c van damm r robin permiss herebi grant free charg person obtain copi softwar associ document file softwar deal softwar without restrict includ without limit right use copi modifi merg publish distribut sublicens andor sell copi softwar permit person softwar furnish subject follow condit copyright notic permiss notic shall includ copi substanti portion softwar softwar provid without warranti kind express impli includ limit warranti merchant fit particular purpos noninfring event shall author copyright holder liabl claim damag liabil whether action contract tort otherwis aris connect softwar use deal softwar provid gener summari chang titl descript describ chang detail motiv context chang requir problem solv replac issu number pull request resolv applic resolv test pleas describ detail test chang includ detail test environ test ran see chang affect area code etc screenshot appropri type chang type chang code introduc put x box appli bug fix nonbreak chang fix issu new featur nonbreak chang add improv function break chang fix featur would caus exist function chang document improv updat user guid docstr develop doc checklist put x box appli your unsur dont hesit ask help read contributinghttpsgithubcomglotzerlabfreudblobmastercontributingmd document code follow code style project updat document relev ad test cover chang relev new exist test pass updat creditshttpsgithubcomglotzerlabfreudblobmasterdocsourcereferencecreditsrst updat changeloghttpsgithubcomglotzerlabfreudblobmasterchangelogmd name featur request suggest idea project titl label assigne featur request relat problem pleas describ clear concis descript problem ex im alway frustrat describ solut youd like clear concis descript want happen describ altern youv consid clear concis descript altern solut featur youv consid addit context add context screenshot featur request name bug report creat report help us improv titl label assigne describ bug clear concis descript bug expect happen reproduc step reproduc behavior start system box particl like creat analysi method call function see error error output applic add termin output screenshot help explain problem system configur pleas complet follow inform os eg maco version python eg version freud eg addit context add context problem lockfre parallel disjoint set data structur small selfcontain c implement unionfind data structur path compress union rank extra support concurr find unit call describ paper waitfre parallel algorithm unionfind problem richard j anderson heather woll addit class support optimist lock try_lockunlock disjoint set combin uniteunlock oper pair set freud cite freud pypi condaforg readthedoc binder githubstar cite freud imag httpsimgshieldsiobadgecitefreudinformationalsvg target httpsfreudreadthedocsioenstablereferencecitinghtml pypi imag httpsimgshieldsiopypivfreudanalysissvg target httpspypiorgprojectfreudanalysi condaforg imag httpsimgshieldsiocondavncondaforgefreudsvg target httpsanacondaorgcondaforgefreud readthedoc imag httpsreadthedocsorgprojectsfreudbadgeversionlatest target httpsfreudreadthedocsioenlatestbadgelatest binder imag httpsmybinderorgbadge_logosvg target httpsmybinderorgvghglotzerlabfreudexamplesmasterfilepathindexipynb githubstar imag httpsimgshieldsiogithubstarsglotzerlabfreudsvgstylesoci target httpsgithubcomglotzerlabfreud overview freud python librari provid simpl flexibl power set tool analyz trajectori obtain molecular dynam mont carlo simul high perform parallel c use comput standard tool radial distribut function correl function order paramet cluster well origin analysi method includ potenti mean forc torqu pmft local environ match freud librari support mani input format httpsfreudreadthedocsioenstabletopicsdatainputshtml__ output numpi array httpsnumpyorg__ enabl integr scientif python ecosystem mani typic materi scienc workflow resourc refer document httpsfreudreadthedocsio__ exampl tutori topic guid packag python api instal guid httpsfreudreadthedocsioenstablegettingstartedinstallationhtml__ instruct instal compil freud freudus googl group httpsgroupsgooglecomdforumfreudusers__ ask question freud user commun github repositori httpsgithubcomglotzerlabfreud__ download freud sourc code issu tracker httpsgithubcomglotzerlabfreudissues__ report issu request featur relat tool hoomdblu httpshoomdbluereadthedocsio__ perform md mc simul analyz freud signac httpssignacio__ manag workflow signac citat use freud process data public pleas use citat httpsfreudreadthedocsioenstablereferencecitinghtml__ instal easiest way instal freud use pip code bash pip instal freudanalysi conda code bash conda instal c condaforg freud freud also avail via contain docker httpshubdockercomrglotzerlabsoftware__ singular httpsglotzerlabenginumichedudownloadsglotzerlab__ need detail inform wish instal freud sourc pleas refer instal guid httpsfreudreadthedocsioenstablegettingstartedinstallationhtml__ compil freud sourc exampl freud librari call use python script mani core featur demonstr freud document httpsfreudreadthedocsioenstableexampleshtml_ exampl come form jupyt notebook also download freud exampl repositori httpsgithubcomglotzerlabfreudexamples_ launch interact binder httpsmybinderorgvghglotzerlabfreudexamplesmasterfilepathindexipynb_ sampl script comput radial distribut function simul run hoomdblu httpshoomdbluereadthedocsio__ save gsd file httpsgsdreadthedocsio_ code python import freud import gsdhoomd creat freud comput object rdf canon exampl rdf freuddensityrdfbin r_max load gsd trajectori see doc format traj gsdhoomdopentrajectorygsd rb frame traj rdfcomputesystemfram resetfals get bin center rdf data attribut r rdfbin_cent rdfrdf support contribut pleas visit repositori github httpsgithubcomglotzerlabfreud__ librari sourc code issu bug may report issu tracker httpsgithubcomglotzerlabfreudissues__ question discuss direct user forum httpsgroupsgooglecomforumforumfreudusers__ contribut freud welcom via pull request includ readmerst tabl content toctre maxdepth caption get start gettingstartedintroduct gettingstartedinstal gettingstartedquickstart gettingstartedtutori gettingstartedexampl toctre maxdepth caption topic guid topicsqueri topicsoptim topicsdatainput toctre maxdepth caption api modulesbox modulesclust modulesdata modulesdens modulesdiffract modulesenviron modulesinterfac modulesloc modulesmsd modulesord modulesparallel modulespmft toctre maxdepth caption refer referencedevelop referencecit referencezrefer referencelicens referencecredit indic tabl refgenindex refmodindex refsearch cluster modul rubric overview autosummari nosignatur freudclusterclust freudclusterclusterproperti rubric detail automodul freudclust synopsi find cluster point member densiti modul rubric overview autosummari nosignatur freuddensitycorrelationfunct freuddensitygaussiandens freuddensitylocaldens freuddensityrdf freuddensityspherevoxel rubric detail automodul freuddens synopsi analyz system densiti member pmft modul rubric overview autosummari nosignatur freudpmftpmftr freudpmftpmftxyt freudpmftpmftxi freudpmftpmftxyz rubric detail automodul freudpmft synopsi comput potenti mean forc torqu member diffract modul rubric overview autosummari nosignatur freuddiffractiondiffractionpattern freuddiffractionstaticstructurefactordeby freuddiffractionstaticstructurefactordirect rubric detail automodul freuddiffract synopsi analyz diffract pattern structur factor member _environ environ modul rubric overview autosummari nosignatur freudenvironmentbondord freudenvironmentlocaldescriptor freudenvironmentenvironmentclust freudenvironmentenvironmentmotifmatch freudenvironmentangularseparationglob freudenvironmentangularseparationneighbor freudenvironmentlocalbondproject rubric detail automodul freudenviron synopsi analyz local particl environ member order modul rubric overview autosummari nosignatur freudordercubat freudordernemat freudorderhexat freudordertransl freudordersteinhardt freudordersolidliquid freudorderrotationalautocorrel rubric detail automodul freudord synopsi comput order paramet member msd modul rubric overview autosummari nosignatur freudmsdmsd rubric detail automodul freudmsd synopsi comput mean squar displac member data modul rubric overview autosummari nosignatur freuddataunitcel freuddatamake_random_system rubric detail automodul freuddata synopsi util function gener standard type system point member box modul rubric overview autosummari nosignatur freudboxbox rubric detail automodul freudbox synopsi repres period box member parallel modul rubric overview autosummari nosignatur freudparallelnumthread freudparallelget_num_thread freudparallelset_num_thread rubric detail automodul freudparallel synopsi manag tbb thread usag member interfac modul rubric overview autosummari nosignatur freudinterfaceinterfac rubric detail automodul freudinterfac synopsi measur interfac member local modul rubric overview autosummari nosignatur freudlocalityaabbqueri freudlocalitylinkcel freudlocalityneighborlist freudlocalityneighborqueri freudlocalityneighborqueryresult freudlocalityperiodicbuff freudlocalityvoronoi rubric detail automodul freudloc synopsi data structur find neighbor point member _exampl exampl exampl provid jupyt httpsjupyterorg_ notebook separ freudexampl httpsgithubcomglotzerlabfreudexamples_ repositori notebook may launch interact binder httpsmybinderorgvghglotzerlabfreudexamplesmasterfilepathindexipynb_ download run system visual data done via matplotlib httpsmatplotliborg_ bokeh httpsbokehpydataorg_ unless otherwis note key concept critic concept algorithm data structur central freud classfreudboxbox class defin concept period simul box modfreudloc modul defin method find nearest neighbor particl sinc use throughout freud recommend read reftutori first delv work specif freud analysi modul toctre maxdepth glob examplesmodule_introsbox examplesmodule_introsloc analysi modul introductori exampl showcas function specif modul freud show use perform specif type analys simul toctre maxdepth glob examplesmodule_introsclust examplesmodule_introsdens examplesmodule_introsdiffract examplesmodule_introsenviron examplesmodule_introsinterfac examplesmodule_introsord examplesmodule_introspmft exampl analys exampl go greater detail specif applic freud use case analysi method enabl userdefin analys machin learn data visual toctre maxdepth glob examplesexamplesnetworkxcna examplesexampleshoomdmcwhoomdmcw examplesexamplesgromacsmdtrajwaterrdfcompute_rdf examplesexampleslammpsljmsdlammpsljmsd examplesexamplesus machin learn structur identif examplesexampleshandl multipl particl type ab bond examplesexamplescalcul rdf gsd file examplesexamplescalcul strain via voxel examplesexamplesvisu fresnel examplesexamplesvisu plato examplesexamplesvisu voronoi voxel benchmark perform central consider freud benchmark compar freud tool offer similar analysi method toctre maxdepth glob examplesexamplesbenchmark introduct freud librari python packag analyz particl simul packag design directli use numer array data make easi use wide rang usecas common usecas freud comput quantiti molecular dynam simul trajectori use analyz type particl simul oper directli numer array data freud allow user pars custom simul output suitabl structur input rather reli specif file type data structur core freud analysi period system repres classfreudboxbox class classfreudboxbox support arbitrari triclin system maximum flexibl use throughout packag ensur consist treatment system packag mani method encapsul variou comput class perform comput popul class attribut access particular note variou comput base nearest neighbor find order character particl environ method simplifi acceler central neighbor find interfac defin classfreudlocalityneighborqueri famili class modfreudloc modul freud _quickstart quickstart guid instal freud installationrst_ start use freud simul data hand exampl well assum run simul use hoomdblu httpsglotzerlabenginumicheduhoomdblue_ use classhoomddumpgsd command output trajectori file trajectorygsd gsd file format httpsgsdreadthedocsioenstable_ provid conveni python file reader offer access data form numpi array make immedi suitabl calcul freud mani file reader data format support see refdatainput full list exampl start read data numpi array codeblock python import gsdhoomd traj gsdhoomdopentrajectorygsd rb immedi calcul import quantiti comput radial distribut function mathgr use classfreuddensityrdf comput class sinc radial distribut function practic comput histogram must specifi histogram bin width largest interparticl distanc includ calcul simpli instanti class appropri paramet perform comput given data codeblock python import freud rdf freuddensityrdfbin r_max rdfcomputesystemtraj access data properti rdf object codeblock python r rdfbin_cent rdfrdf mani class freud nativ support plot data use matplotlib httpsmatplotliborg codeblock python import matplotlib plt fig ax pltsubplot rdfplotaxax note exampl comput mathgr use final frame simul trajectori traj howev mani case radial distribut similar quantiti may noisi simul due natur fluctuat present gener interest timeaverag quantiti system equilibr perform calcul easili modifi origin calcul take advantag freud accumul featur accumul add argument resetfals support comput object histogramlik comput assum method identifi frame wish includ sampl origin code snippet would modifi follow codeblock python import freud rdf freuddensityrdfbin r_max frame traj rdfcomputefram resetfals access data exactli previous that youv seen brief exampl read data comput radial distribut function your readi learn youd like complet walkthrough pleas see reftutori tutori walk mani core concept freud greater detail start basic simul system analyz describ detail neighbor find logic freud see specif featur freud action look refexampl detail document specif class function found api document modules_ _tutori tutori tutori provid complet introduct freud rather attempt touch featur freud focus common core concept help understand freud work data expos comput user tutori begin introduc fundament concept period system implement freud concept comput class consitut primari api perform calcul freud tutori discuss common calcul perform freud find neighbor point period system packag neighbor find tool tune high perform neighbor find enabl calcul freud typic involv character local environ point way next part tutori discuss role histogram freud focus common featur properti histogram share final tutori includ complet demonstr use freud provid reason templat use almost featur freud toctre maxdepth tutorialperiodicrst tutorialcomputeclassrst tutorialneighborfind tutorialpaircomputerst _instal instal instal freud freud librari instal via conda httpscondaioprojectsconda_ pip compil sourc instal via conda code instal freud condaforg httpsanacondaorgcondaforgefreud_ codeblock bash conda instal c condaforg freud instal via pip code instal freud pypi httpspypiorgprojectfreudanalysis_ codeblock bash pip instal freudanalysi compil sourc follow requir instal freud ccompliant compil python httpswwwpythonorg__ numpi httpswwwnumpyorg__ intel thread build block httpswwwthreadingbuildingblocksorg__ r cython httpscythonorg__ scikitbuild httpsscikitbuildreadthedocsio__ cmake httpscmakeorg__ note depend gener use may requir newer version cmake particular visual studio requir cmake inform specif gener see cmake gener document httpscmakeorgcmakehelpgitstagemanualcmakegeneratorshtml__ freud librari use scikitbuild cmake handl build process requir requir compil code freud requir met instal follow packag condaforg channel httpscondaforgeorg__ codeblock bash conda instal c condaforg tbb tbbdevel numpi cython scikitbuild cmake requir tbb also instal via python packag index httpspypiorg__ codeblock bash pip instal numpi cython scikitbuild cmake wheel tbb tbbdevel exist pypi certain oper system mileag may vari nonconda user recommend use osspecif packag manag eg homebrew httpsbrewsh__ mac instal tbb snippet may necessari instal tbb devel packag order get header share librari code follow build freud instal user append user wish instal user site directori codeblock bash git clone recursesubmodul httpsgithubcomglotzerlabfreudgit cd freud python setuppi instal also build freud place run within folder codeblock bash run test test directori python setuppi build_ext inplac build freud place certain advantag sinc affect python behavior except within freud directori freud import build cmake option scikitbuild tool allow setuppi accept three differ set option separ set provid directli scikitbuild cmake code gener choic respect exampl command python setuppi build_ext inplac dcoverageon g ninja j tell scikitbuild perform inplac build tell cmake turn coverag option use ninja compil tell ninja compil parallel thread inform option see scikitbuild doc scikitbuildreadthedocsio__ note default cmake build configur freud releasewithdoc standard build configur like releas relwithdebinfo instal setuppi assum buildtypereleasewithdoc default build type specifi use build configur workaround issu httpsgithubcomscikitbuildscikitbuildissues__ scikitbuild cython embed docstr addit standard cmake flag follow cmake option avail freud glossari coverag build cython file coverag support check unit test coverag freud cmake configur also respect follow environ variabl addit standard like ld_library_path glossari tbbroot root directori tbb instal use tbb instal nonstandard locat locat reason variabl set tbbvarssh script includ tbb build sourc tbb_include_dir directori tbb header eg tbbh locat use tbb instal nonstandard locat locat reason note freud make use git submodul manual updat git submodul execut codeblock bash git submodul updat init recurs unit test unit test freud includ repositori configur run use python modpytest librari codeblock bash run test test directori cd test python pytest note freud design requir instal run ie run directli build directori import freud root repositori fail tri import packag folder result unit test must run outsid root directori wish test instal version freud want run test within root directori instead build freud place codeblock bash run test test directori python setuppi build_ext inplac build place necessari file alongsid freud sourc file freud import root repositori document document freud host onlin readthedoc httpsfreudreadthedocsio_ may also build document build document follow requir build freud document sphinx httpwwwsphinxdocorg_ read doc sphinx theme httpssphinxrtdthemereadthedocsio_ nbsphinx httpsnbsphinxreadthedocsio_ jupyter_sphinx httpsjupytersphinxreadthedocsio_ sphinxcontribbibtex httpssphinxcontribbibtexreadthedocsio_ instal depend use conda codeblock bash conda instal c condaforg sphinx sphinx_rtd_them nbsphinx jupyter_sphinx sphinxcontribbibtex pip codeblock bash pip instal sphinx sphinxrtdthem nbsphinx jupytersphinx sphinxcontribbibtex build document run follow command sourc directori codeblock bash cd doc make html open buildhtmlindexhtml build pdf document requir latex andor pdflatex codeblock bash cd doc make latexpdf open buildlatexfreudpdf _paircomput pair comput comput freud depend bond exampl classfreuddensitygaussiandens creat continu equival system point place normal distribut point locat smear posit sum valu distribut set fix grid point calcul quit use allow applic variou analysi tool like fast fourier transform requir regular grid purpos tutori howev import class exampl calcul neighbor unimport calcul perform perpoint basi much common pattern freud though calcul involv local neighborhood point support effici flexibl comput quantiti variou comput class essenti expos api queri interfac demonstr previou section paircomput class design mirror queri function freud close possibl exampl let consid classfreuddensitylocaldens calcul densiti point local neighborhood point adapt code previou section neighborfinding_ simplest usag class would follow codeblock python import numpi np import freud l num_point point nprandomrandnum_pointsl l box freudboxboxcubel r_max specifi far search around point neighbor r_max system point repres instanc particl specif size diamet use add fraction volum neighbor would overlap sphere radiu r_max around point diamet ld freuddensitylocaldensityr_max diamet ldcomputesystembox point access densiti lddensiti use exampl system weve work far weve calcul estim number point neighborhood point sinc alreadi told comput far search neighbor base r_max pass classtupl box point comput indic point locat binari system imagin instead singl set point actual two differ type point interest find densiti one set point vicin case could modifi calcul follow codeblock python import numpi np import freud l num_point point nprandomrandnum_pointsl l query_point nprandomrandnum_pointsl l r_max diamet ld freuddensitylocaldensityr_max diamet ldcomputesystembox point query_pointsquery_point access densiti lddensiti choic name name suggest exactli calcul intern classfreuddensitylocaldens search point within cutoff distanc r_max everi query_point essenti use queri interfac introduc previous use calcul lddensiti note mean lddensiti contain densiti everi query_point ie length moreov recal one featur queri api specif whether count particl neighbor paircomput class attempt make intellig determin pass second set query_point assum comput singl set point automat exclud selfneighbor otherwis neighbor includ far includ point within fix radiu howev one might instead wish consid densiti shell densiti distanc unit away address need could simpli adapt call comput follow codeblock python ldcomputesystembox point query_pointsquery_point neighborsdictr_max r_min neighbor argument paircomput class allow user specifi arbitari queri argument make possibl easili modifi freud calcul onthefli neighbor argument actual gener queri argument youv seen far queri argument precis enough specifi exact set neighbor want comput instead provid classneighborlist freudlocalityneighborlist directli codeblock python ldcomputesystembox point query_pointsquery_point neighborsnlist featur allow user essenti arbitrari flexibl specifi bond includ bondbas comput common usecas construct classneighborlist freudlocalityneighborlist use classfreudlocalityvoronoi voronoi construct provid power altern method defin neighbor relationship improv accuraci robust certain calcul freud may notic last exampl argument specifi use keyword argument previou exampl attempt show query_point argument defin second set point use perform calcul binari system neighbor argument user specifi neighbor consid calcul system argument point specifi classtupl box point howev dont use tupl instead pass classfreudlocalityneighborqueri central class freud queri infrastructur fact youv alreadi seen exampl classfreudlocalityneighborqueri classfreudlocalityaabbqueri object origin use find neighbor also number input type convert via methfreudlocalityneighborqueryfrom_system see also refdatainput sinc object contain classfreudboxbox set point directli pass comput codeblock python aq freudlocalityaabbquerybox point ldcomputesystemaq query_pointsquery_point neighborsnlist inform might want use classfreudlocalityneighborqueri object instead tupl see refoptim consid way simplifi call mani freud comput one script store box point anoth object youv cover import inform need use freud recap weve discuss freud handl period boundari condit structur usag comput class method find perform calcul pair neighbor detail inform specif method freud see refexampl page look api document specif modul _computeclass comput class calcul freud built around concept comput class python object encod given method expos comput method gener method oper system compos triclin box numpi array particl posit box provid object interpret freud box demonstr exampl look classfreudorderhexat order paramet calcul exampl codeblock python import freud posit read posit trajectori file op freudorderhexatick opcomput systemlx ly dimens posit neighborsdictr_max plot valu order paramet matplotlib import pyplot plt plthistnpabsoluteopparticle_ord calcul hexat order paramet use matplotlib plot classfreudorderhexat class constructor accept singl argument codek repres period calcul your unfamiliar order paramet import piec inform mani comput method freud requir paramet provid comput class construct calcul order paramet call methcomput freudorderhexaticcomput take two argument classtupl box point classdict first focu first argument box object coerc classfreudboxbox describ previou section case use dictionari specifi squar dimension box point must anyth coerc dimension numpi array shape coden gener point may provid anyth interpret mathntim list posit detail valid input see funcnumpyasarray note hexat order paramet design twodimension system point must provid form x ie zcompon must well go detail box point tupl soon paircompute_ suffici think specifi system point want work let return neighbor argument comput dictionari use determin particl neighbor use mani comput freud hexat order paramet involv bond system exampl averag length bond averag number bond given point howev concept bond suffici variabl differ calcul instanc point consid bond within certain distanc everi point consid bond fix number point accommod variabl freud offer gener framework bond specifi well go detail next section neighborfinding_ exampl weve simpli inform classhexat freudorderhexat class want defin bond pair particl less distanc unit apart access comput order paramet opparticle_ord use funcnpabsolut output complex number want see magnitud access comput properti gener comput class expos calcul use properti httpsdocspythonorglibraryfunctionshtmlproperty_ paramet comput object eg codek exampl typic access soon object construct codeblock python op freudorderhexatick opk comput quantiti also access similar manner comput method call exampl codeblock python op freudorderhexatick rais except opparticle_ord opcomput systemlx ly dimens posit neighborsdictr_max access opparticle_ord note freud comput class python wrapper around highperform implement c result none data comput actual store python object instead python object store instanc c object actual own data perform calcul return comput quantiti user python properti provid nice way hide logic python code involv line comput object use mani time calcul quantiti recent calcul output access properti need perform seri calcul save data also easili codeblock python recal list length automat convert freud box box op freudorderhexatick assum list nx numpi array repres simul trajectori loop calcul order paramet valu sequenc trajectori read trajectori file list posit frame hexatic_valu point trajectori opcomputesystembox point neighborsdictr_max hexatic_valuesappendopparticle_ord make use freud simpl possibl comput class design return self comput call featur enabl concis methodchain idiom freud comput properti access immedi codeblock python particle_ord freudorderhexatickcomput systembox pointsparticle_ord _pbc period boundari condit central goal freud analysi simul perform period box period boundari condit ubiquit simul permit simul quasiinfinit system minim comput effort long simul system suffici larg ie assum point system experi correl length scale substanti smaller system length scale period boundari condit ensur system appear effect infinit point order consist defin geometri simul system period boundari freud defin classfreudboxbox class class encapsul concept triclin simul box righthand coordin system triclin box defin parallelepip threedimension polyhedra everi face parallelogram gener box repres three distinct linearli independ box vector enforc requir righthanded guarante box repres matrix form math nowrap begineqnarray mathbfh leftbeginarrayccc l_x xy l_i xz l_z l_i yz l_z l_z endarrayright endeqnarray column one box vector note freud box center origin given box rang possibl posit mathl l box character six paramet box vector length mathl_x mathl_i mathl_z tilt factor mathxi mathxz mathyz tilt factor directli relat angl box vector comput freud built around class ensur natur handl data simul conduct noncub system also nativ support twodimension system set mathl_z box construct varieti way simpl usecas one factori function pyclassfreudboxbox provid easiest possibl interfac codeblock python make x squar box dimension system freudboxboxsquar make xx cubic box freudboxboxcub complex usecas pymethfreudboxboxfrom_box method provid interfac creat box object easili interpret box codeblock python creat x squar box list two item freudboxboxfrom_box creat xx cubic box list three item freudboxboxfrom_box creat triclin box list six item includ tilt factor freudboxboxfrom_box creat triclin box dictionari freudboxboxfrom_boxdictlx ly lz xy xz yz directli call constructor freudboxboxlx ly lz xy xz yz dimens exampl box creat may found api document classbox freudboxbox class _neighbor find neighbor youv introduc basic interact freud let dive central featur freud effici flexibl find neighbor period system problem statement neighborbas calcul discuss refth previou section computeclass central task mani comput freud find particl neighbor calcul typic involv limit subset particl neighbor defin character local environ requir analog forc calcul typic perform molecular dynam simul cutoff radiu specifi beyond pair forc assum small enough neglect unlik simul though mani analys call differ specif simpli select point within certain distanc import exampl calcul order paramet help character phase transit paramet highli sensit precis way neighbor select instanc hard distanc cutoff impos find neighbor hexat order paramet particl may found five neighbor actual six neighbor except last particl slightli outsid cutoff radiu accomod differ flexibl manner freud allow user specifi neighbor varieti way find period neighbor imag imagesperiodicboundaryconditionspng width px find neighbor period system significantli challeng aperiod system illustr differ consid figur black dash line indic boundari system system aperiod three nearest neighbor point would point howev due period point actual closer point other consid move straight top equival bottom boundari although mani tool provid effici implement algorithm find neighbor aperiod system seldom gener period system even rare abil work cubic period system rel tractabl arbitrari triclin geometri describ refpbc precis type calcul freud design neighbor queri understand comput class find neighbor freud help start learn freud neighbor find class directli note much detail topic avail refqueri topic guid section restrict higherlevel overview demonstr make use classfreudlocalityaabbqueri class implement one fast method period neighbor find primari mode interfac class neighbor find class methqueri freudlocalityaabbqueri interfac codeblock python import numpi np import freud exampl randomli gener point xx cubic box l num_point shift point expect rang freud point nprandomrandnum_point l l box freudboxboxcubel aq freudlocalityaabbquerybox point gener smaller sampl point want find neighbor base origin set query_point nprandomrandnum_point l l distanc ask nearest neighbor point query_point bond aqqueryquery_point dictnum_neighbor return bond tupl form query_point_index point_index distanc instanc bond would indic point one nearest neighbor query_point separ distanc ie nplinalgnormquery_point point distancesappendbond avg_dist npmeandist let dig script littl bit first step creat set point cubic box note shift done code could also accomplish use methboxwrap freudboxboxwrap method like boxwrapnprandomrandnum_pointsl result would appear differ plot without consid period point would rang codel codel rather codel howev two set point would equival period system gener addit set query_point ask neighbor use methqueri freudlocalityaabbqueri method function accept two argument set point classdict queri argument queri argument central concept freud repres complet specif set neighbor found gener common form queri request either fix number neighbor exampl request neighbor within specif distanc exampl want rerun exampl instead find bond length less equal would simpli replac loop codeblock python bond aqqueryquery_point dictr_max distancesappendbond queri argument constitut power method specifi queri request mani queri argument may combin specif purpos common usecas find neighbor within singl set point ie set query_point point exampl situat howev typic use point find neighbor sinc trivial closest point fall within cutoff radiu avoid use exclude_ii queri argument codeblock python query_point point bond aqqueryquery_point dictnum_neighbor exclude_iitru pass exampl find nearest neighbor point except point complet descript valid queri argument found refqueri neighbor list queri argument provid simpl power languag express neighbor find logic use manner shown methqueri freudlocalityaabbqueri use express mani calcul natur python way though api shown somewhat restrict output methqueri freudlocalityaabbqueri gener httpsdocspythonorgglossaryhtmltermgenerator_ arent familiar gener import thing know loop unlik object like list loop mani time like youv loop gener cant start begin exampl wasnt problem simpli iter bond singl calcul howev mani practic case may need reus set neighbor multipl time simpl solut would simpli store bond list loop howev common usecas freud provid contain bond classfreudlocalityneighborlist queri easili use gener classneighborlist freudlocalityneighborlist object use methtoneighborlist freudlocalityneighborqueryresulttoneighborlist method codeblock python query_result aqqueryquery_point dictnum_neighbor exclude_iitru nlist query_resulttoneighborlist result object provid persist contain bond data use classneighborlist freudlocalityneighborlist origin exampl might instead look like codeblock python import numpi np import freud l num_point point nprandomrandnum_point l l box freudboxboxcubel aq freudlocalityaabbquerybox point query_point nprandomrandnum_point l l distanc ask nearest neighbor point query_point query_result aqqueryquery_point dictnum_neighbor nlist query_resulttoneighborlist j nlist note wrap bond vector take norm simplest way comput distanc period system distancesappendnplinalgnormboxwrapquery_pointsi pointsj avg_dist npmeandist note exampl loop directli nlist recomput distanc howev query_result contain inform distanc here access nlist codeblock python assert npallclosenlistdist distanc indic also access properti numpylik slice interfac codeblock python assert npallnlistquery_point_indic nlist assert npallnlistpoint_indic nlist note query_point alway first column point second column classfreudlocalityneighborlist object also store properti instanc may assign differ weight differ bond featur use exampl classfreudordersteinhardt typic use calcul steinhardt order paramet httpsjournalsapsorgprbabstractphysrevb_ standard tool character crystallin order provid appropri weight neighbor howev class instead comput minkowski structur metric httpsiopscienceioporgarticlemeta_ much sensit measur differenti wider array crystal structur cite freud pleas acknowledg use softwar within bodi public exampl copi adapt follow formul data analysi public util freud librari v ramasubramani b dice e harper p spell j anderson c glotzer freud softwar suit high throughput analysi particl simul data comput physic commun volum septemb doijcpc paper avail onlin comput physic commun httpswwwsciencedirectcomsciencearticlepiis_ preprint freeli avail arxiv httpsarxivorgabs_ cite refer use follow bibtex entri codeblock bibtex articlefreud titl freud softwar suit high throughput analysi particl simul data author vya ramasubramani bradley dice eric harper matthew p spell joshua anderson sharon c glotzer journal comput physic commun volum page year issn doi httpsdoiorgjcpc url httpwwwsciencedirectcomsciencearticlepii keyword simul analysi molecular dynam mont carlo comput materi scienc option public use freud context machin learn data visual may also wish cite refer b dice v ramasubramani e harper p spell j anderson c glotzer analyz particl system machin learn data visual freud proceed th python scienc confer doimajoraddcdd paper freeli avail scipi confer websit httpconferencescipyorgproceedingsscipybradley_dicehtml_ cite refer use follow bibtex entri codeblock bibtex inproceedingsfreud titl analyz particl system machin learn data visual freud author bradley dice vya ramasubramani eric harper matthew p spell joshua anderson sharon c glotzer booktitl proceed th python scienc confer page year editor chri calloway david lippa dillon niederhut david shupe doi httpsdoiorgmajoraddcdd url httpconferencescipyorgproceedingsscipybradley_dicehtml _develop develop guid contribut freud highli encourag page offer inform project structur goal freud librari contribut new modul toctre maxdepth developmentdesign developmenthowtoadd developmentspecialtop developmentreleas refer necessari file creat bibliographi process sphinx cite command pars fix creat dummi file come late possibl import bibliographi bibliographi freudbib credit freud develop follow peopl contribut develop freud vya ramasubramani lead develop ensur pep complianc ad circleci continu integr support creat environ modul refactor order modul rewrot freud doc includ order densiti environ modul fix nemat order paramet add properti access class member variou minor bug fix refactor pmft code refactor steinhardt order paramet code wrote numer exampl freud usag rewrot freud test replac cmakebas instal setuppi use cython add code coverag metric ad support instal pypi includ ensur numpi instal convert docstr googl format fix variou incorrect doc debug ad rotat autocorrel code ad msd modul wrote neighborqueri _queryarg neighborqueryresult class wrote neighbor iter infrastructur wrote paircomput spatialhistogram parent class wrote managedarray class wrote c histogramrel class initi design freud api neighborqueri object neighbor comput histogram standard neighbor api python use dictionari argument neighborlist object pair comput standard attribut access c python properti standard variabl name pointsquery_point across freud standard vector direction comput enabl usag quaternion place angl orient pmft calcul wrote new freud comput api base neighbor_queri object neighbor either dictionari neighborlist rewrot matchenv code fit freud api split separ calcul rewrit intern use neighborqueri object wrote tutori refer section document unifi util common packag rewrot docstr packag freud chang cubat use mersenn twister rng move citat bibtex format creat data modul standard pmft normal enabl option normal rdf chang correl function properli take complex conjug input wrote develop document version fix handl system variou data sourc fix usag queri orient pmftxi pmftxyt pmftxyz point queri point ident refactor standard pmft test rewrot build system use scikitbuild ad support precommit hook ad option unwrap make_fract make_absolut method box enabl access qlmi array steinhardt solidliquid ad rigor test correct bradley dice lead develop clean variou docstr fix bug hexorderparamet clean test code ad bumpvers support reduc compil warn ad python interfac box period ad voronoi support neighbor list across period boundari ad voronoi weight ad voronoi cell volum comput incorpor intern bimap class boost remov wrote numer exampl freud usag ad freud test ad readthedoc support rewrot interfac modul pure cython ad box ducktyp remov nose unit test use lambda function parallel correlationfunct tbb final boost remov wrote aabbqueri class consolid cluster modul function rewrot solidliquid order paramet class updat angularsepar class rewrot voronoi implement leverag voro implement voronoi bond weight enabl minkowski structur metric refactor method box periodicbuff v ad check c box requir refactor cluster modul standard vector direction comput neighborqueri support clusterproperti gaussiandens voronoi periodicbuff interfac standard api order paramet ad radiu gyrat clusterproperti improv voronoi plot code correct number pointsqueri point localdens made periodicbuff inherit _comput remov cudacpu hoomdmath includ ad plot function box neighborqueri object ad support read system data directli mdanalysi garnett gsd hoomdblu ovito revis tutori document data input updat msd perform accumul comput resetfals ad test pypi support continu integr ad continu integr freudexampl implement period center mass comput c revis doc queri mode implement smarter heurist voronoi voro block size result signific perform gain larg system correct calcul neighbor distanc voronoi neighborlist ad finit toler ensur stabil voronoi neighborlist comput improv stabil histogram bin calcul improv error handl cubat input paramet ad minkowski structur metric hexat enabl use weightedtru along voronoi neighborlist work tommi waltmann add spherevoxel featur fix gaussiandens normal system prevent gaussiandens comput system comput system contribut code design test diffractionpattern class fix hexat order paramet unweight normal number neighbor instead symmetri order k ad num_query_point num_point attribut neighborlist class ad scikitbuild support window fix imag calcul optim neighborlist filter method fix document formula steinhardt class fix incorrect comput steinhardt averag quantiti fix rpath problem affect libfreudso linux wheel updat lambda function captur refer ensur compat c contribut code design document test staticstructurefactordeby class fix boxcontain run linear time onum_point contribut code design document test staticstructurefactordirect class fix doctest run pytest eric harper univers michigan former lead develop ad tbb parallel wrote pmft modul ad nearestneighbor sinc remov wrote rdf ad bond modul sinc remov ad cubat order paramet ad hexat order paramet ad pairingd sinc remov creat common array convers logic joshua anderson univers michigan creator former lead develop initi design implement wrote linkcel iteratorlinkcel wrote gaussiandens localdens ad parallel modul ad index modul sinc remov wrote cluster clusterproperti modul matthew spell former lead develop ad gener neighbor list enabl neighbor list usag across freud modul ad correl function ad localdescriptor class ad interfac modul erin teich wrote environ match matchenv class wrote bondord class julia dshemuchads wrote angularsepar class andrew kara contribut localql develop wrote localbondproject class eric irrgang author kspace modul sinc remov fix numer bug contribut freudshap sinc remov chrisi du author steinhardt order paramet class fix support triclin box antonio osorio develop trajectoryxml class variou bug fix openmp support richmond newman develop freud box solid liquid order paramet carl simon adorf develop python box modul jen glaser wrote kspace frontend sinc remov modifi kspace modul sinc remov wrote nemat order paramet class benjamin schultz wrote voronoi class fix normal gaussiandens bug fix shape modul sinc remov bryan vansad make cython catch c except add shiftvec option pmft ryan marson variou gaussiandens bugfix yina geng cowrot voronoi neighbor list modul add properti access class member carolyn phillip initi design implement packag name ben swerdlow document instal improv jame antonaglia ad number neighbor argument hexorderparamet bugfix analysi deprec kspace modul mayank agraw cowrot voronoi neighbor list modul william zygmunt help boost remov greg van ander bugfix cmake sse instal instruct jame proctor cython cluster modul rose cersonski enabl tbbparallel densiti modul fix c array pull cython wenbo shen translat order paramet andrew kara angular separ wrote refer implement rotat autocorrel paul dodd fix correlationfunct namespac ad computeocf class tbb parallel tim moor ad option rmin argument densityrdf enabl neighborlist index document fix alex dutton bimap class matchenv matthew palathing replac use boost share array share ptr cython help incorpor bimap class matchenv kelli wang enabl neighborlist index ad method compute_dist compute_all_dist box ad method crop box ad box test get_imag contain ad reset argument comput method diffractionpattern class yezhi jin ad support array python interfac box function rewrot voronoi implement leverag voro implement voronoi bond weight enabl minkowski structur metric contribut code design test diffractionpattern class brandon butler ad support multipl l steinhardt along perform improv rewrot steinhardt order paramet jin soo ihm ad benchmark contribut neighborqueri class refactor c perform neighbor queri onthefli ad plot function analysi class wrote rawpoint class creat comput parent class decor ensur properti comput updat common array convers logic ad mani valid test mike henri fix syntax freudexampl notebook v updat document link michael stryk ad short exampl cluster densiti environ order modul tommi waltmann work bradley dice add spherevoxel featur contribut code design test diffractionpattern class contribut code design test staticstructurefactordeby class contribut code design test staticstructurefactordirect class refactor test staticstructurefactor class improv cmake build system use modern style remov ci build configur circleci alreadi cover cibuildwheel maya martirossyan ad test steinhardt particl without neighbor pavel buslaev ad valu argument comput method gaussiandens class charlott zhao work vya ramasubramani bradley dice add option boxboxwrap domagoj fijan contribut code design document test staticstructurefactordeby class contribut code design document test staticstructurefactordirect class andrew kerr contribut document staticstructurefactordeby class emili siew contribut document staticstructurefactordeby class dylan marx contribut document neighborqueri class sourc code highlight none eigen httpeigentuxfamilyorg includ git submodul freud eigen made avail mozilla public licens v httpmozillaorgmpl linear algebra routin use variou task includ comput eigenvalu eigenvector fsph httpsgithubcomglotzerlabfsph includ git submodul freud use calcul spheric harmon fsph made avail mit licens copyright c regent univers michigan permiss herebi grant free charg person obtain copi softwar associ document file softwar deal softwar without restrict includ without limit right use copi modifi merg publish distribut sublicens andor sell copi softwar permit person softwar furnish subject follow condit copyright notic permiss notic shall includ copi substanti portion softwar softwar provid without warranti kind express impli includ limit warranti merchant fit particular purpos noninfring event shall author copyright holder liabl claim damag liabil whether action contract tort otherwis aris connect softwar use deal softwar hoomdblu httpsgithubcomglotzerlabhoomdblu origin sourc algorithm tool vector math implement freud hoomdblu made avail bsd claus licens bsd claus licens hoomdblu copyright c regent univers michigan right reserv redistribut use sourc binari form without modif permit provid follow condit met redistribut sourc code must retain copyright notic list condit follow disclaim redistribut binari form must reproduc copyright notic list condit follow disclaim document andor materi provid distribut neither name copyright holder name contributor may use endors promot product deriv softwar without specif prior written permiss softwar provid copyright holder contributor express impli warranti includ limit impli warranti merchant fit particular purpos disclaim event shall copyright holder contributor liabl direct indirect incident special exemplari consequenti damag includ limit procur substitut good servic loss use data profit busi interrupt howev caus theori liabil whether contract strict liabil tort includ neglig otherwis aris way use softwar even advis possibl damag voro httpsgithubcomchrshrvoro includ git submodul freud use comput voronoi diagram voro made avail follow licens voro copyright c regent univers california lawrenc berkeley nation laboratori subject receipt requir approv us dept energi right reserv redistribut use sourc binari form without modif permit provid follow condit met redistribut sourc code must retain copyright notic list condit follow disclaim redistribut binari form must reproduc copyright notic list condit follow disclaim document andor materi provid distribut neither name univers california lawrenc berkeley nation laboratori us dept energi name contributor may use endors promot product deriv softwar without specif prior written permiss softwar provid copyright holder contributor express impli warranti includ limit impli warranti merchant fit particular purpos disclaim event shall copyright owner contributor liabl direct indirect incident special exemplari consequenti damag includ limit procur substitut good servic loss use data profit busi interrupt howev caus theori liabil whether contract strict liabil tort includ neglig otherwis aris way use softwar even advis possibl damag oblig whatsoev provid bug fix patch upgrad featur function perform sourc code enhanc anyon howev choos make enhanc avail either publicli directli lawrenc berkeley nation laboratori without impos separ written licens agreement enhanc herebi grant follow licens nonexclus royaltyfre perpetu licens instal use modifi prepar deriv work incorpor comput softwar distribut sublicens enhanc deriv work thereof binari sourc code form design principl vision freud librari design power flexibl librari analysi simul output support varieti analysi routin freud place restrict compon primari requir analysi routin freud substanti comput intens requir code c freud code compos fast c routin oper system particl period box remain easytous c modul wrap python code easili access python script python interpret order achiev goal freud take follow viewpoint freud work directli numpi httpsnumpyorg__ array retain maximum flexibl integr tool perform via common data represent numpi array eas mainten freud use git version control github code host issu track pep standard code stress explicitli written code easi read ensur correct freud employ unit test use python modpytest framework addit freud util circleci httpscirclecicom__ continu integr ensur code work correctli chang new featur break exist function languag choic freud librari written two languag python c c allow power fast code execut python allow easi flexibl use intel thread build block parallel provid power c code c code wrap cython allow user interact python numpi provid basic data structur freud commonli use python plot librari packag unit test modul includ set unit test test correct behavior modul test simpl short test singl function complet quickli possibl ideal sec time minut accept justifi benchmark modul benchmark follow way follow code exampl benchmark codefreuddensityrdf modul literalinclud benchmarksbenchmark_density_rdfpi languag python lineno file codebenchmark_density_rdfpi codebenchmark directori exampl found codebenchmark directori runtim codebenchmarkdensityrdfbench_run time codenumb time input size coden runtim respect number thread also measur benchmark run part continu integr perform comparison current commit master branch make execut explicit tempt make code thing automat calcul method find code_calc method class call add return dictionari return user prefer freud execut code explicitli help avoid issu debug undocu behavior codeblock python bad class somefreudclassobject def __init__self kwarg key kwargskey setattrself key kwargskey good class someotherfreudclassobject def __init__self xnone ynone selfx x selfi code duplic possibl code duplic howev explicit import freud translat mani inner loop function similar codeblock c somewher deep function_a int n vecfloat pos_i positioni int j j n j pos_j positionj call somewher deep function_b int n vecfloat pos_i positioni int j j n j pos_j positionj call might possibl figur way creat base c class class inherit run posit call calcul return would rather complic addit chang intern code may result perform penalti difficulti debug etc explicit better howev class number method requir call function function written method instead copypast method typic objectori program python vs cython vs c freud librari meant leverag power c code imbu parallel process power tbb eas write python code bulk calcul take place c shown snippet codeblock python bad def badheavyliftinginpythonposit check posit fine pos_i enumerateposit j pos_j enumerateposit j r_ij pos_j pos_i computed_arrayi some_v return computed_array good def goodheavyliftingincplusplusposit check posit fine cplusplus_heavy_functioncomputed_array posit lenpo return computed_array c code implement heavi lift function call python codeblock c void cplusplus_heavy_functionfloat computed_array float posit int n int n int j j n j j r_ij pos_j pos_i computed_arrayi some_v function may necessari write python level due python librari equival c librari complex code etc case code written cython reason attempt optim code made contribut freud code convent precommit strongli recommend set precommit hook httpsprecommitcom__ ensur code compliant autom linter style check push repositori codeblock bash pip instal precommit precommit instal manual run precommit httpsprecommitcom__ file present repositori run follow command codeblock bash precommit run allfil showdiffonfailur python python cython code freud follow pep httpswwwpythonorgdevpepspep_ continu integr ci python cython code freud analyz use autom linter formatt includ codeflak codeblack codeisort codepyupgrad document written restructuredtext gener use sphinx httpwwwsphinxdocorgenstableindexhtml_ written accord googl python style guid httpsgithubcomgooglestyleguideblobghpagespyguidemdcommentsanddocstrings_ specif note shape numpi array document part type follow manner point mathn_point classnumpyndarray option argument document within type actual type default valu includ within descript box classfreudboxbox option simul box default valu none c c code follow result run codeclangformat style specifi file codeclangformat pleas refer clangformat document httpsclangllvmorgdocsclangformathtml__ detail codeclangformat style automat enforc precommit via ci doubt run codeclangformat stylefil file_with_your_cod top directori freud repositori codecheckstyl step continu integr ci run codeclangtidi codecppcheck codecheckstyl ci fail pleas read output log inform fix addit cmake code test use cmakelang cmakeformat httpscmakeformatreadthedocsioenlatestindexhtml__ doxygen docstr use class function etc code organ code freud mix python cython c user perspect method freud correspond comput class contain python modul group method topic keep modul wellorgan freud implement follow structur c code store cpp folder root repositori subdirectori correspond modul eg cpplocal python code store freud folder root repositori c code expos python use cython code contain pxd file follow convent freud_modulenamepxd note preced underscor core cython code modul contain freudmodulenamepyx underscor gener cython c code eg freudmodulenamecxx commit develop file gener use cython build sourc unnecessari instal compil binari cython modul contain code must import cython modul classfreudboxbox class pyx file must accompani pxd file name freudmodulenamepxd distinguish pxd file use expos c code lack preced underscor inform pxd file work see cython document httpscythonreadthedocsioenlatestsrctutorialpxd_fileshtml_ test freud base python modpytest librari contain test folder test file name convent teststest_modulename_classnamepi benchmark freud contain benchmark directori name analog test benchmarksbenchmark_modulename_classnamepi benchmark benchmark freud perform run benchmarksbenchmarkerpi script script find benchmark use name convent attempt run benchmark defin extend benchmark class defin benchmarksbenchmarkpi provid standard benchmark util use freud subclass need defin method parameter benchmark construct freud object benchmark call relev comput method rather describ process detail consid benchmark codefreuddensityrdf modul exampl literalinclud benchmarksbenchmark_density_rdfpi languag python lineno __init__ method defin basic paramet run bench_setup method call build classfreuddensityrdf object bench_run use time call comput exampl found codebenchmark directori runtim codebenchmarkdensityrdfbench_run time codenumb time input size coden runtim respect number thread also measur benchmark run part continu integr perform comparison current commit master branch step ad new code youv determin add new code freud first step creat new branch codemast process ad code differ base whether edit exist modul freud ad new method exist modul freud requir creat new c file cpp directori modifi correspond _modulenamepxd file freud directori creat wrapper class freudmodulenamepyx new method belong new modul must creat correspond cpp directori pxd pyx file accordingli order code compil must ad relev cmakeliststxt file new c file exist modul must ad correspond cppmodulenamecmakeliststxt file new modul cppnewmodulenamecmakeliststxt file must creat addit new modul must ad cppcmakeliststxt file form add_subdirectori command addit libfreud librari form addit sourc add_librari command similarli new cython modul must ad appropri list freudcmakeliststxt file depend whether c code associ modul final need import new modul freud__init__pi ad codefrom import modulenam modul usabl freudmodulenam code ad appropri test ad test folder test file name convent teststest_modulename_classnamepi final step updat document contain rst file name convent docsourcemodulesmodulenamerst ad class exist modul add class autosummari section correspond rst file creat new modul creat correspond rst file summari section list class function modul follow detail descript class class function document inlin code allow automat gener detail section use automodul direct see modul rst file exampl final new file need ad docsourceindexrst api section _specialtop special topic central compon high level abstract abstract multipl advantag dramat simplifi process implement new code reduc duplic throughout code base ensur bug fix optim occur along singl path entir modul howev abstract come cost signific complex document help orient develop familiar topic provid highlevel overview part code structur piec fit togeth toctre maxdepth specialtopicsmemori specialtopicsneighbor specialtopicshistogram make freud releas releas process step make new releas freud document github wiki httpsgithubcomglotzerlabfreudwikicreatingareleas neighbor find neighbor find central mani method freud purpos page introduc variou c class function involv neighbor find process page focus aspect neighbor find util freud import develop assum knowledg level refneighbor refpaircomput pleas familiar content page proceed two primari usecas neighbor find code freud one directli expos function user via classfreudlocalityneighborqueri abstract class subclass second enabl loop nearest neighbor defin arbitrari queri argument precomput classfreudlocalityneighborlist insid comput method defin c support usecas freud defin find neighbor insid iter class natur loop either case page first discuss iter structur respect localityneighborqueri c class discuss util function built around class enabl easier c comput point also discuss classfreudlocalityneighborlist object fit framework perpoint iter neighborqueri class lowestlevel unit neighbor find infrastructur freud localityneighborperpointiter class defin abstract interfac neighbor iter freud interfac essenti compos next end method given instanc class two method provid mean client code get next neighbor iter neighbor call next produc instanc localityneighborbond simpl data class contain core inform defin bond pair point distanc use ancillari inform rational make perpoint iter central element twofold first conceptu logic find neighbor natur reduc set condit neighbor queri point second practic sinc find neighbor point must sequenti mani case nearest neighbor queri perpoint iter smallest logic unit parallel instanc localityneighborperpointiter construct directli instead construct via localityneighborqueryquerysingl method localityneighborqueri class abstract data type defin interfac method implement find neighbor subclass must implement querysingl method return subclass localityneighborperpointiter instanc localityaabbqueri class implement querysingl return instanc localityaabbiter subclass gener differ neighborqueri subclass need implement separ perpoint iter queri mode localityaabbqueri localityaabbqueryiter localityaabbqueryballiter encod logic nearest neighbor ball queri respect although querysingl method subclass implement primari interfac neighborqueri subclass queri method accept arbitrari set queri point queri argument simpli gener localityneighborqueryiter object localityneighborqueryiter class intermediari allow lazi gener neighbor essenti function contain set point queri point queri argument iter object begin produc neighborperpointiter object demand mode oper also enabl gener approach loop neighbor python sinc iter python correspond directli call next underli neighborqueryiter one conceptu complex associ class import understand sinc logic find neighbor contain perpoint iter class neighborqueryiter actual retain refer construct neighborqueri object call querysingl point bidirect link structur enabl encapsul neighbor find logic also support easili parallel via parallel call querysingl addit structur make natur gener neighborlist object neighborlist neighborlist class repres static list neighbor pair result queri convert neighborlist call toneighborlist method neighborqueryiter anoth reason iter class logic separ neighborqueri object allow gener neighborlist gener independ oper result queri neighborlist simpli implement collect raw array one hold pair neighbor other hold addit inform associ bond distanc weight definit bond neighborlist store form query_point point ie underli array index order query_point order make structur amen fast binari search algorithm loop neighbor given query_point simpli matter find first index list query_point appear iter query_point index list longer match one consider comput neighbor one common oper freud perform comput neighborbond system user multipl way specifi neighbor use queri argument classfreudlocalityneighborlist freud provid util function abstract process loop neighbor function defin localityneighborcomputefunctionalh two import one loopoverneighbor loopoverneighborsiter comput function perform neighbor comput typic accept neighborqueri queryarg neighborlist object object pass either util function loop neighborlist provid classfreudlocalityneighborlist provid python user null pointer pass perform queri neighborqueri object use provid queryarg gener requir neighbor actual comput encapsul lambda function pass argument util distinct two util function lie signatur accept lambda function enabl slightli differ form comput default loopoverneighbor function exactli describ name call provid comput function everi singl bond howev comput requir addit code execut query_point sort normal enabl mode oper loopoverneighborsiter method instead requir lambda function accept two argument query_point index neighborperpointiter way client code loop neighbor given query_point perform need comput execut addit code may option depend index query_point eg updat specif array index default system one import implement detail note user permit simpli provid set point rather neighborqueri object python side ie valid argument methfreudlocalityneighborqueryfrom_system need natur way mirror c ideal without mani method overload implement provid rawpoint c class python classfreudlocality_rawpoint mirror essenti plain contain box set queri point object inherit neighborqueri allow pass directli c comput method howev neighbor comput still need know find neighbor case must construct neighborqueri object capabl neighbor find use provid queri argument find neighbor enabl calcul rawpoint class implement queri method simpli construct aabbqueri intern queri neighbor default neighborlist comput method actual comput produc quantiti per bond one exampl solidliquid order paramet comput order paramet valu bond neighborcomputefunctionalh file implement makedefaultnlist function support calcul creat neighborlist object whatev input provid demand memori manag memori handl freud somewhat intric topic freud develop need awar detail howev certain practic must follow ensur expect behavior achiev page provid overview data handl freud modul develop use freud core class ensur proper memori manag thorough descript process also provid develop need understand intern logic develop note page specif deal modul primarili written c concept appli pure pythoncython modul problem statement standard structur freud modul involv core implement c class wrap cython class own pointer c object python comput method call c comput method perform calcul popul class member array access via properti own cython class class design reusabl ie comput may call mani time object differ data access properti return current data user reason expect access properti save anoth variabl remain unchang futur call comput origin c object destruct naiv implement ensur invari would involv realloc memori everi call comput unnecessarili expens oper ultim want method perform minim number memori alloc allow user oper transpar output without worri whether data invalid futur oper managedarray freud managedarray templat class provid solut problem arbitrari type numer data proper usag class summar follow step declar managedarray class member c call prepar method everi comput make array access via getter method return const refer call make_managed_numpy_array cython return output properti plenti exampl follow pattern found throughout codebas clariti provid complet descript exampl interest detail intern managedarray actual work skip refmanagedarray_explain use managedarray well use modfreudclusterclust illustr four step may implement class take set point assign cluster store c array m_cluster_idx step simpl note m_cluster_idx member variabl type managedarrayunsign int step look first line clustercomput see call m_cluster_idxprepar method encapsul core logic managedarray name intellig realloc memori whenev code still access mean user save correspond python properti attrfreudclusterclustercluster_idx local variabl script call attrfreudclusterclustercomput save variabl still refer origin data new data may access use attrfreudclusterclustercluster_idx step cluster indic accomplish follow code block codeblock c get refer cluster id const utilmanagedarrayunsign int getclusteridx const return m_cluster_idx return type method crucial method must return const refer member final step accomplish cython side cluster indic expos classfreudclusterclust codeblock python _compute_computed_properti def cluster_idxself mathn_point classnumpyndarray cluster index point return freudutilmake_managed_numpy_array selfthisptrgetclusteridx freudutilarr_type_tunsigned_int essenti core logic abstract away user funcfreuddatamake_managed_numpy_array creat numpi array view exist managedarray numpi array effect take ownership data event user keep refer request recomput note signatur function first argument must pointer managedarray return refer second argument indic type data possibl type found freudutilpxd one point note cover exampl templat type managedarray scalar also need provid third argument indic size vector common usecas method return object type managedarrayvecfloat case would call make_managed_numpy_arraygetter_func freudutilarr_type_tfloat index managedarray respect index managedarray class behav like standard arraylik contain access use eg m_cluster_idxindex addit mani calcul freud output multidimension inform managedarray also support multidimension index use oper exampl set element second row third column managedarray array one done use array indic begin therefor managedarray object use easili insid core c calcul freud _managedarray_explain explain managedarray provid detail account managedarray class actual work consid follow block code codeblock python rdf freuddensityrdfbin r_max rdfcomputesystembox point rdf rdfrdf rdfcomputesystembox point rdf rdfrdf requir rdf rdf distinct array equal result comput rdf actual equival two system want achiev minim number memori alloc case mean two requir alloc return copi would doubl achiev goal managedarray object store pointer pointer multipl managedarray object point data array pointer share pointer autom delet array refer remain key use class properli prepar method check refer count determin whether safe simpli zero exist memori need alloc new array exampl comput call second time rdf object python still refer comput data prepar detect multipl two share pointer point data choos realloc classs managedarray store rdf call prepar top everi comput method develop ensur array use rest method properli zero need worri whether realloc need includ case array size chang ensur refer data properli handl addit logic requir python side well cython make_managed_numpy_array instanti _managedarraycontain class essenti contain managedarray point data managedarray provid argument function link increment underli share pointer refer counter make_managed_numpy_array use fact _managedarraycontain transpar convert numpi array point contain result data copi made numpi array effect share ownership data along origin c class array remain scope futur call comput prepar recogn realloc memori need histogram histogram common type calcul implement freud custom histogram hard comput effici pure python c histogram class support weight ndimension histogram differ space dimens key flexibl axi class defin rang space along singl axi ndimension histogram compos sequenc n axi object bin valu histogram perform bin along axi standard regularaxi subclass axi defin evenli space axi bin center defin center bin addit subclass may defin add differ space desir multithread achiev threadlocalhistogram class simpl wrapper around histogram creat equival histogram thread standard pattern parallel histogram gener threadlocalhistogram add data call histogramreduceoverthread method accumul data singl histogram case addit postprocess requir per bin also execut parallel provid lambda function histogramreduceoverthreadsperbin comput histogram histogram class design data structur histogram histogram comput freud involv standard neighbor find get bond follow bin function bond histogram exampl includ rdf bin bond distanc pmft bin bond differ vector compon bond bond order diagram bin bond angl import distinct histogram comput other histogram natur support accumul inform multipl frame data oper illdefin mani comput result histogram comput also need implement boilerpl handl accumul averag data multipl frame detail comput encapsul bondcomputehistogram class contain histogram provid accessor standard histogram properti like bin count axi size gener accumul method accept lambda comput function signatur similar util function loop neighbor fact function transpar forward localityloopoverneighbor comput match pattern inherit bondcomputehistogram class must implement accumul method perform comput reduc reduc thread local histogram singl histogram _queri queri api page provid thorough review neighbor find structur freud assum knowledg level refneighbor level tutori your familiar use methqueri freudlocalityneighborqueryqueri method queri argument find neighbor point pleas familiar section tutori central interfac neighbor find pyclassfreudlocalityneighborqueri famili class provid method dynam find neighbor given pyclassfreudboxbox pyclassfreudlocalityneighborqueri class defin abstract interfac neighbor find implement subclass name pyclassfreudlocalitylinkcel pyclassfreudlocalityaabbqueri class class repres specif data structur use acceler neighbor find two differ method differ perform characterist case classfreudlocalityaabbqueri perform least well better classfreudlocalitylinkcel entir paramet free default method choic use intern freud paircomput class gener data structur oper construct use one set point queri effici find neighbor arbitrari point use pymethfreudlocalityneighborqueryqueri queri argument tabl describ set valid queri argument queri argument definit data type legal valu valid mode type queri perform distanc cutoff number neighbor str none ball nearest classfreudlocalityaabbqueri classfreudlocalitylinkcel r_max maximum distanc find neighbor float r_max classfreudlocalityaabbqueri classfreudlocalitylinkcel r_min minimum distanc find neighbor float r_min r_max classfreudlocalityaabbqueri classfreudlocalitylinkcel num_neighbor number neighbor int num_neighbor classfreudlocalityaabbqueri classfreudlocalitylinkcel exclude_ii whether includ neighbor index array bool truefals classfreudlocalityaabbqueri classfreudlocalitylinkcel r_guess initi search distanc sequenc ball queri float r_guess classfreudlocalityaabbqueri scale scale factor r_guess enough neighbor found float scale classfreudlocalityaabbqueri queri mode ball queri distanc cutoff ball queri find particl within specifi radial distanc provid queri point queri execut modebal describ tabl mode coupl filter minimum distanc r_min andor selfexclus exclude_ii nearest neighbor queri fix number neighbor nearest neighbor queri sometim call mathknearest neighbor find desir number neighbor point queri point order distanc queri point queri execut modenearest describ tabl mode coupl filter maximum distanc r_max minimum distanc r_min andor selfexclus exclude_ii mode deduct mode queri argument specifi type queri perform therefor govern argument interpret case howev queri mode deduc set queri argument specif queri num_neighbor key set assum queri modenearest one num_neighbor r_max must alway specifi form valid set queri argument specifi mode key explicitli ensur queri behavior consist addit queri mode ad freud queri result although dont typic need oper directli use know littl object return queri classfreudlocalityneighborqueryresult store query_point pass queri return neighbor one time like python classiter primari goal result class support easi iter convers persist format sinc iter use typic python approach consum includ pass classlist build list neighbor freudfriendli approach use methtoneighborlist freudlocalityneighborqueryresulttoneighborlist method convert object freud classfreudlocalityneighborlist hood underli c class loop candid point identifi neighbor query_point process occur comput class employ classneighborqueri freudlocalityneighborqueri object find neighbor onthefli case happen c side custom neighborlist thu far weve mostli discuss classneighborlist freudlocalityneighborlist way persist neighbor inform beyond singl queri refoptim guidanc provid use object speed certain use freud howev object also extrem use provid complet customiz way specifi neighbor freud particular note methfreudlocalityneighborlistfrom_array factori function allow make classfreudlocalityneighborlist object directli specifi j pair list kind explicit construct list enabl custom analys would otherwis imposs exampl consid molecular dynam simul particl interact via extrem shortrang patch surfac particl consid bond patch actual interact irrespect close togeth particl type neighbor interact captur normal queri mode could construct user fed freud downstream analysi nearest neighbor asymmetri one import easili overlook detail associ use queri argument mode nearest consid simpl exampl three point xaxi locat assum box dimens math ie suffici larg period play role codeblock python box point query_arg dictmodenearest num_neighbor exclude_iitru listfreudlocalityaabbquerybox pointsquerypoint query_arg output evid calcul symmetr featur nearest neighbor queri unexpect side effect paircomput perform use distinct point query_point two interchang case user alway keep mind freud promis everi query_point end num_neighbor point assum hard cutoff r_max impos enough point present system howev possibl inde like given point fewer mani neighbor distinct particularli tricki calcul depend vector direction freud impos convent bond vector alway point query_point point user calcul like pmft direction import keep mind _optim use freud effici freud librari design fast easytous mani case librari perform good enough user dont need worri usag pattern howev highli performancecrit applic realtim visual onthefli calcul midsimul use benefit know best way make use freud page provid guidanc topic reus local inform perhap power method user dispos speed calcul proper reus data structur modfreudloc one exampl consid use freud calcul multipl neighborbas quantiti set data point import recogn intern time calcul perform use box point classtupl comput class intern rebuild neighborfind acceler classfreudlocalityaabbqueri object use find neighbor codeblock python behind scene freud essenti run freudlocalityaabbquerybox pointsquerypoint dictr_max exclude_iitru feed result rdf calcul rdf freuddensityrdfbin r_max rdfcomputesystembox point user anticip perform mani calcul system point amort cost rebuild classaabbqueri freudlocalityaabbqueri object construct pass multipl comput codeblock python let instead reus object pair calcul nq freudlocalityaabbqueryboxbox pointspoint rdf freuddensityrdfbin r_max rdfcomputesystemnq r_max orient nparray num_point pmft freudpmftpmftxyzr_max r_max r_max bin pmftcomputesystemnq orientationsorient reus significantli improv perform eg visual context user may wish calcul classbond order diagram freudenvironmentbondord classrdf freuddensityrdf frame perhap integr visual toolkit like ovito httpswwwovitoorg_ slightli differ usecas would calcul multipl quantiti base exactli set neighbor user fact expect perform comput exact pair neighbor exampl comput classfreudordersteinhardt multipl mathl valu user speed calcul precomput entir classfreudneighborlist store futur use codeblock python r_max nq freudlocalityaabbqueryboxbox pointspoint nlist nqquerypoint dictr_maxr_maxtoneighborlist q_array l rang ql freudordersteinhardtl q_arraysappendqlcomputebox point neighborsnlistparticle_ord notabl user call comput method computesystembox point unlik exampl freud construct classfreudlocalityneighborqueri intern full set neighbor complet specifi classneighborlist freudneighborlist case freud minim work possibl find neighbor judici use data structur substanti acceler code proper data input minor speedup may also gain pass properli structur data freud packag origin design analyz particl simul trajectori typic store singleprecis binari format result freud librari also oper singl precis therefor convert input singleprecis howev numpi typic work doubl precis default depend data stream freud packag may perform numer data copi order ensur data singleprecis avoid problem make sure specifi appropri data type attrnumpyfloat construct numpi array _datainput read simul data freud freud packag design maximum flexibl make minim assumpt data howev user accustom restrict pattern tool may find flexibl confus particular know provid data specif simul sourc signific sourc confus page intend describ variou type data may convert form suitabl freud simplifi exampl assum case user wish comput classradi distribut function freuddensityrdf frame trajectori follow code alreadi run codeblock python import freud rdf freuddensityrdfbin r_max nativ integr freud librari offer interoper sever popular tool particl simul analysi visual list file format tool directli support systemlik object see classfreudlocalityneighborqueryfrom_system systemlik object data contain store inform period box particl posit attribut particl orient includ automat system represent must load separ numpi array gsd trajectori use gsd python api gsd file easili integr freud shown refquickstart format nativ support hoomdblu httpshoomdbluereadthedocsio__ note gsd format also read refmdanalysi mdanalysisread refgarnett garnetttrajectori provid exampl read data gsd file codeblock python import gsdhoomd traj gsdhoomdopentrajectorygsd rb frame traj rdfcomputesystemfram resetfals _mdanalysisread mdanalysi reader mdanalysi httpswwwmdanalysisorg__ packag read mani popular trajectori format httpswwwmdanalysisorgdocsdocumentation_pagescoordinatesinithtmlsupportedcoordinateformats__ includ common output format charmm namd lammp gromac tinker amber gamess hoomdblu dcd file among familiar simul output due longev provid exampl read data dcd file codeblock python import mdanalysi reader mdanalysiscoordinatesdcddcdreadertrajectorydcd frame reader rdfcomputesystemfram resetfals _mdtrajread mdtraj reader mdtraj httpmdtrajorg__ packag read mani popular trajectori format httpmdtrajorglatestload_functionshtmlformatspecificloadingfunctions__ includ common output format amber msmbuilder protein data bank file openmm tinker gromac lammp hoomdblu use data read mdtraj freud systemlik object must manual construct framelik object contain inform period box particl posit quantiti provid array whole trajectori provid exampl construct system codeblock python import mdtraj traj mdtrajload_xtcoutputprdxtc topoutputprdgro system zipnpasarraytrajunitcell_vector trajxyz rdfcomputesystemsystem resetfals _garnetttrajectori garnett trajectori garnett httpsgarnettreadthedocsio__ packag read sever trajectori format httpsgarnettreadthedocsioenstablereaderswritershtmlfileformats__ histor support hoomdblu simul engin well common type dcd cif garnett packag autodetect support file format file extens provid exampl read data po file codeblock python import garnett garnettreadtrajectorypo traj frame traj rdfcomputesystemfram resetfals ovito modifi ovito open visual tool httpswwwovitoorg__ support userwritten python modifi freud packag instal alongsid ovito enabl userwritten python script modifi httpswwwovitoorgdocscurrentparticlesmodifierspython_scriptphp_ leverag analys freud exampl modifi creat user particl properti ovito pipelin steinhardt bond order paramet codeblock python import freud def modifyfram data ql freudordersteinhardtl qlcomputesystemdata neighborsnum_neighbor datacreate_user_particle_properti nameql data_typefloat dataqlql printcreat ql properti particlesformatdataparticlescount hoomdblu snapshot hoomdblu httpshoomdbluereadthedocsio__ support analyz callback function perform analysi exampl demonstr use anlyz log steinhardt bond order paramet mathq_ simul run codeblock python import hoomd hoomd import md import freud hoomdcontextiniti creat xx simpl cubic lattic particl type name system hoomdinitcreate_lattic unitcellhoomdlatticesca type_namea n specifi lennardjon interact particl pair nl mdnlistcel lj mdpairljr_cut nlistnl ljpair_coeffseta epsilon sigma integr constant temperatur mdintegratemode_standarddt hoomdmdintegratelangevingrouphoomdgroupal kt seed creat steinhardt object analyz snapshot ql freudordersteinhardtl def compute_qtimestep snap systemtake_snapshot qlcomputesystemsnap neighborsnum_neighbor return qlorder regist logger comput q save file ql_logger hoomdanalyzelogfilenameqldat quantitiesq period ql_loggerregister_callbackq compute_q run time step hoomdrun read text file typic best use one nativ support data reader describ howev sometim necessari pars trajectori inform directli text file one exampl plain text format xyz file format gener use mani tool particl simul analysi includ lammp vmd note variou reader exist xyz file includ mdanalysi exampl read file manual demonstr read input plain text though easi pars xyz file usual contain inform system box must alreadi known user assum knowledg box use simul lammp xyz file could use follow codeblock python n intnpgenfromtxttrajectoryxyz max_row traj npgenfromtxt trajectoryxyz skip_head invalid_raisefals reshap n box freudboxboxcubel frame_posit traj rdfcomputesystembox frame_posit resetfals first line number particl read line use determin reshap content rest file numpi array extern reader mani trajectori format highqual reader alreadi exist howev sometim reader data structur must convert format understood freud show exampl convert mdanalysi box dimens matrix classfreudboxbox note refmdanalysi input mdanalysisread nativ support freud without extra step format support reader list similar process follow codeblock python import mdanalysi reader mdanalysiscoordinatesdcddcdreadertrajectorydcd frame reader box freudboxboxfrom_matrixframetriclinic_dimens rdfcomputesystembox frameposit resetfals