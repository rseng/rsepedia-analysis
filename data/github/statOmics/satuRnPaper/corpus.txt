saturn scalabl analysi differenti transcript usag bulk singlecel rnasequenc applic abstract background altern splice allow product multipl function distinct transcript singl genom locu howev deregul splice process extens report caus diseas hallmark cancer sever differenti transcript usag dtu analysi tool alreadi exist optim suit analyz larg bulk rnaseq fulllength scrnaseq dataset leav great potenti data larg unexploit result therefor develop novel dtu analysi tool name saturn acronym scalabal analysi differenti transcript usag rnaseq data evalu perform saturn publicli avail simul real bulk rnaseq benchmark dataset well real scrnaseq benchmark dataset found perform saturn least par perform best tool literatur addit saturn control fdr closer nomin level gener also show saturn scale toward larg data volum gener contemporari bulk singlecel rnaseq experi allow transcriptomewid analysi dataset consist sever thousand cell minut final analyz larg fulllength scrnaseq case studi dataset obtain highli relev biolog result isoformlevel chang cell type would remain obscur canon differenti gene express dge analysi conclus shown novel dtu analysi tool saturn highli perform ii provid strict control fdr iii scale seamlessli larg data volum contemporari scrnaseq dataset iv allow model complex experiment design v deal realist proport zero count vi provid direct infer biolog relev transcript level knowledg saturn dtu analysi method combin qualiti method saturn adopt quasibinomi gener linear model framework saturn provid direct infer dtu model rel usag transcript comparison transcript gene condit interest stabil estim overdispers paramet qb model borrow strength across transcript build upon empir bay methodolog introduc smyth et al order control number fals posit find empir null distribut use obtain pvalu correct multipl test fdr method benjamini hochberg saturn implement r softwar packag avail github httpsgithubcomstatomicssaturn avail data dataset requir reproduc result display public includ supplementari materi avail zenodo includ raw data intermedi result note top analysi script indic dataset requir input script may thu necessari download dataset zenodohttpsdoiorgzenodo easili reproduc analys place download data data folder local clone repositori analys script reproduc result display public proceed follow make local clone github repositori open select r script rmd r project dtu_paperrproj root repositori look top r script input data requir download data zenodo see avail data place data data folder repositori run analys result automat store git repositori either data folder intermedi result result folder end result eg figur improv replic analys perform paper file sessioninfotxt includ root repositori display exact version packag respect depend use analys github repositori contain follow folder casestudi folder contain code reproduc case studi analys analys saturn limma diffsplic doubleexpseq data reproduc result display public input data differ analysi download zenodo see avail data place data folder local clone github page performance_benchmark folder contain code reproduc perform benchmark analys result folder contain result figur includ use public supplementari materi scalability_benchmark folder contain code reproduc scalabl benchmark analys scalability_benchmark folder current problem bandit requir ecc file bulk gb salmon file solut either ecc must provid zenodo bandit analysi reproduc tink upload zenodo perform scalabl analys unix execut runtim simpli run command line use runtim run script requir scalability_runtim folder download zenodo data folder repositroy unzip runtim perform analys scalabl benchmark data dtu method assess public total scalabl benchmark ran approxim hour system gener figur respect scalabl display benchmark run scalabilitybenchmarkrmd script data folder avail data dataset requir reproduc result display public includ supplementari materi avail zenodo includ raw data intermedi result note top analysi script indic dataset requir input script may thu necessari download dataset zenodo easili reproduc result place download data data folder insert zenodo link titl venn_diagram author jeroen gili date output html_document script compar dtu result saturn limma diffsplic doubleexpseq mean venn daigram figur public order run script three file download zenodo place data folder github repositori tasic_casestudy_saturnrd saturn dtu result tasic_casestudy_limmadiffsplicerd limma diffsplic dtu result tasic_casestudy_doubleexpseqrd doubleexpseq dtu result note metadata file ident one supplement tasic et al supplementary_table__full_metadataxlsx gse_accession_tablecsv respect figur gener script avail github repositori resultscasestudi r setup includefals echofals requireknitr opts_knitsetrootdir rprojrootfind_rstudio_root_fil load librari r messagefals warningfals librarysummarizedexperi libraryggplot librarytidyvers libraryvenndiagram librarygrid load data result analys tasic case studi saturn gener saturn_analysisrmd limma diffsplic gener limmadiffsplice_analysisrmd doubleexpseq gener doubleexpseq_analysisrmd r saturn_result readrdsfiledatatasic_casestudy_saturnrd limmares_result readrdsfiledatatasic_casestudy_limmadiffsplicerd doubleexpseq_result readrdsfiledatatasic_casestudy_doubleexpseqrd venn diagram top transcipt contrast extract top transcript contrast r saturn saturn_results_comp_top rowdatasaturn_resultsfitdturesult_c saturn_results_comp_top saturn_results_comp_topordersaturn_results_comp_topempirical_pv saturn_results_comp_top rownamessaturn_results_comp_top limma diffsplic limmares_results_comp_top limmares_result limmares_results_comp_top limmares_results_comp_toporderlimmares_results_comp_topempirical_pv limmares_results_comp_top rownameslimmares_results_comp_top doubleexpseq doubleexpseq_results_comp_top asdataframedoubleexpseq_resultsal doubleexpseq_results_comp_top doubleexpseq_results_comp_toporderdoubleexpseq_results_comp_toppv doubleexpseq_results_comp_top rownamesdoubleexpseq_results_comp_top creat venn diagram venn diagram r pngresultscasestudyvenndiagrampng width height unit re pointsiz start export gridgridnewpag gridgriddrawvenndiagramvenndiagramlistsaturnsaturn_results_comp_top limma_diffsplicelimmares_results_comp_top doubleexpseqdoubleexpseq_results_comp_top filenam null maintop dtu transcript mainfontfac bold cex maincex catcex fill cblack darkblu margin catjust listccc devoff titl saturn_analysi author jeroen gili date output html_document script perform dtu analysi saturn subset cell singlecel rnaseq dataset tasic et al tasic paperhttpsdoiorg order run script three file download zenodo place data folder github repositori tasic_casestudy_transcript_countsrd transcriptlevel express matrix tasic_metadata_xlsx tasic_metadata_csv note metadata file ident one supplement tasic et al supplementary_table__full_metadataxlsx gse_accession_tablecsv respect also note raw data avail geohttpswwwncbinlmnihgovgeoqueryacccgiaccgs figur gener script avail github repositori resultscasestudi r setup includefals echofals requireknitr opts_knitsetrootdir rprojrootfind_rstudio_root_fil load librari rmessagefalsewarningfals data import libraryannotationhub libraryensembldb libraryopenxlsx analysi librarysaturn libraryedg librarytidyvers librarysummarizedexperi visual libraryggplot data import import transcript inform r messagefals ah annotationhub load annot resourc queryah ensdb queri avail ensdb databas ahedb allah mu musculu tx transcriptsahedb txgene asdataframematrixdata na nrow lengthtx ncol colnamestxgen ctxnamegeneid txgenetxnam txstx_id txgenegeneid txsgene_id import count r tasic_count readrdsdatatasic_casestudy_transcript_countsrd alreadi remov gene zero count cell tasic_count tasic_countsrowsumstasic_count dimtasic_count import metadata r access readcsvdatatasic_metadata_csvsep access accessmatchcolnamestasic_countsaccesssra_run metadata openxlsxreadxlsxdatatasic_metadata_xlsx metadata metadatamatchaccesssample_namemetadatasample_nam colnamestasic_count metadatasample_nam metadata metadatametadatacore_intermediate_cal core retain cell unambigu assign certain cell type cluster tasic_count tasic_countsmetadatasample_nam metadata metadatacsample_nam brain_regionclust data wrangl r remov transcript isoform express certain gene txinfo txgene colnamestxinfo cisoform_idgene_id rownamestxinfo null rownamestasic_count sub rownamestasic_count txinfo txinfotxinfoisoform_id rownamestasic_count txinfo subsettxinfoduplicatedgene_id duplicatedgene_id fromlasttru tasic_count tasic_countswhichrownamestasic_count txinfoisoform_id set experiment design r metadataclust gsub _ metadataclust metadatagroup pastemetadatabrain_regionmetadataclustersep remov group cell type less cell remov group remov namestableinteractionmetadatabrain_regionmetadataclustertableinteractionmetadatabrain_regionmetadataclust metadata metadatawhichmetadatagroup remov group asfactormetadatagroup design modelmatrix group factori design colnamesdesign levelsgroup tasic_count tasic_countswhichcolnamestasic_count metadatasample_nam filter r filter_all_edger_string filterbyexprtasic_count design null group metadatabrain_region libsiz null mincount mintotalcount largen minprop tablefilter_all_edger_string tasic_count tasic_countsfilter_all_edger_string r updat txinfo accord filter procedur txinfo txinfowhichtxinfoisoform_id rownamestasic_count remov transcript isoform express certain gene filter txinfo subsettxinfoduplicatedgene_id duplicatedgene_id fromlasttru tasic_count tasic_countswhichrownamestasic_count txinfoisoform_id saturn requir transcript rowdata transcript count matrix order result model match wrong rowdata txinfo txinfomatchrownamestasic_countstxinfoisoform_id rmlist setdiffl ctasic_count txinfo design metadata txgenegroup invisiblegc analysi make summar experi object r messagef sumexp summarizedexperimentsummarizedexperimentassayslistcountstasic_count coldata metadata rowdata txinfo metadatasumexpformula group specifi design intern fit function use design modelmatrixsumexpmetadataformula coldatasumexp fit quasibinomi glm saturn r systim sumexp saturnfitdtuobject sumexp formula group parallel fals bpparam biocparallelbpparam verbos true systim set contrast matrix r manual construct contrast interest defin tasic et al design modelmatrixgroup colnamesdesign levelsgroup l matrix ncol nrow ncoldesign rownamesl colnamesdesign colnamesl cc c c c c c c c lcvispl_it_visp_batf alml_it_alm_cpa_gpr c lcvispl_it_visp_cola alml_it_alm_cbln_fezf c lcvispl_it_visp_cola_fezf alml_it_alm_cpa_gpr c lcvispl_it_visp_cola_fezf alml_it_alm_gkn_pcdh c lcvispl_it_visp_hsdb_end alml_it_alm_lypd_gpr c lcvispl_it_visp_hsdb_end alml_it_alm_tnc c lcvispl_it_visp_hsdb_end alml_it_alm_tmem_dmrtb c lcvispl_it_visp_whrn_tox alml_it_alm_tmem_arhgap c test contrast saturn r sumexp saturntestdtuobject sumexp contrast l plott sort f r rowdata addit slot correspond differ request contrast simpl datafram result transcript select contrast rowdatasumexpfitdturesult_c visual dtu saturn creat panel b c figur paper r group rownamescoldatasumexpcoldatasumexpgroup vispl_it_visp_hsdb_end group rownamescoldatasumexpcoldatasumexpgroup alml_it_alm_tnc plot saturnplotdtuobject sumexp contrast c group listgroupgroup coeffici listcc summarystat model transcript censmustensmustensmustgen nulltopn layout paper seq_alongplot titl cfigureafigurebfigurec current_plot plotsi scale_fill_manuallabel cvispalm valuescroyalblu firebrick scale_x_discretelabel chsdb_endoutnc themeaxistextx element_textangl vjust hjust size themestriptext element_texts face bold pngpasteresultscasestudytitlesipng width height unit re pointsiz printcurrent_plot devoff gsea save dtu transcript contrast perform dtu analysi import msigdb r dtu_tx rownamesrowdatasumexprowdatasumexpempirical_fdr isnarowdatasumexpestim dtu_gen txgenewhichtxgenetxnam dtu_tx geneid sinkfil resultscasestudygseatasic_lit_contrast_dtu_saturntxt catdtu_gen n sink dtu_tx rownamesrowdatasumexprowdatasumexpempirical_fdr isnarowdatasumexpestim dtu_gen txgenewhichtxgenetxnam dtu_tx geneid sinkfil resultscasestudygseatasic_lit_contrast_dtu_saturntxt catdtu_gen n sink dtu_tx rownamesrowdatasumexprowdatasumexpempirical_fdr isnarowdatasumexpestim dtu_gen txgenewhichtxgenetxnam dtu_tx geneid sinkfil resultscasestudygseatasic_lit_contrast_dtu_saturntxt catdtu_gen n sink save final object save result object later comparison result limma diffsplic doubleexpseq r saverdssumexp file datatasic_casestudy_saturnrd titl limmadiffsplice_analysi author jeroen gili date output html_document script perform dtu analysi limma diffsplic subset cell singlecel rnaseq dataset tasic et al tasic paperhttpsdoiorg order run script three file download zenodo place data folder github repositori tasic_casestudy_transcript_countsrd transcriptlevel express matrix tasic_metadata_xlsx tasic_metadata_csv note metadata file ident one supplement tasic et al supplementary_table__full_metadataxlsx gse_accession_tablecsv respect also note raw data avail geohttpswwwncbinlmnihgovgeoqueryacccgiaccgs figur gener script avail github repositori resultscasestudi r setup includefals echofals requireknitr opts_knitsetrootdir rprojrootfind_rstudio_root_fil load librari rmessagefals data import libraryannotationhub libraryensembldb analysi libraryedg librarytidyvers visual libraryggplot data import import transcript inform r messagefals ah annotationhub load annot resourc queryah ensdb queri avail ensdb databas ahedb allah mu musculu tx transcriptsahedb txgene asdataframematrixdata na nrow lengthtx ncol colnamestxgen ctxnamegeneid txgenetxnam txstx_id txgenegeneid txsgene_id import count r tasic_count readrdsdatatasic_casestudy_transcript_countsrd alreadi remov gene zero count cell tasic_count tasic_countsrowsumstasic_count dimtasic_count import metadata r access readcsvdatatasic_metadata_csvsep access accessmatchcolnamestasic_countsaccesssra_run metadata openxlsxreadxlsxdatatasic_metadata_xlsx metadata metadatamatchaccesssample_namemetadatasample_nam colnamestasic_count metadatasample_nam metadata metadatametadatacore_intermediate_cal core retain cell unambigu assign certain cell type cluster tasic_count tasic_countsmetadatasample_nam metadata metadatacsample_nam brain_regionclust data wrangl r remov transcript isoform express certain gene txinfo txgene colnamestxinfo cisoform_idgene_id rownamestxinfo null rownamestasic_count sub rownamestasic_count txinfo txinfotxinfoisoform_id rownamestasic_count txinfo subsettxinfoduplicatedgene_id duplicatedgene_id fromlasttru tasic_count tasic_countswhichrownamestasic_count txinfoisoform_id set experiment design r metadataclust gsub _ metadataclust metadatagroup pastemetadatabrain_regionmetadataclustersep remov group cell type less cell remov group remov namestableinteractionmetadatabrain_regionmetadataclustertableinteractionmetadatabrain_regionmetadataclust metadata metadatawhichmetadatagroup remov group asfactormetadatagroup design modelmatrix group factori design colnamesdesign levelsgroup tasic_count tasic_countswhichcolnamestasic_count metadatasample_nam filter r filter_all_edger_string filterbyexprtasic_count design null group metadatabrain_region libsiz null mincount mintotalcount largen minprop tablefilter_all_edger_string tasic_count tasic_countsfilter_all_edger_string r updat txinfo accord filter procedur txinfo txinfowhichtxinfoisoform_id rownamestasic_count remov transcript isoform express certain gene filter txinfo subsettxinfoduplicatedgene_id duplicatedgene_id fromlasttru tasic_count tasic_countswhichrownamestasic_count txinfoisoform_id saturn requir transcript rowdata transcript count matrix order result model match wrong rowdata txinfo txinfomatchrownamestasic_countstxinfoisoform_id rmlist setdiffl ctasic_count txinfo design metadata txgenegroup invisiblegc analysi fit set contrast test r geneforeachtx txinfogene_idmatchrownamestasic_countstxinfoisoform_id dgelistcount tasic_count groupasfactormetadatagroup gene geneforeachtx calcnormfactorsi v voomi design plotf fit lmfitv design contrastmatrix makecontrastsvispl_it_visp_batfalml_it_alm_cpa_gpr vispl_it_visp_colaalml_it_alm_cbln_fezf vispl_it_visp_cola_fezfalml_it_alm_cpa_gpr vispl_it_visp_cola_fezfalml_it_alm_gkn_pcdh vispl_it_visp_hsdb_endoualml_it_alm_lypd_gpr vispl_it_visp_hsdb_endoualml_it_alm_tnc vispl_it_visp_hsdb_endoualml_it_alm_tmem_dmrtb vispl_it_visp_whrn_toxalml_it_alm_tmem_arhgap levelsdesign fit contrastsfitfit contrastmatrix fit ebayesfit ex limmadiffsplicefit geneid gene verbos f seq_lenncolexcoeffici limmar topspliceex coefi testt number inf printsumlimmaresfdr postprocess without correct obtain huge number dtu transcript limma analysi therefor addit postprocess result accord empir fdr strategi implement saturn adapt locfdr function locfdr packag efron et al time panel figur paper gener r limmares_al list seq_lenncolexcoeffici limmar topspliceex coefi testt number inf limmarest pval limmarespvalu fdr limmaresfdr gener figur pngpasteresultscasestudyfigures_ png sep width height unit re pointsiz start export histpval break main pastecontrasti colwhit devoff gener figur zval qnormpvalsignt zval_mid zvalabszv zval_mid zval_midisnazval_mid pngpasteresultscasestudyfigures_ png sep width height unit re pointsiz start export plot_lfdr locfdrlocfdrzval_midplottmainpastecontrasti devoff empir qbdtupadjust_empiricalpvaltplotf empir fdr correct implement saturn empirical_pv empiricalpv empirical_fdr empiricalfdr result_limma dataframetpvalfdrempirical_pvalempirical_fdr rownamesresult_limma rownameslimmar print number dtu transcript work empir null printsumresult_limmaempirical_fdr limmares_ result_limma save final object save result object later comparison result saturn doubleexpseq r saverdslimmares_allfil datatasic_casestudy_limmadiffsplicerd titl comparison_saturn_limmadiffsplic author jeroen gili date output html_document script perform qualit comparison result dtu analysi saturn dtu analysi limma diffsplic order run script two file download zenodo place data folder github repositori tasic_casestudy_saturnrd saturn dtu result tasic_casestudy_limmadiffsplicerd limma diffsplic dtu result figur gener script avail github repositori resultscasestudi r setup includefals echofals requireknitr opts_knitsetrootdir rprojrootfind_rstudio_root_fil load librari r messagefals warningfals librarysummarizedexperi librarysaturn libraryggplot load data result analys tasic case studi saturn gener saturn_analysisrmd limma diffsplic gener limmadiffsplice_analysisrmd r saturn_result readrdsfiledatatasic_casestudy_saturnrd limmares_result readrdsfiledatatasic_casestudy_limmadiffsplicerd get rank term signific transcript mehtod r txinfo asdataframerowdatasaturn_resultsc txinforank_limma matchtxinfoisoform_idrownameslimmares_result txinforank_saturn matchtxinfoisoform_idrownamesrowdatasaturn_resultsfitdturesult_corderrowdatasaturn_resultsfitdturesult_cempirical_pv txinfodiffrank abstxinforank_limma txinforank_saturn differ rank method limmadiffsplic often identifi transcript gene low inform content inspect transcript highli rank top dtu list limma diffsplic lowli rank top list found transcript origin gene lowli express global comparison contrast get genelevel count r tasic_counts_curr assaysaturn_resultssaturn_resultsgroup cvispl_it_visp_hsdb_end alml_it_alm_tnc get cell contrast totalcount saturngettotalcounttasic_counts_curr txinfo mean_tot rowmeanstotalcount summar genelevel count mean cell get fraction zero r frac_zero rowsumstasic_counts_curr ncoltasic_counts_curr headfrac_zero identifi dtu transcript method r saturn_dtu rowdatasaturn_resultsfitdturesult_cempirical_fdr dtu saturn namessaturn_dtu rownamesrowdatasaturn_resultsfitdturesult_c limma_dtu limmares_resultsempirical_fdr dtu limma nameslimma_dtu rownameslimmares_result limma_dtu limma_dtumatchnamessaturn_dtunameslimma_dtu saturn_dtu limma_dtu dtu saturn saturn_dtu limma_dtu dtu saturn limma limma_dtu saturn_dtu dtu limma get data correct format ggplot r dtu_al limma dtu_allwhichdtu_alltru limmadiffsplic dtu_allwhichsaturntru saturn dtu_allwhichbothtru dtu_allwhichdtu_allfals none gg_data asdataframecbindnamesdtu_allunnamedtu_allmean_totfrac_zero colnamesgg_data ctranscriptmethodtotalcountfrac_zero gg_datamethod asfactorgg_datamethod gg_datatotalcount asnumericascharactergg_datatotalcount gg_datafrac_zero asnumericascharactergg_datafrac_zero gg_datamethod factorgg_datamethod level csaturnbothlimmadiffsplicenon make plot genelevel count transcript uniqu identifi dtu saturn limma diffsplic method r p ggplotdata gg_datawhichgg_datamethod none aesxmethodytotalcountfillmethod geom_boxplot theme_class scale_fill_manualvaluescblackgreyb ylabgenelevel count ggtitleaverag genelevel count dtu transcript themeplottitl element_texts dat ggplot_buildpdata pngresultscasestudyfigureapng width height unit re pointsiz p geom_segmentdatadat aesxxmin xendxmax ymiddl yendmiddl inherita f colourcwhiteblackblack size scale_y_log devoff make plot fraction nonzero count transcript uniqu identifi dtu saturn limma diffsplic method r gg_datafrac_non_zero gg_datafrac_zero pngresultscasestudyfigurebpng width height unit re pointsiz ggplotdata gg_datawhichgg_datamethod none aesxmethodyfrac_non_zerofillmethod geom_violin geom_jitteraescolourmethodwidth theme_class scale_fill_manualvaluescblackgreyb scale_color_manualvaluescgreyblackblack ylim ggtitlefract nonzero count dtu transcript stat_summaryfunmedian geompoint shape size colgreen ylabfract nonzero count themeplottitl element_texts devoff exampl consequ transcript belong lowli express gene correctli consid less inform saturn thu less like pick figur show method estim mean usag tnc cell hsdb endou cell indic gold diamond transcript identifi differenti use given low abund correspond gene highli dispers singlecel level observ r group rownamescoldatasaturn_resultscoldatasaturn_resultsgroup alml_it_alm_tnc group rownamescoldatasaturn_resultscoldatasaturn_resultsgroup vispl_it_visp_hsdb_end plot_a saturnplotdtuobject saturn_result contrast c group listgroupgroup coeffici listcc summarystat cmodelmean transcript ensmustgen nulltopn get layout figur paper transcript ensmust padj_limma formatlimmares_resultstranscriptempirical_fdrdigit rank_limma txinfotxinfoisoform_id transcriptrank_limma padj_saturn formatrowdatasaturn_resultsfitdturesult_ctranscriptempirical_fdrdigit rank_saturn txinfotxinfoisoform_id transcriptrank_saturn label_facet functiontxid padj_limma rank_limma padj_saturn rank_saturn lev levelsasfactortxid lab pastelimma empfdr padj_limma rank rank_limma n saturn empfdr padj_saturn rank rank_saturn nameslab lev returnlab plot figur pngresultscasestudyfigureapng width height unit re pointsiz plot_a scale_fill_manuallabel calmvisp valuescroyalblu firebrick scale_x_discretelabel ctnchsdb_endou facet_wrapvari ncol label labellervari label_facetfactortranscript padj_limma rank_limma padj_saturn rank_saturn themeaxistextx element_textangl vjust hjust size themestriptext element_texts face bold devoff saturn often identifi small chang transcript usag stabl across cell convers look transcript highli rank dtu list lowli rank top list limma observ model like captur small chang transcript usag stabl across cell belong gene highli express exampl exampl transcript shown figur b r plot_b saturnplotdtuobject saturn_result contrast c group listgroupgroup coeffici listcc summarystat model transcript ensmustgen nulltopn get layout figur paper transcript ensmust padj_limma formatlimmares_resultstranscriptempirical_fdrdigit rank_limma txinfotxinfoisoform_id transcriptrank_limma padj_saturn formatrowdatasaturn_resultsfitdturesult_ctranscriptempirical_fdrdigit rank_saturn txinfotxinfoisoform_id transcriptrank_saturn plot figur b pngresultscasestudyfigurebpng width height unit re pointsiz plot_b scale_fill_manuallabel calmvisp valuescroyalblu firebrick scale_x_discretelabel ctnchsdb_endou facet_wrapvari ncol label labellervari label_facetfactortranscript padj_limma rank_limma padj_saturn rank_saturn themeaxistextx element_textangl vjust hjust size themestriptext element_texts face bold devoff limmadiffsplic influenc outli observ low genelevel abund dtu claim limma driven differ raw mean usag transcript exampl figur c raw mean usag transcript tnc cell hsdb endou cell indic cyan diamond contrast mean usag estim saturn take account hsdb endou cell express transcript usag low genelevel count tnc cell hsdb endou cell indic gold diamond r plot_c saturnplotdtuobject saturn_result contrast c group listgroupgroup coeffici listcc summarystat cmodelmean transcript ensmustgen nulltopn get layout figur paper transcript ensmust padj_limma formatlimmares_resultstranscriptempirical_fdrdigit rank_limma txinfotxinfoisoform_id transcriptrank_limma padj_saturn formatrowdatasaturn_resultsfitdturesult_ctranscriptempirical_fdrdigit rank_saturn txinfotxinfoisoform_id transcriptrank_saturn plot figur c pngresultscasestudyfigurecpng width height unit re pointsiz plot_c scale_fill_manuallabel calmvisp valuescroyalblu firebrick scale_x_discretelabel ctnchsdb_endou facet_wrapvari ncol label labellervari label_facetfactortranscript padj_limma rank_limma padj_saturn rank_saturn themeaxistextx element_textangl vjust hjust size themestriptext element_texts face bold devoff titl edger_dge_analysi author jeroen gili date output html_document script perform dge analysi edger subset cell singlecel rnaseq dataset tasic et al tasic paperhttpsdoiorg order run script three file download zenodo place data folder github repositori tasic_casestudy_transcript_countsrd transcriptlevel express matrix tasic_metadata_xlsx tasic_metadata_csv note metadata file ident one supplement tasic et al supplementary_table__full_metadataxlsx gse_accession_tablecsv respect also note raw data avail geohttpswwwncbinlmnihgovgeoqueryacccgiaccgs figur gener script avail github repositori resultscasestudi r setup includefals echofals requireknitr opts_knitsetrootdir rprojrootfind_rstudio_root_fil load librari rmessagefals analysi libraryedg librarytidyvers data import import count r tasic_gene_count readrdsdatatasic_casestudy_gene_countsrd alreadi remov gene zero count cell tasic_gene_count tasic_gene_countsrowsumstasic_gene_count dimtasic_gene_count import metadata r access readcsvdatatasic_metadata_csvsep access accessmatchcolnamestasic_gene_countsaccesssra_run metadata openxlsxreadxlsxdatatasic_metadata_xlsx metadata metadatamatchaccesssample_namemetadatasample_nam colnamestasic_gene_count metadatasample_nam metadata metadatametadatacore_intermediate_cal core retain cell unambigu assign certain cell type cluster tasic_gene_count tasic_gene_countsmetadatasample_nam metadata metadatacsample_nam brain_regionclust set experiment design r metadataclust gsub _ metadataclust metadatagroup pastemetadatabrain_regionmetadataclustersep remov group cell type less cell remov group remov namestableinteractionmetadatabrain_regionmetadataclustertableinteractionmetadatabrain_regionmetadataclust metadata metadatawhichmetadatagroup remov group asfactormetadatagroup design modelmatrix group factori design colnamesdesign levelsgroup tasic_gene_count tasic_gene_countswhichcolnamestasic_gene_count metadatasample_nam filter r filter_all_edger_string filterbyexprtasic_gene_count design null group metadatabrain_region libsiz null mincount mintotalcount largen minprop tablefilter_all_edger_string tasic_gene_count tasic_gene_countsfilter_all_edger_string visual gener figur panel dge figur ensmusg gene contrast ie visp hsdbendou cell versu alm tnc cell r prepar plot plot_data cbindmetadatametadatagroup calml_it_alm_tncvispl_it_visp_hsdb_endoutasic_gene_countsensmusgmetadatagroup calml_it_alm_tncvispl_it_visp_hsdb_end sampl order datafram colnamesplot_data count plot_datagroupwhichplot_datagroup vispl_it_visp_hsdb_end hsdb_endou plot_datagroupwhichplot_datagroup alml_it_alm_tnc tnc plot_datagroup factorplot_datagroup levelsctnc hsdb_endou plot_datavari ensmusg label_facet functiongeneid lev levelsasfactorgeneid lab edger fdr nameslab lev returnlab plot pngresultscasestudyfiguredpng width height unit re pointsiz ggplotplot_data map aesxgroupycountsfillbrain_region geom_violin scale_fill_manualvaluescroyalblu firebrick geom_pointdata plot_data aesxgroupycountss posit position_jitterdodgejitterwidth jitterheight dodgewidth stat_summaryfunmean geompoint posit position_dodgewidth shape size colour cyan stat_summaryfunmedian geompoint posit position_dodgewidth shape size colour green theme_bw ggtitleensmusg facet_wrapvari ncol label labellervari label_facetplot_datavari ylabgen express count xlabgroup themeaxistextx element_textangl vjust hjust size themestriptext element_texts facebold themeplottitl element_texts facebold devoff plot_datacounts_sc plot_datacountsysamplesnormfactorsmetadatagroup calml_it_alm_tncvispl_it_visp_hsdb_end dge analysi edger fit model r dgelistcountstasic_gene_count groupgroup calcnormfactorsi estimatedispydesign design take minut fit glmqlfiti design design fast construct design matrix r creat contrast matrix dtu analysi origin tasic et al analysi l matrix ncol nrow ncoldesign rownamesl colnamesdesign colnamesl cc c c c c c c c lcvispl_it_visp_batf alml_it_alm_cpa_gpr c lcvispl_it_visp_cola alml_it_alm_cbln_fezf c lcvispl_it_visp_cola_fezf alml_it_alm_cpa_gpr c lcvispl_it_visp_cola_fezf alml_it_alm_gkn_pcdh c lcvispl_it_visp_hsdb_end alml_it_alm_lypd_gpr c lcvispl_it_visp_hsdb_end alml_it_alm_tnc c lcvispl_it_visp_hsdb_end alml_it_alm_tmem_dmrtb c lcvispl_it_visp_whrn_tox alml_it_alm_tmem_arhgap c test r treat foldchang threshold resultstreat applyl functioni glmtreatglmfitfit contrasti lfc toptreat lapplyresultstreat toptag nnrowi take four minut show number de gene sigstreat_ c seq_alongtoptreat sigstreat_ csigstreat_sumtoptreatitablefdr sigstreat_ number de gene per contrast sumsigstreat_ total number de gene gsea get signific de gene fdr edger treat r sinkfil resultscasestudygseatasic_lit_contrast_edger_dgetxt catrownamestoptreattabletoptreattablefdr n sink sinkfil resultscasestudygseatasic_lit_contrast_edger_dgetxt catrownamestoptreattabletoptreattablefdr n sink sinkfil resultscasestudygseatasic_lit_contrast_edger_dgetxt catrownamestoptreattabletoptreattablefdr n sink suppli txt file gsea engin msigdb strong evid enrich biolog process relat synaps neuron project interest context tasic et al paper save result r saverdstoptreat filedatatasic_casestudy_edgerrd save access later comparison script titl doubleexpseq_analysi author jeroen gili date output html_document script perform dtu analysi doubleexpseq subset cell singlecel rnaseq dataset tasic et al tasic paperhttpsdoiorg order run script three file download zenodo place data folder github repositori tasic_casestudy_transcript_countsrd transcriptlevel express matrix tasic_metadata_xlsx tasic_metadata_csv note metadata file ident one supplement tasic et al supplementary_table__full_metadataxlsx gse_accession_tablecsv respect also note raw data avail geohttpswwwncbinlmnihgovgeoqueryacccgiaccgs figur gener script avail github repositori resultscasestudi r setup includefals echofals requireknitr opts_knitsetrootdir rprojrootfind_rstudio_root_fil load librari rmessagefals data import libraryannotationhub libraryensembldb libraryopenxlsx analysi libraryedg librarytidyvers librarydoubleexpseq librarysummarizedexperi visual libraryggplot data import import transcript inform r messagefals ah annotationhub load annot resourc queryah ensdb queri avail ensdb databas ahedb allah mu musculu tx transcriptsahedb txgene asdataframematrixdata na nrow lengthtx ncol colnamestxgen ctxnamegeneid txgenetxnam txstx_id txgenegeneid txsgene_id import count r tasic_count readrdsdatatasic_casestudy_transcript_countsrd alreadi remov gene zero count cell tasic_count tasic_countsrowsumstasic_count dimtasic_count import metadata r access readcsvdatatasic_metadata_csvsep access accessmatchcolnamestasic_countsaccesssra_run metadata openxlsxreadxlsxdatatasic_metadata_xlsx metadata metadatamatchaccesssample_namemetadatasample_nam colnamestasic_count metadatasample_nam metadata metadatametadatacore_intermediate_cal core retain cell unambigu assign certain cell type cluster tasic_count tasic_countsmetadatasample_nam metadata metadatacsample_nam brain_regionclust data wrangl r remov transcript isoform express certain gene txinfo txgene colnamestxinfo cisoform_idgene_id rownamestxinfo null rownamestasic_count sub rownamestasic_count txinfo txinfotxinfoisoform_id rownamestasic_count txinfo subsettxinfoduplicatedgene_id duplicatedgene_id fromlasttru tasic_count tasic_countswhichrownamestasic_count txinfoisoform_id set experiment design r metadataclust gsub _ metadataclust metadatagroup pastemetadatabrain_regionmetadataclustersep remov group cell type less cell remov group remov namestableinteractionmetadatabrain_regionmetadataclustertableinteractionmetadatabrain_regionmetadataclust metadata metadatawhichmetadatagroup remov group asfactormetadatagroup design modelmatrix group factori design colnamesdesign levelsgroup tasic_count tasic_countswhichcolnamestasic_count metadatasample_nam filter r filter_all_edger_string filterbyexprtasic_count design null group metadatabrain_region libsiz null mincount mintotalcount largen minprop tablefilter_all_edger_string tasic_count tasic_countsfilter_all_edger_string r updat txinfo accord filter procedur txinfo txinfowhichtxinfoisoform_id rownamestasic_count remov transcript isoform express certain gene filter txinfo subsettxinfoduplicatedgene_id duplicatedgene_id fromlasttru tasic_count tasic_countswhichrownamestasic_count txinfoisoform_id saturn requir transcript rowdata transcript count matrix order result model match wrong rowdata txinfo txinfomatchrownamestasic_countstxinfoisoform_id rmlist setdiffl ctasic_count txinfo design metadata txgenegroup invisiblegc analysi r get txgene better format geneforeachtx txgenegeneidmatchrownamestasic_countstxgenetxnam groupid ascharactergeneforeachtx get total count forcycl splitnrowtasic_count ascharactergroupid totalcount lapplyforcycl functioni sct tasic_countsi drop fals rs tsapplynrowsct functionr colsumssct drop fals rownamesr rownamessct rs totalcount docallrbind totalcount stopifnotallrownamestasic_count rownamestotalcount totalcount totalcountrownamestasic_count doubleexpseq need test contrast separ ie fit model time sinc contrast r defin contrast numer doubleexpseq contrast listcccccccc des_result list systim seq_alongcontrast mdoubl suppresswarningsdbglmi tasic_count totalcount group group shrinkmethodweb contrast contrastsi useallgroupstru des_resultsi mdoubl systim display number dtu transcript transcript r seq_alongdes_result printsumdes_resultsialladjpv narm save final object save result object later comparison result saturn limma diffsplic r saverdsdes_result datatasic_casestudy_doubleexpseqrd titl comparison_saturn_doubleexpseq author jeroen gili date output html_document script perform qualit comparison result dtu analysi saturn dtu analysi doubleexpseq order run script two file download zenodo place data folder github repositori tasic_casestudy_saturnrd saturn dtu result tasic_casestudy_doubleexpseqrd doubleexpseq dtu result figur gener script avail github repositori resultscasestudi r setup includefals echofals requireknitr opts_knitsetrootdir rprojrootfind_rstudio_root_fil load librari r messagefals warningfals librarysummarizedexperi librarysaturn libraryggplot librarytidyvers librarylocfdr load data result analys tasic case studi saturn gener saturn_analysisrmd doubleexpseq gener doubleexpseq_analysisrmd r saturn_result readrdsfiledatatasic_casestudy_saturnrd doubleexpseq_result readrdsfiledatatasic_casestudy_doubleexpseqrd doubleexpseq pvalu distribut figur doubleexpseq display patholog distribut pvalu r seq_alongdoubleexpseq_result pngpasteresultscasestudyfigures_ png sep width height unit re pointsiz start export histdoubleexpseq_resultsiallpvalbreaksmain pastecontrast ixlabpvalu devoff de find larg number dtu transcript r seq_alongdoubleexpseq_result printsumdoubleexpseq_resultsialladjpv narm use locfdr result doubleexpseq problemat r doubleexpseq_results_locfdr list seq_alongdoubleexpseq_result direct ifelsedoubleexpseq_resultsialldoubleexpseq_resultsial pval doubleexpseq_resultsiallpv fdr doubleexpseq_resultsialladjpv z qnormpval signdirect z_work zisnaz z_work z_workingabsz_work current_plot locfdrz_work start code locfdr n lengthz_work b exp logn med medianz_work sc diffquantilez_workingc qnorm mlest locfdrlocmlez_work xlim cmed b sc lo minz_work maxz_work bre break seqlo length bre zzz pmaxpminz_work lo zh histzzz break break plot f x break breakslengthbreak sw x cbind polyx df zh histzzz break break plot f zhcount f glmi polyx df poissonfit covin listx x x x f f sw sw mlout locfdrlocmlez_work xlim cmlest b mlest mlest mlest covin covin mlest mloutml end code locfdr mlest saturnpadjust_empiricalz_workingdirect zval_empir z mlestsmlest pval_empir pnormabszval_empir mean sd pval_empiricalzval_empir inf fdr_empir padjustpval_empir method bh set na na repna lengthnamespvalwhichnamespvalinnamespval_empir namesna namespvalwhichnamespvalinnamespval_empir pval_empir cpval_empiricalna fdr_empir cfdr_empiricalna pval_empir pval_empiricalmatchnamespvalnamespval_empir fdr_empir fdr_empiricalmatchnamespvalnamesfdr_empir des_empir dataframepvalfdrpval_empiricalfdr_empir rownamesdes_empir rownamesdoubleexpseq_resultsial doubleexpseq_results_locfdri des_empir gener figur r direct ifelsedoubleexpseq_resultsalldoubleexpseq_resultsal pval doubleexpseq_resultsallpv fdr doubleexpseq_resultsalladjpv z qnormpval signdirect z_work zisnaz z_work z_workingabsz_work pngresultscasestudyfigurespng width height unit re pointsiz current_plot suppresswarningslocfdrz_work devoff larg number pvalu exatli doubleexpseq result jeopard use empir null control number fals posit discoveri titl scalabilitybenchmark author jeroen gili date output html_document run script requir folder scalability_runtim data folder repositori unzip scalability_runtim either gener run unix exeuct runtim download zenodo r setup includefals echofals requireknitr opts_knitsetrootdir rprojrootfind_rstudio_root_fil load librari r messagefals libraryggplot librarytidyvers read result r read saturn result loaddatascalability_runtimessaturn_rdata loaddatascalability_runtimessaturn_rdata read limmadiffsplic result loaddatascalability_runtimeslimmadiffsplice_rdata loaddatascalability_runtimeslimmadiffsplice_rdata read edgerdiffsplic result loaddatascalability_runtimesedgerdiffsplice_rdata loaddatascalability_runtimesedgerdiffsplice_rdata read drimseq result loaddatascalability_runtimesdrimseq_rdata loaddatascalability_runtimesdrimseq_rdata read doubleexpseq result loaddatascalability_runtimesdoubleexpseq_rdata loaddatascalability_runtimesdoubleexpseq_rdata read dexseq result loaddatascalability_runtimesdexseq_rdata loaddatascalability_runtimesdexseq_rdata loaddatascalability_runtimesdexseq_rdata read bandit result loaddatascalability_runtimesbandits_rdata loaddatascalability_runtimesbandits_rdata concaten result r results_al csaturn_saturn_limmadiffsplice_limmadiffsplice_edgerdiffsplice_edgerdiffsplice_drimseq_drimseq_doubleexpseq_doubleexpseq_dexseq_dexseq_dexseq_bandits_bandits_ rmlistsetdiffl results_al r full_datafram asdataframematrixnrow lengthresults_al ncol colnamesfull_datafram cmethod groupsiz tx txs_round user system elaps dtu remov memori full_dataframemethod repcsaturnlimmadiffspliceedgerdiffsplicedrimseqdoubleexpseqdexseqbanditstimesc add method label round_to functionx roundxtoto get data datafram format seq_lennrowfull_datafram full_dataframegroupsizei results_alliinfos full_dataframetxsi results_alliinfotx full_dataframetxs_roundi round_tofull_dataframetxsi full_dataframeuseri unnameresults_allitim full_dataframesystemi unnameresults_allitim full_dataframeelapsedi unnameresults_allitim full_dataframedtui ifelseisnullresults_alliresultnaresults_alliresult full_dataframeremovedi results_alliremov full_dataframememoryi results_allimemori visual scalabl wrt number cell without method use gener figur panel b paper r data_k full_dataframewhichfull_dataframetxs_round pngresultsscalabilityscale_cells_intropng width height unit re pointsiz ggplotdata data_kwhichdata_kmethod saturn aesxgroupsizeyelapsedcolormethod geom_lin geom_point scale_color_manualvaluescef e fe b theme_bw ylabelaps time min xlabnumb cell per group devoff scalabl wrt number transcript without method use gener figur panel c paper r data_cel full_dataframewhichfull_dataframegroups pngresultsscalabilityscale_transcripts_intropng width height unit re pointsiz ggplotdata data_cellswhichdata_cellsmethod saturn aesxtxsyelapsedcolormethod geom_lin geom_point scale_color_manualvaluesccca ef e fe b theme_bw ylabelaps time min xlabnumb transcript devoff scalabl wrt number cell includ method use gener figur panel paper r pngresultsscalabilityscale_cells_allpng width height unit re pointsiz ggplotdata data_k aesxgroupsizeyelapsedcolormethod geom_lin geom_point scale_color_manualvaluescef e fe bblack theme_bw ylabelaps time min xlabnumb cell per group devoff r zoom pngresultsscalabilityscale_cells_all_zoompng width height unit re pointsiz ggplotdata data_kwhichdata_kmethod cdexseqdrimseq aesxgroupsizeyelapsedcolormethod geom_lin geom_point scale_color_manualvaluescb fe bblack theme_bw ylabelaps time min xlabnumb cell per group devoff scalabl wrt number transcript includ method use gener figur panel b paper r pngresultsscalabilityscale_transcripts_allpng width height unit re pointsiz ggplotdata data_cel aesxtxsyelapsedcolormethod geom_lin geom_point scale_color_manualvaluesccca ef e fe bblack theme_bw ylabelaps time min xlabnumb transcript devoff r zoom pngresultsscalabilityscale_transcripts_all_zoompng width height unit re pointsiz ggplotdata data_cellswhichdata_cellsmethod cbandit dexseqdrimseq aesxtxsyelapsedcolormethod geom_lin geom_point scale_color_manualvaluescb fe bblack theme_bw ylabelaps time min xlabnumb transcript devoff titl _chen_dtu author jeroen gili date output html_document order run script _chen_dturmd dataset chen_benchmark_datasets_countrdata altern chen_benchmark_datasets_countrdata requir file either gener _chen_preparermd script download zenodo run dtu analys method chen benchmark dataset note dexseq drimseq run dataset cell group method scale larg dataset nbsplice omit converg dataset mani zero code run approxim hour macbook pro processor ghz quadcor intel core gb ram runtim attribut dexseq drimseq analys want run script output also download zenodo chen_dtu_results_countrdata altern chen_dtu_results_scaledtpmrdata r setup includefals echofals requireknitr opts_knitsetrootdir rprojrootfind_rstudio_root_fil load dtu method sourc file allow run seven dtu method assess paper saturn doubleexpseq limma diffsplic edgerdiffsplic dexseq drimseq nbsplice r messagefals warningfals load librari libraryedg librarylimma librarydexseq librarydrimseq librarydoubleexpseq librarynbsplic librarysaturn librarydomc sourcefileperformance_benchmarksdtu_methodsr set parallel execut note optim paramet set parallel dtu analys depend specif comput system r iftru nrcore ifnrcor doparallel true doprogress none registerdomccor nrcore els doparallel fals doprogress text run analys run dtu analys method chen benchmark dataset note dexseq drimseq run dataset cell group method scale larg dataset nbsplice omit converg dataset mani zero code run approxim hour macbook pro processor ghz quadcor intel core gb ram runtim attribut dexseq drimseq analys r load benchmark data loadfiledatachen_benchmark_datasets_countrdata loadfiledatachen_benchmark_datasets_scaledtpmrdata combin chenbenchmarkdata cchenbenchmarklenientchenbenchmarkstring run dtu analys benchmark data printstart saturn tstart systim suppresswarningschendtubenchmark_saturn plyrllpli data chenbenchmarkdata inform true fun functionlocaldata perform dtu analysi localr saturn_dtu countdata localdatadata txgene localdatametainfo sampledata localdatadesign massag localresgene_modifi localdatametainfogene_modifiedmatch localrestxnam localdatametainfotxnam return result returnlistdtuanalysi localr difftimesystim tstart printstart edger_diffsplic tstart systim chendtubenchmark_edgerdiffsplic plyrllpli data chenbenchmarkdata parallel doparallel progress doprogress inform true fun functionlocaldata perform dtu analysi localr edger_diffsplice_dtu countdata localdatadata txgene localdatametainfo sampledata localdatadesign massag localresgene_modifi localdatametainfogene_modifiedmatch localrestxnam localdatametainfotxnam return result returnlistdtuanalysi localr difftimesystim tstart printstart doubleexpseq tstart systim chendtubenchmark_doubleexpseq plyrllpli data chenbenchmarkdata parallel doparallel progress doprogress inform true fun functionlocaldata perform dtu analysi localr doubleexpseq_dtu countdata localdatadata txgene localdatametainfo sampledata localdatadesign massag localresgene_modifi localdatametainfogene_modifiedmatch localrestxnam localdatametainfotxnam return result returnlistdtuanalysi localr difftimesystim tstart printstart limma diffsplic tstart systim chendtubenchmark_limmadiffsplic plyrllpli data chenbenchmarkdata parallel doparallel progress doprogress inform true fun functionlocaldata perform dtu analysi localr limma_diffsplice_dtu countdata localdatadata txgene localdatametainfo sampledata localdatadesign massag localresgene_modifi localdatametainfogene_modifiedmatch localrestxnam localdatametainfotxnam return result returnlistdtuanalysi localr difftimesystim tstart printstart dexseq dexseq tstart systim chendtubenchmark_dexseq plyrllpli data chenbenchmarkdata parallel doparallel progress doprogress inform true fun functionlocaldata ifncollocaldatadata returnnul perform dtu analysi localr dexseq_dtu countdata localdatadata txgene localdatametainfo sampledata localdatadesign massag localresgene_modifi localdatametainfogene_modifiedmatch localrestxnam localdatametainfotxnam return result returnlistdtuanalysi localr difftimesystim tstart printstart drimseq tstart systim chendtubenchmark_drimseq plyrllpli data chenbenchmarkdata parallel doparallel progress doprogress inform true fun functionlocaldata ifncollocaldatadata returnnul perform dtu analysi localr drimseq_dtu countdata localdatadata txgene localdatametainfo sampledata localdatadesign massag localresgene_modifi localdatametainfogene_modifiedmatch localrestxnam localdatametainfotxnam return result returnlistdtuanalysi localr difftimesystim tstart add method name list name easi postanalysi nameschendtubenchmark_saturn pastesaturn_ nameschendtubenchmark_saturn nameschendtubenchmark_limmadiffsplic pastelimma_diffsplice_ nameschendtubenchmark_limmadiffsplic nameschendtubenchmark_dexseq pastedexseq_ nameschendtubenchmark_dexseq nameschendtubenchmark_drimseq pastedrimseq_ nameschendtubenchmark_drimseq nameschendtubenchmark_edgerdiffsplic pasteedger_diffsplice_ nameschendtubenchmark_edgerdiffsplic nameschendtubenchmark_doubleexpseq pastedoubleexpseq_ nameschendtubenchmark_doubleexpseq save result save chendtubenchmark_saturn chendtubenchmark_limmadiffsplic chendtubenchmark_dexseq chendtubenchmark_drimseq chendtubenchmark_edgerdiffsplic chendtubenchmark_doubleexpseq filedatachen_dtu_results_countrdata save chendtubenchmark_saturn chendtubenchmark_limmadiffsplic chendtubenchmark_dexseq chendtubenchmark_drimseq chendtubenchmark_edgerdiffsplic chendtubenchmark_doubleexpseq filedatachen_dtu_results_scaledtpmrdata titl _chen_visu author jeroen gili date output html_document order run script _chen_visualizermd dataset chen_benchmark_datasets_countrdata chen_dtu_results_countrdata altern chen_benchmark_datasets_scaledtpmrdata chen_dtu_results_scaledtpmrdata requir file either gener _chen_preparermd _chen_dturmd script respect download zenodo put data folder github repositori result script fdrtpr curv alreadi avail github directori resultschen_benchmark r setup includefals echofals requireknitr opts_knitsetrootdir rprojrootfind_rstudio_root_fil load librari rmessagefalsewarningfals libraryggplot libraryicobra load truth file r loadfiledatachen_benchmark_datasets_countrdata loadfiledatachen_benchmark_datasets_scaledtpmrdata metainfo cchenbenchmarklenientchenbenchmarkstring rmchenbenchmarklenientchenbenchmarkstring load dtu perform result r loadfiledatachen_dtu_results_countrdata loadfiledatachen_dtu_results_scaledtpmrdata chenbenchmark c chendtubenchmark_saturn chendtubenchmark_limmadiffsplic chendtubenchmark_dexseq chendtubenchmark_drimseq chendtubenchmark_edgerdiffsplic chendtubenchmark_doubleexpseq remov empti entri due test aka mani sampl reason runtim chenbenchmark chenbenchmarkwhich sapplychenbenchmark functionx isnullxdtuanalysi rmchendtubenchmark_saturn chendtubenchmark_limmadiffsplic chendtubenchmark_dexseq chendtubenchmark_drimseq chendtubenchmark_edgerdiffsplic chendtubenchmark_doubleexpseq invisiblegc helper function get pvalu differ method differ dataset r get_pvalu functiondatasetnrepnmethod get_all_tx functiondatasetnrep all_tx c nrep current_tx ascharacterdatasetidtuanalysistxnam all_tx call_tx current_tx all_tx uniqueall_tx returnall_tx all_tx get_all_txsdatasetnrep pvalu matrixdatana nrowlengthall_tx ncolnmethodsnrep rownamespvalu all_tx nmethodsnrep pvalues_new dataframedatasetidtuanalysisp_valu rownamespvalues_new datasetidtuanalysistxnam colnamespvalues_new namesdataseti pvaluesi pvalues_newmatchrownamespvaluesrownamespvalues_new pvalu applypvalu asnumer rownamespvalu all_tx pvalu asdataframepvalu pvalu pvaluesorderrownamespvalu ifnmethod colnamespvalu csaturn limma_diffsplic dexseq drimseqedger_diffsplic doubleexpseq els colnamespvalu csaturn limma_diffspliceedger_diffsplic doubleexpseq returnpvalu visual function r visualize_dataset functiondatasetmetainfonfiltersnsamplesizesnrepnmethodsselectionselect count nplot nfilter nsamples printpastethi function gener nplot plot j nplot printj chen_current_out datasetgreplselectionj namesdataset metainfo_current_out metainfogreplselectionj namesmetainfo reslist c count count k lengthnrep chen_current_inn chen_current_outergreplnrepk nameschen_current_out metainfo_current_inn metainfo_current_outergreplnrepk namesmetainfo_current_out pvalu get_pvalueschen_current_innernrepnmethod truth_fil chen_current_innerdtuanalysi ifcount nsamples txswap metainfo_current_inn els txswap metainfo_current_inn truth_fil truth_filectxnamep_valu txswappedmetainfo txswappedmetainfomatchtruth_filetxnametxswappedmetainfotxnam truth_filegene_modifi asnumerictxswappedmetainfotxswap truth_fil truth_fileordertruth_filetxnam rownamestruth_fil truth_filetxnam reslistk listpvaluestruth_fil rownamesreslist pasterownamesreslist _ rownamesreslist pasterownamesreslist _ rownamesreslist pasterownamesreslist _ pvalues_ful rbindreslistreslistreslist rownamesreslist pasterownamesreslist _ rownamesreslist pasterownamesreslist _ rownamesreslist pasterownamesreslist _ truth_file_ful rbindreslistreslistreslist cobra cobradatapv pvalues_ful truth truth_file_ful cobra calculate_adjpcobra cobraperf calculate_performancecobra binary_truth gene_modifi cont_truth none splv none aspect cfdrtpr fdrtprcurv overlap cobraplot prepare_data_for_plotcobraperf colorschem dark facet true nmethod new_col crepcef e fe b black repwhit namesnew_col namescobraplotplotcolor cobraplotplotcolor new_col plot plot_fdrtprcurvecobraplot xaxisrang c yaxisrang c titl c versu edger filter count versu drimseq filter count titl c versu edger filter scaledtpm versu drimseq filter scaledtpm current_titl titlesj els new_col crepcb fe b black repwhit namesnew_col namescobraplotplotcolor cobraplotplotcolor new_col plot plot_fdrtprcurvecobraplot xaxisrang c yaxisrang c titl c versu edger filter count versu drimseq filter count titl c versu edger filter scaledtpm versu drimseq filter scaledtpm current_titl titlesj plot plot ggtitlecurrent_titl themestripbackground element_blank striptextx element_blank plottitl element_texts axistextx element_texts axistexti element_texts axistitlex element_texts axistitley element_texts pngpasteresultschen_benchmarkfdrtpr_ selectionj _ subf selectionj _countpng sep width height unit re pointsiz start export printplot devoff pngpasteresultschen_benchmarkfdrtpr_ selectionj _ subf selectionj _scaledtpmpng sep width height unit re pointsiz start export printplot devoff gener fdrtpr curv r select c_rep__filterlenient_rep__filterstring select c_rep_rep visualize_datasetschenbenchmark metainfo nfilter nsamples nrepcrep_rep_rep_ nmethod select select selectionselect select c__rep__filterlenient__rep__filterstring select c_rep_rep visualize_datasetschenbenchmark metainfo nfilter nsamples nrepcrep_rep_rep_ nmethod select select selectionselect titl _chen_ssrmd author jeroen gili date output html_document script _chen_ssrmd seper script reproduc figur public order run script _love_dtu_subsetrmd dataset love_benchmark_datasets_scaledtpmrdata altern love_benchmark_datasets_countrdata requir file either gener _love_preparermd script download zenodo r setup includefals echofals requireknitr opts_knitsetrootdir rprojrootfind_rstudio_root_fil load librari rmessagefalsewarningfals libraryggplot libraryicobra load truth file r loadfiledatachen_benchmark_datasets_countrdata loadfiledatachen_benchmark_datasets_scaledtpmrdata metainfo cchenbenchmarklenientchenbenchmarkstring rmchenbenchmarklenientchenbenchmarkstring load dtu perform result r loadfiledatachen_dtu_results_countrdata loadfiledatachen_dtu_results_scaledtpmrdata chenbenchmark c chendtubenchmark_saturn chendtubenchmark_limmadiffsplic chendtubenchmark_dexseq chendtubenchmark_drimseq chendtubenchmark_edgerdiffsplic chendtubenchmark_doubleexpseq remov empti entri due test aka mani sampl reason runtim chenbenchmark chenbenchmarkwhich sapplychenbenchmark functionx isnullxdtuanalysi rmchendtubenchmark_saturn chendtubenchmark_limmadiffsplic chendtubenchmark_dexseq chendtubenchmark_drimseq chendtubenchmark_edgerdiffsplic chendtubenchmark_doubleexpseq invisiblegc figur sc r tval chenbenchmarksaturn_samples_used__rep__filterlenientdtuanalysistvalu pval chenbenchmarksaturn_samples_used__rep__filterlenientdtuanalysisp_value_raw zval qnormpval signtval zval_mid zvalabszv zval_mid zval_midisnazval_mid pngresultschen_benchmarkfigscpng width height unit re pointsiz start export plot locfdrlocfdrzval_mid main chen dataset v edger filter repeat devoff figur sd r dataset saturn_samples_used__rep__filterleni chen_select chenbenchmarkdatasetdtuanalysi truth metainfosubstrdatasetnchardatasetmetainfo pvalu asdataframecbindchen_selectp_value_rawchen_selectp_valu colnamespvalu ctheoretical_nul empirical_nul rownamespvalu rownameschen_select rownamestruth truthtxnam cobra cobradatapv pvalu truth truth cobra calculate_adjpcobra cobraperf calculate_performancecobra binary_truth txswap cont_truth none splv none aspect cfdrtpr fdrtprcurv overlap cobraplot prepare_data_for_plotcobraperf colorschem dark facet true new_col crepcblack grey repwhit namesnew_col namescobraplotplotcolor cobraplotplotcolor new_col plot plot_fdrtprcurvecobraplot xaxisrang c yaxisrang c plot plot ggtitlelabelchen dataset v edger filter repeat xlabfdp themestripbackground element_blank striptextx element_blank plottitl element_texts axistextx element_texts axistexti element_texts axistitlex element_texts axistitley element_texts pngresultschen_benchmarkfigsdpng width height unit re pointsiz start export printplot devoff figur sa r data chenbenchmarkdoubleexpseq_samples_used__rep__filterlenientdtuanalysi pngresultschen_benchmarkfigsapng width height unit re pointsiz start export histdatap_valuebreakscolwhitemain chen dataset v edger filter repeat xlab pvalu figur sb r direct datasign pval datap_valu z qnormpval signdirect z_work zisnaz z_work z_workingabsz_work pngresultschen_benchmarkfigsbpng width height unit re pointsiz current_plot suppresswarningslocfdrlocfdrz_work main chen dataset v edger filter repeat devoff titl _chen_prepar author jeroen gili date output html_document order run script _chen_perparermd correspond express count file chen_countsrd altern chen_scaledtpmrd download zenodo addit metadata chen_metadatacsv also download zenodo file must copi data folder github page note raw data avail geohttpswwwncbinlmnihgovgeoqueryacccgiaccgs one want run script output also download zenodo chen_benchmark_datasets_countrdata altern chen_benchmark_datasets_scaledtpmrdata r setup includefals echofals requireknitr opts_knitsetrootdir rprojrootfind_rstudio_root_fil load librari rmessagefalsewarningfals libraryedg librarydrimseq libraryannotationhub libraryensembldb librarydomc load data metadata r chen_count readrdsfil datachen_countsrd chen_count readrdsfil datachen_scaledtpmrd remov transcript zero count cell chen_count chen_countswhichrowsumschen_count metadata readcsvdatachen_metadatacsv rownamesmetadata metadatarun metadata metadatacolnameschen_count load genom annot r messagefals load annot resourc ah annotationhub queri avail ensdb databas queryah ensdb ahedb allah mu musculu tx transcriptsahedb extract gene info txgene asdataframematrixdata na nrow lengthtx ncol colnamestxgen ctxnamegeneid txgenetxnam txstx_id txgenegeneid txsgene_id txinfo txgene colnamestxinfo cisoform_idgene_id rownamestxinfo null txinfo txinfowhich greplercc txinfoisoform_id txinfo txinfowhichtxinfoisoform_id sub rownameschen_count txinfoisoform_id rownameschen_countsmatchtxinfoisoform_idsub rownameschen_count subset chen data gener benchmark dataset need know ground truth ie transcript differenti use group sampl end first gener mock dataset dtu expect introduc dtu group transcriptabundanceswap strategi discuss van den berg et al stager paperhttpsdoiorg order obtain mock dataset need construct dataset ideal dtu expect tri achiev subsampl homogen set sampl chen dataset base follow criteria metadatacell_typ epi metadatasex femal r select homogen set cell metadata metadatawhichmetadatacell_typ epi metadatasex femal chen_count chen_countsascharactermetadatarun setup gener benchmark data set hyperparamet benchmark dataset ie sampl size number repeat fraction dtu gene paramet parallel process r set paramet samplesprcondit c nrrepsmad fracgenesaffect nrcorestous set parallel process ifnrcorestous doparallel true doprogress none registerdomccor nrcorestous els doparallel fals doprogress text list loop nrreplist split rep x samplesprcondit time nrrepsmad past samples_used_ rep x samplesprcondit time nrrepsmad _rep_ sort rep x nrrepsmad time lengthsamplesprcondit gener gtex benchmark data r sourcefileperformance_benchmarksgetbenchmark_datar r chenbenchmarkleni getbenchmark_datacountdatachen_count metadatatxinfo filteredg edger_filter_spec listmincount mintotalcount largen minprop nrreplistnrreplist fracgenesaffect nameschenbenchmarkleni pastenamesnrreplist_filterleni chenbenchmarkstring getbenchmark_datacountdatachen_count metadatatxinfo filterdrimseq nrreplistnrreplist fracgenesaffect nameschenbenchmarkstring pastenamesnrreplist_filterstring save chen benchmark data r savechenbenchmarkleni chenbenchmarkstring filedatachen_benchmark_datasets_countrdata savechenbenchmarkleni chenbenchmarkstring filedatachen_benchmark_datasets_scaledtpmrdata titl _tasic_prepar author jeroen gili date output html_document order run script _tasic_perparermd express count matrix tasic_countsrd altern tasic_scaledtpmrd download zenodo addit two metadata file tasic_metadata_xlsx tasic_metadata_csv also download zenodo three file must copi data folder github page note metadata file ident one supplement paper tasic et al tasic paperhttpsdoiorg supplementary_table__full_metadataxlsx gse_accession_tablecsv respect also note raw data avail geohttpswwwncbinlmnihgovgeoqueryacccgiaccgs want run script output also download zenodo tasic_benchmark_datasets_countrdata altern tasic_benchmark_datasets_scaledtpmrdata r setup includefals echofals requireknitr opts_knitsetrootdir rprojrootfind_rstudio_root_fil load librari rmessagefalsewarningfasl libraryedg librarydrimseq libraryopenxlsx libraryannotationhub libraryensembldb librarydomc load data metadata r tasic_count readrdsfil datatasic_countsrd tasic_count readrdsfil datatasic_scaledtpmrd metadata_ openxlsxreadxlsxdatatasic_metadata_xlsx metadata_ readcsvdatatasic_metadata_csvsep load genom annot r messagefals load annot resourc ah annotationhub queri avail ensdb databas queryah ensdb ahedb allah mu musculu tx transcriptsahedb txgene asdataframematrixdata na nrow lengthtx ncol colnamestxgen ctxnamegeneid txgenetxnam txstx_id txgenegeneid txsgene_id extract gene info txinfo txgene colnamestxinfo cisoform_idgene_id rownamestxinfo null txinfo txinfowhich greplercc txinfoisoform_id subset tasic data gener benchmark dataset need know ground truth ie transcript differenti use group sampl end first gener mock dataset dtu expect introduc dtu group transcriptabundanceswap strategi discuss van den berg et al stager paperhttpsdoiorg order obtain mock dataset need construct dataset ideal dtu expect therefor quantifi cell correspond follow criteria metadata_subclass lamp metadata_brain_region alm metadata_eye_conditionnorm additon subsampl cell meet criterium metadata_clust lamp lsp r remov transcript zero count cell tasic_count tasic_countswhichrowsumstasic_count metadata_ metadata_metadata_sample_nam metadata_whichmetadata_sra_run colnamestasic_countssample_nam metadata_ metadata_metadata_clust lamp lsp metadata_ metadata_whichmetadata_sample_nam metadata_sample_nam tasic_count tasic_countscolnamestasic_countsinmetadata_sra_run make rownam count frame compat txinfo frame rownamestasic_count sub rownamestasic_count setup gener benchmark data set hyperparamet benchmark dataset ie sampl size number repeat fraction dtu gene paramet parallel process r set paramet samplesprcondit c nrrepsmad fracgenesaffect nrcorestous set parallel process ifnrcorestous doparallel true doprogress none registerdomccor nrcorestous els doparallel fals doprogress text list loop nrreplist split rep x samplesprcondit time nrrepsmad past samples_used_ rep x samplesprcondit time nrrepsmad _rep_ sort rep x nrrepsmad time lengthsamplesprcondit gener tasic benchmark data r sourcefileperformance_benchmarksgetbenchmark_datar r tasicbenchmarkleni getbenchmark_datacountdatatasic_count metadatatxinfo filteredg edger_filter_spec listmincount mintotalcount largen minprop nrreplistnrreplist fracgenesaffect namestasicbenchmarkleni pastenamesnrreplist_filterleni tasicbenchmarkstring getbenchmark_datacountdatatasic_count metadatatxinfo filterdrimseq nrreplistnrreplist fracgenesaffect namestasicbenchmarkstring pastenamesnrreplist_filterstring save tasic benchmark data r savetasicbenchmarkleni tasicbenchmarkstring filedatatasic_benchmark_datasets_countrdata savetasicbenchmarkleni tasicbenchmarkstring filedatatasic_benchmark_datasets_scaledtpmrdata titl _tasic_dtu author jeroen gili date output html_document order run script _tasic_dturmd dataset tasic_benchmark_datasets_countrdata altern tasic_benchmark_datasets_scaledtpmrdata requir file either gener _tasic_preparermd script download zenodo run dtu analys method tasic benchmark dataset note dexseq drimseq run dataset cell group method scale larg dataset nbsplice omit converg dataset mani zero code run approxim hour macbook pro processor ghz quadcor intel core gb ram runtim attribut dexseq drimseq analys want run script output also download zenodo tasic_dtu_results_countrdata altern tasic_dtu_results_scaledtpmrdata r setup includefals echofals requireknitr opts_knitsetrootdir rprojrootfind_rstudio_root_fil load dtu method sourc file allow run seven dtu method assess paper saturn doubleexpseq limma diffsplic edgerdiffsplic dexseq drimseq nbsplice r messagefals warningfals load librari libraryedg librarylimma librarydexseq librarydrimseq librarydoubleexpseq librarynbsplic librarysaturn librarydomc sourcefileperformance_benchmarksdtu_methodsr set parallel execut note optim paramet set parallel dtu analys depend specif comput system r iftru nrcore ifnrcor doparallel true doprogress none registerdomccor nrcore els doparallel fals doprogress text run analys run dtu analys method chen benchmark dataset note dexseq drimseq run dataset cell group method scale larg dataset nbsplice omit converg dataset mani zero code run approxim hour macbook pro processor ghz quadcor intel core gb ram runtime attribut dexseq drimseq analys r load benchmark data loadfiledatatasic_benchmark_datasets_countrdata loadfiledatatasic_benchmark_datasets_scaledtpmrdata tasicbenchmarkdata ctasicbenchmarklenienttasicbenchmarkstring run dtu analysi benchmark data printstart saturn tstart systim suppresswarningstasicdtubenchmark_saturn plyrllpli data tasicbenchmarkdata inform true fun functionlocaldata perform dtu analysi localr saturn_dtu countdata localdatadata txgene localdatametainfo sampledata localdatadesign massag localresgene_modifi localdatametainfogene_modifiedmatch localrestxnam localdatametainfotxnam return result returnlistdtuanalysi localr difftimesystim tstart printstart limma diffsplic tstart systim tasicdtubenchmark_limmadiffsplic plyrllpli data tasicbenchmarkdata parallel doparallel progress doprogress inform true fun functionlocaldata perform dtu analysi localr limma_diffsplice_dtu countdata localdatadata txgene localdatametainfo sampledata localdatadesign massag localresgene_modifi localdatametainfogene_modifiedmatch localrestxnam localdatametainfotxnam return result returnlistdtuanalysi localr difftimesystim tstart printstart edger_diffsplic tstart systim tasicdtubenchmark_edgerdiffsplic plyrllpli data tasicbenchmarkdata parallel doparallel progress doprogress inform true fun functionlocaldata perform dtu analysi localr edger_diffsplice_dtu countdata localdatadata txgene localdatametainfo sampledata localdatadesign massag localresgene_modifi localdatametainfogene_modifiedmatch localrestxnam localdatametainfotxnam return result returnlistdtuanalysi localr difftimesystim tstart printstart doubleexpseq tstart systim tasicdtubenchmark_doubleexpseq plyrllpli data tasicbenchmarkdata parallel doparallel progress doprogress inform true fun functionlocaldata perform dtu analysi localr doubleexpseq_dtu countdata localdatadata txgene localdatametainfo sampledata localdatadesign massag localresgene_modifi localdatametainfogene_modifiedmatch localrestxnam localdatametainfotxnam return result returnlistdtuanalysi localr difftimesystim tstart printstart dexseq dexseq tstart systim tasicdtubenchmark_dexseq plyrllpli data tasicbenchmarkdata parallel doparallel progress doprogress inform true fun functionlocaldata ifncollocaldatadata returnnul perform dtu analysi localr dexseq_dtu countdata localdatadata txgene localdatametainfo sampledata localdatadesign massag localresgene_modifi localdatametainfogene_modifiedmatch localrestxnam localdatametainfotxnam return result returnlistdtuanalysi localr difftimesystim tstart printstart drimseq tstart systim tasicdtubenchmark_drimseq plyrllpli data tasicbenchmarkdata parallel doparallel progress doprogress inform true fun functionlocaldata ifncollocaldatadata returnnul perform dtu analysi localr drimseq_dtu countdata localdatadata txgene localdatametainfo sampledata localdatadesign massag localresgene_modifi localdatametainfogene_modifiedmatch localrestxnam localdatametainfotxnam return result returnlistdtuanalysi localr difftimesystim tstart add method name list name easi postanalysi namestasicdtubenchmark_saturn pastesaturn_ namestasicdtubenchmark_saturn namestasicdtubenchmark_limmadiffsplic pastelimma_diffsplice_ namestasicdtubenchmark_limmadiffsplic namestasicdtubenchmark_dexseq pastedexseq_ namestasicdtubenchmark_dexseq namestasicdtubenchmark_drimseq pastedrimseq_ namestasicdtubenchmark_drimseq namestasicdtubenchmark_edgerdiffsplic pasteedger_diffsplice_ namestasicdtubenchmark_edgerdiffsplic namestasicdtubenchmark_doubleexpseq pastedoubleexpseq_ namestasicdtubenchmark_doubleexpseq save result savetasicdtubenchmark_saturn tasicdtubenchmark_limmadiffsplic tasicdtubenchmark_dexseq tasicdtubenchmark_drimseq tasicdtubenchmark_edgerdiffsplic tasicdtubenchmark_doubleexpseq filedatatasic_dtu_results_countrdata savetasicdtubenchmark_saturn tasicdtubenchmark_limmadiffsplic tasicdtubenchmark_dexseq tasicdtubenchmark_drimseq tasicdtubenchmark_edgerdiffsplic tasicdtubenchmark_doubleexpseq filedatatasic_dtu_results_scaledtpmrdata titl _tasic_visu author jeroen gili date output html_document order run script _tasic_visualizermd dataset tasic_benchmark_datasets_countrdata tasic_dtu_results_countrdata altern tasic_benchmark_datasets_scaledtpmrdata tasic_dtu_results_scaledtpmrdata requir file either gener _tasic_preparermd _tasic_dturmd script respect download zenodo put data folder github repositori result script fdrtpr curv alreadi avail github directori resultstasic_benchmark r setup includefals echofals requireknitr opts_knitsetrootdir rprojrootfind_rstudio_root_fil load librari rmessagefalsewarningfals libraryggplot libraryicobra load truth file r loadfiledatatasic_benchmark_datasets_countrdata loadfiledatatasic_benchmark_datasets_scaledtpmrdata metainfo ctasicbenchmarklenienttasicbenchmarkstring rmtasicbenchmarklenienttasicbenchmarkstring load dtu perform data r loadfiledatatasic_dtu_results_countrdata loadfiledatatasic_dtu_results_scaledtpmrdata run visual scaledtpm data tasicbenchmark c tasicdtubenchmark_saturn tasicdtubenchmark_limmadiffsplic tasicdtubenchmark_dexseq tasicdtubenchmark_drimseq tasicdtubenchmark_edgerdiffsplic tasicdtubenchmark_doubleexpseq remov empti enteri due test aka mani sampl reason runtim tasicbenchmark tasicbenchmarkwhich sapplytasicbenchmark functionx isnullxdtuanalysi rmtasicdtubenchmark_saturn tasicdtubenchmark_limmadiffsplic tasicdtubenchmark_dexseq tasicdtubenchmark_drimseq tasicdtubenchmark_edgerdiffsplic tasicdtubenchmark_doubleexpseq invisiblegc helper function get pvalu differ method differ dataset r get_pvalu functiondatasetnrepnmethod get_all_tx functiondatasetnrep all_tx c nrep current_tx ascharacterdatasetidtuanalysistxnam all_tx call_tx current_tx all_tx uniqueall_tx returnall_tx all_tx get_all_txsdatasetnrep pvalu matrixdatana nrowlengthall_tx ncolnmethodsnrep rownamespvalu all_tx nmethodsnrep pvalues_new dataframedatasetidtuanalysisp_valu rownamespvalues_new ascharacterdatasetidtuanalysistxnam colnamespvalues_new namesdataseti pvaluesi pvalues_newmatchrownamespvaluesrownamespvalues_new pvalu applypvalu asnumer rownamespvalu all_tx pvalu asdataframepvalu pvalu pvaluesorderrownamespvalu ifnmethod colnamespvalu csaturn limma_diffsplic dexseq drimseqedger_diffsplic doubleexpseq els colnamespvalu csaturn limma_diffspliceedger_diffsplic doubleexpseq returnpvalu visual function r visualize_dataset functiondatasetmetainfonfiltersnsamplesizesnrepnmethodsselectionselect count nplot nfilter nsamples printpastethi function gener nplot plot j nplot printj tasic_current_out datasetgreplselectionj namesdataset metainfo_current_out metainfogreplselectionj namesmetainfo reslist c count count k lengthnrep tasic_current_inn tasic_current_outergreplnrepk namestasic_current_out metainfo_current_inn metainfo_current_outergreplnrepk namesmetainfo_current_out pvalu get_pvaluestasic_current_innernrepnmethod pvalu pvaluesc truth_fil tasic_current_innerdtuanalysi ifcount nsamples txswap metainfo_current_inn els txswap metainfo_current_inn truth_fil truth_filectxnamep_valu txswappedmetainfo txswappedmetainfomatchtruth_filetxnametxswappedmetainfotxnam truth_filegene_modifi asnumerictxswappedmetainfotxswap truth_fil truth_fileordertruth_filetxnam rownamestruth_fil truth_filetxnam reslistk listpvaluestruth_fil rownamesreslist pasterownamesreslist _ rownamesreslist pasterownamesreslist _ rownamesreslist pasterownamesreslist _ pvalues_ful rbindreslistreslistreslist rownamesreslist pasterownamesreslist _ rownamesreslist pasterownamesreslist _ rownamesreslist pasterownamesreslist _ truth_file_ful rbindreslistreslistreslist cobra cobradatapv pvalues_ful truth truth_file_ful cobra calculate_adjpcobra cobraperf calculate_performancecobra binary_truth gene_modifi cont_truth none splv none aspect cfdrtpr fdrtprcurv overlap cobraplot prepare_data_for_plotcobraperf colorschem dark facet true nmethod new_col crepcef e fe b black repwhit namesnew_col namescobraplotplotcolor cobraplotplotcolor new_col plot plot_fdrtprcurvecobraplot xaxisrang c yaxisrang c titl c versu edger filter count versu drimseq filter count titl c versu edger filter scaledtpm versu drimseq filter scaledtpm current_titl titlesj els new_col crepcb fe b black repwhit namesnew_col namescobraplotplotcolor cobraplotplotcolor new_col plot plot_fdrtprcurvecobraplot xaxisrang c yaxisrang c titl c versu edger filter count versu edger filter count versu drimseq filter count versu drimseq filter count titl c versu edger filter scaledtpm versu edger filter scaledtpm versu drimseq filter scaledtpm versu drimseq filter scaledtpm current_titl titlesj plot plot ggtitlecurrent_titl themestripbackground element_blank striptextx element_blank plottitl element_texts axistextx element_texts axistexti element_texts axistitlex element_texts axistitley element_texts pngpasteresultstasic_benchmarkfdrtpr_ selectionj _ subf selectionj _countpng sep width height unit re pointsiz start export printplot devoff pngpasteresultstasic_benchmarkfdrtpr_ selectionj _ subf selectionj _scaledtpmpng sep width height unit re pointsiz start export printplot devoff gener fdrtpr curv r select c_rep__filterlenient_rep__filterstring select c_rep_rep visualize_datasetsdatasettasicbenchmarkmetainfometainfonfiltersnsamplesizesnrepcrep_rep_rep_nmethodsselect selectionselectionselect select c__rep__filterlenient_rep__filterlenient__rep__filterstringent_rep__filterstring select c_rep_rep_rep_rep visualize_datasetstasicbenchmarkmetainfonfiltersnsamplesizesnrepcrep_rep_rep_nmethodsselect selectionselectionselect titl _darmanis_visu author jeroen gili date output html_document order run script _darmanis_visualizermd dataset darmanis_benchmark_datasets_countrdata darmanis_dtu_results_countrdata requir file either gener _darmanis_preparermd _darmanis_dturmd script respect download zenodo put data folder github repositori result script fdrtpr curv alreadi avail github directori resultsdarmanis_benchmark r setup includefals echofals requireknitr opts_knitsetrootdir rprojrootfind_rstudio_root_fil load librari rmessagefalsewarningfals libraryggplot libraryicobra load truth file r loadfiledatadarmanis_benchmark_datasets_countrdata loadfiledatadarmanis_benchmark_datasets_scaledtpmrdata metainfo cdarmanisbenchmarklenientdarmanisbenchmarkstring rmdarmanisbenchmarklenientdarmanisbenchmarkstring load dtu perform result r loadfiledatadarmanis_dtu_results_countrdata loadfiledatadarmanis_dtu_results_scaledtpmrdata darmanisbenchmark c darmanisdtubenchmark_saturn darmanisdtubenchmark_limmadiffsplic darmanisdtubenchmark_dexseq darmanisdtubenchmark_drimseq darmanisdtubenchmark_edgerdiffsplic darmanisdtubenchmark_doubleexpseq remov empti entri due test aka mani sampl reason runtim darmanisbenchmark darmanisbenchmarkwhich sapplydarmanisbenchmark functionx isnullxdtuanalysi rmdarmanisdtubenchmark_saturn darmanisdtubenchmark_limmadiffsplic darmanisdtubenchmark_dexseq darmanisdtubenchmark_drimseq darmanisdtubenchmark_edgerdiffsplic darmanisdtubenchmark_doubleexpseq invisiblegc helper function get pvalu differ method differ dataset r get_pvalu functiondatasetnrepnmethod get_all_tx functiondatasetnrep all_tx c nrep current_tx ascharacterdatasetidtuanalysistxnam all_tx call_tx current_tx all_tx uniqueall_tx returnall_tx all_tx get_all_txsdatasetnrep pvalu matrixdatana nrowlengthall_tx ncolnmethodsnrep rownamespvalu all_tx nmethodsnrep pvalues_new dataframedatasetidtuanalysisp_valu rownamespvalues_new ascharacterdatasetidtuanalysistxnam colnamespvalues_new namesdataseti pvaluesi pvalues_newmatchrownamespvaluesrownamespvalues_new pvalu applypvalu asnumer rownamespvalu all_tx pvalu asdataframepvalu pvalu pvaluesorderrownamespvalu ifnmethod colnamespvalu csaturn limma_diffsplic dexseq drimseqedger_diffsplic doubleexpseq els colnamespvalu csaturn limma_diffspliceedger_diffsplic doubleexpseq returnpvalu visual function r visualize_dataset functiondatasetmetainfonfiltersnsamplesizesnrepnmethodsselectionselect count nplot nfilter nsamples printpastethi function gener nplot plot j nplot printj tasic_current_out datasetgreplselectionj namesdataset metainfo_current_out metainfogreplselectionj namesmetainfo reslist c count count k lengthnrep tasic_current_inn tasic_current_outergreplnrepk namestasic_current_out metainfo_current_inn metainfo_current_outergreplnrepk namesmetainfo_current_out pvalu get_pvaluestasic_current_innernrepnmethod truth_fil tasic_current_innerdtuanalysi ifcount nsamples txswap metainfo_current_inn els txswap metainfo_current_inn truth_fil truth_filectxnamep_valu txswappedmetainfo txswappedmetainfomatchtruth_filetxnametxswappedmetainfotxnam truth_filegene_modifi asnumerictxswappedmetainfotxswap truth_fil truth_fileordertruth_filetxnam rownamestruth_fil truth_filetxnam reslistk listpvaluestruth_fil rownamesreslist pasterownamesreslist _ rownamesreslist pasterownamesreslist _ rownamesreslist pasterownamesreslist _ pvalues_ful rbindreslistreslistreslist rownamesreslist pasterownamesreslist _ rownamesreslist pasterownamesreslist _ rownamesreslist pasterownamesreslist _ truth_file_ful rbindreslistreslistreslist cobra cobradatapv pvalues_ful truth truth_file_ful cobra calculate_adjpcobra cobraperf calculate_performancecobra binary_truth gene_modifi cont_truth none splv none aspect cfdrtpr fdrtprcurv overlap cobraplot prepare_data_for_plotcobraperf colorschem dark facet true nmethod new_col crepcef e fe b black repwhit namesnew_col namescobraplotplotcolor cobraplotplotcolor new_col plot plot_fdrtprcurvecobraplot xaxisrang c yaxisrang c titl c versu edger filter count versu drimseq filter count titl c versu edger filter scaledtpm versu drimseq filter scaledtpm current_titl titlesj els new_col crepcb fe b black repwhit namesnew_col namescobraplotplotcolor cobraplotplotcolor new_col plot plot_fdrtprcurvecobraplot xaxisrang c yaxisrang c titl c versu edger filter count versu edger filter count versu drimseq filter count versu drimseq filter count titl c versu edger filter scaledtpm versu edger filter scaledtpm versu drimseq filter scaledtpm versu drimseq filter scaledtpm current_titl titlesj plot plot ggtitlecurrent_titl themestripbackground element_blank striptextx element_blank plottitl element_texts axistextx element_texts axistexti element_texts axistitlex element_texts axistitley element_texts pngpasteresultsdarmanis_benchmarkfdrtpr_ selectionj _ subf selectionj _countpng sep width height unit re pointsiz start export printplot devoff pngpasteresultsdarmanis_benchmarkfdrtpr_ selectionj _ subf selectionj _scaledtpmpng sep width height unit re pointsiz start export printplot devoff gener fdrtpr curv r select c_rep__filterlenient_rep__filterstring select c_rep_rep visualize_datasetsdarmanisbenchmarkmetainfonfiltersnsamplesizesnrepcrep_rep_rep_nmethodsselect selectionselectionselect select c__rep__filterlenient_rep__filterlenient__rep__filterstringent_rep__filterstring select c_rep_rep_rep_rep visualize_datasetsdarmanisbenchmarkmetainfonfiltersnsamplesizesnrepcrep_rep_rep_nmethodsselect selectionselectionselect titl _darmanis_dtu author jeroen gili date output html_document order run script _darmanis_dturmd dataset darmanis_benchmark_datasets_countrdata altern darmanis_benchmark_datasets_scaledtpmrdata requir file either gener _darmanis_preparermd script download zenodo run dtu analys method darmani benchmark dataset note dexseq drimseq run dataset cell group method scale larg dataset nbsplice omit converg dataset mani zero code run approxim minut hour macbook pro processor ghz quadcor intel core gb ram runtim attribut dexseq analysi want run script output also download zenodo darmanis_dtu_results_countrdata altern darmanis_dtu_results_scaledtpmrdata r setup includefals echofals requireknitr opts_knitsetrootdir rprojrootfind_rstudio_root_fil load dtu method sourc file allow run seven dtu method assess paper saturn doubleexpseq limma diffsplic edgerdiffsplic dexseq drimseq nbsplice r messagefals warningfals load librari libraryedg librarylimma librarydexseq librarydrimseq librarydoubleexpseq librarynbsplic librarysaturn sourcefileperformance_benchmarksdtu_methodsr set parallel execut note optim paramet set parallel dtu analys depend specif comput system r iftru nrcore ifnrcor doparallel true doprogress none registerdomccor nrcore els doparallel fals doprogress text run analys run dtu analys method darmani benchmark dataset note dexseq drimseq run dataset cell group method scale larg dataset nbsplice omit converg dataset mani zero code run approxim minut macbook pro processor ghz quadcor intel core gb ram runtim attribut dexseq analysi r load benchmark data loadfiledatadarmanis_benchmark_datasets_countrdata loadfiledatadarmanis_benchmark_datasets_scaledtpmrdata darmanisbenchmarkdata cdarmanisbenchmarklenientdarmanisbenchmarkstring run dtu analys benchmark data printstart saturn tstart systim suppresswarningsdarmanisdtubenchmark_saturn plyrllpli data darmanisbenchmarkdata inform true fun functionlocaldata perform dtu analysi localr saturn_dtu countdata localdatadata txgene localdatametainfo sampledata localdatadesign massag localresgene_modifi localdatametainfogene_modifiedmatch localrestxnam localdatametainfotxnam return result return list dtuanalysi localr difftimesystim tstart printstart edger_diffsplic tstart systim darmanisdtubenchmark_edgerdiffsplic plyrllpli data darmanisbenchmarkdata parallel doparallel progress doprogress inform true fun functionlocaldata perform dtu analysi localr edger_diffsplice_dtu countdata localdatadata txgene localdatametainfo sampledata localdatadesign massag localresgene_modifi localdatametainfogene_modifiedmatch localrestxnam localdatametainfotxnam return result return list dtuanalysi localr difftimesystim tstart printstart doubleexpseq tstart systim darmanisdtubenchmark_doubleexpseq plyrllpli data darmanisbenchmarkdata parallel doparallel progress doprogress inform true fun functionlocaldata perform dtu analysi localr doubleexpseq_dtu countdata localdatadata txgene localdatametainfo sampledata localdatadesign massag localresgene_modifi localdatametainfogene_modifiedmatch localrestxnam localdatametainfotxnam return result return list dtuanalysi localr difftimesystim tstart printstart limma diffsplic tstart systim darmanisdtubenchmark_limmadiffsplic plyrllpli data darmanisbenchmarkdata parallel doparallel progress doprogress inform true fun functionlocaldata perform dtu analysi localr limma_diffsplice_dtu countdata localdatadata txgene localdatametainfo sampledata localdatadesign massag localresgene_modifi localdatametainfogene_modifiedmatch localrestxnam localdatametainfotxnam return result return list dtuanalysi localr difftimesystim tstart printstart dexseq tstart systim darmanisdtubenchmark_dexseq plyrllpli data darmanisbenchmarkdata parallel doparallel progress doprogress inform true fun functionlocaldata ifncollocaldatadata returnnul perform dtu analysi localr dexseq_dtu countdata localdatadata txgene localdatametainfo sampledata localdatadesign massag localresgene_modifi localdatametainfogene_modifiedmatch localrestxnam localdatametainfotxnam return result return list dtuanalysi localr difftimesystim tstart printstart drimseq tstart systim darmanisdtubenchmark_drimseq plyrllpli data darmanisbenchmarkdata parallel doparallel progress doprogress inform true fun functionlocaldata ifncollocaldatadata returnnul perform dtu analysi localr drimseq_dtu countdata localdatadata txgene localdatametainfo sampledata localdatadesign massag localresgene_modifi localdatametainfogene_modifiedmatch localrestxnam localdatametainfotxnam return result return list dtuanalysi localr difftimesystim tstart add method name list name easi postanalysi namesdarmanisdtubenchmark_saturn pastesaturn_ namesdarmanisdtubenchmark_saturn namesdarmanisdtubenchmark_limmadiffsplic pastelimma_diffsplice_ namesdarmanisdtubenchmark_limmadiffsplic namesdarmanisdtubenchmark_dexseq pastedexseq_ namesdarmanisdtubenchmark_dexseq namesdarmanisdtubenchmark_drimseq pastedrimseq_ namesdarmanisdtubenchmark_drimseq namesdarmanisdtubenchmark_edgerdiffsplic pasteedger_diffsplice_ namesdarmanisdtubenchmark_edgerdiffsplic namesdarmanisdtubenchmark_doubleexpseq pastedoubleexpseq_ namesdarmanisdtubenchmark_doubleexpseq save result save darmanisdtubenchmark_saturn darmanisdtubenchmark_limmadiffsplic darmanisdtubenchmark_dexseq darmanisdtubenchmark_drimseq darmanisdtubenchmark_edgerdiffsplic darmanisdtubenchmark_doubleexpseq filedatadarmanis_dtu_results_countrdata save darmanisdtubenchmark_saturn darmanisdtubenchmark_limmadiffsplic darmanisdtubenchmark_dexseq darmanisdtubenchmark_drimseq darmanisdtubenchmark_edgerdiffsplic darmanisdtubenchmark_doubleexpseq filedatadarmanis_dtu_results_scaledtpmrdata titl _darmanis_prepar author jeroen gili date output html_document order run script _darmanis_perparermd express count matrix darmanis_countsrd correspond metadata darmanis_metadatardata download zenodo put data folder github repositori altern exact quantif file download origin sourc httpimlspentictonuzhchrobinson_labconquerdatamaegserd note raw data avail geohttpswwwncbinlmnihgovgeoqueryacccgiaccgs one want run script output also download zenodo darmanis_benchmark_datasets_countrdata altern darmanis_benchmark_datasets_scaledtpmrdata r setup includefals echofals requireknitr opts_knitsetrootdir rprojrootfind_rstudio_root_fil load librari rmessagefalsewarningfals libraryedg librarydrimseq librarymultiassayexperi librarydomc load data r messagefals darmanis_data readrdsfil datadarmanis_countsrd extract genom annot r extract gene info txinfo darmanis_dataexperimentlisttxrowrang txinfo asdataframemcolstxinfoctranscriptgen colnamestxinfo cisoform_idgene_id rownamestxinfo null txinfoisoform_id ascharactertxinfoisoform_id txinfogene_id ascharactertxinfogene_id subset darmani data gener benchmark dataset need know ground truth ie transcript differenti use group sampl end first gener mock dataset dtu expect introduc dtu group transcriptabundanceswap strategi discuss van den berg et al stager paperhttpsdoiorg order obtain mock dataset need construct dataset ideal dtu expect tri achiev subsampl homogen set sampl darmani dataset base follow criteria celltyp immun cell tsneclust tissuech tumor metadata retain cell retriev darmanis_metadatardata r loadfil datadarmanis_metadatardata subset express matrix darmanis_count darmanis_dataexperimentlisttxassaysdatacountcellsofinterest count input uncom chunk code use scaledtpm stead raw count r get scaledtpm darmanis_counts_al darmanis_dataexperimentlisttxassaysdatacountcellsofinterest count input darmanis_tpm_al darmanis_dataexperimentlisttxassaysdatatpmcellsofinterest tpm input colsums_count colsumsdarmanis_counts_al colsums_tpm colsumsdarmanis_tpm_al scale_factor colsums_countcolsums_tpm darmanis_scaledtpm_al darmanis_tpm_al diagscale_factor scaledtpm input colnamesdarmanis_scaledtpm_al colnamesdarmanis_counts_al darmanis_count darmanis_scaledtpm_allcellsofinterest setup gener benchmark data set hyperparamet benchmark dataset ie sampl size number repeat fraction dtu gene paramet parallel process r remov ercc txinfo txinfowhich greplercc txinfoisoform_id darmanis_count darmanis_countstxinfoisoform_id darmanis_scaledtpm darmanis_scaledtpmtxinfoisoform_id set paramet samplesprcondit c nrrepsmad fracgenesaffect nrcorestous set parallel process ifnrcorestous doparallel true doprogress none registerdomccor nrcorestous els doparallel fals doprogress text list loop nrreplist split rep x samplesprcondit time nrrepsmad past samples_used_ rep x samplesprcondit time nrrepsmad _rep_ sort rep x nrrepsmad time lengthsamplesprcondit gener darmani benchmark data r sourcefileperformance_benchmarksgetbenchmark_datar r darmanisbenchmarkleni getbenchmark_datacountdatadarmanis_count metadatatxinfo filteredg edger_filter_spec listmincount mintotalcount largen minprop nrreplistnrreplist fracgenesaffect namesdarmanisbenchmarkleni pastenamesnrreplist_filterleni darmanisbenchmarkstring getbenchmark_datacountdatadarmanis_count metadatatxinfo filterdrimseq nrreplistnrreplist fracgenesaffect namesdarmanisbenchmarkstring pastenamesnrreplist_filterstring save darmani benchmark data r savedarmanisbenchmarkleni darmanisbenchmarkstring filedatadarmanis_benchmark_datasets_countrdata savedarmanisbenchmarkleni darmanisbenchmarkstring filedatadarmanis_benchmark_datasets_scaledtpmrdata titl _gtex_visu author jeroen gili date output html_document order run script _gtex_visualizermd dataset gtex_benchmark_datasets_countrdata gtex_dtu_results_countrdata altern gtex_benchmark_datasets_scaledtpmrdata gtex_dtu_results_scaledtpmrdata requir file either gener _gtex_preparermd _gtex_dturmd script download zenodo result script fdrtpr curv alreadi avail github directori resultsgtex_benchmark r setup includefals echofals requireknitr opts_knitsetrootdir rprojrootfind_rstudio_root_fil rmessagefalsewarningfals libraryggplot libraryicobra load benchmark dataset contain ground truth gener script _gtex_preparermd r loadfiledatagtex_benchmark_datasets_countrdata loadfiledatagtex_benchmark_datasets_scaledtpmrdata tpm equival metainfo cgtexbenchmarkdatalenientgtexbenchmarkdatastring rmgtexbenchmarkdatalenientgtexbenchmarkdatastring invisiblegc load dtu analysi result gener script _gtex_dturmd r loadfiledatagtex_dtu_results_countrdata loadfiledatagtex_dtu_results_scaledtpmrdata tpm equival gtexbenchmark c gtexdtubenchmark_dexseq gtexdtubenchmark_doubleexpseq gtexdtubenchmark_drimseq gtexdtubenchmark_edgerdiffsplic gtexdtubenchmark_limmadiffsplic gtexdtubenchmark_nbsplic gtexdtubenchmark_saturn remov empti enteri due test due mani sampl reason runtim gtexbenchmark gtexbenchmarkwhich sapplygtexbenchmark functionx isnullxdtuanalysi rmgtexdtubenchmark_dexseq gtexdtubenchmark_drimseq gtexdtubenchmark_doubleexpseq gtexdtubenchmark_edgerdiffsplic gtexdtubenchmark_limmadiffsplic gtexdtubenchmark_nbsplic gtexdtubenchmark_saturn invisiblegc r gtexbenchmarksaturn_samples_used__rep__filterlenientdtuanalysi count scaledtpm enst enst e enst enst e enst enst e helper function get pvalu differ method differ dataset r get_pvalu functiondatasetnrepnmethod get_all_tx functiondataset all_tx c current_tx ascharacterdatasetdtuanalysistxnam all_tx call_tx current_tx all_tx uniqueall_tx returnall_tx all_tx get_all_txsdataset nmethod lengthdataset pvalu matrixdatana nrowlengthall_tx ncolnmethod rownamespvalu all_tx nmethod pvalues_new dataframedatasetidtuanalysisp_valu rownamespvalues_new ascharacterdatasetidtuanalysistxnam colnamespvalues_new namesdataseti pvaluesi pvalues_newmatchrownamespvaluesrownamespvalues_new pvalu applypvalu asnumer rownamespvalu all_tx pvalu asdataframepvalu pvalu pvaluesorderrownamespvalu colnamespvalu method returnpvalu visual function r visualize_dataset functiondatasetmetainfonfiltersnsamplesizesmethodscolorstitlesselect nplot nfilter nsamples printpastethi function gener nplot plot request benchmark j nplot printj print progress gtexbenchmark_current_out datasetgreplselectionj namesdataset select request analys selected_method c lengthmethod selected_method cselected_methodsgrepmethodsi namesgtexbenchmark_current_out gtexbenchmark_current_out gtexbenchmark_current_outerselected_method name order metainfo_current_out metainfogreplselectionj namesmetainfo reslist c store result repeat later nrepcrep__rep_rep_ k repeat k lengthnrep gtexbenchmark_current_inn gtexbenchmark_current_outergreplnrepk namesgtexbenchmark_current_out get analysi data kth repeat metainfo_current_inn metainfo_current_outergreplnrepk namesmetainfo_current_out get truth data kth repeat pvalu get_pvaluesgtexbenchmark_current_innermethod truth_fil gtexbenchmark_current_innerdtuanalysi txswap metainfo_current_inn txswap first repeat repeat truth_fil truth_filectxnamep_valu txswappedmetainfo txswappedmetainfomatchtruth_filetxnametxswappedmetainfotxnam truth_filegene_modifi asnumerictxswappedmetainfotxswap truth_fil truth_fileordertruth_filetxnam rownamestruth_fil truth_filetxnam reslistk listpvaluestruth_fil concaten result repeat analys one datafram order calcul averag perform repeat requir icobra avoid repeat rownam rownamesreslist pasterownamesreslist _ rownamesreslist pasterownamesreslist _ rownamesreslist pasterownamesreslist _ pvalues_ful rbindreslistreslistreslist concaten metadata repeat analys one datafram order calcul averag perform repeat requir icobra avoid repeat rownam rownamesreslist pasterownamesreslist _ rownamesreslist pasterownamesreslist _ rownamesreslist pasterownamesreslist _ truth_file_ful rbindreslistreslistreslist gener plot icobra cobra cobradatapv pvalues_ful truth truth_file_ful cobra calculate_adjpcobra cobraperf calculate_performancecobra binary_truth gene_modifi cont_truth none splv none aspect cfdrtpr fdrtprcurv overlap cobraplot prepare_data_for_plotcobraperf colorschem dark facet true custom color new_col colorswhichnamescolorsinmethod new_col crepcnew_col repwhitelengthmethod namesnew_col namescobraplotplotcolor cobraplotplotcolor new_col creat plot plot plot_fdrtprcurvecobraplot xaxisrang c yaxisrang c plot plot ggtitletitlesj themestripbackground element_blank striptextx element_blank plottitl element_texts axistextx element_texts axistexti element_texts axistitlex element_texts axistitley element_texts save plot pngpasteresultsgtex_benchmarkfdrtpr_ gsub _ titlesj png width height unit re pointsiz start export printplot devoff visual result r select c_rep___filterlenient_rep___filterlenient_rep___filterstringent_rep___filterstring color cef e fe b de black namescolor cdexseqdoubleexpseqdrimseqedger_diffsplic limma_diffsplic nbsplicesaturn method cdexseqdoubleexpseqdrimseqedger_diffsplic limma_diffsplic nbsplicesaturn titl c versu edger filter count versu edger filter count versu drimseq filter count versu drimseq filter count titl c versu edger filter scaledtpm versu edger filter scaledtpm versu drimseq filter scaledtpm versu drimseq filter scaledtpm visualize_datasetsdatasetgtexbenchmark metainfometainfo nfilter nsamples methodsmethod colorscolor titlestitl selectionselect select c_rep___filterlenient_rep___filterstring color cbe fe b black namescolor cdoubleexpseqedger_diffsplic limma_diffsplicesaturn method cdoubleexpseqedger_diffsplic limma_diffsplicesaturn titl c versu edger filter count versu drimseq filter count titl c versu edger filter scaledtpm versu drimseq filter scaledtpm visualize_datasetsdatasetgtexbenchmark metainfometainfo nfilter nsamples methodsmethod colorscolor titlestitl selectionselect titl _gtex_dtu author jeroen gili date output html_document order run script _gtex_dturmd dataset gtex_benchmark_datasets_countrdata altern gtex_benchmark_datasets_scaledtpmrdata requir file either gener _gtex_preparermd script download zenodo run dtu analys method gtex benchmark dataset note dexseq drimseq nbsplice run dataset sampl group method scale larg dataset code run approxim hour macbook pro processor ghz quadcor intel core gb ram runtim attribut dexseq drimseq nbsplice analys runtim attribut dexseq drimseq nbsplice analys want run script output also download zenodo gtex_dtu_results_countrdata altern gtex_dtu_results_scaledtpmrdata r setup includefals echofals requireknitr opts_knitsetrootdir rprojrootfind_rstudio_root_fil load dtu method sourc file allow run seven dtu method assess paper saturn doubleexpseq limma diffsplic edgerdiffsplic dexseq drimseq nbsplice r messagefals warningfals load librari librarydomc libraryedg librarylimma librarydexseq librarydrimseq librarydoubleexpseq librarynbsplic devtoolsinstall_localusersjgdesktopphddtu_projectsaturn forc true quiet fals librarysaturn sourcefileperformance_benchmarksdtu_methodsr set parallel execut note optim paramet set parallel dtu analys depend specif comput system nrcore ifnrcor doparallel true doprogress none registerdomccor nrcore els doparallel fals doprogress text run analys run dtu analys method gtex benchmark dataset note dexseq drimseq nbsplice run dataset sampl group method scale larg dataset code run approxim hour macbook pro processor ghz quadcor intel core gb ram runtim attribut dexseq drimseq nbsplice analys r load benchmark dataset output _gtex_preparermd loadfiledatagtex_benchmark_datasets_countrdata loadfiledatagtex_benchmark_datasets_scaledtpmrdata gtexbenchmarkdata cgtexbenchmarkdatalenientgtexbenchmarkdatastring run dtu analys benchmark data printstart saturn tstart systim suppresswarningsgtexdtubenchmark_saturn plyrllpli data gtexbenchmarkdata inform true fun functionlocaldata perform dtu analysi localr saturn_dtu countdata localdatadata txgene localdatametainfo sampledata localdatadesign massag localresgene_modifi localdatametainfogene_modifiedmatch localrestxnam localdatametainfotxnam return result returnlistdtuanalysi localr difftimesystim tstart printstart doubleexpseq tstart systim gtexdtubenchmark_doubleexpseq plyrllpli data gtexbenchmarkdata parallel doparallel progress doprogress inform true fun functionlocaldata perform dtu analysi localr doubleexpseq_dtu countdata localdatadata txgene localdatametainfo sampledata localdatadesign quietfals massag localresgene_modifi localdatametainfogene_modifiedmatch localrestxnam localdatametainfotxnam return result returnlistdtuanalysi localr difftimesystim tstart printstart limma diffsplic tstart systim gtexdtubenchmark_limmadiffsplic plyrllpli data gtexbenchmarkdata parallel doparallel progress doprogress inform true fun functionlocaldata perform dtu analysi localr limma_diffsplice_dtu countdata localdatadata txgene localdatametainfo sampledata localdatadesign massag localresgene_modifi localdatametainfogene_modifiedmatch localrestxnam localdatametainfotxnam return result returnlistdtuanalysi localr difftimesystim tstart printstart edger_diffsplic tstart systim gtexdtubenchmark_edgerdiffsplic plyrllpli data gtexbenchmarkdata parallel doparallel progress doprogress inform true fun functionlocaldata perform dtu analysi localr edger_diffsplice_dtu countdata localdatadata txgene localdatametainfo sampledata localdatadesign massag localresgene_modifi localdatametainfogene_modifiedmatch localrestxnam localdatametainfotxnam return result returnlistdtuanalysi localr difftimesystim tstart printstart dexseq tstart systim gtexdtubenchmark_dexseq plyrllpli data gtexbenchmarkdata parallel doparallel progress doprogress inform true fun functionlocaldata ifncollocaldatadata returnnul run dexseq dataset mani sampl slow perform dtu analysi localr dexseq_dtu countdata localdatadata txgene localdatametainfo sampledata localdatadesign massag localresgene_modifi localdatametainfogene_modifiedmatch localrestxnam localdatametainfotxnam return result returnlistdtuanalysi localr difftimesystim tstart printstart drimseq tstart systim gtexdtubenchmark_drimseq plyrllpli data gtexbenchmarkdata parallel doparallel progress doprogress inform true fun functionlocaldata ifncollocaldatadata returnnul run drimseq dataset mani sampl slow perform dtu analysi localr drimseq_dtu countdata localdatadata txgene localdatametainfo sampledata localdatadesign massag localresgene_modifi localdatametainfogene_modifiedmatch localrestxnam localdatametainfotxnam return result returnlistdtuanalysi localr difftimesystim tstart printstart nbsplice tstart systim gtexdtubenchmark_nbsplic plyrllpli data gtexbenchmarkdata parallel doparallel progress doprogress inform true fun functionlocaldata ifncollocaldatadata returnnul run nbsplice dataset mani sampl slow perform dtu analysi localr nbsplice_dtu countdata localdatadata txgene localdatametainfo sampledata localdatadesign quietfals ifisnulllocalr return listdtuanalysi localr massag localresgene_modifi localdatametainfogene_modifiedmatch localrestxnam localdatametainfotxnam return result returnlistdtuanalysi localr difftimesystim tstart add method name list name easi postanalysi namesgtexdtubenchmark_saturn pastesaturn_namesgtexdtubenchmark_saturn namesgtexdtubenchmark_doubleexpseq pastedoubleexpseq_ namesgtexdtubenchmark_doubleexpseq namesgtexdtubenchmark_limmadiffsplic pastelimma_diffsplice_ namesgtexdtubenchmark_limmadiffsplic namesgtexdtubenchmark_edgerdiffsplic pasteedger_diffsplice_ namesgtexdtubenchmark_edgerdiffsplic namesgtexdtubenchmark_dexseq pastedexseq_ namesgtexdtubenchmark_dexseq namesgtexdtubenchmark_drimseq pastedrimseq_ namesgtexdtubenchmark_drimseq namesgtexdtubenchmark_nbsplic pastenbsplice_ namesgtexdtubenchmark_nbsplic save result savegtexdtubenchmark_saturn gtexdtubenchmark_limmadiffsplic gtexdtubenchmark_edgerdiffsplic gtexdtubenchmark_doubleexpseq gtexdtubenchmark_dexseq gtexdtubenchmark_drimseq gtexdtubenchmark_nbsplic filedatagtex_dtu_results_countrdata savegtexdtubenchmark_saturn gtexdtubenchmark_limmadiffsplic gtexdtubenchmark_edgerdiffsplic gtexdtubenchmark_doubleexpseq gtexdtubenchmark_dexseq gtexdtubenchmark_drimseq gtexdtubenchmark_nbsplic filedatagtex_dtu_results_scaledtpmrdata titl _gtex_prepar author jeroen gili date output html_document order run script _gtex_perparermd two file download zenodo copi data folder github page note want run analysi scaledtpm express valu must also copi third file zenodo data folder github page gtex_countsgz _gtex_baseline_metadatatxt gtex_scaledtpmgz note file ident one link renam file httpsstoragegoogleapiscomgtex_analysis_vrna_seq_datagtex_analysis__v_rsemv_transcript_expected_countgctgz httpsstoragegoogleapiscomgtex_analysis_vannotationsgtex_analysis_v_annotations_sampleattributesdstxt httpsstoragegoogleapiscomgtex_analysis_vrna_seq_datagtex_analysis__v_rsemv_transcript_tpmgctgz note raw data eg bam file also acquir gtex data portalhttpswwwgtexportalorghomedocumentationpagestatictextpublicationpolici want run script output also download zenodo gtex_benchmark_datasets_countrdata altern gtex_benchmark_datasets_scaledtpmrdata given larg dataset script quit memori intens r setup includefals echofals requireknitr opts_knitsetrootdir rprojrootfind_rstudio_root_fil load librari rmessagefalsewarningfals librarydatat libraryedg librarydrimseq librarydomc load gtex data rload data gtexcm freaddatagtex_countsgz datat fals gtexsampl freaddatagtex_metadatatxt datat fals subset gtex data gtex dataset origin observ studi use benchmark dataset need know ground truth ie transcript differenti use group sampl end first gener mock dataset dtu expect introduc dtu group transcriptabundanceswap strategi discuss van den berg et al stager paperhttpsdoiorg order obtain mock dataset howev need construct dataset ideal dtu expect tri achiev subsampl homogen set sampl gtex data object base follow criteria adren gland data rna extract paxgenederiv lysat plate base sampl sampl center b rnaseq sampl gtex analysi freez smafrz r extract gene info txinfo gtexcmctranscript_idgene_id colnamestxinfo isoform_id rownamesgtexcm txinfoisoform_id extract sampl gtexsampl gtexsampl whichgtexsamplesmtsd adren gland specif filter extract kit gtexsampl gtexsampl whichgtexsamplesmnabtcht rna extract paxgenederiv lysat plate base specif filter smafrz gtexsampl gtexsampl whichgtexsamplesmafrz rnaseq specif filter center gtexsampl gtexsampl whichgtexsamplesmcent b gtexcm gtexcmwhich colnamesgtexcm gtexsamplesampid uncom chunk code scaledtpm express valu need obain instead raw count colsums_count colsumsgtexcm colsums_count readrdsdatacolsums_countrd rmgtexcm invisiblegc gtextpm freaddatagtex_scaledtpmgz datat fals gtextpm gtextpmwhich colnamesgtextpm gtexsamplesampid get gtexscaledtpm colsums_tpm colsumsgtextpm scale_factor colsums_countcolsums_tpm gtexscaledtpm asmatrixgtextpm diagscale_factor scaledtpm input gtexscaledtpm asdataframegtexscaledtpm colnamesgtexscaledtpm colnamesgtextpm rownamesgtexscaledtpm txinfoisoform_id gtexcm gtexscaledtpm setup gener benchmark data set hyperparamet benchmark dataset ie sampl size number repeat fraction dtu gene paramet parallel process r set benchmark paramet samplesprcondit c nrrepsmad fracgenesaffect nrcorestous set parallel process ifnrcorestous doparallel true doprogress none registerdomccor nrcorestous els doparallel fals doprogress text list loop nrreplist split rep x samplesprcondit time nrrepsmad past samples_used_ rep x samplesprcondit time nrrepsmad _rep_ sort rep x nrrepsmad time lengthsamplesprcondit gener gtex benchmark data r sourcefileperformance_benchmarksgetbenchmark_datar r gtexbenchmarkdataleni getbenchmark_datacountdata gtexcm metadata txinfo filter edger edger_filter_spec listmincount mintotalcount largen minprop nrreplist nrreplist fracgenesaffect namesgtexbenchmarkdataleni pastenamesnrreplist_filterleni gtexbenchmarkdatastring getbenchmark_datacountdatagtexcm metadatatxinfofilterdrimseq nrreplistnrreplist fracgenesaffect namesgtexbenchmarkdatastring pastenamesnrreplist_filterstring save gtex benchmark data r savegtexbenchmarkdataleni gtexbenchmarkdatastring filedatagtex_benchmark_datasets_countrdata savegtexbenchmarkdataleni gtexbenchmarkdatastring filedatagtex_benchmark_datasets_scaledtpmrdata titl _dmelanogaster_prepar author jeroen gili date output html_document order run script _dmelanogaster_perparermd folder dmelanogaster_kallistozip contain kallisto quantif file dataset download zenodo unzip addit two metadata file dmelanogaster_metadata_xlsx dmelanogaster_metadata_txt also download zenodo three file must copi data folder github page note raw data avail arrayexpresshttpswwwebiacukarrayexpressexperimentsemtab one want run script output also download zenodo dmelanogaster_benchmark_datasets_countrdata altern dmelanogaster_benchmark_datasets_scaledtpmrdata r setup includefals echofals requireknitr opts_knitsetrootdir rprojrootfind_rstudio_root_fil load librari rmessagefalsewarningfasl librarytximport librarydrimseq libraryedg load data r rootdir rprojrootfind_rstudio_root_fil sample_nam coutput_output_output_output_output_output_output_output_output_output_ quant_fil filepathrootdir datadmelanogaster_kallistoqu sample_nam abundanceh txi tximportfil quant_fil type kallisto countsfromabund txout true txi tximportfil quant_fil type kallisto countsfromabund scaledtpm txout true mydesign dataframesample_id ascharactersample_nam condit ascharacterrepcgroupgroupeach colnamestxicount mydesignsample_id dm_count txicount load metadata r truth readtablefil datadmelanogaster_metadata_txt sep header true convers readtablefil datadmelanogaster_metadata_txt colnamesconvers ctarget_id transcript_id conversiontarget_id ascharacterconversiontarget_id conversiontranscript_id ascharacterconversiontranscript_id txinfo asdataframecbindascharactertruthgene_id ascharactertruthtranscript_id ascharactertruthtranscript_ds_statu colnamestxinfo cgene_id transcript_id gene_modifi txinfogene_id ascharactertxinfogene_id txinfotranscript_id ascharactertxinfotranscript_id txinfo txinfoc chang order way benchmark dm_count dm_countswhichrownamesdm_count txinfotranscript_id dimdm_count gener lenient filter benchmark dataset edger r dm_lenient dm_count txinfo_leni txinfo group asfactorrepcabeach design modelmatrixgroup sampledata design sampledata colnamesdm_leni colnamessampledata csample_id condit dm_lenient edgerdgelistcount dm_lenientgroupgroup filter edgerfilterbyexprdm_lenientdesigndesign dm_lenient dm_lenientcountsfilt reorder correspond info txinfo_leni txinfo_lenientmatch rownamesdm_leni txinfo_lenienttranscript_id filter gene one tx txinfo_leni txinfo_lenienttxinfo_lenientgene_id namestabletxinfo_lenientgene_idtabletxinfo_lenientgene_id dm_lenient dm_lenienttxinfo_lenienttranscript_id add column sampl size easi retriev txinfo_lenientnrsamplespercondit colnamestxinfo_leni ctxnamegeneidgene_modifiednrsamplespercondit sampledata asdataframesampledata sampledatacondit asfactorrepcabeach dmbenchmarkleni list data dm_lenient design sampledata metainfo txinfo_leni dimdm_leni gener stringent filter benchmark dataset drimseq r dm_stringent dm_count txinfo_string txinfo group asfactorrepcabeach design modelmatrixgroup sampledata design sampledata colnamesdm_string colnamessampledata csample_id condit geneforeachtx txinfo_stringentmatchrownamesdm_stringenttxinfotranscript_idgene_id dm_stringent asdataframedm_string dm_stringentgene_id geneforeachtx dm_stringentfeature_id rownamesdm_string drimseqdmdsdatacount dm_stringent sampl asdataframesampledata dmfilterd min_samps_feature_expr min_feature_expr min_samps_feature_prop min_feature_prop min_samps_gene_expr min_gene_expr dm_stringent dm_countscountsdfeature_id reorder correspond info txinfo_string txinfo_stringentmatch rownamesdm_string txinfo_stringenttranscript_id filter gene one tx txinfo_string txinfo_stringenttxinfo_stringentgene_id namestabletxinfo_stringentgene_idtabletxinfo_stringentgene_id dm_stringent dm_stringenttxinfo_stringenttranscript_id add truth column txinfo_stringentgene_modifi truthtranscript_ds_statusmatchtxinfo_stringenttranscript_idascharactertruthtranscript_id add column sampl size easi retriev txinfo_stringentnrsamplespercondit colnamestxinfo_string ctxnamegeneidgene_modifiednrsamplespercondit sampledata asdataframesampledata sampledatacondit asfactorrepcabeach dmbenchmarkstring list data dm_stringent design sampledata metainfo txinfo_string dimdmbenchmarkstringentdata save dmelanogast benchmark data r savedmbenchmarkleni dmbenchmarkstring filedatadmelanogaster_benchmark_datasets_countrdata savedmbenchmarkleni dmbenchmarkstring filedatadmelanogaster_benchmark_datasets_scaledtpmrdata titl _dmelanogaster_dtu author jeroen gili date output html_document order run script _dmelanogaster_dturmd dataset dmelanogaster_benchmark_datasets_countrdata altern dmelanogaster_benchmark_datasets_scaledtpmrdata requir file either gener _dmelanogaster_preparermd script download zenodo run dtu analys dtu method dmelanogast benchmark dataset code run coupl minut macbook pro processor ghz quadcor intel core gb ram runtim attribut drimseq analysi want run script output also download zenodo dmelanogaster_dtu_results_countrdata altern dmelanogaster_dtu_results_scaledtpmrdata r setup includefals echofals requireknitr opts_knitsetrootdir rprojrootfind_rstudio_root_fil load dtu method sourc file allow run seven dtu method assess paper saturn doubleexpseq limma diffsplic edgerdiffsplic dexseq drimseq nbsplice r messagefals warningfals load librari libraryedg librarylimma librarydexseq librarydrimseq librarydoubleexpseq librarynbsplic librarysaturn librarydomc sourcefileperformance_benchmarksdtu_methodsr set parallel execut note optim paramet set parallel dtu analys depend specif comput system r iftru nrcore ifnrcor doparallel true doprogress none registerdomccor nrcore els doparallel fals doprogress text run analysi method dmelanogast dataset run dtu analys dtu method dmelanogast benchmark dataset code run coupl minut macbook pro processor ghz quadcor intel core gb ram runtim analysi drimseq r load benchmark data loadfiledatadmelanogaster_benchmark_datasets_countrdata loadfiledatadmelanogaster_benchmark_datasets_scaledtpmrdata dmbenchmarkleni listdmbenchmarkleni dmbenchmarkstring listdmbenchmarkstring namesdmbenchmarkleni pastenamesdmbenchmarkleni filterleni namesdmbenchmarkstring pastenamesdmbenchmarkstring filterstring dmbenchmarkdata cdmbenchmarklenientdmbenchmarkstring run dtu analysi benchmark data printstart saturn tstart systim suppresswarningsdmdtubenchmark_saturn plyrllpli data dmbenchmarkdata inform true fun functionlocaldata perform dtu analysi localr saturn_dtu countdata localdatadata txgene localdatametainfo sampledata localdatadesign massag localresgene_modifi localdatametainfogene_modifiedmatch localrestxnam localdatametainfotxnam return result returnlistdtuanalysi localr difftimesystim tstart printstart doubleexpseq tstart systim dmdtubenchmark_doubleexpseq plyrllpli data dmbenchmarkdata parallel doparallel progress doprogress inform true fun functionlocaldata perform dtu analysi localr doubleexpseq_dtu countdata localdatadata txgene localdatametainfo sampledata localdatadesign quietfals massag localresgene_modifi localdatametainfogene_modifiedmatch localrestxnam localdatametainfotxnam return result returnlistdtuanalysi localr difftimesystim tstart printstart limma diffsplic tstart systim dmdtubenchmark_limmadiffsplic plyrllpli data dmbenchmarkdata parallel doparallel progress doprogress inform true fun functionlocaldata perform dtu analysi localr limma_diffsplice_dtu countdata localdatadata txgene localdatametainfo sampledata localdatadesign massag localresgene_modifi localdatametainfogene_modifiedmatch localrestxnam localdatametainfotxnam return result returnlistdtuanalysi localr difftimesystim tstart printstart edger_diffsplic tstart systim dmdtubenchmark_edgerdiffsplic plyrllpli data dmbenchmarkdata parallel doparallel progress doprogress inform true fun functionlocaldata perform dtu analysi localr edger_diffsplice_dtu countdata localdatadata txgene localdatametainfo sampledata localdatadesign massag localresgene_modifi localdatametainfogene_modifiedmatch localrestxnam localdatametainfotxnam return result returnlistdtuanalysi localr difftimesystim tstart printstart dexseq tstart systim dmdtubenchmark_dexseq plyrllpli data dmbenchmarkdata parallel doparallel progress doprogress inform true fun functionlocaldata perform dtu analysi localr dexseq_dtu countdata localdatadata txgene localdatametainfo sampledata localdatadesign massag localresgene_modifi localdatametainfogene_modifiedmatch localrestxnam localdatametainfotxnam return result returnlistdtuanalysi localr difftimesystim tstart printstart drimseq tstart systim dmdtubenchmark_drimseq plyrllpli data dmbenchmarkdata parallel doparallel progress doprogress inform true fun functionlocaldata perform dtu analysi localr drimseq_dtu countdata localdatadata txgene localdatametainfo sampledata localdatadesign massag localresgene_modifi localdatametainfogene_modifiedmatch localrestxnam localdatametainfotxnam return result returnlistdtuanalysi localr difftimesystim tstart printstart nbsplice tstart systim dmdtubenchmark_nbsplic plyrllpli data dmbenchmarkdata parallel doparallel progress doprogress inform true fun functionlocaldata perform dtu analysi localr nbsplice_dtu countdata localdatadata txgene localdatametainfo sampledata localdatadesign massag localresgene_modifi localdatametainfogene_modifiedmatch localrestxnam localdatametainfotxnam return result returnlistdtuanalysi localr difftimesystim tstart add method name list name easi postanalysi namesdmdtubenchmark_saturn pastesaturn_ namesdmdtubenchmark_saturn namesdmdtubenchmark_doubleexpseq pastedoubleexpseq_ namesdmdtubenchmark_doubleexpseq namesdmdtubenchmark_edgerdiffsplic pasteedger_diffsplice_ namesdmdtubenchmark_edgerdiffsplic namesdmdtubenchmark_limmadiffsplic pastelimma_diffsplice_ namesdmdtubenchmark_limmadiffsplic namesdmdtubenchmark_dexseq pastedexseq_ namesdmdtubenchmark_dexseq namesdmdtubenchmark_drimseq pastedrimseq_ namesdmdtubenchmark_drimseq namesdmdtubenchmark_nbsplic pastenbsplice_ namesdmdtubenchmark_nbsplic save result savedmdtubenchmark_saturn dmdtubenchmark_doubleexpseq dmdtubenchmark_limmadiffsplic dmdtubenchmark_edgerdiffsplic dmdtubenchmark_dexseq dmdtubenchmark_drimseq dmdtubenchmark_nbsplic filedatadmelanogaster_dtu_results_countrdata savedmdtubenchmark_saturn dmdtubenchmark_doubleexpseq dmdtubenchmark_limmadiffsplic dmdtubenchmark_edgerdiffsplic dmdtubenchmark_dexseq dmdtubenchmark_drimseq dmdtubenchmark_nbsplic filedatadmelanogaster_dtu_results_scaledtpmrdata titl _dmelanogaster_visu author jeroen gili date output html_document order run script _dmelanogaster_visualizermd result file dtu analysi dmelanogaster_dtu_results_countrdata altern dmelanogaster_dtu_results_scaledtpmrdata requir file either gener run _dmelanogaster_dturmd script download zenodo put data folder github repositori addit ground truth file dmelanogaster_metadata_txt also download zenodo put data folder github repositori result script fdrtpr curv alreadi avail github directori resultsdmelanogaster_benchmark r setup includefals echofals requireknitr opts_knitsetrootdir rprojrootfind_rstudio_root_fil load librari rmessagefalsewarningfals libraryggplot libraryicobra load dtu perform result ground truth file r truth readtablefil datadmelanogaster_metadata_txt sep header true loadfiledatadmelanogaster_dtu_results_countrdata loadfiledatadmelanogaster_dtu_results_scaledtpmrdata dmelanogasterbenchmark c dmdtubenchmark_saturn dmdtubenchmark_doubleexpseq dmdtubenchmark_limmadiffsplic dmdtubenchmark_edgerdiffsplic dmdtubenchmark_dexseq dmdtubenchmark_drimseq dmdtubenchmark_nbsplic remov empti enteri due test aka mani sampl reason runtim dmelanogasterbenchmark dmelanogasterbenchmarkwhich sapplydmelanogasterbenchmark functionx isnullxdtuanalysi rmdmdtubenchmark_saturn dmdtubenchmark_limmadiffsplic dmdtubenchmark_dexseq dmdtubenchmark_drimseq dmdtubenchmark_edgerdiffsplic dmdtubenchmark_nbsplic dmdtubenchmark_doubleexpseq invisiblegc helper function get pvalu differ method differ dataset r get_pvalu functiondatasetnmethod pvalu matrixdatana nrownrowdatasetdtuanalysi ncolnmethod rownamespvalu ascharacterdatasetdtuanalysistxnam nmethod pvalues_new dataframedatasetidtuanalysisp_valu rownamespvalues_new ascharacterdatasetidtuanalysistxnam colnamespvalues_new namesdataseti pvaluesi pvalues_newmatchrownamespvaluesrownamespvalues_new pvalu applypvalu asnumer rownamespvalu ascharacterdatasetdtuanalysistxnam pvalu asdataframepvalu pvalu pvaluesorderrownamespvalu colnamespvalu csaturn doubleexpseq limma_diffsplic edger_diffsplic dexseq drimseqnbsplic returnpvalu visual function r visualize_dataset functiondatasetnfiltersnmethod printpastethi function gener nfilter plot must select correct datafram list base list name select cfilterlenientfilterstring gener store data plot reslist c j nfilter printj print progress dmelanogaster_curr dmelanogasterbenchmarkgreplselectionj namesdmelanogasterbenchmark pvalu get_pvaluesdatasetdmelanogaster_currentnmethodsnmethod truth_file_curr truthtruthtranscript_id rownamespvalu truth_file_curr truth_file_currentordertruth_file_currenttranscript_id rownamestruth_file_curr truth_file_currenttranscript_id cobra cobradatapv pvalu truth truth_file_curr cobra calculate_adjpcobra cobraperf calculate_performancecobra binary_truth transcript_ds_statu cont_truth none splv none aspect cfdrtpr fdrtprcurv overlap cobraplot prepare_data_for_plotcobraperf colorschem dark facet true new_col crepcef e fe b deblack repwhit namesnew_col namescobraplotplotcolor cobraplotplotcolor new_col plot_ful plot_fdrtprcurvecobraplot xaxisrang c yaxisrang c titl c versu edger filter count versu drimseq filter count titl c versu edger filter scaledtpm versu drimseq filter scaledtpm current_titl titlesj plot_ful plot_ful ggtitlecurrent_titl themestripbackground element_blank striptextx element_blank plottitl element_texts axistextx element_texts axistexti element_texts axistitlex element_texts axistitley element_texts pngpasteresultsdmelanogaster_benchmarkfdrtpr_counts_ j png sep width height unit re pointsiz start export printplot_ful devoff pngpasteresultsdmelanogaster_benchmarkfdrtpr_scaledtpm_ j png sep width height unit re pointsiz start export printplot_ful devoff gener fdrtpr curv r visualize_datasetsdatasetdmelanogasterbenchmark nfilter nmethod titl _love_dtu_subset author jeroen gili date output html_document order run script _love_visualize_subsetrmd dataset love_dtu_results_scaledtpm_subsetrdata altern love_dtu_results_count_subsetrdata love_metadatarda requir file either gener _love_preparermd _love_dtu_subsetrmd script download zenodo put data folder github repositori result script fdrtpr curv alreadi avail github directori resultslove_benchmark r setup includefals echofals requireknitr opts_knitsetrootdir rprojrootfind_rstudio_root_fil load librari rmessagefals libraryggplot libraryicobra load dtu perform data r loadfiledatalove_dtu_results_scaledtpm_subsetrdata loadfiledatalove_dtu_results_count_subsetrdata lovebenchmark c lovedtubenchmark_saturn lovedtubenchmark_doubleexpseq lovedtubenchmark_limmadiffsplic lovedtubenchmark_edgerdiffsplic lovedtubenchmark_dexseq lovedtubenchmark_drimseq lovedtubenchmark_nbsplic lovedtubenchmark_bandit remov empti enteri due test aka mani sampl reason runtim lovebenchmark lovebenchmarkwhich sapplylovebenchmark functionx isnullxdtuanalysi rmlovedtubenchmark_saturn lovedtubenchmark_doubleexpseq lovedtubenchmark_limmadiffsplic lovedtubenchmark_edgerdiffsplic lovedtubenchmark_dexseq lovedtubenchmark_drimseq lovedtubenchmark_nbsplic lovedtubenchmark_bandit invisiblegc load wrangl truth file r defin truth copi swim downstream paper love et alfresearch loaddatalove_metadatarda txdf txdfmatchrownamestpm txdftxname txdfdtugen isodtu isodt isodteonli fulldtugen uniquetxdfgeneidtxdfdtugen txpexpr rowsumstpm dtudtegen uniquetxdfgeneidisodt isodteonli txdffulldtu isodtu txdfgeneid dtudtegen txpexpr dtutxp txdftxnametxdffulldtu helper function get pvalu differ method differ dataset r get_pvalu functiondatasetnrepnmethod get_all_tx functiondatasetnrep all_tx c nrep current_tx ascharacterdatasetidtuanalysistxnam all_tx call_tx current_tx all_tx uniqueall_tx returnall_tx all_tx get_all_txsdatasetnrep pvalu matrixdatana nrowlengthall_tx ncolnmethodsnrep rownamespvalu all_tx nmethodsnrep pvalues_new dataframedatasetidtuanalysisp_valu rownamespvalues_new datasetidtuanalysistxnam colnamespvalues_new namesdataseti pvaluesi pvalues_newmatchrownamespvaluesrownamespvalues_new pvalu applypvalu asnumer rownamespvalu all_tx pvalu asdataframepvalu pvalu pvaluesorderrownamespvalu colnamespvalu csaturn doubleexpseq limmadiffsplic edgerdiffsplic dexseq drimseq nbsplice bandit returnpvalu visual function r visualize_dataset functiondatasetnfiltersnsamplesizesnrepnmethod nplot nfilter nsamples printpastethi function generatenplot plot must select correct datafram list base list name select c_rep__filterlenient_rep__filterlenient_rep__filterlenient_rep__filterstringent_rep__filterstringent_rep__filterstring gener store data plot reslist c j nplot printj print progress lovebenchmark_curr lovebenchmarkgreplselectionj nameslovebenchmark pvalu list k seq_lennrep get current repeat current dataset lovebenchmark_dataset_rep lovebenchmark_currentgreppasterep_k_filnameslovebenchmark_curr pvalues_curr get_pvalueslovebenchmark_dataset_repnmethod pvalues_currentisnapvalues_curr allow calcul averag result repeat concaten thte result repeat requir nonident rownam rownamespvalues_curr pasterownamespvalues_current_k omit saturn supplementari figur pvalues_curr pvalues_currentc pvaluesk pvalues_curr concaten get averag perform three dataset pvalues_ful rbindpvaluespvaluespvalu gener truth file truth_ful asdataframecbindrownamespvalues_fullrepnrowpvalues_ful colnamestruth_ful ctxnametruth rownamestruth_ful truth_fulltxnam truth_fulltruth asnumericascharactertruth_fulltruth truth_fullwhichsub_ truth_fulltxnam dtutxpstruth cobra cobradatapv pvalues_ful truth truth_ful cobra calculate_adjpcobra cobraperf calculate_performancecobra binary_truth truth cont_truth none splv none aspect cfdrtpr fdrtprcurv overlap cobraplot prepare_data_for_plotcobraperf colorschem dark facet true new_col crepcccaef e fe b de black repwhit namesnew_col namescobraplotplotcolor cobraplotplotcolor new_col plot_ful plot_fdrtprcurvecobraplot xaxisrang c yaxisrang c titl c versu edger filter scaledtpm versu edger filter scaledtpm versu edger filter scaledtpm versu drimseq filter scaledtpm versu drimseq filter scaledtpm versu drimseq filter scaledtpm titl c versu edger filter count versu edger filter count versu edger filter count versu drimseq filter count versu drimseq filter count versu drimseq filter count current_titl titlesj plot_ful plot_ful ggtitlecurrent_titl themestripbackground element_blank striptextx element_blank plottitl element_texts axistextx element_texts axistexti element_texts axistitlex element_texts axistitley element_texts pngpasteresultslove_benchmarkfdrtpr_scaledtpm_subset_ j png sep width height unit re pointsiz start export printplot_ful devoff gener fdrtpr curv gener amongst other figur r visualize_datasetsdatasetlovebenchmark nfilter nsamples nrep nmethod titl _love_prepar author jeroen gili date output html_document order run script _love_preparermd folder love_salmonzip contain salmon quantif file dataset download zenodo unzip addit metadata file love_metadatarda also download zenodo file must copi data folder github page note quantif file gener read paper love et alswim downstreamhttpsdoiorgfresearch see three zenodo link paper access raw data howev public use recent version salmon salmon v quantif provid metadata file exact copi simulaterda file love et al dataset see zenodo link want run script output also download zenodo love_benchmark_datasets_scaledtpmrdata alern love_benchmark_datasets_countrdata love_eff_lenrd r setup includefals echofals requireknitr opts_knitsetrootdir rprojrootfind_rstudio_root_fil load librari rmessagefalsewarningfasl librarytximport librarydrimseq libraryedg librarydomc librarybandit load data r rootdir rprojrootfind_rstudio_root_fil sample_nam csample_sample_sample_sample_sample_sample_sample_sample_sample_sample_sample_sample_sample_sample_sample_sample_sample_sample_sample_sample_sample_sample_sample_sample_ quant_fil filepathrootdir datalove_salmon sample_nam quantsf fileexistsquant_fil txi tximportfil quant_fil type salmon countsfromabund txout true txi tximportfil quant_fil type salmon countsfromabund scaledtpm txout true mydesign dataframesample_id ascharactersample_nam condit ascharacterrepcabeach colnamestxicount mydesignsample_id load metadata r loaddatalove_metadatarda make tx info copi match benchmark data txinfo txdf colnamestxinfo cisoform_idgene_id txdf txdfmatchrownamestpm txdftxname txdfdtugen isodtu isodt isodteonli fulldtugen uniquetxdfgeneidtxdfdtugen txpexpr rowsumstpm dtudtegen uniquetxdfgeneidisodt isodteonli txdffulldtu isodtu txdfgeneid dtudtegen txpexpr dtutxp txdftxnametxdffulldtu use truth love et al assign truth info df txinfogenemodifi txinfoisoform_id dtutxp comput effect transcript length bandit r eff_len eff_len_computex_eff_len txilength saverdseff_len datalove_eff_lenrd equiv_classes_fil filepathrootdir datalove_salmon sample_nam aux_info eq_classestxt allfileexistsequiv_classes_fil setup gener benchmark data set hyperparamet benchmark dataset ie sampl size number repeat fraction dtu gene paramet parallel process r set paramet samplesprcondit c nrrepsmad nrcorestous set parallel process ifnrcorestous doparallel true doprogress none registerdomccor nrcorestous els doparallel fals doprogress text list loop nrreplist split rep x samplesprcondit time nrrepsmad past samples_used_ rep x samplesprcondit time nrrepsmad _rep_ sort rep x nrrepsmad time lengthsamplesprcondit lenient filter note use getbenchmark_datar script gener benchmark dataset function deefin script still r lovebenchmarkleni lapplyclengthnrreplist functionx step extract random subsampl correct size setseedx localsamples nrreplistx iftru samplestousecond samplemydesignsample_idwhichmydesigncondit localsamples samplestousecond samplemydesignsample_idwhichmydesigncondit b localsamples samplestousecond ascharactersamplestousecond samplestousecond ascharactersamplestousecond localdesign mydesignwhich mydesignsample_id c samplestousecond samplestousecond step subset express featur use edgerfilterbyexpr iftru edgerdgelistcount txicountslocaldesignsample_id design modelmatrixcondit datalocaldesign filter edgerfilterbyexprydesigndesign localcm ycountsfilt get multiisoform gene filter localtx txinfowhich txinfoisoform_id rownameslocalcm tmp tablelocaltxgene_id tmp tmpwhich tmp localtx localtxwhichlocaltxgene_id namestmp localcm localcmwhichrownameslocalcm localtxisoform_id add column sampl size easi retriev localtxnrsamplespercondit localsamples colnameslocaltx ctxnamegeneidgene_modifiednrsamplespercondit combin data datalist list data localcm design localdesign metainfo localtx returndatalist nameslovebenchmarkleni pastenamesnrreplist_filterleni stringent filter r lovebenchmarkstring lapplyclengthnrreplist functionx step extract random subsampl correct size setseedx localsamples nrreplistx iftru samplestousecond sampl mydesignsample_idwhichmydesigncondit localsamples samplestousecond sampl mydesignsample_idwhichmydesigncondit b localsamples samplestousecond ascharactersamplestousecond samplestousecond ascharactersamplestousecond localdesign mydesignwhich mydesignsample_id c samplestousecond samplestousecond step subset express featur use drimseqdmfilt iftru localcm txicountslocaldesignsample_id localcm asdataframelocalcm colnameslocalcm geneforeachtx txinfomatchrownameslocalcmtxinfoisoform_idgene_id localcmgene_id geneforeachtx localcmfeature_id rownameslocalcm drimseqdmdsdatacount localcm sampl localdesign dmfilterd min_samps_feature_exprlocalsamples min_feature_expr min_samps_feature_proplocalsamples min_feature_prop min_samps_gene_exprlocalsamples min_gene_expr localcm txicountscountsdfeature_idlocaldesignsample_id get multiisoform gene filter localtx txinfowhich txinfoisoform_id rownameslocalcm tmp tablelocaltxgene_id tmp tmpwhich tmp localtx localtxwhichlocaltxgene_id namestmp localcm localcmwhichrownameslocalcm localtxisoform_id add column sampl size easi retriev localtxnrsamplespercondit localsamples colnameslocaltx ctxnamegeneidgene_modifiednrsamplespercondit combin data datalist list data localcm design localdesign metainfo localtx returndatalist nameslovebenchmarkstring pastenamesnrreplist_filterstring save love benchmark data r savelovebenchmarkleni lovebenchmarkstring filedatalove_benchmark_datasets_countrdata savelovebenchmarkleni lovebenchmarkstring filedatalove_benchmark_datasets_scaledtpmrdata titl _love_dtu_subset author jeroen gili date output html_document addit analysi perform dtu analysi benchmark dataset love et al subset transcript allow us addit benchmark bandit default set seem scale poorli respect number transcript data could thu includ benchmark order run script _love_dtu_subsetrmd dataset love_benchmark_datasets_scaledtpmrdata altern love_benchmark_datasets_countrdata requir file either gener _love_preparermd script download zenodo run dtu analys dtu method love benchmark dataset reduc number transcript code run approxim hour macbook pro processor ghz quadcor intel core gb ram runtim attribut bandit analysi want run script output also download zenodo love_dtu_results_scaledtpm_subsetrdata alern love_dtu_results_count_subsetrdata r setup includefals echofals requireknitr opts_knitsetrootdir rprojrootfind_rstudio_root_fil load dtu method sourc file allow run seven dtu method assess paper saturn doubleexpseq limma diffsplic edgerdiffsplic dexseq drimseq nbsplice r messagefals warningfals load librari libraryedg librarylimma librarydexseq librarydrimseq librarydoubleexpseq librarynbsplic librarysaturn librarybandit librarydomc librarystringr sourcefileperformance_benchmarksdtu_methodsr bandit r function run bandit bandits_dtu functioncountdata txgene sampledata get equival class count ecc file sample_nam csample_sample_sample_sample_sample_sample_sample_sample_sample_sample_sample_sample_sample_sample_sample_sample_sample_sample_sample_sample_sample_sample_sample_sample_ equiv_classes_fil filepathdatalove_salmon sample_nam aux_info eq_classestxt equiv_classes_fil equiv_classes_fileswhichunliststr_extract_allequiv_classes_fil sample_ colnamescountdata eff_len readrdsdatalove_eff_lenrd get median effect tx length colnamestxgen ctxname geneid group factorsampledatacondit design modelmatrixgroup eff_len eff_lenwhichnameseff_len rownamescountdata txgene_bandit txgenec transcripts_to_keep filter_transcriptsgene_to_transcript txgene_bandit transcript_count countdata min_transcript_proport min_transcript_count min_gene_count input_data create_datasalmon_or_kallisto salmon gene_to_transcript txgene_bandit salmon_path_to_eq_class equiv_classes_fil eff_len eff_len n_core transcripts_to_keep transcripts_to_keep precis prior_precisiongene_to_transcript txgene_bandit transcript_count countdata n_core result banditstest_dtubandits_data input_data precis precisionprior samples_design sampledata group_col_nam condit r burn_in gene_to_transcript txgene_bandit n_core localr resultstranscript_resultsc rownameslocalr localrestxnam colnameslocalr colnameslocalr ctxname geneid p_valuefdr returnlocalr set parallel execut note optim paramet set parallel dtu analys depend specif comput system r nrcore ifnrcor doparallel true doprogress none registerdomccor nrcore els doparallel fals doprogress text run analysi method love benchmark dataset run dtu analys dtu method love benchmark dataset reduc number transcript code run approxim hour macbook pro processor ghz quadcor intel core gb ram runtim attribut bandit analysi r load benchmark data loadfiledatalove_benchmark_datasets_scaledtpmrdata loadfiledatalove_benchmark_datasets_countrdata perform analysi count lovebenchmarkdata clovebenchmarklenientlovebenchmarkstring allow bandit analysi use less transcript loop listfilt transcript random subsampl gene setse seq_alonglovebenchmarkdata lovebenchmarkdataimetainfo lovebenchmarkdataimetainfowhichlovebenchmarkdataimetainfogeneid samplelovebenchmarkdataimetainfogeneid sampl gene lovebenchmarkdataidata lovebenchmarkdataidatalovebenchmarkdataimetainfotxnam run dtu analysi benchmark data printstart saturn tstart systim suppresswarningslovedtubenchmark_saturn plyrllpli data lovebenchmarkdata inform true fun functionlocaldata perform dtu analysi localr saturn_dtu countdata localdatadata txgene localdatametainfo sampledata localdatadesign massag localresgene_modifi localdatametainfogene_modifiedmatch localrestxnam localdatametainfotxnam return result returnlistdtuanalysi localr difftimesystim tstart printstart doubleexpseq lovedtubenchmark_doubleexpseq plyrllpli data lovebenchmarkdata parallel doparallel progress doprogress inform true fun functionlocaldata perform dtu analysi localr doubleexpseq_dtu countdata localdatadata txgene localdatametainfo sampledata localdatadesign quietfals massag localresgene_modifi localdatametainfogene_modifiedmatch localrestxnam localdatametainfotxnam return result returnlistdtuanalysi localr printstart limma diffsplic lovedtubenchmark_limmadiffsplic plyrllpli data lovebenchmarkdata parallel doparallel progress doprogress inform true fun functionlocaldata perform dtu analysi localr limma_diffsplice_dtu countdata localdatadata txgene localdatametainfo sampledata localdatadesign massag localresgene_modifi localdatametainfogene_modifiedmatch localrestxnam localdatametainfotxnam return result returnlistdtuanalysi localr printstart edger_diffsplic lovedtubenchmark_edgerdiffsplic plyrllpli data lovebenchmarkdata parallel doparallel progress doprogress inform true fun functionlocaldata perform dtu analysi systim localr edger_diffsplice_dtu countdata localdatadata txgene localdatametainfo sampledata localdatadesign massag localresgene_modifi localdatametainfogene_modifiedmatch localrestxnam localdatametainfotxnam return result returnlistdtuanalysi localr printstart dexseq tstart systim lovedtubenchmark_dexseq plyrllpli data lovebenchmarkdata parallel doparallel progress doprogress inform true fun functionlocaldata perform dtu analysi localr dexseq_dtu countdata localdatadata txgene localdatametainfo sampledata localdatadesign massag localresgene_modifi localdatametainfogene_modifiedmatch localrestxnam localdatametainfotxnam return result returnlistdtuanalysi localr difftimesystim tstart printstart drimseq tstart systim lovedtubenchmark_drimseq plyrllpli data lovebenchmarkdata parallel doparallel progress doprogress inform true fun functionlocaldata perform dtu analysi localr drimseq_dtu countdata localdatadata txgene localdatametainfo sampledata localdatadesign massag localresgene_modifi localdatametainfogene_modifiedmatch localrestxnam localdatametainfotxnam return result returnlistdtuanalysi localr difftimesystim tstart printstart nbsplice tstart systim lovedtubenchmark_nbsplic plyrllpli data lovebenchmarkdata parallel doparallel progress doprogress inform true fun functionlocaldata perform dtu analysi localr nbsplice_dtu countdata localdatadata txgene localdatametainfo sampledata localdatadesign massag localresgene_modifi localdatametainfogene_modifiedmatch localrestxnam localdatametainfotxnam return result returnlistdtuanalysi localr difftimesystim tstart printstart bandit bandit run hour tstart systim suppresswarningslovedtubenchmark_bandit plyrllpli data lovebenchmarkdata inform true fun functionlocaldata perform dtu analysi localr bandits_dtu countdata localdatadata txgene localdatametainfo sampledata localdatadesign massag localresgene_modifi localdatametainfogene_modifiedmatch localrestxnam localdatametainfotxnam return result returnlistdtuanalysi localr difftimesystim tstart add method name list name easi postanalysi nameslovedtubenchmark_saturn pastesaturn_ nameslovedtubenchmark_saturn nameslovedtubenchmark_doubleexpseq pastedoubleexpseq_ nameslovedtubenchmark_doubleexpseq nameslovedtubenchmark_edgerdiffsplic pasteedger_diffsplice_ nameslovedtubenchmark_edgerdiffsplic nameslovedtubenchmark_limmadiffsplic pastelimma_diffsplice_ nameslovedtubenchmark_limmadiffsplic nameslovedtubenchmark_dexseq pastedexseq_ nameslovedtubenchmark_dexseq nameslovedtubenchmark_drimseq pastedrimseq_ nameslovedtubenchmark_drimseq nameslovedtubenchmark_nbsplic pastenbsplice_ nameslovedtubenchmark_nbsplic nameslovedtubenchmark_bandit pastebandits_ nameslovedtubenchmark_bandit save result save lovedtubenchmark_saturn lovedtubenchmark_doubleexpseq lovedtubenchmark_limmadiffsplic lovedtubenchmark_edgerdiffsplic lovedtubenchmark_dexseq lovedtubenchmark_drimseq lovedtubenchmark_nbsplic lovedtubenchmark_bandit filedatalove_dtu_results_scaledtpm_subsetrdata save lovedtubenchmark_saturn lovedtubenchmark_doubleexpseq lovedtubenchmark_limmadiffsplic lovedtubenchmark_edgerdiffsplic lovedtubenchmark_dexseq lovedtubenchmark_drimseq lovedtubenchmark_nbsplic lovedtubenchmark_bandit filedatalove_dtu_results_count_subsetrdata titl _love_visu author jeroen gili date output html_document order run script _love_visualizermd dataset love_dtu_results_scaledtpmrdata altern love_dtu_results_countrdata love_metadatarda requir file either gener _love_preparermd _love_dturmd script download zenodo put data folder github repositori result script fdrtpr curv alreadi avail github directori resultslove_benchmark r setup includefals echofals requireknitr opts_knitsetrootdir rprojrootfind_rstudio_root_fil load librari rmessagefals libraryggplot libraryicobra load dtu perform data r loadfiledatalove_dtu_results_scaledtpmrdata loadfiledatalove_dtu_results_countrdata run visual count data lovebenchmark c lovedtubenchmark_saturn lovedtubenchmark_doubleexpseq lovedtubenchmark_limmadiffsplic lovedtubenchmark_edgerdiffsplic lovedtubenchmark_dexseq lovedtubenchmark_drimseq lovedtubenchmark_nbsplic remov empti enteri due test aka mani sampl reason runtim lovebenchmark lovebenchmarkwhich sapplylovebenchmark functionx isnullxdtuanalysi rmlovedtubenchmark_saturn lovedtubenchmark_doubleexpseq lovedtubenchmark_limmadiffsplic lovedtubenchmark_edgerdiffsplic lovedtubenchmark_dexseq lovedtubenchmark_drimseq lovedtubenchmark_nbsplic invisiblegc load wrangl truth file r defin truth copi swim downstream paper love et alfresearch loaddatalove_metadatarda txdf txdfmatchrownamestpm txdftxname txdfdtugen isodtu isodt isodteonli fulldtugen uniquetxdfgeneidtxdfdtugen txpexpr rowsumstpm dtudtegen uniquetxdfgeneidisodt isodteonli txdffulldtu isodtu txdfgeneid dtudtegen txpexpr dtutxp txdftxnametxdffulldtu helper function get pvalu differ method differ dataset r get_pvalu functiondatasetnrepnmethod get_all_tx functiondatasetnrep all_tx c nrep current_tx ascharacterdatasetidtuanalysistxnam all_tx call_tx current_tx all_tx uniqueall_tx returnall_tx all_tx get_all_txsdatasetnrep pvalu matrixdatana nrowlengthall_tx ncolnmethodsnrep rownamespvalu all_tx nmethodsnrep pvalues_new dataframedatasetidtuanalysisp_valu rownamespvalues_new datasetidtuanalysistxnam colnamespvalues_new namesdataseti pvaluesi pvalues_newmatchrownamespvaluesrownamespvalues_new pvalu applypvalu asnumer rownamespvalu all_tx pvalu asdataframepvalu pvalu pvaluesorderrownamespvalu colnamespvalu csaturn doubleexpseq limmadiffsplic edgerdiffsplic dexseq drimseq nbsplice returnpvalu visual function r visualize_dataset functiondatasetnfiltersnsamplesizesnrepnmethod ndataset nfilter nsamples printpastethi function generatendataset plot must select correct datafram list base list name select c_rep__filterlenient_rep__filterlenient_rep__filterlenient_rep__filterstringent_rep__filterstringent_rep__filterstring j seq_lenndataset printj print progress get current dataset lovebenchmark_dataset lovebenchmarkgreplselectionj nameslovebenchmark pvalu list k seq_lennrep get current repeat current dataset lovebenchmark_dataset_rep lovebenchmark_datasetgreppasterep_k_filnameslovebenchmark_dataset pvalues_curr get_pvalueslovebenchmark_dataset_repnmethod pvalues_currentisnapvalues_curr allow calcul averag result repeat concaten thte result repeat requir nonident rownam rownamespvalues_curr pasterownamespvalues_current_k pvaluesk pvalues_curr concaten get averag perform three dataset pvalues_ful rbindpvaluespvaluespvalu gener truth file truth_full_new asdataframecbindrownamespvalues_fullrepnrowpvalues_ful colnamestruth_full_new ctxnametruth rownamestruth_full_new truth_full_newtxnam truth_full_newtruth asnumericascharactertruth_full_newtruth truth_full_newwhichsub_ truth_full_newtxnam dtutxpstruth plot fdrtpr icobra cobra cobradatapv pvalues_ful truth truth_full_new cobra calculate_adjpcobra cobraperf calculate_performancecobra binary_truth truth cont_truth none splv none aspect cfdrtpr fdrtprcurv overlap cobraplot prepare_data_for_plotcobraperf colorschem dark facet true new_col crepcef e fe b de black repwhit namesnew_col namescobraplotplotcolor cobraplotplotcolor new_col plot_ful plot_fdrtprcurvecobraplot xaxisrang c yaxisrang c titl c versu edger filter scaledtpm versu edger filter scaledtpm versu edger filter scaledtpm versu drimseq filter scaledtpm versu drimseq filter scaledtpm versu drimseq filter scaledtpm titl c versu edger filter count versu edger filter count versu edger filter count versu drimseq filter count versu drimseq filter count versu drimseq filter count current_titl titlesj plot_ful plot_ful ggtitlecurrent_titl themestripbackground element_blank striptextx element_blank plottitl element_texts axistextx element_texts axistexti element_texts axistitlex element_texts axistitley element_texts pngpasteresultslove_benchmarkfdrtpr_scaledtpm_ j png sep width height unit re pointsiz start export printplot_ful devoff pngpasteresultslove_benchmarkfdrtpr_count_ j png sep width height unit re pointsiz start export printplot_ful devoff gener fdrtpr curv r visualize_datasetsdatasetlovebenchmark nfilter nsamples nrep nmethod titl _love_dtu author jeroen gili date output html_document order run script _love_dturmd dataset love_benchmark_datasets_scaledtpmrdata altern love_benchmark_datasets_countrdata requir file either gener _love_preparermd script download zenodo run dtu analys dtu method love benchmark dataset code run approxim hour minut macbook pro processor ghz quadcor intel core gb ram runtim attribut dexseq analysi want run script output also download zenodo love_dtu_results_scaledtpmrdata altern love_dtu_results_countrdata r setup includefals echofals requireknitr opts_knitsetrootdir rprojrootfind_rstudio_root_fil load dtu method sourc file allow run seven dtu method assess paper saturn doubleexpseq limma diffsplic edgerdiffsplic dexseq drimseq nbsplice r messagefals warningfals load librari libraryedg librarylimma librarydexseq librarydrimseq librarydoubleexpseq librarynbsplic librarysaturn librarydomc sourcefileperformance_benchmarksdtu_methodsr set parallel execut note optim paramet set parallel dtu analys depend specif comput system r nrcore ifnrcor doparallel true doprogress none registerdomccor nrcore els doparallel fals doprogress text run analysi method love benchmark dataset run dtu analys dtu method love benchmark dataset code run approxim hour minut macbook pro processor ghz quadcor intel core gb ram runtim attribut drimseq analysi r load benchmark data loadfiledatalove_benchmark_datasets_scaledtpmrdata loadfiledatalove_benchmark_datasets_countrdata run analysi count data lovebenchmarkdata clovebenchmarklenientlovebenchmarkstring run dtu analysi benchmark data printstart saturn tstart systim suppresswarningslovedtubenchmark_saturn plyrllpli data lovebenchmarkdata inform true fun functionlocaldata perform dtu analysi localr saturn_dtu countdata localdatadata txgene localdatametainfo sampledata localdatadesign massag localresgene_modifi localdatametainfogene_modifiedmatch localrestxnam localdatametainfotxnam return result returnlistdtuanalysi localr difftimesystim tstart printstart doubleexpseq tstart systim lovedtubenchmark_doubleexpseq plyrllpli data lovebenchmarkdata parallel doparallel progress doprogress inform true fun functionlocaldata perform dtu analysi localr doubleexpseq_dtu countdata localdatadata txgene localdatametainfo sampledata localdatadesign quietfals massag localresgene_modifi localdatametainfogene_modifiedmatch localrestxnam localdatametainfotxnam return result returnlistdtuanalysi localr difftimesystim tstart printstart limma diffsplic tstart systim lovedtubenchmark_limmadiffsplic plyrllpli data lovebenchmarkdata parallel doparallel progress doprogress inform true fun functionlocaldata perform dtu analysi localr limma_diffsplice_dtu countdata localdatadata txgene localdatametainfo sampledata localdatadesign massag localresgene_modifi localdatametainfogene_modifiedmatch localrestxnam localdatametainfotxnam return result returnlistdtuanalysi localr difftimesystim tstart printstart edger_diffsplic tstart systim lovedtubenchmark_edgerdiffsplic plyrllpli data lovebenchmarkdata parallel doparallel progress doprogress inform true fun functionlocaldata perform dtu analysi localr edger_diffsplice_dtu countdata localdatadata txgene localdatametainfo sampledata localdatadesign massag localresgene_modifi localdatametainfogene_modifiedmatch localrestxnam localdatametainfotxnam return result returnlistdtuanalysi localr difftimesystim tstart printstart dexseq dexseq tstart systim lovedtubenchmark_dexseq plyrllpli data lovebenchmarkdata parallel doparallel progress doprogress inform true fun functionlocaldata perform dtu analysi localr dexseq_dtu countdata localdatadata txgene localdatametainfo sampledata localdatadesign massag localresgene_modifi localdatametainfogene_modifiedmatch localrestxnam localdatametainfotxnam return result returnlistdtuanalysi localr difftimesystim tstart printstart drimseq tstart systim lovedtubenchmark_drimseq plyrllpli data lovebenchmarkdata parallel doparallel progress doprogress inform true fun functionlocaldata perform dtu analysi localr drimseq_dtu countdata localdatadata txgene localdatametainfo sampledata localdatadesign massag localresgene_modifi localdatametainfogene_modifiedmatch localrestxnam localdatametainfotxnam return result returnlistdtuanalysi localr difftimesystim tstart printstart nbsplice tstart systim lovedtubenchmark_nbsplic plyrllpli data lovebenchmarkdata parallel doparallel progress doprogress inform true fun functionlocaldata perform dtu analysi localr nbsplice_dtu countdata localdatadata txgene localdatametainfo sampledata localdatadesign massag localresgene_modifi localdatametainfogene_modifiedmatch localrestxnam localdatametainfotxnam return result returnlistdtuanalysi localr difftimesystim tstart add method name list name easi postanalysi nameslovedtubenchmark_saturn pastesaturn_ nameslovedtubenchmark_saturn nameslovedtubenchmark_doubleexpseq pastedoubleexpseq_ nameslovedtubenchmark_doubleexpseq nameslovedtubenchmark_edgerdiffsplic pasteedger_diffsplice_ nameslovedtubenchmark_edgerdiffsplic nameslovedtubenchmark_limmadiffsplic pastelimma_diffsplice_ nameslovedtubenchmark_limmadiffsplic nameslovedtubenchmark_dexseq pastedexseq_ nameslovedtubenchmark_dexseq nameslovedtubenchmark_drimseq pastedrimseq_ nameslovedtubenchmark_drimseq nameslovedtubenchmark_nbsplic pastenbsplice_ nameslovedtubenchmark_nbsplic save result save lovedtubenchmark_saturn lovedtubenchmark_doubleexpseq lovedtubenchmark_limmadiffsplic lovedtubenchmark_edgerdiffsplic lovedtubenchmark_dexseq lovedtubenchmark_drimseq lovedtubenchmark_nbsplic filedatalove_dtu_results_scaledtpmrdata savelovedtubenchmark_saturn lovedtubenchmark_doubleexpseq lovedtubenchmark_limmadiffsplic lovedtubenchmark_edgerdiffsplic lovedtubenchmark_dexseq lovedtubenchmark_drimseq lovedtubenchmark_nbsplic filedatalove_dtu_results_countrdata count data use input titl _love_ author jeroen gili date output html_document script _love_srmd seper script reproduc figur public order run script _love_dtu_subsetrmd dataset love_benchmark_datasets_scaledtpmrdata altern love_benchmark_datasets_countrdata requir file either gener _love_preparermd script download zenodo r setup includefals echofals requireknitr opts_knitsetrootdir rprojrootfind_rstudio_root_fil load librari rmessagefals libraryggplot libraryicobra load dtu perform data r use scaledtpm result dataset base love et al count dataset loadfiledatalove_dtu_results_scaledtpmrdata lovebenchmark c lovedtubenchmark_saturn lovedtubenchmark_doubleexpseq lovedtubenchmark_limmadiffsplic lovedtubenchmark_edgerdiffsplic lovedtubenchmark_dexseq lovedtubenchmark_drimseq lovedtubenchmark_nbsplic remov empti enteri due test aka mani sampl reason runtim lovebenchmark lovebenchmarkwhich sapplylovebenchmark functionx isnullxdtuanalysi rmlovedtubenchmark_saturn lovedtubenchmark_doubleexpseq lovedtubenchmark_limmadiffsplic lovedtubenchmark_edgerdiffsplic lovedtubenchmark_dexseq lovedtubenchmark_drimseq lovedtubenchmark_nbsplic invisiblegc load wrangl truth file r defin truth copi swim downstream paper love et alfresearch loaddatalove_metadatarda txdf txdfmatchrownamestpm txdftxname txdfdtugen isodtu isodt isodteonli fulldtugen uniquetxdfgeneidtxdfdtugen txpexpr rowsumstpm dtudtegen uniquetxdfgeneidisodt isodteonli txdffulldtu isodtu txdfgeneid dtudtegen txpexpr dtutxp txdftxnametxdffulldtu figur sa r tval lovebenchmarksaturn_samples_used__rep__filterlenientdtuanalysistvalu pval lovebenchmarksaturn_samples_used__rep__filterlenientdtuanalysisp_value_raw zval qnormpval signtval zval_mid zvalabszv zval_mid zval_midisnazval_mid pngresultslove_benchmarkfigsapng width height unit re pointsiz start export plot locfdrlocfdrzval_mid main love dataset v edger filter repeat devoff figur sb r love_select lovebenchmarksaturn_samples_used__rep__filterlenientdtuanalysi pvalu asdataframecbindlove_selectp_value_rawlove_selectp_valu colnamespvalu ctheoretical_nul empirical_nul rownamespvalu rownameslove_select gener truth file truth_full_new asdataframecbindrownamespvaluesrepnrowpvalu colnamestruth_full_new ctxnametruth rownamestruth_full_new truth_full_newtxnam truth_full_newtruth asnumericascharactertruth_full_newtruth truth_full_newwhichsub_ truth_full_newtxnam dtutxpstruth cobra cobradatapv pvalu truth truth_full_new cobra calculate_adjpcobra cobraperf calculate_performancecobra binary_truth truth cont_truth none splv none aspect cfdrtpr fdrtprcurv overlap cobraplot prepare_data_for_plotcobraperf colorschem dark facet true new_col crepcblack grey repwhit namesnew_col namescobraplotplotcolor cobraplotplotcolor new_col plot plot_fdrtprcurvecobraplot xaxisrang c yaxisrang c plot plot ggtitlelabellov dataset v edger filter repeat xlabfdp themestripbackground element_blank striptextx element_blank plottitl element_texts axistextx element_texts axistexti element_texts axistitlex element_texts axistitley element_texts pngresultslove_benchmarkfigsbpng width height unit re pointsiz start export printplot devoff titl _hsapiens_visu author jeroen gili date output html_document order run script _hsapiens_visualizermd result file dtu analysi hsapiens_dtu_results_countrdata altern hsapiens_dtu_results_scaledtpmrdata requir file either gener run _hsapiens_dturmd script download zenodo put data folder github repositori addit ground truth file hsapiens_metadata_txt also download zenodo put data folder github repositori result script fdrtpr curv alreadi avail github directori resultshsapiens_benchmark r setup includefals echofals requireknitr opts_knitsetrootdir rprojrootfind_rstudio_root_fil load librari rmessagefals libraryggplot libraryicobra load dtu perform result ground truth file r truth readtablefil datahsapiens_metadata_txt sep header true loadfiledatahsapiens_dtu_results_countrdata loadfiledatahsapiens_dtu_results_scaledtpmrdata hsapiensbenchmark c hsdtubenchmark_saturn hsdtubenchmark_limmadiffsplic hsdtubenchmark_dexseq hsdtubenchmark_drimseq hsdtubenchmark_edgerdiffsplic hsdtubenchmark_nbsplic hsdtubenchmark_doubleexpseq hsapiensbenchmark hsapiensbenchmarkwhich sapplyhsapiensbenchmark functionx isnullxdtuanalysi rmhsdtubenchmark_saturn hsdtubenchmark_limmadiffsplic hsdtubenchmark_dexseq hsdtubenchmark_drimseq hsdtubenchmark_edgerdiffsplic hsdtubenchmark_nbsplic hsdtubenchmark_doubleexpseq invisiblegc helper function get pvalu differ method differ dataset r get_pvalu functiondatasetnmethod pvalu matrixdatana nrownrowdatasetdtuanalysi ncolnmethod rownamespvalu datasetdtuanalysistxnam nmethod pvalues_new dataframedatasetidtuanalysisp_valu rownamespvalues_new datasetidtuanalysistxnam colnamespvalues_new namesdataseti pvaluesi pvalues_newmatchrownamespvaluesrownamespvalues_new pvalu applypvalu asnumer rownamespvalu datasetdtuanalysistxnam pvalu asdataframepvalu pvalu pvaluesorderrownamespvalu colnamespvalu csaturn limma_diffsplic dexseqdrimseq edger_diffsplic nbsplice doubleexpseq returnpvalu visual function r visualize_dataset functiondatasetnfiltersnmethod printpastethi function gener nfilter plot must select correct datafram list base list name select cfilterlenientfilterstring gener store data plot reslist c j nfilter printj print progress hsapiens_curr hsapiensbenchmarkgreplselectionj nameshsapiensbenchmark pvalu get_pvalueshsapiens_currentnmethod truth_file_curr truthtruthtranscript_id rownamespvalu truth_file_curr truth_file_currentordertruth_file_currenttranscript_id rownamestruth_file_curr truth_file_currenttranscript_id cobra cobradatapv pvalu truth truth_file_curr cobra calculate_adjpcobra cobraperf calculate_performancecobra binary_truth transcript_ds_statu cont_truth none splv none aspect cfdrtpr fdrtprcurv overlap cobraplot prepare_data_for_plotcobraperf colorschem dark facet true drimseq new_col crepcef e fe b de black repwhit namesnew_col namescobraplotplotcolor cobraplotplotcolor new_col plot_ful plot_fdrtprcurvecobraplot xaxisrang c yaxisrang c titl c versu edger filter count versu drimseq filter count titl c versu edger filter scaledtpm versu drimseq filter scaledtpm current_titl titlesj plot_ful plot_ful ggtitlecurrent_titl themestripbackground element_blank striptextx element_blank plottitl element_texts axistextx element_texts axistexti element_texts axistitlex element_texts axistitley element_texts pngpasteresultshsapiens_benchmarkfdrtpr_counts_ j png sep width height unit re pointsiz start export printplot_ful devoff pngpasteresultshsapiens_benchmarkfdrtpr_scaledtpm_ j png sep width height unit re pointsiz start export printplot_ful devoff r visualize_datasetsdatasethsapiensbenchmark nfilter nmethod titl _hsapiens_dtu author jeroen gili date output html_document order run script _hsapiens_dturmd dataset hsapiens_benchmark_datasets_countrdata altern hsapiens_benchmark_datasets_scaledtpmrdata requir file either gener _hsapiens_preparermd script download zenodo run dtu analys dtu method hsapien benchmark dataset code run approxim minut macbook pro processor ghz quadcor intel core gb ram runtim attribut drimseq analysi want run script output also download zenodo hsapiens_dtu_results_countrdata altern hsapiens_dtu_results_scaledtpmrdata r setup includefals echofals requireknitr opts_knitsetrootdir rprojrootfind_rstudio_root_fil load dtu method sourc file allow run seven dtu method assess paper saturn doubleexpseq limma diffsplic edgerdiffsplic dexseq drimseq nbsplice r messagefals warningfals load librari libraryedg librarylimma librarydexseq librarydrimseq librarydoubleexpseq librarynbsplic librarysaturn librarydomc sourcefileperformance_benchmarksdtu_methodsr set parallel execut note optim paramet set parallel dtu analys depend specif comput system r nrcore ifnrcor doparallel true doprogress none registerdomccor nrcore els doparallel fals doprogress text run analysi method hsapien dataset run dtu analys dtu method hsapien benchmark dataset code run approxim minut macbook pro processor ghz quadcor intel core gb ram runtim analysi drimseq r load benchmark data loadfiledatahsapiens_benchmark_datasets_countrdata loadfiledatahsapiens_benchmark_datasets_scaledtpmrdata hsbenchmarkleni listhsbenchmarkleni hsbenchmarkstring listhsbenchmarkstring nameshsbenchmarkleni pastenameshsbenchmarkleni filterleni nameshsbenchmarkstring pastenameshsbenchmarkstring filterstring hsbenchmarkdata chsbenchmarklenienthsbenchmarkstring run dtu analysi benchmark data printstart saturn tstart systim suppresswarningshsdtubenchmark_saturn plyrllpli data hsbenchmarkdata inform true fun functionlocaldata perform dtu analysi localr saturn_dtu countdata localdatadata txgene localdatametainfo sampledata localdatadesign massag localresgene_modifi localdatametainfogene_modifiedmatch localrestxnam localdatametainfotxnam return result returnlistdtuanalysi localr difftimesystim tstart printstart edger_diffsplic tstart systim hsdtubenchmark_edgerdiffsplic plyrllpli data hsbenchmarkdata parallel doparallel progress doprogress inform true fun functionlocaldata perform dtu analysi localr edger_diffsplice_dtu countdata localdatadata txgene localdatametainfo sampledata localdatadesign massag localresgene_modifi localdatametainfogene_modifiedmatch localrestxnam localdatametainfotxnam return result returnlistdtuanalysi localr difftimesystim tstart printstart doubleexpseq tstart systim hsdtubenchmark_doubleexpseq plyrllpli data hsbenchmarkdata parallel doparallel progress doprogress inform true fun functionlocaldata perform dtu analysi localr doubleexpseq_dtu countdata localdatadata txgene localdatametainfo sampledata localdatadesign quietfals massag localresgene_modifi localdatametainfogene_modifiedmatch localrestxnam localdatametainfotxnam return result returnlistdtuanalysi localr difftimesystim tstart printstart nbsplice tstart systim hsdtubenchmark_nbsplic plyrllpli data hsbenchmarkdata parallel doparallel progress doprogress inform true fun functionlocaldata perform dtu analysi localr nbsplice_dtu countdata localdatadata txgene localdatametainfo sampledata localdatadesign massag localresgene_modifi localdatametainfogene_modifiedmatch localrestxnam localdatametainfotxnam return result returnlistdtuanalysi localr difftimesystim tstart printstart limma diffsplic tstart systim hsdtubenchmark_limmadiffsplic plyrllpli data hsbenchmarkdata parallel doparallel progress doprogress inform true fun functionlocaldata perform dtu analysi localr limma_diffsplice_dtu countdata localdatadata txgene localdatametainfo sampledata localdatadesign massag localresgene_modifi localdatametainfogene_modifiedmatch localrestxnam localdatametainfotxnam return result returnlistdtuanalysi localr difftimesystim tstart printstart dexseq dexseq tstart systim hsdtubenchmark_dexseq plyrllpli data hsbenchmarkdata parallel doparallel progress doprogress inform true fun functionlocaldata perform dtu analysi localr dexseq_dtu countdata localdatadata txgene localdatametainfo sampledata localdatadesign massag localresgene_modifi localdatametainfogene_modifiedmatch localrestxnam localdatametainfotxnam return result returnlistdtuanalysi localr difftimesystim tstart printstart drimseq tstart systim hsdtubenchmark_drimseq plyrllpli data hsbenchmarkdata parallel doparallel progress doprogress inform true fun functionlocaldata perform dtu analysi localr drimseq_dtu countdata localdatadata txgene localdatametainfo sampledata localdatadesign massag localresgene_modifi localdatametainfogene_modifiedmatch localrestxnam localdatametainfotxnam return result returnlistdtuanalysi localr difftimesystim tstart add method name list name easi postanalysi nameshsdtubenchmark_saturn pastesaturn_ nameshsdtubenchmark_saturn nameshsdtubenchmark_limmadiffsplic pastelimma_diffsplice_ nameshsdtubenchmark_limmadiffsplic nameshsdtubenchmark_dexseq pastedexseq_ nameshsdtubenchmark_dexseq nameshsdtubenchmark_drimseq pastedrimseq_ nameshsdtubenchmark_drimseq nameshsdtubenchmark_edgerdiffsplic pasteedger_diffsplice_ nameshsdtubenchmark_edgerdiffsplic nameshsdtubenchmark_nbsplic pastenbsplice_ nameshsdtubenchmark_nbsplic nameshsdtubenchmark_doubleexpseq pastedoubleexpseq_ nameshsdtubenchmark_doubleexpseq save result save hsdtubenchmark_saturn hsdtubenchmark_limmadiffsplic hsdtubenchmark_dexseq hsdtubenchmark_drimseq hsdtubenchmark_edgerdiffsplic hsdtubenchmark_nbsplic hsdtubenchmark_doubleexpseq filedatahsapiens_dtu_results_countrdata save hsdtubenchmark_saturn hsdtubenchmark_limmadiffsplic hsdtubenchmark_dexseq hsdtubenchmark_drimseq hsdtubenchmark_edgerdiffsplic hsdtubenchmark_nbsplic hsdtubenchmark_doubleexpseq filedatahsapiens_dtu_results_scaledtpmrdata titl _hsapiens_prepar author jeroen gili date output html_document order run script _hsapiens_preparermd folder hsapiens_kallistozip contain kallisto quantif file dataset download zenodo unzip addit two metadata file hsapiens_metadata_xlsx hsapiens_metadata_txt also download zenodo three file must copi data folder github page note raw data avail arrayexpresshttpswwwebiacukarrayexpressexperimentsemtab one want run script output also download zenodo hsapiens_benchmark_datasets_countrdata altern hsapiens_benchmark_datasets_scaledtpmrdata r setup includefals echofals requireknitr opts_knitsetrootdir rprojrootfind_rstudio_root_fil load librari rmessagefalsewarningfasl librarytximport librarydrimseq libraryedg load data r rootdir rprojrootfind_rstudio_root_fil sample_nam coutput_output_output_output_output_output_output_output_output_output_ quant_fil filepathrootdir datahsapiens_kallisto sample_nam abundanceh txi tximportfil quant_fil type kallisto countsfromabund txout true txi tximportfil quant_fil type kallisto countsfromabund scaledtpm txout true mydesign dataframesample_id ascharactersample_nam condit ascharacterrepcgroupgroupeach colnamestxicount mydesignsample_id load metadata r truth readtablefil datahsapiens_metadata_txt sep header true convers readtablefil datahsapiens_metadata_txt colnamesconvers ctarget_id transcript_id conversiontarget_id ascharacterconversiontarget_id conversiontranscript_id ascharacterconversiontranscript_id txinfo asdataframecbindascharactertruthgene_id ascharactertruthtranscript_id ascharactertruthtranscript_ds_statu colnamestxinfo cgene_id transcript_id gene_modifi txinfogene_id ascharactertxinfogene_id txinfotranscript_id ascharactertxinfotranscript_id txinfo txinfoc chang order way benchmark gener lenient filter benchmark dataset edger r hs_lenient asdataframetxicount txinfo_leni txinfo group asfactorrepcabeach design modelmatrixgroup sampledata design sampledata colnameshs_leni colnamessampledata csample_id condit hs_lenient edgerdgelistcount hs_lenientgroupgroup filter edgerfilterbyexprhs_lenientdesigndesign hs_lenient hs_lenientcountsfilt reorder correspond info txinfo_leni txinfo_lenientmatch rownameshs_leni txinfo_lenienttranscript_id filter gene one tx txinfo_leni txinfo_lenienttxinfo_lenientgene_id namestabletxinfo_lenientgene_idtabletxinfo_lenientgene_id hs_lenient hs_lenienttxinfo_lenienttranscript_id add column sampl size easi retriev txinfo_lenientnrsamplespercondit colnamestxinfo_leni ctxnamegeneidgene_modifiednrsamplespercondit rownamestxinfo_leni txinfo_lenienttxnam sampledata asdataframesampledata sampledatacondit asfactorrepcabeach hsbenchmarkleni list data asdataframehs_leni design sampledata metainfo txinfo_leni dimhsbenchmarklenientdata gener stringent filter benchmark dataset drimseq r hs_stringent asdataframetxicount txinfo_string txinfo group asfactorrepcabeach design modelmatrixgroup sampledata design sampledata colnameshs_string colnamessampledata csample_id condit hs_stringent hs_stringentrownameshs_stringentintxinfotranscript_id geneforeachtx txinfomatchrownameshs_stringenttxinfotranscript_idgene_id hs_stringentgene_id geneforeachtx hs_stringentfeature_id rownameshs_string drimseqdmdsdatacount hs_stringent sampl asdataframesampledata dmfilterd min_samps_feature_expr min_feature_expr min_samps_feature_prop min_feature_prop min_samps_gene_expr min_gene_expr hs_stringent asdataframetxicountscountsdfeature_id reorder correspond info txinfo_string txinfo_stringentmatch rownameshs_string txinfo_stringenttranscript_id filter gene one tx txinfo_string txinfo_stringenttxinfo_stringentgene_id namestabletxinfo_stringentgene_idtabletxinfo_stringentgene_id hs_stringent hs_stringenttxinfo_stringenttranscript_id add truth column txinfo_stringentgene_modifi truthtranscript_ds_statusmatchtxinfo_stringenttranscript_idascharactertruthtranscript_id add column sampl size easi retriev txinfo_stringentnrsamplespercondit colnamestxinfo_string ctxnamegeneidgene_modifiednrsamplespercondit rownamestxinfo_string txinfo_stringenttxnam sampledata asdataframesampledata sampledatacondit asfactorrepcabeach hsbenchmarkstring list data asdataframehs_string design asdataframesampledata metainfo txinfo_string dimhsbenchmarkstringentdata save hsapien benchmark data r savehsbenchmarkleni hsbenchmarkstring filedatahsapiens_benchmark_datasets_countrdata savehsbenchmarkleni hsbenchmarkstring filedatahsapiens_benchmark_datasets_scaledtpmrdata