methodolog softwar quantifi pseudotempor trajectori clinic dataset clinic dataset larg clinic dataset becom increasingli avail systemat mine associ phenotyp variabl character particular diseas specif properti clinic dataset repres challeng appli standard repertoir machin learn method assum reallif clinic data character follow featur contain mix data type continu binari ordin categor variabl censor data typic contain miss valu nonuniform pattern across data matrix uniqu defin label part clinic variabl use defin clinic group done sever meaningful way clinic trajectori pseudotim dynam phenotyp synchron data assum clinic dataset repres landscap possibl patient phenotyp variou multivari degre clinic graviti accompani detail appli treatment also assum possibl exist clinic trajectori ie clinic relev sequenc partli order phenotyp possibl repres consecut state develop diseas phenotyp lead final state ie lethal outcom clinic trajectori character proper pseudotim allow quantit character degre progress along trajectori clinic variabl plot function pseudotim given clinic trajectori also assum clinic trajectori character branch structur repres import bifurc develop diseas extract cellular trajectori wide use methodolog data analysi genom especi studi certain highli dynam phenomena differenti develop quantifi visual clinic trajectori repres challeng data mine problem due data specif method elast princip graph elpigraph extract analyz clinic trajectori develop semisupervis methodolog clinic data analysi base construct explor properti princip tree pt nonlinear gener princip compon analysi pca princip tree construct use elpigraph method previous exploit determin branch trajectori variou genoom dataset particular singl cell omic data methodolog take account specif clinic data provid tool follow step clinic data analysi univari multivari quantif nomin variabl includ origin implement optim scale ordin variabl sever origin method miss valu imput base singular valu decomposit set stateoftheart method manifold learn partit data accordingli branch princip tree analogu cluster associ branch clinic variabl extract clinic trajectori use princip tree approach associ trajectori clinic variabl visual clinic variabl use princip tree pseudotim plot clinic variabl along clinic trajectori methodolog implement python instal moment way use packag copi py file code folder make avail python path tutori simplifi tutori show basic step clintrajan analysi avail herehttpsgithubcomauranicclintrajanblobmastertutorialtutorialmd tutori better explain present jupyt notebookclintrajan_tutorialipynb case studi demonstr applic methodolog two clinic dataset one moder size patient one rel larg size patient complic myocardi infarct databas collect krasnoyarsk interdistrict clinic hospit russia year origin databas descript download httpsleicesterfigsharecomarticlesmyocardial_infarction_complications_databas contain inform patient featur character clinic phenotyp featur repres possibl complic myocardi infarct diseas two jupyt notebook provid exact protocol analysi databas order use download content git start notebook git folder qi_infarctusipynbqi_infarctusipynb notebook document quantif imput datat consist step remov column contain miss valu remov row contain miss valu determin complet part tabl classifi variabl type binari ordin continu categor variabl suppos convert use standard dummi code univari variabl quantif use quantifi complet part tabl comput svd order correspond intrins dimens estim project vector miss valu space obtain princip compon imput valu taken project valu pt_infarctusipynbpt_infarctusipynb notebook document analysi imput tabl use methodolog princip tree contain follow step preprocess dataset project space first princip compon conserv elbow rulebas estim number top princip compon use case defin class patientsimagesdefinition_of_classes_infarctuspng separ analysi depend complic lethal caus variabl use princip tree note view onlin notebook miss imag show introduc classif patient imag found hereimagesdefinition_of_classes_infarctuspng construct princip tree postprocess prune short edg extend extern branch order avoid border effect comput visual associ princip tree branch patient class determin root node tree associ complic class comput visual trajectori root node leaf node comput visual associ trajectori variabl comput visual connect complic variabl trajectori use princip tree visual variou variabl appli panel manifold learn method dataset diabet readmiss data set uci machin learn repositori dataset repres year clinic care us hospit integr deliveri network includ featur repres patient hospit outcom dataset download uci repositori httpsarchiveicsuciedumldatasetsdiabetesushospitalsforyear kaggl httpswwwkagglecombrandaodiabet data matrix contain hospit case patient suffer diabeti character attribut three jupyt notebook provid exact protocol analysi databas order use download content git start notebook git folder set_up_diabetes_data_for_modelingipynbset_up_diabetes_data_for_modelingipynb notebook provid encod diabet readmiss dataset qi_diabetesipynbqi_diabetesipynb notebook provid detail quantif diabet dataset pt_diabetesipynbpt_diabetesipynb notebook provid detail analysi clinic trajectori diabet dataset refer albergant l mirk e bac j chen h martin faur l barillot e pinello l gorban zinovyev robust scalabl learn complex intrins dataset geometri via elpigraph entropi httpswwwmdpicom golovenkin se bac j chervov mirk em orlova yv barillot e gorban zinovyev trajectori bifurc pseudotim larg clinic dataset applic myocardi infarct diabet data arxivhttpsarxivorgab clintrajan tutori trajan emperor optimu princepshttpsgithubcomauranicclintrajanblobmasterimagestrajanpng applic clintrajan clinic dataset consist two part quantif dataquantificationofthedata applic elpigraphapplicationofelpigraphtoquantifybranchingpseudotim downstream analysesdownstreamanalysesusingelpigraph illustr basic analysi step use dataset myocardi infarct complicationshttpsleicesterfigsharecomarticlesdatasetmyocardial_infarction_complications_databas order follow tutori one download clintrajan githttpsgithubcomauranicclintrajan unpack local easiest way run tutori run code clintrajan tutori jupyt notebookclintrajan_tutorialipynb altern one copypast run command conveni python environ exist also complet jupyt notebookshttpsgithubcomauranicclintrajan allow one reproduc analysi step report clintrajan manuscripthttpsarxivorgab quantif data quantif function clintrajan store modul clintraj_qi first import addit import modul clintrajan standard function import panda pd import numpi np import scipystat import matplotlibpyplot plt clintraj_qi import clintraj_optiscal import clintraj_eltre import clintraj_util import clintraj_ml import let us import dataset assum tabl tabdelimit contain number miss valu row column except first column contain observ name first row contain variabl name assum certain column row tabl contain mani miss valu elimin origin dataset contain categor nomin variabl must encod first use exampl dummi encod df pdread_csvdatainfarctionall_dummiestxtdelimitert displaydf quantify_nansdf httpsgithubcomauranicclintrajanblobmasterimagestable_importpng one see row complet valu column need know type differ variabl binari ordin continu variable_typ binari continu ordin detect_variable_typedfverbosefals need imput miss valu tabl need quantif alreadi simpl univari quantif done via dfqreplacement_info quantify_dataframe_univariatedfvariable_typ opentemptxtw fid fidwritereplacement_info note written case quantif paramet could use imput miss valu restor data tabl initi variabl scale imput miss valu one simpl idea comput svd complet part data matrix project data point miss variabl onto princip compon imput valu valu variabl project point dfq_imput svdcomplete_imputation_methoddfq variable_typ verbosetruenum_compon dequant_info invert_quant_infoload_quantification_infotemptxt df_imput dequantify_tabledfq_imputeddequant_info displaydf_imput readi quantifi data tabl appli optim scale ordin valu df remove_constant_columns_from_dataframedf_imput variable_nam str dfcolumn x dfdfcolumnsto_numpi x_origin x x_before_sc xcopi xcik optimal_scalingxvariable_typesverbosetruevmax output look like httpsgithubcomauranicclintrajanblobmasterimagesoptimal_scalingpng mean sum squar correl q valu quantifi ordin variabl ordin numer variabl increas final correl tabl one see signific correl congrat data matrix x appli elpigraphhttpssysbiocuriegithubioelpigraph algorithm note also kept origin matrix x_origin list list variabl variable_nam variabl type variable_typ applic elpigraphhttpssysbiocuriegithubioelpigraph quantifi branch pseudotim appli elpigraph let us first reduc dimension dataset testshttpsgithubcomjbacscikitdimens show intrins dimension much lower around let us appli princip compon analysi order reduc dimens number note center variabl zero mean scale unit varianc set svd_solver full help get reproduc result ye default pca reproduc sckitlearn reduced_dimens x scipystatszscorex pca pcan_componentsxshapesvd_solverful pcafit_transformx v pcacomponents_t mean_val npmeanxaxi x yreduced_dimens construct princip treehttpswwwmdpicom specifi one paramet number node tree explicitli show valu paramet close default one nnode tree_elpi elpigraphcomputeelasticprincipaltreexnnodesdrawpcaviewtru alphamulambda finalenergypen tree_elpi tree_elpi addit prune graph prune_the_treetree_elpi extend leaf reach extrem data point tree_extend extendleaves_modifiedx tree_elpi mode quantdist controlpar dosa fals produc simpl plot project princip tree pca plane topolog tree complex seem pca project httpsgithubcomauranicclintrajanblobmasterimagesprincipal_treepng particular linear project see less clearli two branch princip tree move need two partit data point proxim node graph multidimension data space tree segment mean sequenc node tree without branch point parit data tree branch vec_labels_by_branch partition_data_by_tree_branchesxtree_extend parit data proxim node partit dist elpigraphsrccorepartitiondatax x nodeposit tree_elpinodeposit squaredx npsumxaxiskeepdim maxblocks trimmingradiu npinf partition_by_nod npzeroslenpartit ip enumeratepartit partition_by_nodei p order visual intrins geometri princip tree use project data point rsupnsup rsupsup appli version forcedirect layouthttpsenwikipediaorgwikiforcedirected_graph_draw princip tree rememb tree planar graphhttpsenwikipediaorgwikiplanar_graph let us visual tree data point color proxim tree segment fig pltfigurefigs visualize_eltree_with_datatree_extendedxx_originalvmean_valkvariable_nam color_by_partit true visualize_partit vec_labels_by_branch pltshow httpsgithubcomauranicclintrajanblobmasterimagesprincipal_tree_segmentspng downstream analys use elpigraph let us visual someth interest use princip tree visual lethal case myocardi infarct complic thick tree edg visual mortal trend along variou clinic trajectori note tabl variabl let_is_ mean lethal outcom fig pltfigurefigs non_lethal_featur let_is_ visualize_eltree_with_datatree_extendedxx_originalvmean_valkvariable_nam color_by_featurenon_lethal_featur feature_edge_widthnon_lethal_featur invert_edge_valuetruemin_edge_widthmax_edge_width visualize_edge_width_asnodecoordinatestruecmapwint pltshow httpsgithubcomauranicclintrajanblobmasterimagesprincipal_tree_lethalitypng ok let us insightful visual let us highlight patient age year bronchyal asthma anamnesi fig pltfigurefigs ind npwherex_originalvariable_namesindexagex_originalvariable_namesindexzab_leg_ color k rangelenx ind colorsi r visualize_eltree_with_datatree_extendedxx_originalvmean_valcolorsvariable_nam highlight_subsetindsbig_point_sizecmaphot pltshow httpsgithubcomauranicclintrajanblobmasterimagesprincipal_tree_asthmapng want quantifi pseudotim need defin root node node correspond least complic case myocardi infarct let us make yet anoth visual order find visual use piechart proport complic node tree piechart show fraction uncompl case black fraction complic red size chart correspond number data point repres closest node graph note lethal outcom consid seriou complic fig pltfigurefigs ax figadd_subplot complication_var fibr_predspreds_tahjelud_tahfibr_jelud a_v_blokotek_lancrazrivdressl zsnrec_imp_im_sten inds_compl variable_namesindexa complication_var lethal x_originalvariable_namesindexlet_is_ has_compl npsumx_originalinds_complaxi ind npwherehas_complicationleth color r rangelenx ind colorsi k visualize_eltree_with_datatree_extendedxx_originalvmean_valcolorsvariable_nam highlight_subsetindsbig_point_sizenormal_point_sizeshownodenumberstru add_pie_chartsaxtree_extendednodepositionsdcolorsrkpartitionscal pltshow root_nod printroot noderoot_nod httpsgithubcomauranicclintrajanblobmasterimagesprincipal_tree_complicationspng result identifi node number potenti root proport complic least know start clinic trajectori quantifi pseudotim all_trajectoriesall_trajectories_edg extract_trajectoriestree_extendedroot_nod printlenall_trajectori trajectori found projstruct project_on_treextree_extend pseudotimetraj quantify_pseudotimeall_trajectoriesall_trajectories_edgesprojstruct nine clinic trajectori final identifi cluster us give mean though one way test set clinic variabl associ trajectori via nonlinear regress case binari variabl logist regress var ritm_ecg_p_ritm_ecg_p_ritm_ecg_p_ var var list_of_associ regression_of_variable_with_trajectoriespseudotimetrajvarvariable_nam variable_typesx_originalr_threshold produceplottru continuous_regression_typegpr verbosetru detect associ visual actual data valu shown red point probabl given logist regress shown red line simpl slide window smooth data shown blue line httpsgithubcomauranicclintrajanblobmasterimagesvariable_associationspng note scale number node along trajectori differ gener pseudotim quantifi along differ trajectori directli compar correspond complet differ physic time scale result regress applic sever variabl shown simultan plot pstt pseudotimetraj color rbg ivar enumeratevar val draw_pseudotime_dependencepsttvarvariable_namesvariable_typesx_originalcolorsi linewidthdraw_datapointsfals pltlegend pltshow httpsgithubcomauranicclintrajanblobmasterimagesvariable_associations_severalpng final pseudotim use visual pseudotempor profil quantiti deriv data exampl comput cumul function hazard order visual lethal risk along differ clinic trajectori use surviv analysi librari lifelin import lifelin lifelin import splinefitt lifelin import nelsonaalenfitt lifelin import kaplanmeierfitt color b g r c k wtabpinktabgreen event_data npzeroslendf event nparraydflet_is_ label death ipstt enumeratepseudotimetraj point psttpoint time psttpseudotim ip enumeratepoint event_datap timesi event_datap eventsp pltfigurefigs ipstt enumeratepseudotimetraj trajnam trajectorystrpstttrajectorystrpstttrajectori point psttpoint naf nelsonaalenfitt event_datapoint e event_datapoint naffitevent_datapoint event_observedevent_datapointslabeltrajnam nafplot_hazardbandwidthfontsizelinewidthcolorcolorsi httpsgithubcomauranicclintrajanblobmasterimageshazard_pseudotimepng see six nine trajectori associ significantli increas lethal risk