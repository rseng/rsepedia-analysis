cammiq cammiq softwar tool microbi identif quantif specif build compact index manag databas microbi genom particular bacterialvir genom ncbi refseqhttpswwwncbinlmnihgovrefseq databas answer queri follow form given set high throughput sequenc ht read obtain mixtur genom databas identifi correspond genom databas comput rel abund _to cite cammiq pleas mention_ httpswwwbiorxivorgcontentv instal cammiq depend though sever script compil code download databas written use bash shell python core program build index queri set read written c need compil use rel recent version current build cammiq test version gcc support c multithread handl use pthread openmphttpsenwikipediaorgwikiopenmp addit youll need follow compon compil sourc httpsgithubcomjlabeitparalleldivsufsort construct suffix array parallel lightweight fashion httpsgithubcommartinusrobinhoodhash faster memori effici altern stl unordered_map ibm ilog cplex optim studiohttpswwwibmcomproductsilogcplexoptimizationstudio gurobi optimizerhttpswwwgurobicomproductsgurobioptim cammiq requir either c interfac solv mix integ linear program ilp figur like composit genom mixtur base distribut queri read instal cammiq clone repositori run script install_cammiqsh prepar automat download relat repo compil code except youll first download instal latest version ibm ilog cplex optim studio eg gurobi optim eg git clone httpsgithubcomalgocancercammiq install_cammiqsh cplexdir cplex_dir install_cammiqsh gurobidir gurobi_dir gurobivers gurobi_vers cplex_dir replac absolut path cplex_studio use cplex use gurobi gurobi_dir replac absolut path linux gurobi directori addit youll need tell compil version gurobi optim usual ab abc format work use cammiq begin use cammiq first need index input genom cammiq index compos cammiq index compos three part necessari queri input read set repres ie maxim sparsifi shortest uniqu substr input genom organ prefix tree trie hash base common prefix encod binari file index_ubin ii set repres ie maxim sparsifi shortest doubli uniqu substr input genom organ prefix tree trie hash base common prefix encod binari file index_dbin iii metainform input genom includ genome_lengthsout text file contain genom length unique_lmer_count_uout text file contain number uniqu lmer genom unique_lmer_count_dout text file contain number doubli uniqu lmer genom construct index youll need run cammiq build option paramet command line option includ uniqu cammiq build set uniqu substr input genom consist index_ubin genome_lengthsout unique_lmer_count_uout note uniqu default option noth specifi command line instruct doubly_uniqu cammiq build set doubli uniqu substr input genom consist index_dbin genome_lengthsout unique_lmer_count_dout cammiq build complet indic consist file index file name modifi option see hand paramet includ follow list possibl mandatori paramet f map_fil mandatori map_fil give list refer genom fasta format eg allselect complet genom refseq bacteri archaeal viral domain download cammiqdownload constitut cammiq databas possibl alongwith ncbi taxonom inform input line map_fil contain least tabdelimit field left right file name genom id encod index file ncbi taxonom id organ name exampl format map_fil gcf__asmv_genomicfna azorhizobium caulinodan or gcf__asmv_genomicfna buchnera aphidicola str sg schizaphi graminum gcf__asmv_genomicfna cellulomona gilvu atcc gcf__asmv_genomicfna dictyoglomu thermophilum h gcf__asmv_genomicfna pelobact carbinolicu dsm shortcut f altern take list fasta file build index file howev queri index need organ inform fasta file map_fil use input queri mode real exampl map file index dataset present paper found httpsdrivegooglecomdriveufoldersilpzjbqsaowo_iglszdfqjehpn note fact recommend genom id grow number genom index featur design minim memori usag construct cammiq index see expect comput cost cammiqwhatistheexpectedcomputationalcostofcammiq detail final note map_fil gener genom id two differ line expect differ howev sometim genom id two distinct line word two fasta file genom id mean cammiq treat contig genom function turn use special case eg read_cnt style queri may want count number read origin genu yet correspond inform fasta file given speciesstrain level case may want use genom id genom belong speciesstrain build index need extrem care queri scenario two ident genom id differ genom fasta file avoid misus cammiq fasta_dir mandatori fasta_dir contain list fasta file name given map_fil k int option minimum length uniqu doublyuniqu substr consid cammiq index default valu k l int option strongli recommend potenti read length queri support cammiq index default valu l fit best read length instanc read queri length expect build index specifi l lmax int option recommend maximum length uniqu doublyuniqu substr consid cammiq index default valu lmax lmax l h intint int option length common prefix uniqu doublyuniqu substr hash default valu h k h note valu h requir less equal k note b h paramet take one two integ valu one input valu h cammiq set hash length collect uniqu substr collect doublyuniqu substr h two input valu h h cammiq set hash length uniqu substr h hash length doublyuniqu substr h index_fil option index_fil includ one two file name found build option uniqu option bin index set singl file name specifi doubly_uniqu option bin index set singl file name specifi option name bin bin file reset respect see cammiq index compos ofwhatiscammiqindexcomposedof default file name specifi index_ubin index_dbin metainform file name ie genome_lengthsout unique_lmer_count_uout unique_lmer_count_dout chang default locat directori store file howev directori index file name metainform file written directori given index file name int option number thread use cammiq index construct note cammiq use openmp index construct default autothread ie attempt use avail cpu comput exampl usag cammiq build doubly_uniqu k l lmax f genome_maptxt datafasta_dir command line instruct build doublyuniqu substr encod index_dbin genom list genome_maptxt store directori datafasta_dir substr length rang thread support queri read length roughli note h specifi cammiq take default valu cammiq build k l lmax h f genome_mapout datafasta_dir dataindicesindex_u_testbin cammiq build uniqu k l lmax h f genome_mapout datafasta_dir dataindicesindex_u_testbin either two command line instruct build uniqu substr encod dataindicesindex_u_testbin metainform file written dataindic genom list genome_maptxt store directori datafasta_dir substr length rang thread support queri read length roughli note h set exceed maximum allow valu k cammiq build k l lmax h f bacteriafa bacteriafa bacteriafa command line instruct build uniqu doubli substr genom bacteriafa bacteriafa bacteriafa substr length rang support queri read length roughli usual much refer genom result list f paramet advoc though support cammiq sinc specifi cammiq attempt use maximum number thread accord openmp default databas support cammiq ye similar mani product cammiq support select complet genom latest version ncbi refseq databas easili download python script cammiqdownload command line option cammiqdownload includ dir database_path directori maintain download genom default path current directori taxa bacteriaviralarchaeaal select collect complet genom refseq download current four option support cammiq user choos download list determin sampl option complet bacteri viral archaeal genom three categori latest version refseq databas sampl nonetaxidspeci option none keep genom taxid keep one repres genom taxonom id speci keep one repres genom speci level taxonom id taxonom id base latest assembl summari file maintain refseq note taxid speci specifi genom mark repres genom refer genom assembl summari file prioriti kept genom found speci level taxid random genom taxid kept unzip option decompress gz file refseq fna file quiet disabl output produc wget trace download progress queri collect metagenom read similarli youll need run cammiq queri option paramet command line option includ read_cnt option read_cnt specifi cammiq produc standard output see option instead cammiq output nonneg tabdelimit matrix row correspond queri fastq file column correspond ncbi taxonom id attent genom id entri give number read given queri cammiq assign uniqu correspond taxon read_cnt queri correspond simplest type queri paper exampl output cammiq find read_cnt command line query_fq query_fq query_fq note output file name specifi paramet doubly_uniqu option valid read_cnt specifi cammiq resolv ambigu read count brought doublyuniqu substr assign read contain doublyuniqu substr two distinct taxa one specif taxon doubly_uniqu queri correspond type ii queri paper paramet includ follow list possibl mandatori paramet f map_fil mandatori use map_fil build index queri attent cammiq charg verifi format correct mean use exactli file build index queri map_fil input map_fil queri differ use build index potenti undefin behavior could happen run cammiq q q query_fil mandatori query_fil either list fastq file directori contain list fastq file queri capit q indic input directori q cammiq take list fastq file q cammiq take directori contain list fastq file index_fil option per cammiq build option default index file name specifi index_ubin index_dbin index file store differ loaction directori use specifi directori file name discuss cammiq index compos ofwhatiscammiqindexcomposedof index_fil includ bin bin plu addit metainform default locat cammiq find metainform genome_lengthsout unique_lmer_count_uout unique_lmer_count_dout file provid index_fil one except read_cnt specifi case cammiq automat ignor metainform file output_fil option strongli recommend cammiq standard output file output_fil specifi file name default output file name quantification_resultsout output_fil present normal abund result queri fastq file line except header line left right contain tabdelimit field ncbi taxonom id abund organ name two queri fastq separ blank line exampl format output_fil samplefastq taxid abund name mycolicibacterium neoaurum vkm acd mycoplasma leachii pg hydrogenobaculum sp hydrogenobaculum sp sho hydrogenobaculum sp sn candidatu saccharibacteria oral taxon tmx attent unlik commonli tool simpli repres read count genom aubndanc cammiq repres sequenc depth genom abund consid follow exampl read genom speci read genom speci b twice larger genom length b cammiq output abund abund b e float option strongli recommend estim averag sequenc error substitut rate default valu e ie sequenc error typic illumina read tri someth like e e cours accur estim error rate queri accur quantif result ie aubndanc input genom cammiq produc h intint int option need special attent describ build option h take one two integ valu dont need speicifi h queri option sinc encod corredpond index bin bin file someth found match valu encod index file cammiq rais error int option number thread use cammiq queri describ build option note cammiq queri two phase first phase assign read one two genom default number thread howev second phase cammiq use ibm ilog cplex optim studio produc metagenom quantif result read count result read_cnt specifi default autothread ie attempt use avail cpu comput linux mahcin cpu default thread use addit also modifi follow list paramet enable_ilp_display allow ilp solver ibm ilog cplex optim studio gurobi optim print debug inform read_length_filt int cammiq discard read shorter specifi valu query_fil default cammiq keep read queri howev user need pay attent possibl exist read shorter hash length specifi h built cammiq indic case cammiq could rais error read_cnt_thr int firm threshold claim exist certain genom contain suffici number uniqu substr uniqu lmer specifi easy_to_identify_thr cammiq appli integ valu specifi float point valu specifi ilp_alpha see genom less number read assign output cammiq ie genom pass easy_to_identify_thr cammiq appli valu given ilp_alpha filter nonexist genom default valu read_cnt_thr easy_to_identify_thr int genom contain uniqu lmer valu specifi consid easi identifi firm read_cnt_thr filter appli see default valu ilp_epsilon float default valu cammiq give feasibl solut quantif result user attempt increas valu gener least one relax feasibl solut ilp_alpha float import cammiq rel read count filter intuit consid resolut cammiq genom less ilp_alpha number uniquedoublyuniqu l mer read assign filter quantif process default valu ilp_alpha see cammiq paper httpswwwbiorxivorgcontentv detail max_depth float maximum allow coverag per genom default valu unique_read_cnt_thr int special paramet read_cnt doublyuniqu queri mainli design singl cell queri case genom suffici number read assign ie pass threshold must includ cammiq identif output doubly_unique_read_cnt_thr int special paramet read_cnt doublyuniqu queri also design singl cell queri genom less unique_read_cnt_thr uniqu read less doubly_unique_read_cnt_thr doublyuniqu read read ambigu assign correspond genom must excludedfilt cammiq identif output exampl usag cammiq queri read_cnt h f genome_mapout index_ubin index_dbin q datafastq read_length_filt cammiq_identificationtxt cammiq queri read_cnt doubly_uniqu h f genome_mapout index_ubin index_dbin q datafastq cammiq_identificationtxt unique_read_cnt_thr doubly_unique_read_cnt_thr first instruct queri index_ubin index_dbin read fastq file directori datafastq fastq form distinct queri read length less discard number read uniqu assign genom genome_mapout must correspond index file written cammiq_identificationtxt futur usag second instruct queri set read time cammiq consid read ambigu assign two genom resolv ambigu ilp solver ibm ilog cplex optim studio gurobi optim paramet unique_read_cnt_thr set doubly_unique_read_cnt_thr set maximum allow number thread ilp solver set cammiq queri f genome_mapout index_u_testbin index_d_testbin q queryfastq queryfastq cammiq_quantificationout cammiq queri h f genome_mapout index_ubin index_dbin q datafastq gurobi_solutionsout ilp_alpha cammiq queri h f genome_mapout index_ubin index_dbin q datatest_fastq cplex_solutionsout enable_ilp_display ilp_alpha read_cnt_thr ilp_epsilon third instruct queri index_u_testbin index_d_testbin store parent level directori metainform also store read two given fastq file queryfastq queryfastq fastq form distinct queri correspond genom cours within list genome_mapout rel bundanc written cammiq_quantificationout thread queri index use ilp quantifi abund fourth instruct queri index_ubin index_dbin read fastq file directori datafastq fastq form distinct queri correspond genom within list genome_mapout rel bundanc written gurobi_solutionsout thread queri index use ilp quantifi abund paramet ilp_alpha set correspond part result shown paper note h set hash length case hash length store indic match cammiq report error fifth instruct queri index_ubin index_dbin set fastq fastq form distinct queri correspond genom within list genome_mapout rel bundanc written cplex_solutionsout cplex ilp solver debug inform enabl screen print output multipl paramet tune attent need paid specifi hash length queri singl cell rnaseq read sinc rnaseq read usual follow roughli uniform distribut across entir genom user suggest appli read_cnt andor doubly_uniqu queri command line option output number read identifi though cammiq indic assign genom index databas multipl paramet includ eg read_length_filt doubly_unique_read_cnt_thr tune control cammiq output expect comput cost cammiq sinc index construct queri cammiq run reason amount time usual hour multipl thread index construct minut queri million read addit cammiq may requir minut load indic main memori queri first fastq file main bottleneck come main memori usag quick estim memori need index construct suppos total size input genom n cammiq need reserv n byte plu memori maintain index structur ram total index construct step plu certain amount disk space queri suppos total index size binbinaux binbinaux file idx_siz total size queri file qry_siz cammiq need roughli idx_siz qry_siz byte ram total queri step plu memori requir ilp solver