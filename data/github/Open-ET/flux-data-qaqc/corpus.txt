titl fluxdataqaqc python packag energi balanc closur postprocess eddi flux data tag python eddycovari energi balanc closur postprocess flux tower data author name john volkcorrespond author orcid affili name justin huntington affili name richard allen affili name forrest melton affili name martha anderson affili name ays kilic affili affili name desert research institu index name univers idaho index name nasa ame research center index name california state univers monterey bay index name usda agricultur research servic index name univers nebraska lincoln index date april bibliographi paperbib introduct eddi covari ec system provid continu direct measur turbul radi heat energi flux atmospher land surfac baldocchi evapotranspir et estim ec system highli valuabl mani scientif disciplin water polici decis oper applic irrig manag although ec techniqu consid accur certain atmospher spatial condit inher theoret practic limit techniqu magnifi data uncertainti postprocess method error result welldocu energi balanc closur problem result inher limit techniqu also data process error instrument error sourc foken stoy sever approach postprocess correct ecbas et estim exist notabl implement major flux measur network dataset like fluxnet pastorello howev postprocess routin often differ individu site team data network end user case postprocess decis difficult reproduc statement need fluxdataqaqc opensourc objectori python packag intend wide audienc includ anyon need process ec flux data estim daili monthli et correct energi balanc closur also use wish perform visual flagbas qualiti control qualiti assur qaqc check ec flux meteorolog data filter replac suspect data point appli data given use exampl atmospher hydrolog model field scientist may find softwar use simplifi postprocess minut ec flux data daili et gapfil correct energi imbal use differ approach softwar also make calcul refer et ec meteorolog data download refer et grid product abatzogl output daili monthli et estim fluxdataqaqc use scientist model valid appli scienc know postprocess step use gener test well document postprocess step ec data commonli involv least follow step data format unit convers gapfil time aggreg et atmospher calcul energi imbal assess correct data qaqc automat visual fluxdataqaqc provid framework common ec postprocess step use python object also allow scientist engin document share process decis analys other via python script write critic seriou studi although tool provid fluxdataqaqc well document highlevel minim profici python requir interact time seri scatter plot eg tool hover pan zoom select link axe produc fluxdataqaqa use data qaqc anyon interest understand visual document atmospher andor hydrolog condit ec tower within plot document daili monthli surfac energi balanc variabl averag flux well commonli measur meteorolog variabl eg wind speed temperatur precipit vapor pressur deficit soil moistur display addit plot display comput result use ec data qaqc mani etori analys result includ energi balanc closur daili monthli energi balanc ratio initi despik smooth et fraction grid refer et well daili et gap inform ultim obtain final et estim ec data involv multipl humandriven process decis present uncertainti issu compar data process differ fluxdataqaqc address issu regard deploy configur ec system initi process high frequenc ec data sever softwar exist instead softwar provid framework proven ec data postprocess eg gapfil tempor aggreg energi balanc closur analys et estim wilson onlin documentationhttpsfluxdataqaqcreadthedocsioenlatestindexhtml fluxdataqaqc provid detail regard applic includ comprehens tutori usag exampl also includ easytofollow instal instruct via python packag index virtual environ automat third parti softwar depend manag design featur fluxdataqaqc packag follow simpl hierarch structur lowlevel class inherit linear fashion two class specif ec postprocess autoreffigfig softwar also modular facilit incorpor addit class method ad new scientif routin packag also facilit standard intuit intern name scheme data format share core class attribut diagram show relationship softwar compon green highlight box indic softwar wherea nonhighlight indic input output file softwarelabelfigfigfigurepdf input fluxdataqaqc tabular timeseri ecmeterolog data site metadata pars use configur file written user use tool provid packag full exampl fileshttpsfluxdataqaqcreadthedocsioenlatestadvanced_config_optionshtmlexampledatadescript provid data class pars data tool unit convers qualitybas filter visual atmospher calcul dew point temperatur potenti solar radiat qaqc class use gapfil daili monthli aggreg energi balanc closur correct write data use standard format creat interact diagnost plot data qaqc class leverag panda python librari give user access pre postprocess data panda datafram facilit myriad pythonbas scientif analys via numpi scipi mani packag plot class contain routin creat standard diagnost plot pre postprocess data also provid robust api gener interact via bokeh packagehttpsdocsbokehorgenlatestindexhtml scatter time seri plot arbitrari time seri data plot convert class along util modul use inherit throughout packag lowlevel tool modular enough easili use softwar custom data pipelin capabl tool provid fluxdataqaqc abil read varieti tabular data format use configur file tool batch process via write configur file programmat automat unit convers filter poor qualiti data flagbas numer gapfil hourli higher frequenc ec data day night time treat separ tempor aggreg high frequenc data daili monthli interact visual inspect tool preprocess data frequenc daili monthli postprocess data ec meteorolog data manag archiv pre postprocess data metadata includ standard name multipl energi balanc closur correct routin energi balanc ratio method bowen ratio method multipl linear regress method atmospher calcul includ hourli daili form american societi civil engin standard refer et equat allen use refethttpsgithubcomwswuprefet python packag abil download grid weather data refer et correspond ec tower abatzogl daili gapfil et use grid refer et sitebas fraction refer et state field fluxdataqaqc similar oneflux pipelin pastorello includ energi balanc closurebas correct slight modif howev mani differ improv process micrometeorolog measur calcul daili water energi flux one oneflux command line applic oppos objectori framework oneflux mani use outsid scope fluxdataqaqc focus water vapor flux similarli sever tool fluxdataqaqc includ oneflux exampl read data differ format via configur file multipl hourli gapfil method daili gapfil method use grid refer et visual tool atmospher calcul standard refer et monthli aggreg abil user select multipl altern energi balanc closur correct routin ec data process qaqc softwar classifi one group process high frequenc ec data flux partit eg partit water vapor flux transpir direct evapor compon friction veloc u filter co postprocess gapfil filter flux footprint gener fluxdataqaqc dedic task group method scope uniqu opensourc postprocess softwar known author besid oneflux list known similar ec postprocess softwar purpos major differ mdi meteo gapfil toolhttpwwwbgcjenampgdemdiworkmeteo onlin applic perform gapfil use differ methodolog gafirhttpswwwbayceerunibayreuthdemmdesoftwaresoftwaresoftware_dlphpid_obj r packag perform gapfil use differ methodolog reddyprochttpswwwbgcjenampgdebgiindexphpservicesreddyprocweb wutzler r packag perform u filter gapfil flux partit differ includ co focus closur correct differ gapfil method halfhourlyhourli daili gapfil monthli aggreg plot strict input format miss ancillari atmospher calcul openeddyhttpsgithubcomlsigutopeneddi r packag perform data handl summar plot differ includ closur correct differ qaqc procedur gapfil strict input format miss ancillari atmospher calcul pyfluxprohttpsgithubcomozfluxpyfluxpro python gui applic perform standard postprocess qaqc routin gapfil u filter flux partit plot differ includ differ gapfil method closur correct daili gapfil miss ancillari atmospher calcul hessefluxhttpsgithubcommcuntzhesseflux cuntz python packag similar reddyproc similar differ name lack energi balanc closur correct research enabl fluxdataqaqc packag design use gener benchmark et dataset ground valid intercomparison remot sens et model part openet melton openet larg collabor effort provid satellitebas et estim field scale across western unit state greatli improv water manag practic among use packag also use process et grapex vineyard ec site evalu spectralbas et approach kusta acknowledg grate acknowledg support work walton famili foundat lyda hill philanthropi sd bechtel jr foundat gordon betti moor foundat windward fund water funder initi nasa appli scienc program nasa western water applic offic usg landsat scienc team california state univers agricultur research institut idaho agricultur experi station nebraska agricultur experi station refer chang log version add autom test use githb action see httpsgithubcomopenetfluxdataqaqcactionsworkflowsfluxdataqaqc_testsyml__ ad descript run test local doc remov xlrd reader depend due outdat read abil panda excel reader minor bug fix relat plot class ass joss paper publish softwar zenodo version add configur write function funcutilwrite_config util modul facilit batch process os similar format input file via station metadata file data dictionari updat check energi balanc ratio closur correct also check invers energi balanc ratio greater word mathfracebr avoid closur correct factor small check occur step energi balanc closur correct routin version relax default allow miss day threshold day day monthli resampl algorithm word month miss daili valu monthli aggreg resampl replac null valu threshold keyword argument utilmonthly_resampl function default use automat resampl variabl remind number miss day per month tabul variabl use fine tune filter chang implement version post add daili asc standard refer et calcul option methqaqcdaily_asce_refet method also ad automat estim daili maximum minimum air temperatur input eg hourli data ad input variabl list variabl linearli interpol take daili aggreg objqaqc constructor word input daili asc refer et formul ea tmin tmax rs wind speed interpol daytim nighttim hourli gap default take daili mean min max subsequ use daili asc calcul chang default keyword argument refer short methdatahourly_asce_refet method add automat calcul high frequenc eg hourli half hourli data includ dew temperatur rel humid ea es avail calcul occur first load input data ie objdatadf attribut access satur vapor pressur es calcul hourlydaili frequenc save ad objdatadf objqaqcdf properti requir panda chang backward compat due intern panda argument deprec particularli pandasgroup object requir bokeh chang backward compat due legend keyword argument name chang bokeh minor chang remov packag deprec warn panda bokeh relat respect larg chang add packag depend openpyxl packag fallback read header excel file xlrd unmaintain fail previous work tool read metadata excel file add requirementstxt file packag version add option use gridmet grass refer et eto etof gap fill daili et default behavior still use alfalfa refer et use eto assign refeteto keyword argument methqaqccorrect_data directli methqaqc_et_gap_fil et et refer fraction plot label updat show correct refer et variabl use improv scale scatter plot give equal x axi length chang return methplotscatter_plot return tupl xmin xmax ymin ymax use plot one one line limit axe length version chang default function methqaqcwrit method use intern variabl name oppos input name fluxdataqaqc header file output daili monthli time seri csv file exampl column net radiat alway name save rn revers previou behavior use user input name set new use_input_nam keyword argument methqaqcwrit true chang methplotscatter_plot underli call bokeh modul scatter plot oppos set circl glyph plot allow user chang symbol circl other pass valid valu scatter_plot marker keyword argument eg markercross version add least squar linear regress method singl multivari input specif qaqclin_regress method use correct energi balanc compon arbitrari time seri data load qaqc instanc produc return readabl tabl regress result fit coeffici rootmeansquareerror etc access qaqclin_regress_result call method default regress use correct energi balanc compon assum net radiat accur depend variabl mathrn c_ c_ g c_ le c_ h mathc_ regress util scikitlearn python modul therefor ad environ setup file depend version add hourli asc standard refer et calcul data class methdatahourly_asce_refet option short tall grass alfalfa refer et calcul input data hourli higher frequenc input data refer et calcul automat resampl hourli data input data hourli result refer et time seri merg attrdatadf attribut otherwis input data tempor frequenc hourli refer et time seri return methdatahourly_asce_refet method add method option linearli interpol energi balanc variabl base length gap daytim mathrn night mathrn method run automat qaqc constructor tempor frequenc input detect less daili new keyword argument qaqc max_interp_hour max_interp_hours_night respect notabl chang first releas github creation filepag chang log add option return option plot method data qaqc object custim default plot showus subset version major improv notab chang includ add packag pypi chang allow gap percentag monthli time seri add read wind direct data bsd licens add packag data fix bug relat filter subday gap improv plot error handl add featur hide line line plot version major improv notab chang includ first document readthedoc httpsfluxdataqaqcreadthedocsioenlatest__ add multipl page doc instal config option basic tutori full api refer etc improv streamlin config file option add vapor pressur vapor pressur deficit calcul hourli lower frequenc data datadf properti upon initi load time seri memori add automat unit convers check select input variabl use convert class util modul add new plot default plot qaqc class eg filter raw etrf mani round improv plot eg hover tooltip link axe style option column etc modifi energi balanc ratio filter extrem valu filter energi balanc ratio correct factor improv tempor resampl option drop day certain fraction subdaili gap track number gap day monthli time seri correct et add exampl et gapfil doc chang exampl data use twitchel island alfalfa site data ameriflux add plot input data use plot method data instanc allow view input data initi tempor frequenc version first work version mani chang mileston includ basic templat work version data qaqc plot class version improv daili monthli resampl bowen energi balanc ratio correct routin exampl jupyt notebook includ fluxnet usg data calcul potenti clear sky radiat chang variabl name system use intern user name abil read multipl soil heat flux soil moistur measur calcul weight averag make packag instal conda environ add input data filter use qualiti control flag numer threshold flag read input variabl unit ad util submodul method resammpl time seri abil take nonweight averag accept input variabl add config file option like date pars remov filter smooth option bowen ratio method modif add method download gridmet variabl base locat conu add routin gap fill et base gridmet etrf smooth filter improv plot class contain modular plot method line scatter use arbitrari data chang intern variabl name eg etr etr method estim et le consid latent heat vapor affect air temp updat improv code structur optim calcul imag httpsreadthedocsorgprojectsfluxdataqaqcbadgeversionlatest target httpsfluxdataqaqcreadthedocsioenlatestbadgelatest alt document statu imag httpsgithubcomopenetfluxdataqaqcactionsworkflowsfluxdataqaqc_testsymlbadgesvg target httpsgithubcomopenetfluxdataqaqcactionsworkflowsfluxdataqaqc_testsyml alt autom test fluxdataqaqc fluxdataqaqc provid framework creat reproduc workflow valid analysi eddi covari data packag intend need postprocess flux data particularli gener daili monthli evapotranspir et timeseri estim energi balanc closur correct appli applic softwar may use includ analysi eddi covari data hydrolog atmospher model valid irrig water consumpt studi key function tool includ data valid method qualitybas filter time seri tool eg gapfil tempor aggreg energi balanc closur algorithm meterolog calcul data proven eg metadata manag file structur download manag gridmet httpwwwclimatologylaborggridmethtml__ meterolog data customiz interact visual builtin unit convers batch process tool document readthedoc httpsfluxdataqaqcreadthedocsio_ instal use pip codeblock bash pip instal fluxdataqaqc pip instal necessari depend howev recommend use conda first instal provid virtual environ use avoid chang local python environ note fluxdataqaqc test python although may work version greater equal first make sure fluxdataqaqc environ file download httpsrawgithubusercontentcomopenetfluxdataqaqcmasterenvironmentymltokenabbjkuklelemwplylxfcwqog_ next instal run codeblock bash conda env creat f environmentyml activ environ use fluxdataqaqc packag run codeblock bash conda activ fluxdataqaqc instal use pip codeblock bash pip instal fluxdataqaqc packag modul tool avail python environ path abl import note instal conda virtual environ pip instal depend automat sure use version python equal test everyth instal correctli open python interpretor ide run follow codeblock python import fluxdataqaqc codeblock python fluxdataqaqc import data qaqc plot everyth instal correctli get error autom test pytest httpsdocspytestorgenxcontentshtml__ softwar test automat run time chang fluxdataqaqc made master branch github use github action workflow httpsgithubcomopenetfluxdataqaqcactionsworkflowsfluxdataqaqc_testsyml__ autom test help spot potenti bug earli identifi correct effici result improv user experi run test manual pytest requir run softwar test provid instal pytest pip codeblock bash pip instal pytest test util exampl flux input data fluxdataqaqc configur file provid softwar whether instal pypi github file found httpsgithubcomopenetfluxdataqaqctreemasterexamples__ run test navivg root directori sourc code command line shell run pytest codeblock bash pytest print basic test result usag pytest plugin command line option use get inform test contributor openet team guidanc feedback given openet httpsetdataorg__ team member dr ays kilic christian dunkerli forrest melton dr gabriel senay dr joshua fisher dr john volk dr justin huntington dr martha anderson dr richard g allen acknowledg energi balanc ratio correct method modifi fluxnet httpsfluxnetfluxdataorg__ methodolog correct daili latent energi sensibl heat addit fluxnet ameriflux httpsamerifluxlblgov__ eddi covari data use code develop thank mantain provid eddi flux data would also like acknowledg refet httpsgithubcomwswuprefet__ python packag develop charl morton refet method use fluxdataqaqc calcul american soceiti civil engin standard refer et use hourli daili formul well calcul potenti solar radiat contribut fluxdataqaqc opensourc python packag anyon serious interest contribut encourag look current issu get start offer direct chang pull request report issu problem softwar pleas open github issu technic problem softwar issu page httpsgithubcomopenetfluxdataqaqcissues__ seek support give feedback suggest feedback nontechn relat softwar develop usag pleas open github issu httpsgithubcomopenetfluxdataqaqcissues__ feedback sent johnvolkdriedu two major function fluxdataqaqc first correct surfac energi balanc adjust latent energi sensibl heat flux calcul climat variabl second serv robust way read differ time seri data produc visual eg daili monthli time seri configur option caveat tutori show use fluxdataqaqc climat data variou format gener cover format rule input data extra option set config file major differ use fluxdataqaqc differ input data lie config file declar therefor entir workflow reftutori work config file set correctli exampl data descript data use refconfigur option caveat provid fluxdataqaqc download httpsgithubcomopenetfluxdataqaqcblobmasterexamplesconfig_options__ two dataset use follow exampl data use show qualiti base filter data base qc flag fluxnet dataset site arm usda unl osu woodward switchgrass contain switchgrass inform site found httpsitesfluxdataorgusar__ site contain multipl soil heat flux measur weight averag soil moistur measur plot subset shorten reduc disk space arm southern great plain site lamont ameriflux site dataset inform site found httpamerifluxlblgovsitessiteinfousarm__ reproduc jupyt notebook minor differ tutori found httpsgithubcomopenetfluxdataqaqcblobmasterexamplesconfig_optionsadvanced_config_optionsipynb__ set config file fluxdataqaqc start creation configur file text file extens ini ini follow rule set httpsdocspythonorglibraryconfigparserhtmlsupportedinifilestructure__ config file fluxdataqaqc requir section metadata data although may provid addit custom use metadata may enter metadata wish long entri key follow equal sign assign valu ie parsedliter key valu mandatori metadata entri uniqu fluxdataqaqc climate_file_path station_elev station_longitud station_latitud site_id climate_file_path full rel file path input climat file excel csv format contain climat data analyz station_elev meter latitudelongitud decim degre field use calcul clear sky potenti solar radiat use asc formul locat nearest gridmet cell centroid download refer et site_id use save output file option metadata entri use fluxdataqaqc includ missing_data_valu qc_threshold qc_flag var_name_delim skiprow date_pars gridmet_file_path missing_data_valu use correctli pars miss valu input climat time seri option metadata use fluxdataqaqc except gridmet_file_path simpli path file download methqaqcdownload_gridmet explain within page data section config file specifi climat variabl unit follow approach explain list expect climat variabl name data section config file key key config file valu intern name use fluxdataqaqc list access time attrdatavariable_names_dict fluxdataqaqc import data datavariable_names_dict datestring_col date net_radiation_col rn ground_flux_col g latent_heat_flux_col le latent_heat_flux_corrected_col le_user_corr sensible_heat_flux_col h sensible_heat_flux_corrected_col h_user_corr shortwave_in_col sw_in shortwave_out_col sw_out shortwave_pot_col sw_pot longwave_in_col lw_in longwave_out_col lw_out vap_press_col vp vap_press_def_col vpd avg_temp_col t_avg precip_col ppt wind_spd_col ws may view climat entri key valu found config file within python use attrdataconfig properti contain inform list config file objconfigparserconfigpars instanc config_path config_for_qc_flag_filteringini dataconfig_path loop list tupl key valu data section dconfigitemsdata printeach datestring_col date net_radiation_col rn net_radiation_unit wm ground_flux_col g ground_flux_unit wm latent_heat_flux_col le latent_heat_flux_qc a_qc_valu latent_heat_flux_unit wm latent_heat_flux_corrected_col le_correct latent_heat_flux_corrected_unit wm sensible_heat_flux_col h sensible_heat_flux_qc a_qc_valu sensible_heat_flux_unit wm sensible_heat_flux_corrected_col h_correct sensible_heat_flux_corrected_unit wm shortwave_in_col sw_in shortwave_in_qc swrad_flag shortwave_in_unit wm shortwave_out_col sw_out shortwave_out_unit wm shortwave_pot_col sw_pot shortwave_pot_unit wm longwave_in_col lw_in longwave_in_unit wm longwave_out_col lw_out longwave_out_unit wm vap_press_col na vap_press_unit na vap_press_def_col vpd vap_press_def_unit hpa avg_temp_col t_avg avg_temp_unit c precip_col ppt precip_unit mm wind_spd_col ws wind_spd_unit ms also access data attrdataconfig dictionari exampl metadata section entri land_cov eg parsedliter metadata land_cov crop access valu methconfigparserconfigparserget return valu land_cov config file metadata section dconfiggetmetadata land_cov crop tip unsur config file metadata contain specif entri pass fallback keywordonli argument methconfigparserconfigparserget method similar python dictionari exampl dconfiggetmetadata land_cov fallbacknot given given input format caveat miss data pars data gap input time seri assign missing_data_valu metadata section config file valu numer eg parsedliter missing_data_valu input time seri file contain climat variabl expec fluxdataqaqc specifi miss na config file simpli list config miss variabl ignor part present output filesplot howev key variabl energi balanc present mathl mathh mathg mathrn abl run energi balanc closur correct routin data file format fluxdataqaqc accept microsoft excel file xlx xlsx comma separ valu csv text file contain time seri input input file column combin date time current restrict tempor frequenc input data howev automat resampl daili frequenc run correct routin lastli singl header row contain variabl name follow first entri climat variabl exampl valid input file first row column date t_avg sw_pot sw_in lw_in vpd ppt ws note input data tempor frequenc recogn fluxdataqaqc attempt resampl daili frequenc use creat objqaqc object also valu recogn numer data column forc null valu data header format common format time seri data header row may start first line file case must add entri metadata section config file skiprow state number row skip find header row caveat use csv data file may number comment line header long start hashtag symbol comment case add skiprow metadata optim data load time fluxdataqaqc util modpanda time seri data manag specif usag objdatetimedatetim object advanc tempor analysi tool file larg specifi datetim format metadata section config file potenti greatli speedup load data exampl date column contain string format year month day hour minut delimit eg januari st midnight fluxdataqaqc config file would enter parsedliter date_pars ymdhm inform correct date parser string date format see direct methdatetimedatetimestrptim httpsdocspythonorglibrarydatetimehtmlstrftimeandstrptimebehavior__ qualitybas data filter current fluxdataqaqc support filter poor qualiti data base userprovid qualiti control qc valu numer flag charact use methdataapply_qc_flag method featur help facilit manual semimanu data filter sometim necessari data preprocess flagbas filter let say column input data name qc_flag contain charact string signifi assign data qualiti climat time seri flag either g mean data point good flag b data point bad qualiti would like filter let say want filter appli latent energi sensibl heat variabl config file would need declar flag bad data b filter metadata section code bash qc_flag b data section config state qc_flag column appli mathl mathh variabl code bash latent_heat_flux_qc qc_flag sensible_heat_flux_qc qc_flag methdataapply_qc_flag method use date entri mathl mathh qc_flag valu b forc null attrdatadf properti objdata instanc thresholdbas filter anoth option use numer qualiti control valu exist input data along threshold valu mean qualiti control valu fall threshold would like exclud analysi let assum column contain qualiti control valu name qc_valu contain valu mean poorest qualiti data highest would like remov data select variabl qualiti control valu let assum would like appli incom solar radiat variabl would declar threshold metadata section config file code bash qc_threshold data section config state qc_valu column appli incom shortwav radiat variabl code bash shortwave_in_qc qc_valu set use function note may appli qualiti control valu flag column multipl climat variabl shown first exampl may also use numer qualtiy control valu charact string flag input dataset although appli variabl wordsf column qualiti control numer valu also charact string mix anoth option use exampl declar multipl qualiti control flag filter use comma separ list exampl provid exampl config flag x b use remov select day incom shorwav radiat code bash qc_flag x b anoth option specifi variabl qualiti control valuesflag name column contain qualtiy control valueflag input climat file variabl correspond suffix _qc exampl sensibl heat column name sens_h qualtiy control column name sens_h_qc use option need specifi name config file exampl flag threshold exampl use provid time seri config file qc flag filter github httpsgithubcomopenetfluxdataqaqctreemasterexamplesconfig_options__ data fluxnet site arm usda unl osu woodward switchgrass locat exhibit switchgrass field inform site found httpamerifluxlblgovsitessiteinfousar__ dataset origin contain charact qaqc flag ad demonstr appli shortwav radiat view list string flag specifi config file config_path config_for_qc_flag_filteringini dataconfig_path view reassign numer threshold specifi config file dqc_threshold view charact qc flag assign config dqc_flag x b attrdataqc_var_pair attribut show variabl found input file qualiti control valu assign use name found input file dqc_var_pair le a_qc_valu h a_qc_valu sw_in swrad_flag tip attrdataqc_var_pair dictionari updat python assign differ column qc valu differ time seri variabl let appli qc valu note exampl mix numer valu threshold charact flag numer valu appli mathl mathh wherea flag x b appli incom shortwav radiat make copi qc filter appli no_qc ddfinput_lecopi no_qc_swrad ddfinput_sw_incopi appli qc flagsvalu dapply_qc_flag qc_def ddfinput_lecopi qc_flag_swrad ddfinput_sw_incopi warn renam column rn input_rn warn renam column g input_g warn renam column le input_l warn renam column h input_h warn renam column sw_in input_sw_in warn renam column sw_out input_sw_out warn renam column sw_pot input_sw_pot warn renam column lw_in input_lw_in warn renam column lw_out input_lw_out warn renam column vpd input_vpd warn renam column t_avg input_t_avg warn renam column ppt input_ppt warn renam column ws input_w note good time point fluxdataqaqc may chang name input variabl exactli match intern name use softwar see attrdatavariable_names_dict case warn messag print read data access df monthly_df properti objdata objqaqc first time name modifi prefix _input shown plot show data appli filter bokehplot import columndatasourc figur show bokehmodelsformatt import datetimetickformatt p figurex_axis_labeld y_axis_labelswrad data remov base qc valu plineno_qc_swradindex no_qc_swrad color legendno flag line_width plineno_qc_swradindex qc_flag_swrad colorblack legendflag b x line_width pxaxisformatt datetimetickformatterdaysdbi showp raw html file _staticqc_flaghtml mathl p figurex_axis_labeld y_axis_label data remov base qc valu plineno_qcindex no_qc color legendno qc line_width plineno_qcindex qc_def colorblack legendqc line_width pxaxisformatt datetimetickformatterdaysdbi showp raw html file _staticqc_flaghtml altern name method qc data case climat variabl qc column name base name climat variabl _qc suffix exampl mathl name le_f_md input file header qc column name le_f_mds_qc time seri data qualtiy control header name follow convent automat detect use appli use methdataapply_qc_flag ie column name variabl assign need declar configini file import os config_path ospathjoinbasic_usagefluxnet_configini dataconfig_path view input file header note qc column dheader indextimestamp ta_f ta_f_qc sw_in_pot sw_in_f sw_in_f_qc lw_in_f lw_in_f_qc vpd_f vpd_f_qc pa_f pa_f_qc p_f p_f_qc ws_f ws_f_qc ustar ustar_qc netrad netrad_qc ppfd_in ppfd_in_qc ppfd_out ppfd_out_qc sw_out sw_out_qc lw_out lw_out_qc co_f_md co_f_mds_qc ts_f_mds_ ts_f_mds__qc swc_f_mds_ swc_f_mds__qc g_f_md g_f_mds_qc le_f_md le_f_mds_qc le_corr le_corr_ le_corr_ le_randunc h_f_md h_f_mds_qc h_corr h_corr_ h_corr_ h_randunc nee_vut_ref nee_vut_ref_qc nee_vut_ref_randunc nee_vut_ nee_vut_ nee_vut_ nee_vut__qc nee_vut__qc nee_vut__qc reco_nt_vut_ref reco_nt_vut_ reco_nt_vut_ reco_nt_vut_ gpp_nt_vut_ref gpp_nt_vut_ gpp_nt_vut_ gpp_nt_vut_ reco_dt_vut_ref reco_dt_vut_ reco_dt_vut_ reco_dt_vut_ gpp_dt_vut_ref gpp_dt_vut_ gpp_dt_vut_ gpp_dt_vut_ reco_sr reco_sr_n dtypeobject verifi qc column pair correspond climat variabl dqc_var_pair netrad netrad_qc g_f_md g_f_mds_qc le_f_md le_f_mds_qc h_f_md h_f_mds_qc sw_in_f sw_in_f_qc sw_out sw_out_qc lw_in_f lw_in_f_qc lw_out lw_out_qc vpd_f vpd_f_qc ta_f ta_f_qc p_f p_f_qc ws_f ws_f_qc note fluxnet file includ qualtiy control flag sensibl heat variabl qualiti threshold column name climat variabl correspond _qc suffix therefor need defin config file appli dataset defin exampl fluxnet_configini specifi qc threshold flag config file therefor must assign call methdataapply_qc_flag method shown refexampl threshold filter view qc threshold specifi config file printdqc_threshold typedqc_threshold none class nonetyp altern may assign threshold flag valu time directli objdata instanc dqc_threshold exampl threshold filter sure valid qc threshold flag appli make sure everyth seem correct see lowest qc valu correspond poor qualiti gapfil data near begin time seri sensibl heat mathh bokehmodel import linearaxi rang p figurex_axis_labeld y_axis_labelsens heat flux wm pextra_y_rang sec rangedstart end plineddfindex ddfh_f_md color line_width legenddata padd_layoutlinearaxisy_range_namesec axis_labelqc valu right pcircleddfindex ddfh_f_mds_qc line_width y_range_namesec legendqc px_rangerangedddfindex ddfindex pxaxisformatt datetimetickformatterdaysdbi plegendloc top_left showp warn insuffici data calcul mean multipl g measur warn insuffici data calcul mean multipl theta measur raw html file _staticqc_flaghtml remind routin provid numer theshold filter remov data entri assign qc column qc valu fall threshold appli qc numer threshold filter dapply_qc_flagsthreshold valu qc valu remov null variabl list attrdataqc_var_pair caution methdataapply_qc_flag method appli filter variabl climat file qc column column specifi config file see column variabl may affect previou filter constrain modifi declar config file within attrdataqc_var_pair ie dqc_var_pair netrad netrad_qc g_f_md g_f_mds_qc le_f_md le_f_mds_qc h_f_md h_f_mds_qc sw_in_f sw_in_f_qc sw_out sw_out_qc lw_in_f lw_in_f_qc lw_out lw_out_qc vpd_f vpd_f_qc ta_f ta_f_qc p_f p_f_qc ws_f ws_f_qc let view sesnibl heat flux time seri appli threshold filter notic strang oscil artifact near begin time seri remov p figurex_axis_labeld y_axis_labelsens heat flux wm pextra_y_rang sec rangedstart end plineddfindex ddfh_f_md color line_width legenddata padd_layoutlinearaxisy_range_namesec axis_labelqc valu right pcircleddfindex ddfh_f_mds_qc line_width y_range_namesec legendqc px_rangerangedddfindex ddfindex pxaxisformatt datetimetickformatterdaysdbi plegendloc top_left showp raw html file _staticqc_flaghtml seealso refstep manual clean poor qualiti data exampl show filter poor qualiti data load data objqaqc object averag data multipl sensor nonweight averag climat station analyz multipl sensor variabl eg sensibl heat flux easili tell fluxdataqaqc use nonweight averag fluxdataqaqc routin includ energi balanc closur correct interact visual simpli list variabl name found file header delimit choic list delimit metadata section exampl three sensibl heat variabl name h_ sens_h_ sensibl heat wm config file metadata would write parsedliter var_name_delim sensibl heat assign data section would read parsedliter sensible_heat_flux_col h_sens_h_sens heat wm caution comma last variabl name use comma name delimit also state delimit variabl name metadata section config file fluxdataqaqc look singl variabl name h_sens_h_sens heat wm header found fluxdataqaqc name averag case h_mean gener add suffix _mean intern name variabl use fluxdataqaqc found key attrdatavariable_names_dict dictionari hint use averag option energi balanc compon ie latent energi sensibl heat net radiat soil heat flux averag also use energi balanc closur correct weight averag fluxdataqaqc provid abil read multipl soil heat fluxmoistur variabl given station locat calcul weight non weight averag writeplot daili monthli time seri current weight averag provid soil heat flux soil moistur variabl use config option also way automat produc time seri plot variabl use methqaqcplot may use comparingvalid multipl soil heatmoistur probe vari locat depth vari instrument need use function list multipl soil variabl name config file data section follow convent multipl soil heat flux variabl config name begin g_ g_ follow integ start ie g_number exampl code bash g_ name_of_my_soil_heat_flux_vari soil moistur variabl name config variabl follow theta_numb exampl code bash theta_ name_of_my_soil_moisture_vari list unit variabl specifi unit soil fluxmoistur variabl add _unit config name assign code bash g__unit wm theta__unit cm set weight multipl variabl comput weight averag assign _weight suffix name config file exampl set weight multipl soil heat flux variabl code bash g__weight g__weight g__weight hint weight given arithmet mean calcul weight sum automat normal case nonweight averag energi balanc compon use option soil heat flux mathg weight averag also use energi balanc closur correct weight averag exampl exampl use time seri data record arm southern great plain site lamont ameriflux eddi covari tower inform site found httpamerifluxlblgovsitessiteinfousarm__ data section config file defin multipl mathg variabl input data file use exampl put much higher weight mathg sensor g___ g___ code bash data g_ g___ g__unit wm g__weight g_ g___ g__unit wm g__weight g_ g___ g__unit wm g__weight g_ g___ g__unit wm g__weight note name system variabl ameriflux convent indic multipl mathg sensor space differ horizont locat one anoth mani soil moistur sensor site use variabl within calcul simpli want load later plot assign weight therefor arithmet mean calcul ad output plot time seri file list data section config file multipl soil moistur record case code bash data theta_ swc___ theta__unit soil water content volumetr rang theta_ swc___ theta__unit soil water content volumetr rang theta_ swc___ theta__unit soil water content volumetr rang theta_ swc___ theta__unit soil water content volumetr rang theta_ swc___ theta__unit soil water content volumetr rang theta_ swc___ theta__unit soil water content volumetr rang theta_ swc___ theta__unit soil water content volumetr rang theta_ swc___ theta__unit soil water content volumetr rang theta_ swc___ theta__unit soil water content volumetr rang theta_ swc___ theta__unit soil water content volumetr rang theta_ swc___ theta__unit soil water content volumetr rang theta_ swc___ theta__unit soil water content volumetr rang theta_ swc___ theta__unit soil water content volumetr rang theta_ swc___ theta__unit soil water content volumetr rang theta_ swc___ theta__unit soil water content volumetr rang theta_ swc___ theta__unit soil water content volumetr rang hint unit soil moistur variabl use yaxi daili monthli time seri plot creat methqaqcplot config file setup let verifi everyth read correctli read data config_path config_for_multiple_soil_varsini dataconfig_path note newli ad multipl g theta variabl dvariabl date timestamp_start rn netrad___ le le___ h h___ sw_in sw_in___sw_in___ sw_out sw_out___ lw_in lw_in___ lw_out lw_out___ vpd vpd_pi___ t_avg t_sonic___ ws ws___ws___ g_ g___ g_ g___ g_ g___ g_ g___ theta_ swc___ theta_ swc___ theta_ swc___ theta_ swc___ theta_ swc___ theta_ swc___ theta_ swc___ theta_ swc___ theta_ swc___ theta_ swc___ theta_ swc___ theta_ swc___ theta_ swc___ theta_ swc___ theta_ swc___ theta_ swc___ note windspe shortwav incom radtiat column assign multipl variabl well use calcul nonweight mean describ refnonweight averag check unit assign dunit rn wm le wm h wm sw_in wm sw_out wm lw_in wm lw_out wm vpd hpa t_avg c ws ms g_ wm g_ wm g_ wm g_ wm theta_ soil water content volumetr rang theta_ soil water content volumetr rang theta_ soil water content volumetr rang theta_ soil water content volumetr rang theta_ soil water content volumetr rang theta_ soil water content volumetr rang theta_ soil water content volumetr rang theta_ soil water content volumetr rang theta_ soil water content volumetr rang theta_ soil water content volumetr rang theta_ soil water content volumetr rang theta_ soil water content volumetr rang theta_ soil water content volumetr rang theta_ soil water content volumetr rang theta_ soil water content volumetr rang theta_ soil water content volumetr rang view variabl weight written config file dsoil_var_weight_pair g_ name added_g_col weight g_ name another_g_var weight g_ name g weight g_ name final_g_var weight g_ name yet_another_g weight theta_ name soil_moisture_z weight theta_ name soil_moisture_z weight data first load memori weight nonweight averag calcul stage weight automat normal sum one new weight print occur load daili monthli datafram calcul weight averag exist ddfhead g weight given dont sum one normal new weight g___ g___ g___ g___ calcul mean var theta column swc___ swc___ swc___ swc___ swc___ swc___ swc___ swc___ swc___ swc___ swc___ swc___ swc___ swc___ swc___ swc___ calcul mean var sw_in column sw_in___ sw_in___ calcul mean var ws column ws___ ws___ exampl shortwav incom radiat windspe also averag nonweight multipl record describ refnonweight averag weight chang updat would expect mathg may ignor weight soil moistur case assign arithmet mean calcul weight use dsoil_var_weight_pair g_ name g___ weight g_ name g___ weight g_ name g___ weight g_ name g___ weight theta_ name swc___ weight theta_ name swc___ weight theta_ name swc___ weight theta_ name swc___ weight theta_ name swc___ weight theta_ name swc___ weight theta_ name swc___ weight theta_ name swc___ weight theta_ name swc___ weight theta_ name swc___ weight theta_ name swc___ weight theta_ name swc___ weight theta_ name swc___ weight theta_ name swc___ weight theta_ name swc___ weight theta_ name swc___ weight datafram also weight mean name g_mean theta_mean ddfcolumn indexinput_t_avg input_sw_pot input_sw_in input_lw_in input_vpd input_ppt input_w input_rn input_sw_out input_lw_out input_g input_l le_correct input_h h_correct added_g_col another_g_var final_g_var yet_another_g soil_moisture_z soil_moisture_z a_qc_valu swrad_flag g_mean theta_mean dtypeobject note even though specifi ground_flux_col config file weight averag valu use updat variabl therefor weight mean use energi balanc closur correct routin subsequ run check variabl use mathg later closur correct use dvariablesgetg g_mean let visual result weight averag multipl mathg measur individu daili time seri get g column plot argument g_col c c ddfcolumn cstartswithg_g_ g_col g___ g___ g___ g___ g_mean exampl creat time seri plot short span data easier visibl weight mean also use plot routin provid objdata objqaqc inheret objplot class within fluxdataqaqc specif exampl util methplotadd_lin make time seri plot multipl variabl effici automat handl hover tooltip fluxdataqaqcplot import columndatasourc hover tooltip shorter period visual df ddfloc g_col plt_var g_col color blue red orang green black x_name date sourc columndatasourcedf fig figurex_axis_labeld y_axis_labelsoil heat flux wm dataadd_linesfig df plt_var color x_name sourc labelsg_col showfig raw html file _staticweighted_ghtml note weight mean closer g___ g___ gave weight versu g___ g___ lastli code snippet run energi balanc ratio closur correct creat default plot order view daili monthli time seri multipl soil moistur variabl also show upload output plot file jupyt notebook view order correctli view output jupyt notebook bokehio import output_notebook output_notebook within set default plot creat methqaqcplot method includ interact daili monthli time seri multipl mathg soil moistur variabl assign input config file exampl scroll view fluxdataqaqc import qaqc q qaqcd qcorrect_data save plot file use output_typesav qplotoutput_typeshow raw html file _staticusarm_multipe_soilvars_plotshtml tutori tutori demonstr import featur fluxdataqaqc python packag manag analysi visual eddi covari time seri data recommend read refinstal refconfigur option caveat tutori one jupyt notebook tutori avail httpsgithubcomopenetfluxdataqaqcblobmasterexamplesbasic_usagetutorialipynb__ tip current softwar includ command line interfac therefor use softwar must use python eg make script use interact shell howev see common workflow accomplish line code simpli follow templat given make custom script descript exampl dataset data exampl come twitchel alfalfa ameriflux eddi covari flux tower site california site locat alfalfa field exhibit mild mediterranean climat dri hot summer inform site download data click httpsamerifluxlblgovsitessiteinfoustw__ load input load manag input climat data metadata configini file done use objfluxdataqaqcdata object nutshel objdata object creat properli format config file see refset config file tool pars input climat data averag input climat time seri accessingmanag metadata flagbas data filter creat interact visual input data one argument creat data object path configini file import code snippet within tutori import panda pd fluxdataqaqc import data qaqc plot bokehplot import figur show columndatasourc bokehmodelsformatt import datetimetickformatt bokehmodel import linearaxi rang creat data object configini file config_path ustw_configini dataconfig_path attribut data object use attribut objdata object may use full path configini file use creat objdata instanc access note return systemdepened objpathlibpath object eg linux machin path dconfig_fil posixpathhomejohnfluxdataqaqcexamplesbasic_usageustw_configini window machin path appropri backslash similarli access climat time seri file dclimate_fil posixpathhomejohnfluxdataqaqcexamplesbasic_usageamf_ustw_base_hh_csv attrdataconfig attribut objconfigparserconfigpars object allow access metadata data config file multipl way modifi fluxdataqaqc mainli use access inform input data get list entri metadata section configini dconfigitemsmetadata access data section way climate_file_path amf_ustw_base_hh_csv station_latitud station_longitud station_elev missing_data_valu skiprow date_pars ymdhm site_id ustw countri usa doi_contributor_nam denni baldocchi doi_contributor_rol author doi_contributor_email baldocchiberkeleyedu doi_contributor_institut univers california berkeley doi_organ california depart water resourc doi_organization_rol sponsor flux_measurements_method eddi covari flux_measurements_vari co flux_measurements_oper continu oper site_nam twitchel alfalfa igbp cro igbp_com alfalfa fast grow legumin crop rais anim feed low statur plant row typic reach cm height prior harvest land_ownership public network ameriflux reference_pap baldocchi penuela j physic ecolog mine carbon dioxid atmospher ecosystem global chang biolog reference_doi gcb reference_usag refer research_top research approach univers california berkeley biometeorolog laboratori involv coordin use experiment measur theoret model understand physic biolog chemic process control trace ga flux biospher atmospher quantifi tempor spatial variat research object mayberri wetland twitchel wetland sherman island twitchel island twitchel alfalfa twitchel corn site follow describ differ flux co ch ho energi differ land use understand mechan control flux use ecosystem model understand control mechan differ environment scenario six site select captur wide rang inund condit within sacramentosan joaquin river delta research focus eddi covari techniqu measur ch co ho energi flux work combin measur net flux partit flux order achiev mechanist understand ecolog control current futur carbon flux delta terrain flat aspect flat wind_direct w surface_homogen site_desc twitchel alfalfa site alfalfa field own state california leas third parti farm tower instal may site surround region part san joaquin sacramento river delta drain begin subsequ use agricultur field alfalfa x year crop rotat occur everi year site harvest mow bail sever time per year field fallow typic novemb februari site irrig periodicallyflood ditch surround field site irrig rais subsequ lower water tabl site_fund california depart water resourc team_member_nam joe verfailli team_member_rol technician team_member_email jverfailberkeleyedu team_member_institut univers california berkeley url_ameriflux httpamerifluxlblgovsitessiteinfoustw utc_offset mat map land_own california depart water resourc climate_koeppen csa doi amf doi_cit denni baldocchi ameriflux ustw twitchel alfalfa amf doi_dataproduct ameriflux team_member_address depart environment scienc polici manag mulford hall hilgard hallberkeley ca usa url httpnatureberkeleyedubiometlabsitesphptabustw dom_dist_mgmt agricultur site_snow_cover_day state ca location_date_start acknowledg biometeorolog lab univers california berkeley pi denni baldocchi use method methconfigparserconfigparserget take section config file option return valu dconfiggetsectionmetadata optionsite_nam twitchel alfalfa section option option keyword dconfiggetmetadata site_nam twitchel alfalfa tip unsur entri option exist config file use fallback keyword argument section option option keyword dconfiggetmetadata site name fallbackna na metadata entri ad objdata attribut easier access use multipl way later includ site_id math elev math latitud math longitud math na_val qc_threshold qc_flag math mandatori metadata entri config file see refset config file explan view column found header row input time seri climat file dheader arraytimestamp_start timestamp_end co ho ch fc fch fc_ssitc_test fch_ssitc_test g h le h_ssitc_test le_ssitc_test wd ws ustar zl tau mo_length v_sigma w_sigma tau_ssitc_test pa rh ta vpd_pi t_sonic t_sonic_sigma swc___ swc___ ts___ ts___ ts___ ts___ ts___ netrad ppfd_dif ppfd_in ppfd_out sw_in sw_out lw_in lw_out p fc_pi_f reco_pi_f gpp_pi_f h_pi_f le_pi_f dtypeu note header column necessarili load specifi config file also data header line load memori creat objdata object time seri data load call attrdatadf increas effici workflow involv metadata variabl name unit fluxdataqaqc two name scheme climat variabl name defin column header input time seri file intern name variabl calcul variabl creat packag refer two set userdefin intern name hereforth attrdatavari attribut map intern userdefin variabl name dvariabl date timestamp_start rn netrad g g le le_pi_f h h_pi_f sw_in sw_in sw_out sw_out lw_in lw_in lw_out lw_out vpd vpd_pi t_avg t_sonic ws ws theta_ swc___ theta_ swc___ attrdatainv_map map intern userdefin name differ howev creat data load call attrdatadf similar dictionari attribut input unit dunit rn wm g wm le wm h wm sw_in wm sw_out wm lw_in wm lw_out wm vpd hpa t_avg c ws ms theta_ soil water content volumetr rang theta_ soil water content volumetr rang access input data pyattrdatadf properti gve access time seri input climat data column specifi config file datetimeindex objpandasdatafram object object numer power built tool time seri analysi visual first datetim gap ddfdropnahead raw html div style scope datafram tbodi tr thonlyoftyp verticalalign middl datafram tbodi tr th verticalalign top datafram thead th textalign right style tabl border classdatafram thead tr styletextalign right thth thinput_gth thwsth thvpd_pith tht_sonicth thswc___th thswc___th thnetradth thsw_inth thsw_outth thlw_inth thlw_outth thh_pi_fth thle_pi_fth ththeta_meanth tr tr thdateth thth thth thth thth thth thth thth thth thth thth thth thth thth thth tr thead tbodi tr th th tdtd tdtd tdtd tdtd tdtd tdtd tdtd tdtd tdtd tdtd tdtd tdtd tdtd tdtd tr tr th th tdtd tdtd tdtd tdtd tdtd tdtd tdtd tdtd tdtd tdtd tdtd tdtd tdtd tdtd tr tr th th tdtd tdtd tdtd tdtd tdtd tdtd tdtd tdtd tdtd tdtd tdtd tdtd tdtd tdtd tr tr th th tdtd tdtd tdtd tdtd tdtd tdtd tdtd tdtd tdtd tdtd tdtd tdtd tdtd tdtd tr tr th th tdtd tdtd tdtd tdtd tdtd tdtd tdtd tdtd tdtd tdtd tdtd tdtd tdtd tdtd tr tbodi tabl div br tip mani tutori use objpandasdatafram power data analysi tool multipl purpos onlin get start may want visit panda list tutori httpspandaspydataorgpandasdocsstablegetting_startedtutorialshtmlinternalguides__ default column name attrdatadf retain userdefin name unless name exactli intern name exampl input ground heat flux column dataset name g therefor renam input_g ddfcolumn indexinput_g ws vpd_pi t_sonic swc___ swc___ netrad sw_in sw_out lw_in lw_out h_pi_f le_pi_f theta_mean dtypeobject new name also updat datavari dvariablesgetg input_g state earlier attrdatainv_map map userdefin name intern fluxdataqaqc name load attrdatadf dinv_map timestamp_start date netrad rn input_g g le_pi_f le h_pi_f h sw_in sw_in sw_out sw_out lw_in lw_in lw_out lw_out vpd_pi vpd t_sonic t_avg ws ws swc___ theta_ swc___ theta_ tip attrdatainv_map mainli use renam datafram intern name use creat custom workflow use fluxdataqaqc api allow know intern name variabl therefor hard code workflow appli differ eddi covari dataset exampl let say want make html tabl basic statist energi balanc compon mani dataset may differ name variabl save file use userdefin name dataustw_configini df ddfrenamecolumnsdinv_map get metadata save site_id dsite_id vars_we_w h le rn g renam variabl calcul basic statist tabl save html dfvars_we_wantrenamecolumnsdvariablesdescribeto_htmlhtmlformatsite_id calcul mean var theta column swc___ swc___ warn renam column g input_g produc follow html tabl userdefin name ipythondisplay import html htmlfilenamehtmlformatsite_id raw html file _statictutorialustwhtml raw html br anoth power featur attrdatadf properti datetimeindex use input data tempor frequenc view date index like ddfindex datetimeindex dtypedatetimen named length freqnon datetimeindex objpandasdatafram object use featur time seri analysi like group calcul statist time aggreg exampl show calcul day year mean energi balanc compon also demonstr use add_lin plot method avail objdata objqaqc objplot object convert intern name copi datafram df ddfrenamecolumnsdinv_map day year mean input energi balanc compon vars_we_w h le rn g doy_mean dfvars_we_wantgroupbyddfindexdayofyearmean creat bokeh figur fig figurex_axis_labelday year y_axis_labelday year mean wm arguement need creat interact plot plt_var vars_we_w color red blue black green x_name date sourc columndatasourcedoy_mean plotadd_linesfig doy_mean plt_var color x_name sourc labelsvars_we_w x_axis_typenon showfig raw html file _statictutorialdoy_mean_examplehtml note x_axis_typenon uniqu argument methplotadd_lin methplotline_plot case mean tri forc xaxi format datetim represent default x_axis_typed seealso routin occur automat creat objdata object includ calcuat weight nonweight averag soil heat flux soil moistur describ refaverag data multipl sensor modifi input data last note objdata object goe objqaqc object attrdatadf class properti case mean reassign differ objpandasdatafram critic manual prefilt valid data proceed energi balanc closur routin simpl exampl shown add air temperatur would effect et calcul later x ddf xt_sonic ddf x realist use reassign attrdatadf attrqaqcdf properti shown manual clean poor qualiti data httpsfluxdataqaqcreadthedocsioenlatestclosure_explanationhtmlstepmanualcleaningofpoorqualitydata__ seealso methdataapply_qc_flag method allow read qualiti control flag input data filter specif data base userdefin numer charact flag routin specif objdata includ sever attribut ad objdata instanc full explan exampl see refqualitybas data filter visual input data methdataplot method creat seri interact time seri plot input data potenti plot inlcud energi balanc compon radiat compon multipl soil heat flux measur air temperatur vapor pressur vapor pressur deficit wind speed precipit latent energi multipl soil moistur measur variabl found plot ad use interact featur plot creat fluxdataqaqc panzoom hover tolltip var name valu date link xax time seri plot save plot option save specif subplot zoom exampl dplotoutput_typenotebook plot_width output plot shown onlin document due memori constraint hint plot method objdata objqaqc object keyword argument output_typ default set save two option notebook show within jupyt notebook show open temporari file default web browser rather save plot mayb want column plot dplotncol plot_width save plot without specifi output file path keyword argument out_fil save output directori config file file name base attrdatasite_id suffix _input_plot plot file save default dplot_fil posixpathhomejohnfluxdataqaqcexamplesbasic_usageoutputustw_input_plotshtml follow plot shown due excess memori usag need build onlin document view outplot plot within jupyt notebook ipythondisplay import html htmlfilenamedplot_fil hint methqaqcplot method shown similar howev may includ ad plot calcul correct variabl exist alway plot data daili monthli tempor frequenc daili frequenc requir appli fluxdataqaqc energi balanc closur correct tempor resampl objqaqc object hold sever tool manag data eddi covari data analysi one primari featur tempor resampl input data daili monthli frequenc resampl time seri data daili frequenc occur upon creation objqaqc instanc frequenc within preceed objdata object alreadi daili frequenc input data minut ddfindex datetimeindex dtypedatetimen named freqnon creat qaqc instanc automat convert daili q qaqcd input data tempor frequenc appear less daili data resampl daili tempor frequenc filter day less subdaili measur convert vpd hpa kpa first datetim indic date qdfindex datetimeindex dtypedatetimen named freqnon method use aggreg differ variabl eg mean sum resampl daili monthli frequenc defin attrqaqcagg_dict class attribut intern name key tempor aggreg method valu qaqcagg_dict energi mean flux mean flux_corr mean br mean et sum et_corr sum et_gap sum et_fil sum et_fill_v sum et_user_corr sum ebr mean ebr_corr mean ebr_user_corr mean ebr_day_clim mean gridmet_etr sum gridmet_prcp sum lw_in mean t_avg mean rso mean sw_pot mean sw_in mean vp mean vpd mean ppt sum ws mean rn mean sw_out mean lw_out mean g mean le mean le_corr mean le_user_corr mean h mean h_corr mean h_user_corr mean note sever calcul variabl may look familiar mani calcul energi balanc closur correct routin describ refclosur methodolog also variabl found attrqaqcagg_dict exist attrqaqcdf access attrqaqcmonthly_df first time averag monthli time seri datafram attrqaqcmonthly_df objqaqc constructor tri infer tempor frequenc input time seri data howev method alway accur access infer initi tempor frequenc data view attrqaqctemporal_freq attribut qtemporal_freq infer input frequenc accur see panda datetim alia httpspandaspydataorgpandasdocsstableuser_guidetimeserieshtmloffsetaliases__ case thirti minut tempor frequenc automat detect abl reli n_samples_per_day instanc attribut manual estim qaqc constructor qn_samples_per_day filter day subdaili gap drop_gap daily_frac keyword argument use creat objqaqc instanc allow control day subdaili measur gap filter resampl daili frequenc subdaili gap energi balanc variabl mathl mathh mathrn mathg daili asc standarid refer et input eg hourli mathea vp mathr sw_in matht_min matht_max mathw linearli interpol automat daili aggreg interpol perform gap length measur hour option control longest length gap interpol mathrn ge control objqaqc keyword argument max_interp_hour default hour longest gap interpol mathrn set max_interp_hours_night default hoursmath import default objqaqc constructor first linearli interpol energi balanc asc ref et variabl mathl mathh mathrn mathg mathea vp mathr sw_in matht_min matht_max mathw accord maximum gap length max_interp_hour max_interp_hours_night count subdaili gap drop day set valu null climat data column qc flag subdaili gap count column subdaili data miss default drop_gapstru daily_frac word hourli input data formathl one hour miss given day default hour linearli interpol calcul daili time seri daili mean calcul hand climat variabl singl hour miss given day eg wind direct day would filter objqaqc constructor import daili time seri use energi balanc closur correct daili asc standard refer et algorithm percentag subdaili sampl requir set daily_frac argument maximum length gap linearli interpol set max_interp_hour max_interp_hours_night complement use tandem exampl input data halfhourli want maximum hour interpol given day gap length interpol hour would pass follow paramet objqaqc constructor q qaqcd daily_frac max_interp_hour max_interp_hours_night input data tempor frequenc appear less daili data resampl daili tempor frequenc linearli interpol gap energi balanc compon hour rn hour rn filter day less subdaili measur case set daily_frac allow maximum hour total gap day word requir half hourli sampl exist filter day rememb linear interpol gap done count subdaili gap could result retain day hour gap origin time seri energi balanc compon may also pass daily_frac arug decim fraction eg math approx drop day take daili meanssum base whatev data exist given day without interpol energi balanc variabl q qaqcd drop_gapsfals max_interp_hoursnon input data tempor frequenc appear less daili data resampl daili tempor frequenc let view comparison mathrn use differ option filter day subdaili gap work dataset sever period systemat gap caus upward skew daili mean mathrn filter care make empti panda datafram rn seri rn_df pddatafram recreat multiplt qaqc instanc use differ subday gap filter q qaqcd drop_gapsfals max_interp_hoursnon rn_dfsub_day_gap qdfrn_subday_gap rn_dfno_filter_no_interp qdfrenamecolumnsqinv_maprn q qaqcd drop_gapsfals rn_dfno_filter_with_interp qdfrenamecolumnsqinv_maprn q qaqcd daily_frac filter day less data rn_dfrequire_ qdfrenamecolumnsqinv_maprn q qaqcd daily_frac rn_dfrequire_ qdfrenamecolumnsqinv_maprn q qaqcd daily_frac max_interp_hour max_interp_hours_night rn_dfrequire__with_interp qdfrenamecolumnsqinv_maprn q qaqcd daily_frac max_interp_hoursnon rn_dfrequire__no_interp qdfrenamecolumnsqinv_maprn plot compar result daygap filter fig figurex_axis_labeld y_axis_labelmean daili net radiat wm filter base subdaili gap argument need creat interact line plot color red darkredorang blue black tan plt_var no_filter_no_interp no_filter_with_interp require_ require_ require__with_interp require__no_interp label filter woutinterp filter winterp requir winterp requir winterp requir winterp requir woutinterp x_name date sourc columndatasourcern_df plotadd_linesfig rn_df plt_var color x_name sourc labelslabel add daili gap count secondari figextra_y_rangesgap_count rangedstart end figadd_layoutlinearaxisy_range_namegap_count axis_labelnumb subdaili gap right figcircled sub_day_gap legendn subday gap y_range_namegap_count colorsilv sourcesourc fighovertooltipsappendsub_day_gapsformatsub_day_gap figlegendloc top_right showfig raw html file _statictutorialfilter_subdayhtml tri zoom gap fill filter woutinterp line compar day retainedfilt differ option also remov line click legend compar subset option tip finegrain approach filter day perhap multipl hour gap fill use newli creat daili gap count column le_subday_gap h_subday_gap rn_subday_gap g_subday_gap q qaqcd df qdfrenamecolumnsqinv_map exampl could postfilt day given energi balanc variabl case mathrn subdaili gap exceed threshold dflocdfrn_subday_gap dfrnnotna rnrn_subday_gap raw html div style scope datafram tbodi tr thonlyoftyp verticalalign middl datafram tbodi tr th verticalalign top datafram thead th textalign right style tabl border classdatafram thead tr styletextalign right thth thrnth thrn_subday_gapsth tr tr thdateth thth thth tr thead tbodi tr tdtd tdtd tdtd tr tr tdtd tdtd tdtd tr tr tdtd tdtd tdtd tr tr tdtd tdtd tdtd tr tr tdtd tdtd tdtd tr tbodi tabl div br monthli time seri attrqaqcmonthly_df properti allow creat monthli time seri input anc calcul variabl provid methqaqccorrect_data use tempor aggreg method daili time seri ie attrqaqcagg_dict although mani similar import differ attrqaqcdf attrqaqcmonthly_df obviou access attrqaqcmonthly_df automat run default energi balanc closur correct routin provid methqaqccorrect_data yet run check run anytim qcorrect fals show work let access monthli data show monthli statist correct evapotranspir et_corr first note et_corr dataset yet et_corr qdfcolumn fals access monthli time seri qmonthly_df et_corr qdfcolumn true call monthli datafram energi balanc closur appli automat qmonthly_dfet_corrdescrib count mean std min max name et_corr dtype float qcorrect true note attrqaqcmonthly_df also filter month less day month miss default calcul monthli time seri threshold fraction day requir use funcutilmonthly_resampl function adjust keyword argument thresh fraction day month requir gap otherwis month valu forc null eg want caclul monthli mean air temperatur requir percent day month gap fluxdataqaqcutil import monthly_resampl select t_avg exampl col t_avg df qdfrenamecolumnsqinv_map creat temporari df differ monthli resampl result tmp_df monthly_resampledf col mean threshrenam columnst_avg thresh_ join temp datafram monthli resampl result use differ thresh monthly_gap_comp tmp_dfjoinmonthly_resampledf col mean threshrenam columnst_avg thresh_ plot compar result daygap filter fig figurex_axis_labeld y_axis_labelmonthi mean air temperatur c filter base daili gap argument need creat interact line plot x date sourc columndatasourcemonthly_gap_comp exampl also show use bokeh plot argument plotline_plotfigdatethresh_sourceredlabelrequir line_alpha plotline_plotfigdatethresh_sourceblacklabelrequir line_dashdot line_width figlegendloc top_right showfig raw html file _statictutorialfilter_monthlyhtml raw html br energi balanc correct fluxdataqaqc provid routin adjust surfac energi balanc flux improv energi balanc closur eddi covari flux station data routin ultim result correct daili monthli time seri latent energi sensibl heat evapotranspir option gapfil day correct et et calcul gridmet refer et fraction refer et two method current implement energi balanc ratio method default modifi fluxnet method httpsfluxnetfluxdataorgdatafluxnetdatasetdataprocessing__ bowen ratio approach forc closur multipl least squar regress user defin lh rh mathl mathh mathrn mathg detail descript method includ daili et gapfil method found onlin document refclosur methodolog page import note api method hydroclimat statist variabl calcul shown methqaqccorrect_data method use run energi balanc closur correct tip use note monthly_df automat appli ebr energi balanc ratio correct qcorr_meth ebr potenti correct option qcorr_method ebr br lin_regress specifi bowen raito method qcorrect_datamethbr recent use correct method shown qcorr_meth br tip appli energi balanc closur correct routin previou correct variabl overwritten drop attrqaqcdf attrqaqcmonthly_df attrqaqcvari therefor make comparison differ method data make copi df monthly_df properti run next correct eg make copi daili result differ correct option qcorrect_datamethebr ebr_gapfil qdf qcorrect_datamethebr etr_gap_fillfals ebr_notgapfil qdf qcorrect_datamethbr br_gapfil qdf qcorrect_datamethbr etr_gap_fillfals br_notgapfil qdf et gapfil note option use refer et fraction daili refer et fill larg gap correct et ie keyword argument qaqccorrect_dataetr_gap_fil true nearest gridmet httpwwwclimatologylaborggridmethtml__ cell time seri data precipit alfalfa refer et attempt download found gridmet_file_path entri configini file path gridmet file found redownload config file updat new path resav overlap time period match eddi covari time seri data attempt download ie period qaqcdfindex gridmet file download alway save subdirectori config file locat call gridmet_data name use attrqaqcsite_id gridmet cell centroid latitud longitud correct latent energi mathle_corr gap also backward fill gapfil et caution gridmet httpwwwclimatologylaborggridmethtml__ exist within contigu unit state present therefor station lie outsid region analyz eddi flux data record option usus alway run correct etr_gap_fillfals avoid potenti error bowen ratio correct method produc br variabl bowen ratio calcul default methqaqccorrect_data also calcul et input latent energi le air temperatur correct et correct le air temperatur potenti clear sky radiat asc formul objdata object attempt calcul vapor pressur deficit vapor pressur air temperatur vapor pressur vapor pressur deficit air temperatur exist hourli shorter tempor frequenc evapotranspir evapotranspir et calcul describ refstep correct turbul flux ebr et energi balanc ratio correct explan asc clear sky radiat daili asc potenti clear sky radiat mathr_so calcul use equat asc standard refer evapotranspir equat final report task committe standard refer evapotranspir environment water resourc institut american societi civil engin januari httpswwwmesonetorgimagessiteasce_evapotranspiration_formulapdf__ calcul simpl method base primarili elev latitud result theoret envelop mathr_so function day year math r_so left time z right r_a mathz elev meter mathr_a daili extraterrestri radiat radiat absenc atmospher wellbehav function solar declin day year solar constant see equat asc report httpswwwmesonetorgimagessiteasce_evapotranspiration_formulapdf__ vapor pressuredeficit objdata object attempt calcul vapor pressur vapor pressur deficit one exist averag air temperatur time seri also exist input data hourli shorter tempor frequenc magnu equat eqn asc report state satur vapor pressur math kpa relat air temperatur math es eleftfrac cdot tt right matht averag hourli air temperatur degre celciu vapor pressur deficit mathvpd math vpd es ea mathea actual vapor pressur kpa note equat defin hourli measur howev use hourli shorter mean variabl matht mathea mathvpd within fluxdataqaqc convert daili mean present input data hourli shorter frequenc calcul equat rearang solv either math mathvpd given variabl air temperatur exampl given matht mathvpd get actual vapor pressur math es eleftfrac cdot tt right math ea es vpd fluxdataqaqc actual vapor pressur name vp ea also calcul rel humid found input dataset subsequ estim math rh time fracea hint calcul avail daili timestep automat appli hourli higher tempor frequenc calcul preffer appli estim vapor pressur vapor pressur deficit satur vapor pressur rel humid daili data one must call methqaqc_calc_vpd_from_vp method objqaqc instanc calcul variabl refer although variabl creat energi balanc closur correct describ refclosur methodolog other refer list possibl calcul variabl creat fluxdataqaqc variabl descript rso potenti clear sky radiat asc formul flux input le h energi input rn g ebr_day_clim day climatolog filter energi balanc ratio le_corr correct latent energi ebc_cf energi balanc closur correct factor invers ebr_corr ebr_corr correct energi balanc ratio flux_corr le_corr h_corr ebr input energi balanc ratio br bowen ratio h_corr correct sensibl heat et et calcul input le averag air temperatur et_corr et calcul le_corr avg air temp gridmet_etr gridmet alfalfa refer et nearest cell gridmet_prcp gridmet precipit etrf fraction refer et et_corr ie et_corr gridmet_etr etrf_filt filter etrf et_fil gridmet_etr etrf_filt fill gap et_corr et_gap true gap day et_corr fals otherwis et_fill_v valu et_fil gap day note unit upon creation objqaqc object variabl check valid input unit convert requir unit need intern calcul run methqaqccorrect_data certain default plot see list valid input unit differ variabl refer attrqaqcallowable_unit attribut qallowable_unit le wm h wm rn wm g wm lw_in wm lw_out wm sw_in wm sw_out wm ppt mm vp kpa hpa vpd kpa hpa t_avg c f variabl given one unit allow unit automat convert requir unit know variabl requir particular unit view attrqcrequired_unit qrequired_unit le wm h wm rn wm g wm lw_in wm lw_out wm sw_in wm sw_out wm ppt mm vp kpa vpd kpa t_avg c note list allow unit work progress input unit avail consid rais issu github httpsgithubcomopenetfluxdataqaqcissues__ provid convers directli pull request automat unit convers handl within objutilconvert class use methutilconvertconvert class method save resampl correct data methqaqcwrit method conveni write daili monthli time seri input calcul variabl comma separ valu csv file methqaqccorrect_data method yet run monthli time seri also creat use default paramet correct routin energi balanc ratio method etrbas gap fill default output directori time seri file accessedchang out_dir attribut chang locat directori configini file daili monthli time seri file name begin attrqaqcsite_id follow daily_data monthly_data resepct exampl new qaqc instanc q qaqcd platform depend pathlibpath object qout_dir posixpathhomejohnfluxdataqaqcexamplesbasic_usageoutput line show output file written attrqaqcout_dir yet print file output directori begin site_id fname f qout_dirglobformatqsite_id ustw_input_plotshtml qcorrect fals write file also ran correct sinc yet run qwrite qcorrect true respect daili monthli time seri written attrqaqcout_dir fname f qout_dirglobformatqsite_id ustw_daily_datacsv ustw_monthly_datacsv ustw_input_plotshtml hint overwrit default name output directori save daili monthli time seri use out_dir keyword argument methqaqcwrit option keep locat within directori config file chang name wherea chang entir output directori path adjust attrqaqcout_dir attribut directli also name scheme output file creat use userdefin name input variabl visual resampl correct data similar methdataplot methqaqcplot method creat seri default time seri scatter plot input case calcul variabl tempor frequenc plot methqaqcplot alway daili monthli addit plot creat valid energi balanc closur correct otherwis option number subplot column super titl subplot dimens output type output file path etc avail similar methqaqcwrit attrqaqcmonthly_df data yet correct plot method correct use default paramet creat plot exampl default daili monthli time seri plot produc run energi balanc ratio closur correct q qaqcd qplotoutput_typenotebook plot_width raw html file _statictutorialustw_plotshtml fluxdataqaqc tool energi balanc closur analysi doc download per month pypi version view github httpsgithubcomopenetfluxdataqaqc_ fluxdataqaqc provid framework creat reproduc workflow valid analysi eddi covari data packag intend need postprocess flux data particularli gener daili monthli evapotransipr et timeseri estim energi balanc closur correct appli applic softwar may use includ analysi involv eddi covari flux tower data hydrolog atmospehr model valid irrig water consumpt studi key function tool includ data valid method qualitybas filter time seri data tool eg tempor aggreg resampl manag site metadata data proven file structur energi balanc closur algorithm meterolog calcul download manag gridmet httpwwwclimatologylaborggridmethtml__ meterolog data customiz interact data visual batch process unit convers toctre maxdepth caption content instal configur option advanced_config_opt tutori tutori closur algorithm closure_explan api test software_test contributor toctre maxdepth changelog indic tabl refgenindex refmodindex refsearch doc imag httpsreadthedocsorgprojectsfluxdataqaqcbadgeversionlatest target httpsfluxdataqaqcreadthedocsioenlatestbadgelatest alt document statu download per month imag httpsimgshieldsiopypidmfluxdataqaqcsvg target httpspypipythonorgpypifluxdataqaqc pypi version imag httpsimgshieldsiopypivfluxdataqaqcsvg target httpspypipythonorgpypifluxdataqaqc instal use pip codeblock bash pip instal fluxdataqaqc pip instal necessari depend howev recommend use conda first instal provid virtual environ use avoid chang local python environ note fluxdataqaqc test python although may work version greater equal first make sure fluxdataqaqc environ file download httpsrawgithubusercontentcomopenetfluxdataqaqcmasterenvironmentymltokenabbjkuklelemwplylxfcwqog_ next instal run codeblock bash conda env creat f environmentyml activ environ use fluxdataqaqc packag run codeblock bash conda activ fluxdataqaqc instal use pip codeblock bash pip instal fluxdataqaqc packag modul tool avail python environ path abl import note instal conda virtual environ pip instal depend automat sure use version python equal test everyth instal correctli open python interpretor ide run follow codeblock python import fluxdataqaqc codeblock python fluxdataqaqc import data qaqc plot everyth instal correctli get error develop mode plan contribut fluxdataqaqc instal develop mode allow easili modifi sourc code test chang within python environ clone download github httpsgithubcomopenetfluxdataqaqc_ codeblock bash git clone httpsgithubcomopenetfluxdataqaqcgit next move root directori instal activ conda environ codeblock bash conda env creat f environmentyml run follow instal fluxdataqaqc develop mode environ codeblock bash pip instal e closur methodolog fluxdataqaqc current provid two routin ultim adjust turbul flux order improv energi balanc closur eddi covari tower data energi balanc ratio bowen ratio method closur method assign keyword argument methqaqccorrect_data method list provid closur option see attrqaqccorr_method exampl would like run bowen ratio correct routin assum succes creat objqaqc object codeblock python q qaqc instanc qcorrect_datamethbr keyword argument methqaqccorrect_data allow gap fill correct evapotranspir mathet calcul correct latent energi mathl default gap fill option set true detail refstep option gap fill correct et use gridmet refer et refer et fraction tip interact visual page creat use methplotline_plot methplotadd_lin methplotscatter_plot automat handl issu util mous hover tooltip objbokehplottingfigurefigur featur data descript data exampl come twitchel alfalfa ameriflux eddi covari flux tower site california site locat alfalfa field exhibit mild mediterranean climat dri hot summer inform site download data click httpsamerifluxlblgovsitessiteinfoustw__ energi balanc ratio method energi balanc ratio method default modifi fluxnet methodolog httpsfluxnetfluxdataorgdatafluxnetdatasetdataprocessing__ step daili heat process method involv filter extrem valu daili energi balanc ratio time seri smooth gap fill invers filter smooth time seri use seri correct factor initi time seri latent energi mathl sensibl heat mathh flux time seri step abbrevi stepbystep descript energi balanc ratio correct routin use fluxdataqaqc detail visual demonstr step shown step option option filter poor qualiti data first qualiti control qc valu flag provid dataset mean exampl fluxnet data includ qc valu mathh mathl eg h_f_mds_qc le_f_mds_qc qc valu gap fill mathh mathl allow manual preqaqc data step calcul energi balanc ratio ebr mathfrach lern g daili time seri raw data step filter ebr valu outsid time interquartil rang step day daili time seri filter ebr slide window day day use select valu step day take percentil default ebr valu check invers ebr valu math invers ratio multipli measur mathl would result flux greater less mathwm leav gap fill later step less day exist slide day window use mean ebr day day day slide window appli criteria extrem ebr valu step step ebr data exist slide window averag fill remain gap ebr mean day slide window day year mean year record ie day climatolog calcul day climatolog filter smooth ebr produc step appli criteria extrem ebr valu step step use filter ebr time seri previou step correct mathl mathh multipli energi balanc closur correct factor mathebc_cf fracebr ebr filter previou step use correct mathl mathh calcul correct ebr step calcul correct mathet correct mathl use averag air temperatur adjust latent heat vapor step option desir fill remain gap correct mathet time seri mathet calcul gridmet refer mathet mathetr matheto multipli filter smooth fraction refer et mathetrf mathetof step manual clean poor qualiti data see daili time seri net radiat mathrn period poor qualiti data common issu due eg instrument problem alway avoid case sensor record valu night provid data mathrn valu lower sever day eg around result overestim daili mean mathrn period although day automat filter objqaqc class exampl show way manual filter case outlier daili data may caus resampl subdaili data systemat measur gap main point manual inspect potenti prefilt poor qualiti data proceed energi balanc closur correct often necessari raw html file _staticclosure_algorithmsstep_notfilteredhtml sever way conduct manual prefilt poor qualiti meterolog time seri data filter data base input qualiti flag numer qualiti valu see refqualitybas data filter fluxdataqaqc also allow filter poor qualiti data fli shown exampl word simpli filter period think bad data mathrn within python run closur correct manual determ date period poor qualiti mathrn filter oiut run correct import panda pd import numpi np fluxdataqaqc import data qaqc datapathtoconfigini day sub daili gap filter automat see tip follow plot q qaqcd drop_gapsfals renam datafram column eas variabl access adjust df qdfrenamecolumnsqinv_map date chosen one way filter make qc flag column rn dfrn_qc good dflocpddate_rang rn_qc bad dflocpddate_rang rn_qc bad dflocpddate_rang rn_qc bad dflocpddate_rang rn_qc bad dflocpddate_rang rn_qc bad dflocpddate_rang rn_qc bad dflocpddate_rang rn_qc bad filter make null base qc flag column rn dflocdfrn_qc bad rn npnan reassign use prefilt data correct qdf df result energi balanc compon plot mathrn filter raw html file _staticclosure_algorithmsstep_filteredhtml tip case issu mathrn caus resampl minut data systemat nighttim gap sort issu automat handl creat objqaqc object keyword argument drop_gap daily_frac objqaqc class use automat filter day measur gap vari size ie datapathtoconfigini q qaqcd drop_gapstru daily_frac qcorrect_data would produc similar energi balanc closur result manual filter anoth finegrain option would flag day gap subdaili input time seri would like filter methdataapply_qc_flag note remain stepbystep explan page use prefilt input time seri howev result energi balanc closur correct without prefilt outlier mathrn also shown plot final step comparison ran qdf df qcorrect_data qplotoutput_typeshow directli produc output step use prefilt data step filter outlier ebr calcul daili ebr mathfrach lern g time seri filter extrem valu outsid interquartil rang note fluxdataqaqc name ebr raw html file _staticclosure_algorithmssteps__prefilteredhtml step filter ebr use move window statist filter ebr time seri use statist perform multipl move window specif take median ebr day move window less day exist window take mean day move window case check result valu retain base follow criteria invers ebr valu must math invers ratio multipli measur mathl result flux less greater mathwm either criteria met leav gap day fill later step raw html file _staticclosure_algorithmssteps__prefilteredhtml step calcul day climatolog ebr comput day climatolog daili ebr adjust previou step fill remain gap day specif calcul day year mean ebr year record extract day year mean use move day day move window result valu also check criteria describ step invers ebr valu must math invers ratio multipli measur mathl result flux less greater mathwm note step use remain gap larger day ebr time seri follow step exampl time period fill day climatolog ebr seen thin blue line plot raw html file _staticclosure_algorithmsstep_prefilteredhtml fluxdataqaqc also keep record day climatolog energi balanc ratio calcul step shown name fluxdataqaqc ebr_day_clim raw html file _staticclosure_algorithmsdayclim_prefilteredhtml step correct turbul flux ebr et calcul correct mathl mathh multipli mathfracebr mathebr filter ebr time seri previou step math le_corr le time fracebr math h_corr h time fracebr use correct le h calcul correct ebr math ebr_corr frach_corr le_corrrn g calcul et le use averag air temperatur adjust latent heat vapor follow method harrison lp math et_mm cdot day _sec cdot day time fracle_w cdot m_mj cdot kg cdot t_c evapotransipir mathet mathmm cdot day mathl latent energi flux mathw cdot matht air temperatur degre celciu approach use calcul correct mathet mathet_corr use mathle_corr plot show time seri initi correct et mathet mathet_corr raw html file _staticclosure_algorithmset_ts_prefilteredhtml signific gap energi balanc compon dataset therefor step use although still demonstr artifici gap next step follow plot show energi balanc closur initi correct data appli step includ manual prefilt mathrn raw html file _staticclosure_algorithmsebc_scatter_prefilteredhtml notic mean daili correct energi balanc ratio slope correct near perfect closur howev plot show result skip manual prefilt outlier mathrn valu case result correct mean closur raw html file _staticclosure_algorithmsebc_scatter_noprefilterhtml tip interact visual energi balanc closur result provid default via methqaqcplot method fluxdataqaqc new variabl name step le_corr h_corr ebr ebr_corr ebc_cf et et_corr ebr_corr ebr_day_clim invers correct ebr filter previou step name ebc_cf short energi balanc closur correct factor describ fluxnet methodolog httpsfluxnetfluxdataorgdatafluxnetdatasetdataprocessing__ step daili heat process step option gap fill correct et use gridmet refer et refer et fraction done download mathetr matheto default mathetr overlap gridmet cell site must conu calcul math et_fil etrf time et_r math etrf fracet_corret_r mathet_corr correct et produc step mathetrf fraction refer et mathetrf first filter remov outlier outsid time interquartil rang smooth day move averag minimum day must exist window lastli linearli interpol fill remain gap gap fill procedur easili done use gridmet grass refer et matheto oppos alfalfa refer et mathetr tip filter raw version mathetrfmathetof gridmet mathetr gridmet matheto gap day monthli total number gap fill day track postprocess visual methqaqcplot methqaqcwrit method sinc data use exampl gap illustr creat follow larg gap measur energi balanc compon may august raw html file _staticclosure_algorithmsstep_filtered_withgaphtml result time seri mathet_corr use option gap fill method describ shown raw html file _staticclosure_algorithmset_ts_with_gapfillhtml note gap fill valu mathet green line accur catch harvest cycl alfalfa howev mathet_corr valu blue line gap fill valu base gridmet refer et local repres hard see tri use box zoom tool right plot zoom gapfil period et gapfil step use default run fluxdataqaqc energi balanc closur correct routin disabl set etr_gap_fil argument methqaqccorrect_data fals eg codeblock python q qaqc instanc qcorrect_datamethebr etr_gap_fillfals fluxdataqaqc new variabl name step etrf etrf_filt gridmet_etr et_gap et_fil et_fill_v differ et_fil et_fill_v latter mask null day fill valu use fill gap mathet_corr also et_gap daili seri true fals valu indic day step mathet_corr gap subsequ fill note use mathetrbas gapfil option gap fill day also use fill gap mathle_corr therefor mean closur found daili monthli closur scatter plot output methqaqcplot updat reflect influenc gapfil day bowen ratio method bowen ratio energi balanc closur correct method implement follow typic approach correct latent energi mathl sensibl heat mathh flux adjust follow way math le_corr fracrn g beta math h_corr le_corr time beta mathbeta bowen ratio ratio sensibl heat flux latent energi flux math beta frachl routin forc energi balanc closur day time seri result mathet_corr time seri use prefilt mathrn energi balanc time seri bowen ratio method raw html file _staticclosure_algorithmset_ts_br_prefilteredhtml energi balanc closur scatter plot show forc closur method raw html file _staticclosure_algorithmsebc_br_scatter_prefilteredhtml new variabl produc fluxdataqaqc method includ br bowen ratio ebr ebr_corr le_corr h_corr et et_corr energi flux flux_corr includ changelogrst api refer page document object function provid fluxdataqaqc data autoclass fluxdataqaqcdata member undocmemb showinherit qaqc autoclass fluxdataqaqcqaqc member undocmemb showinherit plot autoclass fluxdataqaqcplot member undocmemb showinherit util class function automodul fluxdataqaqcutil member undocmemb showinherit