readmemd gener readmermd pleas edit file skater badg start cran statushttpswwwrpkgorgbadgesversionskaterhttpscranrprojectorgpackageskat biorxivhttpsimgshieldsiobadgebiorxivfredhttpswwwbiorxivorgcontentv doihttpszenodoorgbadgesvghttpszenodoorgbadgelatestdoi rcmdcheckstablehttpsgithubcomsignaturescienceskaterworkflowsrcmdcheckstablebadgesvghttpsgithubcomsignaturescienceskateract rcmdcheckdevhttpsgithubcomsignaturescienceskaterworkflowsrcmdcheckdevbadgesvghttpsgithubcomsignaturescienceskateract badg end snpbase kinship analysi test evalu miscellan r data analysi utilti instal instal stabl releas cran r installpackagesskat instal develop version github r remotesinstall_githubsignaturescienceskat build_vignettestru usag basic usag vignettehttpssignaturesciencegithubioskaterarticlesbasic_usagehtml step primari function skater packag r vignettebasic_usag packag skater full document httpssignaturesciencegithubioskat skater updat vignett handl futur chang tidyr thank davisvaughan updat descript url bugreport link skater initi releas test environ local maco instal r r hub fedora linux rdevel ubuntu linux lt rreleas window server r sp rdevel r cmd check result local r cmd check statu ok error warn note r hub note new submiss note possibl misspel word descript ibd et al benchmark polymorph ibd defin descript ident descent benchmark polymorph spell correctli et al use refer link doi doi revis initi cran inspect ad detail descript packag function descript defin acronym descript ad signatur scienc llc cph descript author ad refer descript field descript form author year doi refer preprint describ method better explan ident descent ibd segment kinship coeffici math function document stop export two intern function remov exampl clarifi document ad return valu plot_pedigre call side effect updat export function ensur return valu note class output valu mean output github_docu readmemd gener readmermd pleas edit file r includ fals knitropts_chunkset collaps true comment figpath manfiguresreadm outwidth skater badg start cran statushttpswwwrpkgorgbadgesversionskaterhttpscranrprojectorgpackageskat biorxivhttpsimgshieldsiobadgebiorxivfredhttpswwwbiorxivorgcontentv doihttpszenodoorgbadgesvghttpszenodoorgbadgelatestdoi rcmdcheckstablehttpsgithubcomsignaturescienceskaterworkflowsrcmdcheckstablebadgesvghttpsgithubcomsignaturescienceskateract rcmdcheckdevhttpsgithubcomsignaturescienceskaterworkflowsrcmdcheckdevbadgesvghttpsgithubcomsignaturescienceskateract badg end snpbase kinship analysi test evalu miscellan r data analysi utilti instal instal stabl releas cran r installpackagesskat instal develop version github r remotesinstall_githubsignaturescienceskat build_vignettestru usag basic usag vignettehttpssignaturesciencegithubioskaterarticlesbasic_usagehtml step primari function skater packag r vignettebasic_usag packag skater full document httpssignaturesciencegithubioskat titl skater r packag snpbase kinship analysi test evalu author name stephen turner affili signatur scienc llc austin tx usa name v p nagraj affili signatur scienc llc austin tx usa name matthew scholz affili signatur scienc llc austin tx usa name shakeel jessa affili signatur scienc llc austin tx usa name carlo acevedo affili signatur scienc llc austin tx usa name jiany ge affili center human identif depart microbiolog immunolog genet univers north texa health scienc center fort worth tx usa name august e woerner affili center human identif depart microbiolog immunolog genet univers north texa health scienc center fort worth tx usa name bruce budowl affili center human identif depart microbiolog immunolog genet univers north texa health scienc center fort worth tx usa abstract motiv snpbase kinship analysi genomewid relationship estim ibd segment analysi method produc result often requir downstream process manipul dedic softwar packag consist intuit implement analysi function need result present skater r packag snpbase kinship analysi test evalu r skater packag contain suit welldocu tool import pars analyz pedigre data perform relationship degre infer benchmark relationship degre classif summar ibd segment data avail skater packag implement r packag releas mit licens httpsgithubcomsignaturescienceskat document avail httpssignaturesciencegithubioskat output biocworkflowtoolsf_articl default bibliographi bibliographybib keyword bioinformat kinship r genealog snp singl nucleotid polymorph related r version r rversionstr bioconductor version r biocmanagervers updat name packag name workflow packag work skater packag version r packageversionskat introduct infer famili relationship individu use genet data common practic popul genet medic genet forens multipl approach estim related sampl includ genomewid measur implement plink purcel king manichaikul method reli ident descent ibd segment detect germlin gusev hapibd zhou ibi seidman recent effort focus benchmark method ramstett aid tool simul pedigre genomewid snp data caballero analyz result genomewid snpbase kinship analysi compar analys simul data benchmark point requir write oneoff analysi function util script seldom distribut robust document test suit narr exampl usag need field welldocu softwar packag consist design api contain function assist downstream manipul benchmark analysi snpbase kinship assess method present skater packag snpbase kinship analysi test evalu r method implement softwar tool paper section address tool work relev technic detail requir implement tool develop skater packag provid intuit collect analysi util function snpbase kinship analysi function packag includ tool import pars analyz pedigre data perform relationship degre infer benchmark relationship degre classif summar ibd segment data describ full _use cases_ section packag adher tidi data analysi principl build upon tool releas tidyvers r ecosystem wickham skater packag host comprehens r archiv network cran main repositori r packag httpcranrprojectorgpackageskat user instal skater r execut follow code r evalfals installpackagesskat altern develop version skater avail github httpsgithubcomsignaturescienceskat develop version may contain new featur yet avail version host cran version instal use install_github function devtool packag r evalfals installpackagesdevtool devtoolsinstall_githubsignaturescienceskat build_vignettestru instal skater packag skater depend automat instal includ magritr tibbl dplyr tidyr readr purrr kinship corrr rlang other oper part method includ minim system requir need run softwar overview workflow tool user tool minim system requir instal use skater includ r version higher sever tidyvers packag wickham mani r user alreadi instal use case demonstr detail summari skater packag function read variou output file produc commonli use tool snpbase kinship analysi pedigre pars manpul analysi relationship degre infer benchmark assess relationship classif accuraci ibd segment analysi postprocess comprehens refer function skater packag avail httpssignaturesciencegithubioskat result option novel data analys includ section requir paper includ novel data analys written tradit result section use case skater packag provid collect analysi util function snpbase kinship analysi test evalu r packag function packag includ tool work pedigre data perform relationship degre infer assess classif accuraci summar ibd segment data r libraryskat option new dataset includ section requir paper includ novel data analys exampl input output file provid explanatori context novel complex variabl paramet also explain suffici detail allow user understand use tool function pedigre pars manipul analysi comment line use shorter jossbioinformat submiss expand skater packag sever function import pars analyz pedigre data pedigre defin famili relationship hierarch structur mani genom tool work pedigre start fam file tabular format one row per individu column uniqu id mother father famili unit skater packag contain function read_fam read plinkformat fam file anoth function famp convert content pedigre object nest tibbl one row per famili pedigre process skater intern leverag data structur kinship packag sinnwel function plot_pedigre produc multipag pdf draw diagram pedigre famili pedkinpair produc pairwis list relationship individu data expect kinship coeffici pair see skater packag vignett pedigre defin famili relationship hierarch structur one common format use plink purcel genet analysi tool fam file fam file tabular format one row per individu column uniqu id mother father famili unit packag includ read_fam read file format r famfil systemfileextdata gensfam packageskat mustworktru fam read_famfamfil fam famili structur import fam format file translat pedigre structur use kinship packag sinnwel fam format may includ multipl famili famp function collaps tibbl one row per famili r ped fampedfam ped exampl result tibbl nest famili id data column contain individu famili inform ped column contain pedigre object famili use standard tidyvers oper result tibbl unnest particular famili r ped dplyrfilterfidtestp tidyrunnestcolsdata singl pedigre also inspect visual standard base r plot argument mar cex use adjust aesthet r pedsp r plotp figwidth figheight figcappedigre diagram first famili pedigre shown code plotpedsp marc cex plot_pedigre function skater iter list pedigre object write multipag pdf page contain pedigre famili r evalfals plot_pedigreepedsp filegenspedpdf pedkinpair function take pedigre object produc pairwis list relationship individu data expect kinship coeffici pair function run singl famili r pedkinpairpedsp function also map famili pedigre r kinpair ped dplyrmutatepairspurrrmap pedkinpair dplyrselectfid pair tidyrunnestcolspair kinpair note map pedkinpair ped object input tibbl relationship shown betweenfamili relationship relationship degre infer benchmark skater packag includ function translat kinship coeffici relationship degre kinship coeffici could come pedkinpair kinship estim softwar comment line use shorter jossbioinformat submiss expand dibbl function creat degre infer tibbl degre specifi maximum degre resolut expect kinship coeffici lower upper infer rang defin manichaikul kindegre function infer relationship degre given kinship coeffici maximum degre resolut eg thdegre rel anyth distant classifi unrel dibbl function creat degre infer tibbl degre specifi max_degre default expect kinship coeffici lower l upper u infer rang defin manichaikul degre correspond self ident monozygot twin expect kinship coeffici infer rang anyth beyond maximum degre resolut consid unrel degre na note also theoret upper boundari kinship coeffici infer rang degre person ident twin extend allow float point arithmet stochast effect result kinship coeffici r dibbl degre infer max_degre default chang argument allow granular degre infer rang r dibblemax_degre note distanc relationship degre becom smaller relationship degre becom distant dibbl function emit warn max_degre stop error kindegre function infer relationship degre given kinship coeffici max_degre anyth distant treat unrel exampl first degre rel r kindegre max_degre exampl th degre rel use default max_degre resolut r kindegre max_degre exampl th degre rel increas degre resolut r kindegre max_degre kindegre function vector valu k use insid mutat tibbl kinship coeffici r get two pair type relationship kinpair kinpairs_subset kinpair dplyrgroup_byk dplyrslic kinpairs_subset infer degre third degre rel kinpairs_subset dplyrmutatedegreekindegreek max_degre benchmark degre classif comment line use shorter jossbioinformat submiss expand estim kinship convert degre may interest compar infer degre known degre related aggreg mani relationship infer help benchmark perform particular kinship analysi method skater packag adapt confusion_matrix function clark provid standard conting tabl metric eg sensit specif ppv precis recal f etc new reciproc rmse rrmse metric rrmse metric defin thoroughli skater packag vignett may prefer measur classif accuraci benchmark relationship degre estim mani kinship benchmark analys classif error treat categor manner exact match plu minu one degre neglect true amount share real number take reciproc target predict degre typic rmse calcul result larger penalti egregi misclassif eg classifi firstdegre rel pair seconddegre misclassif distant relationship eg classifi fourthdegre rel pair fifthdegre estim kinship convert degre may interest compar infer degre truth aggreg mani relationship infer approach help benchmark perform particular kinship analysi method skater packag adapt confusion_matrix function clark provid standard conting tabl metric eg sensit specif ppv precis recal f etc new reciproc rmse rrmse metric confusion_matrix function output list four object tibbl calcul accuraci lower upper bound guess rate pvalu accuraci vs guess rate tibbl conting tabl statist calcul class detail statist calcul class review help page confusion_matrix matrix conting tabl object vector reciproc rmse rrmse rrmse repres altern classif accuraci benchmark relationship degre estim calcul use formula take reciproc target predict degre result larger penalti egregi misclassif eg classifi firstdegre rel pair second degre misclassif distant relationship eg misclassifi fourthdegre rel pair fifthdegre adjust prevent divisionbyzero thdegre ident rel pair introduc beginequ sqrtfracsum_ikfractexttargetfractextpredictedk endequ illustr usag exampl start kinpair data randomli flip true relationship degre r function randomli flip level factor default randomflip functionx p ifelseruniflengthxp sampleuniquex x infer degre truthtarget use kindegre randomli flip setse kinpairs_inf kinpair dplyrmutatedegree_truthkindegreek max_degre dplyrmutatedegree_truthtidyrreplace_nadegree_truth unrel dplyrmutatedegree_inferredrandomflipdegree_truth kinpairs_inf next run confusion_matrix function return four object note r confusion_matrixpredict kinpairs_inferreddegree_inf target kinpairs_inferreddegree_truth standard tidyvers function purrrpluck use isol conting tabl r confusion_matrixpredict kinpairs_inferreddegree_inf target kinpairs_inferreddegree_truth purrrpluckt confusion_matrix function includ argument output tidi longertru format exampl illustr spread conting tabl statist class r confusion_matrixpredict kinpairs_inferreddegree_inf target kinpairs_inferreddegree_truth longer true purrrpluckoth tidyrspreadclass valu dplyrrelocateaverag afterdplyrlast_col dplyrmutate_ifrlangis_doubl signif ibd segment analysi tool hapibd zhou ibi seidman detect share ibd segment individu skater packag includ function take ibd segment comput share genom centimorgan cm length convert share cm kinship coeffici addit infer segment function estim truth kinship simul ibd segment caballero read_ibd function read pairwis ibd segment ibd infer tool simul ibd segment read_map function read genet map standard format requir translat total centimorgan share ibd kinship coeffici use ibdkin function see read_ibd read_map addit detail expect format read_ibd function read pairwis ibd segment format input function either infer ibd segment hapibd sourcehapibd simul segment sourcepedsim first exampl use data hapibd output format r messagefals hapibd_filepath systemfileextdata gbrsimibdgz packageskat hapibd_seg read_ibdhapibd_filepath sourc hapibd hapibd_seg order translat share genom cm length kinship coeffici genet map must first read read_map softwar ibd segment infer simul requir genet map map load kinship estim one use creat share ibd segment output exampl use minim genet map ship skater r gmap_filepath systemfileextdata sexspecavgminplinkmap packageskat gmap read_mapgmap_filepath gmap ibdkin function take segment map file output tibbl one row per pair individu column individu id individu id kinship coeffici pair r ibd_dat ibdkinibd_datahapibd_seg mapgmap ibd_dat discuss option novel data analys includ section requir paper includ novel data analys written style tradit discuss section pleas includ brief discuss allow made control bia unwant sourc variabl limit novel dataset conclus option novel data analys includ section requir paper includ novel data analys written tradit conclus summari option new dataset includ skater r packag provid robust softwar packag data import manipul analysi task typic encount work snpbase kinship analysi tool packag function intern document exampl packag contain vignett demonstr usag input output interpret key function packag contain intern test automat run continu integr via github action whenev packag code updat skater packag permiss licens mit easili extens accommod output new genomewid related ibd segment method becom avail data avail option novel data analys includ pleas add detail dataset mention paper previous formal publish found previous publish dataset mention cite refer per usual scholarli convent softwar avail section gener editori offic public author ask provid initi inform assist editori offic detail url link softwar download use noncod author provid option url link author version control system repositori contain sourc code author provid requir link sourc code time public fresearch gener link archiv sourc code time public fresearch gener softwar licens author provid requir softwar avail httpcranrprojectorgpackageskat sourc code avail httpsgithubcomsignaturescienceskat archiv sourc code time public httpsdoiorgzenodo softwar licens mit licens author inform sdt vpn mb develop r packag author contribut method develop sdt wrote first draft manuscript author assist manuscript revis author read approv final manuscript compet interest financi person profession compet interest author could constru unduli influenc content articl must disclos display alongsid articl relev compet interest declar pleas add follow compet interest disclos compet interest disclos grant inform pleas state fund work discuss articl whether employ grant funder etc pleas list fund relev specif piec research funder pleas state funder name grant number applic individu grant assign work fund grant pleas includ line author declar grant involv support work work support part award dubx dens dna data enhanc miss person identif bb award nation institut justic offic justic program us depart justic intern fund center human identif opinion find conclus recommend express author necessarili reflect us depart justic acknowledg section acknowledg anyon contribut research articl qualifi author base criteria provid earlier eg someon organ provid write assist pleas state contribut author obtain permiss acknowledg mention acknowledg section pleas list grant fund section use r markdown exampl commonli use markdown syntax list help get start crossrefer portabl differ output format use syntax introduc bookdown label label reflabel crossrefer follow section provid exampl referenc tabl figur equat citat includ refer standard bibtex file name file given header markdown document case samplebib refer entri bibtex file made use squar bracket use plu key entri referenc smithqr combin multipl entri separ semicolon smithqr smithjd default bibliographi style use numer citat superscript authoryear citat set header metadata field natbibopt either super round respect specifi figur caption code chunk use chunk option figcap plot automat label number figur label gener label code chunk prefix fig eg see figur reffigplot tabl markdown syntax tend lack sophist format featur avail latex may need edit tabl later get desir format first name last name grade john doe richard mile tabl caption tabl like figur tabl caption also number referenc caption enter paragraph begin string tabl may appear either tabl label tabl appear begin caption form tablabel eg see tabl reftabt tabtabl tabl text justif first name last name grade john doe richard mile figur includ static figur ie gener code use include_graph function knitr packag standard code chunk use figcap option provid figur caption refer imag base code chunk label also use option figalign figwidth adjust posit size imag within final document eg figur reffigfrogpictur frog altern use standard markdown syntax like smaller version pictur insert use standard markdown syntaxfrogjpgwidthcm heightcm pleas give figur appropri filenam eg figurepdf figurepng figur legend briefli describ key messag figur figur stand alon main text howev figur also discuss articl text legend concis titl word legend succinct still explain symbol abbrevi avoid lengthi descript method figur reproduc anoth public long appropri permiss obtain copyright holder see head submiss pleas includ line legend state figur reproduc kind permiss includ origin public citat titl basic usag output rmarkdownhtml_vignett toc true vignett vignetteindexentrybas usag vignetteengineknitrrmarkdown vignetteencodingutf r includ fals knitropts_chunkset collaps true comment optionsrmarkdownhtml_vignettecheck_titl fals overview skater packag provid collect analysi util function snpbase kinship analysi test evalu r packag function packag includ tool work pedigre data perform relationship degre infer assess classif accuraci summar ibd segment data r libraryskat pedigre pars manipul pedigre defin famili relationship hierarch structur one format use plink genet analysi tool fam fileplinkfam fam file tabular format one row per individu column uniqu id mother father famili unit packag includ read_fam read file format plinkfam httpswwwcoggenomicsorgplinkformatsfam r famfil systemfileextdata gensfam packageskat mustworktru fam read_famfamfil fam famili structur import fam format file translat pedigre structur use kinship packagekinshipref fam format may includ multipl famili famp function collaps tibbl one row per famili kinshipref sinnwel jason p terri therneau daniel j schaid kinship r packag pedigre data _human heredity_ r ped fampedfam ped exampl result tibbl nest famili id data column contain individu famili inform ped column contain pedigre object famili unnest particular famili r ped dplyrfilterfidtestp tidyrunnestcolsdata also look singl pedigre r pedsp plot pedigre r plotp figwidth figheight figaligncent plotpedsp marc plot_pedigre function skater iter list pedigre object write multipag pdf page contain pedigre famili r evalfals plot_pedigreepedsp filegenspedpdf pedkinpair function take pedigre object produc pairwis list relationship individu data expect kinship coeffici pair function run singl famili r pedkinpairpedsp map famili pedigre r kinpair ped dplyrmutatepairspurrrmap pedkinpair dplyrselectfid pair tidyrunnestcolspair kinpair note map pedkinpair ped object input tibbl relationship shown betweenfamili relationship zero degre infer skater packag includ function translat kinship coeffici relationship degre kinship coeffici could come pedkinpair kinship estim softwar dibbl function creat degre infer tibbl degre specifi max_degre default expect kinship coeffici lower l upper u infer rang defin king papermanichaikul degre correspond self ident monozygot twin expect kinship coeffici infer rang anyth beyond maximum degre resolut consid unrel degre na expect kinship coeffici manichaikul manichaikul mychaleckyj j c rich dali k sale chen w robust relationship infer genomewid associ studi bioinformat oxford england httpsdoiorgbioinformaticsbtq r dibbl degre infer max_degre default chang argument allow granular degre infer rang r dibblemax_degre note distanc relationship degre becom smaller relationship degre becom distant dibbl function throw warn max_degre stop error kindegre function infer relationship degre given kinship coeffici max_degre anyth distant treat unrel exampl first degre rel r kindegre max_degre exampl th degre rel use default max_degre resolut r kindegre max_degre exampl th degre rel increas degre resolut r kindegre max_degre kindegre function vector valu k use insid mutat tibbl kinship coeffici r get two pair type relationship kinpair kinpairs_subset kinpair dplyrgroup_byk dplyrslic kinpairs_subset infer degre third degre rel kinpairs_subset dplyrmutatedegreekindegreek max_degre benchmark degre classif estim kinship convert degre may interest compar infer degre truth aggreg mani relationship infer method help benchmark perform particular kinship analysi method skater packag adapt function confusionmatrix packageconfusionmatrix confusion_matrix function confusionmatrix httpsgithubcommclarkconfusionmatrix confusion_matrix function output list three object tibbl calcul accuraci lower upper bound guess rate pvalu accuraci vs guess rate tibbl follow statist class sensit aac specif dbd preval acabcd ppv sensit prevalencesensit preval specif preval npv specif prevalencesensit preval specif preval detect rate aabcd detect preval ababcd balanc accuraci sensitivityspecif precis aab recal aac f harmon mean precis recal fals discoveri rate ppv fals omiss rate npv fals posit rate specif fals neg rate sensit matrix conting tabl object vector reciproc rmse rrmse rrmse calcul sqrtmeantargetpredict superior measur classif accuraci benchmark relationship degre estim take reciproc target predict degre result larger penalti egregi misclassif eg classifi firstdegre rel pair second degre misclassif distant relationship eg misclassifi fourthdegre rel pair fifthdegre adjust prevent divisionbyzero thdegre ident rel pair introduc illustr usag first take kinpair data randomli flip true relationship degre r function randomli flip level factor default randomflip functionx p ifelseruniflengthxp sampleuniquex x infer degre truthtarget use kindegre randomli flip setse kinpairs_inf kinpair dplyrmutatedegree_truthkindegreek max_degre dplyrmutatedegree_truthascharacterdegree_truth dplyrmutatedegree_truthtidyrreplace_nadegree_truth unrel dplyrmutatedegree_inferredrandomflipdegree_truth kinpairs_inf r confusion_matrixpredict kinpairs_inferreddegree_inf target kinpairs_inferreddegree_truth use purrrpluck isol conting tabl r confusion_matrixpredict kinpairs_inferreddegree_inf target kinpairs_inferreddegree_truth purrrpluckt option output tidi longertru format spread stat class r confusion_matrixpredict kinpairs_inferreddegree_inf target kinpairs_inferreddegree_truth longer true purrrpluckoth tidyrspreadclass valu dplyrrelocateaverag afterdplyrlast_col dplyrmutate_ifrlangis_doubl signif knitrkabl ibd segment analysi tool hapibdhapibd capabl infer share ibd segment individu skater packag includ function take ibd segment comput share genom centimorgan cm length convert share cm kinship coeffici addit infer segment function estim truth kinship data simul pedsimpedsim hapibd httpsgithubcombrowninglabhapibdoutputfil pedsim httpsgithubcomwilliamslabpedsimoutputibdsegmentsfil read_ibd function read pairwis ibd segment format input function either infer ibd segment hapibd sourcehapibd simul segment sourcepedsim first exampl use data hapibd output format r hapibd_fp systemfileextdata gbrsimibdgz packageskat mustworktru hapibd_seg read_ibdhapibd_fp sourc hapibd hapibd_seg order translat share genom cm length kinship coeffici must load genet map read_map softwar ibd segment infer simul requir genet map map load kinship estim one use creat share ibd segment output exampl use minim genet map creat min_mapmin_map ship skater min_map httpsgithubcomwilliamslabmin_map r gmapfil systemfileextdata sexspecavgminplinkmap packageskat mustworktru gmap read_mapgmapfil gmap ibdkin function take segment map file output tibbl one row per pair individu column individu id individu id kinship coeffici pair r ibd_dat ibdkinibd_datahapibd_seg mapgmap ibd_dat note ibd segment kinship estim perform simul segment packag includ exampl ibd data format r pedsim_fp systemfileextdata gbrsimseggz packageskat mustworktru pedsim_seg read_ibdpedsim_fp sourc pedsim pedsim_seg notabl pedsim differenti ibd ibd segment given ibd ibd segment weight differ kinship calcul account process exampl share ibd calcul separ ibd ibd typeibd typeibd respect combin result sum ibd ibd kinship coeffici get overal kinship coeffici r ibd_dat ibdkinibd_datapedsim_segibd mapgmap typeibd ibd_dat ibdkinibd_datapedsim_segibd mapgmap typeibd dplyrbind_rowsibd_datibd_dat dplyrgroup_byidid dplyrsummarisekinship sumkinship group drop gener roxygen edit hand pleas edit document ribdr nameibdkin aliasibdkin titlecomput kinship coeffici ibd segment usag ibdkinibd_data map type null argument itemibd_datatibbl ibd segment creat use linkskaterread_ibd function itemmaptibbl genet map data creat use linkskaterread_map function itemtypetyp ibd use kinship coeffici calcul must codeibd codeibd codenul ibd ibd treat default codenul valu tibbl three column enumer item id sampl identifi item id sampl identifi item kinship kinship coeffic deriv share segment descript function use retriev related measur ibd segment related valu return kinship coeffici detail input data pairwis ibd segment prepar via linkskaterread_ibd function intern loop chromosom use specifi genet map convert share segment genet unit function convert share length kinship coeffici sum eqnibd ibd note data read linkread_ibd codesourcepedsim return list separ tibbl ibd ibd segment current implement function requir run function independ ibd ibd segment summar ad correspond proport see exampl exampl pedsim_fp systemfileextdata gbrsimseggz packageskat mustworktru pedsim_seg read_ibdpedsim_fp sourc pedsim gmapfil systemfileextdata sexspecavgminplinkmap packageskat mustworktru gmap read_mapgmapfil ibd_dat ibdkinibd_datapedsim_segibd mapgmap typeibd ibd_dat ibdkinibd_datapedsim_segibd mapgmap typeibd dplyrbind_rowsibd_datibd_dat dplyrgroup_byidid dplyrsummarisekinship sumkinship group drop refer httpfacultywashingtonedusguyibd_relatednesshtml gener roxygen edit hand pleas edit document rutilsr namearrange_id aliasarrange_id titleord id across two column usag arrange_idsdata id id argument itemdataa tibbl two id column arrang itemidunquot name id column see exampl itemidunquot name id column see exampl valu tibbl id id rearrang alphanumer descript type data result index two identifi two differ column correspond data point emphpair observ eg may column call codeid codeid index tibbl possibl pair result sampl b c attempt join two tibbl codebycid id join fail sampl flip one dataset anoth eg one tibbl may ida idb idb ida function ensur id alphanumer first id alphanumer second see exampl exampl tibbletribbl id id result b l c l c b l tibbletribbl id id result b l c l b c l inner join fail idid dplyrinner_joind bycid id arrang id arrange_idsid id arrange_idsid id inner join dplyrinner_joinarrange_idsd id id arrange_idsd id id bycid id recurs two tibbl listd purrrmaparrange_id id id purrrreducedplyrinner_join bycid id gener roxygen edit hand pleas edit document ribdr nameinterpol aliasinterpol titleinterpol segment usag interpolateibd_bp chromgpo argument itemibd_bpbas pair ibd segment interpol itemchromgposgenet map data specif chromosom valu numer vector genet distanc share segment descript unexport helper use linkskateribdkin function interpol segment appli genet length segment inspir python code distribut brown lab hrefhttpfacultywashingtonedusguyibd_relatednesshtmldocument refer httpfacultywashingtonedusguyibd_relatednesshtml gener roxygen edit hand pleas edit document rreadr nameread_fam aliasread_fam titleread plinkformat fam file usag read_famfil argument itemfileinput file path valu tibbl contain column fam file descript read hrefhttpswwwcoggenomicsorgplinkformatsfamplinkformat fam file input codefil must six column enumer item famili id item individu id item father id item mother id item sex item affect statu exampl famfil systemfileextdata gensfam packageskat mustworktru fam read_famfamfil fam gener roxygen edit hand pleas edit document rconfusion_matrixr nameconfusion_matrix aliasconfusion_matrix titlecalcul variou statist confus matrix usag confusion_matrix predict target posit null preval null dnn cpredict target longer fals argument itempredictiona vector predict itemtargeta vector target valu itempositiveth posit class class set default codenul result use first level codetarget itemprevalencepreval rate default codenul itemdnnth row column header conting tabl return default predict row target column itemlongertranspos output long form default fals requir codetidyr itemoth paramet current use valu list tibbl associ statist possibl frequenc tabl list column first element class contain numer class singl nonnumer class eg unrel rmse reciproc target also return descript given vector predict target valu calcul numer statist interest modifi hrefhttpsgithubcommclarkconfusionmatrixmclarkconfusion_matrix detail return accuraci agreement statist see function find origin inspir codeconfusionmatrix function codecaret packag exampl predict c target c confusion_matrixpredict target posit setse predict samplelett replac true prob target samplelett replac true prob confusion_matrixpredict target predict crep rep rep target crep rep rep confusion_matrixpredict target confusion_matrixpredict target purrrpluckt confusion_matrixpredict target longertru confusion_matrixpredict target longertru purrrpluckoth tidyrspreadclass valu predict unrel class predict crep rep rep repunrel target crep rep rep repunrel confusion_matrixpredict target predict two unrel class predict crep rep repthird repunrel target crep rep repthird repunrel confusion_matrixpredict target refer kuhn johnson k appli predict model seealso codelinkcalc_accuraci codelinkcalc_stat gener roxygen edit hand pleas edit document rpedr nameplot_pedigre aliasplot_pedigre titleplot pedigre usag plot_pedigreep file null width height argument itempedlist pedigre object linkfamp itemfileoutput file path must end pdf itemwidthwidth output pdf itemheightheight output pdf valu return valu call side effect descript plot pedigre gener roxygen edit hand pleas edit document rreadr nameread_ibi aliasread_ibi titleread ibi coef output file usag read_ibisfil argument itemfileinput file path valu tibbl contain column ibi file descript read codeibi hrefhttpsgithubcomwilliamslabibisresult file input codefil must six column whitespac delimit enumer item id member item id member item kinship coeffici item ibd ratio ibdal snp item segment count item kinship degre exampl ibisfil systemfileextdata gensibiscoef packageskat mustworktru ibi read_ibisibisfil ibi gener roxygen edit hand pleas edit document rreadr nameread_map aliasread_map titleread genet map file usag read_mapfil argument itemfileinput file path valu tibbl contain column enumer item chr chromosom item valu genet length within physic posit boundari item bp physic posit boundari descript function read content genet map file translat physic distanc genet unit ie cm regardless sourc input file must sexaverag tabsepar plink format hrefhttpzzzbwhharvardeduplinkdatashtmlmapdocument follow four column header ie column name enumer item chromosom item identifi ignor coderead_map item length genet length within physic posit boundari item posit physic posit boundari column must order note first third fourth column use function detail genet map could come differ sourc one sourc hapmap map distribut brown lab hrefhttpbochetgccbiostatwashingtonedubeaglegenetic_mapsdocument map file use nonsex chromosom download concaten singl file followspreformattedwget httpbochetgccbiostatwashingtonedubeaglegenetic_mapsplinkgrchmapzip unzip plinkgrchmapzip cat chrgrchmap sort k k numericsort plinkallchrgrchmap anoth sourc sexspecif map bherer origin publish bherer et al recommend develop codepedsim simul ibd segment hrefhttpsgithubcomwilliamslabpedsimmapfiledocument retriev prep map file simulationpreformat get refin genet map extract wget nocheckcertif httpsgithubcomcbhererbherer_etal_sexualdimorphismrecombinationrawmasterrefined_genetic_map_btargz tar xvfpz refined_genetic_map_btargz format pedsim per httpsgithubcomwilliamslabpedsimmapfil printf chrtpostmale_cmtfemale_cmn sexspecpedsimmap chr past refined_genetic_map_bmale_chrchrtxt refined_genetic_map_bfemale_chrchrtxt awk v ofst nr print sed schr sexspecpedsimmap done clean rm rf refined_genetic_map_b codesexspecpedsimmap file readi use simul howev must averag reformat plink format use herepreformattedcat sexspecpedsimmap grep v awk v ofst print sexspecavgplinkmap genet map creat ten megabyt size rang trivial store system reduc version would increas portabl eas test minimum viabl genet map could use test instal packag data r packag exampl analysi read minimum viabl genet map item item blog post urlhttpshapidnaorgminimalviablegeneticmap item github repo python code urlhttpsgithubcomwilliamslabmin_map code written reduc averag sexspecif genet map posit x reductionpreformat get minmap script github wget httpsrawgithubusercontentcomwilliamslabmin_mapmainmin_mappi creat empti minmap echo n sexspecavgminplinkmap autosom chr echo work chromosom chr first pull one chromosom grep chrspace sexspecavgplinkmap tmpchr run python script chromosom genet map column rd column nd start physic posit last column base python min_mappi mapfil tmpchr chr chr genetcol physcol nohead error strip header reformat back plink format append minmap file cat min_viable_mapchrtxt grep v awk v ofst print sexspecavgminplinkmap clean rm f min_viable_mapchrtxt tmpchr done averag version bherer sexspecif map reduc minimum viabl genet map error plink format avail instal packag data see exampl use test code full genet map use analysi oper exampl gmapfil systemfileextdata sexspecavgminplinkmap packageskat mustworktru gmap read_mapgmapfil refer urlhttpzzzbwhharvardeduplinkdatashtmlmap urlhttpbochetgccbiostatwashingtonedubeaglegenetic_map urlhttpsgithubcomwilliamslabpedsimmapfil urlhttpswwwnaturecomarticlesncomm urlhttpswwwnaturecomarticlesncomm urlhttpsgithubcomcbhererbherer_etal_sexualdimorphismrecombin gener roxygen edit hand pleas edit document rconfusion_matrixr namecalc_stat aliascalc_stat titlecalcul variou statist confus matrix usag calc_statstabbl preval null posit argument itemtabblea frequenc tabl creat codelinkt itemprevalencepreval valu default codenul itempositiveposit class itemoth current use valu tibbl present column sensit specif ppv npv f score detect rate detect preval balanc accuraci fdr fpr fnr class statist provid class descript given frequenc tabl predict versu target valu calcul numer statist interest detail use within confusion_matrix calcul variou confus matrix metric call codeconfusion_matrix want simpli suppli tabl suppos x tabl notat tabularrcc tab target tab cr predict tab event tab event cr event tab tab b cr event tab c tab cr formula use deqnsensit aac deqnspecif dbd deqnpreval acabcd deqnposit predict valu sensit prevalencesensitivitypreval specificitypreval deqnneg predict valu specif prevalencesensitivitypreval specificitypreval deqndetect rate aabcd deqndetect preval ababcd deqnbalanc accuraci sensitivityspecif deqnprecis aab deqnrecal aac deqnf harmon mean precis recal betaprecisionrecallbeta precisionrecal codebeta function deqnfals discoveri rate posit predict valu deqnfals omiss rate neg predict valu deqnfals posit rate specif deqnfals neg rate sensit deqnd qnormsensit qnorm specif deqnauc pnormdsqrt see refer discuss first five formula abbrevi describ itemposit predict valu ppv itemneg predict valu npv itemfals discoveri rate fdr itemfals omiss rate itemfals posit rate fpr itemfals neg rate fnr note differ name use statist describ itemsensit true posit rate recal hit rate power itemspecif true neg rate itemposit predict valu precis itemfals neg rate miss rate type ii error rate beta itemfals posit rate fallout type error rate alpha function call codeconfusion_matrix want simpli suppli tabl function refer kuhn build predict model r use caret packag emphjourn statist softwar urlhttpswwwjstatsoftorgarticleviewvi altman dg bland jm diagnost test sensit specif emphbritish medic journal vol altman dg bland jm diagnost test predict valu emphbritish medic journal vol velez dr et al balanc accuraci function epistasi model imbalanc dataset use multifactor dimension reduct emphgenet epidemiolog vol author michael clark see hrefhttpsgithubcommclarkconfusionmatrixmclarkconfusion_matrix gener roxygen edit hand pleas edit document rreadr nameread_ibd aliasread_ibd titleread ibd segment file usag read_ibdfil sourc argument itemfileinput file path itemsourcesourc input file must one codehapibd codepedsim valu codesourcehapibd tibbl return codesourcepedsim list two tibbl element codeibd codeibd return codehapibd tibbl two codepedsim tibbl contain six column enumer item id sampl identifi item id sampl identifi item chr chromosom item start segment bp start coordin item end segment bp end coordin item length share segment length genet unit cm descript read infer ibd segment codehapibd hrefhttpsgithubcombrowninglabhapibdoutputfilesdocument ibd segment file gener codepedsim hrefhttpsgithubcomwilliamslabpedsimoutputibdsegmentsfiledocument read codehapibd segment file input data follow column enumer item first sampl identifi item first sampl haplotyp index item second sampl identifi item second sampl haplotyp index item chromosom item base coordin first marker segment item base coordin last marker segment item cm length ibd segment read codepedsim segment file input data follow column enumer item first sampl identifi item second sampl identif item chromosom item physic posit start item physic posit end item ibd type item genet posit start item genet posit end item genet length end start exampl hapibd_fp systemfileextdata gbrsimibdgz packageskat mustworktru hapibd_seg read_ibdhapibd_fp sourc hapibd pedsim_fp systemfileextdata gbrsimseggz packageskat mustworktru pedsim_seg read_ibdpedsim_fp sourc pedsim refer urlhttpsgithubcombrowninglabhapibdoutputfil urlhttpsgithubcomwilliamslabpedsimoutputibdsegmentsfil gener roxygen edit hand pleas edit document rutilsr namekindegre aliaskindegre titlekinship coeffici degre usag kindegreek max_degre l argument itemkkinship coeffici numer typic although king produc valu itemmax_degreemax degre resolut default use seed linkdibbledibbl anyth infer rang codemax_degre report codena see linkdibbledibbl valu vector infer degre maximum degre codedibbl anyth distant codena ie unrel descript infer relationship degre given kinship coeffici exampl kindegre kindegre kindegre kindegre kindegre kindegre max_degre kindegre k seq kindegreek kindegreek max_degre tibbletibblekk dplyrmutatedegreekindegreek gener roxygen edit hand pleas edit document rreadr nameread_akt aliasread_akt titleread akt kin output file usag read_aktfil argument itemfileinput file path valu tibbl contain column akt file descript read verbakt kin hrefhttpsilluminagithubioaktkinresult file input codefil must seven column whitespac delimit enumer item id member item id member item ibd ratio ibdal snp item ibd ratio ibdal snp item kinship coeffici item nsnp exampl aktfil systemfileextdata gensakt packageskat mustworktru akt read_aktaktfil akt gener roxygen edit hand pleas edit document rutilsr namekincm aliaskincm titlekinship coeffici cm usag kincmk argument itemkkinship coeffici numer typic although king produc valu valu vector numer estim cm rang descript convert kinship coeffici put scale share cm use formula eqncm pmin pmax k exampl kincm kincm kincm dibbl dplyrmutatecmkincmk refer urlhttpsdnapaintercomtoolssharedcmv urlhttpswwwancestrycomdnaresourcewhitepaperancestrydnamatchingwhitepaperpdf urlhttpsverogencomwpcontentuploadssnptypinguaskinshipestimationgedmatchprotechnotevdapdf gener roxygen edit hand pleas edit document rpedr namefamp aliasfamp titlefam pedigre usag fampedfam argument itemfama tibbl six column plink fam data read linkread_fam valu tibbl new listcol codep contain pedigre codekinshippedigre descript convert hrefhttpswwwcoggenomicsorgplinkformatsfamplinkformat fam file pedigre object use linkkinshippedigreekinshippedigre exampl famfil systemfileextdata gensfam packageskat mustworktru fam read_famfamfil fampedfam gener roxygen edit hand pleas edit document rutilspip name alia titlepip oper usag lh rh descript see verbmagrittrmagrittrpip detail keywordintern gener roxygen edit hand pleas edit document rpedr namepedkinpair aliaspedkinpair titlepedigre pairwis kinship usag pedkinpairp argument itempeda pedigre class object linkfampedfamp valu tibbl contain pairwis kinship coeffici input pedigre descript convert pedigre class object linkfampedfamp pairwis list relationship expectedtheoret kinship coeffici exampl famfil systemfileextdata gensfam packageskat mustworktru famfil read_fam famp dplyrmutatekinpairspurrrmap pedkinpair dplyrselectfid kinpair tidyrunnestcolskinpair gener roxygen edit hand pleas edit document rconfusion_matrixr namecalc_accuraci aliascalc_accuraci titlecalcul accuraci usag calc_accuracytabbl argument itemtabblea frequenc tabl creat codelinkt valu tibbl correspond statist descript calcul accuraci relat metric detail calcul accuraci lower upper bound guess rate pvalu accuraci vs guess rate function call codeconfusion_matrix want simpli suppli tabl function seealso codelinkbinomtest author michael clark see hrefhttpsgithubcommclarkconfusionmatrixmclarkconfusion_matrix gener roxygen edit hand pleas edit document rreadr nameread_plink_k aliasread_plink_k titleread plink king tabl usag read_plink_kingfil argument itemfileinput file path valu tibbl contain column codeplink makekingt output descript read output codeplink makekingt hrefhttpswwwcoggenomicsorgplinkdistancemake_kingdocument input codefil must six column tab delimit enumer item id member item id member item nsnp item hethet proport site heterozyg item k kinship coeffici exampl plinkkingfil systemfileextdata plinkkingtabletsv packageskat mustworktru plink read_plink_kingplinkkingfil plink plink dplyrfilterk refer urlhttpswwwcoggenomicsorgplinkdistancemake_k gener roxygen edit hand pleas edit document rskaterpackag doctypepackag nameskaterpackag aliasskat aliasskaterpackag titleskat util snpbase kinship analysi descript util singl nucleotid polymorph snp base kinship analysi test evalu skater packag contain function import pars analyz pedigre data perform relationship degre infer benchmark relationship degre classif summar ident descent ibd segment data packag function method describ turner et al skater r packag snpbase kinship analysi test evalu doi seealso use link item item urlhttpsgithubcomsignaturescienceskat item report bug urlhttpsgithubcomsignaturescienceskaterissu author strongmaintain stephen turner emailvustephengmailcom hrefhttpsorcidorgorcid author item item matthew scholz hrefhttpsorcidorgorcid item vp nagraj hrefhttpsorcidorgxorcid contributor item item signatur scienc llc copyright holder keywordintern gener roxygen edit hand pleas edit document rutilsr namedibbl aliasdibbl titledegre tibbl usag dibblemax_degre l argument itemmax_degreeth distant degre want measur usual default valu tibbl contain degre expect kinship coeffici codek lower codel upper codeu infer bound descript creat tibbl degre expect kinship coeffici infer boundari row creat codemax_degre addit row relationship distant codemax_degre codedegre valu final row codena repres infer criteria unrel individu see exampl exampl dibbl dibbl