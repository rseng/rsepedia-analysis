version ad ignorenh option allow inclus multimapp normal exclud nh flag version ad minconversioneffici option allow filter incomplet convert align fli note gener recommend issu fix variou segfault issu relat mappabl filter courtesi valiec version fix issu perread subcommand wherein requireflag option didnt fulli work read would pass least one requir flag set rather issu version rewrot readpair overlap handl perform use constructordestructor mechan htslib instead use intern htslib structur function allow support newer htslib version current test work version due chang pileup constructor interfac issu version fix issu methyldackel mbia due uniniti valu issu version fix issu cytosine_report option report chromosom name could wrong input bam file spars multipl thread use issu libbigwig extern depend need handl binari bismap format ad support filter read accord binari bismap file see herehttpsgithubcomdpryanmethyldackelblobmasterbbm_specificationmd detail code contribut valiec bwlang new england biolab version switch extern htslib current compat htslib version latest one time releas ad perread option use httpswwwbiorxivorgcontentv remov maxdepth option longer requir fix issu keepdup flag chang ignoreflag fix issu confid interv longer extend outsid version ad nob nctot nctob relat ot similar differ specifi number base ignor regardless read length result base either end read ignor version methylkit option output methyl valu rather correct version chang packag name pileometh methyldackel unfortun temporari pileometh name stuck around long fix plot sometim plot line escap bound graph caus read ignor graph bound comput ad requireflagsr option equival f option samtool default requir noth version ad ignoreflagsf option equival f option samtool default xf ignor duplic qc fail secondari supplement align version fix handl hardclip base caus segfault version mindepthd option actual recogn sorri version ad versionv option fix hhelp option actual wasnt recogn ad mindepth option fix handl xg auxiliari tag sinc align bismark use differ purpos singl biggest annoy custom auxiliari tag version ad methylkit option ad autom test make test version fix compil issu clang version bed file sort properli extract noth skip entir bed file isnt iter there overlap significantli speed thing first align overlap given bed interv longer ignor version fix bug mergecontext option sometim result incorrect mergin duplic line version htslib longer submodul instead version directli includ enabl easier integr galaxi version fix bug getstrand handl se align incorrectli version ad mergecontext option pileometh extract ad pileometh mergecontext command use default output ad file header line output file modifi accord presenc logit fraction count version fix mistak makefil prefix use rather path ad logit count fraction option thank tim trich version document output format readmemd convert th column output file contain methyl level rather version first actual releas code seem stabl enough usabl bbm binari bismap format specif bbm binari format store singl data track genom main restrict store integ valu rang inclus result fact use store bismap precent mappabl fall rang howev data track convert discret integ valu could store format format achiev small file size runlength compress data maximum runlength encod one unit base longer run encod sequenc shorter run test bismap human genom mappabl dataset format achiev compress ratio approxim format follow format overview bracket item explain angl bracket item simpli marker begin end file item curli brace contain item explain section begin fileversionchromcountchrom recordchrom recordchrom recordchrom recordend file version unsign charact denot version bbm format use file version describ id chromcount unsign littleendian bit integ reprens number chromosom file chrom record store data given chromosom discuss chromosom record chromosom record store name chromosom valu data track chromosom structur follow namelengthchromnamenulchromlengthchrom data namelength unsign littleendian bit integ reprens number charact chromosom name includ null termin chromnam sequenc bit ascii charact repres name chromosom nul byte function null termin name presenc null termin use error check chromlength unsign littleendian bit integ reprens number base chromosom chrom data store valu data track chromosom discuss chromosom data bbm format store runlengthcompress data singl data track chromosom valu includ run repres valu inclus singl byte run repres two format short run length inclus store two byte long run length inclus store four byte valu marker long run use individu valu length marker short run format simpli seri individu valu short run long run posit store explicitli first valu posit chromosom success valu consecut posit end last valu posit chromlength specif end marker chromosom end chromlength valu list individu valu store singl unsign byte contain valu rang inclus repres valu data track posit short run length repres follow runlengthrunvalu runlength singl unsign byte store valu rang inclus repres run length plu ie repres run length run repes run state must contain valu reason detail section long run runvalu singl unsign byte store run valu long run length repres four byte follow runlengthrunvalu flag indic long run reason use short run sinc presenc start run data indic long run runlength littleendian bit unsign integ repres length run runvalu unsign byte contain run valu master build statushttpstravisciorgdpryanmethyldackelsvgbranchmasterhttpstravisciorgdpryanmethyldackel galaxi installationhttpsimgshieldsiobadgeinstall_withgalaxybrightgreensvgstyleflatsquarehttpstoolshedgbxpsuedu biocondabadgehttpsimgshieldsiobadgeinstallwithbiocondabrightgreensvgstyleflatsquarehttpbiocondagithubio img alignleft srcmethyldackellogopng methyldackel formerli name pileometh temporari name deriv due use pileup extract methyl metric process coordinatesort index bam cram file contain form bsseq align extract perbas methyl metric methyldackel requir index fasta file contain refer genom well prerequisit c compil gcc htslib least version earlier version compat libbigwig requir libbigwig static librari use compil compil instal perform via git clone httpsgithubcomdpryanmethyldackelgit cd methyldackel make libbigwigsomepathtolibbigwiga make instal prefixsomeinstallationpath linker issu find htslib header librari specifi use cflag lib make instal cflagso wall isomepathinclud libslsomepathlib prefixsomeinstallationpath libbigwigsomepathtolibbigwiga licens softwar licens term mit licens see licens file pleas feel free redistribut accord term methyl context methyldackel group cytosin one three sequenc context cpghttpenwikipediaorgwikicpg_sit chg chh h iupac ambigu code nucleotid g n encount refer sequenc context assign chg chh appropri eg cng would categor chg context cnc chh context cytosin close enough end chromosomecontig context cant infer categor chh eg cytosin last base chromosom consid chh context usag basic usag methyldackel follow methyldackel extract reference_genomefa alignmentsbam calcul perbas cpg metric output alignments_cpgbedgraph standard bedgraph file column number readsread pair evid methyl c given posit column equival unmethyl c altern output filenam prefix specifi some_new_prefix option default methyldackel calcul metric cytosin cpg context metric chg chh context support well see chh chg option would like ignor cytosin cpg simpli specifi nocpg type metric output differ file percpg andor perchg rather percytosin metric see percpgchg metric methyldackel filter read base accord mapq phred score respect default minimum mapq phred though chang q p option methyldackel also account methyl bia describ ot ob ctot ctob option given bigwig bismap mappabl data use option methyldackel also filter read mappabl score low support methyl call default set read would reject less base mappabl ge configur b option mappabl data also read bbm file bbm file short binari bismap custom compress version data bigwig use methyldackel read much faster bigwig take less disk space file creat specifi n option run methyldackel extract read use b option instead note overlap read commonli ask import question pairedend read overlap treat two mate pairedend experi happen overlap cpg one could get skew result methyl statu taken read rather one ie doubl count pairedend read bad idea methyldackel written mind default pairedend read overlap never doubl count use note implement intern sinc relat p option sake exampl suppos two mate overlap given posit exampl well specifi mate base call phred score posit mate base phred score base call agre one lower score mate score set read base score mate score increas sinc p option default skip mate count read base call instead disagre process complic total four possibl could work mate higher phred score base call n phred score decrement mate exampl would new phred score phred score mate set mate higher phred score base call n case procedur follow mate phred score decrement mate phred score set mate higher phred score base call n case phred score mate set mate ident phred score case phred score set import think possibl conjunct p option two mate agre individu low qualiti base call may combin produc base call accept qualiti similarli two mate high qualiti base call disagre result could combin base call low qualiti due disagr actual prodcedur samtool mpileup use intern your familiar variant call samtool methodolog reason ident singl cytosin methyl metric extract methyldackel extract produc variant bedgraphhttpgenomeucscedugoldenpathhelpbedgraphhtml that similar coverag file produc bismarkhttpwwwbioinformaticsbabrahamacukprojectsbismark bisonhttpsgithubcomdpryanbison short line consist tab separ column chromosomecontigscaffold name start coordin end coordin methyl percentag round integ number alignmentspair report methyl base number alignmentspair report unmethyl base coordin base half open conform bedgraph definit pairedend read align often occur align overlap case methyldackel count read pair output would lead incorrect downstream statist result exampl output track typebedgraph descriptionsrrsort cpg methyl level note header line start track descript field use label program igvhttpwwwbroadinstituteorgigv subsequ line describ singl cytosin th th base chromosom respect first posit align pair align indic methyl indic unmethyl methyl second posit align support methyl unmethyl methyl percpgchg metric mani circumst desir metric individu cytosin cpg merg produc percpg metric rather percytosin metric accomplish mergecontext option methyldackel extract use output track typebedgraph descriptionsrrsort cpg methyl level chang track typebedgraph descriptionsrrsort merg cpg methyl level also work chglevel metric bedgraph file contain percytosin metric alreadi exist convert instead contain percpgchg metric methyldackel mergecontext exclud lowcoverag region downstream analysi requir absolut minimum coverag defin number methyl call kept filter mapq phred score etc use mindepth option achiev default methyldackel extract output methyl metric long coverag least use mindepth site cover least x output work conjunct mergecontext option request percpg context output ie mergecontext mindepth cpg minimum coverag output exclud partial convert read user wish filter read evid incomplet bisulfit convers determin look chh chgcontext cytosin read determin methyl state filter gener avoid sinc region genom least chh chgcontext cytosin methyl would caus excess filter region howev absolut need filter partiallyconvert align minconversioneffici option default mean chh chgcontext cytosin convers statu ignor maximum valu mean chh chgcontext cytosin align must convert note align chh chgcontext cytosin given convers effici logit fraction count output standard output describ modifi suppli fraction count logit option methyldackel extract fraction option essenti produc first column standard output describ differ rang th column instead instead produc file end simpli bedgraph one end methbedgraph instead produc count option produc first three column standard output follow column total coverag count last column equival sum th th column standard output result file end countsbedgraph rather simpli bedgraph logit option produc first three column standard output follow logit transform methyl fraction logit transform logmethyl fractionmethyl fraction note log use base e logit transform methyl valu rang infin rather result file end logitbedgraph rather simpli bedgraph note option may combin mergecontext howev methyldackel mergecontext use fact combin methylkitcompat output methylkit format produc methylkit option merg cs cpg chg forbidden format likewis option mutual exclus logit et al exclud like variant site sampl genet homogen sometim advantag exclud like variant site methyl extract exampl sinc unmethyl cs read ts extract methyl posit ct mutat caus incorrect result case opposit strand rather g nonvari case would g regardless methyl statu methyldackel track number nong strand opposit cs refer sequenc fraction exce maxvariantfrac option posit exclud output exclud case maxvariantfrac valu exceed due low coverag opposit strand must depth coverag least minoppositedepth note default valu minoppositedepth indic variant site exclus process skip note one addit specifi mergecontext given cpg chg exclud output either individu cs would exclud given specifi minoppositedepth maxvariantfrac methyl bia plot correct ideal experi expect probabl observ methyl c constant across length given read practic howev often increasesdecreas observ methyl rate end read andor global chang term methyl bia includ region extract methyl metric result noisier less accur data reason user strongli encourag make methyl bia plot methyldackel come function purpos methyldackel mbia reference_genomefa alignmentssortedbam output_prefix command creat methyl bia mbia short plot strand valid align command take almost option methyldackel extract your interest look singl region chh chg metric run methyldackel mbia h full list option result mbia graph svg format view modern web browser exampl svg imagehttpsrawgitcomdpryanmethyldackelmasterexample_otsvg pairedend data read pair shown separ case program suggest region inclus ot mark plot applic format output describ methyldackel extract h suggest accept blindli user strongli encourag look tweak actual bound appropri line indic averag methyl percentag given posit shade region confid interv around use gaug mani methyl call given posit rel neighbor note spike methyl end read correspond dip begin read common region ignor suggest trim bound note also number refer first last base includ methyl extract last first base ignor align trim protocol use trim x base one end align regardless length one use nob nctot nctob option format similar mention ot et al differ one specifi number base rather posit within align thu ignor base either end align origin top ot strand one would specifi thu irrelev long align outermost base alway ignor note specifi bound longer given align eg pair base long align caus error ignor align default align mark secondari bit fail qc bit pcroptic duplic bit supplement bit mapq ignor reason default chang expert user need chang behaviour pleas see f ignoreflag q option methyldackel mbia methyldackel extract note pcr optic duplic includ enrichmentbas librari prepar like rrb case vital use keepdup option read map uniqu locat genom may contain methyl inform multipl loci add nois methyl call use mappabl bigwig elimin read uniqu place note mapq alon insuffici identifi read specifi bigwig file contain lowmappabilti region eg bismaphttpshgdownloadsoeucscedugbdbhghoffmanmappabilitykbismapmultitrackmappabilitybw use featur minmappablebas mappabilitythreshold use finetun filter faster execut bigwig file compact bbm file use outputbbmfil use via mappabilitybb perread metric version methydackel provid perread subcommand produc perread cpg methyl level use stamenova et alhttpsdoiorg hiculfit method output tabsepar file follow field read name chromosom posit cpg methyl number inform base fragment longer kb current handl correctli cite methyldackel immedi plan methyldackel public use methyldackel pileometh formerli known research pleas simpli cite url repositori github