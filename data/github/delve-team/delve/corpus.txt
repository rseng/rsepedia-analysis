titl delv neural network featur varianc analysi tag python deep learn machin learn satur pytorch ai author name justin shenkcofirst author orcid affili name mat l richtercofirst author affili orcid name wolf byttner affili orcid affili name visiolab berlin germani index name institut cognit scienc univers osnabrueck osnabrueck germani index name rapid health london england unit kingdom index date august bibliographi paperbib summari design neural network complex task deep neural network often refer black box model littl insight function approxim gain look structur layer output delv tool look neural network repres data represent featur chang throughout train tool enabl deep learn research understand limit suggest improv design network remov ad layer sever tool exist allow analyz neural network train techniqu character focu either data model well level abstract exampl abstract modelori techniqu tool analyz sharp local optima keskarsensitivitygoogl indic gener capabl train model scenario complex dataset model reduc error surfac allow insight differ differ setup less abstract datacentr techniqu gradcam selvaraju et al gradcamgradcamplusplu reduc model set classactiv map overlay individu data point get intuit understand infer process svcca svccasvcca consid modelcentr middl ground term abstract sinc allow compar analysi featur extract specif layer svcca also relev function perspect work sinc use singular valu decomposit core techniqu obtain analysi result anoth modelcentr tool allow layerbylay analysi logist regress probe alain util logist regress train output hidden layer measur linear separ data thu qualiti intermedi solut qualiti classifi model latter great import work sinc logist regress probe often use compar model identifi contribut layer overal perform featurespacesizemattersgoingdeep demonstr satur metric capabl show parameterineffici neural network architectur howev aforement tool signific limit term use practic applic scenario tool use improv perform given model case datacentr tool like gradcam solut propag back data make hard deriv decis regard neural architectur howev biggest concern aforement tool cost comput resourc integr analysi workflow deep learn practition tool like svcca logist regress probe requir complex comput expens procedur need conduct train natur limit techniqu small benchmark primarili academ dataset like cifar featurespac analysi tool use develop deep learningbas model need abl use littl comput workflow overhead possibl ideal analysi done live train progress allow research interrupt potenti longrun train session improv model satur propos shenkthesi later refin featurespac analysi techniqu known author capabl allow identifi parameterineffici setup featurespacesizemattersgoingdeep make satur usabl applic scenario necessari provid easytous framework allow integr tool normal train infer code minim invas chang also necessari comput analysi done onlin part regular forward pass model make integr seamless possibl numer comparison variou method promis avenu futur research model introspect delv tool extract inform base covari matrix data like satur intrins dimension neural network layer emphas practic usabl special attent place low overhead minim invas integr delv exist train infer setup delv hook directli pytorch pytorch model extract necessari inform littl comput memori overhead thank effici covari approxim algorithm enabl user store analyz extract statist without chang current experi workflow make delv easi integr monitor system make interfac easi expand allow user util prefer way monitor experi simpl csvfile folder structur sophist solut like tensorboard tensorflowwhitepap comprehens sourc document provid homepag httpdelvedocsreadthedocsiodelvedocsreadthedocsio statement need research spectral properti neural network represent explod recent year svccasvccagradcamkernelpcaalainfeatureattribut public like svcca featurespac demonstr use interest inform extract spectral analysi latent represent also shown metric like satur shenkthesisspectralanalysi use optim neural network architectur identifi patholog pattern hint ineffici neural network structur main purpos delv provid easi flexibl access type layerbas statist combin eas usag extens delv enabl excit scientif explor machin learn research engin delv alreadi use number scientif public featurespacesizemattersgoingdeep sourc code delv archiv zenodo link doi zenodo overview librari softwar structur sever modul distribut task full detail avail httpsdelvedocsreadthedocsio tensorboardx summarywrit tensorflowwhitepap use effici save artifact like imag statist train minim interrupt varieti layer featur statist observ statist intrins dimension layer satur intrins dimension divid featur space dimension covariancematrix determin covari matrix also known gener varianc trace covari matrix measur varianc data trace diagon matrix anoth way measur dispers data layer satur intrins dimension divid featur space dimension sever layer current support convolut linear lstm addit layer pytorch convtranspos plan futur develop see issu httpsgithubcomdelveteamdelveissu eigendecomposit featur covari matrix comput satur relat metric like intrins dimension requir covari matrix layer output comput covari matrix layer output train evalu set impract naiv sinc would requir hold entir dataset memori would also contradict goal seamless integr exist train loop commonli oper minibatch therefor batchwis approxim algorithm use comput covari matrix onlin train comput covari two variabl use covari approxim algorithm two random variabl x n sampl qx fracsumn_i x_i y_in fracsumn_i x_i sumn_i y_in x_i y_i individu observ respect random variabl x n total number sampl advantag method number seen sampl sum squar sum variabl need store make memori consumpt per layer constant respect size dataset comput qx possibl combin featur obtain covari matrix layer output qz_l z_l z_l layer output entir dataset parallel comput featur combin exploit shape layer output matrix a_l layer l comput sumn_i x_i y_i featur combin layer l calcul run squar sumb_ba_lbt a_lb batch output matric a_lb b b b batch replac fracsumn_i x_i sumn_i y_in outer product bara_l bigotim bara_l sampl mean bara_l run sum output z_lk k n train time divid total number train sampl n formula batchwis approxim covari matrix written like qz_l z_l fracsumb_ba_lbt a_lbn bara_l bigotim bara_l batchwis updat algorithm allow us integr approxim covari matrix part regular forward pass train evalu algorithm use threadsaf common valu store singl comput devic node furthermor allow updat covari matrix asynchron network train distribut manner avoid problem caus round error numer instabl implement algorithm convert default data bit floatingpoint valu default anoth challeng dimension data convolut layer simpl flatten data vector would result high dimension vector comput expens singular valu decomposit direct consequ address issu treat everi kernel posit individu observ turn thdegre outputtensor shape sampl height width filter matrix shape sampl cdot height cdot width filter advantag strategi inform lost keep dimension q manag size option reduc comput requir featur map automat reduc size use linear interpol constant maximum height width sinc inform lost process disabl approxim method describ alongsid satur metric work shenkthesisspectralanalysi refin featurespac refer add lstm vae support fix bug due incomplet merg add support convolut layer add ipython notebook support add tqdm output first commit delv deep live visual evalu logo pypi version test codecovio licens mit doi delv python packag analyz infer dynam model imag httpsrawgithubusercontentcomjustinshenkplaygroundmastersaturation_demogif alt playground use delv need lightweight pytorch extens give insight infer dynam architectur allow optim adjust neural network model dataset without much trial error allow analyz eigenspac data differ stage infer provid basic tool experi log motiv design deep neural network trial error heavi process mostli revolv around compar perform metric differ run one key issu develop process result metric realli propag back easili concret design improv delv provid spectral analysi tool allow investig infer dynam evolv model train allow spot underutil unus layer mismatch object size neural architectur among ineffici observ propag back directli design chang architectur even model fulli converg allow quicker guid design process work close relat maithra raghu googl brain et al work svcca maithra raghu differ wide deep network youtub httpsyoutubeupopu_et_ svccasingular vector canon correl analysi deep learn interpret arxiv httpsarxivorgabs_ instal code bash pip instal delv use layer satur improv model perform satur metric core featur delv default satur valu comput convolut lstm dens layer network satur describ percentag eigendirect requir explain varianc simpli speak tell much data fill individu layer insid model imag see satur portrait ineffici neural network depict model resnet train pixel imag way small model recept field exceed pixel final layer imag httpsrawgithubusercontentcomdelveteamdelvemasterimagesresnetpng alt resnetpng visual poorli chosen input resolut infer train logist regress output everi layer solv task model clearli see first half model best improv intermedia solut logist regress probe layer follow contribut noth qualiti predict also see satur extremli low layer call tail remov either increas input resolut econom reduc recept field size match object size dataset figur httpsrawgithubusercontentcomdelveteamdelvemasterimagesresnetbetterpng alt resnetbetterpng remov first two downsampl layer quarter growth recept field network reduc number paramet also make use avail paramet make layer contribut effectivli detail check public topic spectral analysi latent represent httpsarxivorgabs__ featur space satur train httpsarxivorgabs__ input size matter cnn classifi httpslinkspringercomchapter___ go deeper optim convolut neural network without train httpsarxivorgabs__ go flow distribut inform process multipath network soon demo code python import torch delv import saturationtrack torchcuda import is_avail torchnn import crossentropyloss torchvisiondataset import cifar torchvisiontransform import totensor compos torchutilsdatadataload import dataload torchoptim import adam torchvisionmodelsvgg import vgg setup comput devic tqdm import tqdm __name__ __main__ devic cuda is_avail els cpu get data train_data cifarroottmp traintru downloadtru transformcomposetotensor test_data cifarroottmp trainfals downloadtru transformcomposetotensor train_load dataloadertrain_data batch_siz shuffletru num_work pin_memorytru test_load dataloadertest_data batch_siz shufflefals num_work pin_memorytru instanti model model vggnum_classestodevic instanti optim loss optim adamparamsmodelparamet criterion crossentropylosstodevic initi delv tracker saturationtrackermy_experi save_toplotcsv modulesmodel devicedevic begin train epoch rang modeltrain imag label tqdmtrain_load imag label imagestodevic labelstodevic predict modelimag optimizerzero_gradset_to_nonetru torchcudaampautocast output modelimag _ predict torchmaxoutputsdata loss criterionoutput label lossbackward optimizerstep total test_loss correct modelev imag label tqdmtest_load imag label imagestodevic labelstodevic output modelimag loss criterionoutput label _ predict torchmaxoutputsdata total labelss correct torchsumpredict labelsitem test_loss lossitem add addit metric want keep track trackeradd_scalaraccuraci correct total trackeradd_scalarloss test_loss total add satur mix trackeradd_satur close tracker finish train trackerclos support layer denselinear lstm convolut citat use delv public pleas cite codeblock txt softwaredelv author justin shenk mat l richter wolf byttner michał marcinkiewicz titl delveteamdelv latest month aug year publish zenodo version v doi zenodo url httpsdoiorgzenodo name delv delv verb reach insid receptacl search someth carri intens thorough research data inform like logo imag httpsgithubcomdelveteamdelveblobmasterimagesdelve_logopng pypi version imag httpsbadgefuryiopydelvesvg target httpsbadgefuryiopydelv test imag httpsgithubcomdelveteamdelveactionsworkflowstestsyamlbadgesvg target httpsgithubcomdelveteamdelveactionsworkflowstestsyaml codecovio imag httpscodecoviogithubdelveteamdelvecoveragesvgbranchmast target httpscodecoviogithubdelveteamdelvebranchmast licens mit imag httpsimgshieldsiobadgelicensemitbluesvg target httpsopensourceorglicensesmit doi imag httpszenodoorgbadgesvg target httpszenodoorgbadgelatestdoi example_kera modul automodul example_kera member undocmemb showinherit example_fc modul automodul example_fc member undocmemb showinherit example_deep modul automodul example_deep member undocmemb showinherit exampl modul automodul exampl member undocmemb showinherit example_lstm_class_a modul automodul example_lstm_class_a member undocmemb showinherit example_lstm_generative_va modul automodul example_lstm_generative_va member undocmemb showinherit contribut delv contribut guidelin larg copi geopanda httpsgeopandasreadthedocsioenlatestcontributinghtml_ overview contribut delv welcom like accept quickli follow guidelin stage delv develop prioriti defin simpl usabl stabl api clean maintain readabl code perform matter expens goal gener delv follow convent panda project applic particular submit pull request exist test pass pleas make sure test suit pass local github action httpsgithubcomdelveteamdelveactionsworkflowstestsyaml_ statu github action visibl pull request new function includ test pleas write reason test code make sure pass pull request class method function etc docstr first line docstr standalon summari paramet return valu ducument explicitli delv support python use modern python idiom possibl follow pep possibl import group standard librari import first rdparti librari next delv import third within group import alphabet alway use absolut import possibl explicit rel import local import necessari test seven step contribut seven basic step contribut delv fork delv git repositori creat develop environ instal delv depend make develop build delv make chang code add test updat document submit pull request step detail fork delv repositori use git new user work git one daunt aspect contribut delv quickli becom overwhelm stick guidelin help keep process straightforward mostli troubl free alway difficulti pleas feel free ask help code host github httpsgithubcomdelveteamdelve_ contribut need sign free github account httpsgithubcomsignupfree_ use git httpgitscmcom_ version control allow mani peopl work togeth project great resourc learn git softwar carpentri git tutori httpswcarpentrygithubiogitnovice_ atlassian httpswwwatlassiancomgittutorialswhatisversioncontrol_ github help page httphelpgithubcom_ matthew brett pydagogu httpmatthewbrettgithubcompydagogue_ get start git github instruct httphelpgithubcomsetupgitredirect__ instal git set ssh key configur git step need complet work seamlessli local repositori github _contributingfork fork need fork work code go delv project page httpsgithubcomdelveteamdelve_ hit fork button want clone fork machin git clone gitgithubcomyourusernamedelvegit delveyournam cd delveyournam git remot add upstream gitgithubcomdelveteamdelvegit creat directori delveyournam connect repositori upstream main project delv repositori test suit run automat travisci pull request submit howev wish run test suit branch prior submit pull request travisci need hook github repositori instruct httpabouttravisciorgdocsusergettingstarted__ creat branch want master branch reflect productionreadi code creat featur branch make chang exampl git branch shinynewfeatur git checkout shinynewfeatur simplifi git checkout b shinynewfeatur chang work directori shinynewfeatur branch keep chang branch specif one bug featur clear branch bring delv mani shinynewfeatur switch use git checkout command updat branch need retriev chang master branch git fetch upstream git rebas upstreammast replay commit top latest delv git master lead merg conflict must resolv submit pull request uncommit chang need stash prior updat effect store chang reappli updat _contributingdev_env creat develop environ develop environ virtual space keep independ instal delv make easi keep stabl version python one place use work develop version may break play code anoth easi way creat delv develop environ follow instal either anaconda httpdocscontinuumioanaconda_ miniconda httpcondapydataorgminicondahtml_ make sure refclon repositori contributingfork cd delv sourc directori tell conda creat new environ name delve_dev name would like environ run conda creat n delve_dev python environ conda creat n delve_dev python creat new environ touch exist environ exist python instal work environ window user activ follow activ delve_dev mac osx linux user use sourc activ delve_dev see confirm messag indic new develop environ view environ conda info e return home root environ deactiv see full conda doc httpcondapydataorgdocs__ point easili develop instal detail next section instal depend run delv develop environ must first instal delv depend suggest use follow command execut develop environ activ pip instal r requirementsreqirementstxt instal necessari depend next activ precommit hook run precommit instal make develop build depend place make inplac build navig git clone delv repositori run python setuppi develop make chang write test delv seriou test strongli encourag contributor embrac testdriven develop tdd httpenwikipediaorgwikitestdriven_development_ develop process reli repetit short develop cycl first develop write initi fail autom test case defin desir improv new function produc minimum amount code pass test actual write code write test often test taken origin github issu howev alway worth consid addit use case write correspond test ad test one common request code push delv therefor worth get habit write test ahead time never issu delv use pytest test system httpdocpytestorgenlatest_ conveni extens numpytest httpdocsscipyorgdocnumpyreferenceroutinestestinghtml_ write test test go test directori folder contain mani current exampl test suggest look inspir run test suit test run directli insid git clone without instal delv type pytest updat document delv document resid doc folder chang doc make modifi appropri file sourc folder within doc delv doc us restructuredtext syntax explain httpwwwsphinxdocorgenstableresthtmlrstprimer_ docstr follow numpi docstr standard httpsgithubcomnumpynumpyblobmasterdochowto_documentrsttxt_ made chang build doc navig doc folder type make html result html page locat docbuildhtml submit pull request youv made chang push fork repositori submit pull request integr delv code base find pull request pr tutori github help doc httpshelpgithubcomarticlesusingpullrequests_ _satur overview satur satur metric use identifi intrins dimension featur layer visual satur chang train use optim network topolog provid httpsgithubcomjustinshenkplayground imag _staticsaturation_demogif covari matrix featur comput onlin math qz_l z_l fracsumb_ba_lbt a_lbn bara_l bigotim bara_l mathb batch layer output matrix matha_l mathn number sampl note inform satur comput read featur space satur train httpsarxivorgabs_ exampl delv allow user creat plot log record variou format plot delv allow plot result everi epoch use save_tocsvplot creat autom plot metric record stat argument plot depict layer gener order forward pass figur galleryimagesvggcifarrbseidim_epoch_png width automat gener plot intrins dimension comput train set cifar vgg th epoch epoch train figur galleryimagesvggcifarrbselsat_epoch_png width automat gener plot satur comput train set cifar vgg th epoch epoch train log delv log result log packag show progress tqdm figur galleryimagesloggingjpg width simpl exampl gener twolay network train randomli gener data provid refsphx_glr_galleri refer saturationtrack saturationtrack provid hook pytorch extract metric model train autoclass delvesaturationtrack api page currentmodul delv autosummari templat autosummaryrst toctre refer saturationtrack academ galleri delv use sever paper figur galleryimagesborder_resnet_cifar_png width resnet train cifar epoch use adam optim batch size imag go deeper optim convolut neural network without train httpsarxivorgabs_ figur galleryimagesborder_resnet_cifar_png width resnet train cifar epoch use adam optim imag go deeper optim convolut neural network without train httpsarxivorgabs_ figur galleryimagesdensenet_cifar_png width densenet train food epoch use stochast gradient decent optim batch size imag featur space satur train httpsarxivorgabs_ figur galleryimagesvgg_resolution_satpng width vgg train differ resolut epoch use adamoptim batch size see shift infer process observ shift high satur valu imag input size matter convolut neural network classifi httpswwwspringerprofessionaldeeninputsizemattersforcnnclassifiers_ support delv bug bug issu improv request log github issu httpsgithubcomdelveteamdelveissues_ commun commun support provid via gitter httpsgitterimdelvechatcommunity_ ask question delv toctre maxdepth delv delv packag submodul delvemetr modul automodul delvemetr member undocmemb showinherit delvepca_lay modul automodul delvepca_lay member undocmemb showinherit delvetool modul automodul delvetool member undocmemb showinherit delvetorch_util modul automodul delvetorch_util member undocmemb showinherit delvetorchcallback modul automodul delvetorchcallback member undocmemb showinherit delvewrit modul automodul delvewrit member undocmemb showinherit modul content automodul delv member undocmemb showinherit delv document master file creat sphinxquickstart sun aug adapt file complet like least contain root toctre direct includ readmerst toctre maxdepth caption get start instal instal satur satur usag galleryindex academ galleri galleri exampl plot exampl refer attribut method refer bug support support contribut delv contribut indic tabl refgenindex refmodindex refsearch instal instal delv delv requir python instal instal via pip code pip instal delv instal latest develop version clone github repositori use setup script git clone httpsgithubcomdelveteamdelvegit cd delv pip instal usag instanti classdelvetorchcallbacksaturationtrack class defin pytorch train loop exampl torch import nn delv import saturationtrack model nnmoduledict conv nnconvd pad linear nnlinear layer modelconv modellinear stat saturationtrackerregressionhformath save_toplotcsv moduleslay statslsat _ rang y_pred modelx loss loss_fny_pr optimizerzero_grad lossbackward optimizerstep statsadd_satur statsclos hook layer layer log statist case lsat layer satur save imag regress edit file automat gener sphinxgalleri make chang edit sourc python file galleryextractsaturationpi line number given html note class sphxglrdownloadlinknot click refher sphx_glr_download_gallery_extractsaturationpi download full exampl code rstclass sphxglrexampletitl _sphx_glr_gallery_extractsaturationpi extract layer satur extract layer satur delv gener python sourc line codeblock python import torch tqdm import trang delv import saturationtrack class twolayernettorchnnmodul def __init__self d_in h d_out supertwolayernet self__init__ selflinear torchnnlineard_in h selflinear torchnnlinearh d_out def forwardself x h_relu selflinearxclampmin y_pred selflinearh_relu return y_pred devic torchdevicecuda torchcudais_avail els cpu torchmanual_se h n batch size d_in input dimens h hidden dimens d_out output dimens n d_in h d_out h creat random tensor hold input output x torchrandnn d_in torchrandnn d_out x_test torchrandnn d_in y_test torchrandnn d_out watch specif layer hand delv list also hand entir moduleobject delv let delv search record layer model twolayernetd_in h d_out x model xtodevic ytodevic modeltodevic x_test y_test x_testtodevic y_testtodevic layer modellinear modellinear stat saturationtrackerregressionhformath save_toplotcsv moduleslay devicedevic statslsat lsat_ev loss_fn torchnnmselossreductionsum optim torchoptimsgdmodelparamet lre momentum steps_it trang descstep leavetru posit steps_iterwriteformat regress twolayernet hidden layer size formath step steps_it train step modeltrain y_pred modelx loss loss_fny_pr optimizerzero_grad lossbackward optimizerstep test step modelev y_pred modelx_test loss_test loss_fny_pr y_test updat statist steps_iterset_descriptionlossg lossitem statsadd_scalartrainloss lossitem statsadd_scalartestloss loss_testitem statsadd_satur steps_iterwriten statsclos steps_iterclos rstclass sphxglrtime total run time script minut second _sphx_glr_download_gallery_extractsaturationpi html contain sphxglrfooter class sphxglrfooterexampl contain sphxglrdownload sphxglrdownloadpython downloaddownload python sourc code extractsaturationpi extractsaturationpi contain sphxglrdownload sphxglrdownloadjupyt downloaddownload jupyt notebook extractsaturationipynb extractsaturationipynb html rstclass sphxglrsignatur galleri gener sphinxgalleri httpssphinxgallerygithubio_ orphan _sphx_glr_galleri galleri galleri exampl raw html div classsphxglrthumbcontain tooltipextract layer satur html figur galleryimagesthumbsphx_glr_extractsaturation_thumbpng alt extract layer satur refsphx_glr_gallery_extractsaturationpi raw html div toctre hidden galleryextractsatur raw html div classsphxglrcleardiv html contain sphxglrfooter class sphxglrfootergalleri contain sphxglrdownload sphxglrdownloadpython downloaddownload exampl python sourc code gallery_pythonzip gallerygallery_pythonzip contain sphxglrdownload sphxglrdownloadjupyt downloaddownload exampl jupyt notebook gallery_jupyterzip gallerygallery_jupyterzip html rstclass sphxglrsignatur galleri gener sphinxgalleri httpssphinxgallerygithubio_ delvesaturationtrack currentmodul delv autoclass saturationtrack delvetorchcovariancematrix currentmodul delv autoclass torchcovariancematrix