badg start rcmdcheckhttpsgithubcommingzehuanglatentcorworkflowsrcmdcheckbadgesvghttpsgithubcommingzehuanglatentcoract codecovhttpscodecovioghmingzehuanglatentcorbranchmastergraphbadgesvghttpsappcodecovioghmingzehuanglatentcor cran statushttpswwwrpkgorgbadgesversionlastreleaselatentcorhttpscranrprojectorgpackagelatentcor launch binderhttpsmybinderorgbadge_logosvghttpsmybinderorgvghmingzehuanglatentcormast lifecycl stablehttpsimgshieldsiobadgelifecyclestablebrightgreensvghttpslifecyclerliborgarticlesstageshtmlst josshttpsjosstheojorgpapersjossstatussvghttpsdoiorgjoss doihttpszenodoorgbadgesvghttpszenodoorgbadgelatestdoi badg end latentcor latent correl mix type data latentcor r packag estim latent correl mix data type continu binari truncat ternari latent gaussian copula model refer estim framework see fan j liu h ning zou h high dimension semiparametr latent graphic model mix data jrss bhttpsdoiorgrssb continuousbinari type quan x booth jg well mtrankbas approach estim correl mix ordin data arxivhttpsarxivorgab ternari type yoon g carrol rj gaynanova spars semiparametr canon correl analysi data mix type biometrikahttpsdoiorgbiometasaa truncat type zeroinfl data yoon g müller cl gaynanova fast comput latent correl jcgshttpsdoiorg approxim method comput see vignettehttpsmingzehuanggithubiolatentcorarticleslatentcorhtml detail statement need r softwar packag current avail allow accur fast correl estim mix variabl data unifi manner r packag latentcorhttpscranrprojectorgpackagelatentcor introduc thu repres first standalon r packag comput latent correl take account variabl type continuousbinaryordinalzeroinfl come optim memori footprint comput effici essenti make latent correl estim almost fast rankbas correl estim instal use latentcor need instal rhttpscranrprojectorg enhanc user experi may use ide eg rstudiohttpswwwrstudiocom develop version latentcorhttpsgithubcommingzehuanglatentcor avail github download help devtool packag r follow r installpackagesdevtool devtoolsinstall_githubhttpsgithubcommingzehuanglatentcor build_vignett true stabl releas version latentcorhttpscranrprojectorgpackagelatentcor avail cran download r follow r installpackageslatentcor exampl simpl exampl estim latent correl shown r librarylatentcor gener two variabl sampl size first variabl ternari pi pi pi second variabl continu copula transform appli x gen_datan type cter con xp listc nax estim latent correl matrix origin method latentcorx x type cter con method originalr estim latent correl matrix approxim method latentcorx x type cter conr speed improv approxim method compar origin method librarymicrobenchmark microbenchmarklatentcorx type cter con method origin latentcorx type cter con unit millisecond min lq mean median uq max neval run window intelr coretm cpu ghz ghz heatmap latent correl matrix latentcorx x type cter con showplot trueplotr anoth exampl mtcar dataset r librarylatentcor use buildin dataset mtcar x mtcar check variabl type manual determin applymtcar tabl use builtin get_typ function get type suggest get_typesmtcar estim latent correl matrix origin method latentcormtcar type ccon ter con con con con con bin bin ter con method originalr estim latent correl matrix approxim method latentcormtcar type ccon ter con con con con con bin bin ter conr speed improv approxim method compar origin method librarymicrobenchmark microbenchmarklatentcormtcar type type method origin latentcormtcar type type method approx unit millisecond min lq mean median uq max neval run window intelr coretm cpu ghz ghz heatmap latent correl matrix approxim method latentcormtcar type ccon ter con con con con con bin bin ter con showplot trueplotr interact heatmap see interact heatmap latent correl approx mtcarshttpsrpubscommingzehuang commun guidelin contribut suggest softwar alway welcom pleas consult contribut guidelineshttpsgithubcommingzehuanglatentcorblobmastercontributingmd prior submit pull request report issu problem softwar use github issu trackerhttpsgithubcommingzehuanglatentcorissu contributor must adher code conducthttpsgithubcommingzehuanglatentcorblobmastercode_of_conductmd acknowledg thank dr grace yoon provid implement detail mixedccahttpsgithubcomirinagainmixedcca r packag latentcor renam main function estr latentcor add help function get_typ automat gener type data matrix add document paramet add document speed comparison origin method approxim latentcor add userdefin usenearpd user decid latent correl matrix adjust posit definit automat remov redund code check posit definit minor correct type detect accommod na valu contributor coven code conduct pledg member contributor leader pledg make particip commun harassmentfre experi everyon regardless age bodi size visibl invis disabl ethnic sex characterist gender ident express level experi educ socioeconom statu nation person appear race cast color religion sexual ident orient pledg act interact way contribut open welcom divers inclus healthi commun standard exampl behavior contribut posit environ commun includ demonstr empathi kind toward peopl respect differ opinion viewpoint experi give grace accept construct feedback accept respons apolog affect mistak learn experi focus best us individu overal commun exampl unaccept behavior includ use sexual languag imageri sexual attent advanc kind troll insult derogatori comment person polit attack public privat harass publish other privat inform physic email address without explicit permiss conduct could reason consid inappropri profession set enforc respons commun leader respons clarifi enforc standard accept behavior take appropri fair correct action respons behavior deem inappropri threaten offens harm commun leader right respons remov edit reject comment commit code wiki edit issu contribut align code conduct commun reason moder decis appropri scope code conduct appli within commun space also appli individu offici repres commun public space exampl repres commun includ use offici email address post via offici social media account act appoint repres onlin offlin event enforc instanc abus harass otherwis unaccept behavior may report commun leader respons enforc mingzehuanggmailcom complaint review investig promptli fairli commun leader oblig respect privaci secur report incid enforc guidelin commun leader follow commun impact guidelin determin consequ action deem violat code conduct correct commun impact use inappropri languag behavior deem unprofession unwelcom commun consequ privat written warn commun leader provid clariti around natur violat explan behavior inappropri public apolog may request warn commun impact violat singl incid seri action consequ warn consequ continu behavior interact peopl involv includ unsolicit interact enforc code conduct specifi period time includ avoid interact commun space well extern channel like social media violat term may lead temporari perman ban temporari ban commun impact seriou violat commun standard includ sustain inappropri behavior consequ temporari ban sort interact public commun commun specifi period time public privat interact peopl involv includ unsolicit interact enforc code conduct allow period violat term may lead perman ban perman ban commun impact demonstr pattern violat commun standard includ sustain inappropri behavior harass individu aggress toward disparag class individu consequ perman ban sort public interact within commun attribut code conduct adapt contributor covenanthomepag version avail httpswwwcontributorcovenantorgversioncode_of_conducthtmlv commun impact guidelin inspir mozilla code conduct enforc laddermozilla coc answer common question code conduct see faq httpswwwcontributorcovenantorgfaqfaq translat avail httpswwwcontributorcovenantorgtranslationstransl homepag httpswwwcontributorcovenantorg v httpswwwcontributorcovenantorgversioncode_of_conducthtml mozilla coc httpsgithubcommozilladivers faq httpswwwcontributorcovenantorgfaq translat httpswwwcontributorcovenantorgtransl contribut latentcor contribut latentcor follow principl state guidelin contributor tidyvers ecosystem r see detail develop contribut guidehttpsrstdiotidycontrib fix typo refer thishttpsdocsgithubcomengithubcollaboratingwithpullrequestsproposingchangestoyourworkwithpullrequestscreatingapullrequestfromafork propos chang pull request fork fix typo spell mistak grammat error document directli use github web interfac long chang made _source_ file find typo rd file pleas make chang correspond r file rd file automat gener roxygenhttpsroxygenrliborgarticlesroxygenhtml edit hand bigger chang first step make chang instal devtool use installpackagesdevtool want make bigger chang good idea first file issu make sure someon team agre need found bug pleas file issu illustr bug minim reproduc exampl reprexhttpswwwtidyverseorghelpreprex also help write unit test need pull request process contribut chang latentcor follow step creat branch git give descript name make chang push branch github issu pull request pr discuss pull request iter either accept pr decid good fit latentcor your familiar git github pleas start read httprpkgshadconzgithtml pull request evalu checklist __motivation__ pull request clearli concis motiv need chang pleas describ problem pr address show pull request solv concis possibl also includ motiv news new releas latentcor come easi user see chang add item top file use markdown format news item end yourgithubusernam the_issue_numb __onli relat changes__ submit pull request pleas check make sure havent accident includ unrel chang make harder see exactli what chang evalu unexpect side effect pr correspond git branch expect submit multipl chang make sure creat multipl branch multipl chang depend start first one dont submit other first one process __use latentcor code style__ tri adher close possibl offici tidyvers style guidehttpstyletidyverseorg pleas well maintain consist style across whole code base make much easier jump code your modifi exist latentcor code doesnt follow style guid separ pull request fix style would greatli appreci your ad new paramet new function youll also need document roxygenhttpsgithubcomklutometisroxygen make sure rerun devtoolsdocu code submit titl latentcor r packag estim latent correl mix data type tag r statist latent correl date juli output html_document df_print page bibliographi paperbib author name mingz huang orcid affili name christian l müller orcid affili name irina gaynanova orcid affili affili name depart statist texa univers colleg station tx index name depart econom texa univers colleg station tx index name ludwigmaximiliansuniversität münchen germani index name helmholtz zentrum münchen germani index name flatiron institut new york index summari present latentcor r packag correl estim data mix variabl type mix variabl type includ continu binari ordin zeroinfl truncat data routin collect mani area scienc accur estim correl among variabl often first critic step statist analysi workflow pearson correl default choic well suit mix data type underli normal assumpt violat concept semiparametr latent gaussian copula model hand provid unifi way estim correl mix data type r packag latentcor compris comprehens list model enabl estim correl continuousbinaryternaryzeroinfl truncat variabl type underli implement take advantag fast multilinear interpol scheme effici choic interpol grid point thu give packag small memori footprint without compromis estim accuraci make latent correl estim readili avail modern highthroughput data analysi statement need r softwar packag current avail allow accur fast correl estim mix variabl data unifi manner popular cor function within r packag stat teamr instanc allow comput pearson correl kendal tau spearman rho faster algorithm calcul kendal tau implement r packag pcapp crouxrobust pearson correl appropri skew ordin data use lead invalid infer case rankbas kendal tau spearman rho robust measur associ directli use subsitut statist method requir pearson correl input promin exampl eg graphic model estim xueregularizedyoonmicrobi r packag polycor foxpoli design ordin data allow comput polychor ordinalordin polyseri ordinalcontinu correl base latent gaussian model howev packag function zeroinfl data handl skew continu measur allow copula transform r packag correl makowskimethod easystat collect provid differ correl measur includ polychor polyseri correl howev function correl estim zeroinfl data lack r packag mixedcca yoonspars base latent gaussian copula model comput latent correl continuousbinaryzeroinfl variabl type intermedi step canon correl analysi howev mixedcca allow ordin data type r packag latentcor introduc thu repres first standalon r packag comput latent correl take account variabl type continuousbinaryordinalzeroinfl come optim memori footprint comput effici essenti make latent correl estim almost fast rankbas correl estim estim latent correl gener estim workflow estim latent correl consist three step comput kendal tau pair variabl choos bridg function fcdot base type variabl pair bridg function connect kendal tau comput data widehat tau true underli correl rho via moment equat mathbbewidehat tau frho estim latent correl calcul fwidehat tau summar refer explicit form fcdot variabl combin implement latentcor type continu binari ternari zeroinfl truncat continu liunonparanorm binari fanhigh fanhigh ternari quanrank quanrank quanrank zeroinfl yoonspars yoonspars see latentcor yoonspars truncat vignett deriv effici invers bridg function latentcor invers bridg function fcdot comput two way origin approach method origin reli numer invers pair variabl base uniroot optim yoonspars sinc pair variabl requir separ optim run origin approach comput expens number variabl larg second approach invert fcdot fast multilinear interpol precalcul f valu specif set interpol grid point method approx construct propos yoonfast avail continuousbinarytrunc pair current version mixedcca howev implement lack ternari variabl case reli interpol grid larg memori footprint latentcor includ ternari case provid optim interpol grid redefin bridg function rescal version kendal tau scale adapt smooth underli type variabl simultan control approxim error lower level result latentcor significantli smaller memori footprint see tabl smaller approxim error compar mixedcca newpag memori footprint kb case mixedcca latentcor binarycontinu binarybinari truncatedcontinu truncatedbinari truncatedtrunc ternarycontinu ternarybinari ternarytrunc ternaryternari illustr exampl illustr excel perform latent correl estim mix data consid simpl exampl estim correl continu ternari variabl first use latentcor gener synthet data two variabl sampl size true latent correl valu estim correl use origin method approxim method default standard pearson correl r librarylatentcor first variabl ternari second variabl continu copula transform appli setse x gen_datan type cter con rho x estim correl latentcorx x type cter con method originalr latentcorx x type cter conr corx origin method estim latent correl equal approxim method close valu contrast appli pearson correl give estim true valu illustr bia induc pearson correl estim consid truncatedcontinu case differ valu true correl figur reffigr_alla display valu obtain use standard pearson correl reveal signific estim bia respect true correl figur reffigr_allb display estim latent correl use origin approach versu true valu underli ternarycontinu correl align point around yx line confirm estim empir unbias figur reffigr_allc display estim latent correl use approxim approach method approx versu true valu underli latent correl result almost indistinguish figur reffigr_allb fraction comput cost scatter plot estim pearson correl panel latent correl origin panel b approx panel c vs ground truth correl labelfigr_allcombinedcorrelationspdf script reproduc display result avail latentcor_evaluationhttpsgithubcommingzehuanglatentcor_evaluationblobmasterunbias_checkr next illustr applic latentcor mtcar dataset avail standard r mtcar dataset compris eleven variabl continu binari ternari data type function get_typ use automat extract type data type determin correl matrix estim use either origin method approxim method r librarylatentcor x mtcar extract variabl type type get_typesx estim correl latentcormtcar type type method originalr latentcormtcar type typesr figur reffigr_car show time matric latent correl estim default approx method left panel pearson correl estim middl panel differ estim right panel even small dataset observ absolut differ exceed heatmap latent correl approx left panel pearson correl middl panel differ two estim latent correl pearson correl mtcar dataset labelfigr_carsall_heatmappdf script reproduc figur reffigr_car avail herehttpsgithubcommingzehuanglatentcor_evaluationblobmasterall_heatmapr also provid interact heatmap estim latent correlationshttpsrpubscommingzehuang pearson correlationshttpsrpubscommingzehuang differ estim latent correl minu pearson correlationshttpsrpubscommingzehuang mtcar data set basic usag avail r packag latentcor avail githubhttpsgithubcommingzehuanglatentcor get start vignett basic exampl avail herehttpsmingzehuanggithubiolatentcorarticleslatentcorhtml vignett mathemat background estim process well effect option paramet avail herehttpsmingzehuanggithubiolatentcorarticleslatentcor_mathhtml acknowledg thank dr grace yoon provid implement detail mixedcca r packag refer titl mathemat framework latentcor author mingz huang christian l müller irina gaynanova date r sysdat bibliographi latentcorbib output rmarkdownhtml_vignett extra_depend amsmath nocit crouxrobust filzmoserpcapp liunonparanorm foxpoli vignett vignetteindexentrymathemat framework latentcor vignetteengineknitrrmarkdown vignetteencodingutf r setup includ fals optionstinytexverbos true knitropts_chunkset collaps true comment librarylatentcor latent gaussian copula model mix data latentcor util power semiparametr latent gaussian copula model estim latent correl mix data type continuousbinaryternarytrunc zeroinfl review definit type definit continu model fanhigh random xincalrp satisfi gaussian copula nonparanorm model exist monoton increas ff_j_jp z_jf_jx_j satisfi zsim n_p sigma sigma_jj denot xsim npn sigma f r continu x gen_datan type conx x definit binari model fanhigh random xincalrp satisfi binari latent gaussian copula model exist wsim npn sigma f x_jiw_jc_j icdot indic function c_j constant r binari x gen_datan type binx x definit ternari model quanrank random xincalrp satisfi ternari latent gaussian copula model exist wsim npn sigma f x_jiw_jc_jiw_jc_j icdot indic function c_jc_j constant r ternari x gen_datan type terx x definit truncat zeroinfl model yoonspars random xincalrp satisfi truncat latent gaussian copula model exist wsim npn sigma f x_jiw_jc_jw_j icdot indic function c_j constant r truncat x gen_datan type trux x mix latent gaussian copula model mix latent gaussian copula model jointli model ww_ w_ w_ w_sim npn sigma f x_jw_j x_jiw_jc_j x_jiw_jc_jiw_jc_j x_jiw_jc_jw_j r mix setse x gen_datan type ccon bin ter trux headx momentbas estim sigma base bridg function estim latent correl matrix sigma achiev via bridg function f defin ehattau_jkfsigma_jk sigma_jk latent correl variabl j k hattau_jk correspond sampl kendal tau kendal tau tau_a given observ mathbfx_j mathbfx_kincalrn hattau_jkhattaumathbfx_j mathbfx_kfracnnsum_l iil nsignx_ijx_ijsignx_ikx_ik n sampl size latentcor calcul pairwis kendal widehat tau part estim process r kendalltau estim latentcorx type ccon bin ter tru k estimatek k use f widehat tau_jk momentbas estim hatsigma_jkfhattau_jk correspond hatsigma consist sigma fanhigh quanrank yoonspars explicit form bridg function f deriv combin continuouscbinarybternaryntruncatedt variabl type summar correspond refer combin implement latentcor type continu binari ternari zeroinfl truncat continu liunonparanorm binari fanhigh fanhigh ternari quanrank quanrank quanrank zeroinfl truncat yoonspars yoonspars see appendix yoonspars provid explicit form f combin theorem explicit form bridg function let w_incalrp_ w_incalrp_ w_incalrp_ w_incalrp_ ww_ w_ w_ w_sim npn sigma f pp_p_p_p_ let xx_ x_ x_ x_incalrp satisfi x_jw_j jp_ x_jiw_jc_j jp_ p_p_ x_jiw_jc_jiw_jc_j jp_p_ p_ x_jiw_jc_jw_j jp_p_p_ p delta_jfc_j rankbas estim sigma base observ n realiz x matrix mathbfhatr hatr_jj hatr_jkhatr_kjfhattau_jk block structur mathbfhatrbeginpmatrix f_cchattau f_cbhattau f_cnhattau f_cthattau f_bchattau f_bbhattau f_bnhattau f_bthattau f_nchattau f_nbhattau f_nnhattau f_nthattau f_tchattau f_tbhattau f_tnhattau f_tthattau endpmatrix fcdotbegincas cc sinrpi bc phi_delta_jrsqrtphidelta_j bb phi_delta_jdelta_krphidelta_jphidelta_k nc phi_delta_jrsqrtphidelta_jphi_delta_jdelta_jsigma_arphidelta_jphidelta_j nb phi_delta_jdelta_krphidelta_jphidelta_jphidelta_kphi_delta_jdelta_kr nn phi_delta_jdelta_krphi_delta_jdelta_krphidelta_jphi_delta_jdelta_krphidelta_kphi_delta_jdelta_kr tc phi_delta_jsqrtphi_delta_jsigma_br tb phidelta_jphidelta_kphi_delta_jdelta_ksigma_crphi_delta_jdelta_ksigma_dr tn phidelta_kphidelta_k phi_delta_kdelta_kdelta_jsigma_erphi_delta_kdelta_kdelta_jsigma_arphi_delta_kdelta_kdelta_jsigma_br tt phi_delta_jdelta_ksigma_crphi_delta_jdelta_ksigma_dr endcas delta_jphipi_j delta_kphipi_k delta_jphipi_j delta_jphipi_jpi_j delta_kphipi_k delta_kphipi_kpi_k sigma_ar beginpmatrix fracrsqrt fracrsqrt fracrsqrt fracrsqrt endpmatrix sigma_br beginpmatrix fracsqrt fracrsqrt fracsqrt r fracrsqrt r endpmatrix sigma_cr beginpmatrix r fracsqrt r fracrsqrt fracsqrt fracrsqrt endpmatrix sigma_dr beginpmatrix fracsqrt fracrsqrt fracsqrt fracrsqrt endpmatrix sigma_ beginpmatrix r r endpmatrix sigma_ar beginpmatrix fracrsqrt r fracrsqrt r fracsqrt fracrsqrt fracrsqrt fracsqrt endpmatrix sigma_br beginpmatrix r fracrsqrt fracrsqrt r fracsqrt fracrsqrt fracrsqrt fracsqrt endpmatrix sigma_cr beginpmatrix fracsqrt fracrsqrt fracrsqrt fracsqrt fracsqrt fracrsqrt r fracrsqrt fracsqrt r endpmatrixtextand sigma_dr beginpmatrix r fracsqrt fracrsqrt r fracrsqrt fracsqrt fracsqrt fracrsqrt r fracrsqrt fracsqrt r endpmatrix estim method given form bridg function f obtain momentbas estim widehat sigma_jk requir invers f latentcor implement two method calcul invers method origin subsect describ origin method relev paramet tolorigin method approx subsect describ approxim method relev paramet ratioapprox method calcul invers bridg function appli element sampl kendal tau matrix calcul perform pointwis separ pair variabl result pointwis estim correl matrix may posit semidefinit latentcor perform project pointwiseestim space posit semidefinit matric allow shrinkag toward ident matrix use paramet nu see subsect describ adjust pointwis estim relev paramet nushrinkag origin method method origin origin origin estim approach reli numer invers f base solv uniroot optim problem given calcul widehat tau_jk sampl kendal tau variabl j k estim latent correl widehat sigma_jk obtain call optim function solv follow optim problem widehat r_jk argmin_r fr widehat tau_jk paramet tol control desir accuraci minim pass optim default precis e r callr warn fals messag f estim latentcorx type ccon bin ter tru method origin tol e algorithm origin method input frfr mathbfdelta bridg function base type variabl j k step calcul hattau_jk use r kendal estimatek step binarytrunc variabl j set hatmathbfdelta_jhatdelta_jphipi_j pi_jsum_infracix_ijn ternari variabl j set hatmathbfdelta_jhatdelta_j hatdelta_j hatdelta_jphipi_j hatdelta_jphipi_jpi_j pi_jsum_infracix_ijn pi_jsum_infracix_ijn r zratios_ estimatezratio comput fhattau_jk hatr_jkargminfrhattau_jk solv via optim function r accuraci tol r estim estimaterpointwis approxim method method approx approx faster approxim method base multilinear interpol precomput invers bridg function fix grid point yoonfast possibl invers bridg function analyt function paramet kendal tau proport zero st variabl possibl proport zero one st variabl possibl proport zero nd variabl possibl proport zero one nd variabl short ddimension multilinear interpol use weight averag neighbor approxim function valu point within ddimension cube neighbor perform interpol latentcor take advantag r packag chebpol rchebpol approxim method first describ yoonfast continuousbinarytrunc case latentcor addit implement ternari case optim choic grid well interpol boundari faster comput smaller memori footprint r callr warn fals messag f estim latentcorx type ccon bin ter tru method approx algorithm approxim method input let checkghg precomput valu fhcheckg fix grid checkgincheckcalg base type variabl j k binarycontinu case checkgchecktau_jk checkdelta_j binarybinari case checkgchecktau_jk checkdelta_j checkdelta_k truncatedcontinu case checkgchecktau_jk checkdelta_j truncatedtrunc case checkgchecktau_jk checkdelta_j checkdelta_k ternarycontinu case checkgchecktau_jk checkdelta_j checkdelta_j ternarybinari case checkgchecktau_jk checkdelta_j checkdelta_j checkdelta_k ternarytrunc case checkgchecktau_jk checkdelta_j checkdelta_j checkdelta_k ternayternari case checkgchecktau_jk checkdelta_j checkdelta_j checkdelta_k checkdelta_k step step origin method step hattau_jkl mboxratiotim bartau_jkcdot appli interpol otherwis appli origin method avoid interpol area high approxim error close boundari use hybrid scheme step paramet ratio control size region interpol perform ratio mean interpol ratio mean interpol alway perform deriv approxim bound bc bb tc tb tt case see yoonfast deriv approxim bound nc nb nn nt case appendix bartau_jkcdot begincas pi_jpi_j bc case minpi_jpi_kmaxpi_j pi_k bb case pi_jpi_jpi_jpi_jpi_j nc case minpi_jpi_jpi_jpi_jpi_jpi_kpi_k nb case minpi_jpi_jpi_jpi_jpi_j pi_kpi_kpi_kpi_kpi_k nn case pi_j tc case maxpi_kpi_kmaxpi_kpi_kpi_j tb case maxpi_jpi_kpi_kpi_kpi_k tn case maxpi_jpi_k tt case endcas default latentcor use ratio valu recommend yoonfast good balanc accuraci comput speed valu howev modifi user r estim warn fals messag f latentcorx type ccon bin ter tru method approx ratio r latentcorx type ccon bin ter tru method approx ratio r latentcorx type ccon bin ter tru method originalr lower ratio closer approxim method origin method ratio equival method origin also higher cost comput r speed warn fals messag f librarymicrobenchmark microbenchmarklatentcorx type ccon bin ter tru method approx ratio r microbenchmarklatentcorx type ccon bin ter tru method approx ratio r microbenchmarklatentcorx type ccon bin ter tru method originalr rescal grid interpol sinc hattaul bartau grid need cover whole domain tauin optim memori associ store grid rescal tau follow checktau_jktau_jkbartau_jkin bartau_jk defin addit ternari variabl j alway hold delta_jdelta_j sinc delta_jphipi_j delta_jphipi_jpi_j thu grid cover area correspond delta_jgedelta_j thu rescal follow checkdelta_jdelta_jdelta_jin checkdelta_jdelta_jin speed comparison illustr speed improv method approx plot run time scale behavior method approx method origin set type gen_data replic ccon bin ter tru multipl time increas dimens p sampl size n use simul data figur summar observ scale loglog plot method observ expect op scale behavior dimens p ie linear scale loglog plot howev method approx least one order magnitud faster method origin independ dimens problem timing_plotpng adjust pointwiseestim positivedefinit shrinkag sinc estim perform pointwis result matrix estim latent correl guarante posit semidefinit exampl could expect sampl size small estim error pairwis correl larger r messag fals setse x gen_datan type ccon bin ter trux x latentcorx type ccon bin ter tru outrpointwis eigenoutrpointwisevalu latentcor automat correct pointwis estim posit definit make two adjust first rpointwis smallest eigenvalu less zero latentcor project matrix nearest posit semidefinit matrix user notifi adjust messag supress previou code chunk eg r messag true latentcorx type ccon bin ter tru second latentcor shrink adjust matrix correl toward ident matrix use paramet nu default valu nu result r strictli posit definit minim eigenvalu greater equal nu r nu widetild r nu widetild r nearest posit semidefinit matrix rpointwis r latentcorx type ccon bin ter tru nu outrpointwis outr result r rpointwis could quit differ sampl size n small n larg p moder differ typic driven paramet nu r setse x gen_datan type ccon bin ter trux latentcorx type ccon bin ter tru nu outrpointwis outr appendix deriv bridg function f ternarytrunc case without loss gener let j k definit kendal tau tau_ehattau_efracnnsum_leq ileq leq n signx_ix_ix_ix_i sinc x_ ternari beginalign signx_x_ nonumb iu_c_u_leq c_iu_c_u_leq c_iu_c_u_leq c_ nonumb iu_leq c_ u_c_iu_leq c_ u_c_iu_leq c_ u_c_ nonumb iu_c_iu_c_u_c_iu_c_iu_c_u_c_ nonumb iu_c_iu_c_u_c_ nonumb iu_c_iu_c_u_c_iu_c_iu_c_u_c_ nonumb iu_c_iu_c_u_c_ nonumb iu_c_iu_c_u_c_iu_c_iu_c_u_c_ nonumb iu_c_u_leq c_iu_c_u_leq c_ endalign sinc x_ truncat c_ beginalign signx_x_ix_x_ix_x_ nonumb ix_x_signx_x_ nonumb ix_ix_ix_x_signx_x_ endalign sinc f monoton increas signx_x_signz_z_ beginalign tau_eiu_c_u_leq c_ signx_x_ nonumb eiu_c_u_leq c_ signx_x_ nonumb eiu_c_u_leq c_ ix_ nonumb eiu_c_u_leq c_ ix_ nonumb eiu_c_u_leq c_ix_x_signz_z_ nonumb eiu_c_u_leq c_ ix_ nonumb eiu_c_u_leq c_ ix_ nonumb eiu_c_u_leq c_ix_x_signz_z_ nonumb eiu_c_u_leq c_ ix_ nonumb eiu_c_u_leq c_ ix_ nonumb eiu_c_u_leq c_ix_x_signz_z_ nonumb eiu_c_u_leq c_ix_x_signz_z_ endalign definit u let z_jf_ju_j delta_jf_jc_j j use signxix obtain beginalign tau_eiz_delta_z_leq delta_z_leq delta_eiz_delta_z_leq delta_z_leq delta_ nonumb eiz_delta_z_leq delta_iz_delta_z_delta_z_z_ nonumb eiz_delta_z_leq delta_iz_delta_z_delta_z_z_ nonumb eiz_delta_z_leq delta_ z_leq delta_eiz_delta_z_leq delta_ z_leq delta_ nonumb eiz_delta_z_leqdelta_z_delta_z_z_ nonumb eiz_delta_z_leqdelta_z_delta_z_z_ endalign sinc fracz_z_sqrt z fracz_z_sqrt z fracz_z_sqrt z standard bivari normal distribut variabl correl fracsqrt rsqrt fracrsqrt respect definit phi_cdotcdot cdotcdot phi_cdotcdot cdotcdotcdot beginalign f_ntrdelta_jdelta_jdelta_k phi_leftdelta_jdelta_jdelta_kbeginpmatrix r r endpmatrix right nonumb phi_leftdelta_jdelta_jdelta_kbeginpmatrix r r endpmatrixrightnonumb phi_leftdelta_jdelta_jdelta_kbeginpmatrix fracrsqrt r fracrsqrt r fracsqrt fracrsqrt fracrsqrt fracsqrt endpmatrixright nonumb phi_leftdelta_jdelta_jdelta_kbeginpmatrix r fracrsqrt fracrsqrt r fracsqrt fracrsqrt fracrsqrt fracsqrt endpmatrixright endalign use fact beginalign phi_leftdelta_jdelta_jdelta_kbeginpmatrix r fracrsqrt fracrsqrt r fracsqrt fracrsqrt fracrsqrt fracsqrt endpmatrixright nonumb phi_leftdelta_jdelta_jdelta_kbeginpmatrix r fracrsqrt fracrsqrt r fracsqrt fracrsqrt fracrsqrt fracsqrt endpmatrixright nonumb phi_leftdelta_jdelta_jdelta_kbeginpmatrix r r endpmatrixright endalign beginalign phi_leftdelta_jdelta_jdelta_kbeginpmatrix r r endpmatrixrightphi_leftdelta_jdelta_jdelta_kbeginpmatrix r r endpmatrix right nonumb phi_delta_jdelta_j phidelta_jphidelta_j endalign beginalign f_ntrdelta_jdelta_jdelta_k phidelta_jphidelta_j nonumb phi_leftdelta_jdelta_jdelta_kbeginpmatrix r r endpmatrixrightnonumb phi_leftdelta_jdelta_jdelta_kbeginpmatrix fracrsqrt r fracrsqrt r fracsqrt fracrsqrt fracrsqrt fracsqrt endpmatrixright nonumb phi_leftdelta_jdelta_jdelta_kbeginpmatrix r fracrsqrt fracrsqrt r fracsqrt fracrsqrt fracrsqrt fracsqrt endpmatrixright endalign easi get bridg function truncatedternari case switch j k deriv approxim bound ternarycontinu case let n_xsum_in_xix_i n_xsum_in_xix_i pi_xfracn_xn_x pi_xfracn_xn_x beginalign taumathbfxleq fracn_xnn_xn_xnn_xn_xbeginpmatrix n endpmatrix nonumb fracn_xnfracn_xnfracn_xnfracn_xnfracn_xnfracn_xnfracn_xnfracn_xn nonumb approx fracn_xnfracn_xnfracn_xnfracn_xnfracn_xnfracn_xn nonumb pi_xpi_xpi_xpi_xpi_x endalign ternarybinari ternaryternari case combin two individu bound deriv approxim bound ternarytrunc case let mathbfxinmathcalrn mathbfyinmathcalrn observ n realiz ternari truncat variabl respect let n_xsum_inix_i pi_xfracn_xn n_xsum_inix_i pi_xfracn_xn n_xsum_inix_i pi_xfracn_xn n_ysum_iniy_i pi_yfracn_yn n_xysum_inix_i y_i n_xysum_inix_i y_i n_xysum_inix_i y_i beginalign taumathbfx mathbfyleq fracbeginpmatrixn endpmatrixbeginpmatrixn_x endpmatrixbeginpmatrixn_x endpmatrixbeginpmatrix n_x endpmatrixbeginpmatrixn_i endpmatrixbeginpmatrixn_xi endpmatrixbeginpmatrixn_xi endpmatrixbeginpmatrixn_xi endpmatrixbeginpmatrixn endpmatrix nonumb endalign sinc n_xyleqminn_xn_i n_xyleqminn_xn_i n_xyleqminn_xn_i obtain beginalign taumathbfx mathbfyleq fracbeginpmatrixn endpmatrixbeginpmatrixn_x endpmatrixbeginpmatrixn_x endpmatrixbeginpmatrix n_x endpmatrixbeginpmatrixn_i endpmatrixbeginpmatrixn endpmatrix nonumb fracbeginpmatrixminn_xn_i endpmatrixbeginpmatrixminn_xn_i endpmatrixbeginpmatrixminn_xn_i endpmatrixbeginpmatrixn endpmatrix nonumb leq fracbeginpmatrixn endpmatrixbeginpmatrixmaxn_xn_xn_xn_i endpmatrixbeginpmatrixn endpmatrix nonumb leq fracmaxn_xn_xn_xn_ymaxn_xn_xn_xn_ynn nonumb approx fracmaxn_xn_xn_xn_yn nonumb maxpi_xpi_xpi_xpi_i nonumb maxpi_xpi_xpi_xpi_xpi_i endalign easi get approxim bound truncatedternari case switch mathbfx mathbfi refer titl latentcor author mingz huang christian l müller irina gaynanova date r sysdat bibliographi latentcorbib output rmarkdownhtml_vignett extra_depend amsmath nocit crouxrobust filzmoserpcapp liunonparanorm foxpoli vignett vignetteindexentrylatentcor vignetteengineknitrrmarkdown vignetteencodingutf r setup includ fals optionstinytexverbos true knitropts_chunkset collaps true comment librarylatentcor introduct r packag latentcor util power semiparametr latent gaussian copula model estim latent correl mix data type packag allow estim correl continuousbinaryternaryzeroinfl truncat variabl type underli implement take advantag fast multilinear interpol scheme clever choic grid point give packag small memori footprint allow use latent correl subsampl bootstrap statement need r softwar packag current avail allow accur fast correl estim mix variabl data unifi manner r packag latentcor introduc thu repres first standalon r packag comput latent correl take account variabl type continuousbinaryordinalzeroinfl come optim memori footprint comput effici essenti make latent correl estim almost fast rankbas correl estim get start simpl exampl two variabl first gener pair variabl differ type use sampl size n serv exampl data first variabl ternari second variabl continu r data_gener simdata gen_datan type cter con output gen_data list element r data_output namessimdata x matrix time first column ternari variabl second column continu variabl r data_matrix x simdatax headx n l plotx null showplot fals chang display plot gener data ingen_data input r data_plot simdataplotx estim latent correl matrix base variabl use latentcor function r estim estim latentcorx type cter con output latentcor list sever element r estimation_output namesestim zratio list length number variabl first element time vector indic cumul proport zero one ternari variabl eg first element vector proport zero second element vector proport zero one second element list na continu variabl r zratio estimatezratio k kendal tau tau_a correl matrix variabl r kendal estimatek rpointwis matrix pointwis estim correl due pointwis estim rpointwis guarante posit semidefinit r latent_correlation_pointwis estimaterpointwis r estim final latent correl matrix matrix guarante strictli posit definit nearpd project paramet nu see mathemat framework estim usenearpd true r latent_correl estimat plotr null default showplot fals latentcor otherwis display heatmap latent correl matrix r heatmap estimateplotr exampl mtcar dataset use buildin dataset mtcar r mtcar headmtcar n l let take look uniqu valu variabl determin correspond data type r uniqu applymtcar tabl estim latent correl matrix variabl mtcar use latentcor function r mtcars_estim estimate_mtcar latentcormtcar type ccon ter con con con con con bin bin ter con note determin variabl type also done automat latentcor packag use get_typ function r mtcars_typ messag fals get_typesmtcar function run automat insid latentcor type suppli user howev automat determin type take extra time recommend specifi type explicitli known advanc output latentcor mtcar r mtcars_estimation_output namesestimate_mtcar zratio zratio correspond variabl mtcar r mtcars_zratio estimate_mtcarszratio k kendal tau tau_a correl matrix variabl mtcar r mtcars_kendal estimate_mtcarsk rpointwis matrix pointwis estim correl mtcar r mtcars_latent_correlation_pointwis estimate_mtcarsrpointwis r estim final latent correl matrix mtcar r mtcars_latent_correl estimate_mtcarsr plotr null default showplot fals latentcor otherwis display heatmap latent correl matrix mtcar see heatmap latent correl approx mtcarshttpsrpubscommingzehuang r mtcars_heatmap estimate_mtcarsplotr exampl use latentcor subsampl latentcor determin type variabl automat recommend call get_typ first suppli type explicitli save comput time especi use latentcor subsampl illustr first gener variabl differ type use sampl size n serv exampl data subsampl r data_gener simdata gen_datan type crepter con repbin use data subsampl recommend first run get_typ full data r type subsampl type get_typessimdatax type subsampl recommend explicitli suppli identifi type latentcor illustr use subsampl size r subsampl start_tim proctim select random subsampl size subsampl sampl estim latent correl subsampl specifi type rs latentcorsimdataxsubsampl type type proctim start_tim compar r subsampl start_tim proctim select random subsampl size subsampl sampl estim latent correl subsampl specifi type rs latentcorsimdataxsubsampl type null proctim start_tim refer gener roxygen edit hand pleas edit document rget_typesr nameget_typ aliasget_typ titleautomat determin type variabl continuousbinaryternarytrunc data matrix usag get_typesx tru_prop argument itemxa numer data matrix n p n number sampl p number variabl miss valu na allow itemtru_propa scalar indic minim proport zero present variabl treat codetru truncat type zeroinfl rather codecon continu type default valu variabl zero valu among n sampl treat truncat zeroinfl valu codeget_typ return item itemtyp vector length p indic type p variabl codex element one codecon continu codebin binari codet ternari codetru truncat descript automat determin type variabl continuousbinaryternarytrunc data matrix exampl x gen_datatyp cter conx get_typesx gener roxygen edit hand pleas edit document rlatentcorr namelatentcor aliaslatentcor titleestim latent correl mix type usag latentcor x type null method capprox origin usenearpd true nu tol e ratio showplot fals argument itemxa numer matrix numer data frame n p n number sampl p number variabl miss valu na allow case estim base pairwis complet observ itemtypesa vector length p indic type p variabl codex element must one codecon continu codebin binari codet ternari codetru truncat vector length p variabl assum type suppli default valu codenul variabl type determin automat use function codelinkget_typ automat determin variabl type take extra time recommend suppli type explicitli known advanc itemmethodth calcul method latent correl either codeorigin codeapprox codemethod approx multilinear approxim method use much faster origin method see yoon et al time comparison variou variabl type codemethod origin optim bridg invers function use default codeapprox itemusenearpdlog indic codeusenearpd true get nearest posit definit matrix estim latent correl matrix shrinkag adjust codenu output coder coderpointwis codeusenearpd fals default valu codetru itemnushrinkag paramet correl matrix must guarante minim eigenvalu return correl matrix greater equal codenu codenu shrinkag perform return correl matrix semiposit definit necessarili strictli posit definit codenu ident matrix return recommend default recommend valu itemtolwhen codemethod origin specifi desir accuraci bridg function invers via uniroot optim pass codelinkoptim default valu e codemethod approx paramet ignor itemratiowhen codemethod approx specifi boundari valu multilinear interpol must coderatio linear interpol perform slowest execut equival codemethod origin coderatio linear interpol alway perform fastest execut may lead high approxim error default recommend valu control approxim error fast execut see yoon et al detail codemethod origin paramet ignor itemshowplotlog indic codeshowplot true gener ggplot object codeplotr heatmap latent correl matrix coder codeplotr null codeshowplot fals default valu codefals valu codelatentcor return item itemzratio list length p correspond variabl return na continu variabl proport zero binarytrunc variabl cumul proport zero one eg first valu proport zero second valu proport zero one ternari variabl itemk p x p kendal tau taua matrix codex itemr p x p estim latent correl matrix codex itemrpointwis p x p pointwis estim latent correl codex matrix guarante semiposit definit origin estim latent correl matrix without adjust positivedefinit itemplotr heatmap plot latent correl matrix coder null codeshowplot fals descript estim latent correl matrix observ data possibl mix type continuousbinarytruncatedternari base latent gaussian copula model miss valu na allow estim base pairwis complet observ detail function estim latent correl calcul invers bridg function fan et al evalu valu sampl kendal tau eqnhat tau bridg function f connect kendal tau latent correl r eqnfr ehat tau form function f depend variabl type continuousbinarytruncatedternari exact exact form invers avail evalu numer pair variabl lead coderpointwis codemethod origin invers done numer solv deqnminimize_r fr hat tau use codelinkoptim paramet codetol use control accuraci solut codemethod approx invers done approxim interpol previous calcul store valu eqnfhat tau significantli faster origin method yoon et al binaryternarytrunc case howev approxim error may nonneglig region space paramet coderatio control region interpol perform default recommend valu give good balanc accuraci comput speed increas valu ratio may improv speed possibl sacrific accuraci wherea decreas valu ratio improv accuraci possibl sacrific speed see yoon et al vignett detail case pointwis estim coderpointwis neg eigenvalu project onto space posit semidefinit matric use codelinknearpd paramet codenu allow perform addit shrinkag toward ident matrix desir case number variabl p larg deqnr nu tild r nu eqntild r coderpointwis project codelinknearpd exampl exampl truncat data type type variabl gener data x gen_datan type reptru x estim latent correl matrix origin method check time start_tim proctim r_nc_org latentcorx x type tru method originalr proctim start_tim estim latent correl matrix approxim method check time start_tim proctim r_nc_approx latentcorx x type tru method approxr proctim start_tim heatmap latent correl matrix heatmap_r_nc_approx latentcorx x type tru method approx showplot trueplotr exampl ternarycontinu case x gen_datax estim latent correl matrix origin method r_nc_org latentcorx x type cter con method originalr estim latent correl matrix aprroxim method r_nc_approx latentcorx x type cter con method approxr refer fan j liu h ning zou h high dimension semiparametr latent graphic model mix data doirssb yoon g carrol rj gaynanova spars semiparametr canon correl analysi data mix type doibiometasaa yoon g müller cl gaynanova fast comput latent correl doi gener roxygen edit hand pleas edit document rgen_datar namegen_data aliasgen_data titlemix type simul data gener usag gen_data n type cter con rho copula xp null showplot fals argument itemna posit integ indic sampl size default valu itemtypesa vector indic type variabl could codecon continu codebin binari codetru truncat codet ternari number variabl determin base length type codep lengthtyp default valu codect con creat two variabl first one ternari second one continu itemrhosa vector lowertriangular element desir correl matrix eg coderho c mean correl matrix codematrixc scalar suppli codelengthrho equicorrel matrix assum pairwis correl equal coderho default valu mean correl two variabl itemcopulasa vector indic copula tramsform f p variabl eg u fz element take valu codeno f ident codeexpo exponenti transform codecub cubic transform vector length transform appli p variabl default valu codeno copula transform variabl itemxpa list length p indic proport zero binari truncat proport zero one ternari variabl continu variabl na suppli codenul follow valu automat gener element codexp list correspond data type continu variabl correspond valu na binari truncat variabl correspond valu number repres proport zero default valu ternari variabl correspond valu pair number first number indic proport zero second number indic proport one sum pair number default valu codec itemshowplotlog indic true gener plot data number variabl p default valu fals valu codegen_data return list contain item itemx gener data matrix n p observ variabl itemplotx visual data matrix x histogram codep scatter plot codep scatter plot codep return null codeshowplot fals descript gener data mix type latent gaussian copula model exampl gener singl continu variabl exponenti transform alway greater show histogram simdata gen_datan copula expo type con showplot fals x simdatax plotx simdataplotx gener pair variabl ternari continu default proport without copula transform simdata gen_data x simdatax gener variabl binari ternari truncat correspond copula variabl transform cube cube transform cube cube transform binari variabl zero ternari variabl zero one truncat variabl zero show scatter plot data point project either axi x axa x posit domain axi x simdata gen_datan rho c copula cno cube cube type cbin ter tru xp list c showplot true x simdatax plotx simdataplotx check proport zero binari variabl sumsimdatax check proport zero one ternari variabl sumsimdatax sumsimdatax check proport zero truncat variabl sumsimdatax refer fan j liu h ning zou h high dimension semiparametr latent graphicalmodel mix data doirssb yoon g carrol rj gaynanova spars semiparametr canon correl analysi data mix type doibiometasaa