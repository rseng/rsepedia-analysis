spagcn v spagcn integr gene express spatial locat histolog identifi spatial domain spatial variabl gene graph convolut network jian hu xiangji li kyle coleman amelia schroeder nan david j irwin edward b lee russel shinohara mingyao li spagcn graph convolut network integr gene express histolog identifi spatial domain spatial variabl gene jointli model spot tissu slide spagcn integr inform gene express spatial locat histolog pixel intens across spot undirect weight graph vertex graph contain gene express inform spot edg weight two vertic quantifi express similar driven spatial depend coordin correspond histolog aggreg gene express spot neighbor spot spagcn util convolut layer base edg weight specifi graph aggreg gene express fed deep embed cluster algorithm cluster spot differ spatial domain spatial domain identifi gene enrich spatial domain detect differenti express analysi domain spagcn applic insitu transcriptom singlecel resolut seqfish seqfish merfish starmap fisseq spatial barcod base transcriptom spatial transcriptom slideseq slideseqv hdst x visium dbitseq steroseq pixelseq data spagcn workflowdocsassertsimagesworkflowjpg br thorough detail see preprint biorxivhttpswwwbiorxivorgcontentv br usag spagcnhttpsgithubcomjianhuupennspagcn packag implement garph convolut network spatial transcriptom spagcn preprocess spatial transcriptom data variou format build graph convolut network deep iter cluster algorithm identifi spatial domain identifi spatial variabl gene spatial domain creat mete gene mark spatial domain tutori stepbystep tutori pleas refer br httpsgithubcomjianhuupennspagcnblobmastertutorialtutorialmd br jupyt notebook tutori access br httpsgithubcomjianhuupennspagcnblobmastertutorialtutorialipynb br toy data result download br httpsdrivegooglecomdrivefoldersztenvkjorptidapqgauteyuspshar br pleas instal jupyt order open notebook new featur ez mode spagcn avail user new python provid easi mode spagcn paramet set intermedium step simplifi br import note easi mode basic function analysi purpos br method comparison debug custom paramet check intermedium output pleas refer detail tutori br easi mode spagcn tutori br httpsgithubcomjianhuupennspagcnblobmastertutorialtutorial_ez_modemd br easi mode spagcn jupyt notebook br httpsgithubcomjianhuupennspagcnblobmastertutorialtutorial_ez_modeipynb br system requir python support packag igraph torch panda numpi scipi scanpi anndata louvain sklearn version softwar test environ system mac os python python packag panda numpi numba pythonigraphtorchlouvainscipi scanpi anndata post natsort sklearn environ system anaconda python python packag panda numpi pythonigraph torchlouvain scipi scanpi anndata natsort sklearn environ system anaconda python python packag panda numpi pythonigraph torch louvain scipi scanpi anndata natsort sklearn contribut souc code githubhttpsgithubcomjianhuupennspagcn continu ad new featur bug report featur request welcom last updat version refer pleas consid cite follow refer httpswwwnaturecomarticless br data download httpsdrivegooglecomdrivefoldersztenvkjorptidapqgauteyuspsharinghcenterspagcn easi mode tutorialcenterh centerauthor jian hu xiangji li kyle coleman amelia schroeder nan david j irwin edward b lee russel shinohara mingyao li outlin installationhttpsgithubcomjianhuupennspagcnblobmastertutorialtutorial_ez_modemdinstal import moduleshttpsgithubcomjianhuupennspagcnblobmastertutorialtutorial_ez_modemdimportmodul read datahttpsgithubcomjianhuupennspagcnblobmastertutorialtutorial_ez_modemdreadindata spatial domain detect use spagcnhttpsgithubcomjianhuupennspagcnblobmastertutorialtutorial_ez_modemdspatialdomaindetectionusingspagcn identifi svgshttpsgithubcomjianhuupennspagcnblobmastertutorialtutorial_ez_modemdidentifysvg identifi meta genehttpsgithubcomjianhuupennspagcnblobmastertutorialtutorial_ez_modemdidentifymetagen br instal instal take minut normal comput instal spagcn packag must make sure python version dont know version python check python import platform platformpython_vers note spagcn pend pytorch make sure torch correctli instal br instal current releas spagcn follow three way pypi directli instal packag pypi python pip instal spagcn note need make sure pip pythonor instal spagcn python pip instal spagcn permiss get permiss deni error instal spagcn pip instal user spagcn github download packag github instal local python git clone httpsgithubcomjianhuupennspagcn cd spagcnspagcn_packag python setuppi instal user anaconda python python instal consid instal anaconda instal anaconda creat new environ exampl spagcn chang name like python creat environ call spagcn conda creat n spagcn python activ environ conda activ spagcn git clone httpsgithubcomjianhuupennspagcn cd spagcnspagcn_packag python setuppi build python setuppi instal conda deactiv import modul python import oscsvr import panda pd import numpi np import scanpi sc import math import spagcn spg scipyspars import isspars import random torch import warn warningsfilterwarningsignor import matplotlibcolor clr import matplotlibpyplot plt import spagcn spg order read imag data need instal packag recommend packag opencv inatl opencv python pip instal opencvpython import cv python spg__version__ read data current version spagcn requr three input data gene express matrixn k expression_matrixh spatial coordin samplespositionstxt histolog imageopt histologytif tif png jepg gene exprees data store anndata object anndata store data matrix x togeth annot observ ob variabl var unstructur annot un python read origin data save scanpi import read_x_h adata read_x_htutorialdataexpression_matrixh spatialpdread_csvtutorialdatapositionstxtsepheadernonena_filterfalseindex_col adataobsxspati adataobsxspati adataobsxspati adataobsxspati adataobsxspati select captur sampl adataadataadataobsx adatavar_namesiupp listadatavar_nam adatavargenenameadatavarindexastypestr adatawrite_hadtutorialdatasample_datahad read gene express spatial locat adatascreadtutorialdatasample_datahad read hitolog imag imgcvimreadtutorialdatahistologytif spatial domain detect use spagcn paramet determin weight given histolog calcul euclidean distanc everi two spot mean histolog pixel intens valu scale varianc xy coordin wherea higher valu indic higher scale varianc henc higher weight histolog calcul euclidean distanc b paramet determin area spot extract color intens n_cluster number spatial domain want re resolut initi louvain cluster method number cluster known use spgsearch_r fnction search suitabl resolutionopt python set coordin adataobsx_arrayadataobsx adataobsy_arrayadataobsx adataobsx_pixeladataobsx adataobsy_pixeladataobsx x_arrayadataobsx_arraytolist y_arrayadataobsy_arraytolist x_pixeladataobsx_pixeltolist y_pixeladataobsy_pixeltolist run spagcn adataobspr spgdetect_spatial_domains_ez_modeadata img x_array y_array x_pixel y_pixel n_cluster histologytru b p r_seed t_seed n_seed adataobspredadataobspredastypecategori refin domain option shapehexagon visium data squar st data adataobsrefined_predspgspatial_domains_refinement_ez_modesample_idadataobsindextolist predadataobspredtolist x_arrayx_array y_arrayy_array shapehexagon adataobsrefined_predadataobsrefined_predastypecategori plot spatial domain python plot_colorffebceebedddddaceaedbcceaaaffccfbdfdabfc axspgplot_spatial_domains_ez_modeadata domain_namepr x_namey_pixel y_namex_pixel plot_colorplot_colorsizeadatashap showfals savetruesave_dirsample_resultspredpng axspgplot_spatial_domains_ez_modeadata domain_namerefined_pr x_namey_pixel y_namex_pixel plot_colorplot_colorsizeadatashap showfals savetruesave_dirsample_resultsrefined_predpng spatial domainssample_resultspredpng refin spatial domainssample_resultsrefined_predpng identifi svg target target domain identifi svg min_in_group_fract minium ingroup express fraction min_in_out_group_ratio miniumn ingroup express fraction outgroup express fraction min_fold_chang miniumn ingroup express outgroup express r radiu detect spot neighbor spotstarget target domain identifi svg python target read raw data adatascreadtutorialsample_resultsresultshad rawscreadtutorialdatasample_datahad preprocess rawvar_names_make_uniqu rawobspredadataobspredastypecategori rawobsx_arrayrawobsx rawobsy_arrayrawobsx rawobsx_pixelrawobsx rawobsy_pixelrawobsx rawxrawxa issparserawx els rawx rawrawraw scpplogpraw set filter criteri min_in_group_fract min_in_out_group_ratio min_fold_chang filtered_infospgdetect_svgs_ez_moderaw target x_namex_array y_namey_array domain_namepr min_in_group_fractionmin_in_group_fract min_in_out_group_ratiomin_in_out_group_ratio min_fold_changemin_fold_chang python filtered_info div tabl border classdatafram thead tr styletextalign right thth thgenesth thin_group_fractionth thout_group_fractionth thin_out_group_ratioth thin_group_mean_expth thout_group_mean_expth thfold_changeth thpvals_adjth thtarget_dmainth thneighborsth tr thead tbodi tr thth tdcamkntd tdtd tdtd tdtd tdtd tdtd tdtd tdetd tdtd td td tr tr thth tdenctd tdtd tdtd tdtd tdtd tdtd tdtd tdetd tdtd td td tr tr thth tdgpmatd tdtd tdtd tdtd tdtd tdtd tdtd tdetd tdtd td td tr tr thth tdarpptd tdtd tdtd tdtd tdtd tdtd tdtd tdetd tdtd td td tr tr thth tdhpcaltd tdtd tdtd tdtd tdtd tdtd tdtd tdetd tdtd td td tr tbodi tabl div plot python color_self clrlinearsegmentedcolormapfrom_listpink_green abeaeccfd n spgplot_svgs_ez_modeadataraw gene_listfiltered_infogenestolist x_namey_pixel y_namex_pixel plot_colorcolor_self size showfals savetru save_dirsample_result camknsample_resultscamknpng encsample_resultsencpng gpmasample_resultsgpmapng arppcarpppng hpcalsample_resultshpcalpng identifi meta gene target target domain detect meta gene start_gen gene satrt candid start gene found lower filter criteri python target rawobsmetaspgdetect_meta_genes_ez_moderaw target x_namex_array y_namey_array domain_namepr start_genegfap use_rawfals plot python spgplot_meta_genes_ez_moderaw x_namey_pixel y_namex_pixel meta_namemeta plot_colorcolor_self size showfals savetru save_dir startsample_resultsgfappng meta genesample_resultsmeta_genepng hcenterspagcn tutorialcenterh centerjian hu xiangji li kyle coleman amelia schroeder nan david j irwin edward b lee russel shinohara mingyao li outlin installationhttpsgithubcomjianhuupennspagcnblobmastertutorialtutorialmdinstal import moduleshttpsgithubcomjianhuupennspagcnblobmastertutorialtutorialmdimportmodul read datahttpsgithubcomjianhuupennspagcnblobmastertutorialtutorialmdreadindata integr gene express histolog graphhttpsgithubcomjianhuupennspagcnblobmastertutorialtutorialmdintegrategeneexpressionandhistologyintoagraph spatial domain detect use spagcnhttpsgithubcomjianhuupennspagcnblobmastertutorialtutorialmdspatialdomaindetectionusingspagcn identifi svgshttpsgithubcomjianhuupennspagcnblobmastertutorialtutorialmdidentifysvg identifi meta genehttpsgithubcomjianhuupennspagcnblobmastertutorialtutorialmdidentifymetagen multipl tissu section analysishttpsgithubcomjianhuupennspagcnblobmastertutorialtutorialmdmultipletissuesectionsanalysi br instal instal take minut normal comput instal spagcn packag must make sure python version dont know version python check python import platform platformpython_vers note spagcn pend pytorch make sure torch correctli instal br instal current releas spagcn follow three way pypi directli instal packag pypi python pip instal spagcn note need make sure pip pythonor instal spagcn python pip instal spagcn permiss get permiss deni error instal spagcn pip instal user spagcn github download packag github instal local python git clone httpsgithubcomjianhuupennspagcn cd spagcnspagcn_packag python setuppi instal user anaconda python python instal consid instal anaconda instal anaconda creat new environ exampl spagcn chang name like python creat environ call spagcn conda creat n spagcn python activ environ conda activ spagcn git clone httpsgithubcomjianhuupennspagcn cd spagcnspagcn_packag python setuppi build python setuppi instal conda deactiv import modul python import oscsvr import panda pd import numpi np import scanpi sc import math import spagcn spg scipyspars import isspars import random torch import warn warningsfilterwarningsignor import matplotlibcolor clr import matplotlibpyplot plt import spagcn spg order read imag data need instal packag recommend packag opencv inatl opencv python pip instal opencvpython import cv python spg__version__ read data current version spagcn requr three input data gene express matrixn k expression_matrixh spatial coordin samplespositionstxt histolog imageopt histologytif tif png jepg gene exprees data store anndata object anndata store data matrix x togeth annot observ ob variabl var unstructur annot un python read origin data save scanpi import read_x_h adata read_x_htutorialdataexpression_matrixh spatialpdread_csvtutorialdatapositionstxtsepheadernonena_filterfalseindex_col adataobsxspati adataobsxspati adataobsxspati adataobsxspati adataobsxspati adataobsx_arrayadataobsx adataobsy_arrayadataobsx adataobsx_pixeladataobsx adataobsy_pixeladataobsx select captur sampl adataadataadataobsx adatavar_namesiupp listadatavar_nam adatavargenenameadatavarindexastypestr adatawrite_hadtutorialdatasample_datahad read gene express spatial locat adatascreadtutorialdatasample_datahad read hitolog imag imgcvimreadtutorialdatahistologytif integr gene express histolog graph python set coordin x_arrayadataobsx_arraytolist y_arrayadataobsy_arraytolist x_pixeladataobsx_pixeltolist y_pixeladataobsy_pixeltolist test coordin imag img_newimgcopi rangelenx_pixel xx_pix yy_pix img_newintxintx intyinti cvimwritesample_results_mapjpg img_new paramet determin weight given histolog calcul euclidean distanc everi two spot mean histolog pixel intens valu scale varianc xy coordin wherea higher valu indic higher scale varianc henc higher weight histolog calcul euclidean distanc bparamet determin area spot extract color intens python calcul adjac matrix b adjspgcalculate_adj_matrixxx_pixelyy_pixel x_pixelx_pixel y_pixely_pixel imageimg betab alpha histologytru histlog imag avail spagcn calcul adjac matrix use fnction adjcalculate_adj_matrixxx_pixelyy_pixel histologyfals npsavetxtdataadjcsv adj delimit calcul adj matrix use histolog imag var ccc var xyz spatial domain detect use spagcn express data preprocess python adatascreaddatasample_datahad adjnploadtxtdataadjcsv delimit adatavar_names_make_uniqu spgprefilter_genesadatamin_cel avoid gene zero spgprefilter_specialgenesadata normal take log umi scppnormalize_per_celladata scpplogpadata set hyperparamet p percentag total express contribut neighborhood l paramet control p python p find l valu given p lspgsearch_lp adj start end tol max_run run l p run l p run l p run l p run l p run l p run l p run l p run l p run l p recommend l n_cluster number spatial domain want re resolut initi louvain cluster method number cluster known use spgsearch_r fnction search suitabl resolutionopt python toy data set number cluster sinc tissu layer n_cluster set seed r_seedt_seedn_se search suitabl resolut resspgsearch_resadata adj l n_cluster start step tole lr max_epoch r_seedr_se t_seedt_se n_seedn_se start re step initi cluster center louvain resolut epoch epoch re num cluster recommend re run spagcn python clfspgspagcn clfset_ll set seed randomseedr_se torchmanual_seedt_se nprandomseedn_se run clftrainadataadjinit_spatrueinitlouvainresr tole lr max_epoch y_pred probclfpredict adataobspr y_pred adataobspredadataobspredastypecategori cluster refinementopt shapehexagon visium data squar st data adj_dspgcalculate_adj_matrixxx_arrayyy_array histologyfals refined_predspgrefinesample_idadataobsindextolist predadataobspredtolist disadj_d shapehexagon adataobsrefined_predrefined_pr adataobsrefined_predadataobsrefined_predastypecategori save result adatawrite_hadsample_resultsresultshad initi cluster center louvain resolut epoch epoch epoch epoch epoch epoch epoch epoch epoch epoch epoch epoch epoch epoch epoch epoch epoch epoch epoch epoch calcul adj matrix use xy plot spatial domain python adatascreadsample_resultsresultshad adataob contain two column x_pixel y_pixel set color use plot_colorffebceebedddddaceaedbcceaaaffccfbdfdabfc plot spatial domain domainspr num_celltypelenadataobsdomainsuniqu adataunsdomains_colorslistplot_colornum_celltyp axscplscatteradataalphaxy_pixelyx_pixelcolordomainstitledomainscolor_mapplot_colorshowfalsesizeadatashap axset_aspectequ box axaxesinvert_yaxi pltsavefigsample_resultspredpng dpi pltclose plot refin spatial domain domainsrefined_pr num_celltypelenadataobsdomainsuniqu adataunsdomains_colorslistplot_colornum_celltyp axscplscatteradataalphaxy_pixelyx_pixelcolordomainstitledomainscolor_mapplot_colorshowfalsesizeadatashap axset_aspectequ box axaxesinvert_yaxi pltsavefigsample_resultsrefined_predpng dpi pltclose spatial domainssample_resultspredpng refin spatial domainssample_resultsrefined_predpng identifi svg python read raw data rawscreadtutorialdatasample_datahad rawvar_names_make_uniqu rawobspredadataobspredastypecategori rawobsx_arrayrawobsx rawobsy_arrayrawobsx rawobsx_pixelrawobsx rawobsy_pixelrawobsx convert spars matrix nonspars rawxrawxa issparserawx els rawx rawrawraw scpplogpraw target target domain identifi svg min_in_group_fract minium ingroup express fraction min_in_out_group_ratio miniumn ingroup express fraction outgroup express fraction min_fold_chang miniumn ingroup express outgroup express r radiu detect spot neighbor spot python use domain exampl target set filter criteri min_in_group_fract min_in_out_group_ratio min_fold_chang search radiu spot target domain approxim neighbor averag adj_dspgcalculate_adj_matrixxx_array yy_array histologyfals start end npquantileadj_dadj_dq npquantileadj_dadj_dq rspgsearch_radiustarget_clustertarget cell_idadataobsindextolist xx_array yy_array predadataobspredtolist startstart endend num_min num_max max_run detect neighbor domain nbr_domiansspgfind_neighbor_clusterstarget_clustertarget cell_idrawobsindextolist xrawobsx_arraytolist yrawobsy_arraytolist predrawobspredtolist radiusr ratio nbr_domiansnbr_domian de_genes_infospgrank_genes_groupsinput_adataraw target_clustertarget nbr_listnbr_domian label_colpr adj_nbrtru logtru filter gene de_genes_infode_genes_infode_genes_infopvals_adj filtered_infode_genes_info filtered_infofiltered_infofiltered_infopvals_adj filtered_infoin_out_group_ratiomin_in_out_group_ratio filtered_infoin_group_fractionmin_in_group_fract filtered_infofold_changemin_fold_chang filtered_infofiltered_infosort_valuesbyin_group_fract ascendingfals filtered_infotarget_dmaintarget filtered_infoneighborsstrnbr_domian printsvg domain strtarget filtered_infogenestolist calcul adj matrix use xy calcul adj matrix use xy calcul adj matrix use xy run radiu num_nbr calcul adj matrix use xy run radiu num_nbr calcul adj matrix use xy run radiu num_nbr calcul adj matrix use xy run radiu num_nbr calcul adj matrix use xy run radiu num_nbr calcul adj matrix use xy recommend radiu num_nbr radiu averag number neighbor spot cluster neighbor dmain dmain svg domain camkn enc gpma arpp hpcal python filtered_info tabl border classdatafram thead tr styletextalign right thth thgenesth thin_group_fractionth thout_group_fractionth thin_out_group_ratioth thin_group_mean_expth thout_group_mean_expth thfold_changeth thpvals_adjth thtarget_dmainth thneighborsth tr thead tbodi tr thth tdcamkntd tdtd tdtd tdtd tdtd tdtd tdtd tdetd tdtd td td tr tr thth tdenctd tdtd tdtd tdtd tdtd tdtd tdtd tdetd tdtd td td tr tr thth tdgpmatd tdtd tdtd tdtd tdtd tdtd tdtd tdetd tdtd td td tr tr thth tdarpptd tdtd tdtd tdtd tdtd tdtd tdtd tdetd tdtd td td tr tr thth tdhpcaltd tdtd tdtd tdtd tdtd tdtd tdtd tdetd tdtd td td tr tbodi tabl div python plot refinedspati domain color_self clrlinearsegmentedcolormapfrom_listpink_green abeaeccfd n g filtered_infogenestolist rawobsexprawxrawvarindexg axscplscatterrawalphaxy_pixelyx_pixelcolorexptitlegcolor_mapcolor_selfshowfalsesizerawshap axset_aspectequ box axaxesinvert_yaxi pltsavefigsample_resultsgpng dpi pltclose camknsample_resultscamknpng encsample_resultsencpng gpmasample_resultsgpmapng arppsample_resultsarpppng hpcalsample_resultshpcalpng identifi meta gene python use domain exampl target meta_nam meta_expspgfind_meta_geneinput_adataraw predrawobspredtolist target_domaintarget start_genegfap mean_diff early_stoptru max_it use_rawfals rawobsmetameta_exp add gene mgp minu gene fth absolut mean chang number nontarget spot reduc meta gene gfapmgpfth add gene myl minu gene mbp absolut mean chang number nontarget spot reduc meta gene gfapmgpfthmylmbp add gene krt minu gene mtatp absolut mean chang number nontarget spot reduc meta gene gfapmgpfthmylmbpkrtmtatp python plot meta gene ggfap rawobsexprawxrawvarindexg axscplscatterrawalphaxy_pixelyx_pixelcolorexptitlegcolor_mapcolor_selfshowfalsesizerawshap axset_aspectequ box axaxesinvert_yaxi pltsavefigsample_resultsgpng dpi pltclose rawobsexprawobsmeta axscplscatterrawalphaxy_pixelyx_pixelcolorexptitlemeta_namecolor_mapcolor_selfshowfalsesizerawshap axset_aspectequ box axaxesinvert_yaxi pltsavefigsample_resultsmeta_genepng dpi pltclose startsample_resultsgfappng meta genesample_resultsmeta_genepng multipl tissu section analysi section show exampl analysi multipl adjac tissu section use spagcn mous brain anteriorsample_resultsma_lowrespng mous brain posteriorsample_resultsmp_lowrespng read data python adatascreaddatamouse_brainmahad adatascreaddatamouse_brainmphad imgcvimreaddatamouse_brainma_histologytif imgcvimreaddatamouse_brainmp_histologytif extract color intens python b x_pixeladataobsxtolist y_pixeladataobsxtolist adataobscolorspgextract_colorx_pixelx_pixel y_pixely_pixel imageimg betab z_scalenpmaxnpstdx_pixel npstdy_pixel adataobszadataobscolornpmeanadataobscolornpstdadataobscolorz_scal x_pixeladataobsxtolist y_pixeladataobsxtolist adataobscolorspgextract_colorx_pixelx_pixel y_pixely_pixel imageimg betab z_scalenpmaxnpstdx_pixel npstdy_pixel adataobszadataobscolornpmeanadataobscolornpstdadataobscolorz_scal del img img modifi coordin combin section python anndata import anndata adataobsx_pixelx_pixel adataobsy_pixely_pixel adataobsx_pixelx_pixelnpminx_pixelnpminx_pixel adataobsy_pixely_pixelnpminy_pixelnpmaxy_pixel adatavar_names_make_uniqu adatavar_names_make_uniqu adata_allanndataconcatenateadata adatajoininnerbatch_keydataset_batchbatch_categori integr gene express histolog graph python xnparrayadata_allobsx_pixel adata_allobsy_pixel adata_allobsztastypenpfloat adjspgpairwise_distancex spatial domain detect use spagcn python scppnormalize_per_celladata_al min_count scpplogpadata_al p find l valu given p lspgsearch_lp adj start end tol max_run run l p run l p run l p run l p run l p run l p run l p run l p recommend l python re seed randomseedse torchmanual_seedse nprandomseedse clfspgspagcn clfset_ll clftrainadata_alladjinit_spatrueinitlouvainresr tole lr max_epoch y_pred probclfpredict adata_allobspr y_pred adata_allobspredadata_allobspredastypecategori initi cluster center louvain resolut epoch epoch epoch epoch delta_label tol reach toler threshold stop train total epoch python colors_usefb fffe cac bd cb ec bcbd becf aec ffbb dfa ff becd bb ff ffff fb db becd dbcc bb eb afe e bbbe eafb eb dfa c dd cdec eadc fbd ef fcfc cded deae feeb fce fcd num_celltypelenadata_allobspreduniqu adata_allunspred_colorslistcolors_usenum_celltyp axscplscatteradata_allalphaxy_pixelyx_pixelcolorpredshowfalsesizeadata_allshap axset_aspectequ box axaxesinvert_yaxi pltsavefigsample_resultsmouse_barin_muti_sections_domainspng dpi pltclose spagcn mous brain combinessample_resultsmouse_barin_muti_sections_domainspng spagcn spagcn integr gene express histolog identifi spatial domain spatial variabl gene use graph convolut network jian hu xiangji li kyle coleman amelia schroeder nan david j irwin edward b lee russel shinohara mingyao li spagcn graph convolut network integr gene express histolog identifi spatial domain spatial variabl gene jointli model spot tissu slide spagcn integr inform gene express spatial locat histolog pixel intens across spot undirect weight graph vertex graph contain gene express inform spot edg weight two vertic quantifi express similar driven spatial depend coordin correspond histolog aggreg gene express spot neighbor spot spagcn util convolut layer base edg weight specifi graph aggreg gene express fed deep embed cluster algorithm cluster spot differ spatial domain spatial domain identifi gene enrich spatial domain detect differenti express analysi domain spagcn applic insitu transcriptom singlecel resolut seqfish seqfish merfish starmap fisseq spatial barcod base transcriptom spatial transcriptom slideseq slideseqv hdst x visium dbitseq steroseq pixelseq data info pleas go httpsgithubcomjianhuupennspagcn