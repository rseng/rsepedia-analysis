cumul histori analysi bistabl percept time seri badg start doihttpszenodoorgbadgesvghttpszenodoorgbadgelatestdoi cran statushttpswwwrpkgorgbadgesversionbistablehistoryhttpscranrprojectorgpackagebistablehistori badg end packag comput cumul histori timeseri perceptu domin bistabl display estim cumul histori estim accumul adaptationpredict error domin percept timeseri continu view bistabl perceptu rivalri display comput cumul histori via homogen first order differenti process ie assum exponenti growthdecay histori function time perceptu domin state support gamma log normal normal distribut famili detail rational pleas refer pastukhov braun httpsdoiorg instal current stabl version use r installpackagesbistablehistori master branch develop version instal pleas use r librarydevtool install_githubalexanderpastukhovbistablehistori depend true note packag use stanhttpsmcstanorg stateoftheart platform statist model highperform statist comput therefor depend packag rstantoolshttpscranrprojectorgpackagerstantool turn depend rstanhttpscranrprojectorgpackagerstan packag use v javascript libraryhttpsvdev v r packagehttpscranrprojectorgpackagev therefor need instal v javascript librari system recommend also instal v r packag beforehand detail instruct pleas see httpsgithubcomjeroenv also need r packag curlhttpscranrprojectorgpackagecurl depend libcurl variou oper system pleas see document httpscranrprojectorgpackagecurl usag main function fit_cumhist take data frame timeseri first argument minim need specifi state string column name encod perceptu domin state either durat column name durat individu domin phase onset column name onset time individu domin phase thu simplest case singl subject singl runblock measur default gamma distribut fit cumul histori time constant fix mix state valu histori mix proport call would r librarybistablehistori databr_singleblock gamma_fit fit_cumhistbr_singleblock state state durat durat equival r librarybistablehistori databr_singleblock gamma_fit fit_cumhistbr_singleblock state state onset time look fit valu histori time constant via r history_taugamma_fit main effect histori paramet gamma distribut r coefgamma_fit detail pleas see vignett packag usag usag exampleshttpscranrprojectorgpackagebistablehistoryvignettesusageexampleshtml cumul historyhttpscranrprojectorgpackagebistablehistoryvignettescumulativehistoryhtml exampl write stan code directli write stan codehttpscranrprojectorgpackagebistablehistoryvignetteswritingstancodehtml bistablehistori first cran releas initi cran releas bistablehistori improv custom prior valu histori paramet intercept term histori effect fix effect simplifi stan code predict comput valu histori reduc fit object size predict return vector length match origin tabl bug fix chang differ histori valu instead weight mean use scale instead rate predict gamma famili spell document addit test bistablehistori improv posterior sampl cumul histori titl cumul histori author alexand sasha pastukhov date r sysdat output rmarkdownhtml_vignett bibliographi cumulativehistorybib vignett vignetteindexentrycumul histori vignetteengineknitrrmarkdown vignetteencodingutf r setup includ fals knitropts_chunkset collaps true echo fals warn fals messag fals comment librarydplyr libraryggplot certain stimuli necker cube depict compat sever typic two compar like perceptu interpret case necker cube one perceiv upward downward continu view percept altern altern altern schemat depict right r outwidth figaligncent knitrinclude_graphicsncstimuluspng distribut socal domin phase typic rightskew distribut frequent fit use gamma distribut r outwidth figaligncent knitrinclude_graphicsgammadistributionpng howev individu domin phase show subtl consist serial depend see exampl vane serial depend thought reflect accumul slow adapt pastukhov predict error weilnhamm domin percept slow accumul process describ via homogen first order process brief summari formula exampl accumul time differ initi valu signal strength time constant present detail pleas refer pastukhovbraun cumul histori perceptu state comput via homogen first order process detail first order linear differenti equat pleas refer chapter wilson tagfracdh_idt fractau h_i s_it tau time constant h_i cumul histori s_it current signal level isupthsup perceptu state tag st begincas textif state domin textif state suppress s_mix textif mixedtransit phase s_mix endcas s_mix correspond mixed_st paramet either specifi fit_cumhist function use default fit gener solut equat see theorem wilson chapter page tagh_it ettau fractau int_t etttau st dt chosen satisfi initi condit assum constant signal obtain tagh_it ettau s_i cdot ettau cumul histori interest h_it delta chang follow domin phase start time end time delta constant signal strength s_i assum domin phase start substitut equat h_i word constant equal cumul histori state domin phase onset therefor rel signal strength domin phase determin differ signal strength initi cumul histori valu s_i h_i thu tag h_idelta h_i h_i cdot edelta ttau tag h_idelta h_i cdot edelta ttau figur show accumul time three differ initi valu x signal strength time constant tau note packag allow either specifi fit time constant argument tau fit_cumhist function initi histori valu block history_init argument r figwidth figheight outwidth figaligncent seq lengthout df dataframeh c c tau c group_byh tau summariseh h tau tau h h expt tau paramet sprintfh f f tau h tau groupskeep ggplotdf aesxt yh colorparamet geom_lin xlabdt ylabht Î´t ylabht ut ylim themelegendpositiontop bistabl case two histori state one perceptu state comput histori differ cumul histori tagdelta ht tau h_suppressedt tau h_dominantt tau h_domin h_suppress histori state current domin suppress state respect _eg_ left eye domin follow phase h_domin h_left h_suppress h_right vice versa refer div idrefsdiv titl usag exampl output rmarkdownhtml_vignett bibliographi usageexamplesbib vignett vignetteindexentryusag exampl vignetteengineknitrrmarkdown vignetteencodingutf r includ fals knitropts_chunkset collaps true warn fals messag fals comment minim exampl main function fit_cumhist take data frame timeseri first argument addit need specifi name column code perceptu state state argument column hold either domin phase durat durat onset onset code fit data use gamma distribut default famili singl run singl particip default function fit cumul histori time constant use default fix mix state valu mixed_st initi histori valu history_init r minim exampl durat warn fals messag fals librarybistablehistori databr_singleblock gamma_fit fit_cumhistbr_singleblock statest durationdur refresh altern specifi _onset_ individu domin phase use comput durat r evalfals gamma_fit fit_cumhistbr_singleblock statest onsettim look fit valu histori time constant use history_tau r history_taugamma_fit main effect histori paramet gamma distribut r historyefgamma_fit follow model fit exampl see also companion vignettecumulativehistoryhtml detail cumul histori comput durationi sim gammashapei ratei logshapei alphashap betashape_h cdot delta hi logratei alphar betarate_h cdot delta hi delta hi textcumulative_historytau texthistory_init alphashap alphar sim normallog betashape_h betarate_h sim normal tau sim normallog pass stan control paramet pass stan control paramet via control argument eg r evalfals gamma_fit fit_cumhistbr_singleblock statest durationdur controllistmax_treedepth adapt_delta see stan document detail carpent run default fit_cumhist function assum timeseri repres singl run histori state initi begin use run argument pass name column specifi individu run case histori initi begin everi run avoid spillov effect r evalfals gamma_fit fit_cumhistbr_single_subject statest onsettim runblock experiment session experiment session specifi timeseri measur togeth use comput averag domin phase durat turn use comput cumul histori tau_h tau cdot tau normal time constant mean domin phase durat use account chang overal altern rate differ session day exampl particip new stimuli tend speed cours day suzuki _do not_ specifi session paramet singl mean domin phase durat comput run singl subject random effect random_effect argument allow specifi name column code random effect eg particip ident bistabl display differ display use singl particip etc specifi use fit hierarch model random slope _histori effect_ beta_h note random _independent_ intercept use prior research suggest larg differ overal altern rate particip brascamp r code specifi particip random effect r evalfals gamma_fit fit_cumhistkde_two_observ statest durationdur random_effectobserv runblock correspond model specifi shape paramet ident formula use rate paramet well r_i code random effect level particip ident noncent parametr use pool random slope durationi sim gammashapei ratei logshapei alphar_i beta_hr_i cdot delta hi delta hi textcumulative_historytau texthistory_init alphar_i sim normallog beta_hr_i betapop_h betaz_hr_i cdot sigmapop_h betapop_h sim normal betaz_hr_i sim normal sigmapop_h sim exponenti tau sim normallog ident approach take tau tau random specifi hold mixed_st random argument see fix effect fit_cumhist function allow specifi multipl fix effect term vector string implement restrict continu metric independ variabl use singl valu fit main effect irrespect whether random effect specifi specifi interact either fix effect fix effect cumul histori variabl although limit usabl fix effect restrict allow simpler model specif simpler underli code requir complex model pleas refer companion vignettewritingstancodehtml provid exampl write model use stan directli specifi custom prior mean standard deviat prior normal distribut via history_effect_prior fixed_effects_prior argument former accept vector mean standard deviat wherea latter take name list format codelistfix paramet namecmean std fit use fixef function extract posterior distribut summari effect cumul histori paramet fit_cumhist function take three paramet cumul histori comput see also companion vignettecumulativehistoryhtml tau _normalized_ time constant unit mean domin phase durat mixed_st valu use mixedtransit state phase default history_init initi valu cumul histori onset run default note although history_init accept fix valu either singl valu use state vector two contrast fix fit valu use three paramet possibl function argument valu singl posit number tau singl number within rang mixed_st case valu use directli cumul histori comput default option mixed_st null singl valu fit use particip run default tau random _independent_ tau fit random cluster particip display etc random_effect argument must specifi random valu individu random cluster sampl fit popul distribut _pooled_ valu random_effect argument must specifi specifi custom prior cumul histori paramet via history_prior argument specifi mean standard deviat prior normal distribut history_prior argument must name list codelistparamet namecmean std eg history_prior listtauc fit use history_tau history_mixed_statefunct obtain posterior distribut summari paramet distribut famili fit_cumhist current support three distribut gamma lognorm normal gamma durationi sim gammashapei ratei gamma distribut independ linear model log link function fit shape rate paramet prior intercept paramet alpha normallog lognorm durationi sim lognormalmui sigma mu paramet comput via linear model log link function prior intercept alpha normallog prior sigma sigma sim exponenti normal durationi sim normalmui sigma mu paramet comput via linear model prior intercept alpha normal prior sigma sigma sim exponenti model comparison model fit compar via inform criteria specif log likelihood store log_lik paramet directli use looextract_log_lik function see packag loo use comput either leaveoneout crossvalid via loo conveni function waic via waic inform criteria use model comparison way akaik aic bayesian bic devianc dic inform criteria latter also comput log likelihood howev waic loocv prefer multilevel model see vehtari model comparison perform via looloo_compar function loo packag predict valu predict durat individu domin phase via predict function option get summari averag expect durat plu option credibl interv comput predict durat everi sampl summari statist credibl interv r evalfals predict predictgam_fit summari true prob c predict everi sampl _full length timeseries_ invalid sampl fill na r evalfals prediction_sampl predictgam_fit summari fals full_length true predict everi sampl valid sampl r evalfals prediction_sampl predictgam_fit summari fals full_length fals comput use cumul histori interest cumul histori extract fit object via predict_histori function note five differ histori type extract cumul histori first perceptu state ie state index cumul histori second perceptu state ie state index domin state domin follow phase suppress state suppress follow phase differ differ cumul histori delta h h_suppress hdomin use linear model r evalfals h predict_historygam_fit differ altern skip fit comput histori directli use predefin valu via compute_histori r evalfals df compute_historybr_singleblock statest durationdur tau mixed_st history_init refer div idrefsdiv titl write stan code output rmarkdownhtml_vignett vignett vignetteindexentrywrit stan code vignetteengineknitrrmarkdown vignetteencodingutf r includ fals knitropts_chunkset collaps true comment packag allow limit model eg neither random slope interact effect allow impos restrict design decis would requir duplic function gener purpos packag instead packag provid basic fit suffici simpl case howev find exampl incorpor cumul histori model written stan way achiev maxim flexibl still save time reus code stan model complet stan code model lognorm distribut multipl run singl experiment session singl particip histori timeconst tau fit wherea constant use cumul histori paramet stan outputvarexample_model evalfals data complet timeseri intlow rowsn number row complet multitimeseri tabl includ mix phase real durationrowsn durat dominancetransit phase int istaterowsn index domin istat code two compet clear state transitionmix int is_usedrowsn whether histori valu must use predict durat ignor mix phase warmup period last etc int run_startrowsn mark begin new timeseri runblocketc real session_tmeanrowsn mean domin phase durat clear percept use scale timeconst shorter clearstat timeseri int clearn number row clearstat timeseri real clear_durationclearn durat clear percept cumul histori paramet reallow upper history_starting_valu start valu cumul histori begin run reallow upper mixed_st mix state signal strength paramet reallow tau histori timeconst linear model mu real real bh varianc reallow sigma transform paramet vectorclearn mu vector comput mu clear percept temporari variabl real current_histori current comput histori real tau_h tau unit time real dh comput histori differ int ic index clear percept use fit matrix signal level matrix level mixed_st mixed_st forit rowsn new timeseri recomput absolut tau reset histori state run_startit reset histori current_histori history_starting_valu recomput tau unit time relev multipl session particip howev left code gener tau_h session_tmeanit tau valid percept use histori comput mu is_usedit histori differ dh current_historyistateit current_historyistateit linear model mu muic bh dh ic comput histori next episod see vignett cumul histori forist current_historyist levelist istateit current_historyist levelist istateit expdurationit tau_h model sampl individu paramet tau lognormallog normallog bh normal sigma exponenti sampl data use comput mu sampl sigma clear_dur lognormalexpmu sigma data prepar data section defin model input hope comment make understand fairli straightforward howev sever featur although need limit singl session singl session make easier gener code complic case exampl domin phase use fit specif mix percept phase first domin phase percept enough time form reliabl histori last domin phase curtail end block exclud valid domin phase mark is_us vector total number store clearn variabl actual domin durat clear_dur latter strictli necessari allow us avoid loop vector sampl statement clear_dur lognormalexpmu sigma addit session_tmean vector rather scalar necessari singl session exampl opt use better gener complic case bistabl packag provid servic function preprocess_data simplifi process prepar data howev need perform last step form list input stan sampl r evalfals function check data intern consist return preprocess tabl df bistablehistorypreprocess_databr_single_subject statest durationdur runblock data stan model stan_data list complet timeseri rowsn nrowdf durat dfdurat istat dfistat is_us dfis_us run_start dfrun_start session_tmean dfsession_tmean valid clear percept clearn sumdfis_us clear_dur dfdurationdfis_us histori paramet fix default valu history_starting_valu c mixed_st use model use model either rstan cmdstanr packag exampl use cmdstanr assum model file call examplestan r evalfals compil model model cmdstanrcmdstan_modelexamplestan sampl model fit modelsampledatastan_data chain extract posterior sampl tau paramet tau fitdrawsvari tau gener roxygen edit hand pleas edit document rdatar doctypedata namebr aliasbr titlebinocular rivalri data format data frame row variabl describ itemobserverparticip id itemdisplaydisplay row contain codebr itemblockrun block index itemtimetim rel run onset emphsecond itemstatefactor level codeleft coderight clear state codemix itemdurationdur domin phase emphsecond note durat last domin phase curtail therefor set zero sourc doi usag br descript dataset binocular rivalri eight particip keyworddataset gener roxygen edit hand pleas edit document rdatar doctypedata namenc aliasnc titleneck cube data format data frame row variabl describ itemobserverparticip id itemdisplaydisplay row contain codenc itemblockrun block index itemtimetim rel run onset emphsecond itemstatefactor level codeleft coderight clear state codemix itemdurationdur domin phase emphsecond note durat last domin phase curtail therefor set zero sourc doi usag nc descript dataset necker cube five particip keyworddataset gener roxygen edit hand pleas edit document rcheck_fixed_history_parameterr namecheck_fixed_history_paramet aliascheck_fixed_history_paramet titleevalu valu fix histori paramet usag check_fixed_history_parameterparam_nam param_valu randomn upperlimit argument itemparam_namenam paramet itemparam_valuea singl valu coderandomn numer valu itemrandomnnumb level random variabl itemupperlimitupp limit valid codeparam_valu valu numer vector coderandomn long descript expect either singl valu within valid rang coderandomn valu exampl check_fixed_history_parametertau inf keywordintern gener roxygen edit hand pleas edit document rhistoryefr namehistoryef aliashistoryef titleextract historyeffect estim usag historyefobject summari true prob c argument itemobjectan object class linkcumhistclasscumhist itemsummarywheth summari statist return instead raw sampl valu default codetru itemprobsth percentil use comput summari default credibl interv valu datafram valu summari descript extract model populationlevel coeffici historyspecif term everi model distribut paramet exampl donttest br_fit fit_cumhistbr_singleblock statest durationdur historyefbr_fit gener roxygen edit hand pleas edit document rcumhistclassr doctypeclass namecumhistclass aliascumhistclass aliascumhist titleclass codecumhist descript cumul histori model fit timeseri data detail see codemethodsclass cumhist overview avail method sectionslot describ itemcodefamilya codestr distribut famili itemcodedataa codelist preprocess data itemcodestanfita codelinkrstanstanfitclassstanfit object seealso codelinkfit_cumhist gener roxygen edit hand pleas edit document rhistory_parameterr namehistory_mixed_st aliashistory_mixed_st titleextract valu use fit histori paramet mixed_st usag history_mixed_st object summari true prob c includepopulationlevel true argument itemobjectan object class linkcumhistclasscumhist itemsummarywheth summari statist return instead raw sampl valu default codetru itemprobsth percentil use comput summari default credibl interv itemincludepopulationlevellog pool random effect whether includ popul mean separ code_popul level default codetru valu singl valu fix valu use vector tibbl depend option use singl intercept independ random intercept whether summari request descript shortcut codehistory_parameterobject mixed_st exampl donttest br_fit fit_cumhistbr_singleblock statest durationdur history_taubr_fit gener roxygen edit hand pleas edit document rcompute_historyr namecompute_histori aliascompute_histori titlecomput cumul histori timeseri usag compute_histori data state durat null onset null random_effect null session null run null tau mixed_st history_init argument itemdataa tabl timeseri itemstatestr name column specifi perceptu state column type factor two three level third level assum correspond transitionmix phase convert two level factor would imposs infer ident transit mix phase itemdurationstr name column durat individu perceptu domin phase option specifi codeonset instead itemonsetstr name column onset perceptu domin state option use comput durat domin phase provid explicitli via codedur paramet itemrandom_effectstr name column identifi random effect eg individu particip stimuli singl particip etc omit random effect assum specifi one level particip stimulu etc use hierarch model itemsessionstr name column identifi uniqu experiment session mean domin phase durat comput see codenorm_tau paramet code assum session id differ within particip omit singl mean domin durat base entir time seri use itemrunstr name column identifi uniqu runsblock omit data assum belong singl time seri code assum run id differ within experiment session session eg session run session b run session run itemtautim constant exponenti growthdecay normal mean durat clear percept within codesess singl posit number use particip run codenul default emphsingl valu fit particip run coderandom independ tau fit random cluster coderandom tau random cluster sampl popul distribut ie pool paramet valu via multilevel model itemmixed_statespecifi activ level transitionmix phase state see codest either singl number rang use fix level vector two number codecmu kappa specifi correspondingli mean rang precis beta proport distribut sampl default fix valu code itemhistory_initiniti valu cumul histori comput either numer scalar rang vector two number rang latter case two histori start differ level valu matrix codenrowdata comput histori valu descript comput cumul histori state timeseri exampl df compute_historybr_singleblock state state durat durat tau mixed_st history_init gener roxygen edit hand pleas edit document rdatar doctypedata namebr_contrast aliasbr_contrast titlebinocular rivalri variabl contrast format data frame row variabl describ itemobserverparticip id itemblockrun block index itemcontrastcontrast scale itemtimetim rel run onset emphsecond itemstatefactor level codeleft coderight clear state codemix itemdurationdur domin phase emphsecond note durat last domin phase curtail therefor set zero usag br_contrast descript dataset binocular rivalri variabl equal contrast six particip keyworddataset gener roxygen edit hand pleas edit document rloor nameloocumhist aliasloocumhist titlecomput effici approxim leaveoneout crossvalid via loo librari use model comparison via looloo_compar function usag methodloocumhistx argument itemxa linkcumhistclasscumhist object itemunus valu name list see codelinklooloolooloo detail descript comput effici approxim leaveoneout crossvalid via loo librari use model comparison via looloo_compar function exampl databr_singleblock donttest gamma_fit fit_cumhistbr_singleblock statest durationdur loo_gamma loogamma_fit gener roxygen edit hand pleas edit document rrcppexportsr namefast_history_comput aliasfast_history_comput titlecomput cumul histori usag fast_history_computedf normalized_tau mixed_st history_init argument itemdfdatafram codest integ clear state mix state codedur doubl codeirandom integ base index random cluster coderun_start integ first entri run otherwis codesession_tmean doubl itemnormalized_taudoublevector normal tau valu random cluster individu thu length must equal number uniqu index codedfirandom itemmixed_statedoublevector valu use mix state random cluster individu thu length must equal number uniqu index codedfirandom itemhistory_initdoublevector size initi valu histori run valu numericmatrix size codedfnrow comput histori valu state descript comput cumul histori base common codehistori valu codenormalized_tau codemixed_st defin random cluster individu exampl df preprocess_databr_singleblock statest durationdur fast_history_computedf c gener roxygen edit hand pleas edit document rdatar doctypedata namebr_singleblock aliasbr_singleblock titlesingl run binocular rivalri stimulu format data frame row variabl describ itemobserverparticip id row contain emphap itemgroupdisplay row contain emphbr itemblockrun block index row contain emph itemtimetim rel run onset emphsecond itemstateindex perceptu domin state emph emph clear perceptu state emph mix transit phase itemdurationdur domin phase emphsecond note durat last domin phase curtail therefor set zero sourc doi usag br_singleblock descript singl subject singl run dataset binocular rivalri keyworddataset gener roxygen edit hand pleas edit document rextract_termr nameextract_replicate_term_to_matrix aliasextract_replicate_term_to_matrix titleextract term replic randomn time linear model usag extract_replicate_term_to_matrixobject term argument itemobjectan object class linkcumhistclasscumhist itemtermstr term name valu matrix descript extract term replic randomn time linear model use popul mean varianc term exampl donttest br_fit fit_cumhistbr_singleblock state state durat durat bh_mu extract_replicate_term_to_matrixbr_fit bh_mu gener roxygen edit hand pleas edit document revaluate_history_parameterr nameevaluate_history_opt aliasevaluate_history_opt titleevalu whether fit cumul histori paramet usag evaluate_history_optionparam_nam param_valu randomn upperlimit argument itemparam_namenam paramet itemparam_valuevalu codelinkfit_cumhist function call itemrandomnnumb level random variabl itemupperlimitupp limit valid codeparam_valu valu list codeparam_name_opt codefixed_param_nam descript evalu base codeparam_valu enumer item singl posit number use particip run item codenul default emphsingl valu fit particip run also appli coderandomn item coderandom independ valu fit random cluster item coderandom valu random cluster sampl popul distribut ie pool paramet valu via multilevel model exampl evaluate_history_optiontau inf keywordintern gener roxygen edit hand pleas edit document rhistory_parameterr namehistory_tau aliashistory_tau titleextract valu use fit histori paramet tau usag history_tau object summari true prob c includepopulationlevel true argument itemobjectan object class linkcumhistclasscumhist itemsummarywheth summari statist return instead raw sampl valu default codetru itemprobsth percentil use comput summari default credibl interv itemincludepopulationlevellog pool random effect whether includ popul mean separ code_popul level default codetru valu singl valu fix valu use vector tibbl depend option use singl intercept independ random intercept whether summari request descript shortcut codehistory_parameterobject tau exampl donttest br_fit fit_cumhistbr_singleblock statest durationdur history_taubr_fit gener roxygen edit hand pleas edit document rpredict_historyr namepredict_histori aliaspredict_histori titlecomput predict cumul histori use posterior predict distribut usag predict_histori object history_typ summari true prob null full_length true argument itemobjectan object class linkcumhistclasscumhist itemhistory_typecod code cumul histori first second perceptu state index respect codedomin codesuppress cumul histori state either domin suppress follow phase codediffer differ suppress domin see cumul histori vignett detail itemsummarywheth summari statist return instead raw sampl valu default codetru itemprobsth percentil use comput summari default null ci itemfull_lengthonli codesummari true whether summari tabl includ row predict ie row mix phase firstlast domin phase run etc see codelinkpreprocess_datapreprocess_data default codetru itemunus valu codesummaryfals numer matrix iterationsn x clearn codesummarytru codeprobsnul vector request cumul histori valu codesummarytru codeprob codenul datafram column emphpredict mean column specifi quantil descript comput predict cumul histori use fit model wrapper codepredictobject summari prob full_length predict_historyhistory_typ exampl donttest br_fit fit_cumhistbr_singleblock state state durat durat history_difference_summari predict_historybr_fit differ full posterior predict sampl history_differ predict_historybr_fit differ summari fals full_length true seealso codelinkfit_cumhist codelinkpredictcumhist gener roxygen edit hand pleas edit document rrcppexportsr namepredict_sampl aliaspredict_sampl titlecomput predict sampl usag predict_sampl famili fixedn randomn lmn istat durat is_us run_start session_tmean irandom fix tau_ind mixed_state_ind history_init bh bf sigma argument itemfamilyint distribut famili gamma lognorm normal itemfixednint number fix paramet itemrandomnint number random factor itemlmnint number linear model itemistateintegervector zerobas perceptu state mix state itemdurationdoublevector durat domin phase itemis_usedintegervector whether domin phase use predict itemrun_startintegervector whenev new run start itemsession_tmeandoublevector averag domin phase durat itemirandomintegervector zerobas index random effect itemfixednumericmatrix matrix fix effect valu itemtau_indnumericmatrix matrix sampl tau random level itemmixed_state_indnumericmatrix matrix sampl mixed_st random level itemhistory_initdoublevector initi valu histori run itemanumericmatrix matrix sampl intercept random level itembhnumericmatrix matrix sampl bh linear model random level itembfnumericmatrix matrix sampl bf linear model fix factor itemsigmadoublevector sampl sigma valu numericmatrix predict durat sampl descript comput predict sampl recomput cumul histori use fit paramet valu gener roxygen edit hand pleas edit document rdatar doctypedata namekde_two_observ aliaskde_two_observ titlemultirun data two particip kineticdepth effect display format data frame row variabl describ itemobserverparticip id itemblockrun block index itemstatefactor variabl state level code code code two clear perceptu state code mix transit phase itemtimetim rel run onset emphsecond itemdurationdur domin phase emphsecond note durat last domin phase curtail therefor set zero sourc doi usag kde_two_observ descript multirun data two particip kineticdepth effect display keyworddataset gener roxygen edit hand pleas edit document rwaicr namewaiccumhist aliaswaiccumhist titlecomput wide applic inform criterion waic usag methodwaiccumhistx argument itemxa linkcumhistclasscumhist object itemaddit argument unus valu name list see codelinkloowaicloowa detail descript comput wide applic inform criterion via linkloopackageloo librari use model comparison via linklooloo_comparelooloo_compar function exampl donttest databr_singleblock gamma_fit fit_cumhistbr_singleblock statest durationdur waic_gamma waicgamma_fit normal_fit fit_cumhistbr_singleblock statest durationdur familynorm waic_norm waicnormal_fit looloo_comparewaic_gamma waic_norm gener roxygen edit hand pleas edit document rextract_termr nameextract_term_to_matrix aliasextract_term_to_matrix titleextract term one column per fix randomlevel matrix usag extract_term_to_matrixobject term argument itemobjectan object class linkcumhistclasscumhist itemtermstr term name valu matrix descript extract array term sampl linearmodel randomfixedeffect order return matrix sampl row column order randomfix effect lm randomfix effect lm etc exampl donttest br_fit fit_cumhistbr_singleblock state state durat durat extract_term_to_matrixbr_fit gener roxygen edit hand pleas edit document rsummaryr namesummarycumhist aliassummarycumhist titlesummari cumhist object usag methodsummarycumhistobject argument itemobjecta linkcumhistclasscumhist object itemunus valu noth consol output descript summari cumhist object exampl donttest br_fit fit_cumhistbr_singleblock statest durationdur summarybr_fit gener roxygen edit hand pleas edit document rextract_history_parameterr nameextract_history_paramet aliasextract_history_paramet titleextract histori paramet matrix usag extract_history_paramet object param_nam samplesn null link_funct null argument itemobjecta linkcumhistclasscumhist object itemparam_namestr name paramet itemsamplesnnumb sampl null comput rstan cheaper itemlink_functiona link function use exp invlogit codenul ident valu matrix codesamplesn row randomn found codeobjectdatarandomn column descript extract histori paramet matrix codesamplesn row randomn found codeobjectdatarandomn column exampl donttest br_fit fit_cumhistbr_singleblock statest durationdur extract_history_parameterbr_fit tau link_funct exp gener roxygen edit hand pleas edit document rbayes_rr namebayes_r aliasbayes_r aliasbayes_rcumhist titlecomput rsquar use bayesian rsquar approach usag methodbayes_rcumhistobject summari true prob c argument itemobjectan object class linkcumhistclasscumhist itemsummarywheth summari statist return instead raw sampl valu default codetru itemprobsth percentil use comput summari default credibl interv itemunus valu vector valu datafram summari descript detail refer andrew gelman ben goodrich jonah gabri aki vehtari rsquar bayesian regress model american statistician doi urlhttpsavehtarigithubiobayes_rbayes_rhtml exampl donttest br_fit fit_cumhistbr_singleblock state state durat durat bayes_rbr_fit gener roxygen edit hand pleas edit document rpredictr namepredictcumhist aliaspredictcumhist titlecomput predict domin phase durat use posterior predict distribut usag methodpredictcumhist object summari true prob null full_length true predict_histori null argument itemobjectan object class linkcumhistclasscumhist itemsummarywheth summari statist return instead raw sampl valu default codetru itemprobsth percentil use comput summari default null ci itemfull_lengthonli codesummari true whether summari tabl includ row predict ie row mix phase firstlast domin phase run etc see codelinkpreprocess_datapreprocess_data default codetru itempredict_historyopt predict cumul histori state differ disabl default set codenul specifi code code cumul histori first second perceptu state index respect codedomin codesuppress cumul histori state either domin suppress follow phase codediffer differ suppress domin see cumul histori vignett detail itemunus valu codesummaryfals numer matrix iterationsn x clearn codesummarytru codeprobsnul vector mean predict durat request cumul histori valu codesummarytru codeprob codenul datafram column emphpredict mean column specifi quantil descript comput predict domin phase durat use fit model exampl donttest br_fit fit_cumhistbr_singleblock state state durat durat predictbr_fit full posterior predict sampl predictions_sampl predictbr_fit summaryfals seealso codelinkfit_cumhist gener roxygen edit hand pleas edit document rdatar doctypedata namekd aliaskd titlekineticdepth effect data format data frame row variabl describ itemobserverparticip id itemdisplaydisplay row contain codekd itemblockrun block index itemtimetim rel run onset emphsecond itemstatefactor level codeleft coderight clear state codemix itemdurationdur domin phase emphsecond note durat last domin phase curtail therefor set zero sourc doi usag kde descript dataset kineticdepth effect eleven particip keyworddataset gener roxygen edit hand pleas edit document rdatar doctypedata namebr_single_subject aliasbr_single_subject titlesingl experiment session binocular rivalri stimulu format data frame row variabl describ itemobserverparticip id row contain emphap itemdisplaydisplay row contain emphbr itemblockrun block index itemtimetim rel run onset emphsecond itemstateindex perceptu domin state emph emph clear perceptu state emph mix transit phase itemdurationdur domin phase emphsecond note durat last domin phase curtail therefor set zero sourc doi usag br_single_subject descript singl subject multipl run dataset binocular rivalri keyworddataset gener roxygen edit hand pleas edit document rcheck_normal_priorr namecheck_normal_prior aliascheck_normal_prior titlecheck valid valu use normal distribut paramet usag check_normal_priorvalu paramet argument itemvaluesparamet normal distribut itemparameternam paramet prior defin valu logic true none test fail descript pair numer valu second valu nonzero stop execut error exampl check_normal_priorc tau keywordintern gener roxygen edit hand pleas edit document rhistory_parameterr namehistory_paramet aliashistory_paramet titleextract valu use fit histori paramet usag history_paramet object param summari true prob c includepopulationlevel true argument itemobjectan object class linkcumhistclasscumhist itemparamparamet name codetau codemixed_st itemsummarywheth summari statist return instead raw sampl valu default codetru itemprobsth percentil use comput summari default credibl interv itemincludepopulationlevellog pool random effect whether includ popul mean separ code_popul level default codetru valu vector summari request tibbl summari fix valu use descript extract valu use fit histori paramet exampl donttest br_fit fit_cumhistbr_singleblock statest durationdur history_parameterbr_fit tau gener roxygen edit hand pleas edit document rextract_historyr nameextract_histori aliasextract_histori titlecomput histori fit model usag extract_historyobject argument itemobjectan object class linkcumhistclasscumhist valu matrix cumul histori valu state descript comput histori fit model use mean valu histori paramet use valu random cluster coderandom coderandom parametris use exampl donttest br_fit fit_cumhistbr_singleblock state state durat durat extract_historybr_fit gener roxygen edit hand pleas edit document rpreprocess_datar namepreprocess_data aliaspreprocess_data titlepreprocess timeseri data fit usag preprocess_data data state durat null onset null random_effect null session null run null argument itemdataa tabl one mani timeseri itemstatestr name column specifi perceptu state column type factor two three level third level assum correspond transitionmix phase convert two level factor would imposs infer ident transit mix phase itemdurationstr name column durat individu perceptu domin phase option specifi codeonset instead itemonsetstr name column onset perceptu domin state option use comput durat domin phase provid explicitli via codedur paramet itemrandom_effectstr name column identifi random effect eg individu particip stimuli singl particip etc omit random effect assum specifi one level particip stimulu etc use hierarch model itemsessionstr name column identifi uniqu experiment session mean domin phase durat comput see codenorm_tau paramet code assum session id differ within particip omit singl mean domin durat base entir time seri use itemrunstr name column identifi uniqu runsblock omit data assum belong singl time seri code assum run id differ within experiment session session eg session run session b run session run valu tibbl column item item codest item codedur item coderandom item codeirandom integ index coderandom valu item codesess item coderun item codesession_tmean numer mean durat clear percept everi combin coderandom codesess item codeis_us integ whether comput histori valu need use linear model fit item coderun_start integ first row run timeseri descript perform saniti check eg whether codedata use datafram comput durat domin phase necessari assum singl entri miss codesess coderun coderandom_effect exampl df preprocess_databr_singleblock statest durationdur gener roxygen edit hand pleas edit document rfixefr namefixef aliasfixef titleextract fixedeffect estim usag fixefobject summari true prob c argument itemobjectan object class linkcumhistclasscumhist itemsummarywheth summari statist return instead raw sampl valu default codetru itemprobsth percentil use comput summari default credibl interv valu codetibbl valu summari codenul fix effect use descript extract model fixedeffect term everi model distribut paramet exampl donttest br_fit fit_cumhistbr_singleblock state state durat durat fixed_effect time fixefbr_fit gener roxygen edit hand pleas edit document rbistablehistorypackag doctypepackag namebistablehistorypackag aliasbistablehistorypackag aliasbistablehistori titlecumul histori analysi bistabl percept time seri descript estim cumul histori timeseri continu view bistabl perceptu rivalri display comput cumul histori via homogen first order differenti process ie assum exponenti growthdecay histori function time perceptu domin state pastukhov braun doi support gamma log normal normal distribut famili provid method comput histori directli exampl use comput custom stan code refer stan develop team rstan r interfac stan r packag version httpsmcstanorg seealso codevignettecumulativehistori packag bistablehistori codevignetteusageexampl packag bistablehistori codevignettewritingstancod packag bistablehistori gener roxygen edit hand pleas edit document rcoefr namecoefcumhist aliascoefcumhist titleextract model coeffici usag methodcoefcumhistobject summari true prob c argument itemobjectan object class linkcumhistclasscumhist itemsummarywheth summari statist return instead raw sampl valu default codetru itemprobsth percentil use comput summari default credibl interv itemunus valu datafram valu summari descript extract model populationlevel coeffici historyspecif term fixedeffect term everi model distribut paramet exampl donttest br_fit fit_cumhistbr_singleblock state state durat durat fixed_effect time coefbr_fit gener roxygen edit hand pleas edit document revaluate_history_parameterr nameevaluate_history_init aliasevaluate_history_init titleevalu valid initi histori valu usag evaluate_history_inithistory_init argument itemhistory_initeith singl valu pair valu within rang valu vector two valu descript check number rang valu scalar pass use valu state exampl evaluate_history_init keywordintern gener roxygen edit hand pleas edit document rfit_cumhistr namefit_cumhist aliasfit_cumhist titlefit cumul histori bistabl perceptu rivalri display usag fit_cumhist data state durat null onset null random_effect null session null run null fixed_effect null tau null mixed_st history_init famili gamma history_prior null intercept_prior null history_effect_prior null fixed_effects_prior null chain core null argument itemdataa tabl timeseri itemstatestr name column specifi perceptu state column type factor two three level third level assum correspond transitionmix phase convert two level factor would imposs infer ident transit mix phase itemdurationstr name column durat individu perceptu domin phase option specifi codeonset instead itemonsetstr name column onset perceptu domin state option use comput durat domin phase provid explicitli via codedur paramet itemrandom_effectstr name column identifi random effect eg individu particip stimuli singl particip etc omit random effect assum specifi one level particip stimulu etc use hierarch model itemsessionstr name column identifi uniqu experiment session mean domin phase durat comput see codenorm_tau paramet code assum session id differ within particip omit singl mean domin durat base entir time seri use itemrunstr name column identifi uniqu runsblock omit data assum belong singl time seri code assum run id differ within experiment session session eg session run session b run session run itemfixed_effectsstr vector string name column valu use fit addit fix effect eg contrast binocular rivalri rotat speed kineticdepth effect etc itemtautim constant exponenti growthdecay normal mean durat clear percept within codesess singl posit number use particip run codenul default emphsingl valu fit particip run coderandom independ tau fit random cluster coderandom tau random cluster sampl popul distribut ie pool paramet valu via multilevel model itemmixed_statespecifi activ level transitionmix phase state see codest either singl number rang use fix level vector two number codecmu kappa specifi correspondingli mean rang precis beta proport distribut sampl default fix valu code itemhistory_initiniti valu cumul histori comput either numer scalar rang vector two number rang latter case two histori start differ level itemfamilystr distribut use fit durat perceptu domin phase option includ codegamma default codelognorm codenorm itemhistory_priorsnam list option prior populationlevel cumul histori paramet must follow format codelisttauc valu code mean standard deviat normal distribut itemintercept_priorsa vector option prior populationlevel intercept paramet codecshapemean shapesd scalemean scalesd format gamma famili codecmean sd normal lognorm famili valu code mean standard deviat normal distribut itemhistory_effect_priora vector option prior populationlevel slope histori effect valu code mean standard deviat normal distribut default mu sigma itemfixed_effects_priorsa name list option prior fix effect must follow format codelistnameofvariablecmu sigma codemu codesigma mean standard deviat normal distribut default mu sigma itemchainsnumb chain sampl itemcoresnumb cpu core use sampl omit core use itemaddit argument pass linkrstanstanmodelmethodsamplingrstansampl function valu object class linkcumhistclasscumhist descript fit gener linear model use cumul histori specifi fix effect exampl donttest databr_singleblock gamma_fit fit_cumhistbr_singleblock state state durat durat gener roxygen edit hand pleas edit document rprintr nameprintcumhist aliasprintcumhist titleprint cumhist object usag methodprintcumhistx argument itemxa linkcumhistclasscumhist object itemunus valu noth consol output descript print cumhist object exampl donttest br_fit fit_cumhistbr_singleblock statest durationdur fixed_effectstim br_fit