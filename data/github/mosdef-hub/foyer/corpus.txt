contribut welcom via pull request githubhttpsgithubcommosdefhubfoyerpul develop andor user review request chang make comment rest file serv set gener guidelin contributor featur implement function gener flexibl fashion foyer design gener flexibl limit singl forc field simul engin simul method addit core featur attempt provid someth applic varieti usecas target focu area research howev specif featur target toward limit use case may appropri speak develop write code help make design choic allow flexibl version control current use standard pull request model contribut implement featur branch fork pleas tri keep master branch fork uptod master branch main repositori propos singl set relat chang small chang prefer larg chang major contribut often broken smaller pr larg pr affect mani part codebas harder review like caus merg conflict sourc code use consist style import consist style throughout sourc code follow criteria desir line wrap charact line indent space line end whitespac detail refer pephttpswwwpythonorgdevpepspep use precommithttpsprecommitcom automat check code style precommit includ dev environ git hook instal use bash precommit instal document code comment publicfac function docstr use numpi style includ concis paragraphstyl descript class function relev limit known issu descript argument intern function simpl onelin docstr test write unit test new function foyer test automat unit test execut second test attempt cover option user select ad line sourc code cover unit test current use pytesthttpsdocspytestorgenlatest execut simpli call pytest root directori packag addit forc field file includ test molecul encompass ad modifi atom type function foyer packag atomtyp well appli dissemin forcefield gitter chathttpsbadgesgitterimmosdefhubgittersvghttpsgitterimmosdefhublobbi azp build statushttpsdevazurecommosdefmosdef_apisbuildstatusmosdefhubfoyerbranchnamemasterhttpsdevazurecommosdefmosdef_buildlatestdefinitionidbranchnamemast anaconda badgehttpsanacondaorgcondaforgefoyerbadgesversionsvghttpsanacondaorgcondaforgefoy codecovhttpscodecovioghmosdefhubfoyerbranchmastergraphbadgesvghttpscodecovioghmosdefhubfoy doihttpszenodoorgbadgesvghttpszenodoorgbadgelatestdoi overview foyer opensourc python tool defin appli forc field atomtyp rule format human machineread parametr chemic topolog gener syntact correct input file variou simul engin foyer provid framework forc field dissemin help elimin ambigu atomtyp improv reproduc inform see paperhttpswwwsciencedirectcomsciencearticlepii correspond preprinthttpsarxivorgpdfpdf foyer within mosdef ecosystem p aligncent img srcdocsimagesmosdef_graphic_foyersvgrawtru altfoy within mosdef ecosystem width height p foyer defin forc field xml format smart string use defin chemic context particular atom type overrid use set rule preced rather rigid hierarch scheme foyer build upon openmm xml forc fieldhttpdocsopenmmorguserguideapplicationhtmlcreatingforcefield file annot smartsbas atomtyp eg xml forcefield atomtyp type nameopls_ classct elementc mass defcxchhh descalkan ch type nameopls_ classhc elementh mass defhcx descalkan h atomtyp forcefield foyer appli forcefield arbitrari chemic topolog current support openmmtopologyhttpsgithubcomopenmmopenmmblobwrapperspythonopenmmapptopologypyl parmedstructurehttpparmedgithubioparmedhtmlstructurehtml mbuildcompoundhttpmosdefhubgithubiombuilddata_structureshtml gmsotopologyhttpsgmsomosdeforgenstabledata_structureshtmlgmsotopolog openfftookittopologytopologyhttpsopenforcefieldtoolkitreadthedocsioenapigeneratedopenfftoolkittopologytopologyhtmlopenfftoolkittopologytopolog applic forc field simpl python foyer import forcefield import parm pmd untyped_ethan pmdload_fileethanemol structuretru oplsaa forcefieldforcefield_filesoplsaaxml ethan oplsaaapplyuntyped_ethan save format support parm ethanesaveethanetop ethanesaveethanegro foyer packag part molecular simul design framework mosdef projecthttpmosdeforg librari mosdef ecosystem design provid util neccessari streamlin research simul workflow set simul studi also recommend user follow truehttpswwwtandfonlinecomdoiful transpar reproduc usablebyoth extens standard set common practic meant improv reproduc comput simul research get start quick start docker use foyer jupyternotebook run docker contain depend instal use follow command sh docker pull mosdeffoyerlatest docker run name foyer p mosdeffoyerlatest optcondaenvsfoyerdockerbinjupyt notebook ip altern also start bourn shell directli sh docker run name foyer mosdeffoyerlatest learn use foyer docker pleas refer document herehttpsfoyermosdeforgenlatestdockerhtml get start smartsbas atomtyp smartsbas atomtypingdocssourcetopic_guidessmartsrst support smart grammarhttpsgithubcommosdefhubfoyerissu defin forc field defin forc field parametersdocssourcetopic_guidesparameter_definitionsrst forc field file validationdocssourcereferencevalidationrst exampl foyer forc field file foyer current includ subset opl aa trapp forcefield current part sourc distribut httpsgithubcommosdefhubfoyertreemasterfoyerforcefield addit exampl forc field xml file httpsgithubcomchrisiacovellaoplsaa_perfluoroalkan httpsgithubcommosdefhubforcefield_perfluoroeth httpsgithubcomsummerazoplsaa_alkylsilan exampl templat dissemin forc field httpsgithubcommosdefhubforcefield_templ use foyer perform atom type basic usag examplesdocssourcetopic_guidesusage_examplesrst detail jupyt notebook tutori includ integr mbuildhttpsgithubcommosdefhubfoyer_tutori jupyt notebook tutorialshttpsgithubcommosdefhubfoyer_tutorialstreemast paperhttpsarxivorgab document document websit httpfoyermosdeforg instal instruct instal instructionsdocssourcegetting_startedinstallrst cite foyer use packag pleas cite paperhttpswwwsciencedirectcomsciencearticlepii publish comput materi sciencehttpswwwjournalselseviercomcomputationalmaterialssci manuscript also avail preprint form arxivhttpsarxivorgpdfpdf paper exampl work develop tag paper_commat_httpsgithubcommosdefhubfoyertreepaper_commat_ pleas also cite github repositori httpsgithubcommosdefhubfoy licensehttpsimgshieldsiobadgelicensemitbluesvghttpopensourceorglicensesmit variou subport librari may independ distribut differ licens see file specif term materi base upon work support nation scienc foundat grant nsf aci nsf aci opinion find conclus recommend express materi author necessarili reflect view nation scienc foundat pr summari pr checklist includ appropri unit test appropri docstr addedupd code approxim pep compliant issu raisedaddress name featur request suggest improv foyer describ behavior would like ad foyer clear concis descript propos idea describ solut youd like clear concis descript want happen describ altern youv consid clear concis descript altern solut featur youv consid addit context add context screenshot featur request name questionsdiscuss usag question import note discuss summari question discuss topic name bug report report bug foyer bug summari tri happen instead pleas copi past stack output code reproduc behavior pleas includ code snippet use reproduc bug python past code softwar version version foyer use python c import foyer printfoyer__version__ version python python version oper system usag exampl foyer support atomtyp allatom coarsegrain molecular system also allow separ forc field use atomtyp separ portion molecular system creat box ethan use mbuild construct box fill ethan molecul use foyer atomtyp system appli opl forc field save runabl gromac file python import mbuild mb mbuildexampl import ethan ethane_box mbfill_boxcompoundethan n_compound box ethane_boxsaveethaneboxgro ethane_boxsaveethaneboxtop forcefield_nameoplsaa creat box coarsegrain ethan use mbuild construct box fill ethan molecul howev model ethan use unitedatom descript appli trapp forc field atomtyp note particl name prefix underscor foyer know particl nonatomist python import mbuild mb ethane_ua mbcompound ch_ mbparticlename_ch po ch_ mbparticlename_ch po ethane_uaaddch_ ch_ ethane_uaadd_bondch_ ch_ ethane_ua_box mbfill_boxethane_ua box ethane_ua_boxsaveethaneuaboxgro ethane_ua_boxsaveethaneuaboxtop forcefield_nametrappeua combin forc field instanc use multipl forc field may desir describ molecular system exampl user may want use one forc field surfac anoth fluid system foyer support function allow user separ atomtyp part system exampl take system featur bulk unit atom ethan silica surfac appli opl forc field surfac trapp forc field ethan two atomtyp parm structur combin use simpl oper save gromac file python foyer import forcefield foyertestsutil import get_fn import mbuild mb mbuildexampl import ethan mbuildlibatom import h mbuildlibbulk_materi import amorphoussilica interfac mbsilicainterfacebulk_silicaamorphoussilica interfac mbmonolayersurfaceinterfac chainsh guest_port_nameup box mbboxmin maxinterfacexyz maxsinterfaceperiod ethane_box mbfill_boxcompoundethan n_compound boxbox opl forcefieldnameoplsaa opls_silica forcefieldforcefield_filesget_fnoplssilicaxml ethane_box oplsapplyethane_box interfac opls_silicaapplyinterfac system interfac ethane_box systemsaveethanesilicagro systemsaveethanesilicatop instal conda bash conda instal c mosdef foyer instal edit version sourc bash git clone httpsgithubcommosdefhubfoyergit cd foyer pip instal e smartsbas atomtyp foyer allow user describ atomtyp use modifi version smartshttpwwwdaylightcomdayhtmldoctheorytheorysmartshtml may alreadi familiar smileshttpswwwwikiwandcomensimplified_molecularinput_lineentry_system represent describ chemic structur smart straightforward extens notat basic usag consid follow exampl defin oplsaa atomtyp methyl group carbon hydrogen atom xml forcefield atomtyp type nameopls_ classct elementc mass defcxchhh descalkan ch type nameopls_ classhc elementh mass defhcx descalkan h atomtyp forcefield xml format extens openmm forc field formathttpdocsopenmmorguserguideapplicationhtmlcreatingforcefield exampl util two addit xml attribut support foyer def desc atomtyp attempt match alway __first__ token smart string exampl cx h opls_ methyl group carbon defin smart string indic carbon bond carbon neighbor hydrogen neighbor opls_ alkan hydrogen defin simpli hydrogen atom bond carbon bond overrid atomtyp multipl atomtyp definit appli given atom must establish preced definit mani atomtyp determin rule preced place specif rule first evalu sequenc break loop soon match found approach work becom challeng maintain correct order rule number atomtyp grow foyer iter run rule atom atom maintain whitelist rule appli blacklist rule superced anoth rule set differ white blacklist yield correct atomtyp forc field implement correctli add rule blacklist use overrid attribut xml file illustr exampl overrid use consid follow type describ alken benzen xml forcefield atomtyp type nameopls_ classcm elementc mass defcxccc descalken c rc type nameopls_ classcm elementc mass defcxcch descalken c rhc type nameopls_ classhc elementh mass defhcx descalken h type nameopls_ classca elementc mass defcxrcxrcxrcxrcxrcxr overridesopls_opls_ type nameopls_ classha elementh mass defhcopls_ overridesopls_ descbenzen h atomtyp forcefield atomtyp benzen molecul carbon atom match smart pattern opls_ opls_ without overrid attribut foyer notifi multipl atomtyp found carbon provid overrid indic opls_ pattern match superced specifi rule current grammar support current yet support smart featureshttpwwwdaylightcomdayhtmldoctheorytheorysmartshtml herehttpsgithubcommosdefhubfoyerissu keep track portion support valid forc field file foyer perform sever valid step help prevent malform forc field file smart string make product code goal provid human readabl error messag user may intim familiar xml smart pars grammar easili act upon howev receiv unclear error messag warn strongli encourag __submit issuehttpsgithubcommosdefhubfoyerissuesnew__ detail error messag receiv possibl attach minim exampl forc field file creat problem xml schema first line defens forc field file load foyer valid xml schema definitionfoyerforcefieldsffxsd enforc element eg harmonicbondforc valid attribut format addit schema ensur atomtyp defin atomtyp referenc section actual defin atomtyp element smart valid smart string use defin atomtyp pars pars error captur rerais error messag allow pin point locat problem xml file within smart string wherev possibl attempt provid help hint welcom contribut help improv clariti error messag addit ensur atomtyp referenc use type overrid syntaxsmartsmd actual defin atomtyp element forcefield changelog oplsaa v april start version forcefield xml v june updat smart string opls_ cxoopls_hh cxoopls_hhc opls_from hccopls_opls_ hccopls_opls_opls_opls_ opls_ cxoopls_hh cxoopls_hhh opls_ hcopls_ hcopls_opls_ opls_ cxoopls_hhc updat overrid opls_ opls_ opls_ opls_ opls_ opls_ opls_ opls_ updat refer opls_ ja jcc opls_ ja jcc opls_ ja jcc opls_ ja jcc opls_ ja jcc v august updat smart string opls_ oxh oxhh trappeua v april start version forcefield xml v august updat combining_rul lorentz develop note tool licens assort note develop tool adapt mdtraj releas follow licens licens copyright c stanford univers author right reserv redistribut use file folder devtool basesetuppi setuppi file sourc binari form without modif permit provid follow condit met redistribut sourc code must retain copyright notic list condit follow disclaim redistribut binari form must reproduc copyright notic list condit follow disclaim document andor materi provid distribut softwar provid copyright holder contributor express impli warranti includ limit impli warranti merchant fit particular purpos disclaim event shall copyright holder contributor liabl direct indirect incident special exemplari consequenti damag includ limit procur substitut good servic loss use data profit busi interrupt howev caus theori liabil whether contract strict liabil tort includ neglig otherwis aris way use softwar even advis possibl damag foyer packag atomtyp well appli dissemin forc field licens cite anaconda codecov azur licens imag httpsimgshieldsiobadgelicensemitbluesvg target httpsopensourceorglicensesmit cite imag httpsimgshieldsiobadgecitefoyergreen target referencecitinghtml anaconda imag httpsanacondaorgcondaforgefoyerbadgesversionsvg target httpsanacondaorgcondaforgefoy codecov imag httpscodecovioghmosdefhubfoyerbranchmastergraphbadgesvg target httpscodecovioghmosdefhubfoy azur imag httpsdevazurecommosdefmosdef_apisbuildstatusmosdefhubfoyerbranchnamemast target httpsdevazurecommosdefmosdef_buildlatestdefinitionidbranchnamemast overview foyer opensourc python tool provid framework applic dissemin classic molecular model forc field importantli enabl user defin appli atomtyp rule format simultan human machineread primari goal foyer elimin ambigu atomtyp forc field applic step molecular simul order improv reproduc foyer forc field defin xml format deriv openmm xml specif httpdocsopenmmorglatestuserguideapplicationhtmlbasicconcepts_ smart string httpswwwdaylightcomdayhtmldoctheorytheorysmartshtml_ use defin chemic context atom type overrid use defin clear preced differ atom type foyer design compat tool molecular simul design framework mosdef ecosystem httpsmosdeforg_ resourc docinstal guid getting_startedinstal instruct instal foyer docquickstart getting_startedquickstart brief introduct foyer mosdef httpsmosdeforg_ learn mo lecular imul de sign f ramework foyer paper httpswwwsciencedirectcomsciencearticlepiis_ journal articl describ foyer github repositori httpsgithubcommosdefhubfoyer_ download sourc code contribut develop foyer issu tracker httpsgithubcommosdefhubfoyerissues_ report issu request featur citat use foyer research pleas cite foyer paper httpswwwsciencedirectcomsciencearticlepiis_ see docher referencecit detail instal complet instal instruct docher getting_startedinstal conda instal avail codeblock bash conda creat name foyer foyer c condaforg exampl annot openmm xml forc field httpdocsopenmmorglatestuserguideapplicationhtmlcreatingforcefields__ file smartsbas atomtyp code xml forcefield atomtyp type nameopls_ classct elementc mass defcxchhh descalkan ch type nameopls_ classhc elementh mass defhcx descalkan h atomtyp forcefield appli forcefield arbitrari chemic topolog current support openmmtopolog httpdocsopenmmorglatestapipythongeneratedsimtkopenmmapptopologytopologyhtml__ parmedstructur httpparmedgithubioparmedhtmlstructurehtml__ mbuildcompound httpmosdefhubgithubiombuilddata_structureshtml__ code python foyer import forcefield import parm pmd untyped_ethan pmdload_fileethanemol structuretru oplsaa forcefieldforcefield_filesoplsaaxml ethan oplsaaapplyuntyped_ethan save format support parm ethanesaveethanetop ethanesaveethanegro get start check exampl templat dissemin forc field httpsgithubcommosdefhubforcefield_templ credit materi base upon work support nation scienc foundat grant nsf aci nsf aci opinion find conclus recommend express materi author necessarili reflect view nation scienc foundat tabl content toctre maxdepth caption get start getting_startedinstal getting_starteddock getting_startedquickstart toctre maxdepth caption topic guid topic_guidessmart topic_guidesparameter_definit topic_guidesffappli topic_guidesusage_exampl topic_guidespaper_exampl toctre maxdepth caption refer referenceunit referencevalid referenceffclass referencecit referencelicens quickstart foyer distribut partial support oplsaa forc field first load pdb file downloadher filesethanepdb parm load oplsaa forc field foyer code python import foyer import parm mol parmedloadethanepdb ff foyerforcefieldload_oplsaa mol_ff ffapplymol mol_ffsaveethanegro mol_ffsaveethanetop first step load ethanepdb mol parmedstructur next load opl forc field foyerforcefield object appli forc field molecul mol_ff also parmedstructur contain forc field paramet lennardjon paramet partial charg bond angl dihedr paramet final save parameter structur input format gromac exampl ff forc field paramet oplsaa forc field view xml file paramet httpsgithubcommosdefhubfoyerblobmasterfoyerforcefieldsxmloplsaaxml_ see xml file smart string ad mani oplsaa atom type alway verifi atomtyp perform correctli singl molecul appli forc field entir system wish add support molecul oplsaa forc field view issu httpsgithubcommosdefhubfoyerissues_ real power foyer build distribut xml file paramet set show exampl xml file pentafluoroethan custom paramet set taken paper httpsarxivorgabs_ code bash forcefield nameexample_custom version atomtyp type namec classc elementc mass defcchff desccarbon bond fs h anoth carbon type namec classc elementc mass defccfff desccarbon bond fs anoth carbon type namef classf elementf mass deffccfh descf bond c type namef classf elementf mass deffccff descf bond c type nameh classh elementh mass defhc descsingl h bond c atomtyp harmonicbondforc bond classc classc length k bond classc classf length k bond classc classh length k harmonicbondforc harmonicangleforc angl classc classc classf angl k angl classc classc classh angl k angl classf classc classf angl k angl classf classc classh angl k harmonicangleforc periodictorsionforc proper classf classc classc classf period k phase period k phase proper class classc classc class period k phase periodictorsionforc nonbondedforc coulombscal ljscale atom typec charg sigma epsilon atom typec charg sigma epsilon atom typef charg sigma epsilon atom typef charg sigma epsilon atom typeh charg sigma epsilon nonbondedforc forcefield smart string defin atomtyp section bond angl dihedr paramet defin follow section time load gro file hfc downloadher fileshfcgro load custom forc field xml file downloadher filesff_customxml appli forc field paramet code python import foyer import parm mol parmedloadhfcgro ff foyerforcefieldff_customxml mol_ff ffapplymol mol_ffsavehfctop foyer use save input file simul engin support parm also instal mbuild varieti simul engin also support instal user recommend conda instal code bash conda instal c condaforg c omnia foyer wish instal sourc use follow command code bash git clone httpsgithubcommosdefhubfoyergit cd foyer conda env creat f environmentyml conda activ foyer pip instal use window use environmentwinyml rather environmentyml plan contribut develop foyer recommend creat edit instal requir depend code bash git clone httpsgithubcommosdefhubfoyergit cd foyer conda env creat f environmentdevyml conda activ foyerdev pip instal e instal precommit use precommithttpsprecommitcom automat handl code format packag includ dev environ foyerdev conda environ activ precommit instal local git hook run precommit instal option file check run precommit run allfil support python version python offici support includ test develop packag python version older may success build function guarante made test instal foyer use pytest unit test run simpli type run follow base directori conda instal pytest pytest v build document foyer use sphinx httpswwwsphinxdocorgenmasterindexhtml_ build document build doc local run follow doc directori conda env creat f docsenvyml conda activ foyerdoc make html use foyer docker much scientif softwar develop happen unix platform avoid quirk develop depend system use recommend way use docker container technolog section guid use foyer docker prerequisit docker instal machin follow link httpsdocsdockercomgetdocker_ get docker instal work machin familiar docker want get start docker internet full good tutori like one httpsdockercurriculumcom_ httpswwwyoutubecomwatchvzjwbkzfpifeatureyoutube_ quick start work docker instal pleas use follow command use run jupyternotebook depend foyer instal codeblock bash docker pull mosdeffoyerlatest docker run name foyer p mosdeffoyerlatest command provid contain contain start jupyternotebook contain locat homeanacondadata notebook access copi past notebook url web browser comput finish session use ctrc follow instruct exit notebook usual docker contain exit upon notebook shutdown warn contain natur ephemer filesystem chang eg ad new notebook persist end contain lifecyl contain remov chang code addit persist see section persist data note flag connect keyboard termin run contain may run prior command without flag awar contain respond keyboard input case would need use docker ps docker kill command shut contain persist user volum use foyer docker contain recommend way mount call user volum contain user volum provid way persist filesystemcod addit made contain regardless contain lifecycl exampl might want creat directori call foyernotebook local system store foyer notebookscod order make access containerwher notebook creatededit use follow step codeblock bash mkdir p pathtofoyernotebook cd pathtofoyernotebook docker run name foyer mount typebindsourcepwdtargethomeanacondadata p mosdeffoyerlatest easili mount differ directori local machin chang sourcepwd sourcepathtomyfavoritedirectori note mount flag mount volum docker contain use bind mount bind current directori local filesystem homeanacondadata locat contain file see jupyternotebook browser window exist local machin warn use contain jupyt notebook use homeanacondadata locat mount point insid contain default notebook directori run python script contain jupyt notebook great way explor new softwar prototyp code howev come time product scienc often better work python script order execut python script examplepi exist current work directori local machin run codeblock bash docker run mount typebindsourcepwdtargethomeanacondadata mosdeffoyerlatest python datatestpi note bind mount current work directori homeanacondadata command pass contain python datatestpi note prefix data script enter contain home folder homeanaconda script locat homeanacondadata warn bind mount targethomeanaconda caus error dont want jupyt notebook want python interpret run codeblock bash docker run mount typebindsourcepwdtargethomeanacondadata mosdeffoyerlatest python dont need access local data cours drop mount command codeblock bash docker run mosdeffoyerlatest python clean remov creat contain use follow command codeblock bash docker contain rm foyer note instead use latest use imag codemosdeffoyerst recent stabl releas foyer run tutori exampl foyer paper contain toy exampl usag exampl section foyer paper httpsarxivorgpdfpdf__ sourc code select list page jupyt notebook httpsgithubcommosdefhubfoyertreemasterdocsexamples__ tri exampl note exampl meant showcas abil foyer simpl exampl user would like examin indepth exampl use foyer mbuild pleas refer tutori repositori httpsgithubcommosdefhubmosdef_tutorials__ list paper python script fill mathxx nm box ethan molecul system atomtyp use oplsaa forcefield two approach problem detail list first approach use forcefield_fil function argument mbuild httpsgithubcommosdefhubmbuild__ atomptyp system use foyer hood second approach creat foyer forcefield object call appli function oper mbuild compound return properli atomtyp structur note instanc use foyer chemic system interest convert parm structur even mbuild compound call save routin convert parm structur foyer atomtyp object return foyer atomtyp appli parm structur subject chang later iter foyer homogen fluid code python import mbuild mb mbuildlibmolecul import ethan foyerexamplesutil import example_file_path foyer import forcefield appli forc field save mbuild creat chemic topolog ethane_fluid mbfill_boxcompoundethan n_compound box appli save topolog ethane_fluidsaveethaneboxtop forcefield_filesexample_file_pathoplsaa_alkanexml ethane_fluidsaveethaneboxgro appli forc field directli foyer creat chemic topolog ethane_fluid mbfill_boxcompoundethan n_compound box load forcefield opls_alkan forcefieldforcefield_filesexample_file_pathoplsaa_alkanexml appli forcefield atomtyp ethane_fluid opls_alkaneapplyethane_fluid save atomtyp system ethane_fluidsaveethaneboxtop overwritetru ethane_fluidsaveethaneboxgro overwritetru fluid silica substrat exampl list text showcas abil creat two separ chemic topolog appli differ forcefield file two parameter system gener combin singl parm structur save disk code python foyer import forcefield foyerexamplesutil import example_file_path import mbuild mb mbuildexampl import ethan mbuildlibatom import h mbuildlibbulk_materi import amorphoussilicabulk mbuildlibrecip import silicainterfac mbuildlibrecip import monolay creat silica substrat cap surfac oxygen hydrogen silicasilicainterfacebulk_silicaamorphoussilicabulk silica_substratemonolayersurfacesilicachainshguest_port_nameup determin box dimens dictat silica substrat boxmbboxmin maxsilicaxyzmaxssilicaperiod fill box ethan ethane_fluidmbfill_boxcompoundethanen_compoundsboxbox load forcefield opls_silicaforcefieldforcefield_filesget_example_fileoplsaa_with_silicaxml opls_silicaforcefieldforcefield_filesexample_file_pathoutputxml opls_alkaneforcefieldforcefield_filesexample_file_pathoplsaa_alkanexml appli forcefield silica_substrateopls_silicaapplysilica_substr ethane_fluidopls_alkaneapplyethane_fluid merg two topolog systemsilica_substrateethane_fluid save atomtyp system systemsaveethanesilicatop systemsaveethanesilicagro smartsbas atomtyp foyer allow user describ atomtyp use modifi version smart httpwwwdaylightcomdayhtmldoctheorytheorysmartshtml__ may alreadi familiar smile httpswwwwikiwandcomensimplified_molecularinput_lineentry_system__ represent describ chemic structur smart straightforward extens notat basic usag consid follow exampl defin oplsaa atomtyp methyl group carbon hydrogen atom code xml forcefield atomtyp type nameopls_ classct elementc mass defcxchhh descalkan ch type nameopls_ classhc elementh mass defhcx descalkan h atomtyp forcefield xml format extens openmm forc field format httpdocsopenmmorglatestuserguideapplicationhtmlcreatingforcefields__ exampl util two addit xml attribut support foyer def desc atomtyp attempt match alway first token smart string exampl cx h opls_ methyl group carbon defin smart string indic carbon bond carbon neighbor hydrogen neighbor opls_ alkan hydrogen defin simpli hydrogen atom bond carbon bond overrid atomtyp multipl atomtyp definit appli given atom must establish preced definit mani atomtyp determin rule preced place specif rule first evalu sequenc break loop soon match found approach work becom challeng maintain correct order rule number atomtyp grow foyer iter run rule atom atom maintain whitelist rule appli blacklist rule superced anoth rule set differ white blacklist yield correct atomtyp forc field implement correctli add rule blacklist use overrid attribut xml file illustr exampl overrid use consid follow type describ alken benzen code xml forcefield atomtyp type nameopls_ classcm elementc mass defcxccc descalken c rc type nameopls_ classcm elementc mass defcxcch descalken c rhc type nameopls_ classhc elementh mass defhcx descalken h type nameopls_ classca elementc mass defcxrcxrcxrcxrcxrcxr overridesopls_opls_ type nameopls_ classha elementh mass defhcopls_ overridesopls_ descbenzen h atomtyp forcefield atomtyp benzen molecul carbon atom match smart pattern opls_ opls_ without overrid attribut foyer notifi multipl atomtyp found carbon provid overrid indic opls_ pattern match superced specifi rule support smart grammar current yet support smart featur httpwwwdaylightcomdayhtmldoctheorytheorysmartshtml__ httpsgithubcommosdefhubfoyerissues__ keep track portion support usag exampl foyer support atomtyp allatom coarsegrain molecular system also allow separ forc field use atomtyp separ portion molecular system creat box ethan use mbuild construct box fill ethan molecul use foyer atomtyp system appli opl forc field save runabl gromac file code python import mbuild mb mbuildlibmolecul import ethan ethane_box mbfill_boxcompoundethan n_compound box ethane_boxsaveethaneboxgro ethane_boxsaveethaneboxtop forcefield_nameoplsaa creat box coarsegrain ethan use mbuild construct box fill ethan molecul howev model ethan use unitedatom descript appli trapp forc field atomtyp note particl name prefix underscor foyer know particl nonatomist code python import mbuild mb ethane_ua mbcompound ch_ mbparticlename_ch po ch_ mbparticlename_ch po ethane_uaaddch_ ch_ ethane_uaadd_bondch_ ch_ ethane_ua_box mbfill_boxethane_ua box ethane_ua_boxsaveethaneuaboxgro ethane_ua_boxsaveethaneuaboxtop forcefield_nametrappeua combin forc field instanc use multipl forc field may desir describ molecular system exampl user may want use one forc field surfac anoth fluid system foyer support function allow user separ atomtyp part system exampl take system featur bulk unit atom ethan silica surfac appli opl forc field surfac trapp forc field ethan two atomtyp parm structur combin use simpl oper save gromac file code python foyer import forcefield foyerexamplesutil import example_file_path import mbuild mb mbuildexampl import ethan mbuildlibatom import h mbuildlibbulk_materi import amorphoussilica mbuildlibrecip import silicainterfac mbuildlibrecip import monolay interfac silicainterfacebulk_silicaamorphoussilica interfac monolayersurfaceinterfac chainsh guest_port_nameup box mbboxmin maxinterfacexyz maxsinterfaceperiod ethane_box mbfill_boxcompoundethan n_compound boxbox opl forcefieldnameoplsaa opls_silica forcefieldforcefield_filesexample_file_pathoplssilicaxml ethane_box oplsapplyethane_box interfac opls_silicaapplyinterfac system interfac ethane_box systemsaveethanesilicagro systemsaveethanesilicatop paramet definit paramet definit within forc field xml follow convent defin openmm document httpdocsopenmmorglatestuserguideapplicationhtmlcreatingforcefields__ current certain function form molecular forc support futur develop expect allow foyer support desir function form includ reactiv tabul potenti current support function form molecular forc nonbond lennardjon httpdocsopenmmorglatestuserguideapplicationhtmlnonbondedforce__ bond harmon httpdocsopenmmorglatestuserguideapplicationhtmlharmonicbondforce__ angl harmon httpdocsopenmmorglatestuserguideapplicationhtmlharmonicangleforce__ torsion proper period httpdocsopenmmorglatestuserguideapplicationhtmlperiodictorsionforce__ ryckaertbelleman httpdocsopenmmorglatestuserguideapplicationhtmlrbtorsionforce__ torsion improp period httpdocsopenmmorglatestuserguideapplicationhtmlperiodictorsionforce__ definit molecular forc follow openmm standard httpdocsopenmmorglatestuserguidetheoryhtml_ harmon bond potenti defin math e frackrr_ k bond coeffici mathfracenergydist r sub equilibrium bond distanc note factor mathfrac dihedr potenti report fourier seri eg opl convert ryckaertbelleman rb torsion specifi gromac user manual httpsmanualgromacsorgdocumentationcurrentreferencemanualfunctionsbondedinteractionshtmlproperdihedralsryckaertbellemansfunction_ class vs type openmm allow user specifi either class type see atom type atom class httpdocsopenmmorglatestuserguideapplicationhtmlatomtypesandatomclasses_ defin particl within forc definit type refer specif atom type defin atomtyp section class refer gener descript appli multipl atomtyp ie multipl atomtyp may share class aid limit number forc definit requir forc field xml mani similar atom type may share forc paramet assign paramet specif foyer deviat openmm convent match forc definit forc field xml instanc forc molecular system openmm forc assign accord first match definit forc field xml even multipl match definit exist contrast foyer assign forc paramet base definit specif definit contain type attribut consid specif exampl code xml rbtorsionforc proper classct classct classct classct c c c c c c proper typeopls_ typeopls_ typeopls_ typeopls_ c c c c c c rbtorsionforc two proper torsion defin describ torsion forc four tetrahedr carbon howev first definit featur four class attribut zero type attribut describ gener dihedr tetrahedr carbon second definit featur zero class attribut four type attribut describ specif dihedr case one end carbon type opls_ fluorin carbon remain three carbon type opls_ alkan carbon consid want use forc field contain torsion definit assign paramet molecular system featur partial fluorin alkan assign torsion paramet quartet atom one end carbon fluorin opls_ remain three hydrogen opls_ use openmm procedur paramet assign gener ctctctct torsion paramet first definit would assign would first match definit forc field xml howev foyer second definit autodetect specif due greater number type attribut vs paramet assign instead note two definit featur specif level ie number type definit automat detect preced possibl paramet assign follow openmm procedur wherebi paramet first match forc definit xml assign appli forc field main method use foyer forcefieldappli method import argument understand first sever assert_bond_param assert_angle_param assert_dihedral_param assert_improper_param argument requir suppli forc field paramet everi bond angl dihedr improp system case get error mean forc field miss paramet one bondsanglesdihedralsimprop system could paramet miss atomtyp ie smart string incorrect argument true default except assert_improper_param case wise verifi final file gener expect number bondsanglesdihedralsimprop system import option argument combining_rul option lorentz lorentzberthelot default valid option geometr forc field use geometr combin rule cite foyer use foyer research pleas cite paper httpsdoiorgjcommatsci_ preprint httpsarxivorgabs_ ac klein c summer z thompson w gilmer j b mccabe c cum p sallai j iacovella c r formal atomtyp dissemin forc field foyer comput materi scienc bibtex codeblock bibtex articleklein titl formal atomtyp dissemin forc field foyer journal comput materi scienc volum page year issn doi httpsdoiorgjcommatsci url httpwwwsciencedirectcomsciencearticlepii author christoph klein andrew z summer matthew w thompson justin b gilmer clare mccabe peter cum jano sallai christoph r iacovella keyword molecular simul forc field reproduc opensourc softwar download downloadbibtex filesfoyer_citationbib downloadri filesfoyer_citationri unit foyer forcefield xml file use follow unit follow unit use openmm httpdocsopenmmorglatestuserguidetheoryhtmlunits_ quantiti unit distanc nm angl radian mass amu energi kjmol pleas note unit paramet found parameter parmedstructur follow unit use parm httpsparmedgithubioparmedhtmldimensional_analysishtml_ forcefield class primari data structur foyer forcefield class inherit openmm class name primari oper class appli function take chemic topolog return parametr parm structur user may pass otion function base particular use case autoclass foyerforcefieldforcefield member valid forc field file foyer perform sever valid step help prevent malform forc field file smart string make product code goal provid human readabl error messag user may intim familiar xml smart pars grammar easili act upon howev receiv unclear error messag warn strongli encourag submit issu httpsgithubcommosdefhubfoyerissuesnew_ detail error messag receiv possibl attach minim exampl forc field file creat problem xml schema first line defens forc field file load foyer valid xml schema definit foyerforcefieldsffxsd__ enforc element eg harmonicbondforc valid attribut format addit schema ensur atomtyp defin atomtyp referenc section actual defin atomtyp element smart valid smart string use defin atomtyp pars pars error captur rerais error messag allow pin point locat problem xml file within smart string wherev possibl attempt provid help hint welcom contribut help improv clariti error messag addit ensur atomtyp referenc use type overrid syntax smartshtml__ actual defin atomtyp element