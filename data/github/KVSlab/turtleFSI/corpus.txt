document statushttpsreadthedocsorgprojectsturtlefsibadgeversionlatesthttpsturtlefsireadthedocsioenlatestbadgelatest build statushttpstravisciorgkvslabturtlefsisvgbranchmasterhttpstravisciorgkvslabturtlefsi statushttpsjosstheojorgpapersbfebdaadbcbbstatussvghttpsjosstheojorgpapersbfebdaadbcbb turtlefsi fluidstructur interact solver p aligncent img srcfigsturtlefsi_swimgif width height altturtlefsi_swim img srcfigsturek_benchmarkgif width height altturtlefsi_swim p p aligncent left show turtl swim turtlefsi right classic turek benchmark fsi p descript turtlefsi monolith fluidstructur interact solver written fenic outofthebox high perform capabl goal turtlefsi provid research group individu simpl robust solver investig fluid structur interact problem author turtlefsi develop andrea slyngstad sebastian gjertsen aslak w bergersen alban souch kristian valensendstad licenc turtlefsi licens gnu gpl version option later version turtlefsi copyright author document introduct turtlefsi tutori pleas refer documentationhttpsturtlefsireadthedocsioenlatest wish use turtlefsi journal public pleas refer joss publicationhttpsjosstheojorgpapersjoss bergersen et al turtlefsi robust monolith fenicsbas fluidstructur interact solver journal open sourc softwar httpsdoiorgjoss instal turtlefsi build upon open sourc finit element fenic project version pleas refer respect fenic document instal depend system howev use linux maxosx instal turtlefsi anaconda conda creat n your_environ c condaforg turtlefsi activ environ rune sourc activ your_environ set start run fluidstructur interact simul would like use save_deg pleas instal fenicstool runningth follow pip instal githttpsgithubcommikaemfenicstool use run turtlefsi default paramet turtlefsi see command line paramet run follow command turtlefsi h run specif problem file turtlefsi problem path_to_problem call specif problem file turtlefsi first look file name local check file name present directori turtlefsiproblem pleas refer documentationhttpsturtlefsireadthedocsioenlatest learn defin new problem file complet descript usag contact latest version softwar obtain httpsgithubcomkvslabturtlefsi pleas report bug issu issu tracker httpsgithubcomkvslabturtlefsiissu contribut turtlefsi contribut repositori pleas first discuss chang wish make via issu email method owner repositori make chang test pleas provid unit test new code creat test main function featur submit alway use test coverag submit chang order submit chang pleas send github pull request turtlefsihttpsgithubcomkvslabturtlefsipullnewmast clear list youv done read pull requestshttphelpgithubcompullrequest pleas follow code convent make sure commit atom one featur per commit alway write clear commit messag submit chang onelin messag fine small chang bigger chang look like git commit brief summari commit paragraph describ chang impact code convent format avoid inlin comment break long line charact delet trail whitespac dont includ space dont misspel use space indent use empti line method use space around oper except unari oper use space comma colon semicolon around name avoid abbrevi use snake case variabl method use camel case class name variabl method class reveal intent organ order method caller method earlier file method call place method receiv command line argument bottom file toplevel script environ check separ local global import modul code conduct pledg interest foster open welcom environ contributor maintain pledg make particip project commun harassmentfre experi everyon regardless age bodi size disabl ethnic sex characterist gender ident express level experi educ socioeconom statu nation person appear race religion sexual ident orient standard exampl behavior contribut creat posit environ includ use welcom inclus languag respect differ viewpoint experi grace accept construct critic focus best commun show empathi toward commun member exampl unaccept behavior particip includ use sexual languag imageri unwelcom sexual attent advanc troll insultingderogatori comment person polit attack public privat harass publish other privat inform physic electron address without explicit permiss conduct could reason consid inappropri profession set respons project maintain respons clarifi standard accept behavior expect take appropri fair correct action respons instanc unaccept behavior project maintain right respons remov edit reject comment commit code wiki edit issu contribut align code conduct ban temporarili perman contributor behavior deem inappropri threaten offens harm scope code conduct appli within project space public space individu repres project commun exampl repres project commun includ use offici project email address post via offici social media account act appoint repres onlin offlin event represent project may defin clarifi project maintain enforc instanc abus harass otherwis unaccept behavior may report contact project team albansimulano complaint review investig result respons deem necessari appropri circumst project team oblig maintain confidenti regard report incid detail specif enforc polici may post separ project maintain follow enforc code conduct good faith may face temporari perman repercuss determin member project leadership attribut code conduct adapt contributor covenanthomepag version avail httpswwwcontributorcovenantorgversioncodeofconducthtml homepag httpswwwcontributorcovenantorg answer common question code conduct see httpswwwcontributorcovenantorgfaq titl turtlefsi robust monolith fenicsbas fluidstructur interact solver tag fluidstructur interact fenic finiteel numer method author name aslak w bergersen orcid affili name andrea slyngstad affili name sebastian gjertsen affili name alban souch orcid affili name kristian valensendstad orcid affili affili name depart comput physiolog simula research laboratori fornebu norway index date june bibliographi paperbib summari often suffici studi fluid moin solid holzapfel isol gain fundament insight physic problem factor may play secondari role neglect hand certain phenomena situat stress fluid solid lead larg deform interact fluid solid essenti letallec comput fluidstructur interact fsi activ field research much focu numer accuraci stabil converg rate time also sweet spot area research need experi fsi without indepth bottomup mathemat understand problem physic insight might suffic therefor aim develop fulli monolith robust entrylevel research code easeofus target toward student educ research fenic logg emerg one lead platform develop scientif softwar due close connect mathemat notat compact comput implement highli effici c code compil execut program combin outofthebox entrylevel highperform comput capabl fenic natur choic comput environ compar opensourc fsi solver malinen heil jasak turtlefsi written coupl hundr line highlevel python code contrast ten thousand line lowlevel c code provid full transpar uniqu opportun research educ modifi experi code still provid box entrylevel highperform comput capabl furthermor close resembl mathemat code fenic user make addit modif eas turtlefsi solver reli fulli monolith approach classic arbitrari lagrangianeulerian formul use gener theta scheme tempor discret ppp element veloc pressur displac respect implement evalu four differ mesh lift oper rang simpl effici secondord laplac equat suitabl small deform sophist comput expens th order biharmon equat handl larger mesh deform use method manufactur solut verifi implement obtain result formal secondord accur l space time wick respect demonstr build block code exhibit desir properti solver valid confirm use classic turek flag benchmark case turek good agreement includ diverg numer solut long term evolut certain condit expect complet justif comput approach detail refer slyngstad gjertsen demonstr adequ strong scale core one cluster node although latter problem sizedepend onlin document provid benchmark tutori simpl demo naiv fenic implement provid full transpar compact code easili adapt fsi problem conclus turtlefsi superior fsi solver term speed robust entrylevel fsi solver perform exactli design intend slow steadi win race turtlefsi action turtlefsi come sever problem file found turtlefsiproblem illustr usag document turek flag benchmark use valid implement solver illustr execut output expect solver fluid_turekcentercfd_illupng width figur fluid dynam benchmark snapshot simul execut command turtlefsi problem tf_cfd solid_turekcentercsm_illupng width figur solid mechan benchmark snapshot simul execut command turtlefsi problem tf_csm fsi_turekcenterfsi_illupng width figur full fluidstructur interact benchmark snapshot simul execut command turtlefsi problem tf_fsi acknowledg studi support research council norway center biomed comput grant centr cardiolog innov grant number simmi project grant number simul perform abel cluster univers oslo norwegian metacent high perform comput notur project nnk experiment infrastructur explor exascal comput ex cluster norwegian research council grant refer titl acknowledg refer _acknow_ref acknowledg refer would like acknowledg opensourc project fenic httpswwwfenicsprojectorg_ basi turtlefsi numer scheme turtlefsi present test slyngstad _ gjertsen _ input problem set tf_cfd tf_csm tf_fsi taken turek et al _ benchmark paper slyngstad andrea verif valid monolith fluidstructur interact solver fenic comparison mesh lift oper ms thesi gjertsen sebastian develop verifi valid comput framework fluidstructur interact investig lift oper numer stabil ms thesi turek stefan jaroslav hron propos numer benchmark fluidstructur interact elast object laminar incompress flow fluidstructur interact springer berlin heidelberg titl new featur _new_featur new featur exist method provid mani degre freedom howev need specif method function pleas hesit propos enhanc issu tracker httpsgithubcomkvslabturtlefsiissues_ creat pull request new featur request follow guidelin contribut httpsgithubcomkvslabturtlefsiblobmastercontributingmd_ titl solver verif perform _verif_perf newton solver converg perform illustr solver converg perform turtlefsi fsi pipe flow problem anim impos constant dirichlet plug flow one end fluid domain comput result structur deform fluid flow along pipe figur figsmovie__tstepgif width px align center anim problem use benchmark converg perform solver converg robust turtlefsi reli use direct solver mump within newton iter use direct solver larg problem rapidli becom comput demand inde comput cost turtlefsi spent perform factor linear system newton iter mitig limit reus factor sever iter updat jacobian matrix problem typic done simul newton iter exhibit good converg behavior turtlefsi reus jacobian matrix set flag recomput take integ control mani iter reus jacobian matrix timestep recompute_tstep control mani time step take reus jacobian matrix note increas rel absolut residu trigger turtlefsi recomput jacobian matrix irrespect prescrib user valu set recomput recompute_tstep figur illustr converg solver use full newton procedur updat jacobian matrix iter step versu reus jacobian matrix iter time step reus jacobian matrix lead larger number iter per time step typic iter instead updat jacobian matrix comput time drastic reduc ca min per time step result produc amd cpu ryzen use thread figur figsreuse_jac_iterationspng width px align center figur comparison converg behavior newton procedur updat reus jacobian matrix residu plot time step fsi pipe flow problem see anim averag execut time time step updat jacobian second second reus jacobian hpc perform turtlefsi benefit highperform comput hpc function fenic solver execut mpi parallel task follow without addit code mpirun np turtlefsi perform strong scale fsi pipe flow illustr behavior solver use rel larg number parallel mpi task present result obtain second time step simul start initi rest demonstr adequ scale use core one cluster node execut turtlefsi modul instal within docker contain figur c direct consequ split geometri sever mpi domain figur b increas system size associ handl degre freedom along inner split boundari illustr effect figur total memori usag monitor function number mpi task use solv problem exampl reus jacobian matrix factor direct solver five newton iter shown figur c total execut time comput jacobian matrix factor system two order magnitud larger solv five iter step reus factor figur figsfigure_hpcpng width px align center figur strong scale fsi pipe flow problem mesh inner fluid domain outer solid pipe total thousand element b split geometri mpi domain c total time spent one time step jac jacobian matrix evalu fact direct solver factor step direct solver solv step function number mpi task system memori usag function number mpi task three differ mesh discret problem illustr panel titl instal _instal instal compat depend depend turtlefsi fenic numpi x python fenicstool option basic instal macox linux oper system recommend instal turtlefsi anaconda first instal anaconda miniconda httpsdocscondaioprojectscondaenlatestuserguideinstalldownloadhtmlanacondaorminiconda_ depend need instal turtlefsi recommend miniconda execut follow command termin window conda creat n your_environ c condaforg turtlefsi activ environ run sourc activ your_environ set start use turtlefsi detail explan usag turtlefsi found httpsturtlefsireadthedocsioenlatestusing_turtlefsihtml_ use turtlefsi high perform comput hpc cluster alway recommend build sourc describ accord guidelin provid fenic project httpsfenicsprojectorgdownload_ user instal fenic sourc hpc cluster fulli featur version turtlefsi would also need instal fenicstool manual pip instal githttpsgithubcommikaemfenicstool develop version download latest develop version turtlefsi found offici turtlefsi git repositori httpsgithubcomkvslabturtlefsi_ github clone turtlefsi repositori open termin navig directori wish turtlefsi store type follow command press enter git clone httpsgithubcomkvslabturtlefsi sourc distribut download file locat newli creat turtlefsi folder build order build instal turtlefsi navig turtlefsi folder setuppi file locat first make sure depend instal instal turtlefsi execut follow python setuppi instal instal turtlefsi somewher root access typic cluster add user instal local use fenicstool use save_deg function follow procedur clone fenicstool git repositori httpsgithubcommikaemfenicstools_ instead turtlefsi document master file creat sphinxquickstart tue mar adapt file complet like least contain root toctre direct titl turtlefsi welcom turtlefsi document toctre maxdepth instal using_turtlefsi verif_perf new_featur acknow_ref titl use turtlefsi _using_turtlefsi use turtlefsi execut run turtlefsi aim user friendli paramet control command line provid exampl creat problem file first quick recap execut turtlefsi run turtlefsi default paramet execut turtlefsi execut default problem file turtle_demopi default paramet folder execut command folder turtle_demo_result find visual file checkpoint find list paramet use default_variablespickl note default number time step set take coupl minut execut normal desktop recreat video shown readm set end time second take time run look intermedi result turtle_demo_result paraview run simul run specif problem file run turtlefsi problem path_to_problem get overview paramet pleas run turtlefsi h builtin function turtlefsi design lightweight gener ad featur gener interest checkpointingrestart store file visual checkpoint set variabl checkpointstep set checkpoint frequenc ie often checkpoint store restart previou checkpoint use command restartfold foldersubfold note variabl previou simul overwrit paramet defin set_problem_paramet commandlin need chang paramet previou checkpoint file instanc end time still explicitli redefin variabl initi function set often save file visual set savestep note default set paramet default paramet set problem__init__pi file problem specif paramet overwritten problem file set_problem_paramet command line summari paramet updat follow order default paramet set_problem_paramet command line checkpoint problem specif function creat problem file creat stepbystep explan see creat problem file numer problem specifi set paramet provid mesh boundari condit solv equat final specifi metric interest measur turtlefsi problem file defin seven function provid solver mention inform list order first execut set_problem_paramet get_mesh_domain_and_boundari initi option create_bc pre_solv option post_solv option finish option set_problem_paramet function defin paramet problem like time step size dt end time physic paramet problem see full list default paramet refer default_vari defin turtlefsiproblems__init__pi pleas note also defin problem specif variabl default_vari instanc geometri inform like hight length problem interest problem solv set_problem_paramet function possibl set problem paramet within default_vari dictionari howev keep mind command line argument overwrit default_vari simpl exampl function look like def set_problem_parametersdefault_vari namespac overwrit default valu default_variablesupdatedict end time dt time step theta theta valu dt shift cranknicolson scheme um max veloc inlet ms rho_f fluid densiti kgm mu_f fluid dynam viscos pa rho_s solid densiti kgm mu_s solid shear modulu nd lame coef pa lambda_s solid st lame coef pa nu_ solid poisson ratio dx_f_id id marker fluid domain dx_s_id id marker solid domain extrapolationbiharmon laplac elast biharmon noextrapol extrapolation_sub_typeconstrained_disp constant small_const volum volume_chang constrained_disp constrained_disp_vel recomput recomput jacobian matrix everi recomput newton iter folderturtle_demo_result name folder save data save_step frequenc data save return default_vari note paramet extrapol refer mesh lift oper ie de extrapol deform solid fluid creat ale frame refer laplac cheapest term comput cost less robust larg deform sharp edg contrast biharmon robust cost comput effici increas memori load get_mesh_domain_and_boundari function essenti uniqu everi problem provid problem file run read defin mesh domain marker boundari marker turtle_demopi read mesh data preexist xdmf mesh file contrast defin domain boundari marker use fenic function like turek flagexampl tf_fsipi pygmsh meshio relev tool creat geometri question regard mesh refer fenic document discours group httpsfenicsprojectdiscoursegroup_ turtle_demopi function look like def get_mesh_domain_and_boundariesarg namespac mesh_fold pathjoinpathdirnamepathabspath__file__ mesh turtle_demo exampl mesh marker store follow file mesh_path pathjoinmesh_fold turtle_meshxdmf mesh geometri domains_marker_path pathjoinmesh_fold mcxdmf marker element domain boundaries_marker_path pathjoinmesh_fold mfxdmf marker segment boundari mesh collect mesh geometri entir domain fluid solid exampl import mesh store xdmf file format support xml file mesh mesh xdmf xdmffilempicomm_world mesh_path xdmfreadmesh domain collect element marker fluid domain mark solid domain mark domain meshfunctionsize_t mesh meshgeometrydim xdmf xdmffilempicomm_world domains_marker_path xdmfreaddomain boundari collect boundari marker use appli dirichlet boundari condit fluid solid domain marker valu rang mesh_collect meshvaluecollectionsize_t mesh meshgeometrydim xdmf xdmffilempicomm_world boundaries_marker_path xdmfreadmesh_collect boundari cppmeshmeshfunctionsizetmesh mesh_collect return mesh domain boundari figur figsturtle_boundariespng width px align center domain boundari initi function strictli necessari use initi variabl enter time loop simul need therefor includ see tf_fsipi exampl create_bc function create_bc use defin boundari condit problem solv requir problem file run turtle_demopi inlet boundari condit defin inlet class inherit fenic userexpress class class use function create_bc prescrib dirichlet boundari condit inlet veloc defin boundari condit specif domain region boundari make sure consist marker provid get_mesh_domain_and_boundari class inletuserexpress def __init__self um kwarg selft selft_ramp time rampup max inlet veloc um selfum um max veloc inlet ms super__init__kwarg def updateself selft selft selft_ramp selfvalu selfum npabsnpcosselftselft_rampnppi rampup inlet veloc printselfvalu els um_min selfum lower veloc oscil selfvalu selfumum_min npabsnpcosselftselft_rampnppi um_min printselfvalu def evalself valu x valu selfvalu valu def value_shapeself return def create_bcsdvp boundari um v_deg extrapolation_sub_typ namespac mpirankmpicomm_world printcreat bc inlet inletum degreev_deg noslip segment indic make sure consist boundari file bottom_id segment bottom model outlet_id segment outlet right wall model top_id segment top right wall model inlet_id segment inlet left wall model turtle_head_tail_id segment along head tail turtl fluid veloc boundari condit u_inlet dirichletbcdvpsub inlet boundari inlet_id u_bot dirichletbcdvpsubsub boundari bottom_id slip xdirect u_top dirichletbcdvpsubsub boundari top_id slip xdirect u_head_tail dirichletbcdvpsub noslip boundari turtle_head_tail_id pressur boundari condit p_outlet dirichletbcdvpsub boundari outlet_id list boundari condit fluid bc u_bot u_top u_inlet p_outlet u_head_tail mesh uplift boundari condit d_inlet dirichletbcdvpsub noslip boundari inlet_id d_bot dirichletbcdvpsub noslip boundari bottom_id d_top dirichletbcdvpsub noslip boundari top_id d_outlet dirichletbcdvpsub noslip boundari outlet_id d_head_tail dirichletbcdvpsub noslip boundari turtle_head_tail_id add boundari condit structur bc d_bot d_top d_outlet d_inlet d_head_tail return dictbcsbc inletinlet figur figsturtle_boundaries_zoompng width px align center boundari fluid structur fix boundari figur figsturtle_inlet_velpng width px align center inlet veloc amplitud variat time defin class inlet pre_solv function call within time loop simul call solver given time step turtle_demopi use function updat time variabl inlet express use inlet boundari condit def pre_solvet inlet namespac updat time variabl use inlet boundari condit inletupdatet post_solv function call within time loop simul call solver given time step turtle_demopi use function see tf_fsipi exampl finish function call end time loop exampl use given tf_fsipi text file save store inform simul def finishedfold dis_x dis_i drag_list lift_list time_list namespac mpirankmpicomm_world npsavetxtpathjoinfold lifttxt lift_list delimit npsavetxtpathjoinfold dragtxt drag_list delimit npsavetxtpathjoinfold timetxt time_list delimit npsavetxtpathjoinfold dis_xtxt dis_x delimit npsavetxtpathjoinfold dis_ytxt dis_i delimit visual result given paramet savestep set larger number time step folder foldersubfoldervisu xdmf file open visual probrem instanc paraview visual pressur veloc figur figsturtle_flow_pressure_fields_t_spng width px align center pressur veloc field obtain run turtle_demopi problem file