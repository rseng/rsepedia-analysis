shinyarchruio shinyarchruiohttpscancellmedisinuionoshinyarchruioshinyarchr user interfac openi userfriendli integr opensourc shinybas web app use r program visual massiv singlecel chromatin access data scatacseq base archrhttpsarchrprojectcom granja et al httpswwwnaturecomarticless exampl web interfac tutori dataset avail shinyarchruiohttpscancellmedisinuionoshinyarchruio websit sharma et al bioinformaticshttpsacademicoupcombioinformaticsadvancearticledoibioinformaticsbtab learn videotutori httpsyoutubegiuggjwlwcw downsampl tutori data util tutori data download use gettutorialdata function shini instanc shinyarchruio downsampl tutori data hematopoiet cell approxim gb size use analysi step describ full manual archr toolkit httpswwwarchrprojectcombookdownindexhtml input data archr process archr read wide rang input format often fragment file bam file also capabl read scatacseq data scatacseq fragment file contain correspond cell id scatacseq fragment sort tabix file bam file contain inform scatacseq fragment raw sequenc cellular barcod id inform tabular format preprocess pipelin defin input format use x genom cell ranger softwar exampl return fragment file sciatacseq applic use bam file read fragment file archr use scantabix read bam file use scanbam support input process input data chunk convert compress tablebas represent fragment includ fragment chromosom offsetadjust start end posit well cellular barcod id preserv memori consumpt maintain quick access chunk chunk store temporari hdfformat file final step involv read organ rewrit portion chromosom arrow file within singl hdf group refer fragment way archr abl handl extrem larg input file effici low memori usag allow fulli util parallel process salient featur shinyarchruio written r program use shini packag enabl use local well make avail broader audienc host shini server web interfac scalabl low memori footprint due use arrow file format use archr given massiv singlecel atac seq data user export manuscriptreadi figur pdf tabl content addit tutori readm divid follow section instal quick start guid rapidli deploy shinyarchruio frequent ask question link citat info instal r download shinyarchruio githubcomeskelandlabshinyarchruio git clone httpsgithubcomeskelandlabshinyarchruiogit quick start guid analysi perform shown archr full manualhttpswwwarchrprojectcombookdownindexhtml test dataset hematopoiet cell appli user dataset instal mandatori packag open r environ r gui choic run follow code r check devtool requirenamespacedevtool quietli true installpackagesdevtool instal archr devtoolsinstall_githubgreenleaflabarchrrefmasterreposbiocmanagerrepositori instal archr depend libraryarchr archrinstallextrapackag instal requir packag installpackagescshinyseurat magickhexbinshinybusygridextra gridshinycssload command line r instal devtool rscript e installpackagesdevtoolsreposhttpcranrprojectorg instal biocmanag rscript e installpackagesbiocmanagerreposhttpcranrprojectorg instal archr rscript e devtoolsinstall_githubgreenleaflabarchrrefmasterreposbiocmanagerrepositori instal archr depend rscript e archrinstallextrapackag instal packag rscript e installpackagescshinymagickhexbinseuratshinybusygridextra gridshinycssload ad folder path paramet set paramet open globalr file file editor specifi follow paramet archrthread r set archrthread per avail comput resourc set archr section file default set archrthread provid path save folder globalr r savedarchrproject loadarchrprojectpath projhem savedarchrproject loadarchrprojectpath projhem savedarchrproject loadarchrprojectpath projhem use trajectori name use gettrajectoryhttpswwwarchrprojectcombookdownmyeloidtrajectorymonocytedifferentiationhtml function instead lymphoidu globalr save r trajectory_namelymphoidu save globalr file run shinyarchruio commandlin navig folder contain shinyarchruio r e shinyrunappshinyarchruiolaunchbrows true run shinyarchruio r gui shinyrunappshinyarchruio shinyarchruio tab informationhttpsgithubcomeskelandlabshinyarchruioblobmainexample_datatab_info_wikipng shinyarchruio visual sccluster user select scatacseq cluster unconstrain constrain remap cluster visual compar multidimension reduct umap plot sidebysid scatacseq peak browser visual chromatin access peak browser track origin sampl cluster scatacseq modal peakgenelink visual peaksgenelnk peak browser track select featur interest bottom panel show peak coaccess inform shown featur interest featur interest umap featur comparis tab show multidimension reduct umap allow user compar featur interest genescorematrix geneintegrationmatrix pseudotim trajectori visual pseudotim trajectori genescorematrix geneintegrationmatrix motifmatrix peakmatrix peakgenelink heatmap visual heatmap peakgenelink top marker scatacseq scrnaseq detail descript pleas see supplementari informationhttpswwwbiorxivorgcontentvsupplementarymateri frequent ask question q version r program requir r version recommend q requir packag run shinyarchruio pleas ensur shini archr seurat magick hexbin shinybusi depend requir instal load properli r environ run within r environ detail requir packag depend along found session inform file github repositori q set refer genom hg shinyarchruio support visual addit genom annot custom annot genom set basi gene genom annot demo version util data align use hg genom version howev user analyz data speci custom genom gene annot use creategeneannot creategenomeannot function archr archr nativ support hg hg mm mm use addarchrgenomehg use hg instead hg q much memorystorag space shinyarchruio shini app consum shini app less memori intens meant heavyduti app multipl user access app time memori requir depend save project file archr simultan archr employ arrow file hdf file format store massiv singlecel chromatin access data disk user server initi setup shinyarchruio computationintens includ step comput marker gene peakgenelink analysi plot typic laptop gb ram handl dataset estim k cell gb ram machin handl around kk cell initi app take approxim minut downsampl exampl tutori dataset hematopoiet cell util archr manual q get bad gateway error demo shinyarchruio web interfacehttpscancellmedisinuionoshinyarchruio perform hard refresh browser clear browser cach delet cooki browser may hold certain file save visit websit error pleas wait minut could due higher load server side pleas let us know error still persist q specif shinyarchruio server r rhel system use selinux nginx ssl model name intelr xeonr platinum cpu ghz architectur x_ cpu opmod bit bit cpu cpu famili ram gi icon name computervm virtual vmware oper system red hat enterpris linux ootpa cpe os name cpeoredhatenterprise_linuxga kernel linux elx_ link gener introduct tool set shinyarchruio local pleas watch shinyarchruio introduct video tutorialhttpsyoutubetsljconur pleas watch shinyarchruio setup video tutorialhttpsyoutubeqsoztcyjg citat inform pleas cite shinyarchruio articl publish oup bioinformaticshttpsacademicoupcombioinformaticsadvancearticledoibioinformaticsbtab biorxiv preprinthttpswwwbiorxivorgcontentv ankush sharma akshay akshay mari rogn ragnhild eskeland shinyarchruio userfriendli integr opensourc tool visual singlecel atacseq data use archr bioinformat btab httpsdoiorgbioinformaticsbtab titl archrexampl author akshayankush date output html_document r setup includefals knitropts_chunksetecho true r loadlibrari includefals setse libraryarchr libraryhexbin addarchrthreadsthread addarchrgenomehg r creat arrow file includefals inputfil gettutorialdatahematopoiesi arrowfil createarrowfil inputfil inputfil samplenam namesinputfil filtertss dont set high alway increas later filterfrag addtilemat true addgenescoremat true r add doblet includefals doubscor adddoubletscor input arrowfil k refer mani cell near pseudodoublet count knnmethod umap refer embed use nearest neighbor search doublet project lsimethod r creat archrproject includefals projhem archrproject arrowfil arrowfil outputdirectori hemetutori copyarrow true recommen modifi arrow file origin copi later usag inspect projhem pastememori size roundobjectsizeprojhem mb getavailablematricesprojhem exampl accessor allow direct access cellcoldata headprojhemecellnam access cell name associ cell headprojhemesampl access sampl name associ cell quantileprojhemetssenrich access tss enrich score cell exampl subset archrproject cell projhem projhemeprojhemecellnam subset project base certain cell name subset project keep cell correspond specif sampl idxsampl biocgenericswhichprojhemesampl scatac_bmmc_r cellssampl projhemecellnamesidxsampl projhemecellssampl subset project keep cell meet specif cutoff tss enrich score idxpass whichprojhemetssenrich cellspass projhemecellnamesidxpass projhemecellspass exampl ad data archrproject one way bionam gsub_r_rscatac_projhemesampl headbionam projhemebionam bionam altern bionam bionam cellnam projhemecellnam projhem addcellcoldataarchrproj projhem data pastebionam cell cellnam name bionam getcellcoldataprojhem select cbionam bionam r plot sampl statist includefals exampl make ridg plot sampl tss enrich score p plotgroup archrproj projhem groupbi sampl colorbi cellcoldata name tssenrich plota ridg save archrprojetc savearchrprojectarchrproj projhem outputdirectori saveprojhem load fals filter doublet archrproject projhem filterdoubletsprojhem dimesion reduct r dimesion reduct includefals projhem additerativelsi archrproj projhem usematrix tilematrix name iterativelsi iter clusterparam list see seuratfindclust resolut c samplecel nstart varfeatur dimstous iter less featur projhem additerativelsi archrproj projhem usematrix tilematrix name iterativelsi iter clusterparam list see seuratfindclust resolut c samplecel nstart varfeatur dimstous batch effect correct wtih harmoni batch effect correct wtih harmoni r batch effect correct includefals projhem addharmoni archrproj projhem reduceddim iterativelsi name harmoni groupbi sampl cluster r cluster includefals make cluster projhem addclust input projhem reduceddim iterativelsi method seurat scran name cluster resolut headprojhemeclust tableprojhemeclust sampl resid cluster cm confusionmatrixpasteprojhemeclust pasteprojhemesampl cm plot librarypheatmap cm cm matrixrowsumscm p pheatmappheatmap mat asmatrixcm color palettecontinuouswhiteblu border_color black p umap r umap includefals projhem addumap archrproj projhem reduceddim iterativelsi name umap nneighbor mindist metric cosin p plotembeddingarchrproj projhem colorbi cellcoldata name sampl embed umap instead color sampl color cluster p plotembeddingarchrproj projhem colorbi cellcoldata name cluster embed umap ggalignplotsp p type h tsne r tsne includefals projhem addtsn archrproj projhem reduceddim iterativelsi name tsne perplex p plotembeddingarchrproj projhem colorbi cellcoldata name sampl embed tsne p plotembeddingarchrproj projhem colorbi cellcoldata name cluster embed tsne ggalignplotsp p type h gene score marker gene archr r gene score marker gene includefals identifi marker gene markersg getmarkerfeatur archrproj projhem usematrix genescorematrix groupbi cluster bia ctssenrich lognfrag testmethod wilcoxon get relev marker featur cluster markerlist getmarkersmarkersg cutoff fdr logfc markerlistc visual marker featur simultan markergen c cd earli progenitor gata erythroid pax msa ebf mme bcell trajectori cd cebpb mpo monocyt irf cdd cda tbx ilr tcell heatmapg markerheatmap semark markersg cutoff fdr logfc labelmark markergen transpos true complexheatmapdrawheatmapg heatmap_legend_sid bot annotation_legend_sid bot visual marker gene embed markergen c cd earli progenitor gata erythroid pax msa mme bcell trajectori cd mpo monocyt cdd cdatcel p plotembed archrproj projhem colorbi genescorematrix name markergen embed umap quantcut c imputeweight null pcd plot specif gene subset plot list plot gene use cowplot arrang variou marker gene singl plot p lapplyp functionx x guidescolor fals fill fals theme_archrbases themeplotmargin unitc cm theme axistextxelement_blank axisticksxelement_blank axistextyelement_blank axisticksyelement_blank docallcowplotplot_grid clistncol p marker gene imput magic r marker gene imput includefals projhem addimputeweightsprojhem markergen c cd earli progenitor gata erythroid pax msa mme bcell trajectori cd mpo monocyt cdd cdatcel p plotembed archrproj projhem colorbi genescorematrix name markergen embed umap imputeweight getimputeweightsprojhem pcd track plot archrbrows r marker gene imput includefals markergen c cd earli progenitor gata erythroid pax msa bcell trajectori cd monocyt cdd cda tbx ilr tcell p plotbrowsertrack archrproj projhem groupbi cluster genesymbol markergen upstream downstream gridgridnewpag gridgriddrawpcd defin cluster ident scrnaseq r cluster ident includefals iffileexistsscrnahematopoiesisgranjard downloadfil url httpsjeffgranjasamazonawscomarchrtestdatascrnahematopoiesisgranjard destfil scrnahematopoiesisgranjard serna readrdsscrnahematopoiesisgranjard colnamescoldataserna unconstrain integr projhem addgeneintegrationmatrix archrproj projhem usematrix genescorematrix matrixnam geneintegrationmatrix reduceddim iterativelsi serna serna addtoarrow fals grouprna bioclassif namecel predictedcell_un namegroup predictedgroup_un namescor predictedscore_un constrain integr cm asmatrixconfusionmatrixprojhemeclust projhemepredictedgroup_un preclust colnamescmapplycm whichmax cbindpreclust rownamescm assign cell type label scrnaseq data use unconstrain integr uniqueuniqueprojhemepredictedgroup_un scrna ctnk pastepast collaps ctnk nont cell nonnk cell cluster ie cluster cnontnk pastecpast collaps cnontnk assign scatac categori clusttnk rownamescmgrepctnk preclust clusttnk nont cell nonnk cell identifi remain scatacseq cluster clustnontnk rownamescmgrepcnontnk preclust clustnontnk rna get cell categori rnatnk colnamessernagrepctnk coldatasernabioclassif headrnatnk identifi nont cell nonnk cell cell scrnaseq data rnanontnk colnamessernagrepcnontnk coldatasernabioclassif headrnanontnk grouplist simplelist tnk simplelist atac projhemecellnamesprojhemeclust clusttnk rna rnatnk nontnk simplelist atac projhemecellnamesprojhemeclust clustnontnk rna rnanontnk pass list grouplist paramet addgeneintegrationmatrix function constrain integr note case still ad result arrow file addtoarrow fals recommend check result integr thoroughli expect prior save result arrow file illustr process next section book minut projhem addgeneintegrationmatrix archrproj projhem usematrix genescorematrix matrixnam geneintegrationmatrix reduceddim iterativelsi serna serna addtoarrow fals grouplist grouplist grouprna bioclassif namecel predictedcell_co namegroup predictedgroup_co namescor predictedscore_co compar unconstrain constrain integr pal palettediscretevalu coldatasernabioclassif p plotembed projhem colorbi cellcoldata name predictedgroup_un pal pal p visual integr overlay scrnaseq cell type scatacseq data base constrain integr p plotembed projhem colorbi cellcoldata name predictedgroup_co pal pal p save project savearchrprojectarchrproj projhem outputdirectori saveprojhem load fals defin cluster ident scrnaseq r cluster ident includefals iffileexistsscrnahematopoiesisgranjard downloadfil url httpsjeffgranjasamazonawscomarchrtestdatascrnahematopoiesisgranjard destfil scrnahematopoiesisgranjard serna readrdsscrnahematopoiesisgranjard colnamescoldataserna unconstrain integr projhem addgeneintegrationmatrix archrproj projhem usematrix genescorematrix matrixnam geneintegrationmatrix reduceddim iterativelsi serna serna addtoarrow fals grouprna bioclassif namecel predictedcell_un namegroup predictedgroup_un namescor predictedscore_un constrain integr cm asmatrixconfusionmatrixprojhemeclust projhemepredictedgroup_un preclust colnamescmapplycm whichmax cbindpreclust rownamescm assign cell type label scrnaseq data use unconstrain integr uniqueuniqueprojhemepredictedgroup_un scrna ctnk pastepast collaps ctnk nont cell nonnk cell cluster ie cluster cnontnk pastecpast collaps cnontnk assign scatac categori clusttnk rownamescmgrepctnk preclust clusttnk nont cell nonnk cell identifi remain scatacseq cluster clustnontnk rownamescmgrepcnontnk preclust clustnontnk rna get cell categori rnatnk colnamessernagrepctnk coldatasernabioclassif headrnatnk identifi nont cell nonnk cell cell scrnaseq data rnanontnk colnamessernagrepcnontnk coldatasernabioclassif headrnanontnk grouplist simplelist tnk simplelist atac projhemecellnamesprojhemeclust clusttnk rna rnatnk nontnk simplelist atac projhemecellnamesprojhemeclust clustnontnk rna rnanontnk pass list grouplist paramet addgeneintegrationmatrix function constrain integr note case still ad result arrow file addtoarrow fals recommend check result integr thoroughli expect prior save result arrow file illustr process next section book minut projhem addgeneintegrationmatrix archrproj projhem usematrix genescorematrix matrixnam geneintegrationmatrix reduceddim iterativelsi serna serna addtoarrow fals grouplist grouplist grouprna bioclassif namecel predictedcell_co namegroup predictedgroup_co namescor predictedscore_co compar unconstrain constrain integr pal palettediscretevalu coldatasernabioclassif p plotembed projhem colorbi cellcoldata name predictedgroup_un pal pal p visual integr overlay scrnaseq cell type scatacseq data base constrain integr p plotembed projhem colorbi cellcoldata name predictedgroup_co pal pal p save project savearchrprojectarchrproj projhem outputdirectori saveprojhem load fals ad pseudoscrnaseq profil scatacseq cell r ad pseudoscrnaseq includefals minut projhem addgeneintegrationmatrix archrproj projhem usematrix genescorematrix matrixnam geneintegrationmatrix reduceddim iterativelsi serna serna addtoarrow true forc true grouplist grouplist grouprna bioclassif namecel predictedcel namegroup predictedgroup namescor predictedscor check integr matrix getavailablematricesprojhem ad imput weight project projhem addimputeweightsprojhem make umap plot overlay gene express valu geneintegrationmatrix markergen c cd earli progenitor gata erythroid pax msa bcell trajectori cd monocyt cdd cda tbx ilr tcell p plotembed archrproj projhem colorbi geneintegrationmatrix name markergen continuousset horizonextra embed umap imputeweight getimputeweightsprojhem make umap plot overlay gene score valu genescorematrix p plotembed archrproj projhem colorbi genescorematrix continuousset horizonextra name markergen embed umap imputeweight getimputeweightsprojhem plot marker gene use cowplot pc lapplyp functionx x guidescolor fals fill fals theme_archrbases themeplotmargin unitc cm theme axistextxelement_blank axisticksxelement_blank axistextyelement_blank axisticksyelement_blank pc lapplyp functionx x guidescolor fals fill fals theme_archrbases themeplotmargin unitc cm theme axistextxelement_blank axisticksxelement_blank axistextyelement_blank axisticksyelement_blank docallcowplotplot_grid clistncol pc label scatacseq cluster scrnaseq inform r label scatacseq cluster scrnaseq includefals creat confus matrix scatacseq cluster predictedgroup obtain integr analysi cm confusionmatrixprojhemeclust projhemepredictedgroup labelold rownamescm labelold scatacseq cluster identifi cell type predictedgroup best defin cluster labelnew colnamescmapplycm whichmax labelnew scrnaseq cluster redefin label someth easier interpret remapclust c _hsc progenitor _earlyeryth erythroid _lateeryth erythroid _earlybaso basophil _cmplmpp progenitor _clp clp _gmp gmp _gmpneut gmp _pdc pdc _cdc cdc _cdmono mono _cdmono mono _cdmono mono _clp clp _preb preb _b b _plasma plasma _cdn cdn _cdn cdn _cdn cdn _cdm cdm _cdem cdem _cdcm cdcm _nk nk remapclust remapclustnamesremapclust labelnew convert label new simpler system labelnew maplabelslabelnew oldlabel namesremapclust newlabel remapclust labelnew combin labelsold labelsnew projhemeclust maplabelsprojhemeclust newlabel labelnew oldlabel labelold plot umap new cluster ident overlay p plotembeddingprojhem colorbi cellcoldata name cluster p savearchrprojectarchrproj projhem outputdirectori saveprojhem load fals make pseudobulk replic archr r make pseudobulk replic includefals projhem addgroupcoveragesarchrproj projhem groupbi cluster call peak archr r call peak archr includefals call peak w mac pathtomac findmac projhem addreproduciblepeakset archrproj projhem groupbi cluster pathtomac pathtomac getpeaksetprojhem call peak w tilematrix projhemetmp addreproduciblepeakset archrproj projhem groupbi cluster peakmethod tile method p getpeaksetprojhemetmp compar two peak call method lengthsubsetbyoverlapsgetpeaksetprojhem getpeaksetprojhemetmp lengthgetpeaksetprojhem lengthsubsetbyoverlapsgetpeaksetprojhemetmp getpeaksetprojhem lengthgetpeaksetprojhemetmp lengthsubsetbyoverlapsresizegetpeaksetprojhem center getpeaksetprojhemetmp lengthgetpeaksetprojhem lengthsubsetbyoverlapsgetpeaksetprojhemetmp resizegetpeaksetprojhem center lengthgetpeaksetprojhemetmp add peak matrix savearchrprojectarchrproj projhem outputdirectori saveprojhem load fals projhem loadarchrprojectusersakshaydesktopphdprojetcsextraarchrsaveprojhem projhem addpeakmatrixprojhem getavailablematricesprojhem identifi marker peak archr r identifi marker peak includefals scrna label tableprojhemeclust markerspeak getmarkerfeatur archrproj projhem usematrix peakmatrix groupbi cluster bia ctssenrich lognfrag testmethod wilcoxon markerspeak markerlist getmarkersmarkerspeak cutoff fdr logfc markerlist markerlist getmarkersmarkerspeak cutoff fdr logfc returngr true markerlist markerlisterythroid marker peak heatmap heatmappeak markerheatmap semark markerspeak cutoff fdr logfc transpos true drawheatmappeak heatmap_legend_sid bot annotation_legend_sid bot marker peak volcano plot pv markerplotsemark markerspeak name erythroid cutoff fdr logfc plota volcano pv marker peak browser track p plotbrowsertrack archrproj projhem groupbi cluster genesymbol cgata featur getmarkersmarkerspeak cutoff fdr logfc returngr trueerythroid upstream downstream gridgridnewpag gridgriddrawpgata pairwis test group markertest getmarkerfeatur archrproj projhem usematrix peakmatrix groupbi cluster testmethod wilcoxon bia ctssenrich lognfrag usegroup erythroid bgdgroup progenitor pma markerplotsemark markertest name erythroid cutoff fdr abslogfc plota pma pv markerplotsemark markertest name erythroid cutoff fdr abslogfc plota volcano pv motif featur enrich archr r motif featur enrich includefals motif enrich differenti peak projhem addmotifannotationsarchrproj projhem motifset cisbp name motif motifsup peakannoenrich semark markertest archrproj projhem peakannot motif cutoff fdr logfc motifsup data plot df dataframetf rownamesmotifsup mlogpadj assaymotifsup df dforderdfmlogpadj decreas true dfrank seq_lennrowdf ggup ggplotdf aesrank mlogpadj color mlogpadj geom_points ggrepelgeom_label_repel data dfrevseq_len aesx rank mlogpadj label tf size nudge_x color black theme_archr ylablogpadj motif enrich xlabrank sort tf enrich scale_color_gradientncolor palettecontinuousset comet ggup perform analys peak access progenitor cell use peak logfc motifsdo peakannoenrich semark markertest archrproj projhem peakannot motif cutoff fdr logfc motifsdo df dataframetf rownamesmotifsdo mlogpadj assaymotifsdo df dforderdfmlogpadj decreas true dfrank seq_lennrowdf headdf ggdo ggplotdf aesrank mlogpadj color mlogpadj geom_points ggrepelgeom_label_repel data dfrevseq_len aesx rank mlogpadj label tf size nudge_x color black theme_archr ylablogfdr motif enrich xlabrank sort tf enrich scale_color_gradientncolor palettecontinuousset comet ggdo motif enrich marker peak enrichmotif peakannoenrich semark markerspeak archrproj projhem peakannot motif cutoff fdr logfc enrichmotif heatmapem plotenrichheatmapenrichmotif n transpos true complexheatmapdrawheatmapem heatmap_legend_sid bot annotation_legend_sid bot archr enrich r archr enrich includefals encod tf bind site projhem addarchrannotationsarchrproj projhem collect encodetfbsforc true enrichencod peakannoenrich semark markerspeak archrproj projhem peakannot encodetfb cutoff fdr logfc enrichencod heatmapencod plotenrichheatmapenrichencod n transpos true complexheatmapdrawheatmapencod heatmap_legend_sid bot annotation_legend_sid bot bulk atacseq projhem addarchrannotationsarchrproj projhem collect atacforc true enrichatac peakannoenrich semark markerspeak archrproj projhem peakannot atac cutoff fdr logfc enrichatac heatmapatac plotenrichheatmapenrichatac n transpos true complexheatmapdrawheatmapatac heatmap_legend_sid bot annotation_legend_sid bot codex tfb projhem addarchrannotationsarchrproj projhem collect codexforc true enrichcodex peakannoenrich semark markerspeak archrproj projhem peakannot codex cutoff fdr logfc enrichcodex heatmapcodex plotenrichheatmapenrichcodex n transpos true complexheatmapdrawheatmapcodex heatmap_legend_sid bot annotation_legend_sid bot custom enrich encodepeak c encode_k_gata httpswwwencodeprojectorgfilesencffnqidownloadencffnqibedgz encode_gm_cebpb httpswwwencodeprojectorgfilesencffmgjdownloadencffmgjbedgz encode_k_ebf httpswwwencodeprojectorgfilesencffvsydownloadencffvsybedgz encode_k_pax httpswwwencodeprojectorgfilesencffkuodownloadencffkuobedgz projhem addpeakannotationsarchrproj projhem region encodepeak name chip enrichregion peakannoenrich semark markerspeak archrproj projhem peakannot chip cutoff fdr logfc enrichregion heatmapregion plotenrichheatmapenrichregion n transpos true complexheatmapdrawheatmapregion heatmap_legend_sid bot annotation_legend_sid bot chromvar deviaton enrich archr r chromvar deviaton enrich motif deviat ifmotif ni namesprojhemepeakannot projhem addmotifannotationsarchrproj projhem motifset cisbp name motif projhem addbgdpeaksprojhem projhem adddeviationsmatrix archrproj projhem peakannot motif forc true plotvardev getvardeviationsprojhem name motifmatrix plot true plotvardev extract subset motif downstream analysi motif cgata cebpa ebf irf tbx pax markermotif getfeaturesprojhem select pastemotif collaps usematrix motifmatrix markermotif markermotif grepz markermotif valu true markermotif markermotifsmarkermotif ni zsrebf_ markermotif p plotgroupsarchrproj projhem groupbi cluster colorbi motifmatrix name markermotif imputeweight getimputeweightsprojhem p lapplyseq_alongp functionx ifx px guidescolor fals fill fals theme_archrbases themeplotmargin unitc cm theme axistextyelement_blank axisticksyelement_blank axistitleyelement_blank ylab els px guidescolor fals fill fals theme_archrbases themeplotmargin unitc cm theme axisticksyelement_blank axistitleyelement_blank ylab docallcowplotplot_grid clistnrow rel_width c rep lengthp p instead look distribut zscore overlay zscore umap embed weve done previous gene score p plotembed archrproj projhem colorbi motifmatrix name sortmarkermotif embed umap imputeweight getimputeweightsprojhem p lapplyp functionx x guidescolor fals fill fals theme_archrbases themeplotmargin unitc cm theme axistextxelement_blank axisticksxelement_blank axistextyelement_blank axisticksyelement_blank docallcowplotplot_grid clistncol p see tf deviat zscore compar infer gene express via gene score correspond tf gene overlay gene score tf umap embed markerrna getfeaturesprojhem select pastemotif collaps usematrix genescorematrix markerrna markerrnamarkerrna ni csrebfcebpadt markerrna p plotembed archrproj projhem colorbi genescorematrix name sortmarkerrna embed umap imputeweight getimputeweightsprojhem p lapplyp functionx x guidescolor fals fill fals theme_archrbases themeplotmargin unitc cm theme axistextxelement_blank axisticksxelement_blank axistextyelement_blank axisticksyelement_blank docallcowplotplot_grid clistncol p similarli previous link scatacseq data correspond scrnaseq data plot link gene express tf umap embed markerrna getfeaturesprojhem select pastemotif collaps usematrix geneintegrationmatrix markerrna markerrnamarkerrna ni csrebfcebpadt markerrna p plotembed archrproj projhem colorbi geneintegrationmatrix name sortmarkerrna embed umap continuousset blueyellow imputeweight getimputeweightsprojhem p lapplyp functionx x guidescolor fals fill fals theme_archrbases themeplotmargin unitc cm theme axistextxelement_blank axisticksxelement_blank axistextyelement_blank axisticksyelement_blank docallcowplotplot_grid clistncol p archr custom deviat encod tfb ifencodetfb ni namesprojhemepeakannot projhem addarchrannotationsarchrproj projhem collect encodetfb projhem adddeviationsmatrix archrproj projhem peakannot encodetfb forc true plotvardev getvardeviationsprojhem plot true name encodetfbsmatrix plotvardev ubset tf bind site particular motif interest plot deviat zscore percel umap embed tf cgata_ cebpb ebf irf tbx pax getfeaturesprojhem select pastetf collaps usematrix encodetfbsmatrix markertf getfeaturesprojhem select pastetf collaps usematrix encodetfbsmatrix markertf sortgrepz markertf valu true tfname stringrstr_splitstringrstr_splitmarkertf pattern simplifytru pattern simplifi true markertf markertfsduplicatedtfnam markertf p plotembed archrproj projhem colorbi encodetfbsmatrix name markertf embed umap imputeweight getimputeweightsprojhem p lapplyp functionx x guidescolor fals fill fals theme_archrbases themeplotmargin unitc cm theme axistextxelement_blank axisticksxelement_blank axistextyelement_blank axisticksyelement_blank docallcowplotplot_grid clistncol p bulk atacseq ifatac ni namesprojhemepeakannot projhem addarchrannotationsarchrproj projhem collect atac projhem adddeviationsmatrix archrproj projhem peakannot atac forc true plotvardev getvardeviationsprojhem plot true name atacmatrix plotvardev atacpeak cheme_hsc heme_lmpp heme_eri heme_mono heme_cd heme_cd heme_b heme_nk iatlas_dc_plasmacytoid getfeaturesprojhem select pasteatacpeak collaps usematrix atacmatrix markeratac getfeaturesprojhem select pasteatacpeak collaps usematrix atacmatrix markeratac sortgrepz markeratac valu true markeratac p plotembed archrproj projhem colorbi atacmatrix name markeratac embed umap imputeweight getimputeweightsprojhem p lapplyp functionx x guidescolor fals fill fals theme_archrbases themeplotmargin unitc cm theme axistextxelement_blank axisticksxelement_blank axistextyelement_blank axisticksyelement_blank docallcowplotplot_grid clistncol p footprint archr r footprint motif footprint motifposit getpositionsprojhem motif cgata markermotif unlistlapplymotif functionx grepx namesmotifposit valu true markermotif markermotifsmarkermotif ni srebf_ markermotif projhem addgroupcoveragesarchrproj projhem groupbi cluster sefoot getfootprint archrproj projhem posit motifpositionsmarkermotif groupbi cluster normal footprint tn bia pplotfootprint sefoot sefoot archrproj projhem normmethod subtract plotnam footprintssubtractbia adddoc fals plotfals smoothwindow librarygrid griddrawptss divid tn bin plotfootprint sefoot sefoot archrproj projhem normmethod divid plotnam footprintsdividebia adddoc fals smoothwindow footprint without normal tn bia pplotfootprint sefoot sefoot archrproj projhem normmethod none plotnam footprintsnonorm adddoc fals plotfals smoothwindow featur footprint projhem addgroupcoveragesarchrproj projhem groupbi cluster setss getfootprint archrproj projhem posit grangeslisttss gettssprojhem groupbi cluster flank pplotfootprint sefoot setss archrproj projhem normmethod none plotnam tssnonorm adddoc fals flank plotfals flanknorm integr analysi archr r integr analysi coaccess archr projhem addcoaccess archrproj projhem reduceddim iterativelsi ca getcoaccess archrproj projhem corcutoff resolut returnloop fals ca metadataca ca getcoaccess archrproj projhem corcutoff resolut returnloop true ca ca getcoaccess archrproj projhem corcutoff resolut returnloop true ca ca getcoaccess archrproj projhem corcutoff resolut returnloop true ca plot browser track coaccess markergen c cd earli progenitor gata erythroid pax msa bcell trajectori cd monocyt cdd cda tbx ilr tcell p plotbrowsertrack archrproj projhem groupbi cluster genesymbol markergen upstream downstream loop getcoaccessibilityprojhem gridgridnewpag gridgriddrawpcd peakgenelinkag archr projhem addpeakgenelink archrproj projhem reduceddim iterativelsi pg getpeakgenelink archrproj projhem corcutoff resolut returnloop fals pg pg getpeakgenelink archrproj projhem corcutoff resolut returnloop true pg pg getpeakgenelink archrproj projhem corcutoff resolut returnloop true pg plot browser track coaccess markergen c cd earli progenitor gata erythroid pax msa bcell trajectori cd monocyt cdd cda tbx ilr tcell p plotbrowsertrack archrproj projhem groupbi cluster genesymbol markergen upstream downstream loop getpeakgenelinksprojhem gridgridnewpag gridgriddrawpcd identif posit tfregul step identifi deviant tf motif segroupmotif getgroupsearchrproj projhem usematrix motifmatrix groupbi cluster segroupmotif sez segroupmotifrowdatasegroupmotifseqnamesz rowdatasezmaxdelta lapplyseq_lenncolsez functionx rowmaxsassaysez assaysezx reducecbind rowmax step identifi correl tf motif tf gene scoreexpress corgsm_mm correlatematric archrproj projhem usematrix genescorematrix usematrix motifmatrix reduceddim iterativelsi corgsm_mm corgim_mm correlatematric archrproj projhem usematrix geneintegrationmatrix usematrix motifmatrix reduceddim iterativelsi corgim_mm step add maximum delta deviat correl data frame corgsm_mmmaxdelta rowdatasezmatchcorgsm_mmmotifmatrix_nam rowdataseznam maxdelta corgim_mmmaxdelta rowdatasezmatchcorgim_mmmotifmatrix_nam rowdataseznam maxdelta step identifi posit tf regul corgsm_mm corgsm_mmorderabscorgsm_mmcor decreas true corgsm_mm corgsm_mmwhichduplicatedgsubcorgsm_mmmotifmatrix_nam corgsm_mmtfregul corgsm_mmtfregulatorwhichcorgsm_mmcor corgsm_mmpadj corgsm_mmmaxdelta quantilecorgsm_mmmaxdelta ye sortcorgsm_mmcorgsm_mmtfregulatory p ggplotdataframecorgsm_mm aescor maxdelta color tfregul geom_point theme_archr geom_vlinexintercept lti dash scale_color_manualvalu cnodarkgrey yesfirebrick xlabcorrel gene score ylabmax tf motif delta scale_y_continu expand c limit c maxcorgsm_mmmaxdelta p perform analysi correl deriv geneintegrationmatrix corgim_mm corgim_mmorderabscorgim_mmcor decreas true corgim_mm corgim_mmwhichduplicatedgsubcorgim_mmmotifmatrix_nam corgim_mmtfregul corgim_mmtfregulatorwhichcorgim_mmcor corgim_mmpadj corgim_mmmaxdelta quantilecorgim_mmmaxdelta ye sortcorgim_mmcorgim_mmtfregulatory p ggplotdataframecorgim_mm aescor maxdelta color tfregul geom_point theme_archr geom_vlinexintercept lti dash scale_color_manualvalu cnodarkgrey yesfirebrick xlabcorrel gene express ylabmax tf motif delta scale_y_continu expand c limit c maxcorgim_mmmaxdelta p trajectori analysi archr r trajectori analysi myeloid trajectori monocyt differenti p plotembeddingarchrproj projhem colorbi cellcoldata name cluster embed umap p plotembeddingarchrproj projhem colorbi cellcoldata name cluster embed umap ggalignplotsp p type h pseudotim umap individu featur plot trajectori cprogenitor gmp mono trajectori projhem addtrajectori archrproj projhem name myeloidu groupbi cluster trajectori trajectori embed umap forc true headprojhememyeloiduisnaprojhememyeloidu p plottrajectoryprojhem trajectori myeloidu colorbi cellcoldata name myeloidu p projhem addimputeweightsprojhem p plottrajectoryprojhem trajectori myeloidu colorbi genescorematrix name cebpb continuousset horizonextra p plottrajectoryprojhem trajectori myeloidu colorbi geneintegrationmatrix name cebpb continuousset blueyellow ggalignplotsp p type h ggalignplotsp p type h pseudotim heatmap trajmm gettrajectoryarchrproj projhem name myeloidu usematrix motifmatrix lognorm fals p plottrajectoryheatmaptrajmm pal palettecontinuousset solarextra trajgsm gettrajectoryarchrproj projhem name myeloidu usematrix genescorematrix lognorm true p trajectoryheatmaptrajgsm pal palettecontinuousset horizonextra trajgim gettrajectoryarchrproj projhem name myeloidu usematrix geneintegrationmatrix lognorm fals p plottrajectoryheatmaptrajgim pal palettecontinuousset blueyellow trajpm gettrajectoryarchrproj projhem name myeloidu usematrix peakmatrix lognorm true p plottrajectoryheatmaptrajpm pal palettecontinuousset solarextra integr pseudotim analys corgsm_mm correlatetrajectoriestrajgsm trajmm corgsm_mm trajgsm trajgsmcorgsm_mmnam trajmm trajmmcorgsm_mmnam trajcombin trajgsm assaytrajcombin tapplyassaytrajgsm scale tapplyassaytrajmm scale combinedmat plottrajectoryheatmaptrajcombin returnmat true varcutoff roword matchrownamescombinedmat rownamestrajgsm ht plottrajectoryheatmaptrajgsm pal palettecontinuousset horizonextra varcutoff roword roword ht plottrajectoryheatmaptrajmm pal palettecontinuousset solarextra varcutoff roword roword ht ht repeat exact process use gene express geneintegrationmatrix corgim_mm correlatetrajectoriestrajgim trajmm corgim_mm trajgim trajgimcorgim_mmnam trajmm trajmmcorgim_mmnam trajcombin trajgim assaytrajcombin tapplyassaytrajgim scale tapplyassaytrajmm scale combinedmat plottrajectoryheatmaptrajcombin returnmat true varcutoff roword matchrownamescombinedmat rownamestrajgim ht plottrajectoryheatmaptrajgim pal palettecontinuousset blueyellow varcutoff roword roword ht plottrajectoryheatmaptrajmm pal palettecontinuousset solarextra varcutoff roword roword ht ht lymphoid trajectori b cell cifferenti p plotembeddingarchrproj projhem colorbi cellcoldata name cluster embed umap p plotembeddingarchrproj projhem colorbi cellcoldata name cluster embed umap ggalignplotsp p type h pseudotim umap individu featur plot trajectori cprogenitor clp preb b trajectori projhem addtrajectori archrproj projhem name lymphoidu groupbi cluster trajectori trajectori embed umap forc true p plottrajectoryprojhem trajectori lymphoidu colorbi cellcoldata name lymphoidu p p plottrajectoryprojhem trajectori lymphoidu colorbi genescorematrix name pax continuousset horizonextra p plottrajectoryprojhem trajectori lymphoidu colorbi geneintegrationmatrix name pax continuousset blueyellow ggalignplotsp p type h savearchrprojectarchrproj projhem outputdirectori saveprojhem load fals