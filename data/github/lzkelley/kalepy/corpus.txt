kalepi kernel densiti estim sampl build statushttpstravisciorglzkelleykalepysvgbranchmasterhttpstravisciorglzkelleykalepi codecovhttpscodecovioghlzkelleykalepybranchmastergraphbadgesvghttpscodecovioghlzkelleykalepi document statushttpsreadthedocsorgprojectskalepybadgeversionlatesthttpskalepyreadthedocsioenlatestbadgelatest doihttpsjosstheojorgpapersjossstatussvghttpsdoiorgjoss doihttpszenodoorgbadgesvghttpszenodoorgbadgelatestdoi kalepi anim logohttpsrawgithubusercontentcomlzkelleykalepydevdocsmedialogo_anim_smallgif packag perform kde oper multidimension data calcul estim pdf probabl distribut function resampl new data pdf document number exampl also use continu integr test includ packag notebookshttpsgithubcomlzkelleykalepytreemasternotebook background inform refer includ joss paperhttpsjosstheojorgpapersjoss full document avail kalepyreadthedocsiohttpskalepyreadthedocsioenlatest readm content installationinstal quickstart basic usagebasicusag fanci usagefancyusag develop contributionsdevelopmentcontribut attribut citationattribut instal pypi ie via pip bash pip instal kalepi sourc eg develop bash git clone httpsgithubcomlzkelleykalepygit pip instal e kalepi case packag easili updat chang sourc directori pull rebuild bash cd kalepi git pull pip instal e option run unit test use nosetest packag nosetest kalepi kernel densiti estim sampl build statushttpstravisciorglzkelleykalepysvgbranchmasterhttpstravisciorglzkelleykalepi codecovhttpscodecovioghlzkelleykalepybranchmastergraphbadgesvghttpscodecovioghlzkelleykalepi document statushttpsreadthedocsorgprojectskalepybadgeversionlatesthttpskalepyreadthedocsioenlatestbadgelatest doihttpsjosstheojorgpapersjossstatussvghttpsdoiorgjoss doihttpszenodoorgbadgesvghttpszenodoorgbadgelatestdoi kalepi anim logohttpsrawgithubusercontentcomlzkelleykalepydevdocsmedialogo_anim_smallgif packag perform kde oper multidimension data calcul estim pdf probabl distribut function resampl new data pdf document number exampl also use continu integr test includ packag notebookshttpsgithubcomlzkelleykalepytreemasternotebook background inform refer includ joss paperhttpsjosstheojorgpapersjoss full document avail kalepyreadthedocsiohttpskalepyreadthedocsioenlatest readm content installationinstal quickstart basic usagebasicusag fanci usagefancyusag develop contributionsdevelopmentcontribut attribut citationattribut instal pypi ie via pip bash pip instal kalepi sourc eg develop bash git clone httpsgithubcomlzkelleykalepygit pip instal e kalepi case packag easili updat chang sourc directori pull rebuild bash cd kalepi git pull pip instal e option run unit test use nosetest packag nosetest basic usag python import numpi np import matplotlibpyplot plt import matplotlib mpl import kalepi kale kalepyplot import nbshow gener random data correspond distribut function python num int nprandomse combin data two differ pdf _d nprandomnorm num _d nprandomlognorm sizenum data npconcatenate_d _d calcul true distribut xx nplinspac yy npexpxx npsqrtnppi yy npexpnplogxx xxnpsqrtnppi plot smooth distribut python reconstruct probabilitydens base given data point point densiti kaledensitydata probabilitytru plot pdf pltplotpoint densiti k lw alpha labelkd plot true pdf pltplotxx yy r alpha lw labeltruth plot standard histogram densiti estim plthistdata densitytru histtypestep lw alpha labelhist pltlegend nbshow pnghttpsrawgithubusercontentcomlzkelleykalepymasterdocsmediademo_filesdemo__png resampl construct statist similar valu draw new sampl datapoint kde pdf python draw new sampl kde reconstruct pdf sampl kaleresampledata plot new sampl plthistsampl densitytru labelnew sampl alpha color edgecolorb plot old sampl plthistdata densitytru histtypestep lw alpha colorr labelinput data plot kde reconstruct pdf pltplotpoint densiti k lw alpha labelkd pltlegend nbshow pnghttpsrawgithubusercontentcomlzkelleykalepymasterdocsmediademo_filesdemo__png multivari distribut python reloadkaleplot load randomish threedimension data nprandomse data kaleutils_random_data_d_num construct kde kde kalekdedata construct new data resampl kde resamp kderesamplesize plot data distribut use builtin kalepycorn plot corner h kalecornerkd quantil h cornercleanresamp quantil distddictmedianfals ls cornerlegendh h input data new sampl nbshow pnghttpsrawgithubusercontentcomlzkelleykalepymasterdocsmediademo_filesdemo__png python resampl data default output size input data sampl kderesampl plot input data compar resampl data fig axe pltsubplotsfigs ncolskdendim ii ax enumerateax calcul plot pdf iith paramet ie data dimens ii xx yy kdedensityparamsii probabilitytru axplotxx yy k labelkd lw alpha draw histogram origin newli resampl dataset _ h axhistdataii histtypestep densitytru lw labelinput _ h axhistsamplesii histtypestep densitytru lw labelresampl add kalepycarpet plot show data point kalecarpetdataii axax colorhget_facecolor kalecarpetsamplesii axax colorhget_facecolor shiftaxget_ylim axeslegend nbshow pnghttpsrawgithubusercontentcomlzkelleykalepymasterdocsmediademo_filesdemo__png fanci usag reflect boundari distribut your tri captur edg like uniform distribut two bound kde choos reflect locat base extrema given data python uniform data edg ndata e nprandomse data nprandomuniform intndata creat carpet plot data kalecarpetdata labeldata histogram data plthistdata densitytru alpha labelhist color edgecolork standard kde undershoot justinsid edg overshoot outsid edg point pdf_basic kaledensitydata probabilitytru pltplotpoint pdf_basic r lw alpha labelkd reflect kde keep probabl within given bound set reflecttru let kde guess edg locat base data extrema point pdf_reflect kaledensitydata reflecttru probabilitytru pltplotpoint pdf_reflect b lw alpha labelreflect kde pltlegend nbshow pnghttpsrawgithubusercontentcomlzkelleykalepymasterdocsmediademo_filesdemo__png explicit reflect locat also provid number dimens python construct random data add artifici edg nprandomse edg data nprandomlognormalsigma sizeint data datadata edg histogram data use fix binposit edg nplinspaceedg plthistdata binsedg densitytru alpha labeldata color edgecolork standard kde estim point pdf_basic kaledensitydata probabilitytru pltplotpoint pdf_basic r lw alpha labelbas kde reflect kde set lowerboundari known valu upperboundari none given point pdf_basic kaledensitydata reflectedg none probabilitytru pltplotpoint pdf_basic b lw alpha labelreflect kde pltgcaset_xlimedg pltlegend nbshow pnghttpsrawgithubusercontentcomlzkelleykalepymasterdocsmediademo_filesdemo__png multivari reflect python load predefin dataset boundari x lowend highend data kaleutils_random_data_d_ construct kde given reflect boundari given explicitli kde kalekdedata reflect none none plot use default set kalecornerkd nbshow pnghttpsrawgithubusercontentcomlzkelleykalepymasterdocsmediademo_filesdemo__png specifi bandwidth kernel function python load predefin random data data kaleutils_random_data_d_num choos uniform xspace draw pdf xx nplinspac choos kernelfunct bandwidth test kernel parabola gaussian box bandwidth none none mean let kalepi choos ylabel automat cours fine fig axe pltsubplotsfigs ncolslenkernel nrowslenbandwidth sharextru shareytru pltsubplots_adjusthspac wspace ii jj ax npndenumerateax construct kde use particular kernelfunct bandwidth kern kernelsjj bw bandwidthsii kde kalekdedata kernelkern bandwidthbw bandwidth set none kde choos optim valu bw none bw kdebandwidth axset_titl bwfformatkern bw jj axset_ylabelylabelsii plot kde axplotkdepdfpointsxx colorr plot histogram data panel axhistdata binsauto colorb alpha densitytru plot carpet data panel kalecarpetdata axax colorb axsetxlim ylim nbshow pnghttpsrawgithubusercontentcomlzkelleykalepymasterdocsmediademo_filesdemo__png resampl use differ data weight python load random data true pdf comparison data truth kaleutils_random_data_d_ resampl data use differ weight resamp_uni kaleresampledata size resamp_sqr kaleresampledata weightsdata size resamp_inv kaleresampledata weightsdata size plot differ distribut setup plot paramet kw dictdensitytru histtypestep lw alpha binsauto xx yy truth sampl resamp_inv resamp_uni resamp_sqr yval yyxx yy yyxx label rpropto x rpropto rpropto x pltfigurefigs ii re yy lab enumeratezipsampl yval label hh pltplotxx yy ls alpha lw col hhget_color kalecarpetr colorcol shiftii plthistr colorcol labellab kw pltgcasetxlim add legend pltlegend display figur notebook nbshow pnghttpsrawgithubusercontentcomlzkelleykalepymasterdocsmediademo_filesdemo__png resampl keep certain parametersdimens python construct covari dataset th paramet take discret valu xx nprandomrandint yy nprandomnorm xxsize xx data xx yy plot set disabl histogram disabl mask dens scatterpoint distd dicthistfals mask_densefals draw corner plot kalecornerdata distddistd nbshow pnghttpsrawgithubusercontentcomlzkelleykalepymasterdocsmediademo_filesdemo__png standard kde resampl smooth discret variabl creat smoother distribut use keep paramet choos resampl actual data valu paramet instead resampl smooth base kde python kde kalekdedata resampl data normal keep th paramet valu resamp_stnd kderesampl resamp_keep kderesamplekeep corner kalecorn distdmedian fals disabl median crosshair h cornerplotresamp_stnd distddistd h cornerplotresamp_keep distddistd cornerlegendh h standard keep nbshow pnghttpsrawgithubusercontentcomlzkelleykalepymasterdocsmediademo_filesdemo__png develop contribut pleas visit github page httpsgithubcomlzkelleykalepy_ issu bug report contribut feedback welcom contributor luke zoltan kelley lzkelley zachari hafen zhafen joss paper kexin rong kexinrong arfon smith arfon handley williamjameshandley attribut joss paper publish kalepi packag found packag use research pleas add refer code paper codeblock tex articlekelley doi joss url httpsdoiorgjoss year publish open journal volum number page author luke zoltan kelley titl kalepi python packag kernel densiti estim sampl plot journal journal open sourc softwar develop contribut pleas visit github page httpsgithubcomlzkelleykalepy_ issu bug report contribut feedback welcom contributor luke zoltan kelley lzkelley zachari hafen zhafen joss paper kexin rong kexinrong arfon smith arfon handley williamjameshandley attribut joss paper submit found packag use research pleas add refer code paper codeblock tex articlekalepi author luke zoltan kelley titl kalepi python packag kernel densiti estim sampl journal journal open sourc softwar publish open journal todo knownissu optim need thing done gener simplest way current need optim perform speed memori eg reflect especi case finitesupport kernel calcul drastic sped also use approxim infinitesupport kernel truncat threshold valu sigma percentil etc tri use spstatsrv_continu baseclass distribut provid function like ppf etc differ covariancematrix element numer order magnitud caus spuriou result particular pdf margin paramet see kdedynam rang docstr current check kde_fin method end initi warn given dynam rang seem larg move checkingsanit function kde kernel etc assum correct eg extrema point reflect param etc add documenationexampl base draw function plot submodul eg draw_contourd draw_histd etc add testsdocument sampl submodul kalepi allow calcul pdf resampl particular dimensionsparamet fix doesnt work quit right nonfix bandwidth bandwidth need recalcul differ number dimens test test current check proper error rais make sure test check case num_point num_data visaversa eg pdf calcul kernelspi see _resample_clear _resample_reflect combin kdepi kde explor effici way calcul cdf use underli kernel instead integr pdf use differ method grid edg nd instead broadcast flatten ineffici plotpi add way track mani carpet plot ad axi automat offset appropri differ situat finish scatter method includ carpet option current v plot improv allow origin argument specifi corner plot place locat triangl one bl default tl tr br new kalepysampl submodul sampl continu defin function function defin sample_grid class function sample_grid provid simpl api construct instanc use construct sampl point access directli toplevel packag sample_grid_proport sample_outli v allow covari manual specifi kde constructor new kdefrom_hist method construct kde base exist distribut instead finit point deprec cdf function remov time triweight distribut work signific pdf evalu speed improv use numba sampl evalu code simplifi use abcabc base class distributionobject _distributionabcabc plot improv bug fix incorrect label rotat bottomright panel corner plot allow target line drawn corner plot use cornertarget add argument limit number carpet scatter point drawn v doc signific expans document docstr sphinx readthedocsorg allow kaleplotcorn instanc accept externallycr axe simplifi handl reflect argument improv binedg guess v complet restructur kalepyplot submodul particularli api extens addit improv document inlin docstr addit sphinx doc avail kalepyreadthedocsiokalepyreadthedocsio includ new demotest notebook automat incorpor readmemd sphinx document document test exampl includ core plot function need base draw function eg draw_contourd draw_histd etc kalepi paper fix typo point joss refere ad citat comparison getdist packag bug weight pass correctli resampl without reflect maint fix huge number deprec warn rais numpi oper jag array improv function kaleutilsjshap kaleutilsreallyd function accommod gener plot improv handl color colormap plot method automat select next colorcycl color construct match colormap synchron color plot compon handl quantil confid contour compon handl much selfconsist simpler api draw function eg carpet distd distd load current activ axe default v ad paper submit joss v api remov kdepdf_grid method instead use kdepdf gridtru kdepdf call kdedens probabilitytru note mean like densiti pdf function return tupl evalu point addit densiti valu argument reflect param use tandem kalepi kdepi kde pdf ident densiti probabilitytru pdf_grid delet call pdf gridtru instead kernelspi kernel densiti pdf _pdf_clear _pdf_reflect combin latter function singl new method v reflect argument true given singl valu particular parameterdimens case kde guess reflect point base data extrema dimens target one happen kernels_check_reflect gener bug fix improv kwarg handl plot api kalepydens bug fix issu grid mode output point didnt match valu shape add grid kwarg kalepi kernelspi _check_reflect ad boolean function reflect argument replac data extrema need plotpi gener bug fix improv kwarg handl return handl plot function allow legend utilspi new method check handl jag array flatten flatlen isjag jshape notebook apiipynb newfil new notebook run api test gen_readmepi newfil script automat assembl readmemd file base input templat _readmemd jupyt notebook demoipynb automat take care imag file updat git readmemd updat use gen_readmepi includ new cleaner exampl primarili use toplevel api v improv edg bin pdf evalu construct especi multipl dimens kde construct extrema given data call utilsparse_edg kalepi __init__pi corner newmethod new toplevel api method construct corner plot use either dataset kde instanc densiti newmethod interfac kdedens resampl newmethod interfac kderesampl kdepi kde_basepi renam improv edg construct construct extrema base input data use utilsparse_edg construct edg _guess_edg remov kde densiti newmethod calcul densiti use kde densiti either number densiti probabl densiti ie pdf pdf call densiti use probabilitytru kernelspi plotpi method construct corner plot base strongli dan foremanmackey corner packag corner class manag corner plot plot scatter data kde pdf corner_data higherlevel function construct full corner plot given scatterdata draw_carpet draw_carpet_fuzz renam add rotat argument plot vertic instead horizont hist newmethod calcul histogram use utilshistogram draw use _draw_histd util add posit argument filter posit definit valu _get_smap smap renam add log argument specifi logscal utilspi histogram newmethod calcul histogram densiti probabl paramet instead combin like numpi parse_edg allow weight pass calcul effect number data point interquartil rang quantil percentil stat newmethod combin array_str stats_str output _get_edges_d bug avoid neg binwidth small number data point notebook plottingipynb newfil test demonstr plot method especi corner plot kdeipynb add corner plot use cornerpi submodul convert_notebook_testspi build_notebook_testspi renam v start work clean api ie outward visibl function structur new api function kalepypdf kalepycdf cleanup variabl name convent kde kernel bug calcul pdf param given would often result error bad check edgesgrid shape kalepi __init__pi pdf newmethod conveni api method construct quick pdf base given data cdf newmethod conveni api method construct quick cdf base given data kde_basepi kde bug provid scalar valu bandwidth still multipli data covari need scott silverman rule scalar valu provid rescal covari cdf newmethod calcul cdf integr kdederiv cdf could done much better seem work base simpl test plotpi newfil plot relat function import default primarili intern usag align_axes_loc newmethod align twin axe particular locat base axe draw_carpet_fuzz newmethod draw fuzzstyl carpet plot nbshow move utilspi save_fig move utilspi smap newmethod construct scalarmapp object colormap normal plot plot_control move utilspi utilspi move plot relat method plotpi assert_tru newmethod intern test method bin ad docstr cumsum newmethod calcul cumul sum along either singl axi axe unlik numpycumsum cumtrapz ad docstr reallyd newmethod check given array realli onedimension oppos jag array run_if add otherwis argument function run negat appli run_if_ method space bug convert num integ usag test test_utilspi ad test cumsum notebook updat use initipi initi cell notebook default save plotsfil notebooksoutput v triweight kernel temporarili disabl normal problem nd kalepi kde_basepi class kde addit uncaught keywordargu pass kde initi kernel initi addit argument eg chunk pass along kernelspi bug triweight kernel work disabl kernel class kernel implement chunk resampl calcul current reflect produc extrem memori time perform increas certain paramet empir chunk size e seem work best resampl bug noninteg valu size would result error class distribut signific improv way cdf handl ppf newfunct percent point function invers cdf return quantil given cumulativeprob utilspi bound_indic bug error boolean logic check_path newfunct creat given path alreadi exist cumtrapz newfunct cumul summat use trapezoidrul light wrapper around trapz_dens_to_mass function modify_exist newfunct modifi given filenam alreadi exist run_if newfunct new function run pass method current environ target environ save_fig newfunct save matplotlib figur ad conveni featur doc logo logo associ data file notebook performanceipynb newfil new notebook perform check comparison diagnost v ad code produc kalepi logo ad attach media readm file updat notebook fix minor error v signific improv memori speed resampl reflect boundari implement chunk v kalepi __init__pi import desir api method modul namespac use __all__ kernelspi utilspi kde_basepi class kde introduc helper argument upon initi determin extra check verbos feedback given introcuc bw_rescal initi argument rescal bwmatrix factor matrix array pdf_grid newfunct conveni wrapper function calcul pdf given edg grid kernelspi introduc helper paramet see class kde allow keep paramet true case paramet kept fals none kept none _check_reflect add addit check reflect boundari rel datavalu bandwidth _resample_reflect bug reflect actual period boundari ish instead reflect sure still behav well test bug reflect unnecessarili duplic alreadi reflect data make fewer new point valid utilspi ave_std newfunct calcul option weight averag standarddevi bound_indic allow boundari none boundari percentil newfunct copi zcodemathstatist allow weight percentil stats_str copi function zcodemathmath_cor extend function trapz_dens_to_mass new argument axi integr along target axe trapz_nd new argument axi integr along target axe notebook initipi newfil conveni script set import notebook file utilsipynb newfil new notebook testingexplor utilspi submodul v modul renam kde kalepi notebook includ travi unit test ad skeleton sphinx document written yet readmemd ad instal inform basic exampl kalepi bandwidthspi kde_basepi newfil class kde newclass primari api use kalepi packag use pass data option construct kde interfac kernel instanc kde class calcul bandwidth construct kernel instanc handl pass data covari matrix kernel need pdf interfac kernel instanc method kernelpdf resampl interfac kernel instanc method kernelresampl kernelspi newfil store class method handl kernel underli distribut function note scale normal work properli multidimens kernel class kernel store covariancematrix use need distribut class instanc class distribut subclass implement particular distribut function use kernel agnost data covari kernel class handl covari matrix appropri transform data class gaussiandistribut gaussiannorm distribut function infinit support class box_asymdistribut boxcarrectangleuniform function finit support class paraboladistribut epanechnikov kernelfunct finit support class triweight cubic kernel similar parabola addit smooth deriv warn current work multipledimens normal get_all_distribution_class method retriev list distribut subclass mostli use test get_distribution_class convert argument distribut subclass need argument convert string specif distribut function return actual class utilspi class test_bas baseclass use unittest add_cov given covari matrix use choleski decomposit transform given data covari allclos newfunct conveni function unittest alltru newfunct conveni function unittest array_str newfunct format array element print bin newfunct gener bin edg center width togeth bound_indic find indic paramet space array within given bound cov_from_var_cor construct covari matrix given set varianc paramet correl matrix_invert invert matrix follow back svd initi fail rem_cov given covari matrix use choleski decomposit remov covari given data stats_str newfunct method calcul percentil given data return str trapz_dens_to_mass use ndimension trapezoid rule convert densiti grid mass eg pdf pmf test test_distributionspi test underli distribut function test_kdepi test toplevel kde class accuraci kde calcul pdf resampl test_kernelspi newfil test kernel directli test_utilspi test util function notebook kernelsipynb newfil examin test behavior differ kernel specif demoipynb newfil current includ materi use readmerst expand quick demonstr tutori packag v kde __init__pi class kde base class kde calcul model roughli scipystatsgaussian_kd class allow multidimension pdf calcul resampl data multidimension paramet space reflect boundari condit avail multipl dimens pdf calcul resampl utilspi gener util function packag method extract zcode packag midpoint calcul midpoint valu array either log linear space minmax calcul extrema given dataset allow comparison previou extrema set limit stretch return valu given amount space construct linear log space given extrema test test_kdepi basic test kde base class oper test_utilpi basic test util method notebook kdeipynb includ basic exampl test plot mostli test kdestest directori plot titl kalepi python packag kernel densiti estim sampl plot tag python astronomi statist mont carlo method author name luke zoltan kelley orcid affili multipl affili must quot affili name center interdisciplinari explor research astrophys ciera northwestern univers usa index name physic astronomi northwestern univers usa index date octob bibliographi paperbib summari kernel densiti estim kde rosenblatt parzen type nonparametr densiti estim scott improv upon tradit histogram approach exampl util exact locat data point instead bin ii abl produc smooth distribut continu meaning deriv iii remov arbitrari offset initi bin edg kalepi packag present python kde implement design broad applic includ numer featur absent packag kalepi provid option weight reflect boundari condit support arbitrari number dimens numer kernel ie window function builtin plot builtin resampl statement need numer python kde implement exist exampl scipi scipystatsgaussian_kd scipi seaborn seabornkdeplot seaborn getdist getdist kdepi kdepi scipi seaborn tool simpl access lack advanc function kdepi packag provid excel perform larg number data point dimens includ resampl boundari condit plot tool getdist packag offer extens method plot sampl util numer boundari treatment getdist lack standalon kde interfac resampl function kalepi provid conveni access plot numer result packag includ multipl kernel function builtin resampl boundari condit numer plot tool ndimension corner plot kalepi entir classbas focus eas use provid highli extens framework modif expans rang possibl applic kalepi featur specif particular field design resampl weight astronom dataset consid popul binari deriv cosmolog simul initi popul costli produc eg requir ten million cpu hour long accur sampl paramet space interest may suffici accur produc larger popul resampl variat eg use kde approach depend detail popul mani paramet may highli correl often abut boundari exampl massratio defin lowermass compon divid massiv compon often highli correl total mass binari bound unit interv ie q equiv m_ m_ leq faith resampl popul requir handl discontinu also preserv accur covari may distort transform variabl perform kde transform back method consid dimension paramet space n data point given x_i x_i x_i x_id n data point may associ weight appropri normal sum_in w_i kernel densiti estim gener posit x x_ x_ x_n written hatf_hx sum_in w_i k_hx x_i kernel typic express k_hx h klefth x right h bandwidth covari matrix choos kernel bandwidth matrix produc nuanc art kde common choic kernel like gaussian ie hatf_hx sum_in fracw_ipidh expx_j x_ij hj_k xk x_ik current implement gaussian triweight boxcar kernel implement addit epanechnikov kernel epanechnikov case shown statist optim discontinu deriv produc numer aesthet problem often bandwidth chosen diagon differ rulesofthumb typic use approxim bandwidth minim typic measur error andor bia exampl socal silverman factor silverman bandwidth h_ij delta_ij sigma_i left fracd nrightd textrmsumm impli delta_ij kroneck delta sigma_i standard deviat estim ith paramet current implement silverman scott factor scott bandwidth estim includ reflect boundari condit use improv reconstruct accuraci exampl data drawn lognorm distribut standard kde produc leakag outsid domain enforc restrict fx must known textita priori kernel redefin k_hx renorm preserv unitarityfootnotenot implement instead truncat renorm result hatf_h incorrectli redistribut probabl near boundari whole domain exampl shown autoreffigon histogram upper panel kde bottom resampl deriv pdf done much effici kde framework standard method cdf invers particular see sampl pdf ident resampl replac weight data point shift point base pdf kernel locat data drawn lognorm distribut use estim underli pdf use histgram upper kde lower true distribut shown magenta upper panel default bin chosen matplotlib especi uninsight blue custom bin misrepres distribut posit initi edg poorli chosen red data also includ carpet plot lower panel gaussian kde reflect blue compar one reflect x better reproduc true pdf data resampl reflectingkd pdf shown blue carpet point close resembl input data labelfigonefig_onepngwidth kalepi recent use astronomi astrophys particularli siwek kelley andrew acknowledg acknowledg help consult statist nuanc christoph berri diego muñoz support betatest perform magda siwek jeff andrew also much appreci kalepi util tool function numpi numpi matplotlib matplotlib scipi scipi jupyt notebook ipython jupyt corner foremanmackey refer