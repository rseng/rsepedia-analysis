rcmdcheckhttpsgithubcomtimoastsignacworkflowsrcmdcheckbadgesvghttpsgithubcomtimoastsignacact cran versionhttpswwwrpkgorgbadgesversionsignachttpscranrprojectorgpackagesignac cran downloadshttpscranlogsrpkgorgbadgessignachttpscranrprojectorgpackagesignac signac signac extens seurathttpsgithubcomsatijalabseurat analysi interpret explor singlecel chromatin dataset featur signac design analysi singlecel chromatin data includ scatacseq singlecel target tagment method sccuttag scactseq multimod dataset jointli measur chromatin state alongsid modal signac current support follow featur call peak quantifi percel count differ genom region calcul singlecel qc metric dimension reduct visual cluster identifi celltypespecif peak visual pseudobulk coverag track integr multipl singlecel dataset integr singlecel rnaseq dataset sequenc motif enrich analysi transcript factor footprint analysi link peak correl gene parallel futurehttpscranrprojectorgpackagefutur packag seamless interfac seurathttpssatijalaborgseurat seuratwrappershttpsgithubcomsatijalabseuratwrapp seuratdiskhttpsgithubcommojaveazureseuratdisk seuratdatahttpsgithubcomsatijalabseuratdata function interoper bioconductorhttpsbioconductororg tool pleas see signac vignettesarticlesoverviewhtml page exampl instal instruct see installarticlesinstallhtml page signac rcmdcheckhttpsgithubcomtimoastsignacworkflowsrcmdcheckbadgesvghttpsgithubcomtimoastsignacact cran versionhttpswwwrpkgorgbadgesversionsignachttpscranrprojectorgpackagesignac cran downloadshttpscranlogsrpkgorgbadgessignachttpscranrprojectorgpackagesignac overview signac comprehens r packag analysi singlecel chromatin data signac includ function qualiti control normal dimens reduct cluster differenti activ document tutori found httpssatijalaborgsignac instal signac requir bioconductorhttpswwwbioconductororg instal r requirenamespacebiocmanag quietli true installpackagesbiocmanag biocmanagerinstal setrepositoriesind instal latest releas signac cran r installpackagessignac releas latest develop version github r requirenamespaceremot quietli true installpackagesremot remotesinstall_githubtimoastsignac ref develop releas note changelog pleas see news filehttpsgithubcomtimoastsignacblobdevelopnewsmd also avail signac websitehttpssatijalaborgsignacnewsindexhtml get help encount bug featur request pleas open issuehttpsgithubcomtimoastsignacissu would like discuss question relat singlecel analysi open discussionhttpsgithubcomtimoastsignacdiscuss cite signac use signac packag work pleas cite stuart et al httpsdoiorg articlesignac titl singlecel chromatin state analysi signac author stuart tim srivastava avi madad shaista lareau caleb satija rahul journal nat method publish natur publish group page month nov year url httpswwwnaturecomarticless languag en relat packag seurathttpsgithubcomsatijalabseurat seuratobjecthttpsgithubcommojaveazureseuratobject seuratdiskhttpsgithubcommojaveazureseuratdisk seuratdatahttpsgithubcomsatijalabseuratdata seuratwrappershttpsgithubcomsatijalabseuratwrapp azimuthhttpsgithubcomsatijalabazimuth signac bug fix fix bug featurematrix cell inform present fragment object httpsgithubcomtimoastsignacissu fix bug object merg httpsgithubcomtimoastsignacissu add abil run linkpeak use ensembl id httpsgithubcomtimoastsignacissu fix issu geneact gene name na httpsgithubcomtimoastsignacissu fix bug featurematrix one region suppli allow neg valu expressionplot use scale data httpsgithubcomtimoastsignacissu chang ad idf paramet runtfidf use precomput idf vector ad geneid paramet geneact allow output gene name use gene id httpsgithubcomtimoastsignacissu ad sep paramet connectionstolink httpsgithubcomtimoastsignacissu signac bug fix fix bug findmotif use one region input httpsgithubcomtimoastsignacissu add check correct number column fragment file httpsgithubcomtimoastsignacissu fix gene lookup annot contain na valu httpsgithubcomtimoastsignacissu fix error closestfeatur queri contain region contig present gene annot httpsgithubcomtimoastsignacissu fix bug tssenrich use multipl fragment file httpsgithubcomtimoastsignacissu fix bug callpeak multipl fragment file use input fix bug callpeak account base start call peak fix bug gene name lookup gene name contain charact httpsgithubcomtimoastsignacissu chang updat document genom paramet addmotif runchromvar httpsgithubcomtimoastsignacissu updat foldchang function use normal count rather raw count httpsgithubcomtimoastsignacissu improv error check geneact httpsgithubcomtimoastsignacissu ad format paramet callpeak httpsgithubcomtimoastsignacissu signac bug fix fix linkpeak function run singl gene httpsgithubcomtimoastsignacissu ad fragmenttempdir paramet callpeak enabl set directori split fragment file written peak call httpsgithubcomtimoastsignacissu fix error featurematrix set sep paramet httpsgithubcomtimoastsignacdiscuss fix peak call error group name contain special charact fix issu renamecel cell inform present fragment object httpsgithubcomtimoastsignacissu chang improv error check geneact httpsgithubcomtimoastsignacissu ad foldchang method chromatinassay object set proper paramet chromatin data fix calcul fold chang run seuratfindmark singlecel chromatin data signac new function ad head method fragmentclass object bug fix fix bug chromatinassay merg httpsgithubcomtimoastsignacpul chang ad support fragment file contain header cellrangeratac v httpsgithubcomtimoastsignacissu signac new function ad bigwigtrack function plot data bigwig file ad bigwig bigwigtyp argument coverageplot includ bigwig file coverageplot ad regionhighlight paramet coverageplot ad biotyp paramet geneact gettssposit function ad maxwidth paramet geneact ad mindist paramet linkpeak httpsgithubcomtimoastsignacpul bug fix fix fragment file read one fragment found request region httpsgithubcomtimoastsignacissu fix standardchromosom paramet getgrangesfromensdb httpsgithubcomtimoastsignacissu fix groupbi paramet plotfootprint httpsgithubcomtimoastsignacissu fix bug would caus gene coordin use geneact incorrect httpsgithubcomtimoastsignacissu fix error messag findmotif httpsgithubcomtimoastsignacissu fix bug countsinregion httpsgithubcomtimoastsignacissu chang improv speed chromatinassay merg improv error messag tssenrich httpsgithubcomtimoastsignacissu improv error messag tri run chromatinassayspecif function nonchromatinassay assay perform improv chang default valu n nucleosomesign enabl paral tssenrich fasttru ad earli error check linkpeak httpsgithubcomtimoastsignacpul chang spars matrix correl linkpeak httpsgithubcomtimoastsignacpul move biovizbas biostr suggest packag remov ggbio depend reimplement annotationplot signac new function ad groupbi paramet peakplot allow color plot genom rang metadata variabl ad peaksgroupbi rangesgroupbi paramet coverageplot allow color plot genom rang coverageplot color metadata variabl bug fix updat meta featur inform overal peak access subset object avoid count becom inaccur httpsgithubcomtimoastsignacissu prevent drop featur creat merg chromatinassay httpsgithubcomtimoastsignacpul fix compil error use g version httpsgithubcomtimoastsignacissu retain motif posit subset httpsgithubcomtimoastsignacissu fix assay paramet coverageplot fix error merg chromatinassay object httpsgithubcomtimoastsignacissu add inform error messag featur cell remov paramet choic createchromatinassay httpsgithubcomtimoastsignacissu fix bug createchromatinassay set mincel minfeatur argument httpsgithubcomtimoastsignacissu improv support remot fragment file fix bug plotfootprint one cell ident class httpsgithubcomtimoastsignacissu chang ad citat inform packag ad seuratobject depend signac new function ad callpeak function call peak use mac peak call differ group cell separ set groupbi paramet ad linkpeak function link peak correl gene ad addmotif function add motif inform seurat object chromatinassay ad aggregatetil function combin adjac genom tile ad rang paramet coverageplot plot addit set genom rang ad showbulk paramet coverageplot plot access cell combin ad abil remov fragment object modifi file path exist fragment object httpsgithubcomtimoastsignacissu bug fix fix bug allelefreq httpsgithubcomtimoastsignacissu httpsgithubcomtimoastsignacissu fix bug featurematrix httpsgithubcomtimoastsignacissu httpsgithubcomtimoastsignacissu fix bug createchromatinassay set minfeatur argument httpsgithubcomtimoastsignacissu fix bug createchromatinassay set mincel argument httpsgithubcomtimoastsignacissu fix bug tssenrich cell inform set fragment file httpsgithubcomtimoastsignacissu fix bug tssenrich fragment present tss region httpsgithubcomtimoastsignacissu remov qvalu calcul findmotif httpsgithubcomtimoastsignacissu fix bug setassaydata set scaledata slot chang improv featur match matchregionstat function match distribut multipl featur eg gc content overal access chang paramet name matchregionstat signac releas includ major updat signac packag includ new function perform improv new data structur entir packag updat use new chromatinassay class storag singlecel chromatin data extens standard seurat assay add addit slot need analysi chromatin data includ genom rang genom inform fragment file inform motif gene annot genom link addit defin new fragment class store inform relat fragment file make use fragment file within signac robust check perform verifi expect cell present fragment file fragment file index modifi disk key new function store multipl fragment file store mani fragment file need singl object function use fragment file pull data file cell barcod fragment file _not_ need match cell barcod object use remot fragment file use function fragment file host remot server access http ftp transcript factor footprint new footprint plotfootprint function tf footprint analysi bioconductor method call grang findoverlap seqinfo bioconductor gener function directli chromatinassay seurat object new multimod visual method jointli visual rna express chromatin access use coverageplot function new interact visual interact brows genom use coveragebrows function mitochondri lineag trace new function identifi inform mitochondri allel find clonotyp predict cell lineag relationship use mitochondri mutat chang updat nucleosomesign greatli improv scalabl nucleosomesign fix bug present previou version score comput nucleosomesign differ comput previou version signac new countfrag function fast memoryeffici function implement c count total number fragment cell barcod present fragment file new fast option tssenrich function set true comput tss enrich score per cell without store entir cell tss posit matrix significantli reduc memori requir larg dataset allow subsequ plot tss signal differ group cell new tileplot function tile paramet coverageplot plot tn integr event genom region individu cell perform improv featurematrix coverageplot tssenrich ad manual curat hg genom blacklist region curat anshul kundaj anna shcherbina avail blacklist_hg_unifi object updat frip function use total fragment count per cell store object metadata signac new depthcor function comput correl sequenc depth reduc dimens compon perform improv runtfidf remov option use ensdb object closestfeatur coverageplot use grang instead remov ucsc paramet coverageplot fix bug featurematrix would caus fragment count multipl time nchunk greater number featur use fix bug coverageplot would prevent plot multipl region use grang fix bug coverageplot would prevent plot differ assay activ remov depend genomicfeatur move depend suggest biostr bsgenom remov suggest bsgenomehsapiensucschg ensdbhsapiensv jaspar signac first cran releas new subsetmatrix function subset matrix base number nonzero element row column remov seedus paramet runsvd signac new unifypeak function creat merg set peak multipl sampl signac bug fix runsvd previous scale appli cell rather compon mean center sd scale appli cell embed within compon ad scaleembed option runsvd control whether embed scale center ad irlbawork paramet runsvd updat allow comment charact fragment file cell name signac remov singlecoverageplot export function ad execut exampl function store raw svd output dimreduc misc slot runsvd fix strand orient gene plot coverageplot fix miss xaxi plot peak gene coverageplot signac remov depend tfbstool motifmatchr annotationdbi ggbio annotationfilt renam periodplot fragmenthistogram remov motif dimens reduct function remov motif cluster function remov neighbor reduct slot motif class ad motifnam slot motif class ad abil plot peak rang coverageplot ad abil plot gene annot grang object chang gene plot style coverageplot allow pass addit argument filterfrag add instextdata chang descript file bioconductor depend automat instal signac bug fix getcellsinregion improv document signac new tssenrich tssplot function tss enrich score new insertionbia function new option coverageplot scale track major speed improv coverageplot improv document ad exampl signac updat coverageplot plot tn integr score per base rather whole fragment signac new getintersectingfeatur function find overlap peak object new mergewithregion function perform regionawar seurat object merg signac new runchromvar function run chromvar signac new regionstat function add statist peak sequenc featur metadata improv findmotif select set background peak match sequenc characterist input signac ad intersectmatrix ad unit test bug fix chunkgrang signac first releas signac name ufdadocument issu relat httpssatijalaborgsignac titl label document assigne clear descript content httpssatijalaborgsignac signac function man page issu name ufbbug report describ bug youv seen reproduc exampl titl label bug assigne briefli describ problem output expect question pleas use analysi question templat instead post issu ensur bug reproduc rerun code produc issu new r session pleas includ minim reproduc code exampl use small test data includ signac atac_smal demonstr issu public dataset exampl dataset use signac vignett httpssatijalaborgsignacarticl reproduc issu use public dataset pleas still provid code reproduc issu data tri address pleas includ output sessioninfo oper system issu r insert reproduc exampl name uffeatur request request new featur titl label enhanc assigne clearli explain new featur would like would use titl instal output html_document r setup includefals knitropts_chunksetev fals use signac first make sure bioconductor instal r instal bioconductor requirenamespacebiocmanag quietli true installpackagesbiocmanag biocmanagerinstal automat instal bioconductor depend setrepositoriesind current releas r installpackagessignac develop version unreleas version signac instal github repositori use devtool packag r requirenamespacedevtool quietli true installpackagesdevtool devtoolsinstall_githubtimoastsignac ref develop old version older signac releas instal cran archiv use devtool r requirenamespacedevtool quietli true installpackagesdevtool replac version want instal devtoolsinstall_versionpackag signac version package_vers docker provid docker imag signac via dockerhubhttpshubdockercomrtimoastsignac pull latest imag command line sh docker pull timoastsignaclatest use base imag new dockerfil sh timoastsignaclatest conda signac also instal use conda note use conda instal packag conda rather r make sure set conda channel first httpbiocondagithubiouserinstallhtmlsetupchannel bash conda instal c bioconda rsignac instal genom assembl gene annot packag also use essenti instal speciesspecif packag contain genom gene annot inform bioconductor thishttpsuseastensemblorginfowebsitearchivesassemblyhtml tabl ensembl provid map genom assembl correspond gene annot version human hg r biocmanagerinstallcbsgenomehsapiensucschg ensdbhsapiensv human hg r biocmanagerinstallcbsgenomehsapiensucschg ensdbhsapiensv mous mm r biocmanagerinstallcbsgenomemmusculusucscmm ensdbmmusculusv titl scatacseq data integr date compil r formatsysd b output html_document r setup includefals knitropts_chunksetecho true demonstr integr multipl singlecel chromatin dataset deriv human pbmc one dataset gener use x genom multiom technolog includ dna access gene express inform cell dataset profil use x genom scatacseq includ dna access data integr two dataset togeth use share dna access assay use tool avail seurat packag furthermor demonstr transfer continu gene express categor cell label inform refer queri singlecel chromatin dataset detail summaryview data download codesummari pbmc multiom scatacseq data download x websit bash evalfals multiom wget httpscfxgenomicscomsamplescellarcpbmc_granulocyte_sorted_kpbmc_granulocyte_sorted_k_filtered_feature_bc_matrixh wget httpscfxgenomicscomsamplescellarcpbmc_granulocyte_sorted_kpbmc_granulocyte_sorted_k_atac_fragmentstsvgz wget httpscfxgenomicscomsamplescellarcpbmc_granulocyte_sorted_kpbmc_granulocyte_sorted_k_atac_fragmentstsvgztbi scatac wget httpscfxgenomicscomsamplescellatacatac_pbmc_k_nextgematac_pbmc_k_nextgem_fragmentstsvgz wget httpscfxgenomicscomsamplescellatacatac_pbmc_k_nextgematac_pbmc_k_nextgem_fragmentstsvgztbi detail preprocess well load pbmc multiom data preprocess multiom vignettearticlespbmc_multiomichtml creat new object scatacseq data r messagefals warningfals librarysignac libraryseurat libraryggplot load preprocess multiom data pbmcmulti readrdsvignette_datapbmc_multiomicrd process scatac data first count fragment per cell fragpath vignette_dataatac_pbmc_k_nextgem_fragmentstsvgz fragcount countfragmentsfrag fragpath ataccel fragcountsfragcountsfrequency_count cb creat fragment object atacfrag createfragmentobjectpath fragpath cell ataccel import first step integr analysi singlecel chromatin data ensur featur measur dataset quantifi multiom peak atac dataset ensur common featur across two dataset r messagefals warningfals cachetru quantifi multiom peak scatacseq dataset count featurematrix fragment atacfrag featur grangespbmcmulti cell ataccel creat object atacassay createchromatinassay count count minfeatur fragment atacfrag pbmcatac createseuratobjectcount atacassay assay peak pbmcatac subsetpbmcatac ncount_peak ncount_peak comput lsi pbmcatac findtopfeaturespbmcatac mincutoff pbmcatac runtfidfpbmcatac pbmcatac runsvdpbmcatac next merg multiom scatac dataset togeth observ differ appear due batch experi technologyspecif variat r messagefals warningfals first add datasetidentifi metadata pbmcatacdataset atac pbmcmultidataset multiom merg pbmccombin mergepbmcatac pbmcmulti process combin dataset pbmccombin findtopfeaturespbmccombin mincutoff pbmccombin runtfidfpbmccombin pbmccombin runsvdpbmccombin pbmccombin runumappbmccombin reduct lsi dim p dimplotpbmccombin groupbi dataset integr find integr anchor two dataset need project share lowdimension space well use reciproc lsi project project dataset other lsi space set reductionrlsi inform data integr method seurat see recent paperhttpsdoiorgjcel seurat websitehttpssatijalaborgseurat rather integr normal data matrix typic done scrnaseq data well integr lowdimension cell embed lsi coordin across dataset use integrateembed function much better suit scatacseq data typic spars matrix larg number featur note requir first comput uncorrect lsi embed use merg dataset r messagefals warningfals find integr anchor integrationanchor findintegrationanchor objectlist listpbmcmulti pbmcatac anchorfeatur rownamespbmcmulti reduct rlsi dim integr lsi embed integr integrateembed anchorset integrationanchor reduct pbmccombinedlsi newreductionnam integrated_lsi dimstointegr creat new umap use integr embed integr runumapintegr reduct integrated_lsi dim p dimplotintegr groupbi dataset final compar result merg integr dataset find integr success remov technologyspecif variat dataset retain celltypespecif biolog variat r messagefals warningfals figwidth p ggtitlemerg p ggtitleintegr weve demonstr integr method use two dataset workflow appli integr number dataset refer map case larg highqual dataset dataset contain uniqu inform present dataset cell type annot addit data modal exampl often want use dataset refer map queri onto interpret queri dataset context exist refer demonstr use singlecel chromatin refer queri dataset well treat pbmc multiom dataset refer map scatacseq dataset use findtransferanchor mapqueri function seurat r messagefals warningfals comput umap store umap model pbmcmulti runumappbmcmulti reduct lsi dim returnmodel true find transfer anchor transferanchor findtransferanchor refer pbmcmulti queri pbmcatac referencereduct lsi reduct lsiproject dim map queri onto refer dataset pbmcatac mapqueri anchorset transferanchor refer pbmcmulti queri pbmcatac refdata pbmcmultipredictedid referencereduct lsi newreductionnam reflsi reductionmodel umap detail summarywhat mapqueri doingsummari mapqueri wrapper function run transferdata integrateembed projectumap queri dataset set sensibl default paramet base anchor object gener finer control paramet use function pass paramet mapqueri function use transferdataarg integrateembeddingsarg projectumaparg argument mapqueri run function exampl r evalfals pbmcatac transferdata anchorset transferanchor refer pbmcmulti weightreduct lsiproject queri pbmcatac refdata list celltyp predictedid predicted_rna rna pbmcatac integrateembed anchorset transferanchor refer pbmcmulti queri pbmcatac reduct lsiproject newreductionnam reflsi pbmcatac projectumap queri pbmcatac queryreduct reflsi refer pbmcmulti referencereduct lsi reductionmodel umap detail run mapqueri map scatacseq dataset onto multimod refer enabl cell type label transfer refer queri visual refer map result cell type label associ scatacseq dataset r messagefals warningfals figwidth figheight p dimplotpbmcmulti reduct umap groupbi predictedid label true repel true nolegend ggtitlerefer p dimplotpbmcatac reduct refumap groupbi predictedid label true repel true nolegend ggtitlequeri p p inform multimod refer map see seurat vignettehttpssatijalaborgseuratarticlesmultimodal_reference_mappinghtml rna imput transfer categor inform cell label map queri data onto exist refer umap also transfer continu data refer queri way demonstr transfer gene express valu pbmc multiom dataset measur dna access gene express cell pbmc scatacseq dataset measur dna access note could also transfer valu use mapqueri function call set refdata paramet list valu r messagefals warningfals predict gene express valu rna transferdata anchorset transferanchor refdata getassaydatapbmcmulti assay rna slot data weightreduct pbmcataclsi dim add predict valu new assay pbmcatacpredict rna look immun marker gene see predict express pattern match expect base known express pattern r messagefals warningfals figwidth figheight defaultassaypbmcatac predict featureplot object pbmcatac featur cmsa cdd lef nkg trem lyz ptsize maxcutoff q reduct refumap ncol r includefals saverdsobject pbmcatac file vignette_datapbmc_atac_integrationrd detail summarysess infosummari r sessioninfo detail titl data structur object interact date compil r formatsysd b output html_document signac packag extens seurathttpssatijalaborgseurat design analysi genom singlecel assay includ assay gener signal map genom coordin scatacseq sccuttag scactseq method analysi singlecel chromatin dataset present uniqu challeng comparison analysi scrnaseq data creat extend assay class store addit inform need includ genom rang associ featur eg peak genom bin gene annot genom inform tf motif genomewid signal diskbas format fragment file tf footprint data tn insert bia data link genom region major advantag signac design interoper exist function seurat packag packag abl use seurat object enabl straightforward analysi multimod singlecel data addit differ assay seurat object outlin design class defin signac packag demonstr method run class chromatinassay class chromatinassay class extend standard seurat assay class add sever addit slot data use analysi singlecel chromatin dataset class includ slot present standard seurat assayhttpsgithubcomsatijalabseuratwikiassay follow addit slot rang grangeshttpswwwrdocumentationorgpackagesgenomicrangesversionstopicsgrangesclass object contain genom coordin featur data matrix motif motif object fragment list fragment object seqinfo seqinfohttpswwwrdocumentationorgpackagesgenomeinfodbversionstopicsseqinfoclass object contain inform genom data map annot grangeshttpswwwrdocumentationorgpackagesgenomicrangesversionstopicsgrangesclass object contain gene annot bia vector contain tn integr bia inform frequenc tn integr differ hexam positionenrich name list matric contain posit enrich score tn integr exampl enrich tss differ tf motif link grangeshttpswwwrdocumentationorgpackagesgenomicrangesversionstopicsgrangesclass object describ link genom posit coaccess site enhancergen regulatori relationship r messagefals warningfals libraryseurat librarysignac construct chromatinassay chromatinassay object construct use createchromatinassay function r get data use follow exampl count getassaydataatac_smal slot count r creat standalon chromatinassay object chromatinassay createchromatinassaycount count genom hg genom paramet use set seqinfo slot pass name genom present ucsc eg hg mm pass seqinfoclass object creat seurat object contain chromatinassay rather standard assay initi object use chromatinassay rather count matrix note featur ad seurat r creat seurat object contain chromatinassay object createseuratobjectcount chromatinassay ad chromatinassay seurat object add new chromatinassay object exist seurat object use standard assign oper use ad standard assay object data type seurat object r creat chromatin assay add exist seurat object objectpeak createchromatinassaycount count genom hg get set chromatinassay data getset data chromatinassay much way standard assay object use getassaydata setassaydata function defin seurat exampl r get access data slot found standard assay chromatinassay data getassaydataatac_smal slot data access bia slot uniqu chromatinassay bia getassaydataatac_smal slot bia set set data slot atac_smal setassaydataatac_smal slot data newdata data set bia slot bia rep creat dummi bia vector atac_smal setassaydataatac_smal slot bia newdata bia also varieti conveni function defin gettingset data specif slot includ fragment motif link annot function exampl get set gene annot data use annot getter annot setter function r messagefals warningfals first get gene annot hg libraryensdbhsapiensv convert ensdb grang generang getgrangesfromensdbensdb ensdbhsapiensv convert ucsc style seqlevelsstylegenerang ucsc set gene annot annotationatac_smal generang get gene annot inform annotationatac_smal fragment motif link function demonstr section chromatinassay method chromatinassay object use bioconductor object like grangeshttpswwwrdocumentationorgpackagesgenomicrangesversionstopicsgrangesclass seqinfohttpswwwrdocumentationorgpackagesgenomeinfodbversionstopicsseqinfoclass also call standard bioconductor function defin irang genomicrang genomeinfodb packag chromatinassay object seurat object chromatinassay default assay follow method use genom rang store chromatinassay object r messagefals warningfals extract genom rang associ featur data matrix grangesatac_smal find nearest rang nearestatac_smal subject annotationatac_smal distanc nearest rang distancetonearestatac_smal subject annotationatac_smal find overlap anoth set genom rang findoverlapsatac_smal subject annotationatac_smal mani method defin see document nearestmethod findoverlapsmethod interrangemethod coverag signac full list follow method use seqinfo data store chromatinassay object r get full seqinfo inform seqinfoatac_smal get genom inform genomeatac_smal find length chromosom seqlengthsatac_smal find name chromosom seqnamesatac_smal assign new genom genomeatac_smal hg sever method avail list see document seqinfomethod signac full list full list method chromatinassay class run r methodsclass chromatinassay subset chromatinassay use standard subset function oper subset seurat object contain chromatinassay work way standard assay object r subset use subset function meant interact use subsetobj subsetatac_smal subset ncount_peak subset use extract oper use programmat subsetobj atac_smal atac_smallncount_peak convert assay chromatinassay convert chromatinassay standard assay use function r convert chromatinassay assay assay asobject atac_smallpeak class assay assay convert standard assay chromatinassay use aschromatinassay function take standard assay object well inform fill addit slot chromatinassay class r convert assay chromatinassay chromatinassay aschromatinassayassay seqinfo hg chromatinassay fragment class fragment class design store interact fragment filehttpssupportxgenomicscomsinglecellatacsoftwarepipelineslatestoutputfrag commonli use singlecel chromatin data contain path index fragment file disk md hash fragment file fragment file index vector cell name contain fragment file importantli name vector element vector cell name appear fragment file name element cell name appear chromatinassay object store fragment object allow map cell name disk cell name r avoid need alter fragment file disk path also remot file access http ftp construct fragment class fragment object construct use createfragmentobject function r fragpath systemfileextdata fragmentstsvgz packagesignac fragment createfragmentobject path fragpath cell colnamesatac_smal validatefrag true validatefrag paramet control whether file inspect check whether expect cell name present help avoid assign wrong fragment file object your sure file correct set valu fals skip step save time check typic run fragment object creat normal run exist fragment file inspect fragment file extract first line fragment file ondisk use head method defin fragment object use quickli check chromosom name style fragment file check cell barcod name r headfrag ad fragment object chromatinassay chromatinassay object contain list fragment object avoid need merg fragment file disk simplifi process merg integr differ seurat object contain chromatinassay add new fragment object chromatinassay seurat object contain chromatinassay use fragment assign function thing recomput md hash fragment file index verifi match hash comput fragment object creat check none cell contain fragment object ad alreadi contain anoth fragment object store chromatinassay fragment cell must present one fragment file append fragment object list fragment object store chromatinassay r fragmentsatac_smal fragment show method fragmentclass object print number cell fragment object contain data r fragment altern initi chromatinassay fragment object coupl way either pass vector fragment object fragment paramet createchromatinassay pass path singl fragment file pass path fragment file assum file contain fragment cell chromatinassay cell name fragment file disk chromatinassay exampl r chrom_assay createchromatinassay count count genom hg fragment fragpath object createseuratobject count chrom_assay assay peak creat seurat object contain chromatinassay singl fragment object remov fragment object chromatinassay fragment object associ chromatinassay remov assign null use fragment assign function exampl r fragmentschrom_assay null fragmentschrom_assay remov subset fragment object list fragment object store chromatinassay need extract list fragment object use fragment function subset list object assign subset list assay use seuratsetassaydata function exampl r chrom_assay setassaydatachrom_assay slot fragment newdata fragment fragmentschrom_assay chang fragment file path exist fragment object path fragment file updat use updatepath function use move fragment file new directori copi store seurat object contain chromatinassay differ server r messagefals fragment updatepathfrag newpath fragpath chang path fragment file object need remov fragment object updat path add fragment object back object exampl r frag fragmentsobject get list fragment object fragmentsobject null remov fragment inform assay creat vector new path correct order list fragment object case newpath listfragpath seq_alongfrag fragsi updatepathfragsi newpath newpathsi updat path fragmentsobject frag assign updat list back object fragmentsobject use remot fragment file fragment file host remot server access via http ftp also ad chromatinassay way locallyhost fragment file enabl explor larg singlecel dataset without need download larg file exampl creat fragment object use file host x genom websit r fragment createfragmentobject path httpcfxgenomicscomsamplescellatacatac_v_pbmc_katac_v_pbmc_k_fragmentstsvgz fragment file host remot check describ section md hash expect cell perform get set fragment data access cell name store fragment object use cell function importantli return cell name appear chromatinassay rather appear fragment file r fragment createfragmentobject path fragpath cell colnamesatac_smal validatefrag true cell cellsfrag headcel similarli set cell name inform fragment object use cell assign function set name vector cell store fragment object must suppli name vector r namescel cell cellsfrag cell extract data store fragment object also use getfragmentdata function exampl find path fragment file disk r getfragmentdataobject fragment slot path full list method fragment class run r methodsclass fragment motif class motif class store inform need dna sequenc motif analysi follow slot data spars featur motif matrix entri featur contain motif otherwis pwm name list posit weight posit frequenc matric motifnam list motif id common name posit grangeslist object contain exact posit motif metadata addit inform motif mani slot option need fill requir run certain function exampl posit slot need run tf footprint construct motif class motif object construct use createmotifobject function much data need construct motif object gener use function tfbstoolshttpswwwbioconductororgpackagesreleasebiochtmltfbstoolshtml motifmatchrhttpswwwbioconductororgpackagesreleasebiochtmlmotifmatchrhtml packag posit frequenc matric motif load use jasparhttpjaspargeneregnet packag bioconductorhttpsbioconductororgpackagesreleasedataannotationhtmljasparhtml chromvarmotifshttpsgithubcomgreenleaflabchromvarmotif packag exampl r messagefals warningfals libraryjaspar librarytfbstool librarymotifmatchr get list motif posit frequenc matric jaspar databas pfm getmatrixset x jaspar opt listspeci speci code human scan dna sequenc peak presenc motif motifmatrix createmotifmatrix featur grangesatac_smal pwm pfm genom hg creat new mofif object store result motif createmotifobject data motifmatrix pwm pfm show method motif class print total number motif region includ object r motif ad motif object chromatinassay add motif object chromatinassay seurat object contain chromatinassay use motif assign oper r motifsatac_smal motif get set motif data data store motif object access use getmotifdata setmotifdata function r extract data motif object pfm getmotifdataobject motif slot pwm set data motif object motif setmotifdataobject motif slot pwm newdata pfm access set motif set featur use motif object use colnam rownam function r look motif includ motif object headcolnamesmotif r look featur includ motif object headrownamesmotif quickli convert motif id like motif common name like mefc use convertmotifid function exampl r convert id common name id cmamamamamama name convertmotifidobject motif id id name r convert name id convertmotifidobject motif name name full list method motif class run r warningfals messagefals methodsclass motif detail summarysess infosummari r sessioninfo detail titl parallel distribut process output html_document date compil r formatsysd b parallel comput support signac futurehttpscranrprojectorgpackagefutur packag make easi specifi differ parallel option demonstr parallel featurematrix function show benchmark result get sens amount speedup might expect seurathttpssatijalaborgseurat packag also use futur parallel see seurat vignettehttpssatijalaborgseuratvfuture_vignettehtml inform enabl parallel signac parallel enabl simpli import futur packag set plan r libraryfutur plan default plan set sequenti process parallel chang multicor multiprocessor multisess get asynchron process set number worker chang number core use r warningfals messagefals planmulticor worker plan might also need increas maximum memori usag r optionsfutureglobalsmaxs gb ram note futur version httpscranrprojectorgwebpackagesfuturenew fork process disabl run rstudio enabl parallel comput rstudio need select multisess option benchmark demonstr runtim featurematrix run peak human pbmc differ parallel option detail summaryview benchmark codesummari follow code run ubuntu lt intel xeon platinum l cpu ghz bash eval fals download data wget httpscfxgenomicscomsamplescellatacatac_pbmc_k_nextgematac_pbmc_k_nextgem_fragmentstsvgz wget httpscfxgenomicscomsamplescellatacatac_pbmc_k_nextgematac_pbmc_k_nextgem_fragmentstsvgztbi wget httpscfxgenomicscomsamplescellatacatac_pbmc_k_nextgematac_pbmc_k_nextgem_peaksb r evalfals librarysignac load data fragment vignette_dataatac_pbmc_k_nextgem_fragmentstsvgz peaksk readtabl file vignette_dataatac_pbmc_k_nextgem_peaksb colnam cchr start end peak genomicrangesmakegrangesfromdataframepeaksk cell readlinesvignette_datapbmckcellstxt fragment createfragmentobjectpath fragment cell cell validatefrag fals set number replic nrep result datafram process_n run sequenti timingsequenti c seq_lennrep start systim fmat featurematrixfrag fragment featur peak cell cell process_n process_n timingsequenti ctimingsequenti asnumericsystim start unit sec re datafram set repsequenti nrep core rep nrep replic seq_lennrep time timingsequenti result rbindresult re core libraryfutur planmulticor worker optionsfutureglobalsmaxs timingcor c seq_lennrep start systim fmat featurematrixfrag fragment featur peak cell cell process_n process_n timingcor ctimingcor asnumericsystim start unit sec re datafram set repparallel nrep core rep nrep replic seq_lennrep time timingcor result rbindresult re core planmulticor worker timingcor c seq_lennrep start systim fmat featurematrixfrag fragment featur peak cell cell process_n process_n timingcor ctimingcor asnumericsystim start unit sec re datafram set repparallel nrep core rep nrep replic seq_lennrep time timingcor result rbindresult re save result writet x result file pastevignette_datapbmcktimings_ sysdat tsv quot fals rownam fals detail r messagefals warningfals echofals libraryggplot result readtablevignette_datapbmcktimings_tsv header true resultscor factorresultscor level c p ggplotresult aesx core time color core geom_jitterwidth ylimc ylabtim min xlabnumb core theme_bw themelegendposit none ggtitlefeaturematrix runtim p detail summarysess infosummari r sessioninfo detail titl archiv output html_document instal past version signac see instal instructionsinstallhtmloldvers past version signac document found indexhtml indexhtml titl call peak date compil r formatsysd b output html_document r setup includefals knitropts_chunksetecho true tutori demonstr call peak singlecel atacseq dataset use macshttpsgithubcommacsprojectmac use peak call function signac first need instal mac done use piphttpspypiorgprojectmac condahttpsanacondaorgbiocondamac build packag sourcehttpsgithubcommacsprojectmac demonstr use scatacseq data human pbmc see vignettepbmc_vignettermd code use gener object link raw data first load requir packag precomput seurat object r messagefals warningfals librarysignac libraryseurat pbmc readrdsvignette_datapbmcrd dimplotpbmc peak call perform use callpeak function either done separ differ group cell perform use data cell call peak annot cell type use groupbi argument r messagefals warningfals cachetru peak callpeak object pbmc groupbi predictedid macspath homestuarttminicondaenvssignacbinmac result return grang object addit metadata column list cell type peak identifi r echofals knitrkableheadasdataframepeak quantifi count peak use featurematrix function visual celltypespecif mac peak call alongsid x cellrang peak call current use pbmc object coverageplot function cellrang peak shown grey mac peak red r figheight figwidth coverageplot object pbmc region cda rang peak rangestitl mac detail summarysess infosummari r sessioninfo detail titl find coaccess network cicero date compil r formatsysd b output html_document vignett demonstr find ciscoaccess network cicero use singlecel atacseq data pleas see cicero websitehttpscoletrapnelllabgithubiociceroreleasedocs_m inform cicero facilit convers seurat use signac celldataset use cicero format use convers function seuratwrappershttpsgithubcomsatijalabseuratwrapp packag avail github data load use singlecel atacseq dataset contain human cd hematopoiet stem progenitor cell publish satpathi granja et al natur biotechnolog process dataset avail ncbi geo httpswwwncbinlmnihgovgeoqueryacccgiaccgs dataset use trajectorymonoclehtml vignett well start load dataset creat vignett see trajectorymonoclehtml vignett code use creat object raw data first load dataset perform standard preprocess use signac r includefals requirenamespaceremot quietli true installpackagesremot requirenamespaceseuratwrapp quietli true remotesinstall_githubsatijalabseuratwrapp requirenamespaceleidenbas quietli true remotesinstall_githubcoletrapnelllableidenbas requirenamespacemonocl quietli true remotesinstall_githubcoletrapnelllabmonocl requirenamespacecicero quietli true remotesinstall_githubcoletrapnelllabciceroreleas ref monocl r messagefals warningfals librarysignac libraryseurat libraryseuratwrapp libraryggplot librarypatchwork r load object creat monocl vignett bone readrdsvignette_datacdrd creat cicero object find ciscoaccess network ccan use cicerohttpscoletrapnelllabgithubiociceroreleasedocs_m cicero develop develop separ branch packag work monocl celldataset object first make sure branch instal convert seurat object whole bone marrow dataset celldataset format r evalfals instal cicero requirenamespaceremot quietli true installpackagesremot remotesinstall_githubcoletrapnelllabciceroreleas ref monocl r messagefals warningfals librarycicero r messagefals warningfals convert celldataset format make cicero object bonecd ascell_data_setx bone bonecicero make_cicero_cdsbonecd reduced_coordin reduceddimsbonecdsumap find cicero connect well demonstr run cicero use one chromosom save time workflow appli find ccan whole genom demonstr basic workflow run cicero workflow broken sever step paramet chang default finetun cicero algorithm depend data highli recommend explor cicero websitehttpscoletrapnelllabgithubiociceroreleasedocs_m paperhttpsdoiorgjmolcel document inform r cachetru get chromosom size seurat object genom seqlengthsbon use chromosom save time omit step run whole genom genom genom convert chromosom size datafram genomedf dataframechr namesgenom length genom run cicero conn run_cicerobonecicero genomic_coord genomedf sample_num r headconn find ciscoaccess network ccan weve found pairwis coaccess score peak group pairwis connect larger coaccess network use generate_ccan function cicero r ccan generate_ccansconn r headccan add link seurat object add coaccess link found cicero chromatinassay object seurat use connectionstolink function signac convert output cicero format need store link slot chromatinassay add object use link assign function r link connectionstolinksconn conn ccan ccan linksbon link visual link along dna access inform run coverageplot region r figheight figwidth messagefals warningfals coverageplotbon region chr r includefals saverdsobject bone file vignette_datacdrd acknowledg thank develop cicero especi cole trapnel hannah pliner member trapnel labhttpscoletrapnelllabgithubio use cicero pleas cite cicero paperhttpsdoiorgjmolcel detail summarysess infosummari r sessioninfo detail titl build trajectori monocl date compil r formatsysd b output html_document vignett demonstr construct cell trajectori monocl use singlecel atacseq data pleas see monocl websitehttpscoletrapnelllabgithubiomonocl inform instal monocl facilit convers seurat use signac celldataset use monocl format use convers function seuratwrappershttpsgithubcomsatijalabseuratwrapp packag avail github data load use singlecel atacseq dataset contain human cd hematopoiet stem progenitor cell publish satpathi granja et al natur biotechnologyhttpsdoiorgsz process dataset avail ncbi geo httpswwwncbinlmnihgovgeoqueryacccgiaccgs note fragment file present insid gse_rawtar archiv index fragment file suppli index file use tabixhttpswwwhtsliborgdoctabixhtml exampl tabix p bed fragment_fil first load dataset perform standard preprocess use signac r includefals requirenamespaceremot quietli true installpackagesremot requirenamespaceseuratwrapp quietli true remotesinstall_githubsatijalabseuratwrapp requirenamespaceleidenbas quietli true remotesinstall_githubcoletrapnelllableidenbas requirenamespacemonocl quietli true remotesinstall_githubcoletrapnelllabmonocl requirenamespaceensdbhsapiensv quietli true biocmanagerinstallensdbhsapiensv r messagefals warningfals librarysignac libraryseurat libraryseuratwrapp librarymonocl librarymatrix libraryggplot librarypatchwork setse r filepath vignette_datagsegse_scatachematopoiesiscd peak readtablepastefilepath peakstxtgz header true cell readtablepastefilepath cell_barcodestxtgz header true stringsasfactor fals rownamescel makeuniquecellsbarcod mtx readmmfil pastefilepath mtx mtx asobject mtx class dgcmatrix colnamesmtx rownamescel rownamesmtx peaksfeatur r messagefals warningfals bone_assay createchromatinassay count mtx mincel fragment vignette_datagsegsm_cd_progenitors_rep_fragmentstsvgz sep c_ _ genom hg bone createseuratobject count bone_assay metadata cell assay atac dataset contain multipl cell type subset includ one replic cd progenitor cell bone bone bonegroup_barcod cd_progenitors_rep add cell type annot origin paper cluster_nam chsc mep cmpbmp lmpp clp prob preb gmp mdp pdc cdc monocyt monocyt naiveb memoryb plasmacel basophil immaturenk maturenk maturenk naivecdt naivecdt naivetreg memorycdt treg naivecdt naivecdt naivecdt centralmemorycdt effectormemorycdt gamma delta numlabel lengthcluster_nam namescluster_nam past repclust numlabel seqnumlabel bonecelltyp cluster_namesascharacterboneclust boneatac next add gene annot hg genom object use comput qualiti control metric tss enrich score plot r messagefals warningfals libraryensdbhsapiensv extract gene annot ensdb annot getgrangesfromensdbensdb ensdbhsapiensv chang ucsc style sinc data map hg seqlevelsstyleannot ucsc add gene inform object annotationbon annot qualiti control well comput tss enrich nucleosom signal score percentag count genom blacklist region cell use metric help remov low qualiti cell dataset r messagefals warningfals bone tssenrichmentbon bone nucleosomesignalbon boneblacklist_fract fractioncountsinregionbon region blacklist_hg r figheight figwidth messagefals warningfals vlnplot object bone featur cncount_atac tssenrich nucleosome_sign blacklist_fract ptsize ncol r bone bone bonencount_atac bonetssenrich bonenucleosome_sign dataset preprocess next run standard scatacseq analysi pipelin use signac perform dimens reduct cluster cell type annot r messagefals warningfals bone findtopfeaturesbon mincel bone runtfidfbon bone runsvdbon n depthcorbon r messagefals warningfals bone runumap bone reduct lsi dim reductionnam umap r messagefals warningfals bone findneighborsbon dim reduct lsi bone findclustersbon resolut algorithm r dimplotbon label true nolegend assign cluster common cell type base origin annot paper r fori levelsbon cells_to_reid whichcellsbon ident newid namessorttablebonecelltypecells_to_reiddecreasingtru identsbon cell cells_to_reid newid boneassigned_celltyp identsbon r dimplotbon label true next subset differ lineag creat trajectori lineag anoth way build trajectori use whole dataset build separ pseudotim trajectori differ cell partit found monocl r defaultassaybon atac erythroid bone boneassigned_celltyp chsc mep cmpbmp lymphoid bone boneassigned_celltyp chsc lmpp gmp clp prob pdc mdp gmp build trajectori monocl convert seurat object celldataset object use ascell_data_set function seuratwrappershttpsgithubcomsatijalabseuratwrapp build trajectori use monocl well separ erythroid lymphoid lineag could explor strategi build trajectori lineag togeth r messagefals warningfals resultshid erythroidcd ascell_data_seterythroid erythroidcd cluster_cellscd erythroidcd reduction_method umap erythroidcd learn_grapherythroidcd use_partit true lymphoidcd ascell_data_setlymphoid lymphoidcd cluster_cellscd lymphoidcd reduction_method umap lymphoidcd learn_graphlymphoidcd use_partit true comput pseudotim estim trajectori need decid start trajectori case know hematopoiet stem cell progenitor cell type trajectori set cell root trajectori monocl includ interact function select cell root node graph function launch call order_cel without specifi root_cel paramet weve preselect cell root save file reproduc file download herehttpswwwdropboxcomswjbokcjuiqhsc_cellstxt r load preselect hsc hsc readlinesvignette_datahsc_cellstxt r messagefals warningfals order cell erythroidcd order_cellserythroidcd reduction_method umap root_cel hsc lymphoidcd order_cellslymphoidcd reduction_method umap root_cel hsc plot trajectori color pseudotim plot_cel cd erythroidcd color_cells_bi pseudotim show_trajectory_graph true plot_cel cd lymphoidcd color_cells_bi pseudotim show_trajectory_graph true extract pseudotim valu add seurat object r bone addmetadata object bone metadata erythroidcdsprincipal_graph_auxlistdataumappseudotim colnam erythroid bone addmetadata object bone metadata lymphoidcdsprincipal_graph_auxlistdataumappseudotim colnam lymphoid r figheight figwidth messagefals warningfals featureplotbon cerythroid lymphoid ptsize scale_color_viridis_c r includefals saverdsobject bone file vignette_datacdrd acknowledg thank develop monocl especi cole trapnel hannah pliner member trapnel labhttpscoletrapnelllabgithubio use monocl pleas cite monocl papershttpscoletrapnelllabgithubiomonocledocscit detail summarysess infosummari r sessioninfo detail titl frequent ask question output html_document r setup includefals knitropts_chunksetecho true signac signac extens seurat analysi singlecel chromatin data dnabas singlecel assay extend seurat object includ inform genom sequenc genom coordin sequenc fragment per cell includ function need analysi singlecel chromatin data interact object signac use seurat object structur seurat command use analys data signac see data structur object interact vignettedata_structureshtml explan class defin signac use see seurat document inform seurat object httpssatijalaborgseurat merg object signac see mergemerginghtml integrationintegrationhtml vignett inform combin multipl singlecel chromatin dataset creat fragment file dataset fragment file provid output popular singlecel data data process tool chromaphttpsgithubcomhaowenzchromap cellrangeratachttpssupportxgenomicscomsinglecellatacsoftwarepipelineslatestwhatiscellrangeratac cellrangerarchttpssupportxgenomicscomsinglecellmultiomeatacgexsoftwarepipelineslatestwhatiscellrangerarc use anoth method provid fragment file output use sintohttpsgithubcomtimoastsinto packag gener fragment file bam file see inform use sinto gener fragment file httpstimoastgithubiosintobasic_usagehtmlcreatescatacseqfragmentsfil decid number dimens use choos dimension gener problem singlecel analysi simpl solut discuss scrnaseq read recommend scrnaseq seurat vignett httpssatijalaborgseuratvpbmck_tutorialhtml see determin dimension dataset gener tipssuggest might help guid choic number dimens number dimens need gener scale size complex dataset tri vari number dimens use observ result cluster umap chang usual better choos valu higher rather low good understand biolog help lot know whether cluster make sens dimension might highlow annot genom sequenc organ avail bioconductor studi organ bsgenom genom packag ensdb annot packag avail bioconductor still use gtf file fasta file signac creat bsgenom data packag see vignettehttpswwwbioconductororgpackagesdevelbiocvignettesbsgenomeinstdocbsgenomeforgepdf use gtf file import use rtracklay exampl r evalfals gtf rtracklayerimportgenesgtf genecoord gtfgtftype gene seqlevelsstylegenecoord ucsc genecoord keepstandardchromosomesgenecoord pruningmod coars cite signac use signac pleas cite stuart et al httpsdoiorg r evalfals articlesignac titl singlecel chromatin state analysi signac author stuart tim srivastava avi madad shaista lareau caleb satija rahul journal nat method publish natur publish group page month nov year url httpswwwnaturecomarticless languag en signac extens seurathttpssatijalaborgseurat use seurat object structur consid cite seurat paperhttpsdoiorgjcel use signac titl vignett overview output html_document guid analys follow guid analys demonstr standard endtoend analysi pipelin differ type singlecel chromatin data human peripher blood mononuclear cellspbmc_vignettehtml tutori analyz human peripher blood mononuclear cell pbmc dataset cell r echofals outheight knitrinclude_graphicsassetspbmcpng mous cortic brain cellsmouse_brain_vignettehtml tutori analyz dataset cortic neuron adult mous brain r echofals outheight knitrinclude_graphicsassetsmousepng joint scrnaseq scatacseq analysi x multiomicpbmc_multiomichtml tutori demonstr joint analysi combin gene express dna access data measur human pbmc use x genom multiom kit r echofals outheight knitrinclude_graphicsassetsmultiomicpng joint scrnaseq scatacseq analysi snareseqsnareseqhtml tutori demonstr strategi analyz snareseq dataset pair measur gene express dna access mous brain nuclei r echofals outheight knitrinclude_graphicsassetssnareseqpng joint singlecel mitochondri dna genotyp dna access analysismitohtml tutori identifi clonotyp use mitochondri dna mutat identifi scatacseq data jointli analyz clonal cellular relationship dna access pattern human colorect cancer sampl r echofals outwidth knitrinclude_graphicsassetsmitopng howto follow short vignett demonstr perform special analysi task peak callingpeak_callinghtml vignett demonstr perform celltypespecif peak call scatacseq data r echofals outheight knitrinclude_graphicsassetspeakspng merg datasetsmerginghtml vignett outlin strategi merg differ singlecel chromatin dataset togeth r echofals outwidth knitrinclude_graphicsassetsmergepng integr label transferintegrate_atachtml demonstr integr multipl singlecel chromatin dataset well label transfer refer dataset unlabel queri dataset r echofals outheight knitrinclude_graphicsassetsintegrationpng dna sequenc motif enrich analysismotif_vignettehtml vignett demonstr perform dna sequenc motif enrich analysi use signac r echofals outheight knitrinclude_graphicsassetsmotifspng transcript factor footprint analysisfootprinthtml vignett demonstr perform motif footprint analysi use human hematopoiet stem cell dataset exampl r echofals outheight knitrinclude_graphicsassetsfootprintpng build trajectori monocl monoclehtml demonstr build trajectori use scatacseq data monocl packag convers function present seuratwrapp r echofals outheight knitrinclude_graphicsassetsmonoclepng find coaccess site cicerocicerohtml demonstr find coaccess peak scatacseq data use cicero packag convers function present seuratwrapp r echofals outheight knitrinclude_graphicsassetsciceropng data visualizationvisualizationhtml demonstr creat genom browserstyl plot use singlecel chromatin data r echofals outheight knitrinclude_graphicsassetsvizpng object interact follow vignett demonstr interact seurat object object class defin signac packag data structur object interactiondata_structureshtml vignett detail class defin signac method oper class provid exampl interact object perform common analysi task parallel distribut computingfuturehtml vignett demonstr enabl parallel comput signac seurat give exampl amount speedup might expect enabl parallel titl analyz pbmc scatacseq output html_document date compil r formatsysd b r init includefals knitropts_chunksetecho true tutori analyz singlecel atacseq dataset human peripher blood mononuclear cell pbmc provid x genom follow file use vignett avail x genom websit raw datahttpscfxgenomicscomsamplescellatacatac_v_pbmc_katac_v_pbmc_k_filtered_peak_bc_matrixh metadatahttpscfxgenomicscomsamplescellatacatac_v_pbmc_katac_v_pbmc_k_singlecellcsv fragment filehttpscfxgenomicscomsamplescellatacatac_v_pbmc_katac_v_pbmc_k_fragmentstsvgz fragment file indexhttpscfxgenomicscomsamplescellatacatac_v_pbmc_katac_v_pbmc_k_fragmentstsvgztbi detail summaryview data download codesummari download requir file run follow line shell sh evalfals wget httpscfxgenomicscomsamplescellatacatac_v_pbmc_katac_v_pbmc_k_filtered_peak_bc_matrixh wget httpscfxgenomicscomsamplescellatacatac_v_pbmc_katac_v_pbmc_k_singlecellcsv wget httpscfxgenomicscomsamplescellatacatac_v_pbmc_katac_v_pbmc_k_fragmentstsvgz wget httpscfxgenomicscomsamplescellatacatac_v_pbmc_katac_v_pbmc_k_fragmentstsvgztbi detail first load signac seurat packag use analyz human data r setup messagefals librarysignac libraryseurat librarygenomeinfodb libraryensdbhsapiensv libraryggplot librarypatchwork setse preprocess workflow preprocess chromatin data signac use inform two relat input file creat use cellrang peakcel matrix analog gene express count matrix use analyz singlecel rnaseq howev instead gene row matrix repres region genom peak predict repres region open chromatin valu matrix repres number tn integr site singl barcod ie cell map within peak find detail x websitehttpssupportxgenomicscomsinglecellatacsoftwarepipelineslatestoutputmatric fragment file repres full list uniqu fragment across singl cell substanti larger file slower work store ondisk instead memori howev advantag retain file contain fragment associ singl cell oppos fragment map peak inform fragment file found x genom websitehttpssupportxgenomicscomsinglecellatacsoftwarepipelineslatestoutputfrag sinto websitehttpstimoastgithubiosintobasic_usagehtmlcreatescatacseqfragmentsfil start creat seurat object use peakcel matrix cell metadata gener cellrangeratac store path fragment file disk seurat object r warningfals messagefals count readx_hfilenam vignette_dataatac_v_pbmc_k_filtered_peak_bc_matrixh metadata readcsv file vignette_dataatac_v_pbmc_k_singlecellcsv header true rownam chrom_assay createchromatinassay count count sep c genom hg fragment vignette_dataatac_v_pbmc_k_fragmentstsvgz mincel minfeatur pbmc createseuratobject count chrom_assay assay peak metadata metadata r pbmc atacseq data store use custom assay chromatinassay enabl special function analys genom singlecel assay scatacseq print assay see addit inform contain chromatinassay includ motif inform gene annot genom inform r pbmcpeak exampl call grang seurat object chromatinassay set activ assay chromatinassay see genom rang associ featur object see object interact vignettedata_structureshtml inform chromatinassay class r grangespbmc also add gene annot pbmc object human genom allow downstream function pull gene annot inform directli object r annot messagefals warningfals cachefals extract gene annot ensdb annot getgrangesfromensdbensdb ensdbhsapiensv chang ucsc style sinc data map hg seqlevelsstyleannot ucsc add gene inform object annotationpbmc annot comput qc metric comput qc metric scatacseq experi current suggest follow metric assess data qualiti scrnaseq expect rang valu paramet vari depend biolog system cell viabil factor nucleosom band pattern histogram dna fragment size determin pairedend sequenc read exhibit strong nucleosom band pattern correspond length dna wrap around singl nucleosom calcul per singl cell quantifi approxim ratio mononucleosom nucleosomefre fragment store nucleosome_sign transcript start site tss enrich score encod projecthttpswwwencodeprojectorg defin atacseq target score base ratio fragment center tss fragment tssflank region see httpswwwencodeprojectorgdatastandardsterm poor atacseq experi typic low tss enrich score comput metric cell tssenrich function result store metadata column name tssenrich total number fragment peak measur cellular sequenc depth complex cell read may need exclud due low sequenc depth cell extrem high level may repres doublet nuclei clump artefact fraction fragment peak repres fraction fragment fall within atacseq peak cell low valu ie often repres lowqual cell technic artifact remov note valu sensit set peak use ratio read genom blacklist region encod projecthttpswwwencodeprojectorg provid list blacklist regionshttpsgithubcomboylelabblacklist repres read often associ artefactu signal cell high proport read map area compar read map peak often repres technic artifact remov encod blacklist region human hg grch mous mm drosophila dm c elegan ce includ signac packag note last three metric obtain output cellrang store object metadata also calcul nonx dataset use signac inform end document r messagefals warningfals comput nucleosom signal score per cell pbmc nucleosomesignalobject pbmc comput tss enrich score per cell pbmc tssenrichmentobject pbmc fast fals add blacklist ratio fraction read peak pbmcpct_reads_in_peak pbmcpeak_region_frag pbmcpassed_filt pbmcblacklist_ratio pbmcblacklist_region_frag pbmcpeak_region_frag inspect tss enrich score group cell base score plot access signal tss site set fasttru option tssenrich comput tss enrich score without store entir cell posit matrix tn insert frequenc cell save memori howev set fasttru allow downstream plot tss enrich signal differ group cell use tssplot function shown r messagefals warningfals pbmchightss ifelsepbmctssenrich high low tssplotpbmc groupbi hightss nolegend also look fragment length period cell group cell high low nucleosom signal strength see cell outlier mononucleosom nucleosomefre ratio base plot differ nucleosom band pattern remain cell exhibit pattern typic success atacseq experi r messagefals warningfals pbmcnucleosome_group ifelsepbmcnucleosome_sign ns ns fragmenthistogramobject pbmc groupbi nucleosome_group r messagefals warningfals figwidth figheight vlnplot object pbmc featur cpct_reads_in_peak peak_region_frag tssenrich blacklist_ratio nucleosome_sign ptsize ncol final remov cell outlier qc metric r pbmc subset x pbmc subset peak_region_frag peak_region_frag pct_reads_in_peak blacklist_ratio nucleosome_sign tssenrich pbmc normal linear dimension reduct normal signac perform term frequencyinvers document frequenc tfidf normal twostep normal procedur normal across cell correct differ cellular sequenc depth across peak give higher valu rare peak featur select low dynam rang scatacseq data make challeng perform variabl featur select scrnaseq instead choos use top _n_ featur peak dimension reduct remov featur present less _n_ cell findtopfeatur function featur though note see similar result use subset featur tri set mincutoff q use top peak faster runtim featur use dimension reduct automat set variablefeatur seurat object function dimens reduct next run singular valu decomposit svd tdidf matrix use featur peak select return reduc dimens represent object user familiar scrnaseq think analog output pca combin step tfidf follow svd known latent semant index lsi first introduc analysi scatacseq data cusanovich et al httpssciencesciencemagorgcontentful r messagefals warningfals pbmc runtfidfpbmc pbmc findtopfeaturespbmc mincutoff q pbmc runsvdpbmc first lsi compon often captur sequenc depth technic variat rather biolog variat case compon remov downstream analysi assess correl lsi compon sequenc depth use depthcor function r depthcorpbmc see strong correl first lsi compon total number count cell perform downstream step without compon nonlinear dimens reduct cluster cell embed lowdimension space use method commonli appli analysi scrnaseq data perform graphbas cluster nonlinear dimens reduct visual function runumap findneighbor findclust come seurat packag r messagefals warningfals pbmc runumapobject pbmc reduct lsi dim pbmc findneighborsobject pbmc reduct lsi dim pbmc findclustersobject pbmc verbos fals algorithm dimplotobject pbmc label true nolegend creat gene activ matrix umap visual reveal presenc multipl cell group human blood familiar scrnaseq analys pbmchttpssatijalaborgseuratvpbmck_tutorialhtml may even recogn presenc certain myeloid lymphoid popul scatacseq data howev annot interpret cluster challeng scatacseq data much less known function role noncod genom region known protein code region gene howev tri quantifi activ gene genom assess chromatin access associ gene creat new gene activ assay deriv scatacseq data use simpl approach sum fragment intersect gene bodi promot region also recommend explor cicerohttpscoletrapnelllabgithubiociceroreleas tool accomplish similar goal provid vignett show run cicero within signac workflow herecicerohtml creat gene activ matrix extract gene coordin extend includ kb upstream region promot access often correl gene express count number fragment cell map region use use featurematrix function step automat perform geneact function r messagefals warningfals geneact geneactivitypbmc r messagefals warningfals add gene activ matrix seurat object new assay normal pbmcrna createassayobjectcount geneact pbmc normalizedata object pbmc assay rna normalizationmethod lognorm scalefactor medianpbmcncount_rna visual activ canon marker gene help interpret atacseq cluster note activ much noisier scrnaseq measur repres measur spars chromatin data assum gener correspond gene bodypromot access gene express may alway case nonetheless begin discern popul monocyt b nk cell base gene activ profil howev subdivis cell type challeng base supervis analysi alon r figwidth figheight defaultassaypbmc rna featureplot object pbmc featur cmsa cdd lef nkg trem lyz ptsize maxcutoff q ncol integr scrnaseq data help interpret scatacseq data classifi cell base scrnaseq experi biolog system human pbmc util method crossmod integr label transfer describ herehttpsdoiorgjcel indepth tutori herehttpssatijalaborgseuratvatacseq_integration_vignettehtml aim identifi share correl pattern gene activ matrix scrnaseq dataset identifi match biolog state across two modal procedur return classif score cell scrnaseqdefin cluster label load preprocess scrnaseq dataset human pbmc also provid x genom download raw data experi x websitehttpssupportxgenomicscomsinglecellgeneexpressiondatasetspbmc_k_v view code use construct object githubhttpsgithubcomsatijalabintegrationblobmasterpreprocessing_scriptspbmc_k_vr altern download preprocess seurat object herehttpswwwdropboxcomsznkhirjafoyyxlpbmc_k_vrd r warningfals messagefals load preprocess scrnaseq data pbmc pbmc_rna readrdsvignette_datapbmc_k_vrd transferanchor findtransferanchor refer pbmc_rna queri pbmc reduct cca predictedlabel transferdata anchorset transferanchor refdata pbmc_rnacelltyp weightreduct pbmclsi dim pbmc addmetadataobject pbmc metadata predictedlabel r figwidth plot dimplot object pbmc_rna groupbi celltyp label true repel true nolegend ggtitlescrnaseq plot dimplot object pbmc groupbi predictedid label true repel true nolegend ggtitlescatacseq plot plot see scrnabas classif entir consist umap visual comput scatacseq data easili annot scatacseqderiv cluster altern could use rna classif note cluster map cd memori cell small cluster lower qc metric group like repres lowqual cell remov downstream analysi r cachefals pbmc subsetpbmc ident invert true pbmc renameid object pbmc cd mono cd memori cd effector cd naiv cd mono dn cd naiv nk cddim preb cd mono prob dc nk cdbright pdc find differenti access peak cluster find differenti access region cluster cell perform differenti access da test util logist regress da suggest ntrano et al httpswwwbiorxivorgcontentv scrnaseq data add total number fragment latent variabl mitig effect differenti sequenc depth result spars data scatacseq find often necessari lower minpct threshold findmark default design scrnaseq data focu compar naiv cd cell cd monocyt group cell compar use method also visual marker peak violin plot featur plot dot plot heat map visual tool seurathttpssatijalaborgseuratvvisualization_vignettehtml r messagetru warningfals chang back work peak instead gene activ defaultassaypbmc peak da_peak findmark object pbmc ident cd naiv ident cd mono minpct testus lr latentvar peak_region_frag headda_peak r cachefals figwidth plot vlnplot object pbmc featur rownamesda_peak ptsize ident ccd naivecd mono plot featureplot object pbmc featur rownamesda_peak ptsize plot plot anoth way find da region two group cell look fold chang access two group cell much faster run sophist da test abl account latent variabl differ total sequenc depth cell perform statist test howev still use way quickli explor data perform use foldchang function seurat r messagefals warningfals fc foldchangepbmc ident cd naiv ident cd mono headfc peak coordin difficult interpret alon find closest gene peak use closestfeatur function explor gene list see peak open naiv cell close gene bclb gata key regul cell differenti peak open monocyt close gene cebpb key regul monocyt differenti could follow result gene ontolog enrich analysi gene set return closestfeatur mani r packag see gostatshttpsbioconductororgpackagesreleasebiochtmlgostatshtml packag exampl r warningfals messagefals open_cdna rownamesda_peaksda_peaksavg_logfc open_cdmono rownamesda_peaksda_peaksavg_logfc closest_genes_cdna closestfeaturepbmc region open_cdna closest_genes_cdmono closestfeaturepbmc region open_cdmono r warningfals messagefals headclosest_genes_cdna r warningfals messagefals headclosest_genes_cdmono plot genom region plot frequenc tn integr across region genom cell group cluster cell type metadata store object genom region use coverageplot function repres pseudobulk access track signal cell within group averag togeth visual dna access region thank andrew hill give inspir function excel blog posthttpandrewjohnhillcomblogstreamliningscatacseqvisualizationandanalysi alongsid access track visual import inform includ gene annot peak coordin genom link theyr store object see visual vignettevisualizationhtml inform r messagefals warningfals outwidth figheight set plot order levelspbmc ccd naivecd memorycd naivecd effectordn tnk cdbrightnk cddimprebprobpdcdccd monocd mono coverageplot object pbmc region rownamesda_peak extendupstream extenddownstream also creat interact version plot use coveragebrows function record demonstr show use coveragebrows browser genom adjust plot paramet interact save plot button coveragebrows add current plot list ggplot object return browser session end press done button allow interest view save interact session ifram width height srchttpswwwyoutubecomembedsbrn framebord allowacceleromet autoplay encryptedmedia gyroscop pictureinpictur allowfullscreenifram detail summarywork dataset quantifi use cellrangersummari cellrang softwar x genom gener sever use qc metric percel well peakcel matrix index fragment file vignett util cellrang output provid altern function signac mani purpos gener peakcel bincel matrix featurematrix function use gener count matrix contain set genom rang row region could set peak bin span entir genom r evalfals run peak_rang set genom rang span set peak quantifi per cell peak_matrix featurematrix fragment fragmentspbmc featur peak_rang conveni also includ genomebinmatrix function gener set genom rang span entir genom run featurematrix intern produc genom bincel matrix r evalfals run bin_matrix genomebinmatrix fragment fragmentspbmc genom seqlengthspbmc binsiz count fraction read peak function frip count fraction read peak cell given peakcel assay bincel assay note run subset genom bincel assay need comput whole genom return seurat object metadata ad correspond fraction read peak cell r evalfals run total_frag countfragmentsvignette_dataatac_v_pbmc_k_fragmentstsvgz pbmcfragment total_fragmentscolnamespbmc frequency_count pbmc frip object pbmc assay peak totalfrag fragment count fragment genom blacklist region ratio read genom blacklist region known artifactu accumul read genom sequenc assay diagnost lowqual cell provid blacklist region coordin sever genom hg hg mm mm ce ce dm dm signac packag conveni region provid encod consortium encourag user cite paperhttpsdoiorgsz use region analysi fractioncountsinregion function use calcul fraction count within given set region per cell use function blacklist region find fraction blacklist count per cell r evalfals run pbmcblacklist_fract fractioncountsinregion object pbmc assay peak region blacklist_hg r messagefals warningfals echofals saverdsobject pbmc file vignette_datapbmcrd detail detail summarysess infosummari r sessioninfo detail titl visual genom region date compil r formatsysd b output html_document vignett demonstr visual singlecel data genomebrowsertrack style plot signac demonstr well use human pbmc dataset process vignettepbmc_vignettehtml r messagefals warningfals librarysignac load pbmc dataset pbmc readrdsvignette_datapbmcrd sever differ genom browser style plot type avail signac includ access track gene annot peak coordin genom link fragment posit plot aggreg signal main plot function signac coverageplot comput averag frequenc sequenc dna fragment differ group cell within given genom region r messagefals warningfals cov_plot coverageplot object pbmc region chr annot fals peak fals cov_plot also request region genom gene name use gene coordin store seurat object determin genom region plot r messagefals warningfals coverageplot object pbmc region cda annot fals peak fals plot gene annot gene annot within given genom region plot use annotationplot function r messagefals warningfals gene_plot annotationplot object pbmc region chr gene_plot plot peak coordin peak coordin within genom region plot use peakplot function r messagefals warningfals peak_plot peakplot object pbmc region chr peak_plot plot genom link relationship genom posit plot use linkplot function display arc connect two link posit transpar arc line proport score associ link link could use encod differ thing includ regulatori relationship exampl link enhanc gene regul experiment data hic demonstr function work weve creat fake link ad pbmc dataset r includefals librarygenomicrang gener fake link add object cdcoord lookupgenecoordsobject pbmc gene cda link grang seqnam chr rang irangesstart startcdcoord end endcdcoord score group linkspbmc link r messagefals warningfals link_plot linkplot object pbmc region chr link_plot plot percel fragment abund coverageplot function comput aggreg signal within genom region differ group cell sometim also use inspect frequenc sequenc fragment within genom region _individual_ cell without aggreg done use tileplot function r messagefals warningfals tile_plot tileplot object pbmc region chr ident ccd memori cd effector tile_plot default select top cell group base total number fragment genom region genom region tile total fragment tile count cell result count posit display heatmap plot addit data alongsid genom track multimod singlecel dataset gener multipl experiment measur cell sever method exist capabl measur singlecel chromatin data chromatin access alongsid measur cell gene express mitochondri genotyp case often inform visual multimod data togeth singl plot achiev use expressionplot function similar vlnplot function seurat design incorport genom track plot gener coverageplot r messagefals warningfals expr_plot expressionplot object pbmc featur cda assay rna expr_plot creat similar plot multipl gene simpli pass list gene name r messagefals warningfals expressionplot object pbmc featur ccda cd assay rna combin genom track weve demonstr gener individu track panel combin singl plot singl genom region panel easili combin use combinetrack function r figheight messagefals warningfals combinetrack plotlist listcov_plot tile_plot peak_plot gene_plot link_plot expressionplot expr_plot height c width c height width paramet control rel height width individu track accord order track appear plotlist combinetrack function ensur track align vertic horizont move xaxi label describ genom posit bottom combin track gener multipl track weve shown creat genom plot panel individu combin allow control panel construct theyr combin involv multipl step conveni weve includ abil gener combin differ panel automat coverageplot function annot peak tile featur argument gener similar plot shown singl function call r figheight messagefals warningfals coverageplot object pbmc region chr featur cda annot true peak true tile true link true notic exampl creat tile plot everi group cell shown coverag track wherea abl creat plot show aggreg coverag group cell tile plot cd memori cell cd effector cell higher degre custom possibl creat track separ interact visual demonstr differ type plot construct use signac often explor genom data use abl interact brows differ region genom adjust track fli done signac use coveragebrows function provid function coverageplot function except scroll upstreamdownstream zoom inout region navig new region adjust track shown cell group explor data interact often find interest plot youd like save view later weve includ save plot button add current plot list plot return interact session end here record demonstr coveragebrows function ifram width height srchttpswwwyoutubecomembedsbrn framebord allowacceleromet autoplay encryptedmedia gyroscop pictureinpictur allowfullscreenifram detail summarysess infosummari r sessioninfo detail titl joint rna atac analysi snareseq date compil r formatsysd b output html_document vignett analys singlecel coassay dataset measur gene express dna access cell vignett similar pbmc multiom vignettepbmc_multiomichtml demonstr similar joint analysi differ speci data gather use differ technolog dataset publish chen lake zhang httpswwwnaturecomarticless use technolog call snareseq look dataset adult mous brain raw data download ncbi geo httpswwwncbinlmnihgovgeoqueryacccgiaccgs fragment file dataset publicli avail remap raw data mm genom creat fragment file use sintohttpstimoastgithubiosinto fragment file download httpswwwdropboxcomsseuagcvldxqgfragmentssortbedgz fragment file index download httpswwwdropboxcomskvbfiewkjzkzffragmentssortbedgztbi code use creat fragment file raw data avail httpsgithubcomtimoastsnareseq data load first creat seurat object contain two differ assay one contain gene express data one contain dna access data load count data use readx function seurat first place barcodestsvgz matrixmtxgz featurestsvgz file separ folder r includefals requirenamespaceensdbmmusculusv quietli true biocmanagerinstallensdbmmusculusv r messagefals warningfals librarysignac libraryseurat libraryggplot libraryensdbmmusculusv setse load process data matric assay rna readxvignette_datasnareseqgse_adbraincortex_rna genecolumn atac readxvignette_datasnareseqgse_adbraincortex_atac genecolumn fragment vignette_datasnareseqfragmentssortbedgz creat seurat object add assay snare createseuratobjectcount rna snareatac createchromatinassay count atac sep c genom mm fragment fragment extract gene annot ensdb annot getgrangesfromensdbensdb ensdbmmusculusv chang ucsc style sinc data map hg seqlevelsstyleannot ucsc add gene inform object annotationsnareatac annot qualiti control r messagefals warningfals defaultassaysnar atac snare tssenrichmentsnar snare nucleosomesignalsnar snareblacklist_fract fractioncountsinregion object snare assay atac region blacklist_mm r figwidth messagefals warningfals identssnar group cell togeth rather replic vlnplot snare featur cncount_rna ncount_atac tssenrich nucleosome_sign blacklist_fract ptsize ncol r snare subset x snare subset blacklist_fract tssenrich ncount_rna ncount_atac snare gene express data process process gene express data use seurat r messagefals warningfals defaultassaysnar rna snare findvariablefeaturessnar nfeatur snare normalizedatasnar snare scaledatasnar snare runpcasnar npc snare runumapsnar dim reductionnam umaprna snare findneighborssnar dim snare findclusterssnar resolut algorithm p dimplotsnar label true nolegend ggtitlerna umap dna access data process process dna access data use signac r messagefals warningfals defaultassaysnar atac snare findtopfeaturessnar mincutoff snare runtfidfsnar snare runsvdsnar snare runumapsnar reduct lsi dim reductionnam umapatac p dimplotsnar reduct umapatac label true nolegend ggtitleatac umap r figwidth messagefals warningfals p p integr scrnaseq data next annot cell type dataset transfer label exist scrnaseq dataset adult mous brain produc allen institut r messagefals warningfals label transfer allen brain allen readrdsvignette_dataallen_brainrd use rna assay snareseq data integr scrnaseq defaultassaysnar rna transferanchor findtransferanchor refer allen queri snare dim reduct cca predictedlabel transferdata anchorset transferanchor refdata allensubclass weightreduct snarepca dim snare addmetadataobject snare metadata predictedlabel r label cluster base predict id newclusterid c l l l l ct l l pt pvalb sst astro oligo viplamp l lb np namesx newclusterid levelsx snare snare renameidentsobject snare newclusterid snarecelltyp identssnar dimplotsnar groupbi celltyp label true reduct umaprna jointli visual gene express dna access visual gene express dna access inform time use coverageplot function make easi compar dna access given region differ cell type overlay gene express inform differ gene r messagefals warningfals figwidth figheight defaultassaysnar atac coverageplotsnar region chr featur gad r includefals saverdsobject snare file vignette_datasnarerd detail summarysess infosummari r sessioninfo detail titl joint rna atac analysi x multiom date compil r formatsysd b output html_document r setup includefals knitropts_chunksetecho true vignett well demonstr jointli analyz singlecel dataset measur dna access gene express cell use signac seurat vignett well use publicli avail x genom multiom dataset human pbmc detail summaryview data download codesummari download requir data run follow line shell sh evalfals wget httpscfxgenomicscomsamplescellarcpbmc_granulocyte_sorted_kpbmc_granulocyte_sorted_k_filtered_feature_bc_matrixh wget httpscfxgenomicscomsamplescellarcpbmc_granulocyte_sorted_kpbmc_granulocyte_sorted_k_atac_fragmentstsvgz wget httpscfxgenomicscomsamplescellarcpbmc_granulocyte_sorted_kpbmc_granulocyte_sorted_k_atac_fragmentstsvgztbi detail r includefals requirenamespaceensdbhsapiensv quietli true biocmanagerinstallensdbhsapiensv requirenamespacebsgenomehsapiensucschg quietli true biocmanagerinstallbsgenomehsapiensucschg requirenamespaceremot quietli true installpackagesremot requirenamespaceseuratdisk quietli true remotesinstall_githubmojaveazureseuratdisk r messagefals warningfals librarysignac libraryseurat libraryensdbhsapiensv librarybsgenomehsapiensucschg setse r messagefals warningfals load rna atac data count readx_hvignette_datamultiomicpbmc_granulocyte_sorted_k_filtered_feature_bc_matrixh fragpath vignette_datamultiomicpbmc_granulocyte_sorted_k_atac_fragmentstsvgz r messagefals warningfals get gene annot hg annot getgrangesfromensdbensdb ensdbhsapiensv seqlevelsstyleannot ucsc creat seurat object contain rna adata pbmc createseuratobject count countsgen express assay rna creat atac assay add object pbmcatac createchromatinassay count countspeak sep c fragment fragpath annot annot r pbmc qualiti control comput percel qualiti control metric use dna access data remov cell outlier metric well cell low unusu high count either rna atac assay r figwidth messagefals warningfals defaultassaypbmc atac pbmc nucleosomesignalpbmc pbmc tssenrichmentpbmc vlnplot object pbmc featur cncount_rna ncount_atac tssenrich nucleosome_sign ncol ptsize r filter low qualiti cell pbmc subset x pbmc subset ncount_atac ncount_rna ncount_atac ncount_rna nucleosome_sign tssenrich pbmc peak call set peak identifi use cellrang often merg distinct peak close togeth creat problem certain analys particularli motif enrich analysi peaktogen linkag identifi accur set peak call peak use mac callpeak function call peak cell togeth could identifi peak group cell separ set groupbi paramet help identifi peak specif rare cell popul r messagefals warningfals call peak use mac peak callpeakspbmc macspath homestuarttminicondaenvssignacbinmac remov peak nonstandard chromosom genom blacklist region peak keepstandardchromosomespeak pruningmod coars peak subsetbyoverlapsx peak rang blacklist_hg_unifi invert true quantifi count peak macs_count featurematrix fragment fragmentspbmc featur peak cell colnamespbmc creat new assay use mac peak set add seurat object pbmcpeak createchromatinassay count macs_count fragment fragpath annot annot gene express data process normal gene express data use sctransform reduc dimension use pca r messagefals warningfals resultshid defaultassaypbmc rna pbmc sctransformpbmc pbmc runpcapbmc dna access data process process dna access assay way would process scatacseq dataset perform latent semant index lsi r messagefals warningfals defaultassaypbmc peak pbmc findtopfeaturespbmc mincutoff pbmc runtfidfpbmc pbmc runsvdpbmc annot cell type annot cell type dataset transfer cell label exist pbmc refer dataset use tool seurat packag see seurat refer map vignettehttpssatijalaborgseuratvreference_mappinghtml inform well use annot pbmc refer dataset hao et al httpswwwbiorxivorgcontentv avail download httpsatlasfredhutchorgdatanygcmultimodalpbmc_multimodalhseurat note seuratdisk packag requir load refer dataset instal instruct seuratdisk found herehttpsgithubcommojaveazureseuratdisk r messagefals warningfals libraryseuratdisk load pbmc refer refer loadhseuratvignette_datamultiomicpbmc_multimodalhseurat defaultassaypbmc sct transfer cell type label refer queri transfer_anchor findtransferanchor refer refer queri pbmc normalizationmethod sct referencereduct spca recomputeresidu fals dim predict transferdata anchorset transfer_anchor refdata referencecelltypel weightreduct pbmcpca dim pbmc addmetadata object pbmc metadata predict set cell ident cell type predict identspbmc predictedid set reason order cell type display plot levelspbmc ccd naiv cd tcm cd ctl cd tem cd prolifer cd naiv dnt cd tem cd tcm cd prolifer mait nk nk_cdbright nk prolifer gdt treg b naiv b intermedi b memori plasmablast cd mono cd mono cdc cdc pdc hspc eryth asdc ilc platelet joint umap visual use weight nearest neighbor method seurat vhttpswwwbiorxivorgcontentv comput joint neighbor graph repres gene express dna access measur r messagefals warningfals build joint neighbor graph use assay pbmc findmultimodalneighbor object pbmc reductionlist listpca lsi dimslist list modalityweightnam rnaweight verbos true build joint umap visual pbmc runumap object pbmc nnname weightednn assay rna verbos true dimplotpbmc label true repel true reduct umap nolegend link peak gene gene find set peak may regul gene comput correl gene express access nearbi peak correct bia due gc content overal access peak size see signac paperhttpswwwbiorxivorgcontentv full descript method use link peak gene run step whole genom time consum demonstr peakgen link subset gene exampl function use find link gene omit genesus paramet r messagefals warningfals defaultassaypbmc peak first comput gc content peak pbmc regionstatspbmc genom bsgenomehsapiensucschg link peak gene pbmc linkpeak object pbmc peakassay peak expressionassay sct genesus clyz msa visual link use coverageplot function altern could use coveragebrows function interact analysi r figheight messagefals warningfals identsplot cb naiv b intermedi b memori cd mono cd mono cd tem cd naiv p coverageplot object pbmc region msa featur msa expressionassay sct ident identsplot extendupstream extenddownstream p coverageplot object pbmc region lyz featur lyz expressionassay sct ident identsplot extendupstream extenddownstream patchworkwrap_plotsp p ncol r includefals saverdsobject pbmc file vignette_datapbmc_multiomicrd detail summarysess infosummari r sessioninfo detail titl joint singlecel mitochondri dna genotyp dna access analysi author caleb lareau tim stuart date compil r formatsysd b output html_document self_contain true r packag cachefals messagefals warn fals echo true librarysignac libraryseurat libraryggplot librarypatchwork libraryensdbhsapiensv take look two differ dataset contain dna access measur mitochondri mutat data cell one sampl patient colorect cancer crc tumor polyclon tf cell line data produc lareau ludwig et al read origin paper httpsdoiorg process data file includ mitochondri variant data crc tf dataset avail zenodo httpszenodoorgrecord raw sequenc data dna access process file dataset avail ncbi geo httpswwwncbinlmnihgovgeoqueryacccgiaccgs detail summaryview data download codesummari requir file download run follow line shell bash evalfals atac data wget httpszenodoorgrecordfilescrc_vmtmask_mgatkfiltered_peak_bc_matrixh wget httpszenodoorgrecordfilescrc_vmtmask_mgatksinglecellcsv wget httpszenodoorgrecordfilescrc_vmtmask_mgatkfragmentstsvgz wget httpszenodoorgrecordfilescrc_vmtmask_mgatkfragmentstsvgztbi mitochondri allel data wget httpszenodoorgrecordfilescrc_vmtmask_mgatkatxtgz wget httpszenodoorgrecordfilescrc_vmtmask_mgatkctxtgz wget httpszenodoorgrecordfilescrc_vmtmask_mgatkgtxtgz wget httpszenodoorgrecordfilescrc_vmtmask_mgatkttxtgz wget httpszenodoorgrecordfilescrc_vmtmask_mgatkdepthtabletxt wget httpszenodoorgrecordfilescrc_vmtmask_mgatkchrm_refalleletxt detail colorect cancer dataset demonstr combin analys mitochondri dna variant access chromatin well walk vignett analyz cell primari colorect adenocarcinoma sampl contain mixtur malign epitheli cell tumor infiltr immun cell load dna access data first load scatacseq data creat seurat object follow standard workflow scatacseq data r importdata messagefals warn fals load count metadata cellrangeratac count readx_hfilenam vignette_datamitocrc_vmtmask_mgatkfiltered_peak_bc_matrixh metadata readcsv file vignette_datamitocrc_vmtmask_mgatksinglecellcsv header true rownam load gene annot ensembl annot getgrangesfromensdbensdb ensdbhsapiensv chang ucsc style sinc data map hg seqlevelsstyleannot ucsc creat object crc_assay createchromatinassay count count sep c annot annot mincel genom hg fragment vignette_datamitocrc_vmtmask_mgatkfragmentstsvgz crc createseuratobject count crc_assay assay peak metadata metadata crcpeak qualiti control comput standard qualiti control metric scatacseq filter lowqual cell base metric r messagefals warningfals augment qc metric comput cellrangeratac crcpct_reads_in_peak crcpeak_region_frag crcpassed_filt crcpct_reads_in_dnas crcdnase_sensitive_region_frag crcpassed_filt crcblacklist_ratio crcblacklist_region_frag crcpeak_region_frag comput tss enrich score nucleosom band pattern crc tssenrichmentcrc crc nucleosomesignalcrc r figwidth figheight messagefals warningfals visual qc metric cell vlnplotcrc ctssenrich ncount_peak nucleosome_sign pct_reads_in_peak pct_reads_in_dnas blacklist_ratio ptsize ncol r remov lowqual cell crc subset x crc subset ncount_peak ncount_peak pct_reads_in_dnas blacklist_ratio tssenrich nucleosome_sign crc load mitochondri variant data next load mitochondri dna variant data cell quantifi use mgatkhttpsgithubcomcaleblareaumgatk readmgatk function signac allow output mgatk read directli r conveni format downstream analysi signac load data add seurat object new assay r process_mito cachetru messagefals warn fals echo true load mgatk output mitodata readmgatkdir vignette_datamitocrc creat assay mito createassayobjectcount mitodatacount subset cell present scatacseq assat mito subsetmito cell colnamescrc add assay metadata seurat object crcmito mito crc addmetadatacrc metadata mitodatadepth colnam mtdna_depth look mitochondri sequenc depth cell subset cell base mitochondri sequenc depth r messagefals warningfals vlnplotcrc mtdna_depth ptsize scale_y_log r filter cell base mitochondri depth crc subsetcrc mtdna_depth crc dimens reduct cluster next run standard dimens reduct cluster workflow use scatacseq data identifi cell cluster r messagefals warningfals crc runtfidfcrc crc findtopfeaturescrc mincutoff crc runsvdcrc crc runumapcrc reduct lsi dim crc findneighborscrc reduct lsi dim crc findclusterscrc resolut algorithm r messagefals warningfals dimplotcrc label true nolegend gener gene score help interpret cluster cell assign cell type label well estim gene activ sum dna access gene bodi promot region r setup_gene_act cachefals messagefals warn fals echo true comput gene access geneact geneactivitycrc add seurat object new assay crcrna createassayobjectcount geneact crc normalizedata object crc assay rna normalizationmethod lognorm scalefactor mediancrcncount_rna visual interest gene activ score note follow marker differ cell type crc dataset epcam marker epitheli cell trem meyloid marker ptprc cd panimmun cell marker ilrl basophil marker gata tcell maker r viz_gene_activitit messagefals warn fals figwidth figheight defaultassaycrc rna featureplot object crc featur ctrem epcam ptprc ilrlgata kit ptsize maxcutoff q ncol use gene score valu assign cluster ident r crc renameid object crc epitheli epitheli basophil myeloid_ myeloid_ tcell one myeloid cluster lower percentag fragment peak well lower overal mitochondri sequenc depth differ nucleosom band pattern r cell_filtering_recap messagefals warn fals p featurescattercrc mtdna_depth pct_reads_in_peak ggtitl scale_x_log p featurescattercrc mtdna_depth nucleosome_sign ggtitl scale_x_log p p plot_layoutguid collect see low frip cell myeloid cluster like intratumor granulocyt rel poor access chromatin enrich similarli unusu nuclear chromatin packag cell type yield slightli reduc mtdna coverag compar myeloid cluster find inform mtdna variant next identifi site mitochondri genom vari across cell cluster cell clonotyp base frequenc variant cell signac util principl establish origin mtscatacseq work identifi highqual variant r call_vari messagefals warn fals variablesit identifyvariantscrc assay mito refallel mitodatarefallel variantplotvari variablesit plot clearli show group variant higher vmr strand concord principl high strand concord reduc likelihood allel frequenc driven sequenc error predomin occur one strand due preced nucleotid content common error mtdna genotyp hand variant high vmr like clonal variant altern allel tend aggreg certain cell rather equival dispers cell would indic artifact note variant low vmr high strand concord homoplasm variant sampl may interest set eg donor demultiplex infer subclon particularli use base threshold filter set inform mitochondri variant differ across cell r look_at_vari messagefals warn fals establish filter data frame variant base process highconf subset variablesit subset n_cells_conf_detect strand_correl vmr highconfc thing stand first variant occur less allel frequenc popul howev ct present well see clonal variant mark epitheli cell addit call variant transit g c rather transvers mutat c g fit know mutat aris mitochondri genom depend analyt question threshold adjust identifi variant preval cell comput variant allel frequenc cell current inform strand store mito assay allow strand concord assess set highconfid inform variant creat new assay contain strandcollaps allel frequenc count cell variant use allelefreq function r crc allelefreq object crc variant highconfvari assay mito crcallel visual variant allel frequenc store addit assay use standard function seurat visual allel frequenc distribut across cell visual subset variant use featureplot doheatmap r visual variant messagefals warn fals defaultassaycrc allel allelesview cga ct ct ga featureplot object crc featur allelesview order true col cgrey darkr ncol nolegend r messagefals warningfals doheatmapcrc featur rownamescrc slot data dispmax scale_fill_viridis_c see interest pattern select variant ct present essenti epitheli cell almost exclus epitheli cell edg case isnt true also case umap cluster dont full agre allel frequenc strongli suggest whatev cell origin tumor mutat expand see least variant ga ga ct mostli present specif epitheli cell defin subclon variant includ ga ga tc found specif immun cell popul suggest aros common hematopoet progenitor cell probabl bone marrow tf cell line dataset next well demonstr similar workflow identifi cell clone differ dataset time gener tf cell line dataset contain clone present higher proport base experiment design well demonstr identifi group relat cell clone cluster allel frequenc data relat clonal group access differ util multimod capabl signac data load detail summaryview data download codesummari download data zenodo run follow shell bash evalfals atac data wget httpszenodoorgrecordfilestffilteredfragmentstsvgz wget httpszenodoorgrecordfilestffilteredfragmentstsvgztbi wget httpszenodoorgrecordfilestffilterednarrowpeakgz mitochondri genom data wget httpszenodoorgrecordfilestf_filteredatxtgz wget httpszenodoorgrecordfilestf_filteredttxtgz wget httpszenodoorgrecordfilestf_filteredctxtgz wget httpszenodoorgrecordfilestf_filteredgtxtgz wget httpszenodoorgrecordfilestf_filteredchrm_refalleletxtgz wget httpszenodoorgrecordfilestf_filtereddepthtabletxtgz detail r read mitochondri data tfdata readmgatkdir vignette_datamitotf creat seurat object tf createseuratobject count tfdatacount metadata tfdatadepth assay mito load peak set peak readtabl file vignette_datamitotffilterednarrowpeakgz sep colnam cchrom start end peak width strand x z w peak makegrangesfromdataframepeak creat fragment object frag createfragmentobject path vignette_datamitotffilteredfragmentstsvgz cell colnamestf quantifi dna access data count featurematrix fragment frag featur peak cell colnamestf creat assay access data add seurat object tfpeak createchromatinassay count count fragment frag qualiti control r messagefals warningfals add annot annotationtfpeak annot r messagefals warningfals defaultassaytf peak tf nucleosomesignaltf tf tssenrichmenttf r vlnplottf cncount_peak nucleosome_sign tssenrich ptsize r tf subset x tf subset ncount_peak nucleosome_sign tssenrich tf identifi variant r defaultassaytf mito variant identifyvariantstf refallel tfdatarefallel variantplotvari r highconf subset variant subset n_cells_conf_detect strand_correl vmr r tf allelefreqtf variant highconfvari assay mito tfallel identifi clone weve identifi set variabl allel cluster cell base frequenc allel use findclonotyp function use louvain commun detect algorithm implement seurat r messagefals warningfals defaultassaytf allel tf findclonotypestf r tableidentstf see clonal cluster identifi differ clone tf dataset visual frequenc allel clone use doheatmap findclonotyp function also perform hierarch cluster clonotyp allel set factor level clonotyp base hierarch cluster order order variabl featur base hierarch featur cluster allow us get decent order featur clone automat r messagefals warningfals doheatmaptf featur variablefeaturestf slot data dispmax scale_fill_viridis_c find differenti access peak clone next use clonal inform deriv mitochondri assay find peak differenti access clone r messagefals warningfals defaultassaytf peak find peak specif one clone markersfast foldchangetf ident headmarkersfast dna access region clone use coverageplot function see peak identifi highli specif one clone r coverageplot object tf region rownamesmarkersfast extendupstream extenddownstream detail summarysess infosummari r sessioninfo detail titl merg object date compil r formatsysd b output html_document r setup includefals knitropts_chunksetecho true vignett demonstr merg multipl seurat object contain singlecel chromatin data demonstr use four scatacseq pbmc dataset provid x genom cell pbmchttpssupportxgenomicscomsinglecellatacdatasetsatac_pbmc__nextgem kcell pbmchttpssupportxgenomicscomsinglecellatacdatasetsatac_pbmc_k_nextgem kcell pbmchttpssupportxgenomicscomsinglecellatacdatasetsatac_pbmc_k_nextgem kcell pbmchttpssupportxgenomicscomsinglecellatacdatasetsatac_pbmc_k_nextgem detail summaryview data download codesummari download requir data run follow line shell bash evalfals cell wget httpscfxgenomicscomsamplescellatacatac_pbmc__nextgematac_pbmc__nextgem_fragmentstsvgz wget httpscfxgenomicscomsamplescellatacatac_pbmc__nextgematac_pbmc__nextgem_fragmentstsvgztbi wget httpscfxgenomicscomsamplescellatacatac_pbmc__nextgematac_pbmc__nextgem_peaksb wget httpscfxgenomicscomsamplescellatacatac_pbmc__nextgematac_pbmc__nextgem_singlecellcsv wget httpscfxgenomicscomsamplescellatacatac_pbmc__nextgematac_pbmc__nextgem_filtered_peak_bc_matrixh k cell wget httpscfxgenomicscomsamplescellatacatac_pbmc_k_nextgematac_pbmc_k_nextgem_fragmentstsvgz wget httpscfxgenomicscomsamplescellatacatac_pbmc_k_nextgematac_pbmc_k_nextgem_fragmentstsvgztbi wget httpscfxgenomicscomsamplescellatacatac_pbmc_k_nextgematac_pbmc_k_nextgem_peaksb wget httpscfxgenomicscomsamplescellatacatac_pbmc_k_nextgematac_pbmc_k_nextgem_singlecellcsv wget httpscfxgenomicscomsamplescellatacatac_pbmc_k_nextgematac_pbmc_k_nextgem_filtered_peak_bc_matrixh k cell wget httpscfxgenomicscomsamplescellatacatac_pbmc_k_nextgematac_pbmc_k_nextgem_fragmentstsvgz wget httpscfxgenomicscomsamplescellatacatac_pbmc_k_nextgematac_pbmc_k_nextgem_fragmentstsvgztbi wget httpscfxgenomicscomsamplescellatacatac_pbmc_k_nextgematac_pbmc_k_nextgem_peaksb wget httpscfxgenomicscomsamplescellatacatac_pbmc_k_nextgematac_pbmc_k_nextgem_singlecellcsv wget httpscfxgenomicscomsamplescellatacatac_pbmc_k_nextgematac_pbmc_k_nextgem_filtered_peak_bc_matrixh k cell wget httpscfxgenomicscomsamplescellatacatac_pbmc_k_nextgematac_pbmc_k_nextgem_fragmentstsvgz wget httpscfxgenomicscomsamplescellatacatac_pbmc_k_nextgematac_pbmc_k_nextgem_fragmentstsvgztbi wget httpscfxgenomicscomsamplescellatacatac_pbmc_k_nextgematac_pbmc_k_nextgem_peaksb wget httpscfxgenomicscomsamplescellatacatac_pbmc_k_nextgematac_pbmc_k_nextgem_singlecellcsv wget httpscfxgenomicscomsamplescellatacatac_pbmc_k_nextgematac_pbmc_k_nextgem_filtered_peak_bc_matrixh detail merg multipl singlecel chromatin dataset import awar peak call perform dataset independ peak unlik exactli therefor need creat common set peak across dataset merg creat unifi set peak use function genomicrangeshttpsbioconductororgpackagesgenomicrang packag reduc function genomicrang merg intersect peak anoth option use disjoin function creat distinct nonoverlap set peak visual exampl illustr differ reduc disjoin r echofals includefals librarygenomicrang libraryggplot libraryggbio librarypatchwork r gr grangesseqnam chr rang irangesstart c end c gr r figheight figwidth echofals ggplotgr geom_segments theme_class ggtitlerang ylab ggplotreducegr geom_segments theme_class ggtitlereduc ylab ggplotdisjoingr geom_segments theme_class ggtitledisjoin ylab creat common peak set peak identifi independ experi like overlap perfectli merg peak dataset creat common peak set quantifi peak set experi prior merg object first well load peak coordin experi convert genom rang use genomicrangesreduc function creat common set peak quantifi dataset r messagefals warningfals librarysignac libraryseurat librarygenomicrang libraryfutur planmultiprocess worker optionsfutureglobalsmaxs gb ram r read peak set peak readtabl file vignette_datapbmcatac_pbmc__nextgem_peaksb colnam cchr start end peaksk readtabl file vignette_datapbmckatac_pbmc_k_nextgem_peaksb colnam cchr start end peaksk readtabl file vignette_datapbmckatac_pbmc_k_nextgem_peaksb colnam cchr start end peaksk readtabl file vignette_datapbmckatac_pbmc_k_nextgem_peaksb colnam cchr start end convert genom rang gr makegrangesfromdataframepeak grk makegrangesfromdataframepeaksk grk makegrangesfromdataframepeaksk grk makegrangesfromdataframepeaksk creat unifi set peak quantifi dataset combinedpeak reducex cgr grk grk grk filter bad peak base length peakwidth widthcombinedpeak combinedpeak combinedpeakspeakwidth peakwidth combinedpeak creat fragment object quantifi combin set peak well need creat fragment object experi fragment class special class defin signac hold inform relat singl fragment file first well load cell metadata experi know cell barcod contain file creat fragment object use createfragmentobject function createfragmentobject function perform check ensur file present disk compress index comput md sum file tabix index tell file modifi point check expect cell present file r load metadata md readtabl file vignette_datapbmcatac_pbmc__nextgem_singlecellcsv stringsasfactor fals sep header true rownam remov first row mdk readtabl file vignette_datapbmckatac_pbmc_k_nextgem_singlecellcsv stringsasfactor fals sep header true rownam mdk readtabl file vignette_datapbmckatac_pbmc_k_nextgem_singlecellcsv stringsasfactor fals sep header true rownam mdk readtabl file vignette_datapbmckatac_pbmc_k_nextgem_singlecellcsv stringsasfactor fals sep header true rownam perform initi filter low count cell md mdmdpassed_filt mdk mdkmdkpassed_filt mdk mdkmdkpassed_filt mdk mdkmdkpassed_filt sequenc deeper set higher cutoff creat fragment object frag createfragmentobject path vignette_datapbmcatac_pbmc__nextgem_fragmentstsvgz cell rownamesmd fragsk createfragmentobject path vignette_datapbmckatac_pbmc_k_nextgem_fragmentstsvgz cell rownamesmdk fragsk createfragmentobject path vignette_datapbmckatac_pbmc_k_nextgem_fragmentstsvgz cell rownamesmdk fragsk createfragmentobject path vignette_datapbmckatac_pbmc_k_nextgem_fragmentstsvgz cell rownamesmdk quantifi peak dataset creat matrix peak x cell sampl use featurematrix function function parallel use futurehttpscranrprojectorgpackagefutur packag see parallelizationhttpssatijalaborgsignacarticlesfuturehtml vignett inform use futur r messagefals warningfals cachetru pbmccount featurematrix fragment frag featur combinedpeak cell rownamesmd pbmckcount featurematrix fragment fragsk featur combinedpeak cell rownamesmdk pbmckcount featurematrix fragment fragsk featur combinedpeak cell rownamesmdk pbmckcount featurematrix fragment fragsk featur combinedpeak cell rownamesmdk creat object use quantifi matric creat seurat object dataset store fragment object dataset assay r messagefals warningfals pbmc_assay createchromatinassaypbmccount fragment frag pbmc createseuratobjectpbmc_assay assay atac metadatamd pbmck_assay createchromatinassaypbmckcount fragment fragsk pbmck createseuratobjectpbmck_assay assay atac metadatamdk pbmck_assay createchromatinassaypbmckcount fragment fragsk pbmck createseuratobjectpbmck_assay assay atac metadatamdk pbmck_assay createchromatinassaypbmckcount fragment fragsk pbmck createseuratobjectpbmck_assay assay atac metadatamdk merg object object contain assay set featur use standard merg function merg object also merg fragment object retain fragment inform cell final merg object r add inform identifi dataset origin pbmcdataset pbmc pbmckdataset pbmck pbmckdataset pbmck pbmckdataset pbmck merg dataset ad cell id make sure cell name uniqu combin merg x pbmc listpbmck pbmck pbmck addcellid c k k k combinedatac r messagefals warningfals combin runtfidfcombin combin findtopfeaturescombin mincutoff combin runsvdcombin combin runumapcombin dim reduct lsi r dimplotcombin groupbi dataset ptsize merg object contain four fragment object contain intern map cell name object cell name fragment file retriev inform file without chang cell name fragment file check function pull data fragment file work expect merg object plot region genom r coverageplot messagefals warningfals cachefals outwidth figheight coverageplot object combin groupbi dataset region chr r echofals messagefals warningfals saverdsobject combin file vignette_datapbmc_combinedrd merg without common featur set approach requir access fragment file dataset case may data although creat fragment file bam file use sintohttpstimoastgithubiosintobasic_usagehtmlcreatescatacseqfragmentsfil case still creat merg object caveat result merg count matrix may accur merg function defin signac chromatinassay object consid overlap peak equival adjust genom rang span peak featur object merg becom equival note result inaccuraci count matrix peak extend cover region origin quantifi best done without requantif recommend alway follow procedur outlin object merg whenev possibl demonstr merg four pbmc dataset without creat common featur set r messagefals warningfals load count matrix object gener cellrang count readx_hvignette_datapbmcatac_pbmc__nextgem_filtered_peak_bc_matrixh countsk readx_hvignette_datapbmckatac_pbmc_k_nextgem_filtered_peak_bc_matrixh countsk readx_hvignette_datapbmckatac_pbmc_k_nextgem_filtered_peak_bc_matrixh countsk readx_hvignette_datapbmckatac_pbmc_k_nextgem_filtered_peak_bc_matrixh creat object pbmc_assay createchromatinassaycount count sep c minfeatur pbmc createseuratobjectpbmc_assay assay peak pbmck_assay createchromatinassaycount countsk sep c minfeatur pbmck createseuratobjectpbmck_assay assay peak pbmck_assay createchromatinassaycount countsk sep c minfeatur pbmck createseuratobjectpbmck_assay assay peak pbmck_assay createchromatinassaycount countsk sep c minfeatur pbmck createseuratobjectpbmck_assay assay peak add inform identifi dataset origin pbmcdataset pbmc pbmckdataset pbmck pbmckdataset pbmck pbmckdataset pbmck merg combin merg x pbmc listpbmck pbmck pbmck addcellid c k k k process combin runtfidfcombin combin findtopfeaturescombin mincutoff combin runsvdcombin combin runumapcombin dim reduct lsi r dimplotcombin groupbi dataset ptsize detail summarysess infosummari r sessioninfo detail titl analyz adult mous brain scatacseq output html_document date compil r formatsysd b r init includefals knitropts_chunksetecho true tutori analyz singlecel atacseq dataset adult mous brain cell provid x genom follow file use vignett avail x genom websit detail summaryview data download codesummari download requir data run follow line shell bash evalfals wget httpcfxgenomicscomsamplescellatacatac_v_adult_brain_fresh_katac_v_adult_brain_fresh_k_filtered_peak_bc_matrixh wget httpcfxgenomicscomsamplescellatacatac_v_adult_brain_fresh_katac_v_adult_brain_fresh_k_singlecellcsv wget httpcfxgenomicscomsamplescellatacatac_v_adult_brain_fresh_katac_v_adult_brain_fresh_k_fragmentstsvgz wget httpcfxgenomicscomsamplescellatacatac_v_adult_brain_fresh_katac_v_adult_brain_fresh_k_fragmentstsvgztbi detail vignett echo command run introductori signac vignett human pbmchttpssatijalaborgsignacarticlespbmc_vignettehtml provid analysi differ system demonstr perform applic tissu type provid exampl anoth speci first load signac seurat packag use analyz mous data r includefals requirenamespaceensdbmmusculusv quietli true biocmanagerinstallensdbmmusculusv requirenamespacegenomeinfodb quietli true biocmanagerinstallgenomeinfodb r setup messagefals librarysignac libraryseurat librarygenomeinfodb libraryensdbmmusculusv libraryggplot librarypatchwork setse preprocess workflow r count readx_hvignette_dataatac_v_adult_brain_fresh_k_filtered_peak_bc_matrixh metadata readcsv file vignette_dataatac_v_adult_brain_fresh_k_singlecellcsv header true rownam brain_assay createchromatinassay count count sep c genom mm fragment vignette_dataatac_v_adult_brain_fresh_k_fragmentstsvgz mincel brain createseuratobject count brain_assay assay peak project atac metadata metadata also add gene annot brain object mous genom allow downstream function pull gene annot inform directli object r messagefals warningfals extract gene annot ensdb annot getgrangesfromensdbensdb ensdbmmusculusv chang ucsc style sinc data map hg seqlevelsstyleannot ucsc add gene inform object annotationbrain annot comput qc metric next comput use percel qc metric r messagefals warningfals brain nucleosomesignalobject brain look fragment length period cell group cell high low nucleosom signal strength see cell outlier mononucleosom nucleosomefre ratio differ band pattern remain cell exhibit pattern typic success atacseq experi r messagefals warningfals brainnucleosome_group ifelsebrainnucleosome_sign ns ns fragmenthistogramobject brain groupbi nucleosome_group region chr enrich tn integr event transcript start site tsss also import qualiti control metric assess target tn atacseq experi encod consortium defin tss enrich score number tn integr site around tss normal number tn integr site flank region see encod document inform tss enrich score httpswwwencodeprojectorgdatastandardsterm calcul tss enrich score cell use tssenrich function signac r messagefals warningfals brain tssenrichmentbrain fast fals r messagefals warningfals brainhightss ifelsebraintssenrich high low tssplotbrain groupbi hightss nolegend r messagefals warningfals figwidth figheight brainpct_reads_in_peak brainpeak_region_frag brainpassed_filt brainblacklist_ratio brainblacklist_region_frag brainpeak_region_frag vlnplot object brain featur cpct_reads_in_peak peak_region_frag tssenrich blacklist_ratio nucleosome_sign ptsize ncol remov cell outlier qc metric r brain subset x brain subset peak_region_frag peak_region_frag pct_reads_in_peak blacklist_ratio nucleosome_sign tssenrich brain normal linear dimension reduct r messagefals warningfals brain runtfidfbrain brain findtopfeaturesbrain mincutoff q brain runsvdobject brain first lsi compon often captur sequenc depth technic variat rather biolog variat case compon remov downstream analysi assess correl lsi compon sequenc depth use depthcor function r depthcorbrain see strong correl first lsi compon total number count cell perform downstream step without compon nonlinear dimens reduct cluster cell embed lowdimension space use method commonli appli analysi scrnaseq data perform graphbas cluster nonlinear dimens reduct visual function runumap findneighbor findclust come seurat packag r messagefals warningfals brain runumap object brain reduct lsi dim brain findneighbor object brain reduct lsi dim brain findclust object brain algorithm resolut verbos fals dimplotobject brain label true nolegend creat gene activ matrix r messagefals warningfals comput gene activ geneact geneactivitybrain add gene activ matrix seurat object new assay brainrna createassayobjectcount geneact brain normalizedata object brain assay rna normalizationmethod lognorm scalefactor medianbrainncount_rna r figwidth figheight defaultassaybrain rna featureplot object brain featur csstpvalbgadneurodrorbsyt ptsize maxcutoff q ncol integr scrnaseq data help interpret scatacseq data classifi cell base scrnaseq experi biolog system adult mous brain util method crossmod integr label transfer describ herehttpsdoiorgjcel indepth tutori herehttpssatijalaborgseuratvatacseq_integration_vignettehtml download raw data experi allen institut websitehttpcelltypesbrainmaporgapivwell_known_file_download view code use construct object githubhttpsgithubcomsatijalabintegrationblobmasterpreprocessing_scriptsallen_brainr altern download preprocess seurat object herehttpswwwdropboxcomskqsytvsklbucallen_brainrd r warningfals messagefals load preprocess scrnaseq data allen_rna readrdsvignette_dataallen_brainrd allen_rna findvariablefeatur object allen_rna nfeatur transferanchor findtransferanchor refer allen_rna queri brain reduct cca dim predictedlabel transferdata anchorset transferanchor refdata allen_rnasubclass weightreduct brainlsi dim brain addmetadataobject brain metadata predictedlabel r figwidth plot dimplotallen_rna groupbi subclass label true repel true nolegend ggtitlescrnaseq plot dimplotbrain groupbi predictedid label true repel true nolegend ggtitlescatacseq plot plot detail summarywhi chang default parameterssummari chang default paramet findintegrationanchor findvariablefeatur includ featur dimens run analysi way observ similar result howev use default paramet mislabel cluster cell vipinterneuron fact mei express cgederiv interneuron popul recent describ ushttpswwwnaturecomarticlesnatur othershttpswwwnaturecomarticlesncomm reason subset except rare scrnaseq data gene defin subset exampl mei lowli express select initi set variabl featur therefor need gene dimens facilit crossmod map interestingli subset fold abund scatacseq data compar scrnaseq data see paperhttpsjournalsplosorgplosonearticleidjournalpon possibl explan detail see rnabas classif entir consist umap visual comput atacseq data easili annot scatacseq deriv cluster altern could use rna classif note three small cluster repres subdivis scrnaseq label tri transfer cluster label show finer distinct allen scrnaseq dataset annot r replac label like predict fori levelsbrain cells_to_reid whichcellsbrain ident newid namessorttablebrainpredictedidcells_to_reiddecreasingtru identsbrain cell cells_to_reid newid find differenti access peak cluster find differenti access region excitatori neuron differ layer cortex r messagetru warningfals switch back work peak instead gene activ defaultassaybrain peak da_peak findmark object brain ident cl ident cl l l minpct testus lr latentvar peak_region_frag headda_peak r figwidth plot vlnplot object brain featur rownamesda_peak ptsize ident cll itl plot featureplot object brain featur rownamesda_peak ptsize maxcutoff q plot plot r warningfals messagefals open_l rownamesda_peaksda_peaksavg_logfc open_l rownamesda_peaksda_peaksavg_logfc closest_l closestfeaturebrain open_l closest_l closestfeaturebrain open_l headclosest_l r warningfals messagefals headclosest_l plot genom region also creat coverag plot group cluster cell type metadata store object genom region use coverageplot function repres pseudobulk access track signal cell within group averag togeth visual dna access region r messagefals warningfals outwidth figheight set plot order levelsbrain cl itll itl ptl ct l itnpsstpvalbviplampmeisoligoastroendovlmcmacrophag coverageplot object brain region cneurod gad extendupstream extenddownstream ncol r messagefals warningfals echofals saverdsobject brain file vignette_dataadult_mouse_brainrd detail summarysess infosummari r sessioninfo detail titl transcript factor footprint date compil r formatsysd b output html_document r messagefals warningfals librarysignac libraryseurat data load vignett well use dataset introduc preprocess trajectori build vignettemonoclehtml r bone readrdsvignette_datacdrd dimplotbon label true perform footprint analysi first need add motif inform object includ exact posit motif done use function codemotifmatchr codetfbstool packag r includefals requirenamespacejaspar quietli true biocmanagerinstalljaspar requirenamespacetfbstool quietli true biocmanagerinstalltfbstool requirenamespacemotifmatchr quietli true biocmanagerinstallmotifmatchr requirenamespacebsgenomehsapiensucschg quietli true biocmanagerinstallbsgenomehsapiensucschg r messagefals warningfals librarymotifmatchr libraryjaspar librarytfbstool librarybsgenomehsapiensucschg extract posit frequenc matric motif pwm getmatrixset x jaspar opt listspeci all_vers fals add motif inform bone addmotifsbon genom bsgenomehsapiensucschg pfm pwm motif footprint footprint motif posit inform default includ everi instanc motif genom instead use inpeak true paramet includ motif fall insid peak assay footprint function gather requir data store assay plot footprint motif use plotfootprint function r messagefals warningfals gather footprint inform set motif bone footprint object bone motifnam cgata cebpa ebf genom bsgenomehsapiensucschg plot footprint data group cell p plotfootprintbon featur cgata cebpa ebf r figheight messagefals warningfals p patchworkplot_layoutncol detail summarysess infosummari r sessioninfo detail titl motif analysi signac date compil r formatsysd b output html_document r setup includefals knitropts_chunksetecho true tutori perform dna sequenc motif analysi signac explor two complementari option perform motif analysi one find overrepres motif set differenti access peak one method perform differenti motif activ analysi group cell demonstr use data adult mous brain see vignettemouse_brain_vignettehtml code use gener object link raw data first load requir packag precomput seurat object r includefals requirenamespacetfbstool quietli true biocmanagerinstalltfbstool requirenamespacejaspar quietli true biocmanagerinstalljaspar requirenamespacebsgenomemmusculusucscmm quietli true biocmanagerinstallbsgenomemmusculusucscmm requirenamespacechromvar quietli true biocmanagerinstallchromvar requirenamespaceggbio quietli true biocmanagerinstallggbio r messagefals warningfals librarysignac libraryseurat libraryjaspar librarytfbstool librarybsgenomemmusculusucscmm librarypatchwork setse r messagefals warningfals mouse_brain readrdsvignette_dataadult_mouse_brainrd mouse_brain r messagefals warningfals p dimplotmouse_brain label true ptsize nolegend p ad motif inform seurat object add dna sequenc motif inform requir motif analys run addmotif function r messagefals warningfals get list motif posit frequenc matric jaspar databas pfm getmatrixset x jaspar opt listcollect core tax_group vertebr all_vers fals add motif inform mouse_brain addmotif object mouse_brain genom bsgenomemmusculusucscmm pfm pfm facilit motif analysi signac creat motif class store requir inform includ list posit weight matric pwm posit frequenc matric pfm motif occurr matrix addmotif function construct motif object add mous brain dataset along inform base composit peak motif object ad seurat assay use setassaydata function see object interact vignettedata_structureshtml inform find overrepres motif identifi potenti import celltypespecif regulatori sequenc search dna motif overrepres set peak differenti access cell type find differenti access peak pvalb sst inhibitori interneuron spars data scatacseq find often necessari lower minpct threshold findmark default design scrnaseq data perform hypergeometr test test probabl observ motif given frequenc chanc compar background set peak match gc content r messagefals warningfals da_peak findmark object mouse_brain ident pvalb ident sst onlypo true testus lr minpct latentvar ncount_peak get top differenti access peak topdapeak rownamesda_peaksda_peaksp_v detail summaryopt choos set background peakssummari match set background peak essenti find enrich dna sequenc motif default choos set peak match gc content sometim benefici restrict background peak access group cell compar find differenti access peak accessiblepeak function use find set peak open subset cell use function first restrict set possibl background peak peak open set cell compar findmark creat gccontentmatch set peak larger set use matchregionstat r find peak open pvalb sst cell openpeak accessiblepeaksmouse_brain ident cpvalb sst match overal gc content peak set metafeatur getassaydatamouse_brain assay peak slot metafeatur peaksmatch matchregionstat metafeatur metafeatureopenpeak queryfeatur metafeaturetopdapeak n peaksmatch use background peak set set backgroundpeaksmatch findmotif detail r test enrich enrichedmotif findmotif object mouse_brain featur topdapeak r echofals knitrkableheadenrichedmotif also plot posit weight matric motif visual differ motif sequenc r motifplot object mouse_brain motif headrownamesenrichedmotif other previous shown meffamili motif particularli mefc enrich pvalbspecif peak scatacseq data httpsdoiorgjcel httpsdoiorg shown mefc requir develop pvalb interneuron httpswwwnaturecomarticlesnatur result consist find observ strong enrich meffamili motif top result findmotif comput motif activ also comput percel motif activ score run chromvarhttpsgreenleaflabgithubiochromvarindexhtml allow us visual motif activ per cell also provid altern method identifi differentiallyact motif cell type chromvar identifi motif associ variabl chromatin access cell see chromvar paperhttpswwwnaturecomarticlesnmeth complet descript method r messagefals warningfals figwidth mouse_brain runchromvar object mouse_brain genom bsgenomemmusculusucscmm defaultassaymouse_brain chromvar look activ mefc p featureplot object mouse_brain featur mincutoff q maxcutoff q ptsize p p also directli test differenti activ score cell type tend give similar result perform enrich test differenti access peak cell type shown perform differenti test chromvar zscore set meanfxnrowmean fcnameavg_diff findmark function foldchang calcul comput averag differ zscore group r messagefals warningfals differentialact findmark object mouse_brain ident pvalb ident sst onlypo true meanfxn rowmean fcname avg_diff motifplot object mouse_brain motif headrownamesdifferentialact assay peak detail summarysess infosummari r sessioninfo detail gener roxygen edit hand pleas edit document rgenericsr rfootprintingr nameinsertionbia aliasinsertionbia aliasinsertionbiaschromatinassay aliasinsertionbiasseurat titlecomput tn insert bia usag insertionbiasobject methodinsertionbiaschromatinassayobject genom region chr verbos true methodinsertionbiasseurat object genom assay null region chr verbos true argument itemobjecta seurat chromatinassay object itemaddit argument pass codelinkstringtograng itemgenomea bsgenom object itemregionregion use assess bia default human chromosom itemverbosedisplay messag itemassaynam assay use valu return seurat object descript count tn insert frequenc dna hexam exampl dontrun librarybsgenomemmusculusucscmm regionus grang seqnam cchr chr irangesstart c end c insertionbia object atac_smal genom bsgenomemmusculusucscmm region regionus conceptfootprint gener roxygen edit hand pleas edit document rvisualizationr nameplotfootprint aliasplotfootprint titleplot motif footprint result usag plotfootprint object featur assay null groupbi null ident null label true repel true showexpect true normal subtract labeltop labelid null argument itemobjecta seurat object itemfeaturesa vector featur plot itemassaynam assay use itemgroupbya group variabl itemidentsset ident includ plot itemlabeltruefals valu control whether group label itemrepelrepel label itemshowexpectedplot expect tn integr frequenc main footprint plot itemnormalizationmethod normal tn dna sequenc bia option subtract divid null perform bia correct itemlabeltopnumb group label base highest access motif flank region itemlabelidentsvector ident label suppli codelabeltop ignor descript plot motif footprint result conceptfootprint conceptvisu gener roxygen edit hand pleas edit document rgenericsr rdimension_reductionr namerunsvd aliasrunsvd aliasrunsvddefault aliasrunsvdassay aliasrunsvdseurat titlerun singular valu decomposit usag runsvdobject methodrunsvddefault object assay null n scaleembed true reductionkey lsi_ scalemax null verbos true irlbawork n methodrunsvdassay object assay null featur null n reductionkey lsi_ scalemax null verbos true methodrunsvdseurat object assay null featur null n reductionkey lsi_ reductionnam lsi scalemax null verbos true argument itemobjecta seurat object itemargu pass method itemassaywhich assay use null use default assay itemnnumb singular valu comput itemscaleembeddingsscal cell embed within compon mean sd default true itemreductionkeykey dimens reduct object itemscalemaxclip valu cell embed default null clip itemverboseprint messag itemirlbaworkwork paramet codelinkirlbairlba work subspac dimens larger valu speed converg cost memori use itemfeatureswhich featur use null use variabl featur itemreductionnamenam store dimens reduct object default svd valu return codelinkseuratobjectseurat object descript run partial singular valu decomposit use codelinkirlbairlba exampl x matrixdata rnorm ncol runsvdx runsvdatac_smallpeak runsvdatac_smal conceptdimension_reduct gener roxygen edit hand pleas edit document rgenericsr rpreprocessingr namefindtopfeatur aliasfindtopfeatur aliasfindtopfeaturesdefault aliasfindtopfeaturesassay aliasfindtopfeaturesseurat titlefind frequent observ featur usag findtopfeaturesobject methodfindtopfeaturesdefaultobject assay null mincutoff q verbos true methodfindtopfeaturesassayobject assay null mincutoff q verbos true methodfindtopfeaturesseuratobject assay null mincutoff q verbos true argument itemobjecta seurat object itemargu pass method itemassaynam assay use itemmincutoffcutoff featur includ variablefeatur object percentil specifi q follow minimum percentil exampl q set top common featur variablefeatur object altern integ specifi minimum number cell contain featur featur includ set variablefeatur exampl set includ featur cell set variablefeatur null includ featur variablefeatur na variablefeatur alter featur metadata updat total count percentil rank featur itemverbosedisplay messag valu return codelinkseuratobjectseurat object descript find top featur given assay base total number count featur specifi minimum cell count lower percentil bound determin set variabl featur run function store total count percentil rank featur featur metadata assay comput featur metadata without chang variabl featur assay set codemincutoffna exampl findtopfeaturesobject atac_smallpeak findtopfeaturesobject atac_smallpeak findtopfeaturesatac_smal conceptpreprocess gener roxygen edit hand pleas edit document rutilitiesr namecellspergroup aliascellspergroup titlecel per group usag cellspergroupobject groupbi null argument itemobjecta seurat object itemgroupbya group variabl default activ ident valu return vector descript count number cell group exampl cellspergroupatac_smal conceptutil gener roxygen edit hand pleas edit document rdatar doctypedata nameblacklist_hg aliasblacklist_hg titlegenom blacklist region human hg base format grang object sourc urlhttpsgithubcomboylelabblacklist doisz usag blacklist_hg descript genom blacklist region human hg base conceptdata keyworddataset gener roxygen edit hand pleas edit document rutilitiesr namegrangestostr aliasgrangestostr titlegrang string usag grangestostringgrang sep c argument itemgrangea grang object itemsepvector separ use genom string first element use separ chromosom coordin second separ use separ start end coordin valu return charact vector descript convert grang object vector string exampl grangestostringgrang blacklist_hg conceptutil gener roxygen edit hand pleas edit document rfragmentsr namefiltercel aliasfiltercel titlefilt cell fragment file usag filtercel fragment cell outfil null buffer_length l verbos true argument itemfragmentspath fragment file itemcellsa vector cell keep itemoutfilenam output file itembuffer_lengths buffer read fragment file must longer longest line file itemverbosedisplay messag descript remov fragment allow set cell barcod fragment file creat new file disk contain fragment cell specifi codecel argument output file block gzipcompress index readi use signac function exampl fpath systemfileextdata fragmentstsvgz packagesignac tmpf tempfilefileext gz filtercel fragment fpath cell headcolnamesatac_smal outfil tmpf fileremovetmpf conceptfrag gener roxygen edit hand pleas edit document rgenericsr robjectsr nameaschromatinassay aliasaschromatinassay aliasaschromatinassayassay titleconvert object chromatinassay usag aschromatinassayx methodaschromatinassayassay x rang null seqinfo null annot null motif null fragment null bia null positionenrich null sep c argument itemxan object convert class codelinkchromatinassay itemargu pass method itemrangesa grang object itemseqinfoa codelinkgenomeinfodbseqinfo object contain basic inform genom use altern name ucsc genom provid sequenc inform download ucsc itemannotationgenom annot itemmotifsa codelinkmotif object itemfragmentsa list codelinkfrag object itembiastn integr bia matrix itempositionenrichmenta name list posit enrich matric itemsepcharact use separ chromosom start end coordin row name data matrix descript convert object chromatinassay conceptassay gener roxygen edit hand pleas edit document rdatar doctypedata nameblacklist_dm aliasblacklist_dm titlegenom blacklist region drosophila dm base format grang object sourc urlhttpsgithubcomboylelabblacklist doisz usag blacklist_dm descript genom blacklist region drosophila dm base conceptdata keyworddataset gener roxygen edit hand pleas edit document rvisualizationr nametileplot aliastileplot titleplot integr site per cell usag tileplot object region sep c tiles tilecel extendupstream extenddownstream assay null cell null groupbi null orderbi total ident null argument itemobjecta seurat object itemregiona set genom coordin show grang object string encod genom posit gene name vector string describ genom coordin gene name plot gene name suppli annot must present assay itemsepsepar use string encod genom coordin first element use separ chromosom coordin second element use separ start end coordin itemtilesizes slide window percel fragment tile plot itemtilecellsnumb cell display fragment inform tile plot itemextendupstreamnumb base extend region upstream itemextenddownstreamnumb base extend region downstream itemassaynam assay use itemcellswhich cell plot default cell itemgroupbynam group variabl group cell null use current cell ident itemorderbyopt determin cell chosen group option total random total select top cell base total number fragment region random select randomli itemidentslist cell ident includ plot null use ident valu return codelinkggplotggplot object descript plot presenceabs tn integr site cell within genom region exampl donttest fpath systemfileextdata fragmentstsvgz packagesignac fragment createfragmentobject path fpath cell colnamesatac_smal validatefrag fals fragmentsatac_smal fragment tileplotobject atac_smal region cchr conceptvisu gener roxygen edit hand pleas edit document rdatar doctypedata nameblacklist_dm aliasblacklist_dm titlegenom blacklist region drosophila dm base format grang object sourc urlhttpsgithubcomboylelabblacklist doisz usag blacklist_dm descript genom blacklist region drosophila dm base conceptdata keyworddataset gener roxygen edit hand pleas edit document rdatar doctypedata nameblacklist_c aliasblacklist_c titlegenom blacklist region c elegan ce base format grang object sourc urlhttpsgithubcomboylelabblacklist doisz usag blacklist_c descript genom blacklist region c elegan ce base conceptdata keyworddataset gener roxygen edit hand pleas edit document rgenericsr robjectsr namegetmotifdata aliasgetmotifdata aliasgetmotifdatamotif aliasgetmotifdatachromatinassay aliasgetmotifdataseurat titleretriev motif matrix usag getmotifdataobject methodgetmotifdatamotifobject slot data methodgetmotifdatachromatinassayobject slot data methodgetmotifdataseuratobject assay null slot data argument itemobjecta seurat object itemargu pass method itemslotinform pull object data pwm metadata itemassaywhich assay use default current activ assay valu return codelinkseuratobjectseurat object descript get motif matrix given assay exampl motifobj seuratgetassaydata object atac_smallpeak slot motif getmotifdataobject motifobj getmotifdataobject atac_smal conceptmotif gener roxygen edit hand pleas edit document rgrangesmethodsr namegrangesmethod aliasgrangesmethod aliasgrang aliasgrangeschromatinassaymethod aliasgrangesseuratmethod titleaccess genom rang chromatinassay object usag smethodgrangeschromatinassayx usenam true usemcol fals smethodgrangesseuratx usenam true usemcol fals argument itemxa codelinkchromatinassay object itemusenameswheth name genom rang propag return object itemusemcolsnot support codelinkchromatinassay object itemaddit argument valu return codelinkgenomicrangesgrang object descript method access codelinkgenomicrangesgrang object inform store codelinkchromatinassay object sectionfunct item item codegrangesseuratmethod method seurat object exampl grangesatac_smal seealso item itemlinkgenomicrangesgrang pkggenomicrang packag itemlinkchromatinassayclass conceptgrang gener roxygen edit hand pleas edit document rutilitiesr nameaddchromatinmodul aliasaddchromatinmodul titleadd chromatin modul usag addchromatinmoduleobject featur genom assay null verbos true argument itemobjecta seurat object itemfeaturesa name list featur includ modul name element list use name modul comput store object metadata itemgenomea bsgenom object itemassaynam assay use null use default assay itemverbosedisplay messag itemaddit argument pass coderunchromvar valu return seurat object descript comput chromvar deviat group peak goal function similar codelinkseurataddmodulescor except design singlecel chromatin data chromvar deviat group peak ad object metadata conceptutil gener roxygen edit hand pleas edit document rgenericsr robjectsr nameannot aliasannot aliasannot aliasannotationchromatinassay aliasannotationseurat aliasannotationchromatinassay aliasannotationseurat titleannot usag annotationobject annotationobject valu methodannotationchromatinassayobject methodannotationseuratobject methodannotationchromatinassayobject valu methodannotationseuratobject valu argument itemobjecta seurat object chromatinassay object itemargu pass method itemvaluea valu set null remov current annot inform codelinkgenomicrangesgrang object codegrang object suppli genom inform store assay genom new annot must match genom assay valu return codelinkgenomicrangesgrang object annot data present otherwis return null descript get annot chromatinassay exampl donttest annotationatac_smallpeak donttest annotationatac_smal gene annotationatac_smal annotationatac_smallpeak gene gene annotationatac_smal annotationatac_smal gene conceptassay gener roxygen edit hand pleas edit document rdatar doctypedata nameblacklist_hg_unifi aliasblacklist_hg_unifi titleunifi genom blacklist region human grch format grang object sourc urlhttpswwwencodeprojectorgfilesencfflfx doisz usag blacklist_hg_unifi descript manual curat genom blacklist region hg genom anshul kundaj anna shcherbina see urlhttpswwwencodeprojectorgfilesencfflfx descript blacklist curat author anshul kundaj anna shcherbina conceptdata keyworddataset gener roxygen edit hand pleas edit document rvisualizationr namepeakplot aliaspeakplot titleplot peak genom region usag peakplot object region assay null peak null groupbi null color dimgrey argument itemobjecta codelinkseuratobjectseurat object itemregiona genom region plot itemassaynam assay use null use default assay itempeaksa grang object contain peak coordin null use coordin store seurat object itemgroupbynam variabl featur metadata use rang seurat object genom rang metadata use suppli rang color rang null color metadata variabl itemcolorcolor use codegroupbi null custom color scale see exampl valu return codelinkggplotggplot object descript display genom rang codelinkchromatinassay object fall given genom region exampl donttest plot peak assay peakplotatac_smal region chr manual set color peakplotatac_smal region chr color red color variabl featur metadata peakplotatac_smal region chr groupbi count conceptvisu gener roxygen edit hand pleas edit document rirangesmethodsr namefindoverlapsmethod aliasfindoverlapsmethod aliasfindoverlap aliasfindoverlapsvectorchromatinassaymethod aliasfindoverlapschromatinassayvectormethod aliasfindoverlapschromatinassaychromatinassaymethod aliasfindoverlapsvectorseuratmethod aliasfindoverlapsseuratvectormethod aliasfindoverlapsseuratseuratmethod aliascountoverlapsvectorchromatinassaymethod aliascountoverlap aliascountoverlapschromatinassayvectormethod aliascountoverlapschromatinassaychromatinassaymethod aliascountoverlapsseuratvectormethod aliascountoverlapsvectorseuratmethod aliascountoverlapsseuratseuratmethod titlefind overlap rang chromatinassay object usag smethodfindoverlapsvectorchromatinassay queri subject maxgap l minoverlap l type cani start end within equal select call first last arbitrari ignorestrand fals smethodfindoverlapschromatinassayvector queri subject maxgap l minoverlap l type cani start end within equal select call first last arbitrari ignorestrand fals smethodfindoverlapschromatinassaychromatinassay queri subject maxgap l minoverlap l type cani start end within equal select call first last arbitrari ignorestrand fals smethodfindoverlapsvectorseurat queri subject maxgap l minoverlap l type cani start end within equal select call first last arbitrari ignorestrand fals smethodfindoverlapsseuratvector queri subject maxgap l minoverlap l type cani start end within equal select call first last arbitrari ignorestrand fals smethodfindoverlapsseuratseurat queri subject maxgap l minoverlap l type cani start end within equal select call first last arbitrari ignorestrand fals smethodcountoverlapsvectorchromatinassay queri subject maxgap l minoverlap l type cani start end within equal ignorestrand fals smethodcountoverlapschromatinassayvector queri subject maxgap l minoverlap l type cani start end within equal ignorestrand fals smethodcountoverlapschromatinassaychromatinassay queri subject maxgap l minoverlap l type cani start end within equal ignorestrand fals smethodcountoverlapsseuratvector queri subject maxgap l minoverlap l type cani start end within equal ignorestrand fals smethodcountoverlapsvectorseurat queri subject maxgap l minoverlap l type cani start end within equal ignorestrand fals smethodcountoverlapsseuratseurat queri subject maxgap l minoverlap l type cani start end within equal ignorestrand fals argument itemqueri subjecta codelinkchromatinassay object itemmaxgap minoverlap type select ignorestrandse codelinkgenomicrangesfindoverlap pkggenomicrang pkgirang packag valu see codelinkgenomicrangesfindoverlap descript codefindoverlap countoverlap method avail codelinkchromatinassay object allow find overlap genom rang rang store chromatinassay detail chromatinassay set default assay codelinkseuratobjectseurat object also call codefindoverlap directli seurat object sectionfunct item item codefindoverlapschromatinassayvectormethod method chromatinassay vector item codefindoverlapschromatinassaychromatinassaymethod method chromatinassay chromatinassay item codefindoverlapsvectorseuratmethod method vector seurat item codefindoverlapsseuratvectormethod method seurat vector item codefindoverlapsseuratseuratmethod method seurat seurat item codecountoverlapsvectorchromatinassaymethod method vector chromatinassay item codecountoverlapschromatinassayvectormethod method chromatinassay vector item codecountoverlapschromatinassaychromatinassaymethod method chromatinassay chromatinassay item codecountoverlapsseuratvectormethod method seurat vector item codecountoverlapsvectorseuratmethod method vector seurat item codecountoverlapsseuratseuratmethod method seurat seurat seealso item itemlinkirangesfindoverlapsmethod pkgirang packag itemlinkgenomicrangesfindoverlapsmethod pkggenomicrang packag itemlinkchromatinassayclass conceptoverlap gener roxygen edit hand pleas edit document rlinksr namegetlinkedpeak aliasgetlinkedpeak titleget peak link gene usag getlinkedpeaksobject featur assay null minabsscor argument itemobjecta seurat object itemfeaturesa list gene find link peak itemassaynam assay use null use default assay itemminabsscoreminimum absolut valu link score link return descript find peak link given set gene seealso getlinkedgen conceptlink gener roxygen edit hand pleas edit document rlinksr namegetlinkedgen aliasgetlinkedgen titleget gene link peak usag getlinkedgenesobject featur assay null minabsscor argument itemobjecta seurat object itemfeaturesa list peak find link gene itemassaynam assay use null use default assay itemminabsscoreminimum absolut valu link score link return descript find gene link given set peak seealso getlinkedpeak conceptlink gener roxygen edit hand pleas edit document rdatar doctypedata nameatac_smal aliasatac_smal titlea small exampl scatacseq dataset format seurat object follow assay describ itempeaksa peak x cell dataset itembinsa kb genom bin x cell dataset itemrnaa gene x cell dataset sourc urlhttpssupportxgenomicscomsinglecellatacdatasetsatac_v_pbmc_k usag atac_smal descript subset version x genom k human hg pbmc scatacseq dataset conceptdata keyworddataset gener roxygen edit hand pleas edit document rgenericsr rmotifsr nameaddmotif aliasaddmotif aliasaddmotifsdefault aliasaddmotifschromatinassay aliasaddmotifsseurat titleadd dna sequenc motif inform usag addmotifsobject methodaddmotifsdefaultobject genom pfm verbos true methodaddmotifschromatinassayobject genom pfm verbos true methodaddmotifsseuratobject genom pfm assay null verbos true argument itemobjecta seurat object chromatinassay object itemaddit argument pass method itemgenomea codebsgenom codednastringset codefafil string state genom build recogn codegetbsgenom itempfma codepfmatrixlist codepwmatrixlist object contain posit weightfrequ matric use itemverbosedisplay messag itemassaynam assay use null use default assay valu run codechromatinassay codeseurat object return modifi version input object run matrix return codemotif object descript construct codelinkmotif object contain dna sequenc motif inform add exist seurat object chromatinassay run seurat object codeaddmotif also run codelinkregionstat comput gc content peak store result featur metadata conceptmotif gener roxygen edit hand pleas edit document rgenericsr rmotifsr namerunchromvar aliasrunchromvar aliasrunchromvarchromatinassay aliasrunchromvarseurat titlerun chromvar usag runchromvarobject methodrunchromvarchromatinassayobject genom motifmatrix null verbos true methodrunchromvarseurat object genom motifmatrix null assay null newassaynam chromvar argument itemobjecta seurat object itemaddit argument pass codelinkchromvargetbackgroundpeak itemgenomea codebsgenom codednastringset codefafil string state genom build recogn codegetbsgenom itemmotifmatrixa peak x motif matrix null pull peak x motif matrix motif object store assay itemverbosedisplay messag itemassaynam assay use itemnewassaynamenam new assay use store chromvar result default chromvar valu return codelinkseuratobjectseurat object new assay descript wrapper run codelinkchromvarchromvar assay motif object present return new seurat assay motif activ deviat chromatin access across set region new assay detail see chromvar document inform urlhttpsgreenleaflabgithubiochromvarindexhtml see chromvar paper urlhttpswwwnaturecomarticlesnmeth exampl dontrun librarybsgenomehsapiensucschg runchromvarobject atac_smallpeak genom bsgenomehsapiensucschg dontrun librarybsgenomehsapiensucschg runchromvarobject atac_smal genom bsgenomehsapiensucschg conceptmotif gener roxygen edit hand pleas edit document rgenericsr rpreprocessingr namebinarizecount aliasbinarizecount aliasbinarizecountsdefault aliasbinarizecountsassay aliasbinarizecountsseurat titlebinar count usag binarizecountsobject methodbinarizecountsdefaultobject assay null verbos true methodbinarizecountsassayobject assay null verbos true methodbinarizecountsseuratobject assay null verbos true argument itemobjecta seurat object itemargu pass method itemassaynam assay use list assay binar appli itemverbosedisplay messag valu return codelinkseuratobjectseurat object descript set count count matrix exampl x matrixdata sampl size replac true ncol binarizecountsx binarizecountsatac_smallpeak binarizecountsatac_smal conceptpreprocess gener roxygen edit hand pleas edit document rfragmentsr namecountfrag aliascountfrag titlecount fragment usag countfragmentsfrag cell null max_lin null verbos true argument itemfragmentspath fragment file itemcellscel includ null includ cell itemmax_linesmaximum number line read fragment file null read line file itemverbosedisplay messag valu return datafram descript count total fragment per cell barcod present fragment file exampl fpath systemfileextdata fragmentstsvgz packagesignac count countfragmentsfrag fpath conceptfrag gener roxygen edit hand pleas edit document rutilitiesr nameaveragecount aliasaveragecount titleaverag count usag averagecountsobject assay null groupbi null verbos true argument itemobjecta seurat object itemassaynam assay use default activ assay itemgroupbygroup variabl use default activ ident itemverbosedisplay messag valu return datafram descript comput mean count per group cell given assay exampl averagecountsatac_smal conceptutil gener roxygen edit hand pleas edit document rutilitiesr namesubsetmatrix aliassubsetmatrix titlesubset matrix row column usag subsetmatrix mat minrow mincol maxrowv maxcolv null argument itemmata matrix itemminrowsminimum number nonzero element row retain itemmincolsminimum number nonzero element column retain itemmaxrowvalmaximum allow valu row row retain null dont set limit itemmaxcolvalmaximum allow valu column column retain null dont set limit valu return matrix descript subset row column matrix remov row column less specifi number nonzero element exampl subsetmatrixmat volcano conceptutil gener roxygen edit hand pleas edit document rutilitiesr namestringtograng aliasstringtograng titlestr grang usag stringtograngesregion sep c argument itemregionsvector genom region string itemsepvector separ use genom string first element use separ chromosom coordin second separ use separ start end coordin itemaddit argument pass codelinkgenomicrangesmakegrangesfromdatafram valu return grang object descript convert genom coordin string grang object exampl region cchr chr stringtograngesregion region conceptutil gener roxygen edit hand pleas edit document rquantificationr namegenomebinmatrix aliasgenomebinmatrix titlegenom bin matrix usag genomebinmatrix fragment genom cell null binsiz process_n sep c verbos true argument itemfragmentspath tabixindex fragment file list codelinkfrag object itemgenomea vector chromosom size genom use construct genom bin coordin obtain call codelinkgenomeinfodbseqlength codelinkbsgenomebsgenomeclass object itemcellsvector cell includ null includ cell found fragment file itembinsizes genom bin use itemprocess_nnumb region load memori time per thread process region faster use memori itemsepvector separ use genom string first element use separ chromosom coordin second separ use separ start end coordin itemverbosedisplay messag valu return spars matrix descript construct bin x cell matrix fragment file detail function bin genom call codelinkfeaturematrix construct bin x cell matrix exampl donttest genom namesgenom chr fpath systemfileextdata fragmentstsvgz packagesignac fragment createfragmentobjectfpath genomebinmatrix fragment fragment genom genom binsiz conceptquantif gener roxygen edit hand pleas edit document rutilitiesr namegetcellsinregion aliasgetcellsinregion titleget cell region usag getcellsinregiontabix region cell null argument itemtabixtabix object itemregiona string give region extract fragment file itemcellsvector cell includ output null includ cell valu return list descript extract cell name contain read map within given genom region exampl fpath systemfileextdata fragmentstsvgz packagesignac getcellsinregiontabix fpath region chr conceptutil gener roxygen edit hand pleas edit document rpreprocessingr namenucleosomesign aliasnucleosomesign titlenucleosomesign usag nucleosomesign object assay null n ncolobject verbos true argument itemobjecta seurat object itemassaynam assay use requir fragment path provid null use activ assay itemnnumb line read fragment file null read line default scale number cell object itemverbosedisplay messag itemargu pass function valu return codelinkseuratobjectseurat object ad metadata ratio mononucleosom nucleosomefre fragment per cell percentil rank ratio descript calcul strength nucleosom signal per cell comput ratio fragment bp bp mononucleosom fragment bp nucleosomefre exampl fpath systemfileextdata fragmentstsvgz packagesignac fragmentsatac_smal createfragmentobject path fpath cell colnamesatac_smal toler nucleosomesignalobject atac_smal conceptqc gener roxygen edit hand pleas edit document rfootprintingr namegetfootprintdata aliasgetfootprintdata titleget footprint data usag getfootprintdata object featur assay null groupbi null ident null argument itemobjecta seurat object itemfeaturesa vector featur extract data itemassaynam assay use itemgroupbya group variabl itemidentsset ident group cell valu return matrix descript extract footprint data set transcript factor metafeatur function pull access data given featur eg tf perform background normal ident class data that use creat tf footprint plot codeplotfootprint function conceptfootprint gener roxygen edit hand pleas edit document rgenericsr robjectsr namemotif aliasmotif aliasmotif aliasmotifschromatinassay aliasmotifsseurat aliasmotifschromatinassay aliasmotifsseurat titleget set motif inform usag motifsobject motifsobject valu methodmotifschromatinassayobject methodmotifsseuratobject methodmotifschromatinassayobject valu methodmotifsseuratobject valu argument itemobjecta seurat object itemargu pass method itemvaluea codelinkmotif object descript get set motif object seurat object chromatinassay exampl motifsatac_smallpeak motifsatac_smal motif motifsatac_smal motifsatac_smallpeak motif motif motifsatac_smal motifsatac_smal motif conceptassay conceptmotif gener roxygen edit hand pleas edit document rvisualizationr namevariantplot aliasvariantplot titleplot strand concord vs vmr usag variantplot variant mincel concordancethreshold vmrthreshold argument itemvariantsa datafram contain variant inform comput use codelinkidentifyvari itemmincellsminimum number highconfid cell detect variant variant display itemconcordancethresholdstrand concord threshold itemvmrthresholdmeanvari ratio threshold descript plot pearson correl allel frequenc strand versu log meanvari ratio allel conceptmito conceptvisu gener roxygen edit hand pleas edit document rgenericsr rpeaksr namecallpeak aliascallpeak aliascallpeaksseurat aliascallpeakschromatinassay aliascallpeaksfrag aliascallpeaksdefault titlecal peak usag callpeaksobject methodcallpeaksseurat object assay null groupbi null ident null macspath null broad fals format bed outdir tempdir fragmenttempdir tempdir combinepeak true effectivegenomes e extsiz shift extsiz additionalarg null name projectobject cleanup true verbos true methodcallpeakschromatinassay object macspath null outdir tempdir broad fals format bed effectivegenomes e extsiz shift extsiz additionalarg null name mac cleanup true verbos true methodcallpeaksfrag object macspath null outdir tempdir broad fals format bed effectivegenomes e extsiz shift extsiz additionalarg null name mac cleanup true verbos true methodcallpeaksdefault object macspath null outdir tempdir broad fals format bed effectivegenomes e extsiz shift extsiz additionalarg null name mac cleanup true verbos true argument itemobjecta seurat object chromatinassay object fragment object path fragment file itemargu pass method itemassaynam assay use itemgroupbygroup variabl use set peak call independ group cell combin note call peak use subset cell first split fragment file use use group variabl requir extra time split file perform multipl mac peak call store addit file ondisk may larg note store split fragment file temp directori codelinkbasetempdir default program interrupt complet temporari file remov null peak call use cell togeth pseudobulk itemidentslist ident includ group cell valid also set codegroupbi paramet null peak call cell ident itemmacspathpath mac program null tri find mac automat itembroadcal broad peak codebroad paramet mac itemformatfil format use either bed bedp see mac document itemoutdirpath output file itemfragmenttempdirpath write temporari fragment file use codegroupbi null itemcombinepeakscontrol whether peak call differ group cell combin use codegenomicrangesreduc call peak differ group cell codegroupbi paramet fals list codegrang object return note metadata field pvalu qvalu foldchang inform peak lost combin peak itemeffectivegenomesizeeffect genom size paramet mac codeg default human effect genom size e itemextsizecodeexts paramet mac relev formatb itemshiftcodeshift paramet mac relev formatb itemadditionalargsaddit argument pass mac singl charact string itemnamenam output mac file also place codenam field grang output itemcleanupremov mac output file itemverbosedisplay messag valu return codelinkgenomicrangesgrang object descript call peak use mac fragment file link specifi assay use call peak multipl fragment file present use singl mac invoc return codenarrowpeak mac output codegrang object detail see urlhttpsmacsprojectgithubiomac mac document call peak use mac pleas cite doigbr conceptquantif gener roxygen edit hand pleas edit document rfragmentsr namecellsfrag aliascellsfrag aliascellsfrag titleset get cell barcod inform codelinkfrag object usag methodcellsfragmentx methodcellsfragmentx valu argument itemxa fragment object itemargu pass method itemvaluea vector cell name store codelinkfrag object descript return name cell object contain fragment file cell barcod may match barcod present fragment file codelinkfrag object contain intern map cell name codelinkchromatinassay object cell name fragment file cell name chang assay without need chang cell name disk detail access cell name store fragment file use codegetfragmentdataobject x name cell conceptfrag gener roxygen edit hand pleas edit document rvisualizationr namebigwigtrack aliasbigwigtrack titleplot data bigwig usag bigwigtrack region bigwig smooth type coverag y_label score maxdownsampl downsampler argument itemregiongrang object specifi region plot itembigwigpath bigwig file itemsmoothnumb base smooth data roll mean null appli smooth itemtypeplot type one line heatmap coverag itemy_labelyaxi label itemmaxdownsampleminimum number posit kept downsampl downsampl rate adapt window size paramet set minimum possibl number posit includ plot becom spars window size small itemdownsampleratefract posit retain downsampl retain posit give higherresolut plot make number point larg result larger file size save plot longer period time need draw plot descript creat bigwig track note function work window conceptvisu gener roxygen edit hand pleas edit document rdimension_reductionr namejaccard aliasjaccard titlecalcul jaccard index two matric usag jaccardx argument itemxth first matrix itemyth second matrix valu return matrix descript find jaccard similar row two matric note matric must binari row zero total count result nan entri could caus problem downstream analys detail calcul raw jaccard index without normal expect similar cell due differ sequenc depth exampl x matrixdata samplec size replac true ncol jaccardx x x conceptdimension_reduct gener roxygen edit hand pleas edit document rutilitiesr namefractioncountsinregion aliasfractioncountsinregion titlefract count genom region usag fractioncountsinregionobject region assay null argument itemobjecta seurat object itemregionsa grang object contain set genom region itemassaynam assay use itemaddit argument pass codelinkcountsinregion valu return numer vector descript find fraction count per cell overlap given set genom rang exampl dontrun fractioncountsinregion object atac_smal assay bin region blacklist_hg conceptutil gener roxygen edit hand pleas edit document rgenericsr robjectsr namesetmotifdata aliassetmotifdata aliassetmotifdatamotif aliassetmotifdatachromatinassay aliassetmotifdataseurat titleset motif data usag setmotifdataobject methodsetmotifdatamotifobject slot newdata methodsetmotifdatachromatinassayobject slot newdata methodsetmotifdataseuratobject assay null argument itemobjecta seurat object itemargu pass method itemslotnam slot use itemnewdatamotif matrix add matrix spars matrix class itemassaynam assay whose data set valu return codelinkseuratobjectseurat object descript set motif matrix given assay exampl motifobj seuratgetassaydata object atac_smallpeak slot motif setmotifdataobject motifobj slot data newdata matrix setmotifdata object atac_smallpeak slot data newdata matrix motifmatrix getmotifdataobject atac_smal setmotifdata object atac_smal assay peak slot data newdata motifmatrix conceptmotif gener roxygen edit hand pleas edit document rgenericsr robjectsr namefrag aliasfrag aliasfrag aliasfragmentschromatinassay aliasfragmentsseurat aliasfragmentschromatinassay aliasfragmentsseurat titleget fragment object usag fragmentsobject fragmentsobject valu methodfragmentschromatinassayobject methodfragmentsseuratobject methodfragmentschromatinassayobject valu methodfragmentsseuratobject valu argument itemobjecta seurat object chromatinassay object itemargu pass method itemvaluea codelinkfrag object list fragment object valu return list codelinkfrag object fragment object present return empti list descript get fragment object exampl fragmentsatac_smallpeak fragmentsatac_smal fpath systemfileextdata fragmentstsvgz packagesignac fragment createfragmentobject path fpath cell colnamesatac_smal validatefrag fals fragmentsatac_smallbin fragment fpath systemfileextdata fragmentstsvgz packagesignac fragment createfragmentobject path fpath cell colnamesatac_smal validatefrag fals fragmentsatac_smal fragment conceptassay conceptfrag gener roxygen edit hand pleas edit document rvisualizationr namecombinetrack aliascombinetrack titlecombin genom region plot usag combinetracksplotlist expressionplot null height null width null argument itemplotlista list plot combin must genom region itemexpressionplotplot contain gene express inform suppli place left coverag track align track itemheightsrel height plot null first plot x height track itemwidthsrel width plot requir ad gene express panel null main plot x width gene express panel valu return patchwork ggplot object descript use combin coverag plot peak region plot gene annot plot link element plot differ track stack top xaxi combin exampl donttest p peakplotatac_smal region chr p annotationplotatac_smal region chr combinetracksplotlist listp p height c conceptvisu gener roxygen edit hand pleas edit document rquantificationr namefeaturematrix aliasfeaturematrix titlefeatur matrix usag featurematrix fragment featur cell null process_n sep c verbos true argument itemfragmentsa list codelinkfrag object note set codecel paramet request cell present suppli codefrag object howev cell inform fragment object set codecellsfrag codenul fragment object still search itemfeaturesa grang object contain set genom interv form row matrix entri record number uniqu read fall genom region cell itemcellsvector cell includ null includ cell found fragment file itemprocess_nnumb region load memori time per thread process region faster use memori itemsepvector separ use genom string first element use separ chromosom coordin second separ use separ start end coordin itemverbosedisplay messag valu return spars matrix descript construct featur x cell matrix genom fragment file exampl fpath systemfileextdata fragmentstsvgz packagesignac fragment createfragmentobjectfpath featurematrix fragment fragment featur grangesatac_smal conceptquantif gener roxygen edit hand pleas edit document rfragmentsr namevalidatecel aliasvalidatecel titlevalid cell present fragment file usag validatecel object cell null toler maxlin e verbos true argument itemobjecta codelinkfrag object itemcellsa charact vector contain cell barcod search null use cell store fragment object itemtolerancefract input cell unseen return true exampl codetoler return true cell observ fragment file use cell present much fewer total count would requir extens search fragment cell found itemmaxlinesmaximum number line read without find requir number cell return fals set valu avoid search whole file becom clear expect cell present set valu null enabl exhaust search entir file itemverbosedisplay messag descript search fragment cell exist fragment file iter chunk fragment file least one fragment cell barcod request found conceptfrag gener roxygen edit hand pleas edit document rmitor namefindclonotyp aliasfindclonotyp titlefind clonotyp usag findclonotyp object assay null featur null metric cosin resolut k algorithm argument itemobjecta seurat object itemassaynam assay use itemfeaturesfeatur includ construct neighbor graph itemmetricdist metric use itemresolutionclust resolut use see codelinkseuratfindclust itemkpass codekparam argument codelinkseuratfindneighbor itemalgorithmcommun detect algorithm use see codelinkseuratfindclust valu return codelinkseuratobjectseurat object descript identifi group relat cell allel frequenc data cluster cell base allel frequenc reorder factor level cluster ident hierarch cluster collaps pseudobulk cluster allel frequenc set variabl featur allel frequenc assay order featur defin hierarch cluster conceptmito gener roxygen edit hand pleas edit document rdatar doctypedata nameblacklist_hg aliasblacklist_hg titlegenom blacklist region human grch format grang object sourc urlhttpsgithubcomboylelabblacklist doisz usag blacklist_hg descript genom blacklist region human grch conceptdata keyworddataset gener roxygen edit hand pleas edit document rmitor nameclusterclonotyp aliasclusterclonotyp titlefind relationship clonotyp usag clusterclonotypesobject assay null groupbi null argument itemobjecta seurat object itemassaynam assay use itemgroupbygroup variabl cell valu return list contain two object class codelinkstatshclust one cell cluster one featur allel cluster descript perform hierarch cluster clonotyp data conceptmito gener roxygen edit hand pleas edit document rutilitiesr nameclosestfeatur aliasclosestfeatur titleclosest featur usag closestfeatureobject region annot null argument itemobjecta seurat object itemregionsa set genom region queri itemannotationa grang object contain annot inform null use annot store object itemaddit argument pass codelinkstringtograng valu return datafram name region closest featur annot distanc featur descript find closest featur given set genom region exampl donttest closestfeatur object atac_smal region headgrangesatac_smal conceptutil gener roxygen edit hand pleas edit document rgenericsr rmotifsr nameconvertmotifid aliasconvertmotifid aliasconvertmotifiddefault aliasconvertmotifidmotif aliasconvertmotifidchromatinassay aliasconvertmotifidseurat titleconvert motif name motif id usag convertmotifidobject methodconvertmotifiddefaultobject name id methodconvertmotifidmotifobject methodconvertmotifidchromatinassayobject methodconvertmotifidseuratobject assay null argument itemobjecta seurat chromatinassay motif object itemargu pass method itemnamea vector motif name itemida vector motif id one codenam codeid suppli itemassayfor codeseurat object name assay use null use default assay valu return charact vector length order input name id found store codena descript convert motif name motif id vice versa convert common name id use codenam paramet convert id common name use codeid paramet conceptmotif gener roxygen edit hand pleas edit document robjectsr doctypeclass namechromatinassayclass aliaschromatinassayclass aliaschromatinassay titleth chromatinassay class descript chromatinassay object extend codelinkseuratobjectassay storag analysi singlecel chromatin data sectionslot describ itemcoderangesa codelinkgenomicrangesgrang object describ genom locat featur object itemcodemotifsa codelinkmotif object itemcodefragmentsa list codelinkfrag object itemcodeseqinfoa codelinkgenomeinfodbseqinfo object contain basic inform genom sequenc use itemcodeannotationa codelinkgenomicrangesgrang object contain genom annot itemcodebiasa vector contain tn integr bia inform frequenc tn integr differ kmer itemcodepositionenrichmenta name list matric contain posit enrich score tn integr exampl enrich tss itemcodelinksa codelinkgenomicrangesgrang object describ link genom posit coaccess site enhancergen regulatori relationship codegrang object start end coordin two link genom posit must contain score metadata column conceptassay gener roxygen edit hand pleas edit document rutilitiesr namegetintersectingfeatur aliasgetintersectingfeatur titlefind intersect region two object usag getintersectingfeatur object object assay null assay null distanc verbos true argument itemobjectth first seurat object itemobjectth second seurat object itemassaynam assay use first object null use default assay itemassaynam assay use second object null use default assay itemdistancemaximum distanc region allow intersect record default itemverbosedisplay messag valu return list two charact vector contain row name object overlap descript intersect region store rownam two object return vector contain name row intersect object order row name return correspond intersect region ie nth featur first vector intersect nth featur second vector distanc paramet given case featur within given distanc call intersect exampl getintersectingfeatur object atac_smal object atac_smal assay peak assay bin conceptutil gener roxygen edit hand pleas edit document rmitor namereadmgatk aliasreadmgatk titleread mgatk output usag readmgatkdir verbos true argument itemdirpath directori contain mgatk output file itemverbosedisplay messag valu return list contain spars matrix count two datafram depth refallel spars matrix contain read count base posit strand depth datafram contain total depth cell refallel datafram contain refer genom allel posit descript read output file mgatk urlhttpsgithubcomcaleblareaumgatk exampl dontrun datadir systemfileextdata test_mgatk packagesignac mgatk readmgatkdir datadir conceptmito gener roxygen edit hand pleas edit document rvisualizationr namedepthcor aliasdepthcor titleplot sequenc depth correl usag depthcorobject assay null reduct lsi n argument itemobjecta codelinkseuratobjectseurat object itemassaynam assay use sequenc depth null use default assay itemreductionnam dimens reduct store input object itemnnumb compon use codenul use compon itemaddit argument pass codelinkstatscor valu return codelinkggplotggplot object descript comput correl total count reduc dimens compon exampl donttest depthcorobject atac_smal conceptvisu gener roxygen edit hand pleas edit document rgenericsr rmitor nameallelefreq aliasallelefreq aliasallelefreqdefault aliasallelefreqassay aliasallelefreqseurat titlecomput allel frequenc per cell usag allelefreqobject methodallelefreqdefaultobject variant methodallelefreqassayobject variant methodallelefreqseuratobject variant assay null newassaynam allel argument itemobjecta seurat object assay matrix itemargu pass method itemvariantsa charact vector inform variant keep exampl codecgagagaga itemassaynam assay use itemnewassaynamenam new assay store variant data valu return codelinkseuratobjectseurat object new assay contain allel frequenc inform variant descript collaps allel count strand normal total number count nucleotid posit conceptmito gener roxygen edit hand pleas edit document rutilitiesr nameaccessiblepeak aliasaccessiblepeak titleaccess peak usag accessiblepeak object assay null ident null cell null mincel argument itemobjecta seurat object itemassaynam assay use itemidentsa set ident class find access peak itemcellsa vector cell find access peak itemmincellsminimum number cell peak access count peak call access valu return vector peak name descript find access peak set cell conceptutil gener roxygen edit hand pleas edit document rutilitiesr nameintersectmatrix aliasintersectmatrix titleintersect genom coordin matrix row usag intersectmatrix matrix region invert fals sep c verbos true argument itemmatrixa matrix genom region row itemregionsa set genom region intersect region matrix either vector string encod genom coordin grang object iteminvertdiscard row intersect genom region suppli rather retain itemsepa length charact vector contain separ use extract genom coordin string first element use separ chromosom name coordin second element use separ start end coordin itemverbosedisplay messag itemaddit argument pass codelinkirangesfindoverlap valu return spars matrix descript remov retain matrix row intersect given genom region exampl count matrixdata rep ncol rownamescount cchrchr chrchr chrchr intersectmatrixmatrix count region blacklist_hg conceptutil gener roxygen edit hand pleas edit document rutilitiesr namegeneact aliasgeneact titlecr gene activ matrix usag geneact object assay null featur null extendupstream extenddownstream biotyp protein_cod maxwidth e geneid fals verbos true argument itemobjecta seurat object itemassaynam assay use null use default assay itemfeaturesgen includ null use proteincod gene annot store object itemextendupstreamnumb base extend upstream tss itemextenddownstreamnumb base extend downstream tt itembiotypesgen biotyp includ null use biotyp gene annot itemmaxwidthmaximum allow gene width gene quantifi set paramet avoid quantifi extrem long transcript add rel long amount time null filter gene base width itemgeneidrecord gene id output matrix rather gene name itemverbosedisplay messag itemaddit option pass codelinkfeaturematrix valu return spars matrix descript comput count per cell gene bodi promot region exampl fpath systemfileextdata fragmentstsvgz packagesignac fragment createfragmentobject path fpath cell colnamesatac_smal validatefrag fals fragmentsatac_smal fragment geneactivityatac_smal conceptutil gener roxygen edit hand pleas edit document rutilitiesr nameunifypeak aliasunifypeak titleunifi genom rang usag unifypeaksobjectlist mode reduc argument itemobjectlista list seurat object chromatinassay object itemmodefunct use combin genom rang reduc default disjoin see codelinkgenomicrangesreduc codelinkgenomicrangesdisjoin inform function valu return grang object descript creat unifi set nonoverlap genom rang multipl seurat object contain singlecel chromatin data exampl unifypeaksobjectlist listatac_smal atac_smal conceptpreprocess conceptutil gener roxygen edit hand pleas edit document rvisualizationr nametheme_brows aliastheme_brows titlegenom browser theme usag theme_brows legend true argument itemaddit argument itemlegenddisplay plot legend descript theme appli panel codelinkcoverageplot function exampl donttest peakplotatac_smal region chr theme_brows conceptvisu gener roxygen edit hand pleas edit document rfragmentsr namesplitfrag aliassplitfrag titlesplit fragment file cell ident usag splitfrag object assay null groupbi null ident null outdir getwd filesuffix append true buffer_length l verbos true argument itemobjecta seurat object itemassaynam assay use itemgroupbynam group variabl group cell itemidentslist ident includ itemoutdirdirectori write output file itemfilesuffixsuffix add file name file extens split multipl fragment file without codeappend option set true addit numer suffix ad file eg itemappendif split multipl fragment file append cell group eg cluster file note caus output file unsort itembuffer_lengths buffer read fragment file must longer longest line file itemverbosedisplay messag descript split fragment file separ file group cell split multipl fragment file contain common cell type fragment origin differ file append file one group cell ident conceptfrag gener roxygen edit hand pleas edit document rpreprocessingr namedownsamplefeatur aliasdownsamplefeatur titledownsampl featur usag downsamplefeaturesobject assay null n verbos true argument itemobjecta seurat object itemassaynam assay use default activ assay itemnnumb featur retain default itemverbosedisplay messag valu return codelinkseuratobjectseurat object codelinkseuratobjectvariablefeatur set randomli sampl featur descript randomli downsampl featur assign variablefeatur object select n featur random exampl downsamplefeaturesatac_smal n conceptpreprocess gener roxygen edit hand pleas edit document robjectsr namesubsetmotif aliassubsetmotif aliassubset aliasmotif titlesubset motif object usag methodsubsetmotifx featur null motif null methodmotifx j argument itemxa motif object itemfeatureswhich featur retain itemmotifswhich motif retain itemargu pass method itemiwhich column retain itemjwhich row retain valu return subset codelinkmotif object descript return subset codelinkmotifclass object exampl motifobj seuratgetassaydata object atac_smallpeak slot motif subsetx motifobj featur headrownamesmotifobj motifobj seuratgetassaydata object atac_smal assay peak slot motif motifobj seealso codelinkbasesubset conceptmotif gener roxygen edit hand pleas edit document rdatar doctypedata nameblacklist_mm aliasblacklist_mm titlegenom blacklist region mous mm base format grang object sourc urlhttpsgithubcomboylelabblacklist doisz usag blacklist_mm descript genom blacklist region mous mm base conceptdata keyworddataset gener roxygen edit hand pleas edit document rzzzr doctypepackag namesignacpackag aliassignac aliassignacpackag titlesignac analysi singlecel chromatin data descript framework analysi explor singlecel chromatin data signac packag contain function quantifi singlecel chromatin data comput percel qualiti control metric dimens reduct normal visual dna sequenc motif analysi refer stuart et al doi seealso use link item item urlhttpsgithubcomtimoastsignac item urlhttpssatijalaborgsignac item report bug urlhttpsgithubcomtimoastsignacissu author strongmaintain tim stuart emailtstuartnygenomeorg hrefhttpsorcidorgorcid author item item avi srivastava emailasrivastavanygenomeorg hrefhttpsorcidorgorcid contributor item item paul hoffman emailphoffmannygenomeorg hrefhttpsorcidorgorcid contributor item rahul satija emailrsatijanygenomeorg hrefhttpsorcidorgorcid contributor gener roxygen edit hand pleas edit document rgenericsr rfootprintingr namefootprint aliasfootprint aliasfootprintchromatinassay aliasfootprintseurat titletranscript factor footprint analysi usag footprintobject methodfootprintchromatinassay object genom motifnam null key motifnam region null assay null upstream downstream computeexpect true inpeak fals verbos true methodfootprintseurat object genom region null motifnam null assay null upstream downstream inpeak fals verbos true argument itemobjecta seurat chromatinassay object itemargu pass method itemgenomea codelinkbsgenomebsgenom object itemmotifnamenam motif store assay footprint suppli must suppli set region itemkeykey store posit enrich inform itemregionsa set genom rang contain motif instanc itemassaynam assay use itemupstreamnumb base extend upstream itemdownstreamnumb base extend downstream itemcomputeexpectedfind expect number insert posit given local dna sequenc context insert bia tn iteminpeaksrestrict motif fall peak itemverbosedisplay messag valu return codelinkseuratobjectseurat object descript comput normal observedexpect tn insert frequenc posit surround set motif instanc conceptfootprint gener roxygen edit hand pleas edit document rutilitiesr nameextend aliasextend titleextend usag extendx upstream downstream frommidpoint fals argument itemxa rang itemupstreamlength extend upstream itemdownstreamlength extend downstream itemfrommidpointcount base region midpoint rather end upstream downstream respect valu return codelinkgenomicrangesgrang object descript resiz genomicrang upstream downstream urlhttpssupportbioconductororgp exampl extendx blacklist_hg upstream downstream conceptutil gener roxygen edit hand pleas edit document robjectsr namegetfragmentdata aliasgetfragmentdata titleget fragment object data usag getfragmentdataobject slot path argument itemobjecta codelinkfrag object itemslotinform pull object path hash cell prefix suffix descript extract data codelinkfragmentclass object conceptassay gener roxygen edit hand pleas edit document rdifferential_accessibilityr rfragmentsr doctypeimport namereexport aliasreexport aliasfoldchang aliascel titleobject export packag keywordintern descript object import packag follow link see document describ itemseuratcodelinkseuratfoldchang itemseuratobjectcodelinkseuratobjectcel gener roxygen edit hand pleas edit document rvisualizationr namecoveragebrows aliascoveragebrows titlegenom browser usag coveragebrowserobject region assay null sep c argument itemobjecta seurat object itemregiona set genom coordin itemassaynam assay use itemsepsepar genom coordin region suppli string rather grang object itemparamet pass codelinkcoverageplot valu return list ggplot object descript interact version codelinkcoverageplot function allow alter genom posit interact current view time save list codelinkggplotggplot object use save plot button list plot return end browser press done button conceptvisu gener roxygen edit hand pleas edit document rgenericsr rpreprocessingr nameruntfidf aliasruntfidf aliasruntfidfdefault aliasruntfidfassay aliasruntfidfseurat titlecomput termfrequ inversedocumentfrequ usag runtfidfobject methodruntfidfdefault object assay null method scalefactor idf null verbos true methodruntfidfassay object assay null method scalefactor idf null verbos true methodruntfidfseurat object assay null method scalefactor idf null verbos true argument itemobjecta seurat object itemargu pass method itemassaynam assay use itemmethodwhich tfidf implement use choic item item tfidf implement use stuart butler et al doi comput eqnlogtf time idf item tfidf implement use cusanovich hill et al doijcel comput eqntf time logidf item logtf method use andrew hill comput eqnlogtf time logidf item x genom method tf normal comput eqnidf itemscalefactorwhich scale factor use default itemidfa precomput idf vector use null comput base input data matrix itemverboseprint progress valu return codelinkseuratobjectseurat object descript run term frequenc invers document frequenc tfidf normal matrix detail four differ tfidf method implement recommend use method default exampl mat matrixdata rbinomn size prob nrow runtfidfobject mat runtfidfatac_smallpeak runtfidfobject atac_smal refer urlhttpsenwikipediaorgwikilatent_semantic_analysislatent_semantic_index conceptpreprocess gener roxygen edit hand pleas edit document rfragmentsr nameupdatepath aliasupdatepath titleupd file path fragment object usag updatepathobject newpath verbos true argument itemobjecta codelinkfrag object itemnewpathpath fragment file itemverbosedisplay messag descript chang path fragment file store codelinkfrag object path must file use creat fragment object md hash comput use new path compar hash store fragment object verifi file conceptfrag gener roxygen edit hand pleas edit document robjectsr namecreatemotifobject aliascreatemotifobject titlecr motif object usag createmotifobject data null pwm null motifnam null posit null metadata null argument itemdataa motif x region matrix itempwma name list posit weight matric posit frequenc matric match motif name codedata class pfmatrixlist itemmotifnamesa name list motif name list element name must match name given codepwm null use name list posit weight posit frequenc matric use set altern common name motif pfmatrixlist pass codepwm pull motif name pfmatrixlist itempositionsa codelinkgenomicrangesgrangeslist object contain exact posit motif itemmetadataa datafram contain metadata valu return codelinkmotif object descript creat codelinkmotifclass object exampl motifmatrix matrix data samplec size replac true ncol motif createmotifobjectdata motifmatrix conceptmotif gener roxygen edit hand pleas edit document robjectsr doctypeclass namefragmentclass aliasfragmentclass aliasfrag titleth fragment class descript fragment class design hold inform need work fragment file sectionslot describ itemcodepathpath fragment file disk see urlhttpssupportxgenomicscomsinglecellatacsoftwarepipelineslatestoutputfrag itemcodehasha vector two mdsum first element mdsum fragment file second element mdsum index itemcodecellsa name vector cell element cell barcod appear fragment file name element correspond cell barcod store chromatinassay object conceptfrag gener roxygen edit hand pleas edit document rlinksr namelinkpeak aliaslinkpeak titlelink peak gene usag linkpeak object peakassay expressionassay expressionslot data genecoord null distanc e mindist null mincel method pearson genesus null n_sampl pvalue_cutoff score_cutoff geneid fals verbos true argument itemobjecta seurat object itempeakassaynam assay contain peak inform itemexpressionassaynam assay contain gene express inform itemexpressionslotnam slot pull express data itemgenecoordsgrang object contain coordin gene express assay null extract gene annot store assay itemdistancedist threshold peak includ regress model itemmindistanceminimum distanc peak tss includ regress model null default minimum distanc use itemmincellsminimum number cell posit peak gene need includ result itemmethodwhich correl coeffici comput pearson default spearman kendal itemgenesusegen test null determin express assay itemn_samplenumb peak sampl random comput null distribut itempvalue_cutoffminimum pvalu requir retain link link pvalu equal greater valu remov output itemscore_cutoffminimum absolut valu correl coeffici link retain itemgeneidset true gene express assay name use gene id rather gene name itemverbosedisplay messag valu return seurat object codelink inform set codelinkgenomicrangesgrang object access via codelinklink function follow inform item itemscor correl coeffici access peak express gene itemzscor zscore correl coeffici comput base distribut correl coeffici set background peak itempvalu pvalu associ zscore link itemgen name link gene itempeak name link peak descript find peak correl express nearbi gene gene function comput correl coeffici gene express access peak within given distanc gene tss comput expect correl coeffici peak given gc content access length peak expect coeffici valu peak use comput zscore pvalu detail function inspir method origin describ shareseq sai et al cell pleas consid cite origin shareseq work use function doijcel conceptlink gener roxygen edit hand pleas edit document rirangesmethodsr nameinterrangemethod aliasinterrangemethod aliasrang aliasrangechromatinassaymethod aliasrangeseuratmethod aliasreducechromatinassaymethod aliasreduc aliasreduceseuratmethod aliasgapschromatinassaymethod aliasgap aliasgapsseuratmethod aliasdisjoinchromatinassaymethod aliasdisjoin aliasdisjoinseuratmethod aliasisdisjointchromatinassaymethod aliasisdisjoint aliasisdisjointseuratmethod aliasdisjointbinschromatinassaymethod aliasdisjointbin aliasdisjointbinsseuratmethod titleinterrang transform chromatinassay object usag smethodrangechromatinassayx withrevmap fals narm fals smethodrangeseuratx withrevmap fals narm fals smethodreducechromatinassayx dropemptyrang fals smethodreduceseuratx dropemptyrang fals smethodgapschromatinassayx start na end na smethodgapsseuratx start na end na smethoddisjoinchromatinassayx smethoddisjoinseuratx smethodisdisjointchromatinassayx smethodisdisjointseuratx smethoddisjointbinschromatinassayx smethoddisjointbinsseuratx argument itemxa codelinkchromatinassay object itemaddit argument itemwithrevmapse codelinkirangesinterrangemethod pkgirang packag itemnarmignor itemdropemptyrangesse codelinkirangesinterrangemethod itemstart endse codelinkirangesinterrangemethod descript coderang reduc gap disjoin isdisjoint disjointbin method avail codelinkchromatinassay object sectionfunct item item coderangeseuratmethod method seurat object item codereducechromatinassaymethod method chromatinassay object item codereduceseuratmethod method seurat object item codegapschromatinassaymethod method chromatinassay object item codegapsseuratmethod method seurat object item codedisjoinchromatinassaymethod method chromatinassay object item codedisjoinseuratmethod method seurat object item codeisdisjointchromatinassaymethod method chromatinassay object item codeisdisjointseuratmethod method seurat object item codedisjointbinschromatinassaymethod method chromatinassay object item codedisjointbinsseuratmethod method seurat object seealso item itemlinkirangesinterrangemethod pkgirang packag itemlinkgenomicrangesinterrangemethod pkggenomicrang packag itemlinkchromatinassayclass conceptinter_rang gener roxygen edit hand pleas edit document rvisualizationr namemotifplot aliasmotifplot titleplot dna sequenc motif usag motifplotobject motif assay null usenam true argument itemobjecta seurat object itemmotifsa list motif plot itemassaynam assay use itemusenamesus motif name store motif object itemaddit paramet pass codelinkggseqlogoggseqlogo valu return codelinkggplotggplot object descript plot posit weight matrix posit frequenc matrix differ dna sequenc motif exampl donttest motifobj seuratgetassaydataatac_smal slot motif motifplotatac_smal motif headcolnamesmotifobj conceptmotif conceptvisu gener roxygen edit hand pleas edit document rpreprocessingr namefrip aliasfrip titlecalcul fraction read peak per cell usag fripobject assay totalfrag colnam frip verbos true argument itemobjecta seurat object itemassaynam assay contain peak x cell matrix itemtotalfragmentsnam metadata column contain total number sequenc fragment cell comput use codelinkcountfrag function itemcolnamenam column metadata store frip inform itemverbosedisplay messag valu return codelinkseuratobjectseurat object descript calcul fraction read peak per cell exampl fripobject atac_smal assay peak totalfrag fragment conceptqc gener roxygen edit hand pleas edit document rvisualizationr nameexpressionplot aliasexpressionplot titleplot gene express usag expressionplot object featur assay null groupbi null ident null slot data argument itemobjecta seurat object itemfeaturesa list featur plot itemassaynam assay store express inform itemgroupbya group variabl group cell null use current cell ident itemidentsa list ident includ plot null includ ident itemslotwhich slot pull express data descript display gene express valu differ group cell differ gene gene arrang xaxi differ group stack yaxi express valu distribut group shown violin plot design work alongsid genom coverag track plot abl align coverag track group cell exampl donttest expressionplotatac_smal featur tspan assay rna conceptvisu gener roxygen edit hand pleas edit document rlinksr nameconnectionstolink aliasconnectionstolink titlecicero connect link usag connectionstolinksconn ccan null threshold sep c argument itemconnsa datafram contain coaccess element would usual output coderun_cicero codeassemble_connect specif datafram first column contain genom coordin first element link pair element chromosom start end coordin separ charact second column second element link pair format way first column third column contain coaccess score itemccansthi option suppli datafram contain ciscoaccess network ccan inform gener codegenerate_ccan specif datafram contain name peak first column ccan belong second column itemthresholdthreshold retain coaccess site link valu less equal threshold discard itemsepsepar use string encod genom coordin first element use separ chromosom coordin second element use separ start end coordin valu return codelinkgenomicrangesgrang object descript convert output cicero connect set genom rang start end coordin rang midpoint link element element chromosom includ output detail see cicero packag inform urlhttpsbioconductororgpackagescicero conceptlink gener roxygen edit hand pleas edit document rfragmentsr namecreatefragmentobject aliascreatefragmentobject titlecr fragment object usag createfragmentobject path cell null validatefrag true verbos true argument itempatha path fragment file file contain tabix index directori itemcellsa name charact vector contain cell barcod contain fragment file need cell fragment file cell vector present fragment file search file perform least one fragment cell found null dont check expect cell element vector cell barcod appear fragment file name element correspond cell name object itemvalidatefragmentscheck expect cell present fragment file itemverbosedisplay messag itemaddit argument pass codevalidatecel descript creat codefrag object store fragment file inform object store bit md hash fragment file fragment file index chang file ondisk detect check also perform ensur expect cell present fragment file exampl fpath systemfileextdata fragmentstsvgz packagesignac cell colnamesx atac_smal namesx cell pastetest_ cell frag createfragmentobjectpath fpath cell cell verbos fals toler conceptfrag gener roxygen edit hand pleas edit document rfragmentsr nameheadfrag aliasheadfrag titlereturn first row fragment file usag methodheadfragmentx n l argument itemxa codefrag object itemnan integ specifi number row return fragment file itemaddit argument pass codelinkutilsreadt valu first coden row fragment file codedatafram follow column chrom start end barcod readcount descript return first coden row fragment file allow content fragment file inspect conceptfrag gener roxygen edit hand pleas edit document robjectsr namecreatechromatinassay aliascreatechromatinassay titlecr chromatinassay object usag createchromatinassay count data mincel minfeatur maxcel null rang null motif null fragment null genom null annot null bia null positionenrich null sep c validatefrag true verbos true argument itemcountsunnorm data raw count itemdatanorm data provid pass count itemmincellsinclud featur detect least mani cell subset count matrix well reintroduc exclud featur creat new object lower cutoff itemminfeaturesinclud cell least mani featur detect itemmaxcellsinclud featur detect less mani cell subset count matrix well reintroduc exclud featur creat new object higher cutoff use chromatin assay certain artefactu loci accumul read cell percentag cutoff also set use q follow percentag cell exampl q discard featur detect percent cell null default appli maximum valu itemrangesa set codelinkgenomicrangesgrang correspond row input matrix itemmotifsa motif object requir itemfragmentspath tabixindex fragment file data contain input matrix multipl fragment file requir add addit codelinkfrag object assay creat use codelinkcreatefragmentobject codelinkfrag function altern list codelinkfrag object provid itemgenomea codelinkgenomeinfodbseqinfo object contain basic inform genom use altern name ucsc genom provid sequenc inform download ucsc itemannotationa set codelinkgenomicrangesgrang contain annot genom use itembiasa tn integr bia matrix itempositionenrichmenta name list matric contain posit signal enrich inform cell cell x posit matrix center element interest exampl tss site itemsepsepar use string encod genom coordin first element use separ chromosom coordin second element use separ start end coordin use coderang null itemvalidatefragmentscheck cell assay present fragment file itemverbosedisplay messag itemaddit argument pass codelinkcreatefragmentobject descript creat codelinkchromatinassay object count matrix normal data matrix expect format input matrix featur x cell set genom rang must suppli along matrix length rang equal number row matrix set genom rang suppli extract row name matrix conceptassay gener roxygen edit hand pleas edit document rmotifsr namefindmotif aliasfindmotif titlefindmotif usag findmotif object featur background assay null verbos true argument itemobjecta seurat object itemfeaturesa vector featur test enrich background itembackgroundeith vector featur use background set number specifi number featur randomli select background set number provid region select match sequenc characterist queri featur match sequenc characterist characterist must store featur metadata assay ad use codelinkregionstat function null use featur assay itemassaywhich assay use default activ assay itemverbosedisplay messag itemargu pass codelinkmatchregionstat valu return data frame descript find motif overrepres given set genom featur comput number featur contain motif observ compar total number featur contain motif background use hypergeometr test exampl demotif headrownamesatac_smal bgpeak tailrownamesatac_smal findmotif object atac_smal featur demotif background bgpeak conceptmotif gener roxygen edit hand pleas edit document rgenericsr namecel aliascel titleset get cell barcod inform fragment object usag cellsx valu argument itemxa seurat object itemargu pass method itemvaluea charact vector cell barcod descript set get cell barcod inform fragment object gener roxygen edit hand pleas edit document rgenericsr rquantificationr nameaggregatetil aliasaggregatetil aliasaggregatetilesseurat aliasaggregatetileschromatinassay aliasaggregatetilesdefault titlequantifi aggreg genom tile usag aggregatetilesobject methodaggregatetilesseurat object genom assay null newassaynam tile min_count binsiz verbos true methodaggregatetileschromatinassay object genom min_count binsiz verbos true methodaggregatetilesdefault object genom cell null min_count binsiz verbos true argument itemobjecta seurat object chromatinassay object itemaddit argument pass method itemgenomegenom vector chromosom size genom use construct genom bin coordin obtain call seqlength bsgenomeclass object itemassaynam assay use itemnewassaynamenam new assay creat contain aggreg genom tile itemmin_countsminimum number count tile retain prior aggreg itembinsizes genom bin tile base pair itemverbosedisplay messag itemcellscel includ valu run seurat object return seurat object new codelinkchromatinassay ad run codelinkchromatinassay return new codechromatinassay contain aggreg genom tile run fragment file return spars region x cell matrix descript quantifi fragment count per cell fixeds genom bin across whole genom remov bin less desir minimum number count bin merg adjac tile singl region conceptquantif gener roxygen edit hand pleas edit document rvisualizationr namelinkplot aliaslinkplot titleplot link genom element usag linkplotobject region mincutoff argument itemobjecta codelinkseuratobjectseurat object itemregiona genom region plot itemmincutoffminimum absolut score link plot valu return codelinkggplotggplot object descript display link pair genom element within given region genom conceptlink conceptvisu gener roxygen edit hand pleas edit document rutilitiesr namegetgrangesfromensdb aliasgetgrangesfromensdb titleextract genom rang ensdb object usag getgrangesfromensdb ensdb standardchromosom true biotyp cprotein_cod lincrna rrna processed_transcript verbos true argument itemensdban ensdb object itemstandardchromosomeskeep standard chromosom itembiotypesbiotyp keep itemverbosedisplay messag descript pull transcript inform chromosom ensdb object wrap codelinkbiovizbasecrunch appli extractor function chromosom present ensdb object conceptutil gener roxygen edit hand pleas edit document rgenomeinfodbmethodsr nameseqinfomethod aliasseqinfomethod aliasseqinfo aliasseqinfochromatinassaymethod aliasseqinfochromatinassaymethod aliasseqlevelschromatinassaymethod aliasseqlevel aliasseqlevelschromatinassaymethod aliasseqnameschromatinassaymethod aliasseqnam aliasseqnameschromatinassaymethod aliasseqlengthschromatinassaymethod aliasseqlength aliasseqlengthschromatinassaymethod aliasgenomechromatinassaymethod aliasgenom aliasgenomechromatinassaymethod aliasiscircularchromatinassaymethod aliasiscircular aliasiscircularchromatinassaymethod aliasseqinfoseuratmethod aliasseqinfoseuratmethod aliasseqlevelsseuratmethod aliasseqlevelsseuratmethod aliasseqnamesseuratmethod aliasseqnamesseuratmethod aliasseqlengthsseuratmethod aliasseqlengthsseuratmethod aliasgenomeseuratmethod aliasgenomeseuratmethod aliasiscircularseuratmethod aliasiscircularseuratmethod titleaccess modifi sequenc inform chromatinassay object usag smethodseqinfochromatinassayx smethodseqinfochromatinassayx valu smethodseqlevelschromatinassayx smethodseqlevelschromatinassayx valu smethodseqnameschromatinassayx smethodseqnameschromatinassayx valu smethodseqlengthschromatinassayx smethodseqlengthschromatinassayx valu smethodgenomechromatinassayx smethodgenomechromatinassayx valu smethodiscircularchromatinassayx smethodiscircularchromatinassayx valu smethodseqinfoseuratx smethodseqinfoseuratx valu smethodseqlevelsseuratx smethodseqlevelsseuratx valu smethodseqnamesseuratx smethodseqnamesseuratx valu smethodseqlengthsseuratx smethodseqlengthsseuratx valu smethodgenomeseuratx smethodgenomeseuratx valu smethodiscircularseuratx smethodiscircularseuratx valu argument itemxa codelinkchromatinassay object itemvaluea codelinkgenomeinfodbseqinfo object name ucsc genom store codelinkchromatinassay descript method access modifi codelinkgenomeinfodbseqinfo object inform store codelinkchromatinassay object sectionfunct item item codeseqinfochromatinassaymethod set method chromatinassay object item codeseqlevelschromatinassaymethod get method chromatinassay object item codeseqlevelschromatinassaymethod set method chromatinassay object item codeseqnameschromatinassaymethod get method chromatinassay object item codeseqnameschromatinassaymethod set method chromatinassay object item codeseqlengthschromatinassaymethod get method chromatinassay object item codeseqlengthschromatinassaymethod set method chromatinassay object item codegenomechromatinassaymethod get method chromatinassay object item codegenomechromatinassaymethod set method chromatinassay object item codeiscircularchromatinassaymethod get method chromatinassay object item codeiscircularchromatinassaymethod set method chromatinassay object item codeseqinfoseuratmethod get method seurat object item codeseqinfoseuratmethod set method seurat object item codeseqlevelsseuratmethod get method seurat object item codeseqlevelsseuratmethod set method seurat object item codeseqnamesseuratmethod get method seurat object item codeseqnamesseuratmethod set method seurat object item codeseqlengthsseuratmethod get method seurat object item codeseqlengthsseuratmethod set method seurat object item codegenomeseuratmethod get method seurat object item codegenomeseuratmethod set method seurat object item codeiscircularseuratmethod get method seurat object item codeiscircularseuratmethod set method seurat object seealso item itemlinkgenomeinfodbseqinfo pkggenomeinfodb packag itemlinkchromatinassayclass conceptseqinfo gener roxygen edit hand pleas edit document rpreprocessingr nametssenrich aliastssenrich titlecomput tss enrich score per cell usag tssenrich object tssposit null n null fast true assay null cell null process_n verbos true argument itemobjecta seurat object itemtsspositionsa grang object contain tss posit null use genom annot store assay itemnnumb tss posit use select first _n_ tsss set null use tsss slower itemfastjust comput tss enrich score without store baseresolut matrix integr count site reduc memori requir store object allow plot access profil tss itemassaynam assay use itemcellsa vector cell includ null default use cell object itemprocess_nnumb region process time use codefast option itemverbosedisplay messag valu return codelinkseuratobjectseurat object descript comput transcript start site tss enrich score cell defin encod urlhttpswwwencodeprojectorgdatastandardsterm detail comput score ad object metadata tssenrich exampl dontrun fpath systemfileextdata fragmentstsvgz packagesignac fragmentsatac_smal createfragmentobject path fpath cell colnamesatac_smal toler tssenrichmentobject atac_smal conceptqc gener roxygen edit hand pleas edit document rgenericsr rpreprocessingr nameregionstat aliasregionstat aliasregionstatsdefault aliasregionstatschromatinassay aliasregionstatsseurat titlecomput base composit inform genom rang usag regionstatsobject methodregionstatsdefaultobject genom verbos true methodregionstatschromatinassayobject genom verbos true methodregionstatsseuratobject genom assay null verbos true argument itemobjecta seurat object assay object set genom rang itemargu pass method itemgenomea bsgenom object itemverbosedisplay messag itemassaynam assay use valu return datafram descript comput gc content region length dinucleotid base frequenc region assay add featur metadata exampl dontrun librarybsgenomehsapiensucschg regionstat object rownamesatac_smal genom bsgenomehsapiensucschg dontrun librarybsgenomehsapiensucschg regionstat object atac_smallpeak genom bsgenomehsapiensucschg dontrun librarybsgenomehsapiensucschg regionstat object atac_smal assay bin genom bsgenomehsapiensucschg conceptmotif gener roxygen edit hand pleas edit document rvisualizationr nameannotationplot aliasannotationplot titleplot gene annot usag annotationplotobject region argument itemobjecta codelinkseuratobjectseurat object itemregiona genom region plot valu return codelinkggplotggplot object descript display gene annot given region genom exampl donttest annotationplotobject atac_smal region cchr conceptvisu gener roxygen edit hand pleas edit document rirangesmethodsr namecoveragechromatinassaymethod aliascoveragechromatinassaymethod aliascoverag aliascoverageseuratmethod titlecoverag chromatinassay object usag smethodcoveragechromatinassay x shift l width null weight l method cauto sort hash smethodcoverageseurat x shift l width null weight l method cauto sort hash argument itemxa codelinkchromatinassay object itemshifthow much rang shift coverag comput see codelinkirangescoverag pkgirang packag itemwidthspecifi length return coverag vector see codelinkirangescoverag pkgirang packag itemweightassign weight rang codex see codelinkirangescoverag pkgirang packag itemmethodse codelinkirangescoverag pkgirang packag descript codecoverag method codelinkchromatinassay object sectionfunct item item codecoveragechromatinassaymethod method chromatinassay object item codecoverageseuratmethod method seurat object seealso item itemlinkirangescoveragemethod pkgirang packag itemlinkgenomicrangescoveragemethod pkggenomicrang packag itemlinkchromatinassayclass conceptcoverag gener roxygen edit hand pleas edit document rvisualizationr namefragmenthistogram aliasfragmenthistogram titleplot fragment length histogram usag fragmenthistogram object assay null region chr groupbi null cell null logscal fals argument itemobjecta seurat object itemassaywhich assay use default activ assay itemregiongenom rang use default fist two megabas chromosom grang object string vector string itemgroupbynam one metadata column group color cell default current cell ident itemcellswhich cell plot default cell itemlogscaledisplay yaxi log scale default fals itemargu pass function valu return codelinkggplotggplot object descript plot frequenc fragment differ length present differ group cell exampl donttest fpath systemfileextdata fragmentstsvgz packagesignac fragmentsatac_smal createfragmentobject path fpath cell colnamesatac_smal validatefrag fals fragmenthistogramobject atac_smal region chr conceptqc conceptvisu gener roxygen edit hand pleas edit document rutilitiesr namegettssposit aliasgettssposit titlefind transcript start site usag gettsspositionsrang biotyp protein_cod argument itemrangesa grang object contain gene annot itembiotypesgen biotyp includ null use biotyp suppli gene annot descript get tss posit set genom rang contain gene posit rang contain exon intron utr etc rather whole transcript protein code gene biotyp includ output conceptutil gener roxygen edit hand pleas edit document rvisualizationr nametssplot aliastssplot titleplot signal enrich around tsss usag tssplotobject assay null groupbi null ident null argument itemobjecta seurat object itemassaynam assay use tss enrich inform cell alreadi comput run codelinktssenrich itemgroupbyset ident group cell itemidentsset ident includ plot valu return codelinkggplotggplot object descript plot normal tss enrich score posit rel tss requir codelinktssenrich alreadi run assay conceptqc conceptvisu gener roxygen edit hand pleas edit document robjectsr doctypeclass namemotifclass aliasmotifclass aliasmotif titleth motif class descript motif class design store dna sequenc motif inform includ motif pwm pfm motif posit metadata sectionslot describ itemcodedataa spars binari featur x motif matrix column correspond motif id row correspond genom featur peak bin entri matrix genom featur contain motif otherwis itemcodepwma name list posit weight matric itemcodemotifnamesa list contain name motif itemcodepositionsa codelinkgenomicrangesgrangeslist object contain exact posit motif itemcodemetadataa datafram storag addit inform relat motif could includ name protein bind motif conceptmotif gener roxygen edit hand pleas edit document rutilitiesr namecountsinregion aliascountsinregion titlecount region usag countsinregionobject assay region argument itemobjecta seurat object itemassaynam chromatin assay object use itemregionsa grang object itemaddit argument pass codelinkirangesfindoverlap valu return numer vector descript count read per cell overlap given set region exampl donttest countsinregion object atac_smal assay bin region blacklist_hg conceptutil gener roxygen edit hand pleas edit document rvisualizationr namecoverageplot aliascoverageplot titleplot tn insert frequenc region usag coverageplot object region featur null assay null showbulk fals expressionassay rna expressionslot data annot true peak true peaksgroupbi null rang null rangesgroupbi null rangestitl rang regionhighlight null link true tile fals tiles tilecel bigwig null bigwigtyp coverag height null groupbi null window extendupstream extenddownstream scalefactor null ymax null cell null ident null sep c maxdownsampl downsampler argument itemobjecta seurat object itemregiona set genom coordin show grang object string encod genom posit gene name vector string describ genom coordin gene name plot gene name suppli annot must present assay itemfeaturesa vector featur present anoth assay plot alongsid access track exampl gene name itemassaynam assay plot itemshowbulkinclud coverag track cell combin pseudobulk note plot combin access cell includ plot rather cell object itemexpressionassaynam assay contain express data plot alongsid access track need suppli codefeatur argument itemexpressionslotnam slot pull express data need suppli codefeatur argument itemannotationdisplay gene annot itempeaksdisplay peak itempeaksgroupbygroup variabl color peak must variabl present featur metadata null color peak variabl itemrangesaddit genom rang plot itemrangesgroupbygroup variabl color rang must variabl present metadata store coderang genom rang null color variabl itemrangestitleyaxi titl rang track relev coderang paramet set itemregionhighlightregion highlight plot grang object contain coordin highlight default region highlight grey chang color highlight includ metadata column grang object name color contain color use region itemlinksdisplay link itemtiledisplay percel fragment inform slide window itemtilesizes slide window percel fragment tile plot itemtilecellsnumb cell display fragment inform tile plot itembigwiglist bigwig file path plot data file remot host name element list determin yaxi label given track itembigwigtypetyp track use bigwig file line heatmap coverag either singl valu list valu give type individu track provid list bigwig file itemheightsrel height track access gene annot peak link itemgroupbynam one metadata column group color cell default current cell ident itemwindowsmooth window size itemextendupstreamnumb base extend region upstream itemextenddownstreamnumb base extend region downstream itemscalefactorsc factor track height null default use median group scale factor determin total number fragment sequenc group itemymaxmaximum valu axi null default set highest valu among track itemcellswhich cell plot default cell itemidentswhich ident includ plot default ident itemsepsepar use string encod genom coordin first element use separ chromosom coordin second element use separ start end coordin itemmaxdownsampleminimum number posit kept downsampl downsampl rate adapt window size paramet set minimum possibl number posit includ plot becom spars window size small itemdownsampleratefract posit retain downsampl retain posit give higherresolut plot make number point larg result larger file size save plot longer period time need draw plot itemaddit argument pass codelinkpatchworkwrap_plot valu return codelinkggplotggplot object descript plot frequenc tn insert event differ group cell within given region genom detail thank andrew hill provid earli version function exampl donttest fpath systemfileextdata fragmentstsvgz packagesignac fragment createfragmentobject path fpath cell colnamesatac_smal validatefrag fals fragmentsatac_smal fragment basic coverag plot coverageplotobject atac_smal region cchr show addit rang rangesshow stringtograngeschr coverageplotobject atac_smal region cchr rang rangesshow highlight region coverageplotobject atac_smal region cchr regionhighlight rangesshow chang highlight color rangesshowcolor orang coverageplotobject atac_smal region cchr regionhighlight rangesshow show express data coverageplotobject atac_smal region cchr featur elk conceptvisu gener roxygen edit hand pleas edit document rfragmentsr namevalidatehash aliasvalidatehash titlevalid hash fragment object usag validatehashobject verbos true argument itemobjecta codelinkfrag object itemverbosedisplay messag descript valid hash fragment object conceptfrag gener roxygen edit hand pleas edit document rirangesmethodsr namenearestmethod aliasnearestmethod aliaspreced aliasprecedeanychromatinassaymethod aliasprecedechromatinassayanymethod aliasprecedechromatinassaychromatinassaymethod aliasprecedeanyseuratmethod aliasprecedeseuratanymethod aliasprecedeseuratseuratmethod aliasfollowanychromatinassaymethod aliasfollow aliasfollowchromatinassayanymethod aliasfollowchromatinassaychromatinassaymethod aliasfollowanyseuratmethod aliasfollowseuratanymethod aliasfollowseuratseuratmethod aliasnearestanychromatinassaymethod aliasnearest aliasnearestchromatinassayanymethod aliasnearestchromatinassaychromatinassaymethod aliasnearestanyseuratmethod aliasnearestseuratanymethod aliasnearestseuratseuratmethod aliasdistanceanychromatinassaymethod aliasdist aliasdistancechromatinassayanymethod aliasdistancechromatinassaychromatinassaymethod aliasdistanceanyseuratmethod aliasdistanceseuratanymethod aliasdistanceseuratseuratmethod aliasdistancetonearestanychromatinassaymethod aliasdistancetonearest aliasdistancetonearestchromatinassayanymethod aliasdistancetonearestchromatinassaychromatinassaymethod aliasdistancetonearestanyseuratmethod aliasdistancetonearestseuratanymethod aliasdistancetonearestseuratseuratmethod titlefind nearest rang neighbor chromatinassay object usag smethodprecedeanychromatinassayx subject select carbitrari ignorestrand fals smethodprecedechromatinassayanyx subject select carbitrari ignorestrand fals smethodprecedechromatinassaychromatinassayx subject select carbitrari ignorestrand fals smethodprecedeanyseuratx subject select carbitrari ignorestrand fals smethodprecedeseuratanyx subject select carbitrari ignorestrand fals smethodprecedeseuratseuratx subject select carbitrari ignorestrand fals smethodfollowanychromatinassayx subject select carbitrari ignorestrand fals smethodfollowchromatinassayanyx subject select carbitrari ignorestrand fals smethodfollowchromatinassaychromatinassayx subject select carbitrari ignorestrand fals smethodfollowanyseuratx subject select carbitrari ignorestrand fals smethodfollowseuratanyx subject select carbitrari ignorestrand fals smethodfollowseuratseuratx subject select carbitrari ignorestrand fals smethodnearestanychromatinassayx subject select carbitrari ignorestrand fals smethodnearestchromatinassayanyx subject select carbitrari ignorestrand fals smethodnearestchromatinassaychromatinassayx subject select carbitrari ignorestrand fals smethodnearestanyseuratx subject select carbitrari ignorestrand fals smethodnearestseuratanyx subject select carbitrari ignorestrand fals smethodnearestseuratseuratx subject select carbitrari ignorestrand fals smethoddistanceanychromatinassayx ignorestrand fals smethoddistancechromatinassayanyx ignorestrand fals smethoddistancechromatinassaychromatinassayx ignorestrand fals smethoddistanceanyseuratx ignorestrand fals smethoddistanceseuratanyx ignorestrand fals smethoddistanceseuratseuratx ignorestrand fals smethoddistancetonearestanychromatinassayx subject ignorestrand fals smethoddistancetonearestchromatinassayanyx subject ignorestrand fals smethoddistancetonearestchromatinassaychromatinassayx subject ignorestrand fals smethoddistancetonearestanyseuratx subject ignorestrand fals smethoddistancetonearestseuratanyx subject ignorestrand fals smethoddistancetonearestseuratseuratx subject ignorestrand fals argument itemxa queri codelinkchromatinassay object itemsubjectth subject codelinkgenomicrangesgrang codelinkchromatinassay object miss codex use subject itemselectlog handl tie see codelinkgenomicrangesnearestmethod pkggenomicrang packag itemignorestrandlog argument control whether strand inform ignor itemyfor codedist method codelinkgenomicrangesgrang object codelinkchromatinassay object itemaddit argument method descript codepreced follow nearest distanc distancetonearest method avail codelinkchromatinassay object sectionfunct item item codeprecedechromatinassayanymethod method chromatinassay item codeprecedechromatinassaychromatinassaymethod method chromatinassay chromatinassay item codeprecedeanyseuratmethod method seurat item codeprecedeseuratanymethod method seurat item codeprecedeseuratseuratmethod method seurat seurat item codefollowanychromatinassaymethod method chromatinassay item codefollowchromatinassayanymethod method chromatinassay item codefollowchromatinassaychromatinassaymethod method chromatinassay chromatinassay item codefollowanyseuratmethod method seurat item codefollowseuratanymethod method seurat item codefollowseuratseuratmethod method seurat seurat item codenearestanychromatinassaymethod method chromatinassay item codenearestchromatinassayanymethod method chromatinassay item codenearestchromatinassaychromatinassaymethod method chromatinassay chromatinassay item codenearestanyseuratmethod method seurat item codenearestseuratanymethod method seurat item codenearestseuratseuratmethod method seurat seurat item codedistanceanychromatinassaymethod method chromatinassay item codedistancechromatinassayanymethod method chromatinassay item codedistancechromatinassaychromatinassaymethod method chromatinassay chromatinassay item codedistanceanyseuratmethod method seurat item codedistanceseuratanymethod method seurat item codedistanceseuratseuratmethod method seurat seurat item codedistancetonearestanychromatinassaymethod method chromatinassay item codedistancetonearestchromatinassayanymethod method chromatinassay item codedistancetonearestchromatinassaychromatinassaymethod method chromatinassay chromatinassay item codedistancetonearestanyseuratmethod method seurat item codedistancetonearestseuratanymethod method seurat item codedistancetonearestseuratseuratmethod method seurat seurat seealso item itemlinkirangesnearestmethod pkgirang packag itemlinkgenomicrangesnearestmethod pkggenomicrang packag itemlinkchromatinassayclass conceptnearest gener roxygen edit hand pleas edit document rgenericsr rmitor nameidentifyvari aliasidentifyvari aliasidentifyvariantsdefault aliasidentifyvariantsassay aliasidentifyvariantsseurat titleidentifi mitochondri variant usag identifyvariantsobject methodidentifyvariantsdefault object refallel stabilize_vari true low_coverage_threshold verbos true methodidentifyvariantsassayobject refallel methodidentifyvariantsseuratobject refallel assay null argument itemobjecta seurat object itemargu pass method itemrefallelea datafram contain refer allel mitochondri genom itemstabilize_variancestabil varianc itemlow_coverage_thresholdlow coverag threshold itemverbosedisplay messag itemassaynam assay use null use default assay valu return datafram descript identifi mitochondri variant present singl cell exampl dontrun datadir pathtodatadirectori mgatk readmgatkdir datadir variantdf identifyvari object mgatkcount refallel mgatkrefallel conceptmito gener roxygen edit hand pleas edit document rfragmentsr namevalidatefrag aliasvalidatefrag titlevalid fragment object usag validatefragmentsobject verbos true argument itemobjecta codelinkfrag object itemverbosedisplay messag itemaddit paramet pass codelinkvalidatecel descript verifi cell list object exist fragment file fragment file index chang sinc creat fragment object conceptfrag gener roxygen edit hand pleas edit document rgenericsr robjectsr namelink aliaslink aliaslink aliaslinkschromatinassay aliaslinksseurat aliaslinkschromatinassay aliaslinksseurat titleget set link inform usag linksobject linksobject valu methodlinkschromatinassayobject methodlinksseuratobject methodlinkschromatinassayobject valu methodlinksseuratobject valu argument itemobjecta seurat object itemargu pass method itemvaluea codelinkgenomicrangesgrang object descript get set genom link inform seurat object chromatinassay exampl linksatac_smallpeak linksatac_smal link linksatac_smal linksatac_smallpeak link link linksatac_smal linksatac_smal link conceptassay conceptlink gener roxygen edit hand pleas edit document rutilitiesr namematchregionstat aliasmatchregionstat titlematch dna sequenc characterist usag matchregionstat metafeatur queryfeatur featuresmatch cgcpercent n verbos true argument itemmetafeaturea datafram contain dna sequenc inform featur choos itemqueryfeaturea datafram contain dna sequenc inform featur match itemfeaturesmatchwhich featur queri match select set region vector column name present featur metadata suppli match multipl characterist default gc content itemnnumb region select characterist match queri itemverbosedisplay messag itemargu pass function valu return charact vector descript return vector genom region match distribut set queri region given set characterist specifi input codemetafeatur datafram detail request featur match densiti distribut estim use codelinkstatsdens function set weight featur dataset estim base densiti distribut multipl featur match exampl gc content overal access joint densiti distribut comput multipli individu featur weight set featur characterist match queri region select use codelinkbasesampl function probabl randomli select featur equal joint densiti distribut weight exampl metafeatur seuratgetassaydata object atac_smallpeak slot metafeatur queryfeatur metafeatur featureschoos metafeaturesnrowmetafeatur matchregionstat metafeatur featureschoos queryfeatur queryfeatur featuresmatch percentil n conceptmotif conceptutil gener roxygen edit hand pleas edit document rdatar doctypedata nameblacklist_c aliasblacklist_c titlegenom blacklist region c elegan ce base format grang object sourc urlhttpsgithubcomboylelabblacklist doisz usag blacklist_c descript genom blacklist region c elegan ce base conceptdata keyworddataset gener roxygen edit hand pleas edit document rutilitiesr namelookupgenecoord aliaslookupgenecoord titleget gene coordin usag lookupgenecoordsobject gene assay null argument itemobjecta seurat object itemgenenam gene extract itemassaynam assay use descript extract coordin longest transcript gene store annot within object exampl lookupgenecoordsatac_smal gene mir conceptutil gener roxygen edit hand pleas edit document rpreprocessingr namecreatemotifmatrix aliascreatemotifmatrix titlecr motif matrix usag createmotifmatrix featur pwm genom score fals usecount fals sep c argument itemfeaturesa grang object contain set genom featur itempwma codelinktfbstoolspfmatrixlist codelinktfbstoolspwmatrixlist object contain posit weightfrequ matric use itemgenomeani object compat codegenom argument codelinkmotifmatchrmatchmotif itemscorerecord motif match score rather presenceabs default fals itemusecountsrecord motif count per region fals default record presenceabs motif applic codescorefals itemsepa length charact vector contain separ use construct matrix rownam grang itemaddit argument pass codelinkmotifmatchrmatchmotif valu return spars matrix descript creat motif x featur matrix set genom rang genom set posit weight matric detail requir motifmatchr instal urlhttpswwwbioconductororgpackagesmotifmatchr exampl dontrun libraryjaspar librarytfbstool librarybsgenomehsapiensucschg pwm getmatrixset x jaspar opt listspeci all_vers fals motifmatrix createmotifmatrix featur grangesatac_smal pwm pwm genom bsgenomehsapiensucschg conceptmotif conceptpreprocess