becom contributor submit code contributor licens agreement wed love accept patch take jump coupl legal hurdl pleas fill either individu corpor contributor licens agreement cla individu write origin sourc code your sure intellectu properti youll need sign individu clahttpsdevelopersgooglecomopensourceclaindividu work compani want allow contribut work youll need sign corpor clahttpsdevelopersgooglecomopensourceclacorpor follow either two link access appropri cla instruct sign return receiv well abl accept pull request googler googler pleas make attempt submit intern chang rather github pull request abl submit intern chang pr accept altern contribut patch submit issu describ propos chang issu trackerhttpsgithubcomgooglegoogletestissu pleas dont mix one logic chang per submitt make histori hard follow want make chang doesnt correspond issu issu tracker pleas creat one also coordin team member list issu question ensur work isnt duplic commun plan earli also gener lead better patch propos chang accept havent alreadi done sign contributor licens agreement see detail fork desir repo develop test code chang ensur code adher exist style sampl contribut ensur code appropri set unit test pass submit pull request googl test googl mock commun googl test commun exist primarili discuss grouphttpgroupsgooglecomgroupgoogletestframework github repositori likewis googl mock commun exist primarili discuss grouphttpgroupsgooglecomgroupgooglemock definit encourag contribut discuss also help us keep effect group high follow promot guidelin list pleas friendli show courtesi respect other vital part googl cultur strongli encourag everyon particip googl test develop join us accept noth less cours courteou fail construct disagre mean respect enumer technic reason particular propos may best choic there never reason antagonist dismiss toward anyon sincer tri contribut discuss sure c test seriou busi also lot fun let keep way let strive one friendliest commun open sourc alway discuss googl test offici googletest discuss group dont actual submit code order sign particip valuabl contribut style keep sourc consist readabl diffabl easi merg use fairli rigid code style defin googlestyleguidehttpsgithubcomgooglestyleguid project patch expect conform style outlin herehttpsgooglegithubiostyleguidecppguidehtml use clangformathttpsgithubcomgooglegoogletestblobmasterclangformat check format requir contributor plan contribut patch need build googl test googl mock test git checkout requir pythonhttpswwwpythonorg v newer run test regener certain sourc file templat cmakehttpscmakeorg v newer develop googl test googl mock section discuss make chang googl test project test googl test googl mock make sure chang work intend dont break exist function youll want compil run googl test googlemock test use cmake mkdir mybuild cd mybuild cmake dgtest_build_testson dgmock_build_testson gtest_repo_dir choos build googl test googl mock may modifi cmake command one cmake dgtest_build_testson gtest_dir set googl test test cmake dgmock_build_testson gmock_dir set googl mock test make sure python instal googl test test written python cmake command complain abl find python could find pythoninterp miss python_execut tri tell explicitli python execut found cmake dpython_executablepathtopython next build googl test googl mock desir test nix usual done make run test make test test pass googletest announc live head googletest follow abseil live head philosophyhttpsabseilioaboutphilosophyupgradesupport recommend use latest commit master branch project document updat document live github page httpsgooglegithubiogoogletest recommend brows document github page rather directli repositori releas releas httpsgithubcomgooglegoogletestreleasestagreleas avail come soon plan take depend abseilhttpsgithubcomabseilabseilcpp document improv plan welcom googletest googl c test framework repositori merger formerli separ googletest googlemock project close relat make sens maintain releas togeth get start see googletest user guidehttpsgooglegithubiogoogletest document recommend start googletest primerhttpsgooglegithubiogoogletestprimerhtml inform build googletest found googletestreadmemdgoogletestreadmemd featur xunithttpsenwikipediaorgwikixunit test framework test discoveri rich set assert userdefin assert death test fatal nonfat failur valueparameter test typeparameter test variou option run test xml test report gener support platform googletest requir codebas compil compliant c standard newer googletest code offici support follow platform oper system tool list communitysupport communitysupport platform patch complic code may consid notic problem platform pleas file issu googletest github issu trackerhttpsgithubcomgooglegoogletestissu pull request contain fix welcom oper system linux maco window compil gcc clang msvc maco user xcode provid clang build system bazelhttpsbazelbuild cmakehttpscmakeorg note bazel build system use team intern test cmake support besteffort basi commun use googletest addit mani intern project googl googletest also use follow notabl project chromium projectshttpwwwchromiumorg behind chrome browser chrome os llvmhttpllvmorg compil protocol buffershttpsgithubcomgoogleprotobuf googl data interchang format opencvhttpopencvorg comput vision librari relat open sourc project gtest runnerhttpsgithubcomnholthausgtestrunn qt base autom testrunn graphic user interfac power featur window linux platform googletest uihttpsgithubcomospectorgtestgbar test runner run test binari allow track progress via progress bar display list test failur click one show failur text googletest ui written c gtest tap listenerhttpsgithubcomkinowgtesttaplisten event listen googletest implement tap protocolhttpsenwikipediaorgwikitest_anything_protocol test result output test runner understand tap may find use gtestparallelhttpsgithubcomgooglegtestparallel test runner run test binari parallel provid signific speedup googletest adapterhttpsmarketplacevisualstudiocomitemsitemnamedavidschuldenfreigtestadapt vs code extens allow view googletest tree view rundebug test c testmatehttpsgithubcommatepekvscodecatchtestadapt vs code extens allow view googletest tree view rundebug test cornichonhttpspypiorgprojectcornichon small gherkin dsl parser gener stub code googletest contribut chang pleas read contributingmdhttpsgithubcomgooglegoogletestblobmastercontributingmd detail contribut project happi test name bug report creat report help us improv titl label bug assigne describ bug includ clear concis descript problem includ expect happen actual happen step reproduc bug import abl reproduc problem experienc pleas provid code relev step reproduc problem includ buildcmakeliststxt file build command link github branch godboltorghttpsgodboltorg demonstr problem also help bug persist recent commit recommend use latest commit master branch project oper system version use use linux distribut pleas includ name version distribut well compil version use pleas includ output gcc v clang v equival compil build system use pleas includ output bazel version cmake version equival build system addit context add context problem name featur request propos new featur titl label enhanc assigne featur exist recent commit recommend use latest commit github project need featur ideal explain combin exist featur use instead describ propos includ detail descript featur usag exampl featur specif oper system compil build system version pleas specifi version googletest primer introduct googletest googletest help write better c test googletest test framework develop test technolog team googl specif requir constraint mind whether work linux window mac write c code googletest help support kind test unit test make good test googletest fit believ test independ repeat pain debug test succe fail result test googletest isol test run differ object test fail googletest allow run isol quick debug test well organ reflect structur test code googletest group relat test test suit share data subroutin common pattern easi recogn make test easi maintain consist especi help peopl switch project start work new code base test portabl reusabl googl lot code platformneutr test also platformneutr googletest work differ ose differ compil without except googletest test work varieti configur test fail provid much inform problem possibl googletest doesnt stop first test failur instead stop current test continu next also set test report nonfat failur current test continu thu detect fix multipl bug singl runeditcompil cycl test framework liber test writer housekeep chore let focu test content googletest automat keep track test defin doesnt requir user enumer order run test fast googletest reus share resourc across test pay setupteardown without make test depend sinc googletest base popular xunit architectur youll feel right home youv use junit pyunit take minut learn basic get start let go bewar nomenclatur callout note _note_ might confus aris differ definit term _test_ _test case_ _test suite_ bewar misunderstand histor googletest start use term _test case_ group relat test wherea current public includ intern softwar test qualif board istqbhttpwwwistqborg materi variou textbook softwar qualiti use term _test suiteistqb test suite_ relat term _test_ use googletest correspond term _test caseistqb test case_ istqb other term _test_ commonli broad enough sens includ istqb definit _test case_ much problem term _test case_ use googl test contradictori sens thu confus googletest recent start replac term _test case_ _test suite_ prefer api testsuit older testcas api slowli deprec refactor away pleas awar differ definit term mean googletest term istqbhttpwwwistqborg term exercis particular program path specif input valu verifi result testsimpletest test caseistqb test case istqb test case httpglossaryistqborgensearchtestcas istqb test suit httpglossaryistqborgensearchtestsuit basic concept use googletest start write assert statement check whether condit true assert result success nonfat failur fatal failur fatal failur occur abort current function otherwis program continu normal test use assert verifi test code behavior test crash fail assert fail otherwis succe test suit contain one mani test group test test suit reflect structur test code multipl test test suit need share common object subroutin put test fixtur class test program contain multipl test suit well explain write test program start individu assert level build test test suit assert googletest assert macro resembl function call test class function make assert behavior assert fail googletest print assert sourc file line number locat along failur messag may also suppli custom failur messag append googletest messag assert come pair test thing differ effect current function assert_ version gener fatal failur fail abort current function expect_ version gener nonfat failur dont abort current function usual expect_ prefer allow one failur report test howev use assert_ doesnt make sens continu assert question fail sinc fail assert_ return current function immedi possibl skip cleanup code come may caus space leak depend natur leak may may worth fix keep mind get heap checker error addit assert error provid custom failur messag simpli stream macro use oper sequenc oper see follow exampl use assert_eq expect_eqreferenceassertionsmdexpect_eq macro verifi valu equal c assert_eqxs ysize vector x unequ length int xsize expect_eqxi yi vector x differ index anyth stream ostream stream assert macroin particular c string string object wide string wchar_t tchar unicod mode window stdwstring stream assert translat utf print googletest provid collect assert verifi behavior code variou way check boolean condit compar valu base relat oper verifi string valu floatingpoint valu much even assert enabl verifi complex state provid custom predic complet list assert provid googletest see assert referencereferenceassertionsmd simpl test creat test use test macro defin name test function ordinari c function dont return valu function along valid c statement want includ use variou googletest assert check valu test result determin assert assert test fail either fatal nonfat test crash entir test fail otherwis succe c testtestsuitenam testnam test bodi test argument go gener specif first argument name test suit second argument test name within test suit name must valid c identifi contain underscor _ test full name consist contain test suit individu name test differ test suit individu name exampl let take simpl integ function c int factorialint n return factori n test suit function might look like c test factori testfactorialtest handleszeroinput expect_eqfactori test factori posit number testfactorialtest handlespositiveinput expect_eqfactori expect_eqfactori expect_eqfactori expect_eqfactori googletest group test result test suit logic relat test test suit word first argument test exampl two test handleszeroinput handlespositiveinput belong test suit factorialtest name test suit test follow convent name function classeshttpsgooglegithubiostyleguidecppguidehtmlfunction_nam avail linux window mac test fixtur use data configur multipl test samedatamultipletest find write two test oper similar data use test fixtur allow reus configur object sever differ test creat fixtur deriv class testingtest start bodi protect well want access fixtur member subclass insid class declar object plan use necessari write default constructor setup function prepar object test common mistak spell setup setup small u use overrid c make sure spell correctli necessari write destructor teardown function releas resourc alloc setup learn use constructordestructor use setupteardown read faqfaqmdctorvssetup need defin subroutin test share use fixtur use test_f instead test allow access object subroutin test fixtur c test_ftestfixturenam testnam test bodi like test first argument test suit name test_f must name test fixtur class youv probabl guess _f fixtur unfortun c macro system allow us creat singl macro handl type test use wrong macro caus compil error also must first defin test fixtur class use test_f youll get compil error virtual outsid class declar test defin test_f googletest creat fresh test fixtur runtim immedi initi via setup run test clean call teardown delet test fixtur note differ test test suit differ test fixtur object googletest alway delet test fixtur creat next one googletest reus test fixtur multipl test chang one test make fixtur affect test exampl let write test fifo queue class name queue follow interfac c templat typenam e e element type class queue public queue void enqueueconst e element e dequeu return null queue empti size_t size const first defin fixtur class convent give name footest foo class test c class queuetest public testingtest protect void setup overrid q_enqueu q_enqueu q_enqueu void teardown overrid queueint q_ queueint q_ queueint q_ case teardown need sinc dont clean test what alreadi done destructor well write test use test_f fixtur c test_fqueuetest isemptyiniti expect_eqq_s test_fqueuetest dequeuework int n q_dequeu expect_eqn nullptr n q_dequeu assert_nen nullptr expect_eqn expect_eqq_s delet n n q_dequeu assert_nen nullptr expect_eqn expect_eqq_s delet n use assert_ expect_ assert rule thumb use expect_ want test continu reveal error assert failur use assert_ continu failur doesnt make sens exampl second assert dequeu test assert_nen nullptr need derefer pointer n later would lead segfault n null test run follow happen googletest construct queuetest object let call tsetup initi first test isemptyiniti run tteardown clean test finish destruct step repeat anoth queuetest object time run dequeuework test avail linux window mac invok test test test_f implicitli regist test googletest unlik mani c test framework dont relist defin test order run defin test run run_all_test return test success otherwis note run_all_test run test link unitthey differ test suit even differ sourc file invok run_all_test macro save state googletest flag creat test fixtur object first test initi via setup run test fixtur object clean fixtur via teardown delet fixtur restor state googletest flag repeat step next test test run fatal failur happen subsequ step skip callout import import must ignor return valu run_all_test get compil error rational design autom test servic determin whether test pass base exit code stdoutstderr output thu main function must return valu run_all_test also call run_all_test call conflict advanc googletest featur eg threadsaf death testsadvancedmddeathtest thu support avail linux window mac write main function user _not_ need write main function instead link gtest_main oppos gtest defin suitabl entri point see end section detail remaind section appli need someth custom test run express within framework fixtur test suit write main function return valu run_all_test start boilerpl c includ thispackagefooh includ gtestgtesth namespac namespac project namespac fixtur test class foo class footest public testingtest protect remov follow function bodi would empti footest setup work test footest overrid cleanup work doesnt throw except constructor destructor enough set clean test defin follow method void setup overrid code call immedi constructor right test void teardown overrid code call immedi test right destructor class member declar use test test suit foo test foobar method abc test_ffootest methodbardoesabc const stdstring input_filepath thispackagetestdatamyinputfiledat const stdstring output_filepath thispackagetestdatamyoutputfiledat foo f expect_eqfbarinput_filepath output_filepath test foo xyz test_ffootest doesxyz exercis xyz featur foo namespac namespac project namespac int mainint argc char argv testinginitgoogletestargc argv return run_all_test testinginitgoogletest function pars command line googletest flag remov recogn flag allow user control test program behavior via variou flag well cover advancedguideadvancedmd must call function call run_all_test flag wont properli initi window initgoogletest also work wide string use program compil unicod mode well mayb think write main function much work agre complet that googl test provid basic implement main fit need link test gtest_main librari good go callout note note parsegunitflag deprec favor initgoogletest known limit googl test design threadsaf implement threadsaf system pthread librari avail current _unsafe_ use googl test assert two thread concurr system eg window test issu usual assert done main thread want help volunt implement necessari synchron primit gtestporth platform support platform googletest requir codebas compil compliant c standard newer googletest code offici support follow platform oper system tool list communitysupport communitysupport platform patch complic code may consid notic problem platform pleas file issu googletest github issu trackerhttpsgithubcomgooglegoogletestissu pull request contain fix welcom oper system linux maco window compil gcc clang msvc maco user xcode provid clang build system bazelhttpsbazelbuild cmakehttpscmakeorg bazel build system use team intern test cmake support besteffort basi commun gmock dummi gmock write prototyp test often feasibl wise reli real object entir mock object implement interfac real object use one let specifi run time use method call order mani time argument return etc easi confus term fake object mock object fake mock actual mean differ thing testdriven develop tdd commun fake object work implement usual take shortcut perhap make oper less expens make suitabl product inmemori file system would exampl fake mock object preprogram expect form specif call expect receiv seem abstract dont worri import thing rememb mock allow check interact code use differ fake mock shall becom much clearer start use mock gmock librari sometim also call framework make sound cool creat mock class use c jmockeasymock java well less use gmock first use simpl macro describ interfac want mock expand implement mock class next creat mock object specifi expect behavior use intuit syntax exercis code use mock object gmock catch violat expect soon aris gmock mock object help remov unnecessari depend test make fast reliabl use mock manual c hard someon implement mock job usual tediou errorpron wonder peopl go great distanc avoid qualiti manual written mock bit uh unpredict may see realli polish one may also see hack hurri sort ad hoc restrict knowledg gain use one mock doesnt transfer next one contrast java python programm fine mock framework jmock easymock etc autom creation mock result mock proven effect techniqu wide adopt practic commun right tool absolut make differ gmock built help c programm inspir jmock easymock design cs specif mind friend follow problem bother stuck suboptim design wish done prototyp late prototyp c mean rapid test slow depend mani librari use expens resourc eg databas test brittl resourc use unreli eg network want test code handl failur eg file checksum error easi caus one need make sure modul interact modul right way hard observ interact therefor resort observ side effect end action awkward best want mock depend except dont mock implement yet frankli arent thrill handwritten mock encourag use gmock design tool let experi interfac design earli often iter lead better design test tool cut test outbound depend probe interact modul collabor get start gmock bundl googletest case mock turtl let look exampl suppos develop graphic program reli logohttpenwikipediaorgwikilogo_programming_languagelik api draw would test right thing well run compar screen golden screen snapshot let admit test like expens run fragil upgrad shini new graphic card better antialias suddenli updat golden imag would pain test like fortun learn depend injectionhttpenwikipediaorgwikidependency_inject know right thing instead applic talk system api directli wrap api interfac say turtl code interfac cpp class turtl virtual turtl virtual void penup virtual void pendown virtual void forwardint distanc virtual void turnint degre virtual void gotoint x int virtual int getx const virtual int geti const note destructor turtl must virtual case class intend inherit otherwis destructor deriv class call delet object base pointer youll get corrupt program state like memori leak control whether turtl movement leav trace use penup pendown control movement use forward turn goto final getx geti tell current posit turtl program normal use real implement interfac test use mock implement instead allow easili check draw primit program call argument order test written way much robust wont break new machin antialias differ easier read maintain intent test express code binari imag run much much faster write mock class lucki mock need use alreadi implement nice peopl howev find posit write mock class relax gmock turn task fun game well almost defin use turtl interfac exampl simpl step need follow deriv class mockturtl turtl take virtual function turtl possibl mock nonvirtu method use templatesgmock_cook_bookmdmockingnonvirtualmethod much involv public section child class write mock_method come fun part take function signatur cutandpast macro add two comma one return type name anoth name argument list your mock const method add th paramet contain const parenthes requir sinc your overrid virtual method suggest ad overrid keyword const method th paramet becom const overrid nonconst method overrid isnt mandatori repeat virtual function want mock done goe without say pure virtual method abstract class must either mock overridden process someth like cpp includ gmockgmockh bring gmock class mockturtl public turtl public mock_methodvoid penup overrid mock_methodvoid pendown overrid mock_methodvoid forward int distanc overrid mock_methodvoid turn int degre overrid mock_methodvoid goto int x int overrid mock_methodint getx const overrid mock_methodint geti const overrid dont need defin mock method somewher els mock_method macro gener definit simpl put defin mock class need decid put definit peopl put _testcc fine interfac mock say foo own person team otherwis owner foo chang test could break cant realli expect foo maintain fix everi test use foo rule thumb need mock foo own other defin mock class foo packag better test subpackag clearli separ product code test util put h cc_librari everyon refer test foo ever chang one copi mockfoo chang test depend chang method need fix anoth way introduc thin layer fooadaptor top foo code new interfac sinc fooadaptor absorb chang foo much easili work initi care choos adaptor interfac make code easier write readabl net win long run choos fooadaptor fit specif domain much better foo use mock test mock class use easi typic work flow import gmock name test namespac use unqualifi per file rememb namespac good idea creat mock object specifi expect mani time method call argument etc exercis code use mock option check result use googletest assert mock method call expect wrong argument youll get error immedi mock destruct gmock automat check whether expect satisfi here exampl cpp includ pathtomockturtleh includ gmockgmockh includ gtestgtesth use testingatleast testpaintertest candrawsometh mockturtl turtl expect_callturtl pendown timesatleast painter painterturtl expect_truepainterdrawcircl might guess test check pendown call least painter object didnt call method test fail messag like text pathtomy_testcc failur actual function call count doesnt match expect actual never call expect call least stack trace tip run test emac buffer hit enter line number jump right fail expect tip mock object never delet final verif wont happen therefor good idea turn heap checker test alloc mock heap get automat use gtest_main librari alreadi import note gmock requir expect set mock function call otherwis behavior undefin altern call expect_cal call mock function set expect mock pass mock api mean expect_cal read expect call occur futur call occur gmock work like well specifi expect beforehand allow gmock report violat soon rise context stack trace etc still avail make debug much easier admittedli test contriv doesnt much easili achiev effect without use gmock howev shall reveal soon gmock allow much mock set expect key use mock object success set right expect set expect strict test fail result unrel chang set loos bug slip want right test catch exactli kind bug intend catch gmock provid necessari mean right gener syntax gmock use expect_cal macro set expect mock method gener syntax cpp expect_callmock_object methodmatch timescardin willonceact willrepeatedlyact macro two argument first mock object method argument note two separ comma period use comma answer necessari technic reason method overload macro also call without matcher cpp expect_callmock_object nonoverloadedmethod timescardin willonceact willrepeatedlyact syntax allow test writer specifi call argument without explicitli specifi number type argument avoid unintend ambigu syntax may use method overload either form macro follow option claus provid inform expect well discuss claus work come section syntax design make expect read like english exampl probabl guess cpp use testingreturn expect_callturtl getx time willoncereturn willoncereturn willrepeatedlyreturn say turtl object getx method call five time return first time second time everi time peopl like call style syntax domainspecif languag dsl callout note note use macro well serv two purpos first make expect easili identifi either grep human reader second allow gmock includ sourc file locat fail expect messag make debug easier matcher argument expect mock function take argument may specifi argument expect exampl cpp expect turtl move forward unit expect_callturtl forward oftentim want specif rememb talk test rigid specif lead brittl test obscur intent test therefor encourag specifi what necessaryno less arent interest valu argument write _ argument mean anyth goe cpp use testing_ expect turtl jump somewher x line expect_callturtl goto _ _ instanc call matcher matcher like predic test whether argument wed expect use matcher insid expect_cal wherev function argument expect _ conveni way say valu exampl also matcher implicitli eq eq specifi argument must equal use oper matcher argument mani builtin matchersreferencematchersmd common type well custom matchersgmock_cook_bookmdnewmatch exampl cpp use testingg expect turtl move forward least expect_callturtl forwardg dont care argument rather specifi _ may instead omit paramet list cpp expect turtl move forward expect_callturtl forward expect turtl jump somewher expect_callturtl goto work nonoverload method method overload need help gmock resolv overload expect specifi number argument possibl also type argumentsgmock_cook_bookmdselectoverload cardin mani time call first claus specifi follow expect_cal time call argument cardin tell mani time call occur allow us repeat expect mani time without actual write mani time importantli cardin fuzzi like matcher allow user express intent test exactli interest special case say time may guess mean function shouldnt call given argument gmock report googletest failur whenev function wrong call weve seen atleastn exampl fuzzi cardin earlier list builtin cardin use see heregmock_cheat_sheetmdcardinalitylist time claus omit omit time gmock infer cardin rule easi rememb neither willonc willrepeatedli expect_cal infer cardin time n willonc willrepeatedli n cardin timesn n willonc one willrepeatedli n cardin timesatleastn quick quiz think happen function expect call twice actual call four time action rememb mock object doesnt realli work implement user tell method invok easi gmock first return type mock function builtin type pointer function default action void function return bool function return fals function return addit c mock function whose return type defaultconstruct ie default constructor default action return defaultconstruct valu dont say anyth behavior use second mock function doesnt default action default action doesnt suit specifi action taken time expect match use seri willonc claus follow option willrepeatedli exampl cpp use testingreturn expect_callturtl getx willoncereturn willoncereturn willoncereturn say turtlegetx call exactli three time gmock infer mani willonc claus weve written sinc didnt explicitli write time return respect cpp use testingreturn expect_callturtl geti willoncereturn willoncereturn willrepeatedlyreturn say turtlegeti call least twice gmock know weve written two willonc claus willrepeatedli explicit time return respect first two time third time cours explicitli write time gmock tri infer cardin number specifi larger willonc claus well willonc use gmock default action function everi time unless cours willrepeatedli insid willonc besid return return refer use returnrefvari invok predefin function among othersgmock_cook_bookmdusingact import note expect_cal statement evalu action claus even though action may perform mani time therefor must care side effect follow may want cpp use testingreturn int n expect_callturtl getx time willrepeatedlyreturnn instead return consecut mock function alway return n evalu similarli returnnew foo creat new foo object expect_cal execut return pointer everi time want side effect happen everi time need defin custom action well teach cook bookgmock_cook_bookmd time anoth quiz think follow mean cpp use testingreturn expect_callturtl geti time willoncereturn obvious turtlegeti expect call four time think return everi time think twice rememb one willonc claus consum time function invok default action taken afterward right answer turtlegeti return first time return second time return default action int function use multipl expect multiexpect far weve shown exampl singl expect realist youll specifi expect multipl mock method may multipl mock object default mock method invok gmock search expect revers order defin stop activ expect match argument found think newer rule overrid older one match expect take call get upperboundviol failur here exampl cpp use testing_ expect_callturtl forward_ expect_callturtl forward time forward call three time row third time error last match expect satur howev third forward call replac forward would ok match expect callout note note gmock search match revers order expect reason allow user set default expect mock object constructor test fixtur setup phase custom mock write specif expect test bodi two expect method want put one specif matcher specif rule would shadow gener one come callout tip tip common start catchal expect method timesanynumb omit argument _ argument overload make call method expect necessari method mention uninterest use method expect call ok see understand uninterest vs unexpect callsgmock_cook_bookmduninterestingvsunexpect order vs unord call orderedcal default expect match call even though earlier expect hasnt satisfi word call dont occur order expect specifi sometim may want expect call occur strict order say gmock easi cpp use testinginsequ testfootest drawslineseg insequ seq expect_callturtl pendown expect_callturtl forward expect_callturtl penup foo creat object type insequ expect scope put sequenc occur sequenti sinc reli constructor destructor object actual work name realli irrelev exampl test foo call three expect function order written call made outoford error care rel order call specifi arbitrari partial order answer ye detail found heregmock_cook_bookmdorderedcal expect sticki unless said otherwis stickyexpect let quick quiz see well use mock stuff alreadi would test turtl ask go origin exactli twice want ignor instruct receiv youv come answer take look compar note solv first dont cheat cpp use testing_ use testinganynumb expect_callturtl goto_ _ timesanynumb expect_callturtl goto time suppos turtlegoto call three time third time gmock see argument match expect rememb alway pick last match expect sinc said two call gmock report error immedi basic weve told use multipl expectationsmultiexpect section exampl show expect gmock sticki default sens remain activ even reach invoc upper bound import rule rememb affect mean spec differ done mani mock framework whyd think rule make common case easier express understand simpl let see youv realli understood follow code say cpp use testingreturn int n expect_callturtl getx willoncereturni think say turtlegetx call n time return consecut think twice problem said expect sticki second time turtlegetx call last latest expect_cal statement match immedi lead upper bound violat error piec code use one correct way say turtlegetx return explicitli say expect sticki word retir soon satur cpp use testingreturn int n expect_callturtl getx willoncereturni retiresonsatur there better way case expect call occur specif order line action match order sinc order import make explicit use sequenc cpp use testinginsequ use testingreturn insequ int n expect_callturtl getx willoncereturni retiresonsatur way situat expect may sticki sequenc soon anoth expect come sequenc use automat retir never use match call uninterest call mock object may mani method interest exampl test may care mani time getx geti get call gmock interest method dont say anyth call method occur youll see warn test output wont failur call naggi behavior chang see nice strict naggygmock_cook_bookmdnicestrictnaggi quickstart build cmake tutori aim get run googletest use cmake your use googletest first time need refresh recommend tutori start point project use bazel see quickstart bazelquickstartbazelmd instead prerequisit complet tutori youll need compat oper system eg linux maco window compat c compil support least c cmakehttpscmakeorg compat build tool build project compat build tool includ makehttpswwwgnuorgsoftwaremak ninjahttpsninjabuildorg other see cmake generatorshttpscmakeorgcmakehelplatestmanualcmakegeneratorshtml inform see support platformsplatformsmd inform platform compat googletest dont alreadi cmake instal see cmake instal guidehttpscmakeorginstal callout note note termin command tutori show unix shell prompt command work window command line well set project cmake use file name cmakeliststxt configur build system project youll use file set project declar depend googletest first creat directori project mkdir my_project cd my_project next youll creat cmakeliststxt file declar depend googletest mani way express depend cmake ecosystem quickstart youll use fetchcont cmake modulehttpscmakeorgcmakehelplatestmodulefetchcontenthtml project directori my_project creat file name cmakeliststxt follow content cmake cmake_minimum_requiredvers projectmy_project googletest requir least c setcmake_cxx_standard includefetchcont fetchcontent_declar googletest url httpsgithubcomgooglegoogletestarchivecfefcfdceeffcccezip window prevent overrid parent project compilerlink set setgtest_force_shared_crt cach bool forc fetchcontent_makeavailablegoogletest configur declar depend googletest download github exampl cfefcfdceeffccc git commit hash googletest version use recommend updat hash often point latest version inform creat cmakeliststxt file see cmake tutorialhttpscmakeorgcmakehelplatestguidetutorialindexhtml creat run binari googletest declar depend use googletest code within project exampl creat file name hello_testcc my_project directori follow content cpp includ gtestgtesth demonstr basic assert testhellotest basicassert expect two string equal expect_strnehello world expect equal expect_eq googletest provid assertionsprimermdassert use test behavior code sampl includ main googletest header file demonstr basic assert build code add follow end cmakeliststxt file cmake enable_test add_execut hello_test hello_testcc target_link_librari hello_test gtest_main includegoogletest gtest_discover_testshello_test configur enabl test cmake declar c test binari want build hello_test link googletest gtest_main last two line enabl cmake test runner discov test includ binari use googletest cmake modulehttpscmakeorgcmakehelpgitstagemodulegoogletesthtml build run test pre strongmy_project cmake b buildstrong c compil identif gnu cxx compil identif gnu build file written my_projectbuild strongmy_project cmake build buildstrong scan depend target gtest built target gmock_main strongmy_project cd build cteststrong test project my_projectbuild start hellotestbasicassert test hellotestbasicassert pass sec test pass test fail total test time real sec pre congratul youv success built run test binari use googletest next step check primerprimermd start learn write simpl test see code samplessamplesmd exampl show use varieti googletest featur googletest user guid welcom googletest googletest googl c test mock framework user guid follow content googletest primerprimermd teach write simpl test use googletest read first new googletest googletest advancedadvancedmd read youv finish primer want util googletest full potenti googletest samplessamplesmd describ googletest sampl googletest faqfaqmd question want tip check first mock dummiesgmock_for_dummiesmd teach creat mock object use test mock cookbookgmock_cook_bookmd includ tip approach common mock use case mock cheat sheetgmock_cheat_sheetmd handi refer matcher action invari mock faqgmock_faqmd contain answer mockingspecif question legaci gmock faq call method mock object method real object invok instead what problem order method mock must virtual unless use highperf depend inject techniquegmock_cook_bookmdmockingnonvirtualmethod mock variad function mock variad function ie function take ellipsi argument directli gmock problem gener way mock object know mani argument pass variad method argument type author base class know protocol look head therefor mock function user must teach mock object figur number argument type one way provid overload version function ellipsi argument inherit c realli c featur unsaf use dont work argument constructor destructor therefor recommend avoid c much possibl msvc give warn c c defin mock method const paramet compil use microsoft visual c sp cpp class foo virtual void barconst int class mockfoo public foo mock_methodvoid bar const int overrid may get follow warn shell warn c mockfoobar overrid virtual function differ foobar constvolatil qualifi msvc bug code compil fine gcc exampl use visual c sp would get warn shell warn c mockfoobar virtual function overrid foobar previou version compil overrid paramet differ constvolatil qualifi c declar function const paramet const modifi ignor therefor foo base class equival cpp class foo virtual void barint int const int make differ fact declar bar int paramet defin const int paramet compil still match sinc make paramet const meaningless method declar recommend remov foo mockfoo workaround vc bug note talk toplevel const modifi function paramet pass pointer refer declar pointe refere const still meaning exampl follow two declar equival cpp void barint p neither p p const void barconst int p p const p cant figur gmock think expect satisfi might want run test gmock_verboseinfo flag let gmock print trace everi mock function call receiv studi trace youll gain insight expect set met see messag mock function default action set return type default valu set tri ad default actiongmock_cheat_sheetmdoncal due known issu unexpect call mock without default action dont print detail comparison actual argument expect argument program crash scopedmocklog spit ton messag gmock bug gmock scopedmocklog like right thing test crash failur signal handler tri log lot inform stack trace address map exampl messag compound mani thread depth stack scopedmocklog intercept messag find dont match expect print error learn ignor error rewrit expect make test robust exampl ad someth like cpp use testinganynumb use testingnot ignor log done us expect_calllog log_ notendswithmy_filecc _ timesanynumb assert function never call cpp use testing_ expect_callfoo bar_ time fail test gmock tell twice particular expect satisfi isnt redund gmock detect failur print relev inform mock function argument state relev expect etc help user debug anoth failur detect gmock includ print state relev expect sometim expect state didnt chang two failur youll see descript state twice howev redund refer differ point time fact interest inform get heapcheck failur use mock object use real object fine wrong class hope pure interfac mock virtual destructor whenev deriv base class make sure destructor virtual otherwis bad thing happen consid follow code cpp class base public virtual base class deriv public base public privat stdstring value_ base p new deriv delet p surpris base call deriv value_ leak chang base virtual deriv correctli call delet p execut heap checker happi newer expect overrid older one rule make write expect awkward gmock peopl complain often refer code like cpp use testingreturn foobar call twice return first time return second time howev write expect revers order suck big time expect_callfoo bar willoncereturn retiresonsatur expect_callfoo bar willoncereturn retiresonsatur problem didnt pick best way express test intent default expect dont match particular order want match certain order need explicit gmock jmock fundament philosophi easi accident overspecifi test want make harder two better way write test spec could either put expect sequenc cpp use testingreturn foobar call twice return first time return second time use sequenc write expect natur order insequ expect_callfoo bar willoncereturn retiresonsatur expect_callfoo bar willoncereturn retiresonsatur put sequenc action expect cpp use testingreturn foobar call twice return first time return second time expect_callfoo bar willoncereturn willoncereturn retiresonsatur back origin question gmock search expect on_cal back front allow user set mock behavior common case earli eg mock constructor test fixtur setup phase custom specif rule later gmock search front back use pattern wont possibl gmock print warn function without expect_cal call even set behavior use on_cal would reason show warn case choos neat safe lean toward latter answer think better show warn often peopl write on_cal mock object constructor setup default behavior rare chang test test test bodi set expect often differ test on_cal setup part test doesnt mean call expect there expect_cal method call possibl error quietli let call go without notifi user bug may creep unnot howev sure call ok write cpp use testing_ expect_callfoo bar_ willrepeatedli instead cpp use testing_ on_callfoo bar_ willbydefault tell gmock expect call warn print also control verbos specifi gmock_verboseerror valu info warn find output noisi debug choos less verbos level delet mock function argument action mock function take pointer argument want delet argument use testingdeleteargn delet nth zeroindex argument cpp use testing_ mock_methodvoid bar x x const expect_callmock_foo_ bar_ _ willoncetestingdeletearg perform arbitrari action mock function argument find need perform action that support gmock directli rememb defin action use makeactionnewmonoact makepolymorphicactionnewpolyact write stub function invok use invokefunctionsasact cpp use testing_ use testinginvok mock_methodvoid bar x p expect_callmock_foo_ bar_ willonceinvokemyact code call staticglob function mock need make chang gener find need mock static function sign modul tightli coupl less flexibl less reusabl less testabl etc probabl better defin small interfac call function interfac easili mock bit work initi usual pay quickli googl test blog posthttpstestinggoogleblogcomdefeatstaticclinghtml say excel check mock object need complex stuff lot pain specifi action gmock suck know question get answer free way gmock creat mock c easili peopl might tempt use everywher sometim work great sometim may find well pain use what wrong latter case write test without use mock exercis code assert return correct valu system expect state sometim call statebas test mock great call interactionbas test instead check system state end mock object verifi invok right way report error soon aris give handl precis context error trigger often effect econom statebas test statebas test use test doubl simul real object probabl better use fake use mock case caus pain strong point mock perform complex action experi think mock suck use right tool problem might tri solv wrong problem got warn uninterest function call encount default action taken panic mean fyi mean mock function havent set expect gmock rule mean interest call function therefor call number time call that ok didnt say ok call function actual meant disallow function call forgot write expect_callfoo bartim one argu user fault gmock tri nice print note see messag believ shouldnt uninterest call investig what go make life easier gmock dump stack trace uninterest call encount figur mock function call want defin custom action use invok implement actioninterfac interfac either way fine want choos one that conveni circumst usual action particular function type defin use invok easier action use function differ type eg defin returnvalu makepolymorphicact easiest sometim want precis control type function action use implement actioninterfac way go see implement return testingbasepublicgmockactionsh exampl use setargpointe willonc gcc complain conflict return type specifi mean got error gmock idea valu return mock method call setargpointe say side effect doesnt say return valu need doall chain setargpointe return provid valu appropri api mock see recipegmock_cook_bookmdmockingsideeffect detail exampl huge mock class microsoft visual c run memori compil weve notic clr compil flag use visual c use time much memori compil mock class suggest avoid clr compil nativ c mock gmock cookbook find recip use gmock havent yet pleas read dummi guidegmock_for_dummiesmd first make sure understand basic callout note note gmock live test name space readabl recommend write use testingfoo file use name foo defin gmock omit use statement section breviti code creat mock class mock class defin normal class use mock_method macro gener mock method macro get paramet cpp class mymock public mock_methodreturntyp methodnam arg mock_methodreturntyp methodnam arg spec first paramet simpli method declar split part th paramet accept close list qualifi affect gener method const make mock method const method requir overrid const method overrid mark method overrid recommend overrid virtual method noexcept mark method noexcept requir overrid noexcept method calltyp set call type method eg stdmethodcalltyp use window ref mark method refer qualif specifi requir overrid method refer qualif eg ref ref deal unprotect comma unprotect comma ie comma surround parenthes prevent mock_method pars argument correctli bad cpp class mockfoo public mock_methodstdpairbool int getpair wont compil mock_methodbool checkmap stdmapint doubl bool wont compil solut wrap parenthes good cpp class mockfoo public mock_methodstdpairbool int getpair mock_methodbool checkmap stdmapint doubl bool note wrap return argument type parenthes gener invalid c mock_method remov parenthes solut defin alia good cpp class mockfoo public use boolandint stdpairbool int mock_methodboolandint getpair use mapintdoubl stdmapint doubl mock_methodbool checkmap mapintdoubl bool mock privat protect method must alway put mock method definit mock_method public section mock class regardless method mock public protect privat base class allow on_cal expect_cal refer mock function outsid mock class ye c allow subclass chang access level virtual function base class exampl cpp class foo public virtual bool transformgadget g protect virtual void resum privat virtual int gettimeout class mockfoo public foo public mock_methodbool transform gadget g overrid follow must public section even though method protect privat base class mock_methodvoid resum overrid mock_methodint gettimeout overrid mock overload method mock overload function usual special attent requir cpp class foo must virtual well inherit foo virtual foo overload type andor number argument virtual int addel x virtual int addint time element x overload const object virtual bar getbar virtual const bar getbar const class mockfoo public foo mock_methodint add element x overrid mock_methodint add int time element x overrid mock_methodbar getbar overrid mock_methodconst bar getbar const overrid callout note note dont mock version overload method compil give warn method base class hidden fix use use bring scope cpp class mockfoo public foo use fooadd mock_methodint add element x overrid dont want mock int addint time element x mock class templat mock class templat like class cpp templat typenam elem class stackinterfac must virtual well inherit stackinterfac virtual stackinterfac virtual int getsiz const virtual void pushconst elem x templat typenam elem class mockstack public stackinterfaceelem mock_methodint getsiz overrid mock_methodvoid push const elem x overrid mock nonvirtu method mockingnonvirtualmethod gmock mock nonvirtu function use hiperf depend inject case instead share common base class real class mock class unrel real class contain method signatur syntax mock nonvirtu method mock virtual method dont add overrid cpp simpl packet stream class none member virtual class concretepacketstream public void appendpacketpacket new_packet const packet getpacketsize_t packet_numb const size_t numberofpacket const mock packet stream class inherit defin getpacket numberofpacket class mockpacketstream public mock_methodconst packet getpacket size_t packet_numb const mock_methodsize_t numberofpacket const note mock class doesnt defin appendpacket unlik real class that fine long test doesnt need call next need way say want use concretepacketstream product code use mockpacketstream test sinc function virtual two class unrel must specifi choic compil time oppos run time one way templat code need use packet stream specif give code templat type argument type packet stream product instanti templat concretepacketstream type argument test instanti templat mockpacketstream exampl may write cpp templat class packetstream void createconnectionpacketstream stream templat class packetstream class packetread public void readpacketspacketstream stream size_t packet_num use createconnectionconcretepacketstream packetreaderconcretepacketstream product code use createconnectionmockpacketstream packetreadermockpacketstream test cpp mockpacketstream mock_stream expect_callmock_stream set expect mock_stream packetreadermockpacketstream readermock_stream exercis reader mock free function possibl directli mock free function ie cstyle function static method need rewrit code use interfac abstract class instead call free function say openfil directli introduc interfac concret subclass call free function cpp class fileinterfac public virtual bool openconst char path const char mode class file public fileinterfac public bool openconst char path const char mode overrid return openfilepath mode code talk fileinterfac open file easi mock function may seem like lot hassl practic often multipl relat function put interfac perfunct syntact overhead much lower concern perform overhead incur virtual function profil confirm concern combin recip mock nonvirtu methodsmockingnonvirtualmethod oldstyl mock_methodn macro gener mock_method macro introduc httpsgithubcomgooglegoogletestcommitcfbfcebbcffaedafc mock creat use famili macro collect call mock_methodn macro still support though migrat new mock_method recommend macro mock_methodn famili differ mock_method gener structur mock_methodnmethodnam returntypearg instead mock_methodreturntyp methodnam arg number n must equal number argument mock const method one must use mock_const_methodn mock class templat macro name must suffix _t order specifi call type macro name must suffix _with_calltyp call type first macro argument old macro new equival tabl trth colspansimplethtr tr tdoldtd tdcodemock_methodfoo boolintcodetd tr tr tdnewtd tdcodemock_methodbool foo intcodetd tr trth colspanconst methodthtr tr tdoldtd tdcodemock_const_methodfoo boolintcodetd tr tr tdnewtd tdcodemock_methodbool foo int constcodetd tr trth colspanmethod class templatethtr tr tdoldtd tdcodemock_method_tfoo boolintcodetd tr tr tdnewtd tdcodemock_methodbool foo intcodetd tr trth colspanconst method class templatethtr tr tdoldtd tdcodemock_const_method_tfoo boolintcodetd tr tr tdnewtd tdcodemock_methodbool foo int constcodetd tr trth colspanmethod call typethtr tr tdoldtd tdcodemock_method_with_calltypestdmethodcalltyp foo boolintcodetd tr tr tdnewtd tdcodemock_methodbool foo int calltypestdmethodcalltypecodetd tr trth colspanconst method call typethtr tr tdoldtd tdcodemock_const_method_with_calltypestdmethodcalltyp foo boolintcodetd tr tr tdnewtd tdcodemock_methodbool foo int const calltypestdmethodcalltypecodetd tr trth colspanmethod call type class templatethtr tr tdoldtd tdcodemock_method_t_with_calltypestdmethodcalltyp foo boolintcodetd tr tr tdnewtd tdcodemock_methodbool foo int calltypestdmethodcalltypecodetd tr trth colspanconst method call type class templatethtr tr tdoldtd tdcodemock_const_method_t_with_calltypestdmethodcalltyp foo boolintcodetd tr tr tdnewtd tdcodemock_methodbool foo int const calltypestdmethodcalltypecodetd tr tabl nice strict naggi nicestrictnaggi mock method expect_cal spec call say uninterest call default action specifi use on_cal method taken current uninterest call also default caus gmock print warn futur might remov warn default howev sometim may want ignor uninterest call sometim may want treat error gmock let make decis permockobject basi suppos test use mock class mockfoo cpp test mockfoo mock_foo expect_callmock_foo dothi code use mock_foo method mock_foo dothi call get warn howev rewrit test use nicemockmockfoo instead suppress warn cpp use testingnicemock test nicemockmockfoo mock_foo expect_callmock_foo dothi code use mock_foo nicemockmockfoo subclass mockfoo use wherev mockfoo accept also work mockfoo constructor take argument nicemockmockfoo inherit mockfoo constructor cpp use testingnicemock test nicemockmockfoo mock_foo hi call mockfoo hi expect_callmock_foo dothi code use mock_foo usag strictmock similar except make uninterest call failur cpp use testingstrictmock test strictmockmockfoo mock_foo expect_callmock_foo dothi code use mock_foo test fail method mock_foo dothi call callout note note nicemock strictmock affect uninterest call call method expect affect unexpect call call method expect dont match see understand uninterest vs unexpect callsuninterestingvsunexpect caveat though sadli side effect cs limit nicemockmockfoo strictmockmockfoo work mock method defin use mock_method macro directli mockfoo class mock method defin base class mockfoo nice strict modifi may affect depend compil particular nest nicemock strictmock eg nicemockstrictmockmockfoo support nicemockmockfoo strictmockmockfoo may work correctli destructor mockfoo virtual would like fix requir clean exist test final cautiou use naggi strict mock tend make test brittl harder maintain refactor code without chang extern visibl behavior ideal shouldnt need updat test code interact naggi mock howev may start get spam warn result chang wors code interact strict mock test may start fail youll forc fix gener recommend use nice mock yet default time use naggi mock current default develop debug test use strict mock last resort simplifi interfac without break exist code simplerinterfac sometim method long list argument mostli uninterest exampl cpp class logsink public virtual void sendlogsever sever const char full_filenam const char base_filenam int line const struct tm tm_time const char messag size_t message_len method argument list lengthi hard work messag argument even termin mock use mock awkward howev tri simplifi interfac well need fix client depend often infeas trick redispatch method mock class cpp class scopedmocklog public logsink public void sendlogsever sever const char full_filenam const char base_filenam int line const tm tm_time const char messag size_t message_len overrid interest log sever full file name log messag logsever full_filenam stdstringmessag message_len implement mock method void loglogsever sever const string file_path const string messag mock_methodvoid log logsever sever const string file_path const string messag defin new mock method trim argument list make mock class userfriendli techniqu may also appli make overload method amen mock exampl overload use implement default argument cpp class mockturtlefactori public turtlefactori public turtl maketurtleint length int weight overrid turtl maketurtleint length int weight int speed overrid method deleg one mock_methodturtl domaketurtl allow test dont care overload invok avoid specifi argument matcher cpp on_callfactori domaketurtl willbydefaultreturnmakemockturtl altern mock concret class often may find use class dont implement interfac order test code use class let call concret may tempt make method concret virtual mock tri make nonvirtu function virtual big decis creat extens point subclass tweak class behavior weaken control class harder maintain class invari make function virtual valid reason subclass overrid mock concret class directli problemat creat tight coupl class test small chang class may invalid test make test mainten pain avoid problem mani programm practic code interfac instead talk concret class code would defin interfac talk implement interfac adaptor top concret test easili mock interfac observ code techniqu incur overhead pay cost virtual function call usual problem abstract programm learn howev also bring signific benefit addit better testabl concret api may fit problem domain well may client tri serv design interfac chanc tailor need may add higherlevel function renam stuff etc instead trim class allow write code user interfac natur way mean readabl maintain youll product concret implement ever chang dont rewrit everywher use instead absorb chang implement interfac code test insul chang peopl worri everyon practic techniqu end write lot redund code concern total understand howev two reason may case differ project may need use concret differ way best interfac differ therefor domainspecif interfac top concret code enough project want use interfac alway share like share concret check interfac adaptor somewher near concret perhap contrib subdirectori let mani project use need weigh pro con care particular problem id like assur java commun practic long time proven effect techniqu applic wide varieti situat deleg call fake delegatingtofak time nontrivi fake implement interfac exampl cpp class foo public virtual foo virtual char dothisint n virtual void dothatconst char int p class fakefoo public foo public char dothisint n overrid return n n void dothatconst char int p overrid p strlen want mock interfac set expect howev also want use fakefoo default behavior duplic mock object well lot work defin mock class use gmock deleg default action fake class alreadi use pattern cpp class mockfoo public foo public normal mock method definit use gmock mock_methodchar dothi int n overrid mock_methodvoid dothat const char int p overrid deleg default action method fakefoo object must call custom on_cal statement void delegatetofak on_callthi dothiswillbydefaultthisint n return fake_dothisn on_callthi dothatwillbydefaultthisconst char int p fake_dothat p privat fakefoo fake_ keep instanc fake mock use mockfoo test usual rememb dont explicitli set action on_cal expect_cal fake call upon cpp use testing_ testabctest xyz mockfoo foo foodelegatetofak enabl fake deleg put on_callfoo action specifi mean use default action expect_callfoo dothi expect_callfoo dothat_ _ int n expect_eq foodothi fakefoodothi invok foodothathi n fakefoodothat invok expect_eq n tip want still overrid default action provid on_cal use willonc willrepeatedli expect_cal delegatetofak need deleg method whose fake implement intend use gener techniqu discuss work overload method youll need tell compil version mean disambigu mock function one specifi insid parenthes on_cal use techniqueselectoverload disambigu fake function one place insid invok use static_cast specifi function type instanc class foo method char dothisint n bool dothisdoubl x const want invok latter need write invokefake_ static_castbool fakefoodoubl constfakefoodothi instead invokefake_ fakefoodothi strangelook thing insid angl bracket static_cast type function pointer second dothi method mix mock fake often sign someth gone wrong perhap havent got use interactionbas way test yet perhap interfac take mani role split therefor dont abus would recommend intermedi step refactor code regard tip mix mock fake here exampl may bad sign suppos class system lowlevel system oper particular file io oper suppos want test code use system io want file oper work normal mock entir system class youll provid fake implement file oper part suggest system take mani role instead defin fileop interfac ioop interfac split system function two mock ioop without mock fileop deleg call real object use test doubl mock fake stub etc sometim behavior differ real object differ could either intent simul error test error handl code unintent mock differ behavior real object mistak could end code pass test fail product use delegatingtor techniqu ensur mock behavior real object retain abil valid call techniqu similar delegatingtofakedelegatingtofak techniqu differ use real object instead fake here exampl cpp use testingatleast class mockfoo public foo public mockfoo default call deleg real object on_callthi dothiswillbydefaultthisint n return real_dothisn on_callthi dothatwillbydefaultthisconst char int p real_dothat p mock_methodchar dothi mock_methodvoid dothat privat foo real_ mockfoo mock expect_callmock dothi time expect_callmock dothathi timesatleast use mock test gmock verifi code made right call right argument right order call right number time etc real object answer call behavior product give best world deleg call parent class ideal code interfac whose method pure virtual realiti sometim need mock virtual method pure ie alreadi implement exampl cpp class foo public virtual foo virtual void pureint n virtual int concreteconst char str class mockfoo public foo public mock pure method mock_methodvoid pure int n overrid mock concret method fooconcret shadow mock_methodint concret const char str overrid sometim may want call fooconcret instead mockfooconcret perhap want part stub action perhap test doesnt need mock concret would ohso pain defin new mock class whenev dont need mock one method call fooconcret insid action cpp expect_callfoo concretewilloncefooconst char str return foofooconcretestr tell mock object dont want mock concret cpp on_callfoo concretewillbydefaultfooconst char str return foofooconcretestr dont write return fooconcretestr mockfooconcret call caus infinit recurs sinc fooconcret virtual that c work use matcher match argument valu exactli specifi exactli argument mock method expect cpp use testingreturn expect_callfoo dothi willoncereturna expect_callfoo dothathello bar use simpl matcher use matcher match argument certain properti cpp use testingnotnul use testingreturn expect_callfoo dothisg argument must willoncereturna expect_callfoo dothathello notnul second argument must null frequent use matcher _ match anyth cpp expect_callfoo dothat_ notnul combin matcher combiningmatch build complex matcher exist one use allof allofarray anyof anyofarray cpp use testingallof use testinggt use testinghassubstr use testingn use testingnot argument must expect_callfoo dothisallofgt ne first argument must contain substr blah expect_callfoo dothatnothassubstrblah null matcher function object parametr matcher compos like function howev type long rare provid meaning inform easier express c gener lambda avoid specifi type exampl cpp use testingcontain use testingproperti inlin constexpr auto hasfoo const auto f return propertymyclassfoo containsf expect_thatx hasfooblah cast matcher safematchercast gmock matcher static type mean compil catch mistak use matcher wrong type exampl use eq match string argument good sometim howev know your want compil give slack one exampl matcher long argument want match int two type arent exactli noth realli wrong use matcherlong match int first convert int argument long losslessli give matcher support need gmock give safematchercasttm function cast matcher type matchert ensur safeti gmock check let u type accept type implicitli cast type u u builtin arithmet type bool integ floatingpoint number convers u lossi word valu represent also repres u u refer must also refer underli matcher may interest address u valu code wont compil condit isnt met here one exampl cpp use testingsafematchercast base class child class class base class deriv public base class mockfoo public foo public mock_methodvoid dothi deriv deriv overrid mockfoo foo matcherbas got somewher expect_callfoo dothissafematchercastderivedm find safematchercasttm limit use similar function matchercasttm differ matchercast work long static_cast type type u matchercast essenti let bypass cs type system static_cast isnt alway safe could throw away inform exampl care misuseabus select overload function selectoverload expect overload function call compil may need help overload version disambigu function overload const object use const argument wrapper cpp use testingreturnref class mockfoo public foo mock_methodbar getbar overrid mock_methodconst bar getbar const overrid mockfoo foo bar bar bar expect_callfoo getbar nonconst getbar willoncereturnrefbar expect_callconstfoo getbar const getbar willoncereturnrefbar const defin gmock return const refer argument disambigu overload function number argument differ argument type may need specifi exact type matcher either wrap matcher matchertyp use matcher whose type fix typedeqtyp antyp etc cpp use testingan use testingmatch use testingtypedeq class mockprint public printer public mock_methodvoid print int n overrid mock_methodvoid print char c overrid testprintertest print mockprint printer expect_callprint printanint void printint expect_callprint printmatcherintlt void printint expect_callprint printtypedeqchara void printchar printerprint printerprint printerprinta perform differ action base argument mock method call last match expect that still activ select think newer overrid older make method differ thing depend argument valu like cpp use testing_ use testinglt use testingreturn default case expect_callfoo dothis_ willrepeatedlyreturnb specif case expect_callfoo dothislt willrepeatedlyreturna foodothi call valu less return otherwis b return match multipl argument whole sometim enough match argument individu exampl may want say first argument must less second argument claus allow us match argument mock function whole exampl cpp use testing_ use testingn use testinglt expect_callfoo inrangen _ withlt say first argument inrang must must less second argument express insid must matcher type matcherstdtuplea type function argument also write allargsm instead insid two form equival withallargslt readabl withlt use argsk knm match n select argument tupl exampl cpp use testing_ use testingallof use testingarg use testinglt expect_callfoo blah withallofarg lt arg lt say blah call argument x z x z note exampl wasnt necessari specifi posit matcher conveni exampl gmock provid matcher tupl includ lt matcher see multiargu matchersreferencematchersmdmultiargmatch complet list note want pass argument predic eg witharg trulymypred predic must written take stdtupl argument gmock pass n select argument one singl tupl predic use matcher predic notic matcher fanci predic also know describ mani exist algorithm take predic argument eg defin stl algorithm header would shame gmock matcher allow particip luckili use matcher unari predic functor expect wrap insid match function exampl cpp includ algorithm includ vector use testingmatch use testingg vectorint v mani element v const int count count_ifvbegin vend matchesg sinc build complex matcher simpler one easili use gmock give way conveni construct composit predic use stl function header pain exampl here predic that satisfi number cpp use testingallof use testingg use testingl use testingmatch use testingn matchesallofg le ne use matcher googletest assert see expect_thatreferenceassertionsmdexpect_that assert refer use predic matcher gmock provid set builtin matcher match argument expect valuesse matcher referencereferencematchersmd inform case find builtin set lack use arbitrari unari predic function functor matcher long predic accept valu type want wrap predic insid truli function exampl cpp use testingtruli int isevenint n return n bar must call even number expect_callfoo bartrulyiseven note predic function functor doesnt return bool work long return valu use condit statement condit match argument copyabl expect_callmock_obj foobar gmock save away copi bar foo call later gmock compar argument foo save copi bar way dont need worri bar modifi destroy expect_cal execut true use matcher like eqbar lebar bar copi ie copi constructor could defin matcher function callback use truli previou coupl recip shown may abl get away guarante bar wont chang expect_cal execut tell gmock save refer bar instead copi here cpp use testingeq use testinglt expect foo argument bar expect_callmock_obj fooeqstdrefbar expect foo argument bar expect_callmock_obj fooltstdrefbar rememb dont chang bar expect_cal result undefin valid member object often mock function take refer object argument match argument may want compar entir object fix object may overspecif instead may need valid certain member variabl result certain getter method object field properti specif cpp fieldfoobar matcher match foo object whose bar member variabl satisfi matcher cpp propertyfoobaz matcher match foo object whose baz method return valu satisfi matcher exampl express descript fieldfoonumb ge match x xnumber propertyfoonam startswithjohn match x xname start john note propertyfoobaz method baz must take argument declar const dont use properti member function take address function fragil gener part contract function field properti also match plain pointer object instanc cpp use testingfield use testingg fieldfoonumb ge match plain pointer p pnumber p null match alway fail regardless inner matcher want valid one member time rememb allof allofarraycombiningmatch final field properti provid overload take field properti name first argument includ error messag use creat combin matcher cpp use testingallof use testingfield use testingmatch use testingsafematchercast matcherfoo isfooconst foo foo return alloffieldsome_field foosome_field foosome_field fieldother_field fooother_field fooother_field fieldlast_field foolast_field foolast_field valid valu point pointer argument c function often take pointer argument use matcher like isnul notnul comparison matcher match pointer want make sure valu point pointer instead pointer certain properti well use pointeem matcher pointeem match pointer match valu pointer point exampl cpp use testingg use testingpointe expect_callfoo barpointeeg expect foobar call pointer point valu greater equal one nice thing pointe treat null pointer match failur write pointeem instead cpp use testingallof use testingnotnul use testingpointe allofnotnul pointeem without worri null pointer crash test also tell pointe work raw pointer smart pointer stdunique_ptr stdshared_ptr etc pointer pointer guess use nest pointe probe deeper insid valu exampl pointeepointeelt match pointer point pointer point number less mouth test certain properti object sometim want specifi object argument certain properti exist matcher want good error messag defin matchernewmatch want quick dirti could get away write ordinari function let say mock function take object type foo int bar method int baz method want constrain argument bar valu plu baz valu given number here defin matcher cpp use testingmatch class barplusbazeqmatch public explicit barplusbazeqmatcherint expected_sum expected_sum_expected_sum bool matchandexplainconst foo foo stdostream listen const return foobar foobaz expected_sum_ void describetostdostream os const os bar baz equal expected_sum_ void describenegationtostdostream os const os bar baz equal expected_sum_ privat const int expected_sum_ matcherconst foo barplusbazeqint expected_sum return barplusbazeqmatcherexpected_sum expect_cal dothisbarplusbazeq match contain sometim stl contain eg list vector map pass mock function may want valid sinc stl contain support oper write eqexpected_contain simpli expected_contain match contain exactli sometim though may want flexibl exampl first element must exact match second element posit number also contain use test often small number element defin expect contain outoflin bit hassl use elementsar unorderedelementsar matcher case cpp use testing_ use testingelementsar use testinggt mock_methodvoid foo const vectorint number overrid expect_callmock fooelementsar gt _ matcher say contain must element must greater anyth respect instead write cpp use testing_ use testinggt use testingunorderedelementsar mock_methodvoid foo const vectorint number overrid expect_callmock foounorderedelementsar gt _ mean contain must element permut must greater anyth respect altern place argument cstyle array use elementsarearray unorderedelementsarearray instead cpp use testingelementsarearray elementsarearray accept array element valu const int expected_vector expect_callmock fooelementsarearrayexpected_vector array element matcher matcherint expected_vector gt _ expect_callmock fooelementsarearrayexpected_vector case array need dynam creat therefor array size infer compil give elementsarearray addit argument specifi array size cpp use testingelementsarearray int const expected_vector new intcount fill expected_vector valu expect_callmock fooelementsarearrayexpected_vector count use pair compar map associ contain raw cpp use testingelementsar use testingpair stdmapstr int b c expect_thatm elementsarepaira pairb pairc endraw tip elementsar use match contain implement stl iter pattern ie const_iter type support beginend one defin stl even work contain type yet written long follow pattern use nest elementsar match nest multidimension contain contain pass pointer instead refer write pointeeelementsar order element matter elementsar use contain whose element order undefin eg hash_map use whensort around elementsar share matcher hood gmock matcher object consist pointer refcount implement object copi matcher allow effici pointer copi last matcher refer implement object die implement object delet therefor complex matcher want use need build everytim assign matcher variabl use variabl repeatedli exampl cpp use testingallof use testinggt use testingl use testingmatch matcherint in_rang allofgt le use in_rang matcher multipl expect_cal matcher must sideeffect purematch callout warn warn gmock guarante mani time matcher invok therefor matcher must pure function side effect match result must depend anyth matcher paramet valu match requir must satisfi matter matcher defin eg one standard matcher custom matcher particular matcher never call mock function affect state mock object gmock set expect know expect useoncal on_cal like singl underutil construct gmock basic two construct defin behavior mock object on_cal expect_cal differ on_cal defin happen mock method call emdoesnt impli expect method calledem expect_cal defin behavior also set expect emth method call given argument given number timesem given order specifi order sinc expect_cal isnt better on_cal realli everi expect_cal add constraint behavior code test constraint necessari baaad even wors enough constraint may counterintuit could test verifi wors test verifi less isnt verif whole point test answer lie test verifi good test verifi contract code test overspecifi doesnt leav enough freedom implement result chang implement without break contract eg refactor optim perfectli fine break test spend time fix see broken next time implement chang keep mind one doesnt verifi one properti one test fact good style verifi one thing one test bug like break one two test instead dozen case would rather debug also habit give test descript name tell verifi often easili guess what wrong test log use on_cal default use expect_cal actual intend verifi call made exampl may bunch on_cal test fixtur set common mock behavior share test group write scarc differ expect_cal differ test_f verifi differ aspect code behavior compar style test mani expect_cal lead test resili implement chang thu less like requir mainten make intent test obviou easier maintain need maintain bother uninterest mock function call messag print mock method without expect_cal call may use nicemock instead suppress messag mock object suppress messag specif method ad expect_calltimesanynumb suppress blindli ad expect_cal youll test that pain maintain ignor uninterest call interest mock method call dont say anyth case method ever call gmock perform default action allow test program continu happi default action taken gmock overrid use defaultvaluetset describ heredefaultvalu on_cal pleas note express interest particular mock method via expect_cal invoc must match expect function call argument dont match expect_cal statement error disallow unexpect call mock method shouldnt call explicitli say cpp use testing_ expect_callfoo bar_ time call method allow rest list expect call cpp use testinganynumb use testinggt expect_callfoo bar expect_callfoo bargt timesanynumb call foobar doesnt match expect_cal statement error understand uninterest vs unexpect call uninterestingvsunexpect uninterest call unexpect call differ concept gmock differ call xy uninterest there even singl expect_callx set word test isnt interest xy method evid test doesnt care say anyth call xy unexpect expect_callx ys set none match call put anoth way test interest xy method therefor explicitli set expect_cal verifi call howev verif fail test doesnt expect particular call happen unexpect call alway error code test doesnt behav way test expect behav default uninterest call error violat constraint specifi test gmock philosophi say noth mean constraint howev lead warn might indic problem eg test author might forgotten specifi constraint gmock nicemock strictmock use make mock class nice strict affect uninterest call unexpect call nice mock suppress uninterest call warn less chatti default mock otherwis test fail default mock also fail use nice mock instead vice versa dont expect make mock nice chang test result strict mock turn uninterest call warn error make mock strict may chang test result let look exampl cpp test nicemockmockdomainregistri mock_registri expect_callmock_registri getdomainownergooglecom willrepeatedlyreturnlarri page use mock_registri code test mock_registri sole expect_cal say call getdomainown must googlecom argument getdomainowneryahoocom call unexpect call thu error nice mock doesnt chang sever unexpect call tell gmock getdomainown call argument well standard techniqu add catch expect_cal cpp expect_callmock_registri getdomainowner_ timesanynumb catch call method expect_callmock_registri getdomainownergooglecom willrepeatedlyreturnlarri page rememb _ wildcard matcher match anyth getdomainownergooglecom call second expect_cal say call differ argument first expect_cal say note order two expect_cal import newer expect_cal take preced older one uninterest call nice mock strict mock read nice strict naggynicestrictnaggi ignor uninterest argument parameterlessexpect test doesnt care paramet care number order call often simpli omit paramet list cpp expect foobar twice argument expect_callfoo bartim deleg given method whenev factori invok on_callfoo_factori makefoo willbydefaultbuildfoofortest function avail method overload prevent unexpect behavior compil error tri set expect method specif overload ambigu work around suppli simpler mock interfacesimplerinterfac mock class provid pattern also use argument interest match logic substanti complex leav argument list unspecifi use savearg action save valu later verificationsaveargverifi easili differenti call method wrong number time call wrong argument expect order call orderedcal although expect_cal statement defin later take preced gmock tri match function call expect default call dont happen order expect_cal statement written exampl argument match matcher second expect_cal first third second expect use would rather call occur order expect put expect_cal statement block defin variabl type insequ cpp use testing_ use testinginsequ insequ expect_callfoo dothi expect_callbar dothat_ time expect_callfoo dothi exampl expect call foodothi follow two call bardothat argument anyth turn follow call foodothi call occur outoford gmock report error expect partial order call partialord sometim requir everyth occur predetermin order lead brittl test exampl may care occur b c arent interest rel order b c case test reflect real intent instead overli constrain gmock allow impos arbitrari dag direct acycl graph call one way express dag use clausereferencemockingmdexpect_callaft expect_cal anoth way via insequ claus insequ class borrow jmock less flexibl conveni long chain sequenti call doesnt requir come differ name expect chain here work view expect_cal statement node graph add edg node node b wherev must occur b get dag use term sequenc mean direct path dag decompos dag sequenc need know sequenc expect_cal belong order abl reconstruct origin dag specifi partial order expect need two thing first defin sequenc object expect_cal say sequenc object part expect sequenc must occur order written exampl cpp use testingsequ sequenc expect_callfoo insequ expect_callbar b insequ expect_callbar c insequ expect_callfoo insequ specifi follow dag b c text b c mean must occur b c c must occur there restrict order control expect retir mock method call gmock consid expect still activ expect activ creat becom inact aka retir call occur later occur exampl cpp use testing_ use testingsequ sequenc expect_calllog logwarn _ file larg timesanynumb insequ expect_calllog logwarn _ data set empti insequ expect_calllog logwarn _ user found insequ soon either match retir warn file larg log error note expect doesnt retir automat satur exampl cpp use testing_ expect_calllog logwarn _ _ expect_calllog logwarn _ file larg say exactli one warn messag file larg second warn contain messag match result upperboundviol error want ask expect retir soon becom satur cpp use testing_ expect_calllog logwarn _ _ expect_calllog logwarn _ file larg retiresonsatur use two warn messag file larg first match second match error use action return refer mock method mock function return type refer need use returnref instead return return result cpp use testingreturnref class mockfoo public foo public mock_methodbar getbar overrid mockfoo foo bar bar expect_callfoo getbar willoncereturnrefbar return live valu mock method returnx action save copi x action creat alway return valu whenev execut sometim may want instead return live valu x ie valu time action execut use either returnref returnpointe purpos mock function return type refer use returnrefx shown previou recip return refer mock method howev gmock doesnt let use returnref mock function whose return type refer usual indic user error shall though may tempt use stdref cpp use testingreturn class mockfoo public foo public mock_methodint getvalu overrid int x mockfoo foo expect_callfoo getvalu willrepeatedlyreturnstdrefx wrong x expect_eq foogetvalu unfortun doesnt work code fail error text valu foogetvalu actual expect reason returnvalu convert valu actual return type mock function time action creat execut behavior chosen action safe valu proxi object refer temporari object result stdrefx convert int valu instead const int expect set returnstdrefx alway return returnpointeepoint provid solv problem specif return valu point pointer time action execut cpp use testingreturnpointe int x mockfoo foo expect_callfoo getvalu willrepeatedlyreturnpointeex note x expect_eq foogetvalu succeed combin action want one thing function call that fine doall allow sequenc action everi time return valu last action sequenc use cpp use testing_ use testingdoal class mockfoo public foo public mock_methodbool bar int n overrid expect_callfoo bar_ willoncedoallaction_ action_ action_n verifi complex argument saveargverifi want verifi method call particular argument match criteria complex difficult distinguish cardin failur call method wrong number time argument match failur similarli match multipl paramet may easi distinguish argument fail match exampl cpp ideal could fail problem arg arg mayb method wasnt call expect_callfoo sendvalues_ elementsar equalsproto instead save argument test individu cpp expect_callfoo sendvalu willoncedoallsaveargactual_array saveargactual_proto run test expect_thatactual_array elementsar expect_thatactual_proto equalsproto mock side effect mockingsideeffect sometim method exhibit effect via return valu via side effect exampl may chang global state modifi output argument mock side effect gener defin action implement testingactioninterfac need chang output argument builtin setargpointe action conveni cpp use testing_ use testingsetargpointe class mockmut public mutat public mock_methodvoid mutat bool mutat int valu overrid mockmut mutat expect_callmut mutatetru _ willoncesetargpointe exampl mutatormut call assign int variabl point argument base setargpointe conveni make intern copi valu pass remov need keep valu scope aliv implic howev valu must copi constructor assign oper mock method also need return valu well chain setargpointe return use doall rememb put return statement last cpp use testing_ use testingreturn use testingsetargpointe class mockmut public mutat public mock_methodbool mutateint int valu overrid mockmut mutat expect_callmut mutateint_ willoncedoallsetargpointe returntru note howev use returnokwith method overrid valu provid setargpointe respons paramet function call output argument array use setarrayargumentnfirst last action instead copi element sourc rang first last array point nth base argument cpp use testingnotnul use testingsetarrayargu class mockarraymut public arraymut public mock_methodvoid mutat int valu int num_valu overrid mockarraymut mutat int valu expect_callmut mutatenotnul willoncesetarrayargumentvalu valu also work argument output iter cpp use testing_ use testingsetarrayargu class mockrolodex public rolodex public mock_methodvoid getnam stdback_insert_iteratorvectorstr overrid mockrolodex rolodex vectorstr name namespush_backgeorg namespush_backjohn namespush_backthoma expect_callrolodex getnames_ willoncesetarrayargumentnamesbegin namesend chang mock object behavior base state expect call chang behavior mock object use testinginsequ specifi differ behavior call cpp use testinginsequ use testingreturn insequ seq expect_callmy_mock isdirti willrepeatedlyreturntru expect_callmy_mock flush expect_callmy_mock isdirti willrepeatedlyreturnfals my_mockflushifdirti make my_mockisdirti return true my_mockflush call return fals afterward behavior chang complex store effect variabl make mock method get return valu variabl cpp use testing_ use testingsavearg use testingreturn action_preturnpointe p return p int previous_valu expect_callmy_mock getprevvalu willrepeatedlyreturnpointeeprevious_valu expect_callmy_mock updatevalu willrepeatedlysaveargprevious_valu my_mockdosomethingtoupdatevalu my_mockgetprevvalu alway return argument last updatevalu call set default valu return type defaultvalu mock method return type builtin c type pointer default return invok also c mock method whose return type default constructor return defaultconstruct valu default need specifi action default valu doesnt work sometim may want chang default valu may want specifi default valu type gmock doesnt know use testingdefaultvalu class templat cpp use testingdefaultvalu class mockfoo public foo public mock_methodbar calculatebar overrid bar default_bar set default return valu type bar defaultvaluebarsetdefault_bar mockfoo foo dont need specifi action default return valu work us expect_callfoo calculatebar foocalculatebar return default_bar unset default return valu defaultvaluebarclear pleas note chang default valu type make test hard understand recommend use featur judici exampl may want make sure set clear call right next code use mock set default action mock method youv learn chang default valu given type howev may coars purpos perhap two mock method return type want differ behavior on_cal macro allow custom mock behavior method level cpp use testing_ use testinganynumb use testinggt use testingreturn on_callfoo sign_ willbydefaultreturn on_callfoo sign willbydefaultreturn on_callfoo signgt willbydefaultreturn expect_callfoo sign_ timesanynumb foosign return foosign return foosign return may guess one on_cal statement newer one order take preced older one word last one match function argument use match order allow set common behavior mock object constructor test fixtur setup phase special mock behavior later note on_cal expect_cal later statement take preced rule dont interact expect_cal preced order distinct on_cal preced order use functionsmethodsfunctorslambda action functionsasact builtin action dont suit use exist callabl function stdfunction method functor lambda action cpp use testing_ use testinginvok class mockfoo public foo public mock_methodint sum int x int overrid mock_methodbool complexjob int x overrid int calculatesumint x int return x int sumint x int int z return x z class helper public bool complexjobint x mockfoo foo helper helper expect_callfoo sum_ _ willoncecalculatesum willrepeatedlyinvokenewpermanentcallbacksum expect_callfoo complexjob_ willonceinvokehelp helpercomplexjob willonc return true willrepeatedlyint x return x foosum invok calculatesum foosum invok sum foocomplexjob invok helpercomplexjob foocomplexjob invok inlin lambda requir type function etc must compat signatur mock function mean latter argument take implicitli convert correspond argument former former return type implicitli convert latter invok someth whose type exactli mock function long safe nice huh note action take ownership callback delet action destruct type callback deriv base callback type c need implicitli cast c resolv overload eg cpp use testinginvok resultcallbackbool is_ok invokeis_ok work blockingclosur done new blockingclosur invokeimplicit_castclosuredon cast necessari use function extra info action function functor call use invok must number argument mock function use sometim may function take argument will pass extra argument fill gap gmock use callback prebound argument here exampl cpp use testinginvok class mockfoo public foo public mock_methodchar dothi int n overrid char signofsumint x int const int sum x return sum sum test_ffootest test mockfoo foo expect_callfoo dothi willonceinvokenewpermanentcallbacksignofsum expect_eq foodothi invok signofsum invok functionmethodfunctorlambdacallback without argument invok pass mock function argument function etc invok calle full context call work invok function interest argument simpli ignor yet common pattern test author want invok function without argument mock function could use wrapper function throw away argument invok underlin nullari function needless say tediou obscur intent test two solut problem first pass callabl zero arg action altern use invokewithoutarg like invok except doesnt pass mock function argument calle here exampl cpp use testing_ use testinginvokewithoutarg class mockfoo public foo public mock_methodbool complexjob int n overrid bool job bool jobint n char c mockfoo foo expect_callfoo complexjob_ willonc job willonceinvokewithoutargsnewpermanentcallbackjob foocomplexjob invok job foocomplexjob invok job note action take ownership callback delet action destruct type callback deriv base callback type c need implicitli cast c resolv overload eg cpp use testinginvokewithoutarg resultcallbackbool is_ok invokewithoutargsis_ok work blockingclosur done invokewithoutargsimplicit_castclosuredon cast necessari invok argument mock function sometim mock function receiv function pointer functor word callabl argument eg cpp class mockfoo public foo public mock_methodbool dothi int n resultcallbackbool int callback overrid may want invok callabl argument cpp use testing_ mockfoo foo expect_callfoo dothis_ _ willonc execut callbackrun callback second argument dothi receiv callout note note section legaci document c lambda arghh need refer mock function argument c lambda yet defin action realli well gmock action solv exactli problem cpp invokeargumentnarg_ arg_ arg_m invok nth base argument mock function receiv arg_ arg_ arg_m matter argument function pointer functor callback gmock handl could write cpp use testing_ use testinginvokeargu expect_callfoo dothis_ _ willonceinvokeargu execut callbackrun callback second argument dothi receiv callabl take argument refer problem wrap insid stdref cpp mock_methodbool bar resultcallbackbool int const helper callback overrid use testing_ use testinginvokeargu mockfoo foo helper helper expect_callfoo bar_ willonceinvokeargu stdrefhelp stdrefhelp guarante refer helper copi pass callback callabl take argument refer wrap argument stdref invokeargu make copi argument pass refer copi instead refer origin valu callabl especi handi argument temporari valu cpp mock_methodbool dothat bool fconst doubl x const string overrid use testing_ use testinginvokeargu mockfoo foo expect_callfoo dothat_ willonceinvokeargu stringhi execut f stringhi f function pointer dothat receiv note valu stringhi temporari dead expect_cal statement finish yet fine perform action later sinc copi valu kept insid invokeargu action ignor action result sometim action return someth need action return void perhap want use mock function return void perhap need use doall last list ignoreresult let exampl cpp use testing_ use testingdoal use testingignoreresult use testingreturn int processconst mydata data string dosometh class mockfoo public foo public mock_methodvoid abc const mydata data overrid mock_methodbool xyz overrid mockfoo foo expect_callfoo abc_ willonceinvokeprocess line wont compil process return int abc need return void willonceignoreresultprocess expect_callfoo xyz willoncedoallignoreresultdosometh ignor string dosometh return returntru note use ignoreresult action alreadi return void lead ugli compil error select action argument selectingarg say mock function foo take seven argument custom action want invok foo call troubl custom action want three argument cpp use testing_ use testinginvok mock_methodbool foo bool visibl const string name int x int const mappairint int doubl weight doubl min_weight doubl max_wight bool isvisibleinquadrantbool visibl int x int return visibl x expect_callmock foo willonceinvokeisvisibleinquadr uh wont compil pleas compil god need defin adaptor signatur foo call custom action right argument cpp use testing_ use testinginvok bool myisvisibleinquadrantbool visibl const string name int x int const mappairint int doubl weight doubl min_weight doubl max_wight return isvisibleinquadrantvis x expect_callmock foo willonceinvokemyisvisibleinquadr work isnt awkward gmock provid gener action adaptor spend time mind import busi write adaptor here syntax cpp withargsn n nkaction creat action pass argument mock function given indic base inner action perform use witharg origin exampl written cpp use testing_ use testinginvok use testingwitharg expect_callmock foo willoncewitharg invokeisvisibleinquadr need defin adaptor better readabl gmock also give withoutargsact inner action take argument withargnact arg inner action take one argument may realiz invokewithoutarg syntact sugar withoutargsinvok tip inner action use witharg friend invok anyth repeat argument argument list necessari eg witharg chang order argument eg witharg type select argument match signatur inner action exactli work long implicitli convert correspond argument inner action exampl th argument mock function int my_act take doubl withargmy_act work ignor argument action function selectinganactionsargumentsselectingarg recip show us one way make mock function action incompat argument list fit togeth downsid wrap action witharg get tediou peopl write test defin function method functor lambda callback use invok interest argument altern witharg declar uninterest argument unus make definit less clutter less fragil case type uninterest argument chang could also increas chanc action function reus exampl given cpp public mock_methoddoubl foo doubleconst string label doubl x doubl overrid mock_methoddoubl bar int index doubl x doubl overrid instead cpp use testing_ use testinginvok doubl distancetooriginwithlabelconst string label doubl x doubl return sqrtxx yy doubl distancetooriginwithindexint index doubl x doubl return sqrtxx yy expect_callmock fooabc _ _ willonceinvokedistancetooriginwithlabel expect_callmock bar _ _ willonceinvokedistancetooriginwithindex could write cpp use testing_ use testinginvok use testingunus doubl distancetooriginunus doubl x doubl return sqrtxx yy expect_callmock fooabc _ _ willonceinvokedistancetoorigin expect_callmock bar _ _ willonceinvokedistancetoorigin share action like matcher gmock action object consist pointer refcount implement object therefor copi action also allow effici last action refer implement object die implement object delet complex action want use may build scratch everytim action doesnt intern state ie alway thing matter mani time call assign action variabl use variabl repeatedli exampl cpp use testingact use testingdoal use testingreturn use testingsetargpointe actionboolint set_flag doallsetargpointe returntru use set_flag willonc willrepeatedli howev action state may surpris share action object suppos action factori incrementcounterinit creat action increment return counter whose initi valu init use two action creat express use share action exhibit differ behavior exampl cpp expect_callfoo dothi willrepeatedlyincrementcount expect_callfoo dothat willrepeatedlyincrementcount foodothi return foodothi return foodothat return blah use differ counter bar versu cpp use testingact actionint increment incrementcount expect_callfoo dothi willrepeatedlyincr expect_callfoo dothat willrepeatedlyincr foodothi return foodothi return foodothat return counter share test asynchron behavior one oftencount problem gmock hard test asynchron behavior suppos eventqueu class want test creat separ eventdispatch interfac could easili mock howev implement class fire event background thread made test time difficult could insert sleep statement hope best make test behavior nondeterminist better way use gmock action notif object forc asynchron test behav synchron cpp class mockeventdispatch public eventdispatch mock_methodbool dispatchev int overrid testeventqueuetest enqueueeventtest mockeventdispatch mock_event_dispatch eventqueu event_queuemock_event_dispatch const int keventid abslnotif done expect_callmock_event_dispatch dispatcheventkeventid willoncedon donenotifi event_queueenqueueeventkeventid donewaitfornotif exampl set normal gmock expect add addit action notifi notif object call notificationwaitfornotif main thread wait asynchron call finish test suit complet safe exit callout note note exampl downsid name expect satisfi test run forev eventu timeout fail take longer slightli harder debug allevi problem use waitfornotificationwithtimeoutm instead waitfornotif misc recip use gmock mock method use moveonli type c introduc moveonli type moveonlytyp valu move one object anoth copi stdunique_ptrt probabl commonli use moveonli type mock method take andor return moveonli type present challeng noth insurmount recip show note support moveonli method argument introduc gmock april older code may find complex workaroundslegacymoveonli lack featur let say work fiction project let one post share snippet call buzz code use type cpp enum class accesslevel kintern kpublic class buzz public explicit buzzaccesslevel access class buzzer public virtual buzzer virtual stdunique_ptrbuzz makebuzzstringpiec text virtual bool sharebuzzstdunique_ptrbuzz buzz int_t timestamp buzz object repres snippet post class implement buzzer interfac capabl creat share buzz method buzzer may return unique_ptrbuzz take unique_ptrbuzz need mock buzzer test mock method accept return moveonli type use familiar mock_method syntax usual cpp class mockbuzz public buzzer public mock_methodstdunique_ptrbuzz makebuzz stringpiec text overrid mock_methodbool sharebuzz stdunique_ptrbuzz buzz int_t timestamp overrid mock class defin use test follow code exampl assum defin mockbuzz object name mock_buzzer_ cpp mockbuzz mock_buzzer_ first let see set expect makebuzz method return unique_ptrbuzz usual set expect without action ie willonc willrepeatedli claus expect fire default action method taken sinc unique_ptr default constructor return null unique_ptr that youll get dont specifi action cpp use default action expect_callmock_buzzer_ makebuzzhello trigger previou expect_cal expect_eqnullptr mock_buzzer_makebuzzhello happi default action tweak usual see set default actionsoncal need return predefin moveonli valu use returnbymov action cpp fire unique_ptr specifi bymov return expect_callmock_buzzer_ makebuzzworld willoncereturnbymovemakeuniquebuzzaccesslevelkintern expect_nenullptr mock_buzzer_makebuzzworld note bymov essenti drop code wont compil quiz time think happen returnbymov action perform eg write willrepeatedlyreturnbymov come think first time action run sourc valu consum sinc moveonli valu next time around there valu move youll get runtim error returnbymov run need mock method move predefin valu rememb alway use lambda callabl object pretti much anyth want cpp expect_callmock_buzzer_ makebuzzx willrepeatedlystringpiec text return makeuniquebuzzaccesslevelkintern expect_nenullptr mock_buzzer_makebuzzx expect_nenullptr mock_buzzer_makebuzzx everi time expect_cal fire new unique_ptrbuzz creat return returnbymov cover return moveonli valu work method accept moveonli argument answer work normal although action compil method argument moveonli alway use return lambda functorfunctionsasact cpp use testingunus expect_callmock_buzzer_ sharebuzznotnul _willoncereturntru expect_truemock_buzzer_sharebuzzmakeuniquebuzzaccesslevelkintern expect_callmock_buzzer_ sharebuzz_ _willonc stdunique_ptrbuzz buzz unus return buzz nullptr expect_falsemock_buzzer_sharebuzznullptr mani builtin action witharg withoutargsdeletearg savearg could principl support moveonli argument support implement yet block pleas file bug action eg doall copi argument intern never work noncopy object youll use functor instead legaci workaround moveonli type legacymoveonli support moveonli function argument introduc gmock april older code may encount follow workaround lack featur longer necessari includ refer cpp class mockbuzz public buzzer public mock_methodbool dosharebuzz buzz buzz time timestamp bool sharebuzzstdunique_ptrbuzz buzz time timestamp overrid return dosharebuzzbuzzget timestamp trick deleg sharebuzz method mock method let call dosharebuzz take moveonli paramet instead set expect sharebuzz set dosharebuzz mock method cpp mockbuzz mock_buzzer_ expect_callmock_buzzer_ dosharebuzznotnul _ one call sharebuzz mockbuzz like call forward dosharebuzz mock therefor statement trigger expect_cal mock_buzzer_sharebuzzmakeuniquebuzzaccesslevelkintern make compil faster believ vast major time spent compil mock class gener constructor destructor perform nontrivi task eg verif expect what mock method differ signatur differ type thu constructorsdestructor need gener compil separ result mock mani differ type method compil mock class get realli slow experienc slow compil move definit mock class constructor destructor class bodi cc file way even includ mock class n file compil need gener constructor destructor result much faster compil let illustr idea use exampl here definit mock class appli recip cpp file mock_fooh class mockfoo public foo public sinc dont declar constructor destructor compil gener everi translat unit mock class use mock_methodint dothi overrid mock_methodbool dothat const char str overrid mock method chang would look like cpp file mock_fooh class mockfoo public foo public constructor destructor declar defin mockfoo virtual mockfoo mock_methodint dothi overrid mock_methodbool dothat const char str overrid mock method cpp file mock_foocc includ pathtomock_fooh definit may appear trivial function actual lot thing constructorsdestructor member variabl use implement mock method mockfoomockfoo mockfoomockfoo forc verif destroy friendli mock object automat verifi expect satisfi gener googletest failur conveni leav one less thing worri unless sure mock object destroy could mock object wont eventu destroy well might creat heap own code test suppos there bug code doesnt delet mock object properli could end pass test there actual bug use heap checker good idea allevi concern implement reliabl sometim want forc gmock verifi mock object hope destruct mockverifyandclearexpectationsmock_object cpp testmyservertest processesrequest use testingmock mockfoo const foo new mockfoo expect_callfoo expect server own foo myserv serverfoo serverprocessrequest case server destructor forget delet foo verifi expect anyway mockverifyandclearexpectationsfoo server destroy goe scope callout tip tip mockverifyandclearexpect function return bool indic whether verif success true ye wrap function call insid assert_tru point go verif fail set new expect verifi clear mock use set expect code exercis mock undefin behavior see use mock testsgmock_for_dummiesmdusingmocksintest inform use checkpoint usingcheckpoint sometim might want test mock object behavior phase whose size manag might want set detail expect api call invok mock function techniqu use put expect sequenc insert call dummi checkpoint function specif place verifi mock function call happen right time exampl exercis code cpp foo foo foo want verifi foo foo invok mockbara foo doesnt invok anyth write cpp use testingmockfunct testfootest invokesbarcorrectli mymock mock class mockfunctionf exactli one mock method name call type f mockfunctionvoidstr check_point_nam check insequ expect_callmock bara expect_callcheck call expect_callcheck call expect_callmock bara foo checkcal foo checkcal foo expect spec say first bara call must happen checkpoint second bara call must happen checkpoint noth happen two checkpoint explicit checkpoint make clear bara call call foo mock destructor sometim want make sure mock object destruct right time eg bara call barb call alreadi know specifi constraint orderorderedcal mock function call need mock destructor mock function sound simpl except one problem destructor special function special syntax special semant mock_method macro doesnt work cpp mock_methodvoid mockfoo wont compil good news use simpl pattern achiev effect first add mock function die mock class call destructor like cpp class mockfoo public foo add follow two line mock class mock_methodvoid die mockfoo overrid die name die clash exist symbol choos anoth name translat problem test mockfoo object die test die method call cpp mockfoo foo new mockfoo mockbar bar new mockbar insequ expect foo die bara barb expect_callbar expect_callfoo die expect_callbar b that use gmock thread usingthread unit test best could isol test piec code singlethread context avoid race condit dead lock make debug test much easier yet program multithread sometim test someth need pound one thread gmock work purpos rememb step use mock creat mock object foo set default action expect use on_cal expect_cal code test call method foo option verifi reset mock destroy mock let code test destroy destructor automat verifi follow follow simpl rule mock thread live happili togeth execut test code oppos code test one thread make test easi follow obvious step without lock step make sure thread access foo obviou huh done either one thread multipl thread anyway want gmock take care lock dont unless requir test logic violat rule exampl set expect mock anoth thread call method get undefin behavior that fun dont gmock guarante action mock function done thread call mock function exampl cpp expect_callmock foo willonceact expect_callmock foo willonceact foo call thread foo call thread gmock execut action thread action thread gmock impos sequenc action perform differ thread may creat deadlock action may need cooper mean execut action action exampl may interleav problem add proper synchron logic action action make test threadsaf also rememb defaultvaluet global resourc potenti affect live mock object program natur wont want mess multipl thread still mock action control much inform gmock print gmock see someth potenti error eg mock function expect call aka uninterest call allow perhap forgot explicitli ban call print warn messag includ argument function return valu stack trace hope remind take look see inde problem sometim confid test correct may appreci friendli messag time debug test learn behavior code test wish could observ everi mock call happen includ argument valu return valu stack trace clearli one size doesnt fit control much gmock tell use gmock_verboselevel commandlin flag level string three possibl valu info gmock print inform messag warn error verbos set gmock also log call on_callexpect_cal macro includ stack trace uninterest call warn warn gmock print warn error less verbos omit stack trace uninterest call warn default error gmock print error least verbos altern adjust valu flag within test like cpp testingflags_gmock_verbos error find gmock print mani stack frame inform warn messag rememb control amount gtest_stack_trace_depthmax_depth flag judici use right flag enabl gmock serv better gain super vision mock call test use gmock fail gmock tell expect arent satisfi howev arent sure typo somewher matcher mess order expect_cal code test someth wrong find caus wont nice xray vision actual see trace expect_cal mock method call made call would like see actual argument valu expect_cal gmock think match still need help figur made call abl see complet stack trace mock call unlock power run test gmock_verboseinfo flag exampl given test program cpp includ gmockgmockh use testing_ use testinghassubstr use testingreturn class mockfoo public mock_methodvoid f const string x const string testfoo bar mockfoo mock expect_callmock f_ _willrepeatedlyreturn expect_callmock fa b expect_callmock fc hassubstrd mockfa good mockfa b run gmock_verboseinfo see output shell run foobar foo_testcc expect_callmock f_ _ invok stack trace foo_testcc expect_callmock fa b invok stack trace foo_testcc expect_callmock fc hassubstrd invok stack trace foo_testcc mock function call match expect_callmock f_ _ function call fxfffcdadaxfffcdadgood stack trace foo_testcc mock function call match expect_callmock fa b function call fxfffcdadaaxfffcdadb stack trace foo_testcc failur actual function call count doesnt match expect_callmock fc hassubstrd expect call actual never call unsatisfi activ fail foobar suppos bug c third expect_cal typo actual messag see actual fa good call match first expect_cal third thought obviou third expect_cal written wrong case solv interest mock call trace stack trace combin gmock_verboseinfo gtest_stack_trace_depth test command line run test emac build run test emac use mx googlecompil command mani googletest user sourc file locat gmock googletest error highlight press enter one youll taken offend line type cx jump next error make even easier add follow line emac file text globalsetkey mm googlecompil make globalsetkey mdown nexterror globalsetkey mup lambda interact nexterror type mm start build want run test well make sure foo_testrun runtest build command suppli type mm mupmdown move back forth error extend gmock write new matcher quickli newmatch callout warn warn gmock guarante mani time matcher invok therefor matcher must function pure see sectionpurematch detail matcher famili macro use defin custom matcher easili syntax cpp matchernam description_string_express statement defin matcher given name execut statement must return bool indic match succe insid statement refer valu match arg refer type arg_typ descript string stringtyp express document matcher use gener failur messag match fail refer special bool variabl negat evalu descript matcher negat fals matcher negat negat true conveni allow descript string empti case gmock use sequenc word matcher name descript exampl cpp matcherisdivisiblebi return arg allow write cpp expect mock_foobarn call n divis expect_callmock_foo barisdivisiblebi cpp use testingnot verifi valu divis expect_thatsome_express isdivisiblebi expect_thatsome_other_express notisdivisiblebi assert fail print someth like shell valu some_express expect divis actual valu some_other_express expect divis actual descript divis divis automat calcul matcher name isdivisiblebi may notic autogener descript especi negat may great alway overrid string express cpp matcherisdivisiblebi abslstrcatneg isnt divis return arg option stream addit inform hidden argument name result_listen explain match result exampl better definit isdivisiblebi cpp matcherisdivisiblebi arg return true result_listen remaind arg return fals definit assert give better messag shell valu some_express expect divis actual remaind let matchandexplain print addit inform help user understand match result note explain match succe case success unless obviou use matcher use insid need print argument valu gmock alreadi print callout note note type valu match arg_typ determin context use matcher suppli compil dont need worri declar allow matcher polymorph exampl isdivisiblebi use match type valu arg implicitli convert bool barisdivisiblebi exampl method bar take int arg_typ int take unsign long arg_typ unsign long write new parameter matcher quickli sometim youll want defin matcher paramet use macro cpp matcher_pnam param_nam description_str statement descript string either string express refer negat param_nam exampl cpp matcher_phasabsolutevalu valu return absarg valu allow write cpp expect_thatblaha hasabsolutevaluen may lead messag assum n shell valu blaha expect absolut valu actual note matcher descript paramet print make messag humanfriendli matcher definit bodi write foo_typ refer type paramet name foo exampl bodi matcher_phasabsolutevalu valu write value_typ refer type valu gmock also provid matcher_p matcher_p matcher_p support multiparamet matcher cpp matcher_pknam param_ param_k description_str statement pleas note custom descript string particular instanc matcher paramet bound actual valu therefor usual youll want paramet valu part descript gmock let referenc matcher paramet descript string express exampl cpp use testingprinttostr matcher_pinclosedrang low hi abslstrformat rang negat isnt printtostringlow printtostringhi return low arg arg hi expect_that inclosedrang would gener failur contain messag shell expect rang specifi descript failur messag contain sequenc word matcher name follow paramet valu print tupl exampl cpp matcher_pinclosedrang low hi expect_that inclosedrang would gener failur contain text shell expect close rang purpos type view cpp matcher_pkfoo p pk description_str shorthand cpp templat typenam p_type typenam pk_type foomatcherpkp_typ pk_type foop_typ p pk_type pk write foov vk compil infer type paramet v vk happi result type infer specifi type explicitli instanti templat foolong bool fals said earlier dont get need specifi arg_typ that determin context matcher use assign result express foop pk variabl type foomatcherpkp_typ pk_type use compos matcher matcher dont paramet one paramet special type assign foo foomatchertyp variabl assign foop foomatcherpp_typetyp variabl instanti matcher templat refer type pass paramet pointer usual make code readabl howev still want pass paramet refer awar failur messag gener matcher see valu referenc object address overload matcher differ number paramet cpp matcher_pblah description_string_ matcher_pblah b description_string_ tempt alway use matcher macro defin new matcher also consid implement matcher interfac directli instead see recip follow especi need use matcher lot approach requir work give control type valu match matcher paramet gener lead better compil error messag pay long run also allow overload matcher base paramet type oppos base number paramet write new monomorph matcher matcher argument type implement matcher interfac two thing test whether valu type match matcher describ kind valu match latter abil use gener readabl error messag expect violat matcher must declar typedef like cpp use is_gtest_match void support follow oper cpp match valu option explain ostream bool match matchermatchandexplainvalu maybe_o valu type maybe_o type stdostream null caller interest textual explan matcherdescribetoo matcherdescribenegationtoo os type stdostream need custom matcher truli good option exampl may happi way trulypred describ may want matcher polymorph eqvalu defin matcher whatev want two step first implement matcher interfac defin factori function creat matcher instanc second step strictli need make syntax use matcher nicer exampl defin matcher test whether int divis use like cpp use testingmatch class divisiblebymatch public use is_gtest_match void bool matchandexplainint n stdostream const return n void describetostdostream os const os divis void describenegationtostdostream os const os divis matcherint divisiblebi return divisiblebymatch expect_callfoo bardivisiblebi may improv matcher messag stream addit inform os argument matchandexplain cpp class divisiblebymatch public bool matchandexplainint n stdostream os const const int remaind n remaind os nullptr os remaind remaind return remaind expect_thatx divisiblebi may gener messag like shell valu x expect divis actual remaind callout tip tip conveni matchandexplain take matchresultlisten instead stdostream write new polymorph matcher expand learn polymorph matcher simpl ad templat right place cpp class notnullmatch public use is_gtest_match void implement polymorph matcher need make matchandexplain templat first argument exampl want use notnul pointer matchandexplain accept pointer type first argument gener defin matchandexplain ordinari method method templat even overload templat typenam bool matchandexplaint p stdostream const return p nullptr describ properti valu match matcher void describetostdostream os const os null describ properti valu match matcher void describenegationtostdostream os const os null notnullmatch notnul return notnullmatch expect_callfoo barnotnul argument must nonnul pointer legaci matcher implement defin matcher use somewhat complic requir sever support class virtual function implement matcher type use legaci api deriv matcherinterfacet call makematch construct object interfac look like cpp class matchresultlisten public stream x underli ostream noth ostream null templat typenam matchresultlisten operatorconst x return underli ostream stdostream stream templat typenam class matcherinterfac public virtual matcherinterfac return true matcher match x also explain match result listen virtual bool matchandexplaint x matchresultlisten listen const describ matcher ostream virtual void describetostdostream os const describ negat matcher ostream virtual void describenegationtostdostream os const fortun time defin polymorph matcher easili help makepolymorphicmatch here defin notnul exampl cpp use testingmakepolymorphicmatch use testingmatchresultlisten use testingpolymorphicmatch class notnullmatch public implement polymorph matcher first defin copyabl class three member matchandexplain describeto describenegationto like follow exampl want use notnul pointer matchandexplain accept pointer type first argument gener defin matchandexplain ordinari method method templat even overload templat typenam bool matchandexplaint p matchresultlisten listen const return p null describ properti valu match matcher void describetostdostream os const os null describ properti valu match matcher void describenegationtostdostream os const os null construct polymorph matcher pass instanc class makepolymorphicmatch note return type polymorphicmatchernotnullmatch notnul return makepolymorphicmatchernotnullmatch expect_callfoo barnotnul argument must nonnul pointer callout note note polymorph matcher class need inherit matcherinterfac class method need virtual like monomorph matcher may explain match result stream addit inform listen argument matchandexplain write new cardin cardin use time tell gmock mani time expect call occur doesnt exact exampl say atleast builtin setgmock_cheat_sheetmdcardinalitylist cardin doesnt suit free defin implement follow interfac namespac test cpp class cardinalityinterfac public virtual cardinalityinterfac return true call_count call satisfi cardin virtual bool issatisfiedbycallcountint call_count const return true call_count call satur cardin virtual bool issaturatedbycallcountint call_count const describ self ostream virtual void describetostdostream os const exampl specifi call must occur even number time write cpp use testingcardin use testingcardinalityinterfac use testingmakecardin class evennumbercardin public cardinalityinterfac public bool issatisfiedbycallcountint call_count const overrid return call_count bool issaturatedbycallcountint call_count const overrid return fals void describetostdostream os const os call even number time cardin evennumb return makecardinalitynew evennumbercardin expect_callfoo bar timesevennumb write new action quickli quicknewact builtin action dont work easili defin one defin functor class possibl templat call oper match signatur action cpp struct increment templat typenam operatort arg return arg approach work state functor callabl realli struct multiplybi templat typenam operatort arg return arg multipli int multipli use expect_callwilloncemultiplybi legaci macrobas action c functorbas action support old way write action set action macro suggest avoid new code hide lot logic behind macro potenti lead hardertounderstand compil error nevertheless cover complet write cpp actionnam statement namespac scope ie insid class function defin action given name execut statement valu return statement use return valu action insid statement refer kth base argument mock function argk exampl cpp actionincrementarg return arg allow write cpp willonceincrementarg note dont need specifi type mock function argument rest assur code typesaf though youll get compil error arg doesnt support oper type arg isnt compat mock function return type anoth exampl cpp actionfoo arg blah arg return arg defin action foo invok argument function pointer call function blah set valu point argument return argument conveni flexibl also use follow predefin symbol bodi action argk_typ type kth base argument mock function arg argument mock function tupl args_typ type argument mock function tupl return_typ return type mock function function_typ type mock function exampl use action stub action mock function cpp int dosomethingbool flag int ptr predefin symbol bound arg valu flag arg_typ type bool arg valu ptr arg_typ type int arg tupl flag ptr args_typ type stdtuplebool int return_typ type int function_typ type intbool int legaci macrobas parameter action sometim youll want parameter action defin anoth macro cpp action_pnam param statement exampl cpp action_padd n return arg n allow write cpp return argument willonceadd conveni use term argument valu use invok mock function term paramet valu use instanti action note dont need provid type paramet either suppos paramet name param also use gmockdefin symbol param_typ refer type paramet infer compil exampl bodi action_padd n write n_type type n gmock also provid action_p action_p etc support multiparamet action exampl cpp action_preturndistanceto x doubl dx arg x doubl dy arg return sqrtdxdx dydi let write cpp willoncereturndistanceto view action degener parameter action number paramet also easili defin action overload number paramet cpp action_pplu action_pplu b restrict type argument paramet action maximum breviti reusabl action macro dont ask provid type mock function argument action paramet instead let compil infer type us sometim howev may want explicit type sever trick exampl cpp actionfoo make sure arg convert int int n arg use n instead arg action_pbar param make sure type arg const char testingstaticasserttypeeqconst char arg_typ make sure param convert bool bool flag param staticasserttypeeq compiletim assert googletest verifi two type write new action templat quickli sometim want give action explicit templat paramet infer valu paramet action_templ support view extens action action_p syntax cpp action_templateactionnam has_m_template_paramskind name kind_m name_m and_n_value_paramsp p_n statement defin action templat take explicit templat paramet n valu paramet n name_i name ith templat paramet kind_i specifi whether typenam integr constant templat p_i name ith valu paramet exampl cpp duplicateargk toutput convert kth argument mock function type copi output action_templateduplicatearg note comma int k has__template_paramsint k typenam and__value_paramsoutput output tstdgetkarg creat instanc action templat write cpp actionnamet t_mv v_n ts templat argument vs valu argument valu argument type infer compil exampl cpp use testing_ int n expect_callmock foowillonceduplicatearg unsign charn want explicitli specifi valu argument type provid addit templat argument cpp actionnamet t_m u u_kv v_n u_i desir type v_i action_templ actionaction_p overload number valu paramet number templat paramet without restrict mean follow unclear cpp overloadedactionint boolx use singletemplateparamet action bool refer type x twotemplateparamet action compil ask infer type x use action object type write function return action object youll need know type type depend macro use defin action paramet type rule rel simpl given definit express type actionfoo foo fooaction action_templatefoo has_m_template_param and__value_param foot t_m fooactiont t_m action_pbar param barint_valu baractionpint action_templatebar has_m_template_param and__value_paramsp bart t_mint_valu baractionpt t_m int action_pbaz p p bazbool_valu int_valu bazactionpbool int action_templatebaz has_m_template_param and__value_paramsp p bazt t_mbool_valu int_valu bazactionpt t_m bool int note pick differ suffix action actionp actionp etc action differ number valu paramet action definit overload number write new monomorph action newmonoact action macro conveni sometim inappropri exampl despit trick shown previou recip dont let directli specifi type mock function argument action paramet gener lead unoptim compil error messag baffl unfamiliar user also dont allow overload action base paramet type without jump hoop altern action macro implement testingactioninterfacef f type mock function action use exampl cpp templat typenam f class actioninterfac public virtual actioninterfac perform action result return type function type f argumenttupl tupl argument f exampl f intbool const string result would int argumenttupl would stdtuplebool const string virtual result performconst argumenttupl arg cpp use testing_ use testingact use testingactioninterfac use testingmakeact typedef int incrementmethodint class incrementargumentact public actioninterfaceincrementmethod public int performconst stdtupleint arg overrid int p stdgetarg grab first argument return p actionincrementmethod incrementargu return makeactionnew incrementargumentact expect_callfoo baz_ willonceincrementargu int n foobazn return chang n write new polymorph action newpolyact previou recip show defin action good except need know type function action use sometim problem exampl want use action function differ type eg like return setargpointe action use sever type mock function say polymorph makepolymorphicact function templat make easi defin action cpp namespac test templat typenam impl polymorphicactionimpl makepolymorphicactionconst impl impl namespac test exampl let defin action return second argument mock function argument list first step defin implement class cpp class returnsecondargumentact public templat typenam result typenam argumenttupl result performconst argumenttupl arg const get ith base argument use stdgetarg return stdgetarg implement class need inherit particular class matter must perform method templat method templat take mock function argument tupl singl argument return result action either const must invok exactli one templat argument result type word must abl call performrarg r mock function return type arg argument tupl next use makepolymorphicact turn instanc implement class polymorph action need conveni wrapper cpp use testingmakepolymorphicact use testingpolymorphicact polymorphicactionreturnsecondargumentact returnsecondargu return makepolymorphicactionreturnsecondargumentact use polymorph action way use builtin one cpp use testing_ class mockfoo public foo public mock_methodint dothi bool flag int n overrid mock_methodstr dothat int x const char str const char str overrid mockfoo foo expect_callfoo dothiswilloncereturnsecondargu expect_callfoo dothatwilloncereturnsecondargu foodothistru return foodothat hi bye return hi teach gmock print valu uninterest unexpect call occur gmock print argument valu stack trace help debug assert macro like expect_that expect_eq also print valu question assert fail gmock googletest use googletest userextens valu printer printer know print builtin c type nativ array stl contain type support oper type print raw byte valu hope user figur googletest advanc guideadvancedmdteachinggoogletesthowtoprintyourvalu explain extend printer better job print particular type dump byte use mock creat use gmock includ fileincludesg_testing_logsmd includ fileincludesg_mock_callbacksmd mock stdfunction mockfunct stdfunction gener function type introduc c prefer way pass callback new interfac function copiabl usual pass around pointer make tricki mock fear mockfunct help mockfunctionrt tn mock method call signatur cpp r callt tn also asstdfunct method creat stdfunction proxi forward call cpp stdfunctionrt tn asstdfunct use mockfunct first creat mockfunct object set expect call method pass proxi obtain asstdfunct code test exampl cpp testfootest runscallbackwithbarargu creat mock object mockfunctionintstr mock_funct set expect call method expect_callmock_funct callbarwilloncereturn exercis code use stdfunction foomock_functionasstdfunct foo signatur either void fooconst stdfunctionintstr fun void foostdfunctionintstr fun expect verifi mock_funct goe scope destroy rememb function object creat asstdfunct forward creat multipl share set expect although stdfunction support unlimit number argument mockfunct implement limit ten ever hit limit well callback bigger problem mockabl use googletest variou build system googletest come pkgconfig file use determin necessari flag compil link googletest googlemock pkgconfig standardis plaintext format contain includedir path necessari macro definit requir flag pthread librari l path librari l link current build system support pkgconfig one way anoth exampl assum want compil sampl samplessample_unittestcc cmake use pkgconfig cmake fairli easi cmake cmake_minimum_requiredvers cmake_policyset cmp new projectmy_gtest_pkgconfig version languag cxx find_packagepkgconfig pkg_search_modulegtest requir gtest_main add_executabletestapp samplessample_unittestcc target_link_librariestestapp gtest_ldflag target_compile_optionstestapp public gtest_cflag includectest add_testfirst_and_only_test testapp gener recommend use target_compile_opt _cflag target_include_directori _include_dir former includ flag googletest might requir macro indic intern header librari compil thread enabl addit googletest might also requir pthread compil step split pkgconfig cflag variabl includ dir macro target_compile_definit might still miss recommend goe use _ldflag commonplac _librari happen discard l flag pthread help pkgconfig cant find googletest let say cmakeliststxt along line one tutori tri run cmake possibl get failur along line check one modul gtest_main cmake error usrsharecmakemodulesfindpkgconfigcmak messag none requir gtest_main found failur common instal googletest sourc distro packag manag need tell pkgconfig find pc file contain inform say instal googletest usrloc might pc file instal usrlocallibpkgconfig set export pkg_config_pathusrlocallibpkgconfig pkgconfig also tri look pkg_config_path find gtest_mainpc use pkgconfig crosscompil set pkgconfig use crosscompil set let assum final prefix crosscompil instal usr sysroot homemyusersysroot configur instal gtest use mkdir build cmake dcmake_install_prefixusr instal sysroot use destdir make j instal destdirhomemyusersysroot continu recommend alway defin follow two variabl pkgconfig crosscompil set export pkg_config_allow_system_cflagsy export pkg_config_allow_system_libsy otherwis pkgconfig filter l flag standard prefix usr see httpsbugsfreedesktoporgshow_bugcgiidc reason strip need occur usual look gener pkgconfig file look someth like libdirusrlib includedirusrinclud name gtest descript googletest without main function version url httpsgithubcomgooglegoogletest lib llibdir lgtest lpthread cflag iincludedir dgtest_has_pthread lpthread notic sysroot includ libdir includedir tri run pkgconfig correct pkg_config_libdirhomemyusersysrootusrlibpkgconfig pc file get pkgconfig cflag gtest dgtest_has_pthread lpthread iusrinclud pkgconfig lib gtest lusrlib lgtest lpthread obvious wrong point cbuild chost root order use crosscompil set need tell pkgconfig inject actual sysroot l variabl let us tell pkgconfig actual sysroot export pkg_config_dir export pkg_config_sysroot_dirhomemyusersysroot export pkg_config_libdirpkg_config_sysroot_dirusrlibpkgconfig run pkgconfig get pkgconfig cflag gtest dgtest_has_pthread lpthread ihomemyusersysrootusrinclud pkgconfig lib gtest lhomemyusersysrootusrlib lgtest lpthread contain correct sysroot comprehens guid also includ chost build system call see excel tutori diego elio petten httpsautotoolsiopkgconfigcrosscompilinghtml googletest sampl your like us youd like look googletest sampleshttpsgithubcomgooglegoogletesttreemastergoogletestsampl sampl directori number wellcom sampl show use varieti googletest featur sampl show basic step use googletest test c function sampl show complex unit test class multipl member function sampl use test fixtur sampl teach use googletest googletesth togeth get best librari sampl put share test logic base test fixtur reus deriv fixtur sampl demonstr typeparameter test sampl teach basic valueparameter test sampl show use combin valueparameter test sampl show use listen api modifi googl test consol output use reflect api inspect test result sampl show use listen api implement primit memori leak checker advanc googletest topic introduct read googletest primerprimermd learn write test use googletest time learn new trick document show assert well construct complex failur messag propag fatal failur reus speed test fixtur use variou flag test assert section cover less frequent use still signific assert explicit success failur see explicit success failurereferenceassertionsmdsuccessfailur assert refer except assert see except assertionsreferenceassertionsmdexcept assert refer predic assert better error messag even though googletest rich set assert never complet imposs good idea anticip scenario user might run therefor sometim user use expect_tru check complex express lack better macro problem show valu part express make hard understand went wrong workaround user choos construct failur messag stream expect_tru howev awkward especi express sideeffect expens evalu googletest give three differ option solv problem use exist boolean function alreadi function functor return bool type implicitli convert bool use predic assert get function argument print free see expect_predreferenceassertionsmdexpect_pr assert refer detail use function return assertionresult expect_pr friend handi quick job syntax satisfactori use differ macro differ ariti feel like lisp c testingassertionresult class solv problem assertionresult object repres result assert whether success failur associ messag creat assertionresult use one factori function c namespac test return assertionresult object indic assert succeed assertionresult assertionsuccess return assertionresult object indic assert fail assertionresult assertionfailur use oper stream messag assertionresult object provid readabl messag boolean assert eg expect_tru write predic function return assertionresult instead bool exampl defin iseven c testingassertionresult isevenint n n return testingassertionsuccess els return testingassertionfailur n odd instead c bool isevenint n return n fail assert expect_trueisevenfib print none valu isevenfib actual fals odd expect true instead opaqu none valu isevenfib actual fals expect true want inform messag expect_fals assert_fals well one third boolean assert googl code base neg one fine make predic slower success case suppli success messag c testingassertionresult isevenint n n return testingassertionsuccess n even els return testingassertionfailur n odd statement expect_falseisevenfib print none valu isevenfib actual true even expect fals use predicateformatt find default messag gener expect_predreferenceassertionsmdexpect_pr expect_truereferenceassertionsmdexpect_tru unsatisfactori argument predic support stream ostream instead use predicateformatt assert fulli custom messag format see expect_pred_formatreferenceassertionsmdexpect_pred_format assert refer detail floatingpoint comparison see floatingpoint comparisonreferenceassertionsmdfloatingpoint assert refer floatingpoint predicateformat function floatingpoint oper use often use order avoid explos new macro provid predicateformat function use predic assert macro expect_pred_formatreferenceassertionsmdexpect_pred_format exampl c expect_pred_formattestingfloatl val val expect_pred_formattestingdoublel val val code verifi val less approxim equal val assert use gmock matcher see expect_thatreferenceassertionsmdexpect_that assert refer string assert pleas read previousassertingusinggmockmatch section first havent use gmock string matchersreferencematchersmdstringmatch expect_thatreferenceassertionsmdexpect_that string comparison trick substr prefix suffix regular express etc exampl c use testinghassubstr use testingmatchesregex assert_thatfoo_str hassubstrneedl expect_thatbar_str matchesregexwd window hresult assert see window hresult assertionsreferenceassertionsmdhresult assert refer type assert call function c testingstaticasserttypeeqt assert type function noth assert satisfi type differ function call fail compil compil error messag say type like depend compil show actual valu mainli use insid templat code caveat use insid member function class templat function templat staticasserttypeeqt effect function instanti exampl given c templat typenam class foo public void bar testingstaticasserttypeeqint code c void test foobool foo gener compil error fooboolbar never actual instanti instead need c void test foobool foo foobar caus compil error assert placement use assert c function particular doesnt method test fixtur class one constraint assert gener fatal failur fail assert_ use voidreturn function consequ googl use except place nonvoid function youll get confus compil error like error void valu ignor ought initi return object type bool rvalu type void error viabl convers void string need use fatal assert function return nonvoid one option make function return valu paramet instead exampl rewrit foot x void foot x result need make sure result contain sensibl valu even function return prematur function return void use assert insid chang function type option use assert gener nonfat failur add_failur expect_ callout note note constructor destructor consid voidreturn function accord c languag specif may use fatal assert youll get compil error tri instead either call abort crash entir test execut put fatal assert setupteardown function see constructordestructor vs setupteardownfaqmdctorvssetup callout warn warn fatal assert helper function privat voidreturn method call constructor destructor termin current test intuit might suggest mere return constructor destructor earli possibl leav object partiallyconstruct partiallydestruct state almost certainli want abort use setupteardown instead skip test execut relat assert succeed fail prevent test execut runtim gtest_skip macro use need check precondit system test runtim skip test meaning way gtest_skip use individu test case setup method class deriv either testingenviron testingtest exampl c testskiptest doesskip gtest_skip skip singl test expect_eq wont fail wont execut class skipfixtur public testingtest protect void setup overrid gtest_skip skip test fixtur test skipfixtur wont execut test_fskipfixtur skipsonetest expect_eq wont fail assert macro stream custom messag gtest_skip teach googletest print valu test assert expect_eq fail googletest print argument valu help debug use userextens valu printer printer know print builtin c type nativ array stl contain type support oper type print raw byte valu hope user figur mention earlier printer extens mean teach better job print particular type dump byte defin type c includ ostream namespac foo class bar want googletest abl print instanc creat free inlin friend function friend stdostream operatorstdostream os const bar bar return os bardebugstr whatev need print bar os cant declar function class import oper defin namespac defin bar cs lookup rule reli stdostream operatorstdostream os const bar bar return os bardebugstr whatev need print bar os namespac foo sometim might option team may consid bad style oper bar bar may alreadi oper doesnt want chang instead defin printto function like c includ ostream namespac foo class bar friend void printtoconst bar bar stdostream os os bardebugstr whatev need print bar os cant declar function class import printto defin namespac defin bar cs lookup rule reli void printtoconst bar bar stdostream os os bardebugstr whatev need print bar os namespac foo defin printto latter use googletest concern allow custom valu appear googletest output without affect code reli behavior oper want print valu x use googletest valu printer call testingprinttostringx return stdstring c vectorpairbar int bar_int getbarintvector expect_trueiscorrectbarintvectorbar_int bar_int testingprinttostringbar_int death test mani applic assert caus applic failur condit met saniti check ensur program known good state fail earliest possibl time program state corrupt assert check wrong condit program may proceed erron state could lead memori corrupt secur hole wors henc vital import test assert statement work expect sinc precondit check caus process die call test _death tests_ gener test check program termin except throw except expect fashion also death test note piec code throw except dont consid death purpos death test caller code could catch except avoid crash want verifi except thrown code see except assertionsexceptionassert want test expect_assert_ failur test code see catch failurescatchingfailur write death test googletest provid assert macro support death test see death assertionsreferenceassertionsmddeath assert refer detail write death test simpli use one macro insid test function exampl c testmydeathtest foo death test use compound statement assert_death int n foon error line foo testmydeathtest normalexit expect_exitnormalexit testingexitedwithcod success testmydeathtest killprocess expect_exitkillprocess testingkilledbysignalsigkil send unblock signal verifi call foo caus process die given error messag call normalexit caus process print success stderr exit exit code call killprocess kill process signal sigkil test function bodi may contain assert statement well necessari note death test care three thing statement abort exit process case assert_exit expect_exit exit statu satisfi predic case assert_death expect_death exit statu nonzero stderr output match matcher particular statement gener assert_ expect_ failur caus death test fail googletest assert dont abort process death test name callout import import strongli recommend follow convent name test suit test deathtest contain death test demonstr exampl death test threadsdeathtestsandthread section explain test fixtur class share normal test death test use use typedef introduc alia fixtur class avoid duplic code c class footest public testingtest use foodeathtest footest test_ffootest doesthi normal test test_ffoodeathtest doesthat death test regular express syntax posix system eg linux cygwin mac googletest use posix extend regular expressionhttpwwwopengrouporgonlinepubsbasedefsxbd_chaphtmltag__ syntax learn syntax may want read wikipedia entryhttpenwikipediaorgwikiregular_expressionposix_extended_regular_express window googletest use simpl regular express implement lack mani featur exampl dont support union xy group xy bracket xy repetit count x among other support denot liter charact period singl escap sequenc x denot regular express express mean c match liter charact c match decim digit match charact that decim digit f match f n match n r match r match ascii whitespac includ n match charact that whitespac match v match v w match letter _ decim digit w match charact w doesnt match c match liter charact c must punctuat match singl charact except n match occurr match mani occurr match mani occurr match begin string line match end string line xy match x follow help determin capabl avail system googletest defin macro govern regular express use macro gtest_uses_simple_r gtest_uses_posix_r want death test work case either macro use limit syntax work see death assertionsreferenceassertionsmddeath assert refer death test thread reason two death test style thread safeti due wellknown problem fork presenc thread death test run singlethread context sometim howev isnt feasibl arrang kind environ exampl staticallyiniti modul may start thread main ever reach thread creat may difficult imposs clean googletest three featur intend rais awar thread issu warn emit multipl thread run death test encount test suit name end deathtest run test use clone instead fork spawn child process linux clone avail cygwin mac fork like caus child hang parent process multipl thread perfectli fine creat thread insid death test statement execut separ process affect parent death test style threadsaf death test style introduc order help mitig risk test possibl multithread environ trade increas test execut time potenti dramat improv thread safeti autom test framework set style flag choos particular style death test set flag programmat c testingflags_gtest_death_test_stylethreadsaf main set style death test binari individu test recal flag save run test restor afterward need exampl c int mainint argc char argv testinginitgoogletestargc argv testingflags_gtest_death_test_styl fast return run_all_test testmydeathtest teston testingflags_gtest_death_test_styl threadsaf test run threadsaf style assert_deaththisshoulddi testmydeathtest testtwo test run fast style assert_deaththisshoulddi caveat statement argument assert_exit valid c statement leav current function via return statement throw except death test consid fail googletest macro may return current function eg assert_tru sure avoid statement sinc statement run child process inmemori side effect eg modifi variabl releas memori etc caus observ parent process particular releas memori death test program fail heap check parent process never see memori reclaim solv problem tri free memori death test free memori parent process use heap checker program due implement detail place multipl death test assert line otherwis compil fail unobvi error messag despit improv thread safeti afford threadsaf style death test thread problem deadlock still possibl presenc handler regist pthread_atfork use assert subroutin callout note note want put seri test assert subroutin check complex condit consid use custom gmock matchergmock_cook_bookmdnewmatch instead let provid readabl error messag case failur avoid issu describ ad trace assert test subroutin call sever place assert insid fail hard tell invoc subroutin failur allevi problem use extra log custom failur messag usual clutter test better solut use scoped_trac macro scopedtrac util c scoped_tracemessag c scopedtrac tracefile_path line_numb messag messag anyth streamabl stdostream scoped_trac macro caus current file name line number given messag ad everi failur messag scopedtrac accept explicit file name line number argument use write test helper effect undon control leav current lexic scope exampl c void subint n expect_eqbarn expect_eqbarn testfootest bar scoped_tracea trace point includ everi failur scope sub wont sub could result messag like none pathtofoo_testcc failur valu barn expect actual googl test trace pathtofoo_testcc pathtofoo_testcc failur valu barn expect actual without trace wouldv difficult know invoc sub two failur come respect could add extra messag assert sub indic valu n that tediou tip use scoped_trac suitabl messag often enough use scoped_trac begin subroutin instead call site call subroutin insid loop make loop iter part messag scoped_trac know iter failur sometim line number trace point enough identifi particular invoc subroutin case dont choos uniqu messag scoped_trac simpli use use scoped_trac inner scope one outer scope case activ trace point includ failur messag revers order encount trace dump clickabl emac hit return line number youll taken line sourc file propag fatal failur common pitfal use assert_ fail understand fail abort _current function_ entir test exampl follow test segfault c void subroutin gener fatal failur abort current function assert_eq follow wont execut testfootest bar subroutin intend behavior fatal failur subroutin abort entir test actual behavior function goe subroutin return int p nullptr p segfault allevi googletest provid three differ solut could use either except assertexpect_no_fatal_failur assert hasfatalfailur function describ follow two subsect assert subroutin except follow code turn assertfailur except c class throwlisten public testingemptytesteventlisten void ontestpartresultconst testingtestpartresult result overrid resulttyp testingtestpartresultkfatalfailur throw testingassertionexceptionresult int mainint argc char argv testingunittestgetinstancelistenersappendnew throwlisten return run_all_test listen ad listen otherwis wont see fail ontestpartresult assert subroutin shown test call subroutin assert_ failur test continu subroutin return may want often peopl want fatal failur propag like except googletest offer follow macro fatal assert nonfat assert verifi assert_no_fatal_failurestat expect_no_fatal_failurestat statement doesnt gener new fatal failur current thread failur thread execut assert check determin result type assert statement creat new thread failur thread ignor exampl c assert_no_fatal_failurefoo int expect_no_fatal_failur bar assert multipl thread current support window check failur current test hasfatalfailur testingtest class return true assert current test suffer fatal failur allow function catch fatal failur subroutin return earli c class test public static bool hasfatalfailur typic usag basic simul behavior thrown except c testfootest bar subroutin abort subroutin fatal failur hasfatalfailur return follow wont execut hasfatalfailur use outsid test test_f test fixtur must add testingtest prefix c testingtesthasfatalfailur return similarli hasnonfatalfailur return true current test least one nonfat failur hasfailur return true current test least one failur either kind log addit inform test code call recordpropertykey valu log addit inform valu either string int last valu record key emit xml outputgeneratinganxmlreport specifi one exampl test c test_fwidgetusagetest minandmaxwidget recordpropertymaximumwidget computemaxusag recordpropertyminimumwidget computeminusag output xml like xml testcas nameminandmaxwidget statusrun time classnamewidgetusagetest maximumwidget minimumwidget callout note note recordproperti static member test class therefor need prefix testingtest use outsid test bodi test fixtur class key must valid xml attribut name conflict one alreadi use googletest name statu time classnam type_param value_param call recordproperti outsid lifespan test allow call outsid test test suit setuptestsuit teardowntestsuit method attribut xml element test suit call outsid test suit eg test environ attribut toplevel xml element share resourc test test suit googletest creat new test fixtur object test order make test independ easier debug howev sometim test use resourc expens set make onecopypertest model prohibit expens test dont chang resourc there harm share singl resourc copi addit pertest setupteardown googletest also support pertestsuit setupteardown use test fixtur class say footest declar static member variabl hold share resourc outsid test fixtur class typic defin member variabl option give initi valu test fixtur class defin static void setuptestsuit function rememb spell setuptestsuit small u set share resourc static void teardowntestsuit function tear that googletest automat call setuptestsuit run first test footest test suit ie creat first footest object call teardowntestsuit run last test ie delet last footest object test use share resourc rememb test order undefin code cant depend test preced follow anoth also test must either modifi state share resourc modifi state must restor state origin valu pass control next test here exampl pertestsuit setup teardown c class footest public testingtest protect pertestsuit setup call first test test suit omit need static void setuptestsuit shared_resource_ new pertestsuit teardown call last test test suit omit need static void teardowntestsuit delet shared_resource_ shared_resource_ nullptr defin pertest setup logic usual void setup overrid defin pertest teardown logic usual void teardown overrid expens resourc share test static shared_resource_ footestshared_resource_ nullptr test_ffootest test refer shared_resource_ test_ffootest test refer shared_resource_ callout note note though code declar setuptestsuit protect may sometim necessari declar public use test_p global setup teardown setup teardown test level test suit level also test program level here first subclass testingenviron class defin test environ know setup teardown c class environ public testingenviron public environ overrid overrid defin set environ void setup overrid overrid defin tear environ void teardown overrid regist instanc environ class googletest call testingaddglobaltestenviron function c environ addglobaltestenvironmentenviron env run_all_test call first call setup method environ object run test none environ report fatal failur gtest_skip call run_all_test alway call teardown environ object regardless whether test run ok regist multipl environ object suit setup call order regist teardown call revers order note googletest take ownership regist environ object therefor delet call addglobaltestenviron run_all_test call probabl main use gtest_main need call main start take effect one way defin global variabl like c testingenviron const foo_env testingaddglobaltestenvironmentnew fooenviron howev strongli recommend write main call addglobaltestenviron reli initi global variabl make code harder read may caus problem regist multipl environ differ translat unit environ depend among rememb compil doesnt guarante order global variabl differ translat unit initi valueparameter test valueparameter test allow test code differ paramet without write multipl copi test use number situat exampl piec code whose behavior affect one commandlin flag want make sure code perform correctli variou valu flag want test differ implement oo interfac want test code variou input aka datadriven test featur easi abus pleas exercis good sens write valueparameter test write valueparameter test first defin fixtur class must deriv testingtest testingwithparaminterfacet latter pure interfac type paramet valu conveni deriv fixtur class testingtestwithparamt deriv testingtest testingwithparaminterfacet copyabl type raw pointer respons manag lifespan point valu callout note note test fixtur defin setuptestsuit teardowntestsuit must declar public rather protect order use test_p c class footest public testingtestwithparamconst char implement usual fixtur class member access test paramet call getparam class testwithparamt want add paramet preexist fixtur class class basetest public testingtest class bartest public basetest public testingwithparaminterfaceconst char use test_p macro defin mani test pattern use fixtur want _p suffix parameter pattern whichev prefer think c test_pfootest doesblah insid test access test paramet getparam method testwithparamt class expect_truefooblahgetparam test_pfootest hasblahblah final use instantiate_test_suite_p macro instanti test suit set paramet want googletest defin number function gener test parametersse detail instantiate_test_suite_preferencetestingmdinstantiate_test_suite_p test refer exampl follow statement instanti test footest test suit paramet valu meeni mini moe use valuesreferencetestingmdparamgener paramet gener c instantiate_test_suite_pmeenyminymo footest testingvaluesmeeni mini moe callout note note code must place global namespac scope function scope first argument instantiate_test_suite_p uniqu name instanti test suit next argument name test pattern last paramet generatorreferencetestingmdparamgener instanti test pattern distinguish differ instanc pattern instanti name ad prefix actual test suit name rememb pick uniqu prefix differ instanti test instanti name meenyminymoefootestdoesblah meeni meenyminymoefootestdoesblah mini meenyminymoefootestdoesblah moe meenyminymoefootesthasblahblah meeni meenyminymoefootesthasblahblah mini meenyminymoefootesthasblahblah moe use name gtest_filterrunningasubsetofthetest follow statement instanti test footest paramet valu cat dog use valuesinreferencetestingmdparamgener paramet gener c const char pet cat dog instantiate_test_suite_ppet footest testingvaluesinpet test instanti name petsfootestdoesblah cat petsfootestdoesblah dog petsfootesthasblahblah cat petsfootesthasblahblah dog pleas note instantiate_test_suite_p instanti test given test suit whether definit come instantiate_test_suite_p statement addit default everi test_p without correspond instantiate_test_suite_p caus fail test test suit googletestverif test suit omiss error exampl librari may link reason list test case dynam may empti check suppress tag test suit c gtest_allow_uninstantiated_parameterized_testfootest see sample_unittestcc sample_unittestcc exampl sample_unittestcc httpsgithubcomgooglegoogletestblobmastergoogletestsamplessample_unittestcc parameter test exampl sample_unittestcc httpsgithubcomgooglegoogletestblobmastergoogletestsamplessample_unittestcc parameter test exampl multipl paramet creat valueparameter abstract test defin instanti footest sourc file sometim may want defin valueparameter test librari let peopl instanti later pattern known abstract test exampl applic design interfac write standard suit abstract test perhap use factori function test paramet implement interfac expect pass someon implement interfac instanti suit get interfaceconform test free defin abstract test organ code like put definit parameter test fixtur class eg footest header file say foo_param_testh think declar abstract test put test_p definit foo_param_testcc includ foo_param_testh think implement abstract test defin instanti includ foo_param_testh invok instantiate_test_suite_p depend librari target contain foo_param_testcc instanti abstract test suit multipl time possibl differ sourc file specifi name valueparameter test paramet option last argument instantiate_test_suite_p allow user specifi function functor gener custom test name suffix base test paramet function accept one argument type testingtestparaminfoclass paramtyp return stdstring testingprinttostringparamnam builtin test suffix gener return valu testingprinttostringgetparam work stdstring c string callout note note test name must nonempti uniqu may contain ascii alphanumer charact particular contain underscoresfaqmdwhyshouldtestsuitenamesandtestnamesnotcontainunderscor c class mytestsuit public testingtestwithparamint test_pmytestsuit mytest stdcout exampl test param getparam stdendl instantiate_test_suite_pmygroup mytestsuit testingrang testingprinttostringparamnam provid custom functor allow control test paramet name gener especi type automat convers gener help paramet name eg string demonstr follow exampl illustr multipl paramet enumer type string also demonstr combin gener use lambda concis c enum class mytyp my_foo my_bar class mytestsuit public testingtestwithparamstdtuplemytyp stdstring instantiate_test_suite_p mygroup mytestsuit testingcombin testingvaluesmytypemy_foo mytypemy_bar testingvaluesa b const testingtestparaminfomytestsuiteparamtyp info stdstring name abslstrcat stdgetinfoparam mytypemy_foo foo bar stdgetinfoparam abslc_replace_ifnam char c return stdisalnumc _ return name type test suppos multipl implement interfac want make sure satisfi common requir may defin sever type suppos conform concept want verifi case want test logic repeat differ type write one test test_f type want test may even factor test logic function templat invok test tediou doesnt scale want test n type youll end write mn test type test allow repeat test logic list type need write test logic although must know type list write type test here first defin fixtur class templat parameter type rememb deriv testingtest c templat typenam class footest public testingtest public use list stdlistt static shared_ value_ next associ list type test suit repeat type list c use mytyp testingtypeschar int unsign int typed_test_suitefootest mytyp type alia use typedef necessari typed_test_suit macro pars correctli otherwis compil think comma type list introduc new macro argument use typed_test instead test_f defin type test test suit repeat mani time want c typed_testfootest doesblah insid test refer special name typeparam get type paramet sinc insid deriv class templat c requir us visit member footest via typeparam n thisvalue_ visit static member fixtur add testfixtur prefix n testfixtureshared_ refer typedef fixtur add typenam testfixtur prefix typenam requir satisfi compil typenam testfixturelist valu valuespush_backn typed_testfootest haspropertya see sample_unittestcc complet exampl sample_unittestcc httpsgithubcomgooglegoogletestblobmastergoogletestsamplessample_unittestcc type test exampl typeparameter test typeparameter test like type test except dont requir know list type ahead time instead defin test logic first instanti differ type list later even instanti program design interfac concept defin suit typeparameter test verifi properti valid implement interfaceconcept author implement instanti test suit type verifi conform requir without write similar test repeatedli here exampl first defin fixtur class templat type test c templat typenam class footest public testingtest next declar defin typeparameter test suit c typed_test_suite_pfootest use typed_test_p defin typeparameter test repeat mani time want c typed_test_pfootest doesblah insid test refer typeparam get type paramet typeparam n typed_test_pfootest haspropertya tricki part need regist test pattern use register_typed_test_suite_p macro instanti first argument macro test suit name rest name test test suit c register_typed_test_suite_pfootest doesblah haspropertya final free instanti pattern type want put code header file includ multipl c sourc file instanti multipl time c use mytyp testingtypeschar int unsign int instantiate_typed_test_suite_pmi footest mytyp distinguish differ instanc pattern first argument instantiate_typed_test_suite_p macro prefix ad actual test suit name rememb pick uniqu prefix differ instanc special case type list contain one type write type directli without testingtyp like c instantiate_typed_test_suite_pmi footest int see sample_unittestcc complet exampl test privat code chang softwar intern implement test break long chang observ user therefor per blackbox test principl time test code public interfac still find need test intern implement code consid there better design desir test intern implement often sign class much consid extract implement class test use implement class origin class absolut test nonpubl interfac code though two case consid static function static member function unnam namespac privat protect class member test use follow special techniqu static function definitionsdeclar unnam namespac visibl within translat unit test includ entir cc file test _testcc file includ cc file good way reus code product code howev better approach move privat code foointern namespac foo namespac project normal use put privat declar internalh file product cc file test allow includ intern header client way fulli test intern implement without leak client privat class member access within class friend access class privat member declar test fixtur friend class defin accessor fixtur test use fixtur access privat member product class via accessor fixtur note even though fixtur friend product class test automat friend technic defin subclass fixtur anoth way test privat member refactor implement class declar internalh file client arent allow includ header test call pimplhttpswwwgamedevnetarticlesprogramminggeneralandgameplayprogrammingthecpimplr privat implement idiom declar individu test friend class ad line class bodi c friend_testtestsuitenam testnam exampl c fooh class foo privat friend_testfootest barreturnszeroonnul int barvoid x foo_testcc testfootest barreturnszeroonnul foo foo expect_eqfoobarnul use foo privat member bar pay special attent class defin namespac want test fixtur test friend class must defin exact namespac anonym inlin namespac exampl code test look like c namespac my_namespac class foo friend class footest friend_testfootest bar friend_testfootest baz definit class foo namespac my_namespac test code someth like c namespac my_namespac class footest public testingtest protect test_ffootest bar test_ffootest baz namespac my_namespac catch failur build test util top googletest youll want test util framework would use test googletest cours challeng verifi test util report failur correctli framework report failur throw except could catch except assert googletest doesnt use except test piec code gener expect failur gtestgtestspih contain construct includ header use c expect_fatal_failurestat substr assert statement gener fatal eg assert_ failur current thread whose messag contain given substr use c expect_nonfatal_failurestat substr expect nonfat eg expect_ failur failur current thread check determin result type expect statement creat new thread failur thread also ignor want catch failur thread well use one follow macro instead c expect_fatal_failure_on_all_threadsstat substr expect_nonfatal_failure_on_all_threadsstat substr callout note note assert multipl thread current support window technic reason caveat stream failur messag either macro statement expect_fatal_failure_on_all_thread refer local nonstat variabl nonstat member object statement expect_fatal_failure_on_all_thread return valu regist test programmat test macro handl vast major use case runtim registr logic requir case framework provid testingregistertest allow caller regist arbitrari test dynam advanc api use test macro insuffici macro prefer possibl avoid complex call function provid follow signatur c templat typenam factori testinfo registertestconst char test_suite_nam const char test_nam const char type_param const char value_param const char file int line factori factori factori argument factori callabl moveconstruct object function pointer creat new instanc test object handl ownership caller signatur callabl fixtur fixtur test fixtur class test test regist test_suite_nam must return fixtur type check runtim framework infer fixtur class factori call setuptestsuit teardowntestsuit must call run_all_test invok otherwis behavior undefin use case exampl c class myfixtur public testingtest public option like regular macro usag static void setuptestsuit static void teardowntestsuit void setup overrid void teardown overrid class mytest public myfixtur public explicit mytestint data data_data void testbodi overrid privat int data_ void registermytestsconst stdvectorint valu int v valu testingregistertest myfixtur test stdto_stringvc_str nullptr stdto_stringvc_str __file__ __line__ import use fixtur type return type myfixtur return new mytestv int mainint argc char argv stdvectorint values_to_test loadvaluesfromconfig registermytestsvalues_to_test return run_all_test get current test name sometim function may need know name current run test exampl may use setup method test fixtur set golden file name base test run testinforeferencetestingmdtestinfo class inform obtain testinfo object current run test call current_test_info unittestreferencetestingmdunittest singleton object c get inform current run test delet return object manag unittest class const testingtestinfo const test_info testingunittestgetinstancecurrent_test_info printfw test test suit sn test_infonam test_infotest_suite_nam current_test_info return null pointer test run particular find test suit name setuptestsuit teardowntestsuit know test suit name implicitli function call extend googletest handl test event googletest provid event listen api let receiv notif progress test program test failur event listen includ start end test program test suit test method among other may use api augment replac standard consol output replac xml output provid complet differ form output gui databas also use test event checkpoint implement resourc leak checker exampl defin event listen defin event listen subclass either testingtesteventlistenerreferencetestingmdtesteventlisten testingemptytesteventlistenerreferencetestingmdemptytesteventlisten former abstract interfac pure virtual method overridden handl test event exampl test start onteststart method call latter provid empti implement method interfac subclass need overrid method care event fire context pass handler function argument follow argument type use unittest reflect state entir test program testsuit inform test suit contain one test testinfo contain state test testpartresult repres result test assert event handler function examin argument receiv find interest inform event test program state here exampl c class minimalistprint public testingemptytesteventlisten call test start void onteststartconst testingtestinfo test_info overrid printf test ss startingn test_infotest_suite_nam test_infonam call fail assert success void ontestpartresultconst testingtestpartresult test_part_result overrid printf sdnsn test_part_resultfail failur success test_part_resultfile_nam test_part_resultline_numb test_part_resultsummari call test end void ontestendconst testingtestinfo test_info overrid printf test ss endingn test_infotest_suite_nam test_infonam use event listen use event listen defin add instanc googletest event listen list repres class testeventlistenersreferencetestingmdtesteventlisten note end name main function call run_all_test c int mainint argc char argv testinginitgoogletestargc argv get hold event listen list testingtesteventlisten listen testingunittestgetinstancelisten add listen end googletest take ownership listenersappendnew minimalistprint return run_all_test there one problem default test result printer still effect output mingl output minimalist printer suppress default printer releas event listen list delet ad one line c delet listenersreleaselistenersdefault_result_print listenersappendnew minimalistprint return run_all_test sit back enjoy complet differ output test detail see sample_unittestcc sample_unittestcc httpsgithubcomgooglegoogletestblobmastergoogletestsamplessample_unittestcc event listen exampl may append one listen list onstart ontestpartresult event fire listen receiv order appear list sinc new listen ad end list default text printer default xml gener receiv event first onend event receiv listen revers order allow output listen ad later frame output listen ad earlier gener failur listen may use failurerais macro expect_ assert_ fail etc process event restrict gener failur ontestpartresult otherwis caus ontestpartresult call recurs listen handl ontestpartresult allow gener failur add listen listen list put listen handl ontestpartresult listen gener failur ensur failur gener latter attribut right test former see sample_unittestcc exampl failurerais listen sample_unittestcc httpsgithubcomgooglegoogletestblobmastergoogletestsamplessample_unittestcc failurerais listen exampl run test program advanc option googletest test program ordinari execut built run directli affect behavior via follow environ variabl andor command line flag flag work program must call testinginitgoogletest call run_all_test see list support flag usag pleas run test program help flag also use h short option specifi environ variabl flag latter take preced select test list test name sometim necessari list avail test program run filter may appli need includ flag gtest_list_test overrid flag list test follow format none testsuit testnam testnam testsuit testnam none test list actual run flag provid correspond environ variabl flag run subset test default googletest program run test user defin sometim want run subset test eg debug quickli verifi chang set gtest_filt environ variabl gtest_filt flag filter string googletest run test whose full name form testsuitenametestnam match filter format filter separ list wildcard pattern call posit pattern option follow anoth separ pattern list call neg pattern test match filter match posit pattern match neg pattern pattern may contain match string match singl charact conveni filter negativepattern also written negativepattern exampl foo_test flag thu run test foo_test gtest_filt also run everyth due singl matcheveryth valu foo_test gtest_filterfootest run everyth test suit footest foo_test gtest_filternullconstructor run test whose full name contain either null constructor foo_test gtest_filterdeathtest run nondeath test foo_test gtest_filterfootestfootestbar run everyth test suit footest except footestbar foo_test gtest_filterfootestbartestfootestbarbartestfoo run everyth test suit footest except footestbar everyth test suit bartest except bartestfoo stop test execut upon first failur default googletest program run test user defin case eg iter test develop execut may desir stop test execut upon first failur trade improv latenc complet gtest_fail_fast environ variabl gtest_fail_fast flag set test runner stop execut soon first test failur found temporarili disabl test broken test fix right away add disabled_ prefix name exclud execut better comment code use disabl test still compil thu wont rot need disabl test test suit either add disabled_ front name test altern add front test suit name exampl follow test wont run googletest even though still compil c test foo abc testfootest disabled_doesabc class disabled_bartest public testingtest test bar xyz test_fdisabled_bartest doesxyz callout note note featur use temporari painrelief still fix disabl test later date remind googletest print banner warn test program contain disabl test callout tip tip easili count number disabl test use grep number use metric improv test qualiti temporarili enabl disabl test includ disabl test test execut invok test program gtest_also_run_disabled_test flag set gtest_also_run_disabled_test environ variabl valu combin gtest_filt flag select disabl test run repeat test youll run test whose result hitormiss perhap fail time make rather hard reproduc bug debugg major sourc frustrat gtest_repeat flag allow repeat select test method program mani time hope flaki test eventu fail give chanc debug here use none foo_test gtest_repeat repeat foo_test time dont stop failur foo_test gtest_repeat neg count mean repeat forev foo_test gtest_repeat gtest_break_on_failur repeat foo_test time stop first failur especi use run debugg test fail drop debugg inspect variabl stack foo_test gtest_repeat gtest_filterfoobar repeat test whose name match filter time test program contain global setupteardownglobalsetupandteardown code repeat iter well flaki may also specifi repeat count set gtest_repeat environ variabl shuffl test specifi gtest_shuffl flag set gtest_shuffl environ variabl run test program random order help reveal bad depend test default googletest use random seed calcul current time therefor youll get differ order everi time consol output includ random seed valu reproduc orderrel test failur later specifi random seed explicitli use gtest_random_seedse flag set gtest_random_se environ variabl seed integ rang seed valu special tell googletest default behavior calcul seed current time combin gtest_repeatn googletest pick differ random seed reshuffl test iter control test output color termin output googletest use color termin output make easier spot import inform pre font colorgreenfont test footest font colorgreen run font footestdoesabc font colorgreen ok font footestdoesabc font colorgreenfont test bartest font colorgreen run font bartesthasxyzproperti font colorgreen ok font bartesthasxyzproperti font colorgreen run font bartestreturnstrueonsuccess error messag font color fail font bartestreturnstrueonsuccess font colorgreenfont test test suit ran font colorgreen pass font test font color fail font test list font color fail font bartestreturnstrueonsuccess font color fail font anothertestdoesxyz fail test pre set gtest_color environ variabl gtest_color command line flag ye auto default enabl color disabl color let googletest decid valu auto googletest use color output goe termin nonwindow platform term environ variabl set xterm xtermcolor suppress test pass default googletest print line output test indic pass fail show test failur run test program gtest_brief set gtest_brief environ variabl suppress elaps time default googletest print time take run test disabl run test program gtest_print_tim command line flag set gtest_print_tim environ variabl suppress utf text output case assert failur googletest print expect actual valu type string hexencod string well readabl utf text contain valid nonascii utf charact want suppress utf text exampl dont utf compat output medium run test program gtest_print_utf set gtest_print_utf environ variabl gener xml report googletest emit detail xml report file addit normal textual output report contain durat test thu help identifi slow test gener xml report set gtest_output environ variabl gtest_output flag string xmlpath_to_output_fil creat file given locat also use string xml case output found test_detailxml file current directori specifi directori exampl xmloutputdirectori linux xmloutputdirectori window googletest creat xml file directori name test execut eg foo_testxml test program foo_test foo_testex file alreadi exist perhap left previou run googletest pick differ name eg foo_test_xml avoid overwrit report base junitreport ant task sinc format origin intend java littl interpret requir make appli googletest test shown xml testsuit namealltest testsuit nametest_case_nam testcas nametest_nam failur messag failur messag failur messag testcas testsuit testsuit root testsuit element correspond entir test program testsuit element correspond googletest test suit testcas element correspond googletest test function instanc follow program c testmathtest addit testmathtest subtract testlogictest noncontradict could gener report xml xml version encodingutf testsuit test failur error time timestampt namealltest testsuit namemathtest test failur error time testcas nameaddit statusrun time classnam failur messagevalu add xa actual xaexpect typefailur failur messagevalu add xa actual xaexpect typefailur testcas testcas namesubtract statusrun time classnam testcas testsuit testsuit namelogictest test failur error time testcas namenoncontradict statusrun time classnam testcas testsuit testsuit thing note test attribut testsuit testsuit element tell mani test function googletest program test suit contain failur attribut tell mani fail time attribut express durat test test suit entir test program second timestamp attribut record local date time test execut failur element correspond singl fail googletest assert gener json report googletest also emit json report altern format xml gener json report set gtest_output environ variabl gtest_output flag string jsonpath_to_output_fil creat file given locat also use string json case output found test_detailjson file current directori report format conform follow json schema json schema httpjsonschemaorgschema type object definit testcas type object properti name type string test type integ failur type integ disabl type integ time type string testsuit type array item ref definitionstestinfo testinfo type object properti name type string statu type string enum run notrun time type string classnam type string failur type array item ref definitionsfailur failur type object properti failur type string type type string properti test type integ failur type integ disabl type integ error type integ timestamp type string format datetim time type string name type string testsuit type array item ref definitionstestcas report use format conform follow proto use json encodinghttpsdevelopersgooglecomprotocolbuffersdocsprotojson proto syntax proto packag googletest import googleprotobuftimestampproto import googleprotobufdurationproto messag unittest int test int failur int disabl int error googleprotobuftimestamp timestamp googleprotobufdur time string name repeat testcas testsuit messag testcas string name int test int failur int disabl int error googleprotobufdur time repeat testinfo testsuit messag testinfo string name enum statu run notrun statu statu googleprotobufdur time string classnam messag failur string failur string type repeat failur failur instanc follow program c testmathtest addit testmathtest subtract testlogictest noncontradict could gener report json test failur error time timestamp tz name alltest testsuit name mathtest test failur error time testsuit name addit statu run time classnam failur messag valu add n actual nexpect type messag valu add n actual nexpect type name subtract statu run time classnam name logictest test failur error time testsuit name noncontradict statu run time classnam callout import import exact format json document subject chang control failur report detect test prematur exit googl test implement _prematureexitfile_ protocol test runner catch kind unexpect exit test program upon start googl test creat file automat delet work finish test runner check file exist case file remain undelet inspect test exit prematur featur enabl test_premature_exit_fil environ variabl set turn assert failur breakpoint run test program debugg conveni debugg catch assert failur automat drop interact mode googletest breakonfailur mode support behavior enabl set gtest_break_on_failur environ variabl valu altern use gtest_break_on_failur command line flag disabl catch testthrown except googletest use either without except enabl test throw c except window structur except seh default googletest catch report test failur continu next test method maxim coverag test run also window uncaught except caus popup window catch except allow run test automat debug test failur howev may instead want except handl debugg examin call stack except thrown achiev set gtest_catch_except environ variabl use gtest_catch_except flag run test sanit integr undefin behavior sanitizerhttpsclangllvmorgdocsundefinedbehaviorsanitizerhtml address sanitizerhttpsgithubcomgooglesanitizerswikiaddresssanit thread sanitizerhttpsgithubcomgooglesanitizerswikithreadsanitizercppmanu provid weak function overrid trigger explicit failur detect sanit error creat refer nullptr overrid function place definit sourc file compil part main binari extern c void __ubsan_on_report fail encount undefin behavior sanit error void __asan_on_error fail encount address sanit error void __tsan_on_report fail encount thread sanit error extern c compil project one sanit enabl particular test trigger sanit error googletest report fail communitycr document follow list particular order link document creat googletest commun googlemock insightshttpsgithubcomelectricrcaircraftguyercaguy_dotfilesblobmastergoogletestinsightsmd electricrcaircraftguyhttpsgithubcomelectricrcaircraftguy googletest faq test suit name test name contain underscor callout note note googletest reserv underscor _ special purpos keyword disabled_ prefixadvancedmdtemporarilydisablingtest addit follow rational underscor _ special c reserv follow use compil standard librari identifi start _ follow uppercas letter identifi contain two consecut underscor ie __ anywher name user code prohibit use identifi let look mean test test_f current testtestsuitenam testnam gener class name testsuitename_testname_test happen testsuitenam testnam contain _ testsuitenam start _ follow uppercas letter say _foo end _foo_testname_test reserv thu invalid testsuitenam end _ say foo_ get foo__testname_test invalid testnam start _ say _bar get testsuitename__bar_test invalid testnam end _ say bar_ get testsuitename_bar__test invalid clearli testsuitenam testnam start end _ actual testsuitenam start _ long _ isnt follow uppercas letter that get complic simplic say start _ may seem fine testsuitenam testnam contain _ middl howev consid c testtim flies_like_an_arrow testtime_fli like_an_arrow two test gener class time_flies_like_an_arrow_test that good simplic ask user avoid _ testsuitenam testnam rule constrain necessari simpl easi rememb also give googletest wiggl room case implement need chang futur violat rule may immedi consequ test may may break new compil new version compil use new version googletest therefor best follow rule googletest support expect_eqnul ptr assert_eqnul ptr expect_nenul ptr assert_nenul ptr first use nullptr macro eg expect_eqptr nullptr expect_neptr nullptr assert_eqptr nullptr assert_neptr nullptr prefer syntax style guid nullptr type problem null due peculiar c requir nontrivi templat meta program trick support use null argument expect_xx assert_xx macro therefor need otherwis make implement googletest harder maintain errorpron necessari histor expect_eq macro took expect valu first argument actual valu second though argument order discourag reason someon want write expect_eqnul some_express inde request sever time therefor implement need expect_nenul ptr wasnt nearli strong assert fail alreadi know ptr must null doesnt add inform print ptr case mean expect_trueptr null work well support expect_nenul ptr consist wed support expect_neptr null well mean use templat meta program trick twice implement make even harder understand maintain believ benefit doesnt justifi cost final growth gmock matcher librari encourag peopl use unifi expect_thatvalu matcher syntax often test one signific advantag matcher approach matcher easili combin form new matcher expect_n etc macro easili combin therefor want invest matcher expect_xx macro need test differ implement interfac satisfi common requir use type test valueparameter test test variou implement interfac either type test valueparameter test get done realli user decid conveni depend particular case rough guidelin type test easier write instanc differ implement creat way modulo type exampl implement public default constructor write new typeparam factori function form eg createinstancetypeparam valueparameter test easier write need differ code pattern creat differ implement instanc eg new foo vs new bar accommod differ write factori function wrapper pass function pointer test paramet type test fail default output includ name type help quickli identifi implement wrong valueparameter test show number fail iter default need defin function return iter name pass third paramet instantiate_test_suite_p use output use type test need make sure test interfac type concret type word want make sure implicit_castmyinterfacemy_concrete_impl work my_concrete_impl work less like make mistak area use valueparameter test hope didnt confus dont mind id suggest give approach tri practic much better way grasp subtl differ two tool concret experi much easili decid one use next time got runtim error invalid proto descriptor use protocolmessageequ help callout note note protocolmessageequ protocolmessageequiv deprec pleas use equalsproto etc instead protocolmessageequ protocolmessageequiv redefin recent less toler invalid protocol buffer definit particular fooproto doesnt fulli qualifi type protocol messag refer eg messagebar messageblahbar get runtim error like descriptorcc invalid proto descriptor file pathtofooproto descriptorcc blahmymessagemy_field bar defin see proto file broken need fix make type fulli qualifi new definit protocolmessageequ protocolmessageequiv happen reveal bug death test modifi state chang seem lost death test finish death test expect_death etc execut subprocess st expect crash wont kill test program ie parent process result inmemori side effect incur observ respect subprocess parent process think run parallel univers less particular use mock death test statement invok mock method parent process think call never occur therefor may want move expect_cal statement insid expect_death macro expect_eqhtonlblah blah_blah gener weird compil error opt mode googletest bug actual bug htonl accord man htonl htonl function mean valid use htonl function pointer howev opt mode htonl defin macro break usag wors macro definit htonl use gcc extens standard c hacki implement ad hoc limit particular prevent write foosizeofhtonlx foo templat integr argument implement expect_eqa b use sizeof insid templat argument thu doesnt compil opt mode contain call htonl difficult make expect_eq bypass htonl bug solut must work differ compil variou platform compil complain undefin refer static const member variabl defin class bodi what wrong class static data member c fooh class foo static const int kbar also need defin outsid class bodi foocc c const int fookbar initi otherwis code invalid c may break unexpect way particular use googletest comparison assert expect_eq etc gener undefin refer linker error fact use work doesnt mean valid mean lucki declar static data member constexpr implicitli inlin definit separ definit foocc need c fooh class foo static constexpr int kbar defin kbar need foocc deriv test fixtur anoth ye test fixtur correspond name test suit mean one test suit use particular fixtur sometim howev multipl test case may want use slightli differ fixtur exampl may want make sure gui librari test suit dont leak import system resourc like font brush googletest share fixtur among test suit put share logic base test fixtur deriv base separ fixtur test suit want use common logic use test_f write test use deriv fixtur typic code look like c defin base test fixtur class basetest public testingtest protect deriv fixtur footest basetest class footest public basetest protect void setup overrid basetestsetup set base fixtur first addit setup work void teardown overrid cleanup work footest basetestteardown rememb tear base fixtur clean footest function variabl footest test use fixtur footest test_ffootest bar test_ffootest baz addit fixtur deriv basetest necessari continu deriv test fixtur deriv fixtur googletest limit deep hierarchi complet exampl use deriv test fixtur see sample_unittestcchttpsgithubcomgooglegoogletestblobmastergoogletestsamplessample_unittestcc compil complain void valu ignor ought mean your probabl use assert_ function doesnt return void assert_ use void function due except disabl build system pleas see detail hereadvancedmdassertionplac death test hang segfault fix googletest death test run child process way work delic write death test realli need understand workse detail death assertionsreferenceassertionsmddeath assert refer particular death test dont like multipl thread parent process first thing tri elimin creat thread outsid expect_death exampl may want use mock fake object instead real one test sometim imposs librari must use may creat thread main even reach case tri minim chanc conflict either move mani activ possibl insid expect_death extrem case want move everyth insid leav thing possibl also tri set death test style threadsaf safer slower see help go threadsaf death test rememb rerun test program begin child process therefor make sure program run sidebysid determinist end boil good concurr program make sure race condit deadlock program silver bullet sorri use constructordestructor test fixtur setupteardown ctorvssetup first thing rememb googletest reus test fixtur object across multipl test test_f googletest creat fresh test fixtur object immedi call setup run test bodi call teardown delet test fixtur object need write pertest setup teardown logic choic use test fixtur constructordestructor setupteardown former usual prefer follow benefit initi member variabl constructor option make const help prevent accident chang valu make test obvious correct case need subclass test fixtur class subclass constructor guarante call base class constructor first subclass destructor guarante call base class destructor afterward setupteardown subclass may make mistak forget call base class setupteardown call wrong time may still want use setupteardown follow case c allow virtual function call constructor destructor call method declar virtual use dynam dispatch use definit class constructor current execut call virtual method deriv class constructor chanc run danger virtual method might oper uniniti data therefor need call method overridden deriv class use setupteardown bodi constructor destructor possibl use assert_xx macro therefor setup oper could caus fatal test failur prevent test run necessari use abort abort whole test execut use setup instead constructor teardown oper could throw except must use teardown oppos destructor throw destructor lead undefin behavior usual kill program right away note mani standard librari like stl may throw except enabl compil therefor prefer teardown want write portabl test work without except googletest team consid make assert macro throw platform except enabl eg window mac os linux clientsid elimin need user propag failur subroutin caller therefor shouldnt use googletest assert destructor code could run platform compil complain match function call use assert_pr fix see detail expect_predreferenceassertionsmdexpect_pr assert refer compil complain ignor return valu call run_all_test peopl ignor return valu run_all_test instead c return run_all_test write c run_all_test wrong danger test servic need see return valu run_all_test order determin test pass main function ignor test consid success even googletest assert failur bad decid fix thank michael chastain idea code longer abl ignor run_all_test compil gcc youll get compil error see compil complain ignor return valu run_all_test fix simpl make sure valu use return valu main could introduc chang break exist test well case code alreadi broken first place didnt break compil complain constructor destructor return valu what go due peculiar c order support syntax stream messag assert_ eg c assert_eq foo blah blah foo give use assert fail expect add_failur constructor destructor workaround move content constructordestructor privat void member function switch expect_ work sectionadvancedmdassertionplac user guid explain setup function call c casesensit spell setup similarli sometim peopl spell setuptestsuit setuptestsuit wonder never call sever test suit share test fixtur logic defin new test fixtur class seem pretti tediou dont instead c class footest public basetest test_ffootest abc test_ffootest def class bartest public basetest test_fbartest abc test_fbartest def simpli typedef test fixtur c typedef basetest footest test_ffootest abc test_ffootest def typedef basetest bartest test_fbartest abc test_fbartest def googletest output buri whole bunch log messag googletest output meant concis humanfriendli report test gener textual output mix googletest output make hard read howev easi solut problem sinc log messag go stderr decid let googletest output go stdout way easili separ two use redirect exampl shell my_test gtest_outputtxt prefer test fixtur global variabl sever good reason like test need chang state global variabl make difficult keep side effect escap one test contamin other make debug difficult use fixtur test fresh set variabl that differ name thu test kept independ global variabl pollut global namespac test fixtur reus via subclass done easili global variabl use mani test suit someth common statement argument assert_death assert_deathstat matcher death assert macro use wherev statement valid basic statement c statement make sens current context particular refer global andor local variabl simpl function call often case complex express compound statement exampl shown c death test simpl function call testmydeathtest functioncal assert_deathxyz xyz fail complex express refer variabl function testmydeathtest complexexpress const bool c condit assert_deathc func objectmethodtest funcmethod fail death assert use anywher function particular insid loop testmydeathtest insideloop verifi foo foo foo die int expect_death_mfooi foo error testingmessag death assert contain compound statement testmydeathtest compoundstat verifi leas one bar bar bar die assert_death int bari bar error fixtur class footest test_ffootest bar give error match function call footestfootest googletest need abl creat object test fixtur class must default constructor normal compil defin one howev case defin explicitli declar nondefault constructor class footest disallow_evil_constructor need defin default constructor even would empti footest const nonstat data member defin default constructor initi const member initi list constructor earli version gcc doesnt forc initi const member bug fix gcc assert_death complain previou thread alreadi join linux pthread librari turn back cross line singl thread multipl thread first time creat thread manag thread creat addit get thread later thread creat join main thread thread count decrement manag thread never kill still thread mean safe run death test new nptl thread librari doesnt suffer problem doesnt creat manag thread howev dont control machin test run shouldnt depend googletest requir entir test suit instead individu test name deathtest use assert_death googletest interleav test differ test suit run test one test suit first run test next test suit googletest need set test suit first test run tear afterward split test case would requir multipl setup teardown process ineffici make semant unclean determin order test base test name instead test case name would problem follow situat c test_ffootest abcdeathtest test_ffootest uvw test_fbartest defdeathtest test_fbartest xyz sinc footestabcdeathtest need run bartestxyz dont interleav test differ test suit need run test footest case run test bartest case contradict requir run bartestdefdeathtest footestuvw dont like call entir test suit deathtest contain death test nondeath test dont like may split test suit footest foodeathtest name make clear relat c class footest public testingtest test_ffootest abc test_ffootest def use foodeathtest footest test_ffoodeathtest uvw expect_death test_ffoodeathtest xyz assert_death googletest print log messag death test child process test fail see log messag death test succe print log messag gener statement insid expect_death make harder search real problem parent log therefor googletest print death test fail realli need see log messag workaround temporarili break death test eg chang regex pattern expect match admittedli hack well consid perman solut forkandexecstyl death test implement compil complain match oper use assert give use userdefin type footyp assert must make sure stdostream operatorstdostream const footyp function defin print valu footyp addit footyp declar name space oper also need defin name space see tip week httpabseiliotip detail suppress memori leak messag window sinc static initi googletest singleton requir alloc heap visual c memori leak detector report memori leak end program run easiest way avoid use _crtmemcheckpoint _crtmemdumpallobjectssinc call report static initi heap object see msdn detail addit heap checkdebug routin code detect run test write code sniff whether run test differ thing accordingli leak testonli logic product code easi way ensur testonli code path arent run mistak product clever also lead heisenbugshttpsenwikipediaorgwikiheisenbug therefor strongli advis practic googletest doesnt provid way gener recommend way caus code behav differ test depend injectionhttpenwikipediaorgwikidependency_inject inject differ function test product code sinc product code doesnt link fortest logic testonlyhttpdocsbazelbuildversionsmasterbecommondefinitionshtmlcommontestonli attribut build target help ensur danger accident run howev realli realli realli choic follow rule end test program name _test use horribl hack snif execut name argv main know whether code test temporarili disabl test broken test fix right away add disabled_ prefix name exclud execut better comment code use disabl test still compil thu wont rot includ disabl test test execut invok test program gtest_also_run_disabled_test flag ok two separ testfoo bar test method defin differ namespac ye rule test method test suit must use fixtur class mean follow allow test use fixtur class testingtest c namespac foo testcooltest dosometh succeed namespac foo namespac bar testcooltest dosometh succeed namespac bar howev follow code allow produc runtim error googletest test method use differ test fixtur class test suit name c namespac foo class cooltest public testingtest fixtur foocooltest test_fcooltest dosometh succeed namespac foo namespac bar class cooltest public testingtest fixtur barcooltest test_fcooltest dosometh succeed namespac bar quickstart build bazel tutori aim get run googletest use bazel build system your use googletest first time need refresh recommend tutori start point prerequisit complet tutori youll need compat oper system eg linux maco window compat c compil support least c bazelhttpsbazelbuild prefer build system use googletest team see support platformsplatformsmd inform platform compat googletest dont alreadi bazel instal see bazel instal guidehttpsdocsbazelbuildversionsmasterinstallhtml callout note note termin command tutori show unix shell prompt command work window command line well set bazel workspac bazel workspacehttpsdocsbazelbuildversionsmasterbuildrefhtmlworkspac directori filesystem use manag sourc file softwar want build workspac directori text file name workspac may empti may contain refer extern depend requir build output first creat directori workspac mkdir my_workspac cd my_workspac next youll creat workspac file specifi depend common recommend way depend googletest use bazel extern dependencyhttpsdocsbazelbuildversionsmasterexternalhtml via http_archiv rulehttpsdocsbazelbuildversionsmasterrepohttphtmlhttp_arch root directori workspac my_workspac creat file name workspac follow content loadbazel_toolstoolsbuild_defsrepohttpbzl http_archiv http_archiv name com_google_googletest url httpsgithubcomgooglegoogletestarchivecfefcfdceeffcccezip strip_prefix googletestcfefcfdceeffccc configur declar depend googletest download zip archiv github exampl cfefcfdceeffccc git commit hash googletest version use recommend updat hash often point latest version bazel also need depend rules_cc repositoryhttpsgithubcombazelbuildrules_cc build c code add follow workspac file http_archiv name rules_cc url httpsgithubcombazelbuildrules_ccarchiveafaeadcbaaezip strip_prefix rules_ccafaeadcbaa your readi build c code use googletest creat run binari bazel workspac set use googletest code within project exampl creat file name hello_testcc my_workspac directori follow content cpp includ gtestgtesth demonstr basic assert testhellotest basicassert expect two string equal expect_strnehello world expect equal expect_eq googletest provid assertionsprimermdassert use test behavior code sampl includ main googletest header file demonstr basic assert build code creat file name build directori follow content loadrules_ccccdefsbzl cc_test cc_test name hello_test size small src hello_testcc dep com_google_googletestgtest_main cc_test rule declar c test binari want build link googletest gtest_main use prefix specifi workspac file com_google_googletest inform bazel build file see bazel c tutorialhttpsdocsbazelbuildversionsmastertutorialcpphtml build run test pre strongmy_workspac bazel test test_outputal hello_teststrong info analyz target hello_test packag load target configur info found test target info test hello_test test output hello_test run main gmock_maincc run test test suit global test environ setup test hellotest run hellotestbasicassert ok hellotestbasicassert ms test hellotest ms total global test environ teardown test test suit ran ms total pass test target hello_test uptod bazelbinhello_test info elaps time critic path info process intern linuxsandbox info build complet success total action hello_test pass info build complet success total action pre congratul youv success built run test binari use googletest next step check primerprimermd start learn write simpl test see code samplessamplesmd exampl show use varieti googletest featur gmock cheat sheet defin mock class mock normal class mockclass given cpp class foo virtual foo virtual int getsiz const virtual string describeconst char name virtual string describeint type virtual bool processbar elem int count note foo must virtual defin mock cpp includ gmockgmockh class mockfoo public foo mock_methodint getsiz const overrid mock_methodstr describ const char name overrid mock_methodstr describ int type overrid mock_methodbool process bar elem int count overrid creat nice mock ignor uninterest call naggi mock warn uninterest call strict mock treat failur cpp use testingnicemock use testingnaggymock use testingstrictmock nicemockmockfoo nice_foo type subclass mockfoo naggymockmockfoo naggy_foo type subclass mockfoo strictmockmockfoo strict_foo type subclass mockfoo callout note note mock object current naggi default may make nice default futur mock class templat mocktempl class templat mock like class mock cpp templat typenam elem class stackinterfac virtual stackinterfac virtual int getsiz const virtual void pushconst elem x note member function mock includ stackinterfac must virtual cpp templat typenam elem class mockstack public stackinterfaceelem mock_methodint getsiz const overrid mock_methodvoid push const elem x overrid specifi call convent mock function mock function doesnt use default call convent specifi ad calltypeconvent mock_method th paramet exampl cpp mock_methodbool foo int n calltypestdmethodcalltyp mock_methodint bar doubl x doubl const calltypestdmethodcalltyp stdmethodcalltyp defin objbaseh window use mock test usingmock typic work flow import gmock name need use gmock symbol test namespac unless macro otherwis note creat mock object option set default action mock object set expect mock object call exercis code use mock object necessari check result use googletest assert mock object destruct gmock automat verifi expect satisfi here exampl cpp use testingreturn testbartest doesthi mockfoo foo on_callfoo getsiz willbydefaultreturn default action expect_callfoo describ time willrepeatedlyreturncategori expect expect_eqmyproductionfunctionfoo good set default action oncal gmock builtin default action function return void bool numer valu pointer c addit return defaultconstruct valu one exist given type custom default action function return type use defaultvaluetreferencemockingmddefaultvalu exampl cpp set default action return type stdunique_ptrbuzz creat new buzz everi time defaultvaluestdunique_ptrbuzzsetfactori return makeuniquebuzzaccesslevelkintern fire default action makebuzz run return new buzz object expect_callmock_buzzer_ makebuzzhellotimesanynumb auto buzz mock_buzzer_makebuzzhello auto buzz mock_buzzer_makebuzzhello expect_nebuzz nullptr expect_nebuzz nullptr expect_nebuzz buzz reset default action return type stdunique_ptrbuzz avoid interfer test defaultvaluestdunique_ptrbuzzclear custom default action particular method specif mock object use on_callreferencemockingmdon_cal on_cal similar syntax expect_cal use set default behavior requir mock method call see know expectgmock_cook_bookmduseoncal detail discuss set expect expectcal see expect_callreferencemockingmdexpect_cal mock refer matcher matcherlist see matcher referencereferencematchersmd action actionlist see action referencereferenceactionsmd cardin cardinalitylist see time clausereferencemockingmdexpect_calltim expect_cal mock refer expect order default expect match order expect must match given order use clausereferencemockingmdexpect_callaft insequ clausereferencemockingmdexpect_callinsequ expect_cal use insequ objectreferencemockingmdinsequ verifi reset mock gmock verifi expect mock object destruct earlier cpp use testingmock verifi remov expect mock_obj return true success mockverifyandclearexpectationsmock_obj verifi remov expect mock_obj also remov default action set on_cal return true success mockverifyandclearmock_obj set new expect verifi clear mock use set expect code exercis mock undefin behavior see use mock testsgmock_for_dummiesmdusingmocksintest inform also tell gmock mock object leak doesnt need verifi cpp mockallowleakmock_obj mock class gmock defin conveni mock class templat cpp class mockfunctionra public mock_methodr call see recipegmock_cook_bookmdusingcheckpoint one applic flag flag descript gmock_catch_leaked_mock dont report leak mock object failur gmock_verboselevel set default verbos level info warn error googl mock messag test refer toc_depth page list facil provid googletest write test program use includ header gtestgtesth macro googletest defin follow macro write test test test pre testemtestsuitenameem emtestnameem emstatementsem pre defin individu test name testnam test suit testsuitenam consist given statement argument testsuitenam testnam must valid c identifi must contain underscor _ test differ test suit individu name statement within test bodi code test assertionsassertionsmd use within test bodi determin outcom test test_f test_f pre test_femtestfixturenameem emtestnameem emstatementsem pre defin individu test name testnam use test fixtur class testfixturenam test suit name testfixturenam argument testfixturenam testnam must valid c identifi must contain underscor _ testfixturenam must name test fixtur classse test fixturesprimermdsamedatamultipletest statement within test bodi code test assertionsassertionsmd use within test bodi determin outcom test test_p test_p pre test_pemtestfixturenameem emtestnameem emstatementsem pre defin individu valueparameter test name testnam use test fixtur class testfixturenam test suit name testfixturenam argument testfixturenam testnam must valid c identifi must contain underscor _ testfixturenam must name valueparameter test fixtur classse valueparameter testsadvancedmdvalueparameterizedtest statement within test bodi code test within test bodi test paramet access getparam function see withparaminterfacewithparaminterfac exampl cpp test_pmytestsuit doessometh expect_truedosomethinggetparam assertionsassertionsmd use within test bodi determin outcom test see also instantiate_test_suite_pinstantiate_test_suite_p instantiate_test_suite_p instantiate_test_suite_p instantiate_test_suite_pinstantiationnametestsuitenameparam_gener instantiate_test_suite_pinstantiationnametestsuitenameparam_generatorname_gener instanti valueparameter test suit testsuitenam defin test_ptest_p argument instantiationnam uniqu name instanti test suit distinguish multipl instanti test output instanti name ad prefix test suit name testsuitenam argument param_gener one follow googletestprovid function gener test paramet defin test namespac span idparamgeneratorsspan paramet gener behavior rangebegin end step yield valu begin beginstep beginstepstep valu includ end step default valuesv v vn yield valu v v vn valuesincontain valuesinbeginend yield valu cstyle array stlstyle contain iter rang begin end bool yield sequenc fals true combineg g gn yield stdtupl ntupl combin cartesian product valu gener given n gener g g gn option last argument name_gener function functor gener custom test name suffix base test paramet function must accept argument type testparaminfoclass paramtypetestparaminfo return stdstring test name suffix contain alphanumer charact underscor googletest provid printtostringparamnameprinttostringparamnam custom function use control cpp instantiate_test_suite_p myinstanti mytestsuit testingvalu const testingtestparaminfomytestsuiteparamtyp info use infoparam gener test suffix stdstring name return name inform see valueparameter testsadvancedmdvalueparameterizedtest see also gtest_allow_uninstantiated_parameterized_testgtest_allow_uninstantiated_parameterized_test typed_test_suit typed_test_suit typed_test_suitetestfixturenametyp defin type test suit base test fixtur testfixturenam test suit name testfixturenam argument testfixturenam fixtur class templat parameter type exampl cpp templat typenam class myfixtur public testingtest public use list stdlistt static shared_ value_ argument type typestyp object repres list type run test exampl cpp use mytyp testingtypeschar int unsign int typed_test_suitemyfixtur mytyp type alia use typedef necessari typed_test_suit macro pars correctli see also typed_testtyped_test type testsadvancedmdtypedtest inform typed_test typed_test pre typed_testemtestsuitenameem emtestnameem emstatementsem pre defin individu type test name testnam type test suit testsuitenam test suit must defin typed_test_suitetyped_test_suit within test bodi special name typeparam refer type paramet testfixtur refer fixtur class see follow exampl cpp typed_testmyfixtur exampl insid test refer special name typeparam get type paramet sinc insid deriv class templat c requir us visit member myfixtur via typeparam n thisvalue_ visit static member fixtur add testfixtur prefix n testfixtureshared_ refer typedef fixtur add typenam testfixtur prefix typenam requir satisfi compil typenam testfixturelist valu valuespush_backn inform see type testsadvancedmdtypedtest typed_test_suite_p typed_test_suite_p typed_test_suite_ptestfixturenam defin typeparameter test suit base test fixtur testfixturenam test suit name testfixturenam argument testfixturenam fixtur class templat parameter type see typed_test_suitetyped_test_suit exampl see also typed_test_ptyped_test_p typeparameter testsadvancedmdtypeparameterizedtest inform typed_test_p typed_test_p pre typed_test_pemtestsuitenameem emtestnameem emstatementsem pre defin individu typeparameter test name testnam typeparameter test suit testsuitenam test suit must defin typed_test_suite_ptyped_test_suite_p within test bodi special name typeparam refer type paramet testfixtur refer fixtur class see typed_testtyped_test exampl see also register_typed_test_suite_pregister_typed_test_suite_p typeparameter testsadvancedmdtypeparameterizedtest inform register_typed_test_suite_p register_typed_test_suite_p register_typed_test_suite_ptestsuitenametestnam regist typeparameter test testnam test suit testsuitenam test suit test must defin typed_test_suite_ptyped_test_suite_p typed_test_ptyped_test_p exampl cpp defin test suit test typed_test_suite_pmyfixtur typed_test_pmyfixtur haspropertya typed_test_pmyfixtur haspropertyb regist test test suit register_typed_test_suite_pmyfixtur haspropertya haspropertyb see also instantiate_typed_test_suite_pinstantiate_typed_test_suite_p typeparameter testsadvancedmdtypeparameterizedtest inform instantiate_typed_test_suite_p instantiate_typed_test_suite_p instantiate_typed_test_suite_pinstantiationnametestsuitenametyp instanti typeparameter test suit testsuitenam test suit must regist register_typed_test_suite_pregister_typed_test_suite_p argument instantiationnam uniqu name instanti test suit distinguish multipl instanti test output instanti name ad prefix test suit name testsuitenam argument type typestyp object repres list type run test exampl cpp use mytyp testingtypeschar int unsign int instantiate_typed_test_suite_pmyinstanti myfixtur mytyp type alia use typedef necessari instantiate_typed_test_suite_p macro pars correctli inform see typeparameter testsadvancedmdtypeparameterizedtest friend_test friend_test friend_testtestsuitenametestnam within class bodi declar individu test friend class enabl test access privat class member class defin namespac order friend class test fixtur test must defin exact namespac without inlin anonym namespac exampl class definit look like follow cpp namespac my_namespac class myclass friend class myclasstest friend_testmyclasstest haspropertya friend_testmyclasstest haspropertyb definit class myclass namespac my_namespac test code look like cpp namespac my_namespac class myclasstest public testingtest test_fmyclasstest haspropertya test_fmyclasstest haspropertyb namespac my_namespac see test privat codeadvancedmdtestingprivatecod inform scoped_trac scoped_trac scoped_tracemessag caus current file name line number given messag messag ad failur messag assert failur occur scope inform see ad trace assertionsadvancedmdaddingtracestoassert see also scopedtrac classscopedtrac gtest_skip gtest_skip gtest_skip prevent test execut runtim use individu test case setup method test environ test fixtur class deriv environmentenviron testtest class use global test environ setup method skip test test program use test fixtur setup method skip test correspond test suit similar assert gtest_skip allow stream custom messag see skip test executionadvancedmdskippingtestexecut inform gtest_allow_uninstantiated_parameterized_test gtest_allow_uninstantiated_parameterized_test gtest_allow_uninstantiated_parameterized_testtestsuitenam allow valueparameter test suit testsuitenam uninstanti default everi test_ptest_p call without correspond instantiate_test_suite_pinstantiate_test_suite_p call caus fail test test suit googletestverif gtest_allow_uninstantiated_parameterized_test suppress failur given test suit class type googletest defin follow class type help write test assertionresult assertionresult testingassertionresult class indic whether assert success assert wasnt success assertionresult object store nonempti failur messag retriev object messag method creat instanc class use one factori function assertionsuccessassertionsuccess assertionfailureassertionfailur assertionexcept assertionexcept testingassertionexcept except thrown testeventlistenerontestpartresulttesteventlistenerontestpartresult emptytesteventlisten emptytesteventlisten testingemptytesteventlisten provid empti implement method testeventlistenertesteventlisten interfac subclass need overrid method care environ environ testingenviron repres global test environ see global setup teardownadvancedmdglobalsetupandteardown protect method environmentprotect setup environmentsetup virtual void environmentsetup overrid defin set environ teardown environmentteardown virtual void environmentteardown overrid defin tear environ scopedtrac scopedtrac testingscopedtrac instanc class caus trace includ everi test failur messag gener code scope lifetim scopedtrac instanc effect undon destruct instanc scopedtrac constructor follow form cpp templat typenam scopedtraceconst char file int line const messag exampl usag cpp testingscopedtrac tracefilecc messag result trace includ given sourc file path line number given messag messag argument anyth streamabl stdostream see also scoped_tracescoped_trac test test testingtest abstract class test inherit test copyabl public method testpubl setuptestsuit testsetuptestsuit static void testsetuptestsuit perform share setup test test suit googletest call setuptestsuit run first test test suit teardowntestsuit testteardowntestsuit static void testteardowntestsuit perform share teardown test test suit googletest call teardowntestsuit run last test test suit hasfatalfailur testhasfatalfailur static bool testhasfatalfailur return true current test fatal failur hasnonfatalfailur testhasnonfatalfailur static bool testhasnonfatalfailur return true current test nonfat failur hasfailur testhasfailur static bool testhasfailur return true current test failur either fatal nonfat isskip testisskip static bool testisskip return true current test skip recordproperti testrecordproperti static void testrecordpropertyconst stdstring key const stdstring valu static void testrecordpropertyconst stdstring key int valu log properti current test test suit entir invoc test program last valu given key log key must valid xml attribut name conflict one alreadi use googletest name statu time classnam type_param value_param recordproperti public static call util function member test fixtur call recordproperti made lifespan test moment constructor start moment destructor finish output xml attribut testcas element properti record fixtur setuptestsuit teardowntestsuit method log attribut correspond testsuit element call recordproperti made global context invoc run_all_test setupteardown method regist environ object output attribut testsuit element protect method testprotect setup testsetup virtual void testsetup overrid perform test fixtur setup googletest call setup run individu test teardown testteardown virtual void testteardown overrid perform test fixtur teardown googletest call teardown run individu test testwithparam testwithparam testingtestwithparamt conveni class inherit testtest withparaminterfacetwithparaminterfac testsuit testsuit repres test suit testsuit copyabl public method testsuitepubl name testsuitenam const char testsuitenam const get name test suit type_param testsuitetype_param const char testsuitetype_param const return name paramet type null type typeparameter test suit see type testsadvancedmdtypedtest typeparameter testsadvancedmdtypeparameterizedtest should_run testsuiteshould_run bool testsuiteshould_run const return true test test suit run successful_test_count testsuitesuccessful_test_count int testsuitesuccessful_test_count const get number success test test suit skipped_test_count testsuiteskipped_test_count int testsuiteskipped_test_count const get number skip test test suit failed_test_count testsuitefailed_test_count int testsuitefailed_test_count const get number fail test test suit reportable_disabled_test_count testsuitereportable_disabled_test_count int testsuitereportable_disabled_test_count const get number disabl test report xml report disabled_test_count testsuitedisabled_test_count int testsuitedisabled_test_count const get number disabl test test suit reportable_test_count testsuitereportable_test_count int testsuitereportable_test_count const get number test print xml report test_to_run_count testsuitetest_to_run_count int testsuitetest_to_run_count const get number test test suit run total_test_count testsuitetotal_test_count int testsuitetotal_test_count const get number test test suit pass testsuitepass bool testsuitepass const return true test suit pass fail testsuitefail bool testsuitefail const return true test suit fail elapsed_tim testsuiteelapsed_tim timeinmilli testsuiteelapsed_tim const return elaps time millisecond start_timestamp testsuitestart_timestamp timeinmilli testsuitestart_timestamp const get time test suit start ms start unix epoch gettestinfo testsuitegettestinfo const testinfo testsuitegettestinfoint const return testinfotestinfo ith test among test rang total_test_count rang return null ad_hoc_test_result testsuitead_hoc_test_result const testresult testsuitead_hoc_test_result const return testresulttestresult hold test properti record execut setuptestsuit teardowntestsuit testinfo testinfo testingtestinfo store inform test public method testinfopubl test_suite_nam testinfotest_suite_nam const char testinfotest_suite_nam const return test suit name name testinfonam const char testinfonam const return test name type_param testinfotype_param const char testinfotype_param const return name paramet type null type typeparameter test see type testsadvancedmdtypedtest typeparameter testsadvancedmdtypeparameterizedtest value_param testinfovalue_param const char testinfovalue_param const return text represent valu paramet null valueparameter test see valueparameter testsadvancedmdvalueparameterizedtest file testinfofil const char testinfofil const return file name test defin line testinfolin int testinfolin const return line test defin is_in_another_shard testinfois_in_another_shard bool testinfois_in_another_shard const return true test run anoth shard should_run testinfoshould_run bool testinfoshould_run const return true test run test disabl disabl also_run_disabled_test flag specifi full name match userspecifi filter googletest allow user filter test full name test match filter run see run subset testsadvancedmdrunningasubsetofthetest inform is_report testinfois_report bool testinfois_report const return true test appear xml report result testinforesult const testresult testinforesult const return result test see testresulttestresult testparaminfo testparaminfo testingtestparaminfot describ paramet valueparameter test type type paramet contain field param index hold valu paramet integ index respect unittest unittest testingunittest class contain inform test program unittest singleton class instanc creat unittestgetinst first call instanc never delet unittest copyabl public method unittestpubl getinst unittestgetinst static unittest unittestgetinst get singleton unittest object first time method call unittest object construct return consecut call return object original_working_dir unittestoriginal_working_dir const char unittestoriginal_working_dir const return work directori first testtest test_ftest_f execut unittest object own string current_test_suit unittestcurrent_test_suit const testsuit unittestcurrent_test_suit const return testsuitetestsuit object test that current run null test run current_test_info unittestcurrent_test_info const testinfo unittestcurrent_test_info const return testinfotestinfo object test that current run null test run random_se unittestrandom_se int unittestrandom_se const return random seed use start current test run successful_test_suite_count unittestsuccessful_test_suite_count int unittestsuccessful_test_suite_count const get number success test suit failed_test_suite_count unittestfailed_test_suite_count int unittestfailed_test_suite_count const get number fail test suit total_test_suite_count unittesttotal_test_suite_count int unittesttotal_test_suite_count const get number test suit test_suite_to_run_count unittesttest_suite_to_run_count int unittesttest_suite_to_run_count const get number test suit contain least one test run successful_test_count unittestsuccessful_test_count int unittestsuccessful_test_count const get number success test skipped_test_count unittestskipped_test_count int unittestskipped_test_count const get number skip test failed_test_count unittestfailed_test_count int unittestfailed_test_count const get number fail test reportable_disabled_test_count unittestreportable_disabled_test_count int unittestreportable_disabled_test_count const get number disabl test report xml report disabled_test_count unittestdisabled_test_count int unittestdisabled_test_count const get number disabl test reportable_test_count unittestreportable_test_count int unittestreportable_test_count const get number test print xml report total_test_count unittesttotal_test_count int unittesttotal_test_count const get number test test_to_run_count unittesttest_to_run_count int unittesttest_to_run_count const get number test run start_timestamp unitteststart_timestamp timeinmilli unitteststart_timestamp const get time test program start ms start unix epoch elapsed_tim unittestelapsed_tim timeinmilli unittestelapsed_tim const get elaps time millisecond pass unittestpass bool unittestpass const return true unit test pass ie test suit pass fail unittestfail bool unittestfail const return true unit test fail ie test suit fail someth outsid test fail gettestsuit unittestgettestsuit const testsuit unittestgettestsuiteint const get testsuitetestsuit object ith test suit among test suit rang total_test_suite_count rang return null ad_hoc_test_result unittestad_hoc_test_result const testresult unittestad_hoc_test_result const return testresulttestresult contain inform test failur properti log outsid individu test suit listen unittestlisten testeventlisten unittestlisten return list event listen use track event insid googletest see testeventlistenerstesteventlisten testeventlisten testeventlisten testingtesteventlisten interfac trace execut test method list order correspond event fire public method testeventlistenerpubl ontestprogramstart testeventlistenerontestprogramstart virtual void testeventlistenerontestprogramstartconst unittest unit_test fire test activ start ontestiterationstart testeventlistenerontestiterationstart virtual void testeventlistenerontestiterationstartconst unittest unit_test int iter fire iter test start may one iter gtest_flagrepeat set iter iter index start onenvironmentssetupstart testeventlisteneronenvironmentssetupstart virtual void testeventlisteneronenvironmentssetupstartconst unittest unit_test fire environ setup iter test start onenvironmentssetupend testeventlisteneronenvironmentssetupend virtual void testeventlisteneronenvironmentssetupendconst unittest unit_test fire environ setup iter test end ontestsuitestart testeventlistenerontestsuitestart virtual void testeventlistenerontestsuitestartconst testsuit test_suit fire test suit start onteststart testeventlisteneronteststart virtual void testeventlisteneronteststartconst testinfo test_info fire test start ontestpartresult testeventlistenerontestpartresult virtual void testeventlistenerontestpartresultconst testpartresult test_part_result fire fail assert succeed invoc want throw except function skip next test must assertionexceptionassertionexcept inherit ontestend testeventlistenerontestend virtual void testeventlistenerontestendconst testinfo test_info fire test end ontestsuiteend testeventlistenerontestsuiteend virtual void testeventlistenerontestsuiteendconst testsuit test_suit fire test suit end onenvironmentsteardownstart testeventlisteneronenvironmentsteardownstart virtual void testeventlisteneronenvironmentsteardownstartconst unittest unit_test fire environ teardown iter test start onenvironmentsteardownend testeventlisteneronenvironmentsteardownend virtual void testeventlisteneronenvironmentsteardownendconst unittest unit_test fire environ teardown iter test end ontestiterationend testeventlistenerontestiterationend virtual void testeventlistenerontestiterationendconst unittest unit_test int iter fire iter test finish ontestprogramend testeventlistenerontestprogramend virtual void testeventlistenerontestprogramendconst unittest unit_test fire test activ end testeventlisten testeventlisten testingtesteventlisten let user add listen track event googletest public method testeventlistenerspubl append testeventlistenersappend void testeventlistenersappendtesteventlisten listen append event listen end list googletest assum ownership listen ie delet listen test program finish releas testeventlistenersreleas testeventlisten testeventlistenersreleasetesteventlisten listen remov given event listen list return becom caller respons delet listen return null listen found list default_result_print testeventlistenersdefault_result_print testeventlisten testeventlistenersdefault_result_print const return standard listen respons default consol output remov listen list shut default consol output note remov object listen list releasetesteventlistenersreleas transfer ownership caller make function return null next time default_xml_gener testeventlistenersdefault_xml_gener testeventlisten testeventlistenersdefault_xml_gener const return standard listen respons default xml output control gtest_outputxml flag remov listen list user want shut default xml output control flag substitut custom one note remov object listen list releasetesteventlistenersreleas transfer ownership caller make function return null next time testpartresult testpartresult testingtestpartresult copyabl object repres result test part ie assert explicit fail add_failur success public method testpartresultpubl type testpartresulttyp type testpartresulttyp const get outcom test part return type type enum defin follow cpp enum type ksuccess succeed knonfatalfailur fail test continu kfatalfailur fail test termin kskip skip file_nam testpartresultfile_nam const char testpartresultfile_nam const get name sourc file test part took place null unknown line_numb testpartresultline_numb int testpartresultline_numb const get line sourc file test part took place unknown summari testpartresultsummari const char testpartresultsummari const get summari failur messag messag testpartresultmessag const char testpartresultmessag const get messag associ test part skip testpartresultskip bool testpartresultskip const return true test part skip pass testpartresultpass bool testpartresultpass const return true test part pass nonfatally_fail testpartresultnonfatally_fail bool testpartresultnonfatally_fail const return true test part nonfat fail fatally_fail testpartresultfatally_fail bool testpartresultfatally_fail const return true test part fatal fail fail testpartresultfail bool testpartresultfail const return true test part fail testproperti testproperti testingtestproperti copyabl object repres userspecifi test properti output keyvalu string pair public method testpropertypubl key key const char key const get usersuppli key valu valu const char valu const get usersuppli valu setvalu setvalu void setvalueconst stdstring new_valu set new valu overrid previou one testresult testresult testingtestresult contain inform result singl test testresult copyabl public method testresultpubl total_part_count testresulttotal_part_count int testresulttotal_part_count const get number test part sum number success test part number fail test part test_property_count testresulttest_property_count int testresulttest_property_count const return number test properti pass testresultpass bool testresultpass const return true test pass ie test part fail skip testresultskip bool testresultskip const return true test skip fail testresultfail bool testresultfail const return true test fail hasfatalfailur testresulthasfatalfailur bool testresulthasfatalfailur const return true test fatal fail hasnonfatalfailur testresulthasnonfatalfailur bool testresulthasnonfatalfailur const return true test nonfat failur elapsed_tim testresultelapsed_tim timeinmilli testresultelapsed_tim const return elaps time millisecond start_timestamp testresultstart_timestamp timeinmilli testresultstart_timestamp const get time test case start ms start unix epoch gettestpartresult testresultgettestpartresult const testpartresult testresultgettestpartresultint const return testpartresulttestpartresult ith test part result among result rang total_part_count rang abort program gettestproperti testresultgettestproperti const testproperti testresultgettestpropertyint const return testpropertytestproperti object ith test properti rang test_property_count rang abort program timeinmilli timeinmilli testingtimeinmilli integ type repres time millisecond type type testingtypest repres list type use type test typeparameter test templat argument number type exampl testingtypeschar int unsign int see type testsadvancedmdtypedtest typeparameter testsadvancedmdtypeparameterizedtest inform withparaminterfac withparaminterfac testingwithparaminterfacet pure interfac class valueparameter test inherit valueparameter test fixtur class must inherit testtest withparaminterfac case mean inherit testwithparamtestwithparam complic test hierarchi may need inherit test withparaminterfac differ level interfac defin type alia paramtyp paramet type support access test paramet valu via getparam method static const paramtyp getparam inform see valueparameter testsadvancedmdvalueparameterizedtest function googletest defin follow function help write run test initgoogletest initgoogletest void testinginitgoogletestint argc char argv void testinginitgoogletestint argc wchar_t argv void testinginitgoogletest initi googletest must call call run_all_testsrun_all_test particular pars command line flag googletest recogn whenev googletest flag seen remov argv argc decrement valu return instead googletest flag variabl updat initgoogletestint argc wchar_t argv overload use window program compil unicod mode argumentless initgoogletest overload use arduinoembed platform argcargv addglobaltestenviron addglobaltestenviron environ testingaddglobaltestenvironmentenviron env add test environ test program must call run_all_testsrun_all_test call see global setup teardownadvancedmdglobalsetupandteardown inform see also environmentenviron registertest registertest cpp templat typenam factori testinfo testingregistertestconst char test_suite_nam const char test_nam const char type_param const char value_param const char file int line factori factori dynam regist test framework factori argument factori callabl moveconstruct object function pointer creat new instanc test object handl ownership caller signatur callabl fixtur fixtur test fixtur class test test regist test_suite_nam must return fixtur type check runtim framework infer fixtur class factori call setuptestsuit teardowntestsuit method must call run_all_testsrun_all_test invok otherwis behavior undefin see regist test programmaticallyadvancedmdregisteringtestsprogrammat inform run_all_test run_all_test int run_all_test use function main run test return test success otherwis run_all_test invok command line pars initgoogletestinitgoogletest function formerli macro thu global namespac allcap name assertionsuccess assertionsuccess assertionresult testingassertionsuccess creat success assert result see assertionresultassertionresult assertionfailur assertionfailur assertionresult testingassertionfailur creat fail assert result use oper store failur messag cpp testingassertionfailur failur messag see assertionresultassertionresult staticasserttypeeq staticasserttypeeq testingstaticasserttypeeqt compiletim assert type equal compil type valu return irrelev see type assertionsadvancedmdtypeassert inform printtostr printtostr stdstring testingprinttostringx print valu x use googletest valu printer see teach googletest print valuesadvancedmdteachinggoogletesthowtoprintyourvalu inform printtostringparamnam printtostringparamnam stdstring testingprinttostringparamnametestparaminfot info builtin parameter test name gener return result printtostringprinttostr call infoparam work test paramet stdstring c string see specifi name valueparameter test parametersadvancedmdspecifyingnamesforvalueparameterizedtestparamet inform see also testparaminfotestparaminfo instantiate_test_suite_pinstantiate_test_suite_p action refer actionsgmock_for_dummiesmdactionswhatshoulditdo specifi mock function invok page list builtin action provid googletest action defin test namespac return valu action descript return return void mock function returnvalu return valu type valu differ mock function return type valu convert latter type iat time expect seti action execut returnargn return nth base argument returnnewta ak return new ta ak differ object creat time returnnul return null pointer returnpointeeptr return valu point ptr returnrefvari return refer variabl returnrefofcopyvalu return refer copi valu copi live long action returnroundrobina ak call return next ai list start begin end list reach side effect action descript assignvari valu assign valu variabl deleteargn delet nth base argument must pointer saveargnpoint save nth base argument pointer saveargpointeenpoint save valu point nth base argument pointer setargrefereenvalu assign valu variabl referenc nth base argument setargpointeenvalu assign valu variabl point nth base argument setargumentpointeenvalu setargpointeenvalu deprec remov v setarrayargumentnfirst last copi element sourc rang first last array point nth base argument either pointer iter action take ownership element sourc rang seterrnoandreturnerror valu set errno error return valu throwexcept throw given except copyabl valu avail sinc v use function functor lambda action follow callabl mean free function stdfunction functor lambda action descript f invok f argument pass mock function f callabl invokef invok f argument pass mock function f globalstat function functor invokeobject_point classmethod invok method object argument pass mock function invokewithoutargsf invok f globalstat function functor f must take argument invokewithoutargsobject_point classmethod invok method object take argument invokeargumentnarg arg argk invok mock function nth base argument must function functor k argument return valu invok function use return valu action defin callabl use invok declar unus paramet unus cpp use testinginvok doubl distanceunus doubl x doubl return sqrtxx yy expect_callmock foohi _ _willonceinvokedist invokecallback invokewithoutargscallback take ownership callback must perman type callback must base callback type instead deriv one eg cpp blockingclosur done new blockingclosur invokedon wont compil closur done new blockingclosur invokedon work invokeargumentn argument need pass refer wrap insid stdref exampl cpp use testinginvokeargu invokeargu stringhi stdreffoo call mock function argument pass stringhi valu foo refer default action action descript dodefault default action specifi on_cal builtin one callout note note due technic reason dodefault use insid composit action tri result runtim error composit action action descript doalla action return result invoc first n subact must return void receiv readonli view argument ignoreresulta perform action ignor result must return void withargna pass nth base argument mock function action perform withargsn n nka pass select base argument mock function action perform withoutargsa perform action without argument defin action macro descript actionsum return arg arg defin action sum return sum mock function argument action_pplu n return arg n defin action plusn return sum mock function argument n action_pkfoo p pk statement defin parameter action foop pk execut given statement action macro use insid function class mock refer page list facil provid googletest creat work mock object use includ header gmockgmockh macro macro googletest defin follow macro work mock mock_method mock_method mock_methodreturn_typemethod_nam arg mock_methodreturn_typemethod_nam arg spec defin mock method method_nam argument arg return type return_typ within mock class paramet mock_method mirror method declar option fourth paramet spec commasepar list qualifi follow qualifi accept qualifi mean const make mock method const method requir overrid const method overrid mark method overrid recommend overrid virtual method noexcept mark method noexcept requir overrid noexcept method calltypecalltyp set call type method exampl calltypestdmethodcalltyp use window refqualifi mark method given refer qualifi exampl ref ref requir overrid method refer qualifi note comma argument prevent mock_method pars argument correctli appropri surround parenthes see follow exampl cpp class mymock public follow line compil due comma argument mock_methodstdpairbool int getpair error mock_methodbool checkmap stdmapint doubl bool error one solut wrap argument contain comma parenthes mock_methodstdpairbool int getpair mock_methodbool checkmap stdmapint doubl bool anoth solut use type alias use boolandint stdpairbool int mock_methodboolandint getpair use mapintdoubl stdmapint doubl mock_methodbool checkmap mapintdoubl bool mock_method must use public section mock class definit regardless whether method mock public protect privat base class expect_cal expect_cal expect_callmock_objectmethod_namematch creat expectationgmock_for_dummiesmdsettingexpect method method_nam object mock_object call argument match given matcher matcher expect_cal must preced code exercis mock object paramet matcher commasepar list matchersgmock_for_dummiesmdmatcherswhatargumentsdoweexpect correspond argument method method_nam expect appli call method_nam whose argument match matcher matcher omit expect behav argument matcher wildcard matcher _matchersmdwildcard see matcher referencematchersmd list builtin matcher follow chainabl claus use modifi expect must use follow order cpp expect_callmock_object method_namematch withmulti_argument_match use timescardin use insequencesequ use number time afterexpect use number time willonceact use number time willrepeatedlyact use retiresonsatur use see detail modifi claus expect_callwith withmulti_argument_match restrict expect appli mock function call whose argument whole match multiargu matcher multi_argument_match googletest pass argument one tupl matcher paramet multi_argument_match must thu matcher type matcherstdtuplea type function argument exampl follow code set expect my_mocksetposit call two argument first argument less second cpp use testing_ use testinglt expect_callmy_mock setposition_ _ withlt googletest provid builtin matcher tupl includ lt matcher see multiargu matchersmatchersmdmultiargmatch claus use expect must first claus time expect_calltim timescardin specifi mani time mock function call expect paramet cardin repres number expect call one follow defin test namespac cardin mean anynumb function call number time atleastn function call expect least n time atmostn function call expect n time betweenm n function call expect n time inclus exactlyn n function call expect exactli n time n call never happen time claus omit googletest infer cardin follow neither willonceexpect_callwillonc willrepeatedlyexpect_callwillrepeatedli specifi infer cardin time n willonc claus willrepeatedli claus n infer cardin timesn n willonc claus one willrepeatedli claus n infer cardin timesatleastn time claus use expect insequ expect_callinsequ insequencesequ specifi mock function call expect certain sequenc paramet sequenc number sequencesequ object expect call assign sequenc expect occur order expect declar exampl follow code set expect reset method my_mock call getsiz describ getsiz describ occur order rel cpp use testingsequ sequenc expect_callmy_mock reset insequ expect_callmy_mock getsiz insequ expect_callmy_mock describ insequ insequ claus use number time expect see also insequ classinsequ expect_callaft afterexpect specifi mock function call expect occur one call paramet expect five expectationexpect expectationsetexpectationset object mock function call expect occur given expect exampl follow code set expect describ method my_mock call initx initi call cpp use testingexpect expect init_x expect_callmy_mock initx expect init_i expect_callmy_mock initi expect_callmy_mock describ afterinit_x init_i expectationset object help number prerequisit expect larg variabl exampl cpp use testingexpectationset expectationset all_init collect expect initel call int element_count all_init expect_callmy_mock initelementi expect_callmy_mock describ afterall_init expect describ call initel call claus use number time expect willonc expect_callwillonc willonceact specifi mock function actual behavior invok singl match function call paramet action repres actiongmock_for_dummiesmdactionswhatshoulditdo function call perform see action referenceactionsmd list builtin action use willonc implicitli set cardin expect time specifi see timesexpect_calltim match function call perform next action order declar exampl follow code specifi my_mockgetnumb expect call exactli time return respect first second third call cpp use testingreturn expect_callmy_mock getnumb willoncereturn willoncereturn willoncereturn willonc claus use number time expect willrepeatedli expect_callwillrepeatedli willrepeatedlyact specifi mock function actual behavior invok subsequ match function call take effect action specifi willonceexpect_callwillonc claus perform paramet action repres actiongmock_for_dummiesmdactionswhatshoulditdo function call perform see action referenceactionsmd list builtin action use willrepeatedli implicitli set cardin expect time specifi see timesexpect_calltim willonc claus specifi match function call perform action action specifi willrepeatedli see follow exampl cpp use testingreturn expect_callmy_mock getnam willrepeatedlyreturnjohn doe return john doe call expect_callmy_mock getnumb willoncereturn return first call willrepeatedlyreturn return subsequ call willrepeatedli claus use expect retiresonsatur expect_callretiresonsatur retiresonsatur indic expect longer activ expect number match function call reach retiresonsatur claus meaning expect upperbound cardin expect retir longer match function call satur upper bound reach see follow exampl cpp use testing_ use testinganynumb expect_callmy_mock setnumber_ expect timesanynumb expect_callmy_mock setnumb expect time retiresonsatur exampl first two call my_mocksetnumb match expect becom inact longer match call third call my_mocksetnumb would match expect without retiresonsatur expect third call my_mocksetnumb would match expect produc failur sinc limit call exceed retiresonsatur claus use expect must last claus on_cal on_cal on_callmock_objectmethod_namematch defin happen method method_nam object mock_object call argument match given matcher matcher requir modifi claus specifi method behavior set expect method call paramet matcher commasepar list matchersgmock_for_dummiesmdmatcherswhatargumentsdoweexpect correspond argument method method_nam on_cal specif appli call method_nam whose argument match matcher matcher omit behavior argument matcher wildcard matcher _matchersmdwildcard see matcher referencematchersmd list builtin matcher follow chainabl claus use set method behavior must use follow order cpp on_callmock_object method_namematch withmulti_argument_match use willbydefaultact requir see detail modifi claus on_callwith withmulti_argument_match restrict specif mock function call whose argument whole match multiargu matcher multi_argument_match googletest pass argument one tupl matcher paramet multi_argument_match must thu matcher type matcherstdtuplea type function argument exampl follow code set default behavior my_mocksetposit call two argument first argument less second cpp use testing_ use testinglt use testingreturn on_callmy_mock setposition_ _ withlt willbydefaultreturntru googletest provid builtin matcher tupl includ lt matcher see multiargu matchersmatchersmdmultiargmatch claus use on_cal statement willbydefault on_callwillbydefault willbydefaultact specifi default behavior match mock function call paramet action repres actiongmock_for_dummiesmdactionswhatshoulditdo function call perform see action referenceactionsmd list builtin action exampl follow code specifi default call my_mockgreet return hello cpp use testingreturn on_callmy_mock greet willbydefaultreturnhello action specifi willbydefault supersed action specifi match expect_cal statement see willonceexpect_callwillonc willrepeatedlyexpect_callwillrepeatedli claus expect_cal willbydefault claus must use exactli on_cal statement class class googletest defin follow class work mock defaultvalu defaultvalu testingdefaultvaluet allow user specifi default valu type copyabl publicli destruct ie anyth use function return type mock function return type default valu return function call specifi action provid static method set setfactori clear manag default valu cpp set default valu return must copi construct defaultvaluetsetvalu set factori invok demand must move construct maket defaultvaluetsetfactorymaket unset default valu defaultvaluetclear nicemock nicemock testingnicemockt repres mock object suppress warn uninterest callsgmock_cook_bookmduninterestingvsunexpect templat paramet mock class except anoth nicemock naggymock strictmock usag nicemockt analog usag nicemockt subclass use wherev object type accept addit nicemockt construct argument constructor accept exampl follow code suppress warn mock my_mock type mockclass method dosometh call cpp use testingnicemock nicemockmockclass my_mocksom arg expect_callmy_mock dosometh code use my_mock nicemockt work mock method defin use mock_method macro directli definit class mock method defin base class warn might still gener nicemockt might work correctli destructor virtual naggymock naggymock testingnaggymockt repres mock object gener warn uninterest callsgmock_cook_bookmduninterestingvsunexpect templat paramet mock class except anoth nicemock naggymock strictmock usag naggymockt analog usag naggymockt subclass use wherev object type accept addit naggymockt construct argument constructor accept exampl follow code gener warn mock my_mock type mockclass method dosometh call cpp use testingnaggymock naggymockmockclass my_mocksom arg expect_callmy_mock dosometh code use my_mock mock object type default behav way naggymockt strictmock strictmock testingstrictmockt repres mock object gener test failur uninterest callsgmock_cook_bookmduninterestingvsunexpect templat paramet mock class except anoth nicemock naggymock strictmock usag strictmockt analog usag strictmockt subclass use wherev object type accept addit strictmockt construct argument constructor accept exampl follow code gener test failur mock my_mock type mockclass method dosometh call cpp use testingstrictmock strictmockmockclass my_mocksom arg expect_callmy_mock dosometh code use my_mock strictmockt work mock method defin use mock_method macro directli definit class mock method defin base class failur might gener strictmockt might work correctli destructor virtual sequenc sequenc testingsequ repres chronolog sequenc expect see insequenceexpect_callinsequ claus expect_cal usag insequ insequ testinginsequ object type caus expect encount scope put anonym sequenc allow conveni express multipl expect singl sequenc cpp use testinginsequ insequ seq follow expect occur order declar expect_cal expect_cal expect_cal name insequ object matter expect expect testingexpect repres mock function call expect creat expect_callexpect_cal cpp use testingexpect expect my_expect expect_cal use specifi sequenc expect see afterexpect_callaft claus expect_cal expectationset expectationset testingexpectationset repres set mock function call expect use oper add expectationexpect object set cpp use testingexpectationset expectationset my_expect my_expect expect_cal use specifi sequenc expect see afterexpect_callaft claus expect_cal assert refer page list assert macro provid googletest verifi code behavior use includ header gtestgtesth major macro list come pair expect_ variant assert_ variant upon failur expect_ macro gener nonfat failur allow current function continu run assert_ macro gener fatal failur abort current function assert macro support stream custom failur messag oper exampl cpp expect_truemy_condit condit true anyth stream ostream stream assert macroin particular c string string object wide string wchar_t tchar unicod mode window stdwstring stream assert translat utf print explicit success failur successfailur assert section gener success failur directli instead test valu express use control flow rather boolean express determin test success failur shown follow exampl c switchexpress case check case check default fail shouldnt get succeed succeed succeed gener success make overal test succeed test consid success none assert fail execut succeed assert pure documentari current doesnt gener uservis output howev may add succeed messag googletest output futur fail fail fail gener fatal failur return current function use function return void see assert placementadvancedmdassertionplac inform add_failur add_failur add_failur gener nonfat failur allow current function continu run add_failure_at add_failure_at add_failure_atfile_pathline_numb gener nonfat failur file line number specifi gener assert gener follow assert allow matchersmatchersmd use verifi valu expect_that expect_that expect_thatvaluematch assert_thatvaluematch verifi valu match matchermatchersmd matcher exampl follow code verifi string valu start hello valu match regular express valu cpp includ gmockgmockh use testingallof use testinggt use testinglt use testingmatchesregex use testingstartswith expect_thatvalu startswithhello expect_thatvalu matchesregexlin assert_thatvalu allofgt lt matcher enabl assert form read like english gener inform failur messag exampl assert valu fail result messag similar follow valu valu actual hi world expect start hello googletest provid builtin librari matchersse matcher referencematchersmd also possibl write matchersse write new matcher quicklygmock_cook_bookmdnewmatch use matcher make expect_that power extens assert idea assert borrow joe waln hamcrest project add assertthat junit boolean condit boolean follow assert test boolean condit expect_tru expect_tru expect_truecondit assert_truecondit verifi condit true expect_fals expect_fals expect_falsecondit assert_falsecondit verifi condit fals binari comparison binarycomparison follow assert compar two valu valu argument must compar assert comparison oper otherwis compil error result argument support oper call print argument assert fail otherwis googletest attempt print best way canse teach googletest print valuesadvancedmdteachinggoogletesthowtoprintyourvalu argument alway evalu exactli ok argument side effect howev argument evalu order undefin program depend particular argument evalu order assert work narrow wide string object string wstring see also floatingpoint comparisonfloatingpoint assert compar floatingpoint number avoid problem caus round expect_eq expect_eq expect_eqvalv assert_eqvalv verifi valval pointer equal pointer use two c string test memori locat valu use expect_streqexpect_streq compar c string eg const char valu compar pointer null use expect_eqptr nullptr instead expect_eqptr null expect_n expect_n expect_nevalv assert_nevalv verifi valval pointer equal pointer use two c string test differ memori locat differ valu use expect_strneexpect_strn compar c string eg const char valu compar pointer null use expect_neptr nullptr instead expect_neptr null expect_lt expect_lt expect_ltvalv assert_ltvalv verifi valval expect_l expect_l expect_levalv assert_levalv verifi valval expect_gt expect_gt expect_gtvalv assert_gtvalv verifi valval expect_g expect_g expect_gevalv assert_gevalv verifi valval string comparison cstring follow assert compar two c string compar two string object use expect_eqexpect_eq expect_neexpect_n instead assert also accept wide c string wchar_t comparison two wide string fail valu print utf narrow string compar c string null use expect_eqc_str nullptr expect_nec_str nullptr expect_streq expect_streq expect_streqstrstr assert_streqstrstr verifi two c string str str content expect_strn expect_strn expect_strnestrstr assert_strnestrstr verifi two c string str str differ content expect_strcaseeq expect_strcaseeq expect_strcaseeqstrstr assert_strcaseeqstrstr verifi two c string str str content ignor case expect_strcasen expect_strcasen expect_strcasenestrstr assert_strcasenestrstr verifi two c string str str differ content ignor case floatingpoint comparison floatingpoint follow assert compar two floatingpoint valu due round error unlik two floatingpoint valu match exactli expect_eq suitabl gener floatingpoint comparison make sens user need care choos error bound googletest also provid assert use default error bound base unit last place ulp learn ulp see articl compar float point numbershttpsrandomasciiwordpresscomcomparingfloatingpointnumbersedit expect_float_eq expect_float_eq expect_float_eqvalv assert_float_eqvalv verifi two float valu val val approxim equal within ulp expect_double_eq expect_double_eq expect_double_eqvalv assert_double_eqvalv verifi two doubl valu val val approxim equal within ulp expect_near expect_near expect_nearvalvalabs_error assert_nearvalvalabs_error verifi differ val val exceed absolut error bound abs_error except assert except follow assert verifi piec code throw throw except usag requir except enabl build environ note piec code test compound statement exampl cpp expect_no_throw int n dosomethingn expect_throw expect_throw expect_throwstatementexception_typ assert_throwstatementexception_typ verifi statement throw except type exception_typ expect_any_throw expect_any_throw expect_any_throwstat assert_any_throwstat verifi statement throw except type expect_no_throw expect_no_throw expect_no_throwstat assert_no_throwstat verifi statement throw except predic assert predic follow assert enabl complex predic verifi print clear failur messag expect_tru use alon expect_pr expect_pr expect_predpredv expect_predpredvalv expect_predpredvalvalv expect_predpredvalvalvalv expect_predpredvalvalvalvalv assert_predpredv assert_predpredvalv assert_predpredvalvalv assert_predpredvalvalvalv assert_predpredvalvalvalvalv verifi predic pred return true pass given valu argument paramet pred function functor accept mani argument correspond macro accept valu pred return true given argument assert succe otherwis assert fail assert fail print valu argument argument alway evalu exactli exampl see follow code cpp return true n common divisor except bool mutuallyprimeint int n const int const int b const int c expect_predmutuallyprim b succe expect_predmutuallyprim b c fail exampl first assert succe second fail follow messag mutuallyprimeb c fals b c note given predic overload function function templat assert macro might abl determin version use might necessari explicitli specifi type function exampl boolean function isposit overload take either singl int doubl argument would necessari write one follow cpp expect_predstatic_castbool intisposit expect_predstatic_castbool doubleisposit write simpli expect_predisposit would result compil error similarli use templat function specifi templat argument cpp templat typenam bool isnegativet x return x expect_predisnegativeint must specifi type isneg templat multipl paramet wrap predic parenthes macro argument pars correctli cpp assert_predmypredicateint int expect_pred_format expect_pred_format expect_pred_formatpred_formatterv expect_pred_formatpred_formattervalv expect_pred_formatpred_formattervalvalv expect_pred_formatpred_formattervalvalvalv expect_pred_formatpred_formattervalvalvalvalv assert_pred_formatpred_formatterv assert_pred_formatpred_formattervalv assert_pred_formatpred_formattervalvalv assert_pred_formatpred_formattervalvalvalv assert_pred_formatpred_formattervalvalvalvalv verifi predic pred_formatt succe pass given valu argument paramet pred_formatt predicateformatt function functor signatur cpp testingassertionresult predicateformatterconst char expr const char expr const char exprn val val tn valn val val valn valu predic argument expr expr exprn correspond express appear sourc code type tn either valu type refer type argument type declar either const whichev appropri return type testingassertionresult see use function return assertionresultadvancedmdusingafunctionthatreturnsanassertionresult exampl see follow code cpp return smallest prime common divisor n n mutual prime int smallestprimecommondivisorint int n return true n common divisor except bool mutuallyprimeint int n predicateformatt assert two integ mutual prime testingassertionresult assertmutuallyprimeconst char m_expr const char n_expr int int n mutuallyprimem n return testingassertionsuccess return testingassertionfailur m_expr n_expr n mutual prime common divisor smallestprimecommondivisorm n const int const int b const int c expect_pred_formatassertmutuallyprim b succe expect_pred_formatassertmutuallyprim b c fail exampl final assert fail predicateformatt produc follow failur messag b c mutual prime common divisor window hresult assert hresult follow assert test hresult success failur exampl cpp ccomptrishelldispatch shell assert_hresult_succeededshellcocreateinstancelshellappl ccomvari empti assert_hresult_succeededshellshellexecuteccombstrurl empti empti empti empti gener output contain humanread error messag associ return hresult code expect_hresult_succeed expect_hresult_succeed expect_hresult_succeededexpress assert_hresult_succeededexpress verifi express success hresult expect_hresult_fail expect_hresult_fail expect_hresult_failedexpress expect_hresult_failedexpress verifi express failur hresult death assert death follow assert verifi piec code caus process termin context see death testsadvancedmddeathtest assert spawn new process execut code test process happen depend platform variabl testinggtest_flagdeath_test_styl initi commandlin flag gtest_death_test_styl posix system fork clone linux use spawn child variabl valu fast death test statement immedi execut variabl valu threadsaf child process reexecut unit test binari origin invok extra flag caus singl death test consider run window child spawn use createprocess api reexecut binari caus singl death test consider run much like threadsaf mode posix valu variabl illeg caus death test fail current flag default valu fast death test statement run complet without die child process nonetheless termin assert fail note piec code test compound statement exampl cpp expect_death int n dosomethingn error line dosometh expect_death expect_death expect_deathstatementmatch assert_deathstatementmatch verifi statement caus process termin nonzero exit statu produc stderr output match matcher paramet matcher either matchermatchersmd const stdstring regular express see regular express syntaxadvancedmdregularexpressionsyntaxa bare string matcher treat containsregexsmatchersmdstringmatch eqsmatchersmdgenericcomparison exampl follow code verifi call dosometh caus process die error messag contain text error cpp expect_deathdosometh error expect_death_if_support expect_death_if_support expect_death_if_supportedstatementmatch assert_death_if_supportedstatementmatch death test support behav expect_deathexpect_death otherwis verifi noth expect_debug_death expect_debug_death expect_debug_deathstatementmatch assert_debug_deathstatementmatch debug mode behav expect_deathexpect_death debug mode ie ndebug defin execut statement expect_exit expect_exit expect_exitstatementpredicatematch assert_exitstatementpredicatematch verifi statement caus process termin exit statu satisfi predic produc stderr output match matcher paramet predic function functor accept int exit statu return bool googletest provid two predic handl common case cpp return true program exit normal given exit statu code testingexitedwithcodeexit_cod return true program kill given signal avail window testingkilledbysignalsignal_numb paramet matcher either matchermatchersmd const stdstring regular express see regular express syntaxadvancedmdregularexpressionsyntaxa bare string matcher treat containsregexsmatchersmdstringmatch eqsmatchersmdgenericcomparison exampl follow code verifi call normalexit caus process print messag contain text success stderr exit exit statu code cpp expect_exitnormalexit testingexitedwithcod success matcher refer matcher match singl argument use insid on_cal expect_cal use valid valu directli use two macro macro descript expect_thatactual_valu matcher assert actual_valu match matcher assert_thatactual_valu matcher expect_thatactual_valu matcher except gener fatal failur callout note note although equal match via expect_thatactual_valu expected_valu support prefer make comparison explicit via expect_thatactual_valu eqexpected_valu expect_eqactual_valu expected_valu builtin matcher argument function argument eg actual_valu exampl use context expect_callmock_object methodmatch argument method divid sever categori matcher defin test namespac unless otherwis note wildcard matcher descript _ argument valu correct type atyp antyp argument valu type type gener comparison matcher descript eqvalu valu argument valu gevalu argument valu gtvalu argument valu levalu argument valu ltvalu argument valu nevalu argument valu isfals argument evalu fals boolean context istru argument evalu true boolean context isnul argument null pointer raw smart notnul argument nonnul pointer raw smart optionalm argument option contain valu match test whether option set check equal nullopt may need use eqnullopt inner type doesnt variantwithtm argument variant hold altern type valu match refvari argument refer variabl typedeqtypevalu argument type type equal valu may need use instead eqvalu mock function overload except ref matcher make copi valu case modifi destruct later compil complain valu doesnt public copi constructor tri wrap stdref eg eqstdrefnon_copyable_valu make sure non_copyable_valu chang afterward mean matcher chang istru isfals use need use matcher type explicitli convert boolean implicitli convert boolean case use basic expect_tru expect_falseassertionsmdboolean assert floatingpoint matcher fpmatcher matcher descript doubleeqa_doubl argument doubl valu approxim equal a_doubl treat two nan unequ floateqa_float argument float valu approxim equal a_float treat two nan unequ nansensitivedoubleeqa_doubl argument doubl valu approxim equal a_doubl treat two nan equal nansensitivefloateqa_float argument float valu approxim equal a_float treat two nan equal isnan argument floatingpoint type nan valu matcher use ulpbas comparison use googletest automat pick reason error bound base absolut valu expect valu doubleeq floateq conform ieee standard requir compar two nan equal return fals nansensit version instead treat two nan equal often user want matcher descript doubleneara_doubl max_abs_error argument doubl valu close a_doubl absolut error max_abs_error treat two nan unequ floatneara_float max_abs_error argument float valu close a_float absolut error max_abs_error treat two nan unequ nansensitivedoubleneara_doubl max_abs_error argument doubl valu close a_doubl absolut error max_abs_error treat two nan equal nansensitivefloatneara_float max_abs_error argument float valu close a_float absolut error max_abs_error treat two nan equal string matcher argument either c string c string object matcher descript containsregexstr argument match given regular express endswithsuffix argument end string suffix hassubstrstr argument contain string substr isempti argument empti string matchesregexstr argument match given regular express match start first charact end last charact startswithprefix argument start string prefix strcaseeqstr argument equal string ignor case strcasenestr argument equal string ignor case streqstr argument equal string strnestr argument equal string containsregex matchesregex take ownership object use regular express syntax defin hereadvancedmdregularexpressionsyntax matcher except containsregex matchesregex work wide string well contain matcher stlstyle contain support use eqexpected_contain simpli expected_contain match contain exactli want write element inlin match flexibl get inform messag use matcher descript beginenddistanc argument contain whose begin end iter separ number increment match eg beginenddistancei beginenddistanceislt contain defin size method sizeism may effici containereqcontain eqcontain except failur messag also includ element one contain contains argument contain element match e either valu matcher containsetimesn argument contain element match e either valu matcher number match n either valu matcher unlik plain contain allow check arbitrari occurr includ test absenc containsetim each argument contain everi element match e either valu matcher elementsare e en argument n element ith element match ei valu matcher elementsarearray e en elementsarearraya_contain elementsarearraybegin end elementsarearrayarray elementsarearrayarray count elementsar except expect element valuesmatch come initi list stlstyle contain iter rang cstyle array isempti argument empti contain containerempti issubsetof e en issubsetofa_contain issubsetofbegin end issubsetofarray issubsetofarray count argument match unorderedelementsarex x xk subset x x xk expect matcher issupersetof e en issupersetofa_contain issupersetofbegin end issupersetofarray issupersetofarray count subset argument match unorderedelementsareexpect matcher pointwisem contain pointwisem e e en argument contain number element contain ith element argument ith element contain match matcher tupl eg pointwisel upper_bound verifi element argument doesnt exceed correspond element upper_bound see detail sizeism argument contain whose size match eg sizei sizeislt unorderedelementsare e en argument n element permut element element match ei differ valu matcher unorderedelementsarearray e en unorderedelementsarearraya_contain unorderedelementsarearraybegin end unorderedelementsarearrayarray unorderedelementsarearrayarray count unorderedelementsar except expect element valuesmatch come initi list stlstyle contain iter rang cstyle array unorderedpointwisem contain unorderedpointwisem e e en like pointwisem contain ignor order element whensortedm argument sort use oper match contain matcher eg whensortedelementsar verifi argument contain element ignor order whensortedbycompar whensortedm except given compar instead use sort argument eg whensortedbystdgreat elementsar note matcher also match nativ array pass refer eg fooconst int array pass pointer count eg barconst buffer int len see multiargu matchersmultiargmatch array match may multidimension ie element array pointwisem unorderedpointwisem matcher stdtuplet u u element type actual contain expect contain respect exampl compar two foo contain foo doesnt support oper one might write cpp matcherfooeq return stdgetargequalsstdgetarg expect_thatactual_foo pointwisefooeq expected_foo member matcher matcher descript fieldclassfield argumentfield argumentfield argument plain pointer match matcher argument object type _class_ fieldfield_nam classfield twoparamet version provid better error messag key argumentfirst match e either valu matcher eg containskeyl verifi map contain key pairm argument stdpair whose first field match second field match fieldsarem argument compat object field match piecewis matcher compat object support stdtuple_sizeobjgetiobj protocol c also support type compat structur bind like aggreg propertyclassproperti argumentproperti argumentproperti argument plain pointer match matcher argument object type _class_ method properti must take argument declar const propertyproperty_nam classproperti twoparamet version provid better error messag note use fieldsar match type support structur bind stdtupl stdpair stdarray aggreg type exampl cpp stdtupleint stdstring my_tupl hello world expect_thatmy_tupl fieldsareg hassubstrhello struct mystruct int valu stdstring greet aloha mystruct expect_that fieldsar aloha dont use properti member function take address function fragil gener part contract function match result function functor callback matcher descript resultoff fargument match matcher f function functor pointer matcher matcher descript addressm result stdaddressofargu match pointeem argument either smart pointer raw pointer point valu match matcher pointerm argument either smart pointer raw pointer contain pointer match match raw pointer regardless type argument whendynamiccasttotm argument pass dynamic_castt match matcher multiargu matcher multiargmatch technic matcher match singl valu multiargu matcher one match tupl follow matcher use match tupl x matcher descript eq x ge x gt x le x lt x ne x use follow selector pick subset argument reorder particip match matcher descript allargsm equival use syntact sugar withallargsm argsn n nkm tupl k select use base indic argument match eg arg eq composit matcher make matcher one matcher matcher descript allofm mn argument match matcher mn allofarraym mn allofarraya_contain allofarraybegin end allofarrayarray allofarrayarray count allof except matcher come initi list stlstyle contain iter rang cstyle array anyofm mn argument match least one matcher mn anyofarraym mn anyofarraya_contain anyofarraybegin end anyofarrayarray anyofarrayarray count anyof except matcher come initi list stlstyle contain iter rang cstyle array notm argument doesnt match matcher conditionalcond match matcher cond evalut true els match adapt matcher matcher descript matchercasttm cast matcher type matchert safematchercasttm safe castsgmock_cook_bookmdsafematchercast matcher type matchert trulypred predicateargu return someth consid c true predic function functor addresssatisfiescallback trulycallback take ownership callback must perman callback use matcher predic matchersaspredicatescheat matcher descript matchesmvalu evalu true valu match use matchesm alon unari functor explainmatchresultm valu result_listen evalu true valu match explain result result_listen valuevalu evalu true valu match defin matcher macro descript matcheriseven return arg defin matcher iseven match even number matcher_pisdivisiblebi n result_listen remaind arg n return arg n defin matcher isdivisiblebyn match number divis n matcher_pisbetween b abslstrcatneg isnt printtostringa printtostringb return arg arg b defin matcher isbetweena b match valu rang b note matcher macro use insid function class matcher bodi must pure function ie side effect result must depend anyth valu match matcher paramet use printtostringx convert valu x type string use explainmatchresult custom matcher wrap anoth matcher exampl cpp matcher_pnestedpropertymatch matcher return explainmatchresultmatch argnestedproperti result_listen googletest mock gmock framework overview googl framework write use c mock class help deriv better design system write better test inspir jmockhttpwwwjmockorg easymockhttpwwweasymockorg hamcresthttpcodegooglecomphamcrest design cs specif mind gmock provid declar syntax defin mock defin partial hybrid mock cross real mock object handl function arbitrari type overload function come rich set matcher valid function argument use intuit syntax control behavior mock automat verif expect recordandreplay need allow arbitrari partial order constraint function call express let user extend defin new matcher action use except easi learn use detail exampl found gmock dummieshttpsgooglegithubiogoogletestgmock_for_dummieshtml legaci gmock faqhttpsgooglegithubiogoogletestgmock_faqhtml gmock cookbookhttpsgooglegithubiogoogletestgmock_cook_bookhtml gmock cheat sheethttpsgooglegithubiogoogletestgmock_cheat_sheethtml pleas note code scriptsgener cppclean projecthttpcodegooglecompcppclean apach licens differ googlemock licens googlemock part googletest c test frameworkhttpgithubcomgooglegoogletest subject requir content move work updat googletest document move toplevel docsdoc directori custom point custom directori inject point custom user configur header gmockporth follow macro defin flag relat macro gmock_declare_bool_nam gmock_declare_int_nam gmock_declare_string_nam gmock_define_bool_nam default_v doc gmock_define_int_nam default_v doc gmock_define_string_nam default_v doc pleas note file directori longer support maintain repres mostli histor artifact support commun guarante whatsoev script still work gener build instruct setup build googletest test use need tell build system find header sourc file exact way depend build system use usual straightforward build cmake googletest come cmake build script cmakeliststxthttpsgithubcomgooglegoogletestblobmastercmakeliststxt use wide rang platform c stand crossplatform dont cmake instal alreadi download free httpwwwcmakeorg cmake work gener nativ makefil build project use compil environ choic either build googletest standalon project incorpor exist cmake build anoth project standalon cmake project build googletest standalon project typic workflow start git clone httpsgithubcomgooglegoogletestgit b releas cd googletest main directori clone repositori mkdir build creat directori hold build output cd build cmake gener nativ build script googletest command also includ googlemock default want build googletest replac last command cmake dbuild_gmockoff nix system see makefil current directori type make build googletest simpli instal googletest system administr make sudo make instal instal usrloc default use window visual studio instal gtestsln file sever vcproj file creat build use visual studio mac os x xcode instal xcodeproj file gener incorpor exist cmake project want use googletest project alreadi use cmake easiest way get instal librari header import googletest use find_packag pkg_check_modul exampl find_packagegtest config requir succe use librari gtestgtest gtestgmock robust flexibl approach build googletest part project directli done make googletest sourc code avail main build ad use cmake add_subdirectori command signific advantag compil linker set use googletest rest project issu associ use incompat librari eg debugreleas etc avoid particularli use window make googletest sourc code avail main build done differ way download googletest sourc code manual place known locat least flexibl approach make difficult use continu integr system etc emb googletest sourc code direct copi main project sourc tree often simplest approach also hardest keep date organ may permit method add googletest git submodul equival may alway possibl appropri git submodul exampl set advantag drawback use cmake download googletest part build configur step approach doesnt limit method last method implement small piec cmake code download pull googletest code main build add cmakeliststxt cmake includefetchcont fetchcontent_declar googletest specifi commit depend updat regularli url httpsgithubcomgooglegoogletestarchivecfefcfdceeffcccezip window prevent overrid parent project compilerlink set setgtest_force_shared_crt cach bool forc fetchcontent_makeavailablegoogletest simpli link gtest gtest_main need eg add_executableexampl examplecpp target_link_librariesexampl gtest_main add_testnam example_test command exampl note approach requir cmake later due use fetchcontent_makeavail command visual studio dynam vs static runtim default new visual studio project link c runtim dynam googletest link static gener error look someth like follow gtestlibgtestallobj error lnk mismatch detect runtimelibrari valu mtd_staticdebug doesnt match valu mdd_dynamicdebug mainobj googletest alreadi cmake option gtest_force_shared_crt enabl option make gtest link runtim dynam match project includ c standard version environ support c requir order success build googletest one way ensur specifi standard toplevel project exampl use setcmake_cxx_standard command feasibl exampl c project use googletest valid specifi ad option cmake via dcmake_cxx_flag option tweak googletest googletest use divers environ default configur may work may work well box environ howev easili tweak googletest defin control macro compil command line gener macro name like gtest_xyz defin either enabl disabl certain featur list frequent use macro complet list see file includegtestinternalgtestporthhttpsgithubcomgooglegoogletestblobmastergoogletestincludegtestinternalgtestporth multithread test googletest threadsaf pthread librari avail includ gtestgtesth check gtest_is_threadsaf macro see whether case ye macro defin undefin googletest doesnt correctli detect whether pthread avail environ forc dgtest_has_pthread dgtest_has_pthread googletest use pthread may need add flag compil andor linker select pthread librari youll get link error use cmake script taken care use build script youll need read compil linker manual figur flag add share librari dll googletest compact user build link static librari simplic choos use googletest share librari known dll window prefer compil gtest share librari add dgtest_create_shared_librari compil flag youll also need tell linker produc share librari instead consult linker manual compil test use gtest share librari add dgtest_linked_as_shared_librari compil flag note step arent technic necessari today use compil eg gcc may becom necessari futur decid improv speed load librari see httpgccgnuorgwikivis detail therefor recommend alway add flag use googletest share librari otherwis futur releas googletest may break build script avoid macro name clash c macro dont obey namespac therefor two librari defin macro name clash includ definit case googletest macro clash anoth librari forc googletest renam macro avoid conflict specif googletest code defin macro foo add dgtest_dont_define_foo compil flag tell googletest chang macro name foo gtest_foo current foo assert_eq assert_fals assert_g assert_gt assert_l assert_lt assert_n assert_tru expect_fals expect_tru fail succeed test test_f exampl dgtest_dont_define_test youll need write gtest_testsometest doesthi instead testsometest doesthi order defin test content move work updat googletest document move toplevel docsdoc directori custom point custom directori inject point custom user configur header gtesth follow macro defin gtest_os_stack_trace_getter_ name implement osstacktracegetterinterfac gtest_custom_tempdir_function_ overrid testingtempdir see testingtempdir semant signatur header gtestporth follow macro defin flag relat macro gtest_flagflag_nam gtest_use_own_flagfile_flag_ defin system provid flagfil flag pars gtest_declare_bool_nam gtest_declare_int_nam gtest_declare_string_nam gtest_define_bool_nam default_v doc gtest_define_int_nam default_v doc gtest_define_string_nam default_v doc gtest_flag_getflag_nam gtest_flag_setflag_nam valu log gtest_log_sever gtest_check_condit function logtostderr flushinfolog provid thread gtest_has_notification_ enabl notif alreadi provid gtest_has_mutex_and_thread_local_ enabl mutex threadloc alreadi provid must also provid gtest_declare_static_mutex_mutex gtest_define_static_mutex_mutex gtest_exclusive_lock_required_lock gtest_lock_excluded_lock underli librari support featur gtest_has_cxxabi_h_ export api symbol gtest_api_ specifi export symbol header gtestprintersh see document gtestgtestprintersh detail defin custom printer pleas note file directori longer support maintain repres mosti histor artifact support commun guarante whatsoev script still work physic valid refer physical_valid packag aim test result obtain molecular dynam simul physic valid pleas check httpphysical_validationreadthedocsiohttpphysical_validationreadthedocsio full refer physical_valid larg incorpor function checkensemblehttpsgithubcomshirtsgroupcheckensembl softwar develop shirt group univers colorado boulder gromacsbundl version version physical_valid ship gromac correspond commit b requir numpi scipi pymbar document strategi document type user document mostli extract userfac modul docstr curat framework rst doc facilit organ class function section potenti mix autoextract document sampl document propos incomplet featur facilit collabor design code review user refer document function class docstr userfac public entiti api refer function class document public entiti includ default toplevel namespac link user doc higherlevel collabor exist design document addit develop doc modul document modul includ regular document document maintain static rst version releas packag test infrastructur sourc code mainten note rst sourc also use gromac webpagesphinx cmake target dynam select page_select ref module_select modul provid mechan allow select specifi text engin evalu atom gener set posit one set coordin select atom depend trajectori frame allow write generalpurpos analysi tool oper posit get lot flexibl free select engin exampl tool readili oper center mass group addit individu atom long requir access atom properti peopl familiar vmd select syntax quit familiar differ keyword support vmd extens relat support evalu centerofmass posit addit individu atom oldtim gromac user tool support select gener need make_ndx structur overview central concept use understand select engin explain graph repres relat differ part textual descript uservis compon concept follow graph also includ overview select engin integr ref page_analysisframework use select analysi framework part gray manag framework use select outsid framework either possibl use core compon shown graph box also use select option mechan case caller respons manag object own framework graph dot digraph selection_overview subgraph cluster_framework label analysi framework analysisframework labelframework fillcolorgrey stylefil option labelopt collect fillcolorgrey stylefil analysistool labelanalysi tool subgraph cluster_cor label core engin labelloc b selectioncollect labelselect collect fillcolorgrey stylefil selectiondata labelintern select data fillcolorgrey stylefil select labelselect object selectionopt labelselect option selectionoptionmanag labelselect option manag fillcolorgrey stylefil selectioncollect select labelcr selectioncollect selectiondata labelown updat selectionopt select labelreturn select selectiondata labelread data constraintfals selectionoptionmanag selectionopt labelprovid valu selectionoptionmanag selectioncollect labelget select object analysistool selectionopt labeldeclar analysistool select labelread data analysistool option labeldeclar option analysisframework selectionoptionmanag labelown analysisframework selectioncollect labelown analysisframework option labelown option selectionopt labelcontain enddot _selection_ evalu singl list _select positions_ note particular output posit list atom tool accept one select expect differ semant differ select _dynam selection_ word _dynamic_ refer select set posit instead posit depend input coordin _select position_ singl coordin return select correspond individu atom also collect coordin center mass group atom addit output coordin posit provid inform atom constitut metadata allow one associ posit differ frame differ posit return time _select collection_ group select process unit topolog set coordin analysi framework alway singl select collect manag framework _select variable_ provid select text possibl creat variabl use part select make easier write repetit select make complex common subexpress variabl also provid optim opportun select engin variabl valu repeatedli evalu variabl alway exist context select collect _select object_ select _parsed_ see select collect give handl select _select object_ handl valid lifetim select collect use access inform select oper select collect _compilation_ _evaluation_ see alter valu return select object _select option_ special type commandlin option directli return select object higherlevel construct use analysi framework provid conveni interfac analysi tool simpli declar one select option get list _select objects_ return valu part select engin manag framework core select engin core select engin _select collection_ object graph show handl select oper collect object support sequenc shown box middl input shown top output bottom dot digraph selection_process subgraph cluster_collect label select collect subgraph action rank creat shapebox pars shapebox compil shapebox evalu shapebox evaluatefin labelfinish evaluationshapebox creat pars parsen parsenw pars compil compil evalu evaluaten evaluatenw evalu evaluatefin selectiondata labelintern select data selectiontext labelselect text topolog labeltopologynatom count frame labelfram coordin select labelselect object selectiontext pars pars selectionnw labelreturn pars selectiondata labelcr topolog compil compil selectiondata labelinitializesnposit frame evalu evalu selectiondata labelsetsnposit evaluatefin selectiondata labelreset tonpostcompilationnst selectiondata select labelread data dirback enddot _parsing_ creat empti select collect select need pars text result select collect initi intern data object hold basic inform select return _select objects_ handl data possibl pars one set select collect call pars method input string pars also contain variabl declar get ad collect use later call parser _compilation_ select pars whole select collect compil analyz provid select evalu part depend atom coordin eg subselect base atom residu name compil coordin output posit initi inform initi atom satisfi dynam condit mean subsequ evalu return subset posit return point caller use inform check select valid alloc memori process compil also alloc memori necessari evalu figur topolog shown input compil gener set point compil select text requir inform topolog evalu suffici set atom count _evaluation_ select compil evalu one set atom coordin updat set posit access select object dynam select group posit chang static select coordin posit updat _final evaluation_ return select state compil ie maximum possibl set posit coordin posit uniniti inform avail caller use inform postprocess eg produc label output base select posit intern intern implement implement detail differ part modul discuss separ page subpag page_module_selection_custom subpag page_module_selection_pars subpag page_module_selection_compil subpag page_module_selection_insolidangl endif use gromac librari page_usinglibrari get start gromac librari libgromac provid differ altern use list highest level abstract lowlevel function write trajectori analysi tool pleas see ref page_analysisframework ref page_analysistempl contain ingredi get start exist tool written use analysi templat use select engin ad need convers work get work new templat mostli straightforward requir studi understand new framework write command line tool purpos use facil provid ref module_commandlin differ altern depend much control want give gromac c code implement gmxicommandlineoptionsmodul use gmxruncommandlinemodul execut interfac assum use gmxoption mechan declar commandlin option see ref module_opt lowerlevel interfac gmxicommandlinemodul use requir implement h output commandlin pars possibl use class gromac provid c code use gmx_run_cmain wrap exist c main method constraint provid main method use parse_common_arg argument process approach allow convert exist c tool written pre gromac eg use analysi templat earlier new version want control exampl want default command line option ad gromac directli initi gromac use gmxinitforcommandlin call gromac routin allow write handl command line option scratch also discuss ref module_commandlin control use gmxinit basic initi creat implement gmxiprogramcontext set use gmxsetprogramcontext allow custom gromac librari show name program messag well locat data file fit need may need modifi gromac sourc code particular current rel difficult extend function mdrun without modifi sourc code directli think particular api would necessari work think would easi expos pleas drop line gmxdevelop mail list contribut necessari chang httpgerritgromacsorg link libgromac gromac bit picki header need use depend compil option use gromac preprocessor defin may need set requir includ path may also depend compil option extra librari may need link also like need use compil suffici similar one use standard librari use compil gromac manag easili gromac provid two mechan get correct flag compil link gromac librari pkgconfig gromac instal libgromacspc file suffix librari suffix use pkgconfig present system sourc gmxrc adjust pkgconfig search path file found automat see makefilepkg instal analysi templat one exampl use use differ suffix gromac replac libgromac libgromacsem_suffixem pkgconfig call cmake packag configur file find modul allow find_packagegromac work see detail use cmake sourc gmxrc set environ variabl allow cmake find configur file automat see cmakeliststxt instal analysi templat one exampl use mechan current provid besteffort basi routin test wide rang configur pleas report issu detail gromac built mechan improv known issu pkgconfig file relocat ie hardcod instal prefix absolut path instal static share librari suffix instal prefix guarante work built exactli configur option except build_shared_lib exactli version sever file share instal case latter instal overwrit former static share librari instal past prefix futur instal prefix also instal static share librari otherwis obsolet cmake packag configur file left behind lead find old librari altern delet sharecmak instal directori instal mechan cmakegener instal target use instal gromac exist instal build type eg releas vs debug match previous instal obsolet cmake import target definit file left behind sharecmak may caus failur whey tri use packag configur file gromac built gmx_build_own_fftwon cmakegener import definit libgromac refer gmxfftw target use build refer fftw librari librari exist gromac build tree cmake machineri write import definit anywher link fail error abl find gmxfftw librari cmake packag configur file use gmx_build_own_fftwoff cmake find_packagegromac detail cmake machineri support find_packagegromac two part findgromacscmak find modul found sharegromacstemplatecmak instal sharetemplatecmak sourc tree actual packag configur file gromacsconfigcmak support file instal sharecmak input file srcgromac findgromacscmak simpl wrapper packag configur file provid somewhat conveni interfac machineri support multipl suffix gromac instal instal prefix see gromacs_suffix variabl file intend versionagnost remain forward backwardcompat even major gromac releas versionspecif inform actual detail compil link set packag configur file build system will util findgromacscmak creat local copi use like use instal sharegromacstemplatecmakeliststxt packag configur file also use directli desir bypass findgromacscmak input option influenc find dl dtgromacs_suffix findgromacscmakedt ddthi cmake variabl set call find_packagegromac specifi gromac suffix search set unsuffix version search use packag configur file directli suffix must set use find_packagegromac name gromacssuffixdd dtgromacs_prefer_staticdt ddthi cmake variabl set call find_packagegromac specifi whether static share librari prefer avail affect gromac instal chosen instal static share librari avail instal two differ build suffix choos librari return gromacs_librariesdd dtgromacs_dirdt ddthi cmake cach variabl standard mechan provid find_packag use specifi hint search gromac also cmake_prefix_path use purpos see cmake document find_packag detail gromacs_dir also set environ variabl done gmxrcdd dl output variabl specifi found libgromac header use dl dtgromacs_include_dirsdt ddlist includ directori necessari compil gromac header current includ path gromac headersdd dtgromacs_librariesdt ddlist librari link link gromac hood use import cmake target repres libgromacsdd dtgromacs_definitionsdt ddlist compil definit front requir compil gromac headersdd dtgromacs_is_doubledt ddwhether found gromac compil doubl precisiondd dtgromacs_cxx_flagsdt ddrequir compil flagsdd dl addit import target name gromacslibgromac provid use target_link_librariesfoo privat gromacslibgromac declar macrosfunct use check correct set dl dtgromacs_check_doublegmx_doubledt ddcheck found gromac expect precis paramet gmx_doubl name cach variabl specifi whether doubleprecis requesteddd dtgromacs_check_compilerlangdt ddcheck found gromac compil compil use current cmake system current langcxx supporteddd dl note gromac api header public gromac api instal includegromac instal directori layout reflect sourc code layout srcgromac directori see linktodevmanualoverviewdevdoclayoutsourc code layout header directli includegromac contain declar instead includ collect header subdirectori prefer includ conveni header instead individu header subdirectori sinc much stabl individu header subdirectori renam move goal rare chang name toplevel header pre version gromac instal nearli header directli includegromac header still exist longer instal longterm goal reintroduc part api make sens unfortun take long time thu expect much stabil api header header subdirectori effort put design api stabil howev limit develop resourc focu gromac high perform simul api subject chang without notic new releas possibl except patch releas expect incompat api chang header versionh instal gromacsversionh provid defin call code use check exact releas version gromac instal header doxygen document cover part api framework trajectori analysi page_analysisframework gromac provid framework implement flexibl trajectori analysi routin consist compon also use individu case desir use featur get framework main featur support flexibl select use provid set coordin analyz dynam ie select differ atom differ trajectori frame also support evalu centerofmasscenterofgeometri coordin group atom latter mean tool written use framework automat analyz also centerofmass posit mixtur centerofmass atom posit addit real atom posit support perfram parallel framework design support run analysi parallel multipl frame case differ frame analyz mostli independ time actual parallel implement tool written use framework abl take advantag soon materi minim chang access librari basic analysi routin thing comput averag histogram provid reusabl modul tool code focu actual analysi tool implement subclass abstract class provid implement select pure virtual method framework take care initi task load trajectori loop evalu select also provid basic featur like make molecul whole pass frame analysi code approach also make possibl reus tool code script languag python simpli implement gener support languag bind framework integr implement time though also reusabl analysi routin use independ framework subpag page_analysisnbsearch crash cours implement analysi tool use framework see subpag page_analysistempl highlevel framework ref module_trajectoryanalysi modul provid highlevel framework integr piec togeth provid abstract base class analysi tool modul gmxtrajectoryanalysismodul code run modul commandlin tool gmxtrajectoryanalysiscommandlinerunn see analysi templateref page_analysistempl trajectoryanalysi modul documentationref module_trajectoryanalysi detail select ref module_select modul provid support select work manag select taken care commandlin runner framework analysi tool code see two main class gmxselectionopt associ class use declar number type select tool accept see detail option supportsection_analysisframework_opt tool receiv set gmxselect object valu select option class provid evalu valu select analysi framework evalu frame tool call access select current frame gmxselect object own conceptu overview select engin avail separ page subpag page_select full intern document page also provid overview implement select technic detail select engin also avail select modul documentationref module_select use particular understand select work detail want use select code outsid trajectori analysi framework select modul also provid function neighborhood search analysi tool common case full period boundari condit gridbas search implement see gmxanalysisneighborhood detail class use independ select function output data handl ref module_analysisdata modul provid two thing support uniformli provid output data analysi tool tool comput output valu place _data object_ process allow two thing reusabl data modul appli across differ tool common postprocess data object provid parallel support set reusabl data modul postprocess data includ function like averag data comput histogram plot data file mani modul also provid output data object allow data modul attach gener concept explain detail separ page subpag page_analysisdata analysisdata modul documentationref module_analysisdata provid technic detail input option section_analysisframework_opt declar input data tool typic commandlin option includ input file select ref module_opt modul use analysi tool code receiv instanc gmxioptionscontain one initi method use provid input option basic option declar basicoptionsh also gmxselectionopt use manner option tool declar local variabl receiv valu option option pars command line framework tool code read valu variabl option declar fill gmxioptionscontain object also use provid help user also handl framework see document gmxtrajectoryanalysismodul option modul documentationref module_opt detail coordin data output ref module_coordinateio modul allow modul output coordin data use gener analysi provid two main compon outputmanag handl file open write close registr modul chang metainform set modul chang metainform coordin data frame cross check requir data output file format detail inform well interact diagram found modul documentationref module_coordinateio exampl code write trajectori analysi tool page_analysistempl gromac instal includ templat write trajectori analysi tool use ref page_analysisframework found sharegromacstempl instal directori sharetempl sourc distribut full sourc code file also includ document ref templatecpp templatecpp rest page walk code explain differ part dontinclud templatecpp global definit start includ gener c header skip string vector continu includ header analysi librari skiplin gromacstrajectoryanalysish header includ header togeth defin basic data type need write trajectori analysi tool conveni also import name gmx namespac global scope avoid repeat name everywher skiplin use namespac tool modul class declar defin class implement analysi tool skip analysistempl analysi tool class inherit gmxtrajectoryanalysismodul interfac conveni function easier interfac code walk differ method implement templat note templat implement virtual method less often need discuss issu aris complex case see document gmxtrajectoryanalysismodul full descript avail virtual method conveni function first block member variabl use contain valu provid differ option vari depend need analysi tool analysisneighborhood object provid neighborhood search use analysi final block variabl use process output data see initanalysi detail use templat need custom frameloc data think need complex analysi need see document gmxtrajectoryanalysismoduledata detail care parallel need consid part simpli declar variabl modul class initi gmxtrajectoryanalysismoduleinitanalysi postprocess gmxtrajectoryanalysismodulefinishanalysi construct constructor possibl destructor analysi modul simpl constructor initi default valu destructor free memori manag modul templat attribut class need explicitli freed declar constructor skip analysistempl input option initi modul split method two use templat gmxtrajectoryanalysismoduleinitopt use set option understood modul well set differ option gmxtrajectoryanalysisset see document class detail skip void set templat first set descript text tool use help text declar option specifi output file name follow option use set select final option set cutoff valu cutoff default valu one set constructor would also possibl explicitli set valu provid user option store member variabl final indic tool alway requir topolog inform done demonstr purpos code templat work even without topolog addit document defin differ kind option see gmxioptionscontain basicoptionsh gmxselectionopt need defin option specif analysi common option eg specifi input topolog trajectori ad framework adjust set select option eg number accept select base option valu need overrid gmxtrajectoryanalysismoduleoptionsfinish simplic done templat analysi initi actual analysi initi gmxtrajectoryanalysismoduleinitanalysi skip void inform topolog pass paramet set object also use access inform user input one main task method set appropri gmxanalysisdata object modul see gmxtrajectoryanalysismodul gener approach object use process output tool main purpos support parallel even dont care parallel still provid conveni build block eg histogram file output templat first set cutoff neighborhood search creat regist one gmxanalysisdata object contain frame one column input select contain main output tool minimum distanc refer select particular select creat setup modul comput averag distanc select see writeoutput use final output file provid creat setup modul plot perfram distanc file analysi modul need temporari storag process frame ie use custom class deriv gmxtrajectoryanalysismoduledata alloc gmxtrajectoryanalysismodulestartfram see parallel support need initi base data first frame commonli base box size need overrid gmxtrajectoryanalysismoduleinitafterfirstfram use templat analyz frame one initi method need overridden support automat parallel gmxtrajectoryanalysismodulestartfram need custom frameloc data parallel skip method ignor last paramet gmxtrajectoryanalysismoduleanalyzefram make thing simpler templat method necessari main part analysi analysi code done gmxtrajectoryanalysismoduleanalyzefram method call frame skip void p frnr paramet give zerobas index current frame mostli use gmxanalysisdata p pbc contain pbc inform current frame distanc calcul eg pbc_dx p pdata point data structur creat startfram although usual necessari except time field raw frame data access p fr case analysi written get posit data select assum constant size requir support full flexibl select engin templat first get data custom data structur shorthand access use custom data object need c static_cast skip analysisdatahandl parallelselect simpl calcul use analysisdatahandl class set perfram output tool skip nb finishfram frame process gmxtrajectoryanalysismodulefinishanalysi call place custom postprocess data templat noth necessari process done data modul skip void data structur creat gmxtrajectoryanalysismodulestartfram use aggreg data across frame need overrid gmxtrajectoryanalysismodulefinishfram combin data data structur see document method detail necessari templat moduledata structur contain data use analysi singl frame output final program need write valu analysi complet case achiev proper chain data modul often necessari custom process activ done gmxtrajectoryanalysismodulewriteoutput make easier reus analysi modul eg script languag output file might desir templat simpli print averag distanc analysi group skip void use c avem_ modul initi initanalysi aggreg averag comput distanc definit main thing remain defin main function implement commandlin tool creat modul run use gmxtrajectoryanalysiscommandlinerunn use boilerpl code skip int libapi tool within gromac analysi tool implement use templat also easili includ gromac librari follow step put tool sourc code srcgromacstrajectoryanalysismodul remov use namespac gmx enclos code gmxanalysismodul namespac tool class unnam namespac within creat header file correspond tool add follow class with gmxanalysismodul namespac replac templat name tool cpp class templateinfo public static const char name static const char shortdescript static trajectoryanalysismodulepoint creat add definit item sourc file outsid unnam namespac replac templat analysistempl string correct valu cpp const char templateinfonam templat const char templateinfoshortdescript comput someth trajectoryanalysismodulepoint templateinfocr return trajectoryanalysismodulepointernew analysistempl regist modul srcgromacstrajectoryanalysismodulescpp done tool invok gmx templat use string specifi name see exist tool within srcgromacstrajectoryanalysismodul concret exampl prefer layout file pleas document author file use doxygen comment like exist file endif neighborhood search analysi tool page_analysisnbsearch header nbsearchh declar c interfac rel flexibl effici neighborhood search current implement within select modul origin depend select code easili split futur emphasi flexibl eas use one main driver one common implement gridbas search avoid replic multipl tool make tool take advantag signific perform improv allow main featur provid gridbas search triclin box shape gromac support ie triangular box matrix skew gridbas search pbc option except screw boundari condit pbc gridbas search grid construct base bound box grid atom effici rectangular grid cell whose size determin particl densiti limit cutoff transpar fallback simpl allpair search cutoff long algorithm grid search otherwis support support either nvsm pair search two set coordin pair within singl set coordin support comput distanc xy plane still gridbas conveni function find shortest distanc nearest pair two set posit basic support exclus threadsaf handl multipl concurr search cutoff differ refer posit usag neighborhood search work conceptu two differ set coordin _refer positions_ initi search provid one set refer posit get place search grid determin size grid _test positions_ set refer posit provid set test posit singl posit search perform test posit find refer posit within cutoff point possibl perform multipl search set refer posit grid start use neighborhood search need first creat instanc gmxanalysisneighborhood class allow set global properti search notabl cutoff distanc provid refer posit gmxanalysisneighborhoodposit pbc inform get gmxanalysisneighborhoodsearch instanc either use method directli class find eg nearest refer point test posit full pair search return referencetest pair within cutoff pair search perform use instanc gmxanalysisneighborhoodpairsearch search object return method return inform pair return instanc gmxanalysisneighborhoodpair use access indic refer test posit pair well comput distanc see class document class detail use togeth select instanc gmxselect gmxselectionposit transpar pass posit neighborhood search implement section provid highlevel overview algorithm use necessari understand detail use api use get best perform main audienc develop may need extend api make suitabl case grid search initi base refer posit pbc inform grid cell alway rectangular even fulli triclin box pbc grid edg defin bound box refer posit pbc grid cover unit cell grid cell size determin averag cell contain ten particl special consider place case grid one twodimension flat box result grid cell dimens code fall back automat allpair search correct oper grid algorithm need three cell dimens code fall back nongrid search dimens separ initi also precalcul shift requir across period boundari triclin cell ie fraction number cell grid origin shift cross period boundari z direct final refer posit map grid cell averag number particl within cell somewhat heurist logic particularli optim best perform search test posit test posit consid independ coordin test posit map grid coordin system coordin fraction may lay outsid grid nonperiod dimens bound box cutoff sphere center map coordin determin grid cell intersect box use search refer posit search grid cell may vari depend coordin test posit even test posit within cell possibl triclin shift grid consid loop cell cutoff box coordin wrap around period dimens done shift search rang dimens z dimens loop cross boundari help format page_onlinehelp part gromac use insourc string document sourc notabl use descript option list print h command line case expos also code use gromac librari write commandlin tool help text declar array string const char const desc first paragraph second paragraph text ttsome formattingtt array variabl pass function expos help text help content also gener base eg list option program declar approach also use intern gromac place help text use consol output like h case well produc restructuredtext restructuredtext output pass sphinx produc html user guid unix man page format markup partli due histor reason markup allow within help text mixtur restructuredtext gromacsspecif markup allow format current extens basic construct work gener approach format text written restructuredtext asi replac gromacsspecif markup line break string input array mean comma end line separ string critic proper format also mean restructuredtext construct appear correctli html man page long output format support consol output input string pars basic restructuredtext construct abl rewrap text consol width current fix charact pars one major constraint restructuredtext construct use paragraphlevel markup recogn parser result messi consol output inlin markup current process way construct render reason plain text principl use restructuredtext follow restructuredtext construct recogn work consol output paragraph ie block text separ empti line text within paragraph wrap separ indent preserv long whole paragraph indent level expect restructuredtext mean block quot also render reason sinc indent paragraph liter block ie indent paragraph preced paragraph end line break within paragraph preserv rule handl restructuredtext multipl paragraph within liter block current support titl ie line underlin punctuat charact titl format current preserv asi must manual ensur use punctuat charact properli fit context ie titl gener restructuredtext document titl overlin current support bullet list list start current recogn indent second subsequ line determin first nonspac charact bullet andor second line input minimum use note restructuredtext must indent respect preced paragraph otherwis bullet list render within block quot also empti line need preced bullet list enumer list list start digit support eg multidigit number use indent determin bullet list list renumb automat gromacsspecif markup markup within paragraph current done gromacsspecif construct limit bracket futur may get replac restructuredtext construct follow use tttt text tag format monospac font bbbb text tag format bold font itit text tag format ital font magmag text tag render bar charact special charact restructuredtext par replac two newlin produc paragraph break new help text explicit empti line prefer variou markup construct mainli relat math also use place current alway replac text irrespect output format new approach need proper math support addit follow replac possibl necessarili context refref replac link section describ term tag affect restructuredtext output tag simpli remov consol output mechan manag crosslink would need addit work thismodul replac name current modulecommand eg gmx angl program replac name current execut eg gmx libapi implement see ref module_onlinehelp modul document implement detail see ref page_wrapperbinari detail restructuredtext help export process endif analysi output data handl page_analysisdata ref module_analysisdata modul provid support common data analysi task within ref page_analysisframework basic approach use modul visual dot digraph analysisdata_overview rankdir bt dataobject labeldata objectnsubclass gmxabstractanalysisdata datamodul labeldata modulenimpl gmxianalysisdatamodul datamodul labeldata modulenthat also provid data datamodul labeldata modul datamodul dataobject datamodul dataobject datamodul datamodul enddot typic analysi tool provid raw data output one gmxanalysisdata object root _data object_ diagram object provid storag data perform oper data one _data modules_ attach data object exampl oper averag histogram plot data file data modul provid ref module_analysisdata modul implement new one necessari creat class implement gmxianalysisdatamodul mani case data modul also provid data process act data object make possibl attach data modul form process chain simpl case chain end modul write data file also possibl access data data object whether plain data object data modul programmat comput postprocess outsid framework data object typic need told advanc know store data perman even attach modul requir modul process onlin ie data produc attach modul support necessari store raw data memori modul design also support process frame parallel case data may becom avail order particular write perfram data file also type postprocess necessari reorder data sequenti implement framework analysi tool need worri use provid api structur data highest level data structur separ gmxabstractanalysisdata object oper independ object independ set postprocess modul within gmxabstractanalysisdata object data structur along three dimens _frames_ one frame data object raw data produc analysi tool typic correspond input trajectori frame data set view x axi graph _data sets_ one data set data object purpos data set work independ ie postprocess modul oper data set separ modul reduc data set singl column output main purpos use multipl data set share postprocess chain multipl set data eg multipl rdf comput tool one pass particular case number data set known compil time note data set contain number frame _columns_ one column data set differ data set contain differ number column column frame contain singl valu see support valu programmat data within frame organ _point sets_ point set consist continu rang column singl data set two type data _simple_ frame exactli one point set data set point set span column data set _multipoint_ frame number point set may span arbitrari column allow point set overlap ie multipl point set specifi valu column main purpos multipoint data support case known advanc mani valu frame number impract larg need mainli matter performanceimplement complex tradeoff complex intern implement would possibl support larger data set without performancememori impact current impos current implement place burden decid appropri usag pattern user code allow much simpler intern implement individu valu identifi frame data set column consist singl valu type real option error valu flag flag identifi part valu realli avail follow state possibl _present_ valu set _missing_ valu mark miss data sourc state valu still access return real valu mean differ data modul handl case differ _unset_ valu set allow access valu queri state data modul ignor miss valu skip valu _present_ also handl unset valu data modul typic allow unset valu data provid class base class data object includ data modul provid data gmxabstractanalysisdata class provid facil attach data modul data queri data provid method alter data logic manag actual data deriv class main root nonmodul data object class use analysi tool gmxanalysisdata class provid method set properti data add frame interfac framebas construct one frame time finish move next frame frame construct directli use gmxanalysisdata instead separ _data handles_ use explain detail ref section_analysisdata_parallel simpl need small amount data gmxanalysisarraydata also provid class allow data prepar memori singl big array allow random access data set valu valu set final valu notifi attach data modul loop array parallel section_analysisdata_parallel one major driver design analysi data modul provid support transpar process multipl frame parallel case output data multipl frame may construct simultan must order correctli data modul write file order taken care framework allow analysi tool writer concentr actual analysi task user point view main player respect gmxanalysisdata object two thread process parallel allow creat separ gmxanalysisdatahandl object handl use independ construct frame output data gmxanalysisdata object intern take care notifi modul correctli necessari store finish frame temporari buffer preced frame also finish increas effici data modul also parallelizationawar abil process data order allow gmxanalysisdata notifi soon frame becom avail parallel data modul attach frame reorder temporari buffer need nonparallel data modul attach parallel data modul parallel data modul take respons order output frame ideal data modul produc significantli less data take make cheaper order point current parallel runner implement like applic tool written use framework requir minim chang take advantag framelevel parallel runner materi provid data process modul data modul provid ref module_analysisdata modul list short descript see document individu class detail note list manual maintain may alway uptod comprehens list found look inherit graph gmxianalysisdatamodul list userfriendli dl dtgmxanalysisdataaveragemoduledt dd comput averag standard deviat column input data one output valu input column dd dtgmxanalysisdataframeaveragemoduledt dd comput averag frame input data one output valu input data set frame dd dtgmxanalysisdatabinaveragemoduledt dd comput averag within bin input pair valu first valu defin bin second valu set valu accumul averag within bin one output histogram input data set dd dtgmxanalysisdatasimplehistogrammoduledt dd comput histogram valu within data set ad histogram one output histogram input data set provid histogram input frame separ also full histogram frame intern submodul dd dtgmxanalysisdataweightedhistogrammoduledt dd comput histogram input pair valu first valu defin bin second valu set valu add bin output like gmxanalysisdatasimplehistogrammodul dd dtgmxanalysisdatalifetimemoduledt dd comput lifetim histogram input column determin time interv valu continu presentnonzero creat histogram length interv one output histogram input data set dd dtgmxanalysisdataplotmoduledt dtgmxanalysisdatavectorplotmoduledt dd write data file dd dl gromac mainpag gromac versatil packag perform molecular dynam ie simul newtonian equat motion system hundr million particl see wwwgromacsorghttpwwwgromacsorg inform document gener doxygen mostli extract sourc code provid document understand sourc code document gener differ level detail document gener includ intern document includ intern function class use intern implement purpos main audienc level detail peopl want understand detail implement area tri find specif function within librari overwhelm amount detail librari api documentationhtmllibindexxhtml skip function meant use outsid singl modul elseif libapi document function librari intend reus within librari subset function also expos public api also overview document aim gromac develop includ level main audienc level detail user develop want understand gromac code gener want call gromac modifi public api documentationhtmluserindexxhtml provid cleaner entri point interest intern implement detail describ tri search full documentationhtmlfullindexxhtml els document function expos instal header intend part public api note definit public api preliminari subject chang main audienc level detail user gromac interest write analysi tool use gromac librari well develop want link gromac understand inner work gromac want contribut gromac see detail librari api documentationhtmllibindexxhtml full documentationhtmlfullindexxhtml endif current part code document follow page give overview topic document subpag page_analysisframework br provid overview framework gromac librari provid write trajectori analysi tool subpag page_onlinehelp br provid overview format markup avail help text subpag page_usinglibrari br provid gener guidanc write softwar use gromac librari libapi subpag page_wrapperbinari br provid overview gmx wrapper binari implement subpag page_log br document log statu output within mdrun subpag page_simd br document new simd modul make possibl write highli acceler cpu code still portabl subpag page_nbnxm br document nonbond modul use nxm atom cluster subpag page_awh br document acceler weight histogram awh method use acceler sampl along reaction coordin subpag page_mdmodul br document workinprogress modular part mdrun make easier implement addit featur addon top common interfac subpag page_refdata br document write test use refer data gener test subpag page_modularsimul br document modular simul approach subpag page_modulegraph br automat gener modul depend graph endif list hope expand time nxm atomclust nonbond algorithm page_nbnxm algorithm comput nonbond pair interact time consum part molecular dynam simul therefor necessari highli optim achiev good simul perform standard atom pair list good match modern simd singleinstruct multipledata cpu architectur gpgpu acceler achiev higher cach data reus instruct parallel cluster atom group size n n either differ factor done spatial grid bin construct pair list cluster instead singl atom lead smaller list also regular data access nonbond pairinteract kernel comput interact atompair clusterpair simultan gpu anoth layer superclust consist multipl cluster increas data reus architectur support current modul support differ kernel architectur plain c slow refer simd xm target cpu use simd intrins n simd width simd xmm target cpu use simd intrins n simd width gpu target gpu nm nm depend gmx_gpu_nb_cluster_s compil option valu mdrun modul page_mdmodul current mdrun construct set c routin call share data coupl common data structur t_inputrec t_forcerec t_state etc flow throughout code electr field code srcgromacsappliedforc implement altern concept allow keep everyth relat electr field function singl place least specialpurpos function would hope provid maintain approach would also support easili ad new function core featur may still need stronger coupl provid rest page document part modular mechan taken clear form gener design part may requir code convert modul clearer requir mechan need support best way express gener usabl form structur modul modul implement factori return instanc gmximdmodul interfac method turn refer interfac gmximdpoptionprovid gmximdoutputprovid gmxiforceprovid modul also implement interfac subset code outsid modul call method interfac see document individu interfac detail support implement modul modul construct composit interfac ie abstract class gener pure virtual method lack implement eg trajectorywrit code loop contain pointer gmximdoutputprovid without need know concret type might implement interfac modul class extend use base class express final keyword class definit gener modul implement differ flavour function perhap base user choic avail comput resourc gener implement provid variabl behavior method call interfac either code branch run time upon data contain modul eg read mdp option modul class contain pointer intern interfac class whose concret type might chosen setup set implement intern interfac approach keep separ set interfac characterist md modul particular flavour specif modul virtual method modul class inherit interfac declar overrid express intent implement virtual function interfac permit compil check true eg interfac class chang virtual keyword specifi redund overrid use follow cpp core guidelin guidelin c handl mdp input accept paramet mdp file modul need implement gmximdpoptionprovid initmdpopt declar requir input paramet use option modul case paramet declar nest section instead flat set option structur use futur get input valu structur mdp file eg json xml structur match declar option use option modul modul need declar local variabl valu option assign defin structur also use store tpr file see initmdptransform declar map current flat mdp format structur format defin initmdpopt make possibl intern forwardlook structur represent input still flat list valu futur also allow support format sidebysid long deem necessari implement side framework code interact modul follow thing make mdp input work grompp read mdp file first construct flat keyvaluetreeobject input option set properti call initmdptransform modul use produc transform convert flat tree structur tree perform defin convers process transform oneway although framework keep track origin valu provid sensibl error messag origin mdp option name includ call initmdpopt modul initi singl option object input option process structur tree use option two step option specifi input add properti tree default valu option specifi input valu tree convert nativ valu option eg string int integ option assign valu tree option object make valu avail local variabl modul defin initmdpopt note current modul use storeisset option know whether particular option provid mdp file alway return true option limit current implement also part enforc mdp file written gmx grompp po produc differ behavior setnotset differ grompp po write mdp file equival input implement call buildmdpoutput modul prepar builder object use writekeyvaluetreeasmdp old flat tree valu given user input preserv order option format grompp write tpr file write structur tree default valu nativ valu convers tpr file mdrun read tpr file read structur tree broadcast structur rank rank call initmdpopt modul assign valu tree option object modul exactli state grompp tool gmx dump gmx check particular read tpr file read structur tree principl could oper directli tree gmx dump particular orgir option howev futur proper tpr backward compat support need call modul ensur tree structur version expect instead origin version wrote file current tool call initmdpopt basic defaultn valu convers code interest paramet modul read t_inputrec tpr file ignor tree compat old tpr file yet structur tree io code convert old valu modul paramet structur tree tpxiocpp current mechan chang mdp input paramet ad new remov old one would maintain tpr mdp backward compat vision use transform engin initmdptransform support specifi versiontovers convers chang option appli necessari convers sequenc main challeng keep track version know convers appli callback modul setup simul setup simul modul receiv requir inform like topolog local atom set subscrib callback function includ notif modul add function signatur callback function mdmodulesnotifi mdmodulesnotifiersh c buildmdmodulesnotifi yourcallbacksignatur keep alphabet order eas git merg hand notifier_ member mdmodul implement class builder createyourmodulenotifier_ add function want subscrib builder notifiersubscribeyourfunct subscrib class member function modul use lambda express c notifiernotifier_subscribemodulepoint yourmoduleget yourcallbacksignatur argumentmodulepointerargu setup eg within mdrunner use c yourcallbacksignatur argument mdmodules_notifiernotifier_notifyargu store nonmdp option modul paramet mdrun modul want store data nonmdp input eg result comput setup atom indic index group one exampl evalu string grompp time store list integ run input file mdrun setup inform evalu index group longer avail store paramet subscrib keyvaluetreebuild notif provid handl keyvaluetreebuild allow ad inform tree restor paramet subscrib const keyvaluetreeobject notif return tree build keyvaluetreebuild modul depend graph page_modulegraph graph show depend sourc code modul comput includ statement code document modul gray background click modul take modul document legend graph found graph ifnot xml dotfil moduledepsdot endif legend graph annot color line style use modul depend graph detail textual annot graph dot digraph legend node fontnamefreesansfontsizeheightshapebox edg fontnamefreesansfonts rankdir lr subgraph cluster_nod label node legaci labelundocu fillcolorgrey stylefil analysi labelanalysi fillcolor stylefil util labelutil fillcolor stylefil mdrun labelmdrun fillcolor stylefil instal labelinstal color penwidth subgraph cluster_edg label edg node labelani invalid invalid labelinvalid color legaci legaci labellegaci colorgrey legaci labelundoc public public labelpubl colorblack public labelpubl public labelpubl librari librari labellibrari color librari labellibrari pubimpl pubimpl colorblack styledash pubimpl labelintern pubimpl labelpubl libimpl libimpl color styledash libimpl labelintern libimpl labellibrari test test labeltest color styledash test labeltest legaci invalid styleinvi enddot node color dl dtgray backgrounddt ddundocu moduledd dtorang backgrounddt dddocument util modulesdd dtred backgrounddt dddocument analysi modulesdd dtviolet backgrounddt dddocument md execut modulesdd dtlight blue borderdt ddmodul contain public api instal headersdd dl edg color edg certain color indic type list present dl dtreddt ddinvalid dependencydd dtgraydt ddlegaci depend depend undocu file undocu directoriesdd dtsolid blackdt ddpublic header depend moduledd dtsolid bluedt ddlibrari header depend moduledd dtdash bluedt ddsourc file depend librari header moduledd dtdash blackdt ddsourc file depend public header moduledd dtdash greendt ddtest file depend moduledd dl use refer data c test page_refdata ref module_testutil modul provid among thing util write googl test test compar result store refer data either use regressionstyl test ensur output chang combin manual check refer data differ kind assert expect result would tediou express directli c code eg check complic data structur correct current refer data function quit basic extend ifwhen control eg comparison toler need refer data organ conceptu refer data consist treelik structur node leaf node check singl primit valu integ floatingpoint valu string etc inner node act _compound_ valu help organ data within compound node includ root tree child node identifi id string node within singl compound must uniqu id possibl compar multipl valu produc test singl node natur test pass test produc valu case node also type string leaf node type predetermin set string identifi type valu store node compound node type string provid test case type refer data must match type provid test provid addit safeti chang test detect mismatch test refer data intent compound node whose content structur would type simplifi use xslt view refer data see compound type predefin eg simpl sequenc complic compound defin adhoc test need see use code special case id empti null intend case one check sequenc item thing distinguish item posit sequenc use empti id remov need gener uniqu identifi item make textual diff refer data file easier read singl sequenc node empti id support within one parent node first check node empti id follow nonempti id next check empti id match first node sequenc clariti node empti id type enforc use refer data code use refer data test test first creat exactli one instanc gmxtesttestreferencedata local variabl test member variabl test fixtur subclass test fixtur alreadi contain variabl eg gmxteststringtestbas gmxtestcommandlinetestbas use default constructor constructor intend selftest util code use test includ selftest refer data implement behav differ describ access root node data gmxtesttestreferencedatarootcheck need call return gmxtesttestreferencecheck provid variou check method use check valu toplevel node gmxtesttestreferencecheckercheckcompound call creat custom compound type return anoth gmxtesttestreferencecheck use check valu child node creat compound whenev gmxtesttestreferencecheck method detect mismatch refer data gener nonfat googl test failur current test test natur also use test assert addit check mismatch automat also fail test also possibl read valu refer data item use gmxtesttestreferencecheck use programmat work item first written test support test want check data refer use refer persist layer store inform use least serial test current support use case caveat possibl use test use floatingpoint valu refer data toler comparison influenc gmxtesttestreferencecheckersetdefaulttoler percomparison toler would possibl implement necessari current either chang default toler whenev need creat copi gmxtesttestreferencecheck object set differ toler differ instanc note implicit assumpt mix doubleprecis build produc result within given toler mean thing test refer data eg multipl step md integr refer data test need alway gener doubl precis unless result nice exact binari floatingpoint number creat gmxtesttestreferencedata instanc enforc use refer data test data loadedus gmxtesttestreferencedatarootcheck first call test never call method gmxtesttestreferencedata object noth allow use test fixtur eg commandlinetestbas also test need refer data benefit featur fixtur run test use refer data run test use refer data execut test binari would otherwis howev first add test refer data exist test fail assert messag say refer data could found gener refer data need run test binari refdata creat commandlin option also possibl use updat option gener refer data chang test test code refer data need chang need run test binari refdata updateal refdata updatechang first recreat refer data scratch latter retain old refer valu still valid word floatingpoint refer valu within test toler kept old valu valu outsid toler otherwis match exist updat use least test contain floatingpoint data expect floatingpoint valu would actual need chang allow updat part refer data without doubleprecis build also make easier avoid spuriou chang last bit refer data valu singl output valu expect chang creat updat refer data test need pass run correspond flag comparison refer data pass mode need ensur assert test also pass test throw except note test multipl comparison id node refer data comparison still fail createupd test produc result comparison oper creat updat refer data use gtest_filt commandlin option provid googl test select test whose refer data want influenc persist refer data store xml file srcgromacsemmoduleemtestsrefdata sourc tree part framework depend tinyxml bundl srcextern one file produc per test use refer data renam test otherwis chang refer data current need manual manag file git inspect refer data browser xslt stylesheet transform xml file html custom transform need written type test output easi check otherwis secur featur browser transform may work browser reason xslt file must folder xml file case xslt file share multipl modul srctestutilscopy_xslsh take care synchron file master copi edit acceler weight histogram method awh page_awh acceler sampl awh awh calcul free energi along order paramet system free energi barrier overcom adapt tune bia potenti along order paramet bias distribut along paramet converg toward chosen target distribut fundament equat govern tune logtarget bia free energi bia free energi initi unknown typic target distribut simpli chosen uniform bia complet flatten free energi landscap design awh modul modul implement awh case order paramet correspond reaction coordin refer coordin short ie function system configur bia coupl system bia potenti either form harmon umbrella potenti montecarlo mc jump around current coordin valu smooth convolut umbrella awh modul organ follow awh class interfac outsid insid modul awh class contain one biascoupledtosystem object biascoupledtosystem class take care reaction coordin input forc output singl bia object containt bia class contain wrapper object biasstat helper comput take place biasstat object subclass bia class also contain biaswrit object take care io use awh mdrun basic use awh mdrun consist method call call constructor awh pull modul initi call applybiasforcesandupdatebia everi md step pull potenti calcul function call grompp pull potenti provid regist use registerawhwithpul grompp check unregist potenti main task awh calcul set bia forc given current coordin valu accumul number coordin sampl updat free energi estim bia awh current reli pull code first task pull provid awh updat coordin valu distribut bia forc awh calcul atom make coordin also mean order depend pull function need call awh function see implement quit gener multipl independ awh bias coupl system simultan make sens system made sever fairli independ part like monom protein bia act exactli one possibl multidimension coordin coordin dimens map exactli one pull coordin thu ndimension bias coordin defin set n pull coordin period taken care coordin dimens requir dihedr angl increas parallel option multipl commun simul share sampl simul would share singl bia free energi estim altern one may partit sampl domain smaller subdomain overlap multipl independ simul sampl subdomain note intern awh modul keep track free energi unit thermal energi kt mostli deal free energi form logprob use unit would bug prone energi type variabl explicitli document unit kt also checkpoint energi file data unit kt analysi tool default convert energi kjmol also kt option log page_log current mdrun use combin direct cstyle io fplog stderr facil describ howev get move interfac futur part make log system shown dot digraph logging_overview builder labelloggerbuild urlref gmxloggerbuild owner labelloggerown urlref gmxloggerown logger labelmdlogg urlref gmxmdlogger target labelilogtarget urlref gmxilogtarget user labelus code builder owner labelbuild owner logger owner target labelown logger target labelrefer user builder labelset log target user logger labelwrit withngmx_log enddot initi log system use code creat instanc gmxloggerbuild set desir log target provid method target initi code call gmxloggerbuilderbuild get gmxloggerown respons manag memori alloc logger log inform use code use gmxmdlogger return gmxloggerownerlogg gmx_log macro code write log need know class helper class use implement macro rel simpl contain refer log target log target would consum inform written gmx_log whole statement evalu condit read log target member variabl compar nullptr code format output skip case current implement gear make gmx_log behavior stabl rel extens howev use approach gmx_log write log first think api could best organ inform written log compos _log entries_ gmx_log statement write singl log entri mean newlin automat ad log method threadsaf respons call code use singl thread otherwis synchron access wrapper binari implement page_wrapperbinari page mainli describ implement gmx wrapper binari mani detail visibl code document includ part librari api document make easier understand overal implement without read extens document main implement main method wrapper binari implement srcprogramsgmxcpp simpl code basic task initi gromac use gmxinitforcommandlin see ref page_usinglibrari creat gmxcommandlinemodulemanag instanc wrapper binari call variou method add modul manag initi otherwis mani pre binari ad srcprogramslegacymodulescpp new c tool ad srcgromacstrajectoryanalysismodulescpp pass control manag see success return deiniti gromac return exit code manag main method also catch except one caught print error messag termin program cleanli command line modul modul within wrapper binari implement class implement gmxicommandlinemodul interfac gener helper class gener c modul typic use gmxoption commandlin handl instead modul implement pars help separ ident code implement gmxicommandlineoptionsmodul instead framework provid bridg class contain common code wrap gmxicommandlineoptionsmodul gmxicommandlinemodul c trajectori analysi modul gener implement run gmxtrajectoryanalysismodul subclass cmdlinerunnercpp old cstyle main function see ref section_wrapperbinary_cmain command line manag section_wrapperbinary_manag core wrapper binari gmxcommandlinemodulemanagerrun method method pars command line argument modul name argument wrapper binari argument h version caus rest command modul name follow ignor modul specifi also check command line argument modul name option understood wrapper binari h version see detail h work option handl manag remov command line process print startup header content control command line option command line option request termin startup header version return pass control select modul modul specifi help modul invok see print quot end return exit code modul command line help handl gmx help command well gmx h gmx _module_ h command line manag intern creat modul handl help command command line contain h well invoc gmx without argument translat correspond gmx help command exampl gmx _module_ h handl exactli like gmx help _module_ note h specifi modul command line manag throw away argument pass control modul translat intern help modul handl help output help organ hierarchi gmxihelptop instanc help modul intern creat root help topic print gmx help addit word gmx help command taken specifi topic show hierarchi gmxcommandlinemodulemanag intern creat help topic ad modul topic shown gmx help _module_ invok forward request actual modul gmxicommandlinemodulewritehelp addit topic creat intern gmxcommandlinemodulemanag provid method add addit help topic current use expos refer materi select content access use help select prompt help format build system provid target make sphinxprogram gener restructuredtext help command turn use gener man html help intern execut gmx help export rst trigger special handl intern help modul see document linktodevmanualbuildsystemspeci target build system detail target use gener document option set help modul loop modul binari write help separ file help modul write common header footer ask actual modul write modulespecif content gmxicommandlinemodulewritehelp use differ help context consol output addit list modul gener gromac man page alphabet bytop list html page handl c main function section_wrapperbinary_cmain mani pre modul still implement function c main signatur binari call parse_common_arg less first thing process order implement approach modul manag intern creat command line modul gmxcommandlinemodulemanageraddmodulecmain creat modul collabor parse_common_arg achiev function new c modul run modul simpli execut provid main method help write complex requir help context pass modul parse_common_arg handl use global instanc context see gmxglobalcommandlinehelpcontext context set modul parse_common_arg detect print help return fals indic caller immedi return singleinstruct multipledata simd code page_simd code simd instruct one import way gromac achiev high perform use modern hardwar capabl singl assembl instruct oper multipl data unit essenti short fixedlength vector usual element provid effici way cpu increas floatingpoint perform much less versatil gener purpos regist reason difficult compil gener effici simd code user organ data way possibl access vector vector often need align cach boundari support number differ simd instruct set group kernel age also present verlet kernel place howev increas usag sever architectur differ capabl use vendoragnost gromac simd modul document ref module_simd design gromac simd modul function srcgromacssimd intend use write architectureindepend simd intrins code rather make assumpt base architectur introduc limit number predefin preprocessor macro describ capabl current implement one need check write simd code see function expos modul typic small subset gener simd implement particular even tri expos advanc shuffl permut oper simpli havent abl describ gener way implement effici regardless hardwar howev advantag approach straightforward extend support new simd instruct set futur instantli speed old code support complex stuff gromac nonbond kernel make possibl use simd intrins even part code data simdfriendli layout also ad higherlevel util routin perform gatherscatt oper coordin triplet load tabl data align pair lennardjon paramet sum forc need outer loop nonbond kernel straightforward implement sinc performancecrit want exploit featur architectur reason part simd implement final architectur larg larg simd width eg avx element singl precis avx nonbond kernel becom ineffici sinc architectur present known avx avx avx also provid extens support access part regist option defin hand routin perform load store reduc oper base halfsimdwidth data improv perform use wide implement safe ignor first port new platform need socal xnn simd kernel unfortun standard simd architectur avail featur vari lot still need use quit get best perform possibl mean featur avail certain platform critic make mani assumpt storag format size simd width give exampl x doubl precis bit floatingpoint valu alway convert bit integ mani platform use bit use bit integ mean use mask boolean deriv integ oper select doubleprecis floatingpoint valu could get complex higherlevel code decis expos instead want keep integ bit sinc algorithm anyway need work singl precis w bit int avx support wide bit integ simd arithmet integ _conversions_ still done wide correspond singl precis floatingpoint width similarli avx convers doubleprecis integ use bit wide bit regist also integ arithmet avx add proper arithmet wide integ would sever limit perform say integ support present instead stick bit int limit oper expos shuffl intern sse sse doubl precis wide convert integ put first two element wide integ type mean assum floatingpoint simd regist correspond integ regist convers width sinc boolean valu differ width floatdoubl integ correspond floatdoubl need use separ boolean type valu convert eg want use result integ compar select floatingpoint valu might sound complic actual far easier write separ simd code architectur singl doubl point need rememb limit critic never assum anyth simd implement typic implement simd support new architectur day new modul extens requir verlet kernel also straightforward group kernel complex gradual way higherlevel code import thing never _assume_ anyth simd architectur gener strategi gromac split simd code three level dl dtbase level gener simddt dd base level simd modul get includ gromacssimdsimdh provid api defin manipul simd datatyp enough lot case huge advantag roughli pariti differ architectur dd dthigherlevel architecturespecif simd util functionsdt dd part code enough particular group verlet kernel insan amount floatingpoint oper sinc spend time kernel critic optim much possibl strategi first defin larger highlevel function eg take number distanc load tabl interact interact way move architecturespecif implement simd modul achiev reason clean kernel still optim lot done approxim function nonbond kernel load tabl lennardjon paramet sum forc outer loop function intent given name describ data rather function gromac look document routin refer implement quit straightforward implement new architectur dd dthalfsimdwidth architecturespecif util functionsdt dd describ earlier simd width increas element nonbond kernel becom ineffici due larg jparticl cluster size thing still work architectur support effici access partial simd regist eg load half width use alter balanc memori loadstor oper floatingpoint arithmet oper process either eg interact one iter ref gmx_simd_have_hsimd_util_r set hand routin use nonbond kernel present avoid use routin outsid nonbond kernel sinc slightli complex straightforward determin altern provid best perform dd dtarchitecturespecif kernel directoriesfilesdt dd code outsid simd modul implement directori tri execut anyth hardwar specif note includ even check architectur current simd implement check featur instead work futur port dd dl file organ simd modul use coupl differ file dl dtgromacssimdsimdhdt dd toplevel wrapper alway includ first check set made configur time includ suitabl lowlevel implement either singl doubl also contain routin memori align base current gromac precis set alias real simd datatyp see implement care gromacsspecif detail howev note might get simd support hope compil gromac doubl precis hardwar support singleprecis simd simd routin default gromac real precis defin use check describ dd dtgromacssimdimpl_referenceimpl_referencehdt dd exampl lowlevel implement never ever work directli higherlevel code refer implement contain document simd wrapper though file turn includ separ implement file singl doubl simd etc sinc want abl run lowlevel simd implement simul new platform file intent use rest gromac infrastructur eg assert dd dtgromacssimdsimd_mathhdt dd simd math function function file design work matter whether hardwar support integ simd logic oper integ floatingpoint simd arithmet oper integ howev routin check defin use faster algorithm featur present dd dtgromacssimdvector_operationshdt dd file contain rvecrel simd function eg calcul scalar product norm cross product obvious oper scalar gromac rvec type use separ simd variabl xy z vector compon dd dl simd datatyp simd modul handl challeng mention introduct introduc number datatyp mani might map underli simd type need separ type architectur use differ regist eg boolean type floatingpoint data dl dtgmxsimdrealdt dd simdvers gromac real type set base cmake configur intern alias one next two type dd dtgmxsimdfloatdt dd alway singleprecis data might support architectur dd dtgmxsimddoubledt dd alway doubl precis avail rare case might want use specif precis dd dl integ correspond floatingpoint valu type correspond mean integ type get convert data eg singl doubl precis floatingpoint simd variabl need differ sinc mani common implement use half mani element doubl singl simd variabl get half number integ dl dtgmxsimdintdt dd use integ convert tofrom gromac default real type dd dtgmxsimdfintdt dd integ obtain convert singl precis intend convert singl precis floatingpoint normal integ special convers type sinc simd architectur sse avx use differ regist integ simd variabl width float doubl respect need separ two type integ actual oper perform normal one addit multipl also widest integ data type want pure integ simd oper support platform architectur support simd integ type like defin floatingpoint simd type without support integ oper apart loadstoreconvert dd dtgmxsimddintdt dd integ use convert tofrom doubl see preced item detail explan mani architectur includ x one narrow type gmxsimdfint dd dl note integ loadstor oper defin loadstor bit integ even intern regist storag might bit set width simd implement base mani floatdoubl integ loadstor even intern width could larger boolean valu need separ boolean datatyp mask comparison result sinc assum ident either integ float doubl implement use specif predic regist boolean dl dtgmxsimdbooldt dd result boolean oper involv real boolean use select real valu correspond routin suffix b like gmxsimdorb dd dtgmxsimdfbooldt dd boolean specif singl precis dd dtgmxsimddbooldt dd oper specif doubl dd dtgmxsimdibooldt dd boolean oper integ correspond real see floatingpoint descript dd dtgmxsimdfibooldt dd boolean integ correspond float dd dtgmxsimddibooldt dd boolean integ correspond doubl dd dl note tri store load boolean simd type memori whole reason store load oper provid technic possibl achiev defin object insid structur placement new align memori expens oper platform special singlebit predic regist use repres boolean need find portabl algorithm code instead subset use practic seem daunt practic need use type start code dl dtgmxsimdrealdt dd floatingpoint data dd dtgmxsimdbooldt dd boolean dd dtgmxsimdintdt dd integ data might support must check preprocessor macro describ dd dl oper type defin either floatdoubl correspond integ base current gromac precis document occasion detail lowerlevel actual implement function note critic type align memori alway case declar variabl stack unfortun compil least clang os x appear buggi simd datatyp place insid structur somewher process structur includ class turn includ actual simd datatyp align appear lost thu even though compil warn notic need avoid put simd datatyp structur particular sever alloc memori heap occur stack structuresclass simd implement suffici code work full simd width unfortun realiti simpl algorithm like lattic summat need quartet element even simd width need width simd support avail simd indic ref gmx_simd_have_float ref gmx_simd_have_doubl support small subset simd oper simd simd doesnt scale increasingli larg simd width avoid new code simdn use instead simdn implement code like lattic summat inner loop smaller full simd width gromac algorithm iter common pme order three dimens make import special case vector loop effici requir collaps two inner loop use eg one wide simd vector outer inner iter one wide simd vector outer inner iter simdn function provid avail function indic ref gmx_simd_have_nsimd_util_float ref gmx_simd_have_nsimd_util_doubl function return type alia simdnfloat simdndoubl either normal simd type simd type thu support oper simd type support predefin simd preprocessor macro functionalitywis small set core featur requir present platform avanc featur use code defin like eg ref gmx_simd_have_loadu valu summari current avail preprocessor defin use check support use correspond featur first list floatdoubleint defin set _implementation_ case want check directli floatdoubl defin instead use deriv real defin set file list end preprocessor predefin macro defin set lowlevel implement valu work datatyp ref gmx_simd_have_loadu thu mean load float doubl integ unalign memori unalign load avail simd dl dtref gmx_simddt dd sort simd architectur enabl dd dtref gmx_simd_have_floatdt dd singleprecis instruct avail dd dtref gmx_simd_have_doubledt dd doubleprecis instruct avail dd dtref gmx_simd_have_loadudt dd load unalign memori avail dd dtref gmx_simd_have_storeudt dd store unalign memori avail dd dtref gmx_simd_have_logicaldt dd support andandnotorxor floatingpoint variabl dd dtref gmx_simd_have_fmadt dd floatingpoint fuse multiplyadd note provid emul fma instruct fma support case might abl code effici wo fma dd dtref gmx_simd_have_fint_extractdt dd support extract integ simd element gmxsimdfint dd dtref gmx_simd_have_fint_logicaldt dd bitwis shift gmxsimdfint dd dtref gmx_simd_have_fint_arithmeticsdt dd arithmet op gmxsimdfint dd dtref gmx_simd_have_dint_extractdt dd support extract integ simd element gmxsimddint dd dtref gmx_simd_have_dint_logicaldt dd bitwis shift gmxsimddint dd dtref gmx_simd_have_dint_arithmeticsdt dd arithmet op gmxsimddint dd dtref gmx_simd_have_hsimd_util_floatdt dd halfsimdwidth nonbond kernel util avail float simd dd dtref gmx_simd_have_hsimd_util_doubledt dd halfsimdwidth nonbond kernel util avail doubl simd dd dtref gmx_simd_have_gather_loadu_bysimdint_transpose_floatdt dd load pair unalign float simd offset meant linear tabl dd dtref gmx_simd_have_gather_loadu_bysimdint_transpose_doubledt dd load pair unalign doubl simd offset meant linear tabl dd dl also two macro specif simd ref gmx_simd_have_float set use simd singl precis ref gmx_simd_have_doubl similarli denot support doubleprecis simd implement gener properti eg whether simd fma support check normal simd macro implement properti higherlevel code use macro find inform implement instanc simd width dl dtref gmx_simd_float_widthdt dd number element gmxsimdfloat practic width gmxsimdfint dd dtref gmx_simd_double_widthdt dd number element gmxsimddoubl practic width gmxsimddintdd dtref gmx_simd_rsqrt_bitsdt dd accuraci bit sqrtx lookup step dd dtref gmx_simd_rcp_bitsdt dd accuraci bit x lookup step dd dl includ lowlevel architecturespecif implement header set follow deriv defin base current precis one check unless absolut want dig deep explicit singledoubl precis implement dl dtref gmx_simd_have_realdt dd set either ref gmx_simd_have_float ref gmx_simd_have_doubl dd dtref gmx_simd_have_realdt dd set either ref gmx_simd_have_float ref gmx_simd_have_doubl dd dtref gmx_simd_real_widthdt dd set either ref gmx_simd_float_width ref gmx_simd_double_width dd dtref gmx_simd_have_int_extractdt dd set either ref gmx_simd_have_fint_extract ref gmx_simd_have_dint_extract dd dtref gmx_simd_have_int_logicaldt dd set either ref gmx_simd_have_fint_log ref gmx_simd_have_dint_log dd dtref gmx_simd_have_int_arithmeticsdt dd set either ref gmx_simd_have_fint_arithmet ref gmx_simd_have_dint_arithmet dd dtref gmx_simd_have_hsimd_util_realdt dd set either ref gmx_simd_have_hsimd_util_float ref gmx_simd_have_hsimd_util_doubl dd dtref gmx_simd_have_gather_loadu_bysimdint_transpose_realdt dd set either ref gmx_simd_have_gather_loadu_bysimdint_transpose_float ref gmx_simd_have_gather_loadu_bysimdint_transpose_doubl dd dl conveni also defin ref gmx_simd_width never vari use help make clear loop array refer simd width rather defin avail specifi featur hardwar would strongli recommend sprinkl code defin noth els debug nightmar instead write slower gener simd function work everywher overrid faster architecturespecif version implement recommend way add defin around gener function skip name alreadi defin actual implement lowestlevel file typic defin architecturespecif name simdsincosd_ss overrid eg sse simpli undefin set new definit still implement detail wont worri start write support new simd architectur function name reli c overload name function usual ident regardless datatyp oper except function take argument return valu eg setzero sinc overload work formal paramet differ solv use differ lowlevel function name case creat proxi object highlevel gromacssimdsimdh still get function simpli write setzero code autom check fallback implement simd support perform problem code correctli includ gromacssimdsimdh particularli refactor make checksourc check whole code use symbol defin gromacssimdsimdh requir file use symbol correct includ similar check done higherlevel simdmanag header eg gromacsewaldpme_simdh simd math librari addit lowlevel simd instruct gromac come fairli extens simd math librari gromacssimdsimd_mathh support variou mathemat function function avail singl doubl precis overload usual math function name also provid special version function use doubl precis argument evalu result singl precis accuraci use dont need highli accur result want avoid overhead multipl singledoubl convers hardwar architectur provid doubl precis simd implement function squar root exponenti performancecrit provid addit tempat paramet default choic execut normal function version also possibl choos unsaf execut path complet bypass argument check make absolut sure argument alway fulfil restrict list document function use might even good idea add note call unsaf function justifi flavor fine use modular simul page_modularsimul new modular approach gromac simul describ simul gromac object carri simul simul object creat own runner object outsid scope new approach henc describ simul object provid access gener use data own runner object use modular simul gromac automat use modular simul veloc verlet integr integr mdvv function chosen input paramet implement new framework current includ nve nvt nph npt simul without free energi perturb use avail temperatur pressur coupl algorithm also includ pull expand ensembl simul disabl modular simul case default new framework environ variabl gmx_disable_modular_simulatoron set use new framework also integr md function implement environ variabl gmx_use_modular_simulatoron set overrid legaci default legaci implement legaci implement simul consist number independ function carri differ type simul do_md md simul do_cg do_steep minim do_rerun forc energi evalu simul trajectori do_mim mimic qmmm simul do_nm normal mode analysi do_tpi testparticl insert legaci approach obviou drawback data manag do_ function defin local data includ complex object encapsul data function also data structur effect use global variabl commun differ part simul neither ownership access right except const qualifi clearli defin depend mani function call do_ function depend other ie reli call specif order depend clearli defin branch flow do_ function hard understand due branch setup time everi step simul run number boolean set eg bn neighbor search bcalcen calcul energi do_en write energi bener energi calcul need etc boolean enabl disabl branch code current step entir run mostli encod statement main do_ loop also function call task schedul poorli defin depend perstep branch make task schedul eg parallel execut independ task difficult errorpron develop poorli defin depend unclear code flow make chang simul function errorpron render implement new method tediou modular simul approach main design goal new fulli modular simul approach includ extens want eas mainten implement new integr scheme mont carlo want add mc capabl mix md creat hybrid mcmd scheme data local interfac aim local data object offer interfac access object need multistep aim design intrins support multistep integr eg forc call differ frequenc avoid branch includ rare event trajectori write neighbor search comput loop task parallel although first prioriti want design extend allow task parallel gener design approach task schedul task argumentless function perform part comput period simul schedul build queue task ie list task run order time data depend clearli defin approach modifi independ task run parallel simul element task schedul hold list simul element defin isimulatorel interfac element scheduletaskstep time function get call task schedul allow simul element regist one function pointer run specif step time point view element import note comput carri immedi call later actual partial simul run point view builder task schedul import note order element determin order comput perform class isimulatorel public brief queri whether element want run step time element regist one function run step registr pointer virtual void scheduletaskstep time const registerrunfunct method guarante call construct simul run virtual void elementsetup method guarante call simul run deconstruct virtual void elementteardown standard virtual destructor virtual isimulatorel default task schedul period loop list element build queue function pointer run return list task exampl possibl applic would build new queue domaindecomposit dd neighborsearch ns step might occur everi step schedul would loop repeatedli element element like trajectorywrit element regist one step energycalcul element regist everi tenth step forc posit veloc propag constrain algorithm regist everi step result would long queue function pointer includ comput need next dd ns step run without branch signal element might requir comput element exampl trajectori write element independ energycalcul element need signal energi element write trajectori energi element readi ie perform energi calcul upcom step requir replac boolean branch current implement fulfil signal client model class implement isignal interfac get call everi loop element list inform regist client thing happen step trajectori element exampl tell energi element write trajectori end step energi element regist energi calcul step readi write trajectori request class isignal public function run everi step schedul virtual void signalstep time method guarante call construct simul run virtual void setup modular simul approach easili display use simplifi pseudo code simul respons store element right order addintegrationel includ differ order element differ algorithm eg leapfrog vs veloc verlet also logic depend energi output comput global algorithm built simul simpli execut one task next end simul reach class modularsimul public isimul public run simul void run overrid void modularsimulatorrun modularsimulatoralgorithmbuild algorithmbuild addintegrationelementsalgorithmbuild auto algorithm algorithmbuilderbuild const auto task algorithmgetnexttask execut task task follow snippet illustr build leapfrog integr algorithm algorithm builder allow concis descript simul algorithm void modularsimulatoraddintegrationelementsmodularsimulatoralgorithmbuild builder legacysimulatordata_inputrecei eimd leap frog integr algorithm builderaddforceel full state positionst velocitiestdt forcest builderaddstatepropagatordatael legacysimulatordata_inputrecetc temperaturecouplingvrescal builderaddvrescalethermostat vrescalethermostatusefullstepkeno propagatortagleapfrogpropag builderaddpropagatorintegrationstageleapfrogpropagatortagleapfrogpropag legacysimulatordata_inputrecdelta_t legacysimulatordata_constr builderaddconstraintselementconstraintvariableposit builderaddcomputeglobalselementcomputeglobalsalgorithmleapfrog energi time builderaddenergydatael legacysimulatordata_inputrecepc pressurecouplingparrinellorahman builderaddparrinellorahmanbarostat propagatortagleapfrogpropag simul algorithm simul algorithm respons decid element need run specif time step element get call order decid whether need run specif step precomput multipl step current implement task precomput entir lifetim neighbor list simul algorithm offer function get next task queue own element involv simul henc control lifetim ensur pointer callback exchang element remain valid throughout durat simul run also maintain list task updat need class modularsimulatoralgorithm public get next task queue nodiscard const simulatorrunfunct getnexttask privat list signal stdvectorstdunique_ptrisignal signallerlist_ list element stdvectorstdunique_ptrisimulatorel elementslist_ run queue stdvectorsimulatorrunfunct taskqueue_ task iter stdvectorsimulatorrunfunctionconst_iter taskiterator_ updat task queue void updatetaskqueu getnexttask function return next task task queue rebuild task list need const simulatorrunfunct modularsimulatoralgorithmgetnexttask taskqueue_empti taskiterator_ taskiterator_ taskqueue_end runfinished_ return nullptr updatetaskqueu taskiterator_ taskqueue_begin return taskiterator_ updat task queue involv call signal element everi step schedul period refil task queue import keep mind schedul step necessarili ident current step simul time schedul step ahead preschedul step void modularsimulatoralgorithmupdatetaskqueu step schedulingstep currentstep schedulingstep currentstep schedulingperiod schedulingstep time time gettimeschedulingstep signal signal special treatment schedul step const auto signal signallerlist signallersignalschedulingstep time queri element whether need run schedul step const auto element signallerlist elementscheduleschedulingstep time registerrunfunction_ sequenc diagram preloop loop prepar signal element creat store right order signal element perform setup oper need msc hscale modularsimulatorbuild labelmodularsimulatoralgorithmbuild modularsimul labelmodularsimulatoralgorithm signal labelmodularsimulatoralgorithmnsignal element labelmodularsimulatoralgorithmnel taskqueu labelmodularsimulatoralgorithmntaskqueu label constructelementsandsignal modularsimulatorbuild signal label creat signallersnand order modularsimulatorbuild element label creat elementsnand order label constructelementsandsignal label setupallel modularsimul signal label call setup signal box signal label signal signallersn signallersetup modularsimul element label call setup element box element label element elementsn elementsetup label setupallel endmsc main loop main loop consist two part altern run simul stop criterion met first part popul task queue determin task run simul system given time period current implement schedul period set equal lifetim neighborlist task predetermin simul run order actual simul comput run without branch msc hscale modularsimul labelmodularsimulatoralgorithm signal labelmodularsimulatoralgorithmnsignal element labelmodularsimulatoralgorithmnel taskqueu labelmodularsimulatoralgorithmntaskqueu modularsimul box taskqueu label loop whilenot laststep modularsimul note taskqueu label task queue empti simul state step n textbgcoloryellow modularsimul box modularsimul label populatetaskqueu modularsimul taskqueu label fill task queue task next neighborsearch step modularsimul note taskqueu label task queue hold task need move simul step n step n nstlist simul step perform yet howev simul state henc still step n textbgcoloryellow modularsimul taskqueu label run task taskqueu taskqueu box taskqueu label task taskqueuen run task taskqueu note taskqueu label simul comput happen loop textbgcoloryellow modularsimul note taskqueu label task queue empti simul state step n nstlist textbgcoloryellow modularsimul box taskqueu label end loop whilenot laststep endmsc task schedul part main loop task schedul populatetaskqueu allow element push task task queue everi schedul step signal run first give element inform upcom schedul step schedul routin element call order allow element regist respect task msc hscale modularsimul labelmodularsimulatoralgorithm signal labelmodularsimulatoralgorithmnsignal element labelmodularsimulatoralgorithmnel taskqueu labelmodularsimulatoralgorithmntaskqueu label populatetaskqueu modularsimul box modularsimul label dodomaindecompositionndopmeloadbalanc modularsimul element label updat state topolog modularsimul note modularsimul label schedulingstep nnsimulationstep n textbgcoloryellow modularsimul box taskqueu label loop whilenot nextneighborsearchingstep modularsimul signal label run signal schedulingstep signal box signal label signal signallersn signallersignalschedulestep signal element label notifi signal note element label element know schedulingstep anyth special happen eg neighbor search log write trajectori write textbgcoloryellow modularsimul element label schedul run function schedulingstep element box element label element elementsn elementscheduletaskschedulestep element taskqueu label push task element note taskqueu label element regist everyth need schedulingstep textbgcoloryellow modularsimul note modularsimul label schedulingstep textbgcoloryellow modularsimul box taskqueu label end loop whilenot nextneighborsearchingstep label populatetaskqueu modularsimul note modularsimul label schedulingstep n nstlistnsimulationstep n textbgcoloryellow endmsc accept test plan accept test need fulfil make modular simul default code path endtoend test pass do_md new loop gitlab pre postsubmit pipelin physic valid case pass new loop perform differ size benchmark case x cpuonli nvidia gpu slower httpsgithubcomptmerzgmxbenchmark develop purpos md bare minimum want add support pull full support gpu current implement support gpu updat use new modular simul framework explor ad new function gromac includ mont carlo barostat hybrid mcmd scheme multipletimestep integr also explor optim opportun includ reus queue condit creat user input suffici favor design observ simultan execut independ task probabl priorit support might consid deprec do_md futur gromac version simul anneal remd simul temper multisim membran embed qmmm fep lambda vector fanci mdp option fep output mttk essenti dynam constant acceler group ensembleaverag restraint timeaverag restraint freez deform cosacceler signal element detail current implement modular simul consist follow signal element signal signal list pointer client object implement respect interfac get notifi event signal commun neighborsearchsignal inform client whether current step neighborsearch step laststepsignal inform client current step last step simul loggingsignal inform client whether output log file written current step energysignal inform client energi relat special step name energi calcul step virial calcul step free energi calcul step trajectorysignal inform client write trajectori state xvf andor energi plan current step simul element trajectoryel trajectoryel call trajectori client pass valid output pointer let write trajectori unlik legaci implement trajectori element know noth data written file respons inform client trajectori step provid valid file pointer object need write trajectori computeglobalsel computeglobalsel encapsul legaci call compute_glob new approach global reduct oper discuss current part effort element therefor aim offer interfac legaci implement compat new simul approach element current come templat flavor leapfrog case first call velocityverlet integr second call velocityverlet integr respons simul builder place right place integr algorithm forceel shellfcel forceel shellfcel encapsul legaci call do_forc do_shellfc respect respons simul builder place right place integr algorithm move forward version element would allow call do_forc subset topolog would desir pave way toward multipl time step integr within modular simul allow integr slower degre freedom differ frequenc faster degre freedom constraintel constraint element implement two case constrain posit veloc veloc chang constraint implement replac legaci constrain_coordin constrain_veloc call updateh element implement isimulatorel interfac use new data manag propag propag element templat cover differ propag type use current implement md scheme combin templat static function innermost oper static function allow perform compar fuse updat element keep easili reorder singl instruct current templat implement cover four case positionsonli move posit vector given time step velocitiesonli move veloc vector given time step leapfrog manual fusion previou two propag velocityverletpositionsandveloc manual fusion velocitiesonli positionsonli velocitiesonli propag half time step positionsonli propag also allow implement temperatur pressur coupl scheme offer templat scale veloc order link temperatur pressur coupl object propag propag object tag strong type propagatortag temperatur pressur coupl object connect match propag compar target tag differ propag give propag tag inform temperatur pressur coupl algorithm propag connect respons simul algorithm builder compositesimulatorel composit simul element take list element implement isimulatorel interfac make group element effect behav one simplifi build algorithm vrescalethermostat vrescalethermostat implement vrescal thermostat take callback propag updat veloc scale factor accord vrescal thermostat formal parrinellorahmanbarostat parrinellorahmanbarostat implement parrinellorahman barostat integr parrinellorahman box veloc equat take callback propag updat veloc scale factor scale box posit system statepropagatordatael statepropagatordatael take part simul run might save valid state right moment integr place statepropagatordata correctli duti simul builder might autom later enough metadata variabl ie statepropagatordata know time variabl current decid valid state fulltim step variabl reach statepropagatordatael also client trajectori signal writer save state later writeout simul step know trajectori write occur later step know write file given file pointer trajectoryel energydatael energydatael take part simul run either ad data energi calcul step record noncalcul step step respons simul builder ensur energydatael call point simul run access valid energi state subscrib trajectori signal energi signal log signal know energi calcul need nonrecord step enough energydata element also subscrib trajectori writer element respons write energi data trajectori freeenergyperturbationdatael freeenergyperturbationdatael member class freeenergyperturbationdata updat lambda valu simul run lambda nonstat implement checkpoint client interfac save current state freeenergyperturbationdata restart data structur statepropagatordata statepropagatordata contain littl pure statisticalphys micro state name posit veloc forc box matrix well backup posit box last time step take part simul loop abl backup posit box save current state need main purpos offer access data via getter method element read write data need pointer statepropagatordata need request data explicitli later simplifi understand data depend element note statepropagatordata convert legaci t_state object use deal function yet adapt use new data approach element current implement domain decomposit pme load balanc initi constrain use energydata energydata own energyobject henc respons save energi data write trajectori energydata offer interfac add virial contribut also allow access raw pointer tensor data dipol vector legaci energi data structur freeenergyperturbationdata freeenergyperturbationdata hold lambda vector current fep state offer access valu via getter function simul algorithm builder element defin integr algorithm ie ad use templat modularsimulatoralgorithmbuilderadd method need implement getelementpointerimpl factori function give access data structur infrastructur also allow element accept addit argument eg frequenc offset templatetypenam element typenam arg void modularsimulatoralgorithmbuilderaddarg arg get element factori method auto element static_castelementgetelementpointerel legacysimulatordata_ elementadditionhelper_ statepropagatordata_get energydata_get freeenergyperturbationdata_get globalcommunicationhelper_ stdforwardargsarg make sure return element pointer own ensur make sure control life time elementexistsel throw elementnotfounderrortri append nonexist element call list regist element infrastructur note getelementpointerel call elementgetelementpointerimpl need implement differ element data manag modular simul encourag design local data much possibl also offer access gener use data structur current state energi allow gener data share element simul algorithm builder also allow store object life time guarante either equal simul algorithm builder equal simul algorithm object ie longer life time element infrastructur domdechelp pmeloadbalancehelp infrastructur element respons domain decomposit pme load balanc respect encapsul function call import perform outsid scope effort reli legaci data structur state topolog domdec element implement isimulatorel interfac simul call explicitli task queue popul step allow element receiv new topolog state decid function need run checkpoint checkpointhelp respons write checkpoint offer client access data read checkpoint write checkpoint done neighborsearch ns step last step checkpoint occur period default everi minut need two ns step take effect first ns step checkpoint helper master rank signal rank checkpoint occur next ns step checkpoint written last step checkpoint happen immedi step signal abl react last step signal checkpointhelp also implement isimulatorel interfac regist function last step call checkpoint happen top simul step give straightforward reentri point top simul loop implement detail older approach legaci checkpoint approach data checkpoint need store one follow data structur t_state also hold pointer history_t histori restraint df_history_t histori free energi ekinst awhhistori observablehistori consist energyhistory_t pullhistori edsamhistory_t swaphistory_t checkpoint save detail output file use data structur serial function knowledg implement detail one possibl add data checkpoint expand one object current checkpoint edit respect do_cpt_xxx function checkpointcpp interact xdr librari altern would write entir new data structur chang function signatur checkpointrel function write correspond lowlevel routin interact xdr librari mdmodul approach allow modul write checkpoint legaci checkpoint extend kvtree write checkpoint tree get fill via callback singl modul serial read kvtree get deseri distribut modul read back data previous store modular simul design mdmodul check almost requir modular checkpoint format propos design therefor evolv form approach notabl two improv includ hide implement detail data structur hold data current kvtree client allow chang implement detail read write checkpoint without touch client code offer unifi way read write data allow client write one templat function read write checkpoint allow elimin code duplic danger read write function get sync modular simul checkpoint current chang way legaci simul checkpoint data structur involv legaci checkpoint howev get implement new approach need modularsimul checkpoint also give glimps implement legaci data structur would look like import design part checkpointdata class expos method read write scalar valu arrayref tensor also allow creat subobject type checkpointdata allow complex member implement checkpoint routin without awar member method templat chosen oper checkpointdataoperationread checkpointdataoperationwrit allow client use code read write checkpoint type trait const use catch mani error possibl compil time checkpointdata use kvtree store data intern howev never expos client abstract layer give freedom chang intern implement futur checkpointdata object own readcheckpointdatahold writecheckpointdatahold holder class intern kvtree offer deserializeiseri serializeiseri function respect allow read write file separ clearli defin ownership separ interfac aim file io interfac aim object read write checkpoint checkpoint modular simul tie gener checkpoint facil pass readcheckpointdatahold writecheckpointdatahold object legaci checkpoint read write oper note modular simul checkpoint design distinct data client design requir separ client independ subcheckpointdata object identifi uniqu key key thing need uniqu client ie client free use key _within_ subcheckpointdata without danger overwrit data use client version design reli client keep version system within subcheckpointdata object data store client opaqu top level checkpoint facil way know intern chang fundament chang checkpoint architectur still track toplevel checkpoint version key exist current upload design allow check whether key present checkpointdata could introduc need howev client write selfconsist read write code never need check key exist seem rather lazi way circumv version therefor discourag callback method modular simul mdmodul dont use exact way commun client two method could unifi need _fundamental_ differ modular simul client need identifi uniqu key receiv dedic subdata mdmodul read write kvtree mdmodul could adapt either requir uniqu key modul use checkpointdata modul use singl uniqu key someth like mdmodul regist object global checkpoint perform one major differ new approach legaci checkpoint data get _copied_ checkpointdata legaci approach took pointer data serial slightli reduc perform thought default checkpoint happen start simul read checkpoint everi minut simul run end simul run make low prioriti target optim consequ much thought put optim there certainli way improv thing consid necessari copi measur effect larg data get checkpoint like save posit veloc entir state first target optim need copi data could advantag move forward could continu simul soon data written checkpointdata object dont necessarili need wait write physic medium happen also simplifi move point checkpoint perform within integr one could envis client store data time integr step serial result checkpointdata step avoid need find singl point within loop client need state suitabl checkpoint howev want use approach frequent henc perfom critic oper savingrestor state mc type algorithm swap state run simul multisim type set perform would becom issu iseri vs kvtree new approach use kv tree intern kv tree well suit repres design philosophi approach checkpoint offer function allow client writeread data want data remain opaqu checkpoint element client read write order futur mayb even simultan data written element protect access element avoid bug downsid kv tree data get copi get written file see replac kv tree singl iseri object get pass client would requir element read write sequenti prescrib order help inmemoryseri kvtree could like emul subobject serial memori parent object serial memori file doesnt present clear advantag anymor topologyhold topolog object own local topolog hold constant refer global topolog own isimul local topolog infrequ chang domain decomposit never otherwis topolog holder therefor offer element regist itopologyholdercli get handl updat local topolog whenev chang reli handl valid next updat domain decomposit element defin friend class abl updat local topolog need refer temperatur manag simul techniqu simul anneal simul temper need abl chang refer temperatur simul refer temperatur manag allow element regist callback inform refer temperatur chang perform action need upon chang refer temperatur updat local valu scale veloc recalcul temperatur coupl integr chang temperatur client also inform algorithm chang temperatur requir compat legaci implement differ algorithm react differ refer temperatur chang differ sourc current implement attempt fix inconsist rather make choic legaci implement explicit allow tackl issu easili move forward summari need setchang polici impact polici replac work everi polici mean one thing peopl need read polici everi singl question someth absolut requir polici warrant entir team involv spend time discuss definit handl common sens polici worth ad thing new develop must obey get ask chang futur merg request polici issu rare discuss small number gener meet open multipl polici issu short timefram way gather feedback work need often becom timeconsum issu busi would happen dont dont chang polici polici describ never one place keep uptod take respons document polici way clearli understand new develop label polici followup descript describ actual followup dev unlik priorit issu understood without go read older discuss first origin author agre followup address short term ye assign pleas resolv discuss origin thread instead postpon conflict nobodi work followup issu impact someth must done includ priorit rather one million thing could done wont priorit practic avoid creat followup issu neither origin author work contributor apart origin author els contribut timefram complet assign suitabl mileston near futur experi say followup schedul sever year futur mileston wont see action better creat rather somebodi els close month due inact label followup summari short sweet descript greater concept cover mani differ subissuesfeatur make sure clear understand develop one alreadi work featur use case describ gener conceptfeatur make differec user point view develop impact user would matter like larg impact rel amount work requir detail descript describ concept detail relat umbrella issu avoid creat multipl umbrella issu close relat area make sure develop work part code abl understand concept even top abbrevi creat detail bullet list thing need done link issu make sure stay uptod respons develop umbrella issu must develop assign respons keep updat time plan timefram work expect happen sinc umbrella issu usual longerliv expect updat text develop understand umbrella issu make progress bullet list great linksreferencesimplement link paper nice addit detail descript unlik develop time eg go read paper didnt time describ featur detail would will write implement label umbrellaissu summari would use use case enhanc make differ user rather develop impact matter like larg impact rel amount work requir develop someth expect priorit higher mani thing could done code simplifyremov code rather add code avoid ad gener nicetohav featur unless plan work immedi timefram detail descript pleas describ enhanc detail avoid mere link extern descript develop unlik find time read extern descript person propos enhanc didnt time describ label enhanc summari summar bug encount concis gromac version past output gmx quiet version select relev version year enough find dropdown label list support current stabl releas typic current year also fix bug directcrit relev scientif result verystablereleas typic last year releas bug appear version older version code modifi pleas confirm reproduc current support version code first step reproduc pleas describ reproduc bug share file need ideal tpr file raw gromdptop file need regener bug appear run hour gpu unfortun tend get lot attent typic get much faster attent abl narrow smallest possibl input command line system size etc current bug behavior actual happen expect correct behavior see instead pleas includ least top gromac log file well end info possibl crash file contain lot inform hardwar softwar version librari compil help us debug possibl fix suggest thought welcom link line code might respons problem label bug summari would use use case describ featur make differec user point view develop impact user would matter like larg impact rel amount work requir detail descript describ featur detail eg new algorithm develop lot peopl cite paper implement avail go beyond current state code requir stuff need linksreferencesimplement link paper nice addit detail descript unlik develop time eg go read paper didnt time describ featur detail would will write implement label featur python packag sourc directori exist stage area support gromac enhanc httpsgitlabcomgromacsgromacsissu attempt updat gmxapi effort gromac merg extern repositori httpsgithubcomkassonlabgmxapi httpsgithubcomkassonlabsample_restraint build new function propos httpsgithubcomkassonlabgmxapiscript repositori organ todo test infrastructur project manag convent allow fulli integr develop todo consid long term home directori content gmxapi python framework gmxapi highlevel interfac src directori provid file copi gromac instal locat user may instal python packag allow c extens modul built userchosen gromac instal python interpret like differ use system administr instal gromac build instal python packag first instal gromac pathtogromac instal packag python virtualenv sourc pathtogromacsbingmxrc python venv homesomevirtualenv sourc homesomevirtualenvbinactiv cd src pip instal r requirementstxt pip instal python c import gmxapi gmx use pytest run unit test integr test pip instal r requirementstesttxt pytest srctest pytest test addit discuss packag distribut see httpsgitlabcomgromacsgromacsissu sampl md extens code sample_restraint subtre contain complet cmake project build pluggabl gromac md extens execut gmxapi includ version sampl code subproject live httpsgithubcomkassonlabsample_restraint support gromac gromac repositori becom upstream sourc sampl code gromac releas higher refer readmemdsample_restraintreadmemd python_packagingsample_restraint inform use plugin base sampl restraint need build instal gmxapi python packag todo cookiecutt repo easi fork docker travisci test todo migrat jenkinsbas ci docker infrastructur becom avail infastructur describ transit reflect need abl see code work order review satisfactorili period gromac ci infrastructur readi load point docker aspect chang remov appropri python packag test jenkin dockerbas ci infrastructur littl way mean time tri submit chang affect main line gromac develop build perform test docker extern user may build run docker imag python_packagingdock directori kassonlab travisci account automat build run dockerbas test outstand featur branch dockerfil direct differ linux python gromac configur build instal gmxapi sample_restraint packag provid style test script access entrypointsh success build stage travisci direct use seri docker imag refer dockerhub repositori explan tag dockerfil built imag name scheme encod build matrix element repositori name git branch refer imag tag describ addit inform python_packagingdockerreadmemd gmxapigromacsdependenciesmatrixtag ubuntu distribut depend variou gromac build configur matrix encod build matrix dimens thing like compil mpi flavor travisci rebuild commit kassonlabfork matrix string chang privileg dockerhub account push new repositori first time grant access servic account use travisci configur tag short git revis hash master branch commit correspond current state kassonlabfork branch gmxapigromacsmatrixtag build gromacsdependenciesmatrix matrix mean tag short git revis hash master branch commit correspond current state kassonlabfork branch record kassonlabfork travisyml gmxapicimatrixtag start gromacsmatrix merg python_packag chang associ featur branch indic tag hint fork point master current git ref set environ variabl forkpointgit show prettyformath git mergebas master head refgit show prettyformath extern project code refer srcexternalreadmemd current detail copi extern sourc pybind python bind express c use pybindhttpspybindreadthedocsioenst templat librari pybind repositori mirror gromac project sourc instal gromac conveni reproduc build instal cross compil system gromac built instal differ architectur system python packag compil need use cmake toolchain support crosscompil target architectur offlin instal pip instal option noindex findlink allow offlin stash packag archiv satisfi depend new virtualenv requir network access lengthi build time depend os x depend notabl python instal may requir fiddl xcode sdk httpsdeveloperapplecomdocumentationxcode_release_notesxcode__release_not test gmxapi python packag distribut gromac requir python test use unittest standard librari modul unittestmock submodul includ python addit pytest packag allow test written easili concis easier test fixtur decor log handl output handl file python file begin test_ collect python test framework automat test discoveri conftestpi pytestini provid configur pytest usag basic test instal python packag presum virtualenv use pytest execut run test instal packag pytest local_repo_dirpython_packagingsrctest local_repo_dir path local copi gromac sourc repositori multiprocess test run mpi execut wrapper mpipi modul mpiexec n python mpipi pytest local_repo_dirpython_packagingtest control output refer pytest document command line option control type detail output high level overview basic task onlin httpsdocspytestorgenusagehtml run pytest h termin get complet set avail option particular note log_cli log_level sampl md restraint plugin repositoryhttpsgithubcomkassonlabsample_restraint provid complet work implement gromac restraint potenti intend tutori templat implement new custom restraint potenti restraint potenti implement plugin gromac gromac must configur gmxapionhttpmanualgromacsorgcurrentinstallguideindexhtmlgmxapiexternalapi plugin potenti load configur via python compat gmxapihttpsgithubcomkassonlabgmxapi python packag md simul workflow quick start consid pull recent docker imag alreadi configur gmxapi plugin todo check updat ref github issu httpsgithubcomkassonlabgmxapiissu refer irrgang e hay j kasson p gmxapi highlevel interfac advanc control extens molecular dynam simul bioinformat doi bioinformaticsbtyhttpsdoiorgbioinformaticsbti repositori content repositori use cmake build instal python c extens packag cmakeliststxt cmakefindgromacscmak srccmakeliststxt provid necessari cmake infrastructur need edit srccpp contain header cpp file restraint potenti built modul ad new potenti updat cmakeliststxt creat build target use exist potenti exampl srcpythonmodul contain cmakeliststxt export_pluginh export_plugincpp written new potenti add cmakeliststxt export_plugincpp code produc c extens python ensemblepotenti appli restrain ensembl potenti use addit facil provid gmxapi strikesrcpybind copi python bind framework pybind project ref httpsgithubcompybindpybind use wrap c restraint code give python interfacestrik note pybind current retriev configur cmake ref issu httpsgitlabcomgromacsgromacsissu httpsgitlabcomgromacsgromacsissu test contain c python test provid code updat cmakeliststxt add base exampl c unit test use googletesthttpsgithubcomgooglegoogletest python test use pytesthttpsdocspytestorgenlatest refer respect project make testwrit easier note googletest current download configur cmake ref httpsgitlabcomgromacsgromacsissu exampl contain sampl slurm job script restrainedensemblepi gmxapi script use restrain ensembl simul examplepi exampleipynb explor toy alanin dipeptid system strip_notebookpi helper script remov extra output state data ipython notebook check updat back repositori dockerfil recip build docker imag root repositori todo check updat ref github issu httpsgithubcomkassonlabgmxapiissu docker quickstart todo check updat ref github issu httpsgithubcomkassonlabgmxapiissu pull docker imag launch contain port host map port contain docker run rm ti p gmxapisample_restraintdevel note rm option tell docker save chang make launch contain howev download chang make notebook web interfac refer docker documentationhttpsdocsdockercom option manag contain see someth like follow differ token url open url browser host machin access notebook server brows sample_restraint exampl launch exampl notebook interact walkthrough exampl output execut command jupyt notebook notebookapp write notebook server cooki secret homejovyanlocalsharejupyterruntimenotebook_cookie_secret w notebookapp warn notebook server listen ip address use encrypt recommend notebookapp jupyterlab alpha preview extens load optcondalibpythonsitepackagesjupyterlab notebookapp serv notebook local directori homejovyan notebookapp activ kernel notebookapp jupyt notebook run notebookapp httpall ip address systemtokendeafaddcbfccfac notebookapp use controlc stop server shut kernel twice skip confirm c notebookapp copypast url browser connect first time login token httplocalhosttokendeafaddcbfccfac basic repositori provid potenti use plugin also serv document exampl templat develop gromac extens code gmxapi framework build instal download build instal may need first instal wget git andor cmake plugin requir libgmxapi build see gmxapihttpmanualgromacsorgcurrentinstallguideindexhtmlgmxapiexternalapi download offici releas httpwwwgromacsorg latest gmxapi develop branch httpsgithubcomkassonlabgmxapi use cmake configur build c librari python modul interact instal gromac either sourc gmxrc file provid gromac instal set gmxapi_root cmake variabl gromac instal path gromac instal provid addit cmake infrastructur help us build compat client softwar help set correct compil specifi cmake hint file eg c usrlocalgromacssharecmakegromacsgromacshintscmak gromac instal usrlocalgromac todo link gromac doc toolchain file recommend instal use code python virtual environ see document gmxapi distribut httpgmxapireadthedocsioenlatestinstallhtml accordingli choos instal plugin rather use build directori consid whether want set pythonpath environ variabl instal python find explicitli set instal locat set dgmxplugin_install_pathpathtoinstalldirectori let cmake determin appropri locat automat python interpret administr privileg run desktop comput use python virtual environ recommend dont need specifi anyth addit unprivileg user share machin python virtual environ set dgmxplugin_user_installon instal user python packag directori home directori equival user option pip multipl python instal want unambigu provid cmake python interpret wish use use gmxapi dpython_executablepathtopython root directori gromac sourc sample_restraint sourc code python_packagingsample_restraint cd python_packagingsample_restraint mkdir build cd build get gromac environ set sourc homegromacsbingmxrc configur build environ cmake cmake cmake dgmxplugin_install_pathpathtoinstalldirectori cmake dgmxplugin_user_installon dpython_executablewhich python build myplugin make build run c test make test make test option instal make instal choos instal plugin modul tell python find set pythonpath environ variabl instanc still build directori export pythonpathpwdsrcpythonmodul python gmxapi packag requir test see readmemdreadmemd file parent directori run exampl directori contain sampl script run gmxapi workflow use restraint potenti sampl repositori may also find teststest_bindingpyteststest_bindingpi inform basic walkthrough toy system launch jupyt notebook server navig examplesexamplepi todo script check sinc migrat gromac sourc repositori what go sampl project build sever c object file use build python modul name myplugin set workflow python script provid gmxapi paramet factori function plugin restraint potenti python interfac defin srcpythonmoduleexport_plugincpp session launch c object perform restraint forc calcul creat given gromac librari md step part md forc evalu includ call calcul perform restraint pair restraint demonstr gromac provid rel coordin two atom site calcul code plugin multipl restrain pair need multipl restraint attach simul coordin across ensembl simul possibl use resourc provid session fundament new restraint potenti implement creat class provid calcul method use wrapper give interfac gromac python c wrapper allow basic class implement potenti present gromac librari way use evalu forc simul c templat code wrap potenti portabl way pass gromac python interfac receiv paramet python interpret pybind syntax export_plugincpp provid code actual expos plugin class python modul compat gmx packag provid gmxapi project version addit wrapper boilerpl code migrat file defin calcul method amount copyandpast edit necessari implement new potenti refer srccppharmonicpotentialh srccppharmonicpotentialcpp document exampl simpl pair restraint complex exampl found ensemblepotenti file code srccpp suffici produc testabl object code python modul export srcpythonmoduleexport_plugincpp add addit sourc file new potenti need updat srccppcmakeliststxt well python test pythonlevel test need pytest gmxapi recommend set python virtual environ describ gmxapi instal instruct also need function mpi instal mpipi packag python test run root directori repositori build assum built subdirecori repositori name build pythonpathbuildsrcpythonmodul python pytest test command caus directori name test explor python file name like test_pi _testpi match file import function similarli obviou name run error report particular assert statement evalu perform individu test see also httpsdocspytestorgenlatestgoodpracticeshtmltestdiscoveri test assum packag alreadi instal avail default python path set pythonpath environ variabl run pytest argument discov tri run test elsewher repositori intend fail run full set test ensembl workflow featur first make sure mpicap environ mpipi instal refer httpmpipyreadthedocsioenst httpsgithubcomkassonlabgmxapi inform ensembl test assum rank avail instal plugin run exampl mpiexec n python mpipi pytest todo check updat follow ref github issu httpsgithubcomkassonlabgmxapiissu mpi set system could build docker imag use dockerfil repositori docker build samplerestraint dockerfil docker run cpu rm ti samplerestraint bash c cd homejovyansample_restrainttest mpiexec n python mpipi pytest test prebuilt imag docker hub repositori docker run cpu rm ti gmxapisample_restraint bash c cd homejovyansample_restrainttest mpiexec n python mpipi pytest docker imag directori segreg dockerfil avoid clutter dockerfil help build test gmxapi softwar may subsum supplant futur infrastructur assum alreadi check commit want build assum follow definit forkpointgit show prettyformath git mergebas master head tagfr function requir build note exampl show build tag gmxapi dockerhub namespac dont access remov gmxapi argument use differ dockerhub project space differ dockerfil requir differ build context final path argument gromacsdepend build context doesnt matter use docker directori docker build gmxapigromacsdependenciesmpich f gromacsdependenciesdockerfil option docker tag gmxapigromacsdependenciesmpich gmxapigromacsdependenciesmpichforkpoint rare necessari depend imag probabl pull latest dockerhub gromac build context need root gromac repositori case imag featur branch diverg much becom tightli coupl particular revis master may use tag imag annot gromac build use docker_cor let make use core avail docker engin option includ addit buildarg refforkpoint docker build gmxapigromacsmpich buildarg docker_cor f gromacsdockerfil option docker tag gmxapigromacsmpich gmxapigromacsmpichforkpoint integr test want python_packag subdirectori imag tag accord function intend demonstr docker build gmxapicimpichtag buildarg refforkpoint f cidockerfil run warn rm flag tell docker remov contain process complet prevent unnam contain consum disk space host run altern replac rm name containernam save name copi contain consid use commit snapshot contain refer docker document detail cidockerfil default user imag test gmxapi sample_restraint python packag instal python venv virtual environ own test user entrypointsh script activ python venv wrap command bash exec default command script sourc scriptsrun_pytestsh use script bash etc docker run rm gmxapicimpichtag docker run rm gmxapicimpichtag run_pytest_mpi docker run rm ti gmxapicimpichtag bash venv venv suggest primari instal mode gmxapi python packag import instal mode test script ultim port asyetundefin gromac test infrastructur seem equal plausibl singl imag multipl python instal multipl docker imag singlepython docker imag would use sort python virtualenv system manag nondefault python interpret sinc instal test shell environ postmortem use test user instead root venv provid tidi place work avoid need user flag pip give us conveni place pip freez get known baselin work python environ entri point imag entrypoint script allow contain launch reason default command execut locat contain one script copi script directori parallel one addit script primarili allow easi execut certain suit test see script directori detail debug abl step gdb run someth like follow replac imagenam name docker imag built recip docker run rm ti securityopt seccompunconfin imagenam bash notebookdockerfil built gmxapicimpichlatest imag add notebook entri point use new default command run port map http port easi access jupyt notebook server run docker contain test user home directori docker run rm ti p gmxapinotebook note run rm chang made file contain lost docker run complet preserv work notebook run way download ipynb thejupyt web interfac updat exampl repositori docsdockerfil quick isol document build top gmxapicimpich imag build imag doc dockerfil result imag small web server imag without gromac gmxapi instal html content built copi temporari contain docker run rm p gmxapidoc brows httplocalhost autom todo updat section ci infrastructur evolv travisci build push chain docker imag gmxapi dockerhub organ kassonlab github organ gromacsgmxapi repositori branch descend kassonlabfork branch necessari travisci configur test script script directori conveni run differ suit test specifi argument docker contain base cidockerfil run_flak run flake python lint tool gmxapi packag sourc run_gmxapi_unittest run singlethread test gmxapi python packag run_sample_test run test sample_restraint md plugin api client code run_ful run test run_full_mpi launch rank mpi session variou python test imag httpstravisciorgbeltoforionmuparsersvgbranchmast target httpstravisciorgbeltoforionmupars imag httpsciappveyorcomapiprojectsstatusuujbtuspjxsvgtru target httpsciappveyorcomprojectjschuellermuparserib mupars fast math parser detail descript parser go httpbeltoforiondearticlephpamupars see installtxt instal chang note revis chang remov final keyword parser class sinc api chang broke multipl client applic secur fix follow issu present older releas httpsbugschromiumorgpossfuzzissuesdetailid heapbufferoverflow api abi complianc check version version extend exist enumer new error code ad mupars base class protect function implement basic mathemat oper sinco sqrttan remov binari interfac compat version unless parser use way forse check complianc sampl applic compil exchang librari new version see problem find complet abi complianc report httpswwwbeltoforiondeenmuparsercompat_reports_to_compat_reporthtml recommend replac exist version version pleas report incompat find api abi tri fix final releas reason chang note revis chang prereleas exist version replac chang note revis version bring fix pars bulk mode enabl openmp default thu allow parallel express evalu also fix rang issu report ossfuz httpsgithubcomgoogleossfuzz chang use openmp default set cmake base build ad optim trivial express express rpn length introduc maximum length express charact introduc maximum length identifi charact remov mup_math_except macro relat function c except divid zero sqrt neg number longer support remov parserstackh replac stdstack remov macro defin e pi mup_assert macro longer remov releas build better protect segment fault secur fix fix sever issu report ossfuzz issu present older releas result segment fault httpsbugschromiumorgpossfuzzissuesdetailid httpsbugschromiumorgpossfuzzissuesdetailid httpsbugschromiumorgpossfuzzissuesdetailid httpsbugschromiumorgpossfuzzissuesdetailid ad addit runtim check releas build prevent segment fault invalid express bugfix fix issu bulk mode could hang gccclang build due openmp chunksiz drop welcom gromac document todo consolid least materi document link new user guid along httpwwwgromacsorgdocumentationcutoff_schem httpwwwgromacsorgdocumentationacceleration_and_parallel httpwwwgromacsorgdocumentationperformance_checklist html complet document also avail printabl pdf here_ document version gromac found httpmanualgromacsorgdocument toctre maxdepth download releasenotesindex installguideindex userguideindex howtoindex referencemanualindex gmxapiindex nblibindex devmanualindex indic tabl refgenindex latex releas note found onlin httpmanualgromacsorgcurrentreleasenotesindexhtml toctre maxdepth download installguideindex userguideindex howtoindex referencemanualindex gmxapiindex nblibindex devmanualindex _printabl pdf gmxmanual_ _download download gmx_manual_doi_str gmx_source_doi_str sourc code gmxsourcepackageftp gmxsourcepackagehttp mdsum source_mdsum sourc code version may found web site httpwwwgromacsorgdownloads_ regress test gmxregressiontestspackag mdsum regressiontest_mdsum _doxygenmoduletestutil doxygenhtmllibgroup__module__testutilsxhtml _doxygenpagemodulegraph doxygenhtmllibpage_modulegraphxhtml _doxygenpagerefdata doxygenhtmllibpage_refdataxhtml _doxygenpagewrapperbinari doxygenhtmllibpage_wrapperbinaryxhtml _styleguidelin style guidelin differ style guidelin avail respect section page toctre maxdepth format includestyl name languagefeatur reportstyl commitstyl errorhandl docformat guidelin indent code format docincludestyl guidelin includ style order path use etc docnam name convent file variou code construct doclanguagefeatur allow languag featur docerrorhandl handl error run time refdevdoxygenguidelin guidelin use doxygen document sourc code current section page gener doxygen usag docreportstyl guidelin prepar format bug report doccommitstyl guidelin format git commit send propos fix code review todo add guidelin codebas overview root directori gromac repositori contain filecmakeliststxt root file cmake build system file support build system standard inform file filereadm etc fileinstal gener sourc packag filedocsinstallguideindexrst content follow toplevel directori fileadmin contain variou script develop use well configur file script tool use filecmak contain code fragment find modul cmake content copi andor adapt newer version cmake minimum current support default suppress file valgrind also includ see docbuildsystem detail build system filedoc contain build system logic sourc code document userfac developerfac document gener sourc code filesrc see refdevdoclayout directori also contain develop script use doxygen document oper filescript contain templat filegmxrc script instal script well instal rule script fileshar contain data file instal fileshar includ templat write c analysi tool data file use gromac filesrc contain sourc code see refdevsourcelayout filetest contain build system logic highlevel test current regress test build system logic test filesrc _devsourcelayout sourc code organ follow figur show highlevel view compon get built sourc code filesrc code organ arrow indic direct depend build system describ detail docbuildsystem default option green white compon built part default target gray part test default built part test target gmx_developer_build includ default build target see doctestutil detail test side digraph dev_high_level_compon concentr ye node shapebox stylefil width subgraph rank extern labelexternalsnsrcextern groupcommon styleround gtest labelgoogl test mocknsrcexternalgoogletest grouptest styleroundedfil fillcolor subgraph rank libgromac labellibgromacsnsrcgromac groupgmx fillcolor testutil labeltestutilsnsrctestutil grouptest styleroundedfil fillcolor subgraph rank gmx labelgmxnsrcprogram groupgmx fillcolor test labeltest binariesnsrctest grouptest styleroundedfil fillcolor templat labelanalysi templatensharetempl groupcommon fillcolor gmx templat styleinvi constraintno libgromac extern gmx libgromac testutil extern testutil gtest testutil libgromac test gtest test libgromac test testutil templat libgromac sourc code except analysi templat filesrc directori file relat build system includ root level actual code subdirectori filesrcgromac code directori built singl librari filelibgromac instal header also locat hierarchi main part code organ subdirectori modul see detail filesrcprogram gromac execut gmx built code directori also found driver code mdrun modul call gmx whole gmx view visual modul numer endtoend test gmx mdrun filesrctest variou subdirectori filesrc contain subdirectori name filetest code directori built test binari directori also provid share test code object librari link multipl test binari differ folder see doctestutil detail filesrctestutil contain share util code write googl test test see doctestutil detail filesrcextern contain bundl sourc code variou librari compon gromac use intern code directori built use custom build rule filelibgromac case test binari cmake option chang part code includ build see docbuildsystem explan code directori use filesrcexternalbuildfftw folder contain build system code download build fftw includ filelibgromac compil includ search path set filesrc directori filesrcextern may also includ depend compil option organ filesrcgromac filelibgromac librari built code filesrcgromac toplevel directori contain build instal rule librari dfnpublic api conveni header conveni header provid main instal header code use contain declar includ suitabl set header subdirectori typic also contain highlevel doxygen document subdirectori name filemoduleh correspond filemodul code organ subdirectori subdirectori denot dfnmodul throughout document modul consist set routin welldefin task collect task instal header subset header filesrcgromac instal correspond hierarchi fileincludegromac instal directori comment top header file contain note visibl public instal intralibrari use insid librari intramoduleintrafil header compil instal header without refer variabl defin configh requir header includ instal header allow includ configh cyclic includ depend prevent must avoid best guarante includ everi header sourc file first header even configh code insid librari unnecessarili includ header particular header includ header forward declar type enough header within librari sourc file includ header modul necessari file use public api header realli requir everyth declar see docnam common name pattern file help locat declar test data requir filetest subdirectori modul directori see doctestutil detail _devdoclayout document organ document includ develop guid produc sourc file filedoc except commandlin help gener sourc code execut compil filegmx binari build system provid variou custom target build document see docbuildsystem detail filedocsfrag contain restructuredtext fragment use includ mechan variou place document user document filedocsinstallguid contain restructuredtext sourc file build instal guid section user document well fileinstal file sourc packag build rule filedocscmakeliststxt filedocsreferencemanu contain restructuredtext sourc file gener refer manual html latex filedocsmanu contain latex helper file build refer pdf manual filedocsuserguid contain restructuredtext sourc file use build user guid section user document build rule filedocscmakeliststxt filedocshowto contain restructuredtext sourc file build howto section user focus document unix man page man page program gener run filegmx execut compil use sphinx restructuredtext file filegmx write build rule man page filedocscmakeliststxt develop guid filedocsdevmanu contain restructuredtext sourc file use build develop guid build rule filedocscmakeliststxt organ develop guid explain reffront page guid dev guid doxygen document filedocsdoxygen contain build rule overview content doxygen document see docdoxygen detail doxygen document built organ todo creat separ page front develop guid andor main indexrst describ document reader perspect move relev content contain overview document organ sourc tree doxygen document made differ part use list guidelin look particular kind content sinc document written long period time approach evolv document yet follow guidelin aim document page contain mainli overview content generallevel introduct explan particular area individu modul gener place start familiar code new area code reach link main page also crosslink place document inform relev understand context modul document contain mainli techic content explain gener implement particular modul list class function etc modul complement page describ concept reach modul tab also individu class function etc make modul class document document usag individu class case close relat class necessari time allow broader overview given separ page andor modul document method document document individu method typic class document overview content place look differ method interact file namespac document gener placehold link contain much els main content list class entiti declar file _error handl error handl make gromac behav like proper librari need handl error consist predict way section user refer end user gromac whether via commandlin tool workflow call public api differ type error handl reflect section work progress particularli broader c commun long way consensu area brief summari method use detail rule rational written short reason exist code unabl job reason check compiletim use static_assert reason normal context express type use eg return stdoption document normal reason intern invari precondit violat eg unexpect null pointer pass hot code path use gmx_assert otherwis reason intern invari precondit violat use gmx_release_assert otherwis typic error return system call gpu sdk bad user input use gmx_throw guid principl gromac adopt approach achiev consensu elsewher eg c core guidelin httpisocppgithubiocppcoreguidelinescppcoreguidelines_ particular guid section error handl httpsisocppgithubiocppcoreguidelinescppcoreguidelinesserrors_ librari print anyth stdiostderr unless part api specif even way user suppress redirect output librari normal termin program without user control design interfac function class modul librari valu pass run time valid pass const refer not_nul pointer rather raw pointer return object possibl use eg class enum type pass valu consid enum templat paramet rather pass runtim valu refactor exist interfac improv aspect start new work area check user input api boundari establish invari soon possibl eg express user choic type system form precondit error handl reli use assert valid invari precondit valu use differ techniqu check violat order make reason check clear maintain specif rule use static_assert wherev possibl detect error compil time throw except indic function cant assign task per c core guidelin e httpsisocppgithubiocppcoreguidelinescppcoreguidelinesrethrow_ particular constructor throw construct valid object per c core guidelin c httpsisocppgithubiocppcoreguidelinescppcoreguidelinesreinvariant_ howev recogn case underli reason compon set correct precondit case handl assert see api boundari assign task code valid input code express failur valid throw mani program error violat precondit function languag support contract best done check assert note one compon respons valid particular input user compon reli upon valid precondit assert use gmx_release_assert default macro run check build configur includ releas assert case code call inner loop eg md step gmx_assert use macro run check ndebug defin includ relwithassert build configur default build type use ci appropri provid check uncheck interfac stdvector oper respect note even latter check build eg libstdc right configur call lowlevel api includ c c standard librari gpu sdk alway check successfailur gener correct thing upon failur throw perhap includ descript string obtain error code anoth api call catch except lowerlevel compon memori file system io error gener guidelin incorrect user input produc untrap except result execut termin tell user except occur instead catch except earlier stack frame make suitabl decis diagnost messag decid whether execut termin scope code make decis termin global list possibl except apilegacyincludegromacsutilityexceptionsh librari throw one fail possibl provid detail descript reason failur type except extend current includ memori eg stdbad_alloc file io error eg found invalid user input could understood inconsist user input pars correctli intern conflict simul instabl invalid api callvalueintern error assert might also use case intern modul call code except safe use except error handl avoid propag caller code avoid use except propag error across region start join thread openmp sinc openmp make guarante whether except caught program crash current catch except leav openmp thread region throw except make sure caught handl appropri threadopenmp section avoid use except propag error within region nonblock api call eg mpi gpu sdk made possibl advantag catch higher level continu execut absent partner api call may left block also case librari routin want report warn nonfat error still abl continu process case tri collect issu report report similar grompp note warn error instead return first error irrit user fix report error keep get new error messag everi time rerun program function fail part normal oper howev noth consid normal oper function access data typic also callabl data avail still return normal mean failur normal ok rather throw except error handl gmx_fatal gmx_warn gmx_incon gmx_comm etc deprec gener refactor throw assert accord guidelin current attempt made check error state mpi rank simul provid coordin recoveri howev setup code check routin use gmx_release_assert gmx_assert rather assert ensur nonimmedi string use describ problem error report particularli use troubleshoot issu miss test coverag lead user uncov error code guidelin make work see refimpl except unit test main goal unit test gromac help develop develop code focu test function certain modul group close relat modul design quick execut easi run everi chang check noth broken find build run describ refdevsourcelayout srcgromac divid modul correspond subdirectori avail unit test modul found test subdirectori toplevel modul directori typic test code filefileh modul correspond filetestsfilecpp file correspond test may make sens test individu file isol focu test function expos outsid modul test particular higherlevel modul like integr test test function multipl modul share code use implement test srcexternalgoogletest srctestutil see test built build_testingon default gmx_build_unittestson default cmake modul produc least one separ unit test binari filemoduletest bin execut test modul test execut differ way build test target eg make test run test use ctest includ also regress test cmake told find regress test discuss page test fail print basic summari inform passfail statu test binari regress test class execut fail test binari individu get inform failur note make test rebuild test binari chang sourc code need separ run make make test latter build test binari depend build check target eg make check behav test target extens test binari rebuilt outdat test run test fail output test binari shown unit test andor regress test avail messag print implement make check call ctest via ctest binari run individu test binari finegrain control avail eg filter test name label increas verbos directli execut test binari provid use output diagnos failur allow debug test failur output identifi individu test fail show result fail assert test also add extra inform fail assert make easier identifi reason test skip run number mpi rank gpu devic detect explicit inform case obtain use echoreason flag test binari possibl control test run use command line option execut binari help get addit inform execut use ctest test produc xml output testingtemporari contain result test well failur messag xml use gitlab ci report test statu individu test note test crash fail assert gmx_fatal call xml produc binari ci report anyth test binari actual error visibl consol output unit test framework test written use googl test_ provid framework write unit test compil test binari command line option provid test binari implement googl test see googl test primer_ introduct test also use googl mock_ provid framework creat mock implement c class compon includ sourc tree srcexternalgoogletest compil part unit test build srctestutil contain gromacsspecif share test code includ part cmake macro declar test binari take care provid main method test execut initi part framework test code modul focu actual test part framework need know abl write simpl test use gmx_add_unit_test cmake creat test binari start write actual test right away see srctestutilstestmacroscmak exist cmake code exampl use gener test fixtur helper class c api document doxygen page testutils__ function includ locat test input file sourc directori construct temporari file ad custom command line option test binari custom test assert better except floatingpoint handl util construct command line argument array test fixtur test need test long string correct test execut legaci code stdin read etc easili mock __ doxygenmoduletestutils_ class function support code intern use cmake machineri build set test binari custom googl test suit environ simpl framework build test check result refer data gener test code use easi verifi result code cc code alon manual inspect result manag gener approach document doxygen page use refer data__ __ doxygenpagerefdata_ addit srctestutil modul test directori may provid reusabl test code use higherlevel test exampl srcgromacsanalysisdatatest provid test fixtur mock implement gmxianalysisdatamodul helper class also use srcgromacstrajectoryanalysistest case handl use cmake object librari link test binari need _gmxmakenewtest get start new test start work new test first read googl test_ document get basic understand test framework read descript understand test organ gromac necessari understand detail overal understand help get start write basic test straightforward look exist test exampl exist test vari level complex pointer find test use certain function srcgromacsutilitytestsstringutilcpp contain simpl test function use fanci function plain googl test assert thing requir test test macro block follow plu header requir make compil file contain also simpl test use refer framework check line wrap test gmxtextlinewrapp test fixtur test srctestutilsincludetestutilsstringtesthcpp string test fixtur also demonstr add custom command line option test binari influenc test execut srcgromacsselectiontest contain complex use refer framework code refer framework origin written srcgromacsselectiontestsselectioncollectioncpp main file look complex test use refer framework instead complex verif code look srcgromacsselectiontestsnbsearchcpp complex test mockup class refer framework look srcgromacsanalysisdatatest thing keep mind work unit test tri keep execut time test short possibl cover import path code test gener test take second instead minut run one need hesit run test done chang longrun test go somewher els unit test set note ci run test sever build configur slow test significantli slow pipelin even caus timeout tri produc use messag test assert fail assert messag tell went wrong need run test debugg eg assert within loop loop index relev understand assert fail includ messag even better even user understand goe wrong main audienc messag develop caus test fail _googl test httpcodegooglecompgoogletest _googl test primer httpcodegooglecompgoogletestwikiv__prim _googl mock httpcodegooglecompgooglemock includ fragmentsdoxygenlinksrst mpi test test make specif requir number mpi rank need commun part implement gromacsspecif extens make normallook googletest work well case use gmx_test_mpirankrequir declar test gmx_add_mpi_unit_test teach ctest run test regardless whether build threadmpi real mpi see srctestutilsincludempitesth detail allow languag featur strict rule good reason deviat portabl consider gromac file compil c file remain compil c c lot featur keep sourc code maintain easi read avoid use gromac code basic principl keep thing simpl possibl msvc support subset c workaround requir case abl use virtual c featur outsid opencl kernel compil c consist also cuda kernel c standard librari gromac code must support lowest common denomin c standard librari featur avail support platform modern featur use enough warrant backport consist forwardcompat header provid srcgromacscompat describ librari document doxygenhtmllibgroup__group__compatibilityxhtml_ gener consider baselin gromac follow c core guidelin linkref unless specif guidelin say otherwis tend restrict area depend code compil lot differ c compil want increas readabl howev gromac advanc project constant develop need evolv relax tighten mani point chang happen natur part agreement code review major part dont agre push issu tracker_ thread larg chang suggest earli develop cycl releas avoid hit lastminut compil bug releas use namespac everyth libgromac gmx namespac dont use use header except possibl alias commonlyus name avoid filelevel blanket use namespac gmx similar small number gmx namespac symbol need notyetupd file consid import symbol see also linkref use stl use iostream outsid unit test iostream neg impact perform compar form string stream depend use case also dont alway play well use c stdio routin time use extens current code howev sinc googl test reli iostream use unit test code dont use nonconst refer function paramet make imposs tell whether variabl pass paramet may chang result function call without look prototyp use not_nullt pointer wherev possibl convey semant pointer valid requir refer inappropri see also linkrefnotnul linkrefnotnul use string_view case want use readonlysequ charact instead use const stdstring see also linkrefstringview null termin expect c api eg fopen fput fprintf guarante string_view use case use optionalt type situat exactli one reason clear parti valu type lack valu natur regular valu see linkoptionalboost good exampl includ return type function pars integ valu string search match element rang provid option name residu type use option lazi load resourc eg object default constructor hard construct prefer construct logic requir explan reason regular valu exist eg use optionalt error handl optionalt model object pointer even though oper oper defin linkoptionalcppref dynam memori alloc ever take place forward declar object store optionalt work thu refrain option pass handl contrast unique_ptr option valu semant refer semant dont use cstyle cast use const_cast static_cast reinterpret_cast appropri see point rtti dynamic_cast emphas type eg intent integ divis use constructor syntax creat real constant use userdefin liter _real eg _real instead static_castr use sign integ arithmet includ loop indic use ssize avail free function member arrayref avoid cast avoid overload function unless variant realli thing differ type instead consid make function name descript avoid use default function argument lead code less readabl without see linkref think specif case improv readabl see linkref justifi use dont overload oper thorough consider whether realli best thing never overload comma oper imposs keep origin behavior respect evalu order tri avoid complex templat complex templat special techniqu like sfina much possibl noth els make code difficult understand dont use multipl inherit inherit multipl pure interfac ok long one base class first base class code pleas also refer explan linkref linkref dont write excess deep inherit graph tri inherit implement save bit code follow principl inherit reus reus also mix implement interfac inherit explan pleas see linkref dont includ unnecessari header header file prefer forward declar name type use name header file reduc compil coupl thu time sourc file also use type name eg pass pointer receiv caller calle includ statement need make liber use assert help document intent prefer write code assert necessari prefer gmx_assert gmx_release_assert nake assert former permit add descript text use gmxmutex rather pthread std raw threadmpi mutex use proper enum variabl whose type contain one limit set valu c much better c catch error code ideal enum type enum pleas see linkref write new class think whether necessari make copi class declar copi constructor assign oper privat dont defin make attempt copi object class fail allow copi either provid copi constructor assign oper write clear comment compilergener one make sure want srcgromacsutilityclasshelpersh conveni macro well also use delet function case declar constructor one paramet explicit unless realli know otherwis use implicit type convers make code difficult understand even hide bug would otherwis report compil reason dont declar oper convert class type without thorough consider explan pleas see linkref write constcorrect code const_cast unless absolut necessari avoid use rtti runtim type inform practic dynamic_cast typeid unless realli need cost rtti high binari size alway pay compil execut time pay use problem seem requir rtti think whether would altern design wouldnt altern design often better dont depend compil metadata propag struct element captur lambda paramet tend restrict align qualifi discard compil later defin instanc structur alloc memori hold data member might align plan code run computesensit kernel use data layout reus align simd memori oper recogn part code differ requir comput kernel mdrun setup code highlevel mdloop code simul setup tool analysi tool differ need tradeoff point correct vs review time vs develop time vs compil time vs run time differ linkref replac c guidelin httpisocppgithubiocppcoreguidelinescppcoreguidelines__ linkref replac httpisocppgithubiocppcoreguidelinescppcoreguidelinessfdontwriteusingnamespaceinaheaderfile__ linkref replac httpisocppgithubiocppcoreguidelinescppcoreguidelinesikeepthenumberoffunctionargumentslow__ linkref replac httpsisocppgithubiocppcoreguidelinescppcoreguidelinesfwherethereisachoicepreferdefaultargumentsoveroverloading__ linkref replac httpisocppgithubiocppcoreguidelinescppcoreguidelinescusemultipleinheritancetorepresentmultipledistinctinterfaces__ linkref replac httpisocppgithubiocppcoreguidelinescppcoreguidelinescusemultipleinheritancetorepresenttheunionofimplementationattributes__ linkref replac httpisocppgithubiocppcoreguidelinescppcoreguidelinescwhendesigningaclasshierarchydistinguishbetweenimplementationinheritanceandinterfaceinheritance__ linkref replac httpisocppgithubiocppcoreguidelinescppcoreguidelinesrenumclass__ linkref replac httpisocppgithubiocppcoreguidelinescppcoreguidelinesrcexplicit__ linkrefnotnul replac httpisocppgithubiocppcoreguidelinescppcoreguidelinesrinullptr__ linkrefnotnul replac httpisocppgithubiocppcoreguidelinescppcoreguidelinesrfnullptr__ linkrefstringview replac httpsisocppgithubiocppcoreguidelinescppcoreguidelineshtmlrstrview__ linkoptionalboost replac httpswwwboostorgdoclibsreleaselibsoptional__ linkoptionalbartek replac httpswwwbfilipekcomusingoptionalhtml__ linkoptionalcppref replac cpprefer httpsencppreferencecomwcpputilityoptional__ _implement except implement except error handl see referror handl approach handl runtim error ie use except write exceptionsaf code new code offer least basic nothrow guarante make feasibl use std custom contain wherev possibl use smart pointer memori manag default use stdunique_ptr gmxunique_cptr assoc necessari raw new snew call stdshared_ptr use wherev respons lifetim must share never use malloc use raii manag resourc memori mutex file handl prefer avoid call function might throw except legaci function except safe howev make practic except permit use featur stdvector stdstring could throw stdbad_alloc memori particular gromac lot old cstyle memori handl check tool continu issu valid warn tool acquir function fix old construct ineffici use develop time function method comment whether except safe whether might throw except even indirectli except might throw preprocessor consider dont use preprocessor defin thing directli relat configur build use templat inlin function gener code enum const variabl constant preprocess variabl use configur build organ valid valu alway defin ie never test whether one preprocessor variabl defin rather test valu much robust mainten compil tell variabl undefin avoid code lengthi segment whose compil depend wors ifdef symbol provid outsid gromac prefer organ definit const variabl top sourc code file use code help keep compil path built configur reduc incid silent bug indent nest preprocessor condit nest necessari result look clearer without indent pleas strongli consid comment repeat preprocessor condit end region lengthi region necessari benefit long region greatli help understand debug code sourc tree checker script highlight bash set python script current docsdoxygen check variou aspect sourc tree consist script base produc abstract represent sourc tree variou sourc list file sourc tree overal layout sourc tree list instal header extract gener build system git attribut limit scope check doxygen xml document tag publicpriv natur document header construct actual document construct check consist hardcod knowledg gromac sourc tree layout represent use variou purpos check doxygen document element common mistak miss brief descript mismatch file class visibl etc check consist usag document header eg header document intern modul use outsid modul check modulelevel cyclic depend check consist style order includ direct see docincludestyl actual sort reformat includ direct adher check style gener depend graph modul file within modul check run part singl checksourc target describ separ section addit print issu stderr script also write docsdoxygenchecksourcelog later inspect ci run check part pipelin ci fail issu found correct function script depend correct usag doxygen annot describ docdoxygen particular visibl api definit filelevel comment fals posit script suppress mechan describ easiest way silenc script otherwis goal would minim number suppress script requir python version may work test understand script work intern see comment python sourc file docsdoxygen checker detail checksourc target current check differ type issu list detail mainli relat document includ depend note particular includ depend check much stricter code modulesdirectori document defgroup undocu code assum intern modul rational code gotten attent effort also put defin extern interfac modul document doxygen document current appli member appear document member document brief descript note issu inbodi document function sinc ignor current set class document public document appear instal header class contain file document class document visibl file document file consist usag includ use gromac header includ use system extern header instal header must includ noninstal header header mark instal within cmakeliststxt file respect modul sourc file must includ gmxpreh first header sourcehead file includ configh gromacssimdsimdh gromacsewaldpme_simdh use macro declar file file git attribut identifi candid includ sort includ sorter describ produc chang ie file follow docincludestyl document file instal header public document file api level specifi file higher document visibl exampl publicli document header specifi part public api ingroup module_foo exist match subdirectori file actual part file system defgroup module_foo exist subdirectori file file contain ingroup module_foo file includ file whose document visibl lower includ file document check skip file part document modul defgroup module_foo exist subdirectori explicitli document intern librari api file includ outsid modul undocu document modul specifi part librari public api modul cyclic includ depend modul side effect xml extract make doxygen pars comment code even appear document reveal latent issu comment like invalid doxygen syntax messag xml pars store docsdoxygendoxygenxmllog build tree similar doxygen run suppress issu script current perfect either unfinish implement doxygen bug incomplet doxygen xml output current code also contain issu script detect author fix allow script still use doxygensuppressionstxt contain list issu filter report syntax simpl file text file path file report messag text text report support wildcard file empti suppress match messag associ file file match trail portion file name make work even though script report absolut path empti line line start ignor add suppress issu line report issu copi suppressionstxt line number remov issu file name pseudofil associ lead must ad cover mani similar issu part line replac wildcard _devincludesort includ order sort script check includ order accord docincludestyl obviou includ chang make script happi bulk chang need multipl file eg header renam make previous public header privat possibl run python script sort docsdoxygenincludesorterpi b build file script need know locat sourc tree given build tree given b sort given file sort whole sourc tree one also use adminreformat_allsh includesort bbuild sorter work correctli build tree contain uptod list instal file doxygen xml document former creat automat cmake run latter built use doxygenxml target note current sorter script chang angl bracket quot includ statement includ depend graph set python script also produc includ depend graph addit annot compar eg doxygen produc directori depend graph current modulelevel graph automat built doxygen document built embed document public api document graph togeth legend separ page modul depend graph__ __ doxygenpagemodulegraph_ python script produc graph format suitabl dot graphviz packag lay build system also provid depgraph target gener png file intermedi dot file addit modulelevel graph filelevel graph produc modul show includ depend within modul filelevel graph view png file explan notat current mostli eye candi also use analyz problemat depend clean architectur intermedi dot file final png file put docsdoxygendepgraph build tree file graph graph written filemodule_namedepsdotpng node color light blue public api instal header dark blue librari api header gray sourc file light green test file white file edg signifi includ depend addit inform current includ includ fragmentsdoxygenlinksrst guidelin creat meaning issu report section give start gener use issu gromac issu tracker_ inform come larg extent directli help prepar report report pleas report issu confirm caus gromac behav unintend way investig best abil larg simul fail point tri also trigger problem smaller test case easili debugg bug result use thirdparti softwar investig first make sure fault gromac part toolchain pleas dont submit gener issu result system instabl system refblowingup includ report includ gener descript problem gromac indic expect behaviour actual outcom issu caus program crash report indic crash happen possibl includ stack trace right crash bug includ necessari inform develop reproduc error includ need minim input file tpr top mdp etc run command minim version run script compil gromac possibl system architectur emphasi minim work exampl easi follow develop result warn error exampl gener error issu like consid real minimum much harder analys find actual issu input sensit possibl creat privat issu httpsgitlabcomgromacsgromacsissues_ develop team access solv problem prevent widespread visibl internet support develop gener abl answer question pose develop work program want help fix bug found may includ thing explain run script simul setup well confirm issu differ version program differ combin support librari compil pleas refrain set thing target version decid unreason prioriti decid fix issu pleas adher standard mention relat page refcodeformat refcodecommitstyl seealso doccontribut _issu workflow gener issu workflow gener issu workflow shown figur imag redminestatespng alt sampl procedur pathway report issu project maintain appli statu label httpsgitlabcomgromacsgromacslabelssearchstatus__ issu process statusaccept httpsgitlabcomgromacsgromacsissueslabel_namebdstatusaaaccepted__ bug confirm desir featur statusin progress httpsgitlabcomgromacsgromacsissueslabel_namebdstatusaainprogress__ assigne start work statusblock httpsgitlabcomgromacsgromacsissueslabel_namebdstatusaablocked__ progress requir feedback action statusreject httpsgitlabcomgromacsgromacsissueslabel_namebdstatusaarejected__ invalid report desir featur statusfix upload httpsgitlabcomgromacsgromacsissueslabel_namebdstatusaafixuploaded__ merg request avail review statusfeedbackw httpsgitlabcomgromacsgromacsissueslabel_namebdstatusaafeedbackwanted__ resolut pend addit feedback respons statusresolv httpsgitlabcomgromacsgromacsissueslabel_namebdstatusaaresolved__ issu close discuss text stolen old gromac web page open new issu take minut make easi everybodi els particular develop help way much like get solut problem isol problem far possibl submit huge tpr file sometim fail million step pretti much guarante nobodi go debug upload singl small exampl simul gromac program crash ideal singl small confgro file topoltop gromppmdp make sure input file process without warn gromac version submit bug report dont reli larg extern forc field long script case addit file warn cours complet unrel problem particularli case help other lot take account provid concis report exactli command use reproduc behavour expect got pleas dont set target version unless person work bug set prioriti high user assum mean also priorit provid close instant feedback andor help test develop set prioriti high mean work fix bug word pleas set prioriti high get somebodi els fix faster point might necessari file includ larg script debug problem much like get help develop search file sever differ place read number thread mail list follow long discuss want deciph script understand happen document gener build gromac document multipl compon format tool gromac document aim primarili versionspecif deploy complet document websit releas tarbal quit complex depend build document must get way build code particularli crosscompil yet code must build run order document gener also man page document commandlin complet must built wrapper binari order bundl tarbal help ensur function document remain sync output interest develop gener produc docshtml subdirectori build tree need enabl least follow cmake option gmx_build_manu option need tri build pdf refer manual requir latex imagemagick see cmakegmx_build_manu gmx_build_help option control whether shell complet built automat whether built man page instal avail user still need build man target manual instal see cmakegmx_build_help document built crosscompil requir execut gmx binari follow make target use manual build pdf refer manual man make man page wrapper binari sphinx doxygenal make code document doxygen installguid make instal file tarbal sphinx webpagesphinx make compon gromac webpag requir sphinx includ instal guid user guid webpag make complet gromac webpag requir everyth complet brows docshtmlindexhtml find everyth built releas tarbal source_mdsum source_tarbal regressiontests_mdsum regressiontests_tarbal cmake variabl set pass mdsum valu name tarbal embed final deploy gromac websit need build tool follow tool use build part document doxygen doxygen httpwwwdoxygenorg_ use extract document sourc code comment also overview content laid doxygen markdown sourc file current version expected_doxygen_vers requir warningfre build thorough explan doxygen setup instruct document sourc code found separ page docdoxygen graphviz dot doxygen document use dot graphviz httpwwwgraphvizorg_ build graph tool mandatori doxygen build produc warn avail graph omit document mscgen doxygen document use mscgen httpwwwmcternanmeukmscgen_ build graph dot tool mandatori avail result warn miss graph doxygen issu checker doxygen produc warn incorrect use wrong document mani common mistak detect gromac use addit custom python script check issu easili invok checksourc target build system script also check document header match use sourc code eg header document intern modul actual use outsid modul check run ci detail custom checker separ page common sever checker docgmxtre modul depend graph gromac use custom python script gener annot depend graph code show includ depend modul gener graph embed doxygen document modul depend graph__ script share implement custom checker document page docgmxtre __ doxygenpagemodulegraph_ sphinx sphinx httpsphinxdocorg_ least version expected_sphinx_vers use build part document restructuredtext sourc file latex also requir imagemagick convert graphic file format linkcheck linkcheck httpwummelgithubiolinkchecker__ use togeth filedocslinkcheckerrc file ensur link document resolv correctli document export sourc file man page html document commandlin option execut shell complet gmx binari explicit c code export inform requir build system provid target invok built gmx binari produc document item gener item packag sourc tarbal necessari build sourc distribut sinc gener work crosscompil scenario build instal git distribut explicit action requir see doxygen document wrapper binary__ addit detail __ doxygenpagewrapperbinary_ includ fragmentsdoxygenlinksrst _gmxcodeformat automat sourc code format highlight bash sourc code automat format use clangformat sinc gromac format tool appli guidelin docformat addit python script use automat formattingcheck task overview tool page contain list tool refdevformattingtool page provid detail clangformat clangtidi copyright script ci use script particular clangformatsh copyrightsh clangtidysh checksourc target enforc code stay invari format _gmxclangformat set clangformat gromac format enforc clangformat commandclangformat one core clang tool may includ clang llvm packag favorit packag system may find standalon clangformat packag confirm provid command version exampl clangformat version clangformat version use differ version clangformat like get differ format result gromac continu integr test system commit push fail autom test note refer llvm httpreleasesllvmorgdownloadhtml__ sourc binari download download sourc note need download llvm sourc code clang sourc code per clang installtxt httpsgithubcomllvmllvmprojectblobreleasexclanginstalltxt__ place expand clang sourc filetoolsclang subdirectori within expand llvm archiv run cmake llvm sourc directori todo consid referenc provid binari packag andor checkingmanag execut fileadmin script refer httpsgithubcommongodbmongoblobmasterbuildscriptsclang_formatpi order use instal version clangformat clangformatsh precommit hook also need run gromac repositori git config hooksclangformatpath pathtoclangformat altern want use clangformatsh set clang_format environ variabl pathtoclangformat use precommit hook git filter need addit setup see respect section clangformat discov format rule appli fileclangformat configur file project directori automat updat necessari commandgit pull gromac repositori tool fileclangformat configur file visit httpsreleasesllvmorgtoolsclangdocsclangformathtml automat format identifi file subject automat format script use git filter specifi gitattribut file file attribut filter set one valu process filtercomplete_format perform format use clangformat code format file includ also pass clangtidi code checker filterclangformat clangformat run also run clangtidi filterincludesort includ order enforc copyright header check filtercopyright copyright header check file ignor clangtidysh clangformatsh copyrightsh reformat_allsh script see _gmxclangtidi set clangtidi gromac sourc code tidi check enforc clangtidi provid alongsid clang compil version commandclangtidi one core clang tool may includ clang llvm packag favorit packag system may find standalon clangtidi clangtool packag confirm provid command version exampl clangtidi version llvm httpllvmorg llvm version use differ version clangtidi like get differ check result gromac continu integr test system commit push fail autom test note refer llvm httpsreleasesllvmorgdownloadhtml__ sourc binari download download sourc note need download llvm sourc code clang sourc code per clang installtxt httpsgithubcomllvmllvmprojectblobreleasexclanginstalltxt__ place expand clang sourc filetoolsclang subdirectori within expand llvm archiv run cmake llvm sourc directori order use instal version clangtidi clangtidysh precommit hook also need run gromac repositori git config hooksrunclangtidypath pathtorunclangtidypi altern want use clangtidysh set run_clang_tidi environ variabl pathtorunclangtidypi see section use precommit hook git filter clangtidi discov format rule appli fileclangtidi configur file project directori automat updat necessari commandgit pull gromac repositori tool fileclangtidi configur file visit httpsreleasesllvmorgtoolsclangtoolsextradocsclangtidyindexhtml script copyrightpi script provid lowlevel function check updat copyright header cc sourc file well sever type file like cmake python script file also use loadabl python modul kernel gener provid function gener conform copyright header script rare need run directli instead bash script use intern run script help option want see option provid need mainten copyright header copyrightsh script run copyrightpi modifi file reportsappli result default current head commit sourc branch compar work tree file differ two tree chang outdat copyright header report behavior chang specifi revrev argument use rev instead head base comparison typic use case specifi revhead check head commit specifi copyrightmod alter level copyright check done check copyright header year updat copyright year newformat copyright header add addit year add copyright header file updat addit year add also updat newformat copyright header broken outdat replac replac copyright header newformat copyright header full default updat refus updat dirti file ie differ disk index make easi revert chang overridden ad fforc option clangformatsh script run clangformat modifi file reportsappli result default current head commit sourc branch compar work tree file differ two tree chang clangformat report behavior chang specifi revrev argument use rev instead head base comparison typic use case specifi revhead check head commit specifi action check report file clangformat chang diff print actual diff would chang updat appli chang repositori workdir oper work directori file disk index oper index repositori conveni omit workdirindex suffix workdir assum ie diff equal diffworkdir specifi formatoff run clangformat default updat refus updat dirti file ie differ disk index make easi revert chang overridden ad fforc option sinc behaviour clangformat chang version even use option clangformat clang give correct result path correct clangformat binari specifi via clang_format environ variabl run git config hooksclangformatpath pathtoclangformat repositori root clangtidysh script run clangtidi sourc code checker modifi file either report appli result chang default current head commit sourc branch compar work tree file differ two tree chang appli clangtidi report behavior chang specifi revrev argument use rev instead head base comparison typic use case specifi revhead check head commit specifi action check report file clangformat chang diff print actual diff would chang updat appli chang repositori workdir oper work directori file disk index oper index repositori conveni omit workdirindex suffix workdir assum ie diff equal diffworkdir specifi tidyoff run clangtidi default updat refus updat dirti file ie differ disk index make easi revert chang overridden ad fforc option git precommit hook want run copyrightsh clangtidysh andor clangformatsh automat chang make configur precommit hook use admingitprecommit copi gitprecommit script githooksprecommit specifi path runclangtidi clangformat hook alreadi done git config hooksrunclangtidypath pathtorunclangtidypi git config hooksclangformatpath pathtoclangformat set oper mode hook git config hooksclangtidymod check git config hooksclangformatmod check git config hookscopyrightmod updat configur sourc file modifi commit run code format tool check clangtidi also check correct copyright header file would chang clangtidysh clangformatsh copyrightsh name file report commit prevent issu fix run script manual disabl hook without remov precommit file set git config hooksclangtidymod git config hookscopyrightmod git config hooksclangformatmod disabl temporarili commit set no_format_check environ variabl exampl no_format_check git commit also run git commit noverifi also disabl hook note run git commit amend hook run chang get amend whole commit rebas hook run actual work done adminclangtidysh adminclangformatsh admincopyrightsh script get run checkindex action copyright format get set accord git config set reformat_allsh script run clangformat copyrightpi includ sorter applic file sourc tree see reformat_allsh h invoc script also produc list file command would run specifi listfil command line use filtertyp specifi command get file list use togeth eg xarg run script set file oper also possibl appli patter style variou git command accept ie srccpp match cpp file recurs src pattern specifi patternpattern multipl pattern argument given fforc necessari work tree git index match use git filter altern use precommit hook automat appli uncrustifi clangformat chang use git filter requir either script gitattribut file run git config filterclangformatclean pathtoclangformat configur filter file specifi filtercomplete_format attribut indic format step perform precommit hook manual run script give bettermor intuit control filter possibl work tree differ head still empti git diff provid better perform chang modifi mani file way current also check copyright header filter allow one transpar merg branch run sourc checker appli consist precommit hook run everi commit eg rebas chang manag document assum reader alreadi familiar use git manag file revis content local get start gromac develop happen gitlab httpsgitlabcomgromacsgromac creat user account httpsgitlabcomuserssign_inregisterpan use exist account gitlabcom inform use gitlab look extens user document httpsdocsgitlabcomeeuserindexhtml follow workflow describ httpsdocsgitlabcomeetopicsgitlab_flowhtml alreadi gromac repositori set user git clone gitgitlabcomgromacsgromacsgit obtain current gromac repositori gitlab otherwis use git remot add gitlab gitgitlabcomgromacsgromacsgit use gitlab new code enter gromac merg git develop branch master branch automat detect issu new code test within continu integr ci larg combin set see gmxcodeformat help meet test style guidelin set login credenti gitlab need public ssh key sshkeygen rsa c youremailaddresscom cat sshid_rsapub copi output last command got gitlabcom find user right top corner select set chose ssh key menu left past key text field creat issu metalevel code design discuss organis issu visibl httpsgitlabcomgromacsgromacsissu pleas check issu similar issu alreadi exist creat new one note redmin issu transfer gitlab issu number use gitlab howev comment discuss repres gitlab user acmnpv origin author found inlin bottom comment upload code review creat merg request issu address new code via merg request mr find current mr httpsgitlabcomgromacsgromacsmerge_request two way creat merg request either via gitlab graphic user interfac via command line use gui find relev issu open new one find creat merg request button creat merg request relat issu gitlab default select mark work progress wip mergerequest recommend keep set complet satisfi code test pass select mileston assigne make track progress easier keep requir merg set default also use git push command line directli creat merg request follow link output command line repositori sync gromac repositori ensur use git fetch obtain newest branch merg master branch branch git merg master branch name branch good name documentation_updatedevelopersdocstogitlab nbnxm_makenbnxmgpuintoclass pme_feppmegpu bad name branch mybranch test etc label label httpsdocsgitlabcomeeuserprojectlabelshtml__ help develop allow addit filter issu merg request gromac project defin mani label httpsgitlabcomgromacsgromacslabels__ note label guidelin tbd see httpsgitlabcomgromacsgromacsissu open new issu appropri minim duplic document refer gromac label httpsgitlabcomgromacsgromacslabels__ web interfac label descript creat new label pleas provid short descript peopl understand label intend convey appli issu merg request gener ongo categor help specifi gromac compon develop area use fcd color specif featur subproject area target upcom releas use ead background color statu label use bca note statu label also use issu use accord refstatu label guidelin statu label guidelin best practic label polici propos chang document see httpsgitlabcomgromacsgromacsissu code review review someon els upload code review workflow follow httpsgitlabcomgromacsgromacsmerge_request show open chang chang need two approv go one approv come member either gmx core gmx develop usual patch goe sever cycl vote comment updat becom merg vote develop indic think chang hat progress enough includ chang submit merg postsubmit test click merg review code point polici least two nonauthor approv issu resolv opinion person appli approv merg upload minor fix someon els patch use judgement whether approv guid review first foremost check correct extent possibl portabl perform next import thing check potenti issu check adher refgromac code standard styleguidelin tri ensur commit implement bugfix well import featur task get issu tracker_ entri creat link link done automat special syntax httpsgitlabcomhelpusermarkdownspecialgitlabreferences__ commit bugfix present issu tracker_ contain valid refer issu major bug bug report file issu tracker_ urgent immedi prioriti referenc appropri commit featuretask implement present issu tracker_ contain valid refer issu current issu current present chang would benefit one futur explan ad new issu creat _statu label guidelin updat statu label pleas updat statu label reffor issu issu workflow merg request review pleas updat statu label reffor merg request merg request statu close _merg request statu close merg request merg request updat six month acquir statu label statusstal propos chang still seem import next step unclear contributor stale issu encourag contact exist review potenti review particip develop mail list attend biweekli teleconfer coordin futur merg request becom clear within month especi becom stale multipl time develop may close merg request label indic enter close state statusmr label httpsgitlabcomgromacsgromacslabelssubscribedsearchstatusaamr__ indic merg request review unless explicitli reject see issu background discuss statusmrinact httpsgitlabcomgromacsgromacsmerge_requestslabel_namebdstatusaamraainactive__ respons contributor review avail six month statusmrsupersed httpsgitlabcomgromacsgromacsmerge_requestslabel_namebdstatusaamraasuperseded__ merg request longer necessari statusmrreject httpsgitlabcomgromacsgromacsmerge_requestslabel_namebdstatusaamraarejected__ solut associ issu accept statusmrne discuss httpsgitlabcomgromacsgromacsmerge_requestslabel_namebdstatusaamraaneedsdiscussion__ discuss must take place track issu mr open statusstal httpsgitlabcomgromacsgromacslabelssubscribedsearchstatusaastale__ activ six month seealso refissu workflow use statu label issu manag git tip rubric q use git configur set need work branch larg differ particular lot file move help set git config diffrenamelimit increas limit inexact renam git consid default valu suffici exampl need merg cherrypick releas branch master rubric q use git rebas also git pull rebas assum local featur branch check base master master gotten new commit git rebas master move commit top newest commit master save commit replay top master commit result conflict need resolv usual includ mark resolv use git add use git rebas continu note unless sure use command creat delet commit git commit git checkout git reset without path git rebas continu creat commit conflict resolv origin commit messag get chanc edit realiz conflict messi resolv made mistak result messi conflict use git rebas abort get back state start origin git rebas master invoc rebas alreadi finish realiz made mistak get back start use git log mybranch andor git reflog mybranch check want go git reset hard mybranch rubric q prepar sever commit assum multipl independ chang work tree use git add p file add one independ chang time index use git diff cach check index contain chang want commit one chang git commit want test chang work use temporarili store away chang test git stash test fail amend exist commit git commit amend satisfi push commit review stash away chang want next chang review independ git reset hard head git stash pop push previou chang upstream otherwis difficult get old chang back repeat independ chang commit skip git reset hard step also prepar local featur branch chang rubric q edit earlier commit want edit latest commit simpli chang use git commit amend want edit commit commit chang line chang usual use git commit fixup commit git commit squash commit commit commit want chang differ fixup keep origin commit messag squash allow input addit note edit origin commit messag git rebas multipl commit way also mix fixupsquash commit normal commit done use git rebas autosquash basebranch merg fixupsquash commit commit amend see separ question git rebas choos basebranch kind workflow tri avoid chang line multipl commit except fixupsquash commit alreadi chang line want edit earlier commit use git rebas basebranch like need resolv conflict later see git rebas question later rubric q split commit instruct appli split head commit see use git rebas get earlier commit head split simplest case want split commit chain abc first new commit contain origin commit includ commit messag git reset p head path git commit amend select remov part commit leav work tree creat one commit remain chang describ tip want split commit chain origin commit messag reus someth els first commit eg bac git reset head remov head commit leav everyth work tree creat commit describ tip come point want reus origin commit messag use git reflog find refer origin commit headn git commit c headn rubric q use git rebas edit local commit assum local featur branch check branch three commit base master assum master gotten commit branch want use git rebas edit featur branch see probabl want git rebas head follow separ git rebas master first command allow edit local branch without get conflict chang master latter allow resolv conflict separ rebas run feel brave enough also time use git rebas master guidelin includ direct follow includ order use gromac empti line appear group header within group sort alphabet sourc file includ gmxpreh first sourc file correspond header includ next header directori sourc includ without path ie rel sourc otherwis canon includ path librarynamemodulenameheaderh use file depend defin configh come next follow standard cc header group follow standard c header eg stdioh c version eg cstdio standard c header eg vector prefer one first two group present enforc follow system header platformspecif header unistdh well extern librari gtestgtesth gromacsspecif librari srcextern thread_mpithreadsh gromac header part includ modul public gromac header part includ modul final gromac header intern includ modul execut test target typic path sourc file gromac header includ quot gromacsutilitypathh header angl bracket stdioh header srcextern gener includ quot whenev includ path rel src well threadmpi tng larger thirdparti entiti includ provid system latter group current includ gtestgmock condit includ header typic defin configh set includ end respect group note automat checkersort script act header comment includ statement author code put header proper order case trail comment line includ statement preserv affect checkersort part effort build proper api new scheme separ public librari modul function header file plan see also docgmxtre api restructur issu httpsgitlabcomgromacsgromacsissueslabel_namebdapirestructuring__ detail enforc consist order style advantag make easi quick glanc find depend file without scan long list unorgan includ includ header correspond sourc file first make header includ first sourc file reveal potenti problem header would compil unless header would includ first order person work header like see problem instead someon els see later refactor unrel code consist usag path includ direct make easi use grep find use header well includ depend two modul automat script use reestablish clean code semiautomat refactor like renam includ file sed without caus unnecessari chang _dev guid develop guid highlight bash set page contain guidelin instruct explan relat gromac develop actual code document doxygen document link focu least thing tightli tie code helper script resid sourc repositori organ code may requir document updat sync guid current split main part overview gromac codebas collect overview page describ import implement aspect gener guidelin follow develop gromac guidelin script exist see automat reformat code andor enforc guidelin commit instruct tool use use html addit doxygen document extract comment cc code avail document actual exist code latex full code document gener doxygen found onlin document includ order save tree overview document close relat actual cc code appear doxygen document overview content develop guid reason partial technic crosslink develop guid doxygen document provid whenev relat content appear split two sourc document yet cover area content slowli ad wiki page httpwwwgromacsorgdeveloper_zon may contain addit inform much outdat though link relev locat develop guid toctre maxdepth contribut overview buildsystem changemanag relocatablebinari documentationgener style tool knownissu doxygen document html public api document doxygenhtmluserindexxhtml_ contain document code appear instal header well overview document understand part code pleas note definit public api preliminari subject chang particular part document code document doxygenhtmllibindexxhtml_ contain public api document subset also detail intern implement gromac good place start understand specif area code gener eg contribut full document doxygenhtmlfullindexxhtml_ contain everi singl document function codebas includ intern overwhelm amount detail use tri find specif function within codebas latex doxygen code document avail gromac webpag relocat binari gromac mostli implement concept relocat binari ie initi instal cmake_install_prefix binari packag cpack whole instal tree move differ folder gromac continu work without chang instal tree page explain implement known limit implement inform mainli interest develop need understand chang code also use peopl instal packag gromac relat featur need consid code relat execut work directli execut build tree instal case data file also look sourc tree make develop easi find share librari gromac built dynam link first part make binari relocat make possibl execut find libgromac matter execut platform support rel rpath use make gromac execut find libgromac instal prefix make execut fulli relocat come link long rel folder structur execut librari kept rpath mechan work gmxrc also add absolut path libgromac instal ld_library_path platform support make linker search librari less robust eg mix call differ version gromac note gmxrc current relocat hardcod absolut path nativ window dll fulli support current possibl compil dll mingw visual studio intel compil case dll place bin directori instead lib automat cmake base gener binari type assign cmakeliststxt window automat search dll execut directori correct dll alway found extern librari standard cmake link mechan use rpath extern depend includ execut window dynam link may requir extra effort make loader locat correct extern librari support execut built binari build tree without instal critic execut test develop standard cmake mechan use binari built rpath set build tree instal rpath binari rewritten cmake final rel valu extra optim instal tree rel folder structur build tree final rel rpath use alreadi initi build rpath set root cmakeliststxt possibl disabl use rpath instal standard cmake variabl set cmake_skip_install_rpathon find data file gromacsspecif part make binari relocat make abl find data file instal tree data file use multipl purpos includ show quot end program execut quot databas found quot simpli print file mostli use system prepar tool like refgmx pdbgmx refgmx grompp variou analysi tool static data caus fatal error found sever consider reloc work find data file reli hardcod absolut path must find locat execut code inspect system fallback environ variabl set gmxrc similar could use current run execut build tree desir automat use data file match sourc tree facilit easi test data file copi build tree user free choos rel locat sourc build tree also data file rel path sourc tree instal tree sourc tree sharetop instal tree sharegromacstop latter customiz cmake configur addit gromac execut program link libgromac need abl find data file call certain function librari case execut may directori gromac case static link part code actual load gromac instal prefix make imposs find data file without extern inform user alway use gmxlib environ variabl provid altern locat data file ideal never necessari use data file instal consider fulli address current implement work like find path current execut base argv valu contain directori interpret absolut rel current work directori directori file name search directori list path window current directori also search path file match name found use without check execut found symbol link symbol link travers real file found note link directori name resolv link contain rel path end result may contain compon absolut path execut found code check whether execut locat build output directori use stat similar account possibl symbol link directori compon hardcod sourc tree locat return absolut path execut found build tree parent directori check parent directori contain filesharegromacstopgurgledat directori return instal prefix file name gurgledat locat consid uniqu enough ensur correct directori found instal directori readonli architectureindepend data file custom cmake configur set cmake_install_datadir subdirectori host gromacsspecif data set gmx_install_datasubdir note search resolv symbol link normal input path beforehand compon symbol link path search may proceed unexpect directori issu correct instal prefix found encount symbol link long bin directori symbol link data file found yet tri hardcod guess like origin instal cmake_install_prefix usrloc first guess contain suitabl file gurgledat return still noth found return cmake_install_prefix let subsequ data file open fail logic find instal prefix srcgromacscommandlinecmdlineprogramcontextcpp note code link libgromac provid altern implement gmxiprogramcontext locat data file fulli respons consider inform use data directori print consol output unless run quiet well error messag locat data file help diagnos issu mechan disabl probe search affect process compil time except cmake variabl mention known issu gmxrc relocat hardcod absolut instal path one assign within script longer work reloc contribut get rid shell gmxrc current support welcom version check search data file case issu search may happen instal prefix instal gromac return instead cryptic error miss invalid file may reveal search instal prefix success hardcod absolut guess use one return guess includ absolut path cmake_install_prefix use compil libgromac incorrect reloc search instal prefix base locat execut work program link libgromac instal prefix case hardcod guess use search find correct data file reloc call code howev programmat provid gromac instal prefix ideal would work without offload work call code one option partial solv two issu would use gmxdata environ variabl set gmxrc fallback current environ variabl set rare use instal pkgconfig file relocat hardcod absolut instal path physic valid physic valid test check whether simul result correspond physic mathemat expect unlik exist test abl keep test second minut time frame rather aim hour day therefor ran period probabl everi build also given long run time mani case necessari separ run system eg run specif time differ resourc make script give option prepar run file execut script analyz alreadi present simul prepar run analyz one go test descript current simul result test three physic mathemat expect result integr converg symplect integr shown conserv constant motion energi microcanon simul fluctuat quadrat time step chosen compar two constantofmot trajectori realiz use differ time step otherwis unchang simul paramet allow check symplect integr note lack symplect necessarili impli error integr algorithm also hint physic violat part model noncontinu potenti function imprecis handl constraint etc kinet energi distribut kinet energi trajectori equilibr system sampl canon isothermalisobar ensembl expect maxwellboltzmann distribut similar physic expect observ distribut allow valid sampl kinet energi ensembl distribut configur quantiti distribut configur quantiti like potenti energi volum gener known analyt test likelihood trajectori sampl given ensembl less straightforward kinet energi howev gener ratio probabl distribut sampl ensembl differ state point eg differ temperatur differ pressur known compar two simul differ state point therefor allow valid sampl ensembl physic valid includ gromac test rang mostus set sever system gener philosophi leav set default valu except one explicitli test order sensit chang default valu test set enlarg discov interest test system corner case doubl precis addit test ran test ran use lower toler integr converg simul perform nve argon atom water molecul system test sensit numer imprecis perform longrang correct lennardjon electrostat interact low pairlist toler verletbuffertoler e high linc set applic argon integr integr md integr mdvv longrang correct lj vdwtype pme vdwtype cutoff vdwmodifi forceswitch rvdwswitch water integr integr md integr mdvv longrang correct lj vdwtype pme vdwtype cutoff vdwmodifi forceswitch rvdwswitch longrang correct electrostat coulombtyp pme fourierspac constraint algorithm constraintalgorithm linc lincsord lincsit constraintalgorithm none settl ensembl test gener ensembl test argon atom water molecul settl pme system follow combin integr md tcoupl vrescal taut reft argon reft water integr md tcoupl vrescal taut reft argon reft water pcoupl parrinellorahman refp compress e integr mdvv tcoupl vrescal taut reft argon reft water integr mdvv tcoupl nosehoov taut reft argon reft water pcoupl mttk refp compress e thermostat appli entir system tcgrp system simul run ns fs time step verlet cutoff set left default valu build test use build system sinc test ran frequenc current test kept strictli optin via dgmx_physical_validationon dgmx_physical_validationoff default independ previous exist build target unchang includ make check physic valid turn number addit make target use make check unchang build main binari unit test run unit test avail regress test make checkphi build main binari run physic valid test warn requir simul system might take sever hour averag machin make checkal combin make check make checkphi simul need perform physic valid test may take long might advantag run extern resourc enabl two addit make target present make checkphysprepar prepar simul file testsphysicalvalid build directori well rudimentari run script directori make checkphysanalyz run test make checkphi simul system instead target assum result found testsphysicalvalid build directori intend usag addit target prepar simul file run differ resourc differ time later analyz want use awar run script gener simpl might need consider tune work setup ii analysi script sensit folder structur make sure preserv copi result anoth resourc addit mention make target number intern make target defin intend use directli necessari support function describ especi complex depend intern target includ runctest runctestnophi runctestphi runctestphysanalyz run differ test runphysvalsim run simul physic valid missingtestsnotic missingtestsnoticeal missingphysvalphi missingphysvalphysanalyz missingphysvalal notifi user miss test direct usag python script make command mention call python script testsphysicalvalidationgmx_physicalvalidationpi use independ make system use h flag gener usag inform test detail avail physic valid script requir json file defin test input among option allow defin gromac binari work directori use decid whether prepar simul prepar run simul analyz simul three step ad new test avail test list systemsjson test standardli use singl precis build systems_djson test standardli use doubl precis build file directori gromac file folder system json file list differ test test name attribut need uniqu dir attribut denot directori system insid system directori test test attribut list valid perform system addit option grompp_arg mdrun_arg attribut allow pass specif argument gmx grompp gmx mdrun respect singl test contain sever valid sever independ test perform input file add new test present system add test name argument json file use new system add subfold system directori contain inputsystemgromdptop file defin system use doxygen page document doxygen set gromac sourc tree well guidelin ad new doxygen comment exampl includ well tip trick avoid doxygen warn guidelin focu c code new code follow new modul layout part guidelin still applic document older code eg within gmxlib mdlib particular guidelin format doxygen comment use intern see refdevdoclayout overal structur document get start quickli need read first two section understand overal structur document take look exampl end remain section provid detail understand exampl way complex situat meant refer look solut particular problem rather singletim read understand find individu doxygen command first look doxygen document httpwwwdoxygennlmanu document flavor gromac sourc tree set produc sever differ level doxygen document public api document suffix user document function class export librari intend use outsid gromac librari librari api document suffix lib addit includ function class design use part gromac well guidelin mostli interest develop full document suffix full includ nearli document function class sourc tree maxim verbos document suffix dev everyth doxygen extract well addit intern link subsequ level document includ document level suffix refer suffix doxygen input output file well name output directori flavor built front page document contain link flavor explain differ detail gener guidelin public api document kept free anyth user link unmodifi gromac see word public api document mainli document content instal header provid necessari overview use also verbos requir public api document higher ideal reader document could immedi start use api base document without need look implement similarli librari api document contain thing modul gromac never call particular anyth declar local sourc file avail full document also someth document identifi librari api necessari call function outsid modul build document want see uptod document download artifact webpag job latest schedul pipelin correspond branch httpsgitlabcomgromacsgromacspipelinespagescopeallsourceschedul ci also run doxygen chang push gitlab releas master branch result document found artifact correspond webpag job doxygen job fail introduc doxygen warn may need build document local want check result addingmodifi signific amount comment recommend particular much experi doxygen good idea build differ set see result want produc warn local work gener good idea set gmx_compact_doxygenon cmake option remov larg gener graph document speed process significantli also fast version make target skip addit diagram built lib level lower file relat doxygen resid docsdoxygen subdirectori sourc build tree freshli check sourc tree directori contain variou doxyfilecmakein file run cmake correspond file doxyfileus doxyfilelib doxyfileful doxyfiledev gener correspond locat build tree also doxyfilecommoncmakein use produc doxyfilecommon file contain set share input file doxyfilecompact provid extra set gmx_compact_doxygenon run doxygen directli one gener file output produc current work directori build one doxygenus doxygenlib doxygenful doxygendev target target run doxygen quieter mode show warn put output docshtmldoxygen build tree doxygen build cooper broader webpag target doxygenal target build three target less type gener document put htmluser htmllib htmlfull andor htmldev open indexxhtml file one subdirectori start brows gromac develop htmllib reason start point log file doxygen warn also produc docsdoxygendoxygenlog inspect run need doxygen expected_doxygen_vers build current document version may work like also produc warn addit graphviz httpwwwgraphvizorg_ mscgen httpwwwmcternanmeukmscgen_ requir graph document latex formula work version like avail packag manag possibl build document without tool see error relat figur miss document _devdoxygenguidelin gener guidelin doxygen markup doxygen provid quit differ altern style document sourc code subtleti doxygen treat differ type comment also depend somewhat doxygen configur possibl chang mean comment chang style comment enclos avoid issu avoid need manag altern singl style throughout sourc tree prefer come treatment style gromac use default doxygen configur one except javadoc_autobrief set allow conveni onelin brief descript c code major exist comment gromac use qtstyle comment instead brief instead brief etc use also new document singl except brief comment c code see similarli exist comment use multilin comment c c code instead use multipl line c rational sinc code mixtur languag long time uniform use similar style also sinc file like transit c c gradual rewrit comment differ style issu gener necessari final multilin comment work differ depend doxygen configur better avoid ambigu ad comment ensur short brief descript alway produc use variou list briefli explain purpos method without unnecessarili expand list basic guidelin start comment block brief possibl doxygen command want avoid brief onelin use descript must fit singl line otherwis interpret brief comment note particular simpl without brief produc brief descript also note brief mark whole follow paragraph brief descript insert empti line intend brief descript c code comment must avoid compil like want avoid brief onelin c code use instead brief descript contain unescap period except end prefer c code put document comment header file contain declar header exist implementationspecif comment influenc method use go sourc file method definit intern tag begin comment block doxygenstyl comment within function gener usabl time may need exclud part header sourc file doxygen see gener tri avoid may necessari remov function want appear public api document would gener warn left undocu avoid doxygen warn code understand prefer cond endcond cond work also use ifndef doxygen exclud class method header also need exclud sourc code avoid warn gromac specif gener guidelin style doxygen comment given section introduc gromac specif construct current use doxygen document well gromac use doxygen group organ document consist check done automat use custom script see docgmxtre detail control document visibl control level document certain function appear three differ mechan use global doxygen configur mainli use includ declar local sourc file full document find detail doxyfilecmakein file also mention individu code construct standard doxygen command intern mark document extract full document internal_doc full document use first command comment block exclud document possibl use intern endintern exclud individu paragraph intern prefer see addit gromacsspecif custom doxygen command libintern provid use way exclud document public api document command expand either intern noop depend document level doxygen command cond use section name libapi intern includ document librari api full document respect libapi also defin full document declar use enabled_sect doxygen configur file exampl locat necessari use explicit command given section individu code construct modul doxygen group describ refdevsourcelayout subdirectori srcgromac repres modul ie somewhat coher collect routin doxygen automat gener list routin modul extract variou alphabet index contain less document function class help read document routin modul visibl one place gromac use doxygen group achiev document modul defgroup definit modul relev class function need manual ad group use ingroup addtogroup group page also provid natur place overview document modul navig directli modul tab gener document note use addtogroup order addtogroup add element directli contain group contain namespac declar namespac ad group none namespac content reason addtogroup go within innermost scope around member actual ad modul appear public api document definit defgroup prefix libintern case also addtogroup command modul similarli prefix otherwis creat group public api document without content defgroup definit may also caus content addtogroup section appear public api document even otherwis would public api librari api group addit modul group two fix group provid group_publicapi group_libraryapi class file ad group use gromac specif custom inpublicapi inlibraryapi command gener group document page use annot class file show api definit name make inform easili access command filelevel comment also use automat intermodul depend valid see note function enumer entiti separ page gener document belong one group case modul group prefer api group document specif code construct section describ techic detail tip trick document specif code construct use document produc wonder document certain piec inform see document structur section refdevdoclayout focu document overview content doxygen page modul document experienc develop rel easili read understand individu function document help get big pictur doxygen page page access navig front page written use markdown locat docsdoxygen page place page hierarchi make subpag anoth page ie referenc use subpag mainpagemd root hierarchi two subdirectori user lib determin highest document level page appear add page lib ensur refer page public api document libapi use add refer content otherwis public gener page high enough level provid overview content use enough necessari exclud librari api document modul modul decid header file import one modul selfevid header may better design eg moduledoch purpos current done modul header contain defgroup definit modul name group filemodule_nam name name subdirectori host modul modul ad appropri group see docsdoxygenmisccpp definit use ingroup organ modul tab gener document one contact person know content modul list use author command provid point contact one question author list chronolog order contribut possibl classesstruct class struct header file appear alway doxygen document even enclos file document start document block class part public api intern libintern class declar local sourc file unnam namespac appear full document whole class document current gener warn class simpli exlud document member document class document warn gener guidelin document free function appli method class well base class api classif inpublicapi inlibraryapi base class meant subclass visibl intern libintern contrast reflect api classif deriv class base class document alway gener togeth deriv class class meant subclass protect member protect member appear document level class meant subclass exampl class meant subclass within modul protect member appear full document accomplish use cond note need add cond command also sourc file hide method doxygen otherwis get confus warn methodsfunctionsenumsmacro item appear document unless enclos scope document class member scope class otherwis namespac one exist file addtogroup also defin scope group higher visibl scope outsid function within namespac mostli applic c code visibl enclos file necessari add intern libintern static function current extract document flavor allow header declar static inlin function use exampl math code function anonym namespac extract full document togeth rule mean avoid put static function within document namespac even within sourc file may inadvert appear public api document want exclud item document need put insid cond block doxygen see otherwis warn undocu function gener need enclos declar definit cond file document file start document block right copyright notic document file see exampl section exact format thing note pleas specifi file name explicitli file default file comment appli file contain explicit file name add one thing get date brief appear line file next line intern libintern indic header visibl gener guidelin instal header appear public api document ie contain command noth els document contain public api function header declar anyth librari api mark libintern rest intern sourc file well test file document intern sinc provid anyth public librari api avoid unintent extract thing file document share test file use test modul mark libintern inpublicapi inlibraryapi use indic header meant directli includ modul one contact person list author make signific modif addit file consid ad author line directori directori document typic contain use inform beyond possibl brief descript sinc correspond close modul modul document brief descript still use provid highlevel overview sourc tree gener file page refer modul typic suffici brief descript directori directori current document docsdoxygendirectoriescpp exampl highlight c basic c exampl document c class contain header file comment code actual document explain use doxygen construct libintern file brief declar gmxmyclass detail document still extract class even whole comment block miss author exampl author exampleauthorcom inlibraryapi ingroup module_mymodul namespac gmx libintern brief brief descript class detail libintern tag requir class sinc extract document even absenc document enclos scope libintern tag separ line bug doxygen affect intern clariti also work around inlibraryapi ingroup module_mymodul class myclass public trivial constructor destructor requir document constructor take paramet document like method myclass myclass brief brief descript method paramin param descript first paramet paramin param descript second paramet return descript return valu throw stdbad_alloc memori detail describ method error put paramet block exist code int mymethodint param const char param const brief descript accessor int simpleaccessor const return var_ brief altern verbos way specifi brief descript int anotheraccessor const brief brief descript anoth accessor long conveni fit singl line specifi int secondaccessor const privat privat member whether method variabl current ignor doxygen dont need document document doesnt hurt though int var_ namespac gmx basic c anoth exampl document c header file avoid cstyle comment includ free function also demonstr use addtogroup add multipl function modul group without repeat ingroup tag file brief declar collect function perform certain task detail go author exampl author exampleauthorcom inpublicapi ingroup module_mymodul addtogroup module_mymodul brief brief descript data structur detail inpublicapi typedef struct brief descript member int member int second brief descript second member brief brief descript third member detail int third gmx_mystruct_t brief perform simpl oper paramin valu input valu return comput valu detail descript inpublicapi use doxygen allow singl group function module_mymodul prefer group int gmx_functionint valu brief descript escap brief descript function int gmx_simple_funct scope visibl rule rule doxygen expect someth document command like intern need complex exampl describ pitfal libintern file brief exampl assum file document like libintern definit begin intent expos anyth file public api thing work similarli full document replac libintern intern everywher exampl ingroup module_exampl brief brief descript free function free function extract document unless enclos scope case file libintern necessari void gmx_function assum module_exampl group defin public api addtogroup module_exampl cond libapi brief brief descript free function within addtogroup case enclos scope actual module_exampl group document function need explicitli exclud libintern work sinc would produc warn undocu function whole declar hidden doxygen void gmx_function endcond modul declar librari api addtogroup use without enclos cond otherwis creat dummi modul identifi name cond libapi addtogroup module_libmodul brief brief descript libintern necessari enclos cond void gmx_function endcond altern use enclos scope document librari api libintern addtogroup module_libmodul brief descript void gmx_function libintern brief brief descript struct document struct class header alway extract document libintern necessari exclud current undocu structsclass produc warn cond necessari struct t_exampl int member nonpriv member document bool member otherwis doxygen produc warn namespac document public api namespac gmx cond libapi brief brief descript free function within document namespac case enclos scope document namespac cond necessari avoid warn void gmx_function endcond brief class meant subclass within modul subclass public base class still provid public method visibl subclass appear public document mark inpublicapi class baseclass public brief public method method also appear document subclass public librari api doc void method protect cond necessari exlud document public api sinc public api support subclass cond intern method subclass insid modul see void methodforsubclasstocal method need implement subclass virtual void virtualmethodtoimpl endcond namespac gmx modul document document new modul place comment like central header modul modul tab gener document use navig modul defgroup module_exampl exampl modul exampl ingroup group_utilitymodul brief brief descript modul detail descript modul link separ doxygen page overview andor describ import header andor class modul part document modul expos publicli libintern ad begin defgroup author author name authornameemailcom code use addtogroup module_exampl ingroup module_exampl add content class function etc onto modul page common mistak common mistak particular c code forget document file caus doxygen ignor comment file valid content comment either possibl actual check gener document look like follow exampl show common mistak less common produc correct document well doxygen featuresbug confus struct document comment within declar ignor struct t_struct comment tri document member appli first second produc warn miss document enclos struct document angl paramet doubl alpha beta produc brief document explicit brief requir c c use brief comment int gmx_function produc document sinc miss begin brief brief descript detail int gmx_function put whole paragraph brief descript short descript prefer separ empti line rest text brief brief descript descript continu kind detail function call int gmx_function may doxygen bug produc brief descript intern brief descript int gmx_function first declar appear header second sourc file doxygen associ correctli complain miss document latter solut explicitli add namespac prefix also sourc file even though compil requir header file exampl function namespacequalifi paramet type int gmx_functionconst gmxsomeclass param sourc file use gmxsomeclass int gmx_functionconst someclass param put namespac mention modul instead content namespac addtogroup go within innermost scope addtogroup module_exampl namespac gmx function intend part module_exampl int gmx_function exist code exampl find look exist code sourc tree particular new c code srcgromacsanalysisdata srcgromacsopt subdirectori contain larg amount code document mostli along guidelin comment srcgromacsselect particular clike code predat introduct guidelin best exampl includ fragmentsdoxygenlinksrst contain gromac project infrastructur use docker container isol autom task number imag maintain provid breadth test coverag script configur file build imag store repositori fileadmincontain imag rebuilt manual gromac project staff push dockerhub gitlab see httpshubdockercomugromac httpsgitlabcomgromacsgromacscontainer_registri gitlab contain registri ci pipelin use gitlab contain registri instead pull docker hub project member role develop higher privileg push imag httpsdocsgitlabcomeeuserpackagescontainer_registryindexhtmlbuildandpushimagesbyusingdockercommands__ contain registri step creat person access token httpsgitlabcomprofilepersonal_access_tokens__ doc httpsdocsgitlabcomeeuserprofilepersonal_access_tokenshtml__ write_registri read_registri scope save hash authent command line docker login registrygitlabcom u user name p hash docker push registrygitlabcomgromacsgromacsimagenam refer filebuildallsh master branch set imag current built within docpipelin job gitlabci job specifi docker imag imag properti imag name convent see pyfuncutilityimage_nam imag gitlab registri easili access identifi portabl ci environ variabl may prefer part imag identifi exampl some_job imag ci_registry_imageciconfigur granular consid equival express ci_registryci_project_path ci_registryci_project_namespaceci_project_nam ref httpsdocsgitlabcomeecivariablespredefined_variableshtml util fileutilitypi automodul util member filescripted_gmx_docker_buildspi automodul scripted_gmx_docker_build _codeformat guidelin code format follow list provid gener formattingindent rule gromac code cc basic indent four space keep line reason length keep everi line least charact end indent deepli consid split code function use tab space editor configur gener space even press tab tab particular mix space easili break indent context set exactli equal eg git diff output trail whitespac use brace alway delimit block even singl statement block similar put brace line except short onelin inlin function c class put singl line use space liber extern c namespac block indent other includ class switch bodi namespac block close comment name addit sourc file nontrivi script contain copyright header predetermin format licens inform check exist file copyright holder gromac develop team year code gromac sourc repositori earlier year hold copyright whenev updat file check current year list copyright year guidelin enforc use clangformat uncrustifi automat sourc code format tool copyright guidelin enforc separ python script see doccodeformat detail note due natur script allornoth format note format rule enforc time enforc consist format advantag one need manual review code format issu peopl focu content separ automat script see appli reestablish format refactor like renam symbol chang paramet without need manual number user provid setup avail correct set favourit text editor provid conveni may exactli conform expect either format tool emac format setup insert follow emac configur file defun gromacscmodecommonhook gromac custom cmode csetoffset substatementopen csetoffset innamespac custom go setq ctabalwaysind setq cbasicoffset default setq cindentlevel default setq cfilestyl stroustrup setq tabstoplist setq tabwidth setq indenttabsmod nil use tab addhook cmodecommonhook gromacscmodecommonhook defun gromacscmodecommonhook gromac custom cmoe csetoffset substatementopen csetoffset innamespac custom go setq ctabalwaysind setq cbasicoffset default setq cindentlevel default setq cfilestyl stroustrup setq tabstoplist setq tabwidth setq indenttabsmod nil use tab addhook cmodecommonhook gromacscmodecommonhook configur base content stackoverflow_ _stackoverflow httpstackoverflowcomquestionsemacscmodeincorrectindent eclipsecdt format setup correct format pleas use profile_ _thi profil httpsgistgithubcomrolandschulzffaedfff _codecommitstyl guidelin format git commit true correct way submit new commit code review gromac follow guidelin help review process go smoothli gener rule newli submit code new code follow refstyl rulesstyleguidelin outlin submit make less like chang reject due chang modifi exist code yet conform style preliminari patch clean surround area good idea like slowli improv qualiti add chang function guidelin git commit messag commit messag contain quick explan verb form chang purpos chang avail final part messag changeid short section like fix issueid link chang possibl previous post issu ref issueid present patch somehow relat work without necessarili fix whole issu concern inlin code comment new code suffici comment peopl abl understand purpos code less current oper prefer variabl name code structur clarifi mechan comment refer higherlevel thing choic algorithm desir consist part code exampl follow comment would insuffici explain made exampl iter list interact code take item iter loop store much better exampl would explain iter take place iter item list get specif interact type store new data type futur use function foo second exampl someon debug might abl deduc better error observ foo actual caus previou assign gitlab ci pipelin execut repositori contain dockerfil gitlab runner configur file support autom test document build gener inform configur gitlab ci pipelin found offici gitlab document httpsdocsgitlabcomeeciyaml_ gitlab ci configur entri point filegitlabciyml file root sourc tree configur templat found file fileadmincitempl directori docker imag use gitlab runner avail docker hub httpshubdockercomugromacs__ imag rebuilt manual use detail fileadmincontain todo issu comment number pipelin like run time note full autom test avail merg request origin branch main httpsgitlabcomgromacsgromac repositori gitlab ci pipelin creat fork repositori includ fewer job test pipelin nontrivi merg request may need issu branch gromac project namespac order receiv suffici test accept configur file root repositori filegitlabciyml defin stage default paramet includ file fileadmingitlabci defin job execut pipelin note job name begin period hidden httpsdocsgitlabcomeeciyamlhiddenkeysjobs_ job directli elig run may use templat via extend job properti httpsdocsgitlabcomeeciyamlextends_ job paramet refer httpsdocsgitlabcomeeciyaml complet document gitlab ci job paramet note follow gromacsspecif convent glossari before_script use sever templat prepend shell command job script paramet avoid use beforescript directli cautiou nest extend overrid multipl before_script definit job cach global default job build softwar like set cach explicitli unset cach direct specifi job paramet cach refer gitlab doc httpsdocsgitlabcomeeciyamlcache__ detail particular note detail cach ident accord cachekey httpsdocsgitlabcomeeciyamlcachekey__ imag see docdevmanualcontain docker imag use ci pipelin job depend artifact previou job sure use compat imag depend rule except job paramet control circumst job run key word may differ mean occur element paramet archivewhen note intend appli instead set directli job definit tri use one predefin behavior defin rulessometh fileadmingitlabcirulesgitlabciyml error unexpect behavior occur specifi one rule templat use paramet combin rule templat reduc error unexpect behavior restrict usag control regular job definit dont use hidden parent job note rule compat older except paramet standard newer rule mechan tag job run gromac gitlab ci runner infrastructur requir ksscilifelab tag includ job specifi kubernet configur variabl requir special facil gpu mpi note tag control runner elig take job affect whether job elig addit particular pipelin addit rule logic use make sure job ksscilifelab becom elig pipelin launch outsid gromac project environ see instanc termci_project_namespac variabl mani job definit add overrid key variabl refer gitlab httpsdocsgitlabcomeeciyamlvariables__ detail merg behavior refer refvari local usag schedul trigger pipelin schedul httpsgitlabcomhelpcipipelinesschedules__ configur gitlab web interfac schedul pipelin may provid differ variabl definit environ job run schedul condit httpsgitlabcomhelpcipipelinesschedulesusingonlyandexcept__ nightli schedul pipelin run master releas branch gromac repositori run postmergeaccept pipelin gitlab ci gromac run set job default mr accept result commit includ target branch master one releas branch job trigger manual use post_merge_accept input variabl document execut new pipelin gitlab web interfac global templat addit templat main job definit file common mixin function behavior templat defin fileadmingitlabciglobalgitlabciyml readabl paramet may separ file name accord paramet eg filerulesgitlabciyml job begin use provid mixin behavior boilerpl job use particular tool chain job begin paramet httpsdocsgitlabcomeeciyaml__ name allow paramet set singl place common job characterist provid default paramet valu job name suffix meaning descriptor document within fileadmingitlabciglobalgitlabciyml job name job name indic purpos job indic relationship multistag task distinguish job stage distinguish job definit throughout configur job may reassign differ stage time includ stage name job name help gener tag like pre post build test necessari distinguish phase say webpag tag buri end job name stylist help use delimit like distinguish basic job name qualifi detail also consid group job httpsdocsgitlabcomeecipipelinesindexhtmlgroupingjobs__ _variabl updat regress test chang gromac requir chang regressiontest notori hard merg request test nonupd version regress test necessarili fail updat regress test current chang integr master might caus merg request pipelin fail solut new regressiontest branch commit upload gitlab set regress test branch regressiontestbranch specif commit regressiontestcommit run specif pipelin requir regressiontestupd see set variabl specif pipelin variabl gitlab ci framework gitlab runner plugin script set use sever variabl httpsdocsgitlabcomeecivariablesreadmehtml__ default valu avail variablesdefault definit fileadmingitlabciglobalgitlabciyml mani mixin templat job provid addit overrid definit variabl may set make final job definit variabl may control behvior gitlabci begin ci_ gitlab runner support infrastructur may use job definit pass along environ execut command variabl key begin kubernetes_ relat gitlab runner kubernet executor httpsdocsgitlabcomrunnerexecutorskuberneteshtmlthekubernetesexecutor__ import variabl key follow glossari ci_project_namespac distinguish pipelin creat repositori gromac gitlab project space may use prescreen job determin whether gromac gitlab infrastructur avail pipelin job creat compiler_major_vers integ version number provid toolchain mixin conveni intern use cmake gromacsci docker imag built octob sever version cmake instal recent version cmake contain appear first path allow individu job use specif version cmake pleas write job script section use cmake instead cmake begin script section line cmakecmakewhich cmake specifi cmake version set cmake variabl full execut path cmake version would like use see also doccontain cmake_compiler_script cmake command line option tool chain definit provid mixin toolchain definit eg usegcc append commandcmak call job script cmake_mpi_opt provid cmake command line argument defin gromac mpi build option gromacs_major_vers readonli environ variabl ci script check librari api version expect build job artifact initi variabl defin fileadmingitlabciapiclientmatrixgromacsmastergitlabciyml could move fileadmingitlabciglobalgitlabciyml found gener util gromacs_releas readonli environ variabl check see job execut pipelin prepar tag releas set launch pipelin via gitlab web interfac exampl see rule mixin fileadmingitlabciglobalgitlabciyml regressiontestbranch use branch regressiontest rather master allow merg request requir updat regress test valid ci test regressiontestcommit use commit regressiontest rather head master allow merg request requir updat regress test valid ci test post_merge_accept readonli environ variabl indic job schedul run commit merg target branch execut set run pipelin web interfac schedul use pleas see rule mixin fileadmingitlabciglobalgitlabciyml set variabl variabl individu piplelin set gitlab interfac cicd pipelin chose top right corner run piplelin run desir branch may select variabl may set field name convent convent appli new code common sens modifi exist code exampl renam wide use exist function follow convent may justifi unless whole code get rework current document present state code particular attempt made consolid name file c sourc file cpp extens c sourc file c header use h sourc file filefilecfilefilecpp declar visibl outsid sourc file go correspondingli name header filefileh code may deviat rule improv readabl andor usabl api clearli document also filefile_implh file declar class function access outsid modul whole file declar symbol intern modul file_implh suffix omit case declar use outsid singl sourc file sourc file use suffix filedoch file contain doxygen document modul case natur singl header put document c file prefer name file main class contain current file name alllowercas even though class name contain capit letter ok use commonli known abbrevi andor omit name contain directori would caus unnecessari repetit eg common prefix everi file name directori remain part name uniqu enough avoid multipl file name differ place within librari addit make thing harder find c sourc file name caus obscur problem compil current unit test except rule one particular compil problem workaround possibl ifwhen start affect test file common guidelin c c code preprocessor macro uppercas use lead underscor name reserv accord cc standard name includ guard like gmx_dirname_headername_h avoid abbrevi obviou gener reader use acronym eg pme dd name follow microsoft polici case two letter uppercas dd three lowercas pme first letter would lowercas context use eg begin function name anywher c function name clearest use alllowercas acronym c code function variabl name lowercas underscor word separ need clariti function part public api start gmx_ prefer function well part code use _gmx_ prefix intern function strictli speak reserv name eg trail underscor would better old c code chang still use hungarian notat boolean enumer variabl name well enum valu prefix b e respect gradual move c practic whatev choos avoid complex abbrevi c code use camelcas name start type class struct typedef enum valu capit letter name function variabl lowercas letter may use alllowercas name underscor class close resembl extern construct eg standard librari construct name way c interfac name prefix icommandlinemodul keep interfac identifi without introduc much clutter interfac typic use quit wide spell interfac would make mani name unnecessarili long abstract base class typic name abstract prefix member variabl name trail underscor accessor variabl foo_ name foo setfoo global variabl name g_ prefix global filestat variabl name g_ prefix static class function variabl name s_ prefix static constexpr file class function member name sc_ prefix global constant often name c_ prefix main respons file implement particular class name file match class except possibl abbrevi avoid repetit file name eg class within modul start modul name omit abbrevi modul name ok current sourc file name lowercas case differ differ new c code avoid use hungarian notat descend c code ie practic use b prefix boolean variabl e prefix enumer variabl andor valu instead make name long good descript control typic includ verb boolean variabl like foundatom prefer class enum regular one unexpect convers int happen name function convert class enum valu string enumvaluetostr use nonclass enum prefer includ name enumer type base name enum valu eg helpoutputformat_consol particular set expos modul prefer use enumer type valu instead boolean control paramet function reason easi understand argument helpoutputformat_consol control almost imposs deciph true place without check document role paramet rational trail underscor globalstat prefix immedi clear whether variabl referenc method local function wider scope improv readabl code code gpu rational gpu use right memori space often perform critic cuda devic code sm_ gm_ cm_ prefix use share global constant memori absenc prefix indic regist space prefix use opencl code sm_ indic local memori prefix ad variabl privat address space data transfer host live cpu gpu memori space therefor typic pointer contain cuda memori buffer opencl host memori devicebas counterpart easili distinguish variabl name object prefix h_ d_ ident name otherwis exampl h_mass d_mass case pointer host memori requir prefix h_ even part host code host devic pointer present devic pointer alway prefix d_ gm_ case gpu kernel argument combin structur prefer devic memori pointer within structur prefix d_ ie kernelargsd_data prefer d_kernelargsdata wherea d_kernelargsd_data kernelargsdata accept note pointer prefix d_ host code gm_ devic code exampl d_data pass kernel argument alias gm_data kernel argument list case devic pointer field pass structur use directli alias pointer gm_ prefix ie kernelargsd_data use alias gm_data insid kernel avoid use uninform name cuda warp thread block index opencl analog ie threadindex prefer atomindex unit test test fixtur first paramet testtest_f name test suffix class meant base class test fixtur name typedef fixtur name testbas fixtur suffix ctest test name camelcas end test eg optionsunittest test binari name name modul test suffix highlight bash build system overview gromac build system use cmake version cmake_minimum_required_vers newer requir gener actual build system build tool chosen user see cmake document gener introduct cmake use document focus gromac build system organ implement featur provid develop may interest advanc user develop use make ninja underli build system part build system specif design commandlin consumpt tool may work ideal environ basic build possibl environ support cmake also build system version control design outofsourc build insourc build mostli work custom target particular effort put eg filegitignor file exclud build output clean target remov possibl build output build type build type cmake concept provid overal control build tool use given platform produc execut code set cmake variou way includ command line cmake dcmake_build_typedebug gromac support follow standard cmake build type releas fulli optim code intend use product simul default debug compil code intend use debug tool low optim level debug inform symbol relwithdebinfo releas debug inform symbol name help debug issu emerg optim code minsizerel releas optim minim size result execut never concern gromac instal use probabl work addit gromac provid follow build type develop test implement found cmakegmxbuildtypexxxcmak refer build type compil version gromac aim sole correct parallel optim possibl disabl build type compil gcc gener regress test refer valu gromac build test relwithassert releas remov dndebug compil command line make assert statement activ safetyrel side effect gromac code upon depend profil releas add pg use profil tool like effect profil perform refgmx mdrun use tool tsan build gromac use threadsanit gcc clang httpsclangllvmorgdocsthreadsanitizerhtml detect data race disabl use atom threadmpi prefer mutexbas implement asan build gromac use addresssanit gcc clang httpsclangllvmorgdocsaddresssanitizerhtml detect mani kind memori misus default addresssanit includ leaksanit msan build gromac use memorysanit clang httpsclangllvmorgdocsmemorysanitizerhtml detect read uniniti memori function requir depend gromac build built compat way roughli static librari g fsanitizememori fnoomitframepoint gener requir least c standard librari built special path includ librari depend found build type set cmake cach variabl gmx_msan_path intern xdr intern fftpack support time sanit build get readabl stack trace may need ensur asan_symbolizer_path environ variabl path includ llvmsymbol binari gener cmake gener build system singl cmake_build_typ one pass cmakeliststxt file code use cmake_build_typ cmakeliststxt directli break gromac use cmake code fulli support build type gener includ visual studio cmake cach variabl section provid current incomplet list cach variabl develop advanc user set affect cmake gener andor get built todo figur document basic variabl intend user consumpt relat document todo document remain variabl identifi variabl miss list compil flag standard cmake mechan specifi compil flag use cmake_c_flagscmake_cxx_flag flag affect build type sampcmake_c_flags_buildtypesampcmake_cxx_flags_buildtyp flag affect specif build type cmake provid default flag gromac determin set default flag group two categori gener flag append default cmake flag variabl possibl multipl build type gener specifi optim flag use control compil warn specif flag certain featur build system determin necessari success compil one exampl flag determin simd instruct set compil allow usene support flag ad test work provid compil one cach variabl control behavior automat compil flag cmake gmx_skip_default_cflag set build system add compil flag automat neither gener specif defin skip linker flag well default flag would ad instead print commandcmak run user set flag use cmake variabl default flag ad describ code determin default gener flag filecmakegmxcflagscmak code set specif flag eg simd flag main filecmakeliststxt search cmakegmx_skip_default_cflag variabl use trace back locat actual flag use determin variabl affect compilationlink cmake gmx_broken_calloc enabl emul calloc via mallocmemset need machin broken calloc eg lgmalloc cray xt default need chang unless sure requir cmake gmx_build_for_coverag special variabl set ci build coverag job allow build system set option produc use coverag metric possibl current disabl assert avoid show poor condit coverag default need chang manual build todo could like replac yet anoth build type cmake gmx_build_own_fftw set gromac build system download build fftw sourc automat support window ninja build system cmake gmx_build_shared_ex build execut share binari set disabl rpath dynam linker flag attempt build static binari may requir set toolchain properli make appropri librari avail default cmake gmx_compiler_warn set variou compil warn enabl compil ci use verif default build sourc tarbal user compil version test ci expos rather aggress warn flag trigger lot warn eg new version compil use build git repositori default cmake gmx_cycle_subcount set enabl perform subcount offer finegrain mdrun perform measur evalu default counter see docuserguidemdrunperform descript subcount avail default cmake gmx_enable_ccach set attempt set ccach httpsccachedev_ cach compil wrapper speed repeat build ccach execut search find_packag cmake run compat build type execut found compat compil configur cmake launch wrapper script set enabl ccach execut locat discov cmake must access build well default minim build system complex cmake gmx_install_datasubdir set subdirectori cmake_install_datadir gromacsspecif readonli architectureindepend data file instal default gromac mean file go sharegromac alter share part chang cmake_install_datadir see docrelocatablebinari influenc build cmake gmx_doubl mani part gromac implement term real precis actual either singl doubleprecis type accord valu flag part code deliber use singl doubleprecis type unaffect set see docmix doubl precis referencemanualdefinit inform cmake gmx_extra add support trace use extra httpstoolsbscesextrae_ cmake gmx_external_bla set default cmake first tri use extern bla librari unsuccess fall back use one bundl gromac set cmake use bundl one immedi set cmake use extern one rais error found cmake gmx_external_lapack see gmx_external_bla cmake gmx_external_tng use extern tng librari trajectoryfil handl default cmake gmx_fft_librari choos cpu fft librari use possibl valu fftw mkl fftpack default select depend compil build type cmake gmx_git_version_info whether gener version inform dynam git build eg head commit hash default build git repositori commandgit found otherwis static version inform filecmakegmxversioninfocmak use cmake gmx_gpu choos backend gpu offload possibl valu cuda opencl sycl pleas see refinstal guid gmxgpusupport inform cmake gmx_clang_cuda use clang compil cuda gpu code host devic pleas see refinstal guid gmxgpusupport inform cmake gmx_cuda_clang_flag pass addit cudaonli compil flag clang use variabl cmake cmake_install_libdir set instal directori librari default determin standard cmake packag gnuinstalldir see docrelocatablebinari influenc build cmake gmx_use_plugin enabl support dynam plugin eg vmdsupport file format default cmake gmx_mpi enabl mpi threadmpi support internod parallel default pleas see refinstal guid mpisupport inform cmake gmx_openmp enabl openmp support default cmake gmx_prefer_static_lib prefer static link extern librari default unless gmx_build_shared_ex disabl cmake gmx_simd choos simd instruct set use default auto best one current cpu pleas see refinstal guid gmxsimdsupport inform cmake gmx_thread_mpi enabl threadmpi support internod parallel default cmake gmx_use_rdtscp use lowlat rdtscp instruct x cpubas timer mdrun execut ignor nonx machin might need set compil heterogen environ old x cpu cmake gmx_use_tng use tng librari trajectori io default cmake gmx_vmd_plugin_path path vmd plugin molfil io use gmx_use_plugin enabl cmake gmx_x enabl gmx view tool default deprec cmake gmx_xml current option effect compil link sinc code outsid test would use filelibxml variabl affect target cmake build_test standard variabl creat ctest enablesdis test default cmake gmx_build_help control handl man page shell complet possibl valu default build releas sourc distribut man page shell complet gener part target instal compil sourc packag auto default build develop version shell complet gener execut filegmx binari part target fail messag print build succe man page need gener manual invok man target man page shell complet instal success gener work auto except invok filegmx binari fail build fail well cmake gmx_developer_build set target includ also test binari use googl test cmakegmx_build_unittest also cmakegmx_compiler_warn alway enabl futur develop conveni featur well featur inconveni gener user ad set control variabl cmake gmx_clang_tidi clangtidi httpsreleasesllvmorgtoolsclangtoolsextradocsclangtidyindexhtml_ use static code analysi autom fix issu detect clangtidi easi instal contain llvm binari packag httpreleasesllvmorgdownloadhtml_ version support other might miss test give fals posit run automat gitlab ci commit mani check fix automat appli run build configur cmake dgmx_clang_tidyon dcmake_build_typedebug cmake_build_typ enabl assert eg asan work configur build run compil well clangtidi build name clangtidi execut set dclang_tidi full path set dclang_tidy_ex appli automat fix issu identifi clangtidi run separ run clangtidi fixerror part build corrupt header file fix specif file run clangtidi fixerror headerfilt file fix file parallel runclangtidypi fix headerfilt selectionparsercppselectionscannercpp fix modifi file runclangtidypi fix headerfilt git diff head nameonli filerunclangtidypi script shareclang subfold llvm distribut clangtidi abl find compile_commandsjson file either run build folder add symlink sourc folder cmakegmx_enable_ccach work clangtidi variabl affect special target cmake gmxapi set addit gmxapi c librari configur gmxapi header instal provid addit build tree target gmxapicppdoc gmxapicppdocsdev doxygen avail also export cmake configur file gmxapi allow find_packagegmxapi import gromacsgmxapi cmake target client project search gromac instal root cmake gmx_build_manu set cmake detect latex prerequisit refer pdf manual done manual target build manual gener default detect skip manual built todo consid realli necessari could use gmx_developer_build cmake gmx_build_tarbal set dev suffix strip version string version info logic adjust man page document gener build suitabl releas web page andor sourc distribut packag default cmake gmx_build_unittest test binari use googl test built either separ test target also part target depend cmakegmx_developer_build depend requir build test googl test googl mock framework tinyxml includ filesrcextern default cmakebuild_test cmake gmx_compact_doxygen set doxygen configur chang avoid gener larg depend graph make significantli faster run doxygen reduc disk usag typic use develop document reduc build time default cmake regressiontest_download set cmake download regress test extract local directori cmakeregressiontest_path set extract test note happen configur phase build download done variabl automat reset avoid repeat download set download default cmake regressiontest_path path extract regress test suit match sourc tree directori contain filegmxtestpl set ctest test gener run regress test default empti cmake source_mdsum set md sum releas tarbal gener html document get insert download section html page extern librari todo list extern librari use either srcextern system whether requir option function provid gromac control use special target addit default target gener build system sever custom target intend explicitli built perform variou task may also run automat variou target well use intern typic intend invok directli check build binari need test run test type test avail show note user main target intend normal user run test see doctestutil checksourc run custom python checker script check variou sourcelevel issu use doxygen xml document well rudimentari pars part sourc file target use part ci cmake code current filedocsdoxygen see docgmxtre complet run compil filegmx execut gener shell commandlin complet definit target ad cmakegmx_build_help run automat part default target see cmakegmx_build_help cmake code filesrcprogram depgraph build includ depend graph sourc file use commanddot graphviz cmake code filedocsdoxygen see docgmxtre doxygen target run doxygen gener document doxygenal target run part webpag target turn run part ci cmake code filedocsdoxygen see docdoxygen gmxapicppdoc build api document gmxapi use author client softwar document gener filedocsapius build directori gmxapicppdocsdev extract document gmxapi gromac develop filedocsapidev installguid run sphinx gener plaintext instal file sourc packag file gener filedocsinstallguidetext get put root sourc packag cpack cmake code filedoc man run sphinx gener man page program intern also run compil filegmx execut gener input file sphinx cmake code filedoc see cmakegmx_build_help inform man page instal manual run latex gener refer pdf manual cmake code filedocsmanu see cmakegmx_build_manu package_sourc standard target creat cpack build sourc packag target use gener releas sourc packag test standard target creat ctest run regist test note build test binari run need first ensur uptod see doctestutil test build binari need test gmx see doctestutil webpag collect target run document target gener full set html link documentaion target use part ci cmake code filedoc webpagesphinx run sphinx gener content html document set web page develop guid also part intern also run compil filegmx execut gener input file sphinx cmake code filedoc pass inform sourc code build system use differ mechan influenc compil highest level cmake option select file compil option pass compil command line use equival avail everi compil unit use care keep compil command line manag find current set defin git grep add_definit header file gener use cmake configure_fil includ desir sourc file file must exist compil pass file use ifdef have_config_h protect inclus case defin set use file may get compil outsid main build system filebuildinfoh contain variou string build environ use mainli output version inform log file request fileconfigh contain defin condit compil within sourc file filegmxpreconfigh includ filegmxpreh first thing everi sourc file contain defin requir header correct oper exampl defin affect behavior system header fall categori see doxygen document filegmxpreh file avail interface_include_dir common cmake target ie includ configh sure target_link_librariesmymodul privat common addit follow file gener build system filebaseversiongencpp provid definit declar filebaseversion_genh version info output content gener either git version info static version info build git repositori developmenttim tool sever tool individu page list toctre maxdepth doxygen changemanag infrastructur relengindex gmxtree codeformat testutil physical_valid todo issu consid reason structur current list make much sens overal organ creat confus toc develop guid todo issu add detail tool either form link wiki separ page explain detail chang manag gromac chang manag use git gitlab_ code upload test well issu track chang submiss guidelin refer doccontribut git gromac use git httpsgitscmcom__ version control system instruct set git gromac well tip trick use found docchangemanag basic tutori materi git found web httpsgitscmcomdocext__ gitlab bug issu well random featur discuss track code chang go code review system httpsgitlabcomgromacsgromac build test chang push gitlab automat compil otherwis check variou platform docinfrastructur document build autom provid inform replic build eg diagnos issu docrelengindex provid inform technic implement build _git tip trick httpwwwgromacsorgindexphptitledeveloper_zonegitgit_tips__trick build system todo detail asan other cmake main tool use build system packag distribut cpack unit test ctest gromac use unit test framework base googl c test framework gtest ctest unit test automat run gitlab ci commit detail found separ page doctestutil clang static analyz coverag regress test floatingpoint except debug build floatingpoint except fpe gener whenev one follow oper encount divis zero floatingpoint overflow invalid oper eg take sqrt neg number check perform follow configur releas build build gcc x clang optim build sycl support configur fpe enabl ad fpexcept flag gmx invoc howev fpe support window nonx appl hardwar see apilegacyincludegromacsmathutilitiesh detail _devformattingtool code format style tool script list use automat checkappli format follow gromac style guidelin describ separ page docstyl clangformat use clangformat enforc consist code style set record clangformat main tree see refgmxclangformat detail clangtidi sourc code linter clangtidi use enforc common restrict code check collect clangtidi top main tree see refgmxclangtidi detail admincopyrightpi python script add format copyright header sourc file copyrightsh see use script checkupd copyright year chang file automat admincopyrightsh bash script run copyrightpi python script enforc correct copyright inform file local chang check conform prescrib style option script also appli chang make file conform script automat run ci ensur commit adher docformat copyright job succeed mean script someth complain see doccodeformat detail adminclangformatsh script enforc code style use clangformat script automat run ci ensur commit adher docformat adminclangtidysh clangtidi code correct restrict enforc script script also use ci verifi code addit nightli compil use clangtidi whole tree admingitprecommit sampl git precommit hook use one want appli clangtidysh copyrightsh clangformatsh automat everi commit check format issu see doccodeformat detail docsdoxygenincludesorterpi python script sort reformat includ direct accord guidelin docincludestyl detail document separ page whole suit python script use sourc code check refdevincludesort includ direct checker present form includ sorter script conveni appli format script check issu instead integr checksourc build target target built also check includ format issu intern use sorter script check run ci part document job detail check mechan separ page common sever checker docgmxtre adminreformat_allsh bash script run clangformatcopyrightpyinclud sorter relev file sourc tree particular directori script also produc list file script appli use script see doccodeformat detail git attribut git attribut specifi gitattribut file use annot file subject automat format check automat reformat script see man gitattribut overview mechan use filter attribut specifi type automat checkingformat appli custom attribut use specifi build system depend easier process cmake understand jenkin build page document differ jenkin build actual run httpjenkinsgromacsorg gromac sourc tree purpos twofold provid inform interpret jenkin failur run task local diagnos issu case refer special target describ docbuildsystem provid inform chang build system part repositori need special care break jenkin build todo add link wiki page gener jenkin document presubmit verif follow build trigger patch set upload gerrit compil test main build compil gromac differ configur run test configur use jenkin verif specifi fileadminbuildspresubmitmatrixtxt exact build sequenc found fileadminbuildsgromacspi includ logic translat build option matrix file cmake option document build build variou type document pdf refer manual use latex doxygen document extract sourc code set html page contain instal guid user guid develop guid well link set html page brows jenkin man page instal text file last three requir build filegmx binari run compil failur also show build log file contain warn archiv artifact build presenc warn mark build unstabl brief descript part fail report back gerrit addit build run sourc code check reli doxygen document see descript checksourc target docgmxtre docdoxygen provid gener guidelin doxygen usag help understand solv doxygen warn checksourc issu docincludestyl provid guidelin includ order style anoth part checksourc check exact build sequenc fileadminbuildsdocumentationpi see file detail exactli build chang document build system requir chang script jenkin configur static clang static analysi file fileadminbuildsclanganalyzerpi specifi exact build sequenc cmake cach variabl use clang static analysi file also specifi clang version use analysi well c compil use clangstaticanalyzervers run analysi outsid jenkin run cmake make scanbuild command use cmake cach variabl build script initi cmake configur scanbuild set c compil analyz note use scanbuild like also analyz c code jenkin ignor c code analysi result extra warn suppress manual set cmake_c_compil valu clang static analyz uncrustifi build check sourc code format issu uncrustifi enforc copyright style see docformat guidelin enforc exact build sequenc fileadminbuildsuncrustifypi essenti run adminuncrustifysh check revhead chang requir build mark unstabl script complet fail rare build fail file issu found script archiv artifact build summari report back gerrit actual issu see doccodeformat detail codeformat tool script run clangformat build check enforc code format eg indent also second part build enforc sourc code format see docformat style guidelin build run accord fileadminbuildsclangformatpi result run adminclangformatsh check revhead build mark unstabl code format result chang sourc code ondemand build build trigger request certain chang gerrit manual jenkin see refrelengtriggeringbuild detail trigger coverag build compil one configur gromac instrument coverag run test produc coverag report use gcovr report brows jenkin exact build sequenc fileadminbuildscoveragepi includ specif configur test sourc tarbal build creat sourc tarbal distribut content put tarbal gener execut commandgmx binari build also compil sourc code minim set option build compil code target gener content necessari tarbal follow build package_sourc target gener file use build exact build sequenc fileadminbuildssourcepackagepi releas workflow build creat sourc regressiontest tarbal build instal test configur use build document place document web site new releas set configur test specifi fileadminbuildsreleasematrixtxt exact build sequenc desrib refrelengworkflowreleas build use sourc tarbal build subbuild part build execut use fileadminbuildsgromacspi fileadminbuildsdocumentationpi fileadminbuildsgetversioninfopi use get version inform sourc tree part workflow fileadminbuildsupdateregtesthashpi logic updat regressiontest tarbal md sum releas tarbal automat updat regressiontest data sometim add new test regressiontest repositori also sourc code data file chang sometim necessari updat regressiontest requir particular cmake build type singl doubleprecis build gromac gener data jenkin autom much tedium upload regressiontest chang lack relev refer data either delet outdat data test new jenkin normal thing ignor gerrit patch number chang symbol mmmm go chang mmmm gerrit select patch set want updat new refer data usual latest one comment jenkin updat updat head match sourcecod branch jenkin crossverifi nnnn updat updat build gromac latest version gerrit sourcecod patch nnnn need function chang nnnn affect either layout file refer data result simul result subsequ analysi eventu jenkin upload new version regressiontest patch gerrit contain updat regressiontest data upload trigger jenkin normal presubmit verifi pass perhap pass crossverifi patch nnnn later later need verifi updat version sourcecod patch nnnn newli gener refer data go sourcecod patch nnnn comment jenkin crossverifi mmmm autom infrastructur start releas autom test document build perform gitlab gitlab runner toctre maxdepth jenkin gitlabci contain _gmxdevknownissu known issu relev develop nonexhaust list known issu observ interest develop solv either outsid scope gromac project simpli difficult tediou address issu gpu timer opencl build use opencl debug mode happen gpu timer state get corrupt lead assert failur refmdrun gmx mdrun seem relat load unrel task gpu gpu emul work nonbond gpu emul mode work least build gpu support gpu setup call call also dynam prune need implement gpu emul opencl nvidia volta later broken opencl code produc incorrect result volta ture gpu architectur nvidia cc issu affect certain flavor nonbod kernel like result miscompil known workaround _gmxcontribut contribut gromac gromac communitydriven project love get contribut peopl contribut welcom mani form includ improv document patch fix bug advic forum bug report let us reproduc issu new function plan contribut new function gromac strongli encourag get contact us first earli stage new thing lead excit scienc love howev subsequ code mainten timeconsum requir front longterm commit other might share particular scientif enthusiasm pleas read page first least post develop mail list_ sometim well abl save lot time even plan stage much document found alongsid sourc code git repositori chang suggest contribut done use mechan sourc code contribut review similar way checklist send us code review inclus gromac pleas make sure check point list use code wide applic within scientif commun welcom smaller project track code prepar includ maintain code limit applic evid peopl alreadi use code method one good way show code use scientif public anoth public ideal come sever differ research group show widespread adopt method advanc discuss pleas commun develop eg develop mail list_ mail list issu tracker_ let know gener natur plan prevent duplic wast effort also good idea search resourc well literatur www project may relev verifi propos new method pass first check pleas make sure easili verifi correct physic point view must includ document sourc code later addit user guid andor refer manual capabl graduat student read understand well enough use method appropri sourc code document also help mainten later develop facilit inclus unit test code describ section write refnew test gmxmakenewtest also need form autom highlevel test code peopl understand detail need abl chang infrastructur depend gromac use autom continuousintegr test docgitlab gitlabci need quick feedback whether code would affect propos chang mean user featur continu good scienc base upon trustworthi result gener new version gromac releas youv contribut featur structur chang process review code correct qualiti perform time consum process commit necessari order deliv softwar high enough qualiti reliabl scientif result howev human be busi short attent span propos chang affect line code like gener littl enthusiasm develop review local git commit histori like full chang longer present version youd like contribut cant reason review either might reason break process manag piec function read docmdp set userguidemdpopt might requir write reftpr function refmdrun gmx mdrun execut simplest form featur extens andor optim featur function analysi tool use thing simul output get touch us eg develop mail list_ exchang idea timeli make annual releas gromac featur freez git branch fork fix date agre six month advanc still need month qualiti test branch fork releas there period accept certain kind potenti riski chang master branch remain open kind chang like focu mani core develop releas process larg chang propos need make group smaller chang negoti advanc code review avail review improv month date even smaller chang unlik priorit other review last month code style pleas make sure code follow doccod style style refcod format codeformat guidelin make code review go smoothli side number tool alreadi includ gromac facilit pleas look refth respect part document gmxcodeformat code document ensur proper code document pleas follow instruct provid use docdoxygen doxygen addit new function document manual possibl user guid addit code style pleas also follow instruct given concern refcommit style codecommitstyl also facilit code review process prepar code submiss gromac use git docchangemanag instead accept pull request gromac chang submit individu commit tip master branch host gitlab_ prepar submit manag patch chang requir littl bit setup refer docchangemanag inform access gromac git repositori structur repositori sourc control without merg commit git usag may less common develop work flow altern gromac public mirror avail github httpsgithubcomgromacsgromac may wish fork project github account make featur avail way help gener follow user would help make case contribut featur core process would still need follow remain criteria outlin fork gromac pleas set cmake variabl gmx_version_string_of_fork appropri descript string see cmakegmxversioninfocmak detail project underway develop stabl api gromac promis great tool permit innov ensur ongo qualiti core function might prefer plan port function api becom avail keep touch develop mail list_ youll first know function readi peopl explor question question regard point would like feedback idea contribut pleas feel free contact us develop mail list_ code interest wider gromac commun happi assist process includ main sourc tree _develop mail list httpsmaillistsyskthsemailmanlistinfogromacsorg_gmxdevelop remov function occasion necessari refpolici occas deprecationpolici user also list refanticip chang anticipatedchang refdeprec function deprecatedfunction gromac file placehold use case releng_path identifi locat releng repositori _relengworkflowreleas releas engin gitlab toctre hidden current switch build test system use gitlab integr ci system inform gener system found offici gitlab document httpsdocsgitlabcomeeciyaml_ new configur build test found file gitlabciyml templat configur found file admincitempl directori section go extend individu build inform come avail seealso docinfrastructur _relengtriggeringbuild trigger build gitlab pipelin trigger web interfac differ pipelin avail use specifi environ variabl trigger interfac section go extend inform trigger differ build individu behaviour _refer manual gmxmanualparentdir_ _gmxmembran run membran simul gromac run membran simul user frequent encount problem run simul lipid bilay especi protein involv user seek simul membran protein may find tutori httpwwwmdtutorialscomgmxmembrane_proteinindexhtml__ use one protocol simul membran protein consist follow step choos forc field paramet protein lipid insert protein membran instanc use g_memb preform bilay coarsegrain selfassembl simul convert back atomist represent solvat system add ion neutral excess charg adjust final ion concentr energi minim let membran adjust protein typic run md ns restraint kjmol nm protein heavi atom equilibr without restraint run product md ad water genbox gener water around preform lipid membran refsolv gmx solvat may find water molecul get introduc interstic membran sever approach remov includ short md run get hydrophob effect exclud water gener suffici reach waterfre hydrophob phase molecul usual expel quickli without disrupt gener structur setup reli complet waterfre hydrophob phase start tri follow advic set radiu option refgmx solvat chang water exclus radiu copi vdwradiidat gmxlib locat work directori edit increas radii lipid atom nm suggest carbon prevent refsolv gmx solvat see interstic larg enough water insert edit structur hand delet rememb adjust atom count refgro file account chang reftopolog top use script someon wrote remov extern materi membran simul slide httpsextrascscfichemcoursesgmxerik_talksmembrane_simulationspdf_ membran simul video httptvfunetfimedarshowrecordinginfodoidmetadataficsccoursesgromacs_workshop_speedingupsimulationsalgorithmsapplicationsxml_ erik lindahl gromac tutori membran protein simul httpwwwmdtutorialscomgmxmembrane_proteinindexhtml__ design demonstr sort question problem occur simul protein embed within lipid bilay combin oplsaa forcefield berger lipid httppomesbiochemistryutorontocafileslipidcombinationrulespdf_ detail descript motiv method test sever topolog membran protein differ forc field gaff charmm berger shirley w siu robert vacha pavel jungwirth rainer bckmann biomolecular simul membran physic properti differ forc field httpsdoiorg_ lipidbook httpswwwlipidbookorg_ public repositori forcefield paramet lipid deterg molecul use simul membran membran protein describ j domaski p stansfeld msp sansom beckstein j membran biol doi httpdxdoiorgs_ parameter novel molecul parametr questionsproblem resolv simpli rememb follow two rule mix match forc field refforc field gmxforcefield best design selfconsist typic work well forc field simul part system one forc field anoth part differ forc field parametr first forc field mind result probabl question hope review concern pick forc field use forc field need develop new paramet deriv manner consist rest forc field origin deriv mean need review origin literatur isnt singl right way deriv forc field paramet need deriv paramet consist rest forc field go depend forc field want use exampl amber forc field deriv paramet nonstandard amino acid would probabl involv number differ quantum calcul deriv gromo opl paramet might involv fit variou fluid liquidst properti b adjust paramet base experiencechem intuitionanalog suggest autom approach found docher userguidesystemprepar would wise reason amount simul experi gromac attempt parametr new forc field new molecul exist forc field expert topic suitabl give say undergradu student research project unless like expens quasirandom number gener thorough knowledg refchapt ff gromac refer manual requir havent warn strongli enough pleas read parametr exot speci anoth bit advic dont haphazard obtain paramet would buy fine jewelleri guy street offer sell diamond necklac doesnt mean that buy one similarli isnt necessarili best strategi download paramet molecul interest websit someon youv never heard especi dont explain got paramet forewarn use prodrg httpdavapcbiochdundeeacukcgibinprodrg_ topolog without verifi content artifact publish httppubsacsorgdoiabsciw_ along tip properli deriv paramet gromo famili forc field exot speci want simul proteinnucl acid system bind variou exot metal ion ruthenium ironsulfur cluster essenti function similar unfortun arent paramet avail forc field want use shoot email gromac user email list get refer faq realli insist simul molecular dynam youll need obtain paramet either literatur parametr probabl import stop think sometim reason may alreadi paramet atomsclust particular coupl basic question ask see whether reason developobtain standard paramet use molecular dynam quantum effect ie charg transfer like import ie dival metal ion enzym activ site interest studi enzym function probabl huge issu standard forc field parametr techniqu use forc field choic like fail atomclust type ie hartreefock g cant adequ describ transit metal exampl answer either question ye may want consid simul someth classic molecular dynam even answer probabl want consult someon expert compound your interest attempt parametr probabl want tri parametr someth straightforward embark one potenti mean forc potenti mean forc pmf defin potenti give averag forc configur given system sever way calcul pmf gromac probabl common make use pull code step obtain pmf use umbrella sampl allow sampl statisticallyimprob state gener seri configur along reaction coordin steer md simul normal md simul arbitrarilycr configur use umbrella sampl restrain configur within sampl window use refgmx wham make use wham algorithm reconstruct pmf curv detail tutori link umbrella sampl httpwwwmdtutorialscomgmxumbrellaindexhtml__ singlepoint energi comput energi singl configur oper sometim use best way gromac refmdrun gmx mdrun rerun mechan appli model physic reftpr configur trajectori coordin file suppli mdrun mdrun inputtpr rerun configurationpdb note configur suppli must match topolog use gener reftpr file refgrompp gmx grompp configur suppli refgrompp gmx grompp irrelev except perhap atom name also use featur energi group see refer manual_ trajectori multipl configur case default refmdrun gmx mdrun neighbour search configur make assumpt input similar zerostep energi minim step report energi zerostep md run avoid complic relat cater possibl restart presenc constraint neither procedur recommend carbon nanotub robert johnson tip taken robert johnson post gmxuser mail list absolut sure termin carbon atom share bond topolog file use periodic_molecul ye refmdp file input refgmx grompp even topolog correct crumpl may occur place nanotub box wrong dimens use vmd_ visual nanotub period imag make sure space imag correct space small big larg amount stress induc tube lead crumpl stretch dont appli pressur coupl along axi nanotub fact debug purpos might better turn pressur coupl altogeth figur anyth go wrong use refxtop gmx xtop specif forc field thing assum connect molecul termin carbon atom nanotub bond carbon period one nonperiod cap hydrogen gener infinit nanotub pbc option refxtop gmx xtop refxtop gmx xtop recogn termin c atom actual share chemic bond thu use refgrompp gmx grompp wont get error singl bond c andrea minoia tutori model carbon nanotub gromac also archiv httpchembyteswikidotcomgrocnt contain everyth set simpl simul cnt use oplsaa paramet structur simpl cnt easili gener eg buildcstruct_ python script also add termin hydrogen tubegen online_ copi past pdb output file name cntpdb make work modern gromac youll probabl want follow make directori cnt_oplsaaff directori creat follow file use data tutori page forcefielditp file section refitp atomnamestypesnt file section refnt aminoacidsrtp file section refrtp gener topolog custom forcefield cnt_oplsaaff directori must directori refgmx xtop command run must found gmxlib path noparam instruct refgmx xtop use bondangledihedr forc constant command line kb ka kd reli forc field file howev necessit next step fix dihedr function gmx xtop f cntgro cnttop ff cnt_oplsaa name cnt noparam function type dihedr set refgmx xtop forc field file specifi type therefor replac func type dihedr section topolog file quick way use sed might adapt oper system also manual look top file check chang dihedr func type sed dihedr system cnttop topolog set system instanc simpl invacuo simul use favourit paramet em refmdp md refmdp put slightli bigger box gmx editconf f cntgro boxedgro bt dodecahedron energi minimis vacuuo gmx grompp f emmdp c boxedgro p cnttop emtpr gmx mdrun v deffnm em md vacuuo gmx grompp f mdmdp c emgro p cnttop mdtpr gmx mdrun v deffnm md look trajectori gmx trjconv f mdxtc mdtpr md_centeredxtc pbc mol center gmx trjconv mdtpr f md_centeredxtc md_fitxtc fit rottran vmd emgro md_fitxtc _buildcstruct httpchembyteswikidotcombuildcstruct _tubegen onlin httpturinnssudeleduresearchtubegenonlinehtml short howto guid highlight bash number short guid present help user get start simul use thirdparti tutori provid justin lemkul found httpwwwmdtutorialscom toctre maxdepth beginn topolog special visual _refer manual gmxmanualparentdir_ _gmxbeginn beginn start gromac refmolecular dynam simul gmxmd daunt highli recommend variou extens document made avail gromac read first plu paper publish area interest resourc gromac docreferencemanualindex detail document also act good introduct refmd gmxmd gener docflow chart userguideflow simpl flow chart typic gromac md run protein box water molecular dynam simul gromac introduct slide httpsextrascscfichemcoursesgmxberk_talksforcefpdf_ video httptvfunetfimedarshowrecordinginfodoidmetadataficsccoursesgromacs_workshop_introductiontomolecularsimulationandgromacs_xml_ forc field integr control temperatur pressur berk hess _gmx_add_residu ad residu forc field ad new residu need introduc new residu exist forc field use refpdbgmx gmx pdbgmx modifi exist one sever file need modifi must consult docreferencemanualindex descript requir format follow step add residu refrtp file chosen forc field might abl copi exist residu renam modifi suitabl may need use extern topolog gener tool adapt result refrtp format need hydrogen abl ad residu creat entri relev refhdb file introduc new atom type add atomtypesatp ffnonbondeditp file requir new bond type add ffbondeditp add residu residuetypesdat appropri specif protein dna ion etc residu involv special connect residu updat specbonddat note simul weird ligand water weird ligand normal protein work gener standalon refitp file contain moleculetyp exampl modifi reftop produc parameter server insert includ refitp file reftop gener system without weird ligand modifi forc field modifi forc field best done make full copi instal forcefield directori residuetypesdat local work directori cp r gmxlibresiduetypesdat gmxlibambersbff modifi local copi refpdbgmx gmx pdbgmx find origin modifi version choos modifi version interact list use refpdbgmx gmx pdbgmx ff option local version overrid system version _gmxsolvatewat water solvat use refsolv gmx solvat gener box solvent need suppli preequilibr box suitabl solvent refsolv gmx solvat stack around solut truncat give simul volum desir use point model eg spc spce tipp specifi cs spcgro take file gromacssharetop directori water model eg tipp tipp avail well check content sharetop subdirectori gromac instal solvat sure equilibr least ps desir temperatur need select right water model reftop file either water flag refpdbgmx gmx pdbgmx edit reftop file appropri hand inform use solvent pure water pleas see refnonwat solvat gmxsolvateoth refmix solvent gmxsolvatemix _gmxsolvateoth non water solvent possibl use solvent water gromac requir preequilibr box whatev solvent need suitabl paramet speci simul one pass solvent box cs switch refsolv gmx solvat accomplish solvat seri differ equilibr liquid valid use gromac oplsaa gaff forc field found virtualchemistri httpvirtualchemistryorg_ make nonaqu solvent box choos box densiti box size size eventu simul box nm cube probabl fine gener singl molecul solvent work much volum singl molecul would box chosen densiti size use refeditconf gmx editconf place box size around singl molecul use refeditconf gmx editconf move molecul littl bit center use refgenconf gmx genconf rot replic box larg one right size densiti equilibr thoroughli remov residu order molecul use nvt period boundari condit box pass refsolv gmx solvat cs replic fit size actual simul box _gmxsolvatemix mix solvent common question new user creat system mix solvent urea dmso given concentr water exampl simplest procedur accomplish task follow determin number cosolv molecul necessari given box dimens system gener coordin file singl molecul cosolv ie ureagro use ci nmol option refgmx insertmolecul add requir number cosolv molecul box fill remaind box water whatev solvent use refgmx solvat refgmx insertmolecul edit reftopolog top includ appropri refitp file well make chang molecul direct account speci system make disulfid bond easiest way use mechan implement specbonddat file refpdbgmx gmx pdbgmx may find refpdbgmx gmx pdbgmx ss ye use sulfur atom need unit refpdbgmx gmx pdbgmx convert moleculetyp invok refpdbgmx gmx pdbgmx chainsep correctli may requir see refpdbgmx gmx pdbgmx h requir two sulfur atom within distanc toler usual order recognis disulfid sulfur atom close either edit content specbonddat allow bond format energi minim care allow bond relax sensibl length run preliminari em md distanc restraint disulfid bond sulfur atom larg forc constant approach within exist specbonddat rang provid suitabl coordin file second invoc refpdbgmx gmx pdbgmx otherwis edit reftop file hand option _refer manual gmxmanualparentdir_ _gmxvisual visual softwar program use visual either trajectori file andor coordin file vmd_ molecular visual program display anim analyz larg biomolecular system use graphic builtin script read gromac trajectori pymol_ capabl molecular viewer support anim highqual render crystallographi common molecular graphic activ read gromac trajectori default configur requir convers pdb similar format compil vmd_ plugin reftrr refxtc file load rasmol_ deriv softwar protein explorer_ might better altern chime compon requir window rasmol_ work fine unix protein explorer_ rasmol_ deriv easiesttous power softwar look macromolecular structur relat function run window macintoshppc comput chimera_ full featur pythonbas visual program sort featur use platform current version read gromac trajectori molscript_ scriptdriven program form highqual display molecular structur schemat detail represent get academ licens free avatar also appropri librari found configuretim refgmx view use topolog bond vs render bond rememb visual tool look coordin file gave except give refgmx view reftpr file thu use topolog describ either reftop file reftpr file program make guess chemic bond render purpos surpris heurist alway match topolog _rasmol httpwwwumassedumicrobiorasmolindexhtm _protein explor httpwwwumassedumicrobiorasmol _chimera httpwwwrbviucsfeduchimera _molscript httpsgithubcompekraumolscript extract trajectori inform sever techniqu avail find inform gromac trajectori reftrr refxtc reftng file use gromac trajectori analysi util use refgmx traj write refxvg file read extern program write c code use gromacssharetemplatetemplatecpp templat use refgmx dump redirect shell output file read extern program like matlab mathematica spreadsheet softwar extern tool perform trajectori analysi recent year sever extern tool matur suffici analys divers set trajectori data sever simul packag short list tool alphabet order known abl analys gromac trajectori data loo httploossourceforgenet__ mdanalysi httpswwwmdanalysisorg__ mdtraj httpmdtrajorglatestindexhtml__ ptero httpsgithubcomyesintpteros__ plot data variou gromac analysi util gener refxvg file text file specif format direct use grace howev gromac analysi program turn grace specif code run program xvg none option circumv problem tool like gnuplot excel see note grace use embed backslash code indic superscript normal script etc unit area nmsn nm squar softwar softwar packag use graph data refxvg file grace wysiwyg plot tool x window system tif grace run practic version unixlik os provid satisfi librari depend lesstif valid free altern motif also avail common oper system gnuplot portabl commandlin driven interact data function plot util unix ibm os ms window do macintosh vm atari mani platform rememb use set datafil commentschar avoid gnuplot tri interpret gracespecif command refxvg file use xvg none option run analysi program simpl usag plot filexvg use line hack achiev right result ms excel chang file extens csv open file prompt choos ignor first row select fixedwidth column use german ms excel version chang decim delimit use favourit nix tool sigma plot commerci tool window use analysi tool r freeli avail languag environ statist comput graphic provid wide varieti statist graphic techniqu linear nonlinear model statist test time seri analysi classif cluster etc spss commerci tool statist product servic solut also plot analys data micel cluster necessari refgmx spatial tool fullyform singl aggreg want gener spatial distribut function aggreg solvent around aggreg cluster ensur micel split across refperiod boundari condit gmxpbc border essenti step prior calcul properti radiu gyrat radial distribut function without step result incorrect sign error unexplain huge fluctuat calcul valu visual trajectori look fine three step requir use reftrjconv gmx trjconv pbc cluster obtain singl frame lipid unit cell must first frame trajectori similar frame previou timepoint work use refgrompp gmx grompp make new reftpr file base frame output step use reftrjconv gmx trjconv pbc nojump produc desir trajectori use newli produc reftpr file explicitli step gmx trjconv f axtc a_clustergro e pbc cluster gmx grompp f amdp c a_clustergro a_clustertpr gmx trjconv f axtc a_clusterxtc a_clustertpr pbc nojump note must singl rst file order sphinx build singl plaintext file place instal tarbal _instal guid instal guid highlight bash introduct build gromac instruct pertain build gromac version might also want check uptod instal instructions_ quick dirti instal get latest version c c compil check cmake version cmake_minimum_required_vers later get unpack latest version gromac tarbal make separ build directori chang run cmake path sourc argument run make make check make instal sourc gmxrc get access gromac sequenc command execut parsedliter tar xfz gromacsversiontargz cd gromacsvers mkdir build cd build cmake dgmx_build_own_fftwon dregressiontest_downloadon make make check sudo make instal sourc usrlocalgromacsbingmxrc download build first prerequisit fft librari follow gromac alreadi fftw instal remov argument cmake overal build gromac correct reason fast machin upon cmake ran anoth machin may run may run fast want get maximum valu hardwar gromac read sadli interact hardwar librari compil go continu get complex quick dirti cluster instal cluster user expect run across multipl node use mpi make one instal similar anoth use dgmx_mpion latter instal binari librari name use default suffix _mpi ie gmx_mpi henc safe common practic instal locat nonmpi build instal typic instal detail consid use follow cmake options_ appropri valu instead xxx dcmake_c_compilerxxx equal name c compiler_ wish use environ variabl cc dcmake_cxx_compilerxxx equal name c compiler_ wish use environ variabl cxx dgmx_mpion build use mpi support_ dgmx_gpucuda build nvidia cuda support enabl dgmx_gpuopencl build opencl_ support enabl dgmx_gpusycl build sycl_ support enabl use intel oneapi dpc_ default dgmx_sycl_hipsyclon build sycl_ support use hipsycl_ requir dgmx_gpusycl dgmx_simdxxx specifi level simd support_ node gromac run dgmx_doubleon build gromac doubl precis slower normal use dcmake_prefix_pathxxx add nonstandard locat cmake search librari header programs_ dcmake_install_prefixxxx instal gromac nonstandard location_ default usrlocalgromac dbuild_shared_libsoff turn build share librari help static linking_ dgmx_fft_libraryxxx select whether use fftw mkl fftpack librari fft support_ dcmake_build_typedebug build gromac debug mode build older version instal instruct old gromac version found gromac document page httpmanualgromacsorgdocumentation_ prerequisit platform gromac compil mani oper system architectur includ distribut linux mac os x window architectur includ x amdx sever powerpc includ power arm v sparc viii compil gromac compil platform ansi c c compil respect standard cc librari good perform os architectur requir choos good compil recommend gcc free wide avail frequent provid best perform strive use recent version compil sinc requir full c support minimum compil version support gromac team gnu gcclibstdc llvm clanglibc microsoft msvc compil may work cray pathscal older clang offer competit perform recommend pgi perform c bad intel classic compil iccicpc longer support gromac use intel newer clangbas compil oneapi gcc xlc compil support version compil power architectur gromac version recommend use gcc compil instead extens test may also need recent version compil toolchain compon besid compil eg assembl linker often ship os distribut binutil packag c support requir adequ support compil c librari gcc msvc compil includ standard librari requir configur vendor compil also manag standard librari librari via compil flag honor configur compil read linux clang compil use libstdc come gcc default c librari gromac requir compil support libstc version higher select particular libstdc librari provid path g dgmx_gplusplus_pathpathtog build clang llvm libcxx standard librari use dcmake_cxx_flagsstdliblibc run mac os x best option gcc appl clang compil provid macport work support openmp probabl provid best perform nonx platform best option typic use gcc vendor default recommend compil check special inform updat version gcc add linux os see ubuntu ubuntu toolchain ppa page_ rhelcento epel page_ redhat develop toolset compil parallel option maximum perform need examin use gromac hardwar plan run often openmp_ parallel advantag gromac support gener built compil detect automat _gmxgpusupport gpu support gromac excel support nvidia gpu support via cuda linux nvidia cuda_ toolkit minimum version required_cuda_vers requir latest version strongli encourag nvidia gpu least nvidia comput capabl required_cuda_compute_cap requir strongli recommend get latest cuda version driver support hardwar bewar possibl perform regress newer cuda version older hardwar cuda compil nvcc might offici support recent version gcc backend compil still recommend least use gcc version recent enough get best simd support cpu sinc gromac alway run code cpu reliabl use c compil version gromac code use host compil nvcc make possibl use acceler gromac also includ opencl_ support minimum opencl version requir required_opencl_min_vers bit implement support current opencl implement recommend use gcnbase amd gpu linux recommend rocm runtim intel integr gpu support neo driver opencl also support nvidia gpu use latest nvidia driver includ nvidia opencl runtim recommend also note perform limit inher nvidia opencl runtim possibl support intel vendor gpu opencl bit implement opencl requir therefor opencl support bit platform sinc gromac support sycl_ ad current sycl implement compil either intel oneapi dpc_ compil intel gpu hipsycl_ compil rocm runtim amd gfx cdna gpu use devic support compil possibl recommend possibl configur sever gpu backend build gromac _mpisupport mpi support gromac run parallel multipl core singl workstat use builtin threadmpi user action requir order enabl wish run parallel multipl machin across network need mpi librari instal support mpi standard that true mpi librari version releas sinc gromac team recommend latest version best perform either vendor librari openmpi_ mpich_ compil mpi set compil normal nonmpi compil add dgmx_mpion cmake option possibl set compil mpi compil wrapper neither necessari recommend gpuawar mpi support simul use multipl gpu mpi implement gpu support allow commun perform directli distinct gpu memori space without stage cpu memori often result higher bandwidth lower latenc commun current support gromac cuda build target nvidia gpu use cudaawar mpi librari detail see introduct cudaawar mpi httpsdevelopernvidiacomblogintroductioncudaawarempi_ use cudaawar mpi direct gpu commun recommend use latest openmpi version latest ucx version sinc gromac intern test cudaawar support perform use version openmpi cudaawar support built follow procedur openmpi build instruct httpswwwopenmpiorgfaqcategorybuildcuda_ gmx_mpion gromac attempt automat detect cuda support underli mpi librari compil time enabl direct gpu commun detect howev case gromac may fail detect exist cudaawar support case manual enabl set environ variabl gmx_force_gpu_aware_mpi runtim although case still lack substanti test urg user care check correct result use default build option report issu cmake gromac build cmake build system requir least version cmake_minimum_required_vers check whether cmake instal version cmake version need instal cmake first check whether platform packag manag system provid suitabl version visit cmake instal page_ precompil binari sourc code instal instruct gromac team recommend instal recent version cmake _fft support fast fourier transform librari mani simul gromac make extens use fast fourier transform softwar librari perform alway requir recommend fftw_ version higher intel mkl_ choic librari set cmake dgmx_fft_librarynam name one fftw mkl fftpack fftpack bundl gromac fallback accept simul perform prioriti choos mkl gromac also use mkl bla lapack see linear algebra libraries_ gener advantag use mkl gromac fftw often faster pme gpu offload support use cuda gpubas fft librari requir cudabas gpu fft librari cufft part cuda toolkit requir cuda build therefor addit softwar compon need build cuda gpu acceler use fftw fftw_ like avail platform via packag manag system compat signific perform issu associ packag particular gromac simul normal run mix floatingpoint precis suit use singl precis fftw default fftw packag normal doubl precis good compil option use fftw link gromac may use accordingli gromac team recommend either permit gromac instal download build fftw sourc automat use cmake dgmx_build_own_fftwon build fftw sourc code build fftw sourc get recent version follow fftw instal guide_ choos precis fftw ie singlefloat vs doubl match whether later use mix doubl precis gromac need compil fftw thread mpi support harm x hardwar compil enabless enableavx fftw earlier fftw also add enableavx also intel processor support wide avx includ knl add enableavx also fftw creat fat librari codelet differ instruct set pick fastest support one runtim arm architectur simd support ibm power later definit want version later compil enableneon enablevsx respect simd support use cray special modifi commerci version fft use fftw interfac slightli faster use mkl use mkl bundl intel compil set compil environ eg sourc pathtocompilervarssh intel similar run cmake includ set dgmx_fft_librarymkl need custom use cmake dgmx_fft_librarymkl dmkl_librariesfullpathtolibonesofullpathtolibtwoso dmkl_include_dirfullpathtomklinclud full list order librari requir found intel mkl document system use arm perform librari arm perform librari provid fft transform implement arm architectur preliminari support provid armpl gromac fftwcompat api assum arm hpc toolchain environ includ armpl path set eg load appropri modul like modul load moduleprefixarmhpccompilerxyarmplxi use follow cmake option cmake dgmx_fft_libraryfftw dfftwf_libraryarmpl_dirliblibarmpl_lpso dfftwf_include_dirarmpl_dirinclud option build compon runtim detect hardwar capabl improv link hwloc default turn sinc might support everywher hwloc instal work set dgmx_hwlocon hardwareoptim bla lapack librari use gromac util focus normal mode matrix manipul provid benefit normal simul configur discuss linear algebra libraries_ builtin gromac trajectori viewer gmx view requir x motiflesstif librari header file may prefer use thirdparti softwar visual vmd_ pymol_ extern tng librari trajectoryfil handl use set dgmx_external_tngy tng gmx_tng_minimum_required_vers bundl gromac sourc alreadi lmfit librari levenbergmarquardt curv fit use gromac lmfit gmx_lmfit_required_vers support reduc version librari bundl gromac distribut default build use default may explicitli enabl dgmx_use_lmfitintern use extern lmfit librari set dgmx_use_lmfitextern adjust cmake_prefix_path need lmfit support disabl dgmx_use_lmfitnon zlib use tng compress kind trajectori data build gromac document option requir imagemagick pdflatex bibtex doxygen python sphinx expected_sphinx_vers pygment gromac util program often write data file format suitabl grace plot tool straightforward use file plot program set dgmx_python_packageon configur gromac cmake enabl addit cmake target gmxapi python packag sample_restraint packag main gromac cmake build support addit test document gener build gromac section cover gener build gromac cmake_ exhaust discuss use cmake mani resourc avail web suggest search encount problem cover materi appli specif build unixlik system includ linux mac os x platform see specialist instruct _configurecmak configur cmake cmake run mani test system best work build gromac build machin target machin sure default detect pretti good howev want control aspect build compil cluster head node backend node differ architectur thing consid specifi best way use cmake configur gromac outofsourc build make anoth directori run cmake outsid sourc directori subdirectori also mean never corrupt sourc code tri build requir argument cmake command line name directori contain cmakeliststxt file code want build exampl download sourc tarbal use parsedliter tar xfz gromacsversiontgz cd gromacsvers mkdir buildgromac cd buildgromac cmake see cmake report sequenc result test detect done gromac build system written cmake cach kept cmakecachetxt edit file hand recommend could make mistak attempt move copi file anoth build file path hardcod within mess thing delet file start cmake seriou problem detect stage see fatal error suggest overcom sure deal pleas start search web comput problem alreadi known solut consult gmxuser mail list also inform warn might like take board pipe output cmake less tee use cmake return see set chosen inform use eg curs interfac ccmake actual use ccmake avail unix platform directli first step statu messag mere blink lower part termin rather written standard output platform includ linux window mac os x even nativ graphic user interfac cmake creat project file almost build environ want includ visual studio xcode check run cmake_ gener advic see navig chang thing set might normal want chang alreadi present may make chang reconfigur use c get chanc make chang depend perform check may take sever configur pass reach desir configur particular need resolv error reach desir configur ccmake build system gener press g requir previou configur pass reveal addit set need configur c cmake build system gener pass produc error attempt chang compil initi run cmake need chang clean start _nonstandard locat instal gromac gromac instal directori cmake_install_prefix point may sourc directori build directori requir write permiss directori thu without superus privileg cmake_install_prefix within home directori even superus privileg use instal phase never configur build run gromac _cmake option use cmake commandlin option becom comfort set chang option may know advanc configur gromac speed thing invok cmake pass variou option command line done set cach variabl cmake invoc use doptionvalu note environ variabl also taken account particular variabl like cc cxx exampl follow command line cmake dgmx_gpucuda dgmx_mpion dcmake_install_prefixhomemarydoeprogram use build cuda gpu mpi instal custom locat even save shell script make even easier next time also kind thing ccmake avoid option set abl chang interact run ccmake _gmxsimdsupport simd support gromac extens support detect use simd capabl mani modern hpc cpu architectur build gromac hardwar run dont need read unless get configur warn understand default gromac build system detect simd instruct set support cpu architectur configur done thu pick best avail simd parallel support gromac build system also check compil linker use also support select simd instruct set issu fatal error valid valu list applic valu largest number list gener one choos case choos inappropri higher number lead compil binari run howev number processor architectur choos highest support valu lead perform loss eg intel skylakexsp amd zen none use architectur either lack simd gromac yet port none option applic sse simd instruct set introduc intel processor amd essenti x machin exist might good choic need support dinosaur x comput sse present intel core processor sinc notabl amd magnycour still almost recent processor support also consid good baselin content slow simul prefer portabl reason modern processor avx__fma amd bulldoz piledriv later famili h processor avx_ intel processor sinc sandi bridg code work amd bulldoz piledriv processor significantli less effici avx__fma choic fool assum better case avx_ amd zenzen hygon dhyana microarchitectur processor enabl avx way fuse multiplyadd instruct microarchitectur support bit avx instruct henc avx_ also support bit gener faster particular nonbond task run cpu henc default avx_ gpu offload howev avx_ faster zen processor avx_ present intel haswel later processor also enabl intel way fuse multiplyadd instruct avx_ skylakex desktop skylakesp xeon processor gener fastest higherend desktop server processor two bit fuse multiplyadd unit eg core xeon gold howev certain desktop server model eg xeon bronz silver come one avx fma unit therefor processor avx_ faster compil runtim check tri inform case addit gpu acceler run avx_ also faster highend skylak cpu bit fma unit enabl avx__knl knight land xeon phi processor ibm_vsx power power power later arm_neon_asimd bit armv later arm_sv bit armv later scalabl vector extens sve sve vector length fix cmake configur time default vector length automat detect chang via gmx_simd_arm_sve_length cmake variabl minimum requir compil version gnu llvm arm maximum perform strongli suggest latest gcc compil least llvm releas arm releas lower perform observ llvm arm compil cmake configur system check compil chosen target architectur chosen mdrun check runtim doubt choos lowest number think might work see mdrun say configur system also work around mani known issu mani version common hpc compil gmx_simdrefer option exist special simdlik implement written plain c develop use develop support gromac new simd architectur design use product simul use architectur simd support gromac yet port may wish tri option instead default gmx_simdnon often outperform autovector compil good job post gromac mail list gromac probabl port new simd architectur day cmake advanc option option display default view ccmake one think reason number user might want consid chang lot option avail see toggl advanc mode ccmake even variabl might want chang cmake_ gmx_ prefix also option visibl accord whether precondit satisfi _search librari header program help cmake find right librari header program librari instal nondefault locat locat specifi use follow variabl cmake_include_path header file cmake_library_path librari cmake_prefix_path header librari binari eg usrloc respect includ lib bin append path variabl list path specifi unix separ set environ variabl like cmake_prefix_pathoptfftwoptcuda cmake assum bash shell altern variabl also cmake option set like dcmake_prefix_pathoptfftwoptcuda cc cxx environ variabl also use indic cmake compil use similarli cflagscxxflag use pass compil option note append set gromac build platform build type custom advanc cmake option cmake_c_flag rel see also page cmake environ variables_ _cuda gpu acceler cuda gpu acceler cuda_ toolkit instal use cmake cmake dgmx_gpucuda dcuda_toolkit_root_dirusrlocalcuda whichev path instal case might need specifi manual c compil use eg advanc option cuda_host_compil default code gener common cuda architectur howev reduc build time binari size gener code everi singl possibl architectur rare case say tegra system result default build abl use gpu happen want remov architectur reduc binari size build time alter target cuda architectur done either gmx_cuda_target_sm gmx_cuda_target_comput cmake variabl take semicolon delimit string two digit suffix cuda virtual architectur name instanc detail see option steer gpu code gener section nvcc man help chapter nvcc manual gpu acceler test amdx platform linux mac os x window oper system linux besttest support linux run power arm v cpu also work well experiment support avail compil cuda code host devic use clang version later cuda toolkit still requir use gpu devic code gener link cuda runtim librari clang cuda support simplifi compil provid benefit develop eg allow use code sanit cuda hostcod addit use clang cpu gpu compil benefici avoid compat issu gnu toolchain cuda toolkit clang cuda trigger use gmx_clang_cudaon cmake option target architectur select gmx_cuda_target_sm virtual architectur code alway embed request architectur henc gmx_cuda_target_comput ignor note mainli developerori featur recommend product use perform significantli lower code compil nvcc also receiv less test howev note sinc clang perform gap moder time write slower gpu kernel version could consid non performancecrit usecas opencl gpu acceler primari target gromac opencl support acceler simul amd intel hardwar amd target discret gpu apu integr cpugpu chip intel target integr gpu found modern workstat mobil hardwar gromac opencl nvidia gpu work perform limit make less practic detail see user guid build gromac opencl_ support enabl two compon requir opencl_ header wrapper librari act client driver loader socal icd loader addit runtimeonli depend vendorspecif gpu driver devic target also contain opencl_ compil gpu comput kernel compil ondemand run time vendorspecif compil driver need build gromac former compiletim depend standard compon henc stock version obtain linux distribut repositori eg openclhead oclicdlibopencl debianubuntu compat requir opencl_ version required_opencl_min_vers need ensur altern header librari also obtain vendor sdk must instal path found cmake_prefix_path via environ variabl amdappsdkroot cuda_path trigger opencl_ build follow cmake flag must set cmake dgmx_gpuopencl build support intel integr gpu requir add dgmx_gpu_nb_cluster_s cmake command line gpu kernel match characterist hardwar neo driver httpsgithubcomintelcomputeruntimereleases_ recommend mac os amd gpu use os version higher earlier os version known run incorrectli default clfft librari system use gromac none found code fall back version bundl gromac requir gromac link extern librari use cmake dgmx_gpuopencl dclfft_root_dirpathtoyourclfft dgmx_external_clffttru sycl gpu acceler sycl_ modern portabl heterogen acceler api multipl implement target differ hardwar platform similar opencl_ current support platform gromac intel gpu use intel oneapi dpc_ opencl levelzero backend amd gpu hipsycl_ discret gpu gfx rx vega pro vii instinct mi instinct mi cdna instinct mi architectur nvidia gpu experiment use either hipsycl_ opensourc intel llvm httpsgithubcomintelllvm_ featur support broader opencl yet par cuda sycl_ support gromac intend eventu replac opencl_ acceler mechan amd intel hardwar note sycl_ support gromac less matur either opencl cuda pleas pay extra attent simul correct use sycl gpu acceler intel gpu instal recent intel oneapi dpc_ compil toolkit gromac version recommend use opensourc intel llvm httpsgithubcomintelllvm_ possibl extens test also recommend instal recent neo driver httpsgithubcomintelcomputeruntimereleases_ toolkit instal ad environ usual run sourc optinteloneapisetvarssh use appropri commandmodul load hpc system follow cmake flag must set cmake dcmake_c_compilericx dcmake_cxx_compilericpx dgmx_gpusycl sycl gpu acceler amd gpu use recent hipsycl_ develop branch recent rocm releas recommend addit strongli recommend use rocmbundl llvm build hipsycl gromac follow cmake command use configur hipsycl ensur proper clang use assum rocm_path set correctli eg optrocm case default instal cmake dcmake_c_compilerrocm_pathllvmbinclang dcmake_cxx_compilerrocm_pathllvmbinclang dllvm_dirrocm_pathllvmlibcmakellvm compil instal hipsycl follow set use build gromac set hipsycl_target target hardwar cmake dcmake_c_compilerrocm_pathllvmbinclang dcmake_cxx_compilerrocm_pathllvmbinclang dgmx_gpusycl dgmx_sycl_hipsyclon dhipsycl_targetshipgfxxyz sycl gpu acceler nvidia gpu sycl support nvidia gpu highli experiment product pleas use cuda_ cuda gpu acceleration_ note fft current support nvidia devic use sycl pme offload possibl mix mode pme gpu pmefft cpu nvidia gpu use either hipsycl_ opensourc intel llvm httpsgithubcomintelllvm_ hipsycl make sure hipsycl compil cuda support suppli proper devic via hipsycl_target eg dhipsycl_targetscudasm_ compil cuda recommend use mainlin clang rocmbundl one intel llvm make sure compil cuda openmp support use follow cmake invoc cmake dcmake_c_compilerpathtointelclang dcmake_cxx_compilerpathtointelclang dgmx_gpusycl dgmx_gpu_nb_cluster_s dsycl_cxx_flags_extrafsycltargetsnvptxnvidiacuda sycl gpu compil option follow flag pass cmake order tune gromac dgmx_gpu_nb_cluster_s chang data layout nonbond kernel default valu compil intel oneapi dpc_ compil hipsycl_ reason default intel amd devic respect dgmx_sycl_use_usm switch sycl buffer usm data manag default perform reason static link dynam link gromac execut lead smaller disk footprint instal default platform believ test repeatedli found work gener includ linux window mac os x bsd system static binari take space hardwar andor condit necessari commonli run parallel simul use mpi librari eg cray link gromac binari static intern gromac librari set dbuild_shared_libsoff link static extern nonsystem librari well set dgmx_prefer_static_libson note gener cmake pick whatev avail option instruct cmake prefer static librari static share avail static version extern librari avail even aforement option share librari use also note result binari still dynam link system librari platform default use static system librari addit compilerlink flag necessari eg staticlibgcc staticlibstdc attempt link fulli static binari set dgmx_build_shared_exeoff prevent cmake explicitli set dynam link flag option also set dbuild_shared_libsoff dgmx_prefer_static_libson default caveat appli compil dont default static link requir flag specifi linux usual cflagsstat cxxflagsstat gmxapi c api dynam link build nonwindow platform extra librari header instal set dgmxapion default build target gmxapicppdoc gmxapicppdocsdev produc document docsapius docsapidev respect project inform use case refer track issu associ github gmxapi httpsgithubcomkassonlabgmxapi_ project doi bioinformaticsbti httpsdoiorgbioinformaticsbty_ gmxapi yet test window static link use case target futur version portabl aspect gromac build normal portabl even across hardwar base instruct set like x nonport hardwarespecif optim select configuretim simd instruct set use comput kernel select done build system base capabl build host machin otherwis specifi cmake configur often possibl ensur portabl choos least common denomin simd support eg sse x rare case old x machin ensur use cmake dgmx_use_rdtscpoff target cpu architectur support rdtscp instruct howev discourag attempt use singl gromac instal execut environ heterogen mix avx earlier hardwar lead program especi mdrun run slowli new hardwar build two full instal local manag call correct one eg use modul system recommend approach altern one use differ suffix instal sever version gromac locat achiev one first build full instal leastcommondenomin simd instruct set eg dgmx_simdss order simpl command like gmx grompp work machin build special gmx binari architectur present heterogen environ use custom binari librari suffix cmake variabl dgmx_binary_suffixxxx dgmx_libs_suffixxxx instal locat linear algebra librari mention sometim vendor bla lapack librari provid perform enhanc gromac normalmod analysi covari analysi simplic text refer bla option avail lapack default cmake search bla use found otherwis fall back version bla intern gromac cmake option dgmx_external_blason set accordingli intern version fine normal use need specifi nonstandard path search use dcmake_prefix_pathpathtosearch need specifi librari nonstandard name eg essl power machin armpl arm machin set dgmx_blas_userpathtoreachliblibwhatevera use intel mkl_ fft bla lapack provid use automat could overridden gmx_blas_us etc appl platform acceler framework avail automat use bla lapack could overridden gmx_blas_us etc _instal mimic build mimic qmmm support mimic qmmm interfac integr requir link mimic commun librari establish commun channel gromac cpmd mimic commun librari download httpsgitlabcommimicprojectscommlib__ compil instal check instal folder mimic librari ad cmake_prefix_path instal nonstandard locat build qmmmcapabl version requir doubleprecis version gromac compil mpi support dgmx_doubleon dgmx_mpi dgmx_mimicon _instal cpk build cpk qmmm support cpk qmmm interfac integr requir link libcpk librari incorpor cpk function gromac download compil instal cpk version higher requir cpk latest distribut download httpsgithubcomcpkcpkreleases_ cpk specif instruct pleas follow httpsgithubcomcpkcpkblobmasterinstallmd_ also check instruct offici cpk webpag httpswwwcpkorghowto_ make filelibcpka librari execut follow command make archyour arch file versionyour version like psmp libcpk librari archiv eg filelibcpka appear filecpk dirlibarchvers directori configur gromac commandcmak ad follow flag build static dbuild_shared_libsoff dgmxapioff dgmx_install_nblib_apioff doubl precis gener better singl qmmm howev option viabl dgmx_doubleon fft bla lapack librari cpk gromac use follow flag dgmx_fft_libraryyour librari like fftw dfftwf_librarypath librari dfftwf_include_dirpath directori header dgmx_blas_userpath bla dgmx_lapack_userpath lapack compil qmmm interfac control follow flag dgmx_cpkon activ qmmm interfac compil dcpk_dirpath cpkliblocalpsmp directori libcpka librari dcpk_linker_flagscombin ldflag lib option cpk newer librari use cpk typic combin ldflag lib arch file use cpk compil sometim arch file could sever line defin ldflag lib even split one line sever use case concaten one long string without extra slash quot cpk version newer cpk_linker_flag requir still might use specif situat _suffix chang name gromac binari librari sometim conveni differ version gromac program instal common use case singl doubl precis without mpi mechan also use instal sidebysid multipl version mdrun optim differ cpu architectur mention previous default gromac suffix program librari build _d doubl precis andor _mpi mpi noth otherwis control manual gmx_default_suffix onoff gmx_binary_suffix take string gmx_libs_suffix also take string instanc set custom suffix program librari one might specifi cmake dgmx_default_suffixoff dgmx_binary_suffix_mod dgmx_libs_suffix_mod thu name program librari append _mod chang instal tree structur default differ directori cmake_install_prefix use gromac instal chang mainli use packag gromac variou distribut directori list addit note unless otherwis note directori renam edit instal path main cmakeliststxt bin standard locat execut script script hardcod absolut instal prefix need chang script reloc name directori chang use cmake_install_bindir cmake variabl includegromac standard locat instal header lib standard locat librari default depend system determin cmake name directori chang use cmake_install_libdir cmake variabl libpkgconfig inform instal libgromac librari pkgconfig instal lib part adapt instal locat librari instal file contain instal prefix absolut path sharecmak cmake packag configur file instal sharegromac variou data file document go first part chang use cmake_install_datadir second use gmx_install_datasubdir use cmake variabl prefer way chang instal path sharegromacstop sinc path directori built libgromac well script rel absolut path latter fallback everyth els fail shareman instal man page go compil link configur cmake build gromac make expect alway complet success give warn cmaketim test gromac make set choos pretti extens probabl case thought yet search web first solut problem need help ask gmxuser sure provid much inform possibl system build went wrong may mean scroll back long way output make find first error messag multicor multicpu machin n processor use make j n gener speed thing quit bit build gener system support cmake eg ninja also work well _build mdrun binari instal gromac final make instal instal gromac directori given cmake_install_prefix system directori need permiss write use superus privileg make instal whole procedur _get access gromac get access gromac instal gromac instal script gmxrc bin subdirectori instal directori eg usrlocalgromacsbingmxrc sourc shell sourc yourinstallationprefixherebingmxrc detect kind shell run set environ use gromac may wish arrang login script automat pleas search web instruct shell mani gromac program reli data instal sharegromac subdirectori instal directori default program use environ variabl set gmxrc script avail tri guess path base locat usual work well unless chang name directori insid instal tree still need might want recompil new instal locat properli set edit gmxrc script gromac also instal cmake cach file help build client softwar use c option httpscmakeorgcmakehelplatestmanualcmakehtmloptions__ configur client softwar cmake instal yourinstallationprefixher hint file instal yourinstallationprefixsharecmakegromacsgmx_libs_suffixgromacshintsgmx_libs_suffixcmak gmx_libs_suffix refa document suffix test gromac correct sinc gromac develop use autom system everi new code chang subject regress test number platform softwar combin improv reliabl quit lot everyth test sinc increasingli reli cut edg compil featur nonneglig risk default compil system could bug tri best test refus use known bad version cmake strongli recommend run test take minut trust build simplest way run check build gromac dregressiontest_download run make check gromac automat download run test altern download unpack gromac regress test suit gmxregressiontestspackag tarbal use advanc cmake option regressiontest_path specifi path unpack tarbal use test work pleas read regress test also avail download_ section download unpack tarbal sourc gmxrc describ run gmxtestpl insid regress test folder find option eg ad doubl use doubl precis expand run test whose name match expand execut script without option hope get report test pass individu fail test could sign compil bug toler tini bit tight check output file script direct tri differ newer compil error appear real get pass regress test might tri drop line gromac user forum httpsgromacsbioexceleucgromacsuserforum__ includ detail descript hardwar output gmx mdrun version contain valuabl diagnost inform header nonstandard suffix gmx program suffix nonstandard way gmxtestpl suffix option let specifi suffix test machineri use gmxtestpl doubl test doubleprecis version use gmxtestpl crosscompil stop test har attempt check program run use gmxtestpl mpirun srun command run mpi program call srun run mpienabl test make check target also run integrationstyl test may run mpi gmx_mpion set make work variou possibl mpi librari may need set cmake variabl mpiexec mpiexec_numproc_flag mpiexec_preflag mpiexec_postflag mdrunmpitest_mpi would run multipl rank via shell command mpiexec mpiexec_numproc_flag numproc mpiexec_preflag mdrunmpitest_mpi mpiexec_postflag otherflag typic exampl slurm cmake dgmx_mpion dmpiexecsrun dmpiexec_numproc_flagn dmpiexec_preflag dmpiexec_postflag test gromac perform still work set benchmark system test perform gromac readi recommend tri differ parallel option experi tool gmx tune_pm difficulti alon complex task encount problem instal gromac number locat find assist recommend follow step find solut read instal instruct take note follow everi step correctli search gromac webpage_ user email list inform error ad sitehttpsmailmansyskthsepipermailgromacsorg_gmxus googl search may help filter better result search internet use search engin googl post gromac user email list gmxuser assist sure give full descript done think work give detail system instal copi past command line much output think might relev certainli first indic problem particular pleas tri includ least header mdrun logfil prefer entir file peopl might volunt help time ask interact detail followup question get answer faster provid much inform think could possibl help high qualiti bug report tend receiv rapid high qualiti answer _gmxspecialbuild special instruct platform build window build window use nativ compil rather similar build unix pleas start read download unpack gromac sourc archiv make folder outofsourc build gromac exampl make within folder unpack sourc archiv call buildgromac cmake either use graphic user interfac provid window use command line shell instruct similar unix one open shell within ide eg microsoft visual studio configur environ might need tweak order get either bit bit build environ latter provid fastest execut use normal window command shell need either set environ find compil librari run vcvarsallbat batch script provid msvc like sourc bash script unix graphic user interfac ask compil use initi configur stage use command line set similar way unix unfortun dgmx_build_own_fftwon see use fftw_ work window support way build fftw window either build fftw way eg mingw use builtin fftpack may slow use mkl_ build either load gener solut file eg visual studio use command line cmake build right tool get use build cray gromac build mostli box modern cray machin may need specifi use static binari dgmx_build_shared_exeoff may need set f environment variabl ftn compil fftw arm thunderx cray xc machin differ recommend compil arm hpc compil armclang build solari builtin gromac processor detect work solari strongli recommend build gromac dgmx_hwlocon ensur cmake_prefix_path includ path hwloc header librari found least version hwloc recommend oracl develop studio current support compil current compil gromac correctli perhap threadmpi atom incorrectli implement gromac intel xeon phi xeon phi processor host selfhost support knight landingbas xeon phi processor behav like standard x node support special simd instruct set crosscompil node use avx__knl simd flavor knight land processor support socal cluster mode allow reconfigur memori subsystem lower latenc gromac benefit quadrant snc cluster mode care need taken correctli pin thread particular thread mpi rank cross cluster numa boundari addit main dram memori knight land highbandwidth stack memori call mcdram use offer perform benefit ensur mdrun run entir memori recommend mcdram configur flat mode mdrun bound appropri numa node use eg numactl membind quadrant cluster mode test platform best belief gromac build run pretti much everywher import tell realli know work test everi commit git sourc code repositori current test rang configur option x gcc version includ clang version includ cuda version version oneapi contain intel clangbas compil test use ubuntu oper system compil librari os version test less frequent detail look continu integr server use gromac httpsgitlabcomgromacsgromacs_ use gitlab runner local ks x cluster nvidia amd intel gpu support test irregularli arm v fujitsu afx cray power environ compil compil version support pleas refer manual httpmanualgromacsorg_ document download releas note gromac releas visit user forum httpforumsgromacsorg_ discuss advic report bug httpsgitlabcomgromacsgromacsissu _gmxapi gmxapi python packag document part gromac manual httpmanualgromacsorgcurrent_ describ gmxapi python packag pymodgmxapi allow molecular simul analysi work stage run python version latest offici document httpmanualgromacsorgcurrentgmxapi releas also found github httpswwwgithubcomkassonlabgmxapi_ toctre maxdepth caption document section userguideuserguiderst seealso gmxapi public irrgang e davi c kasson p gmxapi gromacsn python interfac molecular dynam ensembl plugin support plo comput biol doi journalpcbi httpsdxplosorgjournalpcbi_ irrgang e hay j kasson p gmxapi highlevel interfac advanc control extens molecular dynam simul bioinformat doi bioinformaticsbti httpsdoiorgbioinformaticsbty_ indic tabl refgenindex refsearch chang log record chang api behavior rubric develop guid toctre maxdepth projectstructur extend contribut datamodel executionmodel contribut document maintain contribut project gmxapi design note open question output node placehold type shape python style prefer subgraph implement overview stub execut model stub gmxapi data model stub basic data type contain handl futur proxi manag resourc oper factori data flow declar definit initi todo refer httpsgitlabcomgromacsgromacsissu express input output note data compat avoid depend c symbol differ bind extens modul dont reli c type bind need schema pycapsul ad gmxapi compat python bind requir depend gmxapi python packag compat interfac instead inherit extend document build code use collabor gromac gmxapi stub discuss concept protocol pure python c gmxapi python modul refer content local depth concis refer document extract directli code new nonbackwardscompat featur api version must given gromac python packag includ highlevel script interfac implement pure python lowerlevel api implement c extens modul pure python implement provid basic gmxapi modul class stabl syntax maintain maxim compat map lower level interfac may take sort separ also serv remind differ execut context may implement quit diffent though python script use highlevel interfac execut packag document extract gmxapi python modul also avail directli use either pydoc command line pyfunchelp within python interact session refer python sourc code addit clarif seealso copi document built without docinstal gmxapi packag userguideinstal therefor lack full modul refer refer refgmxapi_package_document instruct build complet document view onlin httpmanualgromacsorgcurrentgmxapi__ gmxapi python modul refer content local depth concis refer document extract directli code new nonbackwardscompat featur api version must given gromac python packag includ highlevel script interfac implement pure python lowerlevel api implement c extens modul pure python implement provid basic gmxapi modul class stabl syntax maintain maxim compat map lower level interfac may take sort separ also serv remind differ execut context may implement quit diffent though python script use highlevel interfac execut packag document extract gmxapi python modul also avail directli use either pydoc command line pyfunchelp within python interact session refer python sourc code addit clarif seealso refgmxapi_package_document configur doctest autom syntax check document code snippet testsetup import gmxapi gmx gmxapidata import tpr_filenam gmxapi basic packag import gmxapi gmx automodul gmxapi autodecor function_wrapp autofunct commandline_oper autofunct subgraph autofunct while_loop simul modul automodul gmxapisimul pycurrentmodul gmxapi autofunct read_tpr autofunct modify_input autofunct mdrun util automodul gmxapiutil pycurrentmodul gmxapi autofunct concatenate_list autofunct join_array autofunct logical_not autofunct make_const statu messag log automodul gmxapi_log member except modul automodul gmxapiexcept member gmxversion modul automodul gmxapivers member core api automodul gmxapi_gmxapi except autoexcept gmxapi_gmxapiexcept root except c extens modul deriv gmxapiexceptionserror autoexcept gmxapi_gmxapimissingimplementationerror autoexcept gmxapi_gmxapiprotocolerror autoexcept gmxapi_gmxapiunknownexcept autoexcept gmxapi_gmxapiusageerror function tool launch simul autofunct gmxapi_gmxapifrom_tpr tool manipul tpr input file autofunct gmxapi_gmxapicopy_tprfil autofunct gmxapi_gmxapiread_tprfil autofunct gmxapi_gmxapiwrite_tprfil autofunct gmxapi_gmxapirewrite_tprfil class autoclass gmxapi_gmxapicontext member autoclass gmxapi_gmxapimdarg member autoclass gmxapi_gmxapimdsess member autoclass gmxapi_gmxapimdsystem member autoclass gmxapi_gmxapisimulationparamet member autoclass gmxapi_gmxapitprfil member full instal instruct highlight bash instal instruct pymodgmxapi python packag built gromac command line exampl assum bash httpswwwgnuorgsoftwarebash_ shell note regard multipl gromac instal mani gromac user switch multipl gromac instal comput use hpc modul system andor refgmxrc get access gromac configur script equival sort environ switch pymodgmxapi python packag recommend instal differ python virtual environ httpswwwgooglecomsearchqpythonvirtualenvironment_ gromac instal built particular copi pymodgmxapi python packag alway refer gromac instal content content local depth note follow document contain frequent refer pip_ tool instal python packag case unprivileg user use user command line flag tell pip_ instal packag user sitepackag directori rather default sitepackag directori python instal flag appropri run commandpip virtual environ recommend omit document need user flag modifi exampl command look someth like commandpip instal upgrad somepackag user note instruct use execut name commandpython commandpip instead commandpython commandpip python instal requir suffix usual necessari alreadi activ python virtual environ recommend overview typic set gmxapi python packag follow three step overview suffici comput environ may disregard rest document instal gromac locat gromac instal build instal gromac higher seealso gromac instal httpmanualgromacsorgdocumentationcurrentinstallguideindexhtml_ follow assum gromac instal filepathtogromac set python virtual environ python venv homemyvenv homemyvenvbinactiv python ensurepip defaultpip pip instal upgrad pip setuptool wheel seealso refgmxapi venv instal gmxapi python packag pathtogromacsbingmxrc pip instal nocachedir gmxapi seealso refinstal background gmxapi come three part gromac gmxapi librari c python packag support python higher md restraint plugin sampl gmxapi client code gromac requir python packag requir gromac instal locat exist gromac instal build instal gromac httpmanualgromacsorgdocumentationcurrentinstallguideindexhtml_ proceed note note gmxapi requir gromac configur gmxapion build_shared_libson enabl default case option overridden gromac instal see cmake error tri build instal gmxapi python packag client softwar sourc filegmxrc file gromac instal refa normal would get access gromac use gromac note instal locat pass build configur build system requir gmxapi built python higher need c compat compil reason uptod version cmake full gmxapi function may also requir mpi compil eg commandmpicc import build modul import python need python instal includ python header unfortun alway obviou whether header present find simplest answer tri build python packag use instruct gmxapi unabl find python tool need tri differ python instal instal addit develop packag linux system may requir instal packag pythondev andor pythondev build python either scratch tool like commandpyenv instal see wiki entri httpsgithubcompyenvpyenvwikihowtobuildcpythonwithenableshared_ sure enabl instal python c librari enableshar flag altern variou python distribut provid suffici build environ requir instal user home directori exampl use hpc system softwar avail modul may abl commandmodul load differ python instal find one work python environ requir gmxapi requir python higher check version commandpython version commandpython version note follow document assum need use trail access python interpret system default python interpret system may use commandpython commandpip instead commandpython commandpip check version commandpython version commandpython version commandpip version build instal need python packag cmake_ networkx_ setuptools_ avail pypi pip httpspippypaioenstable_ full function also mpipy_ numpy_ requir version number list filerequirementstxt easiest way make sure requir instal first updat pip_ use filerequirementstxt file provid repositori file path section rel root directori local copi gromac sourc confirm pip_ avail instal pip_ miss get instruct instal pip_ python ensurepip defaultpip instal upgrad requir compon python pip instal upgrad pip pip instal upgrad setuptool requir file gromac sourc tree build sourc code local copi gromac sourc repositori help file allow preinstal python requir instal pymodgmxapi packag pip instal r python_packagingsrcrequirementstxt build document run test commandpip instal r python_packagingrequirementsdocstxt commandpip instal r python_packagingrequirementstesttxt respect see document build requir see refgmxapi_package_document _test requir test requir note test suit avail gromac sourc tree part instal packag acquir gromac sourc commandgit download archiv document elsewher test perform pytest httpsdocspytestorgenlatest_ filepython_packagingrequirementstesttxt list addit requir test pip_ pip instal r python_packagingrequirementstesttxt test full function also requir mpi parallel environ need mpipy_ python packag mpi launcher commandmpiexec commandmpirun launcher provid hpc queu system whatev provid favorit mpi packag oper system _mpi_requir mpi requir ensembl simul featur need mpi instal hpc system mean probabl use commandmodul load load compat set mpi tool compil check hpc document tri commandmodul avail look openmpi mpich mvapich modul match compil modul may simpl modul load gcc modul load mpicc note compil load might first compil discov automat build tool use may specifi compil command line consist may necessari requir gromac gmxapi sampl code built compil note strang error known occur mpipy_ built differ differ tool set use build python gmxapi default compil system suffici gromac gmxapi may need build eg openmpi mpich andor build mpipy_ specif mpi compil wrapper complic build environ conda_ abl confirm mpi compil wrapper consist gromac tool chain comapr output commandmpicc version compil inform report commandgmx version set mpicc environ variabl mpi compil wrapper forcibl reinstal mpipy_ export mpiccwhich mpicc pip instal nocachedir upgrad nobinari forcereinstal mpipi differ mpi c compil wrapper substitut commandmpicc _instal instal python packag recommend use python pip httpspippypaioenstable_ packag instal automat download build instal latest version gmxapi packag python virtual environ httpsdocspythonorgtutorialvenvhtml_ though also possibl instal without virtual environ instal without virtual environ unprivileg user may need set cmake variabl gmxapi_user_instal dgmxapi_user_installon commandcmak command line use user option commandpip instal recommend instal instruct section assum pip abl download file internet altern refer refgmxapi offlin instal locat instal gromac need gromac instal includ gmxapi header librari warn gmxapi recogn multipl gromac instal cmake_install_prefix python packag use file instal sharecmakegmxapi configur c compon configur file overwritten instal gromac cmake_install_prefix httpscmakeorgcmakehelplatestvariablecmake_install_prefixhtml__ overlap gromac instal may occur gromac instal multipl configur mpi support float point precis see issu relat issu gromac higher alreadi instal configur gmxapion build time default sourc refgmxrc get access gromac python packag know find gromac skip next section otherwis instal support version gromac build gromac sourc sure configur cmake flag dgmxapion default set environ variabl gromac instal gmxapi header librari found build python packag instal filegromacsgmxapi directori home directori use commandbash shell sourc homegromacsgmxapibingmxrc use gromac instal provid gmxrc see gmxapi cmake hints_ addit cmake hint _gmxapi venv set python virtual environ recommend instal python packag virtual environ instal virtual environ may abl instal necessari prerequisit eg administr system follow instruct use pymodvenv modul altern virtual environ conda_ work fine beyond scope document welcom contribut recip depend comput environ python interpret may access command commandpython commandpython use commandpython version commandpython version figur need use follow assum python interpret access commandpython creat python virtual environ python venv homemyvenv activ virtual environ shell prompt probabl updat name environ creat make obviou codeblock none sourc homemyvenvbinactiv myvenv note activ venv commandpython commandpip suffici suffix longer necessari omit rest document activ virtual environ may chang shell prompt indic environ activ prompt omit remain exampl remain exampl assum virtual environ still activ dont deactiv environ run commanddeactiv instal depend alway good idea updat pip_ setuptools_ wheel_ instal new python packag pip instal upgrad pip setuptool wheel gmxapi instal requir addit packag best make sure instal date proceed pip instal upgrad cmake pybind mpi use mpipy_ make sure use mpi instal build gromac build compat compil python pip instal upgrad pip setuptool mpiccwhich mpicc pip instal upgrad mpipi seealso refmpi_requir instal latest version gmxapi fetch instal latest offici version gmxapi python packag index get latest offici releas pip instal nocachedir gmxapi note use nocachedir forc rebuild pip download sourc distribut archiv gmxapi build wheel packag gromac instal wheel normal get cach use later attempt pip instal gmxapi instead rebuild want upgrad gromac want instal python packag differ gromac configur eg doubleprecis differ mpi option see also issu pypi repositori httpspypiorgprojectgmxapihistory_ may includ prereleas version commandpip ignor unless use pre flag get latest version includ prereleas version pip instal nocachedir pre gmxapi commandpip find gromac instal use one follow environ variabl provid hint instal also look cmake_arg environ variabl found cmake_arg string split addit argument provid cmake build gmxapi packag _gmxapi cmake hint gmxapi_root singl gromac instal filepathtogromac usual suffici provid locat commandpip envvargmxapi_root environ variabl exampl gmxapi_rootpathtogromac pip instal nocachedir gmxapi note equival provid cmake variabl definit cmake_argsdgmxapi_rootpathtogromac pip instal nocachedir gmxapi gromac cmake hint multipl build gromac distinguish suffix eg _d _mpi etcetera need provid extra hint commandpip softwar tool use build gromac specifi cmake hint file includ c initialcach option cmake_arg inform read c command line option httpscmakeorgcmakehelplatestmanualcmakehtmloptions__ cmake follow exampl unique_prefix path directori hold gromac bin lib share directori etc uniqu gromac provid cmake support one build configur time sharecmakegmxapi even multipl librari configur instal locat see issu suffix suffix distinguish particular build gromac want target refer gromac instal instruct inform suffix may simpli empti export cmake_arg environ provid begin pip instal command line cmake_argsdgmxapi_rootunique_prefix c unique_prefixsharecmakegromacssuffixgromacshintscmak pip instal nocachedir gmxapi instal sourc also instal pymodgmxapi python packag within local copi gromac sourc repositori assum alreadi obtain gromac sourc code root directori sourc tree find pymodgmxapi python packag sourc filepython_packagingsrc directori cd python_packagingsrc pip instal r requirementstxt pip instal _gmxapi offlin instal offlin instal requir depend alreadi instal quick instal without internet access either sourc directori sourc archiv exampl last line previou exampl could replac pip instal nocachedir nodep noindex refer pip_ document descript option built download sourc distribut archiv provid archiv file commandpip instead argument pip instal gmxapitargz exampl archiv file name download pypi httpspypiorgprojectgmxapihistory_ built local accord follow instruct build sourc archiv sourc archiv gmxapi python packag built gromac sourc repositori use python setuptool exampl pip instal upgrad setuptool wheel pybind cmake cd python_packagingsrc python setuppi sdist command creat dist directori contain sourc distribut archiv file file name form gmxapiversionsuffix version version setuppi file suffix determin local environ addit argument setuppi new build httpspypabuildreadthedocsioenlatest__ modul somewhat tidier automat manag temporari venv necessari depend pip instal upgrad build cd python_packagingsrc python build sdist seealso python document creat sourc distribut httpsdocspythonorgdistutilssourcedisthtmlcreatingasourcedistribution_ packag maintain may updat onlin repositori upload freshli built sdist python twine upload dist _gmxapi_package_document access gmxapi document document python class function gmx modul access usual way use pydoc command line help interact python session complet document current read brows onlin httpmanualgromacsorgcurrentgmxapi__ built copi gromac sourc repositori document built combin python modul document static content requir local copi gromac sourc repositori build gromac build full gmxapi document gromac configur gromac dgmx_python_packageon build gromac document normal first build gmxapi python packag instal temporari locat build tree sphinx import packag automat extract python docstr note entir cmakedriven instal python depend instal automat updat python environ configur cmake use filerequirementstxt file provid filepython_packag directori repositori exampl pip instal r python_packagingrequirementsdocstxt pip instal r python_packagingrequirementstesttxt sometim build environ choos differ python interpret one intend set python_root_dir cmake_prefix_path cmake variabl explicitli choos python instal venv directori use pyenv pyenvvirtualenv dynam manag python version help identifi particular version pyenv versionnam directori pyenv prefix version exampl dpython_root_dirpyenv prefix pyenv versionnam docker web server altern build doc docker imag python_packagingdockerdocsdockerfil pull prebuilt imag dockerhub refer dockerfil httpshubdockercomrgmxapidoc inform todo document sample_restraint packag refer issu test note test requirements_ instal pymodgmxapi python packag run python test suit gromac sourc tree exampl assum root directori repositori pytest python_packagingsrctest refer filepython_packagingreadmemd detail inform _gmxapi instal troubleshoot troubleshoot attributeerror modul enum attribut intflag older version depend instal might pick transit depend enum packag tri pip uninstal enum see fix problem tri fresh virtual environ see help narrow problem open issu httpsgitlabcomgromacsgromacsissues_ error regard pybind error may occur setuppi output contain someth like follow modulenotfounderror modul name pybind build wheel gmxapi pyprojecttoml finish statu error error fail build wheel gmxapi fail build gmxapi error could build wheel gmxapi requir instal pyprojecttomlbas project import inform pybind found build depend arent alway automat instal even use pip may disabl automat depend fulfil option like nobuildisol nodep case problem resolv explicitli instal pybind python packag attempt build gmxapi pip instal upgrad pybind couldnt find gmxapi support librari dont want sourc refgmxrc get access gromac file tell packag find gmxapi compat gromac instal gmxapi_root eg gmxapi_rootpathtogromac pip instal updat gmxapi packag gener good idea remov previou instal start fresh build directori abl pip uninstal gmxapi see someth like follow codeblock none cmake error gmxcorecmakeliststxt find_packag could find packag configur file provid gmxapi follow name gmxapiconfigcmak gmxapiconfigcmak add instal prefix gmxapi cmake_prefix_path set gmxapi_root directori contain one file gmxapi provid separ develop packag sdk sure instal could gromac alreadi instal gromac built without cmake variabl gmxapion gmxapi_root gromacs_dir path contain directori like bin share system administr encourag instal python virtual environ creat virtualenv conda_ otherwis need specifi user flag pip two easiest problem run incompat compil incompat python tri make sure use c c compil gromac python packag sampl plugin compil also correspond commandmpicc compil wrapper use compil mpipy_ order build python packag need python header develop instal might alreadi instal machin use get error miss filepythonh point multipl python instal modul avail hpc system could tri one python instal system administr could instal appropri python dev packag altern might tri instal anaconda miniconda home directori attempt instal fail cmake error miss gmxapi make sure gromac instal found instal instanc gmxapi_rootusersericgromac python setuppi instal verbos pip relat python packag manag tool littl flexibl ambigu sometim thing get realli mess tri explicitli uninstal pymodgmxapi modul depend repeat commandpip longer find version packag pip uninstal gmxapi pip uninstal cmake success run test suit essenti work pymodgmxapi packag work make test robust right test suit bit delic may work right even though success built pymodgmxapi packag want troubleshoot though main problem seem automat instal requir python packag may work requir manual instal commandpip instal somepackag ambigu python version work develop branch repositori note upstream branch may reset master new releas tag gener particularli devel branch commandgit pull use rebas flag fetch repositori see git statu like git statu branch devel branch origindevel diverg differ commit respect pymodgmxapi probabl enter new develop cycl commandgit pull rebas updat latest develop branch commandgit pull devel get bunch unexpect merg conflict commandgit merg abort git pull rebas back track develop code gmxapi indic rebas featur branch new develop cycl _cmake httpspypiorgprojectcmak _conda httpsdocscondaioenlatest _mpipi httpspypiorgprojectmpipi _networkx httpspypiorgprojectnetworkx _numpi httpswwwnumpyorg _pip httpspippypaioenst _scikitbuild httpspypiorgprojectscikitbuild _setuptool httpspypiorgprojectsetuptool _wheel httpspypiorgprojectwheel use python packag instal gromac sourc gmxrc see gromac doc instal gmxapi python packag see docinstal import packag python script interact interpret document assum conveni alia gmx refer gmxapi python packag import gmxapi gmx full document pythonlevel interfac api use pydoc command line tool pyfunchelp interact python function refer docpythonrefer python except rais gmxapi descend catchabl classgmxapiexceptionserror addit statu messag acquir refgmxapi log facil unfortun error occur gromac librari yet recover python level much standard gromac termin output yet access python find particularli problemat scenario pleas file gromac bug report instal gmxapi python packag becom tie specif gromac instal would like access multipl gromac instal python build instal gmxapi separ refvirtu environ gmxapi venv _parallel note parallel mpi launch gmxapi script mpi environ commandmpiexec commandsrun must help gmxapi detect mpi environ ensur pymodmpipi load refer refmpi_requir instal pymodmpipi assum use commandmpiexec launch mpi job environ run gmxapi script two rank someth like follow note help provid commandmpiexec full path intend python interpret sinc new process environ creat mpiexec n python mpipi myscriptpi gmxapi limit parallel futur version includ seamless acceler integr improv gromac librari comput environ runtim resourc current gmxapi gromac librari effect way share mpi environ therefor intend run one simul time parallel gmxapi script build gromac threadmpi instead standard mpi librari ie configur gromac cmake flag dgmx_thread_mpion launch gmxapi script one mpi rank per node gmxapi assign nonmpi simul node keep full mpi environ avail use via pymodmpipi run simpl simul gmxapi packag instal run simul easi pyfuncgmxapiread_tpr import gmxapi gmx simulation_input gmxread_tprtpr_filenam md gmxmdrunsimulation_input note set work want perform immedi trigger execut explicitli trigger execut mdrun let gmxapi automat launch work respons data request pyfuncgmxapimdrun oper produc simul trajectori output use mdoutputtrajectori input oper get output directli call mdoutputtrajectoryresult simul run yet result call simul run function return run ensembl simul run batch simul pass array input md gmxread_tprtpr_filenam tpr_filenam mdrun make sure launch script mpi environ suffici number rank allow one rank per simul gmxapi recommend configur gromac build gmx_thread_mpion allow one rank per node order allow simul ensembl member run separ node seealso refparallel _commandlin access command line tool gmxapi gromac tool yet expos gmxapi python oper classgmxapicommandline_oper provid way convert commandgmx command line tool oper use gmxapi script order establish data depend input output file need indic input_fil output_fil paramet input_fil output_fil key word argument dictionari consist file key command line flag exampl might creat commandgmx solvat oper solvat gmxcommandline_operationgmx argumentssolv box input_filesc structurefil output_filesp topfil structurefil check statu error output command line oper refer returncod stderr output access result output file argument use command line flag key file dictionari output exampl structurefil solvateoutputfileoresult solvateoutputreturncoderesult printsolvateoutputerroroutputresult prepar simul continu previou exampl output solvat may use input grompp grompp gmxcommandline_operationgmx grompp input_fil f mdpfile p solvateoutputfilep c solvateoutputfileo po mdout_mdp output_fileso tprfile gromppoutputfileo use input pyfuncgmxapiread_tpr simul input modifi pyfuncgmxapimodify_input oper pass pyfuncgmxapimdrun gmxapi subset mdp paramet may overridden use dictionari pass paramet key word argument exampl simulation_input gmxread_tprgromppoutputfileo modified_input gmxmodify_inputinputsimulation_input parametersnstep md gmxmdruninputmodified_input mdrun use arbitrari python function gener function gmxapi packag return object refer node work graph repres oper run graph execut object output attribut provid access data futur provid input oper comput actual perform also provid nativ python data input oper oper nativ result retriev futur result method howev trivial convert python function gmxapi compat oper pyfuncgmxapifunction_wrapp function input output must name type addit function stateless import eg via python somemodul import myfunct futur compat simpl function use pyfuncreturn publish output long defin return valu type annot function multipl output accept output key word argument assign valu name attribut receiv argument exampl gmxapi import function_wrapp function_wrapperoutputdata float def add_floata float b float float return b function_wrapperoutputdata bool def less_thanlh float rh float outputnon outputdata lh rh seealso python type hint function annot check pep subgraph basic gmxapi work consist flow data oper output oper input form direct acycl graph dag mani case use repeat execut subgraph updat input may want data refer tie immut result singl node work graph instead refer recent result repeat oper one oper stage pyclassgmxapioperationsubgraph sort metaoper factori store input bind behavior instanc creat without provid input argument subgraph variabl serv input output mutabl intern data refer updat oper subgraph variabl also allow state propag iter subgraph use loop use pyfuncgmxapisubgraph creat new empti subgraph variabl argument declar data handl defin state subgraph run initi input subgraph give variabl name valu popul subgraph enter subgraphcontext use pyfuncwith statement oper creat block captu subgraphcontext defin subgraph output assign oper output subgraph variabl within block exit block subgraph may use creat oper instanc may execut repeatedli loop note object return pyfuncgmxapisubgraph atyp gmxapi oper special behavior use python context manag httpsdocspythonorgreferencedatamodelhtmlcontextmanagers__ enter builder state chang behavior attribut variabl operaton instanti exit pyfuncwith block subgraph variabl longer assign oper refer obtain within block longer valid loop oper execut arbitrari number time pyfuncgmxapiwhile_loop provid factori function oper argument loop oper run oper instanti run repeatedli condit evalu true pyfuncgmxapiwhile_loop provid direct way provid oper argument use subgraph defin data flow iter oper condit subgraph variabl variabl evalu run subgraph instanc begin iter exampl subgraph gmxsubgraphvariablesfloat_with_default bool_data true subgraph defin updat float_with_default come add_float oper subgraphfloat_with_default add_floatsubgraphfloat_with_default outputdata subgraphbool_data less_thanlhssubgraphfloat_with_default rhsoutputdata operation_inst subgraph operation_instancerun assert operation_instancevaluesfloat_with_default loop gmxwhile_loopoperationsubgraph conditionsubgraphbool_data handl loop assert handleoutputfloat_with_defaultresult _gmxapi log log gmxapi use python pymodlog modul provid hierarch log organ submodul access logger gmxapilogg import gmxapi python log framework import gmxapi gmx import log get root gmxapi logger gmx_logger logginggetloggergmxapi set low default log level gmx_loggersetlevelloggingwarn make tool verbos descend hierarchi gmx_loggergetchildcommandlinesetlevelloggingdebug direct refer logginggetloggergmxapimdrunsetlevelloggingdebug may prefer adjust log format manipul log handler exampl tag log output mpi rank tri mpipi import mpi rank_numb mpicomm_worldget_rank except importerror rank_numb rank_tag mpi none els rank_tag rankformatrank_numb formatt loggingformatterrank_tag nameslevelnam messag addit consol log creat attach stream handler ch loggingstreamhandl chsetformatterformatt logginggetloggeraddhandlerch inform refer python log document httpsdocspythonorglibrarylogginghtml__ refer docpythonrefer complet granular document inform write use pluggabl simul extens code refer httpsgitlabcomgromacsgromacsissu gmxapi gromac see httpsgithubcomkassonlabsample_restraint todo issu replac link resourc pluggabl extens code becom avail python user guid toctre maxdepth instal usag pythonrefer instal gromac gmxapi python packag use pydoc gmxapi command line import gmxapi helpgmxapi within python packag modul document todo exampl script see issu httpsgitlabcomgromacsgromacsissues_ ad new listedinteract type nblib nblib current code path list interact occur two three four five differ particl easi extend nblib support novel formul particl interact modifi follow three file two center interact must use distanc center input forc kernel three center interact take form particlei particlej particlek case middl particl particlej taken center around angl comput angl must input three center forc kernel likewis four center interact dihedr angl phi must input forc kernel accept constraint possibl add new kernel modifi follow three file bondtypesh_ definitionsh_ kernelshpp_ _bondtypesh bondtypesh file contain one struct interact type paramet set new interact type ad separ struct content requir conveni exist named_meb macro combin inherit stdtupl stdarray may use macro use defin paramet name correspond setter getter exampl named_membersforceconst equildist expand code cpp inlin auto forceconst return stdgetthi inlin auto equildist return stdgetthi inlin const auto forceconst const return stdgetthi inlin const auto equildist const return stdgetthi put everyth togeth one could defin complet paramet set new interact type follow code cpp brief new bond type vr forceconst equildist scalefactor forceconst exp r equildist scalefactor struct newbondtyp public stdtupler real int newbondtyp default newbondtypeforceconst f equildist scalefactor stdtupler real int f named_membersforceconst equildist scalefactor _definitionsh definitionsh file begin preprocessor macro list classifi concret interact type two three four five center type add new type user must add interact type paramet struct name macro correct center number case newbondtyp exampl two center interact would get ad supported_two_center_typ macro assum two center interact call defaultbond result would look like follow snippet code cpp defin supported_two_center_typ defaultbond newbondtyp _kernelshpp ad newbondtyp macro ensur nblib molecul class addinteract function support ad new bond type includ list interact data topolog class provid note c there altern preprocessor macro ad requir templat instanti control macro describ nblib design decis took want expos templat interfac user header reason explicitli need instanti interfac support list interact type defin macro kernelshpp file actual forc kernel interact type implement kernel call templat allow variou precis access overload bondkernel extract relev paramet const newbondtyp argument kernel return type alway stdtupl forc potenti code cpp brief kernel calcul new bond type forc param k forc constant param x equilibrium distanc param scale scale factor param x input bond length return tupleforc potenti energi templat class stdtuplet newbondforcet k x scale x real expon stdexp x x scale real epot k expon real forc epot scale return stdmake_tupleforc epot templat class inlin auto bondkernelt dr const newbondtyp bond return newbondforcebondforceconst bondequildist bondscalefactor dr _nblib nblib api document part gromac manual httpmanualgromacsorgcurrent_ describ nblib api toctre maxdepth caption document section guidetowritingmdprogramsrst guid write md program goal nblib enabl research programmat defin molecular simul tradit perform use collect execut manual workflow follow blackbox simul engin nblib allow user script varieti novel simul analysi workflow granular level mani possibl use case facilit flexibl nblib allow includ custom updat rule defin custom forc orchestr swarm simul nblib also allow write convent md simul analysi document goe step write md program use api nblib expos featur part gromac packag global definit nblib program written c header io advanc task must includ addit one must includ header variou capabl abstract nblib expos well directli copi final use namespac nblib data structur defin librari last line block allow one skip specifi time function data structur use code cpp includ cstdio includ nblibboxh includ nblibforcecalculatorh includ nblibintegratorh includ nblibmoleculesh includ nblibnbkerneloptionsh includ nblibparticletypeh includ nblibsimulationstateh includ nblibtopologyh use namespac nblib defin particl data code cpp paramet gromo compat forcefield h struct owateratom particlenam name ow mass mass c c c c e struct hwatom particlenam name hw mass mass c c c c struct cmethatom particlenam name cm mass mass c c c c e struct hcatom particlenam name hc mass mass c c e c c e mani struct kind particl type system organ data like strictli necessari shown purpos clariti shown multipl particl correspond singl element atom mass vari molecular context exampl carbon atom carboxyl group would differ paramet one methyl group obtain paramet set standard forcefield gener new paramet studi new compound forc field exampl come h paramet set httpspubsacsorgdoiacsjctcb__ defin coordin veloc forc buffer code cpp stdvectorgmxrvec coordin stdvectorgmxrvec veloc stdvectorgmxrvec forc initi coordin particl use stdvector gmxrvec specif data type hold vector quantiti doxygen page rvec here__ __ doxygenrefrvec_ write md program basic c program need main function defin particletyp code cpp int main bring paramet struct scope owatom owatom hwatom hwatom cmethatom cmethatom hcatom hcatom creat particl particletyp owowatomnam owatommass particletyp hwhwatomnam hwatommass particletyp cmcmethatomnam cmethatommass particletyp hchcatomnam hcatommass helper struct defin particletyp data strictli need shown clariti line particletyp cmethatomparticlenamecm mass would suffici defin nonbond interact code cpp particletypeinteract interactionscombinationrulegeometr add nonbond interact particl type interactionsaddowatomnam owatomc owatomc interactionsaddhwatomnam hwatomc hwatomc interactionsaddcmethatomnam cmethatomc cmethatomc interactionsaddhcatomnam hcatomc hcatomc lennardjon interact defin particletypeinteract object particl particletyp interact base c c paramet paramet two differ particl averag use geometr lorentzberthelot combinationrul detail httpmanualgromacsorgdocumentationreferencemanualfunctionsnonbondedinteractionshtmlthelennardjonesinteraction__ default combinationrulegeometr select add interact paramet particl type particletypeinteract object result tabl interact specifi particletyp pair follow matrix describ pairwis c paramet creat use combinationrulegeometr ow hw cm hc ow e hw cm e hc e e e particular interact pair user also overrid specifi combinationrul custom paramet follow overload would replac paramet comput combinationrul ow cm particl type code cpp interactionsaddow cm e facilit modular reusabl code possibl combin multipl particletypeinteract object assum otherinteract defin done interactionsmergeotherinteract defin molecul code cpp molecul waterwat molecul methanemethan wateraddparticleparticlenameo ow wateraddparticleparticlenameh hw wateraddparticleparticlenameh hw wateraddexclusionh wateraddexclusionh methaneaddparticleparticlenamec cm methaneaddparticleparticlenameh hc methaneaddparticleparticlenameh hc methaneaddparticleparticlenameh hc methaneaddparticleparticlenameh hc methaneaddexclusionh c methaneaddexclusionh c methaneaddexclusionh c methaneaddexclusionh c begin declar molecul constitu particl string identifi must uniqu identifi specif particl within molecul also possibl defin partial charg particl comput coulomb interact wateraddparticleparticlenameo charg ow ad exclus ensur nonbond interact comput necessari exampl two particl share bond potenti energi bond make nonbond term neglig particl selfexclus enabl default use uniqu identifi specifi addparticl list interact later defin list interact within molecul one defin interact bond angl dihedr constitu particl nblib provid concret implement sever commonli use center interact code cpp harmonicbondtyp ohharmonicbond harmonicbondtyp hcharmonicbond defaultangl hohangledegre defaultangl hchangledegre add harmon bond water wateraddinteractiono h ohharmonicbond wateraddinteractiono h ohharmonicbond add angl water wateraddinteractionh h hohangl add harmon bond methan methaneaddinteractionh c hcharmonicbond methaneaddinteractionh c hcharmonicbond methaneaddinteractionh c hcharmonicbond methaneaddinteractionh c hhcharmonicbondc add angl methan methaneaddinteractionh c h hchangl methaneaddinteractionh c h hchangl methaneaddinteractionh c h hchangl methaneaddinteractionh c h hchangl methaneaddinteractionh c h hchangl methaneaddinteractionh c h hchangl defin option simul nonbond calcul code cpp defin box simul box box defin option nonbond kernel nbkernelopt option one defin bound box either singl argument cube argument specifi length breadth height separ nbkernelopt contain set flag configur option hardwar context relev calcul simul follow tabl describ possibl option set flag config type implic option usegpu bool use gpu nonbond comput ean numthread int number cpu thread use ger nbnxmsimd enum kernel simd type simdautosimdnosimdxm simdxmm ljcombin enum lennardjon combin rule rule geometriclorentzberthelot usehalfljoptimizat bool enabl iclust halflj optim ion ean pairlistcutoff real specifi pairlist interact cutoff computevirialanden bool enabl energi comput ergi ean coulombtyp enum coulomb interact function pmecutoffreactionfield usetabulatedewaldc bool use tabul pme grid correct orr ean instead analyt numiter int specifi number iter ger kernel cyclesperpair bool enabl print cyclespair instead ean pairscycl timestep real specifi time step defin topolog simul state build system topolog use topologybuild class add molecul object defin previous along particletypesinteract use public function get actual topolog object complet exclus interact map list interact data construct base defin entiti use buildtopolog function code cpp topologybuild topologybuild add molecul topologybuilderaddmoleculewat topologybuilderaddmoleculemethan add nonbond interact map topologybuilderaddparticletypesinteractionsinteract topolog topolog topologybuilderbuildtopolog need fulli describ system use simulationst object built use topolog box particl coordin veloc object serv snapshot system use analysi start simul known state code cpp simulationst simulationstatecoordin veloc forc box topolog write md loop fulli describ system problem need two entiti write md loop first forcecalcul second integr nblib come leapfrog integr also possibl user write custom integr code cpp forc calcul contain data need comput forc forcecalcul forcecalculatorsimulationst option integr requir mass posit forc leapfrog integratorsimulationst alloc forc buffer gmxarrayrefgmxrvec userforcestopologynumparticl md loop int numstep numstep userforc forcecalculatorcomput forc automat updat case user want add stdcopyuserforcesbegin userforcesend beginsimulationstateforc integr time step fs integratorintegr return main _doxygenrefrvec doxygenhtmllibnamespacegmxxhtmlacadeadfedbdesign goal motiv data format bond forc nblib current format list forc gromac look like code cpp struct interactiondefinit stdvectort_iparam iparam stdarraystdvectorint f_nre il format cover interact type ie t_iparam union type hold paramet type member call il contain indic interact type f_nre number interact type gromac support precis member il stdvectorint flatten list interact given interact type vector contain n integ indic interact n number particl involv interact addit index need retriev correct paramet iparam henc total number indic sum n per interact big advantag store type union data type allow loop type simpl forloop pre c perhap even pre c time loop differ type big hassl union data type approach like practic solut one downsid approach howev singl union type one cant leverag compil type system importantli static branch exampl overload resolut consequ dynam branch statement remain consid instanc implement toplevel calc_listedconst interactiondefinit idef gromac essenc look like code cpp void calc_listedconst interactiondefinit idef manag time multithread int ftype ftype f_nre type branch descend stack intermedi function base type interact ftype correspond call function pointer tabl bondfunct bond bondedinteractionfunctionsftyp comput forc ftype bondedidefiparam idefilftyp reduc thread output gromac support lot differ list interact type differ type bond angl proper improp dihedr differ type requir differ handl final right forc kernel chosen tabl function pointer handl code requir correctli branch differ case result quit deep call stack lot branch logic end account fair part overal complex ideal consist typespecif forc calcul implement typeawar approach list forc nblib aim reduc overal code complex typeawar data format interact type implement separ ctype format given interact type look like code cpp templat class interact struct interactiondata stdvectorindexinteract indic stdvectorinteract paramet type interact store interact indic plu interact paramet ctype differ actual data store exactli n integ indic per ncenter interact plu uniqu paramet exampl interact would harmonicbond public part look like code cpp class harmonicbond public return lvalu ref use stdtie order leverag stdtupl comparison op const real forceconst const real equildist index trait class deduc stdarrayint harmon bond need two int coordin indic third int look bond paramet paramet vector angl dihedr index trait would add addit one two int hold addit coordin indic final gather type interact stdtupl complet definit list forc nblib look like code cpp use listedinteract stdtupleinteractiondataharmonicbond interactiondataharmonicangl one import properti listedinteract store exactli inform interactiondefinit therefor convers either direct easi implement nblib list forc pipelin given list interact data provid format describ step requir calcul correspond forc brief loop interact type loop interact given type call interact type kernel store forc return energi procedur ident current implement gromac actual code first step look like code cpp templateclass buffer class pbc auto reducelistedforcesconst listedinteract interact const stdvectorgmxrvec x buffer forc const pbc pbc stdarrayr stdtuple_sizelistedinteractionsvalu energi lambda function appli type auto computeforcetyp forc x energi pbcconst auto ielem real energi computeforcesielemindic ielemparamet x forc pbc energiesfindindexstddecay_tdecltypeilem listedinteract energi appli lambda bond type for_each_tuplecomputeforcetyp interact return energi help gener lambda cs stdappli onelin for_each_tupl gener loop differ type tupl quit effortlessli reducelistedforc implement loop interact type next layer computeforc implement loop interact given type code cpp templat class index class interactiontyp class buffer class pbc real computeforcesconst stdvectorindex indic const stdvectorinteractiontyp iparam const stdvectorgmxrvec x buffer forc const pbc pbc real epot const auto index indic epot dispatchinteractionindex iparam x forc return epot compar union data type approach loop manual implement interact type nblib singl implement requir level individu bond angl dihedr point next step depend actual type interact instead dispatch harmon bond cubic bond harmon angl seper path yet differenti base number interact center overload resolut appropri version dispatchinteract get call one case center interact code cpp templat class buffer class twocentertyp class pbc stdenable_if_tistwocentertwocentertypevalu real dispatchinteractionconst interactionindextwocentertyp index const stdvectortwocentertyp bondinst const stdvectorgmxrvec x buffer forc const pbc pbc int stdgetindex int j stdgetindex const gmxrvec x xi const gmxrvec x xj const twocentertyp bond bondinstancesstdgetindex gmxrvec dx calcul x x modulo pbc pbcdxaiucx x dx real dr dotdx dx real dr stdsqrtdr auto forc energi bondkerneldr bond avoid divis dr forc dr detailspreadtwocenterforcesforc dx forcesi forcesj return energi observ common part among differ center interact type reus common part coordin retriev comput scalar distanc spread scalar part forc two center remain thing call actual kernel comput forc sinc bond distinct type use overload resolut code cpp templat class auto bondkernelt dr const harmonicbond bond return harmonicscalarforcebondforceconst bondequildist dr call actual kernel simplest form harmon bond look like code cpp templat class stdtuplet harmonicscalarforcet k x x real dx x x real dx dx dx real forc k dx real epot k dx return stdmake_tupleforc epot flop that approach outlin manag reus differ type signific part code feed input data forc kernel notabl singl ifftyp requir implement control flow remain part featur complet implement overload dispatchinteract center interact typeawar wrapper differ kernel implement gromac omit breviti note multithread multithread handl toplevel reducelistedforc describ parallel execut input listedinteract tupl split nthread part buffer object set thread reducelistedforc call thread assign fraction listedinteract buffer argument lifetim listedinteract split coupl domain decomposit summari nblib list forc employ ctype awar data format otherwis equival counterpart gromac typeawar data format use simplifi rout layer connect data input appropri kernel thank static branch polymorph increas code reus simplifi branch logic could achiev forc kernel need chang nblib refer gromac implement outlook data flow manag list forc describ allow improv implement aggreg interact type fuse interact differ type aggreg type exampl dihedr interact bond angl present among four particl indic combin singl aggreg interact allow reus particl coordin load memori multipl type also combin store oper forc type aggreg also like simplifi effici gpu implement list forc separ topolog contain paramet set system state b two separ topolog b system state _releasenot releas note releas note record chang made major patch releas gromac major releas contain chang function support wherea patch releas contain fix issu identifi correspond major releas two version seri gromac activ mainten within support lifetim time seri seri latter highli conserv fix made address issu affect scientif correct natur releas made year end keep year origin releas version name user understand date version fix also incorpor recent releas seri appropri around time releas made seri longer maintain issu number report releas note detail found issu tracker_ issu number gromac seri todolist patch releas toctre maxdepth major releas toctre maxdepth majorhighlight majorfeatur majorperform majorapi majortool majorbugsfix majordeprecatedfunction majorremovedfunction majorport majormiscellan gromac seri major releas toctre maxdepth majorhighlight majorfeatur majorperform majorapi majortool majorbugsfix majordeprecatedfunction majorremovedfunction majorport majormiscellan older unmaintain gromac seri gromac seri patch releas toctre maxdepth major releas toctre maxdepth majorhighlight majorfeatur majorperform majortool majorbugsfix majordeprecatedfunction majorremovedfunction majorport majormiscellan gromac seri patch releas toctre maxdepth major releas toctre maxdepth majorhighlight majorfeatur majorperform majortool majorbugsfix majordeprecatedfunction majorremovedfunction majorport majormiscellan gromac seri patch releas toctre maxdepth major releas toctre maxdepth majorhighlight majorfeatur majorperform majortool majorbugsfix majordeprecatedfunction majorremovedfunction majorport majormiscellan gromac seri patch releas toctre maxdepth major releas toctre maxdepth majorhighlight majorfeatur majorperform majortool majorbugsfix majorremovedfeatur majorport majormiscellan gromac seri patch releas toctre maxdepth major releas toctre maxdepth majorhighlight majornewfeatur majorperform majortool majorbugsfix majorremovedfeatur majormiscellan toctre maxdepth olderindex gromac releas note version releas todo releas note document chang taken place gromac sinc previou version fix known issu also incorpor fix made version earlier find describ refreleasenot note develop pleas use underlin individu entri fix issu subfold otherwis format webpag mess also pleas use syntax issuenumb refer issu gitlab without space colon number fix mdrun could behav incorrectli extend error messag freeenergi exclus beyond rlist freeenergi decoupl simul error exclus beyond rlist occur due small box caus ad error messag issu issu fix run lj pme simul lj pme electrostat pme would fail run due error task assign issu fix miss synchron cuda updat kernel use gpu updat settl linc constraint virial calcul could incorrect volta newer nvidia gpu turn would lead incorrect pressur gpu updat enabl default error appear simul manual select even case error might rare sinc observ practic test perform check whether run could affect pleas examin mdrun log file look line gpu support cuda look line pp task updat constrain coordin gpu check whether gpu valu comput cap higher gpu info section three present bug could perturb virial calcul turn led incorrect pressur coupl gromac version prior allow offload updat constraint calcul gpu affect issu fix gmx tool tri guess atom name gmx rm unless need guess atom mass base atom name may sometim fail nomw switch use atom mass need gmx rm tri guess anyway throw fatal error unknown element encount error rais mass actual need issu fix affect portabl miscellan correct unit awh interv user guid appli awh angl dihedr unit bond sampl interv list mdp section user guid state degre guid incorrectli state radian wherea code interpret user input degre issu fix distanc restraint forc calcul case neg prefactor calcul distanc restraint forc quadrat regim weak restraint violat linear regim strong restraint violat interchang case neg forc constant issu gromac releas note version releas januari th releas note document chang taken place gromac sinc previou version fix known issu also incorpor fix made version earlier find describ refreleasenot note develop pleas use underlin individu entri fix issu subfold otherwis format webpag mess also pleas use syntax issuenumb refer issu gitlab without space colon number fix mdrun could behav incorrectli scale coordin frozen atom parrinellorahman pressur coupl parrinellorahman pressur coupl use box scale appli atom caus frozen atom shift effect drastic toward side box pressur chang significantli simul frozen atom ignor coupl atom frozen dimens shall keep valu issu properli account deltah contribut pme run awh fep linear dhdl contribut pme pme calcul gpu separ pme rank calcul late taken account fep steer awh pleas verifi simul result simul run fep steer awh pme gpu use separ pme rank issu fix read awh user pmf read larg pmf valu read user suppli awh input mdrun pmf valu larger kt would caus mdrun exit assert failur valu kt allow exceed caus exit clear error messag issu fix gmx tool gmx make_edi close output file properli previous file close explicitli leav result runtim environ work environ outofbound overflow incorrect output fix gmx spatial sever issu memori manag gmx spatial address outofbound memori write confus error messag coordin exactli boundari happen xtc file norm could becom neg due integ overflow neg ign default led incorrect number grid point coordin grid point incorrect especi ign nonzero norm calcul incorrect default nab valu increas issu fix affect portabl miscellan perform improv run ampereclass nvidia gpu improv perform shortrang nonbond kernel issu gromac releas note version releas march th releas note document chang taken place gromac sinc previou version fix known issu also incorpor fix made version earlier find describ refreleasenot note develop pleas use underlin individu entri fix issu subfold otherwis format webpag mess also pleas use syntax issuenumb refer issu gitlab without space colon number fix mdrun could behav incorrectli fix mimic virtual site like mimic virtual site work correctli call construct site place call use site work test issu fix mass perturb dhdlambda contribut perturb mass miss dhdlambda note contribut miss foreign energi differ use bennett accept ratio method issu run awh convolv potenti fep dimens give wrong result output pmf wrong use awhpotenti convolv pull dimens combin fep dimens fep dimens alway use umbrella potenti combin work properli disabl grompp issu remov veloc partial frozen atom mdvv mdvv would add veloc frozen dimens partial frozen atom constrain lead wrong trajectori frozen dimens posit kept fix propag nonzero veloc howev report trajectori final configur might also lead slightli wrong kinet energi sinc report kinet energi calcul veloc constrain effect expect rel small sinc accumul veloc regularli reset zero per step issu fix gmx tool fix period boundari condit analysi framework tool bug trajectori analysi framework caus molecul broken pbc made whole would usual lead obvious incorrect outlier analysi output issu fix rang check bug gmx covar check invert caus rang check appli wrong issu fix variou bug gmx xpmp numer minor issu introduc refactor sinc gromac fix issu fix affect portabl fix compil cygwin gromac header file includ necessari standard header problem m_pi math constant defin posix c also work around issu improv grompp check awh set sampl fep dimens ensur awh sampl interv compat nstcalcenergi sampl fep dimens use awh avoid crash first awh sampl step step set correct issu miscellan updat gromac logo gromac releas note version releas may th releas note document chang taken place gromac sinc previou version fix known issu also incorpor fix made version earlier find describ refreleasenot note develop pleas use underlin individu entri fix issu subfold otherwis format webpag mess also pleas use syntax issuenumb refer issu gitlab without space colon number fix mdrun could behav incorrectli remov potenti race condit gpu updat fix possibl far unobserv race condit coordin copi use gpu updat dipol moment calcul issu avoid issu global reduct observ mdvv new implement mdvv modular simul could produc floatingpoint except comput valu nonmast rank never use fix avoid comput integr unaffect overwrot valu comput issu prohibit settl interact atom perturb mass older implement produc vari degre wrong result never implement mdrun grompp refus handl system suggest use normal constraint issu rerun write pull output correctli refactor omit preserv pullfxvg pullxxvg file written rerun version affect well pull output file written use earlier issu fix gmx tool fix incorrect behaviour singl residu chain pdbgmx code chcking cyclic molecul could lead singl residu chain incorrectli assign circular molecul issu fix grompp check posit restraint absolut refer fix grompp posit restraint would alway issu warn use absolut refer even absolut refer use issu fix error use vmd plugin tool would crash c librari assert plugin load code incorrectli tri construct string nullptr issu fix file permiss gmx solvat gmx genion use write temporari file unix permiss respect umask process typic issu fix affect portabl support intel oneapi compil fix compil infin math mkl flag fix appl opencl build issu fix compil issu gcc issu miscellan fix bond type gromo forc field bond type c n ace incorrect issu allow pme cpu run domain decomposit gpu updat relax limit prevent run parallel run domain decomposit gpu updat use cpu pme long combin pppme rank use allow parallel run scale cpu resourc suffici pme issu gromac releas note version releas novemb th releas note document chang taken place gromac sinc previou version fix known issu also incorpor fix made version earlier find describ refreleasenot note develop pleas use underlin individu entri fix issu subfold otherwis format webpag mess also pleas use syntax issuenumb refer issu gitlab without space colon number fix mdrun could behav incorrectli fix crash larg system virtual site larg system virtual site ran domain decomposit openmp thread mdrun would crash number atom domain halo issu fix bug gpu linc occasion shift atom wrong direct due miss block synchron cuda version linc share memori occasion overwritten new data may slightli affect final coordin shift atom issu disabl use pme mix mode fep simul use mix mode pme pme gpu pmefft cpu led incorrect comput mathfracparti vpartial lambda fep simul mix mode use explicitli request user issu fix spuriou nan awh free energi output run fep dimens run awh alchem free energi perturb one multipl dimens free energi output could contain nan entri due fail log oper affect awh bia mean simul affect output issu made mdrun work without mpi configur neither mpi threadmpi mdrun would termin assert failur issu fix gmx tool fix gmx converttpr formerli combin could use suppli index file combin also use default index group suppli index file grompp print note combin center mass motion remov posit restraint issu static select larg index group work command like gmx distanc f trajxtc n ndxndx select group contact work size contact less number atom restrict bug fix contact make take size similar use static select deriv index group also work issu static select index group repeat indic work static group index file referenc select eg gmx tool select group contact work correctli never adjac repeat index within group repeat index meaning eg list interatom distanc analyz gmx distanc analyz previous index group written like order work issu fix affect portabl miscellan fix bug affect rerun gmxapi script typo may prevent gmxapi simul continu checkpoint interrupt fix version gmxapi python packag issu gromac releas note version releas august th releas note document chang taken place gromac sinc previou version fix known issu also incorpor fix made version earlier find describ refreleasenot note develop pleas use underlin individu entri fix issu subfold otherwis format webpag mess also pleas use syntax issuenumb refer issu gitlab without space colon number fix mdrun could behav incorrectli fix mdrun ddorder pp_pme rank order pppme mdrun would deadlock initi phase issu fix gmxapi md plugin bind molecular dynam extens code properli handl ad simul gmxapi python interfac meant restraint potenti would silent fail appli gmxapi version updat appli intern gmxapi gmxapi python packag support updat gromac api issu error simul attempt bind extern plugin code compatiblebutbroken api gromac third parti code need updat develop note addit null restraint httpsgitlabcomgromacsgromacstreemasterpython_packagingsample_restraint illustr test purpos issu issu fix multirank restart checkpoint written singlerank simul current singlerank simul never use updat group howev multirank run fix ensur atom within updat group alway start period imag guarante checkpoint written singlerank simul issu fix gmx tool fix gmx nmr viol option tool would previous fail cryptic error also enforc option exclus analysi mode issu fix gmx dipol quad option tool report correct valu issu make sure gmx converttpr work got broken rework intern tool didnt calcul number remain step correctli issu fix dihedr transit count gmx chi gmx angl trajectori frame pass transit count avoid formerli attempt crash trajectori multipl frame pass transit count correct formerli take place fix possibl crash gmx chi histogram formerli invalid refer temporari string use residu name might caus crash fix gmx chi chi_prod formerli could crash produc garbag result number relev dihedr differ number residu dihedr fix affect portabl check necessari python modul avail sourc code valid could otherwis fail build cryptic error issu ensur nblib gmxapi build even without test enabl could otherwis lead cryptic build error miscellan remov perform loss mdrun domain decomposit socal pp mpi rank domain decomposit repartit could incur larg perform overhead due suboptim size hash tabl fix issu remov function note develop pleas use underlin individu entri fix issu subfold otherwis format webpag mess also pleas use syntax issuenumb refer issu gitlab without space colon number remov gmx_scsigma_min environ variabl use reproduc freeenergi softcor behavior gromac version bug fix note develop pleas use underlin individu entri fix issu subfold otherwis format webpag mess also pleas use syntax issuenumb refer issu gitlab without space colon number fix export libgromac cmake target updat export libgromac cmake target depend non exist includ path add gmx_doubl defin interfac definit target get export gromac namespac issu fix unsolicit chang atom name pdb file remov function chang atom name read write pdb file affect name h atom particular issu pdbgmx handl asph gluh input better default treat residu unproton form tri infer proton residu name input proton form avail via interact select option pdbgmx report convert input residu automat also ensur output configur topolog name residu correctli default interactiveselect case issu correct exclud perturb interact beyond nonbond cutoff distanc freeenergi calcul without coupl intermolecular interact nonbond pair interact distanc longer cutoff distanc exclud interact would still pme longrang contribut contribut remov addit mdrun stop fatal error interact beyond pairlist cutoff present issu issu correct awh initi histogram size initi histogram size awh bias depend weakli forc constant depend remov increas histogram size factor practic minor effect time solut multipl dimens histogram size underestim particular combin slower faster dimens simplifi formula initi histogram size given refer manual issu fix default tickmark space gmx xpmp inadvert chang mani year ago lead intend default automat tickmark space replac unsuit fix valu issu fix lj ewald exclus use cutoff electrostat exclus forc cuda opencl kernel comput incorrectli lj ewald use togeth cutoff electrostat issu highlight gromac releas januari th patch releas may made sinc pleas use updat version highlight expect along detail link alway weve got sever use perform improv without gpu enabl autom default addit sever new featur avail run simul extrem interest feedback well new releas work simul hardwar new featur support multipl time step allow simpl near doubl simul speed intend replac virtual site treatment abil use stochast cell rescal barostat equilibr product simul preliminari support use sycl acceler framework support perform free energi perturb awh support pme offload gpu free energi simul support arm sve fujitsu afx contribut research organ inform scienc technolog rist new nonbond interact api nblib collabor prace new gromac logo note develop pleas use underlin individu entri fix issu subfold otherwis format webpag mess also pleas use syntax issuenumb refer issu gitlab without space colon number note develop pleas use underlin individu entri fix issu subfold otherwis format webpag mess also pleas use syntax issuenumb refer issu gitlab without space colon number core gromac team want let user downstream develop know impend chang disrupt minim get touch feel someth inappropri plan deprec function often remain gromac year reli upon note maintain section gener copi content previou major releas except appropri code plan chang happen chang anticip gromac function gmx mdrun memb featur embed protein membran retain probabl differ form gmx memb gmx mdrun rerun featur comput potenti energi quantiti trajectori retain probabl differ form gmx rerun gmx testparticleinsert integr mdp option contain dynam integr energi minim access differt form perhap gmx minim interpret mdp field minim use normalmod analysi may access eg gmx normalmod commandlin help tool better abl document function support much function trjconv editconf eneconv trjcat function tool separ make avail compos modul plan make avail simpler tool eventu via gromac api develop gmx do_dssp replac tool deprec problemat user obtain instal separ dssp binari plan replac implement point nativ implement like base upon xssp make avail new gmx tool name function deprec gromac mdrun deffnm remov function conveni run simpl simul permit group set file differ suffix howev work wider case mdrun modul modul write multipl xvg output file result filenam collid interact checkpoint append led quit bug report user use folder group file standard mechan understand experi outsid gromac build test better softwar remov erstwhil conveni mdrun deffnm pleas updat workflow accordingli issu opencl remov gpu framework issu work underway port amd intel gpu like port base current gromac opencl port nvidia gpu target cuda port chang expectd core team cant maintain test extend port current resourc level sinc prospect emerg gpu vendor hpc need opencl support remov opencl port amd intel support establish way intel knc mic support issu architectur nearli extinct hpc note knl support continu affect deprec sparc hpc ace architectur nearli extinct hpc legaci simd architectur support issu occasion need extend gromac simd framework slowli remov older architectur difficult imposs test follow implement deprec support new function futur power armv platform deprec gromac x mic platform deprec gromac sparc hpc ace platform deprec gromac mdrunonli build gromac issu gromac gmx wrapper binari mdrun binari could built independ mani binari tool built default use instal comput cluster depend mdrun minim howev manag depend better cmake mdrunonli build longer easier build mdrunonli build also harder test introduc complex document gromac teach user use time remov build support version hardwar local librari hwloc issu version support gromac sever year capabl newer hardwar hardwaresupport api interest gromac move forward minim test work encourag cluster upgrad older hwloc instal legaci api issu legaci instal header deprec howev wish state broadli header found within src directori tree gromac intend intern consumpt thu subject chang without notic form content libgromac librari relat cmake target may chang move toward build api support machineri stabl support long term constantacceler md issu broken mani year remov nobodi found interest fix read pdo file gmx wham pull code gromac version wrote file pdo format analys file like longer relev use older gromac version work gmx wham simpler maintain extend longer support read pdo file function deprec gromac support bit architectur issu current plan larg scale resourc use bit architectur abil properli test evalu freeenergi softcor power issu freeenergi softcor power almost never use therefor deprec support armv issu sever issu current code architectur dont resourc support fix issu relat architectur larg hpc impact thu deprec function deprec gromac gener virtual site replac aromat ring standard residu issu thought produc artefact circumst unpublish result never well test wide use need simplifi pdbgmx benchmark option avail gmx benchmark issu option confout resethway resetstep intend use regular mdrun user make avail dedic tool clear also permit us custom default eg write file end simul part way suit respect mdrun benchmark use case confout longer requir gmx mdrun nstep issu number simul step describ tpr file chang gmx converttpr alter mdp file call gmx grompp conveni mdrun option outweight doubt qualiti implement clear record log file lack mainten portabl python environ python requir cpython httpswwwpythonorg__ version support cmake detect python use findpython httpscmakeorgcmakehelpvmodulefindpythonhtml__ previous use python_execut hint locat python interpret instead specifi python root prefix path directori contain binpython cmake variabl python_root_dir cmake_prefix_path infrastructur evolv python_execut may ceas desir effect without warn note develop pleas use underlin individu entri fix issu subfold otherwis format webpag mess also pleas use syntax issuenumb refer issu gitlab without space colon number cmake updat requir cmake version c standard gromac updat requir c standard complianc c c requir standard librari featur see instal guid detail cygwin gromac build cygwin gcc clang compil window gromac build correctli window msvc even path sourc build directori space build msvc correctli detect proper static link setup cmake configur rdtscp usag report gromac default alway x use rdtscp machin instruct lower latenc time old machin might need configur gmx_use_rdtscpoff nonx platform unaffect except longer report rdtscp disabl selfevid armvsv support arm_sv support arm scalabl vector extens sve ad gromac support sve vector length fix cmake configur time typic via msvevectorbitslen compil option time releas support gnu gcc later support soon llvm compil base default detect default vector length cmake configur time chang gmx_simd_arm_sve_lengthbit option support valu note nonbond kernel optim arm_sv yet arm_sv support contribut research organ scienc inform technolog rist new improv featur note develop pleas use underlin individu entri fix issu subfold otherwis format webpag mess also pleas use syntax issuenumb refer issu gitlab without space colon number virtual site singl construct atom ad virtual site construct top singl construct atom use freeenergi calcul densityguid simul appli matrix multipl shift vector structur new mdp option densityguidedsimulationshiftvector defin shift vector shift densityguid simul group densiti forc evalu known shift vector align structur input densiti featur enabl structur refin nonalign densiti without need manipul input densiti data structur mdp option densityguidedsimulationtransformationmatrix allow defin matrix multipli structur coordin shift vector appli allow arbitrari rotat skew scale input structur respect input densiti typic use case membraneembed protein easili shift rotat within membran lower energi drift due settl gromac alreadi appli improv center mass calcul settl reduc energi drift singl precis center mass calcul complet avoid significantli reduc energi drift larg coordin valu present allow accur simul system settl nm size note constrain linc shake still introduc signific drift limit system size nm mdrun report energi drift conserv integr mdrun report drift conserv energi quantiti log file fep use awh possibl control lambda state free energi perturb simul use acceler weight histogram method use one multipl awh dimens other coupl pull coordin support cyclic molecul pdbgmx possibl process cyclic molecul pdbgmx gener gromac topolog file stochast cell rescal barostat implement stochast cell rescal barostat firstord stochast barostat use equilibr product miscellan note develop pleas use underlin individu entri fix issu subfold otherwis format webpag mess also pleas use syntax issuenumb refer issu gitlab without space colon number default valu temperatur pressur coupl interv default mdp input valu nsttcoupl nstpcoupl grompp would set valu nstlist set thu independ nstlist note grompp may choos smaller valu need accur integr uniform manual cmake gpusupport configur gpu acceler setup chang uniform cuda opencl either option enabl set gmx_gpu cuda opencl cmake configur simplifi cmake code also move away autom option select base build host particular mean cuda enabl unless gmx_gpu option explicitli enabl cmake longer perform extra step tri detect hardwar propos instal cuda hardwar avail apart simplif also make easier handl multipl differ acceler api target eg nvidia hardwar configurationtim trivalu option chang autodetect boolean onoff simplifi cmake configur avoid multipl set chang outsid user direct control remov support automat set boolean gmx_build_help gmx_hwloc disabl default gmx_load_plugin enabl default gmxapi c interfac gmxapicontext creat gmxapicreatecontext allow client provid mpi commun librari use instead default eg mpi_comm_world mpienabl client may use filegmxapimpigmxapi_mpih templat header assignresourc helper gener argument createcontext unif sever cuda opencl environ variabl environ variabl exactli mean opencl cuda unifi gmx_cuda_nb_ana_ewald gmx_ocl_nb_ana_ewald gmx_gpu_nb_ana_ewald gmx_cuda_nb_tab_ewald gmx_ocl_nb_tab_ewald gmx_gpu_nb_tab_ewald gmx_cuda_nb_ewald_twincut gmx_ocl_nb_ewald_twincut gmx_gpu_nb_ewald_twincut dysfunct part qmmm interfac remov current gromac support qmmm offici via mimic new cpk qmmm interfac develop within bioexcel qmmm support untest like dysfunct year remov mdp input output result smaller mdp output file grompp improv gromac tool note develop pleas use underlin individu entri fix issu subfold otherwis format webpag mess also pleas use syntax issuenumb refer issu gitlab without space colon number perform improv note develop pleas use underlin individu entri fix issu subfold otherwis format webpag mess also pleas use syntax issuenumb refer issu gitlab without space colon number ad support multipl timestep twolevel multipl timestep scheme implement combin five differ forc group select evalu less frequent therebi improv perform extend support usecas gpu version updat constraint gpu version updat constraint use fep except mass constraint freeenergi perturb reduc time spent grompp larg number distanc restraint time gmx grompp spent process distanc restraint chang quadrat number restraint linear issu support offload pme gpu coulomb fep pme calcul offload gpu coulomb freeenergi perturb cpu simd acceler implement harmon bond simd acceler bond slightli improv perform system hbond constrain constraint give signific improv multipl time step allow offload gpu updat constraint without direct gpu commun allow domaindecomposit separ pme rank parallel run offload updat constraint gpu cuda without requir experiment direct gpu commun featur also enabl tune cuda shortrang nonbond kernel paramet nvidia volta amper recent compil allow retun nonbond kernel default nvidia volta amper agpu improv perform ewald kernel especi also comput energi gromac releas note version releas march releas note document chang taken place gromac sinc version fix known issu also incorpor fix made version sever sinc fix mdrun could behav incorrectli fix mdrun separ pme rank hang upon exit recent fix anoth issu led mdrun hang commun pme rank coordin endofrun perform statist issu fix handl previou virial mdvv integr quantiti get written checkpoint file trotter pressurecoupl integr need copi do_md trotter integr meant append restart mdvv plu nosehoov plu pressur coupl truncat correct edr frame wrote one zero virial wrong pressur case noappend restart write duplic frame agre one written termin issu fix incorrect check nstlog expand ensembl origin version accident revers caus fail nstlog equal fix gmx tool fix gmx tune_pm detect gpu support fix space gmx tune_pm call threadmpi mdrun fix minor issu gmx traj av af made descript xvg yaxi use also work option af issu remov rogu print xvg file gmx mindist gmx mindist xvg none adher print preced comment issu fix bug gmx solvat shell yield sol transit genbox solvat incorrect logic introduc issu correct output gmx do_dssp sc code alway written probabl percentag fix label still fit within expect charact field issu improv document made sever minor improv document messag user remov document unimpl gmx trjconv clustercent introduc system prepar section user guid creat somewher document use limit vdwradiidat enchanc document solvat insertmolecul similarli issu document support amd gcn mesallvm amd gpu use mesa llvm run gromac use opencl document run clang static analyz manual portabl enhanc enabl avx gromac fftw build compil support enabl avx requir gcc newer clang newer sinc support compil older afford enabl avx gmx_build_own_fftwon uncondit work around fals posit simd test bug xlc atan return gromac simd implement howev sinc least one compil produc nan standard librari version better compar known correct valu rather call stdatan issu fix compil icc gmx_simdnon icc defin invsqrt mathh gromac releas note version releas februari releas note document chang taken place gromac sinc version fix known issu also incorpor fix made version sever sinc fix mdrun could behav incorrectli add grompp check equipartit violat risk decoupl mode atom involv angl constrain bond differ mass weakli coupl dynam mode default mdp set often suffici accur obtain equipartit chang add grompp check issu part issu disallow overwrit dihedr type longer allow repeat block paramet multipl line dihedr type also longer allow overrid paramet dihedr type complex properli check still allow repeat paramet block consist singl line repeat block paramet would lead incorrect dihedr potenti forc issu fix flatbottom posit restraint dd openmp realloc miss caus crash issu fix multidomain rerun old code cleanup led multidomain rerun crash fail consid logic separ two place issu fix mdrun perform issu correct cuda sm_ perform kernel launch suit sm size gp architectur fix gmx tool fix fft handl crosscorrrel calcul array complex number creat array pointer pass gmx_fft_d work issu fix gmx rmsf q oq led pdb file contain bfactor use coordin base file rather q file gmx rmsf oq otherwis fine fix crash gmx order gmx order use cumbersom float point method comput histogram lead index valu could neg issu fix minor trjconv bug gmx trjconv novel f inpdb outpdb probabl work better fix time label print gmx vanhov handl issu warn correctli xpmp memb code overwrit output file check error memb use requir user fix issu input file unilater overwrit correct document eigenvalu handl file format doc step implement eigiocpp behaviour gmx anaeig eig eig properli document made editconf bfactor attach use practic bfactor valu ad residu unless index larger number residu option specifi protein residu indic start number case start larg number way add bfactor valu residu patch chang add bfactor valu residu unless number bfactor valu larger number residu fix possibl memori error long select select charact long whitespac exactli point buffer overflow could occur replac buffer stdstring simplifi code significantli issu fix use posit variabl plusmerg select contain posit variabl eg com use least one use plusmerg outofbound memori write caus intern posit structur get fulli initi incomplet initi happen context variabl plusmerg possibl permut actual use valu remain uniniti caus incorrectli comput amount memori requir store result issu improv document made sever minor improv document messag user particular select explain resindex resnr keyword select help explain selectionen tool treat f input file issu clarifi use taup pcoupltyp grompp use permit erron taup reflect one time constant permit pressur coupl unlik groupbas temperatur coupl recent fix issu lead user receiv grompp warn improv doc make clear pressur coupl differ issu portabl enhanc fix x condit ibm sx cpuinfotestsupportlevel test fail ibm sx wrong condit use fix httpsbugzillaredhatcomshow_bugcgiid issu build system enhanc fix compil cmake_cxx_flagswal werror issu stop tri use objdump reloc build system mac recent xcode objdump support reloc warn base output run objdump implement work linuxlik thing spam cmake output platform improv support plugin load build system mdrunonli preferstaticlib build set default build_shared_lib silent disabl plugin support thing like vmdbase io handl convert gmx_load_plugin tristat onoffauto precondit support met suitabl behaviour case issu turn hwloc support static lib found hwloc depend resolv cmake time static libwloca detect case linktim error prevent build gromac hard user know solv cryptic error hwloc requir depend turn hwloc support static lib detect user overrid cmake command line issu fix build gmx_external_tngon housekeep reduc user problem mdrun print invalid perform data less often mdrun finish schedul reset time inform eg mdrun resetstep mdrun resethway mislead time inform report relat default reset step gmx tune_pm increas issu ad runtim check number thread bond code replac debug assert number openmp thread larger gmx_openmp_max_thread fatal error sinc listedforc reduct actual requir list forc condit mdrun run gmx_openmp_max_thread thread issu fix integ narrow tng read long trajectori read tng trajectori suffici larg number frame could truncat integ use frame number fix use bit integ origin intend fix logic trr read read trr file reach end file indistinguish read error magicnumb error fix restor intend behaviour case issu gromac releas note version releas septemb releas note document chang taken place gromac sinc version fix known issu also incorpor fix made version sever sinc fix mdrun could behav incorrectli disabl pme tune group scheme pme tune group cutoff scheme work correctli interact chargegroup pair distanc rlist rcoulomb go miss group scheme deprec issu would requir consider effort fix test simpli disabl pme tune group scheme issu fix valu ewald shift ewald shortrang kernel flavour valu potenti cutoff subtract potenti actual distanc done incorrectli fail divid shift valu cutoff distanc fortun valu distanc often close inconsist shift often cancel practic energi differ comput neighbour list size error cancel differ doesnt even show regressiontest would unit test singl interact issu fix orient restraint refer reset com molecul orient restraint fit refer structur done com refer structur instead instantan structur affect restrain unless ensembl averag use print orient tensor issu fix bug setup orient restraint orient restraint initi got move initi domain decomposit made check domain decomposit fail also fix orient restraint work whole system fit group work around miss openmp implement orient restraint orient restraint code awar openmp thread use global inform run master rank result independ number thread use issu enabl groupschem simd kernel recent avx extens groupschem code run use featur set avx_ support recent hardwar group scheme run maximum suitabl simd previou releas build avx_ binari requir best perform deprec group scheme fix fep state rerun use fep state rerun fep state alway issu fix com pull forc sd report com pull forc use sd integr random pull forc sum systemat random sd updat compon better solut add random forc chang done releas branch issu fix pbc bug swap code issu fix flatbottom posit restraint multipl rank realloc never done flatbottom restraint domain decomposit index could go rang lead segfault issu fix null pointer print dd fix rather harmless print null pointer string dd initi would show gmx mdrun dlb ye improv file present error messag possibl use gmx mdrun deffnm restart even wasnt use initi simul lead absurd situat expect output file present name differ pullxxvg pullfxvg pullxxvg pullfxvg present name exactli list gromac expect name deffnm request improv error messag suggest user check possibl issu partial workaround fix ljpme switch grompp error error call miss grompp ljpme request combin forc potenti switch modifi issu fix unus simd pme tabl kernel verletschem xnn pme kernel tabul correct sever issu kernel flavor could select manual set environ variabl user simul affect issu fix bug doubleprecis simd implement doubl precis version reduc dotproduct return float avx_ avx_ avx__fma avx_ mic ibm_qpx reduc use doubl pme forc gather differ small issu avoid inf simd doubl sqrt argument float_min doubl precis simd sqrt would produc inf mani simd architectur sqrt return argument rang fulli correct unproblemat issu issu fix nvml error messag refer api call fail eg user lack permiss chang clock fix imd interfac malfunct issu fix initi temperatur report continu simul checkpoint mdrun could report doubl intial temperatur nstcalcenergi nsttcoupl note affect report actual veloc correct initi temperatur longer report continu run sinc continu initi temperatur issu fix except simd lj pme solv clear simd pad element solv helper array avoid otherwis harml fp overflow except issu fix gmx tool fix memori access issu gmx solvat outofbound access solvent configur given pdb file one type residu solvent trigger sort also fix memori leak sort routin fix crash mention issu fix consist check gmx make_edi flood one set flood edi input file gmx make_edi code check one use last eigenvector covari matrix correspond rotat translat degre freedom check code erron check number eigenvalu neig store xvg file total number eigenvector depend number atom nav use gmx covar thu origin check would alway fail xvg eigenvalu file contain valu support quiet trajectoryhandl io permit gmx_trajectory_io_verbos set keep frameread code quiet conveni tool use libgromac improv document migrat much content wiki user guid includ expand perform section rework extend simul restart reproduc ad document mdp option simulationpart ad document issu relat floatingpoint arithmet ad document runtim error correct pdf manual reflect tool call gmx tool still occurr oldstyl g_tool name patch remov deliber left g_memb never gmx memb instead got incorpor gmx mdrun clarifi gmx editconf help text possibl user confus c center patch make clear center doesnt anyth unless user realli want shift center system away middl box issu ad miss mdp file document enforc rotat modul fix paramet descript dihedral_restraint forceconst paramet dihedral_restraint document tabl interact type issu replac instanc group coord pull mdp document portabl enhanc support cuda volta nonbond kernel implement productionqu support volta gpu cuda code adapt support chang natur warp synchroni without disturb support older gpu andor cuda improv may seen eg releas realli enabl avx gromacsmanag build fftw earlier attempt enabl avx gcc newer clang newer wrongli implement work compil offici support msvc gcc clang icc fix aspect compil run solari fix avxf compil flag avoid use mic code gener flag xeon code path fix compil flag use mkl fix compil issu arm simd arm_neon never support doubl precis simd disabl gromac doubleprecis build maskzr function use wrong argument order debugmod premask sometim typo syntax shift oper clangbas compil includ armclang v compil seri seem check requir immedi integ argument given inlin call oper function inlin seem permit gcc recogn caller alway use immedi theori new code might gener code run trifl slower dont use moment cost might neglig effect domin perform gromac releas note version releas februari releas note document chang taken place gromac sinc version fix known issu also incorpor fix made version last plan releas seri fix mdrun could behav incorrectli fix triclin domain decomposit bug triclin unitcel vector abc domain decomposit would commun incorrect halo along dimens x bx vector c parallel zaxi halo cutoff bound plane tilt incorrect along xz error approxim proport bxcx bxcybi cx bxcybi commun halo small could caus instabl silent error cx bxcybi commun halo larg could caus commun overhead issu requir ntmpi set ntomp gpu gpu threadmpi set ntomp could lead oversubscript hardwar thread gpu threadmpi user requir set ntmpi use ntomp chose also requir ntmpi user specifi nt ntomp could infer number rank safer ask user explic set ntmpi note specifi ntmpi nt alway work correctli issu prevent dynam load balanc activ immedi exchang turn dlb right exchang replica caus assert failur also useless issu avoid confus messag end nondynam run em tpi nm etc target perform optim write perform report commit fix oversight wherebi would warn user lack perform report normal expect issu chang issu fewer messag cpi checkpoint file present remov duplic messag issu disallow combin pmeuser verlet cutoff issu ad miss ewald correct pmeuser coulombtyp pmeuser ewald mesh energi subtract lead incorrect coulomb energi forc issu fix threadmpi rank choic orient restraint singl rank support must threadmpi code choos there anoth check later catch multirank mpi case fix nstlist increas warn print log file warn messag buggi condit commit fix remov incorrect comment charmm tipsp fix incorrect dvdlambda wall freeenergi deriv dvdlambda wall perturb chang atom type nonwal atom contain bstate contribut issu fix warn confout period molecul period molecul gmx mdrun would incorrectli attempt make molecul whole write final state confout issu fix wrong megaflop account nrnb index entri miss interaction_funct array lead wrong megaflop account print issu fix gmx tool fix gmx grompp net charg check grompp check net charg would ignor molecul block end molecul type use multipl non consecut molecul block issu extend gmx grompp miss energi term messag issu fix gmx genion charg summat accuraci gmx genion accumul charg float could caus underestim net charg highli charg system issu fix gmx check tpr differ atom issu fix gmx grompp andersen massiv com remov fix float point except lead crash also fix possibl differ round interv andersen massiv gmx grompp gmx mdrun common case tau_t multipl delta_t issu improv document updat document nosehoov output document nosehoov chain variabl print long outdat issu clarifi doc fmax em gromac releas note version releas octob releas note document chang taken place gromac sinc initi version fix known issu also incorpor fix made version made distanc restraint work thread dd nmr distanc restraint use sever buffer sum distanc index base index threaddomain local ilist forc atom give incorrect result openmp andor domain decomposit use type index restraint domain local threadloc index pair resolv issu two limit left timeaverag restraint dont work dd multipl copi molecul system without ensembl averag work dd note fix made x releas issu issu issu fix ewald surfacedc correct ewald surfac dc correct forc appli includ last atom exclus water end system last h would correct ion end ion would miss addit verlet scheme domain decomposit forc correct appli issu fix open wall tabl file issu fix bug gmx insertmolecul option ip trial unsuccess molecul eventu incorrectli place due memori error referenc rposxxmol made virial reproduc openmp reduct use reduc virial contribut thread defin order lead differ round make run nonreproduc still fulli correct thread local buffer use also remov openmp parallez small count eg shift forc updat support fftw autodownload fftw get fftw build properli includ enablevsx gmx_simd set vsx ie power enableavx gmx_simd avx flavour safe non work knl presum use futur avx architectur permit automat load balanc disabl make run slower certain condit especi share gpu dlb decreas perform measur cycl per step turn dlb run averag cycl per step dlb get averag without dlb turn dlb measur without dlb without dlb cycl count still lower keep dlb remaind run otherwis turn procedur ensur perform never deterior due dlb improv accuraci time dynam load balanc gpu opencl time local nonbond finish gpu ignor dynam load balanc chang let opencl take code path cuda one intern heurist paramet far small cuda opencl fix correct kernel launch bound tesla p gpu correct initi guess kernel tune paramet result reduc occup sm_ gpu thu improv perform improv logic handl ifwhen run termin settl warn code honour environ variabl gmx_maxconstrwarn set maximum number warn issu fix bug gmx wham read pullx file order column pullx file chang recent gmx wham pick reaction coordin pullxxvg com pull group written gmx wham test variou pull option geometri fix ouput bug gmx wham fix deadlock threadmpi threadmpi mdrun could deadlock pin thread issu made error report grompp user friendli tool alway report file line user input file lead condit subsequ pars continu fix simd suggest vmx fix script xplorgmxpl work gmxdata fix default nice level mdrunonli build mdrunonli build default zero nice level gmx mdrun normal build fix mathtest fals posit depend accuraci float point divis input test function could ulp larg small larg result test function wasnt within ulp test fail improv document approach reduc overhead gpu run document avail wallcycl counter subcount report mdlog file list explain user guid along enabl report subcount sever installguid section improv includ opencl mdrunonli make check quick dirti cluster instal section ad opencl error string written instead cryptic error code fix build gmx_use_tngoff remov variableprecis gro write precis use write gro file fix decim place x v box respect ensur compat softwar variableprecis read still support issu fix bgq platform file instal guid renam platform file reflect normal practic instal guid reduc memori requir freeenergi simul pair list atom whose shortrang paramet perturb use less memori issu bug fix document fix issu fix releas backport branch fix two problem relat restart velocityverlet first problem seriou addit caus problem restart case velocityverlet integr plu either berendsen vrescal temperaturecoupl algorithm temperatur coupl code call twice made distribut kinet energi broad correct averag algorithm combin unaffect second problem initi step restart velocityverlet integr either berendsen vrescal temperaturecoupl algorithm high pressur use empti virial matrix fill mttk pressur control effect bug small affect volum integr one step restart issu fix verlet buffer calcul nstlist rare circumst verlet buffer calcul code call nstlist caus divis zero divis zero avoid furthermor grompp also determin print verlet buffer size nstlist provid user inform add consist check issu fix larg file issu bit platform point gcc start issu warn instead fatal error check code fix realli gener error issu avoid use abort fatal error avoid situat produc useless core dump issu fix possibl divis zero polar code avoid numer overflow overlap atom verlet scheme verletschem kernel allow overlap atom even interact contrast group kernel fix clamp interact distanc becom smaller e singl e doubl number later multipli zero paramet influenc forc clamp never affect normal interact mdrun would previous crash distanc small haswel rf pme kernel get slower respect cuda rf pme kernel get faster respect issu relax pull pbc check check pull code com distanc close half box strict direct pull dimens orthogon pull vector longer check check actual strict enough direct pull along x triclin unit cell corner case furthermor directionperiod hint print geometri direct issu add detect armv cycl counter support armv requir special kernel set allow cycl counter read chang add cmake set enabledis counter architectur armv enabl default armv run small test program see execut success crosscompil armv counter disabl either choic overridden set valu gmx_cyclecount cmake issu introduc fatal error frame gmx do prevent gmx do crash incomprehens error messag frame test part issu properli reset cuda applic clock store applic clock valu read start mdrun reset valu clock chang anoth process meantim issu fix replicaexchang debug output go debug file mdrun debug select replica exchang order descript print mdrun log file look like actual number print debug log put debug log fix gmx mdrun memb alway run singl rank use give fatal error default threadmpi mdrun chosen one rank correctli choos use singl rank fix issu use int number simul step mostli use bit integ mess thing mdrun rerun edr write complain neg step number impli might work around threaten crash cant silenc complaint write reduc scope messag read fix tng wrapper routin pass bit integ like made variou infrastructur use gmx_int_t consist note place practic rang valu store type like smaller cant extend definit xtc trr proper solut avail tng alreadi good though issu fix trr magicnumb read trr headerread routin return ok valu even magic number wrong might lead chaotic result everywher led problem code eg cpptraj mistakenli wrote wrongendian trr file use gromac never thing xdr file defin big endian code exist issu chang use legal charact opencl cach filenam option cach jitcompil opencl shortrang kernel need harden mdrun would write file whose name would usual specif devic also contain filenam would work everywher ie alphanumer charact current local fix bug introduc develop document fix issu identifi introduc releas branch sinc diverg releas appear final releas note formal releas thought problem cours track issu httpsgitlabcomgromacsgromacsissues_ remain avail discuss aris fix bug vrescal thermostat replica exchang commit df made random number vrescal thermostat vari md step similarli replicaexchang random number gener reset wrong place issu fix vsite bug mpiopenmp recent commit befd caus nonloc virtual site treat use openmp mean coordin lag one step behind forc spread atom lead small error forc note nonloc virtual site use local virtual site use construct atom common case cn chnh group vsite hs also ad check vsite count debug build issu fix thread affin case fix one deadlock newli refactor threadaffin code happen automat pin part node full one deadlock still theoret possibl threadmpi report set affin possibl subset rank code deadlock alway might never happen fix remov openmp overhead high parallel commit dd introduc openmp parallel loop clear rvec increas rvec small number atom per mpi rank increas cost loop factor chang disabl openmp parallel low atom count remov stdthreadhardware_concurr use stdthreadhardware_concurr determin logic processor count sinc provid hint note still differ sourc count left ad support link extern tinyxml permit conveni packag gromac distribut got lost gerrit rebas issu fix data race hwinfo threadmpi issu fix power bigendian compil pass test doubl singl precis gcc bigendian vsx chang code incrstoreu decrstoreu address appar regress compil think type return vec_extract pointertofloat attempt reduc test case havent reproduc issu ad test case might hit endian case futur abl test littleendian power risk gccspecif permut could endiansensit well test hardwar access somebodi run test us issu issu reduc hwloc cpuid test requir nonx linux platform hwloc report cach mean fail strict test requir full topolog support problem whatsoev reduc test requir basic support hwloc still better anyth get similarli cpuid error architectur provid specif flag defin avoid mark issu work around compil issu random test bit machin gcc run bit linux fail test random distribut seem caus compil someth strang lead differ lsb use result floatingpoint valu rather exact binari comparis valid c bad behaviour compil imho technic requir produc bitwis ident result high optim howev use floatingpoint test zero ulp toler problem appear go away issu updat gmx wham new pull setup bring gmx wham date new pull setup pull type geometri set per coordin pull coordin chang configur fix memb partial revert f membran embed algorithm must initi call init_forcerec trivial move do_md clean anyway releas sinc remov group scheme fix allow us method work releas issu highlight gromac releas august patch releas made sinc pleas use updat version highlight expect along detail link alway weve got sever use perform improv without gpu cpusid simd thread enhanc make gpuacceler simul faster even wed left gpu code alon thank addit gpu kernel improv gpuacceler run expect around improv throughput plain vanilla md either pull code support openmp thread throughout multisimul less coupl simul new c portabl layer permit us acceler simd cpu lot minor routin also often improv run use acceler mani node better load balanc power arm avx knl fulli simd acceler support new portabl layer made simd acceler bond interact reduc calcul time factor improv load balanc high parallel factor show significantli better scale similarli simd acceler settl reduc time constraint factor strong effect gpu run opencl gpu support avail combin mpi threadmpi gpu share ie cuda kernel perform improv amd gpu benefit opencl nvidia gener still slow tool new analysi framework handl trajectori subset simul system new pull coordin geometri angleaxi dihedr normal angl checkpoint restart work case implement alway user want version number chang year releas plu futur patch number gromac initi releas branch gromac set bug fix gromac etc remov mdrun featur remov sd integr integr known problem way inferior sd test deprec gromac plan replac issu remov twinrang scheme deprec group scheme support verlet scheme support forese futur explicit requir rlist maxrcoulombrvdw remov support twinrang vv integr groupschem twinrang nonbond interact never work velocityverlet integr constraint plan make combin work issu issu remov reactionfieldnec reactionfield noexclus correct option introduc backward compat perform advantag system rigid molecul eg water system forc incorrect verlet scheme support option even would wouldnt even improv perform remov adress modul featur requir deprec group scheme plan port verlet scheme issu remov mdrun compact complic support multipl way analys perstep data remov lambda print mdrun log file issu remov gmx_nochargegroup undocu featur use deprec group scheme miscellan variou improv document test particular definit pressur refer manual bar spuriou r_ij forc mors potenti remov ad document literatur refer membran embed improv templat analysi program document gmock patch work gcc issu improv make_ndx help text clarifi use boolean oper old help text could incorrectli hint would work keyword ad refer gmx select case serv replac issu add check number item read mdp statement ad check number item read sscanf statement process data mdp file issu work around glibc cuda glibc chang behaviour stringh way broke version cuda gcc compil version gromac build system detect glibc work around ad _force_inlin preprocessor defin cuda compil issu split nbnxn cuda kernel four compil unit cuda nonbond kernel built four differ compil unit possibl ie devic comput capabl dramat reduc compil time forc use singl compil unit done use gmx_cuda_nb_single_compilation_unit cmake option issu ad stream flush write newlin charact routin use carriag return without newlin keep write statu eg stderr oper system seem lead output cach buffer chang add explicit fflush print stamement fix issu support cmap qmmm formerli qmmm support bond interact use atom number support hardcod assumpt remov upgrad support lmfit librari base lmfit cmake option gmx_external_lmfit permit link extern lmfit packag rather one bundl gromac issu libxml longer depend gromac use use libxml run test code replac bundl version tinyxml option system version librari disabl autom fftw build window fftw distribut includ configur build automat window particular configur make make instal triad issu remov warn checkpoint mismatch mdrun warn mismatch minor version build number rank use reproduc request also ad separ messag match precis issu report filenam line number failur extend call gmx_fatal fget_lin report filenam line number read fail handl constraint error em energi minim could fail random error constrain produc nan coordin steepest descent reject step constraint error minim produc fatal error suggest use steepest descent first issu disabl static libcudart os x recent version cmake enabl static version libcudart default break build least recent version os x disabl platform fix rare issu link clock_gettim misus preprocess command might led inappropri use clock_gettim issu disabl nvidia jit cach opencl nvidia jit cach known broken opencl compil case kernel sourc chang path chang eg kernel get overwritten new instal therefor disabl jit cach run nvidia gpu amd gpu unaffect issu improv gromac tool support replac solvent gmx insertmolecul make possibl specifi solvent set atom replac select gmx insertmolecul make tool replac residu set insert molecul instead insert assum solvent consist singleresidu molecul sinc molecul inform would requir tpr input might commonli avail prepar system default random seed chang analysi tool see individu tool document function case magic valu obtain gener seed chang document made gmx solvat gmx insertmolecul work better pdb input f pdb file pdbinfo struct got outofsync atom addedremov issu tool new analysi framework read trajectori file subset make tool written new c analysi framework support analyz trajectori contain arbitrari subset atom issu made moleculetyp name case sensit use case chain system chain id set pdb allow use uppercas letter lowercas letter number chain identifi use maximum chain ad number densiti normal option gmx rdf add option gmx rdf allow select radial number densiti normal output addit current raw neighbor count actual rdf simplifi gmx genconf remov block sort shuffl option block isnt use sinc particl decomposit remov option sort shuffl undocu dont seem use day would somebodi simpl python script use macro unit convers gmx wham also issu improv gmx sasa error messag print inform output group part group select calcul help user diagnos issu made gmx vanhov work without pbc fix gmx hbond group overlap check gmx hbond support partial overlap analysi group check code broken never caught result incorrect output might ok first sight also correct bitmask enum intent seem give correct result use non power enum index entri made gmx do work due error index handl gmx do alway stop fatal error issu add check much memori gmx nmeig gmx nmeig could request storag eigenvector output matric int_max element nearli loop variabl int fatal error produc case also avoid confus error messag much memori request alloc routin get correct size gmx_fatal print smaller integ ad support first spars matric perform improv gpu improv addit note overal minor improv contribut increas cuda perform depend paramet compil gpu kernel perform increas expect benefit seen cuda version recommend certain older version eg see even larger improv even larger improv opencl perform amd devic expect eg rfplain cutoff pme potenti shift recent amd opencl compil note due limit nvidia opencl compil cuda still superior perform nvidia gpu henc recommend use cudabas gpu acceler nvidia hardwar improv support opencl devic opencl support fulli compat intra internod parallel mode includ mpi threadmpi gpu share pp rank previou limit caus bug highlevel gromac code addit prefetch shortrang kernel similar cuda code disabl found use ad lennardjon combinationrul kernel gpu implement lj combinationrul paramet lookup cuda opencl kernel geometr lorentzberthelot combin rule enabl plain lj cutoff optim alreadi present cpu kernel improv perform eg opl gromo amber forc field help charmm forc field use forceswitch kernel ad support cuda cc ad buildsystem kernelgener support pascal architectur announc far gp gp support cuda compil default gener binari well ptx code sm_ sm_ given consider differ two also gener ptx virtual arch dont add cc gp compil support know noth kernelgener side given increas regist file cc wider threadsblock kernel enabl later threadsblock remain improv gpu pairlist split improv perform instead split gpu list gener work unit base maximum cutoff gener list close target list size possibl heurist estim number cluster pair high instead result percent fewer pair list still slightli request improv cuda gpu memori configur make use larger amount l cach avail global load cach hardwar support k k tegra k cc pass appropri command line option dlcmca issu automat nstlist chang tune intel knight land cpu improv improv individu kernel provid increment improv cpu perform simul activ valu simul use gpu offload much higher via autotun permit kind resourc util throughput increas optim bond thread forc reduct code multithread bond interact combin forc afterward reduct use fixeds block atom instead divid reduct whole rang block uniformli thread use block divid uniformli thread speed reduct factor number thread typic proteinwat system use domain decomposit domain decomposit speed factor use simd transposescatt bond forc reduct angl dihedr simd function use simd transpos scatter function forc reduct chang give massiv perform improv bond mainli dihedr forc updat lot vector oper without simd fulli replac simd oper ad simd implement lennardjon interact give factor speed improv main improv come simplifi analyt lj instead tabl simd help bit ad simd implement settl haswel cpu make settl factor faster ad simd support routin period boundari coordin transform thread improv improv enhanc perform code run multipl cpu thread improv verletschem pairlist workload balanc implement near perfect loadbalanc verletschem cpu pairlist increas search cost outweigh balanc nonbond kernel time particularli small system improv thread virtualsit code mani thread signific part vsite would end separ serial task therebi limit scale two weakli depend task gener thread one use threadloc forc buffer part reduc differ thread respons part also setup run multithread add openmp support loop loop number atom caus signific amount serial time larg number thread limit scale add openmp parallel pull code pull code could take third comput time openmp parallel simul larg pull group pullcod loop atom openmp parallel version improv multisimul coupl less frequent exampl replicaexchang simul commun simul exchang attempt plain multisimul commun simul overal perform tend improv time progress one simul might faster other eg differ pressur use quieter part network new improv featur chang requir c compil gromac requir c c compil detail see instal guid chang support cuda recent version issu allow rcoulomb rvdw pme gromac kernel support coulomb pme cutoff lj rcoulomb rvdw avail via pme load balanc allow setup chosen also mdp option ad option support portabl hardwar local hwloc ad cmake support detect build gromac hwloc improv gromac abil recogn take advantag avail hardwar hwloc unavail gromac fall back detect routin made normalmod calcul work shell vsite implement shell vsite normalmod analysi mdrun analysi eigenvalu frequenc normalmod analysi done real atom shell minim step analysi issu chang pull group count coord store tpr file ad paramet ngroup pull coord paramet also store tpr file make pull geometri forward compat use sinc avoid bump tpr version everi new geometri expect user want experi new geometri ad pull coordin geometri angleaxi new geometri describ doc check readpullcpp reorgan sinc ad new geometri made old logic bit convolut ad pull coordin geometri dihedr angl use new geometri explain doc ad pull coordin geometri angl new subsect ad doc explain new geometri replac pullprintcom mdp option pullprintcom chang made pull output order name ad pull potenti flatbottomhigh ad new pull coordin type flatbottomhigh flat potenti refer valu harmon ad gmx grompp check pull group ad check valid pull group pull coordin use pull group index rang would caus invalid memori access ad new swap function comput electrophysiolog modul support ad ionwat posit swap multipl ion type polyatom ion includ use userdefin number ionic speci small polyatom ion also ad two extra mdp file paramet bulkoffset allow user specifi offset swap layer compart midplan use setup eg transmembran protein extend far least one compart without offset ion would swap vicin protein want ad extend water layer come cost perform case offset solut document test improv fix logic dd missinginteract check code intend doubl check domain decomposit algorithm miss interact inact sever case fix issu issu permit forc veloc written compress tng uncompress coordin output write forc veloc tng file compress coordin output uncompress coordin output tng file forc veloc written use greatest common divisor set frequenc tng data output ensur lambda box shape written least often anyth els issu ad new note user coupl algorithm unavail mdrun give user explanatori note pressur andor temperatur coupl turn ad mdrun check finit energi ad check total potenti energi finit check nearli free catch issu incorrectli set system user get confus constraint pme error note check perform step energi calcul often catch explod system ad gmx grompp check unbound atom gmx grompp print note atom connect potenti constraint atom moleculetyp sinc often mean user made mistak issu improv multisimul signal multisimul includ remd may need send messag simul exampl remd need write fullyconsist set checkpoint file restart work correctli normal multisimul fine decoupl progress simul effici similarli gmx_mpi mdrun maxh multi need synchron remd implement upgrad coupl happen algorithm chosen user requir issu issu issu issu chang multisimul nstep behaviour unclear expect behaviour multisimul user suppli possibl nonuniform distribut init_step nstep sourc mdp cpt command line previous mdrun adjust total number stesp run run number step report nonuniform proceed assum user know issu ad work directori thing report log file run gromac via batch script use know work directori use rel path file name command line written alongsid header inform prevent fragil use case involv checkpoint restart andor append output file name checkpoint file ie use previou run must present checkpoint restart permit thu workflow peopl use thing like gmx mdrun product cpi equilibr longer avail continu restart instead use gmx grompp equilibr product issu remov warn openmp corecount check mani case gmx_mpi mdrun issu warn compar total core count someth differ return openmp problem caus inappropri manag thread affin mask word messag help user realis remov gmx_mpi mdrun pin may help improv perform case prepar hardwar detect might tri forc offlin core work hardwar detect might foil kernel take core offlin work unavail awar platform gromac like use probabl start see soon platform number core physic present differ count onlin tri forc onlin decid gromac use onlin core x powerpc platform need code never run platform good news longer risk make confus warn possibl ad new suggest user tri eg hyperthread disabl gromac tend perform best sever hardwar thread avail per core eg hyperthread turn x log file note explicitli opportun exist gromac releas note version releas februari releas note document chang taken place gromac sinc version fix known issu also incorpor fix made previou version find describ refreleasenot fix mdrun could behav incorrectli correct freeenergi delta h output mass lambda separ lambda paramet use perturb mass freeenergi contribut contribut doubl count delta h output use bar calcul note dhdlambda alway correct issu issu _releasenotesgpu fix incorrect lj repuls forc switch gpu use cuda opencl gpu coeffici second order term lj repuls forc switch function call manual wrong sign lead small error forc pressur note dispers forc switch correct effect bug physic result seem neglig note forc switch usual use combin charmm forc field issu fix gmx tool fix improv portabl fix compil flag power compil flag power processor lead error code remov issu issu issu miscellan gromac releas note version releas august releas note document chang taken place gromac sinc version fix known issu also incorpor fix made version earlier find describ refreleasenot fix mdrun could behav incorrectli multidomain gpu run longer miss pair interact system empti space unit cell gpu run domain decomposit would comput lj coulomb interact domain interact domain rank point time bug affect simul run gpu domain decomposit contain empti region space lead domain empti possibl observ bug may seemingli random failur calcul reproduc restart simul checkpoint file domain would fill properli interact present begin unlik bug unnot effect short simul miss interact inevit lead simul instabl crash simul crash due bug restart contain small region around crash unphys due interact calcul crash critic fix user x seri run gpu updat point releas issu fix conjug gradient assert failur end minim final step coincid coordin output step conjug gradient minim would exit assert failur instead write confoutgro issu multidomain conjug gradient minimim longer segfault issu fix pairlist buffer brownian dynam brownian dynam bdfric verlet pairlist buffer would determin incorrect mass constrain atom virtual site would lead small buffer typic atomist system constraint issu avoid atom move far error introduct dual pair list led larger nstlist valu lead larger atom displac domain decomposit step made like error atom move far two domain decomposit step n particl commun pme rank time cutoff domain decomposit cell appear stabl system atom displac correctli taken account determin minimum cell size error appear unstabl system issu grompp check pull group close half box size pull group use refer atom period boundari treatment atom well within half box size refer case grompp issu warn issu fix segment fault mdrun qmmm oniom scheme issu correctli specifi pme gpu support dynam integr previous pme gpu support could run fail energi minim normalmod analysi run issu fix gmx tool fix syntax error make_gromos_rtppi issu fix gmx solvat topolog updat remov hard code solvent name allow updat topolog base solvent molecul inform also allow updat multipl solvent type issu fix bfactor output error caus fix issu fix pqr file output broke output bfactor tool issu made sure gmx rm skip valu request skip valu gmx rm would still output valu despit option output valu request process issu fix trjconv provid structur file trjconv would fail segment violat run without structur file due incomplet initi topolog data structur fix add miss check prevent failur issu fix enforc rotat energi output fix improv portabl fix nvcc host compil check trigger issu report date hwloc version inform issu disabl singl compil unit cuda issu miscellan avoid abort mdrun gpu saniti check detect error issu improv opencl kernel perform amd vega gpu opencl kernel optim flag explicitli turn denorm handl could lead perform loss optim explicitli turn consist cuda perform reason amd vega gpu rocm kernel perform improv gromac releas note version releas januari releas note document chang taken place gromac sinc version fix known issu complet list fix descript found refreleasenot fix mdrun could behav incorrectli fix numer deriv normalmod analysi shell code due higher precis need use polariz shell particl normal mode code work reproduc shell order fix stepsiz use numer comput hessian reduc near machin precis chang affect result nonpolariz system protein small molecul make larg pme grid work gpu pme grid size along z larger would make mdrun exit cryptic cuda error issu fix linc accuraci openmp constraint triangl present constraint triangl usual occur replac hydrogen virtual interact site ch nh group need doubl number iter normal constraint openmp would happen last openmp thread least one triangl would caus slight loss accuraci inhomogen system issu fix acceler cosacceler factor miss acceler valu lead incorrect result eg calcul viscos issu fix checkpoint restart tpr infinit step count issu introduc caus refmdrun gmx mdrun refus start use infinit step count refmdrun gmx mdrun properli accept file issu fix energi histori file read check miss read energi file simul stop first valu written file issu fix gmx tool fix trjconv ndec work write xtc file code document work correctli gro file chang releas seri would write fixedwidth column issu issu fix improv portabl miscellan warn problemat coupl time nosehoov parrinellorahman combin nosehoov parrinellorahman coupl algorithm reson kinet energi pressurevolum appear two coupl time involv similar grompp warn taup less two time taut issu fix effici issu shell code minim code cleanup touch unnecessarili complex code creat effici issu issu complex fix issu ad code gener support nvidia ture gpu cuda nvidia ture gpu directli target nvcc compil gener appropri set flag ture architectur default use cuda later gromac releas note version releas may releas note document chang taken place gromac sinc version fix known issu also incorpor fix made previou version find describ refreleasenot fix mdrun could behav incorrectli revert broken chang made revert chang made broke simul use shake constraint algorithm issu work around gcc avx compil bug gcc version compil bug caus larg part nonbond interact ignor compil avx run openmp thread issu fix gmx tool fix improv portabl miscellan updat releas note reffix releasenotesgpu made gpu kernel thought resolv issu investig suggest real caus yet known gromac releas note version releas june releas note document chang taken place gromac sinc version fix known issu also incorpor fix made version earlier find describ refreleasenot fix mdrun could behav incorrectli prevent opencl time memori leak use opencl build time memori leak would lead system memori use issu fix mpi error constraint failur energi minim issu fix move frozen atom constraint frozen atom also bond constraint could move issu fix com remov move frozen atom frozen atom part center mass motion remov group could accumul momentum move issu fix awh infrequ check cover multidimension awh grid mani point rel number sampl requir cover grid detect cover could delay infrequ check issu fix awh continu consist check kind chang upon restart disallow intend fix awh awhnsamplesupd valu check zero forbidden intend issu fix gmx tool fix buffer overflow grompp warn grompp issu warn error filenamepath charact buffer overflow would occur could also happen make checktest issu fix infinit loop gmx solvat provid pdb file box inform solvent gmx solvat could stuck infinit loop fix disallow empti box solvent pdb file issu fix enemat edr file match energi group issu fix pqr file output pqr file gmx editconf violat standard format alway written fix format commit fix issu introduc differ output method pqr file follow standard issu fix crash gmx solvat gmx solvat would crash due memori corrupt use multipl solvent molecul type ad check unallow period setup long distanc atom bond interact could lead incorrect period remov case inconsist shift messag print run analysi termin confus error could issu inform fatal error issu issu fix improv portabl fix cuda compil window issu fix simd support power system doubl precis gcc issu fix possibl illeg instruct knl intel compil issu miscellan inform messag omp_num_thread sent log file made easier track inform write log file clear way rather stderr issu fix inadvert disabl simd version integr fix bug simd version leapfrog integr chosen possibl may improv perform issu fix fftw build certain avxavx hardwar version fftw fix known gcc error avx remov fastmath flag also appear fix issu fail unit test avxcap hardwar bump version download issu switch use standard cmake variabl instal gnu system gnuinstalldirscmak better approach sever document output improv updat toplevel readm file latest gromac core public report gpu detect improv gmx mindist pi doc improv doc mdp option relat bond improv fix variou typo remov leftov mention twinrang scheme gmx trjconv ndec doc improv gromac releas note version releas march releas note document chang taken place gromac sinc initi version fix known issu also incorpor fix made version earlier find describ refreleasenot fix mdrun could behav incorrectli fix leapfrog integr nosehoov coupl parrinellorahman p coupl parrinellorahman p coupl activ appli nosehoov coupl md step p coupl occur updat phase could use outdat garbag coupl data simul mdpnsttcoupl equal mdpnstpcoupl unaffect issu user impact simul use coupl algorithm unaffect issu use simd bond without perturb interact freeenergi calcul lack bond interact perturb atom type simdacceler bond function inadvert disabl enabl improv perform kind freeenergi calcul fix bond whose displac zero allow overlap atom harmon bond former code would caus float point except incorrect freeenergi deriv fix centreofmass motion remov part system comm remov request part system act whole system issu fix multisimul multipl rank per simul use crash hang mysteri simul would start issu improv intersimul signal implement reduc commun overhead either mani simul mani rank per simul fix fep calcul shake shake fep calcul accumul wrong valu dhdl output case result look issu fix handl mdp defin statement assign preprocessor valu mdp file configur topolog valu origin intend eg defin dbool dvarvalu issu prevent log file energi averag print divid zero simul frame comput energi may insuffici data averag skip averag print entir issu correctli set cutoff modifi forcerec cutoff modifi copi interaction_const_t forcerec_t meant gener kernel use group scheme fix restor perform group scheme issu fix box scale pme mix mode use gpu cpu issu reenabl gpu support wall energi group singl nonbond energi group wall use gpu nonbond calcul remov tumbl icecub warn sd integr sd friction ice cube tumbl fix assert failur testparticl insert erron logic tpi meant alway fail without produc result issu avoid mdrun echo option multi mdrun would print mani messag option multi mpi rank stderr also updat multi multidir error messag issu improv mdrun handl gpu present unavail issu fix crash awh awhequilibratehistogramy run awh awhequilibratehistogramy multipl mpi rank simul would segment fault issu fix issu awh bia share share awh bias multipl simul four issu mpi error would occur individu simul would use one rank deconvolut pmf would garbag sampl correct mpi rank individu simul error coordin could occur continu checkpoint could refus issu issu issu issu fix virial awh domain decomposiion run awh domain decomposit awhpul virial contribut would multipli number mpi rank fix restart bug pull geometri directionperiod com pull geometri directionperiod step continu checkpoint closest pbc imag would use instead one closest refer valu could lead sharp spike pull forc continu step issu fix gmx tool ad check grompp avoid assert failur mdp file paramet present current name old name automat get replac assert would fail fatal error issu issu fix grompp net charg check use multipl nonconsecut block moleculetyp work correctli issu fix issu ad select group tng output molecul block molecul type topolog output wrong fix help text function pdbgmx miss permit dangl bond termini occasion use fix improv portabl pme fermiera gpu larg system work older gpu possibl run hardwar size limit fix issu googletest death test use portabl way test gpu util function robust nongpu build gpu build find incompat otherwis unavail devic pass test manner intend issu use portabl python shebang per httpswwwpythonorgdevpepspeprecommend use env point python either make compat chang distro notabl arch linux alreadi point python python choos explicit thu somewhat portabl issu ad workaround gcc target avx hardwar gcc bug overload resolut caus avx scalar function becom ambigu use isfinit unambigu patch provdi veselin kolev quiet compil warn issu work around gcc bug tabul group nonbond kernel gcc compil avx default tabul nonbond kernel deprec group cutoffschem produc incorrect energi forc error larg could caus latent issu issu detect correct amd zen smt topolog recent amd zen processor hardwar thread detect pin handl fix improv perform issu fix power vsx simd usag upcom gcc version issu fix clang cuda permit build sm_ may work around issu sm_ issu miscellan made multiatom tpi reproduc differ compil document enhanc particular handl option mdrun relat gpu run mdrun good perform gromac releas note version releas novemb releas note document chang taken place gromac sinc version fix known issu also incorpor fix made version earlier find describ refreleasenot fix mdrun could behav incorrectli correct pme forc free energi without perturb chargeslj freeenergi calcul lambda set zero actual perturb charg atom type lennardjon coulomb lj pme mesh forc would scale lambda note bug affect usual setup charg atom type actual perturb issu add constraint contribut foreign hamiltonian differ contribut perturb constraint miss foreign hamiltonian valu import free energi calcul bar issu add mass contribut foreign hamiltonian differ free energi calcul perturb mass kinet energi contribut miss foreign hamiltonian valu issu work around bug expand ensembl run expand ensembl run energi would outdat zero veloc verlet integr nstcalcenergi integr nstexpand multipl nstcalcenergi case mdrun set nstcalcenergi issu issu checkpoint continu requir suitabl tpr file step checkpoint file use mdrun restart must less number step tpr formerli step checkpoint could number mdrun nstep could use get particular result use option alreadi deprec use gmx grompp gmx converttpr make tpr file express intent issu fix gmx tool fix mindist output file check mindist would check output file need print residu name residu contact time actual defin lead error empti file name string issu fix gmx helix segment fault tpr file read correctli helix analysi correctli handl select includ prolin residu issu fix bug entropi calcul gmx anaeig gmx anaeig receiv inconsist number atom eigenvector fewer eigenvector three time number atom entropi calcul would use uniniti valu issu fix improv portabl miscellan fix issu log file could sometim report incorrect initi dynam load balanc state issu fix bromin paramet amber forcefield file forcefield entri bromin iron miss actual valu defin sigma epsilon proper valu includ parmdat bromin iron correspond paramet entri remov issu made normalmod analysi work one molecul fix issu normal mode analysi would consid first copi molecul system also fix issu vsite shell normal mode issu disallow rerun use filenam output file use ident filenam rerun cryptic error thrown file would use read write refmdrun gmx mdrun give help error messag get around issu fix issu build gromac without tng compil error resolv could show build gromac without tng support enabl bug fix fix multipl time step parrinellorahman nosehoov work correct trotter style appli scale correct number step fix issu fix issu appli berendsen pressur coupl nstpcoupl step berendsen pressur coupl mistakenli appli success step sinc need chang act nstpcoupl step note chang prevent continu old checkpoint file berendsen pressuringcoupl run sinc previousstep pressur longer store ad miss ewald correct pmeuser mdpvaluecoulombtypepmeus ewald mesh energi subtract lead incorrect coulomb energi forc fix issu fix incorrect dvdlambda wall freeenergi deriv dvdlambda wall perturb chang atom type nonwal atom contain bstate contribut fix issu support openmp orient restraint previous broken fix test support fix orient restraint refer reset com molecul orient restraint fit refer structur done com refer structur instead instantan structur affect restrain unless ensembl averag use print orient tensor fix issu use graph orient restraint verlet cutoff scheme default molecul made whole made whole orient restraint use ad check assert correct pbc treatment orient restraint fix issu fix ekin step com remov kinet energi step comput veloc without center mass veloc remov could caus rel larg jump kinet energi especi small system compute_glob call twice com remov get correct kinet energi fix refgmx grompp andersen massiv com remov fix float point except lead segv also fix possibl differ round interv andersen massiv refgmx grompp mdrun common case taut multipl deltat fix issu improv verlet buffer constraint estim displac estim constrain atom typic h rotat around com partner atom deriv document correctli note still use gaussian match varianc result much larger buffer necessari sinc tail displac distribut set buffer size gaussian long tail wherea actual distribut tail fix virtual site gener water oxygen name ow refgmx pdbgmx would break gener virtual site water oxygen name ow check atomnumb instead fix issu fix threadmpi rank choic orient restraint singl rank support must threadmpi code choos there anoth check later catch multirank mpi case fix incorrect behavior refgmx solvat refgmx solvat replic nonrectangular solvent box correctli sever differ place assum diagon box matrix give fatal error attempt support use triclin box skip replic step solvent target box size alreadi equal support gener triclin box ad separ check introduc valuabl even case keep preequilibr solvent box intact target box size relat fix issu fix dd exact continu reproduc node domain decomposit local atom densiti use set search grid sort particl base local atom count includ atomscharg group would move neighbor cell lead differ densiti valu turn could result differ number search grid cell thu differ summat order run compar continu run checkpoint atom would move differ violat intent mdrun reprod fix ref fix issu made mdrun stop nstlist step mdrun reprod stop mdrun two int term signal eg ctrlc termin shell would alway happen right first global commun step break exact continu mdrun reprod second signal still stop pairlist gener step like first signal still exact continu fix issu ad check gpu detect support detect gpu devic cudaen binari run node cuda driver avail note issu version cuda driver insuffici wrong fix fix issu remov duplic line opl ffbondeditp ident line remov identifi uniq fix issu mdrun longer warn nvml clock max clock alreadi max point echo warn abl set fix issu use reduc default toler tpx comparison toler gmx check mainli intend handl slight statist deviat hide differ tpr file user like want exact check small quantiti like lennardjon paramet chang chang default rel toler absolut toler zero allow minor differ due compil optim fix issu fix return valu frameread function function base read_first_x return number atom document alway return logic boolean whether frame read led aspect gmx spatial gmx trjcat demux broken fix return proper bool fix remain logic use return valu nonboolean sens ref issu remov pbc gener tpr group scheme ensur molecul made whole gener run input file use group scheme avoid error messag larg charg group molecul broken pbc boundari fix issu fix pbc error gmx_spatial fix issu document power spectrum option gmx velacc fix issu chang requir tpr file gmx cluster program could crash without wasnt option fix issu disallow ascii format gmx trjcat sinc gmx trjcat deliber use tpr file tool cant handl trajectori format gro pdb atomresidu name need fix issu improv grompp missingparamet error messag interact entri paramet function type error messag confus note even one function type implement field still requir make readi extens ref issu check larg energi first step also ad step number fatal error messag fix issu disallow combin pmeuser verlet cutoff fix issu avoid confus messag end nondynam run energi minim testparticl insert normalmod analysi etc target perform optim write perform report commit fix oversight wherebi would warn user lack perform report normal expect fix issu chang requir ntmpi set ntomp use gpu gpu threadmpi set gmx mdrun ntomp could lead oversubscript hardwar thread gpu threadmpi user requir set ntmpi use ntomp chose also requir ntmpi user specifi nt ntomp could infer number rank safer ask user explic set ntmpi note specifi ntmpi nt alway work correctli fix issu highlight gromac releas januari patch releas may made sinc pleas use updat version highlight expect along detail link alway weve got sever use perform improv without gpu enabl autom default extrem interest feedback well work simul hardwar pme longrang interact run singl gpu mean mani fewer cpu core need good perform optim simd support recent cpu architectur amd zen intel skylakex skylak xeonsp new featur avail also awh acceler weight histogram method support adapt bias method use overcom free energi barrier calcul free energi see httpdxdoiorg new duallist dynamicprun algorithm shortrang interact use inner outer list permit longerliv outer list less work overal make run less sensit choic nslist paramet physic valid suit ad run seri short simul verifi expect statist properti eg energi distribut simul sensit test code correctli sampl expect ensembl conserv quantiti comput report integr scheme includ berendsen parrinellorahman scheme remov featur remov hybrid gpucpu nonbond mode mode use sinc ran nonloc nonbond interact cpu fraction nonloc interact set domain decomposit flexibl also mode test qmmm remov optim transitionst search function use work old version orca limit use possibl work longer updat applic clock handl pascal gpu start pascal cc longer possibl chang applic clock without root privileg applic clock still report pascal longer suggest chang remov continu refgmx converttpr remov obsolet option refgmx converttpr write tpr file continu use trajectori energi file supersed checkpoint portabl enabl compil cuda devic code clang clang use devic compil set gmx_clang_cudaon cuda toolkit also need note result runtim perform usual wors binari compil offici nvidia cuda compil nvcc increas oldest cmake compil cuda version requir requir gcc clang icc reli full c support also requir cuda cmake ad check cuda avail hardwar compil code compat ad earli check detect refgmx mdrun binari emb code compat gpu devic tri use ptx could justintim compil addit user manual set gmx_cuda_target_comput later sm comput run hardwar wed execut justintimecompil fermi kernel incorrect hostsid code assumpt eg amount share memori alloc textur type chang also prevent case fix issu disabl arm neon nativ rsqrt iter use shortrang interact fix issu avoid ftz trigger simd test failur small argument platform without fma support intel compil default usag flushtozero denorm valu lead slight deviat sinc rang realli dont care nonfma platform anyway thing past avoid test small rang around threshold nonfma simd platform issu fix opencl compil mac os confirm work mac os run macbook pro radeon pro issu test nvcchost compil combin work compil trivial cuda program run cmake catch unsupport nvcchost compil version combin unknown error issu ad avx_ knc symbol fftw simd test otherwis cmake code might complain loudli fftw acceler knc knl host implement chang cmake polici cmake introduc chang behavior rpath vs install_nam option os x avoid reli function remov futur cmake version new improv featur ad support awh bias awh acceler weight histogram method adapt bias method use overcom free energi barrier calcul free energi see httpdxdoiorg although awh gener bia system paramet chang implement bias reaction coordin actual forc distribut coordin handl taken care pull code awh interact pull code regist extern potenti modul coordin awh bias awh code set potenti forc coordin see refer manual full document includ featur comput timeintegr forc correl also known friction tensor see eg httpdxdoiorgphysrevlett friction tensor defin metric coordin space local volum element metric use measur determin region need less sampl dual pairlist buffer dynam prune gromac simul engin use new dual pairlist algorithm dynam prune case verlet buffer determin automat default allow reduc frequenc pair search domain decomposit avoid larg verlet buffer previous inher increas comput cost shortrang nonbond kernel achiev construct outer pairlist built infrequ includ mani pair list outsid cutoff rang lifetim list pair prune effici everi step build smaller inner pairlist shorter lifetim importantli correspondingli shorter verlet buffer still adher specifi toler use nonbond kernel thank simul run significantli less sensit tune search frequenc paramet nstlist shortrang interact run gpu dynam prune overlap integr cpu usual free featur improv simul rate hardwar util power consumpt ad physic valid suit test run seri short simul verifi expect statist properti eg energi distribut simul sensit test code correctli sampl expect ensembl run everyth local take hour use cmake dgmx_physical_valiationon make make checkphysrun current script run system check converg energi conserv nve system decay timestep ensembl gener thermost barost algorithm system ensembl cover broader combin set ad time ad report conserv quantiti coupl algorithm work coupl algorithm berendsen pressur berendsen temperatur parrinellorahman pressur appli system calcul integr formula refer manual ad acceler correct vcm mode new mdp option remov center mass translat veloc correct center mass posit assum linear acceler use eg pull group use absolut refer chang handl refgmx mdrun gpu_id code abl offload gpu task assign becom complex like get complex still gpu_id commandlin option mere enabl user restrict detect gpu avail autom task assign scheme somewhat like cuda_visible_devic environ variabl rare case full control need gmx mdrun gputask avail document user guid ad log output equival x pairlist setup gromac nxm setup use shorter pairlist buffer code simpler x scheme log file report equival setup help peopl perform correct comparison new mdp input electr field ewdc nonneutr system ad correct forc energi accord ballenegg arnold cerda j chem phi httpdxdoiorg hint peopl read httpdoiorgctb help make good choic ad warn grompp charg system ewald reduc round error settl paramet settl comput doubl precis lower systemat error made gmx mdrun pforc termin nonfinit forc refgmx mdrun option pforc use print nonfinit forc would termin run found fatal error issu miscellan updat note manual stochast dynam integr comment sd section berendsen outdat ad sentenc equilibrationdamp mode ad grompp note parrinellorahman posit restraint combin unstabl often desir grompp issu note suggest altern user ref issu clarifi descript fmax energi minim improv vsite parallel check vsite struct store intern whether configur domain decomposit allow intern check valid commrec ad would prevent issu ad partial support write mass partial charg tng file issu updat tng version ad data block atom mass fix issu issu bug warn ad load balanc fraction dlb print dlb often base small fraction total step time especi gpu print mdlog stderr ad refer dihedr function opl opl fourterm dihedr function describ refer list earlier updat also updat refer three term dihedr older paper updat mani aspect document import updat materi wiki incorpor suggest aris mani track issu updat user guid develop guid instal guid refer manual updat mdrun signal help text updat mdrun help text signal handl old recent chang behavior fix issu chang handl erron command line arg better gmx modul need abl accept nonopt argument introduc enough function support behaviour give use error messag case command line mere miss hyphen happen eg peopl copypast inconveni built pdf file tutori increas test coverag relev case remov useless commandlin argument string test case never need also test behaviour handl string option renam test input string reflect intent issu chang longer allow multipl energi group gpu run exit fatal error instead warn sinc latter lead write data energi group incorrect energi file issu remov duplic gmxlib search path remov entri duplic ident default search path avoid eg list ident forc field multipl time issu chang longer write refer pull group log intern group use absolut refer set user print lead confus issu improv gromac tool split nmr relat analys refgmx energi new tool refgmx nmr creat straight copi code refgmx energi new tool reason reduc complex cleanup introduc pass valgrind memori test ad refer refgmx nmr manual ad selectionen refgmx trajectori tool plot coordin veloc forc select provid full replac ox ov com mol refgmx traj decreas memori usag refgmx traj refgmx trjconv made tng write work multipl ident step introduc wrapper structur around tng detect correct case write multipl frame step nonzero initi step tng file avoid frame overwrit make sure time per frame correct issu improv frame timestep handl refgmx trjconv store exact step pdbgro file header care claim time step inform avail chang avoid problem describ issu yet properli fix issu tng librari issu fix refgmx trjconv alway dump correct time set frame timestep start loop read first two frame rewind make sure alway write someth dump output base bestguess least one input frame present issu clarifi refgmx editconf help text possibl user confus c center patch make clear center doesnt anyth unless user realli want shift center system away middl box fix issu ad option water tipsp pdbgmx fix issu remov incorrect comment charmm tipsp remov charmm tipsp perform warn refgmx pdbgmx input file sinc perform loss neglig mdpvaluecutoffschemeverlet avoid refgmx grompp charg warn mere round error even though refgmx grompp total charg check use doubl summat round error charg charg store singl precis charg check round net charg molecul integ differ less maximum possibl sum charg round error fix issu improv pdbgmx nonstandard residu type explicit nonblank chain identifi set hard error residu type chain match blank chain id still need allow detect nonchain part case provid explicit output inform issu allow empti line hdb file skip line consist whitespac univers solut fix hdb file better user get strang error messag dont say anyth whitespac issu chang longer requir match name rtp tdb file document sourc remnant day forc field directori longer necessari chang properli match termini amino acid issu issu made duplic atom bond error refgmx grompp duplic atom indic bond interact use warn sinc nearli case lead issu error except angl restraint use note issu made refgmx grompp r obligatori posit restraint posit restraint would often occur user accident use equilibr coordin instead origin coordin posit restraint coordin due r default c r alway need suppli posit restraint use file name c reproduc old behavior fix refgmx msd use com remov molecul chang order code actual assign correct coordin copi data modifi data structur size use com remov individu molecul issu fix index error refgmx chi error index construct could lead segfault howev actual indic correct produc incorrect result issu fix refgmx grompp complex larg exclus order avoid explod comput complex highli connect molecul larg valu exclud neighbor avoid ad neighbor temporari nnb structur alreadi present lowerord neighbor issu fix refgmx densiti nonmass calcul alway use mass never chargeelectron densiti center system issu fix refgmx check tpr differ number atom fix issu perform improv implement support pme longrang interact gpu singl gpu use acceler comput longrang pme interact featur provid excel perform improv particular cpu core per gpu fast version need mani cpu core balanc gpu perform hardwar good balanc gpu cpu also show minor improv capac hardwar strong gpu run effect simul greatli improv current gpu use pme must either gpu use shortrang interact singl rank simul gpu use pmeonli rank mdrun pme gpu requir pme run gpu support cuda version hardwar gener support gromac run code path includ cuda volta gpu howev combin featur support pme gpu notabl fep calcul yet avail user guid updat reflect new capabl document forthcom ad simd intrins support pme spread gather achiev speedup intel knl processor around pme spreadgath typic simul system ad simd intrins version simpl updat simpl case leapfrog without pressur coupl one temperaturecoupl group updat veloc coordin implement simd intrins improv simul rate add simd intrins version ureybradley angl kernel step energi shift forc requir kernel improv perform otherwis rate limit gpuacceler run particularli charmm forc field use openmp thread amd ryzen autom run setup amd ryzen appear alway perform slightli better openmp mpi use thread core die bit avx simd amd ryzen ryzen support bit avx intern unit organ execut either singl bit instruct two bit simd instruct per cycl sinc kernel slightli less effici wider simd improv perform roughli choos faster nbnxn simd kernel amd zen amd zen tabul ewald kernel alway faster analyt avx_ xnn kernel faster xn faster choic made base cpuinfo run time ref issu enabl groupschem simd gmx_simdavx_ groupschem kernel use avx instruct either avx__fma avx_ extens hardwar support new avx_ extens also support avx_ enabl support groupschem kernel detect avx fma unit choos best simd recent intel x hardwar multipl avx fma unit number unit way use interact way cpu choos clock speed mean advantag avoid use avx simd support gromac one unit way queri hardwar count number unit run code cmake mdrun time compar perform use unit recommend version best may mean build gromac frontend node cluster might suit comput node even gener intel hardwar speed nbnxn buffer clear tweak condit nonbond gpu kernel gpu compil miss easi optim loop invari innerlop condit precomput part condit togeth use bitwis instead logic andor improv perform compil gromac releas note version releas june releas note document chang taken place gromac sinc previou version fix known issu also incorpor fix made version earlier find describ refreleasenot note develop pleas use underlin individu entri fix issu subfold otherwis format webpag mess also pleas use syntax issuenumb refer issu gitlab without space colon number fix mdrun could behav incorrectli fix miss interact domain decomposit run domain decomposit interact describ rarelyus topolog file section intermolecular_interact ignor affect normal nonbond intramolecular interact issu fix possibl float point except minim possibl small forc minim could lead crash due divid zero error fix introduc check issu fix segment fault use membran embed issu allow awh pullgeometri direct period appli awh pull coordin geometri direct awh interv length box size dimens made period issu fix gmx tool fix residu molecul index select issu fix pqr format format incorrect tool use pqr file issu fix gmx wham angl geometri gmx wham would mix degre radian unit lead overlap notanumb output note fix correct correct fix appli next patch releas issu issu add inform grompp error wrong line end give meaning error larg grid hbond use grid larg refhbond gmx hbond could tri alloc enough memori caus crash issu add inform syntax error includ delimit grompp issu fix affect portabl fix wider refer simd setup refer simd build could use small memori align lead mdrun exit align error issu fix build failur appl clang build would fail qsort undefin miscellan remov nonexist mdp option awhdimperiod user guid issu add check mani interact memori alloc issu gromac releas note version releas februari releas note document chang taken place gromac sinc initi version fix known issu also incorpor fix made version earlier find describ refreleasenot fix mdrun could behav incorrectli fix error dd dynam load balanc domain decomposit dynam load balanc mdrun would exit error domain decomposit grid shift much cell size limit issu _releasenotesgpu fix incorrect lj repuls forc switch gpu use cuda opencl gpu coeffici second order term lj repuls forc switch function call manual wrong sign lead small error forc pressur note dispers forc switch correct effect bug physic result seem neglig note forc switch usual use combin charmm forc field issu fix segment fault mdrun domain decomposit issu fix segment fault energi minim group scheme use energi minim combin group cutoff scheme domain decomposit could lead segment fault issu correct freeenergi delta h output mass lambda separ lambda paramet use perturb mass freeenergi contribut contribut doubl count delta h output use bar calcul note dhdlambda alway correct issu issu prevent mdrun rerun write incorrect freeenergi output mdrun rerun exit fatal error mass constraint perturb contribut hamiltonian differ deriv incorrectli set zero version issu fix possibl divis zero enforcedrot code issu fix gmx tool fix trjconv ndec work write xtc file code document work correctli gro file chang releas seri would write fixedwidth column issu issu fix use index file group tpr file suppli select use group suppli index file use even tpr file suppli issu fix tune_pm tool work due file read error fix issu fix affect portabl msvc disabl intern clfft fallback use opencl support gromac requir msvc gromac opencl build requir clfft clfft found user system may well version clfft bundl within gromac built msvc support clfft time configuretim fatal error issu case issu explicitli requir bit platform opencl bit opencl runtim requir gromac known opencl implement bit platform bit known bit platform bit opencl henc requir bit platform configuretim opencl build known unsupport bit platform armv miscellan improv doc appli electr field gromac releas note version releas februari th releas note document chang taken place gromac sinc previou version fix known issu also incorpor fix made version earlier find describ refreleasenot note develop pleas use underlin individu entri fix issu subfold otherwis format webpag mess also pleas use syntax issuenumb refer issu gitlab without space colon number fix mdrun could behav incorrectli actual fix pme forc fe without perturb qlj pme would incorrectli ignor mesh forc perturb atom charg lj atom type actual perturb note rather uncommon scenario issu issu avoid overzeal program abort orient restraint could happen mdrun would abort check orient restraint multipl molecul even though restraint appli issu calcul coulomb lj reciproc term rerun rerun would calcul coulomb lj reciproc term lead wrong potenti energi bug show gromac compil without gpu support issu fix gmx tool ad check inconsist input distanc restraint label gmx disr fix affect portabl fix compil error intel compil fix compil error intel compil updat initi releas compil fail mcpcom core dump file filepullutilcpp miscellan avoid cryptic gpu detect error devic unavail memori issu issu gromac releas note version releas octob nd releas note document chang taken place gromac sinc previou version fix known issu also incorpor fix made version earlier find describ refreleasenot note develop pleas use underlin individu entri fix issu subfold otherwis format webpag mess also pleas use syntax issuenumb refer issu gitlab without space colon number fix mdrun could behav incorrectli fix incorrect pressur atom cmap cross box boundari virial calcul thu pressur would incorrect second third atom involv charmm cmap correct term would resid differ period imag happen protein posit box boundari note energi forc correct sampl affect pressur coupl appli protein cross box boundari issu issu fix incorrect lj cutoff gpu rvdw rcoulomb rvdw chosen user smaller rcoulomb mdp file lj cutoff would initi set coulomb cutoff comput nonbond interact gpu affect energi minim mdrun rerun first nstlist step normal md run sinc correct lj cutoff set pme tune default start nstlist step unless pme tune disabl notunepm issu fix unlik miss bond forc cuda gpu domain decomposit forc could miss bond interact comput cuda gpu domain decomposit nonloc bond interact nonloc nonbond interact two domain note extrem unlik happen sinc distanc bond atom need larger pairlist cutoff distanc nonloc atom within pairlist cutoff distanc issu fix incorrect report final kinet energi temperatur leapfrog integr kinet energi temperatur report last step incorrect last step divis nstcalcenergi nsttcoupl nstpcoupl issu fix segment fault grompp mdrun cosin com pull issu fix gmx tool fix grompp ad angl constraint constraint use mdp option constraintsallangl angl involv bond suppli constraint topolog would remov replac angl constraint issu fix gmx wham angl dihedr geometri gmx wham would appli incorrect radian degre unit convers lead overlap notanumb output issu issu fix bug gmx xpmp tool would fail provid librari file read issu fix bug gmx anaeig issu note read second set set eigenvector could lead problem number eigenvector less three time number atom issu fix issu demuxpl script trajectori could becom discontinu simul longer ns exchang stride multipl ps affect postprocess trajectori gener replica exchang simul made gmx disr work nonconsecut label restraint issu fix write gro file index group output gro file eg gmx editconf f n would take atom name output file order atom input file rather order atom indic indic index file issu made gmx make_ndx keep chain id old style structur file read caus chain id overwritten default valu issu fix affect portabl disabl pme opencl appl appl opencl compil fail produc function clfft build opencl pme support therefor disabl appl platform issu miscellan ad amd zen detect amd zen architectur detect differ zen use bit wide avx simd instruct gmx_simdavx_ default also nonbond kernel paramet tune zen signific impact perform gromac releas note version releas april th releas note document chang taken place gromac sinc previou version fix known issu also incorpor fix made version earlier find describ refreleasenot note develop pleas use underlin individu entri fix issu subfold otherwis format webpag mess also pleas use syntax issuenumb refer issu gitlab without space colon number fix mdrun could behav incorrectli fix lbgf minim minim could fail number system issu disallow pull geometri directionperiod awh could lead incorrect behavior cryptic error messag issu fix mdrun nstep option fix deprec mdrun option nstep allow extens simul certain condit issu fix gmx tool gmx cluster clndx indic correct report indic trajectori frame cluster small one issu gmx editconf f inpdb outpdb preserv chain id inadvert broken fix issu tool accept tpr file input pdbgmx solvat insertmolecul tool could longer accept input configur contain tpr format file fix issu fix segment fault prepar simul anneal input grompp unabl prepar tpr file input contain simul anneal procedur code fix allow gener file issu fix affect portabl fix error avx detect code cmake detect code typo could lead wrong detect result miscellan ad warn use gromo forc field grompp warn gromo forc field use gromo forc field parametr physic incorrect multipletimestep scheme twinrang cutoff use singlerang cutoff physic properti densiti might intend valu issu prevent intern build fftw clang avx simd prevent intern build fftw clang attempt configur fftw compil avx support simd level support fftw clang compil compil fail issu updat perform guid recent intel processor avx instruct support note tradeoff cpu frequenc simd throughput advis user prefer avx avx gpuoffload highli parallel mpi case updat releas note reffix releasenotesgpu made gpu kernel thought resolv issu investig suggest real caus yet known gromac releas note version releas decemb rd releas note document chang taken place gromac sinc previou version fix known issu also incorpor fix made version earlier find describ refreleasenot note develop pleas use underlin individu entri fix issu subfold otherwis format webpag mess also pleas use syntax issuenumb refer issu gitlab without space colon number fix mdrun could behav incorrectli fix use uniniti data pme rank build gpu enabl version gromac clang either host host devic side compil pme datastructur could left uniniti lead use random valu lj pme energi virial pressur effect bug potenti total energi could wrong coulomb mesh energi didnt affect sampl pressur could also wrong would affect sampl pressur coupl use like simul would explod step doesnt seem affect version gromac built gcc host side compil issu fix rang memori access freeenergi calcul freeenergi calcul use lambda state output buffer would access one element beyond alloc size dont expect caus incorrect result memori checker would complain issu work around broken appl clang compil mac os catalina mac os catalina default xcode compil check enforc stack align would good idea appl ship c librari violat stack align avx instruct enabl issu fix error intermolecular interact domain decomposit intermolecular interact distanc longer cutoff domain decomposit mdrun could exit error messag miss interact issu fix issu awh pullgeometri direct period remov fatal error awh period pullgeometri direct distanc within half box size chang assert failur awh interv larger box size fatal error clarifi document pull geometri directionperiod issu remov assert failur awh use initi stage issu fix gmx tool make histogram output clearer output gave number event includ histogram bar au clear user fix dihedr angl calcul near degre boundari analysi tool could incorrectli calcul properti torsion angl averag close degre boundari issu remov problemat output gmx angl tool could happen calcul standard deviat angl caus divid zero error empti popul standard deviat meaningless remov issu fix affect portabl check libhwloc header runtim match could happen libhwloc header librari detect would lead mismatch compil runtim could caus cryptic crash use mdrun issu miscellan fix gro file format larg box gromac manual say box compon gro file format separ space space print box compon except first nm larger offdiagon compon nm smaller least one space alway print content written way alreadi least one space compon unchang exist parser conform document expect whitespac separ continu work case issu fix duplic pdb conect record output pdb conect record output duplic instanc sinc gromac use anywher analysi affect behavior fix issu fix perform issu bond interact wrong gpu stream could lead signific loss perform issu remov function nvml support remov nvidia gpu nvml support report gpu applic clock chang higher throughput longer avail ever support highend hardwar chang clock recent gener hardwar use root permiss avail user may becom less use gromac evolv complic gromac code wasnt regularli test maintain might return condit chang support cuda comput capabl x remov fermiera gpu cira longer widespread use test jenkin complic code longer support contrib directori remov code maintain year like didnt work remov git histori retain memori anybodi need bluegen support remov machin retir port activ maintain sinc gromac support bluegen qpx simd remov implicit solvent support remov sinc gromac simd multithread support mostli broken sinc nobodi want fix featur remov old forc field file paramet simul still read valu ignor remov gmx mdrun multi implement gmx mdrun multidir reliabl work featur nobodi will maintain duplic function bug fix fix type bug trilin dd code fix bug unusu offdiagon element commun atom ensur domain larg enough atom motion domain decomposit make sure domain alway larg enough atom move across addit domain issu veloc verlet integr output energi averag correct step veloc verlet integr would accumul energi write averag energi file step multipl nstcalcenergi correct step multipl nstcalcenergi note although slightli chang report averag averag incorrect issu fix chainsep behaviour pdbgmx issu grompp correctli check nstexpand nstcalcenergi expand ensembl without freeenergi perturb grompp would check nstexpand multipl nstcalcenergi latter case result might incorrect issu issu do_dssp unknown residu refdo_dssp gmx do_dssp tool would fail unknown residu well issu window issu highlight gromac releas decemb st patch releas may made sinc pleas use updat version highlight expect along detail link alway weve got sever use perform improv without gpu enabl autom default extrem interest feedback well work simul hardwar simul automat run use updat group atom whose coordin updat intragroup depend includ constraint virtual site improv perform elimin overhead updat cost intel integr gpu support opencl offload nonbond interact pme longrang interact also run singl amd gpu use opencl mean mani fewer cpu core need good perform hardwar chang anticip gromac function gmx mdrun memb featur embed protein membran retain probabl differ form gmx memb gmx mdrun rerun featur comput potenti energi quantiti trajectori retain probabl differ form gmx rerun gmx testparticleinsert integr mdp option contain dynam integr energi minim access differt form perhap gmx minim interpret mdp field minim use normalmod analysi may access eg gmx normalmod commandlin help tool thenx better abl document function support much function trjconv editconf eneconv trjcat function tool separ make avail compos modul plan make avail simpler tool eventu via gromac api develop gmx do_dssp replac tool deprec problemat user obtain instal separ dssp binari plan replac implement point nativ implement like base upon xssp make avail new gmx tool name _deprecatedfunction function deprec gromac gener virtual site replac aromat ring standard residu issu thought produc artefact circumst unpublish result never well test wide use need simplifi pdbgmx gmx mdrun gcom featur sometim overrid effect variou mdp set way difficult understand report user want commun pp rank less often choos nst mdp option accordingli benchmark option avail gmx benchmark issu option confout resethway resetstep intend use regular mdrun user make avail dedic tool clear also permit us custom default eg write file end simul part way suit respect mdrun benchmark use case confout longer requir gmx mdrun nstep issu number simul step describ tpr file chang gmx converttpr alter mdp file call gmx grompp conveni mdrun option outweight doubt qualiti implement clear record log file lack mainten function deprec gromac function declar deprec previou version gromac yet remov group cutoff scheme remain aspect group cutoff scheme remov remain featur eg tabul interact energygroup exclus vacuum simul avail verlet scheme deprec gromac qmmm support orca gamess mopac interfac untest maintain found deprec gromac portabl increas minimum cuda version requir requir cuda whose featur help keep code maintain increas minimum msvc version requir requir msvc reli full c support highest qualiti implement platform also requir cuda updat opencl requir version requir least opencl version api kernel current target vendor librari support restrict way preliminari support arm perform librari arm perform librari use fft transform fftw compatibl layer provid perform benefit use vanilla fftw recent armv architectur new improv featur gromac build reproduc build system longer emb inform built binari use includ inform help troubleshoot problem ensur checkpoint continu exact possibl seem necessari make build closer reproduc default use project offer distribut reproduc softwar includ gromac updat gmx cluster write correct pdb file index file cluster frame refpdb pdb file gmx cluster miss cryst header box inform make difficult need use gromac tool also refindex ndx file need refgmx trjconv split trajectori frame correspond cluster written add support write refindex ndx file well proper refpdb pdb file allow use com previou step pbc refer ad option pullpbcreffromprevstepcom pull use com group previou step calcul pbc jump instead refer atom sometim move lot simul option pbc refer atom use initi use use larg pull group group potenti larg rel movement atom transit extern api header librari librari access gromac transit new infrastructur gmxapi provid abstract execut environ simul work well develop tool extend md simul code without patch gromac sourc client code may built gromac instal md plugin code may appli extern calcul forc see restraint modul issu simul stop signal session resourc avail run time regist plugin project inform use case refer track issu doi bioinformaticsbti httpsdoiorgbioinformaticsbty_ exampl build extend gromac refer python packag httpsgithubcomkassonlabgmxapi_ sampl restraint plugin httpsgithubcomkassonlabsample_restraint_ repositori restraint modul gmxapi md extens code provid function previous access modifi pull code gromac sourc client softwar may built unmodifi gromac instal separ compil md extens regist new restraint function run time use simul client code built new gmxapi tool see enabl output averag pull forc posit normal pull modul write instantan output posit forc howev write averag valu period sinc last output work correctli even checkpoint restart interven enabl use new option pullfoutaverag pullxoutaverag miscellan grompp discourag use constraintsallbond common forc field includ amber charmm oplsaa parametr bond involv hydrogen constrain constrain bond avoid correct grompp issu note constraintsallbond use forc field time step smaller fs hydrogen replac virtual site use constraintshbond also improv perform document chang restructuredtext complet document move restructuredtext markup format allow build togeth display html pdf improv gromac tool pdbgmx write total charg differ pdbgmx note total charg residu atom field topolog file produc fact gener integ use troubleshoot issu system forc field prepar print done per residu rather everi atom nmeig thermochemistri nmeig tool analyz hessian matrix normal mode analysi gener thermochem properti like standard entropi heat capac constant volum intern thermal energi zeropoint energi analysi base harmon approxim use quantum chemistri implement write latex method reportmethod ad new tool reportmethod write summari method use set simul output file standard output perform improv implement updat group domain decomposit base socal updat group group atom depend updat constraint virtual site updat group typic use bond involv hydrogen constrain enabl automat possibl improv perform elimin mpi openmp commun constraint virtual site pme gpu run free energi perturb involv charg pme run gpu free energi perturb involv perturb charg pme longrang interact gpu offload avail opencl support devic support vendor amd intel nvidia possibl offload pme task gpu use opencl work way former cuda offload singl gpu use acceler comput longrang pme interact featur mean cpu core per gpu fast version need mani cpu core balanc gpu perform hardwar good balanc gpu cpu also show minor improv capac hardwar strong gpu run effect simul greatli improv intel integr gpu support gpu offload opencl intel cpu integr gpu possibl offload nonbond task gpu way offload done gpu architectur perform benefit particular modern desktop mobil intel cpu offload give higher simul perform bond interact support cuda gpu offload common type bond lj interact found run nvidia gpu cuda without domain decomposit interact perturb paramet support ad code gener support nvidia ture gpu cuda nvidia ture gpu directli target nvcc compil gener appropri set flag ture architectur default use cuda later gromac releas note version releas januari th releas note document chang taken place gromac sinc previou version fix known issu also incorpor fix made version earlier find describ refreleasenot note develop pleas use underlin individu entri fix issu subfold otherwis format webpag mess also pleas use syntax issuenumb refer issu redmin without space colon number fix mdrun could behav incorrectli fix mdrun write zero dhdlambda foreign lambda energi checkpoint freeenergi run separatedhdlfileno nstdhdl multipl nstenergi mdrun would write zero dhdlambda foreign energi energi file step last energi frame checkpoint would lead error freeenergi estim could go unnot valu deviat step issu fix bug com pull domain decompost weight rank use com pull domain decomposit result would incorrect use rel weight per atom use dd mpi rank would usual lead crash obvious wrong result issu fix incorrect awh freeenergi multipl walker share bia awh freeenergi output incorrect multipl walker share awh bia error went quadrat freeenergi updat interv well number walker error decreas updat size decreas time meant default awh set error neglig freeenergi updat interv ps observ error equal statist error walker rather fast reaction coordin slower coordin error smaller statist error issu fix conserv energi mttk use pcouplmttk tcouplnosehoov calcul conserv energi incorrect due two error date back gromac respect result report conserv energi use combin temperatur pressur coupl algorithm gromac version sinc gromac like wrong note error impact dynam conserv energi report never use calcul also note bug affect exact combin temperatur pressur coupl algorithm issu fix conserv energi nosehoov use tcouplnosehoov one temperatur group noninteg number degre freedom calcul conserv energi incorrect due error date back gromac report conserv energi use nosehoov temperatur coupl noninteg number degre freedom sinc gromac like slightli note error impact dynam conserv energi report never use calcul also note notic use small temperatur group small system issu fix kinet energi temperatur report mttk use pcouplmttk tcouplnosehoov report kinet energi temperatur slightli integr temperatur coupl trail report half time step note error impact dynam quantiti correctli integr wrongli report also note differ small unlik signific applic except rigor algorithm valid final note bug affect exact combin temperatur pressur coupl algorithm issu fix pull error messag angl dihedr com pull code could print incorrect pull group indic mdrun exit error long pull distanc angl dihedr geometri issu fix numer issu expand ensembl perform simul temper expand ensembl simul chang hamiltonian larg mont carlo propos state suffici unlik would underflow caus divis zero error fix numer harden logic flow propos would reject instead issu fix incorrect electr field strength appli electr field electr field gener electr field modul would incorrect use togeth domain decomposit due error index field atom instead current domain overlap region domain thick pairlist cutoff distanc electr field would doubl domain decomposit valid simul affect issu user calcul actual potenti across simul box use poisson equat potenti agre one provid input simul affect issu fix gmx tool improv charmm support gmx do_dssp issu fix nonfunt gmx horder option gmx horder tool would alway take normal along zaxi issu fix pull group index handl pull code would valid index group correctli lead infinit loop assert trigger grompp time issu fix affect portabl fix build osx code wouldnt compil due miss includ issu miscellan gromac releas note version releas march th releas note document chang taken place gromac sinc previou version fix known issu note develop pleas use underlin individu entri fix issu subfold otherwis format webpag mess also pleas use syntax issuenumb refer issu redmin without space colon number fix mdrun could behav incorrectli cosin acceler fail abort could run cosin acceler compat leapfrog integr mdpintegr md gromac howev accept input file request cosin acceler integr algorithm report viscosityrel quantiti simul sinc cosin acceler never appli case result obtain simul enabl cosin acceler integr md regard invalid issu fix gmx tool fix rang check bug gmx covar check invert caus rang check appli wrong issu fix affect portabl miscellan gromac releas note version releas octob th releas note document chang taken place gromac sinc previou version fix known issu also incorpor fix made version earlier find describ refreleasenot note develop pleas use underlin individu entri fix issu subfold otherwis format webpag mess also pleas use syntax issuenumb refer issu redmin without space colon number fix mdrun could behav incorrectli bug fix gpu version linc multipl domain case increas maximum number coupl constraint domain trigger memori realloc fix happen eg big molecul enter domain previous occupi smaller molecul bug affect singl domain case fix index handl nbodi virtual site domain decomposit incorrect index would use handl nbodi virtual site domain decomposit code would usual lead crash due illeg incorrect memori usag issu fix assert failur ljpme dispers correct vdwtypepm dispers correct mdrun would exit assert failur pme tune issu bug fix fep calcul modular simul domain decomposit use modular simul domain decomposit free energi calcul perturb mass simul would alway perform use mass lambda instead actual lambda valu ad workaround rdrand alway return random number ryzen amd ryzen seri cpu hardwar random number gener rdrand behav incorrectli alway return xffffffff hardwar bug detect runtim gromac switch softwarebas pseudorandom number gener instead mani motherboard vendor distribut firmwar updat contain microcod fix motherboard sold factoryinstal still system affect didnt receiv updat case ran simul one system theori random number seed could affect see algorithm sinc would mean seed use even fine virtual individu simul sinc gener number still random like case would serious affect use ident start conform start mani simul differ random seed gener automat instead manual select seed ryzen hardwar bug could mean simul actual get gener initi veloc stochast chang etc depend algorithm use list affect algorithm found seed gmx grompp affect user suppli seed use eg use ask gromac gener seed affect langevinstochast dynam vrescal thermostat anyth montecarlo relat gener random veloc decis exchang replica replica exchang simul simul use random compon awh analysi prepar tool might affect eg free volum calcul ion placement wham normal mode analysi pme error estim aka httpsxkcdcom diagnos aid detect error run gmx mdrun debug gromac later produc debug log typic call gmxdebug file contain follow messag processor program ran affect hardwar random number gener rdrand return xffffffff twice row may due known bug amd ryzen microcod use pseudorandom number gener prng rather hardwar devic earlier releas fail seedtestmakerandomse test unit test suit affect system check run make check build folder also find sampl test code link inform issu pleas check websit httpsarstechnicacomgadgetshowamonthsoldamdmicrocodebugdestroyedmyweekend_ fix gmx tool fix default output gmx trjcat demux file would written use default file name output issu fix affect portabl cuda support build cuda configur pass test build cuda mean hardwar cc longer support cc use issu fix build msvc build would fail due miss header issu check rdtscp x platform miscellan fix crash grompp whole system frozen whole system would frozen grompp would crash segment fault issu fix unexpect chang molecul index output simul molecul indic repeat molecul number consecut expect instead issu fix interface_include_directori libgromac cmake target filelibgromacscmak malform referenc nonexist directori issu gromac releas note version releas march rd releas note document chang taken place gromac sinc previou version fix known issu also incorpor fix made version earlier find describ refreleasenot note develop pleas use underlin individu entri fix issu subfold otherwis format webpag mess also pleas use syntax issuenumb refer issu gitlab without space colon number fix mdrun could behav incorrectli fix fatal error mdrun multidir rank per simul issu fix deadlock mdrun run multipl rank separ pme rank multipl pp rank well separ pme rank use mdrun could deadlock start pppme balanc issu avoid mdrun assert failur run shell updat gpu check shell ad mdrun task assign code mdrun fall back cpu produc clear error messag attempt run shell updat gpu issu allow larg prime factor mdrun mpi rank count domain decomposit would refus run larg prime factor mpi rank count even grid specifi user issu actual fix pme forc fe without perturb qlj pme would incorrectli ignor mesh forc perturb atom charg lj atom type actual perturb note rather uncommon scenario issu issu avoid deadlock check miss dd interact miss bond interact domain decomposit detect mdrun deadlock instead exit failur issu fix checkpoint restart use parrinellorahman mdvv checkpoint use parrinellorahman mdvv implement new modular simul approach could read issu avoid overzeal program abort orient restraint could happen mdrun would abort check orient restraint multipl molecul even though restraint appli issu add fatal error mdrun multidir simul share state start differ step restart mdrun multidir simul share state data eg replica exchang awh bia share nmr ensembl averag differ initi step caus note print could lead simul get sync fatal error issu situat issu issu correct skew box use modular simul without dd use modular simul without dd check whether box get overli skew use pressur control issu fix nmr restraint use modular simul use nmr restraint distanc orient restraint modular simul work expect orient restraint simul would fail segment fault would distanc restraint simul use time averag distanc restraint simul would run correctli output energi trajectori would occur coincid gener energi write step issu avoid integ overflow use dispers correct chang integ type store index meant valu could overflow turn neg lead wrong lookup unphys valu issu fix small pairlist buffer intel gpu pairlist buffer gener intel gpu slightli small assum x atomclust pair kernel instead x issu fix checkpoint file get sync simul share data simul share data eg replica exchang awh bia share nmr ensembl averag mpi barrier ad renam checkpoint file avoid checkpoint file simul get sync unlik case checkpoint file might temporari name content sync issu fix simul use graph modular simul simul use modular simul graph object would fail segment fault issu fix center mass motion remov frozen atom frozen atom part center mass motion remov group would still contribut mass group meant com veloc correct slightli small complet frozen atom remov com remov group grompp atom frozen along one two dimens part com remov group grompp issu warn issu fix temperatur calcul center mass motion remov part system uncommon case center mass motion remov part system whole system number degre freedom part without comm remov would incorrectli lower issu fix possibl issu pick undefin nb kernel type cpu refer implement nb kernel miss definit specif kernel type affect instal simd explicitli turn someth unlik happen product environ issu fix gmx tool fix affect portabl add support icc nextgen add support intel compil base llvm technolog compil gromac compil use cxxicpc cxxflagsqnextgen cmake document known issu opencl volta ture issu miscellan fix check modifi sourc file releas tarbal could happen modif sourc tree pick happen build directori gener issu gromac releas note version releas februari rd releas note document chang taken place gromac sinc previou version fix known issu note develop pleas use underlin individu entri fix issu subfold otherwis format webpag mess also pleas use syntax issuenumb refer issu redmin without space colon number fix mdrun could behav incorrectli fix bug gpu linc occasion shift atom wrong direct due miss block synchron cuda version linc share memori occasion overwritten new data may slightli affect final coordin shift atom issu fix calcul restraint potenti larg restraint deviat calcul code follow descript potenti manual potenti continu grow quadrat instead linearli issu fix gmx tool fix affect portabl miscellan gromac releas note version releas juli th releas note document chang taken place gromac sinc previou version fix known issu also incorpor fix made version earlier find describ refreleasenot note develop pleas use underlin individu entri fix issu subfold otherwis format webpag mess also pleas use syntax issuenumb refer issu redmin without space colon number fix mdrun could behav incorrectli fix gmx tool fix incorrect read certain older tpr file certain older tpr file could read incorrectli usual lead exit memori alloc error fix segment fault gmx lie tool would crash due mismatch size energi term file f_nre issu fix matrix read gmx xpmp tool would fail read matrix second matrix provid issu fix uniniti variabl warn gmx hbond tool would produc garbag due use uniniti memori issu actual fix gmx do_dssp tool still broken gave incorrect result previou fix issu allow configur dssp default path user configur default path dssp use gmx_dssp_program_path issu avoid segment fault gmx genrestr tool could fail run simpl input due memori access error caus access freed memori issu fix affect portabl updat msvc simd flag newli support simd flag may improv perform recent x run window fix error tinyxml link signatur link extern librari wrong miscellan updat messag use gpu nondynam integr gpu implement pme bond forc requir dynam integr messag inform user use gpu pme bond forc support nondynam integr made clear gromac releas note version releas april th releas note document chang taken place gromac sinc previou version fix known issu also incorpor fix made version earlier find describ refreleasenot note develop pleas use underlin individu entri fix issu subfold otherwis format webpag mess also pleas use syntax issuenumb refer issu gitlab without space colon number fix mdrun could behav incorrectli ewald dipol correct incorrect without domain decomposit ewald dipol correct epsilonsurfac disabl use domain decomposit domain decomposit work molecul consist singl updat group eg water fix releas issu expand ensembl simul restart checkpoint restart expand ensembl simul checkpoint expand ensembl would silent refus run simul would remain origin lambda state issu fix free energi calcul lj pme fix issu calcul wrong longrang correct use free energi perturb vdwtype pme affect forc energi lambda deriv foreign lambda issu veloc center mass remov correctli case updat gpu center mass motion remov veloc updat cpu memori case gpu updat copi back gpu memori updat cpu affect run veloc center mass remov particular veloc larg begin run issu fix checkpoint restart nonzero initi step restart checkpoint initstep mdp paramet ignor check simul alreadi finish result check work properli initstep specifi issu fix gmx tool time output unit fix select time unit microsecond larger gmx tool tu produc correct string xvg particularli xvgr plot fix do_dssp tool would fail segment fault issu fix affect portabl give clearer messag detect ibm_vsx support gcc cmake would fail confus error messag issu miscellan fix initi dlb state report initi dlb state report incorrectli log file either auto valu chosen mdrun startup remov function note develop pleas use underlin individu entri fix issu subfold otherwis format webpag mess also pleas use syntax issuenumb refer issu gitlab without space colon number group cutoff scheme group cutoff scheme remov sever kind simul depend longer work simul vacuum condit support user suppli tabl shortrang nonbond interact support switch shortrang nonbond interact pme support membran embed deactiv qmmm support issu gener reactionfield work correctli group scheme note gener reactionfield simul still perform use standard reaction field comput dielectr constant manual gmx anadock gmx anadock tool remov sinc belong gromac analyz autodock output gmx dyndom gmx dyndom tool remov sinc belong gromac analyz dyndom output gmx morph gmx morph tool remov sinc yield nonphys structur easili done script gmx mdrun gcom featur sometim overrod effect variou mdp set way difficult understand report user want commun pp rank less often choos nst mdp option accordingli bug fix note develop pleas use underlin individu entri fix issu subfold otherwis format webpag mess also pleas use syntax issuenumb refer issu gitlab without space colon number gmx mdrun append requir checkpoint found previous gmx mdrun append would start tpr configur thu append checkpoint file miss verlet buffer correctli handl perturb constraint freeenergi calcul perturb constraint verlet buffer could underestim constraint length perturb usual constraint perturb effect small much smaller overestim buffer due approxim result run perturb constraint affect issu highlight gromac releas januari patch releas may made sinc pleas use updat version highlight expect along detail link alway weve got sever use perform improv without gpu enabl autom default addit sever new featur avail run simul extrem interest feedback well new releas work simul hardwar new featur densityguid simul allow fit atom threedimension densiti map inclus gmxapi api user interfac manag complex simul data flow pluggabl molecular dynam extens code new modular simul built individu object describ differ calcul happen simul step parrinellorahman pressur coupl also avail mdvv integr run almost entir simul step singl cuda compat gpu support type simul includ coordin updat constraint calcul note develop pleas use underlin individu entri fix issu subfold otherwis format webpag mess also pleas use syntax issuenumb refer issu gitlab without space colon number _anticipatedchang note develop pleas use underlin individu entri fix issu subfold otherwis format webpag mess also pleas use syntax issuenumb refer issu gitlab without space colon number core gromac team want let user downstream develop know impend chang disrupt minim get touch feel someth inappropri plan deprec function often remain gromac year reli upon chang anticip gromac function gmx mdrun memb featur embed protein membran retain probabl differ form gmx memb gmx mdrun rerun featur comput potenti energi quantiti trajectori retain probabl differ form gmx rerun gmx testparticleinsert integr mdp option contain dynam integr energi minim access differt form perhap gmx minim interpret mdp field minim use normalmod analysi may access eg gmx normalmod commandlin help tool better abl document function support much function trjconv editconf eneconv trjcat function tool separ make avail compos modul plan make avail simpler tool eventu via gromac api develop gmx do_dssp replac tool deprec problemat user obtain instal separ dssp binari plan replac implement point nativ implement like base upon xssp make avail new gmx tool name function deprec gromac support bit architectur issu current plan larg scale resourc use bit architectur abil properli test evalu freeenergi softcor power issu freeenergi softcor power almost never use therefor deprec support armv issu sever issu current code architectur dont resourc support fix issu relat architectur larg hpc impact thu deprec function deprec gromac gener virtual site replac aromat ring standard residu issu thought produc artefact circumst unpublish result never well test wide use need simplifi pdbgmx benchmark option avail gmx benchmark issu option confout resethway resetstep intend use regular mdrun user make avail dedic tool clear also permit us custom default eg write file end simul part way suit respect mdrun benchmark use case confout longer requir gmx mdrun nstep issu number simul step describ tpr file chang gmx converttpr alter mdp file call gmx grompp conveni mdrun option outweight doubt qualiti implement clear record log file lack mainten portabl note develop pleas use underlin individu entri fix issu subfold otherwis format webpag mess also pleas use syntax issuenumb refer issu gitlab without space colon number ad support hygon dhyana cpu architectur support hardwar detect relat heurist implement hygon dhyana deriv firstgen amd zen share architectur detail enabl pme offload support opencl nvidia intel gpu thank portabl improv previous disabl pme opencl offload enabl also nvidia intel gpu fix build solari gcc gromac build solari gcc test illumo distribut openindiana hipster roll releas use gcc new improv featur note develop pleas use underlin individu entri fix issu subfold otherwis format webpag mess also pleas use syntax issuenumb refer issu gitlab without space colon number densityguid simul user appli addit forc three dimension refer densiti forc use fit atom densiti increas similar simul densiti refer densiti multipl protocol avail calcul simul densiti well similar refer simul densiti evalu virtual site line two atom fix distanc use use eg halogen charmm forc field issu gmxapi python support data flow driven simul analysi python avail default gromac instal user instal gmxapi python packag see refgmxapi new modular simul new approach combin individu calcul step singl simul step introduc focu extens modular simul default simul use velocityverlet nve nvt vrescal thermostat npt vrescal thermostat parrinellorahman barostat nph parrinellorahman barostat without free energi perturb miscellan note develop pleas use underlin individu entri fix issu subfold otherwis format webpag mess also pleas use syntax issuenumb refer issu gitlab without space colon number grompp warn macro mdp defin field unus topolog macro defin mdp eg dposr caus warn grompp encount pars topolog file issu introduc cmake variabl gmx_version_string_of_fork help user develop understand version gromac use anybodi provid fork version gromac shall set gmx_version_string_of_fork sourc code necessari run cmake appear log file user know version fork code produc result provid checksum valid releas tarbal releas version gromac provid checksum calcul file particip build binari build gromac tarbal file checksum compar checksum gener releas build checksum dont match version string modifi indic sourc tree modifi inform print log file user checksum possibl either due miss python instal origin checksum file miss indic differ version string issu updat physic constant codata reproduc comput quantiti easiest achiev softwar stay date standard valu standard unit thu updat conform data avail httpwwwcodataorgcommitteesandgroupsfundamentalphysicalconstants_ chang grompp warn decoupl without sd note warn grompp issu decoupl molecul without use sd integr chang note sinc valid use case use normal md run complet decoupl state issu improv gromac tool note develop pleas use underlin individu entri fix issu subfold otherwis format webpag mess also pleas use syntax issuenumb refer issu gitlab without space colon number fix bug gmx order calcdist refer posit distanc calcul calcul wrongli improv grompp usabl reject invalid mdp line line like reft reject descript messag help prevent kind error construct mdp input note mdp paramet name miss valu still accept lead default behavior paramet ad converttrj new tool refconverttrj gmx converttrj ad allow user interchang trajectori format without use legaci refgmx trjconv support action includ gener slim output trajectori well replac particl inform individu frame data structur file new tool allow usag command line select mean longer necessari write refindex ndx file select certain atom part drive split reftrjconv gmx trjconv tool smaller part ad extractclust ad dedic tool extract trajectori frame correspond differ cluster obtain refgmx cluster new refextractclust gmx extractclust tool gener new trajectori contain frame correspond correct cluster correspond option sub refgmx trjconv remov chang behaviour genion function genion alter prevent swap ion solvent closer rmin nonsolv atom improv prevent situat ion could place core protein would potenti render fold protein less stabl may requir long equilibr time perform improv note develop pleas use underlin individu entri fix issu subfold otherwis format webpag mess also pleas use syntax issuenumb refer issu gitlab without space colon number factor speedup nonbond freeenergi kernel nonbond freeenergi kernel factor faster nonzero b state factor one zero state especi improv run perform nonperturb nonbond offload gpu case pmemesh calcul alway take cpu time proper dihedr fourier type improp dihedr period type simd acceler avoid configur ownfftw avx enabl gromac use avx previous gromac configur use avx flavor intern built fftw would configur also contain avx kernel could caus perform loss often noisi fftw autotun pick avx kernel run otherwis use avxavx could run higher cpu clock without avx clock speed limit avx use intern fftw gromac also configur simd flavor updat constraint run gpu standard simul see user guid detail updat constraint offload gpu cuda thu comput intens part simul offload provid better perform use fast gpu combin slow cpu default updat run cpu use gpu singl rank simul one use new updat gpu command line option use domain decomposit pleas see gpu direct commun run multipl gpu cuda commun oper perform directli gpu memori space automat rout includ via nvlink avail behaviour yet enabl default new codepath verifi standard gromac regress test time releas still lack substanti realworld test enabl set follow environ variabl nonnul valu shell gmx_gpu_dd_comm halo exchang commun pp task gmx_gpu_pme_pp_comm commun pme pp task gmx_force_update_default_gpu also set order combin new gpu updat featur combin mani common simul keep data resid gpu across timestep avoid expens data transfer note current requir gromac built intern threadmpi librari rather extern mpi librari limit singl comput node stress user care verifi result default path report issu grate receiv help us matur softwar bond kernel gpu fuse instead launch one gpu kernel list interact type one gpu kernel handl list interact improv perform run bond calcul gpu delay rampup ad pppme tune modern cpu gpu take second ramp clock speed therefor pppme load balanc start second instead md step avoid suboptim perform set _olderreleasenot releas note older gromac version unfortun resourc finit mani version gromac longer activ maintain page record releas note version user find record chang made major patch releas gromac major releas contain chang function support wherea patch releas contain fix issu identifi correspond major releas issu number report releas note detail found httpsgitlabcomgromacsgromacsissu issu number gromac seri todo come soon remov function note develop pleas use underlin individu entri fix issu subfold otherwis format webpag mess also pleas use syntax issuenumb refer issu gitlab without space colon number bug fix note develop pleas use underlin individu entri fix issu subfold otherwis format webpag mess also pleas use syntax issuenumb refer issu gitlab without space colon number densityguid simul normal mdp option densityguidedsimulationnormalizedens ye refer densiti simul densiti valu previous divid sum valu lead surpris behavior refer densiti lot neg voxel valu densiti start repel protein structur instead attract total sum voxel valu smaller zero neg normal constant lead sign chang voxel valu avoid behavior refer densiti normal sum posit valu uniti ensur normal constant alway posit apart avoid unexpect behavior expect also lead smaller absolut differ refer densiti simul densiti small benefit numer stabil chang affect simul voxel valu neg usual exclud synthet data run densityguidedsimulationnormalizedens ye larger effect first similar measur innerproduct effect forceconst scale second similar measur sum voxel valu neg highlight gromac releas insert date patch releas may made sinc pleas use updat version highlight expect along detail link alway weve got sever use perform improv without gpu enabl autom default addit sever new featur avail run simul extrem interest feedback well new releas work simul hardwar new featur note develop pleas use underlin individu entri fix issu subfold otherwis format webpag mess also pleas use syntax issuenumb refer issu gitlab without space colon number chang api note develop pleas use underlin individu entri fix issu subfold otherwis format webpag mess also pleas use syntax issuenumb refer issu gitlab without space colon number _anticipatedchang note develop pleas use underlin individu entri fix issu subfold otherwis format webpag mess also pleas use syntax issuenumb refer issu gitlab without space colon number chang anticip gromac function function deprec gromac portabl new improv featur note develop pleas use underlin individu entri fix issu subfold otherwis format webpag mess also pleas use syntax issuenumb refer issu gitlab without space colon number miscellan note develop pleas use underlin individu entri fix issu subfold otherwis format webpag mess also pleas use syntax issuenumb refer issu gitlab without space colon number improv gromac tool note develop pleas use underlin individu entri fix issu subfold otherwis format webpag mess also pleas use syntax issuenumb refer issu gitlab without space colon number perform improv note develop pleas use underlin individu entri fix issu subfold otherwis format webpag mess also pleas use syntax issuenumb refer issu gitlab without space colon number gromac releas note version releas todo releas note document chang taken place gromac sinc previou version fix known issu also incorpor fix made version earlier find describ refreleasenot note develop pleas use underlin individu entri fix issu subfold otherwis format webpag mess also pleas use syntax issuenumb refer issu gitlab without space colon number fix mdrun could behav incorrectli fix crash steer fep awh without pme separ pme rank would segfault decid whether earli pme result need issu fix gmx tool fix affect portabl miscellan remov function note develop pleas use underlin individu entri fix issu subfold otherwis format webpag mess also pleas use syntax issuenumb refer issu gitlab without space colon number remov mdrunonli build configur need mdrunonli build gromac expir set depend regular gromac deprec gromac remov simplifi mainten test document instal teach new user issu remov support x mic armv sparc hpcace ibm vmx simd platform dead hpc longer support knl platform unaffect chang issu remov deprec environ variabl follow environ variabl remov deprec favor betternam altern gmx_cuda_nb_ana_ewald gmx_ocl_nb_ana_ewald use gmx_gpu_nb_ana_ewald gmx_cuda_nb_tab_ewald gmx_ocl_nb_tab_ewald use gmx_gpu_nb_tab_ewald gmx_cuda_nb_ewald_twincut gmx_ocl_nb_ewald_twincut use gmx_gpu_nb_ewald_twincut issu remov abil gmx wham read pdo file file pdo format written gromac version prior long ago abl read longer relev capabl deprec version need read file pleas use older version gromac remov bit support deprec bit support way test architectur longer relev hpc offici longer support build gromac bug fix fix slight inaccuraci use virtual site pressur coupl virtual site reconstruct system propag scale due pressur coupl virtual site type linear combin atom complet correct sinc scale due pressur coupl small healthi simul result inaccuraci expect extrem minor case undetect issu correct dvremaindl nstdhdl nstcalcenergi nstcalcenergi multipl nstdhdl incorrect dvremaindl term written energi file note dhdl output dhdlxvg energi file use eg gmx bar correct note develop pleas use underlin individu entri fix issu subfold otherwis format webpag mess also pleas use syntax issuenumb refer issu gitlab without space colon number remov veloc output acceler group report veloc energi file acceler group alway zero veloc longer report energi file issu use correct c paramet mepo oplsaa oplsaa torsion must sum paramet mepo chang c paramet correct valu issu allow function type fourier dihedr free energi perturb fourier dihedr dihedr interact type could use free energi perturb simul hood dihedr paramet anyhow convert ryckaertbelleman paramet check perturb two function issu scale coordin frozen atom parrinellorahman pressur coupl parrinellorahman pressur coupl use box scale appli atom caus frozen atom shift effect drastic toward side box pressur chang significantli simul frozen atom ignor coupl atom frozen dimens shall keep valu issu avoid nonuniform rotat test particl insert anisotrop system anisotrop system random angl would get uniform distribut issu allow free energi calcul linear angl potenti free energi calcul linear angl potenti explicitli allow grompp issu fix progress display trjconv trjcat progress inform frame number time shown trajectori oper trjconv trjcat correctli display issu fix gromo dihedr gener disulfid bridg pdbgmx function gener correct dihedr disulfid bridg gromo forc field seri issu fix energi term name period improp dihedr use name intern nonperiod version print energi file read could caus tool confus tri compar term file term written differ order gmx densiti alway use rel coordin realist use case use absolut coordin bin box dimens chang gmx densiti alway use rel coordin intern also avoid issu output scale last instead averag box size user forget option ensur output alway correct get rid occassion segfault issu highlight gromac releas februari st patch releas may made sinc pleas use updat version highlight expect along detail link alway weve got sever use perform improv without gpu enabl autom default addit sever new featur avail run simul extrem interest feedback well new releas work simul hardwar new featur freeenergi kernel acceler use simd make freeenergi calcul three time fast use gpu new formul softcor nonbond interact freeenergi calcul allow finer control alchem transform pathway new transform pull coordin allow arbitrari mathemat transform one pull coordin new interfac multiscal quantum mechan molecular mechan qmmm simul cpk quantum chemistri packag support period boundari condit grompp perform improv cool quot music playlist httpsopenspotifycomplaylistojxtgiajulgfwpqzx_ addit featur port modular simul ad amd gpu support sycl via hipsycl_ gpu offload featur support sycl pme gpu updat improv parallel gpuacceler run use cuda extend gpu direct commun support multinod simul use cudaawar mpi note develop pleas use underlin individu entri fix issu subfold otherwis format webpag mess also pleas use syntax issuenumb refer issu gitlab without space colon number chang api note develop pleas use underlin individu entri fix issu subfold otherwis format webpag mess also pleas use syntax issuenumb refer issu gitlab without space colon number remov physic constant convers function legaci convers function physic constant gromac represent remov didnt see use librari note develop pleas use underlin individu entri fix issu subfold otherwis format webpag mess also pleas use syntax issuenumb refer issu gitlab without space colon number chang anticip gromac function function deprec gromac gmx_opencl_nb_cluster_s cmake variabl deprec favor gmx_gpu_nb_cluster_s opencl sycl support differ cluster size gmx_gpu_nb_cluster_s use go forward builtin viewer gmx view remov littl use test function worth attempt maintain move forward issu analysi tool gmx chi remov tool function year pleas comment link issu interest issu guess mass atom radii atom name deprec atom mass vanderwa radii need suggest build proper gromac topolog instead use pdb file directli even tool support issu issu portabl intel classic compil iccicpc longer support support intel clangbas compil oneapi icxicpx instead pleas use gcc issu provision initi gmx_install_nblib_api gmxapi build option build_shared_lib cmake option gmxapi gmx_install_nblib_api produc share object librari default valu initi build_shared_lib pend movement issu relat issu coupl option subject chang user gener need manual set gmxapi gmx_install_nblib_api issu updat pybind depend pybind longer bundl gromac gmxapi python packag build system reli pep build requir get pybind header depend python packag system packag manag like pip download depend automat packag manag automat fulfil depend still report miss depend user sample_restraint sampl project bundl python_packagingsample_restraint still primit cmakeonli build procedur fork project sourc may choos modern build system similarli gmxapi bundl pybind sourc within gromac repositori sample_restraint option default gmxapi_extension_download_pybindon issu cmake toolchain file replac cach file gromacstoolchaincmak file previous instal cmake_install_prefixsharecmakegromac longer provid instead partial cmake cach file instal cmake_install_prefixsharecmakegromacssuffixgromacshintscmak client softwar may get cmake hint configur c pathtogromacshintscmak instead forc crosscompil cmake configur dcmake_toolchain_fil toolchain client softwar bundl gromac gmxapi python packag longer requir toolchain file see docgmxapiuserguideinstal detail issu bundl mupars gromac bundl mupars version also possibl link extern provid librari new improv featur note develop pleas use underlin individu entri fix issu subfold otherwis format webpag mess also pleas use syntax issuenumb refer issu gitlab without space colon number hybrid quantumclass simul qmmm cpk interfac simul chemic reaction pathway provid atomist insight mani biolog chemic process perform kind model complex system includ solvent andor protein multiscal quantum mechan molecular mechan qmmm approach often use introduc whole new interfac perform qmmm simul fulli period system use mdmodul coupl gromac cpk quantum chemistri packag enabl hybrid simul system system chemic reaction occur interfac support simul techniqu avail gromac includ energi minim classic md enhanc sampl method umbrella sampl acceler weight histogram method transform pull coordin mathemat transform pull coordin new pull coordin type name transform ad enabl mathemat transform previous defin pull coordin use user suppli formula string allow exampl nonlinear transform distanc eg contact coordin nonlinear combin multipl pull coordin power tool defin complex reaction coordin combin acceler weight histogram method enhanc sampl replicaexchang molecular dynam simul gpu updat replicaexchang molecular dynam work gpu updat new formul softcor interact free energi calcul addit gromac allow choos two scheme soften nonbond interact alchem perturb beutler et al ref refbeutl gapsi et al ref refgapsi softcor function flexibl share bias awh acceler weight histogram method bias share subset simul without restrict allow flexibl ensembl simul setup well simpler launch set simul featur implement modular simul sever featur ad modular simul includ temperatur pressur coupl algorithm avail legaci simul expand ensembl pull free energi calcul support nonperturb bond interact previous gromac permit usag special bond interact restrict anglesdihedr combin bendingtors potenti free energi calcul allow long interact perturb issu adapt number thread actual permit hardwar previous gromac would attempt start mani thread processor system tri pin thread process unit would fail whenev allow use processor eg slurm provid part node job afx processor reserv system would also start far mani thread contain environ part improv hardwar detect detect processor allow run adapt number thread whenev cpu limit set improv perform contain make gromac right thing slurm queue system alloc part node enabl use openmp thread threadforcereduct code gromac allow openmp thread default chang intern logic limit number thread rather refus run appli within rank use unlimit number thread combin openmp thread multipl rank larg machin mani core usual faster sinc domain decomposit use multipl rank better adapt nonuniform memori access hardwar issu center symmetr support gmx potenti gmx potenti support center symmetr option gmx densiti particularli use membran issu miscellan note develop pleas use underlin individu entri fix issu subfold otherwis format webpag mess also pleas use syntax issuenumb refer issu gitlab without space colon number grompp longer modifi nstcomm grompp longer set nstcomm interv center mass motion remov equal nstcalcenergi nstcomm nstcalcenergi note still print case bond atom type name start digit bond atom type name topolog allow start number name support contain least one nondigit charact issu grompp warn exclus forc might miss use pme exclus nonperturbedatom pair within cutoff distanc otherwis mdrun might comput grid correct forc energi grompp comput distanc start structur warn beyond cutoff distanc gener error beyond cutoff distanc issu awh cover diamet angl unit degre use old tpr file appli awh angl dihedr nonzero cover diamet result error suggest regener tpr file issu core spinup code remov formerli nonx nonpowerpc platform mdrun ran multithread code tri wake core os might power caus problem arm platform seem suit signific number platform use gromac remov requir pleas manual spinup core eg stress cpu nproc issu add document linear angl potenti ad document refer linear angl potenti also ad please_cit entri call refer yet issu gmxapimdrun guarante trajectori output gmxapi simul alway run fullprecis trajectori output order guarante avail usabl output trajectori mdrunoutputtrajectori result issu gmxapimdrun accept arbitrari runtim argument arbitrari mdrun argument pass gmxapi new runtime_arg key word argument accept dictionari flag valu issu improv mpi awar task uniqu gmxapi python runner previous python compon pymodgmxapisimul react presenc mpi context could result duplic work even invalid file access pyfuncgmxapicommandline_oper execut task uniqu work directori gmxapi oper task launch one process per ensembl member mpipi httpsmpipyreadthedocsioenstable__ avail mpi environ inspect multipl rank discov resourcemanag instanc variou rank coordin make sure updat call member task result broadcast rank resourcemanag work occur chang mere constitut bugfix addit develop need optim use resourc reduc unnecessari data transfer issu discourag use berendsen coupl algorithm algorithm proven caus incorrect sampl respect distribut mainli provid mean provid backward compat older simul use discourag chang current note use actual warn grompp time improv gromac tool note develop pleas use underlin individu entri fix issu subfold otherwis format webpag mess also pleas use syntax issuenumb refer issu gitlab without space colon number gmx msd migrat trajectoryanalysi framework tool use gromac select syntax rather pipe select via stdin select made use sel option new option call maxtau limit maximum time delta frame compar calcul msd allow user otherwis would run outofmemori error slow execut larg system restrict sampl use tau valu migrat come speedup execut time rare use featur yet migrat includ tensor option yet implement system com remov rmcomm yet implement bfactor write use pdb option yet support slight behavior chang remov mw option gmx msd mol take msd centerofmass molecul massweight done mol select previou gromac version mw default nomw silent ignor mol chosen chang caus differ result perform msd calcul nonhomogen group particl without mol set issu gmx lie read energi file rerun tool formerli reli presenc pressur field edr file field miss edr came rerun howev never necessari reli presenc pressur field tool work correctli issu gmx chi longer need residuetypesdat entri custom residu need add name custom residu residuetypesdat remov serv purpos make gmx chi easier use gmx wham minor improv text output report file handl inputfil column content easier follow gmx do_dssp support dssp version newer dssp version program use do_dssp specifi option ver set dssp environ variabl mkdssp execut path eg setenv dssp optdsspmkdssp issu gmx trjconv dump work reliabl frame nearest dump time alway written even time rang present trajectori file get last frame trajectori file whose frame tempor order request dump time larger time frame trajectori like gmx trjconv dump issu gmx trjconv handl select tng file better write tng file whole system written even user request select atom select atom written select name match molecul type select atom present molecul molecul written expect correct molecul count etc select match atom molecul atom multipl molecul tng file contain singl molecul instanc contain atom issu gmx pdbgmx longer accept charg glutamin qln oplsaa forcefield torsion angl definit miss nonstandard charg glutamin residu grompp would use default torsion angl instead avoid silent error charg glutamin residu remov oplsaa forcefield issu gmxapicommandline_oper isol work directori subprocess launch wrap command line oper run uniqu subdirectori user reli output_fil input file output map affect user reli assumpt wrap command execut need adjust script stderr stdout file output member still primari support mean access command output addit new directori output give filesystem path use subprocess see pyfuncgmxapicommandline_oper detail issu perform improv note develop pleas use underlin individu entri fix issu subfold otherwis format webpag mess also pleas use syntax issuenumb refer issu gitlab without space colon number gpu direct commun cudaawar mpi direct gpu commun support extend simul use cudaawar librarympi run nvidia gpu detect cudaawar mpi perform cmaketim runtim featur test primarili openmpi cudaawar mpi implement suitabl also possibl use threadmpi implement gromac cudaawar mpi support still lack substanti test henc includ current releas develop featur use caution henc even suitabl mpi detect direct commun use default enabl use gmx_enable_direct_gpu_comm environ variabl issu issu dynam pairlist gener energi minim energi minim pairlist domain decomposit run parallel perform least one atom move half pairlist buffer size pairlist use construct everi step nonbond freeenergi kernel use simd free energi calcul perform improv make nonbond freeenergi kernel simd acceler avx kernel time fast give notic speedup system especi perturb interact calcul bottleneck particularli case use gpu perform improv freeenergi run factor issu issu pmepp gpu direct commun pipelin multigpu run direct pmepp gpu commun enabl pme rank pipelin coordin transfer comput pme spread spline kernel coordin consum data transfer handl separ allow comput commun overlap expect benefit system hardwar commun interfac share multipl gpu eg pcie within multigpu server infiniband across multipl node issu domain decomposit singl mpi rank run singl mpi rank pme without gpu mdrun use domain decomposit machineri reorder particl improv perform especi larg system behavior control environ variabl gmx_dd_single_rank restrict gpu support multipl time step gpu use combin mt limit setup longrang nonbond forc appli longer timestep comput cpu compon calcul everi step gpu gmx grompp run faster seri improv loop paramet atomlookup code gmx grompp transform run faster use simpler standard code idiom pme decomposit support mix mode cuda processmpi pme decomposit support mix mode cuda backend support gromac compil extern processmpi underli mpi implement cudaawar featur lack substanti test disabl default enabl set gmx_gpu_pme_decomposit environ variabl perform improv run ampereclass nvidia gpu improv perform shortrang nonbond kernel issu _special special topic section cover special topic concern use gromac specif scientif problem toctre maxdepth specialfreeenergyimplement specialpul specialawh specialenforcedrot specialelectricfield specialcompelectrophi specialfreeenergypmf specialremovefastdgf specialviscositycalcul specialshear specialtabulatedinteractionfunct specialqmmm specialmimicqmmm specialvmdimd specialmembraneembed specialdensityguidedsimulationrst run paramet program onlin document instal standard unix man page program sourc gmxrc script gromac binari directori host alreadi present manpath environ variabl abl type eg man gmxgrompp also use h flag command line eg refgmx grompp gmx grompp h see inform well gmx help grompp list program avail refgmx help gmx help file type inform differ file type found docfileformat gromac file written xdr format read architectur gromac version later configur script found xdr librari system alway present unix sinc necessari nf support run paramet descript refmdp paramet found link local gromac instal refher mdpgener raw latex clearpag prefac disclaim gromac version contribut emil apol rossen apostolov paul bauer herman jc berendsen pr bjelkmar christian blau viacheslav bolnykh kevin boyd aldert van buuren rudi van drunen anton feenstra gerrit groenhof anca hamuraru vincent hindriksen eric irrgang aleksei iupinov christoph junghan joe jordan dimitrio karkouli peter kasson jiri krau carsten kutzner per larsson justin lemkul viveca lindahl magnu lundborg erik marklundpasc merz pieter meulenhoff teemu murtola szilrd pll sander pronk roland schulz michael shirt alexey shvetsov alfon sijber peter tieleman teemu virolainen christian wennberg maarten wolf artem zhmurov mark abraham berk hess david van der spoel erik lindahl depart biophys chemistri univers groningen nijenborgh ag groningen netherland thisyear gromac develop team royal institut technolog uppsala univers sweden manual complet pretens due lack time contributor first prioriti improv softwar work continu case might mean inform entir correct comment form content welcom pleas send one mail list see webpage_ section refcontribut gmxcontribut open issu issu tracker_ correct also made gromac git sourc repositori upload gromac gitlab_ releas updat version manual whenev releas new version softwar gener good idea use manual major minor releas number gromac instal citat inform todo need link ref list gmx_manual_doi_str howev prefer cite gromac paper refbekk et al refbekkera refberendsen et al refberendsena reflindahl et al reflindahla refvan der spoel al refspoela refhess et al refhessb refpronk et al refpronk refpal et al refpal refabraham et al refabraham publish result futur develop depend academ research grant sinc packag distribut free softwar gromac free softwar entir gromac packag avail gnu lesser gener public licens lgpl version mean free free speech use without pay us money redistribut gromac andor modifi term lgpl publish free softwar foundat either version licens option later version detail check copi file sourc code consult page httpwwwgnuorglicensesoldlicenseslgplhtml__ gromac sourc code select set binari packag avail homepag wwwgromacsorg httpwwwgromacsorg__ fun raw latex clearpag _ff interact function forc field accommod potenti function use popular forc field see refff gromac offer choic function nonbond interact dihedr interact describ appropri subsect potenti function subdivid three part nonbond lennardjon buckingham coulomb modifi coulomb nonbond interact comput basi neighbor list list nonbond atom within certain radiu exclus alreadi remov bond coval bondstretch anglebend improp dihedr proper dihedr comput basi fix list restraint posit restraint angl restraint distanc restraint orient restraint dihedr restraint base fix list appli forc extern appli forc see chapter refspeci toctre maxdepth functionsnonbondedinteract functionsbondedinteract functionsrestraint functionspolar functionsfreeenergyinteract functionsinteractionmethod functionslongrangeelectrostat functionslongrangevdw functionsforcefield _defunit definit unit notat follow convent mathemat typeset use throughout document vecex replac mathmathbfr_i lenex replac mathr_i tabl align center width auto item notat exampl vector bold ital vecex vector length ital lenex defin lowercas subscript mathi mathj mathk mathl denot particl mathmathbfr_i posit vector particl mathi use notat math beginalign mathbfr_ij mathbfr_jmathbfr_i r_ij mathbfr_ij endalign label eqnnot forc particl mathi denot mathmathbff_i math mathbff_ij mboxforc exert j label eqbforcenot md unit gromac use consist set unit produc valu vicin uniti relev molecular quantiti let us call md unit basic unit system nm ps k electron charg e atom mass unit u see numreft tablebasicunit valu use gromac taken codata intern recommend valu fundament physic constant see nist homepag httpnistgov__ tnm replac mathmathrmnm tu replac u unifi atom mass unit tu replac math time kg tti replac mathmathrmp tc replac e elementari charg tc replac math time c tte replac k _tablebasicunit tabl basic unit use gromac align center width auto quantiti symbol unit length r tnm mass tu tu time tti charg q tc tc temperatur tte consist unit set deriv unit given numreft tablederivedunit tse replac mathev tsf replac mathmathbff tsp replac mathp tsv replac mathv tsd replac mathmu tsep replac mathphi tsef replac math tdue replac mathmathrmkjmol tduf replac mathmathrmkjmolmathrmnm tdup replac bar tduv replac mathmathrmnmp mathrmm tdud replac mathmathrm nm tduep replac mathmathrmkjmolmathrm tduep replac math volt tduef replac mathmathrmkjmolmathrmnm mathrm tduef replac math time mathrmv _tablederivedunit tabl deriv unit note addit convers factor math amu mathapprox appli get bar instead intern md unit energi log file align center width auto quantiti symbol unit energi tse tdue forc tsf tduf pressur tsp tdup veloc tsv tduv dipol moment tsd tdud electr potenti tsep tduep tduep electr field tsef tduef tduef electr convers factor mathffrac pi varepsilon_o mathmathrmkjmathrmmolmathrmnmmathrm e relat mechan quantiti electr quantiti math v f fracqr mbox f f fracqr label eqnelecconv electr potenti mathphi electr field mathmathbf intermedi quantiti calcul energi forc occur insid gromac use evalu choic equat relat unit strongli recommend follow usual practic includ factor mathf express evalu mathphi mathmathbf math beginalign phimathbfr f sum_j fracq_j mathbfrmathbfr_j mathbfemathbfr f sum_j q_j fracmathbfrmathbfr_j mathbfrmathbfr_j endalign label eqnelecfacinclud definit mathqphi energi mathqmathbf forc unit given numreft tablederivedunit mv potenti thu potenti electron charg distanc nm equal mathf approx unit mathapprox v exact valu math v note unit mutual consist chang unit like produc inconsist therefor strongli discourag particular  use instead nm unit time chang ps mathmathrmkcalmathrmmol mathmathrmkjmol use instead mathmathrmkjmol energi unit time becom ps unit temperatur chang k case electr energi go wrong still comput mathmathrmkjmol expect nm unit length although care rescal charg may still yield consist clear confus must rigidli avoid term md unit usual physic constant take differ valu see numreft tableconst quantiti per mol rather per molecul distinct boltzmann constant mathk ga constant mathr valu mathmathrmkjmol mathrmk _tableconst tabl physic constant align center width auto symbol name valu mathn_av avogadro number mathtim mathrmmol mathr ga constant mathtim mathrmkjmolmathrmk mathk_b boltzmann constant idem mathh planck constant mathmathrmkjmolmathrmp mathhbar dirac constant mathmathrmkjmolmathrmp mathc veloc light mathmathrmnmp reduc unit simul lennardjon lj system might advantag use reduc unit ie set mathepsilon_iisigma_iim_ik_b one type atom possibl specifi input reduc unit output also reduc unit one except temperatur express math reduc unit consequ use boltzmann constant evalu temperatur code thu matht mathk_bt reduc temperatur gromac temperatur matht mean reduc temperatur mathldot unit reduc temperatur requir gromac temperatur math numreft tablereduc quantiti given lj potenti math v_lj epsilon left leftfracsigmarright leftfracsigmarright right label eqnbaseljpotenti _tablereduc tabl reduc lennardjon quantiti align center width auto quantiti symbol relat si length r math r mathsigma mass math math time math mathsigmasqrtepsilonm temperatur math k math_bmathrmtepsilon energi e math e mathepsilon forc f math f mathsigmaepsilon pressur p math p mathsigma epsilon veloc v math v mathsqrtmepsilon densiti mathrho n mathsigma v mix doubl precis gromac compil either mix doubl precis document previou gromac version refer singl precis implement made select use doubl precis mani year use singl precis variabl would lead signific reduct accuraci although mix precis state vector ie particl coordin veloc forc store singl precis critic variabl doubl precis typic exampl latter virial sum forc system vari sign addit mani part code manag avoid doubl precis arithmet pay attent summat order reorgan mathemat express default configur use mix precis easi turn doubl precis ad option dgmx_doubleon cmake doubl precis slower mix precis depend architectur run doubl precis use somewhat memori run input energi fullprecis trajectori file almost twice larg energi mix precis accur last decim last one two decim forc nonsignific virial less accur forc sinc virial one order magnitud larger size element sum atom sec refviri case realli problem sinc fluctuat virial two order magnitud larger averag use cutoff coulomb interact caus larg error energi forc virial even use reactionfield lattic sum method error larger compar error due partial use singl precis sinc md chaotic trajectori similar start condit diverg rapidli diverg faster mix precis doubl precis simul mix precis accur enough case doubl precis requir get reason result normal mode analysi conjug gradient lbfg minim calcul diagon hessian longterm energi conserv especi larg system raw latex clearpag implement detail chapter present implement detail far complet deem necessari clarifi thing would otherwis hard understand singl sum virial gromac virial mathxi written full tensor form math xifracsum_i jnmathbfr_ijotimesmathbff_ij label eqnvirialfulltensorform mathotim denot direct product two vector _ comput inner loop md program multipl addit need _ shown possibl extract virial calcul inner loop ref refbekkerb virial system period boundari condit period must taken account virial math xifracsum_i jnmathbfr_ijnotimesmathbff_ij label eqnvirialperiod mathmathbfr_ijn denot distanc vector nearest imag atom mathi atom mathj definit add shift vector mathdelta_i posit vector mathmathbfr_i atom mathi differ vector mathmathbfr_ijn thu equal math mathbfr_ijnmathbfr_idelta_imathbfr_j label eqnvirialdiffvector shorthand math mathbfr_ijnmathbfr_inmathbfr_j label eqnvirialdiffvecshort triclin system possibl imag mathi truncat octahedron use possibl imag virial nonbond forc deriv singl sum virial nonbond forc routin given coupl consider special gromac take account calcul shortrang interact appli minimum imag convent consid closest imag neighbor particular never allow interact particl period imag equat mean mathi neq j gener either mathi mathj particl might shift neighbor cell get closest interact shift mathdelta_ij howev minimum imag convent differ shift particl central cell typic shortrang biomolecular interact typic differ shift involv particl mention interact present one shift gromac nonbond interact use split neighborlist mathi particl multipl separ list list constant shift mathdelta_i mathi partlcl repres sum shift use index math constraint particl interact contribut one term sum shift longer depend mathj particl sum contain complex depend math mean sum trivial reduc sum mathi andor mathj simplifi sum replac sum mathji doubl sum particl rememb mathi neq j divid start definit virial get math beginalign xi fracsum_i jnmathbf rn_ij otim mathbf f_ij nonumb fracsum_i jnleft mathbf r_i delta_ij mathbf r_j right otim mathbf f_ij nonumb fracsum_insum_jnleft mathbf r_i delta_ij mathbf r_j right otim mathbf f_ij nonumb fracsum_insum_ssum_jnleft mathbf r_i delta_i mathbf r_j right otim mathbf f_ij nonumb fracsum_insum_ssum_jnleft left mathbf r_i delta_i right otim mathbf f_ij mathbf r_j otim mathbf f_ij right nonumb fracsum_insum_ssum_jn left mathbf r_i delta_i right otim mathbf f_ij fracsum_insum_ssum_jn mathbf r_j otim mathbf f_ij nonumb fracsum_insum_ssum_jn left mathbf r_i delta_i right otim mathbf f_ij fracsum_insum_jn mathbf r_j otim mathbf f_ij nonumb fracsum_ssum_inleft mathbf r_i delta_i right otim sum_jn mathbf f_ij fracsum_jn mathbf r_j otim sum_in mathbf f_ij nonumb fracsum_ssum_inleft mathbf r_i delta_i right otim sum_jn mathbf f_ij fracsum_jn mathbf r_j otim sum_in mathbf f_ji nonumb fracsum_ssum_inleft mathbf r_i delta_i right otim mathbf f_i fracsum_jnmathbf r_j otim mathbf f_j nonumb fracleftsum_inmathbf r_i otim mathbf f_i sum_jnmathbf r_j otim mathbf f_j right fracsum_ssum_in delta_i otim mathbf f_i nonumb fracsum_inmathbf r_i otim mathbf f_i fracsum_ssum_indelta_i otim mathbf f_i nonumb fracsum_inmathbf r_i otim mathbf f_i fracsum_sdelta_ otim mathbf f_ nonumb xi_ xi_endalign label eqnviriallong secondlast stage use properti shift vector depend coordin particl mathi possibl sum forc correspond shift vector nonbond kernel use sum differ shift vector outsid kernel also use math beginalign mathbff_isum_jnmathbff_ij mathbff_jsum_inmathbff_jiendalign label eqnvirialtotalforc total forc mathi respect mathj use newton third law math mathbff_ijmathbff_ji label eqnnewtonsthird must implement doubl term contain shift mathdelta_i similarli place sum shiftdepend forc shift come total forc per interact particl separ total virial mathxi compon mathxi_ singl sum particl second compon mathxi_ describ influenc particl shift sum differ shift vector intramolecular shift molshift bond forc shake possibl make molshift list period store simpl array mshift atom index shiftvec array store algorithm gener list deriv graph theori consid particl molecul bead graph bond edg repres bond atom bidirect graph make atom white make one white atom black atom mathi put central box make neighbor mathi current white gray pick one gray atom atom mathj give correct period respect black neighbor make black make neighbor mathj current white gray gray atom remain go white atom remain go use algorithm optim bond forc calcul well shake calcul virial bond forc singl sum method find represent bond bidirect graph virial coval bond sinc coval bond forc give contribut virial math beginalign b mathbfr_ijn v_b frac k_bbb_ mathbff_i nabla v_b k_bbb_fracmathbfr_ijnb mathbff_j mathbff_iendalign label eqncovbondviri virial contribut bond math beginalign xi_b fracmathbfr_inotimesmathbff_imathbfr_jotimesmathbff_j fracmathbfr_ijnotimesmathbff_iendalign label eqncovbondvirialcontri virial shake import contribut virial come shake satisfi constraint forc g exert particl shaken forc come algorithm standard shake calcul afterward use leapfrog math beginalign deltamathbfr_imathbfr_itdelta mathbfr_itbf v_itfracdelta tdelta tfracmathbff_im_idelta bf g_ifracm_ideltamathbfr_idelta tiendalign label eqnshakeviri help us gener case period need like rigid water use otherwis must add virial calcul inner loop shake applic virial calcul singl sum way math xifracsum_in_cmathbfr_iotimesmathbff_i label eqnshakevirialsinglesum mathn_c number constrain atom optim describ algorithm optim use gromac apart parallel _waterloop inner loop water gromac use special inner loop calcul nonbond interact water molecul atom yet anoth set loop interact pair water molecul highli optim loop two type water model three site model similar spc ref refberendsen ie three atom molecul whole molecul singl charg group first atom lennardjon sec reflj coulomb sec refcoul interact atom two three coulomb interact equal charg loop also work spce ref refberendsen tipp ref refjorgensen water model four site water model similar tipp ref refjorgensen four atom molecul whole molecul singl charg group first atom lennardjon sec reflj interact atom two three coulomb sec refcoul interact equal charg atom four coulomb interact benefit implement floatingpoint oper singl loop impli compil schedul code better howev turn even advanc compil problem schedul impli manual tweak necessari get optimum perform may includ commonsubexpress elimin move code around raw latex clearpag note deriv altern notat mathxi_mathrmalt v_xi p_xiq use calcul lennardjon coulomb forc float point oper _algorithm algorithm chapter first give describ gener concept use gromac period boundari condit sec refpbc group concept sec refgroupconcept md algorithm describ sec refmd first global form algorithm given refin subsequ subsect simpl em energi minim algorithm describ sec refem algorithm special purpos dynam describ issu gener interest case system must defin consist molecul molecul consist particl defin interact function detail descript topolog molecul forc field calcul forc given chapter refff present chapter describ aspect algorithm pair list gener updat veloc posit coupl extern temperatur pressur conserv constraint analysi data gener md simul treat chapter refanalysi toctre maxdepth algorithmsperiodicboundarycondit algorithmsgroupconcept algorithmsmoleculardynam algorithmsshellmoleculardynam algorithmsconstraintalgorithm algorithmssimulatedann algorithmsstochasticdynam algorithmsbrowniandynam algorithmsenergyminim algorithmsnormalmodeanalysi algorithmsfreeenergycalcul algorithmsreplicaexchang algorithmsessentialdynam algorithmsexpandedensembl algorithmsparallelizationdomaindecomp _gmxreferencemanualrst refer manual highlight bash todo need care check didnt mess anyth bad ifconfig gmx_image_convert possibl part document cover implement detail gromac quick simul setup short explan pleas refer refus guid user guid help instal gromac found refinstal guid instal guid want help develop gromac welcom read refdevelop guid dev guid continu right away code gromac toctre maxdepth prefac introduct definit algorithm function topolog fileformat special runparamet analysi detail averag refer ifconfig gmx_image_convert imposs manual could properli build could convert imag proper display without imagemagick rest document still part miss quick simul setup short explan pleas refer refus guid user guid help instal gromac found refinstal guid instal guid want help develop gromac welcom read refdevelop guid dev guid continu right away code gromac toctre maxdepth prefac introduct definit topolog fileformat runparamet detail averag refer file format todo futur patch updat accuraci organ better improv format summari file format paramet file refmdp run paramet input refgmx grompp refgmx converttpr refmp input refgmx xpmp _gmxstructurefil structur file refgro gromac format refg gromo format refpdb brookhaven protein databank format structuremassdb reftpr refgro refg refpdb structur mass input analysi tool gro pdb use approxim mass read mass databas topolog file reftop system topolog ascii refitp includ topolog ascii refrtp residu topolog ascii refndx index file ascii refnt atom name definit ascii refatp atom type librari ascii refrb residu build block map ascii refarn atom renam databas ascii refhdb hydrogen atom databas ascii refvsd virtual site databas ascii reftdb termini databas ascii run input file reftpr system topolog paramet coordin veloc binari portabl trajectori file reftng kind data compress portabl precis reftrr x v f binari full precis portabl refxtc x compress portabl precis refgro x v ascii precis refg x ascii fix high precis refpdb x ascii reduc precis format fullprecis data reftng reftrr gener trajectori format reftng refxtc reftrr refgro refg refpdb energi file refen energi temperatur pressur box size densiti virial binari refedr energi temperatur pressur box size densiti virial binari portabl gener energi format refedr refen file refdat gener prefer input refedi essenti dynam constraint input refgmx mdrun refep encapsul postscript reflog log file refmap colormap input refgmx do_dssp refmtx binari matrix data refout gener prefer output reftex latex input refxpm ascii matrix data use refgmx xpmp convert refep refxvg xvgr input file format detail _atp atp atp file contain gener inform atom type like atom number mass atom mass unit _arn arn arn file allow renam atom forc field name name defin iupacpdb allow easier visual identif _cpt cpt cpt file extens stand portabl checkpoint file complet state simul store checkpoint file includ extend thermostatbarostat variabl random number state nmr time averag data domain decomposit also decomposit setup inform store see also refgmx mdrun _dat dat file dat file extens contain gener input output possibl categor data file format gromac gener file format call dat format given _dlg dlg dlg file format use input refgmx view trajectori viewer file meant alter end user sampl grid group bond option radiobutton thin bond fat bond fat bond sphere bond ok f help bond group option checkbox show hydrogen fals help opt checkbox draw plu atom true help opt checkbox show box true help opt checkbox remov pbc fals help opt checkbox depth cue true help opt edittext skip frame help opt simpl defbutton ok ok ok ok help bond _edi edi file edi file extens contain inform refgmx mdrun run molecular dynam essenti dynam constraint use possibl gener option provid httpswiftcmbirunlwhatif_ program wedsam essdyn seem vanish whatif web file gener program ttwedsamtt use output program ttessdyntt menu hrefhttpwwwsanderemblheidelbergdewhatifwhat ifa program _edr edr edr file extens stand portabl energi file energi store use xdr protocol see also refgmx energi _ene ene ene file extens stand binari energi file hold energi gener refgmx mdrun file transform portabl energi file portabl across hardwar platform refedr file use program refgmx eneconv see also refgmx energi _ep ep ep file format special gromac format variant standard postscripttm sampl ep file gener refgmx xpmp program includ show secondari structur peptid function time imag plotsplotj alt hallo _g g file g extens gromo initialfin configur file coordin trajectori file combin file fix format float written file get huge gromac support follow data block given order header block titl mandatori frame block timestep option positionpositionr mandatori velocityvelocityr option box option see gromo manual complet descript block note gromac program read compress gzip file _gro gro file gro file extens contain molecular structur gromo format gro file use trajectori simpli concaten file attempt made read time valu titl string frame preced sampl sampl piec includ md water water ow water hw water hw water ow water hw water hw line contain follow inform top bottom titl string free format string option time ps number atom free format integ one line atom fix format see box vector free format space separ real valu vx vy vz vy vz vx vz vx vy last valu may omit set zero gromac support box vyvzvz format fix ie column fix posit option yet trjconv write gro file number decim place format n posit n decim place n veloc stead veloc upon read precis infer distanc decim point n column contain follow inform left right residu number posit integ residu name charact atom name charact atom number posit integ posit nm x z column posit decim place veloc nmp km x z column posit decim place note separ molecul ion eg water cl regard residu want write file program without use gromac librari use follow format c format dssdffffff fortran format iaiff pascal format left exercis user note format write exampl field may written without space therefor read format statement c _hdb hdb hdb file extens stand hydrogen databas file need refgmx pdbgmx build hydrogen atom either origin miss remov ignh _itp itp itp file extens stand includ topolog file includ topolog file reftop extens _log log logfil gener gromac program usual humanread format use logfil _mp mp mp file format contain input option refgmx xpmp program option easi comprehend look posscripttm output refgmx xpmp command line option xpmp overrid paramet file blackwhit obsolet titlefont timesroman postscript font titlefonts font size pt legend ye show legend legendfont timesroman postscript font legendlabel use none xpm legendlabel use merg two xpm legendfonts font size pt xbox xsize matrix element ybox ysize matrix element matrixspac space matric xoffset matrix bound box yoffset matrix bound box xmajor major tick x axi everi frame xminor id minor tick xfirstmajor first frame major tick xmajorat major tick first frame xmajorticklen xmajorticklength xminorticklen xminorticklength xlabel use none xpm xfontsiz font size pt xfont timesroman postscript font xtickfonts font size pt xtickfont helvetica postscript font ymajor yminor yfirstmajor ymajorat ymajorticklen yminorticklen ylabel yfontsiz yfont timesroman ytickfonts ytickfont helvetica _map map file map matrix data rgb valu use refgmx do_dssp program format file follow first line number element colormap line first charact code secondari structur type come string use legend plot r red g green b blue valu case color order appear white red black cyan yellow blue magenta orang coil e bsheet b bbridg bend turn h ahelix g helix helix _mdp mdp see user guid detail descript option sampl mdp file order item import enter thing twice last use refgmx grompp give note overrid valu dash underscor left hand side ignor valu option valu nanosecond md run protein box water note paramet chosen eg shortrang cutoff depend forc field use integr md dt nstep nstlog nstenergi nstxoutcompress continu ye constraint allbond constraintalgorithm linc cutoffschem verlet coulombtyp pme rcoulomb vdwtype cutoff rvdw dispcorr enerpr tcoupl vrescal tcgrp protein sol taut reft pcoupl parrinellorahman taup compress e refp input refgmx grompp produc comment file default name mdoutmdp file contain option well option explicitli set show default valu _mtx mtx file mtx file extens contain matrix file format ident reftrr format current file format use hessian matric produc refgmx mdrun read refgmx nmeig _ndx ndx gromac index file usual call indexndx contain user defin set atom file read analysi program graphic program refgmx view preprocessor refgmx grompp program creat default index group index file suppli need make index file need special group first group name written squar bracket follow atom number may spread mani line like atom number start exampl file oxygen hydrogen two group total nine atom first group oxygen element second group hydrogen element index file gener tool avail refgmx make_ndx _nt nt gromac file use perform primit translat atom name found structur file correspond atom type mostli use use util refgmx xtop user awar knowledg file extrem limit exampl file sharetopgromosaffatomnametyp h h oa c h c ch c c ch c c c short descript file format follow column element symbol atomfirst charact atom name column atom type assign column charg assign column mass atom column number n atom atom bond number field follow relat number atom element symbol refer distanc bond length column onward element symbol refer bond length n connect column atom assign paramet column refer bond length toler valu specifi file bond outsid toler recogn connect atom assign paramet _out file file extens contain gener output possibl categor data file format gromac gener file format call format given _pdb pdb file refpdb extens molecular structur file protein databank file format protein databank file format describ posit atom molecular structur coordin read atom hetatm record file end endmdl record encount gromac program read write simul box cryst entri pdb format also use trajectori format sever structur separ endmdl read written one file exampl pdb file look like atom h ly atom h ly atom n ly atom h ly _rtp rtp rtp file extens stand residu topolog file need refgmx pdbgmx make gromac topolog protein contain refpdb file file contain default interact type bond interact residu entri consist atom option bond angl dihedr improp paramet ad bond angl dihedr improp paramet overrid standard paramet refitp file use special case instead paramet string ad bond interact string copi reftop file use gromo forcefield refgmx pdbgmx automat gener angl mean angl field use overrid refitp paramet refgmx pdbgmx automat gener one proper dihedr everi rotat bond prefer heavi atom dihedr field use dihedr gener bond correspond specifi dihedr possibl put one dihedr rotat bond refgmx pdbgmx set number exclus mean interact atom connect bond exclud pair interact gener pair atom separ bond except pair hydrogen interact need exclud pair interact gener exclus field ad follow pair atom name separ line nonbond pair interact atom exclud sampl includ bondedtyp mandatori bond angl dihedr improp mandatori gli mandatori atom mandatori name type charg chargegroup n n h h ca ch c c bond option atom atom b kb n h n ca ca c c c n exclus option atom atom angl option atom atom atom th cth dihedr option atom atom atom atom phi cp mult improp option atom atom atom atom q cq n c ca h c ca n zn atom zn zn _rb rb rb file translat residu name residu differ name differ forc field differ name depend proton state _tdb tdb tdb file contain inform amino acid termini place end polypeptid chain _tex tex use latex document process although input user friendli advantag word processor latex know lot format probabl much input clear alway know make anyth letter thesi much _tng tng file tng file extens contain kind data relat trajectori simul exampl might contain coordin veloc forc andor energi variou refmdp file option control written refgmx mdrun whether data written compress lossi compress file portabl binari format read refgmx dump parsedliter refgmx dump f trajtng your fast reader gmx dump f trajtng less also get quick look content file number frame etc use parsedliter refgmx check f trajtng _top top top file extens stand topolog ascii file read refgmx grompp process creat binari topolog reftpr file sampl file includ exampl topolog file default nbfunc combrul genpair fudgelj fudgeqq forc field file includ includ rtcitp moleculetyp name nrexcl urea atom nr type resnr residu atom cgnr charg c urea c urea nt urea n h urea h h urea h nt urea n h urea h h urea h bond ai aj funct c c e e e e e e e e e e e e e e pair ai aj funct c c e e e e e e e e e e e e e e e e angl ai aj ak funct c c e e e e e e e e e e e e e e e e e e dihedr ai aj ak al funct c c c e e e e e e e e e e e e e e e e e e e e e e e e dihedr ai aj ak al funct c c e e e e e e includ spc water topolog includ spcitp system urea water molecul urea sol _tpr tpr tpr file extens stand portabl binari run input file file contain start structur simul molecular topolog simul paramet file binari format read normal editor read portabl binari run input file type parsedliter refgmx dump topoltpr your fast reader gmx dump topoltpr less also compar two tpr file use parsedliter refgmx check top top less _trr trr file trr file extens contain trajectori simul file coordin veloc forc energi print told gromac mdp file file portabl binari format read refgmx dump gmx dump f trajtrr your fast reader gmx dump f trajtrr less also get quick look content file number frame etc use parsedliter refgmx check f trajtrr _vsd vsd vsd file contain inform place virtual site number differ molecul forc field _xdr xdr gromac use xdr file format store thing like coordin file intern _xpm xpm gromac xpm file format compat xpixmap format use store matrix data thu gromac xpm file view directli program like xv altern import gimp scale dpi use strong antialias font graphic first matrix data line xpm file correspond last matrix row addit xpixmap format gromac xpm file may contain extra field inform field use convert xpm file ep refgmx xpmp option extra field gv_xpm declar titl legend xlabel ylabel type follow string legend field determin legend titl type field must follow continu discret determin type legend drawn ep file default type continu xpm colormap entri may follow string label color colormap matrix data field xaxi andor yaxi may present follow tickmark axi exampl gromac xpm file contain extra field ccomment delimit colon extra field option xpm matrix gener g_rm titl backbon rmsd matrix legend rmsd nm xlabel time ps ylabel time ps type continu static char gv_xpm c ffffff b c cccccc c c c e c f c xaxi yaxi feddddcccccba fedddccccbbab fedddccccbabc fddddccccabbc eddccccbacccc edccccbabcccc edcccbabccccc edccbabcccccd edccabcccdddd eccacccccdddd ecacccccddddd daccddddddee adeeeeeeeffff _xtc xtc xtc format portabl format trajectori use xdr routin write read data creat unix nf system trajectori written use reduc precis algorithm work follow way coordin nm multipli scale factor typic coordin pm round integ valu sever trick perform instanc make use fact atom close sequenc usual close space eg water molecul end xdr librari extend special routin write float coordin routin origin written fran van hoesel part europort project updat version obtain link httpsgithubcompappulabxdrf_ data store use call xdr routin int magic magic number current file version valu int natom number atom trajectori int step simul step float time simul time float box comput box store set three basi vector allow triclin pbc rectangular box box edg store diagon matrix dfcoord xnatom coordin store reduc precis pleas note number atom smaller reduc precis use use xtc c program possibl write analysi tool take advantag compress xtc format file see templatecpp file sharegromacstempl directori instal exampl httpsmanualgromacsorgcurrentdoxygenhtmlfullpage_analysistemplatexhtml document read write xtc file follow routin avail via xtcioh function return success otherwis struct t_fileio open_xtcconst char filenam const char mode open file xdr io void close_xtcstruct t_fileio fio close file xdr io int read_first_xtcstruct t_fileio fio int natom int_t step real time matrix box rvec x real prec gmx_bool bok open xtc file read xtc file first time alloc memori x int read_next_xtcstruct t_fileio fio int natom int_t step real time matrix box rvec x real prec gmx_bool bok read subsequ frame int write_xtcstruct t_fileio fio int natom int_t step real time const rvec box const rvec x real prec write frame xtc file use librari function includ gromacsfileioxtcioh file link lgromac _xvg xvg almost output gromac analysi tool readi input grace formerli known xmgr use grace flexibl also free softwar produc postscripttm output suitabl inclus eg latex document also word processor sampl grace session gromac data shown imag plotsxvgr alt sampl xvg graphic produc use gromac tool raw latex clearpag introduct _compchem comput chemistri molecular model gromac engin perform molecular dynam simul energi minim two mani techniqu belong realm comput chemistri molecular model comput chemistri name indic use comput techniqu chemistri rang quantum mechan molecul dynam larg complex molecular aggreg molecular model indic gener process describ complex chemic system term realist atom model goal understand predict macroscop properti base detail knowledg atom scale often molecular model use design new materi accur predict physic properti realist system requir macroscop physic properti distinguish static equilibrium properti bind constant inhibitor enzym averag potenti energi system radial distribut function liquid dynam nonequilibrium properti viscos liquid diffus process membran dynam phase chang reaction kinet dynam defect crystal choic techniqu depend question ask feasibl method yield reliabl result present state art ideal relativist timedepend schrdinger equat describ properti molecular system high accuraci anyth complex equilibrium state atom handl ab initio level thu approxim necessari higher complex system longer time span process interest sever requir approxim certain point reach much earlier one would wish ab initio approach must augment replac empir parameter model use simul base physic principl atom interact still fail due complex system molecular model base entir similar analysi known structur chemic data qsar method quantit structureact relat mani homologybas protein structur predict belong latter categori macroscop properti alway ensembl averag repres statist ensembl either equilibrium nonequilibrium molecular system molecular model two import consequ knowledg singl structur even structur global energi minimum suffici necessari gener repres ensembl given temperatur order comput macroscop properti enough comput thermodynam equilibrium properti base free energi phase equilibria bind constant solubl rel stabil molecular conform etc comput free energi thermodynam potenti requir special extens molecular simul techniqu molecular simul principl provid atom detail structur motion detail often relev macroscop properti interest open way simplifi descript interact averag irrelev detail scienc statist mechan provid theoret framework simplif hierarchi method rang consid group atom one unit describ motion reduc number collect coordin averag solvent molecul potenti mean forc combin stochast dynam ref refgunsteren mesoscop dynam describ densiti rather atom flux respons thermodynam gradient rather veloc acceler respons forc ref reffraaij gener repres equilibrium ensembl two method avail mont carlo simul molecular dynam simul gener nonequilibrium ensembl analysi dynam event second method appropri mont carlo simul simpl md requir comput forc yield significantli better statist md given amount comput time therefor md univers techniqu start configur far equilibrium forc may excess larg md simul may fail case robust energi minim requir anoth reason perform energi minim remov kinet energi system sever snapshot dynam simul must compar energi minim reduc thermal nois structur potenti energi compar better molecular dynam simul md simul solv newton equat motion system mathn interact atom math m_i fracparti mathbfr_iparti mathbff_i ldot n label eqnnewtonslaw forc neg deriv potenti function mathvmathbfr_ mathbfr_ ldot mathbfr_n math mathbff_i fracparti vpartial mathbfr_i label eqnmdforc equat solv simultan small time step system follow time take care temperatur pressur remain requir valu coordin written output file regular interv coordin function time repres trajectori system initi chang system usual reach equilibrium state averag equilibrium trajectori mani macroscop properti extract output file use point consid limit md simul user awar limit alway perform check known experiment properti assess accuraci simul list approxim simul classic use newton equat motion automat impli use classic mechan describ motion atom right atom normal temperatur except hydrogen atom quit light motion proton sometim essenti quantum mechan charact exampl proton may tunnel potenti barrier cours transfer hydrogen bond process properli treat classic dynam helium liquid low temperatur anoth exampl classic mechan break helium may deepli concern us high frequenc vibrat coval bond make us worri statist mechan classic harmon oscil differ appreci real quantum oscil reson frequenc mathnu approxim exce mathk_bth room temperatur wavenumb mathsigma lambda nuc mathh nu k_bt approxim cm math thu frequenc higher say cm math may misbehav classic simul mean practic bond bondangl vibrat suspect even hydrogenbond motion translat librat hbond vibrat beyond classic limit see numreft tabvibr hcx replac h math_ cx oho replac oh mathcdot incm replac mathmathrmcm _tabvibr tabl typic vibrat frequenc wavenumb molecul hydrogenbond liquid compar mathkth mathrmcm k width auto align center type wavenumb type bond vibrat incm ch oh nh stretch cc co stretch hoh bend cc stretch hcx sciss rock ccc bend oho librat oho stretch well apart real quantumdynam simul one two thing perform md simul use harmon oscil bond make correct total intern energi mathu e_kin e_pot specif heat mathc_v entropi math free energi matha mathg calcul correct energi specif heat onedimension oscil frequenc mathnu ref refmcquarri math uqm ucl kt left fracx fracxex right label eqnmdqmcorr math c_vqm c_vcl k left fracxexex right label eqnmdqmcorr mathxhnu kt classic oscil absorb much energi mathkt highfrequ quantum oscil ground state zeropoint energi level mathfrac hnu b treat bond bond angl constraint equat motion rational behind quantum oscil ground state resembl constrain bond close classic oscil good practic reason choic algorithm use larger time step highest frequenc remov practic time step made four time larg bond constrain oscil ref refgunsteren gromac option bond bond angl flexibl latter rather essenti allow realist motion coverag configur space ref refgunsteren electron ground state md use conserv forc field function posit atom mean electron motion consid electron suppos adjust dynam instantli atom posit chang bornoppenheim approxim remain ground state realli right almost alway cours electron transfer process electron excit state treat neither chemic reaction treat properli reason shi away reaction time forc field approxim forc field provid forc realli part simul method paramet modifi user need aris knowledg improv form forc use particular program subject limit forc field incorpor gromac describ chapter present version forc field pairaddit apart longrang coulomb forc incorpor polariz contain finetun bond interact urg inclus limit list rest quit use fairli reliabl biologicallyrelev macromolecul aqueou solut forc field pairaddit mean nonbond forc result sum nonbond pair interact non pairaddit interact import exampl interact atom polariz repres effect pair potenti averag non pairaddit contribut incorpor also mean pair interact pure ie valid isol pair situat differ appreci test system model parameter fact effect pair potenti bad practic omiss polariz also mean electron atom provid dielectr constant exampl real liquid alkan dielectr constant slightli reduc longrang electrostat interact partial charg thu simul exagger longrang coulomb term luckili next item compens effect bit longrang interact cut version gromac alway use cutoff radiu lennardjon interact sometim coulomb interact well minimumimag convent use gromac requir one imag particl period boundari condit consid pair interact cutoff radiu exceed half box size still pretti big larg system troubl expect system contain charg particl truli bad thing happen like accumul charg cutoff boundari wrong energi system consid use one implement longrang electrostat algorithm particlemesh ewald ref refdarden ref refessmann boundari condit unnatur sinc system size small even particl small cluster particl lot unwant boundari environ vacuum must avoid condit wish simul bulk system use period boundari condit avoid real phase boundari sinc liquid crystal someth unnatur remain item mention last least evil larg system error small small system lot intern spatial correl period boundari may enhanc intern correl case bewar test influenc system size especi import use lattic sum longrang electrostat sinc known sometim introduc extra order energi minim search method mention sec refcompchem mani case energi minim requir gromac provid number method local energi minim detail sec refem potenti energi function macromolecular system complex landscap hypersurfac larg number dimens one deepest point global minimum larg number local minima deriv potenti energi function respect coordin zero second deriv nonneg matrix second deriv call hessian matrix nonneg eigenvalu collect coordin correspond translat rotat isol molecul zero eigenvalu local minima saddl point hessian matrix one neg eigenvalu point mountain pass system migrat one local minimum anoth knowledg local minima includ global one saddl point would enabl us describ relev structur conform free energi well dynam structur transit unfortun dimension configur space number local minima high imposs sampl space suffici number point obtain complet survey particular minim method exist guarante determin global minimum practic amount time impract method exist much faster other ref refgeman howev given start configur possibl find nearest local minimum nearest context alway impli nearest geometr sens ie least sum squar coordin differ mean minimum reach systemat move steepest local gradient find nearest local minimum gromac sorri want find minima hope discov global minimum process best advic experi temperaturecoupl md run system high temperatur quench slowli requir temperatur repeatedli someth melt glass transit temperatur exist wise stay time slightli temperatur cool slowli accord clever scheme process call simul anneal sinc physic truth requir use imagin speed process one trick often work make hydrogen atom heavier mass although slow otherwis rapid motion hydrogen atom hardli influenc slower motion system enabl increas time step factor also modifi potenti energi function search procedur eg remov barrier remov dihedr angl function replac repuls potenti softcor potenti ref refnilg alway take care restor correct function slowli best search method allow rather drastic structur chang allow excurs fourdimension space ref refschaik requir extra program beyond standard capabl gromac three possibl energi minim method requir function evalu exampl simplex method variant step made basi result previou evalu deriv inform avail method inferior use inform use deriv inform sinc partial deriv potenti energi respect coordin known md program equal minu forc class method suitabl modif md program use second deriv inform well method superior converg properti near minimum quadrat potenti function minim one step problem mathn particl mathntim n matrix must comput store invert apart extra program obtain second deriv system interest beyond avail capac intermedi method build hessian matrix fli also suffer excess storag requir gromac shi away class method steepest descent method avail gromac second class simpli take step direct neg gradient henc direct forc without consider histori built previou step step size adjust search fast motion alway downhil simpl sturdi somewhat stupid method converg quit slow especi vicin local minimum fasterconverg conjug gradient method see eg ref refzimmerman use gradient inform previou step gener steepest descent bring close nearest local minimum quickli conjug gradient bring close local minimum perform wors far away minimum gromac also support lbfg minim mostli compar conjug gradient method case converg faster raw latex clearpag _analysi analysi chapter differ way analyz trajectori describ name correspond analysi program given specif inform output program found tool document refher gmxcmdline output file often produc finish gracexmgr graph first sec refusinggroup group concept analysi explain refselect explain newer concept dynam select current support tool differ analysi tool present toctre maxdepth analysisusinggroup analysislookingattrajectori analysisgeneralproperti analysisradialdistributionfunct analysiscorrelationfunct analysiscurvefit analysismeansquaredisplac analysisbondangledihedr analysisradiusofgyr analysisrmsd analysiscovarianceanalysi analysisdihedralpca analysishydrogenbond analysisproteinrel analysisinterfacerel topolog gromac must know atom combin atom variou contribut potenti function see chapter refff must act must also know paramet must appli variou function describ topolog file reftop list constant attribut atom mani atom type element atom type present biolog system parameter forc field plu metal ion silicon bond special interact determin fix list includ topolog file certain nonbond interact must exclud first second neighbor alreadi treat bond interact addit dynam attribut atom posit veloc forc strictli belong molecular topolog store coordin file refgro posit veloc trajectori file reftrr posit veloc forc chapter describ setup topolog file reftop file databas file paramet stand howwher chang need first file format explain section reffffil describ organ file forc field note construct topolog encourag upload topolog archiv webpage_ imagin thank youd topolog avail start goe new forc field modifi version standard forc field contribut forc field archiv _homepag webpage_ toctre maxdepth topologiesparticletyp topologiesparameterfil topologiesmoleculedefinit topologiesconstraintalgorithmsect topologiespdbgmxinputfil topologiestopologyfileformat topologiesforcefieldorgan averag fluctuat formula averag note section taken ref ref refgunsterena analyz md trajectori averag mathleftxright fluctuat math leftdelta xrightfrac leftxleftxrightrightfrac label eqnvar quantiti mathx comput varianc mathsigma_x seri n math_x valu mathx_i comput math sigma_x sum_in_x x_i fracn_xleftsum_in_xx_iright label eqnvar unfortun formula numer accur especi mathsigma_xfrac small compar valu mathx_i follow equival express numer accur math sigma_x sum_in_x x_i leftxright label eqnvarequival math leftxright fracn_x sum_in_x x_i label eqnvar use eqeqn eqnvar eq eqnvar one go seri mathx_i valu twice determin mathleftxright comput mathsigma_x wherea eqeqn eqnvar requir one sequenti scan seri mathx_i howev one may cast eqeqn eqnvar anoth form contain partial sum allow sequenti updat algorithm defin partial sum math x_nm sum_inm x_i label eqnpartialsum partial varianc math sigma_nm sum_inm leftx_i fracx_nmmnright label eqnsigma shown math x_nmk x_nm x_mmk label eqnxparti math beginalign sigma_nmk sigma_nm sigma_mmk leftfrac x_nmmn fracx_nmkmknright nonumb fracmnmknk endalign label eqnvarparti mathn one find math sigma_mk sigma_m sigma_mmk leftfracx_mm fracx_mkmkright fracmmkk label eqnsig mathn mathk eqeqn eqnvarparti becom math beginalign sigma_m sigma_m leftfracx_mm fracx_mmright mm sigma_m frac x_m x_mmm endalign label eqnsimplevar use relat math x_m x_m x_m label eqnsimplevar use formula eqeqn eqnsimplevar eqeqn eqnsimplevar averag math leftxright fracx_n_xn_x label eqnfinalaverag fluctuat math leftdelta xrightfrac leftfrac sigma_n_xn_xrightfrac label eqnfinalfluctu obtain one sweep data implement gromac instantan energi mathem store refenergi file edr along valu mathsigma_m mathx_m although step count energi fluctuat step count mean equat present one implement give somewhat lengthi deriv section simplifi check code equat later part simul uncommon perform simul first part eg ps taken equilibr howev averag fluctuat print reflog file log comput whole simul equilibr time part simul may case invalid averag fluctuat number domin initi drift toward equilibrium use eqeqn eqnxparti eq eqnvarparti averag standard deviat part trajectori comput math beginalign x_mmk x_mk x_m sigma_mmk sigma_mksigma_m leftfracx_mm fracx_mkmkright fracmmkkendalign label eqnaveragesimpart gener mathp geq mathq geq p math beginalign x_pq x_q x_p sigma_pq sigma_qsigma_p leftfracx_pp fracx_qqright fracpqqpendalign label eqnaveragesimpartgener note implement entir trivial sinc energi store everi time step simul therefor construct mathx_p mathsigma_p inform time mathp use eqeqn eqnsimplevar eq eqnsimplevar math beginalign x_p x_p x_p sigma_p sigma_p frac x_p p x_pppendalign label eqnfinalaveragesimpartnot combin two simul anoth frequent occur problem fluctuat two simul must combin consid follow exampl two simul mathn b mathm step second simul continu first howev second simul start number instead mathn partial sum problem add mathx_na run math x_nmab x_na x_mb label eqnpscomb want comput partial varianc two compon make correct mathdeltasigma math sigma_nmab sigma_na sigma_mb deltasigma label eqnscombcorr defin mathx_iab combin renumb set data point write math sigma_nmab sum_inm leftx_iab fracx_nmabnmright label eqnpscombpoint thu math sum_inm leftx_iab fracx_nmabnmright sum_in leftx_ia fracx_nanright sum_im leftx_ib fracx_mbmright deltasigma label eqnpscombresult math beginalign sum_inm leftx_iab x_iabfracxab_nmnm leftfracxab_nmnmright right nonumb sum_in leftx_ia x_iafracxa_nn leftfracxa_nnright right nonumb sum_im leftx_ib x_ibfracxb_mm leftfracxb_mmright right deltasigmaendalign label eqnpscombresult mathx_i term drop term independ summat counter mathi simplifi math beginalign fracleftxab_nmrightnm fracleftxa_nrightn fracleftxb_mrightm nonumb fracxab_nmnmsum_inmx_iab fracxa_nnsum_inx_ia fracxb_mmsum_imx_ib deltasigmaendalign label eqnpscombsimp recogn three partial sum second line use eqeqn eqnpscomb obtain math deltasigma fracleftmxa_n nxb_mrightnmnm label eqnpscombus check insert mathm get back eqeqn eqnsimplevar sum energi term refgmx energi gmx energi program also sum energi term one eg potenti kinet total partial averag easi math energi compon math math x_mn sum_imn sum_ss x_i sum_ss sum_imn x_i sum_ss x_mn label eqnsumterm fluctuat less trivial consid exampl fluctuat potenti kinet energi cancel nevertheless tri approach write math sigma_mn sum_ss sigma_mn deltasigma label eqnsigmatermsfluct fill eqeqn eqnsigma math sum_imn leftleftsum_ss x_isright fracx_mnsmnright sum_ss sum_imn leftleftx_isright fracx_mnsmnright deltasigma label eqnsigmaterm expand math beginalign sum_imn leftsum_ss x_i leftfracx_mnsmnright leftfracx_mnsmnsum_ss x_i sum_ss sum_sss x_i x_i rightright nonumb sum_ss sum_imn leftx_i fracx_mnsmnx_i leftfracx_mnsmnrightright deltasigma endalign label eqnsimtermsexpand term mathx_i cancel simplifi math beginalign fracleftx_mnsrightmn fracx_mnsmnsum_imnsum_ss x_i sum_imnsum_ss sum_sss x_i x_i nonumb sum_ss sum_imn left fracx_mnsmnx_i leftfracx_mnsmnrightright deltasigma endalign label eqnsigmatermssimplefi math fracleftx_mnsrightmn sum_imnsum_ss sum_sss x_i x_i sum_ss fracleftx_mnsrightmn deltasigma label eqnsigmatermsaltern expand first term use eqeqn eqnsumterm obtain math fracleftsum_ssx_mnsrightmn sum_imnsum_ss sum_sss x_i x_i sum_ss fracleftx_mnsrightmn deltasigma label eqnsigmatermsfirstexpand reformul math leftsum_ss sum_sss x_mn x_mnssum_imnsum_ss sum_sss x_i x_isright deltasigma label eqnsigmatermsreform math leftsum_ss x_mn sum_sss x_mnssum_ss sum_imnx_i sum_sss x_isright deltasigma label eqnsigmatermsreformedaltern give math sum_ss leftx_mn sum_sss sum_imn x_issum_imn x_i sum_sss x_isright deltasigma label eqnsigmatermsfin sinc need data point mathi evalu gener possibl make estim mathsigma_mn use data point avail use left hand side eqeqn eqnsigmaterm averag comput use time step simul accuraci fluctuat thu limit frequenc energi save sinc easili done program xmgr builtin gromac raw latex clearpag bibliographi raw html div idref classrefer raw html div idrefbekkera _refbekkera sup h bekker hjc berendsen ej dijkstra achterop r van drunen van der spoel sijber h keegstra et al gromac parallel comput molecular dynam simul pp physic comput edit ra de groot j nadrchal world scientif singapor raw html div raw html div idrefberendsena _refberendsena sup hjc berendsen van der spoel r van drunen gromac messagepass parallel molecular dynam implement comp phi comm raw html div raw html div idreflindahla _reflindahla sup e lindahl b hess van der spoel gromac packag molecular simul trajectori analysi j mol mod raw html div raw html div idrefspoela _refspoela sup van der spoel e lindahl b hess g groenhof ae mark hjc berendsen gromac fast flexibl free j comp chem raw html div raw html div idrefhessb _refhessb sup b hess c kutzner van der spoel e lindahl gromac algorithm highli effici loadbalanc scalabl molecular simul j chem theori comput raw html div raw html div idrefpronk _refpronk sup pronk pll r schulz p larsson p bjelkmar r apostolov mr shirt jc smith et al gromac highthroughput highli parallel open sourc molecular simul toolkit bioinformat raw html div raw html div idrefpal _refpal sup pll mj abraham c kutzner b hess e lindahl tackl exascal softwar challeng molecular dynam simul gromac pp solv softwar challeng exascal edit markidi e laur springer intern publish switzerland london raw html div raw html div idrefabraham _refabraham sup mj abraham murtola r schulz pll jc smith b hess e lindahl gromac high perform molecular simul multilevel parallel laptop supercomput softwarex raw html div raw html div idrefgunsteren _refgunsteren sup wf van gunsteren hjc berendsen comput simul molecular dynam methodolog applic perspect chemistri angew chem int ed engl raw html div raw html div idreffraaij _reffraaij sup jgem fraaij dynam densiti function theori microphas separ kinet block copolym melt j chem phi raw html div raw html div idrefmcquarri _refmcquarri sup da mcquarri statist mechan harper row new york raw html div raw html div idrefgunsteren _refgunsteren sup wf van gunsteren hjc berendsen algorithm macromolecular dynam constraint dynam mol phi raw html div raw html div idrefgunsteren _refgunsteren sup wf van gunsteren karplu effect constraint dynam macromolecul macromolecul raw html div raw html div idrefdarden _refdarden sup darden york l pedersen particl mesh ewald n mathbullet logn method ewald sum larg system j chem phi raw html div raw html div idrefessmann _refessmann sup u essmann l perera ml berkowitz darden h lee lg pedersen smooth particl mesh ewald potenti j chem phi raw html div raw html div idrefgeman _refgeman sup geman geman stochast relax gibb distribut bayesian restor imag ieee tran patt anal mach int raw html div raw html div idrefnilg _refnilg sup nilg gm clore gronenborn determin threedimension structur protein interproton distanc data dynam simul anneal random array atom feb lett raw html div raw html div idrefschaik _refschaik sup rc van schaik hjc berendsen ae torda wf van gunsteren structur refin method base molecular dynam spatial dimens j mol biol raw html div raw html div idrefzimmerman _refzimmerman sup k zimmerman purpos molecular mechan simul energi minim j comp chem raw html div raw html div idrefadam _refadam sup dj adam em adam gj hill comput simul polar liquid mol phi raw html div raw html div idrefbekk _refbekk sup h bekker ej dijkstra mkr renardu hjc berendsen effici box shape independ nonbond forc virial algorithm molecular dynam mol sim raw html div raw html div idrefhockney _refhockney sup rw hockney sp goel j eastwood quiet high resolut comput model plasma j comp phi raw html div raw html div idrefverlet _refverlet sup l verlet comput experi classic fluid thermodynam properti lennardjon molecul phi rev raw html div raw html div idrefberendsenb _refberendsenb sup hjc berendsen wf van gunsteren practic algorithm dynam simul raw html div raw html div idrefswop _refswop sup wc swope hc andersen ph beren kr wilson computersimul method calcul equilibriumconst format physic cluster molecul applic small water cluster j chem phi raw html div raw html div idrefberendsen _refberendsen sup hjc berendsen jpm postma dinola jr haak molecular dynam coupl extern bath j chem phi raw html div raw html div idrefandersen _refandersen sup hc andersen molecular dynam simul constant pressur andor temperatur j chem phi raw html div raw html div idrefnos _refnos sup nos molecular dynam method simul canon ensembl mol phi raw html div raw html div idrefhoov _refhoov sup wg hoover canon dynam equilibrium phasespac distribut phi rev raw html div raw html div idrefbussia _refbussia sup g bussi donadio parrinello canon sampl veloc rescal j chem phi raw html div raw html div idrefberendsen _refberendsen sup hjc berendsen transport properti comput linear respons weak coupl bath pp comput simul materi scienc edit meyer v pontiki kluwer raw html div raw html div idrefbasconi _refbasconi sup je basconi mr shirt effect temperatur control algorithm transport properti kinet molecular dynam simul j chem theori comput raw html div raw html div idrefcook _refcook sup b cook sj schmidler preserv boltzmann ensembl replicaexchang molecular dynam j chem phi raw html div raw html div idrefmartyna _refmartyna sup gj martyna ml klein tuckerman noshoov chain canon ensembl via continu dynam j chem phi raw html div raw html div idrefmartyna _refmartyna sup gj martyna tuckerman dj tobia ml klein explicit revers integr extend system dynam mol phi raw html div raw html div idrefholian _refholian sup bl holian af voter r ravelo thermostat molecular dynam avoid toda demon hidden noshoov dynam phi rev e raw html div raw html div idrefeastwood _refeastwood sup mp eastwood ka stafford ra lippert m jensen p maragaki c predescu ro dror de shaw equipartit calcul temperatur biomolecular simul j chem theori comput asap doi ct raw html div raw html div idrefparrinello _refparrinello sup parrinello rahman polymorph transit singl crystal new molecular dynam method j appl phi raw html div raw html div idrefnos _refnos sup nos ml klein constant pressur molecular dynam molecular system mol phi raw html div raw html div idrefliu _refliu sup g liu dynam equat period vector period system constant extern stress j phi raw html div raw html div idreftuckerman _reftuckerman sup tuckerman j alejandr r lpezrendn al jochim gj martyna liouvilleoper deriv measurepreserv integr molecular dynam simul isothermalisobar ensembl j phi raw html div raw html div idrefyu _refyu sup tq yu j alejandr r lopezrendon gj martyna tuckerman measurepreserv integr molecular dynam isothermalisobar ensembl deriv liouvil oper chem phi raw html div raw html div idrefdick _refdick sup bg dick aw overhaus theori dielectr constant alkali halid crystal phi rev raw html div raw html div idrefjordan _refjordan sup pc jordan pj van maaren j mavri van der spoel hjc berendsen toward phase transfer potenti function methodolog applic nitrogen j chem phi raw html div raw html div idrefmaarena _refmaarena sup pj van maaren van der spoel molecular dynam simul water novel shellmodel potenti j phi chem b raw html div raw html div idrefryckaert _refryckaert sup jp ryckaert g ciccotti hjc berendsen numer integr cartesian equat motion system constraint molecular dynam nalkan j comp phi raw html div raw html div idrefmiyamoto _refmiyamoto sup miyamoto pa kollman settl analyt version shake rattl algorithm rigid water model j comp chem raw html div raw html div idrefandersena _refandersena sup hc andersen rattl veloc version shake algorithm molecular dynam calcul j comp phi raw html div raw html div idrefhess _refhess sup b hess h bekker hjc berendsen jgem fraaij linc linear constraint solver molecular simul j comp chem raw html div raw html div idrefhessa _refhessa sup b hess plinc parallel linear constraint solver molecular simul j chem theori comput raw html div raw html div idrefgoga _refgoga sup n goga aj rzepiela ah de vri sj marrink hjc berendsen effici algorithm langevin dpd dynam j chem theori comput raw html div raw html div idrefbyrda _refbyrda sup rh byrd p lu j noced limit memori algorithm bound constrain optim siam j scientif statist comput raw html div raw html div idrefzhua _refzhua sup c zhu rh byrd j noced lbfgsb algorithm lbfgsb fortran routin larg scale bound constrain optim acm tran math softw raw html div raw html div idreflevitt _reflevitt sup levitt c sander ps stern normal mode protein nativ bovin pancreat trypsin inhibitor int j quant chem quant biol symp raw html div raw html div idrefgo _refgo sup n g mathbarrm noguti nishikawa dynam small globular protein term lowfrequ vibrat mode proc natl acad sci usa raw html div raw html div idrefbbrooksb _refbbrooksb sup b brook karplu harmon dynam protein normal mode fluctuat bovin pancreat trypsin inhibitor proc natl acad sci usa raw html div raw html div idrefhaywardb _refhaywardb sup hayward n g mathbarrm collect variabl descript nativ protein dynam annu rev phi chem raw html div raw html div idrefbennett _refbennett sup ch bennett effici estim free energi differ mont carlo data j comp phi raw html div raw html div idrefshirt _refshirt sup mr shirt jd chodera statist optim analysi multipl equilibrium simul j chem phi raw html div raw html div idrefhukushimaa _refhukushimaa sup k hukushima k nemoto exchang mont carlo method applic spin glass simul j phi soc jpn raw html div raw html div idrefsugita _refsugita sup sugita okamoto replicaexchang molecular dynam method protein fold chem phi lett raw html div raw html div idrefseiberta _refseiberta sup seibert patriksson b hess van der spoel reproduc polypeptid fold structur predict use molecular dynam simul j mol biol raw html div raw html div idrefokabea _refokabea sup okab kawata okamoto mikami replicaexchang mont carlo method isobaricisotherm ensembl chem phi lett raw html div raw html div idrefchodera _refchodera sup jd chodera mr shirt replica exchang expand ensembl simul gibb sampl simpl improv enhanc mix j chem phi raw html div raw html div idrefdegroota _refdegroota sup bl de groot amadei dmf van aalten hjc berendsen toward exhaust sampl configur space two form peptid hormon guanylin j biomol str dyn raw html div raw html div idrefdegrootb _refdegrootb sup bl de groot amadei rm scheek naj van nuland hjc berendsen extend sampl configur space hpr e coli protein struct funct gen raw html div raw html div idreflangea _reflangea sup oe lang lv schafer h grubmul flood gromac acceler barrier cross molecular dynam j comp chem raw html div raw html div idreflyubartsev _reflyubartsev sup ap lyubartsev aa martsinovski sv shevkunov pn vorontsovvelyaminov new approach mont carlo calcul free energi method expand ensembl j chem phi raw html div raw html div idrefliem _refliem sup sy liem brown jhr clark molecular dynam simul distribut memori machin comput phi commun raw html div raw html div idrefshaw _refshaw sup kj bower ro dror de shaw midpoint method parallel particl simul j chem phi raw html div raw html div idrefspoela _refspoela sup van der spoel pj van maaren origin layer structur artifact simul liquid water j chem theori comput raw html div raw html div idrefohmin _refohmin sup ohmin h tanaka pg wolyn larg local energi fluctuat water ii cooper motion fluctuat j chem phi raw html div raw html div idrefkitchen _refkitchen sup db kitchen f hirata jd westbrook r levi kofk yarmush conserv energi molecular dynam simul water protein protein water j comp chem raw html div raw html div idrefguenot _refguenot sup j guenot pa kollman conform energet effect truncat nonbond interact aqueou protein dynam simul j comp chem raw html div raw html div idrefsteinbach _refsteinbach sup pj steinbach br brook new sphericalcutoff method longrang forc macromolecular simul j comp chem raw html div raw html div idrefgromo _refgromo sup wf van gunsteren sr billet aa eis ph hnenberg p krger ae mark wrp scott ig tironi biomolecular simul gromo manual user guid hochschulverlag ag der eth zrich zrich switzerland raw html div raw html div idrefbiomo _refbiomo sup wf van gunsteren hjc berendsen gromo manual biomo bv nijenborgh ag groningen netherland raw html div raw html div idrefmors _refmors sup pm mors diatom molecul accord wave mechan ii vibrat level phi rev raw html div raw html div idrefberendsen _refberendsen sup hjc berendsen jpm postma wf van gunsteren j herman interact model water relat protein hydrat pp intermolecular forc edit b pullman reidel publish compani dordrecht raw html div raw html div idrefferguson _refferguson sup dm ferguson parametr evalu flexibl water model j comp chem raw html div raw html div idrefwarn _refwarn sup hr warner jr kinet theori rheolog dilut suspens finit extend dumbbel ind eng chem fundam raw html div raw html div idrefmonicagoga _refmonicagoga sup bulacu n goga w zhao g rossi l monticelli x periol tieleman marrink improv angl potenti coarsegrain molecular dynam simul j chem phi raw html div raw html div idrefbbrook _refbbrook sup br brook bruccoleri bd olafson dj state swaminathan karplu charmm program macromolecular energi minim dynam calcul j comp chem raw html div raw html div idreflawrenceb _reflawrenceb sup cp lawrenc jl skinner flexibl tipp model molecular dynam simul liquid water chem phi lett raw html div raw html div idrefjorgensen _refjorgensen sup wl jorgensen ds maxwel j tirador develop test opl allatom forc field conform energet properti organ liquid j chem soc raw html div raw html div idrefrobertsona _refrobertsona sup mj robertson j tirador wl jorgensen improv peptid protein torsion energet oplsaa forc field j chem theori comput raw html div raw html div idrefbulacugiessen _refbulacugiessen sup bulacu e van der giessen effect bend torsion rigid selfdiffus polym melt moleculardynam studi jctc raw html div raw html div idrefscottscherag _refscottscherag sup ra scott h scheraga conform analysi macromolecul j chem phi raw html div raw html div idrefpaulingbond _refpaulingbond sup l paul natur chemic bond cornel univers press ithaca new york raw html div raw html div idreftorda _reftorda sup ae torda rm scheek wf van gunsteren timedepend distanc restraint molecular dynam simul chem phi lett raw html div raw html div idrefhess _refhess sup b hess rm scheek orient restraint molecular dynam simul use time ensembl averag j magn reson raw html div raw html div idreflopesa _reflopesa sup pem lope j huang j shim luo h li b roux j mackerel alexand polariz forc field peptid protein base classic drude oscil j chem theori comput raw html div raw html div idrefhyu _refhyu sup h yu tw whitfield e harder g lamoureux vorobyov vm anisimov ad mackerel jr b roux simul monoval dival ion aqueou solut use drude polariz forc field j chem theori comput raw html div raw html div idrefthol _refthol sup bt thole molecular polariz modifi dipol interact chem phi raw html div raw html div idreflamoureuxa _reflamoureuxa sup g lamoureux b roux model induc polar classic drude oscil theori molecular dynam simul algorithm j chem phi raw html div raw html div idreflamoureuxb _reflamoureuxb sup g lamoureux ad mackerel b roux simpl polariz model water base classic drude oscil j chem phi raw html div raw html div idrefnoskova _refnoskova sup sy noskov g lamoureux b roux molecular dynam studi hydrat ethanolwat mixtur use polariz forc field j phi chem b raw html div raw html div idrefgunsterena _refgunsterena sup wf van gunsteren ae mark valid molecular dynam simul j chem phi raw html div raw html div idrefbeutl _refbeutl sup tc beutler ae mark rc van schaik pr greber wf van gunsteren avoid singular numer instabl free energi calcul base molecular simul chem phi lett raw html div raw html div idrefjorgensen _refjorgensen sup wl jorgensen j tirador opl potenti function protein energi minim crystal cyclic peptid crambin j chem soc raw html div raw html div idrefberendsenb _refberendsenb sup hjc berendsen wf van gunsteren molecular dynam simul techniqu approach pp molecular liquidsdynam interact edit ajb et al reidel dordrecht netherland raw html div raw html div idrefewald _refewald sup pp ewald die berechnung optisch und elektrostatisch gitterpotential ann phi raw html div raw html div idrefhockney _refhockney sup rw hockney jw eastwood comput simul use particl mcgrawhil new york raw html div raw html div idrefballenegg _refballenegg sup v ballenegg jj cerd c holm convert spme pm influenc function error estim j chem theori comput raw html div raw html div idrefallen _refallen sup mp allen dj tildesley comput simul liquid oxford scienc public oxford raw html div raw html div idrefwennberg _refwennberg sup cl wennberg murtola b hess e lindahl lennardjon lattic summat bilay simul critic effect surfac tension lipid properti j chem theori comput raw html div raw html div idrefoostenbrink _refoostenbrink sup c oostenbrink villa ae mark wf van gunsteren biomolecular forc field base free enthalpi hydrat solvat gromo forcefield paramet set journal comput chemistri raw html div raw html div idrefcornel _refcornel sup wd cornel p cieplak ci bayli ir gould kr merz jr dm ferguson dc spellmey fox et al second gener forc field simul protein nucleic acid organ molecul j chem soc raw html div raw html div idrefkollman _refkollman sup pa kollman advanc continu challeng achiev realist predict simul properti organ biolog molecul acc chem re raw html div raw html div idrefwang _refwang sup j wang p cieplak pa kollman well restrain electrostat potenti resp model perform calcul conform energi organ biolog molecul j comp chem raw html div raw html div idrefhornak _refhornak sup v hornak r abel okur b strockbin roitberg c simmerl comparison multipl amber forc field develop improv protein backbon paramet protein struct funct gen raw html div raw html div idreflindorff _reflindorff sup k lindorfflarsen piana k palmo p maragaki jl klepei ro dorr de shaw improv sidechain torsion potenti amber ffsb protein forc field protein struct funct gen raw html div raw html div idrefduan _refduan sup duan c wu chowdhuri mc lee g xiong w zhang r yang p cieplak et al pointcharg forc field molecular mechan simul protein base condensedphas quantum mechan calcul j comp chem raw html div raw html div idrefgarcia _refgarcia sup ae garca ky sanbonmatsu mathalphahel stabil side chain shield backbon hydrogen bond proc natl acad sci usa raw html div raw html div idrefmackerel _refmackerel sup j mackerel feig cl brook iii extend treatment backbon energet protein forc field limit gasphas quantum mechan reproduc protein conform distribut molecular dynam simul j comp chem raw html div raw html div idrefmackerel _refmackerel sup ad mackerel bashford bellott rl dunbrack jd evanseck mj field fischer j gao et al allatom empir potenti molecular model dynam studi protein j phi chem b raw html div raw html div idreffel _reffel sup se feller ad mackerel improv empir potenti energi function molecular simul phospholipid j phi chem b raw html div raw html div idreffolopp _reffolopp sup n folopp ad mackerel allatom empir forc field nucleic acid paramet optim base small molecul condens phase macromolecular target data j comp chem raw html div raw html div idrefmac _refmac sup ad mackerel nk banavali allatom empir forc field nucleic acid ii applic molecular dynam simul dna rna solut j comp chem raw html div raw html div idreflarsson _reflarsson sup p larsson e lindahl highperform parallelgener born implement enabl tabul interact rescal j comp chem raw html div raw html div idrefbjelkmar _refbjelkmar sup p bjelkmar p larsson cuendet b hess e lindahl implement charmm forc field gromac analysi protein stabil effect correct map virtual interact site water model j chem theori comput raw html div raw html div idrefkohlmey _refkohlmey sup kohlmey j vermaa topotool releas charmm export topogromac raw html div raw html div idrefbereau _refbereau sup bereau zj wang deserno solventfre coarsegrain model unbias highresolut proteinlipid interact nd raw html div raw html div idrefwang_jpcb _refwang_jpcb sup zj wang deserno systemat coarsegrain solventfre model quantit phospholipid bilay simul j phi chem b raw html div raw html div idrefjorgensen _refjorgensen sup wl jorgensen j chandrasekhar jd madura rw impey ml klein comparison simpl potenti function simul liquid water j chem phi raw html div raw html div idrefiupac _refiupac sup iupaciub commiss biochem nomenclatur abbrevi symbol descript conform polypeptid chain tent rule biochemistri raw html div raw html div idrefmahoneya _refmahoneya sup mw mahoney wl jorgensen fivesit model liquid water reproduct densiti anomali rigid nonpolariz potenti function j chem phi raw html div raw html div idrefryckaert _refryckaert sup jp ryckaert belleman molecular dynam liquid alkan far disc chem soc raw html div raw html div idrefloof _refloof sup h de loof l nilsson r rigler molecular dynam simul galanin aqueou nonaqu solut j chem soc raw html div raw html div idrefbuurena _refbuurena sup ar van buuren hjc berendsen molecular dynam simul stabil residu alphahelix water trifluoroethanol biopolym raw html div raw html div idrefrmneumanna _refrmneumanna sup rm neumann entrop approach brownian movement j phi raw html div raw html div idrefjarzynskia _refjarzynskia sup c jarzynski nonequilibrium equal free energi differ phi rev lett raw html div raw html div idrefengina _refengina sup ms engin villa b hess drive forc adsorpt amphiphil peptid airwat interfac j phi chem b raw html div raw html div idreflindahlacceler _reflindahlacceler sup v lindahl j lidmar b hess acceler weight histogram method explor free energi landscap journal chemic physic raw html div raw html div idrefwangeffici _refwangeffici sup f wang landau effici multiplerang random walk algorithm calcul densiti state physic review letter raw html div raw html div idrefhuberloc _refhuberloc sup huber ae torda wf van gunsteren local elev method improv search properti molecular dynam simul journal computeraid molecular design raw html div raw html div idreflaioescap _reflaioescap sup laio parrinello escap freeenergi minima proceed nation academi scienc raw html div raw html div idrefbelardinellifast _refbelardinellifast sup r belardinelli v pereyra fast algorithm calcul densiti state physic review e raw html div raw html div idrefbarducciwel _refbarducciwel sup barducci g bussi parrinello welltemp metadynam smoothli converg tunabl freeenergi method physic review letter raw html div raw html div idreflindahlsequ _reflindahlsequ sup v lindahl villa b hess sequenc depend canon base pair open dna doubl helix plo comput biolog e raw html div raw html div idrefsivakthermodynam _refsivakthermodynam sup da sivak ge crook thermodynam metric optim path physic review letter raw html div raw html div idrefkutzn _refkutzn sup c kutzner j czub h grubmller keep flexibl drive macromolecular rotari motion atomist simul gromac j chem theori comput raw html div raw html div idrefcalemana _refcalemana sup c caleman van der spoel picosecond melt ice infrar laser puls simul studi angew chem int ed engl raw html div raw html div idrefkutznerb _refkutznerb sup c kutzner h grubmller bl de groot u zacharia comput electrophysiolog molecular dynam ion channel permeat select atomist detail biophi j raw html div raw html div idreffeenstra _reffeenstra sup ka feenstra b hess hjc berendsen improv effici larg timescal molecular dynam simul hydrogenrich system j comp chem raw html div raw html div idrefhessa _refhessa sup b hess determin shear viscos model liquid molecular dynam j chem phi raw html div raw html div idrefmopac _refmopac sup mj dewar develop statu mindo mndo j mol struct raw html div raw html div idrefgamessuk _refgamessuk sup mf guest rj harrison jh van lenth lch van corler comput chemistri fpsx scientif comput experi singl multiprocessor system theor chim act raw html div raw html div idrefg _refg sup mj frisch gw truck hb schlegel ge scuseria robb jr cheeseman ja montgomeri jr vreven et al gaussian revis c nd raw html div raw html div idrefcara _refcara sup r car parrinello unifi approach molecular dynam densityfunct theori phi rev lett raw html div raw html div idreffielda _reffielda sup field pa bash karplu combin quantum mechan molecular mechan potenti molecular dynam simul j comp chem raw html div raw html div idrefmaserasa _refmaserasa sup f masera k morokuma imomm new ab initio molecular mechan geometri optim scheme equilibrium structur transit state j comp chem raw html div raw html div idrefsvenssona _refsvenssona sup svensson humbel rdj froe matsubara sieber k morokuma oniom multilay integr mo mm method geometri optim singl point energi predict test dielsald reaction ptptbu h oxid addit j phi chem raw html div raw html div idrefyesylevskyy _refyesylevskyy sup yesylevskyy protsqueez simpl effect autom tool set membran protein simul j chem inf model raw html div raw html div idrefwolf _refwolf sup wolf hoefl c apontesantamara h grubmller g groenhof g_memb effici insert membran protein equilibr lipid bilay minim perturb j comp chem raw html div raw html div idrefspoela _refspoela sup van der spoel hjc berendsen molecular dynam simul leuenkephalin water dmso biophi j raw html div raw html div idrefpsmithc _refpsmithc sup pe smith wf van gunsteren viscos spc spce water chem phi lett raw html div raw html div idrefbalasubramanian _refbalasubramanian sup balasubramanian cj mundi ml klein shear viscos polar fluid molecular dynam calcul water j chem phi raw html div raw html div idreflmfit _reflmfit sup j wuttk lmfit raw html div raw html div idrefsteensaethrea _refsteensaethrea sup b steensthr ac hoffmann van der spoel order paramet algorithm approach detect demarc interfac hydratefluid icefluid system j chem theor comput raw html div raw html div idrefpalmera _refpalmera sup bj palmer transversecurr autocorrelationfunct calcul shear viscos molecular liquid phi rev e raw html div raw html div idrefwensinka _refwensinka sup ejw wensink ac hoffmann pj van maaren van der spoel dynam properti wateralcohol mixtur studi comput simul j chem phi raw html div raw html div idrefguob _refguob sup gj guo yg zhang k refson yj zhao viscos stress autocorrel function supercool water molecular dynam studi mol phi raw html div raw html div idreffanourgakisa _reffanourgakisa sup gs fanourgaki js medina r prosmiti determin bulk viscos rigid water model j phi chem raw html div raw html div idrefspoelb _refspoelb sup van der spoel hj vogel hjc berendsen molecular dynam simul ntermin peptid nucleotid bind protein protein struct funct gen raw html div raw html div idrefamadei _refamadei sup amadei abm linssen hjc berendsen essenti dynam protein protein struct funct gen raw html div raw html div idrefhessb _refhessb sup b hess converg sampl protein simul phi rev e raw html div raw html div idrefhess _refhess sup b hess similar princip compon protein dynam random diffus phi rev e raw html div raw html div idrefmua _refmua sup mu ph nguyen g stock energi landscap small peptid revela dihedr angl princip compon analysi protein struct funct gen raw html div raw html div idrefspoelb _refspoelb sup van der spoel pj van maaren p larsson n timneanu thermodynam hydrogen bond hydrophil hydrophob media j phi chem b raw html div raw html div idrefluzarb _refluzarb sup luzar chandler hydrogenbond kinet liquid water natur raw html div raw html div idrefluzara _refluzara sup luzar resolv hydrogen bond dynam conundrum j chem phi raw html div raw html div idrefkabsch _refkabsch sup w kabsch c sander dictionari protein secondari structur pattern recognit hydrogenbond geometr featur biopolym raw html div raw html div idrefbekkerb _refbekkerb sup h bekker hjc berendsen ej dijkstra achterop r v drunen v spoel sijber h keegstra et al gromac method virial calcul use singl sum pp physic comput edit ra de groot j nadrchal world scientif singapor raw html div raw html div idrefberendsen _refberendsen sup hjc berendsen jr grigera tp straatsma miss term effect pair potenti j phi chem raw html div raw html div idrefgunsterena _refgunsterena sup wf van gunsteren hjc berendsen molecular dynam simpl system raw html div raw html div idrefroethlisbergerqmmm _refroethlisbergerqmmm sup laio j vandevondel u rothlisberg hamiltonian electrostat coupl scheme hybrid carparrinello molecular dynam simul raw html div raw html div idrefgroenhofewaldartefact _refgroenhofewaldartefact sup hub j de groot b l grubmller h groenhof g quantifi artifact ewald simul inhomogen system net charg j chem theori comput raw html div raw html div idrefpallpairinteract _refpallpairinteract sup pll hess b flexibl algorithm calcul pair interact simd architectur comput phi commun raw html div raw html div idreforzechowski _reforzechowski sup orzechowski tama f flexibl fit highresolut xray structur cryoelectron microscopi map use bias molecular dynam simul biophys journal raw html div raw html div idrefigaev _refigaev sup igaev kutzner c bock l v vaiana c grubmller h autom cryoem structur refin use correlationdriven molecular dynam elif e raw html div raw html div idrefbernetti _refbernetti sup bernetti bussi g pressur control use stochast cell rescal j chem phi raw html div div idreflidmar _reflidmar sup lidmar j improv effici extend ensembl simul acceler weight histogram method phi rev e raw html div div idreflindahl _reflindahl sup lindahl v lidmar j hess b riemann metric approach optim sampl multidimension freeenergi landscap phi rev e raw html div div idreflundborg _reflundborg sup lundborg lidmar j hess b acceler weight histogram method alchem free energi calcul j chem phi raw html div div idrefcpk _refcpk sup khne iannuzzi del ben hutter j et al cpk electron structur molecular dynam softwar packag quickstep effici accur electron structur calcul j chem phi raw html div div idreflaino _reflaino sup laino moham f laio parrinello effici real space multigrid qmmm electrostat coupl j chem theori comput raw html div raw html div idrefgapsi _refgapsi sup v gapsi seelig bl de groot new softcor potenti function molecular dynam base alchem free energi calcul j chem theor comput raw html div div idrefspoel _refspoel sup van der spoel h henschel p j van maaren ghahremanpour l costa potenti molecular simul compound linear moieti j chem phi raw html div div idreftuckerman _reftuckerman sup tuckerman b j bern g j martyna revers multipl time scale molecular dynam j chem phi raw html div gener properti refgmx energi gmx energi refgmx traj gmx traj analyz energi properti total pressur pressur tensor densiti boxvolum boxsiz use program refgmx energi gmx energi choic made list set energi like potenti kinet total energi individu contribut like lennardjon dihedr energi centerofmass veloc defin math bf v_com sum_in m_i bf v_i label eqncomveloc mathm sum_in m_i total mass system monitor time program refgmx traj gmx traj com ov howev recommend remov centerofmass veloc everi step see chapter refalgorithm dihedr princip compon analysi refgmx angl gmx angl refgmx covar gmx covar refgmx anaeig gmx anaeig princip compon analysi perform dihedr space ref refmua use gromac start defin dihedr angl interest index file either use refgmx mk_angndx gmx mk_angndx otherwis use refgmx angl gmx angl program flag produc new reftrr file contain cosin sine dihedr angl two coordin respect reftrr file seri number correspond co mathphi_ sin mathphi_ co mathphi_ sin mathphi_ co mathphi_n sin mathphi_n array pad zero necessari use reftrr file input refgmx covar gmx covar program perform princip compon analysi usual work need gener refer file reftpr refgro refpdb etc contain number atom new reftrr file mathn dihedr need mathn atom round integ number use nofit option refgmx covar gmx covar sinc coordin dummi refer file correspond way inform reftrr file analysi result done use refgmx anaeig gmx anaeig _msd mean squar displac refgmx msd gmx msd determin self diffus coeffici mathd_a particl type matha one use einstein relat ref refallen math lim_t rightarrow infti langl bf r_it bf r_i rangle_i d_a label eqnmsd mean squar displac mathd_a calcul program refgmx msd gmx msd normal index file contain atom number use msd averag atom molecul consist one atom mathbf r_i taken center mass posit molecul case use index file molecul number result nearli ident averag atom howev refgmx msd gmx msd program also use calcul diffus one two dimens use studi later diffus interfac exampl mean squar displac spc water given numreffig figmsdwat _figmsdwat figur plotsmsdwat width cm mean squar displac spcwater interfacerel item refgmx order gmx order refgmx densiti gmx densiti refgmx potenti gmx potenti refgmx traj gmx traj simul molecul long carbon tail interest calcul averag orient sever flavor order paramet relat program refgmx order gmx order calcul order paramet use equat math s_z fraclangl costheta_z rangl frac label eqnsgr maththeta_z angl mathzaxi simul box molecular axi consider latter defin vector c math_n c math_n paramet maths_x maths_i defin way bracket impli averag time molecul order paramet vari full order along interfac normal math full order perpendicular normal valu zero case isotrop orient program two thing calcul order paramet ch math_ segment separ three axe divid box slice calcul averag valu order paramet per segment one slice first method give idea order molecul head tail second method give idea order function box length electrostat potenti mathpsi across interfac comput trajectori evalu doubl integr charg densiti mathrhoz math psiz psiinfti int_inftyz dz int_inftyz rhozdz epsilon_ label eqnelpotgr posit mathzinfti far enough bulk phase field zero method possibl split total potenti separ contribut lipid water molecul program refgmx potenti gmx potenti divid box slice sum charg atom slice integr charg densiti give electr field turn integr give potenti charg densiti electr field potenti written xvgr input file program refgmx traj gmx traj simpl analysi program print coordin veloc forc select atom also calcul center mass one molecul print coordin center mass three file probabl use analysi coordin select molecul atom handi analysi interfaci system program refgmx densiti gmx densiti calcul mass densiti group give plot densiti box axi use look distribut group atom across interfac raw latex clearpag look trajectori _figngmxdump figur plotsngmxdump width cm window refgmx view gmx view show box water refgmx view gmx view analyz trajectori often inform look trajectori first gromac come simpl trajectori viewer refgmx view gmx view advantag one requir opengl usual isnt present eg supercomput also possibl gener hardcopi encapsul postscript format see numreffig figngmxdump want faster fanci viewer sever program read gromac trajectori format look webpage_ updat link correl function theori correl function theori correl function well establish ref refallen describ implement variou correl function flavor gromac code definit autocorrel function acf mathc_ft properti mathft math c_ft leftlangl fxi fxitrightrangle_xi label eqncorr notat right hand side indic averag mathxi ie time origin also possibl comput crosscorrel function two properti mathft mathgt math c_fgt leftlangl fxi gxitrightrangle_xi label eqncrosscorr howev gromac standard mechan note use xmgr program comput cross correl integr correl function time correl time mathtau_f math tau_f int_infti c_ft rm label eqncorrtim practic correl function calcul base data point discret time interv mathdelta acf md simul math c_fjdelta fracnjsum_inj fidelta fijdelta label eqncorrmd mathn number avail time frame calcul result acf obvious avail time point interv mathdelta sinc mani applic necessari know short time behavior acf eg first ps often mean save data interv much shorter time scale interest anoth implic eqeqn eqncorrmd principl comput point acf accuraci sinc mathn data point mathc_fdelta mathc_fndelta howev decid comput acf length mathmdelta mathm leq n comput point statist accuraci math c_fjdelta fracmsum_inm fidelta tfijdelta label eqncorrstataccuraci cours mathj mathm sometim refer time lag correl function decid intent use avail point short time interv mathj make easier interpret result anoth aspect may neglect comput acf simul usual time origin mathxi eqeqn eqncorr statist independ may introduc bia result test use blockaverag procedur time origin space least length time lag includ eg use mathk time origin space mathmdelta mathkm leq n math c_fjdelta fracksum_ik fimdelta tfimjdelta label eqncorrblockaverag howev one need long simul get good accuraci way mani fewer point contribut acf use fft comput acf comput cost calcul acf accord eqeqn eqncorrmd proport mathn consider howev improv use fast fourier transform convolut ref refallen special form acf import varieti acf eg acf vector mathmathbfp math c_mathbfpt int_infti p_ncosangleleftmathbfpximathbfpxitright rm xi label eqncorrleg mathp_nx mathnth order legendr polynomi _ correl time actual obtain experiment use eg nmr relax experi gromac comput correl use mathst mathnd order legendr polynomi eqeqn eqncorrleg also use rotat autocorrel refgmx rotacf dipol autocorrel refgmx dipol gmx dipol order studi torsion angl dynam defin dihedr autocorrel function ref refspoela math ct leftlangl costhetatauthetatautrightrangle_tau label eqncoenk note product two function gener use correl function may rewritten sum two product math ct leftlanglecosthetataucosthetatautsinthetatausinthetatautrightrangle_tau label eqncot applic program refgmx velacc gmx velacc calcul veloc autocorrel function math c_mathbfv tau langl mathbfv_itau cdot mathbfv_i rangle_i label eqnvelocityautocorr self diffus coeffici calcul use greenkubo relat ref refallen math d_a int_infti langl bf v_it cdot bf v_i rangle_i dt label eqndiffcoeff integr veloc autocorrel function widelyheld belief veloc acf converg faster mean squar displac sec refmsd also use comput diffus constant howev allen tildesley ref refallen warn us longtim contribut veloc acf ignor care must taken anoth import quantiti dipol correl time dipol correl function particl type matha calcul follow refgmx dipol gmx dipol math c_mu tau langl bf mu_itau cdot bf mu_i rangle_i label eqndipolecorrfunc mathbf mu_i sum_j bf r_j q_j dipol correl time comput use eqeqn eqncorrtim applic see viscos liquid relat correl time pressur tensor mathmathbfp ref refpsmithc ref refbalasubramanian refgmx energi comput viscos accur ref refhessa actual valu converg mathp_x mathp_x x mathp_x x _covan covari analysi covari analysi also call princip compon analysi essenti dynam ref refamadei find correl motion use covari matrix mathc atom coordin math c_ij left langl m_iifrac x_i langl x_i rangl m_jjfrac x_j langl x_j rangl right rangl label eqncovmatrixcoord mathm diagon matrix contain mass atom massweight analysi unit matrix nonmass weight analysi mathc symmetr mathn time n matrix diagon orthonorm transform matrix mathr math rt c r mboxdiaglambda_lambda_ldotslambda_n mboxwherelambda_ geq lambda_ geq ldot geq lambda_n label eqnorthnormtransformmatrix column mathr eigenvector also call princip essenti mode mathr defin transform new coordin system trajectori project princip mode give princip compon mathp_it math bf pt rt mfrac bf xt langl bf x rangl label eqnprinccompon eigenvalu mathlambda_i mean squar fluctuat princip compon mathi first princip mode often describ collect global motion system trajectori filter along one princip mode one princip mode mathi goe follow math bf xft langl bf x rangl mfrac r_ p_it label eqnprincmodei analysi perform macromolecul one often want remov overal rotat translat look intern motion achiev least squar fit refer structur care taken refer structur repres ensembl sinc choic refer structur influenc covari matrix one alway check princip mode well defin first princip compon resembl half cosin second resembl full cosin might filter nois see good way check relev first princip mode calcul overlap sampl first second half simul note done refer structur use two halv good measur overlap defin ref refhessb element covari matrix proport squar displac need take squar root matrix examin extent sampl squar root calcul eigenvalu mathlambda_i eigenvector column rotat matrix mathr symmetr diagonallydomin matrix matha size mathn time n squar root calcul math afrac r mboxdiaglambda_fraclambda_fracldotslambda_nfrac rt label eqnmatrixsquareroot verifi easili product matrix give matha defin differ mathd covari matric matha mathb follow math beginalign dab sqrtmboxtrleftleftafrac bfracrightright sqrtmboxtrlefta b afrac bfracright left sum_in left lambda_ia lambda_ib right sum_in sum_jn sqrtlambda_ia lambda_jb leftr_ia cdot r_jbright rightfracendalign label eqnmatrixdiff tr trace matrix defin overlap math math sab fracdabsqrtmboxtra mboxtr b label eqnmatrixoverlap overlap matric matha mathb ident sampl subspac complet orthogon commonlyus measur subspac overlap first eigenvector covari matric overlap subspac span mathm orthonorm vector mathbf w_ldotsbf w_m refer subspac span mathn orthonorm vector mathbf v_ldotsbf v_n quantifi follow math mboxoverlapbf vbf w fracn sum_in sum_jm bf v_i cdot bf w_j label eqnsubspaceoverlap overlap increas increas mathm set mathbf v subspac set mathbf w disadvantag method take eigenvalu account eigenvector weight equal degener subspac present equal eigenvalu calcul overlap low anoth use check cosin content proven princip compon random diffus cosin number period equal half princip compon index ref refhessb ref refhess eigenvalu proport index power math cosin content defin math fract left int_t cosleftfraci pi ttright p_it mboxd right left int_t p_it mboxd right label eqneigenvaluecosin cosin content first princip compon close largest fluctuat connect potenti random diffus covari matrix built diagon refgmx covar gmx covar princip compon overlap mani thing plot analyz refgmx anaeig gmx anaeig cosin content calcul refgmx analyz gmx analyz proteinrel item refgmx do_dssp gmx do_dssp refgmx rama gmx rama refgmx wheel gmx wheel analyz structur chang protein calcul radiu gyrat minimum residu distanc time see sec refrg calcul rmsd sec refrmsd also look chang secondari structur element run use program refgmx do_dssp gmx do_dssp interfac commerci program dssp ref refkabsch inform see dssp manual typic output plot refgmx do_dssp gmx do_dssp given numreffig figdssp _figdssp figur plotsdssp width cm analysi secondari structur element peptid time one import analysi protein socal ramachandran plot project structur two dihedr angl mathphi mathpsi protein backbon see numreffig figphipsi _figphipsi figur plotsphipsi width cm definit dihedr angl mathphi mathpsi protein backbon evalu ramachandran plot use program refgmx rama gmx rama typic output given numreffig figrama _figrama figur plotsrama width cm ramachandran plot small protein studi mathalphahelic use helic wheel project peptid see whether peptid amphipath done use refgmx wheel gmx wheel program two exampl plot numreffig fighprwheel _fighprwheel figur plotshprwheel width cm helic wheel project ntermin helix hpr _rmsd root mean squar deviat structur refgmx rm gmx rm refgmx rmsdist gmx rmsdist root mean squar deviat mathrmsd certain atom molecul respect refer structur calcul program refgmx rm gmx rm leastsquar fit structur refer structur matht_ subsequ calcul mathrmsd eqeqn eqnrmsd math rmsdt_t_ leftfracm sum_in m_i bf r_it_bf r_it_ rightfrac label eqnrmsd mathm sum_in m_i mathbf r_it posit atom mathi time matht note fit use atom calcul mathrmsd eg protein usual fit backbon atom n c math_alpha c mathrmsd comput backbon whole protein instead compar structur initi structur time matht exampl crystal structur one also calcul eqeqn eqnrmsd structur time matht_t_tau give insight mobil function mathtau matrix also made mathrmsd function matht_ matht_ give nice graphic interpret trajectori transit trajectori clearli show matrix altern mathrmsd comput use fitfre method program refgmx rmsdist gmx rmsdist math rmsdt leftfracnsum_in sum_jn bf r_ijtbf r_ijrightfrac label eqnrmsdff distanc r math_ij atom time matht compar distanc atom time math _usinggroup use group chapter refalgorithm explain group atom use refmdrun gmx mdrun see sec refgroupconcept analysi program group atom must also chosen program gener sever default index group group alway read index file let consid exampl simul binari mixtur compon b want calcul radial distribut function rdf mathg_abr respect b calcul math pi r g_abr vsum_i an_a sum_j bn_b pr label eqnanalysisrdf mathv volum mathpr probabl find b atom distanc mathr atom user defin atom number group b simpl file calcul mathg_ab gener way without make assumpt rdf program type particl group therefor consist seri atom number case also molecul number also possibl specifi seri angl tripl atom number dihedr quadrupl atom number bond vector molecul pair atom number appropri type index file specifi follow analysi program help creat refindex file ndx indexndx coupl program gener use either input configur topolog gener index file consist seri atom number exampl mathg_ab use refgmx make_ndx refgmx select gener index file angl dihedr use refgmx mk_angndx cours also make hand gener format present oxygen hydrogen first group name written squar bracket follow atom number may spread mani line like atom number start tool use group offer avail altern user choos choic made number group name fact first letter group name suffic distinguish group other way use unix shell featur choos group name command line rather interact consult webpage_ suggest _defaultgroup default group index file suppli analysi tool refgrompp gmx grompp number default group gener choos system atom system protein protein atom proteinh protein atom exclud hydrogen calpha c math_alpha atom backbon protein backbon atom n c math_alpha c mainchain protein main chain atom n c math_alpha c includ oxygen cterminu mainchaincb protein main chain atom includ c math_beta mainchainh protein main chain atom includ backbon amid hydrogen hydrogen nterminu sidechain protein side chain atom atom except n c math_alpha c backbon amid hydrogen oxygen cterminu hydrogen nterminu sidechainh protein side chain atom exclud hydrogen protmass protein atom exclud dummi mass use virtual site construct nh math_ group tryptophan sidechain see also sec refvsitetop group includ differ protein group nonprotein nonprotein atom dna dna atom rna rna atom water water molecul name like sol wat hoh etc see residuetypesdat full list nonwat anyth cover water group ion name match ion entri residuetypesdat water_and_ion combin water ion group molecule_nam residuesmolecul recogn protein dna rna one group per residuemolecul name gener atom neither protein dna rna empti group gener group contain protein atom atom consid protein atom residu name list residuetypesdat file list protein entri process determind dna rna etc analog need modifi classif copi file librari directori work directori edit local copi _select select refgmx select gmx select current analysi tool support extend concept dynam select three main differ tradit index group select specifi text instead read fix atom indic file use syntax similar vmd text enter interact provid command line file select restrict atom also specifi analysi perform eg centerofmass posit group atom tool may support select evalu singl atom eg requir inform avail singl atom like atom name type select dynam ie evalu differ atom differ trajectori frame allow analyz subset system satisfi geometr criteria exampl simpl select resnam abc within resnam def select atom residu name abc within nm atom residu name def tool accept select also use tradit index file similarli older tool possibl give refndx file tool directli select group index file select either group number group name index group also use part complic select get start run refgmx select gmx select singl structur use interact prompt tri differ select tool provid among other output option ofpdb write select atom index file refpdb file respect allow test select evalu centerofmass posit select test result examin detail syntax individu keyword use select access type help interact prompt selectionen tool well refgmx help gmx help select help divid subtop access eg help syntax refgmx help gmx help select syntax individu select keyword extend help well access eg help keyword within interact prompt current provid much edit capabl need run program rlwrap tool yet support select syntax use refgmx select gmx select gener static index group pass tool howev allow small subset first bullet list flexibl fulli selectionawar tool offer also possibl write analysi tool take advantag flexibl select see templatecpp file sharegromacstempl directori instal exampl httpsmanualgromacsorgcurrentdoxygenhtmlfullpage_analysistemplatexhtml document hydrogen bond refgmx hbond gmx hbond program refgmx hbond gmx hbond analyz hydrogen bond hbond possibl donor acceptor determin hbond exist geometr criterion use see also numreffig fighbond math beginarrayrclcl r leq r_hb mboxnm alpha leq alpha_hb endarray label eqnhbondgeomtr _fighbond figur plotshbond width cm geometr hydrogen bond criterion valu mathr_hb mathrmnm correspond first minimum rdf spc water see also numreffig fighbondinsert program refgmx hbond gmx hbond analyz hydrogen bond exist two group atom must either ident nonoverlap specifi donorhydrogenacceptor triplet follow way _fighbondinsert figur plotshbondinsert width cm insert water hbond normal hbond two residu hbond bridg via water molecul donoracceptor distanc mathr distribut hbond hydrogendonoracceptor angl mathalpha distribut hbond total number hbond time frame number hbond time residu divid group mathnmathn mathi mathn mathn mathi stand residu number mathi goe group mathi also includ hbond mathi group includ mathnmathn math mathnmathn math mathnmathn math hbond provid measur format mathalphahelic mathbetaturn strand lifetim hbond calcul averag autocorrel function exist function either hbond math ctau langl s_its_i tau rangl label eqnhbcorr maths_it hbond mathi time matht integr mathctau give rough estim averag hbond lifetim mathtau_hb math tau_hb int_infti ctau dtau label eqnhblif integr complet autocorrel function mathctau output sophist analysi eg use multiexponenti fit use get better estim mathtau_hb complet analysi given ref ref refspoelb one fanci option luzar chandler analysi hydrogen bond kinet ref refluzarb ref refluzara hbond exist map gener dimens hbond mathtim frame order ident index file see revers mean last triplet index file correspond first row exist map index group output contain analyz group donorhydrogen atom pair acceptor atom group donorhydrogenacceptor triplet involv hydrogen bond analyz group solvent atom involv insert radial distribut function refgmx rdf gmx rdf radial distribut function rdf pair correl function mathg_abr particl type matha mathb defin follow way math beginarrayrcl g_abr displaystyl fraclangl rho_br ranglelanglerho_brangle_loc displaystyl fraclanglerho_brangle_localdisplaystyl fracn_a sum_i an_a sum_j bn_b displaystyl fracdelta r_ij r pi r endarray label eqnrdfdefin mathlanglerho_brrangl particl densiti type mathb distanc mathr around particl matha mathlanglerho_brangle_loc particl densiti type mathb averag sphere around particl matha radiu mathr_max see numreffig figrdfex c _figrdfex figur plotsrdf width cm definit slice refgmx rdf gmx rdf mathg_abr b mathg_abrtheta slice color gray c normal mathlanglerho_brangle_loc normal mathlanglerho_brangle_localtheta normal volum color gray usual valu mathr_max half box length averag also perform time practic analysi program refgmx rdf gmx rdf divid system spheric slice mathr mathrdr see numreffig figrdfex make histogram stead mathdeltafunct exampl rdf oxygenoxygen spc water ref refberendsen given numreffig figrdf _figrdf figur plotsrdfoo width cm mathg_oor oxygenoxygen spcwater refgmx rdf gmx rdf also possibl calcul angl depend rdf mathg_abrtheta angl maththeta defin respect certain laboratori axi mathbf e see numreffig figrdfex b math g_abrtheta langlerho_brangle_localtheta n_a sum_i an_a sum_j bn_b delta r_ij r deltatheta_ij theta pi r sintheta label eqnrdfangleaxi math costheta_ij bf r_ij cdot bf e r_ij e label eqnrdfangleaxi mathg_abrtheta use analyz anisotrop system note case normal mathlanglerho_brangle_localtheta averag densiti angl slice maththeta maththeta dtheta mathr_max angl depend see numreffig figrdfex _bad bondsdist angl dihedr refgmx distanc gmx distanc refgmx angl gmx angl refgmx gangl gmx gangl monitor specif bond modul gener distanc point program refgmx distanc gmx distanc calcul distanc function time well distribut distanc tradit index file group consist pair atom number exampl bonds_ bonds_ select also support first two posit defin first distanc second pair posit defin second distanc calcul distanc ca cb atom residu assum everi residu either atom neither use select name ca cb select also allow gener distanc comput exampl comput distanc center mass two residu use com resnam aaa plu com resnam bbb program refgmx angl gmx angl calcul distribut angl dihedr time also give averag angl dihedr index file consist triplet quadrupl atom number angl dihedr dihedr angl use either biochem convent mathphi equiv ci polym convent mathphi equiv tran see numreffig figdihdef _figdihdef figur plotsdihdef width cm dihedr convent biochem convent b polym convent program refgmx gangl gmx gangl provid selectionen version comput angl tool also comput angl dihedr support option refgmx angl gmx angl autocorrel time seri analys addit support angl two vector vector plane two plane defin point respect vectorplan mathz axi vectorplan normal sphere determin singl posit also angl vectorplan compar posit first frame support plane refgmx gangl gmx gangl use normal vector perpendicular plane see numreffig figsgangl b c definit _figsgangl figur plotssgangl width cm angl option refgmx gangl gmx gangl angl two vector b angl two plane c angl vector mathz axi angl vector normal sphere also combin support plane vector use interchang curv fit gromac sum exponenti function sometim use fit curv analyt function exampl case autocorrel function noisi tail gromac gener purpos curvefit tool howev therefor gromac support limit number function numreft tablefitfn list avail option correspond commandlin option underli routin fit use levenbergmarquardt algorithm implement lmfit packag ref reflmfit barebon version includ gromac option errorweight fit implement exp replac matheta_ aexp replac matha_eta_ exp replac matha_eta_a_eta_ exp replac matha_eta_a_eta_a_ exp replac matha_eta_a_eta_a_eta_a_ exp replac matha_eta_a_eta_a_eta_a_eta_a_ nexp replac matha_g a_g nexp replac matha_g a_g nexp replac matha_g a_g a_ ge nexp replac matha_g a_g a_g a_g _tablefitfn tabl overview fit function support analysi tool comput autocorrel function note column describ properti output paramet align center width auto command function form mathft note line option exp exp aexp aexp exp_exp exp nexp exp exp nexp exp exp nexp exp exp nexp error estim hood gromac implement fit function name function estim error timecorrel data due hess ref refhessa math varepsilont alphatau_leftfractau_tleftettau_rightright alphatau_leftfractau_tleftettau_rightright label eqntimecorrerror mathtau_ mathtau_ time constant mathtau_ ge tau_ mathalpha usual close fit procedur enforc mathleqalphaleq use refgmx analyz gmx analyz error estim use math lim_trightarrowinftyvarepsilont sigmasqrtfracalphatau_alphatau_t label eqnanalyzeerrorest mathsigma standard deviat data set matht total simul time ref refhessa interphas boundari demarc order determin posit width interfac steensthr et al fit densiti profil follow function math fx fraca_a_ fraca_a_rm erfleftfracxa_a_right label eqndesprofilefunc matha_ matha_ densiti differ phase mathx coordin normal interfac matha_ posit interfac matha_ width interfac ref refsteensaethrea implement refgmx densord gmx densord transvers current autocorrel function order establish transvers current autocorrel function use comput viscos ref refpalmera follow function fit math fx enuleftrm coshomeganufracrm sinhomeganuomegaright label eqntransverseautocorrfunc mathnu xa_ mathomega sqrta_ implement refgmx tcaf gmx tcaf viscos estim pressur autocorrel function viscos notori difficult properti extract simul ref refhessa ref refwensinka principl possibl determin integr pressur autocorrel function ref refpsmithc howev often hamper noisi tail acf workaround fit acf follow function ref refguob math ftf c rm cosomega ettau_fbeta_f c ettau_sbeta_ label eqnviscestpressureautocorr mathomega frequenc rapid pressur oscil mainli due bond forc molecular simul mathtau_f mathbeta_f time constant expon fast relax stretchedexponenti approxim mathtau_ mathbeta_ constant slow relax mathc prefactor determin weight fast slow relax fit integr function mathft use comput viscos math eta fracvk_b tint_infti ft dt label eqncompviscos equat appli comput bulk shear viscos use differ element pressur tensor ref reffanourgakisa _rg radiu gyrat distanc refgmx gyrat gmx gyrat refgmx distanc gmx distanc refgmx mindist gmx mindist refgmx mdmat gmx mdmat refgmx pairdist gmx pairdist refgmx xpmp gmx xpmp rough measur compact structur calcul radiu gyrat program refgmx gyrat gmx gyrat follow math r_g leftfracsum_i bf r_i m_isum_i m_irightfrac label eqnrg mathm_i mass atom mathi mathbf r_i posit atom mathi respect center mass molecul especi use character polym solut protein program also provid radiu gyrat around coordin axi option princip axe sum radii compon orthogon axi instanc math r_gx leftfracsum_i left r_iy r_iz right m_isum_i m_irightfrac label eqnrgaxi sometim interest plot distanc two atom minimum distanc two group atom eg protein sidechain salt bridg calcul distanc certain group sever possibl distanc geometr center two group calcul program refgmx distanc gmx distanc explain sec refbad minimum distanc two group atom time calcul program refgmx mindist gmx mindist also calcul number contact group within certain radiu mathr_max refgmx pairdist gmx pairdist selectionen version refgmx mindist gmx mindist monitor minimum distanc amino acid residu within protein molecul use program refgmx mdmat gmx mdmat minimum distanc two residu math_i math_j defin smallest distanc pair atom mathin math_i j mathin math_j output symmetr matrix smallest distanc residu visual matrix use program xv want view axe legend want print matrix convert refxpmp gmx xpmp postscript numreffig figdistm _figdistm figur plotsdistm width cm minimum distanc matrix peptid ref refspoelb plot matric differ timefram one analyz chang structur eg form salt bridg long rang van der waal interact dispers correct section deriv longrang correct due use cutoff lennardjon buckingham interact assum cutoff long repuls term safe neglect therefor dispers term taken account due natur dispers interact truncat potenti proport mathr energi pressur correct neg energi correct usual small may import free energi calcul differ two differ hamiltonian consid contrast pressur correct larg neglect circumst correct pressur requir especi npt simul although principl possibl parameter forc field pressur close desir experiment valu without correct method make parameter depend cutoff therefor undesir _ecorr energi longrang contribut dispers interact virial deriv analyt assum homogen system beyond cutoff distanc mathr_c dispers energi two particl written math vr_ij c_r_ij label eqnlrljedisp correspond forc math mathbff_ij c_r_ijmathbfr_ij label eqnlrljfdisp period system easi calcul full potenti usual cutoff appli abrupt smooth call potenti forc cutoff mathv_c mathmathbff_c longrang contribut dispers energi system mathn particl particl densiti mathrho mathnv math v_lr fracn rhoint_infti pi r gr left vr v_cr right rm dr label eqnenercorr integr shift function gener form van der waal interact avail gromac shift function constant differ math mathr_ beyond cutoff distanc mathr_c integr eqeqn eqnenercorr assum densiti sphere within mathr_ equal global densiti radial distribut function mathgr beyond mathr_ math beginalign v_lr fracn left rhoint_r_ pi r gr c_ srm dr rhoint_r_r_c pi r left vr v_cr right rm dr rhoint_r_cinfti pi r vr rm dr right fracn leftleftfracpi rho r_ right c_ rhoint_r_r_c pi r left vr v_cr right rm dr frac pi n rho c_r_c rightendalign label eqnlrljshift term math correct selfinteract plain cutoff need assum mathgr beyond mathr_c correct reduc ref refallen math beginalign v_lr frac pi n rho c_r_cendalign label eqnlrljcorrreduc consid exampl box pure water simul cutoff nm densiti g cm math correct math kj mol math per molecul homogen mixtur need defin averag dispers constant math left c_ right fracnnsum_insum_jin c_ij label eqnavcsix gromac exclud pair atom contribut averag case inhomogen simul system eg system lipid interfac energi correct appli mathleft c_ right compon compar _virial virial pressur scalar virial system due dispers interact two particl mathi mathj given math xifrac mathbfr_ij cdot mathbff_ij c_r_ij label eqnlrljdispviri pressur given math pfracvlefte_kin xiright label eqnlrljpressur longrang correct virial given math xi_lr fracn rho int_infti pi r gr xi xi_c rm dr label eqnlrljcorrviri integr longrang contribut virial assum mathgr beyond mathr_ math beginalign xi_lr fracn rho left int_r_r_c pi r xi xi_c rm dr int_r_cinfti pi r c_r_ij rm drright nonumb fracn rho left int_r_r_c pi r xi xi_c rm dr pi c_ r_c rightendalign label eqnlrljvirialcontrib plain cutoff correct pressur ref refallen math p_lrfrac pi c_ rho r_c label eqnlrljpressurecorr use exampl water box correct virial kj mol math per molecul correspond correct pressur spc water approxim math bar homogen mixtur use averag dispers constant mathleft c_ right eqeqn eqnavcsix math p_lrfrac pi left c_ rightrho r_c label eqnpcorr inhomogen system eqeqn eqnpcorr appli restrict hold energi see sec refecorr lennardjon pme order treat system use lennardjon potenti nonhomogen outsid cutoff distanc instead use particlemesh ewald method discuss electrostat case modifi ewald equat becom math beginalign v v_mathrmdir v_mathrmrec v_ ex v_mathrmdir frac sum_ijn sum_n_xsum_n_i sum_n_z fraccij_ gbeta r_ijbf nr_ijbf n endalign label eqnljpmerealspac math beginalign v_mathrmrec fracpifrac betav sum_m_xsum_m_ysum_m_z fpi mathbf beta time sum_ijn cij_ mathrmexpleftpi bf mcdotbf r_ibf r_jright ex v_ fracbetasum_in cii_endalign label eqnljpmerealspac mathbf mm_xm_ym_z mathbeta paramet determin weight direct reciproc space mathcij_ combin dispers paramet particl mathi mathj star indic term mathi j omit mathn_xn_yn_z mathbf r_ijbf n real distanc particl follow deriv essmann ref refessmann function mathf mathg introduc defin math beginalign fxleftxmathrmexpx xsqrtpimathrmerfcx right gxmathrmexpxxfracxendalign label eqnljpmerealdist methodolog work fine long dispers paramet combin geometr eqeqn eqncomb way charg electrostat math cij_mathrmgeom leftcii_ cjj_right label eqnljpmegeom lorentzberthelot combin rule eqeqn eqnlorentzberthelot reciproc part sum calcul seven time due split dispers paramet accord math cij_mathrmlb sigma_isigma_jsum_n p_nsigma_insigma_jn label eqnljpmelorenztberthelot mathp_n pascal triangl coeffici introduc nonneglig cost reciproc part requir seven separ fft therefor limit factor previou attempt implement ljpme solut problem use geometr combin rule order calcul approxim interact paramet reciproc part potenti yield total interact math beginalign vrr_c underbracecmathrmdir_ gbeta r r_mathrmdirect space underbracecmathrmrecip_mathrmgeom gbeta r r_mathrmreciproc space nonumb cmathrmrecip_mathrmgeomr leftcmathrmdir_cmathrmrecip_mathrmgeomrightgbeta rr vrr_c underbracecmathrmrecip_mathrmgeom gbeta r r_mathrmreciproc spaceendalign label eqnpmearith preserv welldefin hamiltonian significantli increas perform simul approxim introduc error sinc differ locat interact calcul reciproc space effect small compar total interact energi simul lipid bilay use cutoff nm rel error total dispers energi thorough discuss found ref refwennberg gromac perform proper calcul interact subtract directspac interact contribut made approxim potenti use reciproc part math v_mathrmdir cmathrmdir_ r cmathrmrecip_ gbeta r r label eqnljpmedirectspac potenti reduc express eqeqn eqnljpmerealspac mathcmathrmdir_ cmathrmrecip_ total interact given math beginalign nonumb vrr_c underbracecmathrmdir_ r cmathrmrecip_ gbeta r r_mathrmdirect space underbracecmathrmrecip_ gbeta r r_mathrmreciproc space cmathrmdir_ r endalign label eqnljpmecorr math beginalign vrr_c cmathrmrecip_ gbeta r rendalign label eqnljpmecorr case mathcmathrmdir_ neq cmathrmrecip_ retain unmodifi lj forc cutoff error order magnitud smaller simul directspac interact account approxim use reciproc space use vdw interact modifi potentialshift constant math leftcmathrmdir_ cmathrmrecip_ gbeta r_cright r_c label eqnljpmeconst ad eqeqn eqnljpmecorr order ensur potenti continu cutoff note way eqeqn eqnljpmedirectspac degener expect mathc_gbeta r_cr_c mathcmathrmdir_ cmathrmrecip_ addit longrang dispers correct appli correct approxim use combin rule reciproc space correct assum cutoff lj potenti uniform particl distribut sinc error combin rule approxim small longrang correct necessari case also note homogen correct correct surfac tension inhomogen properti use ljpme exampl use particlemesh ewald summat lennardjon interact gromac specifi follow line refmdp file vdwtype pme rvdw vdwmodifi potentialshift rlist rcoulomb fourierspac pmeorder ewaldrtollj ljpmecombrul geometr fourier grid interpol order use ljpme electrostat pme activ set fourierspac pmeorder common ewaldrtollj control split direct reciproc space way ewaldrtol addit combin rule use reciproc space determin ljpmecombrul current forc field use lorentzberthelot combin rule possibl set ljpmecombrul geometr order gain signific increas perform small loss accuraci detail approxim found section note use complet longrang dispers correct mean coulomb pme rvdw free paramet method rather necessarili restrict forcefield parameter scheme thu possibl optim cutoff space order toler term accuraci best perform natur use ljpme rather lj cutoff add comput commun done reciprocalspac part best perform balanc load parallel simul use pmeonli rank rank use may possibl improv upon automat loadbalanc use refmdrun gmx mdrun polar polar treat gromac attach shell drude particl atom andor virtual site energi shell particl minim time step order remain bornoppenheim surfac simpl polar implement harmon potenti equilibrium distanc input given topolog file polariz mathalpha gromac unit follow polar atom j type alpha case polariz volum nm math  math order comput harmon forc constant mathk_c mathc stand coreshel follow use ref refmaarena math k_c fracq_salpha label eqnsimplepol mathq_ charg shell particl anharmon polar develop drude forc field roux mckerel ref reflopesa found particl overpolar fix introduc higher order term polar energi math beginalign v_pol frack_c r_c r_c le delta frack_c r_c k_hyp r_csdelta r_c deltaendalign label eqnanharmpol mathdelta userdefin constant set nm anion drude forc field ref refhyu sinc origin introduct also use atom type ref reflopesa polar atom j type alpha nm delta khyp e forc constant mathk_hyp correspond mathcdot math kcalmolnm math henc strang number water polar special potenti water allow anisotrop polar singl shell particl ref refmaarena thole polar base earli work thole ref refthol roux cowork implement potenti molecul like ethanol ref reflamoureuxa ref refnoskova within molecul intramolecular interact shell particl howev must screen full coulomb would strong potenti two shell particl mathi mathj math v_thole fracq_i q_jr_ijleftleftfracbarr_ijrightrm expbarr_ijright label eqntholepol note sign error equat noskov et al ref refnoskova math barr_ij afracr_ijalpha_i alpha_j label eqntholsignerror matha magic dimensionless constant usual chosen ref refnoskova mathalpha_i mathalpha_j polariz respect shell particl method exclus interact atom within molecul close chain ie atom coval bond link one two atom call first neighbor second neighbor third neighbor respect see numreffig figchain sinc interact atom atom mainli quantum mechan model lennardjon potenti instead assum interact adequ model harmon bond term constraint harmon angl term first second neighbor atom therefor exclud lennardjon interact list atom atom call exclus atom _figchain figur plotschain width cm atom along alkan chain third neighbor normal lennardjon repuls sometim still strong mean appli molecul molecul would deform break due intern strain especi case carboncarbon interact cisconform eg cisbutan therefor interact lennardjon repuls reduc gromo forc field implement keep separ list normal lennardjon paramet forc field opl ref refjorgensen standard lennardjon paramet reduc factor two case also dispers r math coulomb interact scale gromac use either method charg group principl forc calcul md mathon problem therefor appli cutoff nonbond forc nbf calcul particl within certain distanc interact reduc cost mathon typic mathn mathn nbf also introduc error case accept except appli cutoff impli creation charg case consid use lattic sum method provid gromac consid water molecul interact anoth atom would appli plain cutoff atomatom basi might includ atomoxygen interact charg math without compens charg proton result induc larg dipol moment system therefor keep group atom total charg togeth group call charg group note proper treatment longrang electrostat eg particlemesh ewald sec refpm keep charg group togeth requir treatment cutoff group scheme gromac quit flexibl treat cutoff impli quit number paramet set paramet set input file grompp two sort paramet affect cutoff interact select type interact use case cutoff use neighbor search coulomb van der waal interact interact type selector term vdwtype coulombtyp two paramet total six nonbond interact paramet see user guid complet descript paramet group cutoff scheme interact function numreft tabfuncparm requir neighbor search done radiu least larg mathr_c specifi function form use charg group extra radiu typic order nm roughli largest distanc two atom charg group plu distanc charg group diffus within neighbor list updat cpcop replac mathr_c mathvarepsilon_r crfp replac mathr_c mathvarepsilon_rf cshfp replac mathr_ mathr_c mathvarepsilon_r cswfp replac mathr_ mathr_c mathvarepsilon_r vpcop replac mathr_c vshfp replac mathr_ mathr_c vswfp replac mathr_ mathr_c _tabfuncparm tabl paramet differ function form nonbond interact type paramet coulomb plain cutoff cpcop reaction field crfp shift function cshfp switch function cswfp vdw plain cutoff vpcop shift function vshfp switch function vswfp _virtualsit virtual interact site virtual interact site call dummi atom gromac version use gromac number way write posit virtual site mathmathbfr_ function posit particl mathmathbfr math_i mathmathbfr_ fmathbfr_mathbfr_n virtual site may carri charg involv interact use forc calcul forc act virtual site must redistribut particl mass consist way good way found ref ref refberendsenb write potenti energi math v vmathbfr_smathbfr_ldotsmathbfr_n vmathbfr_ldotsmathbfr_n label eqnvsiteepot forc particl mathi math mathbff_i fracparti vpartial mathbfr_i fracparti vpartial mathbfr_i fracparti vpartial mathbfr_ fracparti mathbfr_sparti mathbfr_i mathbff_idirect mathbff_i label eqnvsiteforc first term normal forc second term forc particl mathi due virtual site written tensor notat math mathbff_i leftbeginarrayccc displaystylefracparti x_spartial x_i displaystylefracparti y_spartial x_i displaystylefracparti z_spartial x_i ex displaystylefracparti x_spartial y_i displaystylefracparti y_spartial y_i displaystylefracparti z_spartial y_i ex displaystylefracparti x_spartial z_i displaystylefracparti y_spartial z_i displaystylefracparti z_spartial z_i endarrayrightmathbff_ label eqnfvsit mathmathbff_ forc virtual site mathx_ mathy_ mathz_ coordin virtual site way total forc total torqu conserv ref refberendsenb comput virial eqeqn eqnxi nontrivi virtual site use sinc virial involv summat atom rather virtual site forc must redistribut virtual site atom use eqeqn eqnfvsit comput virial special case forc atom written linear combin forc virtual site type differ comput virial redistribut forc howev gener case redistribut done first _figvsit figur plotsdummi width cm seven differ type virtual site construct construct atom shown black circl virtual site gray six way construct virtual site surround atom gromac classifi number construct atom note site type mention construct type fd normal inplan nonnorm plane howev amount comput involv increas sharpli along list strongli recommend use first adequ virtual site type suffici certain purpos numreffig figvsit depict avail virtual site construct conceptu simplest construct type linear combin math mathbfr_ sum_in w_i mathbfr_i label eqnvsitelincomb forc redistribut use weight math mathbff_i w_i mathbff_ label eqnvsitelincombforc type virtual site support gromac given list construct atom virtual site virtual site higher list ie virtual site construct particl simpler virtual site virtual site veloc report use integr virtual site posit top atom allow give atom multipl atom type also assign multipl differ bond interact especi use freeenergi calcul coordin virtual site equal construct atom math mathbfr_ mathbfr_i label eqnvsit forc move construct atom math mathbff_i mathbff_ label eqnvsiteforc veloc virtual site equal construct atom math mathbfv_ mathbfv_i label eqnvsitevel linear combin two atom numreffig figvsit weight calcul math w_i w_j label eqnvsitelinatom case virtual site line atom mathi mathj veloc virtual site linear combin veloc construct atom line two atom fix distanc numreffig figvsit fd posit calcul math mathbfr_ mathbfr_i frac mathbfr_ij mathbfr_ij label eqnvsitefdatom case virtual site line two particl distanc matha mathi forc particl mathi mathj due forc virtual site comput math beginarraylcr mathbff_i displaystyl mathbff_ gamma mathbff_i mathbfp ex mathbff_j displaystyl gamma mathbff_ mathbfp ex endarray mbox beginarrayc displaystyl gamma fraca mathbfr_ij ex displaystyl mathbfp frac mathbfr_i cdot mathbff_ mathbfr_i cdot mathbfr_i mathbfr_i endarray label eqnvsitefdforc veloc calcul math mathbfv_ mathbfv_i fracamathbfr_ij leftmathbfv_ij mathbfr_ij fracmathbfv_ijcdotmathbfr_ij mathbfr_ijright label eqnvsitefdatomvel linear combin three atom numreffig figvsit weight calcul math w_i b w_j w_k b label eqnvsitelinatom case virtual site plane three particl plane three atom fix distanc numreffig figvsit fd posit calcul math mathbfr_ mathbfr_i b frac mathbfr_ijk mathbfr_ijk mbox mathbfr_ijk mathbfr_ij mathbfr_jk label eqnvsiteplaneatom case virtual site plane three particl distanc mathb mathi forc particl mathi mathj mathk due forc virtual site comput math beginarraylcr mathbff_i displaystyl mathbff_ gamma mathbff_i mathbfp ex mathbff_j displaystyl agamma mathbff_ mathbfp ex mathbff_k displaystyl gamma mathbff_ mathbfp endarray mbox beginarrayc displaystyl gamma fracb mathbfr_ij mathbfr_jk ex displaystyl mathbfp frac mathbfr_i cdot mathbff_ mathbfr_i cdot mathbfr_i mathbfr_i endarray label eqnvsiteplaneatomforc veloc calcul math mathbfv_ mathbfv_i fracbmathbfr_ijk leftdotmathbfr_ijk mathbfr_ijkfracdotmathbfr_ijkcdotmathbfr_ijk mathbfr_ijkright label eqnvsiteplaneatomvel plane three atom fix angl distanc numreffig figvsit fad posit calcul math mathbfr_ mathbfr_i co theta fracmathbfr_ij mathbfr_ij sin theta fracmathbfr_perp mathbfr_perp mbox mathbfr_perp mathbfr_jk frac mathbfr_ij cdot mathbfr_jk mathbfr_ij cdot mathbfr_ij mathbfr_ij label eqnvsitefadf case virtual site plane three particl distanc mathd mathi angl mathalpha mathmathbfr_ij atom mathk defin plane direct angl note case mathb mathalpha must specifi instead matha mathb see also sec refvsitetop forc particl mathi mathj mathk due forc virtual site comput mathmathbfr_perp defin eqeqn eqnvsitefadf math beginarrayc beginarraylcllll mathbff_i mathbff_ dfracd co theta mathbfr_ij mathbff_ dfracd sin theta mathbfr_perp left dfrac mathbfr_ij cdot mathbfr_jk mathbfr_ij cdot mathbfr_ij mathbff_ mathbff_ right ex mathbff_j dfracd co theta mathbfr_ij mathbff_ dfracd sin theta mathbfr_perp left mathbff_ dfrac mathbfr_ij cdot mathbfr_jk mathbfr_ij cdot mathbfr_ij mathbff_ mathbff_ right ex mathbff_k dfracd sin theta mathbfr_perp mathbff_ ex endarray ex mboxwher mathbff_ mathbff_ dfrac mathbfr_ij cdot mathbff_ mathbfr_ij cdot mathbfr_ij mathbfr_ij mbox mathbff_ mathbff_ dfrac mathbfr_perp cdot mathbff_ mathbfr_perp cdot mathbfr_perp mathbfr_perp mboxand mathbff_ dfrac mathbfr_ij cdot mathbff_ mathbfr_ij cdot mathbfr_ij mathbfr_perp endarray label eqnvsitefadfforc veloc calcul math mathbfv_ mathbfv_i dcostheta fracdeltadelta tfracmathbfr_ijmathbfr_ij dsintheta fracdeltadelta tfracmathbfr_perpmathbfr_perp mboxwher fracdeltadelta tfracmathbfr_ijmathbfr_ij fracmathbfr_ijleftmathbfv_ij mathbfr_ij fracmathbfv_ijcdotmathbfr_ijmathbfr_ijright fracdeltadelta tfracmathbfr_perpmathbfr_perp fracmathbfr_perp leftdotmathbfr_perp mathbfr_perpfracdotmathbfr_perpcdotmathbfr_perpmathbfr_perpright dotmathbfr_perp mathbfv_jk mathbfr_ij fracmathbfr_ijmathbfv_ijcdotmathbfr_jk mathbfr_ijcdotmathbfv_jk mathbfr_ijcdotmathbfr_jkmathbfr_ijcdotmathbfv_ij mathbfr_ij fracmathbfr_ijcdotmathbfr_jkmathbfr_ij mathbfv_ij label eqnvsitefadvel nonlinear combin three atom plane numreffig figvsit posit calcul math mathbfr_ mathbfr_i mathbfr_ij b mathbfr_ik c mathbfr_ij time mathbfr_ik label eqnvsitenonlinatom enabl construct virtual site plane atom forc particl mathij mathk due forc virtual site comput math beginarraylcl mathbff_j leftbeginarrayccc cz_ik cy_ik ex cz_ik cx_ik ex cy_ik cx_ik endarrayrightmathbff_ mathbff_k leftbeginarrayccc b cz_ij cy_ij ex cz_ij b cx_ij ex cy_ij cx_ij b endarrayrightmathbff_ mathbff_i mathbff_ mathbff_j mathbff_k endarray label eqnvsitenonlinatomforc veloc calcul math mathbfv_ mathbfv_i fraccmathbfr_mleftdotmathbfr_m mathbfr_m fracdotmathbfr_mcdotmathbfr_mmathbfr_mright label eqnvsitenonlinatomvel four atom fix distanc see separ numreffig figvsitefdn construct bit complex particular sinc previou type fd could unstabl forc us introduc elabor construct _figvsitefdn figur plotsvsitefdn width cm new fdn virtual site construct stabl even construct atom plane posit calcul math beginalign mathbfr_ja mathbfr_ik mathbfr_ij mathbfx_k mathbfx_i mathbfx_j mathbfx_i nonumb mathbfr_jb b mathbfr_il mathbfr_ij b mathbfx_l mathbfx_i mathbfx_j mathbfx_i nonumb mathbfr_m mathbfr_ja time mathbfr_jb nonumb mathbfr_ mathbfr_i c fracmathbfr_m mathbfr_m endalign label eqnvsit veloc calcul math mathbfv_ mathbfv_i fraccmathbfr_mleftdotmathbfr_m mathbfr_m fracdotmathbfr_mcdotmathbfr_mmathbfr_mright mboxwher dotmathbfr_m dotmathbfr_ja time mathbfr_jb mathbfr_ja time dotmathbfr_jb label eqnvsitevel case virtual site distanc mathc mathi matha mathb paramet note vector mathmathbfr_ik mathmathbfr_ij normal save floatingpoint oper forc particl mathi mathj mathk mathl due forc virtual site comput chain rule deriv construct express exact conserv energi lead rel lengthi express includ floatingpoint oper interest reader look sourc code vsitec fortun vsite type normal use chiral center mathc_alpha atom protein new fdn construct identifi type valu topolog earlier fd type still support intern type valu use new simul current gromac tool automat gener type fdn instead linear combin mathn atom rel weight matha_i weight atom mathi math w_i a_i leftsum_jn a_j right label eqnvsiterelweight three option set weight center geometri equal weight center mass matha_i mass atom mathi freeenergi simul mass atom chang mass astat use weight center weight matha_i defin user bond interact bond interact base fix list atom exclus pair interact includ bodi interact well bond stretch bodi bond angl bodi dihedr angl bodi interact special type dihedr interact call improp dihedr use forc atom remain plane prevent transit configur opposit chiral mirror imag _bondpot bond stretch _harmonicbond harmon potenti bond stretch two coval bond atom mathi mathj repres harmon potenti _figbstretch figur plotsbstretch width cm principl bond stretch left bond stretch potenti right math v_br_ij frackb_ijr_ijb_ij label eqnharmbondstretch see also numreffig figbstretch forc given math mathbff_imathbfr_ij kb_ijr_ijb_ij fracmathbfr_ijr_ij label eqnharmbondstretchforc _gbond fourth power potenti gromo forc field ref refgromo coval bond potenti reason comput effici written math v_br_ij frackb_ijleftr_ijb_ijright label eqngbond correspond forc math mathbff_imathbfr_ij kb_ijr_ijb_ijmathbfr_ij label eqngbondforc forc constant form potenti relat usual harmon forc constant mathkbmathrmharm sec refbondpot math kb b_ij kbmathrmharm label eqnharmrel forc constant mostli deriv harmon one use gromo ref refbiomo although form comput effici squar root evalu conceptu complex one particular disadvantag sinc form harmon averag energi singl bond equal mathfrackt normal harmon potenti _morsebond mors potenti bond stretch system requir anharmon bond stretch potenti mors potenti ref refmors two atom j avail gromac potenti differ harmon potenti asymmetr potenti well zero forc infinit distanc function form math displaystyl v_mors r_ij d_ij expbeta_ijr_ijb_ij label eqnmorsebond see also numreffig figmors correspond forc math beginarrayrcl displaystyl bf f_mors bf r_ij d_ij beta_ij expbeta_ijr_ijb_ij displaystyl expbeta_ijr_ijb_ij fracdisplaystyl bf r_ijdisplaystyl r_ij endarray label eqnmorsebondforc mathdisplaystyl d_ij depth well kjmol mathdisplaystyl beta_ij defin steep well nm math mathdisplaystyl b_ij equilibrium distanc nm steep paramet mathdisplaystyl beta_ij express term reduc mass atom j fundament vibrat frequenc mathdisplaystyleomega_ij well depth mathdisplaystyl d_ij math displaystyl beta_ij omega_ij sqrtfracmu_ij d_ij label eqnmorsefreq mathdisplaystyl omega sqrtkmu one rewrit mathdisplaystyl beta_ij term harmon forc constant mathdisplaystyl k_ij math displaystyl beta_ij sqrtfrack_ij d_ij label eqnbetaij small deviat mathdisplaystyl r_ijb_ij one approxim mathdisplaystyl expterm firstord use taylor expans math displaystyl expx approx x label eqnexpminx substitut eqeqn eqnbetaij eqeqn eqnexpminx function form math beginarrayrcl displaystyl v_mors r_ijd_ij expbeta_ijr_ijb_ij displaystyl d_ij sqrtfrack_ij d_ijr_ijb_ij displaystyl frac k_ij r_ijb_ij endarray label eqnharmfrommors recov harmon bond stretch potenti _figmors figur plotsfmors width cm mors potenti well bond length nm cubic bond stretch potenti anoth anharmon bond stretch potenti slightli simpler mors potenti add cubic term distanc simpl harmon form math v_br_ij kb_ijr_ijb_ij kb_ijkcub_ijr_ijb_ij label eqncubicbond flexibl water model base spc water model ref refberendsen includ cubic bond stretch potenti oh bond develop ferguson ref refferguson model found yield reason infrar spectrum ferguson water model avail gromac librari flexwatfergusonitp note potenti asymmetr overstretch lead infinit low energi integr timestep therefor limit fs forc correspond potenti math mathbff_imathbfr_ij kb_ijr_ijb_ijfracmathbfr_ijr_ij kb_ijkcub_ijr_ijb_ijfracmathbfr_ijr_ij label eqncubicbondforc fene bond stretch potenti coarsegrain polym simul bead often connect fene finit extens nonlinear elast potenti ref refwarn math v_mboxfener_ij frackb_ij b_ij logleft fracr_ijb_ijright label eqnfenebond potenti look complic express forc simpler math f_mboxfenemathbfr_ij kb_ij left fracr_ijb_ijright mathbfr_ij label eqnfenebondforc short distanc potenti asymptot goe harmon potenti forc constant mathkb diverg distanc mathb _harmonicangl harmon angl potenti bondangl vibrat triplet atom mathi mathj mathk also repres harmon potenti angl maththeta_ijk _figangl figur plotsangl width cm principl angl vibrat left bond angl potenti math v_atheta_ijk fracktheta_ijktheta_ijktheta_ijk label eqnharmangl bondangl vibrat repres harmon potenti form bond stretch numreffig figbstretch forc equat given chain rule math beginarrayl mathbff_i displaystylefracd v_atheta_ijkd mathbfr_i mathbff_k displaystylefracd v_atheta_ijkd mathbfr_k mathbff_j mathbff_imathbff_k endarray mbox theta_ijk arcco fracmathbfr_ij cdot mathbfr_kjr_ijr_kj label eqnharmangleforc number mathijk sequenc coval bond atom atom mathj middl atom mathi mathk end see numreffig figangl note input topolog file angl given degre forc constant kjmolrad math _gangl cosin base angl potenti gromo forc field simplifi function use repres angl vibrat math v_atheta_ijk fracktheta_ijkleftcostheta_ijk costheta_ijkright label eqngangl math costheta_ijk fracmathbfr_ijcdotmathbfr_kjr_ijr_kj label eqngangleco correspond forc deriv partial differenti respect atom posit forc constant function relat forc constant harmon form mathkthetamathrmharm refharmonicangl math ktheta sintheta_ijk kthetamathrmharm label eqnganglefc gromo manual much complic convers formula temperatur depend formula equival k differ k order note input topolog file angl given degre forc constant kjmol _reb restrict bend potenti restrict bend reb potenti ref refmonicagoga prevent bend angl maththeta reach mathcirc valu way numer instabl due calcul torsion angl potenti elimin perform coarsegrain molecular dynam simul systemat hinder bend angl reach mathcirc valu bend potenti eqeqn eqngangl divid mathsintheta factor math v_rm rebtheta_i frac k_theta fraccostheta_i costheta_sintheta_i label eqnreb numreffigur figreb show comparison reb potenti eq eqnreb standard one eq eqngangl _figreb figur plotsfig width cm bend angl potenti cosin harmon solid black line angl harmon dash black line restrict bend red bend constant mathk_theta kj mol math equilibrium angl maththeta_circ orang line repres sum cosin harmon mathk kj mol math restrict bend mathk kj mol math potenti maththeta_circ wall reb potenti repuls region close mathcirc result bend angl kept within safe interv far instabl power math mathsintheta_i denomin chosen guarante behavior allow eleg differenti math f_rm rebtheta_i frack_thetasintheta_icostheta_i costheta_ costheta_icostheta_ fracparti costheta_iparti vec r_k label eqdiffreb due construct restrict bend potenti use equilibrium maththeta_ valu close mathcirc mathcirc experi least mathcirc differ recommend import start configur bend angl safe interv avoid initi instabl bend potenti use combin form torsion potenti alway prevent three consecut particl becom collinear result torsion potenti remain free singular also ad standard bend potenti affect angl around mathcirc keep origin form around minimum see orang curv numreffig figreb ureybradley potenti ureybradley bondangl vibrat triplet atom mathi mathj mathk repres harmon potenti angl maththeta_ijk harmon correct term distanc atom mathi mathk although easili written simpl sum two term conveni singl entri topolog file output separ energi term use mainli charmm forc field ref refbbrook energi given math v_atheta_ijk fracktheta_ijktheta_ijktheta_ijk frackub_ijkr_ikr_ik label eqnubangl forc equat deduc section refharmonicbond refharmonicangl linear angl potenti linear angl potenti design especi linear compound nitril carbon dioxid ref refspoel avoid calcul angl per se sinc angl forc welldefin angl degre rather comput deviat central atom triplet ijk refer posit math mathbfx_j mathbfx_i mathbfx_k defin bondlength ij jk symmetr molecul carbon dioxid compound differ bond length mathb_ij mathb_jk respectivey instead math fracb_jkb_ijb_jk order atom chang kji need replac energi given math v_lin frack_linleftmathbfx_j mathbfx_jright mathk_lin forc constant exampl deriv forc energi function see ref ref refspoel bondbond cross term bondbond cross term three particl mathi j k form bond mathij mathkj given ref reflawrenceb math v_rr k_rr leftleftmathbfr_imathbfr_jrightr_eright leftleftmathbfr_kmathbfr_jrightr_eright label eqncrossbb mathk_rr forc constant mathr_ mathr_ equilibrium bond length mathij mathkj bond respect forc associ potenti particl mathi math mathbff_i k_rrleftleftmathbfr_kmathbfr_jrightr_erightfracmathbfr_imathbfr_jleftmathbfr_imathbfr_jright label eqncrossbbforc forc atom mathk obtain swap mathi mathk equat final forc atom mathj follow fact sum intern forc zero mathmathbff_j mathbff_imathbff_k bondangl cross term bondangl cross term three particl mathi j k form bond mathij mathkj given ref reflawrenceb math v_rtheta k_rtheta leftleftmathbfr_imathbfr_krightr_ right leftleftmathbfr_imathbfr_jrightr_ leftmathbfr_kmathbfr_jrightr_eright label eqncrossba mathk_rtheta forc constant mathr_ mathik distanc constant eqequ eqncrossbb forc associ potenti atom mathi math mathbff_i k_rtheta left left left mathbfr_i mathbfr_kright r_eright frac mathbfr_imathbfr_j left mathbfr_imathbfr_jright left left mathbfr_imathbfr_jright r_e left mathbfr_kmathbfr_jright r_eright frac mathbfr_imathbfr_k left mathbfr_imathbfr_kright right label eqncrossbaforc quartic angl potenti special purpos angl potenti use fourth order polynomi math v_qtheta_ijk sum_n c_n theta_ijktheta_ijkn label eqnquarticangl _imp improp dihedr improp dihedr meant keep planar group eg aromat ring planar prevent molecul flip mirror imag see numreffig figimp _figimp figur plotsringimp width cm principl improp dihedr angl plane bend ring improp dihedr angl mathxi defin angl plane ijk jkl figur plotssubstim width cm figur plotstetraim width cm principl improp dihedr angl tetrahedr angl improp dihedr angl mathxi defin angl plane ijk jkl improp dihedr harmon type simplest improp dihedr potenti harmon potenti plot numreffig figimp math v_idxi_ijkl frack_xixi_ijklxi_ label eqnharmimpdihedr sinc potenti harmon discontinu sinc discontinu chosen mathcirc distanc mathxi_ never caus problem note input topolog file angl given degre forc constant kjmolrad math _figimp figur plotsfimp width cm improp dihedr potenti improp dihedr period type potenti ident period proper dihedr see separ dihedr type type abl distinguish improp proper dihedr paramet section output proper dihedr normal dihedr interact choic either gromo period function function base expans power mathco phi socal ryckaertbelleman potenti choic consequ inclus special interact first fourth atom dihedr quadrupl period gromo potenti special ljinteract must includ ryckaertbelleman potenti alkan interact must exclud nonbond list note ryckaertbelleman potenti also use eg opl forc field combin interact therefor modifi topolog gener refpdbgmx gmx pdbgmx case proper dihedr period type proper dihedr angl defin accord iupaciub convent mathphi angl mathijk mathjkl plane zero correspond ci configur mathi mathl side two dihedr function type gromac topolog file standard type behav like bond interact certain forc field type use type allow multipl potenti function appli automat singl dihedr dihedr section multipl paramet defin atomtyp dihedraltyp section _figpdihf figur plotsfdih width cm principl proper dihedr angl left tran form dihedr angl potenti right math v_dphi_ijkl k_phi cosn phi phi_ label eqnperiodicpropdihedr proper dihedr ryckaertbelleman function alkan follow proper dihedr potenti often use see numreffig figrbdih math v_rbphi_ijkl sum_n c_n cospsi n label eqnrbproperdihedr mathpsi phi circ note convers one convent anoth achiev multipli everi coeffici mathdisplaystyl c_n mathdisplaystyl n exampl constant mathc given numreft tabcrb _tabcrb tabl constant ryckaertbelleman potenti mathmathrmkj mol width auto align center mathc_ mathc_ mathc_ mathc_ mathc_ mathc_ _figrbdih figur plotsfrb width cm ryckaertbelleman dihedr potenti note use potenti impli exclus lj interact first last atom dihedr mathpsi defin accord polym convent mathpsi_tran rb dihedr function also use includ fourier dihedr see math v_rb phi_ijkl frac leftf_cosphi f_ cosphi f_cosphi f_cosphiright label eqnrbproperdihedralfouri equal mathcosphi cosphi mathcosphi cosphi cosphi mathcosphi cosphi cosphi one translat opl paramet ryckaertbelleman paramet follow math displaystyl beginarrayrcl displaystyl c_f_ frac f_ f_ displaystyl c_frac f_ f_ displaystyl c_ f_ f_ displaystyl c_ f_ displaystyl c_ f_ displaystyl c_ endarray label eqnoplsrbconvers opl paramet protein convent rb paramet polym convent yield minu sign odd power co mathphi note mind convers kcal mol math literatur opl rb paramet kj mol math gromac proper dihedr fourier function opl potenti function given first three ref refjorgensen four ref refrobertsona cosin term fourier seri gromac four term function implement math v_f phi_ijkl frac leftc_cosphi c_ cosphi c_cosphi c_cosphiright label eqnfourierproperdihedr intern gromac use ryckaertbelleman code comput fourier dihedr see effici note mind convers k cal mol math literatur opl paramet kj mol math gromac proper dihedr restrict torsion potenti manner similar restrict bend potenti see refreb restrict torsiondihedr potenti introduc math v_rm retphi_i frac k_phi fraccosphi_i cosphi_sinphi_i label eqnret advantag function mathcosphi problem take deriv mathsinphi keep torsion angl one minimum valu case factor mathsinphi allow dihedr angl move mathcirc mathcirc interv ie maxima mathphi_ mathphi_ maxima one reason dihedr angl start configur valu desir angl interv equilibrium mathphi_ valu close interv limit restrict bend potenti describ refreb least mathcirc differ recommend proper dihedr combin bendingtors potenti four particl form dihedr angl becom collinear situat never happen atomist simul occur coarsegrain simul calcul torsion angl potenti lead numer instabl one way avoid use restrict bend potenti see refreb prevent dihedr reach mathcirc valu anoth way disregard effect dihedr becom illdefin keep dihedr forc potenti calcul continu entir angl rang coupl torsion potenti cosin form bend potenti adjac bend angl uniqu express math v_rm cbttheta_i theta_i phi_i k_phi sintheta_i sintheta_i sum_n a_n cosnphi_i label eqncbt combin bendingtors cbt potenti propos ref refbulacugiessen polym melt simul extens describ ref refmonicagoga potenti two main advantag depend dihedr angl mathphi_i mathi mathi mathi mathi bead also bend angl maththeta_i maththeta_i defin three adjac bead mathi mathi mathi mathi mathi mathi respect two mathsintheta prefactor tent suggest ref refscottscherag theoret discuss ref refpaulingbond cancel torsion potenti forc either two bend angl approach valu mathcirc depend mathphi_i express polynomi mathcosphi_i avoid singular mathphicirc mathcirc calcul torsion forc two properti make cbt potenti wellbehav md simul weak constraint bend angl even steer nonequilibrium md bend torsion angl suffer major modif use cbt potenti bend potenti adjac maththeta_i maththeta_i may form also possibl leav two angl bend term maththeta_i maththeta_i complet numreffig figcbt illustr differ torsion potenti without mathsintheta factor blue gray curv respect _figcbt figur plotsfig width cm blue surfac plot combin bendingtors potenti eq eqncbt mathk kj mol math matha_ matha_ matha_ matha_ simplic bend angl behav maththeta_theta_theta gray torsion potenti without mathsintheta term ryckaertbelleman type mathphi dihedr angl addit deriv mathv_cbt respect cartesian variabl straightforward math fracparti v_rm cbttheta_itheta_iphi_i partial vec r_l fracparti v_rm cbtpartial theta_i fracparti theta_iparti vec r_l fracparti v_rm cbtpartial theta_i fracparti theta_i partial vec r_l fracparti v_rm cbtpartial phi_i fracparti phi_i partial vec r_l label eqnforcecbt cbt base cosin form without multipl symmetr around mathcirc obtain asymmetr dihedr angl distribut eg one maximum mathcircmathcirc interv standard torsion potenti harmon angl period cosin potenti use instead cbt potenti howev two form inconveni forc deriv mathsinphi align bead maththeta_i maththeta_i circ circ coupl non mathcosphi potenti mathsintheta factor improv simul stabil sinc case maththeta mathphi simultan mathcirc integr step would possibl due cancel torsion potenti next step would singular maththeta mathcirc mathphi close mathcirc tabul bond interact function full flexibl function shape use bond angl dihedr usersuppli tabul function function shape math beginalign v_br_ij k fb_nr_ij v_atheta_ijk k fa_ntheta_ijk v_dphi_ijkl k fd_nphi_ijklendalign label eqntabuatedbond mathk forc constant unit energi mathf cubic spline function detail see refcubicsplin interact forc constant mathk tabl number mathn specifi topolog two differ type bond one gener exclus type one type detail see numreft tabtopfil tabl file suppli refmdrun gmx mdrun program tabl file name underscor letter b bond angl dihedr tabl number must append exampl tabul bond mathn read file table_bxvg multipl tabl suppli simpli ad file differ valu mathn appli appropri bond specifi topolog numreft tabtopfil format tabl file three fixedformat column suitabl width column must contain mathx mathfx mathfx valu mathx uniformli space requir entri topolog given numreft tabtopfil setup tabl follow bond mathx distanc nm distanc beyond tabl length refmdrun gmx mdrun quit error messag angl mathx angl degre tabl go includ degre deriv taken degre dihedr mathx dihedr angl degre tabl go includ degre iupaciub convent use ie zero ci deriv taken degre forc field forc field built two distinct compon set equat call potenti function use gener potenti energi deriv forc describ detail previou chapter paramet use set equat given manual data file correspond gromac distribut within one set equat variou set paramet use care must taken combin equat paramet form consist set gener danger make ad hoc chang subset paramet variou contribut total forc usual interdepend mean principl everi chang document verifi comparison experiment data publish peerreview journal use gromac version includ sever forc field addit one avail websit know one select recommend gromo unitedatom setup oplsaal allatom paramet said describ avail option detail allhydrogen forc field gromosbas allhydrogen forc field almost ident normal gromo forc field sinc extra hydrogen lennardjon interact zero charg differ bond angl improp dihedr angl term forc field use need exact hydrogen posit instanc distanc restraint deriv nmr measur cite forc field pleas read previou paragraph gromo gromac support gromo forc field ref refgromo paramet develop improv alkan dihedr paramet set includ standard build block includ topolog built automat refpdbgmx gmx pdbgmx gromo forc field develop gromo forc field improv gromo forc field protein small molecul note sugar paramet present correspond publish ref refoostenbrink differ present includ gromac time paramet set correspond later revis paramet gromo forc field howev recommend use long alkan lipid gromo forc field differ gromo forc field respect forc field paramet paramet bond interact link atom type fourth power bond stretch potenti refgbond angl potenti base cosin angl refgangl two differ implement gromac gromo lead slightli differ result simul system packag gromo neighbor search solvent perform first atom solvent molecul implement gromac differ search center charg group small virial gromo moleculebas implement gromac use atom virial gromo forc field parameter lennardjon cutoff nm sure use lennardjon cutoff rvdw least larger cutoff possibl lennardjon potenti forc almost zero beyond nm gromo file gromac read write gromo coordin trajectori file file extens refg file gromo initialfin configur file coordin trajectori file combin file fix format float written file get huge gromac support follow data block given order header block titl mandatori frame block timestep option positionpositionr mandatori velocityvelocityr option box option see gromo manual ref refgromo complet descript block note gromac program read compress z gzip gz file oplsaa amber gromac provid nativ support follow amber forc field amber ref refcornel amber ref refkollman amber ref refwang ambersb ref refhornak ambersbildn ref reflindorff amber ref refduan amberg ref refgarcia _charmmff charmm gromac support charmm forc field protein ref refmackerel ref refmackerel lipid ref reffel nucleic acid ref reffolopp ref refmac protein paramet extent lipid nucleic acid paramet thoroughli test compar potenti energi port standard paramet set charmm molecular simul packag well protein forc field behav togeth gromacsspecif techniqu virtual site enabl long time step recent implement ref reflarsson detail result present paper bjelkmar et al ref refbjelkmar nucleic acid paramet well one heme convert test michel cuendet select charmm forc field refpdbgmx gmx pdbgmx default option use cmap torsion correct map exclud cmap use nocmap basic form cmap term implement gromac function mathphi mathpsi backbon torsion angl term defin rtp file cmap statement end residu support cmap follow five atom name defin two torsion angl atom defin mathphi atom defin mathpsi correspond atom type match correct cmap type cmapitp file contain correct map port charmm forc field use gromac also avail mackerel lab webpag httpmackerellumarylandeducharmm_ffshtmlgromacs_ branch polym topolog support refpdbgmx gmx pdbgmx possibl use topotool ref refkohlmey gener gromac top file _cgforcefield coarsegrain forc field coarsegrain systemat way reduc number degre freedom repres system interest achiev typic whole group atom repres singl bead coarsegrain forc field describ effect interact depend choic parameter function form interact complic often tabul potenti use coarsegrain model design reproduc certain properti refer system either full atomist model even experiment data depend properti reproduc differ method deriv forc field incomplet list method given conserv free energi simplex method martini forc field see next section conserv distribut like radial distribut function socal structurebas coarsegrain iter boltzmann invers invers mont carlo convers forc forc match note coarsegrain potenti state depend eg temperatur densiti reparametr depend system interest simul condit exampl done use versatil objectori toolkit coarsegrain applic votca packag design assist systemat coarsegrain provid implement algorithm mention well test interfac gromac avail open sourc inform found wwwvotcaorg httpwwwvotcaorg_ martini martini forc field coarsegrain paramet set allow construct mani system includ protein membran plum plum forc field ref refbereau exampl solventfre proteinmembran model membran deriv structurebas coarsegrain ref refwang_jpcb gromac implement found codegooglecompplumx httpcodegooglecompplumx__ restraint special potenti use impos restraint motion system either avoid disastr deviat includ knowledg experiment data either case realli part forc field reliabl paramet import potenti form implement gromac mention sake complet restraint constraint refer quit differ algorithm gromac _positionrestraint posit restraint use restrain particl fix refer posit mathmathbfr_i use equilibr order avoid drastic rearrang critic part eg restrain motion protein subject larg solvent forc solvent yet equilibr anoth applic restrain particl shell around region simul detail shell approxim lack proper interact miss particl outsid shell restrain maintain integr inner part spheric shell wise procedur make forc constant depend radiu increas zero inner boundari larg valu outer boundari featur howev implement gromac follow form use math v_prmathbfr_i frack_prmathbfr_imathbfr_i label eqnposrestform potenti plot numreffig figpositionrestraint _figpositionrestraint figur plotsfpr width cm posit restraint potenti potenti form rewritten without loss gener math v_prmathbfr_i frac left k_prx x_ix_i hatbf x k_pri y_iy_i hatbf k_prz z_iz_i hatbf zright label eqnposrestgener forc math beginarrayrcl f_ix k_prxx_i x_i f_iy k_pryy_i y_i f_iz k_przz_i z_i endarray label eqnposrestforc use three differ forc constant posit restraint turn spatial dimens mean atom harmon restrain plane line posit restraint appli special fix list atom list usual gener refpdbgmx gmx pdbgmx program _referencemanualpositionrestraint note posit restraint make potenti depend absolut coordin space therefor gener pressur virial well defin pressur deriv freeenergi system respect volum refer coordin scale along system select mdp option mdpvaluerefcoordscalingal pressur virial well defin flatbottom posit restraint flatbottom posit restraint use restrain particl part simul volum forc act restrain particl within flatbottom region potenti howev harmon forc act move particl flatbottom region outsid possibl appli normal flatbottom posit restraint particl howev refer posit mathmathbfr_i follow gener potenti use numreffigur figfbposr math v_mathrmfbmathbfr_i frack_mathrmfb d_gmathbfr_imathbfr_i r_mathrmfbhd_gmathbfr_imathbfr_i r_mathrmfb label eqnflatbottomposrest mathmathbfr_i refer posit mathr_mathrmfb distanc center flat potenti mathk_mathrmfb forc constant mathh heavisid step function distanc mathd_gmathbfr_imathbfr_i refer posit depend geometri mathg flatbottom potenti _figfbposr figur plotsfbposr width cm flatbottom posit restraint potenti invert b invert follow geometri flatbottom potenti support sphere mathg particl kept sphere given radiu forc act toward center sphere follow distanc calcul use math d_gmathbfr_imathbfr_i mathbfr_imathbfr_i label eqnfbsphereposrest cylind mathg particl kept cylind given radiu parallel mathx mathg mathi mathg mathzaxi mathg backward compat set mathg map mathg code old reftpr file topolog work forc flatbottom potenti act toward axi cylind compon forc parallel cylind axi zero cylind align along mathzaxi math d_gmathbfr_imathbfr_i sqrt x_ix_i y_i y_i label eqnfbcylinderposrest layer mathg particl kept layer defin thick normal layer layer normal parallel mathx mathi mathzaxi forc act parallel layer normal math d_gmathbfr_imathbfr_i x_ix_i mboxor d_gmathbfr_imathbfr_i y_iy_i mboxor d_gmathbfr_imathbfr_i z_iz_i label eqnfblayerposrest possibl appli multipl independ flatbottom posit restraint differ geometri one particl exampl appli cylind layer mathz keep particl within disk appli three layer mathx mathi mathz keep particl within cuboid addit possibl invert restrain region unrestrain region lead potenti act keep particl outsid volum defin mathmathbfr_i mathg mathr_mathrmfb featur switch defin neg mathr_mathrmfb topolog follow potenti use numreffigur figfbposr b math v_mathrmfbmathrminvmathbfr_i frack_mathrmfb d_gmathbfr_imathbfr_i r_mathrmfb h d_gmathbfr_imathbfr_i r_mathrmfb label eqninvertrest angl restraint use restrain angl two pair particl one pair particl mathzaxi function form similar proper dihedr two pair atom math v_armathbfr_imathbfr_jmathbfr_kmathbfr_l k_ar cosn theta theta_ mboxwher theta arccosleftfracmathbfr_j mathbfr_imathbfr_j mathbfr_i cdot fracmathbfr_l mathbfr_kmathbfr_l mathbfr_k right label eqnanglerest one pair atom mathzaxi math v_armathbfr_imathbfr_j k_ar cosn theta theta_ mboxwher theta arccosleftfracmathbfr_j mathbfr_imathbfr_j mathbfr_i cdot left beginarrayc endarray right right label eqnanglerestzaxi multipl mathn use want distinguish parallel antiparallel vector equilibrium angl maththeta degre multipl degre multipl _dihedralrestraint dihedr restraint use restrain dihedr angl mathphi defin four particl improp dihedr sec refimp slightli modifi potenti use math phi leftphiphi_right rm mod pi label eqndphi mathphi_ refer angl potenti defin math v_dihrphi left beginarraylclll frack_dihrphideltaphi mboxfor phi deltaphi ex mboxfor phi le deltaphi ex endarrayright label eqndihr mathdeltaphi user defin angl mathk_dihr forc constant note input topolog file angl given degre forc constant kjmolrad math _distancerestraint distanc restraint distanc restraint add penalti potenti distanc specifi pair atom exce threshold valu normal use impos experiment restraint instanc experi nuclear magnet reson nmr motion system thu md use structur refin use nmr data gromac three way impos restraint pair atom simpl harmon restraint use bond type see sec refexcl piecewis linearharmon restraint bond type complex nmr distanc restraint option pair time andor ensembl averag last two option detail potenti form distanc restraint quadrat specifi lower bound two specifi upper bound linear beyond largest bound see numreffig figdist math v_drr_ij left beginarraylclllll frack_drr_ijr_ mboxfor r_ij r_ ex mboxfor r_ le r_ij r_ ex frack_drr_ijr_ mboxfor r_ le r_ij r_ ex frack_drr_r_r_ijr_r_ mboxfor r_ le r_ij endarrayright label eqndisr _figdist figur plotsfdr width cm distanc restraint potenti forc math mathbff_i left beginarraylclllll k_drr_ijr_fracmathbfr_ijr_ij mboxfor r_ij r_ ex mboxfor r_ le r_ij r_ ex k_drr_ijr_fracmathbfr_ijr_ij mboxfor r_ le r_ij r_ ex k_drr_r_fracmathbfr_ijr_ij mboxfor r_ le r_ij endarray right label eqndisreforc restraint deriv nmr data function usual suffic section bond type use appli individu restraint pair atom see reftopfil appli restraint deriv nmr measur complex function might requir provid distance_restraint section describ time averag distanc restraint base instantan distanc potenti reduc fluctuat molecul significantli problem overcom restrain time averag distanc ref reftorda forc time averag math mathbff_i left beginarraylclllll ka_drbarr_ijr_fracmathbfr_ijr_ij mboxfor barr_ij r_ ex mboxfor r_ le barr_ij r_ ex ka_drbarr_ijr_fracmathbfr_ijr_ij mboxfor r_ le barr_ij r_ ex ka_drr_r_fracmathbfr_ijr_ij mboxfor r_ le barr_ij endarray right label eqntimeaveragerest mathbarr_ij given exponenti run averag decay time mathtau math barr_ij r_ij label eqnrav forc constant mathka_dr switch slowli compens lack histori begin simul math ka_dr k_dr leftexpleftfracttaurightright label eqnforceconstantswitch time averag longer speak distanc restraint potenti way atom satisfi two incompat distanc restraint averag move two posit exampl would amino acid sidechain rotat around mathchi dihedr angl therebi come close variou group mobil side chain give rise multipl noe fulfil singl structur comput time averag distanc refmdrun gmx mdrun program done follow fashion math beginarrayrcl overliner_ij r_ij overliner_ijt overliner_ijtdelta texpleftfracdelta ttauright r_ijtleftexpleftfracdelta ttaurightright endarray label eqnravdisr pair within bound still feel forc time averag distanc still beyond bound prevent proton pull close togeth mix approach use approach penalti zero instantan distanc within bound otherwis violat squar root product instantan violat time averag violat math mathbff_i left beginarraylcll ka_drsqrtr_ijr_barr_ijr_fracmathbfr_ijr_ij mboxfor r_ij r_ mboxand barr_ij r_ ex ka _dr mboxminleftsqrtr_ijr_barr_ijr_r_r_right fracmathbfr_ijr_ij mboxfor r_ij r_ mboxand barr_ij r_ ex mboxotherwis endarray right label eqntimeaverageviol averag multipl pair sometim unclear experiment data atom pair give rise singl noe occas obviou one pair contribut due symmetri system eg methyl group three proton group possibl distinguish proton therefor taken account calcul distanc methyl group anoth proton group proton due physic natur magnet reson intens noe signal invers proport sixth power interatom distanc thu combin atom pair fix list mathn restraint may taken togeth appar distanc given math r_nt left sum_nn barr_nt right label eqnrsix use mathr_ij eqeqn eqnrav mathbarr_n mathr_n instantan timeaverag distanc combin mix restrain indic pair proton contribut noe signal intens increas sum distanc shorter compon due reciproc summat two option distribut forc atom pair conserv option forc defin deriv restraint potenti respect coordin result conserv potenti time averag use forc distribut pair proport mathr mean close pair feel much larger forc distant pair might lead molecul rigid option equal forc distribut case pair feel mathn deriv restraint potenti respect mathr_n advantag method conform might sampl nonconserv natur forc lead local heat proton also possibl use ensembl averag use multipl protein molecul case bound lower math beginarrayrcl r_ r_ r_ r_ endarray label eqnrestforceensembleaverag mathm number molecul gromac preprocessor refgrompp gmx grompp automat appropri option given result distanc use calcul scalar forc accord math mathbff_ileft beginarrayrcl hspacecm r_n r_ k_drr_nr_fracmathbfr_ijr_ij r_ le r_n r_ k_drr_r_fracmathbfr_ijr_ij r_n ge r_ endarray right label eqnrestscalarforc mathi mathj denot atom pair contribut noe signal use distanc restraint list distanc restrain base noe data ad molecul definit topolog file like follow exampl distance_restraint ai aj type index type low fac exampl number featur found column ai aj find atom number particl restrain type column alway explain refdistancerestraint multipl distanc contribut singl noe signal topolog set use index column exampl restraint index therefor treat simultan extra requir treat restraint togeth restraint must success line without interven restraint type column usual set obtain distanc restraint never time ensembleaverag use restrain hydrogen bond column low hold valu mathr_ mathr_ mathr_ eqeqn eqndisr case use differ forc constant restraint control column fac forc constant paramet file multipli valu column fac restraint inform restraint store energi file process plot refgmx nmr orient restraint section describ orient vector measur certain nmr experi calcul restrain md simul present refin methodolog comparison result without time ensembl averag publish ref refhess theori nmr experi orient vector measur molecul tumbl complet isotrop solvent two exampl orient measur residu dipolar coupl two nuclei chemic shift anisotropi observ vector mathmathbfr_i written follow math delta_i frac mboxtrmathbf smathbf d_i label eqnorrestvector mathmathbf dimensionless order tensor molecul tensor mathmathbf d_i given math mathbf d_i fracc_imathbfr_ialpha left beginarrayll x x x x z x z x z z z z endarray right label eqnorientdef math mboxwith quad xfracr_ixmathbfr_i quad yfracr_iymathbfr_i quad zfracr_izmathbfr_i label eqnorientdef dipolar coupl mathmathbfr_i vector connect two nuclei mathalpha constant mathc_i given math c_i fracmu_pi gamma_i gamma_i frachbarpi label eqnorrestconst mathgamma_i mathgamma_i gyromagnet ratio two nuclei order tensor symmetr trace zero use rotat matrix mathmathbf transform follow form math mathbf tt mathbf smathbf left beginarrayccc fraceta fraceta endarray right label eqnorresttensor math leq leq math leq eta leq math call order paramet matheta asymmetri order tensor mathmathbf molecul tumbl isotrop solvent math zero orient effect observ mathdelta_i zero calcul orient simul reason explain mathmathbf matric calcul respect refer orient molecul orient defin rotat matrix mathmathbf r need leastsquar fit current coordin select set atom onto refer conform refer conform start conform simul case ensembl averag treat later structur taken first subsystem calcul mathmathbf d_ic matrix given math mathbf d_ict mathbf rt mathbf d_it mathbf rtt label eqndrot calcul orient vector mathi given math deltac_it frac mboxtrmathbf stmathbf d_ict label eqndrotvector order tensor mathmathbf st usual unknown reason choic order tensor tensor minim weight mean squar differ calcul observ orient math msdt leftsum_in w_iright sum_in w_i delta_ delta_iexp label eqnsmsd properli combin differ type measur unit mathw_i term dimensionless mean unit mathw_i unit mathdelta_i power math note scale mathw_i constant factor influenc order tensor time averag sinc tensor mathmathbf d_i fluctuat rapidli time much faster observ experi averag time simul howev simul time number copi molecul limit usual one obtain converg averag mathmathbf d_i tensor orient molecul one assum averag orient mathmathbfr_i vector within molecul converg much faster tumbl time molecul tensor averag axi system rotat molecul express eqequ eqndrot timeaverag tensor calcul use exponenti decay memori function math mathbf da_it fracdisplaystyl int_ut_t mathbf dc_iu expleftfractutaurightmboxd u displaystyl int_ut_t expleftfractutaurightmboxd u label eqnorresttimeaverag assum order tensor mathmathbf fluctuat slower mathmathbf d_i timeaverag orient calcul math delta_iat frac mboxtrmathbf st mathbf d_iat label eqnorresttimeaveori order tensor mathmathbf st calcul use express eq eqnsmsd mathdelta_ict replac mathdelta_iat restrain simul structur restrain appli forc proport differ calcul experiment orient time averag appli proper potenti defin math v frac k sum_in w_i delta_ delta_iexp label eqnorrestsimrest unit mathk unit energi thu effect forc constant restraint mathi mathk w_i forc given minu gradient mathv forc mathmathbff_i work vector mathmathbfr_i math beginalign mathbff_it fracmboxd vmboxdmathbfr_i k w_i delta_ delta_iexp fracmboxd delta_i tmboxdmathbfr_i k w_i delta_ delta_iexp frac c_imathbfralpha left mathbf rt mathbf smathbf rmathbfr_i fracalphamathbfr mboxtrmathbf rt mathbf smathbf rmathbfr_i mathbfr_it mathbfr_i rightendalign label eqnorrestsimrestforc ensembl averag ensembl averag appli simul system mathm subsystem contain ident set orient restraint system interact via orient restraint potenti defin math v frac k sum_in w_i langl delta_ delta_iexp rangl label eqnorrestensembleav forc vector mathmathbfr_im subsystem mathm given math mathbff_imt fracmboxd vmboxdmathbfr_im k w_i langl delta_ delta_iexp rangl fracmboxd delta_imc tmboxdmathbfr_im label eqnorrestensaveforc time averag use time averag possibl defin potenti still defin quantiti give rough idea energi store restraint math v frac ka sum_in w_i langl delta_ia delta_iexp rangl label eqntimeavepot forc constant mathk_a switch slowli compens lack histori time close matht_ exactli proport amount averag accumul math ka k fractauint_ut_t expleftfractutaurightmboxd u label eqntimeaveforceswitch realli matter definit forc chosen proport squar root product timeaverag instantan deviat use timeaverag deviat induc larg oscil forc given math mathbff_imt left beginarrayl quad mboxfor quad b leq displaystyl ka w_i fracaa sqrta b fracmboxd delta_imc tmboxdmathbfr_im quad mboxfor quad b endarray right label eqntimeaveforc math beginalign langl delta_ia delta_iexp rangl b langl delta_ delta_iexp rangleendalign label eqntimeaveforc use orient restraint orient restraint ad molecul definit topolog file section orientation_restraint give exampl section contain five nh residu dipolar coupl restraint orientation_restraint ai aj type exp label alpha const ob weight hz nm hz hz unit observ hz one choos unit column ai aj find atom number particl restrain type column alway exp column denot experi number start experi separ order tensor mathmathbf optim label uniqu number larger zero restraint alpha column contain power mathalpha use eqequ eqnorientdef calcul orient const column contain constant mathc_i use equat constant unit observ time nm mathalpha column ob contain observ unit like last column contain weight mathw_i unit invers squar unit observ paramet orient restraint specifi refgrompp gmx grompp refmdp file studi effect differ forc constant averag time ensembl averag see ref refhess inform restraint store energi file process plot refgmx nmr raw latex clearpag nonbond interact nonbond interact gromac pairaddit math vmathbfr_ldot mathbfr_n sum_ijv_ijmathbfr_ij label eqnnbinteract math mathbff_i sum_j fracdv_ijr_ijdr_ij fracmathbfr_ijr_ij label eqnnbinteract sinc potenti depend scalar distanc interact centrosymmetr ie vectori partial forc particl mathi pairwis interact mathv_ijr_ij opposit direct partial forc particl mathj effici reason interact calcul loop interact updat partial forc rather sum one complet nonbond forc time nonbond interact contain repuls term dispers term coulomb term repuls dispers term combin either lennardjon interact buckingham exp potenti addit partial charg atom act coulomb term _lj lennardjon interact lennardjon potenti mathv_lj two atom equal math v_ljr_ij fracc_ijr_ij fracc_ijr_ij label eqnnblj see also numreffig figlj paramet mathc_ij mathc_ij depend pair atom type consequ taken matrix ljparamet verlet cutoff scheme potenti shift constant zero cutoff distanc _figlj figur plotsflj width cm lennardjon interact forc deriv potenti math mathbff_imathbfr_ij left fracc_ijr_ij fracc_ijr_ij right fracmathbfr_ijr_ij label eqnljforc lj potenti may also written follow form math v_ljmathbfr_ij epsilon_ijleftleftfracsigma_ij r_ijright leftfracsigma_ijr_ijright right label eqnsigep construct paramet matrix nonbond ljparamet two type combin rule use within gromac geometr averag type input section forcefield file math beginarrayrcl c_ij leftc_ii c_jjright c_ij leftc_ii c_jjright endarray label eqncomb altern lorentzberthelot rule use arithmet averag use calcul mathsigma_ij geometr averag use calcul mathepsilon_ij type math beginarrayrcl sigma_ij frac sigma_ii sigma_jj epsilon_ij leftepsilon_ii epsilon_jjright endarray label eqnlorentzberthelot final geometr averag paramet use type math beginarrayrcl sigma_ij leftsigma_ii sigma_jjright epsilon_ij leftepsilon_ii epsilon_jjright endarray label eqnnbgeometricaverag last rule use opl forc field buckingham potenti buckingham potenti flexibl realist repuls term lennardjon interact also expens comput potenti form math v_bhr_ij a_ij expb_ij r_ij fracc_ijr_ij label eqnnbbuckingham _figbham figur plotsfbham width cm buckingham interact see also numreffig figbham forc deriv math mathbff_ir_ij left a_ijb_ijexpb_ij r_ij fracc_ijr_ij right fracmathbfr_ijr_ij label eqnnbbuckinghamforc _coul coulomb interact coulomb interact two charg particl given math v_cr_ij f fracq_i q_jvarepsilon_rr_ij label eqnvcoul see also numreffig figcoul mathf fracpi varepsilon_ see chapter refdefunit _figcoul figur plotsvcrf width cm coulomb interact particl equal sign charg without reaction field latter case mathvarepsilon_r mathvarepsilon_rf mathr_c nm dotdash line dash line except constant forc deriv potenti math mathbff_imathbfr_ij f fracq_i q_jvarepsilon_rr_ijfracmathbfr_ijr_ij label eqnfcoul plain coulomb interact use without cutoff pair fall within cutoff sinc abrupt larg chang forc cutoff case want use cutoff potenti shift constant make potenti integr forc group cutoff scheme shift appli nonexclud pair verlet cutoff scheme shift also appli exclud pair self interact make potenti equival reaction field mathvarepsilon_rf see gromac rel dielectr constant mathvarepsilon_r may set input refgrompp gmx grompp _coulrf coulomb interact reaction field coulomb interact modifi homogen system assum constant dielectr environ beyond cutoff mathr_c dielectr constant mathvarepsilon_rf interact read math v_crf f fracq_i q_jvarepsilon_rr_ijleftfracvarepsilon_rfvarepsilon_rvarepsilon_rfvarepsilon_r fracr_ijr_cright ffracq_i q_jvarepsilon_rr_cfracvarepsilon_rfvarepsilon_rfvarepsilon_r label eqnvcrf constant express right make potenti zero cutoff mathr_c charg cutoff sphere correspond neutral homogen background charg rewrit eqeqn eqnvcrf simplic math v_crf f fracq_i q_jvarepsilon_rleftfracr_ij k_rf r_ij c_rfright label eqnvcrfrewrit math beginalign k_rf fracr_cfracvarepsilon_rfvarepsilon_rvarepsilon_rfvarepsilon_r endalign label eqnkrf math beginalign c_rf fracr_ck_rfr_c fracr_cfracvarepsilon_rfvarepsilon_rfvarepsilon_r endalign label eqncrf larg mathvarepsilon_rf mathk_rf goe mathr_c mathvarepsilon_rf mathvarepsilon_r correct vanish numreffig figcoul modifi interact plot clear deriv respect mathr_ij forc goe zero cutoff distanc forc deriv potenti read math mathbff_imathbfr_ij f fracq_i q_jvarepsilon_rleftfracr_ij k_rfr_ijrightfracmathbfr_ijr_ij label eqnfcrf reactionfield correct also appli exclud atom pair includ self pair case normal coulomb term eqeqn eqnvcrf eq eqnfcrf absent _modnbint modifi nonbond interact gromac nonbond potenti modifi shift function also call forceswitch function sinc switch forc zero cutoff purpos replac truncat forc forc continu continu deriv cutoff radiu forc time integr produc smaller error note lennardjon interact error usual smaller error integr error repuls part potenti coulomb interact advis use shift potenti use reaction field proper longrang method pme fundament differ switch function multipli potenti function shift function add function forc potenti ref refspoela switch function special case shift function appli forc function mathfr relat electrostat van der waal forc act particl mathi particl mathj math mathbff_i c fr_ij fracmathbfr_ijr_ij label eqnswitch pure coulomb lennardjon interact mathfr f_alphar alpha ralpha switch forc mathf_sr gener written math beginarrayrcl f_srf_alphar r r_ f_srf_alpharsr r_ le r r_c f_sr r_c le r endarray label eqnswitchforc mathr_ tradit shift function otherwis act switch function correspond shift potenti function read math v_sr intinfty_rf_sx dx label eqnswitchpotenti gromac forc switch function maths_fr smooth boundari therefor follow boundari condit impos switch function math beginarrayrcl s_fr_ s_fr_ s_fr_c f_alphar_c s_fr_c f_alphar_c endarray label eqnswitchforcefunct mathrd degre polynomi form math s_fr arr_ brr_ label eqnswitchforcepoli fulfil requir constant b given boundari condit mathr_c math beginarrayrcl alpha displaystyl fracalphar_calphar_ r_calphar_cr_ b alpha displaystyl fracalphar_calphar_r_calphar_cr_ endarray label eqnforceswitchboundari thu total forc function math f_sr fracalpharalpha arr_ brr_ label eqnswitchfinalforc potenti function read math v_sr fracralpha fraca rr_ fracb rr_ c label eqnswitchfinalpotenti math c fracr_calpha fraca r_cr_ fracb r_cr_ label eqnswitchpotentialexp gromac potentialswitch function maths_vr scale potenti mathr_ mathr_c similar boundari condit intend produc smoothlyvari potenti forc math beginarrayrcl s_vr_ s_vr_ s_vr_ s_vr_c s_vr_c s_vr_c endarray label eqnpotentialswitch fifthdegre polynomi properti math s_vr r_ r_c leftfracrr_r_cr_right leftfracrr_r_cr_right leftfracrr_r_cr_right label eqnpolynom implement found sever simul packag ref refohmin ref refguenot differ charmm ref refsteinbach switch potenti lead artifici larg forc switch region therefor recommend switch coulomb interact use function ref refspoela switch lennardjon interact use function produc accept result modifi shortrang interact ewald summat ewald summat particlemesh ewald use calcul longrang interact shortrang coulomb potenti must also modifi potenti switch nearli zero cutoff instead forc case short rang potenti given math vr f fracmboxerfcbeta r_ijr_ij q_i q_j label eqnewaldsrmod mathbeta paramet determin rel weight direct space sum reciproc space sum erfc mathx complementari error function detail longrang electrostat see sec reflrelstat _feia free energi interact section describ mathlambdadepend potenti use free energi calcul see sec reffecalc common type potenti constraint interpol smoothli state mathlambda state b mathlambda vice versa bond interact interpol linear interpol interact paramet nonbond interact interpol linearli via softcor interact start gromac mathlambda vector allow differ compon free energi transform carri differ rate coulomb lennardjon bond restraint term control independ describ refmdp option harmon potenti exampl given bond potenti harmon gromac howev equat appli angl potenti improp dihedr potenti well math beginalign v_b fracleftlambdak_ba lambdak_bbright leftb lambdab_a lambdab_bright fracparti v_bpartial lambdafrack_bbk_ba leftb lambdab_a lambdab_bright nonumb phantomfracb_ab_b leftb lambdab_a lambdab_bright leftlambdak_ba lambdak_bb rightendalign label eqnfepharmpot gromo bond angl fourthpow bond stretch cosinebas angl potenti interpol linear interpol forc constant equilibrium posit formula given proper dihedr proper dihedr equat somewhat complic math beginalign v_d leftlambdak_da lambdak_db right left cosleftn_phi phi lambdaphi_sa lambdaphi_sb rightright fracparti v_dpartial lambdak_dbk_da left co left n_phi phi lambdaphi_sa lambdaphi_sb right right nonumb phi_sb phi_sa leftlambdak_da lambdak_dbright sinleft n_phiphi lambdaphi_sa lambdaphi_sb rightendalign label eqnfeppropdihedr note multipl mathn_phi parameter function remain period interv mathpi tabul bond interact tabul bond interact forc constant interpol math beginalign v lambdaka lambdakb f fracparti vpartial lambda kb ka fendalign label eqnfeptabbond coulomb interact coulomb interact two particl charg vari mathlambda math beginalign v_c fracfvarepsilon_rfr_ijleftlambdaq_ia q_ja lambda q_ib q_jbright fracparti v_cpartial lambda fracfvarepsilon_rfr_ijleft q_ia q_ja q_ib q_jbrightendalign label eqnfepcoloumb mathf fracpi varepsilon_ see chapter refdefunit coulomb interact reaction field coulomb interact includ reaction field two particl charg vari mathlambda math beginalign v_c fleftfracr_ij k_rf r_ij c_rfright leftlambdaq_ia q_ja lambda q_ib q_jbright fracparti v_cpartial lambda fleftfracr_ij k_rf r_ij c_rfright left q_ia q_ja q_ib q_jbright endalign label eqdvcoulombdlambda note constant mathk_rf mathc_rf defin use dielectr constant mathvarepsilon_rf medium see sec refcoulrf lennardjon interact lennardjon interact two particl atom type vari mathlambda write math beginalign v_lj fraclambdac_a lambda c_br_ij fraclambdac_a lambda c_br_ij fracparti v_ljpartial lambdafracc_b c_ar_ij fracc_b c_ar_ij endalign label eqdvljdlambda note also possibl express pathway state state b use mathsigma mathepsilon see eqeqn eqnsigep may seem make sens physic vari forc field paramet mathsigma mathepsilon rather deriv paramet mathc_ mathc_ howev differ pathway paramet space larg free energi depend pathway use simpl formul present kinet energi mass particl chang also contribut kinet energi free energi note write momentum mathmathbfp mathmathbfv sinc would result sign mathfracparti e_kparti lambda incorrect ref refgunsterena math beginalign e_k fracfracmathbfplambdama lambdamb fracparti e_kparti lambda fracfracmathbfpmbmalambdama lambdambendalign label eqnfepekin take deriv insert mathmathbfp mathmathbfv math fracparti e_kparti lambda fracmathbfvmbma label eqnfepekinderiv constraint constraint formal part hamiltonian therefor give contribut free energi gromac calcul use linc shake algorithm mathk ldot k constraint equat mathg_k linc math g_k mathbfr_k d_k label eqnfepconstr mathmathbfr_k displac vector two particl mathd_k constraint distanc two particl express fact constraint distanc mathlambda depend math d_k lambdad_ka lambdad_kb label eqnfepconstrdistdep thu mathlambdadepend constraint equat math g_k mathbfr_k leftlambdad_ka lambdad_kbright label eqnfepconstrlambda zero contribut mathg hamiltonian constraint use lagrang multipli mathlambda_k logic distinct freeenergi mathlambda math beginalign g sumk_k lambda_k g_k fracparti gpartial lambda fracparti gpartial d_k fracparti d_kpartial lambda sumk_k lambda_k leftd_kbd_karightendalign label eqnconstrfreeenergi shake constraint equat math g_k mathbfr_k d_k label eqnfepshakeconstr mathd_k math beginalign fracparti gpartial lambda sumk_k lambda_k leftd_kbd_karightendalign label eqnfepshakeconstr softcor interact beutler et al _figsoftcor figur plotssoftcor height cm softcor interact mathlambda mathp mathc_ac_ac_bc_b freeenergi calcul particl grow noth particl disappear use simpl linear interpol lennardjon coulomb potenti describ eqequ eqdvljdlambda eq eqdvcoulombdlambda may lead poor converg particl nearli disappear close appear mathlambda close interact energi weak enough particl get close lead larg fluctuat measur valu mathparti vpartial lambda simpl linear interpol depend potenti endpoint mathlambda circumv problem singular potenti need remov done modifi regular lennardjon coulomb potenti softcor potenti limit energi forc involv mathlambda valu mathlambda gromac softcor potenti mathv_sc shift version regular potenti singular potenti deriv mathr never reach formul introduc beutler et al ref refbeutl math beginalign v_scr lambdavar_a lambdavbr_b r_a leftalpha sigma_a lambdap r rightfrac r_b leftalpha sigma_b lambdap r rightfracendalign label eqnfepsoftcor mathva mathvb normal hard core van der waal electrostat potenti state mathlambda state b mathlambda respect mathalpha softcor paramet set sc_alpha refmdp file mathp softcor mathlambda power set sc_power mathsigma radiu interact mathc_c_ input paramet sc_sigma mathc_ mathc_ zero beutler et al ref refbeutl probe variou combin mathr power valu lennardjon coulomb interact gromac use mathr van der waal electrostat interact intermedi mathlambda mathr_a mathr_b alter interact littl mathr alpha sigma quickli switch softcor interact almost constant valu smaller mathr numreffig figsoftcor forc math f_scr fracparti v_scrpartial r lambdafar_a leftfracrr_aright lambdafbr_b leftfracrr_bright label eqnfepsoftcoreforc mathfa mathfb hard core forc contribut deriv free energi math beginalign fracparti v_scrpartial lambda vbr_b var_a lambdafracparti var_aparti r_a fracparti r_aparti lambda lambdafracparti vbr_bpartial r_b fracparti r_bpartial lambda nonumb vbr_b var_a nonumb fracp alpha left lambdafbr_b r_b sigma_b lambdap lambdafar_a r_a sigma_a lambdap rightendalign label eqnfepsoftcorederiv origin gromo lennardjon softcor function ref refbeutl use mathp mathp give smoother mathparti hpartiallambda curv anoth issu consid softcor effect hydrogen without lennardjon interact softcor mathsigma set sc_sigma refmdp file hydrogen produc peak mathparti hpartiallambda mathlambda andor mathp close andor mathp lower sc_sigma decreas effect also increas interact hydrogen rel interact softcor state softcor potenti select set sc_alpha coulomb lennardjon potenti turn sequenti coulomb interact turn linearli rather use softcor interact less statist noisi case behavior overwritten use refmdp option sccoul ye note sccoul taken account lambda state use couplelambda couplelambda still turn softcor interact set scalpha addit softcor interact potenti appli either b state zero interact potenti b state nonzero interact potenti default linear scale describ use coulomb lennardjon interact turn simultan softcor potenti use hydrogen introduc delet sigma set scsigmamin default scsigmadefault softcor interact gapsi et al section describ function form paramet softcor nonbond interact use formal gapsi et al ref refgapsi gapsi et al softcor formul act level van der waal electrostat forc nonbond interact linear point defin mathr_sclj mathr_scq respect linear point depend state system control mathlambda paramet two paramet mathalpha_q set scgapsysscalelinpointq mathalpha_lj set scgapsysscalelinpointlj depend mathlambda guarante endstat properli repres hardcor potenti numreffig figgapsyssc illustr behaviour linear point forc integr potenti energi respect paramet mathalpha_q mathalpha_lj optim choic paramet valu systemat explor ref refgapsi recommend valu set default scfunctiongapsi select scgapsysscalelinpointq scgapsysscalelinpointlj _figgapsyssc figur plotsgapsyssc width cm illustr softcor paramet influenc linear point top row forc middl row energi bottom row van der waal left column electrostat interact right column case two interact atom consid state atom charg mathsigma nm mathepsilon kjmol state b nonbond interact set zero paramet mathlambda set electrostat interact cutoff nm paramet mathalpha_lj unitless scale factor rang math scale posit point van der waal forc linear linear forc allow rang mathf_minlj set mathalpha_lj result standard hardcor van der waal interact set mathalpha_lj closer bring forc linear point toward minimum lennardjon forc curv mathf_minlj construct allow retain repuls two particl nonzero c paramet mathlambda valu paramet mathalpha_q unit mathfracnm defin rang mathinf scale posit point coulomb forc linear even though theori mathalpha_q set arbitrarili larg valu algorithm linear point forc bound rang mathf_rcoulq set mathalpha_q result standard hardcor coulomb interact set mathalpha_q larger valu soften coulomb forc notat simplic distanc two atom mathi mathj note mathr ie mathrr_ij forc van der waal interact math beginalign mathbff_ijljmathbfrbegincas fracc_ijr fracc_ijrfracmathbfrr mboxif mbox r geq r_sclj fracdmathbff_ijljdr_rr_scljr mathbff_ijljr_sclj mboxif mbox rr_sclj endcasesendalign label eqvdwforc switch point soft hardcor lennardjon forc mathr_sclj alpha_ljfracsigmalambdafrac state mathr_sclj alpha_ljfracsigmalambdafrac state b analog beutler et al soft core version mathsigma radiu interact mathc_c_ input paramet set scsigmaljgapsi c c zero default valu paramet scsigmaljgapsi explicit express math beginalign mathbff_ljmathbfrbegincas leftfraccr fraccrrightfracmathbfrr mboxif mbox r geq r_sclj leftfraccr_sclj fraccr_scljrightmathbfr fraccr_sclj fraccr_sclj mboxif mbox rr_sclj endcasesendalign label eqvdwforcesexpl forc coulomb interact math beginalign mathbff_ijqmathbfrbegincas fracq_iq_jpivarepsilon_varepsilon_rrfracmathbfrr mboxif mbox r geq r_scq r_cutoffq fracdmathbff_ijqdr_rr_scqr mathbff_ijqr_scq mboxif mbox rr_scq r_cutoffq fracdmathbff_ijqdr_rr_cutoffqr mathbff_ijqr_cutoffq mboxif mbox r rscq geq r_cutoffq endcasesendalign label eqqforc switch point mathrsc soft hardcor electrostat forc mathr_scq alpha_qq_iq_jlambdafrac state mathr_scq alpha_qq_iq_jlambdafrac state b mathlambda depend linear point van der waal coulomb interact power math explicit express math beginalign mathbff_qmathbfrbegincas fracq_iq_jpivarepsilon_varepsilon_rrfracmathbfrr mboxif mbox r geq r_scq r_cutoffq fracpivarepsilon_varepsilon_rbig fracq_iq_jr_scmathbfr fracq_iq_jr_sc big mboxif mbox rr_scq r_cutoffq fracpivarepsilon_varepsilon_rbig fracq_iq_jr_cutoffqmathbfr fracq_iq_jr_cutoffq big mboxif mbox r r_scq geq r_cutoffq endcasesendalign label eqqforcesexpl energi van der waal interact explicit definit energi math beginalign v_ljrbegincas fraccr fraccr mboxif mbox r geq r_sclj leftfraccr_sclj fraccr_scljrightr leftfraccr_sclj fraccr_scljrightr fraccr_sclj fraccr_sclj mboxif mbox rr_sclj endcasesendalign label eqvdwen energi coulomb interact math beginalign v_qrbegincas fracq_iq_jpivarepsilon_varepsilon_rr mboxif mbox r geq r_scq r_cutoffq fracq_iq_jr_scqr fracq_iq_jr_scqr fracq_iq_jr_scq mboxif mbox rr_scq r_cutoffq fracq_iq_jr_cutoffqr fracq_iq_jr_cutoffqr fracq_iq_jr_cutoffq mboxif mbox r r_scq geq r_cutoffq endcasesendalign label eqqen mathparti h partial lambda van der waal interact provid explicit express mathparti h partial lambda lennardjon potenti mathrr_sclj simplic express use notat mathr_sclj_ar_sca mathr_sclj_br_scb math beginalign fracpartialhpartiallambda v_ljbr v_ljar lambdafracpartialv_ljarpartiallambda lambdafracpartialv_ljbrpartiallambda leftfracc_br_scb fracc_br_scbrightr leftfracc_br_scb fracc_br_scbrightr fracc_br_scb fracc_br_scb leftleftfracc_ar_sca fracc_ar_scarightr leftfracc_ar_sca fracc_ar_scarightr fracc_ar_sca fracc_ar_sca right fraclambdalambdaleftleftfracc_ar_sca fracc_ar_scarightr leftfracc_ar_sca fracc_ar_scarightr fracc_ar_sca fracc_ar_scaright fraclambdalambdaleftleftfracc_br_scb fracc_br_scbrightr leftfracc_br_scb fracc_br_scbrightr fracc_br_scb fracc_br_scbright endalign label eqvdwdhdl mathparti h partial lambda lennardjon potenti mathr geq r_sclj calcul standard hardcor contribut mathparti h partial lambda mathfracpartialhpartiallambda v_ljbr v_ljar mathparti h partial lambda coulomb interact provid explicit express mathparti h partial lambda coulomb potenti mathrr_scqr_cutoffq simplic express use notat mathr_scq_ar_sca mathr_scq_br_scb math beginalign fracpartialhpartiallambda v_qbr v_qar lambdafracpartialv_qarpartiallambda lambdafracpartialv_qbrpartiallambda fracq_ibq_jbr_scbr fracq_ibq_jbr_scbr fracqb_iq_jbr_scb leftfracq_iaq_jar_scar fracq_iaq_jar_scar fracqa_iq_jar_scaright fraclambdalambdaleftfracq_iaq_jar_scar fracq_iaq_jar_scar fracq_iaq_jar_scaright fraclambdalambdaleftfracq_ibq_jbr_scbr fracq_ibq_jbr_scbr fracq_ibq_jbr_scbright endalign label eqqdhdl mathparti h partial lambda coulomb potenti mathr r_scq geq r_cutoffq calcul use express set mathr_scar_cutoffq mathr_scbr_cutoffq mathparti h partial lambda coulomb potenti mathr geq r_scq r_cutoffq calcul standard hardcor contribut mathparti h partial lambda mathfracpartialhpartiallambda v_qbr v_qar _lrelstat long rang electrostat ewald summat total electrostat energi mathn particl period imag given math vfracfsum_n_xsum_n_i sum_n_z sum_in sum_jn fracq_i q_jbf r_ijbf n label eqntotalcoulomb mathn_xn_yn_zbf n box index vector star indic term mathij omit mathn_xn_yn_z distanc mathbf r_ijbf n real distanc charg minimumimag sum condit converg slow ewald summat first introduc method calcul longrang interact period imag crystal ref refewald idea convert singl slowlyconverg sum eqeqn eqntotalcoulomb two quicklyconverg term constant term math beginalign v v_mathrmdir v_mathrmrec v_ ex v_mathrmdir fracf sum_ijn sum_n_xsum_n_i sum_n_z q_i q_j fracmboxerfcbeta r_ijbf n r_ijbf n ex v_mathrmrec fracf pi v sum_ijn q_i q_j sum_m_xsum_m_i sum_m_z fracexpleft pi bf mbeta pi bf cdot bf r_i bf r_jrightbf ex v_ fracf betasqrtpisum_in q_iendalign label eqntotalcoloumbsepar mathbeta paramet determin rel weight direct reciproc sum mathbf mm_xm_ym_z way use short cutoff order math nm direct space sum short cutoff reciproc space sum eg wave vector direct unfortun comput cost reciproc part sum increas mathn mathn slightli better algorithm therefor realist use larg system use ewald dont use ewald unless absolut sure want almost case pme method perform much better still want employ classic ewald summat enter refmdp file side box math nm coulombtyp ewald rvdw rlist rcoulomb fourierspac ewaldrtol e ratio box dimens fourierspac paramet determin highest magnitud wave vector mathm_xm_ym_z use direct nm cubic box exampl would use math wave vector math math direct ewaldrtol paramet rel strength electrostat interact cutoff decreas give accur direct sum less accur reciproc sum _pme pme particlemesh ewald method propos tom darden ref refdarden improv perform reciproc sum instead directli sum wave vector charg assign grid use interpol implement gromac use cardin bspline interpol ref refessmann refer smooth pme spme grid fourier transform fft algorithm reciproc energi term obtain singl sum grid kspace potenti grid point calcul invers transform use interpol factor get forc atom pme algorithm scale mathn logn substanti faster ordinari ewald summat medium larg system small system might still better use ewald avoid overhead set grid transform parallel pme see section mpmd pme refmpmdpm verlet cutoff scheme pme direct space potenti shift constant potenti zero cutoff shift small sinc net system charg close zero total shift small unlik case lennardjon potenti shift add appli shift anyhow potenti exact integr forc use pme exampl use particlemesh ewald summat gromac specifi follow line refmdp file coulombtyp pme rvdw rlist rcoulomb fourierspac pmeorder ewaldrtol e case fourierspac paramet determin maximum space fft grid ie minimum number grid point pmeorder control interpol order use fourthord cubic interpol space give electrostat energi accur mathcdot sinc lennardjon energi accur might even possibl increas space slightli pressur scale work pme awar fact anisotrop scale introduc artifici order system pmad particleparticl particlemesh method hockney eastwood also appli gromac treatment long rang electrostat interact ref refhockney although pm method first effici longrang electrostat method molecular simul smooth pme spme method larg replac pm method choic atomist simul one perform disadvantag origin pm method requir dfft back transform obtain forc particl requir pm forc deriv analyt differenti potenti done pme result method term pmad remain differ pmad pme optim lattic green influenc function error minim pm use howev shown spme influenc function modifi obtain pm ref refballenegg mean advantag error minim pmad use comput cost code pme ad line modifi influenc function howev optim paramet set effect error minim pmad less pmad show larg accuraci gain interlac also known stagger grid support gromac yet pm use gromac exactli option use pme select electrostat type coulombtyp pmad optim fourier transform pme calcul recommend optim paramet calcul electrostat interact pme grid dimens cutoff radii particularli relev launch long product run refgmx mdrun automat lot pme optim gromac also includ special tool refgmx tune_pm autom process select optim number pmeonli rank viscos calcul shear viscos properti liquid determin easili experi use parameter forc field kinet properti properti use parameter thermodynam viscos also import properti sinc influenc rate conform chang molecul solvat liquid viscos calcul equilibrium simul use einstein relat math eta fracfracvk_b lim_t rightarrow infti fracmboxdmboxd leftlangl left int_t_t_t p_xzt mboxd right rightrangle_t_ label eqneinsteinrel done refgmx energi gmx energi method converg slowli ref refhessa nanosecond simul might long enough accur determin viscos result depend treatment electrostat use short cutoff result larg nois offdiagon pressur element increas calcul viscos order magnitud gromac also nonequilibrium method determin viscos ref refhessa make use fact energi fed system extern forc dissip viscou friction gener heat remov coupl heat bath newtonian liquid ad small forc result veloc gradient accord follow equat math a_xz fracetarho fracparti v_xzpartial z label eqnviscositygradi appli acceler matha_xz mathxdirect function mathzcoordin gromac acceler profil math a_xz cosleftfracpi zl_zright label eqnviscosityacceler mathl_z height box gener veloc profil math v_xz v cosleftfracpi zl_zright label eqnviscosityprofil math v fracrhoetaleftfracl_zpiright label eqnviscosityprofil viscos calcul matha mathv math eta fracavrho leftfracl_zpiright label eqnvisc simul mathv defin math v fracdisplaystyl sum_in m_i v_ix cosleftfracpi zl_zright displaystyl sum_in m_i label eqnsimulationviscos gener veloc profil coupl heat bath moreov veloc profil exclud kinet energi one would like mathv larg possibl get good statist howev shear rate high system get far equilibrium maximum shear rate occur cosin zero rate math mboxsh_max max_z left fracparti v_xzpartial z right fracrhoeta fracl_zpi label eqnshearr simul matheta kgm math math mathrho kgm math mathl_zpi nm mathmboxsh_max psnm math matha shear rate smaller one longest correl time system liquid rotat correl time around ps case matha smaller nmp math shear rate high observ viscos low mathv proport squar box height optim box elong mathzdirect gener simul length ps enough obtain accur valu viscos heat gener viscou friction remov coupl heat bath coupl instantan real temperatur liquid slightli lower observ temperatur berendsen deriv temperatur shift ref refberendsen written term shear rate math t_ fracetatau rhoc_v mboxsh_max label eqnberendsentempshift mathtau coupl time berendsen thermostat mathc_v heat capac use valu exampl mathtau mathc_v cdot j kg math k math get matht_ kp mathsh math_max want shear rate smaller math ps math matht_ smaller k neglig note system build veloc profil start equilibrium state buildup time order correl time liquid two quantiti written energi file along averag fluctuat mathv matheta obtain eq eqnvisc tabul interact function _cubicsplin cubic spline potenti inner loop gromac lookup tabl use comput potenti forc tabl interpol use cubic spline algorithm separ tabl electrostat dispers repuls interact sake cach perform combin singl array cubic spline interpol mathx_i leq x x_i look like math v_sx a_ a_ epsilon a_ epsilon a_ epsilon label eqnsplin tabl space mathh fraction mathepsilon given math beginalign h x_i x_i epsilon x x_ihendalign label eqntablespac math le epsilon calcul deriv order determin forc math v_sx fracrm dv_sxrm depsilonfracrm depsilonrm dx a_ a_ epsilon a_ epsilonh label eqntablederiv four coeffici determin four condit mathv_ mathv_ end interv match exact potenti mathv forc mathv result follow error interv math beginalign v_ v _max v frach oh v_ v _max v frachsqrt oh v_ v _max v frach ohendalign label eqntableerror v v continu v first discontinu deriv number point per nanomet mix doubleprecis version gromac respect mean error potenti forc usual smaller mix precis accuraci gromac store matha_ matha_ matha_ matha_ forc routin get tabl four paramet scale factor math equal number point per nm note mathh math algorithm goe littl someth like calcul distanc vector mathmathbfr_ij distanc r math_ij multipli r math_ij math truncat integ valu mathn_ get tabl index calcul fraction compon mathepsilon math r math_ij n_ mathepsilon interpol calcul potenti mathv scalar forc mathf calcul vector forc mathmathbff multipli mathf mathmathbfr_ij note tabl lookup significantli slower comput simpl lennardjon coulomb interact howev much faster shift coulomb function use conjunct pppm method final much easier modifi tabl potenti get graphic represent modifi inner loop md program userspecifi potenti function also use potenti function without edit gromac code potenti function accord follow equat math vr_ij fracq_i q_j piepsilon_ fr_ij c_ gr_ij c_ hr_ij label eqnuserpotfunct mathf mathg mathh user defin function note mathgr repres normal dispers interact mathgr math c math_ c math_ charg read topolog also note combin rule support lennardjon buckingham tabl match paramet binari topolog add follow line refmdp file rlist coulombtyp user rcoulomb vdwtype user rvdw refmdrun gmx mdrun read singl nonbond tabl file multipl energygrpt set see name file set refmdrun gmx mdrun option tabl tabl file contain seven column tabl lookup data order mathx mathfx mathfx mathgx mathgx mathhx mathhx mathx run mathr_c valu table_extens chang refmdp file choos space like standard tabl gromac use space nm run mix doubl precis respect context mathr_c denot maximum two cutoff rvdw rcoulomb see variabl need need either function use potenti contain singular mathx sinc atom normal closer nm function valu mathx import final also possibl combin standard coulomb modifi lj potenti vice versa one specifi eg coulombtyp cutoff coulombtyp pme combin vdwtype user tabl file must alway contain column howev meaning data ie zero must enter column number prebuilt tabl file found gmxlib directori lennardjon potenti combin normal coulomb want differ function form differ group atom set energi group differ tabl use nonbond interact differ energi group pair refmdp option energygrpt see detail user guid atom interact differ potenti put differ energi group group pair list energygrpt normal user tabl use make easi use differ function form type atom _dgimplement free energi implement free energi calcul two thing must specifi end state pathway connect end state end state specifi two way straightforward specif end state topolog file potenti form support matha state mathb state whenev state specifi matha state correspond initi free energi state mathb state correspond final state case end state also defin case without alter topolog sole refmdp file use couplemoltyp couplelambda couplelambda coupleintramol refmdp keyword molecul type select couplemoltyp automat mathb state implicitli construct matha state redefin accord couplelambda keyword couplelambda couplelambda defin nonbond paramet present matha state couplelambda mathb state couplelambda choic q vdw vdwq indic coulomb van der waal paramet turn respect state end state defin path end state defin path defin sole mdp file start mathlambda vector compon coulomb van der waal bond restraint mass compon abl adjust independ make possibl turn coulomb term linearli van der waal use soft core simul especi use replica exchang expand ensembl simul import sampl way interact noninteract state simul improv sampl feplambda default array mathlambda valu rang lambda array use valu array specifi previou behavior pathway control singl mathlambda variabl preserv use feplambda defin pathway _figlambdav figur plotslambdavalu width cm separ mathlambda valu coulomb vanderwa restraint interact numreffig figlambdav show exampl differ lambda array first coulomb term reduc van der waal term chang bond time rate van der waal chang restraint throughout first twothird simul correspond mathlambda vector given coullambda vdwlambda bondedlambda restraintlambda also equival feplambda coullambda restraintlambda feplambda array case use default fill bond van der waal mathlambda array usual best fill array explicitli make sure thing properli assign want turn restraint go matha mathb would restraintlambda compon mathlambda vector would left matha state comput free energi vector mathlambda use thermodynam integr ti equat becom vector equat math delta f int langl nabla h rangl cdot dveclambda label eqnfepti finit differ math delta f approx int sum langl nabla h rangl cdot deltalambda label eqnfepfinitediff extern pymbar script httpssimtkorghomepymbar_ comput integr automat gromac dhdlxvg output potenti mean forc potenti mean forc pmf potenti obtain integr mean forc ensembl configur gromac sever differ method calcul mean forc method limit list pull code center mass molecul group molecul awh code current act coordin provid pull code freeenergi lambda paramet freeenergi code harmon bond constraint singl atom freeenergi code posit restraint chang conform rel immobil group atom pull code limit case group atom part larger molecul bond constrain shake linc pull group rel larg pull code use pull freeenergi code describ detail follow two section entrop effect distanc two atom center mass two group constrain restrain pure entrop contribut pmf due rotat two group ref refrmneumanna system two noninteract mass potenti mean forc math v_pmfr n_c k_b logr label eqnfepentropi mathn_c number dimens constraint work ie mathn_c normal constraint mathn_c mathzdirect constrain whether one need correct contribut depend pmf repres one want pull substrat protein entrop term inde contribut work get substrat protein calcul pmf two solut solvent purpos simul without solvent entrop contribut remov note term signific k distanc halv contribut kj mol math _compel comput electrophysiolog comput electrophysiolog compel protocol ref refkutznerb allow simul ion flux membran channel driven transmembran potenti ion concentr gradient real cell compel establish transmembran potenti sustain small imbal charg mathdelta q across membran give rise potenti differ mathdelta u accord membran capacit math delta u delta q c_membran label eqnmembcap transmembran electr field concentr gradient control refmdp option allow user set refer count ion either side membran differ actual refer number persist certain time span specifi user number ionwat pair exchang compart refer number restor alongsid calcul channel conduct ion select compel simul also enabl determin channel revers potenti import characterist obtain electrophysiolog experi compel setup simul system divid two compart b independ ion concentr best achiev use doubl bilay system copi copi channelpor interest bilay numreffig figcompelsetup b channel axe point direct channel flux observ simultan posit neg potenti way instanc import studi channel rectif _figcompelsetup figur plotscompelsetup width cm typic doublemembran setup compel simul b ionwat molecul exchang perform need two light blue volum around dot black line plot c show potenti differ mathdelta u result select charg imbal mathdelta q_ref compart potenti differ mathdelta u across membran easili calcul refgmx potenti gmx potenti util potenti drop along mathz pore axi exactli known time interv simul numreffig figcompelsetup c type number ion mathn_i charg mathq_i travers channel simul written swapionsxvg output file averag channel conduct mathg interv mathdelta determin math g fracsum_i n_iq_idelta delta u label eqnchannelcond ion select calcul number flux ratio differ speci best result obtain averag valu sever overlap time interv calcul revers potenti best achiev use small set simul given transmembran concentr gradient complement small ion imbal vari magnitud exampl one compart contain salt given charg neutral otherwis set simul mathdelta q e mathdelta q e mathdelta q e could use fit straight line currentvoltag relationship obtain mathimathu pair near zero current yield mathu_rev usag follow refmdp option control compel protocol swapcoord z swap posit x z swapfrequ swap attempt frequenc choos z membran mathxyplan numreffig figcompelsetup ion exchang compart depend mathzposit alon swapfrequ determin often swap attempt made step requir posit split group ion possibl solvent molecul commun parallel process chosen small decreas simul perform posit swap entri cycl time account tabl end mdlog file summar amount runtim spent swap modul splitgroup channel defin compart boundari splitgroup channel defin compart boundari masswsplit use massweight center masswsplit splitgroup splitgroup two index group defin boundari two compart usual center channel masswsplit masswsplit set ye center mass index group use boundari mathzdirect otherwis geometr center use mathtim numreffig figcompelsetup membran channel select split group center channel defin divid plane compart dash horizont line index group must defin index file restor request ion count ion one compart exchang water molecul compart molecul swap largest distanc compartmentdefin boundari dash horizont line depend ion concentr effect result exchang molecul light blue volum channel asymmetr mathzdirect would extend one swap volum one offset swap exchang plane bulkoffset paramet valu mean offset mathb valu math b move swap exchang plane closer lower valu math b closer upper membran numreffig figcompelsetup left depict compart solventgroup sol group contain solvent molecul iontyp number differ ion type control iontypenam na group name ion type iontypeina refer count ion type iontypeinb refer count ion type b iontypenam k iontypeina iontypeinb iontypenam cl iontypeina iontypeinb group name solvent molecul act exchang partner ion set solventgroup number differ ionic speci control compel protocol given iontyp paramet iontypenam give name index group contain atom ionic speci refer number ion type set iontypeina iontypeinb option compart b respect obvious sum iontypeina iontypeinb need equal number ion group defin iontypenam refer number mean use number ion found begin simul refer valu couplstep averag mani swap step threshold swap threshold couplstep set momentari ion distribut determin whether ion exchang couplstep use timeaverag ion distribut select number attempt step instead use exampl ion diffus near compart boundari would lead numer unproduct ion exchang threshold mean swap perform averag ion count compart differ least request valu higher threshold lead toler larger differ ion exchang request number mathpm threshold reach cylr split cylind radiu nm cylup split cylind upper extens nm cyldown split cylind lower extens nm cylr channel cylup cyldown cylind option use defin virtual geometr cylind around channel pore track mani ion type pass channel ion count travel channel accord definit channel cylind radiu upper lower extens rel locat respect split group affect actual flux exchang provid ion permeat number across channel note ion count pass particular channel detect within defin split cylind swap step swapfrequ chosen high particular ion may detect compart one swap step compart b follow swap step unclear channel pass doublelay system compel simul easili prepar duplic exist membranechannel md system direct membran normal typic mathz refgmx editconf translat l_z l_z box length direct alreadi defin index group channel singlelay system refgmx make_ndx n indexndx twin provid group doublelay system suppress larg fluctuat membran along swap direct may use appli harmon potenti act swap dimens two channel andor bilay center use umbrella pull see section refpul multimer channel split group consist one molecul correct pbc imag molecul respect chosen channel center correctli determin gromac assum start structur reftpr file correct pbc represent set follow environ variabl check whether case gmx_compeldump output start structur made whole refpdb file _fepmf calcul pmf use freeenergi code freeenergi couplingparamet approach see sec reffecalc provid sever way calcul potenti mean forc potenti mean forc two atom calcul connect harmon potenti constraint purpos special potenti avoid gener extra exclus see sec refexcl posit minimum constraint length nm state b state restraint constraint forc given mathparti hpartial lambda distanc atom chang function mathlambda time set deltalambda refmdp file result ident although numer due differ implement result pull code umbrella sampl constraint pull unlik pull code free energi code also handl atom connect constraint potenti mean forc also calcul use posit restraint posit restraint atom link posit space harmon potenti see refpositionrestraint posit made function coupl paramet mathlambda posit b state suppli refgrompp gmx grompp r rb option respect one could use approach target md note encourag use target md protein protein forc one conform anoth use conform posit restraint coordin state b one slowli chang mathlambda main drawback approach conform freedom protein sever limit posit restraint independ chang state b also protein forc state b almost straight line wherea real pathway might differ exampl fruit applic solid system liquid confin wall one want measur forc requir chang separ boundari wall boundari wall alreadi need fix posit restraint limit system sampl shear simul common type nonequilibrium simul fluid dynam rheolog shear simul nonequilibrium simul work perform simul system achiev shear flow use comput viscos friction studi effect shear stress conform gromac four differ way achiev shear flow group atom given constant acceler effect massweight forc caus group move respect rest system care need taken control veloc center mass system normal center mass motion remov use would affect flow system gromac support gener triclin unitcel shape unit cell deform set shear flow achiev either deform unit cell directli use deform option refmdp file driven appli offdiagon stress pressur coupl former case one measur viscos stress latter case measur shear rate measur viscos simpl liquid one use cosineshap acceler profil specifi use cosacceler option refmdp file unitcel deform avoid complic method viscos comput fli report energi file final case one want studi effect wall flow particular structur wall interest consist atom kind case one want wall two side system typic xyplan close z box height flow driven move wall constant speed use constant forc constant forc achiev use acceler group allow posit restrain atom wall along direct shear need type wall case wall part atom posit restrain constant speed set use freeenergi lambdacoupl code achiev need suppli second bstate posit restraint file r option refgmx grompp shift coordin file nm direct shear set speed wall deltalambda option refmdp file note make lambda increas proport simul time limit magnitud lambda period shift wall handl correctli posit restraint coordin shift nm forc wall given directli mathdvdlambda couett flow popular setup experi unfortun difficult achiev simul best would experi appli pressur differ part simul box easi set one acceler liquid atom guarante atom interact directli wall experi forc would experi slightli better setup would acceler atom middl flow spatial defin acceler group current support gromac embed protein membran gromac capabl insert protein preequilibr lipid bilay minim perturb lipid use method initi describ protsqueez techniqu ref refyesylevskyy later implement g_memb tool ref refwolf current function g_memb avail mdrun describ user guid method work first artifici shrink protein mathxyplan remov lipid overlap much smaller core protein atom gradual resiz back initi configur use normal dynam rest system lipid adapt protein lipid remov requir raw latex clearpag nonequilibrium pull distanc two group chang continu work appli system mean system longer equilibrium although limit slow pull system equilibrium mani system limit reachabl within reason comput time howev one use jarzynski relat ref refjarzynskia obtain equilibrium freeenergi differ mathdelta g two distanc mani nonequilibrium simul math delta g_ab k_bt log leftlangl ebeta w_ab rightrangle_a label eqjarz mathw_ab work perform forc system along one path state b angular bracket denot averag canon ensembl initi state mathbetak_b _pull collect variabl pull code pull code appli forc constraint collect variabl sometim refer reaction coordin basic collect pull coordin distanc angl dihedr angl center mass group atom socal pull group complex collect variabl defin use reftransformationcoord pull group part one pull coordin furthermor coordin also oper singl group absolut refer posit space distanc pair group determin dimens along userdefin vector refer distanc constant chang linearli time normal atom weight mass addit weight factor also use _figpul figur plotspul width cm schemat pictur pull lipid lipid bilay umbrella pull mathv_rup veloc spring retract mathz_link atom spring attach mathz_spr locat spring sever differ pull type ie way appli pull forc support case refer distanc constant linearli chang time umbrella pull harmon potenti appli center mass two group thu forc proport displac constraint pull distanc center mass two group constrain constraint forc written file method use shake algorithm need iter exact two group constrain constant forc pull constant forc appli center mass two group thu potenti linear case refer distanc pull rate flat bottom pull like umbrella pull potenti forc zero coordin valu pullcoordtyp flatbottom pullcoordtyp flatbottomhigh refer valu use restrain eg distanc two molecul certain region extern potenti take potenti act reaction coordin anoth modul current acceler weight histogram method see sec docawh support provid adapt bias pull coordin addit differ type reaction coordin socal pull geometri set refmdp option pullcoordgeometri definit center mass gromac three way defin center mass group standard way plain center mass possibl addit weight factor period boundari condit longer possibl uniqu defin center mass group atom therefor refer atom use determin center mass atom group closest period imag refer atom use uniqu defin center mass default middl determin order topolog atom use refer atom user also select atom would closer center group larg pull group lipid bilay pullpbcrefprevstepcom use avoid potenti larg movement center mass case atom pull group move much refer atom far intend center mass option enabl center mass previou step use instead posit refer atom determin refer posit posit refer atom still use first step larg pull group import select refer atom close intend center mass ie use pullgrouppbcatom layer system instanc lipid bilay may interest calcul pmf lipid function distanc whole bilay whole bilay taken refer group case might also interest defin reaction coordin pmf local refmdp option pullcoordgeometri cylind use atom refer group instead dynam within cylind radiu pullcylinderr around pull vector go pull group work distanc defin one dimens cylind orient long axi along one dimens avoid jump pull forc contribut atom weight function distanc addit mass weight atom mathi math beginalign w_ir_i r_mathrmcyl leftfracr_ir_mathrmcylright leftfracr_ir_mathrmcylright w_ir_i geq r_mathrmcyl endalign label eqnpulldistmassweight note radial depend weight caus radial forc cylind group pull group math beginalign fmathrmradial_ir_i r_mathrmcyl fmathrmpul a_i fracsum_i w_ifracr_mathrmcyl r_i r_i r_mathrmcyl fmathrmradial_ir_i geq r_mathrmcyl endalign label eqnpulldistmassweightradialforc mathfmathrmpul pull forc work group matha_i axial distanc atom mathi center mass cylind group undesir unavoid effect minim effect cylind radiu chosen suffici larg effect mass time cylind uniform weight equal mass uniform cylind time radiu _figpullref figur plotspullref width cm comparison plain center mass refer group versu cylind refer group appli interfac system c refer group circl repres center mass two group plu refer group mathd_c refer distanc group molecul period system plain refer group might welldefin exampl water slab connect period mathx mathi two liquidvapor interfac along mathz setup water molecul evapor liquid move vapor period boundari interfac system inher period proper way defin plain center mass along mathz proper solut use cosin shape weight profil atom refer group profil cosin singl period unit cell phase optim give maximum sum weight includ mass weight provid uniqu continu refer posit nearli ident plain center mass posit case atom within half unitcel length see ref ref refengina detail rel weight mathw_i use calcul either suppli weight input due cylind geometri due cosin weight weight need scale conserv momentum math w_i w_i left sum_jn w_j m_j right sum_jn w_j m_j label eqnpullmassscal mathm_j mass atom mathj group mass group requir calcul constraint forc math sum_in w_i m_i label eqnpullconstraint definit weight center mass math mathbfr_com left sum_in w_i m_i mathbfr_i right label eqnpullcom center mass afm constraint umbrella forc mathmathbff_com group calcul forc center mass group redistribut atom follow math mathbff_i fracw_i m_im mathbff_com label eqnpullcomforc definit pull direct common setup pull along direct vector contain two pull group select pullcoordgeometri distanc might want pull along certain vector instead select pullcoordgeometri direct caus unwant torqu forc system unless pull refer group nearli fix orient eg membran protein embed membran along xy pull along z refer group fix orient probabl use pullcoordgeometri directionrel see numreffig figpulldirrel sinc potenti depend coordin two addit group defin orient torqu forc work two group _figpulldirrel figur plotspulldirrel width cm pull setup geometri directionrel normal pull group group defin pull direct thu direct normal pull forc red lead reaction forc blue group perpendicular pull direct magnitud given normal pull forc time ratio mathd_p distanc group definit angl dihedr pull geometri four pull group requir pullcoordgeometri angl way geometri two group consecut pair group mathi mathi defin vector connect com group mathi mathi angl defin angl two result vector eg refmdp option pullcoordgroup defin angl vector com group com group vector com group com group angl take valu close interv deg pullcoordgeometri angleaxi angl defin respect refer axi given pullcoordvec two group need given dihedr geometri requir six pull group pair way describ defin three vector dihedr angl defin angl two plane span two first two last vector equival dihedr angl seen angl first third vector vector project onto plane normal second vector axi vector exampl consid dihedr angl involv four group refmdp option pullcoordgroup specifi three vector defin dihedr angl first vector com distanc vector group second vector com distanc vector group third vector com distanc vector group dihedr angl take valu interv deg period boundari _transformationcoord transform pull coordin transform pull coordin meta pull coordin use defin complex collect variabl transform one pull coordin use arbitrari mathemat express power tool gener complex collect variabl simpl exampl contact coordin use nonlinear transform distanc complex exampl nonlinear combin two pull coordin sum contact typic forc constant pull coordin transform coordin act zero avoid unintend addit direct forc pull coordin indirect forc transit pull coordin requir direct indirect tranform coordin forc work almost never desir transform linear combin multipl distanc use normal coeffici transform coordin also unit nanomet make choic forc constant interpret easier two exampl pull section refmdp input use tranform coordin setup first contact reaction coordin contact larger distanc pull ye pullngroup pullncoord pullgroupnam groupa pullgroupnam groupb pullcoordtyp umbrella pullcoordgeometri distanc pullcoordgroup pullcoorddim pullcoordk avoid forc work directli distanc pullcoordtyp umbrella pullcoordgeometri transform pullcoordexpress expx x refer valu coord pullcoordinit restrain distanc contact pullcoordk second exampl averag two distanc pull ye pullngroup pullncoord pullgroupnam groupa pullgroupnam groupb pullgroupnam groupc pullgroupnam groupd pullcoordtyp umbrella pullcoordgeometri distanc pullcoordgroup pullcoorddim pullcoordk avoid forc work directli distanc pullcoordtyp umbrella pullcoordgeometri distanc pullcoordgroup pullcoorddim pullcoordk avoid forc work directli distanc pullcoordtyp umbrella pullcoordgeometri transform pullcoordexpress x x x x refer valu coord coord pullcoordinit restrain averag distanc nm pullcoordk limit one theoret limit strictli speak constraint forc calcul group connect constraint rest system group contain part molecul bond length constrain pull constraint linc shake bond constraint algorithm iter simultan done gromac mean simul constraint allbond refmdp file pull strictli speak limit whole molecul group molecul case limit avoid use free energi code see sec reffepmf practic error caus iter two constraint algorithm neglig pull group consist larg amount atom andor pull forc small case constraint correct displac pull group small compar bond length _mimic mimic hybrid quantum mechanicalmolecular mechan simul section describ coupl novel qmmm interfac multiscal model comput chemistri mimic interfac combin gromac cpmd qm code httpcpmdorg__ find inform qmmm implement gromac pleas refer section refqmmm within qmmm approach typic small part system eg activ site enzym chemic reaction take place treat qm level theori neglect electron degre freedom describ process eg chemic reaction rest system remaind protein solvent etc describ classic forcefield mm overview mimic implement qmmm coupl scheme develop group prof u roethlisberg describ ref refroethlisbergerqmmm addit scheme use electrostat embed classic system within quantum hamiltonian total qmmm energi calcul sum subsystem contribut math e_tot e_qme_mme_qmmm qm contribut comput cpmd mm part process gromac cross term treat mimic interfac cross term ie term involv simultan atom qm region atom mm region consist bond nonbond interact bond interact taken forcefield use describ mm part whenev chemic bond cross qmmm boundari addit care taken handl situat correctli otherwis qm atom involv cut bond left unsatur electron orbit lead unphys system behaviour therefor dangl bond cap anoth qm atom two differ option avail cpmd bond cap hydrogen cap simplest approach cap bond hydrogen atom constrain rel posit link atom pseudopotenti strategi use adhoc pseudopotenti develop cap bond pseudopotenti would repres real atom thu requir bond constraint standard forcefield nonbond contribut mathe_qmmm separ van der waal electrostat contribut first contribut taken mm forcefield second part nonbond interact handl mimic within electrostat embed approach add addit term hamiltonian system math e_qmmm sum_an_mmq_aintrhomathbfrfracr_ca mathbfr_a mathbfrr_ca mathbfr_a mathbfrdmathbfr sum_an_mmsum_nn_qmq_az_n fracr_ca mathbfr_a mathbfr_n r_ca mathbfr_a mathbfr_n mathn_mm number mm atom mathn_qm number qm atom mathr_ca coval radiu mm atom first term correspond damp coulomb interact eletron densiti mathrhomathbfr qm region mm atom damp need due fact cpmd use planewav basi set expand electron wavefunct unlik local basi set plane wave deloc may give rise socal electron spillout problem posit charg mm atom may artifici overpolar electron cloud due absenc quantum mechan effect eg pauli repus would normal prevent fulli quantum system function form damp coulomb potenti equat introduc ref refroethlisbergerqmmm sinc comput integr first term comput extrem expens mimic also implement hierarch electrostat embed scheme order mitig enorm comput effort need comput mathn_mm integr electron grid within scheme mm atom group two shell accord distanc qm region shortrang longrang one mm atom shortrang shell qmmm interact calcul use equat contrast interact involv mm atom longrang shell comput use multipolar expans qm electrostat potenti detail found ref refroethlisbergerqmmm applic coupl model unlik major qmmm interfac mimic use loos coupl partner code mean instead compil code singl binari mimic build separ execut cpmd gromac user prepar input code run simultan code run use separ pool mpi process commun necessari data eg coordin energi forc mpi clientserv mechan within mimic framework cpmd act server gromac becom client softwar prerequisit gromac version newer major releas may support multipl version mimic cpmd version usag refinstal mimic run mimic qmmm simul one need get compil cpmd mimic support normal classic equilibr gromac creat index group repres qm atom within gromac keep mind group also includ link atom bound atom qm region treat quantum level prepar input cpmd gromac accord recommend run cpmd gromac two independ instanc within singl batch job prepar input file gromac order setup refmdp file mimic simul one need add two option mdpvalueintegratormim enabl mimic workflow within gromac qmmmgrpsname_of_qm_index_group indic atom go handl cpmd sinc cpmd go perform md integr refmdp option relat forc calcul output activ set refmdp file one run refgrompp gmx grompp usual refgrompp gmx grompp set charg qm atom zero avoid doublecount coulomb interact moreov updat nonbond exclus list exclud lj interact qm atom sinc describ cpmd final remov bond qm atom present recommend output preprocess topolog file use gmx grompp pp preprocessed_topology_fil help prepar input cpmd autom way prepar input file cpmd section describ mimicrel input cpmd configur dftrelat option pleas refer cpmd manual httpswwwcpmdorgwordpresscpmdgetfilephpfilemanualpdf__ prepar input gromac obtain preprocess topolog file simpli run python preprocessor script provid within mimic distribut obtain mimicrel part cpmd input file usag script simpl prepareqmmmpi index_fil gro_fil preprocessed_topology_fil qm_group_nam advis mimic crucial forcefield contain data element number atom type provid preprocessor fail error look like forcefield use inform element number element number need run qmmm simul given relev inform script print part cpmd input relat mimic sampl output short descript keyword found part cpmd input mimic path some_absolute_path box overlap end atom h end suggest qm box size mimic section contain mimic set path indic number mm client code involv simul absolut path respect folder keep mind path point folder gromac go run otherwis caus deadlock cpmd next line contain number mm code case next mathn line contain path respect work directori box indic size whole simul box bohr x z format overlap set number id atom within gromac go treat cpmd format follow code_id atom_id_in_cod host_code_id atom_id_in_that_cod cpmd host code id alway id therefor qmmm simul gromac code id option longrang coupl enabl faster multipol coupl atom locat certain distanc qm box option cutoff distanc next line contain cutoff explicit coulomb coupl bohr default longrang coupl present option multipol order next line contain order multipolar expans truncat default maximum atom section cpmd input file contain qm atom within system default cpmd format pleas refer cpmd manual httpwwwcpmdorgdownloadablefilesnoauthenticationmanual_v__pdf__ adjust needson need set correct pseudopotenti atom speci final preprocessor suggest size qm box electron densiti go contain suggest valu final adjust user may requir run mimic qmmm simul order run simul one need run gromac cpmd within one job easili done within vast major queue system exampl case slurm queue system one use two job step within one job exampl job script run node slurm job alloc node gromac node cpmd code launch folder binbash x sbatch node sbatch outputmpioutj sbatch errormpierrj sbatch time sbatch partitionbatch start job script srun n ntaskspernod cpuspertask r gmx_mpi_d mdrun deffnm mimic ntomp srun n ntaskspernod cpuspertask r cpmdx benchmarkinp path_to_pp_fold benchmarkout wait known issu openmpi prior version xx bug prevent usag mimic complet pleas use newer version mpi distribut intelmpi commun cpmd gromac may result deadlock situat happen set intelmpirel environ variabl may help export fi_ofi_rxm_use_srx _awh adapt bias awh acceler weight histogram method ref reflidmar ref reflindahlacceler calcul pmf along reaction coordin ad adapt determin bias potenti awh flatten free energi barrier along reaction coordin appli historydepend potenti system fill free energi minima similar spirit adapt bias potenti method eg wanglandau ref refwangeffici local elev ref refhuberloc metadynam ref reflaioescap method initi sampl stage awh make method robust choic input paramet furthermor target distribut along reaction coordin may chosen freeli basic method rather bias reaction coordin mathxix directli awh act refer coordin mathlambda fundament method base connect atom coordin mathlambda establish extend ensembl ref reflyubartsev math pxlambda fracmathcalzeglambda qxixlambda vx label eqawhpxlambda mathglambda bia function free variabl mathvx unbias potenti energi system distribut along mathlambda tune predefin target distribut mathrholambda often chosen flat choos mathglambda wise evid math plambda int pxlambda dx fracmathcalzeglambda int e qxixlambda vx dx equiv fracmathcalzeglambda flambda label eqawhplambda mathflambda free energi math flambda ln int e qxixlambda vx dx label eqawhflambda reaction coordin mathxix commonli coupl mathlambda harmon potenti math qxilambda frac beta k xi lambda label eqnawhbas larg forc constant mathk mathxi approx lambda note use dimensionless energi compat previous publish work unit energi obtain multipl mathk_btbeta simul mathlambda sampl userdefin sampl interv mathi convolut pmf gaussian defin harmon potenti mathflambda smoothen version pmf eqeq eqawhplambda show order obtain mathplambdarholambda mathflambda need determin accur thu awh adapt calcul mathflambda simultan converg mathplambda toward mathrholambda also possibl directli control mathlambda state eg alchem free energi perturb ref reflundborg case harmon potenti mathlambda chang discret step along reaction coordin depend bias free energi differ mathlambda state nb yet possibl use awh combin perturb mass constraint multidimension reaction coordin mathxi sampl interv cartesian product mathipi_mu i_mu rectangular domain free energi updat awh initi estim free energi mathf_lambda regular time interv estim updat use data collect updat updat mathn appli bia mathg_nlambda function current free energi estim mathf_nlambda target distribut mathrho_nlambda math g_nlambda ln rho_nlambda f_nlambda label eqawhgrhofrel consist eqeq eqawhplambda note also target distribut may updat simul see exampl section refawhtarget substitut choic mathgg_n back eqeq eqawhplambda yield simpl free energi updat math delta f_nlambda flambda f_nlambda lnfracp_nlambdarho_nlambda label eqawhdfna would yield better estim mathf_n f_n delta f_n assum mathp_nlambda measur accur awh estim mathp_nlambda regularli calcul condit distribut math omega_nlambdax equiv p_nlambdax fraceg_nlambda qxix lambdasum_lambda eg_nlambda qxixlambda label eqawhomega accumul probabl weight yield mathsum_t omegalambdaxt sim p_nlambda mathint p_nlambdax p_nx dx p_nlambda use mathomega_nlambdax weight thu sampl awh method limit amount sampl one practic updat scheme eq eqawhdfna yield noisi result awh instead appli free energi updat form appli repeatedli limit local sampl math delta f_n ln fracw_nlambda sum_t omega_nlambdaxtw_nlambda sum_trho_nlambda label eqnawhsampl mathw_nlambda refer weight histogram repres prior sampl updat mathwlambda disregard initi stage see section refawhinitialstag math w_nlambda w_nlambda sum_trho_nlambda label eqawhwupd thu weight histogram equal target ideal histori sampl two import thing note free energi updat first sampl driven away oversampl current local region mathlambda valu mathomega_nlambda rho_nlambda mathdelta f_nlambda eqeq eqawhgrhofrel impli mathdelta g_nlambda assum mathdelta rho_n equiv thu probabl sampl mathlambda decreas updat see eqeq eqawhplambda secondli normal histogram mathn_nsum_lambda w_nlambda determin updat size math delta flambda instanc singl sampl mathomegalambdax use harmon potenti see eqeq eqnawhbas shape updat approxim gaussian function width mathsigmasqrtbeta k height mathpropto n_n ref reflindahlacceler math delta f_nlambda propto fracn_n efrac beta k xix lambda label eqawhdfs directli control lambda state system shape updat instead math delta f_nlambda propto fracn_n p_nlambda x label eqawhdfsizelambda therefor case sampl accumul mathwlambda mathn_n grow updat get smaller allow free energi converg note quantiti interest user mathflambda pmf mathphixi mathphixi extract reweight sampl mathxit fli ref reflindahlacceler see also section refawhreweight converg rate mathflambda see numreffig figawhbiasevolut pmf written output see section refawhusag appli bia system bia potenti appli system two way either appli harmon potenti center mathlambdat sampl use rejectionfre montecarlo sampl condit distribut mathomega_nlambda xt p_nlambda xt see eqeq eqawhomega also call gibb sampl independ sampl altern default code follow convolv bia potenti appli math u_nxi ln int e g_nlambda qxilambda lambda label eqawhbiaspotenti two approach equival sens give rise bias probabl mathp_nx cf eq eqawhpxlambda dynam clearli differ two case choic affect intern awh algorithm forc potenti awh return md engin along bia dimens directli control mathlambda state system control free energi perturb montecarlo sampl altern alway use even convolv bia potenti chosen use along dimens one _figawhbiasevolut figur plotsawhtraj width cm awh evolut time brownian particl doublewel potenti reaction coordin mathxit travers sampl interv multipl time initi stage exit enter final stage final stage dynam mathxi becom increasingli diffus _figawhbiasevolut figur plotsawhinvn width cm final stage dynam mathxi becom increasingli diffus time cover shown mathtimesmark differ color time free energi updat size mathsim n mathn size weight histogram decreas scale mathn factor mathgamma _figawhbiasevolut figur plotsawhsampleweight width cm final stage mathn grow sampl rate thu mathnsimt exit final stage determin fli ensur effect sampl weight math data collect final stage exce initi stage data note mathln st plot _figawhbiasevolut figur plotsawhpmf width cm estim pmf also extract simul bottom right exit initi stage estim global free energi differ fairli accur _awhinitialstag initi stage initi bia potenti far optim sampl highli correl case let mathwlambda accumul sampl prescrib eqeq eqawhwupd entail rapid decay free energi updat size motiv split simul initi stage weight histogram grow accord restrict robust protocol final stage weight histogram grow linearli sampl rate eqeq eqawhwupd awh initi stage take inspir wellknown wanglandau algorithm ref refwangeffici although differ detail initi stage updat size kept constant keep mathn_n constant transit across sampl interv detect cover definit cover see eqeq eqawhcov cover occur mathn_n scale constant growth factor mathgamma chosen heurist mathgamma thu initi stage mathn_n set dynam mathn_n gammam n_ mathm number cover sinc updat size scale mathn eqeq eqawhdfs lead close exponenti decay updat size initi stage see numreffig figawhbiasevolut updat size directli determin rate chang mathf_nlambda henc eqeq eqawhgrhofrel also rate chang bia funcion mathg_nlambda thu initi mathn_n kept small updat larg system driven along reaction coordin constantli fluctuat bia mathn_ set small enough first transit typic fast larg updat size quickli give first rough estim free energi second transit use mathn_gamma n_ refin estim thu rather care fill free energi minima use small initi updat size sampl interv sweep backandforth multipl time use wide rang updat size see numreffig figawhbiasevolut way initi stage also make awh robust choic mathn_ cover criterion gener case multidimension reaction coordin mathlambdalambda_mu sampl interv mathi consid cover dimens cover dimens mathd cover point mathlambda_mu onedimension sampl interv mathi_mu visit final point mathlambda_mu i_mu visit least one point mathlambdain mathlambda_mu lambda_mu sinc last cover accumul probabl weight correspond peak multidimension gaussian distribut math delta wlambda ge w_mathrmpeak equiv prod_mu fracdelta lambda_musqrtpisigma_k label eqawhcov mathdelta lambda_mu point space discret mathi_mu mathsigma_ksqrtbeta k_mu mathk_mu forc constant gaussian width exit initi stage longer time major free energi barrier larg flatten converg bia potenti histogram mathwlambda grow actual sampl rate initi stage need exit ref refbelardinellifast multipl reason heurist way determin transit take place one option postul number sampl weight histogram mathn_n never exceed actual number collect sampl exit initi stage condit break ref reflindahlacceler initi stage mathn grow close exponenti collect number sampl grow linearli exit sure occur eventu instead appli exit criterion base observ artif keep mathn constant continu collect sampl correspond scale rel weight old sampl rel new one similarli subsequ scale mathn factor mathgamma correspond scale weight old data briefli exit criterion devis weight sampl collect initi stage alway larger equal weight sampl collect initi stage see numreffig figawhbiasevolut consist scale earli noisi data initi stage exit criterion describ detail start begin cover stage mathn scale mathgamma kept constant thu first sampl stage weight math gamma rel last sampl previou cover stage assum mathdelta n sampl collect ad mathw updat keep mathn constant mathw need scale factor mathnn delta n everi updat equival mean new data scale rel old data invers factor thu mathdelta n updat new sampl rel weight mathsgamma n_n delta nn_ndelta n assum cover occur time continu next cover stage mathn scale mathgamma correspond multipli math mathgamma point math ge gamma rescal math ge ie overal rel weight new sampl rel old sampl still grow fast contrari math gamma defin exit initi stage initi stage mathn simpli grow sampl rate see eqeq eqawhwupd realli ensur mathsg hold exit sampl exit least sampl weight older sampl last cover stage extend suffici number updat _awhtarget choic target distribut target distribut mathrholambda tradit chosen uniform math rho_mathrmconstlambda mathrmconst label eqnawhuniformdist choic exactli flatten mathflambda userdefin sampl interv mathi gener mathrholambda lambdanotin certain case choic may prefer instanc multidimension case rectangular sampl interv like contain region high free energi eg atom clash exclud region mathrholambda specifi follow function free energi math rho_mathrmcutlambda propto frac eflambda f_mathrmcut label eqawhrhocut mathf_mathrmcut free energi cutoff rel mathmin_lambda flambda thu region sampl interv mathflambda f_mathrmcut exponenti suppress smooth fashion altern high free energi region could avoid still flatten moder free energi barrier target boltzmann distribut correspond scale mathbetak_bt factor maths_beta math rho_mathrmboltzlambda propto es_beta flambda label eqawhrhoboltz paramet maths_beta determin degre free energi landscap flatten lower maths_beta flatter note mathrho_mathrmcutlambda mathrho_mathrmboltzlambda depend mathflambda need substitut current best estim mathf_nlambda thu target distribut also updat consist eqeq eqawhgrhofrel fact altern approach obtain mathrho_mathrmboltzlambda limit target distribut awh particular way weight histogram mathwlambda target distribut mathrho updat coupl yield evolut bia potenti similar welltemp metadynam ref refbarducciwel see ref reflindahlacceler detail popular success welltemp metadynam special case worth consid case mathrho function refer weight histogram math rho_mathrmboltzloclambda propto wlambda label eqnawhweighthistogram updat weight histogram modifi cf eqeq eqawhwupd math w_nlambda w_nlambda s_betasum_t omegalambda xt label eqnawhupdateweighthist thu weight histogram equal real histori sampl scale maths_beta target distribut call local boltzmann sinc mathw modifi local sampl taken place see maths_beta approx histogram essenti grow size free energi updat stay constant valu origin formul metadynam thu free energi estim converg continu fluctuat around correct valu illustr inher coupl converg choic target distribut special choic target furthermor note use mathrhorho_mathrmboltzloc initi stage section refawhinitialstag rescal weight histogram appli initi stage global oper incompat mathrho_mathrmboltzloc depend local sampl histori lastli target distribut modul arbitrari probabl weight math rholambda rho_lambda w_mathrmuserlambda label eqnawhpropweigth mathw_mathrmuserlambda provid user data principl mathrho_lambda target distribut mention multipl independ share bias multipl independ bia potenti may appli within one simul make sens bias coordin mathxi mathxi mathldot evolv essenti independ one anoth typic exampl would appli independ bia monom protein furthermor multipl awh simul launch parallel set indepedend bias defin sampl interv larg rel diffus time reaction coordin travers sampl interv multipl time requir initi stage section refawhinitialstag may take infeas mount simul time case could advantag parallel work group multipl walker mathxiit share singl bia potenti achiev collect sampl mathxii share group singl histogram updat common free energi estim sampl share walker within simul andor multipl simul howev current share simul support code bias within simul independ note attempt shorten simul time use biasshar walker care must taken ensur simul still long enough properli explor equilibr region sampl interv begin walker group decorrel distribut approxim accord target distribut start refin free energi achiev eg equilibr share weight histogram let grow instanc mathwlambdanapprox rholambda toler furthermor cover transit criterion initi stage gener detect sampl interv collect travers one altern use criterion singl walker sampl see eqeq eqawhcov howev contrast singl walker case ensur real transit across sampl interv taken place principl walker could sampl local still cover whole interv standard umbrella sampl procedur free energi may appear converg realiti simul sampl closebi mathlambda valu sampl disconnect region phase space stricter criterion help avoid issu requir simul mark point mathlambda_mu along dimens mathmu visit share walker also point within certain diamet mathd_mathrmcov visit ie fulfil eqeq eqawhcov increas mathd_mathrmcov increas robust may slow converg maximum valu mathd_mathrmcov equal length sampl interv sampl interv consid cover least one walker independ travers sampl interv practic bias share set mdpawhsharemultisim true mdpawhsharegroup bia nonzero valu bia share simul share group valu share differ bia etc although use case use technic restrict share apart bias share need number grid point updat interv match note bias share within simul latter could use especi multimer protein difficult implement _awhreweight reweight combin bias data often one may want postsimul calcul unbias pmf mathphiu anoth variabl mathux mathphiu estim use mathxibias data reweight unbias trajectori use bia potenti mathu_nt see eqeq eqawhbiaspotenti essenti one bin bias data along mathu remov effect mathu_nt divid weight sampl mathut matheu_ntxit math hatphiu ln sum_t _uuteu_ntxit mathcalz_nt label eqawhunbia indic function math_u denot bin procedur math_uu mathu fall bin label mathu math otherwis normal factor mathmathcalz_n int ephixi u_nxid xi partit function extend ensembl seen mathmathcalz_n depend mathphixi pmf bias reaction coordin mathxi calcul written file awh simul advis use final stage data reweight procedur due rapid chang bia potenti initi stage one would includ initi stage data one use sampl weight infer repeat rescal histogram initi stage sake consist initi stage sampl would case heavili scale rel final stage sampl note eqeq eqawhunbia also use combin data multipl simul ad anoth sum also trajectori set furthermor multipl independ awh bias gener set pmf estim mathhatphiixi combin best estim mathhatphixi obtain appli selfconsist exponenti averag detail procedur deriv eqeq eqawhunbia use slightli differ notat found ref reflindahlsequ _awhfrict friction metric awh simul follow timeintegr forc correl function calcul math eta_munulambda beta int_infti frac leftdelta mathcalf_muxtlambda delta mathcalf_nuxlambda omegalambdaxt omegalambdaxright leftomegalambda xright dt label eqawhmetr mathmathc f_muxlambda k_mu xi_mux lambda_mu forc along dimens mathmu harmon potenti center mathlambda mathdelta mathcal f_muxlambda mathcal f_muxlambda leftmathc f_muxlambdaright deviat forc factor mathomegalambdaxt see eqeq eqawhomega reweight sampl matheta_munulambda friction tensor ref reflindahl ref refsivakthermodynam matrix element invers proport local diffus coeffici measur sampl ineffici mathlambda given math etafraclambda sqrtdeteta_munulambda label eqawhsqrtmetr larg valu mathetafraclambda indic slow dynam long correl time may requir sampl _awhusag usag awh store data energi file refedr frequenc set user data pmf convolv bia distribut mathlambda mathxi coordin etc extract simul use refgmx awh tool furthermor trajectori reaction coordin mathxit print pull output file mathtt pullxxvg log file reflog also contain inform check messag start awh tell cover potenti sampl issu set initi updat size initi valu weight histogram size mathn set initi updat size rate chang bia mathn kept constant like initi stage averag varianc free energi scale mathvarepsilon sim nd ref reflindahlacceler simpl model system constant diffus mathd along reaction coordin provid ballpark estim use awh initi mathn term meaning quantiti math fracn_ fracn_varepsilon_ fracdelta t_mathrmsampl max_d fracl_dd_d varepsilon_ label eqawhn mathl_d length interv mathd_d diffus constant along dimens mathd awh bia one dimens mathld averag time diffus distanc mathl take maximum cross time dimens involv bia essenti formula tell us slower system small mathd requir sampl larger mathn attain level accuraci mathvarepsilon_ given sampl rate convers system given diffus choos initi bias rate depend good initi accuraci initi error mathvarepsilon_ diffus mathd need roughli estim guess typic case one would tweak mathd paramet use default valu mathvarepsilon_ good converg mathd chosen larg possibl maintain stabl system give larg initi bia updat fast initi transit choos mathd small lead slow initi converg may good idea run short trial simul first cover check maximum free energi differ pmf estim much larger expect magnitud free energi barrier cross system probabl pull hard mathd decreas accur estim diffus obtain awh simul refgmx awh tool mathvarepsilon_ hand rough estim initi error tip effici sampl forc constant mathk larger curvatur pmf landscap case distribut reaction coordin mathxi refer coordin mathlambda differ significantli warn print log file one choos mathk larg time step support neccessarili increas number point discret sampl interv mathi gener howev affect perform simul notic awh updat implement sampl point access free energi updat time method choic reaction coordin critic singl reaction coordin suffic identifi second reaction coordin sampl twodimension landscap may help case use target distribut free energi cutoff see eqeq eqawhrhocut might requir avoid sampl uninterest region high free energi obtain accur free energi reaction coordin much higher dimension possibl gener feasibl monitor transit rate mathxit across sampl interv also advis reliabl statist eg reweight trajectori describ section refawhreweight one would gener want observ least transit exit initi stage furthermor dynam reaction coordin suddenli chang may sign eg reaction coordin problem difficult region sampl may also detect calcul friction tensor matheta_munulambda sampl interv see section refawhfrict matheta_munulambda well sampl effici measur mathetafraclambda eqeq eqawhsqrtmetr written energi file extract refgmx awh high peak mathetafraclambda indic region requir longer time sampl properli realli belong opinion use vmd plugin trajectori file io gromac tool abl use plugin found exist instal vmd_ order read write trajectori file format nativ gromac abl suppli amber dcdformat trajectori filenam directli gromac tool exampl requir vmd instal older version system provid dlopen function program determin run time plugin exist build share librari build gromac cmake find vmd execut path environ variabl vmddir configur run time locat plugin altern vmd_plugin_path use run time specifi path plugin found note plugin binari format format must match architectur machin attempt use interact molecular dynam gromac support interact molecular dynam imd protocol implement vmd_ control run simul namd imd allow monitor run gromac simul vmd client addit user interact simul pull atom residu fragment mous forcefeedback devic addit inform gromac implement exemplari gromac imd system found homepag httpwwwmpibpcmpgdegrubmuellerinteractivemd__ simul input prepar gromac implement allow transmiss interact part run simul eg case water molecul transmit pull group specifi via refmdp option imdgroup imdgroup empti imd protocol disabl enabl via switch refmdrun gmx mdrun interact entir system imdgroup set system use refgrompp gmx grompp refgro file use vmd input written imd switch refgrompp gmx grompp start simul commun vmd gromac achiev via tcp socket thu enabl control refmdrun gmx mdrun run local remot cluster port connect specifi imdport switch refmdrun gmx mdrun default port number smaller provid gromac automat assign free port use imd everi mathn step refmdrun gmx mdrun client receiv appli forc vmd send new posit client vmd permit increas decreas commun frequenc interact default simul start run even imd client connect behavior chang imdwait switch refmdrun gmx mdrun startup whenev client disconnect integr stop reconnect client imdterm switch use simul termin press stop button vmd disabl default final allow interact simul ie pull vmd imdpul switch use therefor simul monitor influenc vmd client none imdwait imdterm imdpul set howev sinc imd protocol requir authent advis run simul host directli reachabl insecur environ secur shell forward tcp use connect run simul directli reachabl interact host note imd command line switch refmdrun gmx mdrun hidden default show help text refgmx mdrun h hidden connect vmd vmd first structur correspond imd group load file mathrightarrow new molecul imd connect window use extens mathrightarrow simul mathrightarrow imd connect namd imd connect window hostnam port specifi follow press connect detach sim allow disconnect without termin simul stop sim end simul next neighbor search step allow imdterm timestep transfer rate allow adjust commun frequenc simul imd client set keep rate load everi mathnmathrmth frame vmd instead discard new one receiv display energi si unit contrast energi display namd simulationss _electr field electr field puls oscil electr field appli accord math et e_ expleftfractt_sigmarightcosleftomega tt_right label eqefield mathe_ field strength angular frequenc mathomega pi clambda matht_ time peak field strength mathsigma width puls special case occur mathsigma nonpuls field mathomega static field see mdpelectricfieldx detail simul laserpuls appli simul melt ice ref refcalemana puls electr field may look ike numreffig figfield support inform paper impact appli electr field system period boundari condit analyz describ effect electr field pbc larger appli field factor depend size box dielectr properti molecul box system static dielectr properti factor correct system dielectr vari time exampl membran protein pore open close simul way appli electr field use case one use comput electrophysiolog protocol describ next section sec refcompel _figfield figur plotsfield width cm simul laser puls gromac electr field appli follow option specifi refgrompp gmx grompp refmdp file specifi order mathe_ mathomega matht_ mathsigma electricfieldx yield static field mathe_ vnm xdirect contrast electricfieldx yield oscil electr field mathe_ vnm mathomega ps matht_ ps final electricfieldx yield pulsedoscil electr field mathe_ vnm mathomega ps matht_ ps mathsigma ps read ref ref refcalemana note input file format chang undocu older version figur like numreffig figfield may produc pass field option refgmx mdrun _densityguidedsimul appli forc threedimension densiti densityguid simul addit forc appli atom depend gradient similar simul densiti refer densiti appli forc protein structur made fit densiti eg cryo electronmicroscopi implement approach extend one describ ref reforzechowski ref refigaev overview forc appli depend forward model describ atom posit translat simul densiti mathrhomathrmsimmathbfr similar measur describ close simul densiti refer densiti mathrhomathrmref mathsrhomathrmrefrhomathrmsimmathbfr scale forc forc constant mathk result effect potenti energi math u u_mathrmforcefieldmathbfr k srhomathrmrefrhomathrmsimmathbfrmathrm label eqndenson correspond densiti base forc ad simul math mathbff_mathrmdens k nabla_mathbfr srhomathrmrefrhomathrmsimmathbfrmathrm label eqndenstwo deriv decompos similar measur deriv simul densiti model deriv sum densiti voxel mathmathbfv math mathbff_mathrmdens k sum_mathbfvpartial_rho_mathbfvmathrmsim srhomathrmrefrhomathrmsim cdot nabla_mathbfr rho_mathbfvmathrmsimmathbfrmathrm label eqndensthre thu densityguid simul forc calcul base comput simul densiti deriv respect atom posit well densitydens deriv simul refer densiti usag densityguid simul control set mdp option provid refer densiti map file addit tpr option relat densityguid simul prefix densityguidedsimul set densityguidedsimulationact ye trigger densityguid simul default paramet caus atom move refer densiti simul densiti forc contribut atom spread onto regular threedimension lattic refer densiti spread atom onto grid discret gauss transform use simul densiti atom posit mathmathbfr_i voxel coordin mathmathbfv math rho_mathbfv sum_i a_i fracsqrtpisigma expfracmathbfr_imathbfv sigmamathrm label eqndensfour matha_i amplitud determin per atom type may atom mass partial charg uniti atom width gaussian spread function determin mathsigma recommend use spread width smaller grid space refer densiti factor densiti forc math nabla_r rho_mathbfvmathrmsimmathbfr sum_i a_i fracmathbfr_imathbfvsigma fracsqrtpisigma expfracmathbfr_imathbfv sigmamathrm label eqndensf densiti similar measur forc contribut multipl valid similar measur refer densiti simul densiti motiv experiment sourc refer densiti data densityguid simul gromac follow measur provid inner product simul densiti math s_mathrminnerproductrhomathrmrefrhomathrmsim fracn_mathrmvoxelsum_vn_mathrmvoxel rhomathrmref_v rhomathrmsim_vmathrm label eqndenssix neg rel entropi two densiti math s_mathrmrelativeentropyrhomathrmrefrhomathrmsim sum_v rhomathrmref rhomathrmsimn_mathrmvoxel rhomathrmref logrhomathrmsim_vlogrhomathrmref_vmathrm label eqndensseven cross correl two densiti math s_mathrmcrosscorrelationrhomathrmrefrhomathrmsim fracsum_vleftrho_vmathrmref barrhomathrmrefrho_vmathrmsim barrhomathrmsimright sqrtsum_vrho_vmathrmref barrhomathrmref sum_vrho_vmathrmsim barrhomathrmsimmathrm label eqndenscrosscorr declar region fit subset atom may chosen preprocess simul densityguid simul forc appli atom gener simul densiti compar refer densiti perform follow factor affect perform densityguid simul number atom densityguid simul group mathn_mathrmatom spread rang multipl gaussian width mathn_mathrmsigma ratio spread width input densiti grid space mathr_mathrmsigma number voxel input densiti mathn_mathrmvoxel frequenc forc calcul mathn_mathrmforc commun cost use multipl rank reflect constant mathc_mathrmcomm overal cost densityguid simul approxim proport math fracn_mathrmforc leftn_mathrmatomsleftn_mathrmsigmar_mathrmsigmaright c_mathrmcommn_mathrmvoxelrightmathrm label eqndenseight appli forc everi nth step cost appli forc everi integr step reduc appli densityguid simul forc everi mathn step appli forc scale mathn approxim effect hamiltonian appli forc everi step maintain timerevers energi conserv note set energi output frequenc must multipl mathn maxim timestep exceed fastest oscil period atom within map potenti divid mathpi oscil period depend choic refer densiti similar measur forc constant thu hard estim directli observ order picosecond typic cryo electronmicroscopi data result densityguidedsimulationnst set order combin densityguid simul pressur coupl note contribut forc densityguid simul system virial account size effect pressurecoupl algorithm grow total sum densityguid simul forc well angular momentum introduc forc densityguid simul minim effect align structur densiti run pressurecoupl simul addit appli forc everi nth step work current implement infrequ evalu pressur coupl constraint virial period boundari condit treatment period imag one closest center densiti map consid refer densiti map format refer input densiti given mrc format accord emdb map distribut format descript version c emdatabankorg close relat format like ccp map might work awar differ visual softwar handl map format differ simul refer densiti interpret visualis vmd output energi output file contain addit densityfit term energi ad system densityguid simul lower energi higher similar simul refer densiti adapt forc constant scale enabl steadi increas similar refer simul densiti use littl forc possibl adapt forc scale decreas forc constant similar increas vice versa avoid larg fluctuat forc constant chang similar measur exponenti move averag smoothen time seri similar measur time constant mathtau given ps exponenti move averag similar increas forc constant scale divid mathdelta t_mathrmdensitytau mathdelta t_mathrmdens time densiti guid simul step convers similar refer simul densiti decreas forc constant increas multipli mathdelta t_mathrmdensitytau note adapt forc scale conserv energi ultim lead high forc similar increas map input structur densiti data affin transform align input structur densiti data transform matrix mathmathbfa shift vector mathmathbfv_mathrmshift may defin transform input structur atom coordin evalu densityguidedsimul energi forc math u u_mathrmforcefieldmathbfr k srhomathrmrefrhomathrmsimmathbfa mathbfrmathbfv_mathrmshiftmathrm label eqndensnin math mathbff_mathrmdens k nabla_mathbfr srhomathrmrefrhomathrmsimmathbfa mathbfrmathbfv_mathrmshiftmathrm label eqndensten affin transform may use amongst thing perform rotat eg around zaxi angl maththeta use mathabeginpmatrix co theta sin theta sin theta co theta endpmatrix project eg onto zaxi use mathabeginpmatrix endpmatrix allow densityguid simul steer densityprofil along axi scale structur densiti factor math use mathabeginpmatrix endpmatrix prove use eg voxels cryoem densiti adjust arbitrari combin matrix multipl note matrix multipl commut futur develop similar measur might ad futur along differ method determin atom amplitud autom choos forc constant well align input densiti map structur might provid enforc rotat modul use enforc rotat group atom eg protein subunit varieti rotat potenti among complex one allow flexibl adapt rotat subunit well local rotat axi simul exampl applic found ref ref refkutzn _figrot figur plotsrot width cm comparison fix flexibl axi rotat rotat sketch shape insid white tubular caviti creat artifact fix rotat axi dash use realist shape would revolv like flexibl pipeclean dot insid bear gray b fix rotat around axi mathmathbfv pivot point specifi vector mathmathbfu c subdivid rotat fragment slab separ rotat axe mathuparrow pivot point mathbullet slab allow flexibl distanc two slab indic mathn mathn mathdelta x _figequipotenti figur plotsequipotenti width cm select differ rotat potenti definit notat four potenti mathv color code shown singl atom posit mathmathbfx_jt isotrop potenti mathvmathrmiso b radial motion potenti mathvmathrmrm flexibl potenti mathvmathrmflex cd radial motion potenti mathvmathrmrm flexibl potenti mathvmathrmflex mathepsilonmathrm mathrm nm c mathepsilonmathrm mathrmnm rotat axi perpendicular plane mark mathotim light gray contour indic boltzmann factor mathevk_b mathmathbfx_jplan matht k mathkmathrm mathrmkjmathrmmol cdotmathrmnm green arrow show direct forc mathmathbff_j act atom mathj blue dash line indic motion refer posit fix axi rotat stationari axi isotrop potenti fix axi approach see numreffig b figrot torqu group mathn atom posit mathmathbfx_i denot rotat group appli rotat refer set atom posit usual initi posit mathmathbfy_i constant angular veloc mathomega around axi defin direct vector mathhatmathbfv pivot point mathmathbfu aim atom posit mathmathbfx_i attract virtual spring potenti move refer posit mathmathbfy_i mathbfomegat mathbfy_i mathbfu mathmathbfomegat matrix describ rotat around axi simplest case spring describ harmon potenti math vmathrmiso frack sum_in w_i left mathbfomegat mathbfy_i mathbfu mathbfx_i mathbfu right label eqnpotiso option massweight prefactor mathw_i n m_im total mass mathm sum_in m_i rotat matrix mathmathbfomegat math mathbfomegat left beginarrayccc cosomega v_xxi v_x v_yxi v_zsinomega v_x v_zxi v_ysinomega v_x v_yxi v_zsinomega cosomega v_yxi v_i v_zxi v_xsinomega v_x v_zxi v_ysinomega v_i v_zxi v_xsinomega cosomega v_zxi endarray right label eqnrotmat mathv_x mathv_i mathv_z compon normal rotat vector mathhatmathbfv mathxi cosomega illustr numreffig figequipotenti singl atom mathj rotat matrix mathmathbfomegat oper initi refer posit mathmathbfy_j mathbfx_jt_ atom mathj mathtt_ later time matht refer posit rotat away initi place along blue dash line result forc math mathbff_jmathrmiso nabla_j vmathrmiso k w_j left mathbfomegat mathbfy_j mathbfu mathbfx_j mathbfu right label eqnforcefix direct toward refer posit pivotfre isotrop potenti instead fix pivot vector mathmathbfu potenti use center mass mathmathbfx_c rotat group pivot rotat axi math mathbfx_c fracm sum_in m_i mathbfx_i mboxand mathbfy_c fracm sum_in m_i mathbfy_i label eqncom yield pivotfre isotrop potenti math vmathrmisopf frack sum_in w_i left mathbfomegat mathbfy_i mathbfy_c mathbfx_i mathbfx_c right label eqnpotisopf forc math mathbff_jmathrmisopf k w_j left mathbfomegat mathbfy_j mathbfy_c mathbfx_j mathbfx_c right label eqnforceisopf without massweight pivot mathmathbfx_c geometr center group parallel motion potenti variant forc gener isotrop potenti eqn eq eqnpotiso eq eqnpotisopf also contain compon parallel rotat axi therebi restrain motion along axi either whole rotat group case mathvmathrmiso within rotat group case mathvmathrmisopf case unrestrain motion along axi prefer implement parallel motion variant elimin compon parallel rotat axi potenti achiev project distanc vector refer actual posit math mathbfr_i mathbfomegat mathbfy_i mathbfu mathbfx_i mathbfu label eqnrotdistvector onto plane perpendicular rotat vector math mathbfr_iperp mathbfr_i mathbfr_i cdot hatmathbfvhatmathbfv label eqnproject yield math beginalign nonumb vmathrmpm frack sum_in w_i mathbfr_iperp frack sum_in w_i leftlbrac mathbfomegat mathbfy_i mathbfu mathbfx_i mathbfu right nonumb left leftlbrac left mathbfomegatmathbfy_i mathbfu mathbfx_i mathbfu right cdothatmathbfv rightrbracehatmathbfv rightrbrac endalign label eqnpotpm similarli math mathbff_jmathrmpm k w_j mathbfr_jperp label eqnforcepm pivotfre parallel motion potenti replac eqn eq eqnpotpm fix pivot mathmathbfu center mass mathmathbfx_c yield pivotfre variant parallel motion potenti math mathbfs_i mathbfomegat mathbfy_i mathbfy_c mathbfx_i mathbfx_c label eqnparrallelpotenti respect potenti forc math beginalign vmathrmpmpf frack sum_in w_i mathbfs_iperp endalign label eqnpotpmpf math beginalign mathbff_jmathrmpmpf k w_j mathbfs_jperp endalign label eqnforcepmpf radial motion potenti variant minimum rotat potenti either singl point refer posit mathmathbfy_i isotrop potenti singl line mathmathbfy_i parallel rotat axi parallel motion potenti result radial forc restrict radial motion atom two subsequ type rotat potenti mathvmathrmrm mathvmathrmrm drastic reduc even elimin effect first variant mathvmathrmrm numreffig b figequipotenti elimin forc compon parallel vector connect refer atom rotat axi math vmathrmrm frack sum_in w_i left mathbfp_i cdotmathbfx_i mathbfu right label eqnpotrm math mathbfp_i frachatmathbfvtim mathbfomegat mathbfy_i mathbfu hatmathbfvtim mathbfomegat mathbfy_i mathbfu label eqnpotrmpart variant depend distanc mathmathbfp_i cdot mathbfx_i mathbfu atom mathi plane span mathhatmathbfv mathmathbfomegatmathbfy_i mathbfu result forc math mathbff_jmathrmrm k w_j left mathbfp_jcdotmathbfx_j mathbfu right mathbfp_j label eqnpotrmforc pivotfre radial motion potenti proceed similar pivotfre isotrop potenti yield pivotfre version potenti math mathbfq_i frachatmathbfvtim mathbfomegat mathbfy_i mathbfy_c hatmathbfvtim mathbfomegat mathbfy_i mathbfy_c label eqnpotrmpfpart potenti forc pivotfre variant radial motion potenti read math beginalign vmathrmrmpf frack sum_in w_i left mathbfq_i cdotmathbfx_i mathbfx_c right endalign label eqnpotrmpf math beginalign mathbff_jmathrmrmpf k w_j left mathbfq_jcdotmathbfx_j mathbfx_c right mathbfq_j k fracm_jm sum_in w_i left mathbfq_icdotmathbfx_i mathbfx_c rightmathbfq_i endalign label eqnpotrmpfforc radial motion altern potenti seen numreffig b figequipotenti forc result mathvmathrmrm still contain small secondord radial compon case perturb toler follow altern mathvmathrmrm fulli elimin radial contribut forc depict numreffig c figequipotenti math vmathrmrm frack sum_in w_i fracleft hatmathbfv time mathbfx_i mathbfu cdot mathbfomegatmathbfy_i mathbfu right hatmathbfv time mathbfx_i mathbfu epsilon label eqnpotrm small paramet mathepsilon introduc avoid singular mathepsilonmathrm mathrmnm equipotenti plane span mathmathbfx_i mathbfu mathhatmathbfv yield forc perpendicular mathmathbfx_i mathbfu thu contract expand structur part move away toward rotat axi choos small posit mathepsilon eg mathepsilonmathrm mathrmnm numreffig figequipotenti denomin eqn eq eqnpotrm yield welldefin potenti continu forc also close rotat axi case mathepsilonmathrm mathrmnm numreffig c figequipotenti math beginalign mathbfr_i mathbfomegatmathbfy_i mathbfu mathbfs_i frachatmathbfv time mathbfx_i mathbfu hatmathbfv time mathbfx_i mathbfu equiv psi_i hatmathbfv time mathbfx_imathbfu psi_i frac hatmathbfv time mathbfx_imathbfu epsilonendalign label eqnpotrmforcepart forc atom mathj read math mathbff_jmathrmrm k leftlbrac w_j mathbfs_jcdotmathbfr_j left fracpsi_j psi_j mathbfr_j fracpsi_j psi_j mathbfs_jcdotmathbfr_jmathbfs_j right rightrbrac time hatmathbfv label eqnpotrmforc pivotfre radial motion potenti pivotfre variant potenti math vmathrmrmpf frack sum_in w_i fracleft hatmathbfv time mathbfx_i mathbfx_c cdot mathbfomegatmathbfy_i mathbfy_c right hatmathbfv time mathbfx_i mathbfx_c epsilon label eqnpotrmpf math beginalign mathbfr_i mathbfomegatmathbfy_i mathbfy_c mathbfs_i frachatmathbfv time mathbfx_i mathbfx_c hatmathbfv time mathbfx_i mathbfx_c equiv psi_i hatmathbfv time mathbfx_imathbfx_c psi_i frac hatmathbfv time mathbfx_imathbfx_c epsilonendalign label eqnpotrmpfpart forc atom mathj read math beginalign nonumb mathbff_jmathrmrmpf k leftlbrac w_j mathbfs_jcdotmathbfr_j left fracpsi_j psi_j mathbfr_j fracpsi_j psi_j mathbfs_jcdotmathbfr_jmathbfs_j right rightrbrac time hatmathbfv kfracm_jm leftlbrac sum_in w_imathbfs_icdotmathbfr_i left fracpsi_i psi_i mathbfr_i fracpsi_i psi_i mathbfs_icdotmathbfr_i mathbfs_i right rightrbrac time hatmathbfv endalign label eqnpotrmpfforc flexibl axi rotat sketch numreffig figrot ab rigid bodi behavior fix axi rotat scheme drawback mani applic particular deform rotat group suppress equilibrium atom posit directli depend refer posit avoid limit eqn eq eqnpotrmpf eq eqnpotrmpf gener toward flexibl axi sketch numreffig c figrot achiev subdivid rotat group set equidist slab perpendicular rotat vector appli separ rotat potenti slab numreffig c figrot show midplan slab dot straight line center thick black dot avoid discontinu potenti forc defin soft slab weigh contribut slab mathn total potenti function mathvmathrmflex gaussian function math g_nmathbfx_i gamma mboxexp left fracbeta_nmathbfx_isigma right label eqngaussian center midplan mathn th slab mathsigma width gaussian function mathdelta x distanc adjac slab math beta_nmathbfx_i mathbfx_i cdot hatmathbfv n delta x label eqngaussianpart _figgaussian figur plotsgaussian width cm gaussian function mathg_n center mathn delta x slab distanc mathdelta x nm mathn geq gaussian function mathg_ highlight bold dash line depict sum shown gaussian function conveni choic mathsigma delta x math gamma sum_n z mboxexp leftfracn fraccdot right approx label eqngaussianpart yield nearli constant sum essenti independ mathmathbfx_i dash line numreffig figgaussian ie math sum_n z g_nmathbfx_i epsilonmathbfx_i label eqnnorm math epsilonmathbfx_i cdot choic also impli individu contribut forc slab add uniti normal requir slab center mathmathbfx_cn atom contribut gaussianweight option also massweight posit vector mathg_nmathbfx_i mathbfx_i instantan slab center mathmathbfx_cn calcul current posit mathmathbfx_i math mathbfx_cn fracsum_in g_nmathbfx_i m_i mathbfx_i sum_in g_nmathbfx_i m_i label eqndefx refer center mathmathbfy_cn calcul refer posit mathmathbfy_i math mathbfy_cn fracsum_in g_nmathbfy_i m_i mathbfy_i sum_in g_nmathbfy_i m_i label eqndefi due rapid decay mathg_n slab essenti involv contribut atom locat within mathapprox delta x slab center flexibl axi potenti consid two flexibl axi variant first variant slab segment procedur gaussian weight appli radial motion potenti eqn eq eqnpotrmpf numreffig b figequipotenti yield contribut slab mathn math vn frack sum_in w_i g_nmathbfx_i left mathbfq_in cdot mathbfx_i mathbfx_cn right label eqnflexpot total potenti function math vmathrmflex sum_n vn label eqnpotflex note global center mass mathmathbfx_c use eqn eq eqnpotrmpf replac mathmathbfx_cn center mass slab math beginalign mathbfq_in frachatmathbfv time mathbfomegatmathbfy_i mathbfy_cn hatmathbfv time mathbfomegatmathbfy_i mathbfy_cn b_in mathbfq_in cdot mathbfx_i mathbfx_cn endalign label eqnflexpotpart result forc atom mathj read math beginalign nonumberhspacemm mathbff_jmathrmflex k w_j sum_n g_nmathbfx_j b_jn leftlbrac mathbfq_jn b_jn fracbeta_nmathbfx_jsigma hatmathbfv rightrbrac k m_j sum_n fracg_nmathbfx_jsum_h g_nmathbfx_h sum_in w_i g_nmathbfx_i b_in leftlbrac mathbfq_in fracbeta_nmathbfx_jsigma left mathbfq_in cdot mathbfx_j mathbfx_cn right hatmathbfv rightrbrac endalign label eqnpotflexforc note mathvmathrmflex defin slab fix space refer center mathmathbfy_cn simul rotat group move far mathmathbfv direct may enter region due lack nearbi refer posit refer slab center defin render potenti evalu imposs therefor includ slightli modifi version potenti avoid problem attach midplan slab mathn center mass rotat group yield slab move rotat group achiev subtract center mass mathmathbfx_c group posit math tildemathbfx_i mathbfx_i mathbfx_c mbox tildemathbfy_i mathbfy_i mathbfy_c label eqntrafo math beginalign vmathrmflext frack sum_n sum_in w_i g_ntildemathbfx_i left frachatmathbfv time mathbfomegattildemathbfy_i tildemathbfy_cn hatmathbfv time mathbfomegattildemathbfy_i tildemathbfy_cn cdot tildemathbfx_i tildemathbfx_cn right endalign label eqnpotflext simplifi forc deriv effici reason assum mathmathbfx_c constant thu mathparti mathbfx_c partial x partial mathbfx_c partial partial mathbfx_c partial z result forc error small order mathon mathom_jm massweight appli therefor toler assumpt forc mathmathbffmathrmflext form eqn eq eqnpotflexforc flexibl axi altern potenti second variant slab segment appli mathvmathrmrm eqn eq eqnpotrmpf result flexibl axi potenti without radial forc contribut numreffig c figequipotenti math vmathrmflex frack sum_in sum_n w_ig_nmathbfx_i fracleft hatmathbfv time mathbfx_i mathbfx_cn cdot mathbfomegatmathbfy_i mathbfy_cn right hatmathbfv time mathbfx_i mathbfx_cn epsilon label eqnpotflex math beginalign mathbfr_in mathbfomegatmathbfy_i mathbfy_cn mathbfs_in frachatmathbfv time mathbfx_i mathbfx_cn hatmathbfv time mathbfx_i mathbfx_cn equiv psi_i hatmathbfv time mathbfx_imathbfx_cn psi_i frac hatmathbfv time mathbfx_imathbfx_cn epsilon w_jn fracg_nmathbfx_jm_jsum_h g_nmathbfx_hm_h mathbfsn sum_in w_ig_nmathbfx_i mathbfs_incdotmathbfr_in left fracpsi_i psi_i mathbfr_in fracpsi_i psi_i mathbfs_incdotmathbfr_in mathbfs_in right endalign label eqnsn forc atom mathj read math beginalign nonumb mathbff_jmathrmflex k leftlbrac sum_n w_jg_nmathbfx_j mathbfs_jncdotmathbfr_jn left fracpsi_j psi_j mathbfr_jn fracpsi_j psi_j mathbfs_jncdotmathbfr_jn mathbfs_jn right rightrbrac time hatmathbfv nonumb k leftlbrac sum_n w_jn mathbfsn rightrbrac time hatmathbfv k leftlbrac sum_n w_jn fracbeta_nmathbfx_jsigma fracpsi_j mathbfs_jn cdot mathbfsn rightrbrac hatmathbfv frack leftlbrac sum_n w_jg_nmathbfx_j fracbeta_nmathbfx_jsigma fracpsi_jpsi_j mathbfs_jn cdot mathbfr_jn rightrbrac hatmathbfv endalign label eqnpotflexforc appli transform eq eqntrafo yield translationtoler version flexibl potenti mathvmathrmflex assum mathparti mathbfx_c partial x mathparti mathbfx_c partial mathparti mathbfx_c partial z small result equat mathvmathrmflex mathmathbffmathrmflex similar mathvmathrmflex mathmathbffmathrmflex usag appli enforc rotat particl mathi subject one rotat potenti defin via index group rotgroup rotgroup etc refmdp input file refer posit mathmathbfy_i read special reftrr file provid refgrompp gmx grompp file found mathmathbfx_it use refer posit written reftrr use subsequ setup paramet potenti mathk mathepsilon etc numreft tabvar provid refmdp paramet rottyp select type potenti option rotmassw allow choos whether use massweight averag flexibl potenti cutoff valu mathg_nmathrmmin typic mathg_nmathrmmin make sure signific contribut mathv mathmathbff evalu ie term mathg_nmathbfx g_nmathrmmin omit numreft tabquant summar observ written addit output file describ rotiso replac v mathmathrmiso rotisopf replac v mathmathrmisopf rotpm replac v mathmathrmpm rotpmpf replac v mathmathrmpmpf rotrm replac v mathmathrmrm rotrmpf replac v mathmathrmrmpf rotrm replac v mathmathrmrm rotrmpf replac v mathmathrmrmpf rotfl replac v mathmathrmflex rotflt replac v mathmathrmflext rotfl replac v mathmathrmflex rotflt replac v mathmathrmflext kunit replac mathfracmathrmkjmathrmmol cdot mathrmnm bfx replac x kma replac mathk vecv replac mathhatmathbfv vecu replac mathmathbfu omeg replac mathomega epsp replac mathepsilon delx replac mathdeltax gmin replac mathg_nmathrmmin cip replac mathcirc ps nm replac nm math ref replac eqeqnpotiso ref replac eqeqnpotisopf ref replac eqeqnpotpm ref replac eqeqnpotpmpf ref replac eqeqnpotrm ref replac eqeqnpotrmpf ref replac eqeqnpotrm ref replac eqeqnpotrmpf ref replac eqeqnpotflex ref replac eqeqnpotflext ref replac eqeqnpotflex _tabvar tabl paramet use variou rotat potenti bfx indic paramet actual use given potenti width auto align center paramet kma vecv vecu omeg epsp delx gmin refmdp input variabl name k vec pivot rate ep slabdist mingauss unit kunit nm cip nm nm fix axi potenti eqn isotrop rotiso ref bfx bfx bfx bfx pivotfre rotisopf ref bfx bfx bfx parallel motion rotpm ref bfx bfx bfx bfx pivotfre rotpmpf ref bfx bfx bfx radial motion rotrm ref bfx bfx bfx bfx pivotfre rotrmpf ref bfx bfx bfx radial motion rotrm ref bfx bfx bfx bfx bfx pivotfre rotrmpf ref bfx bfx bfx bfx flexibl axi potenti eqn flexibl rotfl ref bfx bfx bfx bfx bfx transl tol rotflt ref bfx bfx bfx bfx bfx flexibl rotfl ref bfx bfx bfx bfx bfx bfx transl tol rotflt bfx bfx bfx bfx bfx bfx vt replac mathvt thet replac maththeta_ mathrmreft thetav replac maththeta_mathrmavt thetfit replac maththeta_mathrmfitt maththeta_mathrmfittn yvec replac mathmathbfy_n mathmathbfx_tn taut replac mathtaut tautn replac mathtautn reft replac numrefse tabl tabvar refeq replac maththeta_mathrmreftomega ref replac eqeqnavangl ref replac eqeqnrmsdfit ref replac eqeqndefx eqeqndefi ref replac eqeqntorqu _tabquant tabl quantiti record output file enforc rotat simul slabwis data written everi nstsout step rotat data everi nstrout step width auto align center quantiti unit equat output file fix flexibl vt kjmol reft rotat bfx bfx thet degre refeq rotat bfx bfx thetav degre ref rotat bfx thetfit degre ref rotangl bfx yvec nm ref rotslab bfx taut kjmol ref rotat bfx tautn kjmol ref rottorqu bfx angl rotat group fix axi fix axi rotat averag angl maththeta_mathrmavt group rel refer group determin via distanceweight angular deviat rotat group atom refer posit math theta_mathrmav left sum_in r_i theta_i right sum_in r_i label eqnavangl mathr_i distanc refer posit rotat axi differ angl maththeta_i determin atom posit project onto plane perpendicular rotat axi pivot point mathmathbfu see eqn eq eqnproject definit mathperp math co theta_i fracmathbfy_imathbfuperp cdot mathbfx_imathbfuperp mathbfy_imathbfuperp cdot mathbfx_imathbfuperp label eqnavanglepart sign maththeta_mathrmav chosen maththeta_mathrmav actual structur rotat ahead refer angl rotat group flexibl axi flexibl axi rotat two output provid angl entir rotat group separ angl segment slab angl entir rotat group determin rmsd fit mathmathbfx_i refer posit mathmathbfy_i matht yield maththeta_mathrmfit angl refer rotat around mathhatmathbfv optim fit math mathrmrmsd big mathbfx_i mathbfomegatheta_mathrmfit mathbfy_i big stackrel mathrmmin label eqnrmsdfit determin local angl slab mathn refer actual posit weight gaussian function slab mathn maththeta_mathrmfittn calcul eqn eq eqnrmsdfit gaussianweight posit angl refmdp input option rotfitmethod control whether normal rmsd fit perform whether fit posit mathmathbfx_i put distanc rotat axi refer counterpart mathmathbfy_i latter case rmsd measur angular differ radial one angl determin search energi minimum altern rotfitmethod potenti angl rotat group determin angl rotat potenti energi minim therefor use rotat potenti addit evalu set angl around current refer angl case rotangleslog output file contain valu rotat potenti chosen set angl rotationxvg list angl minim potenti energi torqu torqu mathmathbftaut exert rotat potenti calcul fix axi rotat via math mathbftaut sum_in mathbfr_it time mathbff_iperpt label eqntorqu mathmathbfr_it distanc vector rotat axi mathmathbfx_it mathmathbff_iperpt forc compon perpendicular mathmathbfr_it mathhatmathbfv flexibl axi rotat torqu mathmathbftau_n calcul slab use local rotat axi slab gaussianweight posit _rmfast remov fastest degre freedom maximum time step md simul limit smallest oscil period found simul system bondstretch vibrat quantummechan ground state therefor better repres constraint instead harmon potenti remain degre freedom shortest oscil period measur simul fs bondangl vibrat involv hydrogen atom take guidelin verlet leapfrog integr scheme minimum numer integr step perform per period harmon oscil order integr reason accuraci maximum time step fs disregard fast oscil period fs next shortest period around fs allow maximum time step fs remov bondangl degre freedom hydrogen atom best done defin virtual interact site instead normal atom wherea normal atom connect molecul bond angl dihedr virtual site posit calcul posit three nearbi heavi atom predefin manner see also sec refvirtualsit hydrogen water hydroxyl sulfhydryl amin group degre freedom remov rotat freedom preserv option avail slow motion increas mass hydrogen atom expens mass connect heavi atom increas moment inertia water molecul hydroxyl sulfhydryl amin group without affect equilibrium properti system without affect dynam properti much construct shortli describ sec refvsitehydro previous describ full detail ref reffeenstra use virtual site modifi mass next bottleneck like form improp dihedr use preserv planar chiral molecular group peptid dihedr peptid dihedr chang without affect physic behavior protein improp dihedr preserv planar mostli deal aromat residu bond angl dihedr residu also replac somewhat elabor virtual site construct modif describ section perform use gromac topolog build tool refpdbgmx gmx pdbgmx separ option exist increas hydrogen mass virtual hydrogen atom also virtual aromat ring standard residu note hydrogen atom virtual insid aromat residu virtual well ie hydrogen aromat residu treat differ depend treatment aromat residu note virtual aromat ring deprec paramet virtual site construct hydrogen atom infer forcefield paramet vi bond length angl directli refgrompp gmx grompp process topolog file construct aromat residu base bond length angl geometri describ forc field paramet hardcod refpdbgmx gmx pdbgmx due complex natur construct need whole aromat group _vsitehydro hydrogen bondangl vibrat construct virtual site _figvsitehydro figur plotsdumtyp width cm differ type virtual site construct use hydrogen atom atom use construct virtual site depict black circl virtual site gray one hydrogen smaller heavi atom fix bond angl note hydrogen virtual site b plane three atom fix distanc c plane three atom fix angl distanc construct amin group nh math_ nh math_ see text detail goal defin hydrogen atom virtual site remov highfrequ degre freedom case degre freedom hydrogen atom remov eg case hydroxyl amin group rotat freedom hydrogen atom preserv care taken unwant correl introduc construct virtual site eg bondangl vibrat construct atom could translat hydrogen bondlength vibrat addit sinc virtual site definit massless order preserv total system mass mass hydrogen atom treat virtual site ad bond heavi atom take account consider hydrogen atom protein natur fall sever categori requir differ approach see also numreffig figvsitehydro hydroxyl oh sulfhydryl sh hydrogen intern degre freedom hydroxyl group constrain bend coh angl angl fix defin addit bond appropri length see numreffig afigvsitehydro remov highfrequ angl bend leav dihedr rotat freedom goe sulfhydryl group note case hydrogen treat virtual site singl amin amid nh aromat hydrogen ch posit hydrogen construct linear combin bond vector flexibl angl heavi atom instead hydrogen atom posit fix distanc bond heavi atom line go bond heavi atom point line second bond atom see numreffig bfigvsitehydro planar amin nhmath_ hydrogen method use singl amid hydrogen well suit planar amin group suitabl two heavi atom found defin direct hydrogen atom instead hydrogen construct fix distanc nitrogen atom fix angl carbon atom plane defin one heavi atom see numreffig cfigvsitehydro amin group umbrella nhmath_ nhmath_ hydrogen amin hydrogen rotat freedom construct virtual site heavi atom connect sinc would result loss rotat freedom amin group preserv rotat freedom remov hydrogen bondangl degre freedom two dummi mass construct total mass moment inertia rotat around cn bond center mass amin group dummi mass interact atom except fact connect carbon result rigid triangl three particl posit nitrogen hydrogen atom construct linear combin two carbonmass vector outer product result amin group rotat freedom intact without intern degre freedom see numreffig dfigvsitehydro figur plotsdumaro width cm differ type virtual site construct use aromat residu atom use construct virtual site depict black circl virtual site gray one hydrogen smaller heavi atom phenylalanin b tyrosin note hydroxyl hydrogen virtual site c tryptophan histidin outofplan vibrat aromat group planar arrang side chain aromat residu lend perfectli virtualsit construct give perfectli planar group without inher unstabl constraint necessari keep normal atom plane basic approach defin three atom dummi mass constraint fix geometri creat rest atom simpl virtual site type see sec refvirtualsit three aromat residu requir differ approach phenylalanin c math_gamma c math_epsilon c math_epsilon kept normal atom mass one third total mass phenyl group see numreffig afigvsitehydro tyrosin ring treat ident phenylalanin ring addit constraint defin c math_epsilon c math_epsilon math_eta origin improp dihedr angl keep triangl one ring one math_eta plane due larger moment inertia construct much stabl bondangl hydroxyl group constrain constraint c math_gamma h math_eta note hydrogen treat virtual site see numreffig bfigvsitehydro tryptophan c math_beta kept normal atom two dummi mass creat center mass ring mass equal total mass respect ring c math_delta c math_epsilon count half ring keep overal center mass moment inertia almost quit equal see numreffig cfigvsitehydro histidin c math_gamma c math_epsilon n math_epsilon kept normal atom mass redistribut center mass ring preserv see numreffig dfigvsitehydro _qmmm hybrid quantumclass simul qmmm cpk interfac molecular mechan mm forc field influenc electron express empir paramet assign basi experiment data basi result highlevel quantum chemistri calcul valid ground state given coval structur mm approxim usual suffici accur groundstat process overal connect atom system remain unchang howev process connect chang chemic reaction process involv multipl electron state photochem convers electron longer ignor quantum mechan descript requir least part system reaction take place one approach simul chemic reaction solut enzym use combin quantum mechan qm molecular mechan mm react part system treat quantum mechan remaind model use forc field current version gromac provid interfac popular quantum chemistri packag cpk ref refcpk overview gromac interact qm mm subsystem handl use geep approach describ laino et al ref reflaino method evalu interact qm mm subsystem variant electrostat embed scheme electrostat interact electron qm region mm atom qm nuclei mm atom explicitli includ hamiltonian qm subsystem math hqmmm hqm_esum_insum_jmfraceq_jpiepsilon_r_ijsum_ansum_jmfracez_aq_jepiepsilon_r_aj mathn mathn number electron nuclei qm region respect mathm number charg mm atom first term right hand side origin electron hamiltonian isol qm system first doubl sum total electrostat interact qm electron mm atom total electrostat interact qm nuclei mm atom given second doubl sum import advantag use cpkgeep combin allow evalu forc qmqm qmmm interact case system period boundari condit pbc avoid doubl account electrostat interact lj classic mm charg qm atom zero well lj interact qmqm atom exclud note lj interact qmmm atom kept still calcul gromac bond interact qm mm atom describ mm level appropri forcefield term bond consist qm atom angl settl contain qm atom dihedr contain qm atom exclud forcefield evalu broken chemic bond qm mm subsystem need cap qm calcul done within cpk ad hydrogen atom complet valenc qm region forc atom present qm region distribut two atom bond cap atom usual refer link atom within interfac describ topolog modif perform automat refgmx grompp preprocess softwar prerequisit cpk version later link gromac libcpk specif instal instruct pleas follow refinstal cpk guid limit simul techniqu qmmm interfac limit simul two way first topolog modif possibl simul qm region second interfac complet ignor b state paramet topolog make doubl topolog setup imposs eg freeenergi perturb simul refdgimpl addit note contribut forc qmmm system virial account size effect pressurecoupl algorithm grow total sum forc due qmmm interact might produc artifact simul npt ensembl usag qmmm simul cpk interfac control set refmdp file option case provid addit input file refgmx grompp qmi commandlin option option relat qmmm simul cpk prefix qmmmcpk set mdpvalueqmmmcpkactivetru trigger qmmm simul use whole system qm part default paramet option choos atom qm calcul qm part system chosen name correspond atom group index file gromac mdpqmmmcpkqmgroup option refmdp file typic qm part consist atom interest chemic point view ie part system reaction happen make comput qm part feasibl small compact possibl space dft simul often scale rd order number atom qm part mean increas number atom qm part factor slow simul factor addit user provid total charg qm subsystem mdpqmmmcpkqmcharg option spinstat multipl mdpqmmmcpkqmmultipl option support qm method qm method chosen mdpqmmmcpkqmmethod refmdp file current follow qm method support mdpvalueqmmmcpkqmmethodpb dft use pbe function dzvpmolopt basi set mdpvalueqmmmcpkqmmethodblyp dft use blyp function dzvpmolopt basi set list updat new method test includ interfac provid cpk input file addit possibl use custom extern cpk input file mdpvalueqmmmcpkqmmethodinput provid file refgmx grompp qmi option extern file incorpor reftpr file simul subject follow restrict run_typ option cpk input equal energy_forc charg option present multipilicti option present coord_file_nam option present point toward refpdb file charge_extend true coord_file_format pdb option present increment includ includ direct allow cpk input file chang name cpk file refgmx mdrun simul addit file produc inp pdb contain cpk input cpk output refpdb file point charg mm atom extend beta field default cpk relat file name deduc reftpr simul file name ad _cpk suffix order chang manual mdpqmmmcpkqmfilenam option use output energi output file contain addit quantum en term energi ad system qmmm interact addit file contain cpk output appear simul directori extens futur develop support addit dft method ad futur well semiempir dftb descript qm subsystem allow support multipl timestep approach speedup simul ad excit state simul implement tddft descript wavefunct stochast dynam stochast veloc langevin dynam add friction nois term newton equat motion math m_i mboxd mathbfr_i mboxdt m_i gamma_i mboxdmathbfr_i mboxdt mathbff_imathbfr stackrelcircmathbfr_i label eqnsdeq mathgamma_i friction constant mathmboxp mathstackrelcircmathbfr_it nois process mathlangl stackrelcircr_it stackrelcircr_jt rangl m_i gamma_i k_b delta delta_ij mathgamma_i larg compar time scale present system one could see stochast dynam molecular dynam stochast temperaturecoupl process take longer mathgamma_i eg hydrodynam dampen sinc degre freedom coupl independ heat bath equilibr fast mode occur rapidli simul system vacuum addit advantag accumul error overal translat rotat degre freedom mathgamma_i small compar time scale present system dynam complet differ md sampl still correct gromac one simpl effici implement accuraci equival normal md leapfrog veloc verlet integr nearli ident common way discret langevin equat friction veloc term appli impuls fashion ref refgoga describ math beginalign mathbfv mathbfvtfracdelta fracmmathbfftdelta deltamathbfv alpha mathbfvtfracdelta sqrtfrack_b tm alpha mathbfrg_i mathbfrtdelta mathbfrtleftmathbfv fracdelta mathbfvrightdelta endalign label eqnsdint math beginalign mathbfvtfracdelta mathbfv delta mathbfv alpha egamma delta tendalign label eqnsdxupd mathmathbfrg_i gaussian distribut nois mathmu mathsigma veloc first updat full time step without friction nois get mathmathbfv ident normal updat leapfrog friction nois appli impuls step mathtdelta advantag scheme velocitydepend term act full time step make correct integr forc depend coordin veloc constraint dissip particl dynam dpd implent yet straightforward constraint coordin updat eqeqn eqnsdxupd split normal leapfrog updat mathdelta mathbfv updat constraint appli coordin veloc use sd thermostat appropri valu mathgamma eg ps math sinc result friction lower intern friction water still provid effici thermostat normalmod analysi normalmod analysi ref reflevitt ref refbbrooksb perform use gromac diagon massweight hessian mathh math beginalign rt h r mboxdiaglambda_ldotslambda_n lambda_i pi omega_iendalign label eqnnma mathm contain atom mass mathr matrix contain eigenvector column mathlambda_i eigenvalu mathomega_i correspond frequenc first hessian matrix mathn time n matrix mathn number atom need calcul math beginalign h_ij fracparti vpartial x_i partial x_jendalign label eqnnmahessian mathx_i mathx_j denot atom x z coordin practic equat use hessian calcul numer forc math beginalign h_ij fracf_ibf xhbf e_j f_ibf xhbf e_jh f_i fracparti vpartial x_iendalign label eqnnmahessianfromforc mathbf e_j unit vector direct mathj note usual normalmod calcul necessari complet minim energi prior comput hessian toler requir depend type system rough indic kj mol math minim done conjug gradient lbfg doubl precis number gromac program involv calcul first energi minim use refmdrun gmx mdrun refmdrun gmx mdrun comput hessian note gener run input file one use minim conform full precis trajectori file structur file accur enough refgmx nmeig diagon sort normal mode accord frequenc refmdrun gmx mdrun refgmx nmeig run doubl precis normal mode analyz program refgmx anaeig ensembl structur temperatur subset normal mode gener refgmx nmen overview normalmod analysi relat princip compon analysi see sec refcovan found ref refhaywardb replica exchang replica exchang molecular dynam remd method use speed sampl type simul especi conform separ rel high energi barrier involv simul multipl replica system differ temperatur randomli exchang complet state two replica regular interv probabl math p leftrightarrow minleftexpleft leftfrack_b t_ frack_b t_rightu_ u_ right right label eqnrex matht_ matht_ refer temperatur mathu_ mathu_ instantan potenti energi replica respect exchang veloc scale matht_t_pm neighbor search perform next step combin fast sampl frequent barriercross highest temperatur correct boltzmann sampl differ temperatur ref refhukushimaa ref refsugita attempt exchang neighbor temperatur probabl decreas rapidli temperatur differ one attempt exchang possibl pair one step instanc replica would exchang chanc exchang replica depend energi replica also energi replica gromac solv attempt exchang odd pair odd attempt even pair even attempt four replica order temperatur attempt exchang everi step pair tri step etc pair step etc one choos temperatur energi differ written math u_ u_ n_df fracc k_b t_ t_ label eqnrexediff mathn_df total number degre freedom one replica mathc harmon potenti around proteinwat system matht_ epsilon t_ probabl becom math p leftrightarrow expleft fracepsilon cn_df epsilon right approx expleftepsilon fracc n_df right label eqnrexprob thu probabl matheapprox one obtain mathepsilon approx sqrtcn_df bond constrain one mathn_df approx n_atom thu mathc one choos mathepsilon mathsqrtn_atom howev one problem use pressur coupl densiti higher temperatur decreas lead higher energi ref refseiberta taken account gromac websit featur socal remd calcul let type temperatur rang number atom base propos set temperatur extens remd isobaricisotherm ensembl propos okab et al ref refokabea work exchang probabl modifi math p leftrightarrow minleftexpleft leftfrack_b t_ frack_b t_rightu_ u_ leftfracp_k_b t_ fracp_k_b t_rightleftv_v_right right right label eqnrexexchangeprob mathp_ mathp_ respect refer pressur mathv_ mathv_ respect instantan volum simul case differ volum small second term neglig play role differ mathp_ mathp_ larg phase transit hamiltonian replica exchang also support gromac hamiltonian replica exchang replica differ hamiltonian defin free energi pathway specifi simul exchang probabl maintain correct ensembl probabl math p leftrightarrow minleftexpleft leftfrack_b t_ frack_b t_rightu_x_ u_x_ u_x_ u_x_ rightright label eqnrexcorrectensembl separ hamiltonian defin free energi function gromac swap made differ valu mathlambda defin mdp file hamiltonian temperatur replica exchang also perform simultan use accept criteria math p leftrightarrow minleftexpleft leftfrack_b t_ frack_b t_rightfracu_x_ u_x_k_b t_ fracu_x_ u_x_k_b t_ right right label eqnrexaccept gibb sampl replica exchang also implement gromac ref refchodera gibb sampl replica exchang possibl pair test exchang allow swap replica neighbor gibb sampl replica exchang requir addit potenti energi calcul howev addit commun cost gibb sampl replica exchang permut one round swap must take place case extra commun cost might affect effici replica exchang variant option refmdrun gmx mdrun program work mpi instal due inher parallel algorithm effici replica run separ rank see manual page refmdrun gmx mdrun use multinod featur brownian dynam limit high friction stochast dynam reduc brownian dynam also call posit langevin dynam appli overdamp system ie system inertia effect neglig equat math mboxdmathbfr_i mboxdt fracgamma_i mathbff_imathbfr stackrelcircmathbfr_i label eqnbrowniandyn mathgamma_i friction coeffici mathmboxamup mathstackrelcircmathbfr_it nois process mathlangl stackrelcircr_it stackrelcircr_jt rangl delta delta_ij k_b gamma_i gromac equat integr simpl explicit scheme math mathbfr_itdelta mathbfr_it delta gamma_i mathbff_imathbfrt sqrt k_b delta gamma_i mathbfrg_i label eqnbrowniandynint mathmathbfrg_i gaussian distribut nois mathmu mathsigma friction coeffici mathgamma_i chosen particl mathgamma_i m_igamma_i friction constant mathgamma_i differ differ group atom system assum overdamp larg timestep use linc use constraint sinc shake converg larg atom displac bd option refmdrun gmx mdrun program simul anneal well known simul anneal sa protocol support gromac even coupl multipl group atom separ arbitrari number refer temperatur chang simul anneal implement simpli chang current refer temperatur group temperatur coupl actual relax coupl properti depend type thermostat use hard coupl sinc chang refer temperatur import rememb system instantan reach valu need allow inher relax time coupl algorithm chang anneal refer temperatur faster temperatur relax probabl end crash differ becom larg anneal protocol specifi seri correspond time refer temperatur group also choos whether want singl sequenc temperatur coupl last refer valu anneal period restart first refer point sequenc complet mix match type anneal nonann group simul _fecalc free energi calcul slowgrowth method free energi calcul perform gromac use number method includ slowgrowth exampl problem might calcul differ free energi bind inhibitor enzym e mutat enzym e mathprim feasibl comput simul perform dock calcul larg complex even releas inhibitor enzym reason amount comput time reason accuraci howev consid free energi cycl numreffig afigfre write math delta g_ delta g_ delta g_ delta g_ label eqnddg interest lefthand term equal well comput righthand term _figfre figur plotsfre width cm free energi cycl calcul mathdelta g_ free energi differ bind inhibitor enzym e respect e mathprim _figfre figur plotsfre width cm free energi cycl b calcul mathdelta g_ free energi differ bind inhibitor respect mathprim enzym e want comput differ free energi bind two inhibitor mathprim enzym e numreffig figfre use eqeqn eqnddg comput desir properti free energi differ two molecular speci calcul gromac use slowgrowth method free energi differ differ molecular speci physic meaningless use obtain meaning quantiti employ thermodynam cycl method requir simul hamiltonian system chang slowli describ one system describ system b chang must slow system remain equilibrium process requir fulfil chang revers slowgrowth simul b yield result differ sign slowgrowth simul b use check user awar danger equal forward backward growth result guarante correct result requir modif hamiltonian mathh realiz make mathh function coupl paramet mathlambda hhpqlambda way mathlambda describ system mathlambda describ system b math hpqhmathrmapq hpqhmathrmbpq label eqnddghamiltonian gromac function form mathlambdadepend differ variou forcefield contribut describ section sec reffeia helmholtz free energi matha relat partit function mathq mathnvt ensembl assum equilibrium ensembl gener md simul constant volum temperatur gener use gibb free energi mathg relat partit function mathdelta mathnpt ensembl assum equilibrium ensembl gener md simul constant pressur temperatur math beginalign alambda k_bt ln q q c intint expbeta hpqlambdadpdq glambda k_bt ln delta delta c intintint expbeta hpqlambda beta pvdpdqdv g pv endalign label eqnddggib mathbeta k_bt mathc n hn integr phase space evalu simul possibl evalu deriv respect mathlambda ensembl averag math fracdadlambda fracintint partial h partial lambda expbeta hpqlambdadpdqintint expbeta hpqlambdadpdq leftlangl fracparti hpartial lambda rightrangle_nvtlambda label eqnddgensembleav similar relat mathdgdlambda mathnpt ensembl differ free energi b found integr deriv mathlambda math beginalign amathrmbvtamathrmavt int_ leftlangl fracparti hpartial lambda rightrangle_nvtlambda dlambda endalign label eqdela math beginalign gmathrmbptgmathrmapt int_ leftlangl fracparti hpartial lambda rightrangle_nptlambda dlambda endalign label eqdelg one wish evalu mathgmathrmbptgmathrmapt natur choic constantpressur simul howev quantiti also obtain slowgrowth simul constant volum start system pressur mathp volum mathv end system b pressur mathp_b appli follow small principl exact correct math gmathrmbpgmathrmap amathrmbvamathrmav int_ppmathrmbvmathrmbpvdp label eqnddgpresscorr omit constant matht notat correct roughli equal mathfrac pmathrmbpdelta vdelta v kappa v mathdelta v volum chang mathp mathkappa isotherm compress usual small exampl growth water molecul noth bath water molecul constant volum would produc addit pressur much bar correct helmholtz free energi kj mol math cartesian coordin kinet energi term hamiltonian depend momenta separ integr fact remov equat mass chang contribut kinet energi otherwis integr contribut free energi mathfrac k_bt ln mmathrmbmmathrma note true absenc constraint thermodynam integr gromac offer possibl integr eqeq eqdela eq eq eqdelg one simul full rang b howev chang larg insuffici sampl expect user may prefer determin valu mathlangl dgdlambda rangl accur number wellchosen intermedi valu mathlambda easili done set stepsiz delta_lambda zero simul equilibr first proper error estim made valu mathdgdlambda fluctuat mathparti hpartial lambda total free energi chang determin afterward appropri numer integr procedur gromac also support use bennett accept ratio ref refbennett calcul valu mathdelta g transform state state b use program refgmx bar data also use calcul free energi use mbar ref refshirt though analysi current requir extern tool extern pymbar packag httpssimtkorghomepymbar_ mathlambdadepend forcefield contribut describ detail section sec reffeia _groupconcept group concept gromac md analysi program use userdefin group atom perform certain action maximum number group atom belong six differ group one follow temperaturecoupl group temperatur coupl paramet refer temperatur time constant number degre freedom see refupd defin tcoupl group separ exampl solvat macromolecul solvent tend gener heat forc integr error coupl shorter time constant bath macromolecul surfac kept cooler adsorb molecul mani differ tcoupl group may defin see also center mass group freez group atom belong freez group kept stationari dynam use equilibr eg avoid badli place solvent molecul give unreason kick protein atom although effect also obtain put restrain potenti atom must protect freez option use desir one two coordin atom therebi freez atom plane line atom partial frozen constraint still abl move even frozen direct fulli frozen atom move constraint mani freez group defin frozen coordin unaffect pressur scale case produc unwant result particularli constraint also use case get larg pressur accordingli recommend avoid combin freez group constraint pressur coupl sake equilibr could suffic start freez constant volum simul afterward use posit restraint conjunct constant pressur acceler group atom acceler group acceler mathmathbfag impos equival massweight extern forc featur make possibl drive system nonequilibrium state comput exampl transport properti energymonitor group mutual interact energymonitor group compil simul done separ lennardjon coulomb term principl group could defin would lead mathtim item better use concept sparingli nonbond interact pair energymonitor group exclud see detail user guid pair particl exclud pair energymonitor group put pair list result signific speedup simul interact within part system requir center mass group gromac center mass com motion remov either complet system group atom latter use eg system limit friction eg ga system prevent center mass motion occur make sens use group temperatur coupl center mass motion remov compress posit output group order reduc size compress trajectori file refxtc reftng possibl store subset particl xcompress group specifi save rest group specifi atom save compress trajectori file use group gromac tool describ sec refusinggroup _em energi minim energi minim gromac done use steepest descent conjug gradient lbfg limitedmemori broydenfletchergoldfarbshanno quasinewtonian minimizerw prefer abbrevi em option refmdrun gmx mdrun program steepest descent although steepest descent certainli effici algorithm search robust easi implement defin vector mathmathbfr vector mathn coordin initi maximum displac mathh_ eg nm must given first forc mathmathbff potenti energi calcul new posit calcul math mathbfr_n mathbfr_n fracmathbff_nmax mathbff_n h_n label eqnempo mathh_n maximum displac mathmathbff_n forc neg gradient potenti mathv notat mathmax mathbff_n mean largest scalar forc atom forc energi comput new posit mathv_n v_n new posit accept mathh_n h_n mathv_n geq v_n new posit reject mathh_n h_n algorithm stop either userspecifi number forc evalu perform eg maximum absolut valu forc gradient compon smaller specifi valu mathepsilon sinc forc truncat produc nois energi evalu stop criterion made tight avoid endless iter reason valu mathepsilon estim root mean squar forc mathf harmon oscil would exhibit temperatur matht valu math f pi nu sqrt mkt label eqnemharmosc mathnu oscil frequenc mathm reduc mass mathk boltzmann constant weak oscil wave number cm math mass atom unit temperatur k mathf kj mol math nm math valu mathepsilon accept conjug gradient conjug gradient slower steepest descent earli stage minim becom effici closer energi minimum paramet stop criterion steepest descent gromac conjug gradient use constraint includ settl algorithm water ref refmiyamoto implement water present must flexibl model specifi refmdp file defin dflexibl realli restrict sinc accuraci conjug gradient requir minim prior normalmod analysi perform constraint purpos steepest descent effici enough lbfg origin bfg algorithm work success creat better approxim invers hessian matrix move system current estim minimum memori requir proport squar number particl practic larg system like biomolecul instead use lbfg algorithm noced ref refbyrda ref refzhua approxim invers hessian fix number correct previou step slidingwindow techniqu almost effici origin method memori requir much lower proport number particl multipli correct step practic found converg faster conjug gradient due correct step yet parallel also noteworthi switch shift interact usual improv converg sinc sharp cutoff mean potenti function current coordin slightli differ previou step use build invers hessian approxim essenti dynam sampl result essenti dynam see sec refcovan protein use guid md simul idea initi md simul sourc definit collect fluctuat largest amplitud obtain posit along one collect mode constrain second md simul number way sever purpos exampl posit along certain mode may kept fix monitor averag forc freeenergi gradient coordin posit anoth applic enhanc sampl effici respect usual md ref refdegroota ref refdegrootb case system encourag sampl avail configur space systemat diffusionlik path protein usual take anoth possibl enhanc sampl flood flood potenti ad certain collect degre freedom expel system region phase space ref reflangea procedur essenti dynam sampl flood follow first eigenvector eigenvalu need determin use covari analysi refgmx covar normalmod analysi refgmx nmeig inform fed refmake_edi gmx make_edi mani option select vector set paramet see gmx make_edi h gener refedi input file pass refmdrun gmx mdrun shell molecular dynam gromac simul polariz use shell model dick overhaus ref refdick model shell particl repres electron degre freedom attach nucleu spring potenti energi minim respect shell posit everi step simul see success applic shell model gromac publish mathn_ ref refjordan water ref refmaarena optim shell posit forc mathmathbff math_ shell particl math decompos two compon math mathbff_ mathbff_bond mathbff_nb label eqnshellforcedecomp mathmathbff_bond denot compon repres polar energi usual repres harmon potenti mathmathbff_nb sum coulomb van der waal interact assum mathmathbff_nb almost constant analyt deriv optim posit shell ie mathmathbff_ shell connect atom math mathbff_bond k_b left mathbfx_ mathbfx_aright label eqnshel iter solver posit mathmathbfx_sn mathn iter count iter mathn math mathbff_nb mathbff_ k_b left mathbfx_sn mathbfx_aright label eqnshellsolv optim posit shell mathx_sn thu follow math mathbff_ k_b left mathbfx_sn mathbfx_aright k_b left mathbfx_sn mathbfx_aright label eqnshelloptpo write math delta mathbfx_ mathbfx_sn mathbfx_sn label eqnshelloptpo final obtain math delta mathbfx_ mathbff_sk_b label eqnshelloptpo yield algorithm comput next trial optim shell posit math mathbfx_sn mathbfx_sn mathbff_sk_b label eqnshelloptpo _pbc period boundari condit _figpbc figur plotspbctric width cm period boundari condit two dimens classic way minim edg effect finit system appli period boundari condit atom system simul put spacefil box surround translat copi numreffig figpbc thu boundari system artifact caus unwant boundari isol cluster replac artifact period condit system crystallin boundari condit desir although motion natur restrict period motion wavelength fit box one wish simul nonperiod system liquid solut period caus error error evalu compar variou system size expect less sever error result unnatur boundari vacuum sever possibl shape spacefil unit cell like rhombic dodecahedron truncat octahedron ref refadam closer sphere cube therefor better suit studi approxim spheric macromolecul solut sinc fewer solvent molecul requir fill box given minimum distanc macromolecular imag time rhombic dodecahedra truncat octahedra special case triclin unit cell gener spacefil unit cell compris possibl spacefil shape ref refbekk reason gromac base triclin unit cell gromac use period boundari condit combin minimum imag convent one nearest imag particl consid shortrang nonbond interact term longrang electrostat interact alway accur enough gromac therefor also incorpor lattic sum method ewald sum pme pppm gromac support triclin box shape simul box unit cell defin box vector mathbf mathbf b mathbf c box vector must satisfi follow condit math a_i a_z b_z label eqnboxrot math a_xb_yc_z label eqnboxshift math b_x leq frac a_x c_x leq frac a_x c_i leq frac b_i label eqnboxshift equat eq eqnboxrot alway satisfi rotat box inequ eq eqnboxshift eq eqnboxshift alway satisfi ad subtract box vector even simul use triclin box gromac alway keep particl brickshap volum effici illustr numreffig figpbc dimension system therefor output trajectori might seem simul done rectangular box program reftrjconv gmx trjconv use convert trajectori differ unitcel represent also possibl simul without period boundari condit usual effici simul isol cluster molecul larg period box sinc fast grid search use period system _figboxshap figur plotsrhododec width cm rhombic dodecahedron arbitrari orient figur plotstruncoct width cm truncat octahedron arbitrari orient use box type mathd replac mathd mathd replac mathd mathd replac mathfracsqrtd mathd replac mathd mathd replac mathfracsqrtd mathd replac mathd mathd replac mathfracd mathd replac mathfracd mathdn replac mathfracd math replac mathfracsqrtd math replac mathfracsqrtd math replac mathfracsqrtd math replac mathfracsqrtd math replac mathfracsqrtd math replac mathfracsqrtd angbc replac mathangl bc angac replac mathangl ac angab replac mathangl ab deg replac mathcirc deg replac mathcirc deg replac mathcirc deg replac mathcirc _tableboxtyp tabl overview differ box type align center width auto box type imag box box vector box vector angl distanc volum b c angbc angac angab mathd cubic mathd mathd mathd deg deg deg mathd rhombic mathd mathd mathd dodcahdron mathd mathd mathd mathd deg deg deg xysquar math rhombic mathd mathd mathd mathd dodcahdron mathd mathd math math deg deg deg xy math hexagon truncat mathd mathd mathd mathdn octahedron mathd mathd math math deg deg deg math three use box type simul solvat system describ numreft tableboxtyp rhombic dodecahedron numreffig figboxshap smallest regular spacefil unit cell imag cell distanc volum volum cube imag distanc save cputim simul spheric flexibl molecul solvent two differ orient rhombic dodecahedron satisfi equat eq eqnboxrot eq eqnboxshift eq eqnboxshift program refeditconf gmx editconf produc orient squar intersect xyplan orient chosen first two box vector coincid x yaxi easier comprehend orient use simul membran protein case crosssect xyplan hexagon area smaller area squar imag distanc height box mathc_z chang obtain optim space box shape save cpu time also result uniform arrang protein cutoff restrict minimum imag convent impli cutoff radiu use truncat nonbond interact may exceed half shortest box vector math r_c fracminbf abf bbf c label eqnphysicalrc otherwis one imag would within cutoff distanc forc macromolecul protein studi solut restrict alon suffici principl singl solvent molecul abl see side macromolecul mean length box vector must exceed length macromolecul direct edg plu two time cutoff radiu mathr_c howev common compromis respect make solvent layer somewhat smaller order reduc comput cost effici reason cutoff triclin box restrict grid search extra restrict weak math r_c mina_xb_yc_z label eqngridrc simpl search extra restrict stronger math r_c fracmina_xb_yc_z label eqnsimplerc unit cell cubic rectangular triclin surround translat imag particular imag therefor alway identifi index point one translat vector construct appli translat index vector see refforc restrict eq eqngridrc ensur imag need consid constraint algorithm constraint impos gromac use linc default tradit shake method _shake shake shake ref refryckaert algorithm chang set unconstrain coordin mathmathbfr set coordin mathmathbfr fulfil list distanc constraint use set mathmathbfr refer math rm shakemathbfr rightarrow mathbfr mathbfr label eqnshakebas action consist solv set lagrang multipli constrain equat motion shake need rel toler continu constraint satisfi within rel toler error messag given shake reset coordin deviat larg given number iter surpass assum equat motion must fulfil mathk holonom constraint express math sigma_kmathbfr_ ldot mathbfr_n k ldot k label eqnshakemotconstr exampl mathmathbfr_ mathbfr_ b forc defin math fracpartialparti mathbfr_i left v sum_kk lambda_k sigma_k right label eqnshakeforc mathlambda_k lagrang multipli must solv fulfil constraint equat second part sum determin constraint forc mathmathbfg_i defin math mathbfg_i sum_kk lambda_k fracparti sigma_kparti mathbfr_i label eqnshakeconstrforc displac due constraint forc leapfrog verlet algorithm equal mathmathbfg_im_idelta solv lagrang multipli henc displac requir solut set coupl equat second degre solv iter shake refsettl _settl settl special case rigid water molecul often make simul system implement settl algorithm ref refmiyamoto sec refconstraintalg implement settl gromac slight modif origin algorithm complet avoid calcul center mass water molecul apart save oper main gain reduct roud error larg coordin float point precis constrain distanc reduc lead energi drift usual depend quadrat coordin settl depend linear enabl accur integr system singl precis nm size note drift due shake linc still quadrat depend limit size system normal constraint singl precis nm veloc verlet addit round constrain must done constrain veloc second veloc half step remov compon veloc parallel bond vector step call rattl cover detail origin andersen paper ref refandersena linc _linc linc algorithm linc algorithm reset bond correct length unconstrain updat ref refhess method nonit alway use two step although linc base matric matrixmatrix multipl need method stabl faster shake use bond constraint isol angl constraint proton angl oh stabil linc especi use brownian dynam linc two paramet explain subsect paramet parallel version linc plinc describ subsect refplinc linc formula consid system mathn particl posit given mathn vector mathmathbfrt molecular dynam equat motion given newton law math mboxd mathbfr mboxdt mathbfmmathbff label eqnc mathmathbff mathn forc vector mathmathbfm mathn time n diagon matrix contain mass particl system constrain mathk timeindepend constraint equat math g_imathbfr mathbfr_i_mathbfr_i_ d_i ildotsk label eqnc numer integr scheme linc appli unconstrain updat like shake algorithm work two step see figur numreffig figlinc first step project new bond old bond set zero second step correct appli lengthen bond due rotat numer first step second step similar complet deriv algorithm found ref refhess short descript first step given _figlinc figur plotslinc height cm three posit updat need one time step dash line old bond length mathd solid line new bond mathld co theta mathp l new notat introduc gradient matrix constraint equat appear right hand side equat math b_hi partialg_h partialr_i label eqnc notic mathmathbfb mathk time n matrix contain direct constraint follow equat show new constrain coordin mathmathbfr_n relat unconstrain coordin mathmathbfr_nunc math beginarrayc mathbfr_nmathbfimathbft_n mathbfb_n mathbfr_nunc mathbft_n mathbfd mm mathbfr_nunc mathbfmmathbfb_n mathbfb_n mathbfmmathbfb_nt mathbfb_n mathbfr_nunc mathbfd endarray label eqnm math mathbft mathbfmmathbfbt mathbfbmathbfmmathbfbt label eqnnm deriv equat eqeqn eqnc eq eqnc found ref refhess first step set real bond length prescrib length project new bond onto old direct bond correct rotat bond mathi project bond mathp_i old direct set math p_isqrt d_i l_i label eqnma mathl_i bond length first project correct posit math mathbfr_nmathbfimathbft_n mathbfb_nmathbfr_n mathbft_n mathbfp label eqnmb correct rotat effect actual iter process md one iter appli rel constraint deviat procedur less everi constraint energi minim might accur enough number iter equal order expans see half cpu time goe invert constraint coupl matrix mathmathbfb_n mathbfmmathbfb_nt done everi time step mathk time k matrix mathm_i_ m_i_ diagon offdiagon element nonzero two bond connect element mathco phi m_c mathm_c mass atom connect two bond mathphi angl bond matrix mathmathbft invert power expans mathk time k matrix mathmathbf introduc invers squar root diagon mathmathbfb_n mathbfmmathbfb_nt matrix use convert diagon element coupl matrix one math beginarrayc mathbfb_n mathbfmmathbfb_nt mathbfsmathbf mathbfb_n mathbfmmathbfb_nt mathbf mathbfsmm mathbfsmathbfsmathbfb_n mathbfmmathbfb_nt mathbf mathbf mathbfsmathbfi mathbfa_n mathbfsendarray label eqnm matrix mathmathbfa_n symmetr spars zero diagon thu simpl trick use calcul invers math mathbfimathbfa_n mathbfi mathbfa_n mathbfa_n mathbfa_n ldot label eqnm invers method valid absolut valu eigenvalu mathmathbfa_n smaller one molecul bond constraint connect low alway true even ring structur present problem aris angleconstrain molecul constrain angl addit distanc constraint multipl small ring structur introduc give high connect lead larg eigenvalu therefor linc use coupl angleconstraint molecul bond constrain eigenvalu matha around mean addit order expans eqeqn eqnm deviat decreas factor rel isol triangl constraint largest eigenvalu around triangl occur remov hydrogen angl vibrat addit angl constraint alcohol group constrain water molecul linc instanc flexibl constraint constraint triangl converg twice slow constraint therefor start gromac addit term ad expans triangl math mathbfimathbfa_n approx mathbfi mathbfa_n ldot mathbfa_nn_i leftmathbfa_n ldot mathbfa_nn_i right mathbfa_nn_i label eqnmang mathn_i normal order expans mathmathbfa contain element mathmathbfa coupl constraint within rigid triangl element zero manner accuraci angl constraint come close constraint seri matrix vector multipl requir determin expans need extend constraint coupl procedur describ plinc paper ref refhessa linc paramet accuraci linc depend number matric use expans eqeqn eqnm md calcul fourth order expans enough brownian dynam larg time step eighth order expans may necessari order paramet refmdp file implement linc done way algorithm never crash even imposs reset constraint linc gener conform fulfil constraint well possibl howev linc gener warn one step bond rotat predefin angl angl set user refmdp file expand ensembl expand ensembl simul ref reflyubartsev coordin thermodynam ensembl treat configur variabl sampl probabl given state written math pvecxk propto expleftbeta_k u_k g_kright label eqnexpandensembl mathbeta_k frack_b t_k mathbeta correspond mathk th thermodynam state mathg_k userspecifi weight factor correspond mathk th state space therefor mix gener expand ensembl sampl multipl thermodynam ensembl simultan mathg_k chosen give specif weight subensembl expand ensembl either fix determin iter procedur set mathg_k frequent chosen give thermodynam ensembl equal probabl case mathg_k equal free energi nondimension unit set arbitrari valu desir sever differ algorithm use equilibr weight describ mdp option list gromac space sampl altern sampl mathk mathvecx direct sampl mathvecx direct done standard molecular dynam sampl sampl differ thermodynam state done mont carlo sever differ mont carlo move support mathk state defin differ temperatur choic free energi mathlambda variabl expand ensembl simul thu repres serial replica exchang formal allow singl simul explor mani thermodynam state _md molecular dynam _gmxmdscheme global md algorithm input initi condit potenti interact mathv function atom posit posit mathmathbfr atom system veloc mathmathbfv atom system mathdownarrow repeat requir number step comput forc forc atom mathmathbff_i displaystylefracparti vpartial mathbfr_i comput calcul forc nonbond atom pair mathmathbff_i sum_j mathbff_ij plu forc due bond interact may depend atom plu restrain andor extern forc potenti kinet energi pressur tensor may comput mathdownarrow updat configur movement atom simul numer solv newton equat motion mathdisplaystyl frac mboxdmathbfr_imboxdt fracmathbff_im_i mathdisplaystyl fracmboxdmathbfr_imboxdt mathbfv_i fracmboxdmathbfv_imboxdt fracmathbff_im_i mathdownarrow requir output step write posit veloc energi temperatur pressur etc global flow scheme md given md em run requir input set initi coordin option initi veloc particl involv chapter describ obtain setup actual md run check refus guid section refgmxsysprep refgmxgettingstart initi condit topolog forc field system topolog includ descript forc field must read forc field topolog describ chapter refff reftop respect inform static never modifi run coordin veloc _figmaxwel figur plotsmaxwel width cm maxwellboltzmann veloc distribut gener random number run start box size coordin veloc particl requir box size shape determin three vector nine number mathmathbfb_ mathbfb_ mathbfb_ repres three basi vector period box run start mathtt_ coordin mathtt_ must known leapfrog algorithm default algorithm use updat time step mathdelta see refupd also requir veloc mathtt_ fracdelta known veloc avail program gener initi atom veloc mathv_i ildot n maxwellboltzmann distribut numreffig figmaxwel given absolut temperatur matht math pv_i sqrtfracm_i pi ktexpleftfracm_i v_iktright label eqnmaxwellboltzman mathk boltzmann constant see chapter refdefunit accomplish normal distribut random number gener ad twelv random number mathr_k rang math le r_k subtract sum result multipli standard deviat veloc distribut mathsqrtktm_i sinc result total energi correspond exactli requir temperatur matht correct made first centerofmass motion remov veloc scale total energi correspond exactli matht see eqeqn eqnet centerofmass motion centerofmass veloc normal set zero everi step usual net extern forc act system centerofmass veloc remain constant practic howev updat algorithm introduc slow chang centerofmass veloc therefor total kinet energi system especi temperatur coupl use chang quench appreci centerofmass motion develop long run temperatur significantli misinterpret someth similar may happen due overal rotat motion isol cluster simul period system fill box overal rotat motion coupl degre freedom caus problem neighbor search mention chapter refff intern forc either gener fix static list dynam list latter consist nonbond interact pair particl calcul nonbond forc conveni particl rectangular box shown numreffig figpbc possibl transform triclin box rectangular box output coordin alway rectangular box even dodecahedron triclin box use simul eqequ eqnboxrot ensur reset particl rectangular box first shift box vector mathbf c mathbf b final mathbf equat eq eqnboxshift eq eqnphysicalrc eq eqngridrc ensur find nearest triclin imag within linear combin involv multipl box vector pair list gener nonbond pair forc need calcul pair mathij distanc mathr_ij mathi nearest imag mathj less given cutoff radiu mathr_c particl pair fulfil criterion exclud interact alreadi fulli account bond interact electrostat treatment correct forc also need comput exclud atom pair gromac employ pair list contain particl pair nonbond forc must calcul pair list contain particl mathi displac vector particl mathi particl mathj within rlist particular imag particl mathi list updat everi nstlist step make pair list atom pair within pair list cutoff distanc need found store list note list gener store neighbor atom sinc atom pair appear list search usual call neighbor search ns pair search involv period boundari condit determin imag see sec refpbc search algorithm employ gromac mathon pair search expens oper gener pair list retain certain number integr step buffer need account rel displac atom step fix pair list retain gromac use buffer pair list default also use cluster particl static old charg group scheme rather cluster defin spatial consist particl conveni stream comput use eg sse avx cuda gpu neighbor search step pair list creat verlet buffer ie pairlist cutoff larger interact cutoff nonbond kernel interact comput particl pair within cutoff distanc particular time step ensur particl move pair search step forc nearli particl within cutoff distanc calcul say nearli particl gromac use fix pair list updat frequenc effici particlepair whose distanc outsid cutoff could possibl move enough fix number step distanc within cutoff small chanc result small energi drift size chanc depend temperatur temperatur coupl use buffer size determin automat given certain toler energi drift default toler kjmoln per particl practic energi drift usual order magnitud smaller note singl precis normal atomist simul constraint caus drift somewher around kjmoln per particl doesnt make sens go much lower pair list implement effici fashion base cluster particl simplest exampl cluster size particl pair list construct base cluster pair clusterpair search much faster search base particl pair math time particl pair put list nonbond forc calcul kernel calcul mani particlepair interact map nice simd simt unit modern hardwar perform multipl float oper nonbond kernel much faster kernel use group scheme type system particularli newer hardwar inform algorithm implement detail verlet cutoff scheme nxm kernel well detail perform analysi pleas consult follow articl ref refpallpairinteract addit list buffer determin automat describ also appli dynam pair list prune pair list construct infrequ lead lot pair list outsid cutoff rang life time pair list pair prune appli clusterpair kernel determin cluster rang way nonbond data regular gromac kernel order magnitud faster search interact kernel gpu prune overlap integr cpu free case therefor prune everi integr step littl overhead significantli reduc number cluster pair interact kernel procedur appli automat unless user set pairlist buffer size manual energi drift pairlist buffer canon nvt ensembl averag energi error caus diffus mathj particl outsid pairlist cutoff mathr_el insid interact cutoff mathr_c lifetim list determin atom displac shape potenti cutoff displac distribut along one dimens freeli move particl mass mathm time matht temperatur matht gaussian mathgx zero mean varianc mathsigma k_b tm distanc two particl varianc chang mathsigma sigma_ k_b tm_m_ note practic particl usual interact bump particl time matht therefor real displac distribut much narrow given nonbond interact cutoff distanc mathr_c pairlist cutoff mathr_ellr_cr_b mathr_b verlet buffer size write averag energi error time matht miss pair interact singl mathi particl type surround mathj particl type number densiti mathrho_ interparticl distanc chang mathr_ mathr_t math langl delta v rangl int_r_c int_r_ellinfti pi r_ rho_ vr_t gleftfracr_tr_sigmaright r_ r_t label eqnverletbufenergi evalu analyt need make approxim first replac mathvr_t taylor expans around mathr_c move lower bound integr mathr_ mathinfti simplifi result math beginalign langl delta v rangl approx int_inftyr_c int_r_ellinfti pi r_ rho_ big vr_c r_t r_c nonumb phantomint_inftyr_c int_r_ellinfti pi r_ rho_ big vr_cfracr_t r_c nonumb phantomint_inftyr_c int_r_ellinfti pi r_ rho_ big vr_cfracr_t r_c nonumb phantomint_inftyr_c int_r_ellinfti pi r_ rho_ big leftr_t r_c rightbig gleftfracr_tr_sigmaright r_ r_tendalign label eqnverletaylor replac factor mathr_ mathr_el sigma result slight overestim allow us calcul integr analyt math beginalign langl delta v rangl approx pi r_ellsigma rho_ int_inftyr_c int_r_ellinfti big vr_c r_t r_c nonumb phantom pi r_ellsigma rho_ int_inftyr_c int_r_ellinfti big vr_cfracr_t r_c nonumb phantom pi r_ellsigma rho_ int_inftyr_c int_r_ellinfti big vr_cfracr_t r_c big gleftfracr_tr_sigmaright r_ r_t pi r_ellsigma rho_ bigg fracvr_cleftr_b sigma gleftfracr_bsigmaright r_bsigmaeleftfracr_bsigmaright right nonumb phantom pi r_ellsigma rho_ bigg fracvr_cleft sigmar_bsigma gleftfracr_bsigmaright r_br_bsigma eleftfracr_bsigmaright right nonumb phantom pi r_ellsigma rho_ bigg fracvr_cbigg r_bsigmar_bsigma gleftfracr_bsigmaright nonumb phantom pi r_ellsigma rho_ bigg fracvr_cbigg r_br_bsigmasigma eleftfracr_bsigmaright bigg biggendalign label eqnverletanalyt mathgx gaussian distribut mean unit varianc mathexfracmathrmerfcxsqrt alway want achiev small energi error mathsigma small compar mathr_c mathr_el thu approxim equat good sinc gaussian distribut decay rapidli energi error need averag particl pair type weight particl count gromac dont allow cancel error pair type averag absolut valu obtain averag energi error per unit time need divid neighborlist life time matht tt nstlist timestt dt function invert analyt use bisect obtain buffer size mathr_b target drift note practic error usual much smaller estim condens phase particl displac much smaller freeli move particl assumpt use bond constraint present particl fewer degre freedom reduc energi error simplic consid one constraint per particl heaviest particl case particl involv multipl constraint simplif overestim displac motion constrain particl superposit motion center mass particl rotat around center mass displac arbitrari direct particl degre freedom gaussian rather follow complementari error function math fracsqrtpisqrtsigmamathrmerfcleftfracrsqrtsigmaright label eqnddisp mathsigma matht k_b tm distribut longer integr analyt obtain energi error gener tight upper bound use scale shift gaussian distribut shown gaussian distribut use calcul energi error describ rotat displac around center mass length arm take account scale mathsigma eqeqn eqnddisp detail present obtain overestim real displac latter effect significantli reduc buffer size longer neighborlist lifetim eg water constrain hydrogen far fastest particl move nm heavi atom connect one import implement detail reduc energi error caus finit verlet buffer list size deriv assum particl pairlist howev gromac implement use cluster pairlist effici pair list consist pair cluster particl case also call math time list list also math time gpu cuda kernel avx bit singl precis kernel math time sse doubleprecis kernel mean pairlist effect much larger correspond math time list thu slightli beyond pairlist cutoff still larg fraction particl pair present list fraction determin simul accur estim reason assumpt fraction decreas increas pairlist rang mean smaller buffer use typic allatom simul cutoff nm fraction around give reduct energi error factor reduct taken account automat verlet buffer calcul result smaller buffer size _figverletdrift figur plotsverletdrift width cm energi drift per atom spce water system k time step fs pairlist updat period step pairlist life time fs pme use ewaldrtol set math paramet affect shape potenti cutoff error estim due finit verlet buffer size shown math time atom pair list math time atom pair list without dash line cancel posit neg error real energi drift shown simul use doubl mixedprecis set round error settl constraint algorithm use singl precis caus drift becom neg larg buffer size note zero buffer size real drift small posit hh neg oh energi error cancel numreffig figverletdrift one see small buffer size drift total energi much smaller pair energi error toler due cancel error larger buffer size error estim factor higher drift total energi altern buffer estim nm larg proton dont move freeli fs rather vibrat cutoff artifact switch interact default pair potenti shift zero cutoff make potenti integr forc howev still energi drift forc nonzero cutoff effect extrem small often notic integr error eg constraint may domin complet avoid cutoff artifact nonbond forc switch exactli zero distanc smaller neighbor list cutoff sever way gromac see sec refmodnbint one buffer size equal neighbor list cutoff less longest interact cutoff simpl search due eqeqn eqnboxrot eq eqnsimplerc vector mathmathbfr_ij connect imag within cutoff mathr_c found construct math beginalign mathbfr mathbfr_jmathbfr_i mathbfr mathbfr mathbfcmathrmroundr_zc_z mathbfr mathbfr mathbfbmathrmroundr_yb_i mathbfr_ij mathbfr mathbfamathrmroundr_xa_x endalign label eqnsearchvec distanc two particl triclin box need obey eqeqn eqnboxrot mani shift combin box vector need consid find nearest imag _figgrid figur plotsnstric width cm grid search two dimens arrow box vector grid search grid search schemat depict numreffig figgrid particl put ns grid smallest space mathg mathr_c direct direct box vector particl mathi three imag direct imag may correspond translat box vector search surround ns grid cell neighbor mathi calcul imag rather construct imag first search neighbor correspond imag mathi numreffig figgrid show grid cell may search differ imag mathi problem sinc due minimum imag convent one imag see mathjparticl everi particl fewer math neighbor cell search therefor algorithm scale linearli number particl although prefactor larg scale behavior make algorithm far superior standard mathon algorithm hundr particl grid search equal fast rectangular triclin box thu protein peptid simul rhombic dodecahedron prefer box shape _chargegroup charg group charg group origin introduc reduc cutoff artifact coulomb interact concept supersed exact atomist cutoff treatment histor reason charg group still defin atom section moleculetyp topolog longer use _forc comput forc potenti energi forc comput potenti energi interact term comput well total potenti energi sum variou contribut lennardjon coulomb bond term also possibl comput contribut energymonitor group atom separ defin see sec refgroupconcept kinet energi temperatur temperatur given total kinet energi mathnparticl system math e_kin fracsum_in m_i v_i label eqntempekin absolut temperatur matht comput use math fracn_mathrmdf kt e_mathrmkin label eqnet mathk boltzmann constant mathn_df number degre freedom comput math n_mathrmdf n n_c n_mathrmcom label eqndofcoupl mathn_c number constraint impos system perform molecular dynam mathn_mathrmcom addit degre freedom must remov three centerofmass veloc constant motion usual set zero simul vacuo rotat around center mass also remov case mathn_mathrmcom one temperaturecoupl group use number degre freedom group mathi math ni_mathrmdf ni ni_c frac n n_c n_mathrmcom n n_c label eqndofonecouplgroup kinet energi also written tensor necessari pressur calcul triclin system system shear forc impos math bf e_mathrmkin fracsum_in m_i mathbfv_iotim mathbfv_i label eqnekintensor pressur virial pressur tensor p calcul differ kinet energi mathe_mathrmkin virial mathbf xi math bf p fracv bf e_mathrmkinbf xi label eqnp mathv volum comput box scalar pressur mathp use pressur coupl case isotrop system comput math p rm tracebf p virial mathbf xi tensor defin math bf xi fracsum_ij mathbfr_ij otim mathbff_ij label eqnxi gromac implement virial comput describ sec refviri _updat leapfrog integr _figleapfrog figur plotsleapfrog width cm leapfrog integr method algorithm call leapfrog mathmathbfr mathmathbfv leap like frog other back default md integr gromac socal leapfrog algorithm ref refhockney integr equat motion extrem accur integr temperatur andor pressur coupl requir veloc verlet integr also present may prefer see refvverlet leapfrog algorithm use posit mathmathbfr time matht veloc mathmathbfv time mathtfracdelta updat posit veloc use forc mathmathbfft determin posit time matht use relat math beginalign mathbfvtfracdelta mathbfvtfracdelta tfracdelta tmmathbfft mathbfrtdelta mathbfrtdelta tmathbfvtfracdelta tendalign label eqnleapfrogv algorithm visual numreffig figleapfrog produc trajectori ident verlet ref refverlet algorithm whose positionupd relat math mathbfrtdelta tmathbfrt mathbfrtdelta fracmmathbfftdelta todelta label eqnleapfrogp algorithm third order mathmathbfr timerevers see ref ref refberendsenb merit algorithm comparison time integr algorithm equat motion modifi temperatur coupl pressur coupl extend includ conserv constraint describ _vverlet veloc verlet integr veloc verlet algorithm ref refswop also implement gromac though yet fulli integr set option veloc verlet posit mathmathbfr veloc mathmathbfv time matht use integr equat motion veloc previou half step requir math beginalign mathbfvtfracdelta mathbfvtfracdelta tmmathbfft mathbfrtdelta mathbfrtdelta tmathbfvtfracdelta mathbfvtdelta mathbfvtfracdelta tfracdelta tmmathbfftdelta tendalign label eqnvelocityverlet equival math beginalign mathbfrtdelta mathbfrt delta tmathbfv fracdelta tmmathbfft mathbfvtdelta mathbfvt fracdelta tmleftmathbfft mathbfftdelta trightendalign label eqnvelocityverlet temperatur pressur coupl correspond start point leapfrog veloc verlet gener ident trajectori easili verifi hand equat given singl start file start point mathmathbfx mathmathbfv leapfrog veloc verlet give ident trajectori leapfrog interpret veloc correspond mathtfracdelta veloc verlet interpret correspond timepoint matht understand revers integr trotter decomposit understand relationship veloc verlet leapfrog integr introduc revers trotter formul dynam also use understand implement thermostat barostat gromac system coupl firstord differenti equat evolv time matht time matht appli evolut oper math beginalign gammat expilt gamma nonumb il dotgammacdot nabla_gammaendalign label eqnevoluoper mathl liouvil oper mathgamma multidimension vector independ variabl posit veloc shorttim approxim true oper accur time mathdelta tp appli mathp time success evolv system math gammat prod_ip expildelta gamma label eqnevolvesystem nve dynam liouvil oper math beginalign il sum_in mathbfv_i cdot nabla_mathbfr_i sum_in fracm_imathbffr_i cdot nabla_mathbfv_iendalign label eqnliouvilleoper split two addit oper math beginalign il_ sum_in fracm_imathbffr_i cdot nabla_mathbfv_i nonumb il_ sum_in mathbfv_i cdot nabla_mathbfr_i endalign label eqnlotwoaddit shorttim symmetr thu revers approxim true dynam math beginalign expildelta expil_fracdelta expil_delta expil_fracdelta mathcalodelta endalign label eqnvetrott correspond veloc verlet integr first exponenti term mathfracdelta correspond veloc halfstep second exponenti term mathdelta correspond full veloc step last exponenti term mathfracdelta final veloc half step futur time matht ndelta becom math beginalign expilndelta approx leftexpil_fracdelta expil_delta expil_fracdelta trightn nonumb approx expil_fracdelta biggexpil_delta expil_delta tbiggn nonumb expil_delta expil_fracdelta endalign label eqntrottertimestep formal allow us easili see differ differ flavor verlet integr leapfrog integr seen start eqeq eqnvetrott mathexpleftil_ delta tright term instead halfstep veloc term yield math beginalign expilndelta expleftil_ delta tright expleftil_ delta tright mathcalodelta tendalign label eqnleapfroghalfvel full step veloc mathtfracdelta mathtfracdelta sinc combin veloc half step veloc verlet futur time matht ndelta becom math beginalign expilndelta approx biggexpleftil_ delta tright expleftil_ delta tright biggnendalign label eqnvelverlethalfvel although first appear symmetr long full veloc step mathtfracdelta mathtfracdelta simpli way start veloc verlet differ place cycl even though trajectori thu potenti energi ident leapfrog veloc verlet kinet energi temperatur necessarili standard veloc verlet use veloc matht calcul kinet energi thu temperatur time matht kinet energi sum particl math beginalign ke_mathrmfullt sum_i leftfracm_imathbfv_itright nonumb sum_i fracm_ileftfracmathbfv_itfracdelta tfracmathbfv_itfracdelta trightendalign label eqntrotterekin squar outsid averag standard leapfrog calcul kinet energi time matht base averag kinet energi timestep mathtfracdelta mathtfracdelta sum particl math beginalign ke_mathrmaveraget sum_i fracm_ileftfracmathbfv_itfracdelta tfracmathbfv_itfracdelta trightendalign label eqntrottersumparticl squar insid averag nonstandard variant veloc verlet averag kinet energi mathketfracdelta mathketfracdelta exactli like leapfrog also implement gromac refmdp file option mdpvalueintegratormdvvavek without temperatur pressur coupl veloc verlet halfstepaverag kinet energi leapfrog ident numer precis temperatur pressurecontrol scheme howev veloc verlet halfstepaverag kinet energi leapfrog differ discuss section thermostat barostat halfstepaverag kinet energi temperatur slightli accur given step size differ averag kinet energi use halfstepaverag kinet energi mdpvalueintegratormd mdpvalueintegratormdvvavek closer kinet energi obtain limit small step size fullstep kinet energi use mdpvalueintegratormdvv nve simul differ usual signific sinc posit veloc particl still ident make differ way temperatur simul interpret trajectori produc although kinet energi accur halfstepaverag method mean chang less timestep get larg also noisi rm deviat total energi system sum kinet plu potenti halfstepaverag kinet energi case higher twice high case fullstep kinet energi drift still howev trajectori ident nvt simul howev differ discuss section temperatur control sinc veloc particl adjust kinet energi simul calcul either way reach distribut correspond set temperatur case three method give ident result veloc posit defin time matht veloc verlet integr use method especi rigor correct pressur control method actual possibl leapfrog integr take neglig time leapfrog twice mani commun call current requir case especi larg system commun speed import parallel differ thermodynam ensembl vanish mathn limit nvt ensembl requir leapfrog like prefer integr pressur control simul fine detail thermodynam import veloc verlet allow true ensembl calcul either case simul doubl precis may requir get fine detail thermodynam correct multipl timestep leapfrog integr gromac support configur multipl timestep scheme use improv perform comput slowli vari forc less frequent respa scheme ref reftuckerman use base trotter decomposit therefor revers symplect order allow tune system integr make possibl specifi differ type bond nonbond interact multipletim step integr avoid integr error still imper integr interv use forc compon short enough univers formula allow algorithm detect sinc slowlyvari forc often smaller magnitud use time step larg might result simul crash recommend conserv gradual increas interv ensur get proper sampl avoid energi drift initi guidanc mani common biomolecular forc field appear run stabil problem period integr lennardjon forc fs longer recommend comput longrang electrostat pme mesh contribut less frequent everi step use base time step fs anoth rather differ scenario use base time step fs nonconstrain harmon bond comput interact everi second fourth step despit caveat encourag user test function assess stabil energi drift either discuss experi gromac forum suggest improv document improv guidanc futur use larger time step interact integr angl vibrat involv hydrogen atom remov use virtual interact site see sec refrmfast bring shortest time step pme mesh updat frequenc multipl time step scheme result near doubl simul perform _tempcoupl temperatur coupl direct use molecular dynam give rise nve constant number constant volum constant energi ensembl quantiti wish calcul actual constant temperatur nvt ensembl also call canon ensembl gromac use weakcoupl scheme berendsen ref refberendsen stochast random andersen thermostat ref refandersen extend ensembl noshoov scheme ref refnos ref refhoov velocityresc scheme ref refbussia simul constant temperatur advantag scheme laid sever reason might necessari control temperatur system drift equilibr drift result forc truncat integr error heat due extern friction forc entir correct thermodynam standpoint case mask symptom increas temperatur system rather underli problem deviat correct physic dynam larger system error ensembl averag structur properti incur use temperatur control remov slow drift temperatur appear neglig complet comprehens comparison carri caution must take interpret result use temperatur andor pressur coupl total energi longer conserv instead conserv energi quantiti formula depend combin temperatur pressur coupl algorithm use coupl algorithm except andersen temperatur coupl parrinellorahman pressur coupl combin shear stress conserv energi quantiti comput store energi log file note quantiti conserv extern forc appli system pull group chang distanc electr field furthermor well energi conserv depend accuraci algorithm involv simul usual algorithm caus drift constraint pairlist buffer depend paramet use berendsen temperatur coupl berendsen algorithm mimic weak coupl firstord kinet extern heat bath given temperatur matht_ see ref ref refberendsen comparison noshoov scheme effect algorithm deviat system temperatur matht_ slowli correct accord math fracmboxdtmboxdt fract_ttau label eqntcoupl mean temperatur deviat decay exponenti time constant mathtau method coupl advantag strength coupl vari adapt user requir equilibr purpos coupl time taken quit short eg ps reliabl equilibrium run taken much longer eg ps case hardli influenc conserv dynam berendsen thermostat suppress fluctuat kinet energi mean one gener proper canon ensembl rigor sampl incorrect error scale mathn larg system ensembl averag affect significantli except distribut kinet energi howev fluctuat properti heat capac affect similar thermostat produc correct ensembl veloc rescal thermostat ref refbussia describ berendsen thermostat support histor reason includ abil reproduc old simul strongli recommend use new simul heat flow system affect scale veloc particl everi step everi mathn_mathrmtc step timedepend factor mathlambda given math lambda left fracn_mathrmtc delta ttau_t leftfract_tt fracdelta right right label eqnlambda paramet mathtau_t close exactli equal time constant mathtau temperatur coupl eqeqn eqntcoupl math tau c_v tau_t n_df k label eqntcoupltau mathc_v total heat capac system mathk boltzmann constant mathn_df total number degre freedom reason mathtau neq tau_t kinet energi chang caus scale veloc partli redistribut kinet potenti energi henc chang temperatur less scale energi practic ratio mathtau tau_t rang ga harmon solid water use term temperatur coupl time constant mean paramet mathtau_t note practic scale factor mathlambda limit rang math lambda avoid scale larg number may crash simul normal use mathlambda alway much closer thermostat modifi kinet energi scale step math delta e_k lambda e_k label eqnthermostat sum chang run need subtract total energi obtain conserv energi quantiti velocityresc temperatur coupl velocityresc thermostat ref refbussia essenti berendsen thermostat see addit stochast term ensur correct kinet energi distribut modifi accord math mboxdk k_ k fracmboxdttau_t sqrtfrack k_n_f fracmboxdwsqrttau_t label eqnvrescal mathk kinet energi mathn_f number degre freedom mathmboxdw wiener process addit paramet except random seed thermostat produc correct canon ensembl still advantag berendsen thermostat first order decay temperatur deviat oscil andersen thermostat one simpl way maintain thermostat ensembl take mathnv integr period reselect veloc particl maxwellboltzmann distribut ref refandersen either done random veloc simultan massiv collis everi mathtau_tdelta step andersenmass random everi particl small probabl everi timestep andersen equal mathdelta ttau case mathdelta timestep mathtau_t characterist coupl time scale way constraint oper particl constraint group must random simultan parallel issu andersen version current use system constraint andersenmass use regardless constraint thermostat also current possibl veloc verlet algorithm oper directli veloc timestep algorithm complet avoid ergod issu thermostat algorithm energi flow back forth energet decoupl compon system veloc scale motion howev slow kinet system random correl motion system includ slow sampl mathtau_t moder level less ps algorithm therefor gener use examin kinet transport properti system ref refbasconi noshoov temperatur coupl berendsen weakcoupl algorithm extrem effici relax system target temperatur system reach equilibrium might import probe correct canon ensembl unfortun case weakcoupl scheme enabl canon ensembl simul gromac also support extendedensembl approach first propos nos ref refnos later modifi hoover ref refhoov system hamiltonian extend introduc thermal reservoir friction term equat motion friction forc proport product particl veloc friction paramet mathxi friction paramet heat bath variabl fulli dynam quantiti momentum mathp_xi equat motion time deriv calcul differ current kinet energi refer temperatur formul particl equat motion global refmd scheme gmxmdscheme replac math frac mboxdmathbfr_imboxdt fracmathbff_im_i fracp_xiqfracmboxdmathbfr_imboxdt label eqnnheqnofmot equat motion heat bath paramet mathxi math frac mboxdp_ximboxdt left t_ right label eqnnhheatbath refer temperatur denot matht_ matht current instantan temperatur system strength coupl determin constant mathq usual call mass paramet reservoir combin refer temperatur _ conserv quantiti noshoov equat motion total energi rather math beginalign h sum_in fracmathbfp_im_i uleftmathbfr_mathbfr_ldotsmathbfr_nright fracp_xiq n_fktxiendalign label eqnnhconservedbas mathn_f total number degre freedom opinion mass paramet somewhat awkward way describ coupl strength especi due depend refer temperatur implement even includ number degre freedom system defin mathq maintain coupl strength one would chang mathq proport chang refer temperatur reason prefer let gromac user work instead period mathtau_t oscil kinet energi system reservoir instead directli relat mathq matht_ via math q frac tau_t t_ pi label eqnnhq provid much intuit way select noshoov coupl strength similar weakcoupl relax addit mathtau_t independ system size refer temperatur howev import keep differ weakcoupl scheme noshoov algorithm mind use weak coupl get strongli damp exponenti relax noshoov approach produc oscillatori relax actual time take relax noshoov coupl sever time larger period oscil select oscil contrast exponenti relax also mean time constant normal time larger relax time use weak coupl mileag may vari noshoov dynam simpl system collect harmon oscil nonergod mean subsect phase space ever sampl even simul run infinit long reason noshoov chain approach develop noshoov thermostat noshoov thermostat control temperatur limit infinit chain thermostat dynam guarante ergod use chain greatli improv ergod recent research shown system still nonergod still entir clear practic effect ref refcook current default number chain control user case chain equat modifi follow way includ chain thermostat particl ref refmartyna math beginalign frac mboxdmathbfr_imboxdt fracmathbff_im_i fracp_xi_q_ fracmboxdmathbfr_imboxdt nonumb frac mboxdp_xi_mboxdt left t_ right p_xi_ fracp_xi_q_ nonumb frac mboxdp_xi_ildot nmboxdt leftfracp_xi_iq_i ktright p_xi_i fracp_xi_iq_i nonumb frac mboxdp_xi_nmboxdt leftfracp_xi_nq_nktright endalign label eqnnhchaineqnofmot conserv quantiti noshoov chain math beginalign h sum_in fracmathbfp_im_i uleftmathbfr_mathbfr_ldotsmathbfr_nright sum_kmfracp_xi_kqprime_k n_fktxi_ ktsum_km xi_k endalign label eqnnhconservedquant valu veloc noshoov thermostat variabl gener includ output take fair amount space gener import analysi simul set refmdp option valu posit veloc noshoov particl chain written refedr file leapfrog simul current noshoov chain length like updat later version describ integr section temperatur coupl temperatur algorithm attempt match refer temperatur calcul differ veloc verlet leapfrog dynam veloc verlet mdvv use fullstep kinet energi leapfrog mdvvavek use halfstepaverag kinet energi examin trotter decomposit better understand differ constanttemperatur integr case noshoov dynam simplic use chain mathn detail ref ref refmartyna split liouvil oper math il il_ il_ il_mathrmnhc label eqnnhtrott math beginalign il_ sum_in leftfracmathbfp_im_irightcdot fracpartialparti mathbfr_i nonumb il_ sum_in mathbff_icdot fracpartialparti mathbfp_i nonumb il_mathrmnhc sum_infracp_xiqmathbfv_icdot nabla_mathbfv_i fracp_xiqfracparti partial xi left t_ rightfracparti partial p_xiendalign label eqnnhtrott standard veloc verlet noshoov temperatur control becom math beginalign expildelta expleftil_mathrmnhcdelta tright expleftil_ delta tright nonumb expleftil_ delta tright expleftil_ delta tright expleftil_mathrmnhcdelta tright mathcalodelta tendalign label eqnnhtrott halfstepaverag temperatur control use mdvvavek decomposit work sinc full step temperatur second veloc step howev construct altern decomposit still revers switch place nhc veloc portion decomposit math beginalign expildelta expleftil_ delta tright expleftil_mathrmnhcdelta trightexpleftil_ delta trightnonumb expleftil_mathrmnhcdelta tright expleftil_ delta tright mathcalodelta endalign label eqhalfstepnhcintegr formal allow us easili see differ differ flavor veloc verlet integr leapfrog integr seen start eqeq eqhalfstepnhcintegr mathexpleftil_ delta tright term yield math beginalign expildelta expleftil_ delta tright expleftil_mathrmnhcdelta tright nonumb expleftil_ delta tright expleftil_mathrmnhcdelta tright mathcalodelta tendalign label eqnnhleapfrog use algebra trick solv quantiti requir actual calcul ref refholian group temperatur coupl gromac temperatur coupl perform group atom typic protein solvent reason algorithm introduc energi exchang differ compon perfect due differ effect includ cutoff etc whole system coupl one heat bath water experi largest cutoff nois tend heat protein cool typic k differ obtain use proper electrostat method pme differ much smaller still neglig paramet temperatur coupl group given refmdp file recent investig shown small temperatur differ protein water may actual artifact way temperatur calcul finit timestep larg differ temperatur like sign someth els serious go wrong system investig care ref refeastwood one special case mention possibl temperaturecoupl part system leav part without temperatur coupl done specifi math time constant mathtau_t group thermostat part system thermostat system still eventu converg nvt system fact one suggest minim error temperatur caus discret timestep constraint water use water degre freedom thermostat protein degre freedom higher frequenc mode protein caus larger deviat true temperatur temperatur obtain small timestep ref refeastwood pressur coupl spirit temperatur coupl system also coupl pressur bath gromac support berendsen algorithm ref refberendsen scale coordin box vector everi step strongli recommend use new stochast cell rescal algorithm extendedensembl parrinellorahman approach ref refparrinello ref refnos veloc verlet variant martynatuckermantobiasklein mttk implement pressur control ref refmartyna parrinellorahman berendsen combin temperatur coupl method mttk use noshoov temperatur control afterward use system constraint berendsen pressur coupl berendsen algorithm rescal coordin box vector everi step everi mathn_mathrmpc step matrix mathmu effect firstord kinet relax pressur toward given refer pressur mathbf p_ accord math fracmboxdbf pmboxdt fracbf p_bf ptau_p label eqnberendsenpressur scale matrix mathmu given math mu_ij delta_ij fracn_mathrmpcdelta tau_p beta_ij p_ij p_ijt label eqnmu mathbeta isotherm compress system case diagon matrix equal element diagon valu gener known suffic take rough estim valu mathbeta influenc noncrit time constant pressur relax without affect averag pressur water atm k mathbeta time pa math time bar math math time md unit see chapter refdefunit liquid similar valu scale complet anisotrop system rotat order obey eqeqn eqnboxrot rotat approxim first order scale usual less math actual scale matrix mathmu math mathbfmu leftbeginarrayccc mu_xx mu_xi mu_yx mu_xz mu_zx mu_yy mu_yz mu_zi mu_zz endarrayright label eqnberendsenpressuresc veloc neither scale rotat sinc equat motion modifi pressur coupl conserv energi quantiti also need modifi first order pressur coupl work barostat appli system everi step need subtract total energi obtain conserv energi quantiti math sum_ij mu_ij delta_ij p_ij v sum_ij mu_ij delta_ij xi_ij label eqnberendsenpressureconserv mathdelta_ij kroneck delta mathbf xi virial note factor origin factor mathfrac virial definit eqeqn eqnxi gromac berendsen scale also done isotrop mean instead mathmathbfp diagon matrix element size trace mathmathbfp use system interfac semiisotrop scale use case mathxydirect scale isotrop mathz direct scale independ compress mathxi mathzdirect set zero scale direct allow full anisotrop deform use constraint might scale slowli decreas timestep avoid error constraint algorithm import note although berendsen pressur control algorithm yield simul correct averag pressur yield exact npt ensembl yet clear exactli error approxim may yield strongli advis use new simul use role recent ensur fast relax without oscil eg start simul equilibrium provid stochast cell rescal use instead full anisotrop simul need use parrinellorahman barostat oscil problem mani correctensembl barostat get initi system stabl might need use berendsen briefli warningserror get remind use product run stochast cell rescal stochast cell rescal algorithm variant berendsen algorithm allow correct fluctuat sampl similarli berendsen algorithm rescal coordin box vector everi step everi mathn_mathrmpc step effect firstord kinet relax pressur toward given refer pressur mathp_ varianc berendsen algorithm rescal matrix calcul includ stochast term make volum fluctuat correct isotrop version easili written term strain mathepsilonlogvv_ evolv accord follow equat motion math mboxdepsilonfracbetatau_pp_pmboxdt sqrtfrack_btbetavtau_pmboxdw label eqnstochasticcellresc mathbeta isotherm compress system suffic take rough estim valu mathbeta influenc noncrit time constant pressur relax without affect volum distribut water atm k mathbeta time pa math time bar math math time md unit see chapter refdefunit liquid similar valu anoth differ respect berendsen algorithm veloc scale factor reciproc scale factor posit semiisotrop implement also provid defin variabl mathepsilon_xylogaa_ mathepsilon_zlogll_ matha mathl area simul box mathxi plane height respect follow equat obtain math mboxdepsilon_xyfracbetatau_pp_fracgammalfracp_xxp_yymboxdtsqrtfrack_btbetavtau_pmboxdw_xi label eqnstochasticcellrescalingxi math mboxdepsilon_zfracbetatau_pp_p_zzmboxdt sqrtfrack_btbetavtau_pmboxdw_z label eqnstochasticcellrescalingz mathgamma extern surfac tension mathp_xx mathp_yy mathp_zz compon intern pressur detail explan found origin refer ref refbernetti parrinellorahman pressur coupl case fluctuat pressur volum import per se eg calcul thermodynam properti especi small system may problem exact ensembl well defin weakcoupl scheme simul true npt ensembl gromac also support constantpressur simul use parrinellorahman approach ref refparrinello ref refnos similar noshoov temperatur coupl theori give true npt ensembl parrinellorahman barostat box vector repres matrix obey matrix equat motion _ math fracmboxdmathbfbmboxdt v mathbfw mathbfb left mathbfp mathbfp_refright label eqnprpressur volum box denot mathv mathmathbfw matrix paramet determin strength coupl matric math_ref current refer pressur respect equat motion particl also chang noshoov coupl case would combin parrinellorahman barostat noshoov thermostat keep simpl show parrinellorahman modif modifi hamiltonian conserv math e_mathrmpot e_mathrmkin sum_i p_ii v sum_ij frac w_ij left fracmboxdb_ijmboxdt right label eqnprpressureconserv equat motion atom obtain hamiltonian math beginalign frac mboxdmathbfr_imboxdt fracmathbff_im_i mathbfm fracmboxdmathbfr_imboxdt mathbfm mathbfb left mathbfb fracmboxdmathbfbmboxdt fracmboxdmathbfbmboxdt mathbfb right mathbfb endalign label eqnprpressuremot extra term appear friction note fictici rather effect parrinellorahman equat motion defin particl coordin repres rel box vector gromac use normal cartesian coordin posit veloc forc worth note kinet energi formal calcul base veloc rel box vector effect eg extern constant stress support coupl constant extern pressur normal simul veloc box vector extrem small compar particl veloc gang liu done work deriv cartesian coordin ref refliu tri implement point futur togeth support extern stress invers mass paramet matrix mathmathbfw determin strength coupl box deform box restrict eq eqnboxrot fulfil automat correspond element mathmathbfw zero sinc coupl strength also depend size box prefer calcul automat gromac provid approxim isotherm compress mathbeta pressur time constant mathtau_p input file mathl largest box matrix element math left mathbfw right_ij frac pi beta_ij tau_p l label eqnprpressuretimeconst noshoov thermostat realiz parrinellorahman time constant equival relax time use berendsen pressur coupl algorithm case need use time larger time constant parrinellorahman coupl pressur far equilibrium parrinellorahman coupl may result larg box oscil could even crash run case would increas time constant better use weakcoupl scheme reach target pressur switch parrinellorahman coupl system equilibrium addit use leapfrog algorithm pressur time matht avail time step complet pressur previou step must use make algorithm directli revers may appropri high precis thermodynam calcul surfacetens coupl period system consist one phase separ surfac parallel mathxyplan surfac tension mathzcompon pressur coupl pressur bath present work berendsen pressur coupl algorithm gromac averag surfac tension mathgammat calcul differ normal later pressur math beginalign gammat fracn int_l_z left p_zzzt fracp_xxzt p_yyzt right mboxdz fracl_zn left p_zzt fracp_xxt p_yyt rightendalign label eqnsurftenscoupl mathl_z height box mathn number surfac pressur zdirect correct scale height box mathmu_zz math delta p_zz fracdelta ttau_p p_zz p_zzt label eqnzpressur math mu_zz beta_zz delta p_zz label eqnzpressur similar normal pressur coupl except factor math miss pressur correct mathzdirect use get correct converg surfac tension refer valu mathgamma_ correct factor box length mathxmathydirect math mu_xi fracdelta ttau_p beta_xi left fracn gamma_mu_zz l_z left p_zztdelta p_zz fracp_xxt p_yyt right right label eqnboxlengthcorr valu mathbeta_zz critic normal pressur coupl normal incorrect compress scale mathtau_p surfac tension coupl affect converg surfac tension mathbeta_zz set zero constant box height mathdelta p_zz also set zero necessari obtain correct surfac tension mttk pressur control algorithm mention previou section one weak leapfrog integr constant pressur simul sinc pressur requir calcul virial kinet energi full time step leapfrog inform avail full timestep veloc verlet allow calcul cost extra round global commun comput mod integr error true npt ensembl full equat combin pressur coupl temperatur coupl taken martyna et al ref refmartyna tuckerman ref reftuckerman refer mttk equat martynatuckermantobiasklein introduc conveni mathepsilon ln vv_ mathv_ refer volum momentum mathepsilon mathv_epsilon p_epsilonw dotepsilon dotvv defin mathalpha n_dof see ref ref reftuckerman isobar equat math beginalign dotmathbfr_i fracmathbfp_im_i fracp_epsilonw mathbfr_i nonumb fracdotmathbfp_im_i fracm_imathbff_i alphafracp_epsilonw fracmathbfp_im_i nonumb dotepsilon fracp_epsilonw nonumb fracdotp_epsilonw fracvwp_mathrmint p alphaleftsum_nnfracmathbfp_im_irightendalign label eqnmttkisobar math beginalign p_mathrmint p_mathrmkin p_mathrmvir fracvleftsum_in leftfracmathbfp_im_i mathbfr_i cdot mathbff_i rightrightendalign label eqnmttkisobar term includ mathalpha requir make phase space incompress ref reftuckerman mathepsilon acceler term rewritten math beginalign fracdotp_epsilonw fracvwleftalpha p_mathrmkin p_mathrmvir prightendalign label eqnmttkaccel term veloc equat becom math beginalign dotmathbfr_i mathbfv_i v_epsilonmathbfr_i nonumb dotmathbfv_i fracm_imathbff_i alphav_epsilonmathbfv_i nonumb dotepsilon v_epsilonnonumb dotv_epsilon fracvwp_mathrmint p alphaleft sum_nn frac m_i mathbfv_irightnonumb p_mathrmint p_mathrmkin p_mathrmvir fracvleftsum_in leftfrac m_imathbfv_i mathbfr_i cdot mathbff_irightrightendalign label eqnmttkvel equat conserv quantiti math beginalign h sum_in fracmathbfp_im_i uleftmathbfr_mathbfr_ldotsmathbfr_nright fracp_epsilonw pvendalign label eqnmttkconserv next step add temperatur control ad noshoov chain includ barostat degre freedom use matheta barostat noshoov variabl mathqprim coupl constant thermostat barostat get math beginalign dotmathbfr_i fracmathbfp_im_i fracp_epsilonw mathbfr_i nonumb fracdotmathbfp_im_i fracm_imathbff_i alphafracp_epsilonw fracmathbfp_im_i fracp_xi_q_fracmathbfp_im_inonumb dotepsilon fracp_epsilonw nonumb fracdotp_epsilonw fracvwalpha p_mathrmkin p_mathrmvir p fracp_eta_qprime_p_epsilonnonumb dotxi_k fracp_xi_kq_k nonumb doteta_k fracp_eta_kqprime_k nonumb dotp_xi_k g_k fracp_xi_kq_k kldot nonumb dotp_eta_k gprime_k fracp_eta_kqprime_k kldot nonumb dotp_xi_m g_m nonumb dotp_eta_m gprime_m nonumb endalign label eqnmttkthermandbar math beginalign p_mathrmint p_mathrmkin p_mathrmvir fracvleftsum_in leftfracmathbfp_im_i mathbfr_i cdot mathbff_irightright nonumb g_ sum_in fracmathbfp_im_i n_f kt nonumb g_k fracp_xi_kq_k kt k ldotsm nonumb gprime_ fracp_epsilonw kt nonumb gprime_k fracp_eta_kqprime_k kt k ldotsmendalign label eqnmttkthermandbar conserv quantiti math beginalign h sum_in fracmathbfp_im_i uleftmathbfr_mathbfr_ldotsmathbfr_nright fracp_epsilonw pv nonumb sum_kmfracp_xi_kq_k sum_kmfracp_eta_kqprime_k n_fktxi_ ktsum_im xi_k ktsum_km eta_kendalign label eqnmttkthermandbarconserv return trotter decomposit formal pressur control temperatur control ref refmartyna get math beginalign il il_ il_ il_epsilon il_epsilon il_mathrmnhcbaro il_mathrmnhcendalign label eqnmttkthermandbartrott nhcbaro correspond noshoov chain barostat nhc correspond nhc particl math beginalign il_ sum_in leftfracmathbfp_im_i fracp_epsilonwmathbfr_irightcdot fracpartialparti mathbfr_i il_ sum_in mathbff_i alpha fracp_epsilonwmathbfp_i cdot fracpartialparti mathbfp_i il_epsilon fracp_epsilonw fracpartialparti epsilon il_epsilon g_epsilon fracpartialparti p_epsilonendalign label eqnmttkthermandbartrott math beginalign g_epsilon vleftalpha p_mathrmkin p_mathrmvir prightendalign label eqnmttkthermandbartrott use trotter decomposit get math beginalign expildelta expleftil_mathrmnhcbarodelta trightexpleftil_mathrmnhcdelta tright nonumb nonumb expleftil_epsilondelta tright expleftil_ delta tright nonumb nonumb expleftil_epsilondelta tright expleftil_ delta tright nonumb nonumb expleftil_ delta tright expleftil_epsilondelta tright nonumb nonumb expleftil_mathrmnhcdelta trightexpleftil_mathrmnhcbarodelta tright mathcalodelta tendalign label eqnmttkthermandbartrotterdecomp action mathexpleftil_ delta tright come solut differenti equat mathdotmathbfr_i mathbfv_i v_epsilonmathbfr_i mathmathbfv_i mathbfp_im_i mathv_epsilon constant initi condit mathmathbfr_i evalu mathtdelta yield evolut math mathbfr_idelta mathbfr_iev_epsilondelta delta mathbfv_i ev_epsilondelta fracsinhleft v_epsilondelta trightv_epsilondelta label eqnmttkthermandbartrotterevol action mathexpleftil_ delta tright come solut differenti equat mathdotmathbfv_i fracmathbff_im_i alphav_epsilonmathbfv_i yield math mathbfv_idelta mathbfv_iealphav_epsilondelta fracdelta tm_imathbff_i ealphav_epsilondelta tfracsinhleft alphav_epsilondelta trightalphav_epsilondelta label eqnmttkthermandbartrotterevol mdvvavek use full step kinet energi determin pressur pressur control halfstepaverag kinet energi temperatur written trotter decomposit math beginalign expildelta expleftil_mathrmnhcbarodelta trightnonumb expleftil_epsilondelta tright expleftil_ delta tright nonumb expleftil_mathrmnhcdelta tright expleftil_epsilondelta tright expleftil_ delta tright expleftil_mathrmnhcdelta tright nonumb expleftil_ delta tright expleftil_epsilondelta tright expleftil_mathrmnhcbarodelta tright mathcalodelta tendalign label eqnvvavektrotterdecomp constraint equat becom significantli complic equat need solv iter constraint forc gromac iter constraint solv describ ref refyu gromac onward mttk constraint remov numer stabil issu iter infrequ evalu temperatur pressur coupl temperatur pressur control requir global commun comput kinet energi virial becom costli perform everi step larg system rearrang trotter decomposit give altern symplect revers integr coupl step everi mathn step instead everi step new integr diverg coupl time step larg auxiliari variabl integr converg howev case long coupl time appropri disturb dynam less ref refmartyna standard veloc verlet noshoov temperatur control trotter expans math beginalign expildelta approx expleftil_mathrmnhcdelta tright expleftil_ delta tright nonumb expleftil_ delta tright expleftil_ delta tright expleftil_mathrmnhcdelta trightendalign label eqnvvnhtrott noshoov chain suffici slow respect motion system write altern integr mathn step veloc verlet math beginalign expildelta approx expleftil_mathrmnhcndelta trightleftexpleftil_ delta trightright nonumb leftexpleftil_ delta tright expleftil_ delta trightrightn expleftil_mathrmnhcndelta trightendalign label eqnvvnhtrott pressur control becom math beginalign expildelta approx expleftil_mathrmnhcbarondelta trightexpleftil_mathrmnhcndelta tright nonumb nonumb expleftil_epsilonndelta tright leftexpleftil_ delta trightright nonumb nonumb expleftil_epsilondelta tright expleftil_ delta tright nonumb nonumb leftexpleftil_ delta trightrightn expleftil_epsilonndelta tright nonumb nonumb expleftil_mathrmnhcndelta trightexpleftil_mathrmnhcbarondelta trightendalign label eqnvvnpressur box volum integr occur everi step auxiliari variabl integr happen everi mathn step complet updat algorithm _gmx_md_updat updat algorithm given posit mathmathbfr atom time matht veloc mathmathbfv atom time mathtfracdelta acceler mathmathbffm atom time matht forc comput disregard constraint total kinet energi virial mathtdelta mathdownarrow comput scale factor mathlambda mathmu accord eqeqn eqnlambda eq eqnmu mathdownarrow updat scale veloc mathmathbfv lambda mathbfv mathbfa delta mathdownarrow comput new unconstrain coordin mathmathbfr mathbfr mathbfv delta mathdownarrow appli constraint algorithm coordin constrain mathmathbfr rightarrow mathbfr mathbfr mathdownarrow correct veloc constraint mathmathbfv mathbfr mathbfr delta mathdownarrow scale coordin box mathmathbfr mu mathbfr mathbfb mu mathbfb complet algorithm updat veloc coordin given use leapfrog refth outlin gmx_md_updat shake algorithm step explain gromac provis freez prevent motion select particl must defin freez group implement use freez factor mathmathbff_g vector differ freez group see sec refgroupconcept vector contain zero freez one dont freez take freez factor extern acceler mathmathbfa_h account updat algorithm veloc becom math mathbfvtfracdelta tmathbff_g lambda left mathbfvtfracdelta fracmathbfftmdelta mathbfa_h delta right label eqntotalupd mathg mathh group indic differ per atom output step import output md run trajectori file contain particl coordin option veloc regular interv trajectori file contain frame could includ posit veloc andor forc well inform dimens simul volum integr step integr time etc interpret time vari integr chosen describ veloc verlet integr veloc label time matht time integr eg leapfrog stochast dynam veloc label time matht time matht fracdelta sinc trajectori file lengthi one save everi step retain inform suffic write frame everi step sinc least step made per period highest frequenc system shannon sampl theorem state two sampl per period highest frequenc bandlimit signal contain avail inform still give long file highest frequenc interest sampl per ps may suffic awar distort highfrequ motion stroboscop effect call alias higher frequenc mirror respect sampl frequenc appear lower frequenc gromac also write reducedprecis coordin subset simul system special compress trajectori file format tool read write format see user guid detail set refmdp file refmdrun gmx mdrun use featur note deriv altern notat mathxi_mathrmalt v_xi p_xiq use box matrix represent correspond transpos box matrix represent paper nos klein equat look slightli differ parallel cpu time requir simul reduc run simul parallel one core ideal one would want linear scale run mathn core make simul mathn time faster practic achiev small number core scale depend lot algorithm use also differ algorithm differ restrict interact rang atom domain decomposit sinc interact molecular simul local domain decomposit natur way decompos system domain decomposit spatial domain assign rank integr equat motion particl current resid local domain domain decomposit two choic made divis unit cell domain assign forc domain molecular simul packag use halfshel method assign forc two method alway requir less commun eighth shell ref refliem midpoint ref refshaw method gromac current use eighth shell method certain system hardwar architectur might advantag use midpoint method therefor might implement midpoint method futur detail domain decomposit found gromac paper ref refhessb coordin forc commun gener case triclin unit cell space divid grid parallelepip call domain decomposit cell cell assign particleparticl rank system partit rank begin md step neighbor search perform minimum unit partit atom charg group deprec group cutoff scheme updat group updat group group atom depend updat occur use constraint andor virtual site thu differ updat group updat independenli current updat group use two sequenti constraint case constrain bond involv hydrogen atom advantag updat group commun requir updat allow updat part system comput forc part atom group assign cell center geometri resid forc calcul coordin neighbor cell need commun forc calcul forc need commun direct commun forc assign base zone cover one multipl cell exampl zone setup shown numreffig figddcel _figddcel figur plotsddcel width cm nonstagg domain decomposit grid mathtim mathtim cell coordin zone commun corner cell home particl zone mathr_c cutoff radiu coordin commun move data along neg direct mathx mathi mathz next neighbor done one multipl puls numreffig figddcel two puls mathx requir one mathi one mathz forc commun revers procedur see gromac paper ref refhessb detail determin nonbond bond forc calcul rank dynam load balanc differ rank differ comput load load imbal rank wait one take time one would like avoid situat load imbal occur due four reason inhomogen particl distribut inhomogen interact cost distribut chargeduncharg waternonwat due gromac water innerloop statist fluctuat small particl number differ commun time due network topolog andor job machin interf commun need dynam load balanc algorithm volum domain decomposit cell adjust independ achiev domain decomposit grid need stagger numreffig figddtric show gener case due stagger one might requir two distanc check decid charg group need commun nonbond distanc bond distanc check _figddtric figur plotsddtric width cm zone commun rank zone see text detail mathr_c mathr_b nonbond bond cutoff radii respect mathd exampl distanc follow stagger boundari cell default refmdrun gmx mdrun automat turn dynam load balanc simul total perform loss due forc calcul imbal note report forc load imbal number might higher sinc forc calcul part work need done integr step load imbal report log file log output step v option use also screen averag load imbal total perform loss due load imbal report end log file one import paramet dynam load balanc minimum allow scale default dimens domain decomposit cell scale least factor domain decomposit allow cell chang volum factor allow compens load imbal minimum allow scale chang dd option refmdrun gmx mdrun load imbal measur time singl region md step mpi rank region includ mpi commun time mpi call allow separ wait due imbal actual commun domain volum scale underrelax invers proport measur time procedur decreas load imbal chang load measur region correl chang domain volum load outsid measur region depend strongli domain volum cpuonli simul load measur coordin forc commun simul nonbond work gpu overlap commun work cpu calcul gpu therefor measur last commun forc calcul cpu gpu finish whichev last use pme rank subtract time pme cpu time includ mpi call pme load independ domain size gener work well unless nonbond load low imbal bond interact two issu aris dynam load balanc increas imbal updat constraint pme coordin forc redistribut time go significantli although dynam load balanc significantli improv perform case imbal bond interact cpu mani situat domain continu decreas size load imbal increas andor pme coordin forc redistribut cost increas significantli version refmdrun gmx mdrun disabl dynam load balanc measur indic deterior perform mean case user get good perform default autom dynam load balanc set _plinc constraint parallel sinc domain decomposit part molecul resid differ rank bond constraint cross cell boundari happen gromac updat group use happen bond involv hydrogen constrain atom connect constraint assign domain without updat group parallel constraint algorithm requir gromac use plinc algorithm ref refhessa parallel version linc algorithm ref refhess see reflinc plinc procedur illustr numreffig figplinc molecul cross cell boundari atom molecul lincs_ord bond away commun cell boundari normal linc algorithm appli local bond plu commun one procedur local bond correctli constrain even though extra commun one one coordin commun step requir initi linc step one iter forc need commun _figplinc figur plotsparlinc width cm exampl parallel setup plinc one molecul split three domain decomposit cell use matrix expans order top part show atom coordin need commun cell bottom part show local constraint solid nonloc constraint dash three cell interact rang domain decomposit take advantag local interact mean limit rang interact default refmdrun gmx mdrun tri find optim balanc interact rang effici happen simul stop error messag miss interact simul might run slightli faster shorter interact rang list interact rang default valu given numreft tableddrang nbrang replac mathr_c max mathr_mathrmlist mathr_mathrmvdw mathr_mathrmcoul tbrang replac maxmathr_mathrmmb mathr_c mbrang replac mathr_mathrmmb csrang replac mathr_mathrmcon vsrang replac mathr_mathrmcon mdrunr replac refmdrun gmx mdrun rdd mdrunc replac refmdrun gmx mdrun rcon _tableddrang tabl interact rang domain decomposit width auto align center interact rang option default nonbond nbrang refmdp file twobodi bond tbrang mdrunr start conf multibodi bond mbrang mdrunr start conf constraint csrang mdrunc est bond length virtual site vsrang mdrunc case default refmdrun gmx mdrun caus simul stop error messag miss interact rang bond interact determin distanc bond chargegroup start configur ad headroom constraint valu mathr_mathrmcon determin take maximum distanc lincs_ord bond cover connect angl degre actual constraint commun limit mathr_mathrmcon minimum cell size mathl_c follow lower limit math l_c geq maxr_mathrmmbr_mathrmcon label eqnddmincells without dynam load balanc system actual allow scale beyond limit pressur scale use note triclin box mathl_c simpli box diagon compon divid number cell direct rather shortest distanc triclin cell border rhombic dodecahedra factor mathsqrt shorter along mathx mathi mathr_mathrmmb r_c refmdrun gmx mdrun employ smart algorithm reduc commun simpli commun charg group within mathr_mathrmmb would increas amount commun enorm therefor chargegroup connect bond interact charg group local present commun lead littl extra commun also slightli increas cost domain decomposit setup case eg coarsegrain simul short cutoff one might want set mathr_mathrmmb hand reduc cost _mpmdpme multipleprogram multipledata pme parallel electrostat interact longrang therefor special algorithm use avoid summat mani atom pair gromac usual pme sec refpm sinc pme particl interact global commun requir usual limit factor scale domain decomposit reduc effect problem come multipleprogram multipledata approach ref refhessb rank select pme mesh calcul rank call particleparticl pp rank rest work rectangular box optim pp pme rank ratio usual rhombic dodecahedra usual number pme rank reduc factor number commun call reduc factor put differ scale time rank addit modern core machin network effect network bandwidth pme quadrupl sinc quarter core use network connect machin pme calcul _figmpmdpm figur plotsmpmdpm width cm exampl rank without left right mpmd pme commun red arrow much higher left right mpmd addit pp pme coordin forc commun blue arrow requir total commun complex lower refmdrun gmx mdrun default interleav pp pme rank rank number consecut insid machin one might want use refmdrun gmx mdrun ddorder pp_pme machin real toru proper commun softwar assign rank accordingli one use refmdrun gmx mdrun ddorder cartesian optim perform one usual set cutoff pme grid pme load total calcul load refgrompp gmx grompp print estim load end also refmdrun gmx mdrun calcul estim determin optim number pme rank use high parallel might worthwhil optim pme load refmdp set andor number pme rank npme option refmdrun gmx mdrun chang electrostat set use know accuraci electrostat remain nearli constant coulomb cutoff pme grid space scale factor note usual better overestim underestim number pme rank sinc number pme rank smaller number pp rank lead less total wait time pme domain decomposit along mathx andor mathi axi decomposit also known pencil decomposit shape domain high parallel decomposit along mathi axi use pp decomposit domain along mathx pme decomposit number domain along mathx equal number pp decomposit refmdrun gmx mdrun automat choos pme decomposit possibl total given number rank base minimum amount commun coordin redistribut pme plu commun grid overlap transpos avoid superflu commun coordin forc pp pme rank number dd cell mathx direct ideal multipl number pme rank default refmdrun gmx mdrun take care issu domain decomposit flow chart numreffig figddflow flow chart shown domain decomposit possibl commun differ algorithm simpler simul flow chart appli without algorithm commun algorithm use _figddflow figur plotsflowchart width cm flow chart show algorithm commun arrow standard md simul virtual site constraint separ pmemesh rank raw latex clearpag particl type gromac three type particl see numreft tabptyp regular atom virtual interact site use gromac shell necessari polariz model like shellwat model ref refmaarena _tabptyp tabl particl type gromac particl symbol atom shell virtual side v _atomtyp atom type forc field defin set atom type characterist name number mass amu list found atomtypesatp file refatp tom ype p aramet file therefor file begin chang andor add atom type file use refgmx pdbgmx sampl gromosaff forc field list carbonyl oxygen co om carboxyl oxygen co oa hydroxyl sugar ester oxygen ow water oxygen n peptid nitrogen n nh nt termin nitrogen nh nl termin nitrogen nh nr aromat nitrogen nz arg nh nh ne arg ne nh c bare carbon ch aliphat sugar chgroup ch aliphat sugar chgroup ch aliphat chgroup note gromac make use atom type name number eg gromo interact paramet atom type set atomtyp section topolog file often obtain includ forc field paramet file atomtyp list atomtypesatp file atomtyp section nonbond atom type use look nonbond van der waal interact paramet forc field use atom type look paramet bond interact forc field addit use bond atom type look paramet bond interact often far fewer bond atom type need nonbond atom type case set paramet nonbond atom type includ bond atom type anoth option paramet nonbond atom type atom number use hybrid qmmm simul _vsitetop virtual site forc field use virtual interact site interact site construct particl posit certain interact locat eg benzen ring reproduc correct quadrupol describ sec refvirtualsit make virtual site system includ section virtual_sit backward compat old name dummi also use topolog file stand number construct particl virtual site type type fd fad type fdn last replac older fd type type valu could occasion unstabl still support intern code old fd type use new input file differ type explain sec refvirtualsit paramet type look like virtual_sit site funct type like virtual_sit site funct type fd like virtual_sit site funct type like virtual_sit site funct b type fd like virtual_sit site funct type fad like virtual_sit site funct theta type like virtual_sit site funct b c type fdn like virtual_sit site funct b c result construct virtual site number first column site base posit atom whose indic next two three four column follow rule determin function number next column funct paramet specifi last one two three column b obvious atom number includ virtual site number depend molecul may instruct studi topolog tipp tipp water model includ gromac distribut note constant bond interact defin virtual site andor normal atom remov refgrompp gmx grompp unless option normvsbd use remov bond interact done gener exclus gener exclus base chemic bond interact virtual site construct gener way use basic geometr paramet direct use virtual_sitesn requir paramet list numreft tabtopfil exampl entri defin virtual site center geometri given set atom might virtual_sitesn site funct paramet file atom static properti see numreft tabstatprop assign atom type assign base data sever place mass list atomtypesatp see refatomtyp wherea charg list refrtp refrtp r esidu opolog p aramet file see refrtp impli charg defin build block amino acid nucleic acid otherwis defin user gener reftopolog top use refpdbgmx gmx pdbgmx program inform file combin _tabstatprop tabl static atom type properti gromac properti symbol unit type mass amu charg q electron epsilon mathepsilon kjmol sigma mathsigma nm _nbpar nonbond paramet nonbond paramet consist van der waal paramet v c mathsigma depend combin rule w c mathepsilon list file ffnonbondeditp ptype particl type see numreft tabptyp bond paramet entri type direct appli counterpart topolog file miss paramet gener warn except note section refpairinteract atomtyp name atnum mass charg ptype vc wc e e om e e nonbond_param j func vc wc e e oa e e note includ forc field also includ atnum column inform impli oplsaa bond_typ column interpret paramet v w depend combin rule chosen default section topolog file see reftopfil math beginalign mboxfor combin rule beginarraylllll mboxv_ii c_i epsilon_isigma_i mbox kj mol nm mboxw_ii c_i epsilon_isigma_i mbox kj mol nm endarray mboxfor combin rule beginarraylll mboxv_ii sigma_i mbox nm mboxw_ii epsilon_i mbox kj mol endarrayendalign label eqndefcombrul combin differ atom type given nonbond_param section paramet v w defin combin given comput paramet correspond atom type accord combin rule math beginalign mboxfor combin rule beginarrayll c_ij leftc_ic_jrightfrac c_ij leftc_ic_jrightfrac endarray mboxfor combin rule beginarrayll sigma_ij fracsigma_isigma_j epsilon_ij sqrtepsilon_iepsilon_j endarrayendalign label eqngivencombrul mathsigma mathepsilon need suppli rule would seem imposs nonzero mathc combin zero mathc paramet howev provid neg mathsigma exactli mathc set zero mathc calcul normal situat repres special case read valu mathsigma noth one set combin rule buckingham potenti math beginarrayrcl a_ij lefta_ii a_jjright b_ij leftfracb_ii fracb_jjright c_ij leftc_ii c_jjright endarray label eqnbuckinghamcombrul bond paramet bond paramet ie bond bond angl improp proper dihedr list ffbondeditp entri databas describ respect atom type interact type interact paramet associ interact paramet read refgrompp gmx grompp process topolog appli relev bond paramet ie bondtyp appli entri bond direct etc bond paramet miss relev type direct gener fatal error type interact list numreft tabtopfil exampl excerpt file follow bondtyp j func b kb c c om angletyp j k func th cth ho oa c ho oa ch dihedraltyp l func q cq nr nr nr nr dihedraltyp j k func phi cp mult c oa c n dihedraltyp ryckaertbelleman dihedr aj ak funct cp cp ffbondeditp file add bond paramet want includ paramet new atom type make sure defin atomtypesatp well interact type bond paramet search assign use exact match type name allow singl set paramet except rule dihedr paramet dihedraltyp wildcard atom type name specifi letter x one four posit thu one exampl assign proper dihedr paramet base type middl two atom paramet entri exact match ie least wildcard match use note gromac version older use first match mean full match would ignor preced entri match wildcard thu suggest put wildcard entri end case someon might use forcefield older version gromac addit dihedr type add possibl assign multipl dihedr potenti use combin term differ multipl differ dihedr potenti paramet set directli adjac line dihedraltyp section molecul definit moleculetyp entri organiz structur usual correspond molecul moleculetyp entri entri serv two main purpos one give structur topolog file usual correspond real molecul make topolog easier read write less labor intens second purpos comput effici system definit kept memori proport size moleculetyp definit molecul present copi save factor memori mean system usual fit cach improv perform tremend interact correspond chemic bond gener exclus defin atom within moleculetyp allow multipl molecul coval bond one moleculetyp definit molecul made infinit long connect period boundari period molecul present option refmdp file need set tell gromac attempt make molecul broken period boundari whole intermolecular interact case one would like atom differ molecul also interact interact usual nonbond interact often case bind studi molecul coval bound eg ligand bind coval protein effect one molecul defin one moleculetyp entri note refpdbgmx gmx pdbgmx option put two molecul one moleculetyp entri molecul coval bound much conveni use separ moleculetyp definit specifi intermolecular interact intermolecular_interact section section place end topolog see numreft tabtopfil normal bond interact specifi use global atom indic restrict interact use gener exclus constraint use _pairinteract intramolecular pair interact extra lennardjon electrostat interact pair atom molecul ad pair section molecul definit paramet interact set independ nonbond interact paramet gromo forc field pair use modifi interact interact atom separ three bond forc field interact exclud nonbond interact see sec refexcl pairtyp j func cs cs interact e e om e e pair interact paramet atom type ffnonbondeditp list pairtyp section gromo forc field list interact paramet explicitli section might empti forc field like opl calcul interact uniformli scale paramet pair paramet present pairtyp section gener genpair set ye default direct forcefielditp see reftopfil genpair set refgrompp gmx grompp give warn pair type paramet given normal pair interact intend interact function type function type pairs_nb intend freeenergi simul determin hydrat free energi solut need decoupl solvent done ad bstate topolog see sec reffecalc use zero solut nonbond paramet ie charg lj paramet howev free energi differ b state total hydrat free energi one add free energi reintroduc intern coulomb lj interact solut vacuum second step combin first step coulomb lj interact within solut modifi purpos pair function type ident function type except bstate paramet alway ident astat paramet search paramet pairtyp section distinct made function type pair section pairs_nb intend replac nonbond interact use unscal charg nonbond lj paramet also use astat paramet note one add exclus atom pair list pairs_nb otherwis pair also end normal neighbor list altern behavior achiev without ever touch topolog use couplemoltyp couplelambda couplelambda coupleintramol keyword see section sec reffecalc sec refdgimpl inform three pair type alway use plain coulomb interact even reactionfield pme ewald shift coulomb interact select nonbond interact energi type written energi log file separ lj coulomb entri per energi group pair energi pairs_nb ad ljsr coulombsr term _excl exclus exclus nonbond interact gener refgrompp gmx grompp neighbor atom certain number bond away defin moleculetyp section topolog file see reftopfil particl consid bond connect chemic bond bond type constraint constraint type type bond use creat connect two atom without creat interact harmon interact bond type connect atom chemic bond also second constraint type constraint type fix distanc connect atom chemic bond complet list interact see numreft tabtopfil extra exclus within molecul ad manual exclus section line start one atom index follow one atom indic nonbond interact first atom atom exclud nonbond interact within group atom need exclud conveni much effici use energi monitor group exclus see sec refgroupconcept _constraintalg constraint algorithm constraint defin constraint section format two atom number follow function type constraint distanc differ two type type use gener exclus type see sec refexcl distanc constrain use linc shake algorithm select refmdp file type constraint perturb freeenergi calcul ad second constraint distanc see refconstraintforc sever type bond angl see numreft tabtopfil convert automat constraint refgrompp gmx grompp sever option refmdp file also implement settl algorithm ref refmiyamoto analyt solut shake specif water settl select topolog file see instanc spc molecul definit moleculetyp molnam nrexcl sol atom nr type re nr ren nm nm cg nr charg ow sol ow hw sol hw hw sol hw settl ow funct doh dhh exclus settl direct defin first atom water molecul settl funct alway distanc oh hh distanc must given note algorithm also use tipp tipp ref refjorgensen tipp anoth geometri tipp virtual site sinc gener need shaken stir file format _topfil topolog file topolog file built follow gromac specif molecular topolog reftop file gener refpdbgmx gmx pdbgmx possibl entri topolog file list numreft tabtopfil numref tabtopfil also tabul unit paramet interact perturb free energi calcul bond interact use refgrompp gmx grompp gener exclus bond interact convert constraint refgrompp gmx grompp vcr replac v mathcr wcr replac w mathcr cro replac mathcr tref replac numreft tabtopfil akjm replac mathamathrmkjmol kjn replac mathmathrmkjmolmathrmnm bnm replac mathbmathrmnm clj replac mathc_ star replac math nrex replac mathn_exnrexcl qemu replac mathq e mathm u mqm replac mathqm _tabtopfil tabl reftopolog top file paramet interact type direct f paramet tp mandatori default nonbond function type combin rule cro gener pair noy fudg lj fudg qq mandatori atomtyp atom type bond type atom number u q e particl type vcr wcr bond type atom number option bondtyp see tref direct bond pairtyp see tref direct pair angletyp see tref direct angl dihedraltyp star see tref direct dihedr constrainttyp see tref direct constraint lj nonbond_param vcr wcr buckingham nonbond_param akjm bnm clj kjn tabl molecul definit f e mandatori moleculetyp molecul name nrex mandatori atom atom type residu number type residu name atom name charg group number qemu mqm intramolecular interact geometri definit describ tref tabl system mandatori system system name mandatori molecul molecul name number molecul tabl intermolecular interact option intermolecular_interact one bond interact describ tref two atom interact gener exclus constraint use global atom number requir number atom type indic direct f tp valu use select function type f e indic paramet interpol free energi calcul cro combin rule determin type lj paramet see refnbpar star dihedraltyp one specifi atom inner outer improp atom nrex exclud neighbor mathn_ex bond away nonbond interact free energi calcul type mathq mathm paramet ad topolog b mathlambda line normal paramet bzero replac mathb_ kb replac mathk_b kdr replac mathk_dr nm replac kj mol math nm math nm replac kj mol math nm math dkj replac mathd kj mol math beta replac mathbeta nm math c replac mathc_i kj mol math nm mathi bmm replac mathb_m ge replac mathgeq ko replac mathk kjm replac kj mol math luu replac low math_ math_ mv replac mathv mw replac mathw qij replac mathq_i mathq_j replac maththeta_ kthe replac mathk_theta kjr replac kj mol math rad math rn replac mathr_ kub replac mathk_ub c replac mathc_i kjri replac kj mol math rad mathi phi replac mathphi_ phi replac mathphi_ kphi replac mathk_phi phik replac mathphik klin replac mathk_lin xi replac mathxi_ kxi replac mathk_xi c replac mathc_ c replac mathc_ c replac mathc_ c replac mathc_ c replac mathc_ c replac mathc_ replac matha_ replac matha_ replac matha_ replac matha_ replac matha_ doh replac mathd_mboxsc oh dhh replac mathd_mboxsc hh ao replac matha bo replac mathb co replac mathc replac mathd kx replac mathk_x ky replac mathk_i kz replac mathk_z go replac mathg ro replac mathr dphi replac mathdeltaphi dihr replac mathk_mathrmdihr thet replac maththeta nm replac nm math kc replac mathk_c thek replac maththetak replac mathr_ replac mathr_ replac mathr_ krr replac mathk_rr krth replac mathk_rtheta alph replac mathalpha co u nm mathalpha um replac u math _tabtopfil tabl detail moleculetyp direct name interact topolog file direct num func order paramet unit use atom _ type _ fe _ bond bond _ _ bzero nm kb nm g bond bond _ _ bzero nm kb nm mors bond _ _ bzero nm dkj beta cubic bond bond _ _ bzero nm c connect bond _ harmon potenti bond bzero nm kb nm fene bond bond _ bmm nm kb nm tabul bond bond _ tabl number ge ko kjm ko tabul bond _ bond tabl number ge ko kjm ko restraint potenti bond luu nm kdr nm extra lj coulomb pair mv _ mw _ extra lj coulomb pair fudg qq qij e mv _ mw _ extra lj coulomb pairs_nb qij e mv _ mw _ angl angl _ deg kthe kjr g angl angl _ deg kthe kjm cross bondbond angl nm krr nm cross bondangl angl nm krth nm ureybradley angl _ deg kthe kjr rn nm kub nm quartic angl angl _ deg c kjri tabul angl angl tabl number ge ko kjm ko linear angl angl klin nm restrict bend potenti angl deg kthe kjm proper dihedr dihedr phi deg kphi kjm multipl phik improp dihedr dihedr xi deg kxi kjr ryckaertbelleman dihedr dihedr c c c c c c kjm period improp dihedr dihedr phi deg kphi kjm multipl phik fourier dihedr dihedr c c c c c kjm tabul dihedr dihedr tabl number ge ko kjm ko proper dihedr multipl dihedr phi deg kphi kjm multipl phik restrict dihedr dihedr phi deg kphi kjm combin bendingtors potenti dihedr kphi kjm exclus exclus one atom indic constraint constraint _ bzero nm constraint _ constraint bzero nm settl settl doh dhh nm bodi virtual site virtual_sit bodi virtual site virtual_sit ao bodi virtual site fd virtual_sit nm bodi virtual site virtual_sit ao bo bodi virtual site fd virtual_sit ao nm bodi virtual site fad virtual_sit thet deg nm bodi virtual site virtual_sit ao bo co nm bodi virtual site fdn virtual_sit ao bo co nm nbodi virtual site cog virtual_sitesn one construct atom indic nbodi virtual site com virtual_sitesn one construct atom indic nbodi virtual site cow virtual_sitesn one pair consist construct atom index weight posit restraint position_restraint kx ky kz nm flatbottom posit restraint position_restraint go ro nm ko nm distanc restraint distance_restraint type label luu nm weight dihedr restraint dihedral_restraint phi deg dphi deg dihr kjr orient restraint orientation_restraint exp label alph ob u weight um angl restraint angle_restraint deg kc kjm multipl thek angl restraint z angle_restraints_z deg kc kjm multipl thek requir number atom indic direct index use select function type indic paramet interpol free energi calcul interact type use refgrompp gmx grompp gener exclus interact type convert constraint refgrompp gmx grompp combin rule determin type lj paramet see refnbpar connect exclus gener interact descript file layout semicolon newlin charact surround comment line end mathbackslash newlin charact ignor direct surround topolog hierarchi must follow consist three level paramet level defin certain forcefield specif see numreft tabtopfil molecul level contain one molecul definit see numreft tabtopfil system level contain systemspecif inform system molecul item separ space tab comma atom molecul number consecut start atom charg group must list consecut bond atom type name must contain least one nondigit charact file pars impli forward refer treat item must defin use exclus gener bond overridden manual bond forc type gener atom type overridden per bond possibl appli multipl bond interact type atom descript comment line empti line highli recommend start gromac version direct paramet level use multipl time restrict order except atom type need defin use paramet definit paramet certain interact defin multipl time combin atom type last definit use start gromac version refgrompp gmx grompp gener warn paramet redefinit differ valu use one atom bond pair angl etc without use moleculetyp meaningless gener warn use molecul without use system meaningless gener warn system allow direct molecul use unknown string caus data next direct ignor gener warn exampl topolog file ureatop exampl topolog file forcefield file includ includ amberffforcefielditp moleculetyp name nrexcl urea atom c ure c amber c type ure amber type n ure n amber n type h ure h amber h type h ure h amber h type n ure n amber n type h ure h amber h type h ure h amber h type bond dihedr ai aj ak al funct definit dihedr position_restraint wouldnt normal use molecul like urea includ didact purpos ai funct fc restrain point restrain line yaxi restrain plane yzplane dihedral_restraint ai aj ak al type phi dphi fc includ tipp water topolog includ amberfftippitp system urea water molecul molecul name nr urea sol follow explanatori text includ amberffforcefielditp includ inform forc field use includ bond nonbond paramet exampl use amber forc field simul may use differ forc field refgrompp gmx grompp automat go find file copyandpast content content seen sharetopamberffforcefielditp defin _ff_amber defin _ff_amber default nbfunc combrul genpair fudgelj fudgeqq ye includ ffnonbondeditp includ ffbondeditp two defin statement set condit futur part topolog know amber forc field use default nbfunc nonbond function type use lennardjon buckingham combrul number combin rule see refnbpar genpair pair gener default ie get paramet pairtyp list paramet present list stop fatal error set ye gener paramet present pair list normal lennardjon paramet use fudgelj fudgelj factor multipli lennardjon interact default fudgeqq factor multipli electrostat interact default mathn power repuls term mathn potenti nonbondedtyp lennardjon start gromac version refgrompp gmx mdrun also read appli mathn valu equal tabul interact function use older version would use user tabul interact note genpair fudgelj fudgeqq mathn option fudgelj use gener pair set ye fudgeqq alway use howev want specifi mathn need give valu paramet well includ statement add larg amount data need describ rest forc field skip return ureatop see moleculetyp defin name molecul reftop nrexcl stand exclud nonbond interact atom bond away atom defin molecul nr type fix rest user defin atom name like cgnr made larger smaller possibl total charg charg group zero charg chang bond comment pair lj coulomb interact angl comment dihedr case proper dihedr funct improp funct ryckaertbelleman type dihedr want includ ryckaertbelleman type dihedr topolog follow case eg decan dihedr ai aj ak al funct c c c origin implement potenti alkan ref refryckaert interact use mean order implement particular forc field need remov interact pair section topolog modern forc field like oplsaa amber rule differ ryckaertbelleman potenti use cosin seri combin interact position_restraint harmon restrain select particl refer posit refpositionrestraint refer posit read separ coordin file refgrompp gmx grompp dihedral_restraint restrain select dihedr refer valu implement dihedr restraint describ section refdihedralrestraint manual paramet specifi dihedral_restraint direct follow type one possibl valu phi valu mathphi_ eqeqn eqndphi eqeqn eqndihr manual dphi valu mathdeltaphi eqeqn eqndihr manual fc forc constant mathk_dihr eqeqn eqndihr manual includ tippitp includ topolog file alreadi construct see section refmolitp system titl system userdefin molecul defin total number submolecul system defin reftop exampl file stand urea molecul dissolv water molecul molecul type sol defin tippitp file name must correspond name given moleculetyp earlier topolog order block molecul type number molecul must match coordin file accompani topolog suppli refgrompp gmx grompp block molecul need contigu tool eg refgenion gmx genion may act first last block particular molecul type also block noth definit group see sec refgroupconcept sec refusinggroup _molitp moleculeitp file construct topolog file use frequent like water molecul tippitp alreadi construct good make moleculeitp file list inform one particular molecul allow reus moleculetyp multipl system without reinvok refpdbgmx gmx pdbgmx manual copi past exampl ureaitp follow moleculetyp molnam nrexcl ure atom c ure c amber c type h ure h amber h type bond dihedr ai aj ak al funct definit dihedr use refitp file result short reftop file exampl topolog file forc field file includ includ amberffforcefielditp includ ureaitp includ tipp water topolog includ ambertippitp system urea water molecul molecul name nr urea sol ifdef statement power featur gromac use ifdef statement reftop file make use statement associ defin statement like seen amberffforcefielditp earlier differ paramet one molecul use reftop file exampl given tfe option use differ charg atom charg deriv de loof et al ref refloof van buuren berendsen ref refbuurena fact use much function c preprocessor cpp refgrompp gmx grompp contain similar preprocess function scan file way make use ifdef option follow either use option defin ddeloof refmdp file contain refgrompp gmx grompp input paramet use line defin deloof earli reftop refitp file put ifdef statement reftop shown atom nr type resnr residu atom cgnr charg mass ifdef deloof use charg deloof c tfe c f tfe f f tfe f f tfe f ch tfe ch oa tfe oa ho tfe ho els use charg vanbuuren c tfe c f tfe f f tfe f f tfe f ch tfe ch oa tfe oa ho tfe ho endif bond ai aj funct c c e e e e e e e e e e e e mechan use refpdbgmx gmx pdbgmx implement option posit restraint refpositionrestraint includ refitp file whose content meaning particular defin set spell correctli topolog free energi calcul free energi differ two system b calcul describ sec reffecalc system b describ topolog consist number molecul number atom mass nonbond interact perturb ad b paramet atom direct bond interact perturb ad b paramet bond type bond interact paramet perturb list numreft tabtopfil numref tabtopfil mathlambdadepend interact describ section sec reffeia bond paramet use line bond interact definit one look atom type bond type list explain numreft tabtopf case thing work intuit b atom type bond interact ident paramet present bstate either line bond type refgrompp gmx grompp use astat paramet issu warn free energi calcul paramet topolog b mathlambda ad line normal paramet order normal paramet gromac onward mathlambda treat vector bondedlambda compon control bond term explicitli label restraint restrain term control restraintlambda compon replac math _tabtopf tabl bond paramet use free energi topolog line bond interact definit look bond type section base atom type b indic paramet use state b respect indic nonpres paramet topolog x indic presenc influenc bstate atom type paramet paramet paramet bond type bond type expect ident line atom b atom messag astat atom type b b b ye ab x x ye b x x ye error ye ab ye b ab x x x x warn b x x x x x x error ab warn b warn x b x b exampl topolog chang propanol pentan use gromo forc field includ forc field paramet includ gromosaffforcefielditp moleculetyp name nrexcl proppent atom nr type resnr residu atom cgnr charg mass typeb chargeb massb h prop ph ch oa prop po ch ch prop pc ch ch prop pc ch prop pc bond ai aj funct par_a par_b gb_ gb_ gb_ gb_ gb_ gb_ gb_ pair ai aj funct angl ai aj ak funct par_a par_b ga_ ga_ ga_ ga_ ga_ ga_ dihedr ai aj ak al funct par_a par_b gd_ gd_ gd_ gd_ system name propanol pentan molecul compound mol proppent atom perturb pc pc need bstate paramet specif sinc b paramet copi paramet bond interact atom perturb need b paramet specif case last bond exampl topolog topolog use oplsaa forc field need bond paramet sinc b paramet determin atom type nonbond interact involv one two perturb atom use freeenergi perturb function form nonbond interact two nonperturb atom use normal function form mean instanc charg particl perturb lennardjon interact also affect lambda equal zero one note topolog use gromo forc field bond interact determin atom type bond interact string convert cpreprocessor forcefield paramet file contain line like defin gb_ e defin gd_ _constraintforc constraint forc constraint forc two atom one molecul calcul free energi perturb code ad constraint two atom differ length b topolog b length nm longer length lambda kept constant zero deriv hamiltonian respect lambda constraint forc constraint molecul pull code use see sec refpul exampl calcul constraint forc nm two methan water combin two methan one molecul note definit molecul gromac necessarili correspond chemic definit molecul gromac molecul defin group atom one wish consid simultan ad constraint function type mean use gener exclus see sec refexcl note constraint free energi term includ deriv term specif includ bondedlambda compon howev free energi chang constraint includ potenti energi differ use bar mbar requir reevalu energi constraint compon function plan later version includ forcefield paramet includ gromosaffforcefielditp moleculetyp name nrexcl methan atom nr type resnr residu atom cgnr charg mass ch ch c ch ch c constraint ai aj funct length_a length_b includ gromosaffspcitp system name methan water molecul compound mol methan sol coordin file file refgro file extens contain molecular structur gromo format sampl piec includ md water reformat step pa aug water ow water hw water hw water ow water hw water hw format fix ie column fix posit want read file program without use gromac librari use follow format cformat issiffffff precis titl etc look like sn titl dn natom inatom dssdffffffn residuenrresiduenameatomnameatomnrxyzvxvyvz fffffffffn boxxxboxyyboxzz boxxyboxxzboxyxboxyzboxzxboxzi fortran format iaiff confingro gromac coordin file almost gromo file gromo user use ntx differ box gromac use tensor vector _pdbgmxfile refpdbgmx gmx pdbgmx input file gromac program refpdbgmx gmx pdbgmx gener topolog input coordin file sever format support coordin file refpdb commonlyus format henc name refpdbgmx gmx pdbgmx refpdbgmx gmx pdbgmx search forc field subdirectori gromac sharetop directori work directori forc field recogn file forcefielditp directori extens ff file forcefielddoc may present first line use refpdbgmx gmx pdbgmx present short descript user help choos forc field otherwis user choos forc field ff xxx commandlin argument refpdbgmx gmx pdbgmx indic forc field xxxff directori desir refpdbgmx gmx pdbgmx search first work directori gromac sharetop directori use first match xxxff directori found two gener file read refpdbgmx gmx pdbgmx atom type file extens refatp see refatomtyp forcefield directori file call residuetypesdat either work directori gromac sharetop directori residuetypesdat determin residu name consid protein dna rna water ion refpdbgmx gmx pdbgmx read one multipl databas topolog inform differ type molecul set file belong one databas basenam prefer tell someth type molecul eg aminoacid rna dna possibl file basenamertp basenamerb option basenamearn option basenamehdb option basenamentdb option basenamectdb option refrtp file contain topolog build block mandatori inform file use build block come refrtp file base name user add build block forc field addit file base name work directori default extra build block defin call refpdbgmx gmx pdbgmx rtpo option allow build block local file replac default one forc field residu databas file hold residu databas extens refrtp origin file contain build block amino acid protein gromac interpret rtcdat file gromo residu databas file contain inform bond charg charg group improp dihedr frequentlyus build block better chang file standard input refpdbgmx gmx pdbgmx chang need make reftop file see reftopfil refrtp file work directori explain sec refpdbgmxfil defin topolog new small molecul probabl easier write includ topolog file refitp directli discuss section refmolitp ad new protein residu databas dont forget add residu name residuetypesdat file refgrompp gmx grompp refmake_ndx gmx make_ndx analysi tool recogn residu protein residu see refdefaultgroup refrtp file use refpdbgmx gmx pdbgmx mention extra inform program need refrtp databas bond charg atom charg group improp dihedr rest read coordin input file protein contain residu standard list coordin file construct build block strang residu otherwis obtain reftop file also hold molecul coordin file ligand polyatom ion crystal cosolv etc residu databas construct follow way bondedtyp mandatori bond angl dihedr improp mandatori gli mandatori atom mandatori name type charg chargegroup n n h h ca ch c c bond option atom atom b kb n h n ca ca c c c n exclus option atom atom angl option atom atom atom th cth dihedr option atom atom atom atom phi cp mult improp option atom atom atom atom q cq n c ca h c ca n zn atom zn zn file free format restrict one entri line first field file bondedtyp field follow four number indic interact type bond angl dihedr improp dihedr file contain residu entri consist atom option bond angl dihedr improp charg group code denot charg group number atom charg group alway order consecut use hydrogen databas refpdbgmx gmx pdbgmx ad miss hydrogen see refhdb atom name defin refrtp entri correspond exactli name convent use hydrogen databas atom name bond interact preced minu plu indic atom preced follow residu respect explicit paramet ad bond angl dihedr improp overrid standard paramet refitp file use special case instead paramet string ad bond interact use gromo refrtp file string copi topolog file replac forcefield paramet cpreprocessor refgrompp gmx grompp use defin statement refpdbgmx gmx pdbgmx automat gener angl mean forc field angl field use overrid refitp paramet gromo forc field interact number angl need specifi refpdbgmx gmx pdbgmx automat gener one proper dihedr everi rotat bond prefer heavi atom dihedr field use dihedr gener bond correspond specifi dihedr possibl put one dihedr function rotat bond case charmm ff refpdbgmx gmx pdbgmx add correct map dihedr use default cmap option pleas refer refcharmmff inform refpdbgmx gmx pdbgmx set number exclus mean interact atom connect bond exclud pair interact gener pair atom separ bond except pair hydrogen interact need exclud pair interact gener exclus field ad follow pair atom name separ line nonbond pair interact atom exclud residu build block databas forc field name convent residu residu consist name especi differ proton state mani differ name refrb file use convert standard residu name forcefield build block name refrb present forcefield directori residu list build block name assum ident residu name refrb contain column column format residu name first column build block name second column format addit column build block residu occur nterminu cterminu termini time singl residu molecul use instanc amber forc field one termin version present dash enter correspond column gromac name convent residu appar except refpdbgmx gmx pdbgmx code refrb file specbonddat file convent import ad residu type refrtp file convent list numreft tabrb special bond instanc heme group gromac name convent introduc specbonddat see refspecbond subsequ translat refrb file requir ndel replac n math_delta nep replac n math_epsilon _tabrb tabl intern gromac residu name convent gromac id residu arg proton arginin argn neutral arginin asp neg charg aspart acid asph neutral aspart acid cy neutral cystein cy cystein sulfur bound anoth cystein heme glu neg charg glutam acid gluh neutral glutam acid hisd neutral histidin ndel proton hise neutral histidin nep proton hish posit histidin ndel nep proton histidin bound heme lysn neutral lysin ly proton lysin heme heme atom renam databas forc field often use atom name follow iupac pdb convent refarn databas use translat atom name coordin file forcefield name atom list keep name file three column build block name old atom name new atom name respect residu name support questionmark wildcard match singl charact addit gener atom renam file call xlateatdat present sharetop directori translat common nonstandard atom name coordin file iupacpdb convent thu write forcefield file assum standard atom name atom name translat requir except translat standard atom name forcefield one hydrogen databas hydrogen databas store refhdb file contain inform refpdbgmx gmx pdbgmx program connect hydrogen atom exist atom version databas gromac hydrogen atom name atom connect first letter atom name replac h version onward h atom list explicitli old behavior proteinspecif henc could gener molecul one hydrogen atom connect atom number ad end hydrogen atom name exampl ad two hydrogen atom nd asparagin hydrogen atom name hd hd import sinc atom name refrtp file see refrtp must format hydrogen databas follow re addit h add type h j k ala h n c ca arg h n ca c ne cd cz hh nh cz ne hh nh cz ne first line see residu name ala arg number kind hydrogen atom may ad residu hydrogen databas follow one line addit see number h atom ad method ad h atom one planar hydrogen eg ring peptid bond one hydrogen atom n gener lie plane atom ijk plane bisect angl jik distanc nm atom angl nij nik math mathrm one singl hydrogen eg hydroxyl one hydrogen atom n gener distanc nm atom angl nij degre dihedr nijktran two planar hydrogen eg ethylen cch math_ amid conh math_ two hydrogen nn gener distanc nm atom angl nijnij degre dihedr nijkci nijktran name accord iupac standard ref refiupac two three tetrahedr hydrogen eg ch math_ three nnn two nn hydrogen gener distanc nm atom angl nijnijnij mathrm dihedr nijktran nijktran nijktran mathrm one tetrahedr hydrogen eg c math_ ch one hydrogen atom n mathprim gener distanc nm atom tetrahedr conform angl n mathprimeijn mathprimeikn mathprimeil mathrm two tetrahedr hydrogen eg cch math_ c two hydrogen atom nn gener distanc nm atom tetrahedr conform plane bisect angl jik angl ninnijnik mathrm two water hydrogen two hydrogen gener around atom accord spc ref refberendsen water geometri symmetri axi altern three coordin axe direct three water hydrogen two hydrogen gener around atom accord spc ref refberendsen water geometri symmetri axi altern three coordin axe direct addit extra particl gener posit oxygen first letter name replac use fouratom water model tipp ref refjorgensen four water hydrogen except two addit particl gener posit oxygen name lp lp use fiveatom water model tipp ref refmahoneya name new h atom prefix eg hd asparagin exampl given earlier three four control atom ijkl first alway atom h atom connect two three depend code select water one control atom exot case approxim construct tool suitabl use energi minim good enough begin md simul exampl secondari amin hydrogen nitrenyl hydrogen mathmathrmcmathrmnh even ethynyl hydrogen could approxim construct use method hydroxyl hydrogen termini databas termini databas store aminoacidsntdb aminoacidsctdb n ctermini respect contain inform refpdbgmx gmx pdbgmx program connect new atom exist one atom remov chang bond interact ad format follow gromosaffaminoacidsctdb none coo replac c c c om oxt om add c ca n om bond c gb_ c gb_ angl c ga_ ca c ga_ ca c ga_ dihedr n ca c gd_ improp c ca gi_ file organ block header specifi name block block correspond differ type termini ad molecul exampl coo first block correspond chang termin carbon atom deproton carboxyl group none second terminu type correspond terminu leav molecul block name follow replac add delet bond angl dihedr improp would interfer paramet block would probabl also confus human reader block follow option present replac replac exist atom one differ atom type atom name charg andor mass entri use replac atom present input coordin refrtp databas also renam atom input coordin match name forc field latter case also correspond add section present give instruct add atom posit sequenc bond known atom present input coordin kept present construct refpdbgmx gmx pdbgmx atom replac line enter follow field name atom replac new atom name option new atom type new mass new charg add add new atom group ad atom twolin entri necessari first line contain field entri hydrogen databas name new atom number atom type addit control atom see refhdb possibl type addit extend two specif ctermin addit two carboxyl oxygen coomath two oxygen nn gener accord rule distanc nm atom angl nijnij degre carboxyl oxygen hydrogen cooh two oxygen nn gener accord rule distanc nm nm atom n n respect angl nij nij degre one hydrogen n mathprim gener around n accord rule nij nijk read n mathprimeni n mathprimenij respect line anoth line follow specifi detail ad atom way replac atom ie atom type mass charg charg group option like hydrogen databas see refrtp one atom connect exist one number append end atom name note like hydrogen databas atom name line control atom wherea begin second line prior gromac version charg group field left ad atom charg group number atom bond delet delet exist atom one atom name per line bond angl dihedr improp add addit bond paramet format ident use refrtp file see refrtp virtual site databas sinc reli posit hydrogen input file need special input file decid geometri paramet add virtual site hydrogen complex virtual site construct eg entir aromat side chain made rigid also need inform equilibrium bond length angl atom side chain inform specifi refvsd file forc field termini one file class residu refrtp file virtual site databas realli simpl list inform first coupl section specifi mass center typic call mch math_mnh math_ use ch math_ nh math_ nh math_ group depend equilibrium bond length angl hydrogen heavi atom need appli slightli differ constraint distanc mass center note specifi actual paramet automat type mass center use accomplish three section name ch nh nh expect three column first column atom type bound hydrogen second column next heavi atom type bound third column type mass center use special case nh section also possibl specifi planar second column use differ construct without mass center current differ opinion forc field whether nh math_ group planar tri hard stick default equilibrium paramet forc field second part virtual site databas contain explicit equilibrium bond length angl pairstriplet atom aromat side chain entri current read specif routin virtual site gener code would like extend eg nucleic acid would also need write new code section name short amino acid name phe tyr trp hid hie hip simpli contain column atom name follow number specifi bond length nm angl degre note approxim equilibr geometri entir molecul might ident equilibrium valu singl bondangl molecul strain _specbond special bond primari mechan use refpdbgmx gmx pdbgmx gener interresidu bond reli headtotail link backbon atom differ residu build macromolecul case eg disulfid bond heme group branch polym necessari creat interresidu bond lie backbon file specbonddat take care function necessari residu belong moleculetyp merg chainsep function refpdbgmx gmx pdbgmx use manag special interresidu bond differ chain first line specbonddat indic number entri file add new entri sure increment number remain line file provid specif creat bond format line follow resa atoma nbondsa resb atomb nbondsb length newresa newresb column indic resa name residu particip bond atoma name atom residu form bond nbondsa total number bond atoma form resb name residu b particip bond atomb name atom residu b form bond nbondsb total number bond atomb form length refer length bond atoma atomb within length mathpm coordin file suppli refpdbgmx gmx pdbgmx bond form newresa new name residu necessari forc field use eg cy cystein disulfid heme linkag newresb new name residu b likewis _fforgan forc field organ _fffile forcefield file mani forc field avail default forc field detect presenc nameff directori gmxlibsharegromacstop subdirectori andor work directori inform regard locat forc field file print refpdbgmx gmx pdbgmx easili keep track version forc field call case made modif one locat anoth forc field includ gromac amber protein nucleic amber duan et al j comp chem amber forc field cornel et al jac amber protein nucleic amber kollman et al acc chem re amber protein nucleic amber wang et al j comp chem ambersb protein nucleic amber hornak et al protein ambersbildn protein nucleic amber lindorfflarsen et al protein amberg forc field garcia sanbonmatsu pna charmm allatom forc field charm plu cmap protein gromo forc field gromo forc field improv alkan dihedr gromo forc field schuler jcc gromo forc field jcc vol pag gromo forc field jcc vol pag gromo forc field eur biophi j doi oplsaal allatom forc field aminoacid dihedr forc field includ begin topolog file includ statement follow nameffforcefielditp statement includ forcefield file turn may includ forcefield file forc field organ way exampl amberffforcefielditp shown reftopfil forc field sever file use refpdbgmx gmx pdbgmx residu databas refrtp hydrogen databas refhdb two termini databas ntdb ctdb see atom type databas refatp contain mass option file describ sec refpdbgmxfil chang forcefield paramet one want chang paramet bond interact molecul easili accomplish type paramet behind definit bond interact directli reftop file moleculetyp section see reftopfil format unit one want chang paramet instanc certain interact one chang forcefield file add new type section includ forc field paramet certain interact defin multipl time last definit use gromac version warn gener paramet redefin differ valu chang lennardjon paramet atom type recommend gromo forc field lennardjon paramet sever combin atom type gener accord standard combin rule combin possibl other follow combin rule defin nonbond_param section chang lennardjon paramet atom type effect combin ad atom type gromac version atom type ad extra atomtyp section inclus normal forc field definit new atom type addit nonbond pair paramet defin pre version gromac new atom type need ad atomtyp section forcefield file nonbond paramet last atomtyp section would overwritten use standard combin rule raw latex clearpag _gmxcmdline commandlin refer toctre hidden glob onlinehelpgmx onlinehelpgmx gromac includ mani tool prepar run analyz molecular dynam simul structur part singl commandgmx wrapper binari invok command like commandgmx grompp commandgmx mdrun document found respect section well man page eg manpagegmxgrompp sampgmx help command sampgmx command h youv instal mpi version gromac default commandgmx binari call commandgmx_mpi adapt accordingli commandlin interfac convent gromac command requir option argument ie commandlin argument need preced argument start dash valu start dash argument preced option option except boolean flag expect argument multipl case option name argument must separ commandlin argument ie separ space f trajxtc one argument need given option similarli separ option also default argument ie specifi option without argument use default argument option specifi default valu use case option file default might use file see gromac command option start singl dash whether singl multiplelett option howev two dash also recogn start addit commandspecif option option handl commandgmx wrapper specifi command see docwrapp binari help onlinehelpgmx list option option recogn command name eg commandgmx quiet grompp well command name eg commandgmx grompp quiet also hidden option specifi combin h show help advanceddevelopertarget option analysi command process trajectori fewer atom run input structur file trajectori consist first n atom run input structur file handl specif type commandlin option boolean option boolean flag specifi like pbc negat like nopbc also possibl use explicit valu like pbc pbc ye file name option option accept file name featur support use default file name default file name specif option requir option set default use option mark option file use unless option set condit make file requir option set file name provid default use option accept file name without file extens extens automat append case multipl input format accept gener structur format directori search file type suppli default name file recogn extens found error given output file multipl format default file type use file format also read compress filez filegz format enum option enumer option enum use one argument list option descript argument may abbrevi first match shortest argument list select vector option option accept vector valu either paramet suppli one paramet suppli two valu also set valu select option see doconlinehelpselect command name includ fragmentsbynamerst command topic includ fragmentsbytopicrst special topic inform topic also access sampgmx help topic command line select syntax usag toctre onlinehelpselect _commandchang command chang version start gromac analysi command command well chang significantli one main driver mani new tool mention accept select one commandlin option instead prompt static index group take full advantag select interfac command chang somewhat previou commandlin option longer present effect achiev suitabl select pleas see doconlinehelpselect addit inform use select process old analysi command remov favor power function avail altern tool remov replac command page document perform task new tool new command brief note avail featur given see link help new command full descript section list major chang minor chang like additionalremov option bug fix typic includ inform chang featur pleas check refreleas note releasenot version gmx converttrj new refgmx converttrj introduc selectionen altern exchang trajectori file format previous done refgmx trjconv gmx extractclust new refgmx extractclust introduc selectionen way write subtrajectori base output cluster analysi correspond option sub refgmx trjconv remov version gmx trajectori new refgmx trajectori introduc selectionen version refgmx traj support output coordin veloc andor forc posit calcul select version analysi arbitrari subset atom tool implement new analysi framework oper upon trajectori match subset atom input structur file gmx insertmolecul improv refgmx insertmolecul gain option replac make possibl insert molecul solvat configur replac overlap solvent atom fulli solvat box also possibl insert certain region solvent select subset solvent atom replac take select also contain express like within gmx rdf improv normal output rdf also radial number densiti gmx genconf simplifi remov block sort shuffl version gener symbol link longer support way invok command sampgmx command gmx pairdist new refgmx pairdist introduc selectionen replac refgmx mindist gmx mindist still exist unchang calcul minmax pairwis distanc pair select includ eg perresidu minimum distanc distanc singl point set residuecentersofmass gmx rdf rewritten refgmx rdf rewritten use select specifi point rdf calcul interfac mostli except new commandlin option specifi select follow addit chang made com rdf option remov equival function avail select com replac sampcom select refer select rdf replac suitabl set select eg sampres_com select andor use seltyp rmax option ad specifi cutoff rdf set valu significantli smaller half box size speed calcul significantli gridbas neighborhood search use hq fade option remov simpli postprocess step raw number easili done analysi version gener version introduc commandgmx wrapper binari backward compat version still creat symbol link default old tool eg g_order option equival gmx order option g_order simpli symbol link file system g_bond replac tool remov replac refgmx distanc provid exist index file refgmx distanc calcul distanc differ blen tol option differ default valu control output histogram binw aver averdist option present instead choos differ thing calcul use oav correspond averdist oall correspond without averdist oh correspond aver oallstat correspond l without aver produc combin output file compar g_bond gmx distanc oall current miss label output column g_dist replac tool remov replac refgmx distanc option refgmx select dist lt index group b fileindexndx g_dist use follow command comput distanc gmx distanc gmx distanc n indexndx select com group plu com group b oxyz oall intra switch replac nopbc use dist calcul gmx select gmx select n indexndx select group b within com group onoiosolt select output option best suit postprocess need olt replac g_dist dist lt gmx distanc new refgmx distanc introduc selectionen replac variou tool comput distanc fix pair atom centersofmass group combin featur g_bond g_dist allow comput one multipl distanc either atomatom pair centersofmass group provid combin output option avail one tool gmx gangl new refgmx gangl introduc selectionen replac g_sgangl addit support atomatom vector centersofmass use endpoint vector addit angl type calcul command also basic support calcul normal angl three atom andor centersofmass make partial replac refgmx angl well gmx proton replac old tool origin written unit atom forc field necessari gener hydrogen run trajectori order calcul eg distanc restraint violat function simpli proton structur avail refgmx pdbgmx signific interest might reintroduc move new topolog format futur gmx freevolum new tool introduc use mont carlo sampl method calcul fraction free volum within box use probe given size g_sa rewritten tool rewritten renam refgmx sasa underli surfac area calcul algorithm still main differ new tool support select instead prompt index group potenti dynam select calcul given surfac number output group given output allow multipl part surfac area comput singl run total area surfac group alway calcul tool longer automat divid surfac hydrophob hydrophil area f_index option effect obtain defin suitabl select output want output contain number old tool calcul group output group b use gmx sasa surfac group output hydrophob group charg hydrophil group b charg total group b solvat free energi estim calcul separ request odg written separ file output option posit restraint file current implement new tool would difficult add request g_sgangl replac tool remov replac refgmx gangl angl calcul refgmx distanc od od od index group b indexndx g_sgangl use follow command comput angl gmx gangl gmx gangl n indexndx g vectorplan group group g vectorplan group group b oav need select either vector plane g g option depend one index group specifi singl index group indexndx use g_sgangl z one use gmx gangl n indexndx g vectorplan group group g zt oav distanc use refgmx distanc comput one distanc want distanc center group individu atom support use new select syntax genbox tool split refgmx solvat refgmx insertmolecul tpbconv tool renam refgmx converttpr _gmxffinclud forc field gromac _gmxamberff amber amber_ assist model build energi refin refer set molecular mechan refforc field gmxforcefield simul biomolecul packag molecular simul program gromac version higher support follow amber forc field nativ amber amber amber ambersb ambersbildn amber amberg inform concern forc field found use follow inform amber forc field httpambermdorgff__ background amber forc field amber program httpambermdorgcode__ inform amber suit program molecular simul antechambergaff httpambermdorgantechamberantechamberhtml__ gener amber forc field gaff suppos provid paramet suitabl small molecul compat amber proteinnucl acid forc field avail either togeth amber antechamb packag also distribut separ script avail convert amber system set exampl gaff gromac ambgmxpl httpsgithubcomchoderalabmmtoolsblobmasterconvertersambgmxpl__ acpyp httpsgithubcomalanwilteracpype_ requir ambertool httpsambermdorgambertoolsphp_ instal work older gromac version need separ instal ffamber port use amber forc field gromac httpchemistrycsulbeduffamber__ known ffamber port number amber forc field complet document use ffamber port gromac requir input structur file adher amber nomenclatur residu problemat residu involv termini prefix n c lysin either lyn lyp histidin hid hie cystein cyn cyx pleas see ffamber document httpchemistrycsulbeduffamberusage__ _amber httpambermdorg _gmxcharmmff charmm charmm_ chemistri harvard macromolecular mechan set forc field softwar packag refmolecular dynam gmxmd simul analysi includ unit atom charmm atom charmm charmm charmm refforc field gmxforcefield charmm forc field port gromac offici support version charmm forc field file obtain mackerel lab website_ regularli produc uptod charmm forc field file gromac format _charmm httpwwwcharmmorg _mackerel lab websit httpmackerellumarylandeducharmm_ffshtmlgromac use charmm gromac newer pleas use follow set refmdp file constraint hbond cutoffschem verlet vdwtype cutoff vdwmodifi forceswitch rlist rvdw rvdwswitch coulombtyp pme rcoulomb dispcorr note dispers correct appli case lipid monolay bilay pleas also note switch distanc matter debat lipid bilay simul depend extent natur lipid studi found nm switch appropri other argu nm best yet other stand nm user caution thoroughli investig forc field literatur chosen lipid begin simul anyon use old version gromac may find script use charmm gromac perl script intend facilit calcul use gromac program charmm forcefield need gromac version link httpwwwgromacsorgapidekifilescharmm_to_gromacstgz_ _gmxgromosff gromo gromos_ generalpurpos molecular dynam comput simul packag studi biomolecular system also incorpor forc field cover protein nucleotid sugar etc appli chemic physic system rang glass liquid crystal polym crystal solut biomolecul gromac support gromo forc field paramet provid distribut gromo forc field refunit atom forc field gmxforcefield ie without explicit aliphat nonpolar hydrogen gromo gromac format j comput chem vol gromo gromac format j comput chem vol gromo ap modifi contain sep phosphoserin tpo phosphothreonin ptr phosphotyrosin po form seph tpoh ptrh poh form todo add new forc field list _gromo httpswwwigcethzchgromoshtml _refer manual gmxmanualparentdir_ _gmxopl opl opl optim potenti liquid simul set forc field develop prof william l jorgensen condens phase simul latest version oplsaam httpzarbichemyaleeduoplsaamhtml__ standard implement forc field boss mcpro program develop jorgensen group httpzarbichemyaleedusoftwarehtml__ central webpag point user advis consult origin literatur unit atom oplsua httpsdoiorgfjaa__ atom oplsaa httpsdoiorgfja__ forc field well jorgensen group page httpzarbichemyaleedu__ _gmxperform get good perform refmdrun gmx mdrun give overview parallel acceler scheme employ gromac aim provid understand underli mechan make gromac one fastest molecular dynam packag inform present help choos appropri parallel option run configur well acceler option achiev optim simul perform gromac build system refgmx mdrun tool lot builtin configur intellig detect hardwar make pretti effect use lot casual seriou use refgmx mdrun automat machineri work well enough get hardwar maxim scientif qualiti read hardwar background inform modern comput hardwar complex heterogen need discuss littl bit background inform set definit experienc hpc user skip section glossari core hardwar comput unit actual execut instruct normal one core processor often mani cach special kind memori local core much faster access main memori kind like top human desk compar file cabinet often sever layer cach associ core socket group core share kind local share cach make effici spread comput work core within socket core differ socket modern processor often one socket node group socket share coarserlevel local share access memori without requir network hardwar normal laptop desktop comput node node often smallest amount larg comput cluster user request use thread stream instruct core execut mani differ program abstract creat manag spread comput multipl thread openmp pthread winthread cuda opencl openacc kind hardwar map one softwar thread core intel x processor call hyperthread gener concept often call smt simultan multithread ibm power instanc use hardwar thread per core featur usual enabl disabl either hardwar bio set linux oper system gromac typic make use moder free perform boost case enabl default eg new x processor case system administr might disabl case ask reenabl sure enabl check output cpu inform log file compar cpu specif find onlin thread affin pin default oper system allow softwar thread migrat core hardwar thread help automat balanc workload howev perform refgmx mdrun deterior permit degrad dramat especi reli multithread within rank avoid refgmx mdrun default set affin thread individu coreshardwar thread unless user softwar environ alreadi done entir node use run ie potenti node share set thread affin sometim call thread pin mpi domin multinod parallelizationschem provid standard languag program written work across one node rank mpi rank smallest group hardwar use multinod parallel scheme group control user might correspond core socket node group node best choic vari hardwar softwar comput task sometim mpi rank call mpi process gpu graphic process unit often faster effici convent processor particular kind comput workload gpu alway associ particular node often particular socket within node openmp standard techniqu support mani compil share comput workload multipl core often combin mpi achiev hybrid mpiopenmp parallel cuda proprietari parallel comput framework api develop nvidia allow target acceler hardwar gromac use cuda gpu acceler support nvidia hardwar opencl open standardbas parallel comput framework consist cbase compil program api target heterogen acceler hardwar gromac use opencl gpu acceler amd devic gpu apu intel integr gpu nvidia hardwar also support simd type cpu instruct modern cpu core execut multipl floatingpoint instruct singl cycl work distribut parallel gromac algorithm refgmx mdrun implement relev choos make good use hardwar detail see refrefer manual gmxreferencemanualrst import _gmxdomaindecomp glossari domain decomposit domain decomposit dd algorithm decompos shortrang compon nonbond interact domain share spatial local permit use effici algorithm domain handl particleparticl pp interact member map singl mpi rank within pp rank openmp thread share workload work offload gpu pp rank also handl bond interact member domain gpu may perform work one pp rank normal effici use singl pp rank per gpu rank thousand particl work pp rank done cpu refmdrun gmx mdrun make extens use simd capabl core variou refcommandlin option controllingthedomaindecompositionalgorithm control behaviour dd algorithm particlemesh ewald particlemesh ewald pme algorithm treat longrang compon nonbond interact coulomb possibl also lennardjon either subset rank may particip work comput longrang compon often inaccur call simpli pme compon algorithm use fft requir global commun parallel effici get wors rank particip mean fastest use subset rank eg onequart onehalf rank separ pme rank remain rank handl pp work otherwis rank pp pme work parallel scheme gromac performanceori strong focu effici parallel multipl parallel scheme avail therefor simul run given hardwar differ choic run configur _intracoreparallel intracor parallel via simd sse avx etc one level perform improv avail gromac use singl instruct multipl data simd instruct detail inform found refsimd support gmxsimdsupport instal guid gromac simd instruct use parallel part code highest impact perform nonbond bond forc calcul pme neighbour search use hardwar specif simd kernel form one three level nonbond kernel avail refer gener kernel slow use produc refer valu test optim plainc kernel use crossplatform still slow simd intrins acceler kernel simd intrins code compil compil technic possibl compil differ level acceler one binari difficult manag acceler mani part code thu need configur compil gromac simd capabl target cpu default build system detect highest support acceler host compil carri crosscompil machin differ highest simd instruct set order set target acceler dgmx_simd cmake option use use singl instal multipl differ machin conveni compil analysi tool lowest common simd instruct set reli littl simd acceler best perform refmdrun gmx mdrun compil compil separ highest latest nativ simd instruct set target architectur support gromac recent intel cpu architectur bring tradeoff maximum clock frequenc cpu ie speed width simd instruct execut ie throughput given speed particular intel skylak cascad lake processor eg xeon sp goldplatinum offer better throughput use narrow simd better clock frequenc avail consid build refmdrun gmx mdrun configur gmx_simdavx_ instead gmx_simdavx better perform gpu acceler highli parallel mpi run latest arm base cpu fujitsu afx support scalabl vector extens sve though sve use gener fairli effici vector length agnost vla code good fit gromac simd vector length assum known cmake time consequ sve vector length must fix cmake time default automat detect default vector length cmake time via procsysabisve_default_vector_length pseudofil chang configur gmx_simd_arm_sve_lengthlen support vector length sinc simd shortrang nonbond kernel support float point number per simd vector bit vector length valid doubl precis eg dgmx_doubleon note even refmdrun gmx mdrun check simd vector length runtim run differ vector length one use cmake time undefin behavior refmdrun gmx mdrun might crash reach check would abort userfriendli error messag processor level parallel via openmp gromac refmdrun gmx mdrun support openmp multithread part code openmp enabl default turn onoff configur time gmx_openmp cmake variabl runtim ntomp option omp_num_thread environ variabl openmp implement quit effici scale well thread intel thread amd cpu node level parallel via gpu offload threadmpi multithread threadmpi threadmpi librari implement subset mpi specif base system thread support posix pthread window thread support thu provid great portabl unixlinux window oper system act dropin replac mpi threadmpi enabl compil run refmdrun gmx mdrun singl machin ie across network without mpi addit provid conveni way use comput multicor cpu threadmpi case make refmdrun gmx mdrun run slightli faster mpi threadmpi includ gromac sourc default parallel sinc version practic render serial refmdrun gmx mdrun deprec compil threadmpi control gmx_thread_mpi cmake variabl threadmpi compat refmdrun gmx mdrun featur parallel scheme includ openmp gpu compat mpi multisimul run default threadmpi refmdrun gmx mdrun use avail core machin start appropri number rank openmp thread occupi number rank control use nt ntmpi option nt repres total number thread use mix threadmpi openmp thread hybridheterogen acceler hybrid acceler mean distribut comput work avail cpu gpu improv simul perform new nonbond algorithm develop aim effici acceler cpu gpu computeintens part simul nonbond forc calcul well possibl pme bond forc calcul updat constraint offload gpu carri simultan remain cpu work nativ gpu acceler support commonli use algorithm gromac inform gpu kernel pleas see refinstal guid gmxgpusupport nativ gpu acceler turn either runtim use refmdrun gmx mdrun nb option configur time use gmx_gpu cmake variabl effici use comput resourc avail cpu gpu comput done simultan overlap openmp multithread bond forc pme longrang electrostat calcul cpu nonbond forc calcul gpu multipl gpu singl node well across multipl node support use domaindecomposit singl gpu assign nonbond workload domain therefor number gpu use match number mpi process threadmpi thread simul start avail cpu core partit among process threadmpi thread set core gpu calcul respect domain pme electrostat refmdrun gmx mdrun support autom cpugpu loadbalanc shift workload pme mesh calcul done cpu particleparticl nonbond calcul done gpu startup iter tune execut first md step iter involv scale electrostat cutoff pme grid space determin valu give optim cpugpu load balanc cutoff valu provid use mdprcoulomb rvdw refmdp option repres minimum electrostat cutoff tune start therefor chosen small possibl still reason physic simul lennardjon cutoff rvdw kept fix dont allow scale shorter cutoff dont want chang rvdw would perform gain autom cpugpu load balanc alway attempt find optim cutoff set might alway possibl balanc cpu gpu workload happen cpu thread finish calcul bond forc pme faster gpu nonbond forc calcul even shortest possibl cutoff case cpu wait gpu time show wait gpu local cycl time summari tabl end log file parallel multipl node via mpi heart mpi parallel gromac neutralterritori refdomain decomposit gmxdomaindecomp dynam load balanc parallel simul across multipl machin eg node cluster refmdrun gmx mdrun need compil mpi enabl use gmx_mpi cmake variabl _controllingthedomaindecompositionalgorithm control domain decomposit algorithm section list option affect domain decomposit algorithm decompos workload avail parallel hardwar rdd use set requir maximum distanc inter chargegroup bond interact commun twobodi bond interact nonbond cutoff distanc alway come free nonbond commun particl beyond nonbond cutoff commun miss bond interact mean extra cost minor nearli independ valu rdd dynam load balanc option rdd also set lower limit domain decomposit cell size default rdd determin refgmx mdrun base initi coordin chosen valu balanc interact rang commun cost ddcheck default inter chargegroup bond interact beyond bond cutoff distanc refgmx mdrun termin error messag pair interact tabul bond gener exclus check turn option noddcheck rcon constraint present option rcon influenc cell size limit well particl connect nc constraint nc linc order plu beyond smallest cell size error messag gener happen user chang decomposit decreas linc order increas number linc iter default refgmx mdrun estim minimum cell size requir plinc conserv fashion high parallel use set distanc requir plinc rcon dd set minimum allow x andor z scale cell dynam load balanc refgmx mdrun ensur cell scale least factor option use autom spatial decomposit use dd well determin number grid puls turn set minimum allow cell size certain circumst valu dd might need adjust account high low spatial inhomogen system multilevel parallel mpi openmp multicor trend cpu develop substanti need multilevel parallel current multiprocessor machin cpu core count high memori cach subsystem lag behind multicor evolut emphas nonuniform memori access numa effect becom perform bottleneck time core share network interfac pure mpiparallel scheme mpi process use network interfac although mpi intranod commun gener effici commun node becom limit factor parallel especi pronounc case highli parallel simul pme commun intens fat node connect slow network multilevel parallel aim address numa commun relat issu employ effici intranod parallel typic multithread combin openmp mpi creat addit overhead especi run separ multithread pme rank depend architectur input system size well factor mpiopenmp run fast faster alreadi small number process eg multiprocessor intel westmer sandi bridg also consider slower eg multiprocessor amd interlago machin howev pronounc benefit multilevel parallel highli parallel run separ pme rank cpu rank particleparticl pp pme calcul done process one anoth pme requir alltoal global commun time limit factor scale larg number core design subset rank pme calcul perform parallel run greatli improv openmp mutithread pme rank also possibl use multithread pme improv perform high parallel reason n thread number process commun therefor number messag reduc factor n note modern commun network process sever messag simultan could advantag process commun separ pme rank use low parallel switch higher parallel happen automat process number pme rank estim mdrun pme load higher pp load mdrun automat balanc load lead addit nonbond calcul avoid idl larg fraction rank usual rank pp rank ensur best absolut perform highli parallel run advis tweak number autom reftune_pm gmx tune_pm tool number pme rank set manual refmdrun gmx mdrun command line use npme option number pme thread specifi command line ntomp_pm altern use gmx_pme_num_thread environ variabl latter especi use run comput node differ number core enabl set differ number pme thread differ node run refmdrun gmx mdrun within singl node refgmx mdrun configur compil sever differ way effici use within singl termnod default configur use suitabl compil deploy multilevel hybrid parallel use cuda openmp thread platform nativ hardwar program conveni gromac nativ thread use implement singl node mpi scheme would use node much effici call threadmpi user perspect real mpi threadmpi look almost gromac refer mpi rank mean either kind except note real extern mpi use refgmx mdrun within singl node run slowli threadmpi version default refgmx mdrun inspect hardwar avail run time best make fairli effici use whole node log file stdout stderr use print diagnost inform user choic made possibl consequ number commandlin paramet avail modifi default behavior nt total number thread use default start mani thread avail core whether thread threadmpi rank andor openmp thread within rank depend set ntmpi total number threadmpi rank use default start one rank per gpu present otherwis one rank per core ntomp total number openmp thread per rank start default start one thread avail core altern refmdrun gmx mdrun honor appropri system environ variabl eg omp_num_thread set note maximum number openmp thread per rank effici reason limit rare benefici use number thread higher gmx_openmp_max_thread cmake variabl use increas limit npme total number rank dedic longrang compon pme use default dedic rank total number thread least use around quarter rank longrang compon ntomp_pm use pme separ pme rank total number openmp thread per separ pme rank default copi valu ntomp pin set auto control whether refmdrun gmx mdrun attempt set affin thread core default auto mean refmdrun gmx mdrun detect core node use refmdrun gmx mdrun behav like attempt set affin unless alreadi set someth els pinoffset pin specifi logic core number refmdrun gmx mdrun pin first thread run one instanc refmdrun gmx mdrun node use option avoid pin thread differ refmdrun gmx mdrun instanc core pinstrid pin specifi stride logic core number core refmdrun gmx mdrun pin thread run one instanc refmdrun gmx mdrun node use option avoid pin thread differ refmdrun gmx mdrun instanc core use default minim number thread per physic core let refmdrun gmx mdrun manag hardwar os configurationspecif detail map logic core physic core ddorder set interleav pp_pme cartesian default interleav mean separ pme rank map mpi rank order like pp pp pme pp pp pme etc gener make best use avail hardwar pp_pme map pp rank first pme rank cartesian specialpurpos map gener use special toru network acceler global commun cartesian commun effect separ pme rank nb use set execut shortrang nonbond interact set auto cpu gpu default auto use compat gpu avail set cpu requir gpu use set gpu requir compat gpu avail use pme use set execut longrang nonbond interact set auto cpu gpu default auto use compat gpu avail set gpu requir compat gpu avail multipl pme rank support pme gpu gpu use pme calcul npme must set bond use set execut bond interact part pp workload domain set auto cpu gpu default auto use compat cuda gpu one avail gpu handl shortrang interact cpu handl longrang interact work electrostat lj work bond interact take place gpu shortrang interact independ assign set gpu requir compat gpu avail use updat use set execut updat constraint present set auto cpu gpu default auto current alway use cpu set gpu requir compat cuda gpu avail simul use singl rank updat constraint gpu current support mass constraint freeenergi perturb domain decomposit virtual site ewald surfac correct replica exchang constraint pull orient restraint comput electrophysiolog gpu_id string specifi id number gpu avail use rank node exampl specifi gpu id report gpu runtim use refmdrun gmx mdrun use share node comput gpu dedic display use gromac without specifi paramet refmdrun gmx mdrun util gpu mani gpu present comma may use separ id would make gpu avail refmdrun gmx mdrun could necessari use differ gpu differ node simul case environ variabl gmx_gpu_id set differ rank differ node achiev result gromac version preced paramet use specifi gpu avail gpu task assign latter done gputask paramet gputask string specifi id number gpu use correspond gpu task node exampl specifi first two gpu task use gpu two use gpu use option number rank must known refmdrun gmx mdrun well task differ type run use nb gpu task set run gpu count pars map see assign task gpus_ detail note gpu_id gputask use time gromac version preced singl type gpu task pp could run rank support run pme gpu number gpu task number gpu id expect gputask string actual singlerank simul id still case use multipl gpu per singl rank yet implement order gpu task per rank string pp first pme second order rank differ kind gpu task default influenc ddorder option get quit complex use multipl node note bond interact pp task may run gpu shortrang work cpu control bond flag gpu task assign whether manual set autom report refmdrun gmx mdrun output first physic node simul exampl gmx mdrun gputask nb gpu pme gpu npme ntmpi produc follow output log filetermin host tcbl gpu select run map gpu id gpu task rank node pppppppme case rank set user comput pp work gpu rank comput pme gpu detail index gpu also report log file inform gpu task pleas refer reftyp gpu tasksgmxgputask pmefft allow choos whether execut fft comput cpu gpu set auto cpu gpu pme offload gpu pmefft gpu default entir pme calcul execut gpu howev case eg rel slow older gener gpu combin fast cpu core run move work gpu back cpu comput fft cpu improv perform _gmxmdrunsinglenod exampl refmdrun gmx mdrun one node gmx mdrun start refmdrun gmx mdrun use avail resourc refmdrun gmx mdrun automat choos fairli effici divis threadmpi rank openmp thread assign work compat gpu detail vari hardwar kind simul run gmx mdrun nt start refmdrun gmx mdrun use thread might threadmpi openmp thread depend hardwar kind simul run gmx mdrun ntmpi ntomp start refmdrun gmx mdrun use eight total thread two threadmpi rank four openmp thread per rank use option seek optim perform must take care rank creat openmp thread run socket number rank multipl number socket number core per node multipl number thread per rank gmx mdrun ntmpi nb gpu pme cpu start refmdrun gmx mdrun use four threadmpi rank cpu core avail split evenli rank use openmp thread longrang compon forc calcul cpu may optim hardwar cpu rel power compar gpu bond part forc calcul automat assign gpu sinc longrang compon forc calcul cpu gmx mdrun ntmpi nb gpu pme gpu bond gpu updat gpu start refmdrun gmx mdrun use singl threadmpi rank use avail cpu core interact type run gpu may optim hardwar cpu extrem weak compar gpu gmx mdrun ntmpi nb gpu pme cpu gputask start refmdrun gmx mdrun use four threadmpi rank map gpu id cpu core avail split evenli rank use openmp thread first two rank offload shortrang nonbond forc calcul gpu last two rank offload gpu longrang compon forc calcul cpu may optim hardwar cpu rel power compar gpu gmx mdrun ntmpi nb gpu pme gpu npme gputask start refmdrun gmx mdrun use four threadmpi rank one dedic longrang pme calcul first thread offload shortrang nonbond calcul gpu id th pme thread offload calcul gpu id gmx mdrun ntmpi nb gpu pme gpu npme gputask similar exampl rank assign calcul shortrang nonbond forc one rank assign calcul longrang forc case shortrang rank offload nonbond forc calcul gpu gpu id calcul shortrang forc rd shortrang rank well longrang forc pmeded rank whether exampl optim depend capabl individu gpu system composit gmx mdrun gpu_id start refmdrun gmx mdrun use gpu id eg gpu dedic run display requir two threadmpi rank split avail cpu core use openmp thread gmx mdrun nt pin pinoffset pinstrid gmx mdrun nt pin pinoffset pinstrid start two refmdrun gmx mdrun process six total thread arrang process affect littl possibl assign disjoint set physic core thread affin set particular logic core begin first th logic core respect would work well intel cpu six physic core hyperthread enabl use kind setup restrict refmdrun gmx mdrun subset core share node process word caution map logic cpuscor physic core may differ oper system linux cat proccpuinfo examin determin map mpirun np gmx_mpi mdrun use refgmx mdrun compil extern mpi start two rank mani openmp thread hardwar mpi setup permit mpi setup restrict one node result refgmx mdrun local node _gmxmdrunmultiplenod run refmdrun gmx mdrun one node requir configur gromac build extern mpi librari default refmdrun gmx mdrun execut run gmx_mpi mdrun consider run singlenod refmdrun gmx mdrun still appli except ntmpi nt caus fatal error instead number rank control mpi environ set npme much import use multipl node configur mpi environ produc one rank per core gener good one approach strongscal limit point use openmp spread work mpi rank one core need continu improv absolut perform locat scale limit depend processor presenc gpu network simul algorithm worth measur around particlescor need maximum throughput commandlin paramet relev case tunepm default simul optim variou aspect pme dd algorithm shift load rank andor gpu maxim throughput refmdrun gmx mdrun featur compat ignor option dlb set auto ye default auto dynam load balanc mpi rank need maxim perform particularli import molecular system heterogen particl interact densiti certain threshold perform loss exceed dlb activ shift particl rank improv perform avail use bond gpu expect improv abil dlb maxim perform simul refgmx mdrun must commun pp rank comput quantiti kinet energi log file report perhap temperatur coupl default happen whenev necessari honor sever refmdp option mdpgener period commun phase least common denomin mdpnstlist mdpnstcalcenergi mdpnsttcoupl mdpnstpcoupl note tunepm effect one termnod cost commun pp pme rank differ still shift load pp pme rank chang number separ pme rank use note also dlb tunepm interfer experi perform variat could result may wish tune pme separ run result mdrun notunepm dlb ye refgmx tune_pm util avail search wider rang paramet space includ make safe modif reftpr file vari npme awar number rank creat mpi environ explicitli manag aspect openmp optim exampl refmdrun gmx mdrun one node exampl explan singlenod refmdrun gmx mdrun still relev ntmpi longer way choos number mpi rank mpirun np gmx_mpi mdrun start refgmx mdrun rank map hardwar mpi librari eg specifi mpi hostfil avail core automat split among rank use openmp thread depend hardwar environ set omp_num_thread mpirun np gmx_mpi mdrun npme start refgmx mdrun rank requir dedic pme compon mpirun np gmx_mpi mdrun ntomp npme ntomp_pm start refgmx mdrun rank requir six dedic pme compon one openmp thread remain five pp compon two openmp thread mpirun np gmx_mpi mdrun ntomp nb gpu gputask start refgmx mdrun machin two node use four total rank rank six openmp thread rank node share gpu id mpirun np gmx_mpi mdrun ntomp gputask use samesimilar hardwar start refgmx mdrun machin two node use eight total rank rank three openmp thread four rank node share gpu id may may faster previou setup hardwar mpirun np gmx_mpi mdrun ntomp gputask start refgmx mdrun rank assign cpu core evenli across rank one openmp thread setup like suitabl ten node one gpu node two socket four core mpirun np gmx_mpi mdrun gpu_id start refgmx mdrun rank assign cpu core evenli across rank one openmp thread setup like suitabl ten node two gpu anoth job node use gpu job schedul set affin thread job alloc core perform refmdrun gmx mdrun suffer greatli mpirun np gmx_mpi mdrun gpu_id start refgmx mdrun rank setup like suitabl ten node two gpu need specifi gpu_id normal case gpu node avail use approach scale limit sever aspect run gromac simul import number atom per core approach current scale limit atomscor one use constraint allbond plinc set artifici minimum size domain reconsid use constraint bond bear mind possibl consequ safe maximum dt chang lincs_ord lincs_it suitabl find run refmdrun gmx mdrun better wallcycl modul use runtim perform measur refgmx mdrun end log file run real cycl time account section provid tabl runtim statist differ part refgmx mdrun code row tabl tabl contain column indic number rank thread execut respect part run walltim cycl count aggreg across thread rank averag entir run last column also show precentag total runtim row repres note refgmx mdrun timer reset function resethway resetstep reset perform counter therefor use avoid startup overhead perform instabl eg due load balanc begin run perform counter particleparticl particl mesh ewald domain decomposit domain decomposit commun load domain decomposit commun bound virtual site constraint send x particl mesh ewald neighbor search launch gpu oper commun coordin forc wait commun forc particl mesh ewald pme redist xf pme spread pme gather pme dfft pme dfft commun pme solv lennardjon pme solv lj pme solv elec pme wait particleparticl wait receiv pme forc wait gpu nonloc wait gpu local wait pme gpu spread wait pme gpu gather reduc pme gpu forc nonbond positionforc buffer oper virtual site spread com pull forc awh acceler weight histogram method write trajectori updat constraint commun energi enforc rotat add rotat forc posit swap interact md perform data collect everi run essenti assess tune perform refgmx mdrun perform therefor benefit code develop well user program counter averag timecycl differ part simul take henc directli reveal fluctuat singl run although comparison across multipl run still use counter appear md log file relat part code execut refgmx mdrun run also special counter call rest indic amount time account counter therefor signific amount rest time percent often indic parallel ineffici eg serial code recommend report develop addit set subcount offer finegrain inspect perform domain decomposit redistribut dd neighbor search grid sort dd setup commun dd make topolog dd make constraint dd topolog neighbor search grid local ns grid nonloc ns search local ns search nonloc bond forc bondedfep forc restraint forc list buffer oper nonbond prune nonbond forc launch nonbond gpu task launch pme gpu task ewald forc correct nonbond posit buffer oper nonbond forc buffer oper subcount gear toward develop enabl compil see docdevmanualbuildsystem inform todo futur patch red flag log file interpret wallcycl output hint dev extend wallcycl _gmxmdrunongpu run refmdrun gmx mdrun gpu _gmxgputask type gpu task better understand later section differ gpu use case calcul refshort rangegmxgpupp refpmegmxgpupm refbond interactionsgmxgpubond refupd constraint gmxgpuupdat first introduc concept differ gpu task think run simul sever differ kind interact atom calcul inform pleas refer refer manual calcul thu split sever distinct part larg independ henc calcul order eg sequenti concurr inform combin end time step obtain final forc atom propag system next time point better understand also pleas see section refdomain decomposit gmxdomaindecomp calcul requir md step gromac aim optim perform bottomup step lowest level simd unit core socket acceler etc therefor mani individu comput unit highli tune lowest level hardwar parallel simd unit addit gpu acceler use coprocessor work offload calcul simultaneouslyconcurr cpu acceler devic result commun cpu right gromac support gpu acceler offload two task shortrang refnonbond interact real space gmxgpupp refpm gmxgpupm pleas note solv pme gpu still initi version support behaviour come set limit outlin right gener support shortrang nonbond offload without dynam prune wide rang gpu acceler nvidia amd intel compat grand major featur parallel mode use scale larg machin simultan offload shortrang nonbond longrang pme work gpu acceler new featur restrict term featur parallel compat pleas see refsect gmxpmegpulimit _gmxgpupp gpu comput short rang nonbond interact todo make elabor includ figur use gpu shortrang nonbond interact provid major avail speedup compar run use cpu gpu act acceler effect parallel problem thu reduc calcul time _gmxgpupm gpu acceler calcul pme todo extend add actual use inform concern perform etc gromac allow offload pme calcul gpu reduc load cpu improv usag overlap cpu gpu solv pme perform addit calcul short rang interact gpu short rang interact _gmxpmegpulimit known limit pleas note limit outlin pme order support gpu pme run gpu exactli one rank pme task ie decomposit multipl rank pme support singl precis support dynam integr support ie leapfrog veloc verlet stochast dynam lj pme support gpu _gmxgpubond gpu acceler calcul bond interact cuda todo extend add actual use inform concern perform etc gromac allow offload bond part pp workload cudacompat gpu treat part pp work requir shortrang nonbond task also run gpu typic perform advantag offload bond interact particular amount cpu resourc per gpu rel littl either cpu weak cpu core assign gpu run comput cpu typic case latter freeenergi calcul _gmxgpuupdat gpu acceler calcul constraint coordin updat cuda sycl todo extend add actual use inform concern perform etc gromac make possibl also perform coordin updat request constraint calcul cudacompat gpu allow execut support comput simul step gpu featur support singl domain run unless use experiment gpu domain decomposit featur need explicitli request user new parallel mode forc coordin data gpu resid number step typic neighbor search step benefit less coupl cpu host gpu typic md step data need transfer cpu gpu scheme howev still possibl part comput execut cpu concurr gpu calcul help support broad rang gromac featur port gpu time also allow improv perform make use otherwis mostli idl cpu often advantag move bond pme calcul back cpu detail depend rel perform cpu core pair simul gpu possibl chang default behaviour set gmx_force_update_default_gpu environ variabl nonzero valu case simul tri run part default gpu fall back cpu base calcul simul compat use parallel mode typic advantag case fast gpu use weak cpu particular singl simul assign gpu howev typic throughput case multipl run assign gpu offload everyth especi without move back work cpu perform wors parallel mode forc comput offload assign task gpu depend task perform hardwar differ kind calcul combin differ gpu accord inform provid run refmdrun gmx mdrun possibl assign calcul differ comput task gpu mean share comput resourc devic differ process unit perform one task one overview possibl task assign given gromac version two differ type assign gpu acceler task avail nb pme pp rank nb task offload gpu one rank pme task includ rank pmeonli rank task offload gpu pme task run wholli gpu latter stage run cpu limit pme gpu support pme domain decomposit one pme task offload singl gpu assign separ pme rank nb decompos offload multipl gpu gromac version new assign gpu task avail bond interact may run gpu shortrang interact pp task influenc bond flag perform consider gpu task perform balanc depend speed number cpu core vs speed number gpu slowold gpu andor fastmodern cpu mani core might make sens let cpu pme calcul gpu focus calcul nb fastmodern gpu andor slowold cpu core gener help gpu pme offload bond work gpu often improv simul perform effici cpubas kernel complet bond comput gpu done offload work therefor gmx mdrun default bond offload pme offload typic case perform improv bond offload signific bond work eg pure lipid mostli polym system littl solvent andor slow cpu core per gpu cpu comput eg pme free energi possibl use multipl gpu pme offload let eg mpi rank use one gpu shortrang interact fourth rank pme gpu way know sure altern best machin test check perform todo need concret ie machinesoftwar aspect take consider default run mode use pmegpu whenhow user reason test differ set default todo someon know mix mode comment reduc overhead gpu acceler run order cpu core gpu execut concurr task launch execut asynchron gpu cpu core execut nonoffload forc comput like longrang pme electrostat asynchron task launch handl gpu devic driver requir cpu involv therefor work schedul gpu task incur overhead case significantli delay interfer cpu execut delay cpu execut caus latenc launch gpu task overhead becom signific simul nsday increas ie shorter walltim per step overhead measur refgmx mdrun report perform summari section log file launch gpu op row percent runtim spent categori normal fastiter multigpu parallel run larger overhead observ gener user littl avoid overhead case tweak give perform benefit opencl run time gpu task default enabl case impact small fast run perform affect case percent launch gpu op time observ recommend turn time set gmx_disable_gpu_tim environ variabl parallel run mani rank share gpu launch overhead also reduc start fewer threadmpi mpi rank per gpu eg often one rank per thread core optim second type overhead interfer gpu driver cpu comput caus schedul coordin gpu task separ gpu driver thread requir cpu resourc may clash concurr run nonoffload task potenti degrad perform pme bond forc comput effect pronounc use amd gpu opencl older driver releas eg fglrx minim overhead recommend leav cpu hardwar thread unus launch refgmx mdrun especi cpu high core count andor hyperthread enabl eg machin core cpu eight thread via hyperthread amd gpu tri gmx mdrun ntomp pin leav free cpu resourc gpu task schedul reduc interfer cpu comput note assign fewer resourc refgmx mdrun cpu comput involv tradeoff may outweigh benefit reduc gpu driver overhead particular without hyperthread cpu core todo futur patch tip cover run opencl version mdrun current support hardwar architectur gcnbase amd gpu nvidia gpu least opencl support intel igpu make sure latest driver instal amd gpu computeori rocm httpsrocmgithubio_ stack recommend altern amdgpupro stack also compat use outdat unsupport fglrx proprietari driver runtim recommend certain older hardwar may way obtain support addit mesa version newer llvm newer also support nvidia gpu use proprietari driver requir open sourc nouveau driver avail mesa provid opencl support intel integr gpu neo driver httpsgithubcomintelcomputeruntimereleases_ recommend minimum opencl version requir required_opencl_min_vers see also refknown limit openclknownlimit devic amd gcn architectur seri compat regularli test nvidia kepler later comput capabl known work product run alway make sure gromac test pass success hardwar opencl gpu kernel compil run time henc build opencl program take second introduc slight delay refgmx mdrun startup normal problem long product md might prefer kind work eg run step cpu eg see nb gpu_id option gmx_gpu_id environ variabl use select cuda devic defin map gpu pp rank use opencl devic refopencl manag openclmanag environ variabl may interest develop _openclknownlimit known limit opencl support limit current opencl support interest gromac user intel integr gpu support intel cpu xeon phi support due block behavior asynchron task enqueu function nvidia opencl runtim affect driver version almost perform gain use nvidia gpu issu affect nvidia driver version seri known fix later driver releas nvidia gpu opencl kernel achiev much lower perform equival cuda kernel due limit nvidia opencl compil nvidia volta ture architectur opencl code known produc incorrect result driver version x like due compil issu run typic fail architectur limit interest gromac develop current implement requir minimum execut kernel compil narrow execut width due hardwar requir compil choic suitabl trigger runtim error perform checklist mani differ aspect affect perform simul gromac simul requir lot comput resourc therefor worthwhil optim use resourc sever issu mention list could lead perform differ factor use go checklist gromac configur dont use doubl precis unless your absolut sure need compil fftw librari correct flag x case correct flag automat configur x use gcc compil icc pgi cray compil power use gcc instead ibm xlc use new compil version especi gcc eg version perform compil code improv lot mpi librari openmpi usual good perform caus littl troubl make sure compil support openmp version clang dont gpu support either cuda opencl sycl use configur dgmx_gpucuda dgmx_gpuopencl dgmx_gpusycl cuda use newest cuda avail gpu take advantag latest perform enhanc use recent gpu driver make sure use refgmx mdrun gmx_simd appropri cpu architectur log file contain warn note suboptim set use howev prefer avx avx gpu highli parallel mpi run inform see refintracor parallel inform intracoreparallel compil cluster head node make sure gmx_simd appropri comput node run setup approxim spheric solut use rhombic dodecahedron unit cell use timestep fs use mdpvalueconstraintshbond mdpvalueconstraintsallbond sinc faster especi gpu forc field parametr bond involv hydrogen constrain increas timestep fs use virtual interact site gmx pdbgmx vsite h massiv parallel run pme might need tri differ number pme rank gmx mdrun npme achiev best perform refgmx tune_pm help autom search massiv parallel run also gmx mdrun multidir slow network global commun becom bottleneck reduc choos larger period algorithm temperatur pressur coupl check improv perform look end mdlog file see perform cycl counter wallclock time differ part md calcul pppme load ratio also print warn lot perform lost due imbal adjust number pme rank andor cutoff pme gridspac larg pppme imbal note even small report imbal autom pmetun might reduc initi imbal could still gain perform chang mdp paramet increas number pme rank neighbor search take lot time increas nstlist verlet buffer toler use done automat refgmx mdrun pairlist buffer increas keep energi drift constant comm energi take lot time note print log file increas nstcalcenergi commun take lot time might run mani core could tri run combin mpiopenmp parallel openmp thread per mpi process common error use gromac vast major error messag gener gromac descript inform user exact error lie error aris note along detail issu solv move text duplic page one page error two kept format new page chang later _commonerror common error usag _outofmemori memori alloc program attempt assign memori use calcul unabl due insuffici memori possibl solut reduc scope number atom select analysi reduc length trajectori file process case confus ngstrm nm may lead user gener refpdbgmx gmx pdbgmx water box time larger think eg refgmx solvat use comput memori instal memori comput replac sup user bear mind cost time andor memori variou activ scale number atomsgroupsresidu n simul length order n nlogn nsquar mayb wors depend type activ take long time think underli algorithm see refer manual_ man page use h flag util see there someth sensibl better scale properti _refer manual gmxmanualparentdir_ nsquar replac n sup _pdbgmxerror error refpdbgmx gmx pdbgmx residu xxx found residu topolog databas mean forc field select run refpdbgmx gmx pdbgmx entri refresidu databasertp xxx refresidu databasertp entri necessari standalon molecul eg formaldehyd peptid standard nonstandard entri defin atom type connect bond nonbond interact type residu necessari use refpdbgmx gmx pdbgmx build reftop file refresidu databasertp entri may miss simpli databas contain residu name differ new user error appear run refpdbgmx gmx pdbgmx refpdbpdb file without consider content file refforc fieldgmxforcefield magic deal molecul residu build block provid refresidu databasertp includ otherwis want use refpdbgmx gmx pdbgmx automat gener topolog ensur appropri refrtp entri present within desir refforc fieldgmxforcefield name build block tri use call molecul refpdbgmx gmx pdbgmx tri build histidin base entri refrtp file look exact atom entri histidin less want reftopologytop arbitrari molecul use refpdbgmx gmx pdbgmx unless build refrtp entri build entri hand use anoth program refxtopgmx xtop one script contribut user build reftop file entri residu databas option obtain forc field paramet see differ name use residu refresidu databasertp renam appropri parameter residu molecul lot work even expert find reftopolog filetop molecul convert refitp file includ reftop file use anoth refforc fieldgmxforcefield paramet avail search primari literatur public paramet residu consist forc field use determin paramet topolog residu see refad residu forc field gmx_add_residu instruct proceed long bond andor miss atom probabl atom miss earlier refpdb file make refpdbgmx gmx pdbgmx go crazi check screen output refpdbgmx gmx pdbgmx tell one miss add atom refpdb file energi minim put right place fix side chain eg httpsswiftcmbiumcnnlwhatif_ program chain identifi x use two nonsequenti block mean within refcoordin filegmxstructurefil fed refpdbgmxgmx pdbgmx x chain split possibl incorrect insert one molecul within anoth solut simpl move insert molecul locat within file split anoth molecul messag may also mean chain identifi use two separ chain case renam second chain uniqu identifi _gmxatommiss warn atom x miss residu xxx pdb file relat long bondsmiss atom error error usual quit obviou mean refpdbgmxgmx pdbgmx expect certain atom within given residu base entri forc field refrtp file sever case error appli miss hydrogen atom error messag may suggest entri refhdb file miss like nomenclatur hydrogen atom simpli match expect refrtp entri case use ignh allow refpdbgmxgmx pdbgmx add correct hydrogen renam problemat atom termin residu usual nterminu miss h atom usual suggest proper ter option suppli chosen properli case refamb forc fieldsgmxamberff nomenclatur typic problem ntermin ctermin residu must prefix n c respect exampl ntermin alanin list refpdb file ala rather nala specifi ffamber httpffambercnsmcsulbeduffamberphp_ instruct atom simpli miss structur file provid refpdbgmxgmx pdbgmx look remark remark entri refpdb file atom model use extern softwar gromac tool reconstruct incomplet model contrari error messag say use option miss almost alway inappropri miss option use gener special topolog amino acidlik molecul take advantag refrtp entri find use miss order gener topolog protein nucleic acid dont topolog produc like physic unrealist atom x residu yyy found rtp entri attempt assembl topolog use refpdbgmx gmx pdbgmx atom name expect match found refrtp file defin build block structur case problem aris name mismatch simpli renam atom refcoordin file gmxstructurefil appropri case may suppli structur residu conform expect refforc field gmxforcefield case investig differ occur make decis base find use differ refforc field gmxforcefield manual edit structur etc forc field found file name forcefielditp subdirectori end ff mean environ configur use gromac properli refpdbgmx gmx pdbgmx find databas forcefield inform could happen gromac instal move one locat anoth either follow instruct refget access gromac reinstal gromac error refgrompp gmx grompp found second default direct file caus default direct appear reftopolog top refforc field gmxforcefield file system appear typic caus second default set includ reftopolog top file refitp sourc somewher els specif topolog file work see refer manual_ section default nbfunc combrul genpair fudgelj fudgeqq one solut simpli comment delet line code file includ second time ie default nbfunc combrul genpair fudgelj fudgeqq better approach find solut rethink default direct appear top reftop file choos refforc field gmxforcefield tri mix two refforc field gmxforcefield ask troubl molecul refitp file tri choos forc field whoever produc ask troubl invalid order direct xxx direct top itp file rule order appear error seen order violat consid exampl discuss chapter refer manual_ andor tutori materi refinclud file mechan gmxtopoinclud use includ file old locat contain direct properli place particular invalid order direct default result default set reftopolog top refforc field gmxforcefield file inappropri locat default section appear must first direct reftopolog top default direct typic present refforc field gmxforcefield file forcefielditp ad reftopolog top includ file system topolog direct question atomtyp common sourc error bond nonbond type direct typic user ad nonstandard speci ligand solvent etc introduc new atom type paramet system indic new type paramet must appear moleculetyp direct refforc field gmxforcefield fulli construct molecul defin atom index n position_restraint bound common problem place posit restraint file multipl molecul order recal posit restraint refitp file contain position_restraint block belong moleculetyp block contain exampl wrong includ topol_aitp includ topol_bitp includ liganditp ifdef posr includ posre_aitp includ posre_bitp includ ligand_posreitp endif right includ topol_aitp ifdef posr includ posre_aitp endif includ topol_bitp ifdef posr includ posre_bitp endif includ liganditp ifdef posr includ ligand_posreitp endif atom index position_restraint must rel moleculetyp rel system pars reach molecul yet concept system use output tool like refgenrestr gmx genrestr blindli genrestr h warn system nonzero total charg notifi counterion may requir system neutral charg may problem topolog charg close integ indic problem reftopolog top refpdbgmx gmx pdbgmx use look righthand comment column atom list list cumul charg integ everi residu andor charg group applic assist find residu thing start depart integ valu also check termin cap group use charg alreadi close integ differ caus refround error gmxfloatingpoint major problem note pme user possibl use uniform neutral background charg pme compens system net background charg may howev especi nonhomogen system lead unwant artifact shown ref refgroenhofewaldartefact httppubsacsorgdoiabsctb nevertheless standard practic actual add counterion make system net neutral incorrect number paramet look reftopolog top file system youv given enough paramet one bond definit sometim also occur youv mangl refinclud file mechan gmxtopoinclud topolog file format see refer manual_ chapter edit file number coordin coordin file match topolog point base inform provid reftopolog top file reftop total number atom particl within system match exactli provid within refcoordin file gmxstructurefil often refgro refpdb common reason simpli user fail updat topolog file solvat ad addit molecul system made typograph error number one molecul within system ensur end topolog file use contain someth like follow match exactli within coordin file use term number order molecul molecul compound mol protein sol na fatal error moleculetyp xxx type molecul molecul section reftop file must correspond moleculetyp section defin previous either reftop file refinclud gmxtopoinclud refitp file see refer manual_ section syntax descript reftop file doesnt definit indic molecul check content relev file name molecul tri refer later pay attent statu ifdef includ statement tcoupl group xxx fewer atom possibl specifi separ refthermostat gmxthermostat temperatur coupl group everi molecul type within simul particularli bad practic employ mani new user molecular dynam simul bad idea introduc error artifact hard predict case best molecul within singl group use default system group separ coupl group requir avoid hotsolv coldsolut problem ensur suffici size combin molecul type appear togeth within simul exampl protein water counterion one would like want use protein nonprotein cutoff length longer half shortest box vector longer smallest box diagon element increas box size decreas rlist error gener case note within messag dimens box atom interact use period boundari condit thu violat minimum imag convent event total unrealist introduc seriou artefact solut note within messag either increas size simul box absolut minimum twice cutoff length three dimens take care use pressur coupl box dimens chang time decreas even slightli still violat minimum imag convent decreas cutoff length depend refforc field gmxforcefield utilis may option atom index bond bound kind error look like fatal error file spcitp line atom index bond bound probabl mean insert topolog section settl part belong differ molecul intend case move settl section right molecul error fairli selfexplanatori look reftop file check molecul section contain data pertain molecul data includ anoth molecul type refitp file previou moleculetyp end consult exampl chapter refer manual_ inform requir order differ section pay attent content file refinclud gmxtopoinclud includ direct error also aris use water model enabl use chosen refforc field gmxforcefield default exampl attempt use spc water model refamb forc field gmxamberff see error reason spcitp ifdef statement defin atom type refamb forc field gmxamberff either add section use differ water model xxx nonmatch atom name error usual indic order reftopolog top file match refcoordin file gmxstructurefil run refgrompp gmx grompp program read reftopolog top map suppli paramet atom refcoordin gmxstructurefil file mismatch error gener remedi problem make sure content molecul direct match exact order atom coordin file case error harmless perhap use refcoordin gmxstructurefil file old pre ion nomenclatur case allow refgrompp gmx grompp reassign name harmless situat error come ignor maxwarn option avail mean use blind hope simul work undoubtedli refblow blowingup sum two largest charg group radii x larger rlist rvdwrcoulomb error warn combin set result poor energi conserv longest cutoff occur charg group move pair list rang error two sourc charg group encompass mani atom charg group less atom less refmdp set incompat chosen algorithm switch shift function rlist must larger longest cutoff rvdw rcoulomb provid buffer space charg group move beyond neighbor search radiu set incorrectli may miss interact contribut poor energi conserv similar error sum two largest charg group radii x larger rlist aris two follow circumst charg group inappropri larg rlist set low molecul broken across period boundari problem period system case sum two largest charg group correspond valu twice box vector along molecul broken invalid line coordin file atom x error aris format refgro file broken way common explan second line refgro file specifi incorrect number atom caus refgrompp gmx grompp continu search atom find box vector error refmdrun gmx mdrun stepsiz small chang energi converg machin precis request f submax may error simpli inform energi minim process mdrun reach limit possibl minim structur current paramet mean system minim fulli situat may case system signific amount water present e subpot order sup sup conjunct f submax kj mol sup nm sup typic reason valu start md simul result structur import result like valu f submax describ slope potenti energi surfac ie far energi minimum structur lie special purpos normal mode analysi type calcul may necessari minim minim may achiev use differ energi minim method make use doubl precisionen gromac energi minim stop forc least one atom finit like indic least two atom close input coordin forc exert greater magnitud express extent precis gromac therefor minim proceed sometim possibl minim system infinit forc use softcor potenti scale magnitud lennardjon interact use gromac free energi code approach accept workflow equilibr coarsegrain system martini lincssettleshak warn sometim run dynam refmdrun gmx mdrun may suddenli stop perhap write sever refpdb file seri warn constraint algorithm eg linc settl shake written reflog file algorithm often use constrain bond length andor angl system refblow blowingup ie explod due diverg forc constraint usual first thing fail doesnt necessarili mean need troubleshoot constraint algorithm usual sign someth fundament wrong physic unrealist system see also advic refdiagnos unstabl system systemdiagnosi interact within cutoff atom move two atom separ three bond separ cutoff distanc bad importantli increas cutoff error actual indic atom larg veloc usual mean part molecul refblow blowingup use linc constraint probabl also alreadi got number linc warn use shake give rise shake error halt simul within cutoff error appear number reason larg veloc system happen begin simul system might equilibr well enough eg contain bad contact tri anoth round energi minim fix otherwis might high temperatur andor timestep larg experi paramet error stop occur doesnt help check valid paramet reftopolog top simul run output error mdrun appear chew cpu time noth written output file number reason may occur simul might simpli refslow gmxperform sinc output buffer take quit time output appear respect file tri fix problem want get output fast possibl set environ variabl gmx_log_buff someth might go wrong simul caus eg notanumb nan gener result eg divis zero subsequ calcul nan gener float point except slow everyth order magnitud might nst paramet see refmdp file set suppress output disk might full eventu lead refmdrun gmx mdrun crash sinc output buffer might take mdrun realiz cant write conjug gradient constraint mean cant energi minim conjug gradient algorithm topolog constraint defin pleas check refer manual_ pressur scale error tend gener simul box begin oscil due larg pressur small coupl constant system start reson refthen crash blowingup mean system isnt equilibr suffici use pressur coupl therefor better equilibr may fix issu recommend observ system trajectori prior crash may indic particular part system structur problem case system equilibr suffici error mean pressur coupl constant mdptaup small particularli use berendsen weak coupl method increas valu slow respons pressur chang may stop reson occur also like see error use parrinellorahman pressur coupl system yet equilibr start much forgiv berendsen method first switch algorithm error also appear use timestep larg eg fs absenc constraint virtual site rang check error usual mean simul refblow blowingup probabl need better energi minim andor equilibr andor topolog design x particl commun pme node cell length domain decomposit cell charg group anoth way refmdrun gmx mdrun tell system refblow blowingup particl fli across system get fatal error messag indic piec system tear apart henc cell charg group refer refblow blowingup page advic fix issu charg group move far two domain decomposit step see inform softwar inconsist error interact seem assign multipl time see inform domain decomposit n rank compat given box minimum cell size x nm mean tri run parallel calcul refmdrun gmx mdrun tri partit simul cell chunk couldnt minimum cell size control size largest charg group bond interact largest rvdw rlist rcoulomb effect bond constraint safeti margin thu possibl run small simul larg number processor refgrompp gmx grompp warn larg charg group pay attent reconsid size refmdrun gmx mdrun print breakdown comput minimum size reflog file perhap find caus didnt think run parallel calcul awar gromac use threadbas parallel default prevent give refmdrun gmx mdrun ntmpi command line option otherwis might use mpienabl gromac awar fact _gmxsysprep system prepar toctre hidden mani way prepar simul system run gromac often vari kind scientif question consid model physic involv proteinligand atomist freeenergi simul might need multist topolog coarsegrain simul might need manag default suit system higher densiti step consid follow gener guidanc help plan success simul stage option kind simul clearli identifi properti phenomena interest studi perform simul continu clear run simul seek work use test hypothesi may unsuit requir inform save select appropri tool abl perform simul observ properti phenomena interest import read familiar public research similar system choic tool includ softwar perform simul consider forc field may influenc decis forc field describ particl within system interact select one appropri system studi properti phenomena interest import nontrivi step consid analyz simul data make observ obtain gener initi coordin file molecul place within system mani differ softwar packag abl build molecular structur assembl suitabl configur gener raw start structur system place molecul within coordin file appropri molecul may specif place arrang randomli sever nongromac tool use within gromac refgmx solvat refgmx insertmolecul refgmx genconf solv frequent problem obtain gener topolog file system use exampl refgmx pdbgmx refgmx xtop swissparam httpswissparamch_ charmm forcefield prodrg httpdavapcbiochdundeeacukcgibinprodrg_ gromo autom topolog builder httpsatbuqeduau_ gromo mktop httpwwwaribeironetbrmktop_ oplsaa favourit text editor concert chapter gromac refer manual_ amber forc field antechamb httpsambermdorgantechamberantechamberhtml__ acpyp httpsgithubcomalanwilteracpype__ might appropri describ simul box eg use refgmx editconf whose size appropri eventu densiti would like fill solvent eg use refgmx solvat add counterion need neutral system eg use refgmx grompp refgmx insertmolecul step may need edit topolog file stay current coordin file run energi minim system use refgmx grompp refgmx mdrun requir sort bad start structur caus gener system may caus product simul crash may necessari also minim solut structur vacuo introduc solvent molecul lipid bilay whatev els consid use flexibl water model use bond constraint frozen group use posit restraint andor distanc restraint evalu care select appropri simul paramet equilibr simul defin refmdp file need choos simul paramet consist forc field deriv may need simul nvt posit restraint solvent andor solut get temperatur almost right relax npt fix densiti done berendsen densiti stabil switch barostat produc correct ensembl move need reach product simul ensembl eg nvt nve problem system refblow blowingup consid use suggest page eg posit restraint solut use bond constraint use smaller integr timestep sever gentler heat stage run equilibr simul suffici time system relax suffici target ensembl allow product run commenc use refgmx grompp refgmx mdrun refgmx energi trajectori visual tool httpwwwgromacsorgdocumentationhowtostrajectory_visualization_ select appropri simul paramet product simul defin refmdp file particular care regener veloc still need consist forc field deriv measur properti phenomena interest _refer manual gmxmanualparentdir_ tip trick databas file sharetop directori gromac instal contain numer plaintext helper file dat file extens commandlin tool see doccmdlin refer tool document file use use need modifi file eg introduc new atom type vdw radii vdwradiidat copi file instal directori work directori gromac tool automat load copi work directori rather standard one suppress standard definit use empti file work directori note use bash onelin verifi whether variabl file longer present code export input_filedocsuserguideenvironmentvariablesrst git_pagercat grep input_fil sed sg sed g countgit grep grep v input_fil wc l count eq printf ssn count done anoth use onelin find undocumentedvari export input_filedocsuserguideenvironmentvariablesrst git_pagercat ss git grep getenv sed sgetenv sort u grep az grep input_fil c eq echo done git grep ss done environ variabl gromac program may influenc use environ variabl first variabl set gmxrc file essenti run compil gromac use environ variabl list follow section environ variabl function set shell nonnul valu specif requir describ valu need set consult document shell instruct set environ variabl current shell configur file futur shell note requir export environ variabl job run batch control system vari consult local document detail output control gmx_maxbackup gromac automat back old copi file tri write new file name variabl control maximum number backup made default set fail run output file alreadi exist set overwrit output file without make backup gmx_no_quot explicitli set cool quot print end program gmx_suppress_dump prevent dump step file exampl blow failur constraint algorithm gmx_tpi_dump dump configur refpdb file interact energi less valu set environ variabl gmx_view_xvg gmx_view_ep gmx_view_pdb command use automat view refxvg refep refpdb file type respect default xmgrace ghostview rasmol set empti disabl automat view particular file type command fork run background prioriti gromac tool might want care use command block termin eg vi sinc multipl instanc might run gmx_log_buff size buffer file io set file io unbuff therefor slow handi debug purpos ensur file alway total uptod gmx_logo_color set display color logo refgmx view gmx_print_longformat use long float format print decim valu gmx_compeldump appli comput electrophysiolog setup see refer manual initi structur get dump refpdb file allow check whether multimer channel correct pbc represent gmx_trajectory_io_verbos default print frame count eg read trajectori file set quiet oper gmx_enable_gpu_tim enabl gpu time log file cuda sycl note cuda time incorrect multipl stream happen domain decomposit nonbond pme gpu also main reason turn default gmx_disable_gpu_tim disabl gpu time log file opencl debug gmx_dd_nst_dump number step elaps dump current dd pdb file default take effect domain decomposit typic never everi dd phase multipl mdpnstlist gmx_dd_nst_dump_grid number step elaps dump current dd grid pdb file default take effect domain decomposit typic never everi dd phase multipl mdpnstlist gmx_dd_debug gener debug trigger everi domain decomposit default mean current check globalloc atom index map consist gmx_dd_npuls overrid number dd puls use default mean overrid normal gmx_disable_alternating_gpu_wait disabl special poll wait path use wait pme nonbond gpu task complet overlap reduct result forc arriv first set variabl switch gener path fix wait order gmx_test_required_number_of_devic set number gpu requir test suit default test suit would fallback use cpu gpu could detect set posit integ valu ensur least least number usabl gpu detect default test gpu avail number extra environ variabl like use debug check code perform run control gmx_do_galactic_dynam planetari simul made possibl fun set environ variabl allow set mdpepsilonr refmdp file normal mdpepsilonr must greater zero prevent fatal error see webpage_ exampl input file planetari simul gmx_bonded_nthread_uniform valu number thread per rank switch uniform local bond interact distribut optim valu depend system hardwar default valu gmx_dd_single_rank control use domain decomposit machineri use singl mpi rank valu turn dd turn dd default autom choic base heurist gmx_gpu_nb_ewald_twincut forc use twinrang cutoff kernel even mdprvdw equal mdprcoulomb pppme load balanc switch twinrang kernel autom variabl use benchmark gmx_gpu_nb_ana_ewald forc use analyt ewald kernel use benchmark gmx_gpu_nb_tab_ewald forc use tabul ewald kernel use benchmark gmx_disable_cuda_tim deprec use gmx_disable_gpu_tim instead gmx_gpu_dd_comm remov use gmx_enable_direct_gpu_comm instead gmx_gpu_pme_pp_comm remov use gmx_enable_direct_gpu_comm instead gmx_enable_direct_gpu_comm enabl direct gpu commun multirank parallel run note domain decomposit cudaawar mpi support multipl puls along second third decomposit dimens small system featur disabl intern gmx_enable_staged_gpu_to_cpu_pmepp_comm use stage implement gpu commun pme forc transfer pme gpu cpu memori pp rank threadmpi stage done via gpu buffer pp gpu expect benefici server direct commun link gpu gmx_disable_staged_gpu_to_cpu_pmepp_comm use direct rather stage gpu commun pme forc transfer pme gpu cpu memori pp rank may advantag pcieonli server run low atom count sensit latenc bandwidth gmx_gpu_sycl_no_synchron disabl synchron differ gpu stream sycl build instead reli sycl runtim schedul base data depend experiment gmx_gpu_sycl_use_subdevic partit gpu support subdevic treat one independ devic gpu split ignor intend use multitil gpu gmx_gpu_sycl_use_gpu_fft enabl use gpu fft dpc intel gpu unless variabl set mix mode pme avail intel gpu test oneapi opencl backend older oneapi version work produc wrong result hipsycl build gpu fft alway enabl amd gpu affect variabl gmx_cycle_al time code run incompat thread gmx_cycle_barri call mpi_barri cycl startstop call gmx_dd_order_zyx build domain decomposit cell order z x rather default x z gmx_dd_use_sendrecv constraint vsite commun use pair mpi_sendrecv call instead two simultan nonblock call default mean might faster mpi implement gmx_dlb_based_on_flop domaindecomposit dynam load balanc base flop count rather measur time elaps default mean make load balanc reproduc use debug purpos valu use flop valu add valu nois flop increas imbal scale gmx_dlb_max_box_sc maximum percentag box scale permit per domaindecomposit loadbalanc step default gmx_dd_record_load record dd load statist report end run default mean gmx_detailed_perf_stat set print slightli detail perform inform reflog file result output way perform summari report version x thu may use anyon use script pars reflog file standard output gmx_disable_simd_kernel disabl architecturespecif simdoptim sse sse avx etc nonbond kernel thu forc use plain c kernel gmx_disable_gpu_tim time asynchron execut gpu oper nonneglig overhead short step time disabl time improv perform case time disabl default cuda sycl gmx_disable_gpu_detect set disabl gpu detect even refgmx mdrun compil gpu support gmx_disre_ensemble_s number system distanc restraint ensembl averag take integ valu gmx_emulate_gpu emul gpu run use algorithm equival cpu refer code instead gpuacceler function cpu code slow intend use debug purpos gmx_enx_no_fat disabl exit upon encount corrupt frame refedr file allow use frame corrupt gmx_force_upd updat forc invok mdrun rerun gmx_force_gpu_aware_mpi overrid result build runtim gpuawar mpi detect forc use direct gpu mpi commun aim case user know mpi librari gpuawar gromac abl detect note cuda build support function gmx_force_update_default_gpu forc updat run gpu default overrid mdrun updat auto option work similar set mdrun updat gpu fall back cpu codepath set input support use run updat gpu multirank case latter case consid experiment sinc lack substanti test also gpu updat support gpu direct commun gmx_force_update_default_gpu variabl set simultan gmx_enable_direct_gpu_comm environ variabl multirank case use librarympi overrid mdrun updat cpu gmx_gpu_id set way mdrun gpu_id gmx_gpu_id allow user specifi differ gpu id differ rank use select differ devic differ comput node cluster use conjunct mdrun gpu_id gmx_gputask set way mdrun gputask gmx_gputask allow map gpu task gpu devic id differ differ rank eg mpi runtim permit variabl differ differ rank use conjunct mdrun gputask requir mdrun gputask gmx_gpu_disable_compatibility_check disabl hardwar compat check opencl sycl use develop allow test openclsycl kernel nonsupport platform without sourc code modif gmx_ignore_fsync_failure_env allow refgmx mdrun continu even file miss gmx_ljcomb_tol set floatingpoint valu overrid default toler e forcefield floatingpoint paramet gmx_maxconstrwarn set refgmx mdrun exit produc mani linc warn gmx_nb_min_ci neighbor list balanc paramet use run gpu set target minimum number pairlist order improv multiprocessor loadbal better perform small simul system must set nonneg integ valu disabl list split default valu optim support gpu therefor chang necessari normal usag use futur architectur gmx_nbnxn_cycl set print detail neighbor search cycl count gmx_nbnxn_ewald_analyt forc use analyt ewald nonbond kernel mutual exclus gmx_nbnxn_ewald_t gmx_nbnxn_ewald_t forc use tabul ewald nonbond kernel mutual exclus gmx_nbnxn_ewald_analyt gmx_nbnxn_simd_xnn forc use xnn simd cpu nonbond kernel mutual exclus gmx_nbnxn_simd_xn gmx_nbnxn_simd_xn forc use xn simd cpu nonbond kernel mutual exclus gmx_nbnxn_simd_xnn gmx_nooptimizedkernel deprec use gmx_disable_simd_kernel instead gmx_no_cart_reord use initi domain decomposit commun rank reorder default switch environ variabl gmx_no_lj_comb_rul forc use lj paremet lookup instead use combin rule nonbond kernel gmx_no_int gmx_no_term gmx_no_usr disabl signal handler sigint sigterm sigusr respect gmx_no_nodecomm use separ inter intranod commun gmx_no_nonbond skip nonbond calcul use estim possibl perform gain ad gpu acceler current hardwar setup assum fast enough complet nonbond calcul cpu bond forc pme comput freez particl requir stop system blow gmx_pull_participate_al disabl default heurist use separ pull mpi commun rank gmx_nopredict shell posit predict gmx_no_updategroup turn updat group may allow decomposit domain small system cost commun updat gmx_pme_num_thread set number openmp pme thread overrid default set refgmx mdrun use instead npme command line option also use set heterogen perprocessnod thread count gmx_pme_pm use pmoptim influenc function instead smooth pme bspline interpol gmx_pme_thread_divis pme thread divis format x z three dimens sum thread dimens must equal total number pme thread set envvargmx_pme_nthread gmx_pmeonedd number domain decomposit cell set x decompos pme one dimens gmx_require_shell_init requir shell posit initi gmx_tpic_mass contain multipl mass use test particl insert caviti center mass last atom use insert caviti gmx_verlet_buffer_r resolut buffer size verlet cutoff scheme default valu overridden environ variabl hwloc_xmlfil strictli gromac environ variabl larg machin hwloc detect take second lot mpi process run hwloc command commandlstopo outxml set environ variabl point locat file hwloc librari use cach inform instead faster mpirun mpirun command use refgmx tune_pm mdrun refgmx mdrun command use refgmx tune_pm gmx_disable_dynamicprun disabl dynam pairlist prune note refgmx mdrun still tune nstlist optim valu pick assum dynam prune thu good perform nstlist option use gmx_nstlist_dynamicprun overrid dynam pairlist prune interv chosen heurist mdrun valu prune frequenc valu cpu gpu mdpnstlist _openclmanag opencl manag current sever environ variabl exist help custom aspect opencl_ version gromac mostli relat runtim compil opencl kernel also use devic select gmx_ocl_gencach enabl opencl binari cach intend use develop expert test neither concurr cach invalid implement safe gmx_ocl_nofastgen set gener compil algorithm flavor otherwis flavor requir simul gener compil gmx_ocl_disable_fastmath prevent use clfastrelaxedmath compil option note fast math alway disabl intel devic due instabl gmx_ocl_dump_log defin opencl build log alway written mdrun log file otherwis build log written log file error occur gmx_ocl_verbos defin enabl verbos mode opencl kernel build current avail nvidia gpu see gmx_ocl_dump_log detail obtain opencl build log gmx_ocl_dump_interm_fil defin intermedi languag code correspond opencl build process save file cach turn order option take effect nvidia gpu ptx code save current directori name device_nameptx amd gpu ilisa file creat opencl kernel built detail file creat check amd document savetemp compil option gmx_ocl_debug use conjunct ocl_force_cpu amd devic add debug flag compil option g gmx_ocl_noopt disabl optimis add option cloptdis compil option gmx_ocl_force_cpu forc select cpu devic instead gpu exist debug purpos expect gromac function properli option sole simplic step kernel see happen gmx_ocl_disable_i_prefetch disabl iatom data type lj paramet prefetch allow test gmx_ocl_enable_i_prefetch enabl iatom data type lj paramet prefetch allow test platform behavior default gmx_ocl_file_path use paramet forc gromac load opencl kernel custom locat use want overrid gromac default behavior want test kernel gmx_ocl_show_diagnost use intel opencl extens show addit runtim perform diagnost analysi core function dssp use refgmx do_dssp point dssp execut path gmx_dipole_spac space use refgmx dipol gmx_maxresrenum set maximum number residu renumb refgmx grompp valu indic residu renumb gmx_no_ffrtp_ter_renam forc field like amber use specif name n c termin residu nxxx cxxx refrtp entri normal renam set environ variabl disabl renam gmx_font name x font use refgmx view gmxtimeunit time unit use output file anyth fs ps ns us ms h gmx_ener_verbos make refgmx energi refgmx eneconv loud noisi vmd_plugin_path find vmd plugin need abl read file format recogn vmd plugin vmddir base path vmd instal gmx_use_xmgr set viewer xmgr deprec instead xmgrace flow chart flow chart typic gromac md run protein box water detail exampl avail docgettingstart sever step energi minim may necessari consist cycl refgmx grompp refgmx mdrun digraph flowchart node shapebox width input_pdb labeleiwitpdb tooltipprotein databank file urlreferencemanualfileformatshtmlpdb shapenon width height margin groupinput pdbgmx labelgener gromac topologyngmx pdbgmx tooltipconvert pdb file gromac coordin file topolog urlonlinehelpgmxpdbgmxhtml width groupmain input_pdb pdbgmx headport editconf labelenlarg boxngmx editconf tooltipadjust box size placement molecul urlonlinehelpgmxeditconfhtml pdbgmx editconf labelconfgro labeltooltipgromac coordin file contain molecul pdb file urlreferencemanualfileformatshtmlgro solvat labelsolv proteinngmx solvat tooltipfil box water solvat molecul urlonlinehelpgmxsolvatehtml width groupmain pdbgmx solvat labeltopoltop labeltooltipgromac ascii topolog file urlreferencemanualfileformatshtmltop editconf solvat labelconfgro labeltooltipgromac coordin file adjust box etc urlreferencemanualfileformatshtmlgro input_mdp labelgromppmdp tooltipparamet file grompp control md paramet urlreferencemanualfileformatshtmlmdp shapenon width height margin groupinput grompp labelgener mdrun input filengmx grompp tooltipprocess paramet coordin topolog write binari topolog urlonlinehelpgmxgrompphtml width groupmain input_pdb input_mdp styleinvi minlen input_mdp grompp headport weight solvat grompp labelconfgro labeltooltipgromac coordin file water molecul ad urlreferencemanualfileformatshtmlgro solvat grompp labeltopoltop labeltooltipgromac ascii topolog file water molecul ad urlreferencemanualfileformatshtmltop mdrun labelrun simul em mdngmx mdrun tooltipth moment wait start md run urlonlinehelpgmxmdrunhtml width groupmain grompp mdrun labeltopoltpr labeltooltipport gromac binari run input file contain inform start md run urlreferencemanualfileformatshtmltpr mdrun mdrun labelcontinuationnstatecpt labeltooltipcheckpoint file urlreferencemanualfileformatshtmlcpt analysi labelanalysisngmx ngmx view tooltipyour favourit gromac analysi tool urlcmdlinehtmlcommandsbytop mdrun analysi labeltrajxtc trajtrr labeltooltipport compress trajectori full precis portabl trajectori urlreferencemanualfileformatshtmlxtc energi labelanalysisngmx energi tooltipenergi plot averag fluctuat urlonlinehelpgmxenergyhtml mdrun energi labeleneredr labeltooltipport energi file urlreferencemanualfileformatshtmledr _user guid user guid highlight bash guid provid materi introduc gromac practic advic make effect use gromac get build instal gromac see docinstallguideindex background algorithm implement see refrefer manual part gmxreferencemanualrst document question answer resourc pleas visit gromac user forum httpsgromacsbioexceleu_ search potenti answer ask question commun gmx_manual_doi_str gmx_source_doi_str todo go requir organ get content avail toctre maxdepth knownissu gettingstart systemprepar managingsimul faq forcefield mdpoption mdrunfeatur mdrunperform runtimeerror cmdline terminolog environmentvari floatingpoint secur deprecationpolici _deprecationpolici polici deprec gromac function occasion function ceas use unabl fix maintain user interfac need improv develop team sparingli broken function might remov without notic nobodi will fix found work function chang announc previou major releas intent remov andor chang form function thu typic year user extern tool provid prepar chang contact gromac develop see might affect best adapt refcurr list deprecatedfunction deprec function environ variabl deprec user make sure script updat accordingli new releas case sensibl develop team effort keep old environ variabl work one extra releas cycl fulli remov user inform futur deprec warn keep old environ variabl possibl highli problemat set remov environ variabl trigger warn one releas cycl _gmxfloatingpoint float point arithmet gromac spend life arithmet real number often sum mani million real number encod comput socal binari floatingpoint represent represent somewhat like scientif exponenti notat use binari rather decim necessari fastest possibl speed calcul unfortun law algebra approxim appli binari floatingpoint part real number repres simpli exactli decim like exact represent binari floatingpoint repres decim mani sourc find search engin discuss issu exhaust wikipedia httpsenwikipediaorgwikifloatingpoint_arithmetic__ david goldberg paper everi comput scientist know floatingpoint arithmet articl httpsdocsoraclecomcdencg_goldberghtml__ addendum httpsdocsoraclecomcde_htmlezhtml__ bruce dawson also written number valuabl blog post modern floatingpoint program random ascii site httpsrandomasciiwordpresscomcategoryfloatingpoint__ worth read sum larg number binari represent exact decim number need equal expect algebra decim result user observ phenomenon sum partial charg express two decim place sometim approxim integ total charg contribut howev deviat first decim place would alway indic badlyform topolog gromac repres floatingpoint number output sometim use comput form scientif notat known e notat notat number like e actual close enough purpos assess total charg system also appropri gromac guess round thing round reli assumpt input need true instead user need understand tool work use mdrun featur section discuss featur refgmx mdrun dont fit well elsewher _singlepoint energi rerun simul rerun featur allow take trajectori file trajtrr comput quantiti base upon coordin file use model physic suppli topoltpr file use command line like mdrun topol rerun trajtrr reftpr could differ one gener trajectori use comput energi forc exactli coordin suppli input extract quantiti base subset molecular system see refgmx converttpr refgmx trjconv easier correct singlepoint energi evalu featur step simul neighbor search perform everi frame trajectori independ valu mdpnstlist sinc refgmx mdrun longer assum anyth structur gener natur updat constraint algorithm ever use rerun featur gener comput mani quantiti report full simul take posit input ignor potenti present veloc report potenti energi volum densiti dhdl term restraint inform notabl report kinet total conserv energi temperatur virial pressur run simul reproduc mode gener difficult run effici parallel md simul base primarili floatingpoint arithmet fulli reproduc default refgmx mdrun observ thing go vari simul conduct order optim throughput howev reproduc mode avail mdrun reprod systemat elimin sourc variat within run repeat invoc input hardwar binari ident howev run mode differ hardwar differ compil etc reproduc normal use investig possibl problem halt run simul refgmx mdrun receiv term int signal eg ctrlc press stop next neighbor search step second global commun step whichev happen later refgmx mdrun receiv second term int signal reproduc request stop first global commun step case usual output written file checkpoint file written last step refgmx mdrun receiv abrt signal third term int signal abort directli without write new checkpoint file run mpi signal one refgmx mdrun rank suffici signal sent mpirun refgmx mdrun process parent other run multisimul numer situat run relat set simul within invoc mdrun necessari use run replicaexchang simul requir simul use ensemblebas distanc orient restraint run relat seri lambda point freeenergi comput also conveni way featur requir refconfigur gromac extern mpi librari mpisupport set simul commun n simul within set use intern mpi parallel also mpirun np x gmx_mpi mdrun x multipl n use xn rank per simul two way organ file run simul normal mechan work either case includ deffnm multidir must creat set n directori n simul place relev input file directori eg name topoltpr run mpirun np x gmx_mpi mdrun topol multidir namesofdirectori order simul within multisimul signific respons order name provid multidir care shell filenam glob dictionarystyl eg dir dir dir dir option gener conveni use gmx mdrun tabl group cutoffschem work mode exampl run multisimul mpirun np gmx_mpi mdrun multidir b c start multisimul rank simul input output file found directori b c mpirun np gmx_mpi mdrun multidir b c gputask start multisimul machin two physic node two gpu per node mpi rank per node mpi rank per simul mpi rank pp work node map gpu id even though come one simul map order indic pp rank simul use singl gpu howev order could run faster run replicaexchang simul run multisimul use gmx mdrun replex n mean replica exchang attempt everi given number step number replica set multidir option describ run input file use differ valu coupl paramet eg temperatur ascend set input file random seed replica exchang set rese everi exchang veloc scale neighbor search perform see refer manual detail replica exchang function gromac control length simul normal length md simul best manag refmdp option mdpnstep howev situat control use sampgmx mdrun nstep overrid refmdp file execut step sampgmx mdrun maxh termin simul shortli hour elaps use run cluster queue long queu system ever suspend simul secur use gromac _gmxsecur advis user gromac care use gromac file obtain unknown sourc eg internet guarante program wont crash seriou error could caus execut code privileg gromac eg delet content home directori file user creat dont carri risk may still misbehav crash consum larg amount resourc upon malform input run input file obtain outsid sourc treat caution execut file sourc _manag long simul manag long simul molecular simul often extend beyond lifetim singl unix commandlin process use abl stop restart simul way equival singl run refgmx mdrun halt write checkpoint file restart simul exactli interrupt checkpoint retain fullprecis version posit veloc along state inform necessari restart algorithm eg implement coupl extern thermal reservoir restart attempt use eg refgro file veloc sinc refgro file significantli less precis none coupl algorithm state carri restart less continu normal md step checkpoint file also written period refgmx mdrun run interv given cpt flag refgmx mdrun refgmx mdrun attemp write success checkpoint file first renam old file suffix _prev even someth goe wrong write new checkpoint file recent progress lost refgmx mdrun halt sever way number simul mdpnstep expir user issu termin signal eg ctrlc termin job schedul issu termin signal time expir refgmx mdrun detect length specifi maxh elaps option use help cooper job schedul problemat job suspend kind catastroph failur loss power disk fill network fail use checkpoint file restart use command line gmx mdrun cpi state direct mdrun use checkpoint file name statecpt default choos give output checkpoint file differ name cpo flag must provid name input cpi later use file queri content checkpoint file refgmx check refgmx dump append output file default refgmx mdrun append old output file previou part end regular way perform data end log file remov new inform run context written simul proceed otherwis mdrun truncat output file back time last written checkpoint file continu simul stop checkpoint regular way choos append output file use noappend flag forc mdrun write output separ file whose name includ partxxxx string describ simul part contain file number start zero increas monoton simul restart reflect number simul step part mdpsimulationpart option use set number manual refgmx grompp use data lost eg filesystem failur user error append work output file modifi remov mdrun wrote checkpoint file maintain checksum file verifi write case must either restor file name checkpoint file expect continu noappend origin run use deffnm want append continu must also use deffnm back file arrang back simul file frequent network file system cluster configur less conserv way lead refgmx mdrun told checkpoint file written disk actual still memori somewher vulner power failur disk fill fail meantim unix tool rsync use way period copi simul output remot storag locat work safe even simul underway keep copi final checkpoint file part job submit cluster use file system unreli extend tpr file simul describ reftpr file complet extend use refgmx converttpr tool extend run eg gmx converttpr previoustpr extend timetoextendbi nexttpr gmx mdrun nexttpr cpi statecpt time also extend use nstep option note origin refmdp file may gener veloc onetim oper within refgmx grompp never perform tool chang mdp option restart wish make chang simul set length refmdp file topolog call gmx grompp f possiblychangedmdp p possiblychangedtop c statecpt newtpr gmx mdrun newtpr cpi statecpt instruct refgmx grompp copi fullprecis coordin checkpoint file new reftpr file consid choic mdptinit mdpinitstep mdpnstep mdpsimulationpart gener regener veloc mdpgenvel gener select mdpcontinu constraint reappli first integr step restart without checkpoint file use possibl continu simul without checkpoint file approach could unreli lead unphys result restart checkpoint permit continu exact comput unlimit precis integr timediscret equat motion hand exact continu would lead ident result sinc practic comput limit precis md chaotic trajectori diverg rapidli even one bit differ trajectori equal valid eventu differ continu use checkpoint file use code compil compil run comput architectur use number processor without gpu see next section would lead binari ident result howev default actual work load balanc across hardwar accord observ execut time trajectori principl reproduc particular run took place one part ident equival run one part neither better sens reproduc follow factor affect reproduc simul thu output precis mix doubl doubl give better reproduc number core due differ order forc accumul instanc abc necessarili binari ident abc floatingpoint arithmet type processor even within processor famili slight differ optim level compil optim run time eg fftw librari typic use fast fourier transform determin startup version algorithm fastest use remaind calcul sinc speed estim determinist result may vari run run random number use instanc seed gener veloc gromac preprocess stage uniniti variabl code shouldnt dynam link differ version share librari eg fft dynam load balanc sinc particl redistribut processor base elaps wallclock time lead abc abc issu number pmeonli rank parallel pme simul mpi reduct typic guarante order oper absenc associ floatingpoint arithmet mean result reduct depend order actual chosen gpu reduct eg nonbond forc nondeterminist summat order fast implement nonreprodud design import question whether problem simul complet reproduc answer ye reproduc cornerston scienc gener henc import central limit theorem httpsenwikipediaorgwikicentral_limit_theorem_ tell us case infinit long simul observ converg equilibrium valu molecular simul gromac adher theorem henc instanc energi system converg finit valu diffus constant water molecul converg finit valu mean import observ valu would like get simul reproduc individu trajectori reproduc howev howev case would use trajectori reproduc includ develop debug search rare event trajectori occur want manual save checkpoint file restart simul differ condit eg write output much frequent order obtain reproduc trajectori import look list elimin factor could affect use gmx mdrun reprod elimin sourc nonreproduc ie execut hardwar share librari run input file command line paramet lead reproduc result terminolog _gmxpressur pressur pressur molecular dynam comput kinet energi virial fluctuat whether pressur coupl use within simul pressur valu simul box oscil significantli instantan pressur meaningless welldefin picosecond time scale usual good indic true pressur variat entir normal due fact pressur macroscop properti measur properli time averag measur andor adjust pressur coupl microscop scale much vari speed depend number atom system type pressur coupl use valu coupl constant fluctuat order hundr bar typic box water fluctuat bar standard sinc fluctuat go squar root number particl system water molecul time larger still pressur fluctuat bar _gmxpbc period boundari condit period boundari condit pbc use molecular dynam simul avoid problem boundari effect caus finit size make system like infinit one cost possibl period effect beginn visual trajectori sometim think observ problem molecul stay centr box appear part molecul diffus box hole creat broken molecul appear unit cell rhombic dodecahedron cubic octahedron look like slant cube simul crazi bond across simul cell appear problem error occur expect exist pbc mean atom leav simul box say righthand face enter simul box lefthand face exampl larg protein look face simul box opposit one protein protrud hole solvent visibl reason molecul move initi locat within box vast major simul free diffus around held magic locat box box center around anyth perform simul molecul made whole matter cours moreov period cell shape express parallelepip aka triclin cell gromac intern regardless initi shape box visual issu fix conclus simul judici use option input refgmx trjconv process trajectori file similarli analys rmsd atom posit flaw refer structur compar structur need adjust period effect solut refgmx trjconv follow line complex case need one oper requir one invoc refgmx trjconv order work inform see correspond section refrefer manual pbc suggest workflow fix period effect refgmx trjconv suit visual analysi tricki multipl invoc necessari may need creat custom index group eg keep ligand protein follow step order omit requir help get pleasant result need consult gmx trjconv h find detail step that deliber magic want recip decid want first first make molecul whole want whole cluster moleculesparticl want cluster want jump remov extract first frame trajectori use refer use pbc nojump first frame refer center system use criterion shift system dont use pbc nojump step perhap put everyth box pbc ur option fit result trajectori refer structur desir dont use pbc relat option afterward point three issu refgmx trjconv remov jump first frame use refer structur provid refer structur run input file clusteredwhol use pbc nojump undo step _gmxthermostat thermostat thermostat design help simul sampl correct ensembl ie nvt npt modul temperatur system fashion first need establish mean temperatur simul instantan kinet temperatur usual comput kinet energi system use equipartit theorem word temperatur comput system total kinet energi what goal thermostat actual turn goal keep temperatur constant would mean fix total kinet energi would silli aim nvt npt rather ensur averag temperatur system correct see case imagin glass water sit room suppos look close molecul small region glass measur kinet energi would expect kinet energi small number particl remain precis constant rather youd expect fluctuat kinet energi due small number particl averag larger larger number particl fluctuat averag get smaller smaller final time look whole glass say constant temperatur molecular dynam simul often fairli small compar glass water bigger fluctuat realli appropri think role thermostat ensur correct averag temperatur b fluctuat correct size see relev section refrefer manual tempcoupl detail temperatur coupl appli type current avail _gmxthermostatsdo hint practic gener good idea prefer use thermostat sampl correct distribut temperatur exampl see correspond manual section addit give correct averag temperatur least use thermostat give correct averag temperatur appli compon system justifi see first bullet do_ case use tcgrp system may lead hot solventcold solut problem describ rd refer reading_ _gmxthermostatsdont hint practic gener good idea use use separ thermostat everi compon system molecular dynam thermostat work well thermodynam limit group must suffici size justifi thermostat use one thermostat say small molecul anoth protein anoth water like introduc error artifact hard predict particular coupl ion aqueou solvent separ group solvent protein simul use tcgrp protein nonprotein usual best use thermostat work well limit larg number degre freedom system degre freedom exampl use noshoov berendsen thermostat type free energi calcul compon system degre freedom end state ie noninteract small molecul read cheng merz k applic noshoov chain algorithm studi protein dynam j phi chem httppubsacsorgdoiabsjpy_ mor ziv g levi simul protein inhomogen degre freedom effect thermostat j comput chem httpdxdoiorgjcc_ lingenheil denschlag r reichold r tavan p hotsolventcoldsolut problem revisit j chem theori comput httppubsacsorgdoiabsct__ energi conserv principl molecular dynam simul conserv total energi total momentum nonperiod system total angular momentum number algorithm numer issu make alway case cutoff treatment andor longrang electrostat treatment see van der spoel van maaren p j origin layer structur artifact simul liquid water j chem theor comp httpsdoiorgct_ treatment pair list constraint algorithm see eg hess b plinc parallel linear constraint solver molecular simul j chem theor comp httpsdoiorgctb__ integr timestep reftemperatur coupl gmxthermostat refpressur coupl gmxpressur roundoff error particular singl precis exampl subtract larg number lippert r et al common avoid sourc error molecular dynam integr j chem phi httpdxdoiorg_ choic integr algorithm gromac normal leapfrog remov center mass motion one group conserv energi violat averag structur variou gromac util comput averag structur presum idea come someth like ensembleaverag nmr structur case make sens calcul averag structur step way calcul rootmeansquar fluctuat rmsf exampl one need averag posit atom howev import rememb averag structur isnt necessarili meaning way analog suppos altern hold ball left hand right hand what averag posit ball halfway even though alway either left hand right hand similarli structur averag tend meaningless anytim separ metast conform state happen sidechain level region backbon even whole helic compon secondari structur thu deriv averag structur molecular dynam simul find artifact like unphys bond length weird structur etc doesnt necessarili mean someth wrong show averag structur simul necessarili physic meaning structur _blowingup blow blow highli technic term use describ common sort simul failur brief describ failur typic due unaccept larg forc end result failur integr give bit background import rememb molecular dynam numer integr newton equat motion take small discret timestep use timestep determin new veloc posit veloc posit forc previou timestep forc becom larg one timestep result extrem larg chang velocityposit go next timestep typic result cascad error one atom experi larg forc one timestep thu goe shoot across system uncontrol way next timestep overshoot prefer locat land top anoth atom someth similar result even larger forc next timestep uncontrol motion ultim caus simul packag crash way sinc cant cope situat simul constraint first symptom usual linc shake warn error constraint sourc problem theyr first thing crash similarli simul domain decomposit may see messag particl cell length domain decomposit cell charg group symptomat underli problem domain decomposit algorithm likewis warn tabul interact outsid distanc support tabl happen one comput system anoth result stabl simul imposs numer reproduc calcul differ comput system possibl caus includ didnt minim well enough bad start structur perhap steric clash use larg timestep particularli given choic constraint particl insert free energi calcul without use soft core use inappropri pressur coupl eg equilibrium berendsen best relax volum need switch accur pressurecoupl algorithm later use inappropri temperatur coupl perhap inappropri group posit restraint coordin differ present system singl water molecul somewher within system isol water molecul experienc bug refgmx mdrun blow due typic forc larg particular timestep size coupl basic solut make sure forc dont get larg use smaller timestep better system prepar way make sure forc dont get larg problem occur near begin simul _systemdiagnosi diagnos unstabl system troubleshoot system blow challeng especi inexperienc user gener tip one may find use address scenario crash happen rel earli within step set nstxout nstxoutcompress captur possibl frame watch result trajectori see atomsresiduesmolecul becom unstabl first simplifi problem tri establish caus new box solvent tri minim simul singl molecul see instabl due inher problem molecul topolog instead clash start configur proteinligand system tri simul protein alon desir solvent stabl simul ligand vacuo see topolog give stabl configur energi etc remov use fanci algorithm particularli havent equilibr thoroughli first monitor variou compon system energi use refgmx energi intramolecular term spike may indic improp bond paramet exampl make sure havent ignor error messag miss atom run refgmx pdbgmx mismatch name run refgmx grompp etc use workaround like use gmx grompp maxwarn shouldnt make sure topolog intact interpret correctli make sure use appropri set refmdp file forc field chosen type system particularli import set treatment cutoff proper neighbor search interv nstlist temperatur coupl improp set lead breakdown model physic even start configur system reason use explict solvent start equilibr smaller time step product run help energi equipartit stabli sever common situat instabl frequent aris usual introduct new speci ligand molecul system determin sourc problem simplifi system eg case proteinligand complex follow way protein water minim adequ test integr coordin system prepar fail someth probabl went wrong run refgmx pdbgmx see mayb refgmx genion place ion close protein random ligand minim vacuo test topolog check parameter ligand implement new paramet forc field file previou item success ligand minim water andor short simul ligand water succeed sourc possibl problem biomolecul topolog use miss run refgmx pdbgmx dont reconstruct miss coordin rather ignor overrid longshort bond warn chang length dont probabl miss atom terribl input geometri _gmxmd molecular dynam molecular dynam md comput simul atom andor molecul interact use basic law physic gromac refrefer manual md provid good gener introduct area well specif materi use gromac first chapter mandatori read anybodi wish use gromac wast time introduct molecular model slides_ video_ theoret framework model level limit possibl system method erik lindahl book sever text book around good introductori book leach molecular model principl applic schlick molecular model simul program background rapaport art molecular dynam simul frenkel b smith understand molecular simul physicist view allen tildesley comput simul liquid hjc berendsen simul physic world hierarch model quantum mechan fluid dynam type ensembl nve number particl n system volum v energi e constant conserv nvt number particl n system volum v temperatur constant conserv see refthermostat gmxthermostat constant temperatur npt number particl n system pressur p temperatur constant conserv see refpressur coupl gmxpressur constant pressur _slide httpsextrascscfichemcoursesgmxerik_talkspreworkshop_tutorial_introductionpdf _video httptvfunetfimedarshowrecordinginfodoidmetadataficsccoursesgromacs_workshop_introductiontomolecularsimulationandgromacsxml _gmxforcefield forc field forc field set potenti function parametr interact use studi physic system gener introduct histori function use beyond scope guid user ask consult either relev literatur tri start relev wikipedia page_ _wikipedia page httpsenwikipediaorgwikiforce_field_chemistri answer frequent ask question faq _refer manual gmxmanualparentdir_ migrat old websit toctre maxdepth hidden question regard gromac instal need compil util mpi one rarelyus except refpme_error gmx pme_error refmdrun gmx mdrun abl use refmpi mpisupport parallel need use dgmx_mpion flag refconfigur configurecmak build intend run main simul engin refmdrun gmx mdrun gener desir run multinod cluster necessari use multisimul algorithm usual also instal build gromac configur without mpi conveni user version compil use doubl precis gener gromac need build default mixedprecis mode detail see discuss chapter refer manual_ sometim usag may also depend target system decid upon accord refindividu instruct gmxspecialbuild question concern system prepar preprocess find solvent refcoordin file gmxstructurefil use refsolv gmx solvat suitabl equilibr box solvent refstructur file gmxstructurefil found gmxdirsharegromacstop directori locat search default refsolv gmx solvat exampl use cs spcgro argument solvent box prepar user describ manual page refsolv gmx solvat elsewher note suitabl topolog file need solvent box use refgrompp gmx grompp avail forc field may found respect subfold gmxdirsharegromacstop prevent refsolv gmx solvat place water undesir place water placement gener well behav solvat protein difficult set membran micel simul case water may place alkyl chain lipid lead problem later refdur simul blowingup either remov water hand account molecul type reftopolog top file set local copi vdwradiidat file gmxlib directori specif project locat work directori increas vdw radiu atom suppress interstiti insert recommend eg common tutorial_ use instead _tutori httpwwwmdtutorialscomgmxlysozyme_solvatehtml provid multipl definit bond dihedr topolog add addit bond term beyond normal defin residu eg defin special ligand includ addit copi respect line bond pair angl dihedr section moleculetyp section molecul found either refitp file reftopolog top file add extra term potenti energi evalu remov previou one care duplic entri also keep mind appli duplic entri bondtyp angletyp dihedraltyp forcefield definit file duplic overwrit previou valu realli need refgro file refgro file use gromac unifi refstructur file gmxstructurefil format read util larg major gromac routin also use file type refpdb limit veloc avail refthi case gmxneedforgro need textbas format digit precis refg format suitabl support alway need run refpdbgmx gmx pdbgmx alreadi produc refitp file elsewher dont need prepar addit file alreadi refitp reftop file prepar tool exampl charmmgui httpwwwcharmmguiorg__ atb autom topolog builder httpsatbuqeduau__ pmx httppmxmpibpcmpgdeinstructionshtml__ prodrg httpdavapcbiochdundeeacukcgibinprodrg__ build miss atom gromac support build coordin miss nonhydrogen atom system miss part add miss piec use extern program avoid refmiss atom gmxatommiss error done use program chimera httpswwwcglucsfeduchimera__ combin model httpssalilaborgmodeller__ swiss pdb viewer httpsspdbvvitalitch__ maestro httpswwwschrodingercommaestro__ run simul miss atom unless know exactli stabl total charg system integ like reffloat point gmxfloatingpoint math real number display arbitrari precis see eg wikipedia httpsenwikipediaorgwikifloatingpoint_arithmetic__ mean small differ final integ valu persist gromac lie round valu charg differ integ valu larger amount eg least usual mean someth went wrong system prepar question regard simul methodolog coupl hand ion temperaturecoupl bath need consid minim size temperatur coupl group explain refgmxthermostat specif refgmxthermostatsdont well implement chosen thermostat describ refer manual_ grompp restart alway start time zero choos differ valu mdptinit mdpinitstep todo add continu simul content label gmxcontsimul link eg refcontinu simul gmxcontsimul cant conjug gradient minim constraint minim conjug gradient scheme perform constraint describ refer manual_ addit inform wikipedia httpsenwikipediaorgwikiconjugate_gradient_method__ hold atom place energi minim simul group may frozen place use freez group see refer manual_ common use set posit restraint place penalti movement atom file control kind behaviour creat use refgenrestr gmx genrestr extend complet simul longer time pleas see section refmanag long simul either prepar new refmdp file extend simul time origin reftpr file use refconverttpr gmx converttpr todo complet crash simul need gmxcontcrash doc target codeblock none easili achiev use checkpoint read refavail gmxcontcrash gromac version newer todo simul constant ph need gmxhowtocph doc target codeblock none rather larg topic least read short refconst ph howto gmxhowtocph literatur includ get overview topic comput singlepoint energi best achiev rerun option refmdrun gmx mdrun see refsinglepoint energi section parameter forc field want simul molecul protein dna etc complex variou transit metal ion ironsulfur cluster exot speci paramet exot speci arent avail forc field x first consid well refmd gmxmd actual describ system eg see recent literatur httpsdxdoiorgfacschemrevb__ mani speci infeas model without either atom polariz qm treatment need prepar set paramet add new residu refforc field gmxforcefield choic valid system behav physic way continu simul studi could also tri build simplifi model reli complic addit long still repres correct real object laboratori take paramet one forc field appli insid anoth miss molecul parametr given refforc field gmxforcefield behav physic manner interact molecul parametr accord differ standard requir molecul includ forc field need use parametr accord methodolog forc field analysi visual todo visual trajectori gmxhowtovisu doc target codeblock none use one number differ program visual coordin reffil trajectori gmxhowtovisu see bond creat watch trajectori visual softwar determin bond statu atom depend set predefin distanc bond pattern creat might one defin reftopolog top file matter inform encod softwar read reftpr tpr file inform reliabl agreement topolog suppli refgrompp gmx grompp visual trajectori simul use pbc hole peptid leav simul box hole molecul move around result molecul rang refbox boundari wrap around gmxpbc reason concern fix visual use reftrjconv gmx trjconv prepar structur analysi total simul time integ like simul time calcul use reffloat point arithmet gmxfloatingpoint round error occur concern _gmxgettingstart get start toctre hidden flow chapter assum reader familiar molecular dynam familiar unix includ use text editor jot emac vi furthermor assum gromac softwar instal properli system see line like ls l suppos type content line comput termin set environ order check whether access gromac pleas start enter command gmx version command print inform version gromac instal contrast return phrase gmx command found find version gromac instal default case binari locat usrlocalgromacsbin howev ask local system administr inform follow advic refget access gromac flowchart typic simul typic simul workflow gromac docillustr flow import file overview import gromac file type encount molecular topolog file top molecular topolog file gener program refgmx pdbgmx refgmx pdbgmx translat refpdb structur file peptid protein molecular topolog file topolog file contain complet descript interact peptid protein _gmxtopoinclud topolog includ file mechan construct system topolog reftop file present grompp gromac use builtin version socal c preprocessor cpp gromac realli cpp cpp interpret line like includ ionsitp look indic file current directori gromac sharetop directori indic gmxlib environ variabl directori indic flag valu includ mdprun paramet includ refmdp file either find file report warn note suppli directori name use unixstyl forward slash windowsstyl backslash separ found use content exactli cut past includ file main file note shouldnt go copyandpast sinc main purpos includ file mechan reus previou work make futur chang easier prevent typo cpp interpret code ifdef posres_wat posit restraint water oxygen position_restraint funct fcx fci fcz endif test whether preprocessor variabl posres_wat defin somewher ie defin could done defin posres_wat earlier reftop file includ file flag includ run paramet command line cpp function flag borrow similar usag cpp string follow must match exactli use dposr trigger ifdef posr ifdef dposr mechan allow chang refmdp file choos whether want posit restraint solvent rather reftop file note preprocessor variabl shell environ variabl _gmxneedforgro molecular structur file gro pdb refgmx pdbgmx execut gener molecular topolog also translat structur file refpdb file gromo structur file refgro file main differ refpdb file gromo file format refgro file also hold veloc howev need veloc also use refpdb file program gener box solvent molecul around peptid program refgmx solvat use first program refgmx editconf use defin box appropri size around molecul refgmx solvat solvat solut molecul peptid solvent case water output refgmx solvat gromo structur file peptid solvat water refgmx solvat also chang molecular topolog file gener refgmx pdbgmx add solvent topolog molecular dynam paramet file mdp molecular dynam paramet refmdp file contain inform molecular dynam simul eg timestep number step temperatur pressur etc easiest way handl file adapt sampl refmdp file refsampl mdp file mdp avail index file ndx sometim may need index file specifi action group atom eg temperatur coupl acceler freez usual default index group suffici demo consid use index file run input file tpr next step combin molecular structur refgro file topolog reftop file mdparamet refmdp file option index file refndx gener run input file reftpr extens file contain inform need start simul gromac refgmx grompp program process input file gener run input reftpr file trajectori file trr tng xtc run input file avail start simul program start simul call refgmx mdrun input file refgmx mdrun usual need order start run run input file reftpr file typic output file refgmx mdrun trajectori file reftrr file logfil reflog file perhap checkpoint file refcpt file tutori materi sever thirdparti tutorials_ avail cover aspect use gromac inform also found dochow howtoindex section background read berendsen hjc postma jpm van gunsteren wf herman j intermolecular forc chapter interact model water relat protein hydrat pp dordrecht reidel publish compani dordrecht kabsch w sander c dictionari protein secondari structur pattern recognit hydrogenbond geometr featur biopolym mierk df kessler h molecular dynam dimethyl sulfoxid solvent conform cyclic hexapeptid j chem soc stryer l biochemistri vol p new york freeman edit readm see run control section work exampl syntax use make mdp entri without detail document valu entri might take everyth crossreferenc see exampl todo make crossrefer molecular dynam paramet mdp option _mdpgener gener inform default valu given parenthes list first among choic first option list alway default option unit given squar bracket differ dash underscor ignor refsampl mdp file mdp avail appropri start normal simul edit suit specif need desir preprocess mdp includ directori includ topolog format ihomejohnmylib iotherlib mdp defin defin pass preprocessor default defin use defin control option custom topolog file option act exist reftop file mechan includ dflexibl use flexibl water instead rigid water topolog use normal mode analysi dposr trigger inclus posreitp topolog use implement posit restraint run control mdp integr despit name list includ algorithm actual integr time mdpvalueintegratorsteep entri follow categori mdpvalu md leapfrog algorithm integr newton equat motion mdpvalu mdvv veloc verlet algorithm integr newton equat motion constant nve simul start correspond point trajectori trajectori analyt binari ident mdpvalueintegratormd leapfrog integr kinet energi determin whole step veloc therefor slightli high advantag integr accur revers nosehoov parrinellorahman coupl integr base trotter expans well slightli small full step veloc output come cost extra comput especi constraint extra commun parallel note nearli product simul mdpvalueintegratormd integr accur enough mdpvalu mdvvavek veloc verlet algorithm ident mdpvalueintegratormdvv except kinet energi determin averag two half step kinet energi mdpvalueintegratormd integr thu accur nosehoov andor parrinellorahman coupl come slight increas comput cost mdpvalu sd accur effici leapfrog stochast dynam integr constraint coordin need constrain twice per integr step depend comput cost forc calcul take signific part simul time temperatur one group atom mdptcgrp set mdpreft invers friction constant group set mdptaut paramet mdptcoupl mdpnsttcoupl ignor random gener initi mdpldseed use thermostat appropri valu mdptaut ps sinc result friction lower intern friction water high enough remov excess heat note temperatur deviat decay twice fast berendsen thermostat mdptaut mdpvalu bd euler integr brownian posit langevin dynam veloc forc divid friction coeffici mdpbdfric plu random thermal nois mdpreft mdpbdfric friction coeffici particl calcul mass mdptaut integr mdpvalueintegratorsd random gener initi mdpldseed mdpvalu steep steepest descent algorithm energi minim maximum step size mdpemstep toler mdpemtol mdpvalu cg conjug gradient algorithm energi minim toler mdpemtol cg effici steepest descent step done everi determin mdpnstcgsteep minim prior normal mode analysi requir high accuraci gromac compil doubl precis mdpvalu lbfg quasinewtonian algorithm energi minim accord lowmemori broydenfletchergoldfarbshanno approach practic seem converg faster conjug gradient due correct step necessari yet parallel mdpvalu nm normal mode analysi perform structur reftpr file gromac compil doubl precis mdpvalu tpi test particl insert last molecul topolog test particl trajectori must provid mdrun rerun trajectori contain molecul insert insert perform mdpnstep time frame random locat random orienti molecul mdpnstlist larger one mdpnstlist insert perform sphere radiu mdprtpi around random locat use pair list sinc pair list construct expens one perform sever extra insert list almost free random seed set mdpldseed temperatur boltzmann weight set mdpreft match temperatur simul origin trajectori dispers correct implement correctli tpi relev quantiti written file specifi mdrun tpi distribut insert energi written file specifi mdrun tpid trajectori energi file written parallel tpi give ident result singlenod tpi charg molecul use pme fine grid accur also effici sinc potenti system need calcul per frame mdpvalu tpic test particl insert predefin caviti locat procedur mdpvalueintegratortpi except one coordin extra read trajectori use insert locat molecul insert center gromac sinc differ situat differ way center might optim also mdprtpi set radiu sphere around locat neighbor search done per frame mdpnstlist use parallel mdpvalueintegratortp give ident result singlerank mdpvalueintegratortp mdpvalu mimic enabl mimic qmmm coupl run hybrid molecular dynam keey mind requir launch cpmd compil mimic well mode option regard integr tcoupl pcoupl timestep number step ignor cpmd integr instead option relat forc comput cutoff pme paramet etc work usual atom select defin qm atom read mdpqmmmgrp mdp tinit ps start time run make sens timebas integr mdp dt ps time step integr make sens timebas integr mdp nstep maximum number step integr minim maximum mdp initstep start step time step run calcul mdptinit mdpdt mdpinitstep freeenergi lambda calcul lambda mdpinitlambda mdpdeltalambda mdpinitstep also nonequilibrium md paramet depend step number thu exact restart redo part run might necessari set mdpinitstep step number restart frame refgmx converttpr automat mdp simulationpart simul consist multipl part part number option specifi number help keep track part logic simul option gener use set cope crash simul file lost mdp mt mdpvalu evalu forc everi integr step mdpvalu ye use multipl timingstep integr evalu forc specifi mdpmtslevelforc everi mdpmtslevelfactor integr step forc evalu everi step mt current support mdpvalueintegratormd mdp mtslevel number level multipl timestep scheme current support mdp mtslevelforc longrangenonbond list one forc group evalu everi mdpmtslevelfactor step support entri longrangenonbond nonbond pair dihedr angl pull awh pair list pair forc select dihedr dihedr select includ cmap forc includ restraint evalu integr everi step pme ewald use electrostat andor lj interact longrangenonbond omit mdp mtslevelfactor step interv comput forc level multipl timestep scheme mdp commmod mdpvalu linear remov center mass translat veloc mdpvalu angular remov center mass translat rotat veloc mdpvalu linearaccelerationcorrect remov center mass translat veloc correct center mass posit assum linear acceler mdpnstcomm step use case acceler expect center mass nearli constant mdpnstcomm step occur exampl pull group use absolut refer mdpvalu none restrict center mass motion mdp nstcomm step frequenc center mass motion remov mdp commgrp group center mass motion remov default whole system langevin dynam mdp bdfric amu ps sup brownian dynam friction coeffici mdpbdfric friction coeffici particl calcul mass mdptaut mdp ldseed integ use initi random gener thermal nois stochast brownian dynam mdpldseed set pseudo random seed use run bd sd multipl processor processor use seed equal mdpldseed plu processor number energi minim mdp emtol kj mol sup nm sup minim converg maximum forc smaller valu mdp emstep nm initi stepsiz mdp nstcgsteep step frequenc perform steepest descent step conjug gradient energi minim mdp nbfgscorr number correct step use lbfg minim higher number least theoret accur slower shell molecular dynam shell flexibl constraint present system posit shell length flexibl constraint optim everi time step either rm forc shell constraint less mdpemtol maximum number iter mdpniter reach minim converg maximum forc smaller mdpemtol shell md valu mdp niter maximum number iter optim shell posit flexibl constraint mdp fcstep ps sup step size optim flexibl constraint chosen mudvdq mu reduc mass two particl flexibl constraint dvdq second deriv potenti constraint direct hope number differ much flexibl constraint number iter thu runtim sensit fcstep tri sever valu test particl insert mdp rtpi nm test particl insert radiu see integr mdpvalueintegratortpi mdpvalueintegratortp output control mdp nstxout step number step elaps write coordin output trajectori file reftrr last coordin alway written unless mean coordin written trajectori file mdp nstvout step number step elaps write veloc output trajectori file reftrr last veloc alway written unless mean veloc written trajectori file mdp nstfout step number step elaps write forc output trajectori file reftrr last forc alway written unless mean forc written trajectori file mdp nstlog step number step elaps write energi log file last energi alway written mdp nstcalcenergi number step elaps calcul energi never option relev dynam option affect perform parallel simul calcul energi requir global commun process becom bottleneck high parallel mdp nstenergi step number step elaps write energi energi file last energi alway written multipl mdpnstcalcenergi note exact sum fluctuat md step modulo mdpnstcalcenergi store energi file refgmx energi report exact energi averag fluctuat also mdpnstenergi mdp nstxoutcompress step number step elaps write posit coordin use lossi compress refxtc file write compress coordin output mdp compressedxprecis real precis write compress trajectori file mdp compressedxgrp group write compress trajectori file default whole system written mdpnstxoutcompress mdp energygrp group write write shortrang nonbond potenti energi energi file support gpu neighbor search mdp cutoffschem mdpvalu verlet gener pair list buffer buffer size automat set base mdpverletbuffertoler unless set case mdprlist use mdpvalu group gener pair list group atom correspond charg group topolog option longer support mdp nstlist step mdpvalu frequenc updat neighbor list dynam mdpverletbuffertoler set mdpnstlist actual minimum valu refgmx mdrun might increas unless set parallel simul andor nonbond forc calcul gpu valu often give best perform energi minim paramet use pair list updat least one atom move half pair list buffer size mdpvalu neighbor list construct never updat mainli use vacuum simul particl see vacuum simul temporarili support mdpvalu unus mdp pbc mdpvalu xyz use period boundari condit direct mdpvalu use period boundari condit ignor box simul without cutoff set cutoff mdpnstlist best perform without cutoff singl mpi rank set mdpnstlist zero mdpvaluenstypesimpl mdpvalu xy use period boundari condit x direct work mdpvaluenstypegrid use combin walls_ without wall one wall system size infinit z direct therefor pressur coupl ewald summat method use disadvantag appli two wall use mdp periodicmolecul mdpvalu molecul finit fast molecular pbc use mdpvalu ye system molecul coupl period boundari condit requir slower pbc algorithm molecul made whole output mdp verletbuffertoler kj mol sup ps sup use perform simul dynam set maximum allow error pair interact per particl caus verlet buffer indirectli set mdprlist mdpnstlist verlet buffer size fix perform reason particl pair pair list occasion get within cutoff distanc mdpnstlist step caus small jump energi constanttemperatur ensembl small energi jump estim given cutoff mdprlist estim assum homogen particl distribut henc error might slightli underestim multiphas system see refer manual_ detail longer pairlist lifetim mdpnstlist mdpdt buffer overestim interact particl ignor combin cancel error actual drift total energi usual one two order magnitud smaller note gener buffer size take account gromac pairlist setup lead reduct drift factor compar simpl particlepair base list without dynam energi minim etc buffer cutoff nve simul initi temperatur use unless zero case buffer use nve simul toler usual need lower achiev proper energi conserv nanosecond time scale overrid autom buffer set use mdpverletbuffertoler set mdprlist manual mdp rlist nm cutoff distanc shortrang neighbor list dynam default set mdpverletbuffertoler option valu mdprlist ignor without dynam default set maximum cutoff plu buffer except test particl insert buffer manag exactli automat nve simul autom set possibl advis procedur run refgmx grompp nvt setup expect temperatur copi result valu mdprlist nve setup electrostat mdp coulombtyp mdpvalu cutoff plain cutoff pair list radiu mdprlist coulomb cutoff mdprcoulomb mdprlist mdprcoulomb mdpvalu ewald classic ewald sum electrostat realspac cutoff mdprcoulomb equal mdprlist use eg mdprlist mdprcoulomb highest magnitud wave vector use reciproc space control mdpfourierspac rel accuraci directreciproc space control mdpewaldrtol note ewald scale sup thu extrem slow larg system includ mainli refer case pme perform much better mdpvalu pme fast smooth particlemesh ewald spme electrostat direct space similar ewald sum reciproc part perform fft grid dimens control mdpfourierspac interpol order mdppmeorder grid space nm cubic interpol electrostat forc accuraci sup sinc error vdwcutoff larger might tri nm run parallel interpol parallel better fft tri decreas grid dimens increas interpol mdpvalu pmad particleparticl particlemesh algorithm analyt deriv long rang electrostat interact method code ident spme except influenc function optim grid give slight increas accuraci mdpvalu reactionfield reaction field electrostat coulomb cutoff mdprcoulomb mdprlist mdprvdw dielectr constant beyond cutoff mdpepsilonrf dielectr constant set infin set mdpepsilonrf mdpvalu user current unsupport refgmx mdrun expect find file tablexvg userdefin potenti function repuls dispers coulomb pair interact present refgmx mdrun also expect find file tablepxvg pair interact interact use nonbond pair interact user specifi file name tabl file file contain column x valu fx fx gx gx hx hx fx coulomb function gx dispers function hx repuls function mdpvdwtype set user valu g g h h ignor nonbond interact x valu run largest cutoff distanc mdptableextens uniformli space pair interact tabl length file use optim space use nonus tabl nm run mix precis nm run doubl precis function valu x import inform print manual mdpvalu pmeswitch current unsupport combin pme switch function directspac part see mdprcoulomb allow smaller mdprlist mdpvalu pmeuser current unsupport combin pme user tabl see mdprcoulomb allow smaller mdprlist pme mesh contribut subtract user tabl refgmx mdrun subtract user tabl contain decim place mdpvalu pmeuserswitch current unsupport combin pmeuser switch function see switch function appli final particleparticl interact ie user suppli function pme mesh correct part mdp coulombmodifi mdpvalu potentialshift shift coulomb potenti constant zero cutoff make potenti integr forc note affect forc sampl mdpvalu none use unmodifi coulomb potenti use compar energi comput softwar mdp rcoulombswitch nm start switch coulomb potenti relev forc potenti switch use mdp rcoulomb nm distanc coulomb cutoff note pme valu increas pme tune refgmx mdrun along pme grid space mdp epsilonr rel dielectr constant valu mean infin mdp epsilonrf rel dielectr constant reaction field use reactionfield electrostat valu mean infin van der waal mdp vdwtype mdpvalu cutoff plain cutoff pair list radiu mdprlist vdw cutoff mdprvdw mdprlist mdprvdw mdpvalu pme fast smooth particlemesh ewald spme vdw interact grid dimens control mdpfourierspac way electrostat interpol order control mdppmeorder rel accuraci directreciproc space control mdpewaldrtollj specif combin rule use reciproc routin set use mdpljpmecombrul mdpvalu shift function deprec replac use mdpvaluevdwtypecutoff mdpvaluevdwmodifierforceswitch lj buckingham potenti decreas whole rang forc decay smoothli zero mdprvdwswitch mdprvdw mdpvalu switch function deprec replac use mdpvaluevdwtypecutoff mdpvaluevdwmodifierpotentialswitch lj buckingham potenti normal mdprvdwswitch switch reach zero mdprvdw potenti forc function continu smooth awar switch function give rise bulg increas forc sinc switch potenti mdpvalu user current unsupport see user mdpcoulombtyp function valu zero import want use lj correct make sure mdprvdw correspond cutoff userdefin function mdpcoulombtyp set user valu f f column ignor mdp vdwmodifi mdpvalu potentialshift shift van der waal potenti constant zero cutoff make potenti integr forc note affect forc sampl mdpvalu none use unmodifi van der waal potenti use compar energi comput softwar mdpvalu forceswitch smoothli switch forc zero mdprvdwswitch mdprvdw shift potenti shift whole rang switch zero cutoff note expens calcul plain cutoff requir energi conserv sinc potentialshift conserv energi well mdpvalu potentialswitch smoothli switch potenti zero mdprvdwswitch mdprvdw note introduc articif larg forc switch region much expens calcul option use forc field use requir mdp rvdwswitch nm start switch lj forc possibl potenti relev forc potenti switch use mdp rvdw nm distanc lj buckingham cutoff mdp dispcorr mdpvalu dont appli correct mdpvalu enerpr appli long rang dispers correct energi pressur mdpvalu ener appli long rang dispers correct energi tabl mdp tableextens nm extens nonbond potenti lookup tabl beyond largest cutoff distanc actual nonbond interact tabl never access beyond cutoff longer tabl length might need interact alway tabul irrespect use tabl nonbond interact mdp energygrpt current unsupport user tabl use electrostat andor vdw one give pair energi group separ user tabl use two energi group append tabl file name order definit mdpenergygrp separ underscor exampl energygrp na cl sol energygrpt na na na cl refgmx mdrun read table_na_naxvg table_na_clxvg addit normal tablexvg use energi group pair ewald mdp fourierspac nm ordinari ewald ratio box dimens space determin lower bound number wave vector use sign direct pme pm ratio determin lower bound number fourierspac grid point use along axi case number direct overridden enter nonzero valu mdpfouriernx direct optim rel load particleparticl interact mesh part pme use know accuraci electrostat remain nearli constant coulomb cutoff pme grid space scale factor note space scale along mdprcoulomb pme tune refgmx mdrun mdp fouriernx mdp fourierni mdp fouriernz highest magnitud wave vector reciproc space use ewald grid size use pme pm valu overrid mdpfourierspac per direct best choic power avoid larg prime note grid size reduc along scale mdprcoulomb pme tune refgmx mdrun mdp pmeorder interpol order pme equal cubic interpol might tri run parallel simultan decreas grid dimens mdp ewaldrtol sup rel strength ewaldshift direct potenti mdprcoulomb given mdpewaldrtol decreas give accur direct sum need wave vector reciproc sum mdp ewaldrtollj sup pme vdwinteract mdpewaldrtollj use control rel strength dispers potenti mdprvdw way mdpewaldrtol control electrostat potenti mdp ljpmecombrul geometr combin rule use combin vdwparamet reciproc part ljpme geometr rule much faster lorentzberthelot usual recommend choic even rest forc field use lorentzberthelot rule mdpvalu geometr appli geometr combin rule mdpvalu lorentzberthelot appli lorentzberthelot combin rule mdp ewaldgeometri mdpvalu ewald sum perform three dimens mdpvalu dc reciproc sum still perform forc potenti correct appli z dimens produc pseudod summat system slab geometri xy plane tri increas zdimens box box height time slab height usual ok use option mdp epsilonsurfac control dipol correct ewald summat default valu zero mean turn turn set valu rel permitt imaginari surfac around infinit system care shouldnt use free mobil charg system valu affect slab dc variant long rang correct temperatur coupl mdp tcoupl mdpvalu temperatur coupl mdpvalu berendsen temperatur coupl berendsen thermostat bath temperatur mdpreft time constant mdptaut sever group coupl separ specifi mdptcgrp field separ space histor thermostat need abl reproduc previou simul strongli recommend use new product run consult manual detail mdpvalu nosehoov temperatur coupl use nosehoov extend ensembl refer temperatur coupl group select case mdptaut control period temperatur fluctuat equilibrium slightli differ relax time nvt simul conserv energi quantiti written energi log file mdpvalu andersen temperatur coupl random fraction particl veloc timestep refer temperatur coupl group select mdptaut averag time random molecul inhibit particl dynam somewhat littl ergod issu current implement veloc verlet implement constraint mdpvalu andersenmass temperatur coupl random veloc particl infrequ timestep refer temperatur coupl group select mdptaut time random molecul inhibit particl dynam somewhat littl ergod issu current implement veloc verlet mdpvalu vrescal temperatur coupl use veloc rescal stochast term jcp thermostat similar berendsen coupl scale use mdptaut stochast term ensur proper canon ensembl gener random seed set mdpldseed thermostat work correctli even mdptaut nvt simul conserv energi quantiti written energi log file mdp nsttcoupl frequenc coupl temperatur default valu set mdpnsttcoupl equal fewer step requir accur integr note default valu addit comput commun requir obtain kinet energi veloc verlet integr mdpnsttcoupl set mdp nhchainlength number chain nosehoov thermostat veloc verlet integr leapfrog mdpvalueintegratormd integr support data nh chain variabl print refedr file default turn mdpprintnosehooverchainvari option mdp printnosehooverchainvari mdpvalu store nosehoov chain variabl energi file mdpvalu ye store posit veloc nosehoov chain energi file mdp tcgrp group coupl separ temperatur bath mdp taut ps time constant coupl one group mdptcgrp mean temperatur coupl mdp reft k refer temperatur coupl one group mdptcgrp pressur coupl mdp pcoupl mdpvalu pressur coupl mean fix box size mdpvalu berendsen exponenti relax pressur coupl time constant mdptaup box scale everi mdpnstpcoupl step barostat yield correct thermodynam ensembl includ abl reproduc previou run strongli recommend use new simul see manual detail mdpvalu crescal exponenti relax pressur coupl time constant mdptaup includ stochast term enforc correct volum fluctuat box scale everi mdpnstpcoupl step use equilibr product present use full anisotrop coupl mdpvalu parrinellorahman extendedensembl pressur coupl box vector subject equat motion equat motion atom coupl instantan scale take place nosehoov temperatur coupl time constant mdptaup period pressur fluctuat equilibrium probabl better method want appli pressur scale data collect bewar get larg oscil start differ pressur simul exact fluctat npt ensembl import pressur coupl time short may appropri previou time step pressur use step gromac implement current time step pressur mdpvalu mttk martynatuckermantobiasklein implement useabl mdpvalueintegratormdvv mdpvalueintegratormdvvavek similar parrinellorahman nosehoov temperatur coupl time constant mdptaup period pressur fluctuat equilibrium probabl better method want appli pressur scale data collect bewar get larg oscil start differ pressur current version support isotrop scale work without constraint mdp pcoupltyp specifi kind isotropi pressur coupl use kind take one valu mdpcompress mdprefp singl valu permit mdptaup mdpvalu isotrop isotrop pressur coupl time constant mdptaup one valu mdpcompress mdprefp requir mdpvalu semiisotrop pressur coupl isotrop x direct differ z direct use membran simul two valu mdpcompress mdprefp requir xy z direct respect mdpvalu anisotrop valu need xx yy zz xyyx xzzx yzzi compon respect offdiagon compress set zero rectangular box stay rectangular bewar anisotrop scale lead extrem deform simul box mdpvalu surfacetens surfac tension coupl surfac parallel xyplan use normal pressur coupl zdirect surfac tension coupl xy dimens box first mdprefp valu refer surfac tension time number surfac bar nm second valu refer zpressur bar two mdpcompress valu compress xy z direct respect valu zcompress reason accur sinc influenc converg surfacetens also set zero box constant height mdp nstpcoupl frequenc coupl pressur default valu set mdpnstpcoupl equal fewer step requir accur integr note default valu addit comput commun requir obtain virial veloc verlet integr mdpnstpcoupl set mdp taup ps time constant pressur coupl one valu direct mdp compress bar sup compress note realli bar sup water atm k compress e bar sup number requir valu impli mdppcoupltyp mdp refp bar refer pressur coupl number requir valu impli mdppcoupltyp mdp refcoordsc mdpvalu refer coordin posit restraint modifi note option virial pressur might ill defin see refher referencemanualpositionrestraint detail mdpvalu refer coordin scale scale matrix pressur coupl mdpvalu com scale center mass refer coordin scale matrix pressur coupl vector refer coordin center mass scale one com use even multipl molecul posit restraint calcul com refer coordin start configur period boundari condit taken account note option virial pressur might ill defin see refher referencemanualpositionrestraint detail simul anneal simul anneal control separ temperatur group gromac refer temperatur piecewis linear function use arbitrari number point group choos either singl sequenc period behaviour group actual anneal perform dynam chang refer temperatur use thermostat algorithm select rememb system usual instantan reach refer temperatur mdp anneal type anneal temperatur group mdpvalu simul anneal coupl refer temperatur valu mdpvalu singl singl sequenc anneal point simul longer time last point temperatur coupl constant valu anneal sequenc reach last time point mdpvalu period anneal start first refer point last refer time reach repeat simul end mdp annealingnpoint list number anneal referencecontrol point use temperatur group use group anneal number entri equal number temperatur group mdp annealingtim list time anneal referencecontrol point group use period anneal time use modulo last valu ie valu coupl restart ps valu ps ps ps etc number entri equal sum number given mdpannealingnpoint mdp annealingtemp list temperatur anneal referencecontrol point group number entri equal sum number given mdpannealingnpoint confus ok let use exampl assum two temperatur group set group select anneal singl period number point group annealingnpoint time annealingtim final temperatur annealingtemp first group coupl k ps refer temperatur drop linearli reach k ps linearli k k ps ps stay constant k second group coupl k ps increas linearli k ps stay constant ps ps ps decreas k start pattern ie rise linearli k k ps ps check summari print refgmx grompp unsur veloc gener mdp genvel mdpvalu gener veloc veloc set zero veloc input structur file mdpvalu ye gener veloc refgmx grompp accord maxwel distribut temperatur mdpgentemp random seed mdpgense meaning mdpvalueintegratormd mdp gentemp k temperatur maxwel distribut mdp gense integ use initi random gener random veloc mdpgense set pseudo random seed use bond mdp constraint control bond topolog convert rigid holonom constraint note typic rigid water model bond rather special settl direct affect keyword mdpvalu none bond convert constraint mdpvalu hbond convert bond hatom constraint mdpvalu allbond convert bond constraint mdpvalu hangl convert bond constraint convert angl involv hatom bondconstraint mdpvalu allangl convert bond constraint angl bondconstraint mdp constraintalgorithm choos solver satisfi nonsettl holonom constraint mdpvalu linc linear constraint solver domain decomposit parallel version plinc use accuraci set mdplincsord set number matric expans matrix invers matrix invers correct algorithm iter correct compens lengthen due rotat number iter control mdplincsit root mean squar rel constraint deviat print log file everi mdpnstlog step bond rotat mdplincswarnangl one step warn print log file stderr linc use coupl angl constraint mdpvalu shake shake slightli slower less stabl linc work angl constraint rel toler set mdpshaketol good valu normal md shake support constraint atom differ decomposit domain use domain decomposit socal updategroup use usal case bond involv hydrogen constrain shake use energi minim mdp continu option formerli known unconstrainedstart mdpvalu appli constraint start configur reset shell mdpvalu ye appli constraint start configur reset shell use exact coninu rerun mdp shaketol rel toler shake mdp lincsord highest order expans constraint coupl matrix constraint form triangl addit expans order appli top normal expans coupl within triangl normal md simul order usual suffic need larg timestep virtual site bd accur energi minim doubl precis order might requir note singl precis order higher often lead wors accuraci due amplif round error domain decomposit cell size limit distanc span mdplincsord constraint one want scale limit one decreas mdplincsord increas mdplincsit sinc accuraci deterior mdplincsit mdplincsord remain constant mdp lincsit number iter correct rotat lengthen linc normal run singl step suffici nve run want conserv energi accur accur energi minim doubl precis might want increas note singl precis use iter often lead wors accuraci due amplif round error mdp lincswarnangl deg maximum angl bond rotat linc complain mdp mors mdpvalu bond repres harmon potenti mdpvalu ye bond repres mors potenti energi group exclus mdp energygrpexcl pair energi group nonbond interact exclud exampl two energi group protein sol specifi energygrpexcl protein protein sol sol would give nonbond interact protein solvent especi use speed energi calcul mdrun rerun exclud interact within frozen group wall mdp nwall set wall z set also wall zzbox wall use mdppbc xy set pressur coupl ewald summat use usual best use semiisotrop pressur coupl xy compress set otherwis surfac area chang wall interact wit rest system option mdpwallatomtyp energi group wall wall mdpnwall ad automat monitor interact energi group wall center mass motion remov turn zdirect mdp wallatomtyp atom type name forc field wall exampl defin special wall atom type topolog combin rule allow independ tune interact atomtyp wall mdp walltyp mdpvalu lj integr volum behind wall potenti mdpvalu lj integr wall surfac potenti mdpvalu direct lj potenti z distanc wall mdp tabl user defin potenti index z distanc wall tabl read analog mdpenergygrpt option first name normal energi group second name wall wall dispers repuls column use mdp wallrlinpot nm distanc wall potenti continu linearli thu forc constant set option postiv valu especi use equilibr atom beyond wall valu mdpwalltyp tabl fatal error gener atom beyond wall mdp walldens nm sup nm sup number densiti atom wall wall type mdp wallewaldzfac scale factor third box vector ewald summat minimum ewald summat use mdpnwall one use mdpewaldgeometri dc empti layer box serv decreas unphys coulomb interact period imag com pull set whether pull collect variabl activ note pull coordin applic one set mdppullncoord multipl relat refmdp variabl exist accordingli document refer thing like mdppullcoordvec understood appli applic pull coordin eg second pull coordin describ pullcoordvec pullcoordk mdp pull mdpvalu center mass pull follow pull option ignor present refmdp file unfortun gener warn mdpvalu ye center mass pull appli group use pull coordin mdp pullcylinderr nm radiu cylind mdpvaluepullcoordgeometrycylind mdp pullconstrtol sup rel constraint toler constraint pull mdp pullprintcom mdpvalu print com group mdpvalu ye print com group pull coordin mdp pullprintrefvalu mdpvalu print refer valu pull coordin mdpvalu ye print refer valu pull coordin mdp pullprintcompon mdpvalu print distanc pull coordin mdpvalu ye print distanc cartesian compon select mdppullcoorddim mdp pullnstxout frequenc write com pull group never mdp pullnstfout frequenc write forc pull group never mdp pullpbcrefprevstepcom mdpvalu use refer atom mdppullgrouppbcatom treatment period boundari condit mdpvalu ye use com previou step refer treatment period boundari condit refer initi use refer atom mdppullgrouppbcatom locat central group use com previou step use one pull group larg mdp pullxoutaverag mdpvalu write instantan coordin pull group mdpvalu ye write averag coordin sinc last output pull group nb analysi tool might expect instantan pull output mdp pullfoutaverag mdpvalu write instantan forc pull group mdpvalu ye write averag forc sinc last output pull group nb analysi tool might expect instantan pull output mdp pullngroup number pull group includ absolut refer group use pull group reus multipl pull coordin pull option group given group simpli increas group index number mdp pullncoord number pull coordin pull option coordin given coordin simpli increas coordin index number mdp pullgroupnam name pull group look index file default group obtain atom involv mdp pullgroupweight option rel weight multipli mass atom give total weight com number mean number atom pull group mdp pullgrouppbcatom refer atom treatment period boundari condit insid group effect treatment pbc group option import diamet pull group larger half shortest box vector determin com atom group put period imag closest mdppullgrouppbcatom valu mean middl atom number wise use safe small group refgmx grompp check maximum distanc refer atom specif chosen atom group larg paramet use mdppullcoordgeometri cylind valu turn cosin weight use group molecul period system eg water slab see engin et al j chem phi b mdp pullcoordtyp mdpvalu umbrella center mass pull use umbrella potenti refer group one group mdpvalu constraint center mass pull use constraint refer group one group setup ident option umbrella except fact rigid constraint appli instead harmon potenti note type support combin multipl time step mdpvalu constantforc center mass pull use linear potenti therefor constant forc option refer posit therefor paramet mdppullcoordinit mdppullcoordr use mdpvalu flatbottom distanc mdppullcoordinit harmon potenti appli otherwis potenti appli mdpvalu flatbottomhigh distanc mdppullcoordinit harmon potenti appli otherwis potenti appli mdpvalu externalpotenti extern potenti need provid anoth modul mdp pullcoordpotentialprovid name extern modul provid potenti case mdppullcoordtyp externalpotenti mdp pullcoordgeometri mdpvalu distanc pull along vector connect two group compon select mdppullcoorddim mdpvalu direct pull direct mdppullcoordvec mdpvalu directionperiod mdpvaluepullcoordgeometrydirect appli period box vector correct keep distanc within half box length use push group apart half box length continu chang refer locat use pull rate geometri box dynam eg pressur scale pull dimens pull forc ad virial mdpvalu directionrel mdpvaluepullcoordgeometrydirect pull vector vector point com third com fourth pull group mean group need suppli mdppullcoordgroup note pull forc give rise torqu pull vector turn lead forc perpendicular pull vector two group defin vector want pull group move two group defin vector simpli use union two group refer group mdpvalu cylind design pull respect layer refer com given local cylindr part refer group pull direct mdppullcoordvec first two group mdppullcoordgroup cylind select around axi go com second group direct mdppullcoordvec radiu mdppullcylinderr weight atom decreas contin zero radial distanc goe mdppullcylinderr mass weight also use radial depend give rise radial forc pull group note radiu smaller half box size tilt cylind even smaller half box size sinc distanc atom refer group com pull group radial axial compon geometri support constraint pull mdpvalu angl pull along angl defin four group angl defin angl two vector vector connect com first group com second group vector connect com third group com fourth group mdpvalu angleaxi mdpvaluepullcoordgeometryangl second vector given mdppullcoordvec thu two group defin first vector need given mdpvalu dihedr pull along dihedr angl defin six group pairwis defin three vector vector connect com group com group com group com group com group com group dihedr angl defin angl two plane plane span two first vector plane span two last vector mdpvalu transform transform pull coordin use mathemat express defin mdppullcoordexpress pull coordin lower indic use variabl pull coordin thu pull transform coordin higher pull coordin index pull coordin transform mdp pullcoordexpress mathemat express transform pull coordin lower indic new one pull coordin refer variabl equat pullcoord valu becom x pullcoord valu becom x etc mathemat express evalu use mupars relev mdppullcoordgeometri set mdpvaluetransform mdp pullcoorddx e size finit differ use numer deriv pull coordin respect pull coordin current implement use simpl first order finit differ method perform deriv fx fxdxfxdx relev mdppullcoordgeometri set mdpvaluetransform mdp pullcoordgroup group indic pull coordin oper number group indic requir geometri depend first index case absolut refer mdppullcoordorigin use absolut refer system longer translat invari one think center mass motion mdp pullcoorddim select dimens pull coordin act print output file mdppullprintcompon mdpvaluepullcoordstarty mdppullcoordgeometri mdpvaluepullcoordgeometrydist cartesian compon set contribut distanc thu set n result distanc xy plane geometri dimens nonzero entri mdppullcoordvec set valu dimens affect output mdp pullcoordorigin pull refer posit use absolut refer mdp pullcoordvec pull direct refgmx grompp normal vector mdp pullcoordstart mdpvalu modifi mdppullcoordinit mdpvalu ye add com distanc start conform mdppullcoordinit mdp pullcoordinit nm deg refer distanc refer angl mdp pullcoordr nmp degp rate chang refer posit refer angl mdp pullcoordk kj mol sup nm sup kj mol sup nm sup kj mol sup rad sup kj mol sup rad sup forc constant umbrella pull harmon forc constant kj mol sup nm sup kj mol sup rad sup angl constant forc pull forc constant linear potenti thu neg constant forc kj mol sup nm sup kj mol sup rad sup angl note angl forc constant express term radian mdppullcoordinit mdppullcoordr express degre mdp pullcoordkb pullk kj mol sup nm sup kj mol sup nm sup kj mol sup rad sup kj mol sup rad sup mdppullcoordk state b use mdpfreeenergi turn forc constant lambda mdppullcoordk lambda mdppullcoordkb awh adapt bias mdp awh mdpvalu bias mdpvalu ye adapt bia reaction coordin use awh method estim correspond pmf pmf awh data written energi file interv set mdpawhnstout extract gmx awh tool awh coordin multidimension defin map dimens pull coordin index allow mdpvaluepullcoordtypeexternalpotenti mdppullcoordpotentialprovid awh concern pull coordin indic pull geometri directionperiod support awh mdp awhpotenti mdpvalu convolv appli bias potenti convolut bia function set harmon umbrella potenti see mdpvalueawhpotentialumbrella result smooth potenti function forc resolut potenti set forc constant umbrella see mdpawhdimforceconst option compat use free energi lambda state awh reaction coordin mdpvalu umbrella potenti bia appli control posit harmon potenti use montecarlo sampl forc constant set mdpawhdimforceconst umbrella locat sampl use montecarlo everi mdpawhnstsampl step option requir use free energi lambda state awh reaction coordin apart option mainli comparison test purpos advantag use umbrella mdp awhsharemultisim mdpvalu awh share bias across simul start refgmx mdrun option multidir bias independ mdpvalu ye refgmx mdrun option multidir bia pmf estim bias mdpawhsharegroup share across simul bias mdpawhsharegroup valu simul awh set share make sens refgmx mdrun check whether simul technic compat share user check bia share physic make sens mdp awhse random seed montecarlo sampl umbrella posit indic gener seed use mdpvalueawhpotentialumbrella mdp awhnstout number step print awh data energi file multipl mdpnstenergi mdp awhnstsampl number step sampl coordin valu sampl basi updat bia estim pmf awh observ mdp awhnsamplesupd number coordin sampl use awh updat updat interv step mdpawhnstsampl time valu mdp awhnbia number bias act coordin follow option specifi bia although option bia number shown option bia indic obtain replac bia index mdp awherrorinit kj mol sup estim initi averag error pmf bia valu togeth given diffus constant mdpawhdimdiffus determin initi bias rate error obvious known priori rough estim mdpawherrorinit need howev gener guidelin leav mdpawherrorinit default valu start new simul hand priori knowledg pmf eg initi pmf estim provid see mdpawhuserdata option mdpawherrorinit reflect knowledg mdp awhgrowth mdpvalu explinear bia keep refer weight histogram coordin sampl size set magnitud bia function free energi estim updat sampl correspond larg updat vice versa thu growth rate set maximum converg rate default initi stage histogram grow close exponenti slower sampl rate final stage follow growth rate linear equal sampl rate set mdpawhnstsampl initi stage typic necessari effici converg start new simul high free energi barrier yet flatten bia mdpvalu linear mdpvalueawhgrowthexplinear skip initi stage may use priori knowledg see mdpawherrorinit elimin need initi stage also set compat mdpvalueawhtargetlocalboltzmann mdp awhequilibratehistogram mdpvalu equilibr histogram mdpvalu ye enter initi stage see mdpvalueawhgrowthexplinear make sure histogram sampl weight follow target distribut close enough specif least target region need local rel error less option would typic use mdpawhsharegroup initi configur poorli repres target distribut mdp awhtarget mdpvalu constant bia tune toward constant uniform coordin distribut defin sampl interv defin mdpawhdimstart mdpawhdimend mdpvalu cutoff similar mdpvalueawhtargetconst target distribut proport expf mdpvalueawhtargetcutoff f free energi rel estim global minimum provid smooth switch flat target distribut region free energi lower cutoff boltzmann distribut region free energi higher cutoff mdpvalu boltzmann target distribut boltzmann distribtut scale beta invers temperatur factor given mdpawhtargetbetasc eg valu would give coordin distribut sampl simul temperatur scale mdpvalu localboltzmann target distribut use mdpawhtargetbetasc converg toward target distribut inher local ie rate chang bia depend local sampl local converg properti compat mdpvalueawhgrowthlinear sinc mdpvalueawhgrowthexplinear histogram global rescal initi stage mdp awhtargetbetasc mdpvalueawhtargetboltzmann mdpvalueawhtargetlocalboltzmann unitless beta scale factor take valu mdp awhtargetcutoff kj mol sup mdpvalueawhtargetcutoff cutoff mdp awhuserdata mdpvalu initi pmf target distribut default valu mdpvalu ye initi pmf target distribut user provid data mdpawhnbia refgmx mdrun expect file awhinitxvg present run directori multipl bias refgmx mdrun expect file awhinitxvg awhinitxvg etc file name chang awh option first mdpawhndim column input file contain coordin valu row defin point coordin space column mdpawhndim contain pmf valu kt point target distribut column either follow pmf column mdpawhndim column written refgmx awh mdp awhsharegroup mdpvalu share bia mdpvalu posit share bia pmf estim simul current work bias index note current share within singl simul support bia share across simul specifi valu mdpawhsharegroup enabl use mdpvalueawhsharemultisimy refgmx mdrun option multidir share may increas converg initi although start configur critic especi share mani bias mdp awhndim integ number dimens coordin dimens map pull coordin follow option specifi dimens option dimens number shown option dimens indic obtain replac dimens index mdp awhdimcoordprovid mdpvalu pull pull modul provid reaction coordin dimens multipl timestep awh pull mt level mdpvalu feplambda free energi lambda state reaction coordin dimens lambda state use specifi mdpfeplambda mdpvdwlambda mdpcoullambda etc compat deltalambda also requir calclambdaneighbor multipl timestep awh slow level option requir mdpvalueawhpotentialumbrella mdp awhdimcoordindex index pull coordin defin coordin dimens mdp awhdimforceconst kj mol sup nm sup kj mol sup rad sup forc constant convolv umbrella potenti along coordin dimens mdp awhdimstart nm deg start valu sampl interv along dimens rang allow valu depend relev pull geometri see mdppullcoordgeometri dihedr geometri mdpawhdimstart greater mdpawhdimend allow interv wrap around period period direct geometri dimens made period direct along box vector cover box length note one appli pressur coupl along period dimens mdp awhdimend nm deg end valu defin sampl interv togeth mdpawhdimstart mdp awhdimdiffus sup nm supp rad supp ps sup estim diffus constant coordin dimens determin initi bias rate need rough estim critic affect result unless set someth low lead slow converg high forc system far equilibrium set valu explicitli gener warn mdp awhdimcoverdiamet nm deg diamet need sampl singl simul around coordin valu point consid cover initi stage see mdpvalueawhgrowthexplinear valu ensur cover continu transit diamet across coordin valu trivial true independ simul multipl biasshar simul mdpawhsharegroup diamet cover occur soon simul sampl whole interv mani share simul guarante transit across free energi barrier hand diamet sampl interv length cover occur singl simul independ sampl whole interv enforc rotat refmdp paramet use enforc rotat group atom eg protein subunit refer manual_ describ detail differ potenti use achiev rotat mdp rotat mdpvalu enforc rotat appli enforc rotat option ignor present refmdp file unfortun gener warn mdpvalu ye appli rotat potenti specifi mdprottyp group atom given mdprotgroup option mdp rotngroup number rotat group mdp rotgroup name rotat group index file mdp rottyp iso type rotat potenti appli rotat group follow iso isopf pm pmpf rm rmpf rm rmpf flex flext flex flext mdp rotmassw use mass weight rotat group posit mdp rotvec rotat vector get normal mdp rotpivot nm pivot point potenti iso pm rm rm mdp rotrat degre ps sup refer rotat rate group mdp rotk kj mol sup nm sup forc constant group mdp rotslabdist nm slab distanc flexibl axi rotat type chosen mdp rotmingauss minimum valu cutoff gaussian function forc evalu flexibl axi potenti mdp rotep nm sup valu addit constant epsilon rm flex potenti mdp rotfitmethod rmsd fit method determin actual angl rotat group one rmsd norm potenti mdp rotpotfitnstep fit type potenti number angular posit around refer angl rotat potenti evalu mdp rotpotfitstep fit type potenti distanc degre two angular posit mdp rotnstrout output frequenc step angl rotat group well torqu rotat potenti energi mdp rotnstsout output frequenc perslab data flexibl axi potenti ie angl torqu slab center nmr refin mdp disr mdpvalu ignor distanc restraint inform topolog file mdpvalu simpl simpl permolecul distanc restraint mdpvalu ensembl distanc restraint ensembl molecul one simul box normal one would perform ensembl averag multipl simul use mdrun multidir environ variabl gmx_disre_ensemble_s set number system within ensembl usual equal number directori suppli mdrun multidir mdp disreweight mdpvalu equal divid restraint forc equal atom pair restraint mdpvalu conserv forc deriv restraint potenti result weight atom pair reciproc seventh power displac forc conserv mdpdisretau zero mdp disremix mdpvalu violat use calcul restraint forc timeaverag violat mdpvalu ye violat use calcul restraint forc squar root product timeaverag violat instantan violat mdp disrefc kj mol sup nm sup forc constant distanc restraint multipli possibl differ factor restraint given fac column interact topolog file mdp disretau ps time constant distanc restraint run averag valu zero turn time averag mdp nstdisreout step period step run timeaverag instantan distanc atom pair involv restraint written energi file make energi file larg mdp orir mdpvalu ignor orient restraint inform topolog file mdpvalu ye use orient restraint ensembl averag perform mdrun multidir mdp orirefc kj mol sup forc constant orient restraint multipli possibl differ weight factor restraint set zero obtain orient free simul mdp oriretau ps time constant orient restraint run averag valu zero turn time averag mdp orirefitgrp fit group orient restrain group atom use determin rotat r system respect refer orient refer orient start conform first subsystem protein backbon reason choic mdp nstorireout step period step run timeaverag instantan orient restraint molecular order tensor written energi file make energi file larg free energi calcul mdp freeenergi mdpvalu use topolog mdpvalu ye interpol topolog lambda topolog b lambda write deriv hamiltonian respect lambda specifi mdpdhdlderiv hamiltonian differ respect lambda valu specifi foreign lambda energi file andor dhdlxvg process exampl refgmx bar potenti bondlength angl interpol linearli describ manual mdpscalpha larger zero softcor potenti use lj coulomb interact mdp expand turn expand ensembl simul alchem state becom dynam variabl allow jump differ hamiltonian see expand ensembl option control expand ensembl simul perform differ hamiltonian use expand ensembl simul defin free energi option mdp initlambda start valu lambda float gener use slow growth ie nonzero mdpdeltalambda case mdpinitlambdast specifi instead lambda vector given mdp initlambda use interpol vector instead set lambda directli must greater equal mdp deltalambda increment per time step lambda mdp initlambdast start valu lambda state integ specifi columm lambda vector mdpcoullambda mdpvdwlambda mdpbondedlambda mdprestraintlambda mdpmasslambda mdptemperaturelambda mdpfeplambda use zerobas index mdpinitlambdast mean first column mdp feplambda array zero one lambda valu delta h valu determin written dhdlxvg everi mdpnstdhdl step valu must greater equal valu greater allow use care free energi differ differ lambda valu determin refgmx bar mdpfeplambda differ lambda keyword compon lambda vector specifi use mdpfeplambda includ mdprestraintlambda therefor pull code restraint mdp coullambda array zero one lambda valu delta h valu determin written dhdlxvg everi mdpnstdhdl step valu must greater equal valu greater allow use care softcor potenti use valu must electrostat interact control compon lambda vector lambda lambda state differ electrostat interact mdp vdwlambda array zero one lambda valu delta h valu determin written dhdlxvg everi mdpnstdhdl step valu must greater equal valu greater allow use care softcor potenti use valu must van der waal interact control compon lambda vector mdp bondedlambda array zero one lambda valu delta h valu determin written dhdlxvg everi mdpnstdhdl step valu must greater equal valu greater allow use care bond interact control compon lambda vector mdp restraintlambda array zero one lambda valu delta h valu determin written dhdlxvg everi mdpnstdhdl step valu must greater equal valu greater allow use care restraint interact dihedr restraint pull code restraint control compon lambda vector mdp masslambda array zero one lambda valu delta h valu determin written dhdlxvg everi mdpnstdhdl step valu must greater equal valu greater allow use care particl mass control compon lambda vector mdp temperaturelambda array zero one lambda valu delta h valu determin written dhdlxvg everi mdpnstdhdl step valu must greater equal valu greater allow use care temperatur control compon lambda vector note lambda use replica exchang simul temper mdp calclambdaneighbor control number lambda valu delta h valu calcul written mdpinitlambdast set posit valu limit number lambda point calcul nth neighbor mdpinitlambdast exampl mdpinitlambdast paramet valu energi lambda point calcul writen valu mean lambda point written normal bar refgmx bar valu suffici mbar use mdp scfunction beutler mdpvalu beutler beutler et al softcor function mdpvalu gapsi gapsi et al softcor function mdp scalpha scfunctionbeutl softcor alpha paramet valu result linear interpol lj coulomb interact use scfunctionbeutl mdp scrpower power radial term softcor equat use scfunctionbeutl mdp sccoul whether appli softcor free energi interact transform columb interact molecul default gener effici turn coulom interact linearli turn van der waal interact note taken account lambda state use mdpcouplelambda mdpcouplelambda still turn softcor interact set mdpscalpha use scfunctionbeutl mdp scpower power lambda softcor function valu support use scfunctionbeutl mdp scsigma nm scfunctionbeutl softcor sigma particl c c paramet equal zero sigma smaller mdpscsigma use scfunctionbeutl mdp scgapsysscalelinpointlj scfunctiongapsi unitless alphalj paramet control soft van der waal interact scale point linear vdw forc set result standard hardcor van der waal interact use scfunctiongapsi mdp scgapsysscalelinpointq nme scfunctiongapsi alphaq paramet unit nme default valu control soft coulomb interact set result standard hardcor coulomb interact use scfunctiongapsi mdp scgapsyssigmalj nm scfunctiongapsi softcor sigma particl c c paramet equal zero use scfunctiongapsi mdp couplemoltyp one suppli molecul type defin topolog calcul solvat coupl free energi special option system coupl molecul type system use equilibr system start nearli random coordin mdpfreeenergi turn van der waal interact andor charg molecul type turn lambda lambda depend set mdpcouplelambda mdpcouplelambda want decoupl one sever copi molecul need copi renam molecul definit topolog mdp couplelambda mdpvalu vdwq interact lambda mdpvalu vdw charg zero coulomb interact lambda mdpvalu q van der waal interact turn lambda softcor interact requir avoid singular mdpvalu none van der waal interact turn charg zero lambda softcor interact requir avoid singular mdp couplelambda analog mdpcouplelambda lambda mdp coupleintramol mdpvalu intramolecular nonbond interact moleculetyp mdpcouplemoltyp replac exclus explicit pair interact manner decoupl state molecul correspond proper vacuum state without period effect mdpvalu ye intramolecular van der waal coulomb interact also turn onoff use partit freeenergi rel larg molecul intramolecular nonbond interact might lead kinet trap vacuum conform pair interact turn mdp nstdhdl frequenc write dhdlambda possibl delta h dhdlxvg mean ouput multipl mdpnstcalcenergi mdp dhdlderiv ye ye default deriv hamiltonian respect lambda mdpnstdhdl step written valu need interpol linear energi differ refgmx bar although also achiev right foreign lambda set may flexibl thermodynam integr mdp dhdlprintenergi includ either total potenti energi dhdl file option potenti total inform need later free energi analysi state interest differ temperatur state temperatur inform need potenti use case one use mdrun rerun gener dhdlxvg file rerun exist trajectori kinet energi often correct thu one must comput residu free energi potenti alon kinet energi compon comput analyt mdp separatedhdlfil mdpvalu ye free energi valu calcul specifi foreign lambda mdpdhdlderiv set written separ file default name dhdlxvg file use directli refgmx bar mdpvalu free energi valu written energi output file eneredr accumul block everi mdpnstenergi step extract refgmx energi use directli refgmx bar mdp dhhistsiz nonzero specifi size histogram delta h valu specifi foreign lambda deriv dhdl valu bin written eneredr use save disk space calcul free energi differ one histogram get written foreign lambda two dhdl everi mdpnstenergi step awar incorrect histogram set small size wide bin introduc error use histogram unless your certain need mdp dhhistspac specifi bin width histogram energi unit use conjunct mdpdhhistsiz size limit accuraci free energi calcul use histogram unless your certain need expand ensembl calcul mdp nstexpand number integr step beween attempt move chang system hamiltonian expand ensembl simul must multipl mdpnstcalcenergi greater less mdpnstdhdl mdp lmcstat mdpvalu mont carlo state space perform mdpvalu metropolistransit use metropoli weight updat expand ensembl weight state minexpbeta_new u_new beta_old u_old mdpvalu barkertransit use barker transit critera updat expand ensembl weight state defin expbeta_new u_newexpbeta_new u_newexpbeta_old u_old mdpvalu wanglandau use wanglandau algorithm state space energi space updat expand ensembl weight mdpvalu minvari use minimum varianc updat method escobedo et al updat expand ensembl weight weight free energi rather emphas state need sampl give even uncertainti mdp lmcmcmove mdpvalu mont carlo state space perform mdpvalu metropolistransit randomli choos new state use metropoli critera decid whether accept reject minexpbeta_new u_new beta_old u_old mdpvalu barkertransit randomli choos new state use barker transit critera decid whether accept reject expbeta_new u_newexpbeta_new u_newexpbeta_old u_old mdpvalu gibb use condit weight state given coordin expbeta_i u_i sum_k expbeta_i u_i decid state move mdpvalu metropolizedgibb use condit weight state given coordin expbeta_i u_i sum_k expbeta_i u_i decid state move exclud current state use reject step ensur detail balanc alway effici gibb though margin mani situat nearest neighbor decent phase space overlap mdp lmcseed random seed use mont carlo move state space mdplmcseed set pseudo random seed us mdp mctemperatur temperatur use acceptancereject mont carlo move specifi temperatur simul specifi first group mdpreft use mdp wlratio cutoff histogram state occup reset free energi incrementor chang delta delta mdpwlscale defin nratio number sampl histogram averag number sampl histogram mdpwlratio mean mean histogram consid flat nratio simultan nratio mdp wlscale time histogram consid flat current valu wanglandau incrementor free energi multipli mdpwlscale valu must mdp initwldelta initi valu wanglandau incrementor kt valu near kt usual effici though sometim valu unit kt work better free energi differ larg mdp wloneovert set wanglandau incrementor scale simul time larg sampl limit signific evid standard wanglandau algorithm state space present result free energi get burn incorrect valu depend initi state mdpwloneovert true incrementor becom less n n mumber sampl collect thu proport data collect time henc wanglambda incrementor set n decreas everi step occur mdpwlratio ignor weight still stop updat equilibr criteria set mdplmcweightsequil achiev mdp lmcrepeat control number time mont carlo swap type perform iter limit larg number mont carlo repeat method converg gibb sampl valu gener need differ mdp lmcgibbsdelta limit gibb sampl select number neighbor state gibb sampl sometim ineffici perform gibb sampl state defin posit valu mdplmcgibbsdelta mean state plu minu mdplmcgibbsdelta consid exchang valu mean state consid less state probabl expens includ state mdp lmcforcednstart forc initi state space sampl gener weight order come reason initi weight set allow simul drive initi final lambda state mdplmcforcednstart step state move next lambda state mdplmcforcednstart suffici long thousand step perhap weight close correct howev case probabl better simpli run standard weight equilibr algorithm mdp nsttransitionmatrix frequenc output expand ensembl transit matrix neg number mean print end simul mdp symmetrizedtransitionmatrix whether symmetr empir transit matrix infinit limit matrix symmetr diverg statist nois short timescal forc symmetr use matrix t_sym transposet remov problem like exist small magnitud neg eigenvalu mdp mininumvarmin minvari strategi option mdplmcstat valid larger number sampl get stuck sampl use state mdpmininumvarmin minimum number sampl state allow minvari strategi activ select mdp initlambdaweight initi weight free energi use expand ensembl state default vector zero weight format similar lambda vector set mdpfeplambda except weight float point number unit kt length must match lambda vector length mdp lmcweightsequil mdpvalu expand ensembl weight continu updat throughout simul mdpvalu ye input expand ensembl weight treat equilibr updat throughout simul mdpvalu wldelta expand ensembl weight updat stop wanglandau incrementor fall valu mdpvalu numberalllambda expand ensembl weight updat stop number sampl lambda state greater valu mdpvalu numberstep expand ensembl weight updat stop number step greater level specifi valu mdpvalu numbersampl expand ensembl weight updat stop number total sampl across lambda state greater level specifi valu mdpvalu countratio expand ensembl weight updat stop ratio sampl least sampl lambda state sampl lambda state greater valu mdp simulatedtemp turn simul temper simul temper implement expand ensembl sampl differ temperatur instead differ hamiltonian mdp simtemplow k low temperatur simul temper mdp simtemphigh k high temperatur simul temper mdp simulatedtemperingsc control way temperatur intermedi lambda calcul mdptemperaturelambda part lambda vector mdpvalu linear linearli interpol temperatur use valu mdptemperaturelambda ie mdpsimtemplow mdpsimtemphigh lambda correspond temperatur nonlinear set temperatur alway implement uneven space lambda mdpvalu geometr interpol temperatur geometr mdpsimtemplow mdpsimtemphigh ith state temperatur mdpsimtemplow mdpsimtemphigh mdpsimtemplow rais power intemp give roughli equal exchang constant heat capac though cours thing simul involv protein fold high heat capac peak mdpvalu exponenti interpol temperatur exponenti mdpsimtemplow mdpsimtemphigh ith state temperatur mdpsimtemplow mdpsimtemphigh mdpsimtemplowexpmdptemperaturelambda iexpi nonequilibrium md mdp accgrp group constant acceler eg protein sol atom group protein sol experi constant acceler specifi mdpacceler line note kinet energi center mass accelar group contribut kinet energi temperatur system desir make acceler group also separ temperatur coupl group mdp acceler nm ps sup acceler mdpaccgrp x z group eg mean first group constant acceler nm ps sup x direct second group opposit mdp freezegrp group frozen ie x andor z posit updat eg lipid sol mdpfreezedim specifi dimens freez appli avoid spuriou contribut virial pressur due larg forc complet frozen atom need use energi group exclus also save comput time note coordin frozen atom scale pressurecoupl algorithm mdp freezedim dimens group mdpfreezegrp frozen specifi n x z group eg n n n n mean particl first group move z direct particl second group move direct mdp cosacceler nm ps sup amplitud acceler profil calcul viscos acceler xdirect magnitud mdpcosacceler co pi zboxheight two term ad energi file amplitud veloc profil viscos mdp deform nm ps sup veloc deform box element ax cz bx cx cy step box element mdpdeform nonzero calcul boxtsttsdeform offdiagon element correct period coordin transform accordingli frozen degre freedom purpos also transform time ts set first step step x v written trajectori ensur exact restart deform use togeth semiisotrop anisotrop pressur coupl appropri compress set zero diagon element use strain solid offdiagon element use shear solid liquid electr field mdp electricfieldx mdp electricfieldi mdp electricfieldz specifi electr field option altern puls gener express field form gaussian laser puls math et e_ expleftfractt_sigmarightcosleftomega tt_right exampl four paramet direct x set field mdpelectricfieldx similar electricfieldi electricfieldz like electricfieldx e omega sigma unit respect v nm sup ps sup ps ps special case sigma exponenti term omit cosin term use case must set also omega static electr field appli read refelectr field ref ref refcalemana mix quantumclass molecular dynam mdp qmmmgrp group descib qm level mimic qmmm mdp qmmm mdpvalu qmmm longer support via mdp option mimic use comput electrophysiolog use option switch control ionwat posit exchang comput electrophysiolog simul setup see refer manual_ detail mdp swapcoord mdpvalu enabl ionwat posit exchang mdpvalu x z allow ionwat posit exchang along chosen direct typic setup membran parallel xy plane ionwat pair need exchang z direct sustain request ion concentr compart mdp swapfrequ swap attempt frequenc ie everi mani time step ion count per compart determin exchang made necessari normal necessari check everi time step typic comput electrophysiolog setup valu suffici yield neglig perform impact mdp splitgroup name index group membraneembed part channel center mass atom defin one compart boundari chosen near center membran mdp splitgroup channel defin posit compart boundari mdp masswsplit defin whether massweight use calcul split group center mdpvalu use geometr center mdpvalu ye use center mass mdp masswsplit splitgroup mdp solventgroup name index group solvent molecul mdp couplstep averag number ion per compart mani swap attempt step use prevent ion near compart boundari diffus channel eg lead unwant back forth swap mdp iontyp number differ ion type control simul exchang solvent molecul reach desir refer number mdp iontypenam name first ion type mdp iontypeina request refer number ion type compart default valu mean use number ion found time step refer valu mdp iontypeinb refer number ion type compart b mdp bulkoffseta offset first swap layer compart midplan default ie bulk offset ionwat exchang happen layer maximum distanc bulk concentr split group layer howev offset b b specifi offset bulk layer middl toward one compartmentpartit layer mdp bulkoffsetb offset swap layer compart b midplan mdp threshold swap ion threshold differ request count reach mdp cylr nm radiu split cylind two split cylind mimick channel pore option defin rel center split group help cylind count ion pass channel split cylind definit impact whether ionwat swap done mdp cylup nm upper extens split cylind mdp cyldown nm lower extens split cylind mdp cylr nm radiu split cylind mdp cylup nm upper extens split cylind mdp cyldown nm lower extens split cylind densityguid simul option enabl control calcul applic addit forc deriv threedimension densiti eg cryo electronmicroscopi experi see refer manual_ detail mdp densityguidedsimulationact activ densityguid simul mdp densityguidedsimulationgroup protein atom subject forc densityguid simul contribut simul densiti mdp densityguidedsimulationsimilaritymeasur innerproduct similar measur densiti calcul atom posit refer densiti mdpvalu innerproduct take sum product refer densiti simul densiti voxel valu mdpvalu relativeentropi use neg rel entropi kullbackleibl diverg refer densiti simul densiti similar measur neg densiti valu ignor mdpvalu crosscorrel use pearson correl coeffici refer densiti simul densiti similar measur mdp densityguidedsimulationatomspreadingweight uniti determin multipl factor gaussian kernel spread atom grid mdpvalu uniti everi atom densiti fit group assign unit factor mdpvalu mass atom contribut simul densiti proport mass mdpvalu charg atom contribut simul densiti proport charg mdp densityguidedsimulationforceconst e kj mol sup scale factor densityguid simul forc may also neg mdp densityguidedsimulationgaussiantransformspreadingwidth nm gaussian rm width spread kernel simul densiti mdp densityguidedsimulationgaussiantransformspreadingrangeinmultiplesofwidth rang gaussian cut multipl gaussian rm width describ mdp densityguidedsimulationreferencedensityfilenam referencemrc refer densiti file name use absolut path path rel folder refgmx mdrun call mdp densityguidedsimulationnst interv step densiti fit forc evalu appli forc scale number appli see refer manual_ detail mdp densityguidedsimulationnormalizedens true normal sum densiti voxel valu one refer densiti well simul densiti mdp densityguidedsimulationadaptiveforcesc fals adapt forc constant ensur steadi increas similar simul refer densiti mdpvalu fals use adapt forc scale mdpvalu true use adapt forc scale mdp densityguidedsimulationadaptiveforcescalingtimeconst ps coupl forc constant increas similar refer densiti time constant larger time result looser coupl mdp densityguidedsimulationshiftvector nm add vector atom densityguidedsimulationgroup calcul forc energi densityguidedsimul affect densityguidedsimul forc energi correspond shift input densiti opposit direct densityguidedsimulationshiftvector mdp densityguidedsimulationtransformationmatrix multipli atom matrix densityguidedsimulationgroup calcul forc energi densityguidedsimul affect densityguidedsimul forc energi correspond transform input densiti invers matrix matrix given rowmajor order option allow eg rotat densityguid atom group around zaxi maththeta degress use follow input mathco theta sin theta sin theta co theta qmmm simul cpk interfac option enabl control calcul applic addit qmmm forc comput cpk packag link gromac detail qmmm interfac implement follow refqmmm mdp qmmmcpkactiv fals activ qmmm simul requir cpk link gromac mdp qmmmcpkqmgroup system index group atom treat qm mdp qmmmcpkqmmethod pbe method use describ qm part system mdpvalu pbe dft use pbe function dzvpmolopt basi set mdpvalu blyp dft use blyp function dzvpmolopt basi set mdpvalu input provid extern input file cpk run refgmx grompp qmi commandlin option extern input file subject limit describ refqmmm mdp qmmmcpkqmcharg total charg qm part mdp qmmmcpkqmmultipl multipl spinstat qm part default valu mean singlet state mdp qmmmcpkqmfilenam name cpk file gener simul use default empti valu name simul input file use addit _cpk suffix user defin thingi mdp usergrp mdp usergrp mdp userint mdp userint mdp userint mdp userint mdp userr mdp userr mdp userr mdp userr use modifi code pass integ real group subroutin check inputrec definit srcgromacsmdtypesinputrech remov featur featur remov gromac old refmdp reftpr file mistakenli misus still pars option refgmx grompp refgmx mdrun issu fatal error set mdp adress mdp implicitsolv _refer manual gmxmanualparentdir_ known issu affect user gromac _gmxusersknownissu nonexhaust list issu awar affect regular user gromac unabl compil cuda due bug nvcc compil current possibl compil nvidia gpuenabl gromac version cuda compil recommend use cuda earlier compil fix releas issu gmxapi python interfac gromac gmxapi provid python access gromac molecular simul tool oper connect flexibl allow high perform simul analysi complex control data flow user defin new oper c python tool kit use implement packag python packag requir compat gromac instal api librari header see httpgmxapiorg detail instal usag