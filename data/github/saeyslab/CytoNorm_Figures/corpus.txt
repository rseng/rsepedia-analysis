cytonorm_figur script replic figur report cytonorm public titl r notebook output html_notebook load requir librari r suppresspackagestartupmessageslibraryflowcor suppresspackagestartupmessageslibraryflowworkspac choos file interest r dir datagates_extracontrol wsp_file manualwsp fcs_file listfilesdir patterngates_pfc choos gate interest final cell label r cell_typ cnaiv cd cell cd cellscdra naiv cell memori cd cell cd cellscdra mem cell tcrgd cell tcrgd cell naiv cd cell cd cellscdra naiv cell memori cd cell cd cellscdra mem cell nk cell cdcdnkcell b cell b cell monocyt lincdcdbcdmc pdc pdc cdcd cdcd pars flowjo workspac r wsp flowworkspaceopenworkspacefilepathdir wsp_file captureoutput gate suppressmessagesflowworkspaceparseworkspacewsp sampl sampnloc samplenod files_in_wsp gatesdataorigsamplevector count asnumericgsub_ files_in_wsp extract manual gate everi file r result list forfil fcs_file printpasteprocess file file_id grepgsub file files_in_wsp iflengthfile_id stopfil found file avail gsub_ n files_in_wsp build matrix truefals valu everi cell gate combin gate_nam flowworkspacegetnodesgatesfile_id path auto gating_matrix matrixfals nrow countsfile_id ncol lengthgate_nam dimnam listnul gate_nam gate gate_nam gating_matrix gate flowworkspacegetindicematgatesfile_id gate build one vector individu label everi cell manual_vector repunknownnrowgating_matrix forcell_typ cell_typ manual_vectorgating_matrixcell_typ cell_typ manual_vector factormanual_vector levelscunknowncell_typ renam prettier name flowjo workspac levelsmanual_vector cunknown namescell_typ col_id sapplycell_typ functionx whichcolnamesgating_matrix x colnamesgating_matrixcol_id namescell_typ resultfil listmatrix gating_matrix manual manual_vector save result later use r saverdsresult datagates_extracontrolsmanualrd r sessioninfo titl r notebook output html_notebook tsne comparison r suppresspackagestartupmessageslibrarytidyvers suppresspackagestartupmessageslibraryflowcor suppresspackagestartupmessageslibraryflowsom suppresspackagestartupmessageslibrarycytonorm suppresspackagestartupmessageslibraryflowworkspac suppresspackagestartupmessageslibrarycytoml r dir ddataongoingstanforddatagates_extracontrol file listfilesdir patterngates_pfc df dataframefil file plate asfactorstr_matchfil ptlg stim asfactorstr_matchfil __control volunt asfactorstr_matchfil _ stringsasfactor fals rownamesdf dffile df df dplyrfilterstim unstim volunt df r setse data listorigin aggregateflowframesfilepathdir dffile normal aggregateflowfram filepathresults_cytonormdatacluster_quantilenormlimited_unstim_and_ifna_lps_ pastenorm_ dffile r cols_of_interest c r data lapplydata functiondtransformd transformlistcolnamesdcols_of_interest cytoftransform r setse dim_r list ford namesdata dim_redd rtsnertsnedatadexpr cols_of_interest perplex r figwidth setse rand_ord samplenrowdataorigin plot list ford namesdata plotsd ggplotdataframex dim_reddyrand_ord dim_reddyrand_ord file factordatadexprsrand_orderfil geom_pointaesx color file size xlabtsn ylabtsn theme_minim ggtitl themelegendposit none p docallgridextragridarrang cplot listncol ggsaveresults_cytonormtsne_before_afterpdf p width height titl r notebook output html_notebook instal librari yet previous instal remov hash sign actual run line r installpackagestidyvers installpackagesgridextra installpackagespheatmap installpackagesbiocmanag biocmanagerinstallflowcor installpackagesdevtool devtoolsinstall_githubsaeyslabflowsom devtoolsinstall_githubsaeyslabcytonorm setup load requir librari r suppresspackagestartupmessageslibrarytidyvers suppresspackagestartupmessageslibrarygridextra suppresspackagestartupmessageslibrarypheatmap suppresspackagestartupmessageslibraryflowcor suppresspackagestartupmessageslibraryflowsom suppresspackagestartupmessageslibrarycytonorm directori save result r result results_cytonorm direxistsresult dircreateresult set path data file extract metadata filenam file download flow repositori dataset frfcmz r dir ddataongoingstanforddatagates_extracontrol file listfilesdir patterngates_pcontrolfc sampl dataframefil file plate asfactorstr_matchfil ptlg stim asfactorstr_matchfil __control volunt asfactorstr_matchfil _ stringsasfactor fals rownamessampl samplesfil sampl read marker name first file identifi marker interest order alphabet surfac marker first r captureoutputff readfcsfilepathdir samplesfil marker_nam get_markersff colnamesff norm_id c norm_channel colnamesffnorm_id norm_mark marker_namesnorm_id transformlist transformlistnorm_channel cytoftransform transformlistrevers transformlistnorm_channel cytoftransformrevers printnorm_mark load manual map data see extractmanualgating_cytonormr file gener rd file download flowrepositori r manual readrdsddataongoingstanforddatagates_extracontrolsmanualrd cell_typ call levelsmanualmanu printcell_typ character batch effect densiti overview r function use global variabl use notebook getdensities_plot functiondens marker densiti lapplydens functionx xfile gsubnorm_ gsub xfile xbatch samplesxfil plate xvolunteer_stim pastesamplesxfil volunt _ samplesxfil stim xvolunteer_stim factorxvolunteer_stim level c_unstim _ifna_lp _unstim _ifna_lp x plot list formark marker p ggplotdplyrfilterdensitiesquantil channel flowsomget_channelsff marker geom_vlineaesxintercept col grey linetypedash geom_vlineaesxintercept col grey geom_vlineaesxintercept col b lwd geom_vlineaesxintercept col grey geom_vlineaesxintercept col grey linetypedash geom_lineaesx x data dplyrfilterdensitiesdens channel flowsomget_channelsff marker facet_gridbatch volunteer_stim switchi ggtitlepastemark express xlabcontrol valid sampl includ everi plate ylabdiffer plate xlimc theme_minim themeaxistexti element_blank striptexti element_textangl plotsmark p returnplot r res_fil filepathresult densities_originalrd iffileexistsres_fil densiti getdensitiesfil filepathdir samplesfil channel norm_channel transformlist transformlist quantilevalu c saverdsdens res_fil els densiti readrdsres_fil r marker ccd cd plot getdensities_plotdens marker ccd cd p docallgridextragridarrang cplot listnrow ggsavep filenam filepathresult pastedensity_original_ pastemark collaps _pdf width height r correl matrixna nrow ncol lengthnorm_mark dimnam listcunstim ifna_lp norm_mark forchannel norm_channel subset densitiesquantil dplyrfilterchannel channel sample_typ str_matchsubsetfil ptlg_fc median subset correlationsunstim marker_nameschannel cormedianssample_typ unstim_control_ medianssample_typ unstim_control_ correlationsifna_lp marker_nameschannel cormedianssample_typ ifna_lps_control_ medianssample_typ ifna_lps_control_ applycorrel mean applycorrel sd cell type specif densiti r figwidth figheight cell_types_to_plot cb cell monocyt marker hladr res_fil filepathresult pastedensities_original_ pastecell_types_to_plot collaps _ rd fileexistsres_fil densities_select list cell_typ cell_types_to_plot cell_type_select lapplymanu functionx xmatrix cell_typ namescell_type_select filepathdir namescell_type_select densities_selectedcell_typ getdensitiesfil filepathdir samplesfil channel norm_channel transformlist transformlist quantilevalu c select cell_type_select saverdsdensities_select res_fil els densities_select readrdsres_fil r plot list forcell_typ cell_types_to_plot p getdensities_plotdensities_selectedcell_typ marker ggtitlepastemark express cell_typ xlimc plotscell_typ p p docallgridextragridarrang cplot listnrow ggsavep filenam filepathresult pastedensity_original_ marker _ pastecell_types_to_plot collaps _ pdf width height bc densiti review r bc_channel colnamesffgrepbc get_markersff colnamesff densities_bc getdensitiesfil filepathdir samplesfil channel bc_channel transformlist transformlistbc_channel cytoftransform quantilevalu c plot getdensities_plotdensities_bc marker get_markersff bc_channel p docallgridextragridarrang cplot listnrow ggsavep filenam filepathresult pastedensity_original_ pasteget_markersff bc_channel collaps _ pdf width height titl r notebook output html_notebook tsne comparison r suppresspackagestartupmessageslibrarytidyvers suppresspackagestartupmessageslibraryflowcor suppresspackagestartupmessageslibraryflowsom suppresspackagestartupmessageslibrarycytonorm suppresspackagestartupmessageslibraryflowworkspac suppresspackagestartupmessageslibrarycytoml r setse data_agg listorigin aggregateflowframesvalidation_datafil normal aggregateflowfram filepathnorm_dir pastenorm_ gsub validation_datafil ctotal r cols_of_interest c r data_agg_t lapplydata_agg functiondtransformd transformlistcolnamesdcols_of_interest cytoftransform r setse dim_r list ford namesdata_agg dim_redd rtsnertsnedata_aggdexpr cols_of_interest perplex r figwidth setse rand_ord samplenrowdata_aggorigin plot list ford namesdata_agg plotsd ggplotdataframex dim_reddyrand_ord dim_reddyrand_ord file factordata_aggdexprsrand_orderfil geom_pointaesx color file size theme_minim ggtitl themelegendposit none p docallgridextragridarrang cplot listncol ggsavefilepathresult tsne_patients_before_afterpdf p width height titl r notebook output html_notebook r suppresspackagestartupmessageslibrarytidyvers suppresspackagestartupmessageslibraryflowcor suppresspackagestartupmessageslibraryflowstat r result validation_gatesgaussnorm ifdirexistsresult dircreateresult recurs true norm_dir filepathresult normal ifdirexistsnorm_dir dircreatenorm_dir file clistfilesdatag pattern ptlgunstimfc fullnam true listfilesdatagates_extracontrol pattern ptlgunstimfc fullnam true file greppast cptlg ptlg ptlg ptlg ptlg _bu collaps file invert true valu true file grepunstim_control_ file invert true valu true df dataframefil file plate asfactorstr_matchfil ptlg timepoint asfactorgsubunstim control str_matchfil ptlg_repeat___ stringsasfactor fals rownamesdf dffile repeat_ctrl_fil datagatesgates_ptlg__repeats_unstim_controlfc dfrepeat_ctrl_fil cplatetimepoint cptlg control headdf r train_data df dplyrfiltertimepoint control captureoutputff readfcsfilepathtrain_datafil norm_mark c channel colnamesffnorm_mark transformlist transformlistcolnamesffnorm_mark cytoftransform transformlistrevers transformlistcolnamesffnorm_mark cytoftransformrevers train landmark first control file refer r ff readfcstrain_data dplyrfilterpl ptlg dplyrpullfil ff transformff transformlist rembflowset flowstatsremboundaryflowset flowsetff channelnam channel maxlm rep lengthchannel namesmaxlm channel lm flowstatsextractlandmarksflowset rembflowsetr exprlist channelnam channel maxlm maxlm peakdensitythr peakdistancethr baselm flowstatsextractbaselandmarkslmsfilt channel maxlm r validation_data df dplyrfiltertimepoint control validation_datacohort stringrstr_matchvalidation_datafil gate rownamesvalidation_data gsub validation_datafil validation_dataplatevalidation_datapl ptlg ptlg r fori seq_lennrowvalidation_data file validation_datafilei ff readfcsfil ff transformff transformlist gauss_r gaussnormflowset flowsetff channelnam channel baselm baselm ff_n gauss_resflowset ff_n transformff_n transformlistrevers writefcsff_n filenam filepathnorm_dir pastenorm_ gsub file titl r notebook output html_notebook notebook assum run setup part _data_exploration_of_control_and_validation_samplesrmd first make use variabl creat notebook evalu flowsom cluster r train_fil sampl dplyrfiltervolunt dplyrfilterstim unstim dplyrpullfil r res_fil filepathresult prepareflowsomrd fileexistsres_fil fsom prepareflowsomfilepathdir train_fil norm_channel ncell flowsomparam listxdim ydim nclu scale fals transformlist transformlist plot true seed saverdsfsom filepathresult prepareflowsomrd els fsom readrdsres_fil r test differ amount metaclust pdffilepathresult cv_testpdf width height cv_test testcvfsom cluster_valu plot true verbos true devoff cv_testcv run normal sampl cytonorm normal experi setup r flowsomparam listncel xdim ydim nclu scale fals normparam listquantilenormlimit listnq limit c goal ptlg quantilenorm listnq goal ptlg minmaxnorm listnq quantile_valu c goal ptlg qminmaxnorm listnq quantile_valu c goal ptlg exp_setup expandgridclust ccluster norm namesnormparam stim cunstim_and_ifna_lp volunt c rownamesexp_setup gsub_ applyexp_setup past collaps _ exp_setup setup test control sampl differ rang r flowsomparam listncel xdim ydim nclu scale fals normparam listquantilenormlimit listnq limit c goal ptlg exp_setup expandgridclust ccluster norm namesnormparam stim cunstim_and_ifna_lp unstim ifna_lp volunt c rownamesexp_setup gsub_ applyexp_setup past collaps _ exp_setup train r ifdirexistsfilepathresult model dircreatefilepathresult model iffileexistsfilepathresult model timesrd time readrdsfilepathresult model timesrd els time list forexp rownamesexp_setup ifdirexistsfilepathresult model exp dircreatefilepathresult model exp printpastetrain exp train_data sampl dplyrfiltervolunt exp_setupsexp volunt dplyrfiltergreplgsub_and_ exp_setupsexp stim stim ifexp_setupsexp cluster cluster systemtimecaptureoutput model cytonormtrainfil filepathdir train_datafil label train_datapl channel norm_channel transformlist transformlist flowsomparam flowsomparam normmethodtrain quantilenormtrain normparam normparamsexp_setupsexp norm seed outputdir filepathresult model exp plot true els systemtimecaptureoutput model docallquantilenormtrain clistfil filepathdir train_datafil label train_datapl channel norm_channel transformlist transformlist plot true normparamsexp_setupsexp norm printt timesexp saverdstim file filepathresult model timesrd saverdsmodel file filepathresult model exp gatesextracontrols_modelrd normal r dircreatefilepathresult data forexp rownamesexp_setup dircreatefilepathresult data exp printpastenorm exp model readrdsfilepathresult model exp gatesextracontrols_modelrd test_data sampl dplyrfiltervolunt exp_setupsexp volunt ifexp_setupsexp cluster cluster systemtimecaptureoutput cytonormnormalizemodel model file filepathdir test_datafil label test_datapl transformlist transformlist transformlistrevers transformlistrevers outputdir filepathresult data exp normmethodnorm quantilenormnorm els systemtimecaptureoutput quantilenormnormalizemodel model file filepathdir test_datafil label test_datapl transformlist transformlist transformlistrevers transformlistrevers outputdir filepathresult data exp printt r emd list forvolunt c forstim cunstim ifna_lp printpasteevalu origin toevalu sampl dplyrfiltervolunt volunt dplyrfilterstim stim captureoutput emdspasteoriginal_ volunt _ stim emdevaluationfilepathdir toevaluatefil transformlist transformlist manual lapplymanu functionxxmanu channel norm_channel exp rownamesexp_setup forstim cunstim ifna_lp printpasteevalu exp toevalu sampl dplyrfiltervolunt exp_setupsexp volunt dplyrfilterstim stim captureoutput emdspasteexp _ stim emdevaluationfilepathresult data exp pastenorm_ toevaluatefil transformlist transformlist manual lapplymanu functionxxmanu channel norm_channel saverdsemd file filepathresult pasteemds_diff_methodsrd r emd readrdsfilepathresult emds_diff_methodsrd emds_g lapplynamesemd functionst col_nam pasteemd_st gatherdataframepopul rownamesemdsst emdsstat channel col_nam popul magrittrset_colnamescpopul channel col_nam magrittrset_namesnamesemd emds_g cbindemds_gc docallcbind lapplyemds_g functionx x rownamesemds_g pasteemds_g _ get_markersff emds_g reduct list forexp colnamesemds_gc exp_origin gsub_ original_ exp affect emds_gexp emds_g exp_origin reductionexp dataframepopulation_mark rownamesemds_gaffect reduct emds_gexp_origin emds_gexp emds_gexp_originalaffect exp exp method gsub_ exp subset gsub_ exp reduct docallrbind reduct reduction_overal cbindmean tapplyreductionreduct reductionmethod mean sd tapplyreductionreduct reductionmethod sd volunt c stim cunstim ifna_lp forf cmean sd subset reduct dplyrfiltersubset pastevolunt _ stim reduction_subset tapplysubsetreduct subsetmethod evalparsetext f reduction_overal cbindreduction_overal matrixreduction_subset dimnam listnamesreduction_subset pastevolunt _ stim _ f printreduction_overal pasteroundreduction_overal grepmeancolnamesreduction_overal roundreduction_overal grepsdcolnamesreduction_overal pheatmappheatmapreduction_overal grep_mean colnamesreduction_overal cluster_row fals cluster_col fals display_numb true number_color white r fore uniquereductionexp subset reduct dplyrfilterexp e plotdensitysubsetreduct main e r volunt c stim cunstim ifna_lp subset reduct dplyrfiltersubset pastevolunt _ stim reduction_subset tapplysubsetreduct subsetmethod evalparsetext f reduction_overal cbindreduction_overal matrixreduction_subset dimnam listnamesreduction_subset pastevolunt _ stim _ f r plot_emd functionexp_ exp_ emds_g titl null subtitl null emds_gaffect repposit nrowemds_g emds_gaffectedemds_gexp_ emds_gexp_ neg emds_gaffectedemds_gexp_ emds_gexp_ ifisnulltitl method stringrstr_matchexp_ _ subset stringrstr_matchexp_ _ titl averag chang subtitl pasteroundreduction_overallmethod pastesubset_mean roundreduction_overallmethod pastesubset_sd p ggplotemds_g geom_pointaes_stringx exp_ exp_ col affect geom_rectdata dataframexmin xmax ymin ymax aesxmin xmin xmax xmax ymin ymin ymax ymax fill alpha scale_x_continuouslimit c scale_y_continuouslimit c scale_color_manualvalu cno grey posit black neg b ggplotgeom_ablinelwd coord_fix ggtitletitl subtitl theme_minim themeplotsubtitl element_texthjust legendposit none emds_gaffect null returnp r plot list test cunstim ifna_lp model cunstim_and_ifna_lp unstim ifna_lp plotspastemodel_test plot_emdspastecluster_quantilenormlimited_ model __ test original__unstim emds_g xlabemd normal ylabemd normal ggtitlepastetrain gsub_and_ model subtitl pastevalid test themeplottitl element_texts plotsubtitl element_texts p docallgridarrang cplot listnrow ggsavefilepathresult emd_unstim_vs_ifna_lpspdf p width height p r plot_titl cccluster_quantilenormlimit cluster quantil quantilenormlimit quantil cluster_qminmaxnorm cluster quantil qminmaxnorm quantil plot list volunt c test cunstim ifna_lp formethod ccluster_quantilenormlimit quantilenormlimit cluster_qminmaxnorm qminmaxnorm plotspastemethod_volunteer_test plot_emdspastemethod _unstim_and_ifna_lps_ volunt _ test pasteoriginal_volunteer_ test emds_g xlabemd normal ylabemd normal ggtitleplot_titlesmethod subtitl pastevalid donor volunt test themeplottitl element_texts plotsubtitl element_texts p docallgridarrang cplot listnrow ggsavefilepathresult emd_methodspdf p width height titl r notebook output html_notebook valid r suppresspackagestartupmessageslibrarytidyvers suppresspackagestartupmessageslibraryflowcor suppresspackagestartupmessageslibrarycytonorm suppresspackagestartupmessageslibraryflowworkspac suppresspackagestartupmessageslibrarycytoml r result results_cytonormvalidation_pregn ifdirexistsresult dircreateresult recurs true norm_dir filepathresult normal ifdirexistsnorm_dir dircreatenorm_dir file clistfilesddataongoingstanforddatag pattern ptlgunstimfc fullnam true listfilesddataongoingstanforddatagates_extracontrol pattern ptlgunstimfc fullnam true file greppast cptlg ptlg ptlg ptlg ptlg _bu collaps file invert true valu true file grepunstim_control_ file invert true valu true df dataframefil file plate asfactorstr_matchfil ptlg timepoint asfactorgsubunstim control str_matchfil ptlg_repeat___ stringsasfactor fals rownamesdf dffile repeat_ctrl_fil ddataongoingstanforddatagatesgates_ptlg__repeats_unstim_controlfc dfrepeat_ctrl_fil cplatetimepoint cptlg control headdf r train_data df dplyrfiltertimepoint control captureoutputff readfcsfilepathtrain_datafil norm_mark c transformlist transformlistcolnamesffnorm_mark cytoftransform transformlistrevers transformlistcolnamesffnorm_mark cytoftransformrevers r model cytonormtrainfil train_datafil label train_datapl channel colnamesffnorm_mark transformlist transformlist outputdir result flowsomparam listncel xdim ydim nclu scale fals normmethodtrain quantilenormtrain normparam listnq goal ptlg limit c seed plot true verbos true saverdsmodel filepathresult cytonorm_model_rd r fsom readrdsfilepathresultscytonorm_flowsomrd pdffilepathresult cv_testpdf cv_test testcvfsom cluster_valu c devoff saverdscv_test filepathresult cv_testrd r validation_data df dplyrfiltertimepoint control validation_datacohort stringrstr_matchvalidation_datafil gate rownamesvalidation_data gsub validation_datafil validation_dataplatevalidation_datapl ptlg ptlg r cytonormnormalizemodel model file validation_datafil label validation_datapl transformlist transformlist transformlistrevers transformlistrevers outputdir norm_dir prefix norm_ verbos true normmethodnorm quantilenormnorm r freq_to_extract cbcell bcell cdtcell cdtcell cdtcells_mem cd mem cell cdtcells_naiv cd naiv cell cdnkcell cdnkcell cdtcell cdatcel cdtcells_mem cd mem cell cdtcells_naiv cd naiv cell tcrgdtcell tcrgdtcell cmc cmc mdc mdc pdc pdc mfis_to_extract ccreb erk ikb mapkapk nfkb p stat stat stat mfis_feature_nam applyexpandgridnamesfreq_to_extract mfis_to_extract unstim past collaps _ r freq_fil filepathresult validation_data_frequenciesrd fileexistsfreq_fil frequenc lapplylistorigin origin normal normal gaussnorm gaussnorm adapt adapt functionxmatrixna nrow nrowvalidation_data ncol lengthfreq_to_extract dimnam listrownamesvalidation_data namesfreq_to_extract mfi lapplylistorigin origin normal normal gaussnorm gaussnorm adapt adapt functionxmatrixna nrow nrowvalidation_data ncol lengthfreq_to_extract lengthmfis_to_extract dimnam listrownamesvalidation_data mfis_feature_nam forfil rownamesvalidation_data printfil file_path validation_datafil file file_vers listorigin file_path normal filepathnorm_dir pastenorm_ gsub file_path gaussnorm filepathvalidation_gatesgaussnormnorm pastenorm_ gsub file_path forvers namesfile_vers fcs_path file_versionsvers captureoutput gate suppressmessag cytonormapplystaticgatingfilepathresultsgates_ptlg_unstim_controlwsp fcs_path freqs_tmp colsumsg freqs_tmp freqs_tmp freqs_tmpcdcd frequenciesversionfil namesfreq_to_extract freqs_tmpfreq_to_extract ff transformreadfcsfcs_path transformlist forpop namesfreq_to_extract select gate freq_to_extractpop ifsumselect mfis_tmp applyffexprsselect flowsomget_channelsff mfis_to_extract drop fals median mfisversionfil pastepop mfis_to_extract unstim sep _ mfis_tmp saverdsfrequ freq_fil saverdsmfi gsubfrequ mfi freq_fil els frequenc readrdsfreq_fil mfi readrdsgsubfrequ mfi freq_fil r validation_data readrdsfilepathresult validation_datard loadcuserssofievgdownloadsdata_origrda rownamesvalidation_data gsub_repeat rownamesvalidation_data frequenc lapplyfrequ functionx rownamesx gsub_repeat rownamesx x mfi lapplymfi functionx rownamesx gsub_repeat rownamesx x r validation_dataweek na validation_dataadaptedvalu na files_meta_ord pastegates_ featurepati _ namesfeaturetim _unstimfc validation_datafiles_meta_ord week featureweek frequenciesadaptedfiles_meta_ord namesfreq_to_extract freqfeatur namesfreq_to_extract mfisadaptedfiles_meta_ord mfis_feature_nam mfifeatur mfis_feature_nam files_meta_ord pastegates_ vfeaturepati _ namesvfeaturetim _unstimfc validation_datafiles_meta_ord week vfeatureweek frequenciesadaptedfiles_meta_ord namesfreq_to_extract vfreqfeatur namesfreq_to_extract mfisadaptedfiles_meta_ord mfis_feature_nam vmfifeatur mfis_feature_nam validation_datatimepoint factorvalidation_datatimepoint level ccontrol bl levelsvalidation_datatimepoint ccontrol stntrimest ndntrimest rdntrimest postnpartum r figwidth figheight plot_titl corigin origin fc file gaussnorm gaussnorm normal cytonorm adapt manual adapt gate plot list fortyp corigin gaussnorm normal adapt p ggplotdataframevalidation_data frequenciestyp mfistyp checknam fals geom_boxplotaesx timepoint cdtcells_naive_stat_unstim geom_jitteraesx timepoint cdtcells_naive_stat_unstim col cohort width height ggtitleplot_titlestyp ylabstat mfi cd naiv cell ylimc theme_minim themelegendposit none plotslengthplot p p_mfi docallgridextragridarrang cplot listnrow ggsaveplot p_mfi filenam filepathresult validation_cdtcells_naive_stat_unstimpdf width height r plot list fortyp corigin gaussnorm normal adapt p ggplotdataframevalidation_data frequenciestyp mfistyp checknam fals geom_boxplotaesx timepoint cdtcells_naiv geom_jitteraesx timepoint cdtcells_naiv col cohort width height ggtitleplot_titlestyp ylabcd naiv cell frequenc ylimc theme_minim themelegendposit none plotslengthplot p p docallgridextragridarrang cplot listnrow ggsaveplot p filenam filepathresult validation_cdtcells_naive_unstimpdf width height r figheight figwidth plot list fortyp corigin gaussnorm normal adapt p ggplotdataframevalidation_data frequenciestyp mfistyp checknam fals dplyrfiltertimepoint cstntrimest ndntrimest rdntrimest geom_pointaes_stringx week cdtcells_naive_stat_unstim color plate geom_lineaes_stringx week cdtcells_naive_stat_unstim group plate color plate ggtitleplot_titlestyp ylim theme_minim themelegendposit none plotslengthplot p docallgridextragridarrang cplot listnrow r figwidth frequencies_longformat lapplynamesfrequ functiontyp freq frequenciestyp gatherdataframefil rownamesfreq cohort validation_datarownamesfreq cohort freq key popul valu pastefrequency_ type file cohort frequencies_longformat frequencies_longformat left_joinfrequencies_longformat cfile cohort popul left_joinfrequencies_longformat cfile cohort popul left_joinfrequencies_longformat cfile cohort popul plot list fortyp corigin gaussnorm normal plotspastetyp _cohort ggplotfrequencies_longformat geom_pointaes_stringx frequency_adapt pastefrequency_ type col cohort ggtitleplot_titlestyp xlabfrequ manual adapt gate ylabfrequ static gate theme_minim themelegendposit none p_freq docallgridextragridarrang cplot listnrow ggsavep_freq filenam filepathresultsfrequenciespdf width height r ggsaveplot docallgridextragridarrang listp_freq p_mfi filenam filepathresult figurepdf width height r fortyp corigin gaussnorm normal p ggplotfrequencies_longformat dplyrfilterpopul cdtcells_naive_stat_unstim geom_pointaes_stringx frequency_adapt pastefrequency_ type col popul theme_minim printp