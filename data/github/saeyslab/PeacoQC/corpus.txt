peacoqc peakbas select high qualiti cytometri data introduct peacoqc packag provid qualiti control function check monoton increas channel remov outlier unstabl event introduc due eg clog speed chang etc measur sampl also provid function visualis qualiti control result one sampl visualis result multipl sampl one experi instal instal packag use devtool librari r biocmanagerinstallcomplexheatmap devtoolsinstall_githubsaeyslabpeacoqc titl peacoqc author ann emmaneel packag peacoqc output biocstylehtml_docu vignett vignetteindexentrypeacoqc_vignett vignetteengineknitrrmarkdown vignetteencodingutf r includefals knitropts_chunkset collapsetru comment introduct peacoqc packag provid qualiti control function check monoton increas channel remov outlier unstabl event introduc due eg clog speed chang etc measur sampl also provid function visualis qualiti control result one sampl visualis result multipl sampl one experi instal peacoqc r setup installpackagesdevtool devtoolsinstall_githubhttpsgithubcomsaeyslabpeacoqc librarypeacoqc warn pleas awar fact vignett creat directori current work directori sinc packag meant run multipl file figur directli creat directori pleas check folder correspond output_directori variabl call chunck code standard preprocess qualiti control pipelin follow pipelin recommend use preprocess data pipelin start flowfram flow cytometri mass cytometri data first remov margin compens transform end peacoqc qualiti control give back list clean flowfram differ paramet set also save flowfram new fc file make plot qualiti control sampl note remov margin function compens necessari mass cytometri data explain code exampl r warningfals figshowhid specifi flowfram path read flowfram filenam systemfileextdata fc packagepeacoqc ff flowcorereadfcsfilenam determin channel qualiti control done channel c remov margin make sure compens sinc intern paramet chang neccessari removemargin function possibl specifi intern paramet channel_specif paramet ff removemarginsffff channelschannel outputfram compens transform data ff flowcorecompensateff flowcorekeywordffspil ff flowcoretransformff flowcoreestimatelogicleff colnamesflowcorekeywordffspil run peacoqc save clean flowfram fc file plot result qualiti control step peacoqc_r peacoqc ffff channelschannel determine_good_cellsal save_fcstru plottru output_directori peacoqc_exampl filter flowfram store peacoqc_resfinalff use analysi ff peacoqc_resfinalff mass cytometri data want clean mass cytometri data file alter paramet paramet remove_zero set true it_limit rang sinc channel spars flow cytometri result time_unit paramet plot function also alter sinc mass cytometri data typic measur longer time flow cytometri data play bit paramet dont see picketfenc effect anymor event rate plot top left overview note chunck code excecut result appear work directori exampl work mass cytometri data r eval fals exampl code could look mass cytometri data ff readfcsfil dont remov margin event compens data transform channel c ff transformfftransformlistcolnamesffchannel arcsinhtransforma b c make sure paramet set correctli remove_zero variabl set true peacoqc_result peacoqcff channelschannel it_limit remove_zerostru time_unit larg dataset larg dataset want run preprocess pipelin multipl file recommend run first coupl file tweak paramet dataset inlcud channel spars pattern eg mass data it_limit probabl increas order strict seem mad paramet remov much also increas make peacoqc less strict run file paramet chose r warningfals chang it_limit one compens transform file highermor strict lowerless strict fc file save sinc still optimis paramet filenam systemfileextdata fc packagepeacoqc ff flowcorereadfcsfilenam determin channel qualiti control done channel c remov margin ff removemarginsffff channelschannel outputfram compens transform data ff flowcorecompensateff flowcorekeywordffspil ff flowcoretransformff flowcoreestimatelogicleff colnamesflowcorekeywordffspil run peacoqc save clean flowfram fc file plot result qualiti control step peacoqc_r peacoqc ffff channelschannel determine_good_cellsal save_fcsfals plottru output_directori peacoqc_exampl it_limit note next chunck code gener result r eval fals also chang mad paramet lower valu make strict higher valu make less strict sinc mad analysi remov someth neccesari peacoqc_r peacoqc ff channel determine_good_cellsal save_fcsfals plottru mad correct paramet chosen run differ file loop file file ff flowcorereadfcsfil remov margin ff removemarginsffff channelschannel outputfram compens transform data ff flowcorecompensateff flowcorekeywordffspil ff flowcoretransformff flowcoreestimatelogicleff colnamesflowcorekeywordffspil peacoqc_r peacoqc ff channel determine_good_cellsal it_limit save_fcst plott peacoqcheatmap order get overview much qualiti control remov peacoqcheatmap allow visualis represent differ condit differ percentag remov differ run r find path report creat use peacoqc function locat systemfileextdata peacoqc_reporttxt packagepeacoqc make heatmap overview qualiti control run peacoqcheatmapreport_locationloc make heatmap run last test peacoqcheatmapreport_locationloc latest_teststru make heatmap row annot peacoqcheatmapreport_locationloc row_splitcrepr repr plotpeacoqc without qualiti control plotpeacoqc function also use display peak differ channel without qualiti control even use display measur result appear peacoqc_plot folder r warningfals figshow hide load compens transform flowfram filenam systemfileextdata _comp_transfc packagepeacoqc ff flowcorereadfcsfilenam plot peak qualiti control plotpeacoqcff channel display_peakstru prefix peacoqc_peaks_ plot dot file plotpeacoqcff channel display_peaksfals prefix peacoqc_nopeaks_ gener roxygen edit hand pleas edit document rpeacoqcr nameremovedoublet aliasremovedoublet titleremov doublet event flow cytometri data usag removedoubletsff channelfsca channelfsch nmad verbosefals outputfram argument itemffa flowfram contain flow cytometri data itemchannelth first channel use determin doublet event default fsca itemchannelth second channel use determin doublet event default fsch itemnmadbandwidth ratio allow cell kept ratio smaller median ratio codenmad time median absolut deviat ratio default itemverboseif set true median ratio width print default fals itemoutputif set full list filter flowfram indic doublet event return set frame filter flowfram return default frame valu function return either filter flowfram codeoutput paramet set frame list contain filter flowfram truefals list indic margin event extra column name original_id ad flowfram cell given origin cell id descript coderemovedoublet remov doublet event flowfram base two channel exampl read data filenam systemfileextdata fc packagepeacoqc ff flowcorereadfcsfilenam remov doublet ff_clean removedoubletsff gener roxygen edit hand pleas edit document rpeacoqcr nameplotpeacoqc aliasplotpeacoqc titlevisualis delet cell peacoqc usag plotpeacoqcff channel output_directori display_cel manual_cellsnul title_frnul display_peakstru prefixpeacoqc_ time_unit argument itemffa flowfram itemchannelsindic name channel flowfram display itemoutput_directorydirectori plot gener set null plot need gener default work directori itemdisplay_cellsth number measur display number dot display everi channel default itemmanual_cellsg vector truefals annot cell compar autom qc default null itemtitle_frth titl display flow rate figur default null itemdisplay_peaksif result codepeacoqc given qualiti control result visualis set true codepeacoqc run peak display without qualiti control set fals peak display event display default true itemprefixth prefix given gener png file default peacoqc_ itemtime_unitth number time unit group togeth visualis event rate default set result event per second flow dataset suggest adapt mass cytometri data itemargu given codepeacoqc codedisplay_peak set true valu function return noth gener png file output_directori descript codeplotpeacoqc gener png file overview flow rate differ select channel annot base measur remov peacoqc also possibl display quantil median measur without annot exampl plot result peacoqc read transform compens data filenam systemfileextdata _comp_transfc packagepeacoqc ff flowcorereadfcsfilenam defin channel qualiti control done plot made channel c run peacoqc peacoqc_r peacoqcff channel determine_good_cellsal plotfals save_fcstru run plotpeacoqc plotpeacoqcff channel display_peakspeacoqc_r plot peak qualiti control plotpeacoqcff channel display_peakstru plot dot file plotpeacoqcff channel display_peaksfals gener roxygen edit hand pleas edit document rpeacoqcr nameremovemargin aliasremovemargin titleremov margin event flow cytometri data usag removemarginsff channel channel_specificationsnul outputfram argument itemffa flowfram contain flow cytometri data itemchannelsth channel indic channel name check margin event itemchannel_specificationsa list list paramet specif certain channel paramet use valu intern paramet descript strict wrong number channel one list per channel first minrang maxrang valu list channel name found back codecolnamesflowcoreexprsff channel list paramet default intern valu use default paramet null itemoutputif set full list filter flowfram indic margin event return set frame filter flowfram return default frame valu function return either filter flowfram codeoutput paramet set frame list contain filter flowfram truefals list indic margin event extra column name original_id ad flowfram cell given origin cell id descript coderemovemargin remov margin event flowfram base intern descript fc file exampl read raw data filenam systemfileextdata fc packagepeacoqc ff flowcorereadfcsfilenam defin channel margin event remov channel c remov margin ff_clean removemarginsff channel intern valu wrong channel eg fsca channel_specif listfscac ff_clean removemargin ff channel channel_specificationschannel_specif gener roxygen edit hand pleas edit document rpeacoqcr namepeacoqcheatmap aliaspeacoqcheatmap titlemak overview heatmap qualiti control analysi usag peacoqcheatmapreport_loc show_valuestru show_row_namestru latest_testsfals titlepeacoqc report argument itemreport_locationth path peacoqc report gener codepeacoqc itemshow_valuesif set true percentag remov valu display heatmap default true itemshow_row_namesif set fals filenam display heatmap default true itemlatest_testsif set true latest qualiti control run display heatmap default fals itemtitleth titl given heatmap default peacoqc_report itemextra paramet given codeheatmap function eg row_split valu function return noth gener heatmap save pdf png descript codepeacoqcheatmap make heatmap display result gener codepeacoqc includ percentag measur remov total method mad method also show paramet use qualiti control exampl find path peacoqc report locat systemfileextdata peacoqc_reporttxt packagepeacoqc make heatmap overview qualiti control run peacoqcheatmapreport_locationloc make heatmap run last test peacoqcheatmapreport_locationloc latest_teststru make heatmap row annot peacoqcheatmapreport_locationloc row_splitcrepr repr gener roxygen edit hand pleas edit document rpeacoqcr namepeacoqc aliaspeacoqc titlepeakbas detect high qualiti cytometri data usag peacoqcff channel determine_good_cellsal plot save_fcstru output_directori name_directorypeacoqc_result reporttru events_per_binfindeventsperbinremove_zero ff channel min_cel max_bin step min_cel max_bin step mad it_limit consecutive_bin remove_zerosfals suffix_fcs_qc force_it peak_remov min_nr_bins_peakdetect argument itemffa flowfram locat fc file make sure flowfram compens transform mass cytometri data transform necessari itemchannelsindic name channel flowfram peak determin itemdetermine_good_cellsif set fals algorithm determin peak set bad measur filter base mad analysi also put mad use one method filter itemplotwhen peacoqc remov specifi percentag overview plot made select channel delet measur set true codeplotpeacoqc function run make overview plot delet measur even noth remov default set increas decreas trend found figur also made except plot set fals itemsave_fcsif set true clean fc file save codeoutput_directori filename_qcfc _qc name alter codesuffix_fc paramet extra column name original_id ad fc file cell given origin cell id default true itemoutput_directorydirectori new folder creat consist gener fc file plot report set null noth storedth default folder work directori itemname_directorynam folder gener codeoutput_directori default peacoqc_result itemreportoverview text report gener peacoqc run set fals report gener default true itemevents_per_binnumb event put one bin default calcul base row codeff itemmin_cellsth minimum amount cell nonzero valu present one bin lower paramet affect robust peak detect default itemmax_binsth maximum number bin use clean process valu lower larger bin made default itemstepth step events_per_bin paramet reduc default itemmadth mad paramet default increas algorithm becom less strict itemit_limitth isolationtre paramet default increas algorithm becom less strict itemconsecutive_binsif good bin locat bin remov also mark bad default itemremove_zerosif set true zero valu remov peak detect step indic bad valu recommend clean mass cytometri data default fals itemsuffix_fcsth suffix given new fc file default _qc itemforce_itif number determin bin less number analysi perform default bin itempeak_removaldur peak detect step peak kept codepeak_remov percentag maximum height peak default itemmin_nr_bins_peakdetectionth percentag number bin maximum number peak present default itemopt pass codeplotpeacoqc function display_cel manual_cel prefix valu function return codelist number item includ finalff transform compens clean flowfram store also contain start paramet inform necessari give codeplotpeacoqc two function run seperatli goodcel list also given good measur indic true remov measur fals descript codepeacoqc determin peak channel flowfram remov anomali caus eg clog chang speed etc use isolationtre andor mad method exampl gener pipelin preprocess qualiti control peacoqc read raw fc file filenam systemfileextdata fc packagepeacoqc ff flowcorereadfcsfilenam defin channel margin event remov qualiti control done channel c ff removemarginsffff channelschannel outputfram compens transform data ff flowcorecompensateff flowcorekeywordffspil ff flowcoretransformff flowcoreestimatelogicleff colnamesflowcorekeywordffspil run peacoqc peacoqc_r peacoqcff channel determine_good_cellsal save_fcstru