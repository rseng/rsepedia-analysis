readmemd gener readmermd pleas edit file github markdown built use rmarkdownrenderreadmermdoutput_format md_document nichenetr badg start r build statushttpsgithubcomsaeyslabnichenetrworkflowsrcmdcheckbiocbadgesvghttpsgithubcomsaeyslabnichenetract coverag statushttpscodecovioghsaeyslabnichenetrbranchmastergraphbadgesvghttpscodecovioghsaeyslabnichenetr doihttpszenodoorgbadgedoizenodosvghttpsdoiorgzenodo badg end nichenetr r implement nichenet method goal nichenet studi intercellular commun comput perspect nichenet use human mous gene express data interact cell input combin prior model integr exist knowledg ligandtotarget signal path allow predict ligandreceptor interact might drive gene express chang cell interest describ nichenet algorithm follow paper nichenet model intercellular commun link ligand target geneshttpswwwnaturecomarticless bonnardel tjonck et al alreadi use nichenet predict upstream nich signal drive kupffer cell differenti stellat cell hepatocyt endotheli cell imprint kupffer cell ident monocyt colon liver macrophag nichehttpswwwcellcomimmunityfulltext import updat liver atla paper guilliam et al spatial proteogenom reveal distinct evolutionarili conserv hepat macrophag nicheshttpswwwsciencedirectcomsciencearticlepii use differenti nichenet extens default nichenet algorithm differenti nichenet use compar cellcel interact differ nich better predict nichespecif ligandreceptor lr pair use paper predict ligandreceptor pair specif kupffer cell nich mous human main differ classic nichenet pipelin differenti nichenet pipelin differenti nichenet also use differenti express conditionsnich ligandreceptor pair priorit addit ligand activ classic nichenet pipelin contrari use ligand aciv priorit show differenti express visual data multipl condit nich want includ differenti express ligandreceptor pair priorit recommend check differenti nichenet bottom page find link two vignett illustr differenti nichenet analysi recommend vignett want appli differenti nichenet data want see code use analys use guilliam et al paper see httpsgithubcomsaeyslabnichenet_livercellatla introduct nichenet figur show graphic represent nichenet workflow interact infer sever complementari ligandreceptor signal gene regulatori data sourc aggreg respect integr network ligandtarget regulatori potenti score calcul model prior inform potenti ligandtarget link use infer activ ligandtarget link interact cell nichenet priorit ligand accord activ ie well predict observ chang gene express receiv cell look affect target high potenti regul priorit ligand offer option use prebuilt prior model network integr step repeat creat use prior model see refer detail vignett brbr vignettesworkflow_nichenetjpg brbr nichenet strongli differ current comput approach studi intercellular commun current approach studi intercellular commun singlecel express data link ligand express sender cell correspond receptor express receiv cell howev function understand cellular commun process also requir know infer ligandreceptor interact result chang express downstream target gene within receiv cell address need develop nichenet contrari exist approach nichenet look gene regulatori effect ligand use prior knowledg goe beyond ligandreceptor interact incorpor intracellular signal transcript regul well result nichenet allow predict ligand influenc express anoth cell target gene affect ligand signal mediat may involv gener novel type hypothes nichenet drive improv function understand cellcel commun process interest figur summar conceptu differ current ligandreceptor network infer approach top panel nichenet bottom panel visual power nichenet priorit ligandreceptor interact base gene express effect brbr img srcvignettescomparison_other_approaches_jpg width brbr main function nichenetr specif function packag includ assess well ligand express sender cell predict chang gene express receiv cell priorit ligand base effect gene express infer put ligandtarget link activ system studi infer potenti signal path ligand target gene interest gener causal hypothes check data sourc support predict valid prior ligandtarget model construct userdefin prior ligandtarget model moreov provid instruct make intuit visual main predict eg via circo plot shown brbr vignettescircos_plot_adaptedjpg instal nichenetr instal typic take minut depend number depend alreadi instal pc instal nichenetr requir depend github installpackagesdevtool devtoolsinstall_githubsaeyslabnichenetr nichenetr test window linux recent test r version r learn use nichenetr learn use nichenetr read one follow vignett explain sever type analys follow vignett contain explan perform basic nichenet analysi includ priorit ligand predict target gene priorit ligand demo analysi take minut run nichenet ligand activ analysi gene set interest predict activ ligand target genesvignettesligand_activity_genesetmd vignetteligand_activity_geneset packagenichenetr facilit use nichenet singlecel data demonstr use nichenet seurat object follow vignett one demonstr use singl wrapper function demonstr what behind wrapper recommend perform nichenet analysi start seurat objectvignettesseurat_wrappermdvignetteseurat_wrapp packagenichenetr perform nichenet analysi start seurat object stepbystep analysisvignettesseurat_stepsmdvignetteseurat_step packagenichenetr follow vignett contain explan followup analys perform basic analysi infer ligandtotarget signal pathsvignettesligand_target_signaling_pathmd vignetteligand_target_signaling_path packagenichenetr assess well toprank ligand predict gene set interestvignettestarget_prediction_evaluation_genesetmd vignettetarget_prediction_evaluation_geneset packagenichenetr singlecel nichenet ligand activ analysisvignettesligand_activity_single_cellmd vignetteligand_activity_single_cel packagenichenetr want make circo plot visual nichenet output check follow vignett circo plot visual show activ ligandtarget link interact cellsvignettescircosmdvignettecirco packagenichenetr seurat wrapper circo visualizationvignettesseurat_wrapper_circosmdvignetteseurat_wrapper_circo packagenichenetr peopl interest build model benchmark model nichenet read one follow vignett model constructionvignettesmodel_constructionmd vignettemodel_construct packagenichenetr model evalu target gene ligand activ predictionvignettesmodel_evaluationmd vignettemodel_evalu packagenichenetr paramet optim via mlrmbovignettesparameter_optimizationmd vignetteparameter_optim packagenichenetr peopl work mous data see follow vignett convert nichenet ligandtarget model given human symbol mous symbol convert nichenet model human mous symbolsvignettessymbol_conversionmd vignettesymbol_convers packagenichenetr differenti nichenet vignett differenti nichenet analysi nich interestvignettesdifferential_nichenetmdvignettedifferential_nichenet packagenichenetr differenti nichenet analysi condit interestvignettesdifferential_nichenet_pemtmdvignettedifferential_nichenet_pemt packagenichenetr faq check faq page faq nichenetvignettesfaqmd vignettefaq packagenichenetr refer browaey r saelen w saey nichenet model intercellular commun link ligand target gene nat method doi bonnardel et al stellat cell hepatocyt endotheli cell imprint kupffer cell ident monocyt colon liver macrophag nich immun doijimmuni guilliam et al spatial proteogenom reveal distinct evolutionarili conserv hepat macrophag nich cell doijcel construct nichenet ligandtarget model robin browaey github markdown built use rmarkdownrendervignettesmodel_constructionrmd output_format github_docu vignett show ligandtarget prior regulatori potenti score infer nichenet framework use procedur shown develop model inclus contextspecif network remov noisi irrelev data sourc network basi nichenet download zenodo doihttpszenodoorgbadgedoizenodosvghttpsdoiorgzenodo background inform nichenet prior ligandtarget model prior model basi nichenet denot strongli exist knowledg support ligand may regul express target gene calcul ligandtarget regulatori potenti integr biolog knowledg ligandtotarget signal path follow first collect multipl complementari data sourc cover ligandreceptor signal transduct eg proteinprotein kinasesubstr interact gene regulatori interact eg infer chipseq motif inform collect data sourc link websit databas etc see data sourc informationdata_sourcesxlsx secondli integr individu data sourc two weight network ligandsign network contain proteinprotein interact cover signal path ligand downstream transcript regul gene regulatori network contain gene regulatori interact transcript regul target gene let inform data sourc contribut final model weight data sourc integr data sourc weight automat determin via modelbas paramet optim improv accuraci ligandtarget predict see vignett paramet optim via mlrmboparameter_optimizationmd vignett show construct model unoptim data sourc weigth well final combin ligandsign gene regulatori network calcul regulatori potenti score pair ligand target gene ligandtarget pair receiv high regulatori potenti regul target gene lie downstream signal network ligand calcul use network propag method integr network propag signal start ligand flow receptor signal protein transcript regul ultim end target gene graphic summari procedur visual workflow_model_constructionpng construct ligandtarget model collect ligandreceptor signal gene regulatori network data sourc load requir packag network use construct model r librarynichenetr librarytidyvers nichenet framework ligandtarget link predict base collect biolog knowledg ligandreceptor signal gene regulatori interact complet network download zenodo lr_network readrdsurlhttpszenodoorgrecordfileslr_networkrd sig_network readrdsurlhttpszenodoorgrecordfilessignaling_networkrd gr_network readrdsurlhttpszenodoorgrecordfilesgr_networkrd construct nichenet ligandtarget model unoptim data sourc weight construct weight integr ligandsign gene regulatori network first exampl give everi data sourc weight given source_weights_df data frame provid default nichenetr packag see vignett show use mlrmbo optim data sourc weight hyperparamet interest perform paramet optim hyperparamet model hub correct factor damp factor use optim valu given hyperparameter_list data frame provid default nichenetr packag ligandsign network hub correct factor gene regulatori network hub correct factor defin hyperparamet model mitig potenti neg influenc overdomin hub final model damp factor hyperparamet main paramet person pagerank algorithm use network propag algorithm link ligand downstream regul r aggreg individu data sourc weight manner obtain weight integr signal network weighted_network construct_weighted_networkslr_network lr_network sig_network sig_network gr_network gr_network source_weights_df source_weights_df downweigh import signal gene regulatori hub use optim paramet weighted_network apply_hub_correctionsweighted_network weighted_network lr_sig_hub hyperparameter_listlr_sig_hub gr_hub hyperparameter_listgr_hub infer ligandtarget regulatori potenti score base weight integr network r exampl calcul target gene regulatori potenti score tnf ligand combin tnfil ligand listtnfctnfil ligand_target_matrix construct_ligand_target_matrixweighted_network weighted_network ligand ligand algorithm ppr damping_factor hyperparameter_listdamping_factor ltf_cutoff hyperparameter_listltf_cutoff show top target gene ligand tnf ligand combin tnfil r extract_top_n_targetstnfligand_target_matrix hacd ph ubd ighd ccl sele mucac cox crp cxcl r extract_top_n_targetstnfilligand_target_matrix bud hacd ighd crp cox ph sele il casp mmp construct nichenet ligandtarget model optim data sourc weight demonstr make altern model optim data sourc weight given optimized_source_weights_df data frame provid default nichenetr packag r aggreg individu data sourc weight manner obtain weight integr signal network weighted_network construct_weighted_networkslr_network lr_network sig_network sig_network gr_network gr_networksource_weights_df optimized_source_weights_df downweigh import signal gene regulatori hub use optim paramet weighted_network apply_hub_correctionsweighted_network weighted_network lr_sig_hub hyperparameter_listlr_sig_hub gr_hub hyperparameter_listgr_hub infer ligandtarget regulatori potenti score base weight integr network ligand listtnf ligand_target_matrix construct_ligand_target_matrixweighted_network weighted_network ligand ligand algorithm ppr damping_factor hyperparameter_listdamping_factor ltf_cutoff hyperparameter_listltf_cutoff show top target gene ligand tnf r extract_top_n_targetstnfligand_target_matrix hacd ph sele vcam ubd cda ccl mucac cxcl crp chang data sourc basi nichenet ligandtarget model keep specif data sourc interest demonstr decid data sourc use model want creat let say exampl interest make model consist literaturederiv ligandreceptor interact signal gene regulatori interact comprehens databas gene regulatori interact infer chipseq annot differ data sourc given annotation_data_sourc data frame provid default nichenetr packag r annotation_data_sourcestype_db uniqu literatur predict comprehensive_db ptm text_min directional_ppi chip motif perturb r data_sources_to_keep annotation_data_sourc filtertype_db cliteraturecomprehensive_dbchip pullsourc new_source_weights_df source_weights_df filtersourc data_sources_to_keep new_lr_network lr_network filtersourc data_sources_to_keep new_sig_network sig_network filtersourc data_sources_to_keep new_gr_network gr_network filtersourc data_sources_to_keep r aggreg individu data sourc weight manner obtain weight integr signal network weighted_network construct_weighted_networkslr_network new_lr_network sig_network new_sig_network gr_network new_gr_network source_weights_df new_source_weights_df downweigh import signal gene regulatori hub use optim paramet weighted_network apply_hub_correctionsweighted_network weighted_network lr_sig_hub hyperparameter_listlr_sig_hub gr_hub hyperparameter_listgr_hub infer ligandtarget regulatori potenti score base weight integr network ligand listtnf ligand_target_matrix construct_ligand_target_matrixweighted_network weighted_network ligand ligand algorithm ppr damping_factor hyperparameter_listdamping_factor ltf_cutoff hyperparameter_listltf_cutoff show top target gene ligand tnf r extract_top_n_targetstnfligand_target_matrix hacd ph cda sele ubd ccl ccl st nox krt give second exampl say dont trust tftarget link infer motif inform want construct model data sourc except motif one r data_sources_to_remov annotation_data_sourc filtertype_db cmotif pullsourc data_sources_to_keep annotation_data_sourcessourc setdiffdata_sources_to_remov new_source_weights_df source_weights_df filtersourc data_sources_to_keep new_lr_network lr_network filtersourc data_sources_to_keep new_sig_network sig_network filtersourc data_sources_to_keep new_gr_network gr_network filtersourc data_sources_to_keep r aggreg individu data sourc weight manner obtain weight integr signal network weighted_network construct_weighted_networkslr_network new_lr_network sig_network new_sig_network gr_network new_gr_network source_weights_df new_source_weights_df downweigh import signal gene regulatori hub use optim paramet weighted_network apply_hub_correctionsweighted_network weighted_network lr_sig_hub hyperparameter_listlr_sig_hub gr_hub hyperparameter_listgr_hub infer ligandtarget regulatori potenti score base weight integr network ligand listtnf ligand_target_matrix construct_ligand_target_matrixweighted_network weighted_network ligand ligand algorithm ppr damping_factor hyperparameter_listdamping_factor ltf_cutoff hyperparameter_listltf_cutoff show top target gene ligand tnf r extract_top_n_targetstnfligand_target_matrix hacd ph ccl ubd ighd plaga sele cxcl crp mucac add data sourc nichenet model addit remov data sourc also add new data sourc could exampl help make contextspecif model would network data contain contextspecif interact interest input requir data sourc contain direct interact gene interact proteinprotein signal interact ligandreceptor signal data sourc gene regulatori interact gene regulatori data sourc data sourc format data frame follow column sourc denot sourc node gene direct interact gene b denot target node gene b direct interact sourc userdefin name data sourc show download process integr onlin data sourc within nichennet framework exampl data sourc hub protein proteinprotein interact harmonizom portal httpsamppharmmssmeduharmonizomedatasethubproteinsproteinproteininteract r input_fil httpsamppharmmssmedustatichdfsharmonizomedatahubsgene_attribute_edgestxtgz ppi_network read_tsvinput_fil col_nam true ppi_network ppi_network transmutefromtargettosourc filterfrom geneinfo_humansymbol geneinfo_humansymbol keep interact gene ofici gene symbol option step give data sourc name ppi_network ppi_network mutatesourc harmonizome_hub_ppi databas harmonizom headppi_network tibbl x sourc databas chr chr chr chr lrif gad harmonizome_hub_ppi harmonizom lrif id harmonizome_hub_ppi harmonizom lrif nocl harmonizome_hub_ppi harmonizom lrif esr harmonizome_hub_ppi harmonizom lrif nrc harmonizome_hub_ppi harmonizom lrif pparg harmonizome_hub_ppi harmonizom first add new data sourc data sourc data sourc contain intracellular proteinprotein interact consid data sourc signal data sourc exampl assign data sourc weight want strong contribut final model r new_sig_network sig_network bind_rowsppi_network new_network_weights_df tibblesourc harmonizome_hub_ppi weight new_source_weights_df optimized_source_weights_df bind_rowsnew_network_weights_df make model r aggreg individu data sourc weight manner obtain weight integr signal network weighted_network construct_weighted_networkslr_network lr_network sig_network new_sig_network gr_network gr_network source_weights_df new_source_weights_df downweigh import signal gene regulatori hub use optim paramet weighted_network apply_hub_correctionsweighted_network weighted_network lr_sig_hub hyperparameter_listlr_sig_hub gr_hub hyperparameter_listgr_hub infer ligandtarget regulatori potenti score base weight integr network ligand listtnf ligand_target_matrix construct_ligand_target_matrixweighted_network weighted_network ligand ligand algorithm ppr damping_factor hyperparameter_listdamping_factor ltf_cutoff hyperparameter_listltf_cutoff show top target gene ligand tnf r extract_top_n_targetstnfligand_target_matrix hacd ph sele vcam ubd cda ccl mucac cxcl crp case possibl want data sourc consid data sourc specif layer ie ligandreceptor signal gene regulatori layer therefor show use new data sourc data sourc part signal network r new_sig_network ppi_network new_network_weights_df tibblesourc harmonizome_hub_ppi weight new_source_weights_df optimized_source_weights_df bind_rowsnew_network_weights_df r aggreg individu data sourc weight manner obtain weight integr signal network weighted_network construct_weighted_networkslr_network lr_network sig_network new_sig_network gr_network gr_network source_weights_df new_source_weights_df downweigh import signal gene regulatori hub use optim paramet weighted_network apply_hub_correctionsweighted_network weighted_network lr_sig_hub hyperparameter_listlr_sig_hub gr_hub hyperparameter_listgr_hub infer ligandtarget regulatori potenti score base weight integr network ligand listtnf ligand_target_matrix construct_ligand_target_matrixweighted_network weighted_network ligand ligand algorithm ppr damping_factor hyperparameter_listdamping_factor ltf_cutoff hyperparameter_listltf_cutoff show top target gene ligand tnf r extract_top_n_targetstnfligand_target_matrix hacd ph sele cda ubd vcam ccl mucac ccl crp final note optim would like optim paramet includ data sourc instruct given follow vignett paramet optim via mlrmboparameter_optimizationmd vignetteparameter_optim packagenichenetr howev optim process take lot time requir avail multipl core perform optim parallel demonstr nichenet paper unoptim model also perform consider well data sourc weight optmiz necessari decent predict abil singlecel nichenet ligand activ analysi robin browaey github markdown built use rmarkdownrendervignettesligand_activity_single_cellrmd output_format github_docu vignett show nichenet use predict ligand might activ singlecel ligand high activ cell mean target gene ligand stronger express cell cell exampl use data puram et al explor intercellular commun tumor microenviron head neck squamou cell carcinoma hnscc see puram et al specif assess activ cancerassoci fibroblast caf ligand malign cell use ligandtarget matrix exampl express data interact cell download zenodo doihttpszenodoorgbadgedoizenodosvghttpsdoiorgzenodo order priorit ligand regul process interest perform regressioncorrel analysi ligand activ cell score cell correspond process interest exampl case studi interest find ligand regul pemt therefor correl ligand activ pemt score cell purpos singlecel ligand activ analysi offer complementari way priorit ligand drive process interest better analyz heterogen ligand activ differ cell load nichenetr tidyvers r librarynichenetr librarytidyvers read express data interact cell first read singlecel data caf malign cell hnscc tumor see puram et al r hnscc_express readrdsurlhttpszenodoorgrecordfileshnscc_expressionrd express hnscc_expressionexpress sample_info hnscc_expressionsample_info contain metainform cell secondli determin gene express caf malign cell high qualiti primari tumor therefor wil consid cell tumor sampl less qualiti lymph node metastas determin express gene use definit use puram et al r tumors_remov chnhnhn hn hn hn hnhn caf_id sample_info filterlymph node filtertumor tumors_remov fals filternoncanc cell type caf cell malignant_id sample_info filterlymph node filterclassifi cancer cell filtertumor tumors_remov fals cell expressed_genes_caf expressioncaf_id applyfunctionxx applyfunctionxlogmeanx name expressed_genes_malign expressionmalignant_id applyfunctionxx applyfunctionxlogmeanx name load ligandtarget model want use r ligand_target_matrix readrdsurlhttpszenodoorgrecordfilesligand_target_matrixrd ligand_target_matrix target gene row ligand column cxcl cxcl cxcl cxcl ppbp abg e e e e e abga e e e e e acf e e e e e e e e e e ama e e e e e perform nichenet singlecel ligand activ analysi first step defin set potenti activ ligand potenti activ ligand use ligand express caf bind put receptor express malign cell put ligandreceptor link gather nichenet ligandreceptor data sourc r lr_network readrdsurlhttpszenodoorgrecordfileslr_networkrd ligand lr_networkfrom uniqu expressed_ligand intersectligandsexpressed_genes_caf receptor lr_networkto uniqu expressed_receptor intersectreceptorsexpressed_genes_malign potential_ligand lr_network filterfrom expressed_ligand expressed_receptor uniqu headpotential_ligand hgf tnfsf tgfb tgfb inhba cd second step scale singlecel express data includ express gene r background_expressed_gen expressed_genes_malign rownamesligand_target_matrix expression_sc express malignant_idsbackground_expressed_gen scale_quantil perform ligand activ analysi infer well nichenet ligandtarget potenti score predict whether gene belong strongli express gene cell compar cell reduc run time vignett perform analysi exampl cell hn tumor vignett purpos illustr analysi practic ligand activ analysi sever cell better run parallel via eg parallelmclappli r malignant_hn_id sample_info filtertumor hn filterlymph node filterclassifi cancer cell cell head ligand_act predict_single_cell_ligand_activitiescell_id malignant_hn_id expression_sc expression_sc ligand_target_matrix ligand_target_matrix potential_ligand potential_ligand ligand priorit regress analysi furthermor also show perform addit analys link ligand activ cell properti cell order priorit ligand toy exampl score malign cell extent express core pemt gene tgfbi r cell_scores_tbl tibblecel malignant_hn_id score expression_scaledmalignant_hn_idstgfbi determin correl pemt score ligand activ cell priorit pemtinduc ligand hypothes ligand might potenti regul pemt program higher ligand activ associ higher pemt score base correl obtain rank potenti pemtinduc ligand frist need process normal ligand activ ie pearson correl valu make differ cell compar use modifi zscore normal r normalized_ligand_act normalize_single_cell_ligand_activitiesligand_act combin ligand activ cell properti score perform correl regress analysi priorit ligand rank base pearson correl activ score properti score r output_correlation_analysi single_ligand_activity_score_regressionnormalized_ligand_activitiescell_scores_tbl output_correlation_analysi arrangepearson_regress selectpearson_regress ligand tibbl x pearson_regress ligand dbl chr tnc tfpi semaa anxa tnfsfb ibsp hdgf hspb calm cxcl row visual relat ligand activ cell properti score interest r inner_joincell_scores_tblnormalized_ligand_act ggplotaesscoretnc geom_point geom_smoothmethod lm ligand_activity_single_cell_filesfiguregfmunnamedchunkpng refer div idref classrefer div idrefpuram_singlecell_ puram sidharth v itay tirosh anuraag parikh anoop p patel keren yizhak shawn gillespi christoph rodman et al singlecel transcriptom analysi primari metastat tumor ecosystem head neck cancer cell e httpsdoiorgjcel div div nichenet ligand activ analysi gene set interest predict activ ligand target gene robin browaey github markdown built use rmarkdownrendervignettesligand_activity_genesetrmd output_format github_docu vignett learn perform basic nichenet analysi nichenet analysi help gener hypothes intercellular commun process interest bulk singlecel gene express data specif nichenet predict ligand one cell popul sendernich like affect target gene express interact cell popul receivertarget specif target gene affect predict ligand nichenet studi ligand affect gene express neighbor cell need data effect gene express want studi need clear set gene put affect ligand one interact cell pipelin basic nichenet analysi consist mainli follow step defin sendernich cell popul receivertarget cell popul present express data determin gene express popul defin gene set interest gene receivertarget cell popul potenti affect ligand express interact cell eg gene differenti express upon cellcel interact defin set potenti ligand ligand express sendernich cell popul bind put receptor express receivertarget popul perform nichenet ligand activ analysi rank potenti ligand base presenc target gene gene set interest compar background set gene infer toppredict target gene ligand toprank ligand activ analysi vignett guid detail step exampl express data interact cell use data puram et al explor intercellular commun tumor microenviron head neck squamou cell carcinoma hnscc see puram et al specif look ligand express cancerassoci fibroblast caf induc specif gene program neighbor malign cell program partial epithelialmesenschym transit pemt program could link metastasi puram et al use ligandtarget matrix exampl express data interact cell download zenodo doihttpszenodoorgbadgedoizenodosvghttpsdoiorgzenodo step load requir packag nichenet ligandtarget prior model process express data interact cell packag r librarynichenetr librarytidyvers ligandtarget model model denot prior potenti particular ligand might regul express specif target gene r ligand_target_matrix readrdsurlhttpszenodoorgrecordfilesligand_target_matrixrd ligand_target_matrix target gene row ligand column cxcl cxcl cxcl cxcl ppbp abg e e e e e abga e e e e e acf e e e e e e e e e e ama e e e e e express data interact cell publicli avail singlecel data caf malign cell hnscc tumor r hnscc_express readrdsurlhttpszenodoorgrecordfileshnscc_expressionrd express hnscc_expressionexpress sample_info hnscc_expressionsample_info contain metainform cell step defin express gene sender receiv cell popul research question priorit ligand express caf induc pemt neighbor malign cell therefor caf sender cell exampl malign cell receiv cell exampl paracrin signal note autocrin signal consid sender receiv cell type determin gene express sender cell caf receiv cell malign cell high qualiti primari tumor therefor wil consid cell tumor sampl less qualiti lymph node metastas determin express gene case studi use definit use puram et al author dataset ea aggreg express gene across k cell calcul eai logaveragetpmik recommend user defin express gene way consid appropri dataset singlecel data gener x platform lab dont use definit use consid gene express cell type nonzero valu least cell cell type describ well vignett perform nichenet analysi start seurat object stepbystep analysisseurat_stepsmdvignetteseurat_step packagenichenetr r tumors_remov chnhnhn hn hn hn hnhn caf_id sample_info filterlymph node tumor tumors_remov noncanc cell type caf pullcel malignant_id sample_info filterlymph node tumor tumors_remov classifi cancer cell pullcel expressed_genes_send expressioncaf_id applyfunctionxx applyfunctionxlogmeanx name expressed_genes_receiv expressionmalignant_id applyfunctionxx applyfunctionxlogmeanx name check number express gene reason number total express gene cell type eg lengthexpressed_genes_send lengthexpressed_genes_receiv step defin gene set interest background gene gene set interest consid gene express possibl affect due commun cell definit gene set depend research question crucial step use nichenet want investig caf regul express pemt gene malign cell use pemt gene set defin puram et al gene set interest use gene express malign cell background gene r geneset_oi readrread_tsvurlhttpszenodoorgrecordfilespemt_signaturetxt col_nam gene pullgen rownamesligand_target_matrix consid gene also present nichenet model exclud gene gene list offici hgnc symbol use puram et al headgeneset_oi serpin tgfbi mmp lamc pha pdpn background_expressed_gen expressed_genes_receiv rownamesligand_target_matrix headbackground_expressed_gen rp elmo pnma mmp tmem ercc step defin set potenti ligand potenti activ ligand use ligand express caf bind put receptor express malign cell put ligandreceptor link gather nichenet ligandreceptor data sourc r lr_network readrdsurlhttpszenodoorgrecordfileslr_networkrd want user remov ligandreceptor interact predict base proteinprotein interact keep ligandreceptor interact describ curat databas uncom follow line code lr_network lr_network filterdatabas ppi_prediction_go databas ppi_predict ligand lr_network pullfrom uniqu expressed_ligand intersectligandsexpressed_genes_send receptor lr_network pullto uniqu expressed_receptor intersectreceptorsexpressed_genes_receiv lr_network_express lr_network filterfrom expressed_ligand expressed_receptor headlr_network_express tibbl x sourc databas chr chr chr chr hgf met kegg_cytokin kegg tnfsf tnfrsfa kegg_cytokin kegg tnfsf tnfrsfb kegg_cytokin kegg tgfb tgfbr kegg_cytokin kegg tgfb tgfbr kegg_cytokin kegg inhba acvra kegg_cytokin kegg ligandreceptor network contain express ligandreceptor interact potenti activ ligand nichenet analysi consid ligand network r potential_ligand lr_network_express pullfrom uniqu headpotential_ligand hgf tnfsf tgfb tgfb inhba cd step perform nichenet ligand activ analysi gene set interest perform ligand activ analysi analysi calcul ligand activ ligand word assess well cafligand predict pemt gene set compar background express gene predict whether gene belong pemt program r ligand_act predict_ligand_activitiesgeneset geneset_oi background_expressed_gen background_expressed_gen ligand_target_matrix ligand_target_matrix potential_ligand potential_ligand want rank ligand base ligand activ valid studi show pearson correl coeffici pcc ligand target predict observ transcript respons inform measur defin ligand activ therefor rank ligand base pearson correl coeffici allow us priorit pemtregul ligand r ligand_act arrangepearson tibbl x test_ligand auroc aupr pearson chr dbl dbl dbl pthlh cxcl agt tgfb il inhba adam tnc ctgf fn row best_upstream_ligand ligand_act top_n pearson arrangepearson pulltest_ligand headbest_upstream_ligand pthlh cxcl agt tgfb il inhba see perform metric indic toprank ligand predict pemt gene reason impli rank ligand might accur shown studi howev possibl gene set target gene predict perform toprank ligand would much better random predict case priorit ligand less trustworthi addit note look top ligand continu analysi infer pemt target gene ligand howev choic look toprank ligand biolog interpret base biolog intuit quit arbitrari therefor user decid continu analysi differ number ligand recommend check select cutoff look distribut ligand activ valu show ligand activ histogram score th ligand indic via dash line r show histogram ligand activ score p_hist_lig_act ggplotligand_act aesxpearson geom_histogramcolorblack filldarkorang geom_densityalpha fillorang geom_vlineaesxinterceptminligand_act top_n pearson pullpearson color linetypedash size labsxligand activ pcc ligand theme_class p_hist_lig_act ligand_activity_geneset_filesfiguregfmunnamedchunkpng step infer target gene toprank ligand visual heatmap show look regulatori potenti score ligand target gene interest case look link toprank pemt regul ligand pemt gene ligandtarget heatmap show regulatori potenti score interact toprank ligand follow target gene gene belong gene set interest strongli predict target least one toprank ligand top target accord gener prior model top target dataset consequ gene gene set top target gene one priorit ligand shown heatmap r active_ligand_target_links_df best_upstream_ligand lapplyget_weighted_ligand_target_linksgeneset geneset_oi ligand_target_matrix ligand_target_matrix n bind_row nrowactive_ligand_target_links_df headactive_ligand_target_links_df tibbl x ligand target weight chr chr dbl pthlh cola pthlh mmp pthlh mmp pthlh myh pthlh pha pthlh plau visual purpos adapt ligandtarget regulatori potenti matrix follow regulatori potenti score set score predefin threshold quantil score interact toprank ligand respect top target see ligandtarget network defin data frame r active_ligand_target_link prepare_ligand_target_visualizationligand_target_df active_ligand_target_links_df ligand_target_matrix ligand_target_matrix cutoff nrowactive_ligand_target_links_df headactive_ligand_target_links_df tibbl x ligand target weight chr chr dbl pthlh cola pthlh mmp pthlh mmp pthlh myh pthlh pha pthlh plau put activ ligandtarget link visual heatmap order ligand accord rank accord ligand activ predict r order_ligand intersectbest_upstream_ligand colnamesactive_ligand_target_link rev order_target active_ligand_target_links_dftarget uniqu vis_ligand_target active_ligand_target_linksorder_targetsorder_ligand p_ligand_target_network vis_ligand_target make_heatmap_ggplotpriorit cafligandspemt gene malign cell color purplelegend_posit top x_axis_posit toplegend_titl regulatori potenti scale_fill_gradientlow whitesmok high purpl break c themeaxistextx element_textfac ital p_ligand_target_network ligand_activity_geneset_filesfiguregfmunnamedchunkpng note choic cutoff visual quit arbitrari recommend user test sever cutoff valu would consid top target base prior inform infer less confid ligandtarget link consid less target stringent would chang quantil cutoff use set score visual purpos lower cutoff result dens heatmap wherea higher cutoff result spars heatmap followup analysi ligandreceptor network infer toprank ligand one type followup analysi look receptor receiv cell popul malign cell potenti bind priorit ligand sender cell popul caf infer predict ligandreceptor interact toprank ligand visual heatmap r get ligandreceptor network toprank ligand lr_network_top lr_network filterfrom best_upstream_ligand expressed_receptor distinctfromto best_upstream_receptor lr_network_top pullto uniqu get weight ligandreceptor interact use nichenet model weighted_network readrdsurlhttpszenodoorgrecordfilesweighted_networksrd lr_network_top_df weighted_networkslr_sig filterfrom best_upstream_ligand best_upstream_receptor convert matrix lr_network_top_df lr_network_top_df spreadfromweightfil lr_network_top_matrix lr_network_top_df selectto asmatrix magrittrset_rownameslr_network_top_dfto perform hierarch cluster order ligand receptor dist_receptor distlr_network_top_matrix method binari hclust_receptor hclustdist_receptor method wardd order_receptor hclust_receptorslabelshclust_receptorsord dist_ligand distlr_network_top_matrix method binari hclust_ligand hclustdist_ligand method wardd order_ligands_receptor hclust_ligandslabelshclust_ligandsord show heatmap ligandreceptor interact r vis_ligand_receptor_network lr_network_top_matrixorder_receptor order_ligands_receptor p_ligand_receptor_network vis_ligand_receptor_network make_heatmap_ggplotpriorit cafligandsreceptor express malign cell color mediumvioletr x_axis_posit toplegend_titl prior interact potenti p_ligand_receptor_network ligand_activity_geneset_filesfiguregfmunnamedchunkpng followup analysi visual express toppredict ligand target gene combin heatmap nichenet consid express ligand sender cell take account express rank ligand rank pure base potenti ligand might regul gene set interest given prior knowledg also use look express ligand target gene demonstr could make combin figur show ligand activ ligand express target gene express ligandtarget regulatori potenti load addit packag requir visual r libraryrcolorbrew librarycowplot libraryggpubr prepar ligand activ matrix r ligand_pearson_matrix ligand_act selectpearson asmatrix magrittrset_rownamesligand_activitiestest_ligand vis_ligand_pearson ligand_pearson_matrixorder_ligand asmatrixncol magrittrset_colnamespearson r p_ligand_pearson vis_ligand_pearson make_heatmap_ggplotpriorit cafligandsligand activ color darkorangelegend_posit top x_axis_posit top legend_titl pearson correl coefficientntarget gene predict abil p_ligand_pearson ligand_activity_geneset_filesfiguregfmunnamedchunkpng prepar express ligand fibroblast per tumor singlecel data collect multipl tumor show averag express ligand per tumor r expression_df_caf expressioncaf_idsorder_ligand datafram rownames_to_columncel as_tibbl inner_joinsample_info selectcelltumor cell aggregated_expression_caf expression_df_caf group_bytumor selectcel summarise_allmean aggregated_expression_df_caf aggregated_expression_caf selecttumor magrittrset_colnamesaggregated_expression_caftumor datafram rownames_to_columnligand as_tibbl aggregated_expression_matrix_caf aggregated_expression_df_caf selectligand asmatrix magrittrset_rownamesaggregated_expression_df_cafligand order_tumor chnhnhnhnhnhnhnhnhnhn order determin base paper puram et al tumor order accord pemt score vis_ligand_tumor_express aggregated_expression_matrix_caforder_ligandsorder_tumor r libraryrcolorbrew color colorramppaletterevbrewerpaln name rdylbu p_ligand_tumor_express vis_ligand_tumor_express make_heatmap_ggplotpriorit cafligandstumor color colorlegend_posit top x_axis_posit top legend_titl expressionnaverag overnsingl cell themeaxistexti element_textfac ital p_ligand_tumor_express ligand_activity_geneset_filesfiguregfmunnamedchunkpng prepar express target gene malign cell per tumor r expression_df_target expressionmalignant_idsgeneset_oi datafram rownames_to_columncel as_tibbl inner_joinsample_info selectcelltumor cell aggregated_expression_target expression_df_target group_bytumor selectcel summarise_allmean aggregated_expression_df_target aggregated_expression_target selecttumor magrittrset_colnamesaggregated_expression_targettumor datafram rownames_to_columntarget as_tibbl aggregated_expression_matrix_target aggregated_expression_df_target selecttarget asmatrix magrittrset_rownamesaggregated_expression_df_targettarget vis_target_tumor_expression_sc aggregated_expression_matrix_target scale_quantil order_tumorsorder_target r p_target_tumor_scaled_express vis_target_tumor_expression_sc make_threecolor_heatmap_ggplottumortarget low_color colormid_color color mid high_color color legend_posit top x_axis_posit top legend_titl scale expressionnaverag overnsingl cell themeaxistextx element_textfac ital p_target_tumor_scaled_express ligand_activity_geneset_filesfiguregfmunnamedchunkpng combin differ heatmap one overview figur r figures_without_legend plot_grid p_ligand_pearson themelegendposit none axistick element_blank themeaxistitlex element_text p_ligand_tumor_express themelegendposit none axistick element_blank themeaxistitlex element_text ylab p_ligand_target_network themelegendposit none axistick element_blank ylab null null p_target_tumor_scaled_express themelegendposit none axistick element_blank xlab align hv nrow rel_width cncolvis_ligand_pearson ncolvis_ligand_tumor_express ncolvis_ligand_target rel_height cnrowvis_ligand_pearson nrowvis_target_tumor_expression_sc legend plot_grid as_ggplotget_legendp_ligand_pearson as_ggplotget_legendp_ligand_tumor_express as_ggplotget_legendp_ligand_target_network as_ggplotget_legendp_target_tumor_scaled_express nrow align h plot_gridfigures_without_legend legend rel_height c nrow align hv ligand_activity_geneset_filesfiguregfmunnamedchunkpng followup analys anoth followup analysi infer possibl signal path ligand target interest read follow vignett infer ligandtotarget signal pathsligand_target_signaling_pathmdvignetteligand_target_signaling_path packagenichenetr anoth followup analysi get tangibl measur well toprank ligand predict gene set interest assess gene gene set predict well read follow vignett assess well toprank ligand predict gene set interesttarget_prediction_evaluation_genesetmdvignettetarget_prediction_evaluation_geneset packagenichenetr case want visual ligandtarget link multipl interact cell make appeal circo plot shown vignett circo plot visual show activ ligandtarget link interact cellscircosmdvignettecirco packagenichenetr refer div idref classrefer div idrefpuram_singlecell_ puram sidharth v itay tirosh anuraag parikh anoop p patel keren yizhak shawn gillespi christoph rodman et al singlecel transcriptom analysi primari metastat tumor ecosystem head neck cancer cell e httpsdoiorgjcel div div seurat wrapper circo visual robin browaey github markdown built use rmarkdownrendervignettesseurat_wrapper_circosrmd output_format github_docu vignett learn perform basic nichenet analysi seurat v object visual output circo plot vignett demonstr workflow shown perform nichenet analysi start seurat objectseurat_wrappermdvignetteseurat_wrapp packagenichenetr add circo plot visual shown circo plot visual show activ ligandtarget link interact cellscircosmdvignettecirco packagenichenetr detail inform nichenet workflow check vignett vignett made upon popular request demonstr two vignett combin one analysi workflow note develop nichenet gener recommend visual output combin sever heatmap ligand activ ligandtarget link ligandreceptor link ligand express ligand lfc use circo plot visual certainli case mani sender cell type ligand express one sender cell type case circo plot much less inform could lead wrong interpret result exampl express data interact cell use mous nicheseq data medaglia et al explor intercellular commun cell area inguin lymph node hour lymphocyt choriomening viru lcmv infect see medaglia_spatial_ nichenet explor immun cell crosstalk respons lcmv infect dataset differenti express observ cd cell steadyst cd cell lcmv infect nichenet appli look sever immun cell popul lymph node ie monocyt dendrit cell nk cell b cell cd cell regul induc observ gene express chang nichenet specif priorit ligand immun cell target gene chang express upon lcmv infect use nichenet network ligandtarget matrix exampl express data interact cell download zenodo nichenet network ligandtarget matrix doihttpszenodoorgbadgedoizenodosvghttpsdoiorgzenodo seurat object process nicheseq singlecel data doihttpszenodoorgbadgedoizenodosvghttpsdoiorgzenodo prepar nichenet analysi load requir packag read seurat object process express data interact cell nichenet ligandtarget prior model ligandreceptor network weight integr network load packag r librarynichenetr libraryseurat pleas updat seurat v librarytidyvers librarycircl would use load packag recommend load packag other read nichenet ligandtarget prior model ligandreceptor network weight integr network r ligand_target_matrix readrdsurlhttpszenodoorgrecordfilesligand_target_matrixrd ligand_target_matrix target gene row ligand column cxcl cxcl cxcl cxcl ppbp abg e e e e e abga e e e e e acf e e e e e e e e e e ama e e e e e lr_network readrdsurlhttpszenodoorgrecordfileslr_networkrd headlr_network tibbl x sourc databas chr chr chr chr cxcl cxcr kegg_cytokin kegg cxcl cxcr kegg_cytokin kegg cxcl cxcr kegg_cytokin kegg cxcl cxcr kegg_cytokin kegg ppbp cxcr kegg_cytokin kegg cxcl cxcr kegg_cytokin kegg weighted_network readrdsurlhttpszenodoorgrecordfilesweighted_networksrd headweighted_networkslr_sig interact weight ligandreceptor signal network tibbl x weight chr chr dbl abg abcc abg ace abg adam abg ago abg akt abg anxa headweighted_networksgr interact weight gene regulatori network tibbl x weight chr chr dbl abg aaa gfap aadac cypa aadac irf aatf atm aatf atr read express data interact cell r seuratobj readrdsurlhttpszenodoorgrecordfilesseuratobjrd seuratobjmetadata head ngene numi origid aggreg re celltyp ncount_rna nfeature_rna w ln_ss ss cd w ln_ss ss cd w ln_ss ss cd w ln_ss ss cd w ln_ss ss cd w ln_ss ss cd visual cell popul present cd cell includ regulatori cell cd cell b cell nk cell dendrit cell dc inflammatori monocyt r seuratobjmetadatacelltyp tabl note number cell cell type low prefer higher real applic b cd cd dc mono nk treg dimplotseuratobj reduct tsne seurat_wrapper_circos_filesfiguregfmunnamedchunkpng r seuratobjmetadataaggreg tabl lcmv ss dimplotseuratobj reduct tsne groupbi aggreg seurat_wrapper_circos_filesfiguregfmunnamedchunkpng perform nichenet analysi nichenet analysi seurat object explain differenti express two condit case studi receiv cell popul cd cell popul wherea sender cell popul cd treg mono nk b dc describ function consid gene express express least predefin fraction cell one cluster default gene set interest gene differenti express cd cell lcmv infect condit interest thu lcmv wherea referencesteadyst condit ss notion condit extract metadata column aggreg method calcul differenti express standard seurat wilcoxon test number toprank ligand use predict activ target gene construct activ ligandreceptor network default perform nichenet analysi specif run follow r indic cell type cell class ident check via seuratobj ident tabl sender_celltyp ccd ttreg mono nk b dc nichenet_output nichenet_seuratobj_aggreg seurat_obj seuratobj receiv cd condition_colnam aggreg condition_oi lcmv condition_refer ss sender sender_celltyp ligand_target_matrix ligand_target_matrix lr_network lr_network weighted_network weighted_network organ mous read process nichenet network defin express ligand receptor receiv sender cell perform de analysi receiv cell perform nichenet ligand activ analysi infer activ target gene priorit ligand infer receptor priorit ligand interpret nichenet analysi output ligand activ analysi result first thing nichenet priorit ligand base predict ligand activ see rank ligand run follow command r nichenet_outputligand_act tibbl x test_ligand auroc aupr pearson rank bona_fide_ligand chr dbl dbl dbl dbl lgl ebi fals il true crlf fals app true tgfb true ptprc true hm true icam true cxcl true adam true row ligand express one input sender cell see cell popul express toprank ligand run follow r dotplotseuratobj featur nichenet_outputtop_ligand rev col rdylbu rotatedaxi seurat_wrapper_circos_filesfiguregfmunnamedchunkpng see op toprank ligand seem mainli express dendrit cell monocyt could also interest see whether ligand differenti express lcmv infect r dotplotseuratobj featur nichenet_outputtop_ligand rev splitbi aggreg rotatedaxi seurat_wrapper_circos_filesfiguregfmunnamedchunkpng r vlnplotseuratobj featur cil cxclcxcl splitbi aggreg ptsize combin fals seurat_wrapper_circos_filesfiguregfmunnamedchunkpng seurat_wrapper_circos_filesfiguregfmunnamedchunkpng seurat_wrapper_circos_filesfiguregfmunnamedchunkpng infer activ ligandtarget link nichenet also infer activ target gene toprank ligand see toprank ligand predict regul express differenti express gene run follow command heatmap visual r nichenet_outputligand_target_heatmap seurat_wrapper_circos_filesfiguregfmunnamedchunkpng circo plot visual ligandtarget ligandreceptor interact visual group top predict activ ligand accord strongest express cell type therefor need determin per cell type ligand express strongli cell type calcul averag ligand express sender cell r avg_expression_ligand averageexpressionseuratobj subsetsubset aggreg lcmvfeatur nichenet_outputtop_ligand want look specif lcmvonli cell avg_expression_ligand averageexpressionseuratobj featur nichenet_outputtop_ligand assign ligand sender cell assign ligand sender cell type eg look sender cell type show express higher averag sd r sender_ligand_assign avg_expression_ligandsrna appli functionligand_express ligand_express ligand_express mean ligand_express sd sender_ligand_assign sender_ligand_assign appli functionxxx true purrrkeepfunctionxlengthx namessender_ligand_assign b nk mono dc top ligand seem strongli express b cell nk cell monocyt dc know also look ligand common across multipl cell type specif gt cell type assign cell type previou block code determin priorit ligand express caf endotheli cell r all_assigned_ligand sender_ligand_assign lapplyfunctionxnamesx unlist unique_ligand all_assigned_ligand tabl name general_ligand nichenet_outputtop_ligand setdiffunique_ligand b_specific_ligand sender_ligand_assignmentb name setdiffgeneral_ligand nk_specific_ligand sender_ligand_assignmentnk name setdiffgeneral_ligand mono_specific_ligand sender_ligand_assignmentmono name setdiffgeneral_ligand dc_specific_ligand sender_ligand_assignmentdc name setdiffgeneral_ligand ligand_type_indication_df tibbl ligand_typ crepbspecif time b_specific_ligand length repnkspecif time nk_specific_ligand length repmonospecif time mono_specific_ligand length repdcspecif time dc_specific_ligand length repgener time general_ligand length ligand cb_specific_ligand nk_specific_ligand mono_specific_ligand dc_specific_ligand general_ligand defin ligandtarget link interest avoid make circo plot mani ligandtarget link show link weight higher predefin cutoff link belong lowest score remov cutoff cutoff use visual chang accord user need r active_ligand_target_links_df nichenet_outputligand_target_df mutatetarget_typ lcmvde inner_joinligand_type_indication_df want ot make circo plot multipl gene set combin differ data frame differenti target belong gene set via target type cutoff_include_all_ligand active_ligand_target_links_dfweight quantil active_ligand_target_links_df_circo active_ligand_target_links_df filterweight cutoff_include_all_ligand ligands_to_remov setdiffactive_ligand_target_links_dfligand uniqu active_ligand_target_links_df_circosligand uniqu targets_to_remov setdiffactive_ligand_target_links_dftarget uniqu active_ligand_target_links_df_circostarget uniqu circos_link active_ligand_target_links_df filtertarget targets_to_remov ligand ligands_to_remov prepar circo visual give segment ligand target specif color order r grid_col_ligand cgener lawngreen nkspecif royalblu bspecif darkgreen monospecif violet dcspecif steelblu grid_col_target c lcmvde tomato grid_col_tbl_ligand tibbleligand_typ grid_col_ligand name color_ligand_typ grid_col_ligand grid_col_tbl_target tibbletarget_typ grid_col_target name color_target_typ grid_col_target circos_link circos_link mutateligand pasteligand extra space make differ gene ligand gene target circos_link circos_link inner_joingrid_col_tbl_ligand inner_joingrid_col_tbl_target links_circl circos_link selectligandtarget weight ligand_color circos_link distinctligandcolor_ligand_typ grid_ligand_color ligand_colorcolor_ligand_typ set_namesligand_colorligand target_color circos_link distincttargetcolor_target_typ grid_target_color target_colorcolor_target_typ set_namestarget_colortarget grid_col cgrid_ligand_colorgrid_target_color give option link circo plot transpar ligandtarget potenti score transpar circos_link mutateweight weightminweightmaxweightminweight mutatetranspar weight transpar prepar circo visual order ligand target r target_ord circos_linkstarget uniqu ligand_ord cmono_specific_ligand dc_specific_ligand nk_specific_ligandsb_specific_ligand general_ligand cpast intersectcircos_linksligand order cligand_ordertarget_ord prepar circo visual defin gap differ segment r width_same_cell_same_ligand_typ width_different_cel width_ligand_target width_same_cell_same_target_typ gap c width_ligand_target repwidth_same_cell_same_ligand_typ time circos_link filterligand_typ monospecif distinctligand nrow width_different_cel repwidth_same_cell_same_ligand_typ time circos_link filterligand_typ dcspecif distinctligand nrow width_different_cel repwidth_same_cell_same_ligand_typ time circos_link filterligand_typ nkspecif distinctligand nrow width_different_cel repwidth_same_cell_same_ligand_typ time circos_link filterligand_typ bspecif distinctligand nrow width_different_cel repwidth_same_cell_same_ligand_typ time circos_link filterligand_typ gener distinctligand nrow width_ligand_target repwidth_same_cell_same_target_typ time circos_link filtertarget_typ lcmvde distincttarget nrow width_ligand_target render circo plot link transpar width block indic target gene proport ligandtarget regulatori potenti prior knowledg support regulatori interact r circospargapdegre gap chorddiagramlinks_circl direct orderorderlinksort true linkdecreas fals gridcol grid_coltranspar diffheight directiontyp cdiffheight arrowslinkarrtyp bigarrow linkvis links_circleweight cutoff_include_all_ligandsannotationtrack grid preallocatetrack listtrackheight go back first track custom sector label circostracktrackindex panelfun functionx circostextcell_metaxcent cell_metaylim cell_metasectorindex face clockwis nicefac true adj c cex bgborder na seurat_wrapper_circos_filesfiguregfmunnamedchunkpng r circosclear render circo plot degre transpar determin regulatori potenti valu ligandtarget interact r circospargapdegre gap chorddiagramlinks_circl direct orderorderlinksort true linkdecreas fals gridcol grid_coltranspar transpar diffheight directiontyp cdiffheight arrowslinkarrtyp bigarrow linkvis links_circleweight cutoff_include_all_ligandsannotationtrack grid preallocatetrack listtrackheight go back first track custom sector label circostracktrackindex panelfun functionx circostextcell_metaxcent cell_metaylim cell_metasectorindex face clockwis nicefac true adj c cex bgborder na seurat_wrapper_circos_filesfiguregfmunnamedchunkpng r circosclear save circo plot svg file r svgligand_target_circossvg width height circospargapdegre gap chorddiagramlinks_circl direct orderorderlinksort true linkdecreas fals gridcol grid_coltranspar transpar diffheight directiontyp cdiffheight arrowslinkarrtyp bigarrow linkvis links_circleweight cutoff_include_all_ligandsannotationtrack grid preallocatetrack listtrackheight go back first track custom sector label circostracktrackindex panelfun functionx circostextcell_metaxcent cell_metaylim cell_metasectorindex face clockwis nicefac true adj c cex bgborder na circosclear devoff png visual ligandreceptor interact priorit ligand circo plot r lr_network_top_df nichenet_outputligand_receptor_df mutatereceptor_typ lcmv_cdt_receptor inner_joinligand_type_indication_df r grid_col_ligand cgener lawngreen nkspecif royalblu bspecif darkgreen monospecif violet dcspecif steelblu grid_col_receptor c lcmv_cdt_receptor darkr grid_col_tbl_ligand tibbleligand_typ grid_col_ligand name color_ligand_typ grid_col_ligand grid_col_tbl_receptor tibblereceptor_typ grid_col_receptor name color_receptor_typ grid_col_receptor circos_link lr_network_top_df mutateligand pasteligand extra space make differ gene ligand gene receptor circos_link circos_link inner_joingrid_col_tbl_ligand inner_joingrid_col_tbl_receptor links_circl circos_link selectligandreceptor weight ligand_color circos_link distinctligandcolor_ligand_typ grid_ligand_color ligand_colorcolor_ligand_typ set_namesligand_colorligand receptor_color circos_link distinctreceptorcolor_receptor_typ grid_receptor_color receptor_colorcolor_receptor_typ set_namesreceptor_colorreceptor grid_col cgrid_ligand_colorgrid_receptor_color give option link circo plot transpar ligandreceptor potenti score transpar circos_link mutateweight weightminweightmaxweightminweight mutatetranspar weight transpar prepar circo visual order ligand receptor r receptor_ord circos_linksreceptor uniqu ligand_ord cmono_specific_ligand dc_specific_ligand nk_specific_ligandsb_specific_ligand general_ligand cpast intersectcircos_linksligand order cligand_orderreceptor_ord prepar circo visual defin gap differ segment r width_same_cell_same_ligand_typ width_different_cel width_ligand_receptor width_same_cell_same_receptor_typ gap c width_ligand_target repwidth_same_cell_same_ligand_typ time circos_link filterligand_typ monospecif distinctligand nrow width_different_cel repwidth_same_cell_same_ligand_typ time circos_link filterligand_typ dcspecif distinctligand nrow width_different_cel repwidth_same_cell_same_ligand_typ time circos_link filterligand_typ nkspecif distinctligand nrow width_different_cel repwidth_same_cell_same_ligand_typ time circos_link filterligand_typ bspecif distinctligand nrow width_different_cel repwidth_same_cell_same_ligand_typ time circos_link filterligand_typ gener distinctligand nrow width_ligand_receptor repwidth_same_cell_same_receptor_typ time circos_link filterreceptor_typ lcmv_cdt_receptor distinctreceptor nrow width_ligand_receptor render circo plot link transpar width block indic receptor proport ligandreceptor interact weight prior knowledg support interact r circospargapdegre gap chorddiagramlinks_circl direct orderorderlinksort true linkdecreas fals gridcol grid_coltranspar diffheight directiontyp cdiffheight arrowslinkarrtyp bigarrow linkvis links_circleweight cutoff_include_all_ligandsannotationtrack grid preallocatetrack listtrackheight go back first track custom sector label circostracktrackindex panelfun functionx circostextcell_metaxcent cell_metaylim cell_metasectorindex face clockwis nicefac true adj c cex bgborder na seurat_wrapper_circos_filesfiguregfmunnamedchunkpng r circosclear render circo plot degre transpar determin prior interact weight ligandreceptor interact width block indic receptor r circospargapdegre gap chorddiagramlinks_circl direct orderorderlinksort true linkdecreas fals gridcol grid_coltranspar transpar diffheight directiontyp cdiffheight arrowslinkarrtyp bigarrow linkvis links_circleweight cutoff_include_all_ligandsannotationtrack grid preallocatetrack listtrackheight go back first track custom sector label circostracktrackindex panelfun functionx circostextcell_metaxcent cell_metaylim cell_metasectorindex face clockwis nicefac true adj c cex bgborder na seurat_wrapper_circos_filesfiguregfmunnamedchunkpng r circosclear save circo plot svg file r svgligand_receptor_circossvg width height circospargapdegre gap chorddiagramlinks_circl direct orderorderlinksort true linkdecreas fals gridcol grid_coltranspar transpar diffheight directiontyp cdiffheight arrowslinkarrtyp bigarrow linkvis links_circleweight cutoff_include_all_ligandsannotationtrack grid preallocatetrack listtrackheight go back first track custom sector label circostracktrackindex panelfun functionx circostextcell_metaxcent cell_metaylim cell_metasectorindex face clockwis nicefac true adj c cex bgborder na circosclear devoff png convert nichenet model human mous symbol robin browaey github markdown built use rmarkdownrendervignettessymbol_conversionrmd output_format github_docu vignett show convert nichenet ligandtarget matrix model human mous gene symbol necessari want appli nichenet mous express data nichenet prior inform given human gene symbol data sourc basi nichenet base human data onetoon ortholog gather ncbi homologen also ensembl via biomart load requir packag r librarynichenetr librarytidyvers load nichenet ligandtarget model r ligand_target_matrix readrdsurlhttpszenodoorgrecordfilesligand_target_matrixrd ligand_target_matrix target gene row ligand column cxcl cxcl cxcl cxcl ppbp abg e e e e e abga e e e e e acf e e e e e e e e e e ama e e e e e dimligand_target_matrix convert ligandtarget model human mous symbol human gene mous onetoon ortholog gene remov mous model r colnamesligand_target_matrix ligand_target_matrix colnam convert_human_to_mouse_symbol rownamesligand_target_matrix ligand_target_matrix rownam convert_human_to_mouse_symbol ligand_target_matrix ligand_target_matrix isnarownamesligand_target_matrix isnacolnamesligand_target_matrix dimligand_target_matrix show top target tnf mous symbol r top_target extract_top_n_targetstnfligand_target_matrix name top_target hacd ph sele vcam ubd ccl mucac cxcl crp icam want convert mous human symbol use r top_target convert_mouse_to_human_symbol hacd ph sele vcam ubd ccl mucac cxcl hacd ph sele vcam ubd ccl mucac cxcl crp icam crp icam differenti nichenet analysi nich interest robin browaey github markdown built use rmarkdownrendervignettesdifferential_nichenetrmd output_format github_docu vignett guid detail step differenti nichenet analysi exampl express data interact cell use subset liver scrnaseq data gener paper guilliam et al spatial proteogenom reveal distinct evolutionarili conserv hepat macrophag nicheshttpswwwsciencedirectcomsciencearticlepii took subset data deposit httpszenodoorgdeposit demonstr purpos larg size entir dataset explor download data paper refer liver atla data portalhttpswwwlivercellatlasorg code use differenti nichenet analys entir liver cell atla dataset see httpsgithubcomsaeyslabnichenet_livercellatla goal differenti nichenet predict ligandreceptor pair differenti express activ differ nich interest vignett look cellcel commun differ kupffer cell nich bile duct macrophag nich capsul macrophag nich macrophag nich receiv cell interest mean interest identifi nichespecif ligand import ident macrophag subtyp read express data interest nichenet ligandreceptor network ligandtarget matrix load packag r librarynichenetr libraryrcolorbrew librarytidyvers libraryseurat read express data r seurat_obj readrdsurlhttpszenodoorgrecordfilesseurat_obj_subset_integrated_zonationrd dimplotseurat_obj groupbi celltyp label true differential_nichenet_filesfiguregfmunnamedchunkpng r seurat_obj setidentseurat_obj valu celltyp see lsec hepatocyt stellat cell divid two group base spatial locat periport pericentr read nichenet ligandreceptor network ligandtarget matrix use ligandreceptor network ligandtarget matrix download zenodo doihttpszenodoorgbadgedoizenodosvghttpsdoiorgzenodo seurat object contain express data interact cell hnscc also download zenodo doihttpszenodoorgbadgedoizenodosvghttpsdoiorgzenodo r ligand_target_matrix readrdsurlhttpszenodoorgrecordfilesligand_target_matrixrd ligand_target_matrix target gene row ligand column cxcl cxcl cxcl cxcl ppbp abg e e e e e abga e e e e e acf e e e e e e e e e e ama e e e e e r lr_network readrdsurlhttpszenodoorgrecordfileslr_networkrd lr_network lr_network mutatebonafid databas cppi_predictionppi_prediction_go lr_network lr_network dplyrrenameligand receptor distinctligand receptor bonafid headlr_network tibbl x ligand receptor bonafid chr chr lgl cxcl cxcr true cxcl cxcr true cxcl cxcr true cxcl cxcr true ppbp cxcr true cxcl cxcr true note data mous origin need convert human gene symbol murin onetoon ortholog r organ mous r iforgan mous lr_network lr_network mutateligand convert_human_to_mouse_symbolsligand receptor convert_human_to_mouse_symbolsreceptor drop_na colnamesligand_target_matrix ligand_target_matrix colnam convert_human_to_mouse_symbol rownamesligand_target_matrix ligand_target_matrix rownam convert_human_to_mouse_symbol ligand_target_matrix ligand_target_matrix isnarownamesligand_target_matrix isnacolnamesligand_target_matrix defin nichesmicroenviron interest nich least one sendernich cell popul one receivertarget cell popul present express data case studi interest find differ cellcel interact hepat macrophag three differ nich kupffer cell nich bileduct lipidassoci macrophag nich capsul macrophag nich base imag spatial transcriptom composit nich defin follow receiv cell popul kupffer cell nich kc cell type sender cell type lsecs_portalhepatocytes_port stellat cells_port receiv cell popul lipidassoci macrophag momac nich momac cell type sender cell type cholangiocyt fibroblast receiv cell popul capsul macrophag momac nich momac cell type sender cell type capsul fibroblast mesotheli cell import receiv cell type consist cluster r nich list kc_nich list sender clsecs_portalhepatocytes_portalstel cells_port receiv ckc momac_nich list sender ccholangiocytesfibroblast receiv cmomac momac_nich list sender ccapsul fibroblastsmesotheli cell receiv cmomac calcul differenti express nich step determin de differ nich sender receiv defin de lr pair calcul de method calcul differenti express standard seurat wilcoxon test replac want user requir output tabl de_sender_process de_receiver_process format shown de calcul pairwis sender receiv cell type comparis nich across nich within nich case studi mean eg de lsecs_port ligand calcul de analysi lsecs_port vs cholangiocyt lsecs_port vs fibroblast lsecs_port vs capsul fibroblast lsecs_port vs mesotheli cell split cell per cell type instead merg cell nich avoid de analysi driven abund cell type r assay_oi sct possibl rna de_send calculate_niche_deseurat_obj seurat_obj subsetfeatur lr_networkligand intersectrownamesseurat_obj nich nich type sender assay_oi assay_oi ligand import sender cell type calcul sender de lsecs_port cholangiocyt calcul sender de lsecs_port fibroblast calcul sender de lsecs_port capsul fibroblast calcul sender de lsecs_port mesotheli cell calcul sender de hepatocytes_port cholangiocyt calcul sender de hepatocytes_port fibroblast calcul sender de hepatocytes_port capsul fibroblast calcul sender de hepatocytes_port mesotheli cell calcul sender de stellat cells_port cholangiocyt calcul sender de stellat cells_port fibroblast calcul sender de stellat cells_port capsul fibroblast calcul sender de stellat cells_port mesotheli cell calcul sender de cholangiocyt lsecs_port calcul sender de cholangiocyt hepatocytes_port calcul sender de cholangiocyt stellat cells_port calcul sender de cholangiocyt capsul fibroblast calcul sender de cholangiocyt mesotheli cell calcul sender de fibroblast lsecs_port calcul sender de fibroblast hepatocytes_port calcul sender de fibroblast stellat cells_port calcul sender de fibroblast capsul fibroblast calcul sender de fibroblast mesotheli cell calcul sender de capsul fibroblast lsecs_port calcul sender de capsul fibroblast hepatocytes_port calcul sender de capsul fibroblast stellat cells_port calcul sender de capsul fibroblast cholangiocyt calcul sender de capsul fibroblast fibroblast calcul sender de mesotheli cell lsecs_port calcul sender de mesotheli cell hepatocytes_port calcul sender de mesotheli cell stellat cells_port calcul sender de mesotheli cell cholangiocyt calcul sender de mesotheli cell fibroblast de_receiv calculate_niche_deseurat_obj seurat_obj subsetfeatur lr_networkreceptor uniqu nich nich type receiv assay_oi assay_oi receptor later de analysi find target tibbl x receiv receiver_other_nich chr chr kc momac kc momac momac momac calcul receiv de kc momac calcul receiv de kc momac calcul receiv de momac kc calcul receiv de momac momac calcul receiv de momac kc calcul receiv de momac momac process de result r expression_pct de_sender_process process_niche_dede_t de_send nich nich expression_pct expression_pct type sender de_receiver_process process_niche_dede_t de_receiv nich nich expression_pct expression_pct type receiv combin senderreceiv de base lr pair mention de ligand one sender cell type determin calcul de cell type sender cell type nich summar de ligand cell type sever option could take averag lfc also minimum lfc compar nich recommend use minimum lfc strongest specif measur ligand express high min lfc mean ligand strongli express cell type nich compar cell type nich contrast high averag lfc exclud one cell type nich also strongli express ligand r specificity_score_lr_pair min_lfc de_sender_receiv combine_sender_receiver_dede_sender_process de_receiver_process lr_network specificity_scor specificity_score_lr_pair option calcul differenti express differ spatial region improv cellcel interact predict consid spatial inform possibl applic spatial inform come microscopi data spatial transcriptom data visium sever way incorpor spatial inform differenti nichenet pipelin first consid cell type belong nich spatial locat anoth way includ spatial differenti express ligandreceptor pair within one cell type priorit framework exampl cell type x locat region b want studi cellcel commun region first add celltypex regiona nich definit calcul de celltypexregiona celltypexregionb give higher priorit weight regionaspecif ligand case studi region interest periport region liver kc mous predominantli locat periport region therefor give higher weight ligand nich cell kc higher express periport compar pericentr region follow first defin spatial info datafram spatial inform data set follow two paramet fals make mock spatial_info data frame r include_spatial_info_send true spatial info includ put fals include_spatial_info_receiv fals spatial info includ put true r spatial_info tibblecelltype_region_oi clsecs_portalhepatocytes_portalstel cells_port celltype_other_region clsecs_centralhepatocytes_centralstel cells_centr mutatenich kc_nich celltype_typ sender specificity_score_spati lfc r defin dont spatial info mock spatial info ifinclude_spatial_info_send fals include_spatial_info_receiv fals spatial_info tibblecelltype_region_oi na celltype_other_region na mutatenich nich name head celltype_typ sender r ifinclude_spatial_info_send true sender_spatial_d calculate_spatial_deseurat_obj seurat_obj subsetfeatur lr_networkligand uniqu spatial_info spatial_info filtercelltype_typ sender assay_oi assay_oi sender_spatial_de_process process_spatial_dede_t sender_spatial_d type sender lr_network lr_network expression_pct expression_pct specificity_scor specificity_score_spati add neutral spatial score sender celltyp spatial known import sender_spatial_de_oth get_non_spatial_denich nich spatial_info spatial_info type sender lr_network lr_network sender_spatial_de_process sender_spatial_de_process bind_rowssender_spatial_de_oth sender_spatial_de_process sender_spatial_de_process mutatescaled_ligand_score_spati scale_quantile_adaptedligand_score_spati els add neutral spatial score sender celltyp none spatial relev case sender_spatial_de_process get_non_spatial_denich nich spatial_info spatial_info type sender lr_network lr_network sender_spatial_de_process sender_spatial_de_process mutatescaled_ligand_score_spati scale_quantile_adaptedligand_score_spati calcul spatial de lsecs_port lsecs_centr calcul spatial de hepatocytes_port hepatocytes_centr calcul spatial de stellat cells_port stellat cells_centr r ifinclude_spatial_info_receiv true receiver_spatial_d calculate_spatial_deseurat_obj seurat_obj subsetfeatur lr_networkreceptor uniqu spatial_info spatial_info filtercelltype_typ receiv assay_oi assay_oi receiver_spatial_de_process process_spatial_dede_t receiver_spatial_d type receiv lr_network lr_network expression_pct expression_pct specificity_scor specificity_score_spati add neutral spatial score receiv celltyp spatial known import receiver_spatial_de_oth get_non_spatial_denich nich spatial_info spatial_info type receiv lr_network lr_network receiver_spatial_de_process receiver_spatial_de_process bind_rowsreceiver_spatial_de_oth receiver_spatial_de_process receiver_spatial_de_process mutatescaled_receptor_score_spati scale_quantile_adaptedreceptor_score_spati els add neutral spatial score receiv celltyp none spatial relev case receiver_spatial_de_process get_non_spatial_denich nich spatial_info spatial_info type receiv lr_network lr_network receiver_spatial_de_process receiver_spatial_de_process mutatescaled_receptor_score_spati scale_quantile_adaptedreceptor_score_spati calcul ligand activ infer activ ligandtarget link step predict ligand activ ligand receiv cell type across differ nich similar ligand activ analysi done normal nichenet pipelin calcul ligand activ first need defin geneset interest nich case studi geneset interest kupffer cell nich gene upregul kupffer cell compar capsul bile duct macrophag geneset interest bile duct macrophag nich gene upregul bile duct macrophag compar capsul macrophag kupffer cell similarli capsul macrophag geneset interest note also defin geneset interest differ way eg pathwaybas geneset etc ligandtarget link infer way describ basic nichenet vignett r lfc_cutoff recommend x min_lfc cutoff specificity_score_target min_lfc de_receiver_target calculate_niche_de_targetsseurat_obj seurat_obj nich nich lfc_cutoff lfc_cutoff expression_pct expression_pct assay_oi assay_oi calcul receiv de kc momac calcul receiv de kc momac calcul receiv de momac kc calcul receiv de momac momac calcul receiv de momac kc calcul receiv de momac momac de_receiver_processed_target process_receiver_target_dede_receiver_target de_receiver_target nich nich expression_pct expression_pct specificity_scor specificity_score_target background de_receiver_processed_target pulltarget uniqu geneset_kc de_receiver_processed_target filterreceiv nicheskc_nichereceiv target_scor lfc_cutoff target_signific target_pres pulltarget uniqu geneset_momac de_receiver_processed_target filterreceiv nichesmomac_nichereceiv target_scor lfc_cutoff target_signific target_pres pulltarget uniqu geneset_momac de_receiver_processed_target filterreceiv nichesmomac_nichereceiv target_scor lfc_cutoff target_signific target_pres pulltarget uniqu good idea check gene left ligand activ analysi present rownam ligandtarget matrix mani gene left might point issu gene name eg gene alias old gene symbol bad humanmous map geneset_kc setdiffrownamesligand_target_matrix fcna wfdc cb aw mtco adgr pira mtnd mtco mtco mtnd mtatp mtnd mtnd iigp ear crik anapc bnrik trima pilrb gbp arf ac xlr cdf mtcytb ifitm mndal gm ifi serpinag geneset_momac setdiffrownamesligand_target_matrix chil lyz ccl lyc tmsb gm calm sa ftlp gm msac atp snrpe cleca lyi irik aphc coxc atpo rpl cbr rtf gm snhg cleci ai ggta pppcc rplp eifsi gstp gm cypc mup cesa rpsp geneset_momac setdiffrownamesligand_target_matrix hab malat haa gm hm mgl klra hd hq lengthgeneset_kc lengthgeneset_momac lengthgeneset_momac alway use check number gene geneset ligand activ analysi recommend gene geneset interest background least gene proper ligand activ analysi retriev mani de gene recommend use higher lfc_cutoff threshold recommend use cutoff gt receiv cellsnich compar use min_lfc specif score receiversnich recommend use higher threshold use singlecel data like smartseq high sequenc depth recommend also use higher threshold r top_n_target niche_geneset_list list kc_nich list receiv kc geneset geneset_kc background background momac_nich list receiv momac geneset geneset_momac background background momac_nich list receiv momac geneset geneset_momac background background ligand_activities_target get_ligand_activities_targetsniche_geneset_list niche_geneset_list ligand_target_matrix ligand_target_matrix top_n_target top_n_target calcul ligand activ kc calcul ligand activ momac calcul ligand activ momac calcul scale express ligand receptor target across cell type interest log express valu express fraction step calcul averag scale express fraction express ligand receptor target gene across cell type interest demonstr via dotplot function seurat also done via way cours r features_oi unionlr_networkligand lr_networkreceptor unionligand_activities_targetstarget setdiffna dotplot suppresswarningsseuratdotplotseurat_obj subsetid nich unlist uniqu featur features_oi assay assay_oi exprs_tbl dotplotdata as_tibbl exprs_tbl exprs_tbl renamecelltyp id gene featuresplot express avgexp expression_sc avgexpsc fraction pctexp mutatefract fraction as_tibbl selectcelltyp gene express expression_sc fraction distinct arrangegen mutategen ascharactergen exprs_tbl_ligand exprs_tbl filtergen lr_networkligand renamesend celltyp ligand gene ligand_express express ligand_expression_sc expression_sc ligand_fract fraction exprs_tbl_receptor exprs_tbl filtergen lr_networkreceptor renamereceiv celltyp receptor gene receptor_express express receptor_expression_sc expression_sc receptor_fract fraction exprs_tbl_target exprs_tbl filtergen ligand_activities_targetstarget renamereceiv celltyp target gene target_express express target_expression_sc expression_sc target_fract fraction r exprs_tbl_ligand exprs_tbl_ligand mutatescaled_ligand_expression_sc scale_quantile_adaptedligand_expression_sc mutateligand_fraction_adapt ligand_fract mutate_condligand_fract expression_pct ligand_fraction_adapt expression_pct mutatescaled_ligand_fraction_adapt scale_quantile_adaptedligand_fraction_adapt exprs_tbl_receptor exprs_tbl_receptor mutatescaled_receptor_expression_sc scale_quantile_adaptedreceptor_expression_sc mutatereceptor_fraction_adapt receptor_fract mutate_condreceptor_fract expression_pct receptor_fraction_adapt expression_pct mutatescaled_receptor_fraction_adapt scale_quantile_adaptedreceptor_fraction_adapt express fraction receptor step score ligandreceptor interact base express strength receptor way give higher score strongli express receptor certain ligand certain celltyp effect rank individu ligand later help priorit import receptor per ligand next factor regard receptor see later r exprs_sender_receiv lr_network inner_joinexprs_tbl_ligand cligand inner_joinexprs_tbl_receptor creceptor inner_joinde_sender_receiv distinctnich sender receiv ligand_scaled_receptor_expression_fraction_df exprs_sender_receiv group_byligand receiv mutaterank_receptor_express dense_rankreceptor_express rank_receptor_fract dense_rankreceptor_fract mutateligand_scaled_receptor_expression_fract rank_receptor_fract maxrank_receptor_fract rank_receptor_express maxrank_receptor_express distinctligand receptor receiv ligand_scaled_receptor_expression_fract bonafid distinct ungroup priorit ligandreceptor ligandtarget link step combin calcul inform priorit ligandreceptortarget link scale everi properti interest final priorit score weight sum scale score properti interest provid user option consid follow properti priorit weight defin prioritizing_weight ligand de score nichespecif express ligand default minimum logfc sender interest sender nich higher min logfc higher nichespecif ligand therefor recommend give factor high weight prioritizing_weight argument scaled_ligand_scor recommend weight least max scale ligand express scale express ligand one sender compar cell type dataset might use rescu potenti interest ligand high scale express valu rel small min logfc compar nich one reason logfc might small occur gene pick effici use sequenc technolog reason low rna express ligand exampl observ mani ligand tgfbetabmp famili pick effici singlenuclei rna sequenc compar singlecel sequenc prioritizing_weight argument scaled_ligand_expression_sc recommend weight unless technic reason lower gene detect use nucseq recommend use higher weight ligand express fraction ligand express smaller fraction cell cell type defin exprs_cutoffdefault get lower rank proport fraction eg ligand express cell rank higher ligand express cell opt weight base fraction instead remov ligand express cell cutoff interest ligand could remov way fraction express taken account priorit alreadi higher cutoff prioritizing_weight argument ligand_fract recommend weight ligand spatial de score spatial express specif ligand nich interest specif tissu locat sender cell type nich also present locat inform priorit ligand sender look de spatial locat interest compar locat prioritizing_weight argument scaled_ligand_score_spati recommend weight applic receptor de score nichespecif express receptor default minimum logfc receiv interest receiv nich higher min logfc higher nichespecif receptor base experi dont suggest give high import ligand de might depend specif case studi prioritizing_weight argument scaled_receptor_scor recommend weight least lower scaled_ligand_scor scale receptor express scale express receptor one receiv compar cell type dataset might use rescu potenti interest receptor high scale express valu rel small min logfc compar nich one reason logfc might small occur gene pick effici use sequenc technolog prioritizing_weight argument scaled_receptor_expression_sc recommend weight receptor express fraction receptor express smaller fraction cell cell type defin exprs_cutoffdefault get lower rank proport fraction eg receptor express cell rank higher receptor express cell opt weight base fraction instead remov receptor express cell cutoff interest receptor could remov way fraction express taken account priorit alreadi higher cutoff prioritizing_weight argument receptor_fract recommend weight receptor express strength factor let us give higher weight highli express receptor ligand receiv let us rank higher one member receptor famili higher express member prioritizing_weight argument ligand_scaled_receptor_expression_fract recommend valu minimum receptor spatial de score spatial express specif receptor nich interest specif tissu locat receiv cell type nich also present locat inform priorit receptor receiv look de spatial locat interest compar locat prioritizing_weight argument scaled_receptor_score_spati recommend weight applic absolut ligand activ priorit ligandreceptor pair base predict effect ligandreceptor interact gene express receiv cell type absolut ligand activ accord absolut enrich target gene ligand within affect receiv gene prioritizing_weight argument scaled_act recommend weight unless absolut enrich target gene specif interest normal ligand activ priorit ligandreceptor pair base predict effect ligandreceptor interact gene express receiv cell type normal activ done found datasetsconditionsnich higher baselin activ valu other normal ligand activ accord rel enrich target gene ligand within affect receiv gene prioritizing_weight argument scaled_activity_norm recommend weight least prior knowledg qualiti lr interact nichenet lr network consist two type interact lr pair document curat databas lr pair predict base gene annot ppi former categor bona fide interact rank bona fide interact higher exlud potenti interest nonbonafid one give bona fide interact score nonbonafid interact score fof prioritizing_weight argument bona_fid recommend weight least r prioritizing_weight cscaled_ligand_scor scaled_ligand_expression_sc ligand_fract scaled_ligand_score_spati scaled_receptor_scor scaled_receptor_expression_sc receptor_fract ligand_scaled_receptor_expression_fract scaled_receptor_score_spati scaled_act scaled_activity_norm bona_fid r output listde_sender_receiv de_sender_receiv ligand_scaled_receptor_expression_fraction_df ligand_scaled_receptor_expression_fraction_df sender_spatial_de_process sender_spatial_de_process receiver_spatial_de_process receiver_spatial_de_process ligand_activities_target ligand_activities_target de_receiver_processed_target de_receiver_processed_target exprs_tbl_ligand exprs_tbl_ligand exprs_tbl_receptor exprs_tbl_receptor exprs_tbl_target exprs_tbl_target prioritization_t get_prioritization_tablesoutput prioritizing_weight prioritization_tablesprioritization_tbl_ligand_receptor filterreceiv nichesreceiv head tibbl x nich receiv sender ligand_receptor ligand receptor bonafid ligand_scor ligand_signif ligand_pres ligand_expressi chr chr chr chr chr chr lgl dbl dbl dbl dbl kc_nich kc hepat apoalrp apoa lrp fals kc_nich kc hepat apoamsr apoa msr fals kc_nich kc hepat apoaabca apoa abca fals kc_nich kc hepat apoascarb apoa scarb fals kc_nich kc hepat apoaderl apoa derl fals kc_nich kc hepat apoaatpb apoa atpb fals kc_nich kc hepat serpinaalrp serpi lrp true kc_nich kc hepat trftfrc trf tfrc true kc_nich kc lsec cxclfpr cxcl fpr fals kc_nich kc lsec cxclccr cxcl ccr fals variabl ligand_expression_sc dbl ligand_fract dbl ligand_score_spati dbl receptor_scor dbl receptor_signific dbl receptor_pres dbl receptor_express dbl receptor_expression_sc dbl receptor_fract dbl receptor_score_spati dbl ligand_scaled_receptor_expression_fract dbl avg_score_ligand_receptor dbl activ dbl activity_norm dbl scaled_ligand_scor dbl scaled_ligand_expression_sc dbl scaled_receptor_scor dbl scaled_receptor_expression_sc dbl scaled_avg_score_ligand_receptor dbl scaled_ligand_score_spati dbl scaled_receptor_score_spati dbl scaled_ligand_fraction_adapt dbl scaled_receptor_fraction_adapt dbl prioritization_tablesprioritization_tbl_ligand_target filterreceiv nichesreceiv head tibbl x nich receiv sender ligand_receptor ligand receptor bonafid target target_scor target_significa target_pres chr chr chr chr chr chr lgl chr dbl dbl dbl kc_nich kc hepatocytes_p apoalrp apoa lrp fals abca kc_nich kc hepatocytes_p apoalrp apoa lrp fals actb kc_nich kc hepatocytes_p apoalrp apoa lrp fals ehd kc_nich kc hepatocytes_p apoalrp apoa lrp fals et kc_nich kc hepatocytes_p apoalrp apoa lrp fals hmox kc_nich kc hepatocytes_p apoalrp apoa lrp fals nrf kc_nich kc hepatocytes_p apoalrp apoa lrp fals sgk kc_nich kc hepatocytes_p apoalrp apoa lrp fals sptbn kc_nich kc hepatocytes_p apoalrp apoa lrp fals tcfl kc_nich kc hepatocytes_p apoalrp apoa lrp fals tscd variabl target_express dbl target_expression_sc dbl target_fract dbl ligand_target_weight dbl activ dbl activity_norm dbl scaled_act dbl scaled_activity_norm dbl prioritization_scor dbl prioritization_tablesprioritization_tbl_ligand_receptor filterreceiv nichesreceiv head tibbl x nich receiv sender ligand_receptor ligand receptor bonafid ligand_scor ligand_signif ligand_pres ligand_expressi chr chr chr chr chr chr lgl dbl dbl dbl dbl momac momac cholan sppcd spp cd true momac momac cholan sppitga spp itga true momac momac cholan sppitgb spp itgb true momac momac cholan sppitgav spp itgav true momac momac cholan sppitgb spp itgb true momac momac cholan sppitga spp itga true momac momac cholan sppncstn spp ncstn fals momac momac cholan sppitga spp itga fals momac momac cholan cyritgb cyr itgb true momac momac cholan sppsdc spp sdc fals variabl ligand_expression_sc dbl ligand_fract dbl ligand_score_spati dbl receptor_scor dbl receptor_signific dbl receptor_pres dbl receptor_express dbl receptor_expression_sc dbl receptor_fract dbl receptor_score_spati dbl ligand_scaled_receptor_expression_fract dbl avg_score_ligand_receptor dbl activ dbl activity_norm dbl scaled_ligand_scor dbl scaled_ligand_expression_sc dbl scaled_receptor_scor dbl scaled_receptor_expression_sc dbl scaled_avg_score_ligand_receptor dbl scaled_ligand_score_spati dbl scaled_receptor_score_spati dbl scaled_ligand_fraction_adapt dbl scaled_receptor_fraction_adapt dbl prioritization_tablesprioritization_tbl_ligand_target filterreceiv nichesreceiv head tibbl x nich receiv sender ligand_receptor ligand receptor bonafid target target_scor target_significa target_pres chr chr chr chr chr chr lgl chr dbl dbl dbl momac_nich momac cholangioc sppcd spp cd true ahnak momac_nich momac cholangioc sppcd spp cd true capn momac_nich momac cholangioc sppcd spp cd true cdkna momac_nich momac cholangioc sppcd spp cd true cxcr momac_nich momac cholangioc sppcd spp cd true dhr momac_nich momac cholangioc sppcd spp cd true fam momac_nich momac cholangioc sppcd spp cd true fn momac_nich momac cholangioc sppcd spp cd true gadd momac_nich momac cholangioc sppcd spp cd true gapdh momac_nich momac cholangioc sppcd spp cd true gdf variabl target_express dbl target_expression_sc dbl target_fract dbl ligand_target_weight dbl activ dbl activity_norm dbl scaled_act dbl scaled_activity_norm dbl prioritization_scor dbl prioritization_tablesprioritization_tbl_ligand_receptor filterreceiv nichesreceiv head tibbl x nich receiv sender ligand_receptor ligand receptor bonafid ligand_scor ligand_signif ligand_pres ligand_expressi chr chr chr chr chr chr lgl dbl dbl dbl dbl momac momac mesoth ccar c car true momac momac capsul ccar c car true momac momac mesoth citgb c itgb true momac momac mesoth citgax c itgax true momac momac capsul citgb c itgb true momac momac mesoth clrp c lrp true momac momac capsul citgax c itgax true momac momac capsul clrp c lrp true momac momac capsul rarrescmklr rarr cmklr true momac momac mesoth cccr c ccr fals variabl ligand_expression_sc dbl ligand_fract dbl ligand_score_spati dbl receptor_scor dbl receptor_signific dbl receptor_pres dbl receptor_express dbl receptor_expression_sc dbl receptor_fract dbl receptor_score_spati dbl ligand_scaled_receptor_expression_fract dbl avg_score_ligand_receptor dbl activ dbl activity_norm dbl scaled_ligand_scor dbl scaled_ligand_expression_sc dbl scaled_receptor_scor dbl scaled_receptor_expression_sc dbl scaled_avg_score_ligand_receptor dbl scaled_ligand_score_spati dbl scaled_receptor_score_spati dbl scaled_ligand_fraction_adapt dbl scaled_receptor_fraction_adapt dbl prioritization_tablesprioritization_tbl_ligand_target filterreceiv nichesreceiv head tibbl x nich receiv sender ligand_receptor ligand receptor bonafid target target_scor target_signif target_pres chr chr chr chr chr chr lgl chr dbl dbl dbl momac_nich momac mesotheli ccar c car true btg momac_nich momac mesotheli ccar c car true ccl momac_nich momac mesotheli ccar c car true ccnd momac_nich momac mesotheli ccar c car true ilb momac_nich momac mesotheli ccar c car true jun momac_nich momac mesotheli ccar c car true pdgfb momac_nich momac mesotheli ccar c car true tle momac_nich momac mesotheli ccar c car true ubc momac_nich momac capsul fib ccar c car true btg momac_nich momac capsul fib ccar c car true ccl variabl target_express dbl target_expression_sc dbl target_fract dbl ligand_target_weight dbl activ dbl activity_norm dbl scaled_act dbl scaled_activity_norm dbl prioritization_scor dbl prioritization_tablesprioritization_tbl_ligand_receptor prioritization_tablesprioritization_tbl_ligand_receptor mutatereceiv factorreceiv level ckcsmomacmomac nich factornich level ckc_nichemomac_nichemomac_nich prioritization_tablesprioritization_tbl_ligand_target prioritization_tablesprioritization_tbl_ligand_target mutatereceiv factorreceiv level ckcsmomacmomac nich factornich level ckc_nichemomac_nichemomac_nich visual differenti nichenet output differenti express ligand express visual need defin import ligandreceptor pair per nich first determin nich highest score found ligandligandreceptor pair get top ligand per nich r top_ligand_niche_df prioritization_tablesprioritization_tbl_ligand_receptor selectnich sender receiv ligand receptor prioritization_scor group_byligand top_n prioritization_scor ungroup selectligand receptor nich renametop_nich nich top_ligand_receptor_niche_df prioritization_tablesprioritization_tbl_ligand_receptor selectnich sender receiv ligand receptor prioritization_scor group_byligand receptor top_n prioritization_scor ungroup selectligand receptor nich renametop_nich nich ligand_prioritized_tbl_oi prioritization_tablesprioritization_tbl_ligand_receptor selectnich sender receiv ligand prioritization_scor group_byligand nich top_n prioritization_scor ungroup distinct inner_jointop_ligand_niche_df filternich top_nich group_bynich top_n prioritization_scor ungroup get top ligand per nich look first top ligandreceptor pair kc take top score receptor per priorit ligand r receiver_oi kc filtered_ligand ligand_prioritized_tbl_oi filterreceiv receiver_oi pullligand uniqu prioritized_tbl_oi prioritization_tablesprioritization_tbl_ligand_receptor filterligand filtered_ligand selectnich sender receiv ligand receptor ligand_receptor prioritization_scor distinct inner_jointop_ligand_receptor_niche_df group_byligand filterreceiv receiver_oi top_n prioritization_scor ungroup visual minimum lfc compar nich r lfc_plot make_ligand_receptor_lfc_plotreceiver_oi prioritized_tbl_oi prioritization_tablesprioritization_tbl_ligand_receptor plot_legend fals height null width null lfc_plot differential_nichenet_filesfiguregfmunnamedchunkpng show spatiald addit inform r lfc_plot_spati make_ligand_receptor_lfc_spatial_plotreceiver_oi prioritized_tbl_oi prioritization_tablesprioritization_tbl_ligand_receptor ligand_spati include_spatial_info_send receptor_spati include_spatial_info_receiv plot_legend fals height null width null lfc_plot_spati differential_nichenet_filesfiguregfmunnamedchunkpng plot see kcnich ligand like dll lsec il stellat cell higher express periport lsecstel cell vs pericentr one interest inform know kc mainli locat periport howev ligand like gdf stellat cell preferenti express periport stellat cell mean interest see follow figur ligand one highest ligand activ mean strong enrich target gene among kcspecif gene ligand express activ target gene activ target gene infer cf default nichenet visual ligand activ ligandtarget link r exprs_activity_target_plot make_ligand_activity_target_exprs_plotreceiver_oi prioritized_tbl_oi prioritization_tablesprioritization_tbl_ligand_receptor prioritization_tablesprioritization_tbl_ligand_target outputexprs_tbl_ligand outputexprs_tbl_target lfc_cutoff ligand_target_matrix plot_legend fals height null width null exprs_activity_target_plotcombined_plot differential_nichenet_filesfiguregfmunnamedchunkpng plot see strongli de ligandreceptor pair kc nich also high scale ligand activ kc make strong predict valid exampl gdf bmp bind receptor acvrl alk role gdfbmpacvrl kc develop experiment valid guilliam et al paper import ligandreceptor pair high differenti express ligand activ target gene enrich interest predict key regul intercellular commun process interest plot contain much inform look mani hit top ligand make plot cours less ligand well eg top r filtered_ligand ligand_prioritized_tbl_oi filterreceiv receiver_oi top_n prioritization_scor pullligand uniqu prioritized_tbl_oi prioritization_tablesprioritization_tbl_ligand_receptor filterligand filtered_ligand selectnich sender receiv ligand receptor ligand_receptor prioritization_scor distinct inner_jointop_ligand_receptor_niche_df group_byligand filterreceiv receiver_oi top_n prioritization_scor ungroup exprs_activity_target_plot make_ligand_activity_target_exprs_plotreceiver_oi prioritized_tbl_oi prioritization_tablesprioritization_tbl_ligand_receptor prioritization_tablesprioritization_tbl_ligand_target outputexprs_tbl_ligand outputexprs_tbl_target lfc_cutoff ligand_target_matrix plot_legend fals height null width null exprs_activity_target_plotcombined_plot differential_nichenet_filesfiguregfmunnamedchunkpng circo plot priorit ligandreceptor pair top much visual circo plot visual top r filtered_ligand ligand_prioritized_tbl_oi filterreceiv receiver_oi top_n prioritization_scor pullligand uniqu prioritized_tbl_oi prioritization_tablesprioritization_tbl_ligand_receptor filterligand filtered_ligand selectnich sender receiv ligand receptor ligand_receptor prioritization_scor distinct inner_jointop_ligand_receptor_niche_df group_byligand filterreceiv receiver_oi top_n prioritization_scor ungroup colors_send brewerpaln prioritized_tbl_oisend uniqu sort length name spectral magrittrset_namesprioritized_tbl_oisend uniqu sort colors_receiv clavend magrittrset_namesprioritized_tbl_oireceiv uniqu sort circos_output make_circos_lrprioritized_tbl_oi colors_send colors_receiv differential_nichenet_filesfiguregfmunnamedchunkpng differential_nichenet_filesfiguregfmunnamedchunkpng r circos_outputp_circo visual liver macrophag central vein r receiver_oi momac filtered_ligand ligand_prioritized_tbl_oi filterreceiv receiver_oi top_n prioritization_scor pullligand uniqu prioritized_tbl_oi prioritization_tablesprioritization_tbl_ligand_receptor filterligand filtered_ligand selectnich sender receiv ligand receptor ligand_receptor prioritization_scor distinct inner_jointop_ligand_receptor_niche_df group_byligand filterreceiv receiver_oi top_n prioritization_scor ungroup lfc_plot make_ligand_receptor_lfc_plotreceiver_oi prioritized_tbl_oi prioritization_tablesprioritization_tbl_ligand_receptor plot_legend fals height null width null lfc_plot differential_nichenet_filesfiguregfmunnamedchunkpng visual liver macrophag bile duct r receiver_oi momac filtered_ligand ligand_prioritized_tbl_oi filterreceiv receiver_oi top_n prioritization_scor pullligand uniqu prioritized_tbl_oi prioritization_tablesprioritization_tbl_ligand_receptor filterligand filtered_ligand selectnich sender receiv ligand receptor ligand_receptor prioritization_scor distinct inner_jointop_ligand_receptor_niche_df group_byligand filterreceiv receiver_oi top_n prioritization_scor ungroup lfc_plot make_ligand_receptor_lfc_plotreceiver_oi prioritized_tbl_oi prioritization_tablesprioritization_tbl_ligand_receptor plot_legend fals height null width null lfc_plot differential_nichenet_filesfiguregfmunnamedchunkpng note limit comparison default nichenet default nichenet pipelin express ligandreceptor pair priorit base ligand activ alon differenti nichenet pipelin also draw inform base differenti express lr pair compar nich applic spatial locat focu differenti express ligandreceptor pair use default priorit weight de activ tend find mani differ hit default nichenet pipelin differenti nichenet tend find highd lowact hit wherea default nichenet find lowd highact hit note highd lowact hit might realli import low nichenet activ due limit nichenet activ predict eg improperincomplet prior knowledg within nichenet ligand might also high de activ dont strong signal effect eg ligand involv cell adhes opposit pair lowd highact strongli priorit differenti nichenet follow consid ligand regul posttranscript high predict activ might still reflect true signal high predict activ valu might due limit nichenet inaccur prior knowledg lowd ligand import biolog process interest although highd famili member ligand may sinc signal famili member tend similar high activ one condit might due downregul condit lead high activ low de current ligand activ automat calcul upregul gene per condit downregul gene could also sign ligand activ ligandreceptor pair high de high activ consid good candid regul process interest recommend test candid experiment valid refer browaey r saelen w saey nichenet model intercellular commun link ligand target gene nat method doi guilliam et al spatial proteogenom reveal distinct evolutionarili conserv hepat macrophag nich cell doijcel infer ligandtotarget signal path robin browaey github markdown built use rmarkdownrendervignettesligand_target_signaling_pathrmd output_format github_docu infer signal path beween ligand target interest determin signal path ligand target interest look transcript factor best regul target gene close downstream ligand base weight edg integr ligandsign gene regulatori network shortest path transcript factor ligand interest determin gene form part path consid import signal mediat final look collect data sourc network interact ligand signal mediat transcript factor target gene allow priorit signal mediat check collect data sourc support ligandtarget predict interest analysi need defin one ligand interest one target gene interest vignett demonstr infer signal path cafligand caf cancerassoci fibroblast interest toppredict pemt target gene output analysi easili import cytoscap explor network first load necessari packag network infer signal path ligand target gene interest r librarynichenetr librarytidyvers weighted_network readrdsurlhttpszenodoorgrecordfilesweighted_networksrd ligand_tf_matrix readrdsurlhttpszenodoorgrecordfilesligand_tf_matrixrd lr_network readrdsurlhttpszenodoorgrecordfileslr_networkrd sig_network readrdsurlhttpszenodoorgrecordfilessignaling_networkrd gr_network readrdsurlhttpszenodoorgrecordfilesgr_networkrd exampl infer signal path cafligand tgfb toppredict pemt target gene tgfbi lamc tnc r ligands_al tgfb list multipl ligand requir targets_al ctgfbilamctnc active_signaling_network get_ligand_signaling_pathligand_tf_matrix ligand_tf_matrix ligands_al ligands_al targets_al targets_al weighted_network weighted_network better visual edg weigth normal edg weight make compar signal gene regulatori interact active_signaling_network_min_max active_signaling_network active_signaling_network_min_maxsig active_signaling_network_min_maxsig mutateweight weightminweightmaxweightminweight active_signaling_network_min_maxgr active_signaling_network_min_maxgr mutateweight weightminweightmaxweightminweight graph_min_max diagrammer_format_signaling_graphsignaling_graph_list active_signaling_network_min_max ligands_al ligands_al targets_al targets_al sig_color indianr gr_color steelblu render graph uncom follow line code diagrammerrender_graphgraph_min_max layout tree tgfb_targets_signaling_pathpng look collect data sourc support interact network r data_source_network infer_supporting_datasourcessignaling_graph_list active_signaling_networklr_network lr_network sig_network sig_network gr_network gr_network headdata_source_network tibbl x sourc databas layer chr chr chr chr chr smad tgfbi regnetwork_sourc regnetwork regulatori smad tgfbi remap_ remap regulatori smad lamc harmonizome_chea harmonizome_gr regulatori smad tgfbi harmonizome_chea harmonizome_gr regulatori smad tnc harmonizome_chea harmonizome_gr regulatori smad tnc regnetwork_sourc regnetwork regulatori inform mention data sourc sourc column link websit databas etc see data sourc informationdata_sourcesxlsx export cytoscap export follow eg cytoscap explor network r output_path write_output fals chang true write output weight network import network cytoscap ifwrite_output bind_rowsactive_signaling_networksig mutatelay signal active_signaling_networkgr mutatelay regulatori write_tsvpasteoutput_pathweighted_signaling_networktxt network inform support data sourc import network cytoscap ifwrite_output data_source_network write_tsvpasteoutput_pathdata_source_networktxt node annot tabl import tabl cytoscap specific_annotation_tbl bind_row tibblegen ligands_al annot ligand tibblegen targets_al annot target tibblegen cdata_source_networkfrom data_source_networkto uniqu setdiffctargets_allligands_al intersectlr_networkto uniqu annot receptor tibblegen cdata_source_networkfrom data_source_networkto uniqu setdiffctargets_allligands_al intersectgr_networkfrom uniqu setdiffcdata_source_networkfrom data_source_networkto uniqu intersectlr_networkto uniqueannot transcript regul non_specific_annotation_tbl tibblegen cdata_source_networkfrom data_source_networkto uniqu setdiffspecific_annotation_tblgen annot signal mediat ifwrite_output bind_rowsspecific_annotation_tblnon_specific_annotation_tbl write_tsvpasteoutput_pathannotation_tabletxt perform nichenet analysi start seurat object stepbystep analysi robin browaey github markdown built use rmarkdownrendervignettesseurat_stepsrmd output_format github_docu vignett learn perform basic nichenet analysi seurat v object nichenet analysi help gener hypothes intercellular commun process interest singlecel gene express data seurat object specif nichenet predict ligand one cell popul sendernich like affect target gene express interact cell popul receivertarget specif target gene affect predict ligand nichenet studi ligand affect gene express put neighboringinteract cell need data effect gene express want studi need kind differenti express receiv cell popul caus ligand one interact sender cell popul vignett demonstr use nichenet seurat object step analysi show also discuss detail main basi nichenet vignett nichenet ligand activ analysi gene set interest predict activ ligand target genesligand_activity_genesetmdvignetteligand_activity_geneset packagenichenetr make sure understand differ step nichenet analysi describ vignett proceed vignett perform real nichenet analysi data vignett describ differ step behind wrapper function shown perform nichenet analysi start seurat objectseurat_wrappermdvignetteseurat_wrapp packagenichenetr follow vignett advantag allow user adapt specif step pipelin make appropri data exampl express data interact cell use mous nicheseq data medaglia et al explor intercellular commun cell area inguin lymph node hour lymphocyt choriomening viru lcmv infect medaglia et al nichenet explor immun cell crosstalk respons lcmv infect dataset differenti express observ cd cell steadyst cd cell lcmv infect nichenet appli look sever immun cell popul lymph node ie monocyt dendrit cell nk cell b cell cd cell regul induc observ gene express chang nichenet specif priorit ligand immun cell target gene chang express upon lcmv infect use nichenet network ligandtarget matrix exampl express data interact cell download zenodo nichenet network ligandtarget matrix doihttpszenodoorgbadgedoizenodosvghttpsdoiorgzenodo seurat object process nicheseq singlecel data doihttpszenodoorgbadgedoizenodosvghttpsdoiorgzenodo prepar nichenet analysi load requir packag read seurat object process express data interact cell nichenet ligandtarget prior model ligandreceptor network weight integr network nichenet ligandreceptor network weight network necessari defin show possibl ligandreceptor interact two cell popul ligandtarget matrix denot prior potenti particular ligand might regul express particular target gene matrix necessari priorit possibl ligandreceptor interact base observ gene express effect ie nichenet ligand activ analysi infer affect target gene priorit ligand load packag r librarynichenetr libraryseurat pleas updat seurat v librarytidyvers would use load packag recommend load packag other read express data interact cell dataset use publicli avail singlecel data immun cell cell area inguin lymph node data process aggreg appli seurat align pipelin seurat object contain aggreg data note seurat v object gene name offici mousehuman gene symbol r seuratobj readrdsurlhttpszenodoorgrecordfilesseuratobjrd seuratobjmetadata head ngene numi origid aggreg re celltyp ncount_rna nfeature_rna w ln_ss ss cd w ln_ss ss cd w ln_ss ss cd w ln_ss ss cd w ln_ss ss cd w ln_ss ss cd visual cell popul present cd cell includ regulatori cell cd cell b cell nk cell dendrit cell dc inflammatori monocyt r seuratobjmetadatacelltyp tabl note number cell cell type low prefer higher real applic b cd cd dc mono nk treg dimplotseuratobj reduct tsne seurat_steps_filesfiguregfmunnamedchunkpng visual data see condit cell belong metadata datafram column denot condit steadyst lcmv infect call aggreg r seuratobjmetadataaggreg tabl lcmv ss dimplotseuratobj reduct tsne groupbi aggreg seurat_steps_filesfiguregfmunnamedchunkpng read nichenet ligandtarget prior model ligandreceptor network weight integr network r ligand_target_matrix readrdsurlhttpszenodoorgrecordfilesligand_target_matrixrd ligand_target_matrix target gene row ligand column cxcl cxcl cxcl cxcl ppbp abg e e e e e abga e e e e e acf e e e e e e e e e e ama e e e e e lr_network readrdsurlhttpszenodoorgrecordfileslr_networkrd headlr_network tibbl x sourc databas chr chr chr chr cxcl cxcr kegg_cytokin kegg cxcl cxcr kegg_cytokin kegg cxcl cxcr kegg_cytokin kegg cxcl cxcr kegg_cytokin kegg ppbp cxcr kegg_cytokin kegg cxcl cxcr kegg_cytokin kegg weighted_network readrdsurlhttpszenodoorgrecordfilesweighted_networksrd weighted_networks_lr weighted_networkslr_sig inner_joinlr_network distinctfromto cfromto headweighted_networkslr_sig interact weight ligandreceptor signal network tibbl x weight chr chr dbl abg abcc abg ace abg adam abg ago abg akt abg anxa headweighted_networksgr interact weight gene regulatori network tibbl x weight chr chr dbl abg aaa gfap aadac cypa aadac irf aatf atm aatf atr express data mous origin convert nichenet network gene symbol human mous base onetoon ortholog r lr_network lr_network mutatefrom convert_human_to_mouse_symbolsfrom convert_human_to_mouse_symbolsto drop_na colnamesligand_target_matrix ligand_target_matrix colnam convert_human_to_mouse_symbol rownamesligand_target_matrix ligand_target_matrix rownam convert_human_to_mouse_symbol ligand_target_matrix ligand_target_matrix isnarownamesligand_target_matrix isnacolnamesligand_target_matrix weighted_networks_lr weighted_networks_lr mutatefrom convert_human_to_mouse_symbolsfrom convert_human_to_mouse_symbolsto drop_na perform nichenet analysi case studi want appli nichenet predict ligand express immun cell cell area lymph node like induc differenti express cd cell lcmv infect describ main vignett pipelin basic nichenet analysi consist follow step defin sendernich cell popul receivertarget cell popul present express data determin gene express popul case studi receiv cell popul cd cell popul wherea sender cell popul cd treg mono nk b dc consid gene express express least cell one cluster r receiv receiv cd expressed_genes_receiv get_expressed_genesreceiv seuratobj pct background_expressed_gen expressed_genes_receiv rownamesligand_target_matrix r sender sender_celltyp ccd ttreg mono nk b dc list_expressed_genes_send sender_celltyp uniqu lapplyget_expressed_gen seuratobj lappli get express gene everi sender cell type separ expressed_genes_send list_expressed_genes_send unlist uniqu defin gene set interest gene receivertarget cell popul potenti affect ligand express interact cell eg gene differenti express upon cellcel interact gene set interest gene differenti express cd cell lcmv infect condit interest thu lcmv wherea referencesteadyst condit ss notion condit extract metadata column aggreg method calcul differenti express standard seurat wilcoxon test chang necessari r seurat_obj_receiv subsetseuratobj ident receiv seurat_obj_receiv setidentseurat_obj_receiv valu seurat_obj_receiveraggreg condition_oi lcmv condition_refer ss de_table_receiv findmarkersobject seurat_obj_receiv ident condition_oi ident condition_refer minpct rownames_to_columngen geneset_oi de_table_receiv filterp_val_adj absavg_logfc pullgen geneset_oi geneset_oi rownamesligand_target_matrix defin set potenti ligand ligand express sendernich cell popul bind put receptor express receivertarget popul combin express gene sender cell type exampl perform one nichenet analysi pool ligand cell type togeth later interpret output check sender cell type express ligand r ligand lr_network pullfrom uniqu receptor lr_network pullto uniqu expressed_ligand intersectligandsexpressed_genes_send expressed_receptor intersectreceptorsexpressed_genes_receiv potential_ligand lr_network filterfrom expressed_ligand expressed_receptor pullfrom uniqu perform nichenet ligand activ analysi rank potenti ligand base presenc target gene gene set interest compar background set gene r ligand_act predict_ligand_activitiesgeneset geneset_oi background_expressed_gen background_expressed_gen ligand_target_matrix ligand_target_matrix potential_ligand potential_ligand ligand_act ligand_act arrangepearson mutaterank rankdescpearson ligand_act tibbl x test_ligand auroc aupr pearson rank chr dbl dbl dbl dbl ebi il crlf app tgfb ptprc hm icam cxcl adam row differ ligand activ measur auroc aupr pearson correl coeffici measur well ligand predict observ differenti express gene compar background express gene valid studi show pearson correl coeffici ligand target predict observ transcript respons inform measur defin ligand activ therefor nichenet rank ligand base pearson correl coeffici allow us priorit ligand induc antivir respons cd cell number toprank ligand use predict activ target gene construct activ ligandreceptor network r best_upstream_ligand ligand_act top_n pearson arrangepearson pulltest_ligand uniqu ligand express one input sender cell see cell popul express toprank ligand run follow r dotplotseuratobj featur best_upstream_ligand rev col rdylbu rotatedaxi seurat_steps_filesfiguregfmunnamedchunkpng see op toprank ligand seem mainli express dendrit cell monocyt infer receptor toppredict target gene ligand toprank ligand activ analysi activ target gene infer r active_ligand_target_links_df best_upstream_ligand lapplyget_weighted_ligand_target_linksgeneset geneset_oi ligand_target_matrix ligand_target_matrix n bind_row drop_na active_ligand_target_link prepare_ligand_target_visualizationligand_target_df active_ligand_target_links_df ligand_target_matrix ligand_target_matrix cutoff order_ligand intersectbest_upstream_ligand colnamesactive_ligand_target_link rev makenam order_target active_ligand_target_links_dftarget uniqu intersectrownamesactive_ligand_target_link makenam rownamesactive_ligand_target_link rownamesactive_ligand_target_link makenam makenam heatmap visual gene like ht colnamesactive_ligand_target_link colnamesactive_ligand_target_link makenam makenam heatmap visual gene like ht vis_ligand_target active_ligand_target_linksorder_targetsorder_ligand r p_ligand_target_network vis_ligand_target make_heatmap_ggplotpriorit ligandspredict target gene color purplelegend_posit top x_axis_posit toplegend_titl regulatori potenti themeaxistextx element_textfac ital scale_fill_gradientlow whitesmok high purpl break c p_ligand_target_network seurat_steps_filesfiguregfmunnamedchunkpng note ligand top present ligandtarget heatmap leftout ligand ligand dont target gene high enough regulatori potenti score therefor surviv use cutoff includ less stringent use cutoff receptor toprank ligand r lr_network_top lr_network filterfrom best_upstream_ligand expressed_receptor distinctfromto best_upstream_receptor lr_network_top pullto uniqu lr_network_top_df_larg weighted_networks_lr filterfrom best_upstream_ligand best_upstream_receptor lr_network_top_df lr_network_top_df_larg spreadfromweightfil lr_network_top_matrix lr_network_top_df selectto asmatrix magrittrset_rownameslr_network_top_dfto dist_receptor distlr_network_top_matrix method binari hclust_receptor hclustdist_receptor method wardd order_receptor hclust_receptorslabelshclust_receptorsord dist_ligand distlr_network_top_matrix method binari hclust_ligand hclustdist_ligand method wardd order_ligands_receptor hclust_ligandslabelshclust_ligandsord order_receptor order_receptor intersectrownameslr_network_top_matrix order_ligands_receptor order_ligands_receptor intersectcolnameslr_network_top_matrix vis_ligand_receptor_network lr_network_top_matrixorder_receptor order_ligands_receptor rownamesvis_ligand_receptor_network order_receptor makenam colnamesvis_ligand_receptor_network order_ligands_receptor makenam r p_ligand_receptor_network vis_ligand_receptor_network make_heatmap_ggplotligandsreceptor color mediumvioletr x_axis_posit toplegend_titl prior interact potenti p_ligand_receptor_network seurat_steps_filesfiguregfmunnamedchunkpng receptor toprank ligand consid bona fide ligandreceptor interact document literatur publicli avail databas r lr_network_strict lr_network filterdatabas ppi_prediction_go databas ppi_predict ligands_bona_fid lr_network_strict pullfrom uniqu receptors_bona_fid lr_network_strict pullto uniqu lr_network_top_df_large_strict lr_network_top_df_larg distinctfromto inner_joinlr_network_strict cfromto distinctfromto lr_network_top_df_large_strict lr_network_top_df_large_strict inner_joinlr_network_top_df_larg cfromto lr_network_top_df_strict lr_network_top_df_large_strict spreadfromweightfil lr_network_top_matrix_strict lr_network_top_df_strict selectto asmatrix magrittrset_rownameslr_network_top_df_strictto dist_receptor distlr_network_top_matrix_strict method binari hclust_receptor hclustdist_receptor method wardd order_receptor hclust_receptorslabelshclust_receptorsord dist_ligand distlr_network_top_matrix_strict method binari hclust_ligand hclustdist_ligand method wardd order_ligands_receptor hclust_ligandslabelshclust_ligandsord order_receptor order_receptor intersectrownameslr_network_top_matrix_strict order_ligands_receptor order_ligands_receptor intersectcolnameslr_network_top_matrix_strict vis_ligand_receptor_network_strict lr_network_top_matrix_strictorder_receptor order_ligands_receptor rownamesvis_ligand_receptor_network_strict order_receptor makenam colnamesvis_ligand_receptor_network_strict order_ligands_receptor makenam r p_ligand_receptor_network_strict vis_ligand_receptor_network_strict make_heatmap_ggplotligandsreceptor color mediumvioletr x_axis_posit toplegend_titl prior interact potentialnbona fide p_ligand_receptor_network_strict seurat_steps_filesfiguregfmunnamedchunkpng add log fold chang inform ligand sender cell case might possibl also check upregul ligand sender cell add use extra layer inform next ligand activ defin nichenet assum ligand induc de receiv cell de sender cell possibl defin log fold chang lcmv steadyst sender cell type visual extra inform r de analysi sender cell type use new nichenetr function reinstal nichenetr necessari de_table_al identsseuratobj level intersectsender_celltyp lapplyget_lfc_celltyp seurat_obj seuratobj condition_colnam aggreg condition_oi condition_oi condition_refer condition_refer expression_pct celltype_col null reducefull_join use cell type label ident seurat object indic celltype_col properli de_table_allisnade_table_al combin ligand activ de inform ligand_activities_d ligand_act selecttest_ligand pearson renameligand test_ligand left_joinde_table_al renameligand gene ligand_activities_deisnaligand_activities_d make lfc heatmap lfc_matrix ligand_activities_d selectligand pearson asmatrix magrittrset_rownamesligand_activities_deligand rownameslfc_matrix rownameslfc_matrix makenam order_ligand order_ligandsorder_ligand rownameslfc_matrix vis_ligand_lfc lfc_matrixorder_ligand colnamesvis_ligand_lfc vis_ligand_lfc colnam makenam p_ligand_lfc vis_ligand_lfc make_threecolor_heatmap_ggplotpriorit ligandslfc sender low_color midnightbluemid_color white mid medianvis_ligand_lfc high_color redlegend_posit top x_axis_posit top legend_titl lfc themeaxistexti element_textfac ital p_ligand_lfc seurat_steps_filesfiguregfmunnamedchunkpng r chang color bit make stand p_ligand_lfc p_ligand_lfc scale_fill_gradientncolor cmidnightblueblu grey greyfirebrickredvalu c limit cvis_ligand_lfc min vis_ligand_lfc max p_ligand_lfc seurat_steps_filesfiguregfmunnamedchunkpng summari visual nichenet analysi exampl make combin heatmap ligand activ ligand express ligand log fold chang target gene toprank ligand plot log fold chang target gene alreadi made let make heatmap ligand activ express r ligand activ heatmap ligand_pearson_matrix ligand_act selectpearson asmatrix magrittrset_rownamesligand_activitiestest_ligand rownamesligand_pearson_matrix rownamesligand_pearson_matrix makenam colnamesligand_pearson_matrix colnamesligand_pearson_matrix makenam vis_ligand_pearson ligand_pearson_matrixorder_ligand asmatrixncol magrittrset_colnamespearson p_ligand_pearson vis_ligand_pearson make_heatmap_ggplotpriorit ligandsligand activ color darkorangelegend_posit top x_axis_posit top legend_titl pearson correl coefficientntarget gene predict abil themelegendtext element_texts r ligand express seurat dotplot order_ligands_adapt order_ligand order_ligands_adaptedorder_ligands_adapt hm hm cf requir use makenam heatmap visual necessari ligand list priorit ligand order_ligands_adaptedorder_ligands_adapt ht ht cf requir use makenam heatmap visual necessari ligand list priorit ligand rotated_dotplot dotplotseuratobj subsetcelltyp sender_celltyp featur order_ligands_adapt col rdylbu coord_flip themelegendtext element_texts legendtitl element_texts flip coordin necessari want show ligand row combin plot r figures_without_legend cowplotplot_grid p_ligand_pearson themelegendposit none axistick element_blank themeaxistitlex element_text rotated_dotplot themelegendposit none axistick element_blank axistitlex element_texts axistexti element_textfac ital size axistextx element_texts angl hjust ylabexpress sender xlab scale_y_discreteposit right p_ligand_lfc themelegendposit none axistick element_blank themeaxistitlex element_text ylab p_ligand_target_network themelegendposit none axistick element_blank ylab align hv nrow rel_width cncolvis_ligand_pearson ncolvis_ligand_lfc ncolvis_ligand_lfc ncolvis_ligand_target legend cowplotplot_grid ggpubras_ggplotggpubrget_legendp_ligand_pearson ggpubras_ggplotggpubrget_legendrotated_dotplot ggpubras_ggplotggpubrget_legendp_ligand_lfc ggpubras_ggplotggpubrget_legendp_ligand_target_network nrow align h rel_width c combined_plot cowplotplot_gridfigures_without_legend legend rel_height c nrow align hv combined_plot seurat_steps_filesfiguregfmunnamedchunkpng remark toprank ligand target gene shown differ predict shown respect case studi nichenet paper differ definit express gene use refer div idref classrefer cslbibbodi hangingind div idrefmedaglia_spatial_ classcslentri medaglia chiara amir giladi liat stolerbarak marco de giovanni tomer meir salam adi biram eyal david et al spatial reconstruct immun nich combin photoactivat report span classnocasescrnaspanseq scienc decemb eaao httpsdoiorgscienceaao div div faq nichenet robin browaey github markdown built use rmarkdownrendervignettesfaqrmd output_format github_docu document tri give extens answer question got past month go vignett see requir differenti express two condit steadyst data want use nichenet cant nichenet use find ligandreceptor pair steadyst nichenet tool let studi ligand affect gene express put neighboringinteract cell priorit import ligand base effect word priorit express ligandreceptor interact base observ target gene need data effect gene express want studi need kind differenti express receiv cell popul caus ligand one interact sender cell popul concret differenti express one cell type two condit caus cellcel interact also differenti express two cell type exampl progenitor differenti cell type differenti influenc microenviron case dont necessarili need two condit would interest ligandreceptor interact homeostat condit homeostat condit data alway infer ligandreceptor interact base express level end goal tool like cellphonedb see also question intermediari step nichenet pipelin cf step seurat step vignett httpsgithubcomsaeyslabnichenetrblobmastervignettesseurat_stepsmd howev priorit express ligandreceptor interact base observ target gene appli nichenet steadyst data harder dont clear set gene affect intercellular commun process could still use total set gene genom background gene express cell type gene set interest need chang geneset_oi express gene background gene ligandtarget matrix dont realli recommend express gene influenc cellcel interact contrari gene probabl express part gener celltyp specif gene express program cant discrimin cellintrins cellextrins effect data still use nichenet risk ligand fals link cellintrins gene confound analysi lead irrelev noisi predict takeaway messag nichenet predict upstream ligandreceptor pair might regul gene gene set interest gene set interest consist gene expect regul extracellular microenviron better gene set would also consist gene necessarili influenc environ case use express celltyp specif gene gene set interest nichenet still provid good predict sometim substanti part gene would affect cellcel interact therefor cautiou rememb garbag garbag gene set interest use seurat cluster marker found via findmark function good idea discuss question good idea gener use marker gene receiv cluster gene set interest assum clusterspecif gene induc cellcel interact cell type howev think case mani clusterspecif gene reflect celltyp specif gene express program part cellinstrins gene express program entir influenc environment factor word gene cluster marker probabl realli inducedregul ligand interact cell therefor use nichenet gene set ideal use nichenet case increas chanc fals link ligand cellintrins gene might except use clusterspecif gene gene set interest might work though mayb cluster cell type one cluster locat differ tissu thu differ extracellular influenc de gene cluster reflect differ cell type cellcel interact affect cell type case use nichenet anoth exampl possibl progenitor cell cluster differenti anoth cell cluster influenc cellcel interact use nichenet clusterspecif gene differenti cell popul check influenc cellcel interact differenti process compar priorit ligandreceptor interact nichenet cellphonedb find littl overlap explain main reason tool differ goal mind priorit ligandreceptor interact goal cellphonedb find celltyp specif ligandreceptor pair cellphonedb ideal want investig differenti interact potenti differ cell type cellphonedb first look express ligandreceptor pair interact cell find celltyp specif ligandreceptor pair look express ligand receptor stronger specif ligandsreceptor express senderreceiv cell popul better priorit via cellphonedb analysi goal nichenet complementari cellphonedb nichenet want find ligandreceptor pair like regul gene express receiv cell look ligandreceptor pair evid signal interact exist data contrast cellphonedb might give function inform idea downstream target ligandreceptor interact also clue interact might realli activ express ligand receptor rna level found cellphonedb necessarili mean interact realiti downstream signal effect interact observ eg via nichenet bit evid interact might happen realiti like cellphonedb nichenet start look express ligandreceptor pair interact cell interest instead priorit look express strength nichenet priorit base observ target gene receiv cell possibl disadvantag approach ligandreceptor pair rel low express return therefor also recommend check express ligand receptor nichenet priorit give exampl ligand rank th would much stronger express ligand would st nd rank accord ligand activ strongli express candid ligand might interest compar nichenet cellphonedb output follow differ expect present ligadreceptor pair pick nichenet cellphonedb might gener express rather lowli express signal evid pair pick cellphonedb nichenet strongli celltyp specif express evid base prior knowledg signal pathway pair actual function cours lack evid mean signal go check express top ligand accord nichenet see ligand andor receptor realli lowli express possibl nichenet take account express data cell priorit ligand nichenet ligand activ analysi occur base enrich target gene set gene differenti express receiv cell priorit base strength express ligand sender cell strength express receptor receiv cell express sender cell use determin ligand express sender cell express receiv cell use determin receptor express receiv cell default definit express gene express cell cluster interest high put stringent cutoff want result possibl outcom ligand toprank accord enrich target gene actual highli express observ expect base nichenet priorit ligand current version nichenet express strength thu directli includ find hard formal tradeoff ligand activ express express level import recommend check express ligand receptor nichenet priorit give exampl ligand rank th would much stronger express ligand would st nd rank accord ligand activ strongli express candid ligand might interest observ top ligand accord nichenet induc condit interest compar control higher express control condit interest possibl ligand priorit current done without take account express valu ligand condit ligand express mean algorithm consid whether ligand strongli express case vs control long express suffici level cours might interest inform use priorit nichenet ligand activ analysi therefor recommend check express ligand nichenet priorit interest hit might one ligand andor receptor upregul condit interest compar control opposit pattern could also interest could consid follow hypothesi ligand might downregul mani gene instead addit upregul mani gene mean ligand x activ control condit downregul gene ligand x repress case condit lower express downregulatori effect might disappear lead upregul gene downregul target gene ligand x high ligand activ ligand x accord nichenet would want consid ligand upregul casevscontrol condit alway chang pipelin first perform differenti express analysi sender cell consid upregul ligand express ligand potenti ligand nichenet analysi would recommend filter upregul afterward ligand differenti activ due process upregul rna level use nichenet want find potenti ligand import cell interest even though dont express data possibl interactingsend cell perfectli possibl appli nichenet case dont sender cell type case analysi upstream regul analysi intercellular commun analysi look ligand nichenet databas ligand potenti receptor express instead look ligand express specif sender cell type small chang code requir use ligand instead expressed_ligand basic seurat step vignett defin potential_ligand use seurat wrapper function set paramet function sender sender undefin need sure use express data responderreceiv cell type defin set gene like affect upstream regulatori intercellular signal process case dont data sender cell type interest know publicli avail express data avail cell type tissu interest might help use dataset proxi express ligand nichenet prior model base human mous data separ model human mous model primarili build base human data sourc howev also includ mous data sourc gener model least gene mous onetoon ortholog strongli minor nichenet model tailor human mous mous model use vignett obtain convert human gene symbol mous onetoon ortholog model inde tailor human expect would perform bit better human mous dont think differ larg paper evalu ligandtarget predict base ligand treatment dataset human mous origin indic dataset human would work better mous howev disadvantag mousespecif gene dont inform nichenet ligandtarget model impli nichenet might miss pattern wellknown mouseonli target gene would de dataset work solut would construct mous model addit mous data sourc work difficult vignett httpsgithubcomsaeyslabnichenetrblobmastervignettesmodel_constructionmd show build model use nichenet data mous human data ye two option first explor possibl construct organismspecif model data sourc organ interest work difficult vignett httpsgithubcomsaeyslabnichenetrblobmastervignettesmodel_constructionmd show build model main thing consid though enough primari data sourc organ second option would use current human nichenet model convert human gene symbol onetoon ortholog organ interest main thing consid organ interest dissimilar human make tradeoff homolog speci number qualiti data sourc avail build new speciesspecif model exampl primat could use human model convert gene symbol drosophila make new model data sourc probabl appropri decid want construct model data sourc realli need optim data sourc weight shown paper data sourc weight optim improv perform model bit effect larg model without data sourc weight optim also seem work well optim difficult timeconsum procedur dont see problem optim data sourc weight confid data sourc high qualiti noisi nichenet say cell popul interact dont nichenet cant give clearcut answer question suggest mani ligand certain cell type mani target gene de receiv cell type might suggest intercellular signal process go cell type vignett httpsgithubcomsaeyslabnichenetrblobmastervignettestarget_prediction_evaluation_genesetmd show calcul fraction gene de receiv cell type might target top priorit ligand nichenet way found one case studi describ paper de gene strongli predict target gene priorit ligand high fraction suggest intercellular signal might inde go cours still valid use nichenet gene set base approach eg extract gene set consist target gene ligand x ye use function extract_top_n_target extract_top_fraction_target near futur also add vignett use score individu cell base express top n target gene ligand interest gener doubl layer ligandreceptortarget circo plot shown immun paper httpswwwcellcomimmunityfulltext far know straightforward way directli make kind ligandreceptortarget circo plot via circliz r packag therefor made ligandreceptortarget circo plot make first two separ circo plot ligandtarget ligandreceptor circo plot made sure ligandreceptor circo plot bigger ligandtarget plot overlay inkscap center two circl locat remov everyth ligandreceptor circo plot except outer receptor layer make ligandreceptor circo plot similar make ligandtarget circo plot shown circo plot vignett would want split target gene receptor differ group accord signal pathway done paper first need defin group specif data frame advanc cf shown ligand ligand_type_indication_dfin vignett want overlay receptor case need make sure ligandreceptor weight receptor one group proport ligandtarget weight target group gener nice overlay effect case ligandreceptor weight proport underli ligandtarget regulatori potenti score reflect prior inform support specif ligandreceptor interact shown current vignett ligandreceptor circo plot see inde cumbersom far ideal situat ideal would work straightforward solut futur cant promis anyth high prioriti us think combin ligandact ligandreceptor ligandtarget heatmap least equal inform use ligandreceptor network instead one includ nichenet model ye definit vignett httpsgithubcomsaeyslabnichenetrblobmastervignettesmodel_constructionmd see incorpor new data sourc new ligandreceptor pair build custom nichenet prior model would suggest add new ligandreceptor data sourc exist one altern remov exist one give new data sourc weight use optim weight data sourc updat data sourc behind nichenet nichenet model inde plan updat prior model incorpor new updat databas cant pin date interpret output ligandtarget matrix see gene gene set interest final ligandtarget matrix reason ligandtarget matrix show gene top predict target least one top ligand tweak paramet function permiss want includ gene allow lower regulatori potenti score set n top n target higher use nichenet bulk rnaseq data well singlecel data ye work cell popul sort bulk data better sequenc depth might even work better cours depend set whether clean data cell popul interest alreadi appli nichenet bulk rnaseq data shown paper httpswwwcellcomimmunityfulltext analysi follow step explain basic vignett httpsgithubcomsaeyslabnichenetrblobmastervignettesligand_activity_genesetmd adapt basic vignett need though exampl need anoth way defin set express gene sender receiv anoth way de analysi defin gene set interest defin gene express could use filterbyexpr packag edger check distribut express valu choos cutoff base distribut doubt choos cutoff would recommend consid gene express remov gene analysi number express gene differ per cell type organ rang bulk rnaseq data gene materi method paper see exampl determin express gene perform de analysi nichenet return signific ligandreceptor interact realiz nichenet give clearcut answer ligandreceptor pair signific first nichenet pipelin determin possibl express ligandreceptor pair ligand activ analysi perform rank ligand base activ accord enrich strongli predict target gene ligand gene set interest receiv cell base top n default ligand select analys visual look ligandreceptor network see low interact score highli express ligandreceptor interact high score lowli express pair reason ligandreceptor interact score shown ligandreceptor matrixheatmap proxi confid ligand interact receptor base prior knowledg ligandreceptor network basi nichenet result integr multipl singl ligandreceptor data sourc score see plot prior ligandreceptor interact potenti proxi number qualiti ligandreceptor ppi data sourc report certain ligandreceptor interact ligandreceptor interact describ mani confid databas score higher interact predict via one proteinprotein interact databas score thu sole base prior knowledg base express dataset way express use defin whether ligandreceptor express ye ligandsreceptor express wont appear heatmap inde possibl lowli express ligandreceptor pair shown near futur provid code show make heatmap score reflect express strength ligand receptor product express averag express seurat vignett show code defin bona fide ligandreceptor interact see ligandreceptor pair consid bona fide higher prior interact score bona fide pair possibl prior interact score base confid prior inform bona fide pair highest score inde see confus categor bonafid ligand base whether come valid curat ligandreceptor databas like kegg guidepharmacolog also ligandreceptor interact present databas predict base proteinprotein interact network eg base annot know gene x encod ligand gene receptor predict ligandreceptor interact x ppi databas ligandreceptor databas support xy interact predict ligandreceptor interact part curat ligandreceptor databas bona fide higher score bona fide one mani confid ppi pathway databas report interact basic bona fide ligandreceptor interact known ligandreceptor interact nonbona fide interact ppi much evid high score yet document lr interact curat databas focus bona fide lr interact give wellvalid pair wherea includ nonbona fide one novel less confid although nichenet alreadi priorit ligandreceptor pair strongli still find mani possibl pair experiment valid type inform would recommend consid even priorit think could take mani factor consider first consid nichenet ligand activ alreadi instead strong prefer st rank ligand versu th ligand suggest also take account express level ligand receptor look express valu fraction cell express ligandreceptor whether ligandreceptor celltyp specif ideal case would casevscontrol data could also look ligandsreceptor pair ligand andor receptor upregul case vs control condit next could check whether ligandreceptor interact bona fide cf previou question whether ligandreceptor prior interact potenti weight high suggest give highest weight ligand activ expressionupregul inform interpret pearson correl valu ligand activ mean neg valu ligand_pearson_matrix find pearson correl valu nichenet prior ligandtarget predict gene set interest high score mean top predict target gene ligand enrich gene set interest compar background would say good pearson score top ligand around higher low nonzero score might still rank ligand valuabl although rank base top predict target gene ligand gene set interest score around zero mean top predict target ligand enrich gene set interest compar background thu rank ligand valuabl case ligand typic auroc around mean nichenet find evid sender cell regul gene express chang receiv cell although lack evid demonstr lack valu neg mean enrich top predict target gene background compar gene set interest valu neg close zero noth worri valu realli neg indic someth went wrong analysi probabl definit background gene set interest gene set interest typic much smaller background stronger anticorrel score ligand would occur gene set interest would almost entir consist gene lowest regulatori potenti score ligand would rare occur one possibl explan find strongli neg score could background gene set small thu good represent genom background gene set interest never larger background recommend least around gene background would still issu enough express gene larg background could use gene present ligandtarget matrix genom background look combin ligandactivitytarget heatmap see ligand seem higher activ less target gene ligand possibl ligand activ base observ target gene gene set interest rank ligand base well toprank target gene ligand base regulatori potenti enrich gene set interest pearson correl whether gene belong gene set interest regulatori potenti score target gene ligand highli rank ligand mean mani toprank target gene gene set interest compar background note pearson correl rank ligand calcul ligand separ result correl depend rank target gene one ligand rel ligandtarget regulatori potenti score ligand without look ligand regulatori potenti score ligandtarget link shown heatmap visual absolut ligandtarget regulatori potenti confid score relat mani data sourc confirm regulatori interact ligand target higher score mean evid specif ligandtarget interact import note heatmap show gene part gene set possibl target gene reason see contradict pearson correl regulatori potenti score thu follow ligand x rank higher ligand toprank target gene enrich target gene ligand although absolut regulatori potenti score ligand ytarget link higher case wellstudi ligand like tnf ifng ilb ligand target howev probabl less enrich might high score target gene ligand gene set interest compar ligand x target explain stronger enrich ligand x target although inform ligand nichenet also calcul ligandreceptor interact specif downregul target gene nichenet distinguish target gene upregul downregul due ligandreceptor interact nichenet inde work upregul downregul target gene default case would recommend consid upregul downregul gene potenti target gene gene set interest ligandreceptor interact inde lead downregul gene mention perfectli possibl look upregul gene depend research question could sometim interest could also interest find ligand respons upregul downregul might interest nichenet priorit algorithm directli distinguish downregul gene import consequ keep mind upregul gene downregul gene ligand upregul gene like activ downregulatori gene nichenet directli distinguish downregul gene regulatori potenti accord evidencepotentialprob ligand might regul express target gene regul mean upregul downregul nichenet know priori target gene upregul downregul follow reason construct model calcul prior regulatori potenti score consid retriev interact activ databas basi nichenet dont provid inform whether interact induc repress inform final model evid regul target x ligand reg potenti evid regul target x ligand reg potenti evid lead higher score repress regulatori interact lead downregul also score higher user visual express target gene combin heatmap exampl shown basic vignett allow check specif gene downregul two main cell type divid two subpopul base condit casevscontrol need use receiv sender cell type interest eg seurat vignett recommend use cell receiv cell type interest receiv includ condit sender might sometim better use cell case condit howev think perfectli fine includ sender cell well thu condit check nichenet analys ligand might upregul case condit compar control question list first check open close issu httpsgithubcomsaeyslabnichenetrissu packag github see whether question might address one dont hesit open new issu would prefer keep discuss privat also send email robinbrowaeysugentb prefer open issu user learn well circo plot visual show activ ligandtarget link interact cell robin browaey github markdown built use rmarkdownrendervignettescircosrmd output_format github_docu vignett show nichenet use predict activ ligandtarget link multipl interact cell make circo plot summar toppredict link via circliz packag vignett start way main basi nichenet vignett nichenet ligand activ analysi gene set interest predict activ ligand target genesligand_activity_genesetmdvignetteligand_activity_geneset packagenichenetr make sure understand differ step describ vignett proceed vignett contrast basic vignett look commun multipl cell type specif predict ligand express caf endotheli cell induc pemt program neighbor malign cell see puram et al load packag requir vignett r librarynichenetr librarytidyvers librarycircl read express data interact cell first read publicli avail singlecel data caf endotheli cell malign cell hnscc tumor r hnscc_express readrdsurlhttpszenodoorgrecordfileshnscc_expressionrd express hnscc_expressionexpress sample_info hnscc_expressionsample_info contain metainform cell secondli determin gene express caf endotheli malign cell high qualiti primari tumor therefor wil consid cell tumor sampl less qualiti lymph node metastas determin express gene use definit use puram et al r tumors_remov chnhnhn hn hn hn hnhn caf_id sample_info filterlymph node tumor tumors_remov noncanc cell type caf pullcel endothelial_id sample_info filterlymph node tumor tumors_remov noncanc cell type endotheli pullcel malignant_id sample_info filterlymph node tumor tumors_remov classifi cancer cell pullcel expressed_genes_caf expressioncaf_id applyfunctionxx applyfunctionxlogmeanx name expressed_genes_endotheli expressionendothelial_id applyfunctionxx applyfunctionxlogmeanx name expressed_genes_malign expressionmalignant_id applyfunctionxx applyfunctionxlogmeanx name load ligandtarget model want use r ligand_target_matrix readrdsurlhttpszenodoorgrecordfilesligand_target_matrixrd ligand_target_matrix target gene row ligand column cxcl cxcl cxcl cxcl ppbp abg e e e e e abga e e e e e acf e e e e e e e e e e ama e e e e e load gene set interest background gene gene set interest consid gene express possibl affect due commun cell want investig caf endotheli cell regul express pemt gene malign cell use pemt gene set defin puram et al gene set interset use gene express malign cell background gene r pemt_geneset readrread_tsvurlhttpszenodoorgrecordfilespemt_signaturetxt col_nam gene pullgen rownamesligand_target_matrix consid gene also present nichenet model exclud gene gene list offici hgnc symbol use puram et al headpemt_geneset serpin tgfbi mmp lamc pha pdpn background_expressed_gen expressed_genes_malign rownamesligand_target_matrix headbackground_expressed_gen rp elmo pnma mmp tmem ercc perform nichenet ligand activ analysi gene set interest first step defin set potenti activ ligand potenti activ ligand use ligand express caf andor endotheli cell bind put receptor express malign cell put ligandreceptor link gather nichenet ligandreceptor data sourc note combin ligand caf endotheli cell one ligand activ analysi later look toprank ligand mainli express cell type r lr_network readrdsurlhttpszenodoorgrecordfileslr_networkrd ligand lr_network pullfrom uniqu expressed_ligands_caf intersectligandsexpressed_genes_caf expressed_ligands_endotheli intersectligandsexpressed_genes_endotheli expressed_ligand unionexpressed_ligands_caf expressed_genes_endotheli receptor lr_network pullto uniqu expressed_receptor intersectreceptorsexpressed_genes_malign potential_ligand lr_network filterfrom expressed_ligand expressed_receptor pullfrom uniqu headpotential_ligand il hgf tnfsf tgfb tgfb inhba perform ligand activ analysi infer well nichenet ligandtarget potenti score predict whether gene belong pemt program r ligand_act predict_ligand_activitiesgeneset pemt_geneset background_expressed_gen background_expressed_gen ligand_target_matrix ligand_target_matrix potential_ligand potential_ligand want rank ligand base ligand activ valid studi show pearson correl ligand target predict observ transcript respons inform measur defin ligand activ therefor rank ligand base pearson correl coeffici r ligand_act arrangepearson tibbl x test_ligand auroc aupr pearson chr dbl dbl dbl pthlh edn cxcl agt tgfb il inhba adam tnc vwf row best_upstream_ligand ligand_act top_n pearson arrangepearson pulltest_ligand headbest_upstream_ligand pthlh edn cxcl agt tgfb il see toprank ligand predict pemt gene reason impli rank ligand might accur shown studi howev possibl gene set target gene predict perform toprank ligand would much better random predict case priorit ligand less trustworthi determin priorit ligand express caf endotheli cell r best_upstream_ligand intersectexpressed_ligands_caf pthlh cxcl agt tgfb il inhba adam tnc ctgf fn bmp il cxcl mmp cola psen cxcl best_upstream_ligand intersectexpressed_ligands_endotheli edn cxcl il adam vwf ctgf fn spp cxcl cola psen cxcl lot overlap cell type term express ligand therefor determin ligand strongli express two ligand_expression_tbl tibbl ligand best_upstream_ligand caf expressioncaf_idsbest_upstream_ligand applyfunctionxx applyfunctionxlogmeanx endotheli expressionendothelial_idsbest_upstream_ligand applyfunctionxx applyfunctionxlogmeanx caf_specific_ligand ligand_expression_tbl filtercaf endotheli pullligand endothelial_specific_ligand ligand_expression_tbl filterendotheli caf pullligand general_ligand setdiffbest_upstream_ligandsccaf_specific_ligandsendothelial_specific_ligand ligand_type_indication_df tibbl ligand_typ crepcafspecif time caf_specific_ligand length repgener time general_ligand length rependothelialspecif time endothelial_specific_ligand length ligand ccaf_specific_ligand general_ligand endothelial_specific_ligand infer target gene toprank ligand visual circo plot show look regulatori potenti score ligand target gene interest case look link toprank pemtregul ligand pemt gene exampl infer target gene belong pemt gene set strongli predict target least one select toprank ligand top target accord gener prior model top target dataset get first activ ligandtarget link look pemt gene among toppredict target gene priorit ligand r active_ligand_target_links_df best_upstream_ligand lapplyget_weighted_ligand_target_linksgeneset pemt_geneset ligand_target_matrix ligand_target_matrix n bind_row active_ligand_target_links_df active_ligand_target_links_df mutatetarget_typ p_emt inner_joinligand_type_indication_df want ot make circo plot multipl gene set combin differ data frame differenti target belong gene set via target type avoid make circo plot mani ligandtarget link show link weight higher predefin cutoff link belong lowest score remov cutoff cutoff use visual chang accord user need r cutoff_include_all_ligand active_ligand_target_links_dfweight quantil active_ligand_target_links_df_circo active_ligand_target_links_df filterweight cutoff_include_all_ligand ligands_to_remov setdiffactive_ligand_target_links_dfligand uniqu active_ligand_target_links_df_circosligand uniqu targets_to_remov setdiffactive_ligand_target_links_dftarget uniqu active_ligand_target_links_df_circostarget uniqu circos_link active_ligand_target_links_df filtertarget targets_to_remov ligand ligands_to_remov prepar circo visual give segment ligand target specif color order r grid_col_ligand cgener lawngreen cafspecif royalblu endothelialspecif gold grid_col_target c p_emt tomato grid_col_tbl_ligand tibbleligand_typ grid_col_ligand name color_ligand_typ grid_col_ligand grid_col_tbl_target tibbletarget_typ grid_col_target name color_target_typ grid_col_target circos_link circos_link mutateligand pasteligand extra space make differ gene ligand gene target circos_link circos_link inner_joingrid_col_tbl_ligand inner_joingrid_col_tbl_target links_circl circos_link selectligandtarget weight ligand_color circos_link distinctligandcolor_ligand_typ grid_ligand_color ligand_colorcolor_ligand_typ set_namesligand_colorligand target_color circos_link distincttargetcolor_target_typ grid_target_color target_colorcolor_target_typ set_namestarget_colortarget grid_col cgrid_ligand_colorgrid_target_color give option link circo plot transpar ligandtarget potenti score transpar circos_link mutateweight weightminweightmaxweightminweight mutatetranspar weight transpar prepar circo visual order ligand target r target_ord circos_linkstarget uniqu ligand_ord ccaf_specific_ligandsgeneral_ligandsendothelial_specific_ligand cpast intersectcircos_linksligand order cligand_ordertarget_ord prepar circo visual defin gap differ segment r width_same_cell_same_ligand_typ width_different_cel width_ligand_target width_same_cell_same_target_typ gap c width_ligand_target repwidth_same_cell_same_ligand_typ time circos_link filterligand_typ cafspecif distinctligand nrow width_different_cel repwidth_same_cell_same_ligand_typ time circos_link filterligand_typ gener distinctligand nrow width_different_cel repwidth_same_cell_same_ligand_typ time circos_link filterligand_typ endothelialspecif distinctligand nrow width_ligand_target repwidth_same_cell_same_target_typ time circos_link filtertarget_typ p_emt distincttarget nrow width_ligand_target render circo plot link transpar width block indic target gene proport ligandtarget regulatori potenti prior knowledg support regulatori interact r circospargapdegre gap chorddiagramlinks_circl direct orderorderlinksort true linkdecreas fals gridcol grid_coltranspar diffheight directiontyp cdiffheight arrowslinkarrtyp bigarrow linkvis links_circleweight cutoff_include_all_ligandsannotationtrack grid preallocatetrack listtrackheight go back first track custom sector label circostracktrackindex panelfun functionx circostextcell_metaxcent cell_metaylim cell_metasectorindex face clockwis nicefac true adj c cex bgborder na circos_filesfiguregfmunnamedchunkpng r circosclear render circo plot degre transpar determin regulatori potenti valu ligandtarget interact r circospargapdegre gap chorddiagramlinks_circl direct orderorderlinksort true linkdecreas fals gridcol grid_coltranspar transpar diffheight directiontyp cdiffheight arrowslinkarrtyp bigarrow linkvis links_circleweight cutoff_include_all_ligandsannotationtrack grid preallocatetrack listtrackheight go back first track custom sector label circostracktrackindex panelfun functionx circostextcell_metaxcent cell_metaylim cell_metasectorindex face clockwis nicefac true adj c cex bgborder na circos_filesfiguregfmunnamedchunkpng r circosclear save circo plot svg file r svgligand_target_circossvg width height circospargapdegre gap chorddiagramlinks_circl direct orderorderlinksort true linkdecreas fals gridcol grid_coltranspar transpar diffheight directiontyp cdiffheight arrowslinkarrtyp bigarrow linkvis links_circleweight cutoff_include_all_ligandsannotationtrack grid preallocatetrack listtrackheight go back first track custom sector label circostracktrackindex panelfun functionx circostextcell_metaxcent cell_metaylim cell_metasectorindex face clockwis nicefac true adj c cex bgborder na circosclear devoff png visual ligandreceptor interact priorit ligand circo plot r get ligandreceptor network toprank ligand lr_network_top lr_network filterfrom best_upstream_ligand expressed_receptor distinctfromto best_upstream_receptor lr_network_top pullto uniqu get weight ligandreceptor interact use nichenet model weighted_network readrdsurlhttpszenodoorgrecordfilesweighted_networksrd lr_network_top_df weighted_networkslr_sig filterfrom best_upstream_ligand best_upstream_receptor renameligand receptor lr_network_top_df lr_network_top_df mutatereceptor_typ p_emt_receptor inner_joinligand_type_indication_df r grid_col_ligand cgener lawngreen cafspecif royalblu endothelialspecif gold grid_col_receptor c p_emt_receptor darkr grid_col_tbl_ligand tibbleligand_typ grid_col_ligand name color_ligand_typ grid_col_ligand grid_col_tbl_receptor tibblereceptor_typ grid_col_receptor name color_receptor_typ grid_col_receptor circos_link lr_network_top_df mutateligand pasteligand extra space make differ gene ligand gene receptor circos_link circos_link inner_joingrid_col_tbl_ligand inner_joingrid_col_tbl_receptor links_circl circos_link selectligandreceptor weight ligand_color circos_link distinctligandcolor_ligand_typ grid_ligand_color ligand_colorcolor_ligand_typ set_namesligand_colorligand receptor_color circos_link distinctreceptorcolor_receptor_typ grid_receptor_color receptor_colorcolor_receptor_typ set_namesreceptor_colorreceptor grid_col cgrid_ligand_colorgrid_receptor_color give option link circo plot transpar ligandreceptor potenti score transpar circos_link mutateweight weightminweightmaxweightminweight mutatetranspar weight transpar prepar circo visual order ligand receptor r receptor_ord circos_linksreceptor uniqu ligand_ord ccaf_specific_ligandsgeneral_ligandsendothelial_specific_ligand cpast intersectcircos_linksligand order cligand_orderreceptor_ord prepar circo visual defin gap differ segment r width_same_cell_same_ligand_typ width_different_cel width_ligand_receptor width_same_cell_same_receptor_typ gap c width_ligand_receptor repwidth_same_cell_same_ligand_typ time circos_link filterligand_typ cafspecif distinctligand nrow width_different_cel repwidth_same_cell_same_ligand_typ time circos_link filterligand_typ gener distinctligand nrow width_different_cel repwidth_same_cell_same_ligand_typ time circos_link filterligand_typ endothelialspecif distinctligand nrow width_ligand_receptor repwidth_same_cell_same_receptor_typ time circos_link filterreceptor_typ p_emt_receptor distinctreceptor nrow width_ligand_receptor render circo plot link transpar width block indic receptor proport ligandreceptor interact weight prior knowledg support interact r circospargapdegre gap chorddiagramlinks_circl direct orderorderlinksort true linkdecreas fals gridcol grid_coltranspar diffheight directiontyp cdiffheight arrowslinkarrtyp bigarrow linkvis links_circleweight cutoff_include_all_ligandsannotationtrack grid preallocatetrack listtrackheight go back first track custom sector label circostracktrackindex panelfun functionx circostextcell_metaxcent cell_metaylim cell_metasectorindex face clockwis nicefac true adj c cex bgborder na circos_filesfiguregfmunnamedchunkpng r circosclear render circo plot degre transpar determin prior interact weight ligandreceptor interact width block indic receptor r circospargapdegre gap chorddiagramlinks_circl direct orderorderlinksort true linkdecreas fals gridcol grid_coltranspar transpar diffheight directiontyp cdiffheight arrowslinkarrtyp bigarrow linkvis links_circleweight cutoff_include_all_ligandsannotationtrack grid preallocatetrack listtrackheight go back first track custom sector label circostracktrackindex panelfun functionx circostextcell_metaxcent cell_metaylim cell_metasectorindex face clockwis nicefac true adj c cex bgborder na circos_filesfiguregfmunnamedchunkpng r circosclear save circo plot svg file r svgligand_receptor_circossvg width height circospargapdegre gap chorddiagramlinks_circl direct orderorderlinksort true linkdecreas fals gridcol grid_coltranspar transpar diffheight directiontyp cdiffheight arrowslinkarrtyp bigarrow linkvis links_circleweight cutoff_include_all_ligandsannotationtrack grid preallocatetrack listtrackheight go back first track custom sector label circostracktrackindex panelfun functionx circostextcell_metaxcent cell_metaylim cell_metasectorindex face clockwis nicefac true adj c cex bgborder na circosclear devoff png remark make ligandreceptortarget circo plot paper bonnardel tjonck et al stellat cell hepatocyt endotheli cell imprint kupffer cell ident monocyt colon liver macrophag nichehttpswwwcellcomimmunityfulltext show fig b ligandreceptortarget circo plot visual main nichenet predict ligandreceptortarget circo plot made make first two separ circo plot ligandtarget ligandreceptor circo plot circo plot overlay inkscap center two circl locat ligandreceptor circo plot bigger ligandtarget one gener combin circo plot shown ni fig b manual remov element ligandreceptor circo plot except outer receptor layer near futur work solut gener ligandreceptortarget circo plot fulli autom manner would want split target gene receptor differ group accord signal pathway done mention paper first need defin group specif data frame advanc cf shown ligand ligand_type_indication_dfin vignett want overlay receptor case need make sure ligandreceptor weight receptor one group proport ligandtarget weight target group gener nice overlay effect case ligandreceptor weight proport underli ligandtarget regulatori potenti score reflect prior inform support specif ligandreceptor interact shown vignett ligandreceptor circo plot refer bonnardel et al immun stellat cell hepatocyt endotheli cell imprint kupffer cell ident monocyt colon liver macrophag nichehttpsdoiorgjimmuni div idref classrefer div idrefpuram_singlecell_ puram sidharth v itay tirosh anuraag parikh anoop p patel keren yizhak shawn gillespi christoph rodman et al singlecel transcriptom analysi primari metastat tumor ecosystem head neck cancer cell e httpsdoiorgjcel div div perform nichenet analysi start seurat object robin browaey github markdown built use rmarkdownrendervignettesseurat_wrapperrmd output_format github_docu vignett learn perform basic nichenet analysi seurat v object nichenet analysi help gener hypothes intercellular commun process interest singlecel gene express data seurat object specif nichenet predict ligand one cell popul sendernich like affect target gene express interact cell popul receivertarget specif target gene affect predict ligand nichenet studi ligand affect gene express put neighboringinteract cell need data effect gene express want studi need kind differenti express receiv cell popul caus ligand one interact sender cell popul vignett demonstr use nichenet seurat object wrapper function show consist differ step discuss detail main basi nichenet vignett nichenet ligand activ analysi gene set interest predict activ ligand target genesligand_activity_genesetmdvignetteligand_activity_geneset packagenichenetr make sure understand differ step nichenet analysi describ vignett proceed vignett perform real nichenet analysi data anoth vignett perform nichenet analysi start seurat object stepbystep analysisseurat_stepsmdvignetteseurat_step packagenichenetr also show execut step one one contrast main vignett specif seurat object allow user adapt specif step pipelin make appropri data recommend exampl express data interact cell use mous nicheseq data medaglia et al explor intercellular commun cell area inguin lymph node hour lymphocyt choriomening viru lcmv infect see medaglia et al nichenet explor immun cell crosstalk respons lcmv infect dataset differenti express observ cd cell steadyst cd cell lcmv infect nichenet appli look sever immun cell popul lymph node ie monocyt dendrit cell nk cell b cell cd cell regul induc observ gene express chang nichenet specif priorit ligand immun cell target gene chang express upon lcmv infect use nichenet network ligandtarget matrix exampl express data interact cell download zenodo nichenet network ligandtarget matrix doihttpszenodoorgbadgedoizenodosvghttpsdoiorgzenodo seurat object process nicheseq singlecel data doihttpszenodoorgbadgedoizenodosvghttpsdoiorgzenodo prepar nichenet analysi load requir packag read seurat object process express data interact cell nichenet ligandtarget prior model ligandreceptor network weight integr network nichenet ligandreceptor network weight network necessari defin show possibl ligandreceptor interact two cell popul ligandtarget matrix denot prior potenti particular ligand might regul express particular target gene matrix necessari priorit possibl ligandreceptor interact base observ gene express effect ie nichenet ligand activ analysi infer affect target gene priorit ligand load packag r librarynichenetr libraryseurat pleas updat seurat v librarytidyvers would use load packag recommend load packag other read nichenet ligandtarget prior model ligandreceptor network weight integr network r ligand_target_matrix readrdsurlhttpszenodoorgrecordfilesligand_target_matrixrd ligand_target_matrix target gene row ligand column cxcl cxcl cxcl cxcl ppbp abg e e e e e abga e e e e e acf e e e e e e e e e e ama e e e e e lr_network readrdsurlhttpszenodoorgrecordfileslr_networkrd headlr_network tibbl x sourc databas chr chr chr chr cxcl cxcr kegg_cytokin kegg cxcl cxcr kegg_cytokin kegg cxcl cxcr kegg_cytokin kegg cxcl cxcr kegg_cytokin kegg ppbp cxcr kegg_cytokin kegg cxcl cxcr kegg_cytokin kegg weighted_network readrdsurlhttpszenodoorgrecordfilesweighted_networksrd headweighted_networkslr_sig interact weight ligandreceptor signal network tibbl x weight chr chr dbl abg abcc abg ace abg adam abg ago abg akt abg anxa headweighted_networksgr interact weight gene regulatori network tibbl x weight chr chr dbl abg aaa gfap aadac cypa aadac irf aatf atm aatf atr read express data interact cell dataset use publicli avail singlecel data immun cell cell area inguin lymph node data process aggreg appli seurat align pipelin seurat object contain aggreg data note seurat v object gene name offici mousehuman gene symbol r seuratobj readrdsurlhttpszenodoorgrecordfilesseuratobjrd seuratobjmetadata head ngene numi origid aggreg re celltyp ncount_rna nfeature_rna w ln_ss ss cd w ln_ss ss cd w ln_ss ss cd w ln_ss ss cd w ln_ss ss cd w ln_ss ss cd visual cell popul present cd cell includ regulatori cell cd cell b cell nk cell dendrit cell dc inflammatori monocyt r seuratobjmetadatacelltyp tabl note number cell cell type low prefer higher real applic b cd cd dc mono nk treg dimplotseuratobj reduct tsne seurat_wrapper_filesfiguregfmunnamedchunkpng visual data see condit cell belong metadata datafram column denot condit steadyst lcmv infect call aggreg r seuratobjmetadataaggreg tabl lcmv ss dimplotseuratobj reduct tsne groupbi aggreg seurat_wrapper_filesfiguregfmunnamedchunkpng perform nichenet analysi case studi want appli nichenet predict ligand express immun cell cell area lymph node like induc differenti express cd cell lcmv infect describ main vignett pipelin basic nichenet analysi consist follow step defin sendernich cell popul receivertarget cell popul present express data determin gene express popul defin gene set interest gene receivertarget cell popul potenti affect ligand express interact cell eg gene differenti express upon cellcel interact defin set potenti ligand ligand express sendernich cell popul bind put receptor express receivertarget popul perform nichenet ligand activ analysi rank potenti ligand base presenc target gene gene set interest compar background set gene infer receptor toppredict target gene ligand toprank ligand activ analysi step contain one three follow similar singl function nichenet_seuratobj_aggreg nichenet_seuratobj_cluster_d nichenet_seuratobj_aggregate_cluster_d addit step function nichenet_seuratobj_aggreg use analysi two condit also calcul differenti express ligand sender cell type note ligand differenti express use priorit rank ligand nichenet analysi seurat object explain differenti express two condit case studi receiv cell popul cd cell popul wherea sender cell popul cd treg mono nk b dc describ function consid gene express express least predefin fraction cell one cluster default gene set interest gene differenti express cd cell lcmv infect condit interest thu lcmv wherea referencesteadyst condit ss notion condit extract metadata column aggreg method calcul differenti express standard seurat wilcoxon test number toprank ligand use predict activ target gene construct activ ligandreceptor network default perform nichenet analysi specif run follow r indic cell type cell class ident check via seuratobj ident tabl nichenet_output nichenet_seuratobj_aggreg seurat_obj seuratobj receiv cd condition_colnam aggreg condition_oi lcmv condition_refer ss sender ccd ttreg mono nk b dc ligand_target_matrix ligand_target_matrix lr_network lr_network weighted_network weighted_network organ mous read process nichenet network defin express ligand receptor receiv sender cell perform de analysi receiv cell perform nichenet ligand activ analysi infer activ target gene priorit ligand infer receptor priorit ligand perform de analysi sender cell interpret nichenet analysi output ligand activ analysi result first thing nichenet priorit ligand base predict ligand activ see rank ligand run follow command r nichenet_outputligand_act tibbl x test_ligand auroc aupr pearson rank bona_fide_ligand chr dbl dbl dbl dbl lgl ebi fals il true crlf fals app true tgfb true ptprc true hm true icam true cxcl true adam true row differ ligand activ measur auroc aupr pearson correl coeffici measur well ligand predict observ differenti express gene compar background express gene valid studi show pearson correl coeffici ligand target predict observ transcript respons inform measur defin ligand activ therefor nichenet rank ligand base pearson correl coeffici allow us priorit ligand induc antivir respons cd cell column bona_fide_ligand indic whether ligand part ligandreceptor interact document public databas bona_fide_ligand true ligandreceptor interact predict base annot ligandreceptor proteinprotein interact databas bona_fide_ligand fals get list toprank ligand run follow command r nichenet_outputtop_ligand ebi il crlf app tgfb ptprc hm icam cxcl adam cxcl cxcl ht semad ccl c cxcl itgb anxa sell ligand express one input sender cell see cell popul express toprank ligand run follow r nichenet_outputligand_expression_dotplot seurat_wrapper_filesfiguregfmunnamedchunkpng see op toprank ligand seem mainli express dendrit cell monocyt could also interest see whether ligand differenti express lcmv infect r nichenet_outputligand_differential_expression_heatmap seurat_wrapper_filesfiguregfmunnamedchunkpng see op toprank ligand seem also upregul monocyt viral infect prerequisit toprank cf rank determin base enrich target gene among de gene receiv cdt cell nice addit evid ligand might inde import infer activ ligandtarget link nichenet also infer activ target gene toprank ligand see toprank ligand predict regul express differenti express gene run follow command heatmap visual r nichenet_outputligand_target_heatmap seurat_wrapper_filesfiguregfmunnamedchunkpng normal ggplot object adapt likewis exampl want chang color code blue instead purpl chang axi tick legend chang axi label heatmap follow r nichenet_outputligand_target_heatmap scale_fill_gradientlow whitesmok high royalblu break c xlabantilcmv respons gene cd cell ylabpriorit immmun cell ligand seurat_wrapper_filesfiguregfmunnamedchunkpng want also extract ligandtarget link regulatori potenti score matrix data frame format eg visual way output csv file r nichenet_outputligand_target_matrix cd cd ddit id ifit irf sell itgb c ccl semad ht adam cxcl icam hm r nichenet_outputligand_target_df weight column regulatori potenti tibbl x ligand target weight chr chr dbl ebi cd ebi cd ebi ddit ebi id ebi ifit ebi irf ebi irf ebi irf ebi parp ebi pdcd row get list toppredict target gene toprank ligand run follow command r nichenet_outputtop_target cd cd ddit id ifit irf irf irf parp pdcd pml psmb rnf stat stat tap ubc zbp cd gbp basp casp cxcl nlrc vim actb ifih myh bm ht rpla cxcr visual express well focu cd cell receiv cell show express cell emphas target gene differenti express split cell steadysst cell cell respons lcmv infect r dotplotseuratobj subsetid cd featur nichenet_outputtop_target rev splitbi aggreg rotatedaxi seurat_wrapper_filesfiguregfmunnamedchunkpng r vlnplotseuratobj subsetid cd featur czbpifitirf splitbi aggreg ptsize combin fals seurat_wrapper_filesfiguregfmunnamedchunkpng seurat_wrapper_filesfiguregfmunnamedchunkpng seurat_wrapper_filesfiguregfmunnamedchunkpng visual ligand activ express differenti express target gene ligand run follow command r nichenet_outputligand_activity_target_heatmap seurat_wrapper_filesfiguregfmunnamedchunkpng import figur consid one import summari figur nichenet analysi see ligandreceptor pair high differenti express ligand activ target gene enrich interest predict key regul intercellular commun process interest infer ligandreceptor interact toprank ligand nichenet also infer receiv cell receptor toprank ligand run follow command heatmap visual ligandreceptor link r nichenet_outputligand_receptor_heatmap seurat_wrapper_filesfiguregfmunnamedchunkpng want also extract ligandreceptor link interact confid score matrix data frame format eg visual way output csv file r nichenet_outputligand_receptor_matrix cxcl cxcl cxcl ccl cxcl app cxcr ccr ccr gpr spr itga cd ptkb ilrb ilrg r nichenet_outputligand_receptor_df weight column accord number data sourc document interact tibbl x ligand receptor weight chr chr dbl adam notch anxa ccr anxa ccr anxa cxcr anxa itga app ccr app ccr app cxcr app notch app tgfbr row get list receptor toprank ligand run follow command r nichenet_outputtop_receptor notch ccr ccr cxcr itga tgfbr itgb gpr spr ilr ilra cda klrd ilrg itgal spn ilrb cd ptkb cd cd selplg ptprc visual express well focu cd cell receiv cell show express cell r dotplotseuratobj subsetid cd featur nichenet_outputtop_receptor rev splitbi aggreg rotatedaxi seurat_wrapper_filesfiguregfmunnamedchunkpng also show bona fide ligandreceptor link describ literatur predict base proteinprotein interact r nichenet_outputligand_receptor_heatmap_bonafid seurat_wrapper_filesfiguregfmunnamedchunkpng r nichenet_outputligand_receptor_matrix_bonafid hm ht c icam tgfb cxcl il ilrb ilrg itgal itgb tgfbr cxcr klrd nichenet_outputligand_receptor_df_bonafid tibbl x ligand receptor weight chr chr dbl c itgb cxcl cxcr ht klrd hm klrd icam itgal icam itgb il ilrb il ilrg tgfb tgfbr interest check geneset background set gene use ligand activ analysi r nichenet_outputgeneset_oi irf stat ifit ifit bst bm rnf plac isg shisa zbp isg samhd usp ht gbp ifi tmsbx rsad lye rtp ifit xaf smchd daxx alb samdl actb parp gbp lgalsbp mx gbp cmpk dtxl slfn oasl herc ifih rpsa pri irgm tapbp rp stat ifi rpl psmb igfbp ddx rac trafd pml oa psme apo basp rpsa znfx rpl oa ntc rnf tap rp rplp ddx vim ifi itmb ctss pabpc parp hspa tora rpl tmbim thi ncoa dhx rp rp psmb ilrg etnk irf crik parp eifak eefb eef npc rp rp sp ubel nmi uba psmb cxcl rpla nhp tbrg usp toraip adar gzma cd hspa cfl crip slcoa tlr trim rpl mycbp rp nlrc rplp acadl trimc rpsx irf psma nme zcchc snord phip ifitm sp dusp mrpl hm gbp dtx eefg rbl xpo gm rpl rp cxcr eifm treml rpla pdcd arrb ubc clic rpla lcp cd ddit cnn nampt ascc cd snordb dwsue famf hcst myh rp mov arf arhgdib ppib trim tspo id snorda rnf casp ptpn itk cd nop anxa hk prkcb iqgap keap rpl parp nichenet_outputbackground_expressed_gen length rerun nichenet analysi differ sender cell definit instead focus multipl sender cell type possibl interest analyi one sender cell type dendrit cell case r nichenet_output nichenet_seuratobj_aggregateseurat_obj seuratobj receiv cd condition_colnam aggreg condition_oi lcmv condition_refer ss sender dc ligand_target_matrix ligand_target_matrix lr_network lr_network weighted_network weighted_network organ mous read process nichenet network defin express ligand receptor receiv sender cell perform de analysi receiv cell perform nichenet ligand activ analysi infer activ target gene priorit ligand infer receptor priorit ligand perform de analysi sender cell nichenet_outputligand_activity_target_heatmap seurat_wrapper_filesfiguregfmunnamedchunkpng instead focus one multipl predefin sender cell type also possibl want consid cell type present possibl sender cell also includ receiv cell type make look autocrin signal well r nichenet_output nichenet_seuratobj_aggregateseurat_obj seuratobj receiv cd condition_colnam aggreg condition_oi lcmv condition_refer ss sender ligand_target_matrix ligand_target_matrix lr_network lr_network weighted_network weighted_network organ mous read process nichenet network defin express ligand receptor receiv sender cell perform de analysi receiv cell perform nichenet ligand activ analysi infer activ target gene priorit ligand infer receptor priorit ligand perform de analysi sender cell nichenet_outputligand_activity_target_heatmap seurat_wrapper_filesfiguregfmunnamedchunkpng case could possibl dont data potenti sender cell still want predict possibl upstream ligand could respons observ differenti express cell type follow command consid possibl ligand nichenet databas receptor express receiv cell interest r nichenet_output nichenet_seuratobj_aggregateseurat_obj seuratobj receiv cd condition_colnam aggreg condition_oi lcmv condition_refer ss sender undefin ligand_target_matrix ligand_target_matrix lr_network lr_network weighted_network weighted_network organ mous read process nichenet network defin express ligand receptor receiv sender cell perform de analysi receiv cell perform nichenet ligand activ analysi infer activ target gene priorit ligand infer receptor priorit ligand nichenet_outputligand_activity_target_heatmap seurat_wrapper_filesfiguregfmunnamedchunkpng see analysi result mani gene de cd cell lcmv infect strongli predict type interferon target presenc type interferon signatur receiv cell type absenc express type interferon sender cell type might indic type interferon express differ nonprofil cell type time point sampl latter could make sens alway time delay express ligandencod gene effect ligand targetreceiv cell ie express target gene run multipl nichenet analys differ receiv cell popul case might interest multipl targetreceiv cell popul decid run everi cell type separ one line code demonstr result exampl could interest explain de steadyst lcmv infect cd cd cell r receiver_celltypes_oi ccd cd receiver_celltypes_oi seuratobj ident uniqu celltyp dataset use would make sens biolog nichenet_output receiver_celltypes_oi lapplynichenet_seuratobj_aggreg seurat_obj seuratobj condition_colnam aggreg condition_oi lcmv condition_refer ss sender ccd ttreg mono nk b dc ligand_target_matrix ligand_target_matrix lr_network lr_network weighted_network weighted_network organ mous read process nichenet network defin express ligand receptor receiv sender cell perform de analysi receiv cell perform nichenet ligand activ analysi infer activ target gene priorit ligand infer receptor priorit ligand perform de analysi sender cell read process nichenet network defin express ligand receptor receiv sender cell perform de analysi receiv cell perform nichenet ligand activ analysi infer activ target gene priorit ligand infer receptor priorit ligand perform de analysi sender cell namesnichenet_output receiver_celltypes_oi check ligand toprank cdt cdt ligand celltyp specif r common_ligand intersectnichenet_outputcd ttop_ligand nichenet_outputcd ttop_ligand printcommon ligand common ligand printcommon_ligand ebi il crlf hm app ptprc icam ccl cxcl tgfb cxcl semad cxcl ht cxcl c itgb cd_ligand nichenet_outputcd ttop_ligand setdiffnichenet_outputcd ttop_ligand cd_ligand nichenet_outputcd ttop_ligand setdiffnichenet_outputcd ttop_ligand printligand specif regul de cdt ligand specif regul de cdt printcd_ligand cd hmgb cd printligand specif regul de cdt ligand specif regul de cdt printcd_ligand adam anxa sell nichenet analysi seurat object explain differenti express two cell popul previous demonstr use wrapper function appli nichenet explain differenti express two condit one cell type howev also differenti express two cell popul might sometim partial caus commun cell neighborhood exampl differenti progenitor cell differenti cell might induc nich cell concret exampl discuss paper stellat cell hepatocyt endotheli cell imprint kupffer cell ident monocyt colon liver macrophag nichehttpswwwcellcomimmunityfulltext therefor also demonstr use anoth seurat wrapper function use case explain differenti express cell popul keep mind comparison make biolog relev possibl use nichenet explain differenti express beween two cell popul dataset case differenti express cell popul result cellintrinisc properti ie differ cell type differ gene express profil intercellular commun process case make sens use nichenet demonstr purpos first chang seuratobject data describ use set r seuratobjmetadatacelltyp pasteseuratobjmetadatacelltypeseuratobjmetadataaggreg sep _ seuratobjmetadatacelltyp tabl b_lcmv b_ss cd t_lcmv cd t_ss cd t_lcmv cd t_ss dc_lcmv dc_ss mono_lcmv mono_ss nk_lcmv nk_ss treg_lcmv treg_ss seuratobj setidentseuratobjvalu celltyp perform nichenet analysi explain differenti express affect cell popul cd cell lcmv infect refer cell popul cd cell steadyst ligand express monocyt dc lcmv infect r nichenet_output nichenet_seuratobj_cluster_d seurat_obj seuratobj receiver_refer cd t_ss receiver_affect cd t_lcmv sender cdc_lcmvmono_lcmv ligand_target_matrix ligand_target_matrix lr_network lr_network weighted_network weighted_network organ mous read process nichenet network defin express ligand receptor receiv sender cell perform de analysi two receiv cell cluster perform nichenet ligand activ analysi infer activ target gene priorit ligand infer receptor priorit ligand check toprank ligand target gene r nichenet_outputligand_activity_target_heatmap seurat_wrapper_filesfiguregfmunnamedchunkpng check express toprank ligand r dotplotseuratobj featur nichenet_outputtop_ligand rev col rdylbu rotatedaxi seurat_wrapper_filesfiguregfmunnamedchunkpng could interest check toprank ligand differenti express monocyt lcmv infect r mono_upregulated_ligand findmarkersseuratobj ident mono_lcmv ident mono_ss rownames_to_columngen filteravg_logfc p_val_adj pullgen intersectnichenet_outputtop_ligand printmonocyt ligand upregul lcmv infect explain de cdtstst cdtlcmv monocyt ligand upregul lcmv infect explain de cdtstst cdtlcmv printmono_upregulated_ligand cxcl remark toprank ligand target gene shown differ predict shown respect case studi nichenet paper differ definit express gene use differenti express done via classic wilcoxon test use seurat defin marker gene cell cluster compar cluster optim would repeat sampl condit case recommend follow vignett perform nichenet analysi start seurat object stepbystep analysisseurat_stepsmdvignetteseurat_step packagenichenetr tweak differenti express step perform analysi eg discuss httpsgithubcomhelenalcmuscat refer bonnardel et al immun stellat cell hepatocyt endotheli cell imprint kupffer cell ident monocyt colon liver macrophag nichehttpsdoiorgjimmuni div idref classrefer cslbibbodi hangingind div idrefmedaglia_spatial_ classcslentri medaglia chiara amir giladi liat stolerbarak marco de giovanni tomer meir salam adi biram eyal david et al spatial reconstruct immun nich combin photoactivat report span classnocasescrnaspanseq scienc decemb eaao httpsdoiorgscienceaao div div assess well toprank ligand predict gene set interest robin browaey github markdown built use rmarkdownrendervignettestarget_prediction_evaluation_genesetrmd output_format github_docu vignett show nichenet use predict ligand might regul given set gene well predict analysi need defin set gene express receiv cell possibl affect extracellular protein signal ligand eg gene differenti express upon cellcel interact set potenti activ ligand eg ligand express interact sender cell therefor often first need process express data interact cell defin exampl use data puram et al explor intercellular commun tumor microenviron head neck squamou cell carcinoma hnscc see puram et al specif look ligand express cancerassoci fibroblast caf induc specif gene program neighbor malign cell program partial epithelialmesenschym transit pemt program could link puram et al metastasi analysi first assess ligand activ ligand word assess well cafligand predict pemt gene set compar background express gene allow us priorit pemtregul ligand assess well priorit ligand togeth predict whether gene belong gene set interest use ligandtarget matrix exampl express data interact cell download zenodo doihttpszenodoorgbadgedoizenodosvghttpsdoiorgzenodo load packag requir vignett r librarynichenetr librarytidyvers read express data interact cell first read publicli avail singlecel data caf malign cell hnscc tumor r hnscc_express readrdsurlhttpszenodoorgrecordfileshnscc_expressionrd express hnscc_expressionexpress sample_info hnscc_expressionsample_info contain metainform cell secondli determin gene express caf malign cell high qualiti primari tumor therefor wil consid cell tumor sampl less qualiti lymph node metastas determin express gene use definit use puram et al r tumors_remov chnhnhn hn hn hn hnhn caf_id sample_info filterlymph node tumor tumors_remov noncanc cell type caf pullcel malignant_id sample_info filterlymph node tumor tumors_remov classifi cancer cell pullcel expressed_genes_caf expressioncaf_id applyfunctionxx applyfunctionxlogmeanx name expressed_genes_malign expressionmalignant_id applyfunctionxx applyfunctionxlogmeanx name load ligandtarget model want use r ligand_target_matrix readrdsurlhttpszenodoorgrecordfilesligand_target_matrixrd ligand_target_matrix target gene row ligand column cxcl cxcl cxcl cxcl ppbp abg e e e e e abga e e e e e acf e e e e e e e e e e ama e e e e e load gene set interest background gene gene set interest consid gene express possibl affect due commun cell want investig caf regul express pemt gene malign cell use pemt gene set defin puram et al gene set interset use gene express malign cell background gene r pemt_geneset readrread_tsvurlhttpszenodoorgrecordfilespemt_signaturetxt col_nam gene pullgen rownamesligand_target_matrix consid gene also present nichenet model exclud gene gene list offici hgnc symbol use puram et al headpemt_geneset serpin tgfbi mmp lamc pha pdpn background_expressed_gen expressed_genes_malign rownamesligand_target_matrix headbackground_expressed_gen rp elmo pnma mmp tmem ercc perform nichenet ligand activ analysi gene set interest first step defin set potenti activ ligand potenti activ ligand use ligand express caf bind put receptor express malign cell put ligandreceptor link gather nichenet ligandreceptor data sourc r lr_network readrdsurlhttpszenodoorgrecordfileslr_networkrd ligand lr_network pullfrom uniqu expressed_ligand intersectligandsexpressed_genes_caf receptor lr_network pullto uniqu expressed_receptor intersectreceptorsexpressed_genes_malign potential_ligand lr_network filterfrom expressed_ligand expressed_receptor pullfrom uniqu headpotential_ligand hgf tnfsf tgfb tgfb inhba cd perform ligand activ analysi infer well nichenet ligandtarget potenti score predict whether gene belong pemt program r ligand_act predict_ligand_activitiesgeneset pemt_geneset background_expressed_gen background_expressed_gen ligand_target_matrix ligand_target_matrix potential_ligand potential_ligand want rank ligand base ligand activ valid studi show pearson correl ligand target predict observ transcript respons inform measur defin ligand activ therefor rank ligand base pearson correl coeffici r ligand_act arrangepearson tibbl x test_ligand auroc aupr pearson chr dbl dbl dbl pthlh cxcl agt tgfb il inhba adam tnc ctgf fn row best_upstream_ligand ligand_act top_n pearson arrangepearson pulltest_ligand headbest_upstream_ligand pthlh cxcl agt tgfb il inhba top ligand build multiligand model use toprank ligand predict whether gene belong pemt program classif model train via crossvalid return probabl everi gene r chang round fold two round reduc time normal multipl round k fold n round pemt_gene_predictions_top_list seqn lapplyassess_rf_class_prob fold k geneset pemt_geneset background_expressed_gen background_expressed_gen ligands_oi best_upstream_ligand ligand_target_matrix ligand_target_matrix evalu well target gene probabili accord gene set assign r get perform aurocauprpearson target_prediction_performances_cv pemt_gene_predictions_top_list lapplyclassification_evaluation_continuous_pred_wrapp bind_row mutateroundseqnrow auroc aupr pcc model averag crossvalid round r target_prediction_performances_cvauroc mean target_prediction_performances_cvaupr mean target_prediction_performances_cvpearson mean evalu whether gene belong gene set like toppredict look top predict target r get perform mani pemt gene nonpemtgen among top predict target target_prediction_performances_discrete_cv pemt_gene_predictions_top_list lapplycalculate_fraction_top_predict quantile_cutoff bind_row ungroup mutateroundreplengthpemt_gene_predictions_top_list fraction pemt gene belong top predict target r target_prediction_performances_discrete_cv filtertrue_target fraction_positive_predict mean fraction nonpemt gene belong top predict target r target_prediction_performances_discrete_cv filtertrue_target fraction_positive_predict mean see pemt gene enrich toppredict target gene test appli fisher exact test everi crossvalid round report averag pvalu r target_prediction_performances_discrete_fish pemt_gene_predictions_top_list lapplycalculate_fraction_top_predicted_fish quantile_cutoff target_prediction_performances_discrete_fish unlist mean e final look pemt gene wellpredict everi crossvalid round r get top predict gene top_predicted_gen seqlengthpemt_gene_predictions_top_list lapplyget_top_predicted_genespemt_gene_predictions_top_list reducefull_join cgenetrue_target top_predicted_gen filtertrue_target tibbl x gene true_target predicted_top_target_roun predicted_top_target_r chr lgl lgl lgl cola true true true mmp true true true mmp true true true plau true true true timp true true true mta true true true inhba true true true cola true true true mmp true true true cola true true true row refer div idref classrefer div idrefpuram_singlecell_ puram sidharth v itay tirosh anuraag parikh anoop p patel keren yizhak shawn gillespi christoph rodman et al singlecel transcriptom analysi primari metastat tumor ecosystem head neck cancer cell e httpsdoiorgjcel div div evalu nichenet ligandtarget predict robin browaey github markdown built use rmarkdownrendervignettesmodel_evaluationrmd output_format github_docu vignett show ligandtarget predict nichenet evalu valid collect transcriptom data cell treat one two ligand cultur use ligand treatment dataset valid advantag observ gene express chang directli attribut addit ligand henc differenti express gene consid gold standard target gene particular ligand use procedur shown evalu model compar perform nichenet ligand treatment valid dataset nichenet ligandtarget model download zenodo doihttpszenodoorgbadgedoizenodosvghttpsdoiorgzenodo load nichenetr model want evalu dataset want evalu r librarynichenetr librarytidyvers load ligandtarget model ligand_target_matrix readrdsurlhttpszenodoorgrecordfilesligand_target_matrixrd ligand treatment express dataset use valid download zenodo expression_settings_valid readrdsurlhttpszenodoorgrecordfilesexpression_settingsrd ligand treatment dataset show log fold chang express gene treatment one specif ligand exampl ligand nodal headexpression_settings_validationnodal_nodaldiffexp lfc qval gene best smim cradd rcan mfapl parl exampl transcript respons predict evalu first demonstr evalu transcript respons ie target gene predict perform ligand treatment express dataset determin well model predict gene differenti express treatment ligand ideal target gene high regulatori potenti score ligand differenti express respons ligand inform collect ligand treatment dataset see dataset informationevaluation_datasetsxlsx sake simplic exclud vignett ligandtreat dataset profil respons multipl ligand see build ligandtarget model target predict multipl ligand see vignett construct nichenet ligandtarget modelmodel_constructionmd vignettemodel_construct packagenichenetr step convert express dataset requir format perform target gene predict r set expression_settings_valid lapplyconvert_expression_settings_evalu set set discardlengthfrom step calcul target gene predict perform r evalu transcript respons predict everi dataset perform set lapplyevaluate_target_predict ligand_target_matrix bind_row step visual result show differ classif evalu metric r visual classif evalu metric show target gene predict perform perform perform selectaupr auc_iregulonpearson_log_pvalspearman_log_pv sensitivity_roc specificity_roc gatherkey scorenam valu scorevalu aurocspearman scorelabel caurocauroc aupr_correctedaupr correct auc_iregulon_correct auciregulon correctedpearson pearson correl spearman spearman rank correlationmean_rank_gst_log_pv meanrank geneset enrich scorerandom cauroc aupr_correct auc_iregulon_correct pearson spearman mean_rank_gst_log_pv dataframescorevalu rownames_to_columnscorenam perform mutatemodel nichenet ggplot geom_violinaesmodel scorevalu groupmodel fill model geom_boxplotaesmodel scorevalu group modelwidth scale_y_continuousscor target predict facet_wrapscorenam scale free labelleras_labellerscorelabel geom_hlineaesyinterceptscorevalu datascorerandom linetyp color red theme_bw model_evaluation_filesfiguregfmunnamedchunkpng exampl ligand activ predict evalu show assess accuraci model predict whether cell treat particular ligand word evalu well nichenet priorit activ ligand given set differenti express gene procedur assum follow better ligand predict transcript respons compar ligand like ligand activ therefor first get ligand activ ligand import featur import score ligand ligandtreat express dataset true aciv ligand known assess whether truli activ ligand get inde higher ligand activ score good ligandtarget model graphic summari procedur visual vignettesligand_activity_prediction_workflow_newpng step convert express dataset requir format perform ligand activ predict r convert express dataset correct format ligand activ predict all_ligand set extract_ligands_from_settingscombin fals unlist settings_ligand_predict set convert_settings_ligand_predictionall_ligand all_ligand valid true step calcul ligand import classif evalu metric indic well ligand predict observ de gene specif ligand treatment dataset r infer ligand import ligand interest assess well ligand explain differenti express specif dataset dataset ligand_import settings_ligand_predict lapplyget_single_ligand_importancesligand_target_matrix bind_row step evalu separ ligand import predict ligand activ r look predict perform singleindividu import measur predict ligand activ ligand test ligand truli activ dataset get highest activ score ie best target gene predict perform evaluation_ligand_predict ligand_importancesset uniqu lapplyfunctionxx lapplywrapper_evaluate_single_importances_ligand_predictionligand_import bind_row inner_joinligand_import distinctsettingligand step visual result show differ classif evalu metric r visual classif evalu metric show ligand activ predict perform evaluation_ligand_predict evaluation_ligand_predict selectaupr sensitivity_roc specificity_roc pearson spearman mean_rank_gst_log_pv gatherkey scorenam valu scorevalu aurocaupr_correct scorelabel caurocauroc aupr_correctedaupr correct scorerandom cauroc aupr_correct dataframescorevalu rownames_to_columnscorenam evaluation_ligand_predict filterimportance_measur cauroc aupr_correct mean_rank_gst_log_pv auc_iregulon_correct pearson spearman ggplot geom_violinaesimportance_measur scorevalu groupimportance_measur fill importance_measur geom_boxplotaesimportance_measur scorevalu group importance_measurewidth scale_y_continuousevalu ligand activ predict scale_x_discreteligand activ measur facet_wrapscorenam scale free labelleras_labellerscorelabel geom_hlineaesyinterceptscorevalu datascorerandom linetyp color red theme_bw themeaxistextx element_textangl model_evaluation_filesfiguregfmunnamedchunkpng plot show use pearson correl coeffici target predict metric best metric use rank ligand accord predict ligand activ differenti nichenet analysi condit interest robin browaey github markdown built use rmarkdownrendervignettesdifferential_nichenet_pemtrmd output_format github_docu remark beta version new extens nichenet name differenti nichenet shortterm improv includ scalabl visual document vignett underli function januari goal differenti nichenet predict ligandreceptor pair differenti express activ differ nich interest vignett guid detail step differenti nichenet analysi exampl express data interact cell use data puram et al explor intercellular commun tumor microenviron head neck squamou cell carcinoma hnscc puram et al specif look cellcel commun differ pemthigh pemtlow tumor pemt partial epithelialmesenschym transit data thu conditionsnich pipelin also usabl conditionsnich use ligandreceptor network ligandtarget matrix download zenodo doihttpszenodoorgbadgedoizenodosvghttpsdoiorgzenodo seurat object contain express data interact cell hnscc also download zenodo doihttpszenodoorgbadgedoizenodosvghttpsdoiorgzenodo read express data interest nichenet ligandreceptor network ligandtarget matrix load packag r librarynichenetr libraryrcolorbrew librarytidyvers libraryseurat read express data case studi want studi differ cellcel commun pattern pemthigh pemtlow tumor meta data column indic pemt statu tumor pemt cell type indic celltyp column r seurat_obj readrdsurlhttpszenodoorgrecordfilesseurat_obj_hnsccrd dimplotseurat_obj groupbi celltyp user adapt requir dataset differential_nichenet_pemt_filesfiguregfmunnamedchunkpng r dimplotseurat_obj groupbi pemt user adapt requir dataset differential_nichenet_pemt_filesfiguregfmunnamedchunkpng also check number cell per cell type condit combin r tableseurat_objmetadatacelltyp seurat_objmetadatapemt cell type vs condit user adapt requir dataset high low caf endotheli malign myeloid myofibroblast tcell differenti nichenet need compar least nich condit case nich pemthighnich pemtlownich adapt name cell type base nich origin r seurat_objmetadatacelltype_aggreg pasteseurat_objmetadatacelltyp seurat_objmetadatapemtsep _ user adapt requir dataset dimplotseurat_obj groupbi celltype_aggreg differential_nichenet_pemt_filesfiguregfmunnamedchunkpng r seurat_objmetadatacelltype_aggreg tabl sortdecreas true malignant_high tcell_high malignant_low caf_high myofibroblast_high endothelial_high caf_low myeloid_high myofibroblast_low endothelial_low myeloid_low tcell_low r celltype_id celltype_aggreg metadata column name cell type interest seurat_obj setidentseurat_obj valu seurat_objcelltype_id read nichenet ligandreceptor network ligandtarget matrix r ligand_target_matrix readrdsurlhttpszenodoorgrecordfilesligand_target_matrixrd ligand_target_matrix target gene row ligand column cxcl cxcl cxcl cxcl ppbp abg e e e e e abga e e e e e acf e e e e e e e e e e ama e e e e e r lr_network readrdsurlhttpszenodoorgrecordfileslr_networkrd lr_network lr_network mutatebonafid databas cppi_predictionppi_prediction_go lr_network lr_network dplyrrenameligand receptor distinctligand receptor bonafid headlr_network tibbl x ligand receptor bonafid chr chr lgl cxcl cxcr true cxcl cxcr true cxcl cxcr true cxcl cxcr true ppbp cxcr true cxcl cxcr true note data mous origin convert human gene symbol onetoon ortholog r organ human user adapt requir dataset r iforgan mous lr_network lr_network mutateligand convert_human_to_mouse_symbolsligand receptor convert_human_to_mouse_symbolsreceptor drop_na colnamesligand_target_matrix ligand_target_matrix colnam convert_human_to_mouse_symbol rownamesligand_target_matrix ligand_target_matrix rownam convert_human_to_mouse_symbol ligand_target_matrix ligand_target_matrix isnarownamesligand_target_matrix isnacolnamesligand_target_matrix defin nichesmicroenviron interest nich least one sendernich cell popul one receivertarget cell popul present express data case studi interest find differ cellcel interact malign cell pemt high pemt low tumor receiv cell popul pemthigh nich thu malignant_high cell type pemtlow nich malignant_low sender cell popul interest myofibroblast endotheli caf tcell myeloid importantli includ tcell myeloid pemthigh nich cell popul present pemtlow nich herebi demonstr possibl includ conditionspecif cell type analysi possibl calcul de compar sender cell nich pemtlow group cell cell type import receiv cell type consist cluster r nich list pemt_high_nich list sender cmyofibroblast_high endothelial_high caf_high tcell_high myeloid_high receiv cmalignant_high pemt_low_nich list sender cmyofibroblast_low endothelial_low caf_low receiv cmalignant_low user adapt requir dataset calcul differenti express nich step determin de differ nich sender receiv defin de lr pair calcul de method calcul differenti express standard seurat wilcoxon test replac want user requir output tabl de_sender_process de_receiver_process format shown de calcul pairwis sender receiv cell type comparis nich across nich within nich case studi mean de myofibroblast_high ligand calcul de analysi myofibroblast_high vs myofibroblast_low myofibroblast_high vs endothelial_low myofibroblast_high vs caf_low split cell per cell type instead merg cell nich avoid de analysi driven abund cell type r assay_oi sct possibl rna de_send calculate_niche_deseurat_obj seurat_obj subsetfeatur lr_networkligand uniqu nich nich type sender assay_oi assay_oi ligand import sender cell type calcul sender de myofibroblast_high myofibroblast_low calcul sender de myofibroblast_high endothelial_low calcul sender de myofibroblast_high caf_low calcul sender de endothelial_high myofibroblast_low calcul sender de endothelial_high endothelial_low calcul sender de endothelial_high caf_low calcul sender de caf_high myofibroblast_low calcul sender de caf_high endothelial_low calcul sender de caf_high caf_low calcul sender de tcell_high myofibroblast_low calcul sender de tcell_high endothelial_low calcul sender de tcell_high caf_low calcul sender de myeloid_high myofibroblast_low calcul sender de myeloid_high endothelial_low calcul sender de myeloid_high caf_low calcul sender de myofibroblast_low myofibroblast_high calcul sender de myofibroblast_low endothelial_high calcul sender de myofibroblast_low caf_high calcul sender de myofibroblast_low tcell_high calcul sender de myofibroblast_low myeloid_high calcul sender de endothelial_low myofibroblast_high calcul sender de endothelial_low endothelial_high calcul sender de endothelial_low caf_high calcul sender de endothelial_low tcell_high calcul sender de endothelial_low myeloid_high calcul sender de caf_low myofibroblast_high calcul sender de caf_low endothelial_high calcul sender de caf_low caf_high calcul sender de caf_low tcell_high calcul sender de caf_low myeloid_high de_receiv calculate_niche_deseurat_obj seurat_obj subsetfeatur lr_networkreceptor uniqu nich nich type receiv assay_oi assay_oi receptor later de analysi find target tibbl x receiv receiver_other_nich chr chr malignant_high malignant_low calcul receiv de malignant_high malignant_low calcul receiv de malignant_low malignant_high process de result r expression_pct de_sender_process process_niche_dede_t de_send nich nich expression_pct expression_pct type sender de_receiver_process process_niche_dede_t de_receiv nich nich expression_pct expression_pct type receiv combin senderreceiv de base lr pair mention de ligand one sender cell type determin calcul de cell type sender cell type nich summar de ligand cell type sever option could take averag lfc also minimum lfc compar nich recommend use minimum lfc strongest specif measur ligand express high min lfc mean ligand strongli express cell type nich compar cell type nich contrast high averag lfc exclud one cell type nich also strongli express ligand r specificity_score_lr_pair min_lfc de_sender_receiv combine_sender_receiver_dede_sender_process de_receiver_process lr_network specificity_scor specificity_score_lr_pair option calcul differenti express differ spatial region improv cellcel interact predict consid spatial inform possibl applic spatial inform come microscopi data spatial transcriptom data visium sever way incorpor spatial inform differenti nichenet pipelin first consid cell type belong nich spatial locat anoth way includ spatial differenti express ligandreceptor pair within one cell type priorit framework exampl cell type x locat region b want studi cellcel commun region first add celltypex regiona nich definit calcul de celltypexregiona celltypexregionb give higher priorit weight regionaspecif ligand case studi region interest tumor lead edg sinc puram et al defin region import regard pemt process puram et al also defin caf fibroblast close lead edg wherea fibroblast myofibroblast preferenti locat tumor lead edg thu priorit fibroblast ligand look ligand de leadingedg fibroblast caf nonleadingedg fibroblast myofibroblast follow first defin spatial info datafram spatial inform data set follow two paramet fals make mock spatial_info data frame r include_spatial_info_send true spatial info includ put fals user adapt requir dataset include_spatial_info_receiv fals spatial info includ put true user adapt requir dataset r spatial_info tibblecelltype_region_oi caf_high celltype_other_region myofibroblast_high nich pemt_high_nich celltype_typ sender user adapt requir dataset specificity_score_spati lfc r defin dont spatial info mock spatial info ifinclude_spatial_info_send fals include_spatial_info_receiv fals spatial_info tibblecelltype_region_oi na celltype_other_region na mutatenich nich name head celltype_typ sender r ifinclude_spatial_info_send true sender_spatial_d calculate_spatial_deseurat_obj seurat_obj subsetfeatur lr_networkligand uniqu spatial_info spatial_info filtercelltype_typ sender sender_spatial_de_process process_spatial_dede_t sender_spatial_d type sender lr_network lr_network expression_pct expression_pct specificity_scor specificity_score_spati add neutral spatial score sender celltyp spatial known import sender_spatial_de_oth get_non_spatial_denich nich spatial_info spatial_info type sender lr_network lr_network sender_spatial_de_process sender_spatial_de_process bind_rowssender_spatial_de_oth sender_spatial_de_process sender_spatial_de_process mutatescaled_ligand_score_spati scale_quantile_adaptedligand_score_spati els add neutral spatial score sender celltyp none spatial relev case sender_spatial_de_process get_non_spatial_denich nich spatial_info spatial_info type sender lr_network lr_network sender_spatial_de_process sender_spatial_de_process mutatescaled_ligand_score_spati scale_quantile_adaptedligand_score_spati calcul spatial de caf_high myofibroblast_high r ifinclude_spatial_info_receiv true receiver_spatial_d calculate_spatial_deseurat_obj seurat_obj subsetfeatur lr_networkreceptor uniqu spatial_info spatial_info filtercelltype_typ receiv receiver_spatial_de_process process_spatial_dede_t receiver_spatial_d type receiv lr_network lr_network expression_pct expression_pct specificity_scor specificity_score_spati add neutral spatial score receiv celltyp spatial known import receiver_spatial_de_oth get_non_spatial_denich nich spatial_info spatial_info type receiv lr_network lr_network receiver_spatial_de_process receiver_spatial_de_process bind_rowsreceiver_spatial_de_oth receiver_spatial_de_process receiver_spatial_de_process mutatescaled_receptor_score_spati scale_quantile_adaptedreceptor_score_spati els add neutral spatial score receiv celltyp none spatial relev case receiver_spatial_de_process get_non_spatial_denich nich spatial_info spatial_info type receiv lr_network lr_network receiver_spatial_de_process receiver_spatial_de_process mutatescaled_receptor_score_spati scale_quantile_adaptedreceptor_score_spati calcul ligand activ infer activ ligandtarget link step predict ligand activ ligand receiv cell type across differ nich similar ligand activ analysi done normal nichenet pipelin calcul ligand activ first need defin geneset interest nich case studi geneset interest pemthigh nich gene upregul pemthigh tumor compar pemtlow tumor vice versa note also defin geneset interest differ way eg pathwaybas geneset etc ligandtarget link infer way describ basic nichenet vignett r lfc_cutoff recommend x min_lfc cutoff specificity_score_target min_lfc de_receiver_target calculate_niche_de_targetsseurat_obj seurat_obj nich nich lfc_cutoff lfc_cutoff expression_pct expression_pct assay_oi assay_oi calcul receiv de malignant_high malignant_low calcul receiv de malignant_low malignant_high de_receiver_processed_target process_receiver_target_dede_receiver_target de_receiver_target nich nich expression_pct expression_pct specificity_scor specificity_score_target background de_receiver_processed_target pulltarget uniqu geneset_nich de_receiver_processed_target filterreceiv nichesreceiv target_scor lfc_cutoff target_signific target_pres pulltarget uniqu geneset_nich de_receiver_processed_target filterreceiv nichesreceiv target_scor lfc_cutoff target_signific target_pres pulltarget uniqu good idea check gene left ligand activ analysi present rownam ligandtarget matrix mani gene left might point issu gene name eg gene alias old gene symbol bad humanmous map geneset_nich setdiffrownamesligand_target_matrix anxal prkcdbp il ptrf sepp corf ccdcb corf leprel znf loc loc linc dfna plk zmymnb corf ctsl sqrdl loc wbp loc aim corf loc gpr vimp sep corf naprt lhfp krtp corf ptpla gramd cpsfl mesdc corf kiaa ccdc txlngp ngfrap erol fama lsmd tceb bgaltl hnl loc kiaa gltd fama corfnbl sepw gpr loc linc tceb gramd gnbl kirrel geneset_nich setdiffrownamesligand_target_matrix loc agpat corf kiaa loc ept cta loc upkbl linc loc fama ccdcc loc loc leprel loc loc linc loc scdl pvrl loc linc loc ppapc corf corf whscl loc setd kdmba spg cxcr loc loc mgc lphn cenpc corf corf loc flj loc mlfip tmema rrpb rexol loc kiaa ctage loc loc loc utsd loc kiaa corf corf prune lrrca loc flj corf loc mgc loc ppapdc frgb cecr loc ccbl ptplad mst loc loc ccdca kiaa loc loc loc loc bre loc loc loc loc corf smek kiaa corf plekhmp loc pcnxl loc corf loc smcrl corf gpr athl loc ppapdcb dak loc crhrit ppapb adck kiaa gyltlb loc loc whsc loc corf corf adck corf sgol loc ptplad kiaa loc loc adrbk linc fama loc famb rpg mettld erolb flj nadkd loc loc fama linc corf setda sgk flj ccdc fama narg mterfd ccdcba loc wdr corf flj kiaa gcnl flj loc fong corf alglp gtdc loc nbpf wbscr corf loc kiaa fama pmsl lust corf fama loc pycrl loc loc corf flj loc loc tomma alscr ldocl hdgfrp znf loc loc leprel qtrtd selm corf corf hnrpll loc loc corf corf corf corf loc lengthgeneset_nich lengthgeneset_nich alway use check number gene geneset ligand activ analysi recommend gene geneset interest background least gene proper ligand activ analysi retriev mani de gene recommend use higher lfc_cutoff threshold recommend use cutoff gt receiv cellsnich compar use min_lfc specif score receiversnich recommend use higher threshold use singlecel data like smartseq high sequenc depth recommend also use higher threshold see smartseq data nich compar use stronger lfc threshold keep less de gene trustworthi one r lfc_cutoff specificity_score_target min_lfc de_receiver_processed_target process_receiver_target_dede_receiver_target de_receiver_target nich nich expression_pct expression_pct specificity_scor specificity_score_target background de_receiver_processed_target pulltarget uniqu geneset_nich de_receiver_processed_target filterreceiv nichesreceiv target_scor lfc_cutoff target_signific target_pres pulltarget uniqu geneset_nich de_receiver_processed_target filterreceiv nichesreceiv target_scor lfc_cutoff target_signific target_pres pulltarget uniqu good idea check gene left ligand activ analysi present rownam ligandtarget matrix mani gene left might point issu gene name eg gene alias old gene symbol bad humanmous map geneset_nich setdiffrownamesligand_target_matrix anxal prkcdbp il ptrf sepp corf geneset_nich setdiffrownamesligand_target_matrix loc agpat corf kiaa loc ept cta lengthgeneset_nich lengthgeneset_nich r top_n_target niche_geneset_list list pemt_high_nich list receiv nichesreceiv geneset geneset_nich background background pemt_low_nich list receiv nichesreceiv geneset geneset_nich background background ligand_activities_target get_ligand_activities_targetsniche_geneset_list niche_geneset_list ligand_target_matrix ligand_target_matrix top_n_target top_n_target calcul ligand activ malignant_high calcul ligand activ malignant_low calcul scale express ligand receptor target across cell type interest log express valu express fraction step calcul averag scale express fraction express ligand receptor target gene across cell type interest demonstr via dotplot function seurat also done via way cours r features_oi unionlr_networkligand lr_networkreceptor unionligand_activities_targetstarget setdiffna dotplot suppresswarningsseuratdotplotseurat_obj subsetid nich unlist uniqu featur features_oi assay assay_oi exprs_tbl dotplotdata as_tibbl exprs_tbl exprs_tbl renamecelltyp id gene featuresplot express avgexp expression_sc avgexpsc fraction pctexp mutatefract fraction as_tibbl selectcelltyp gene express expression_sc fraction distinct arrangegen mutategen ascharactergen exprs_tbl_ligand exprs_tbl filtergen lr_networkligand renamesend celltyp ligand gene ligand_express express ligand_expression_sc expression_sc ligand_fract fraction exprs_tbl_receptor exprs_tbl filtergen lr_networkreceptor renamereceiv celltyp receptor gene receptor_express express receptor_expression_sc expression_sc receptor_fract fraction exprs_tbl_target exprs_tbl filtergen ligand_activities_targetstarget renamereceiv celltyp target gene target_express express target_expression_sc expression_sc target_fract fraction r exprs_tbl_ligand exprs_tbl_ligand mutatescaled_ligand_expression_sc scale_quantile_adaptedligand_expression_sc mutateligand_fraction_adapt ligand_fract mutate_condligand_fract expression_pct ligand_fraction_adapt expression_pct mutatescaled_ligand_fraction_adapt scale_quantile_adaptedligand_fraction_adapt exprs_tbl_receptor exprs_tbl_receptor mutatescaled_receptor_expression_sc scale_quantile_adaptedreceptor_expression_sc mutatereceptor_fraction_adapt receptor_fract mutate_condreceptor_fract expression_pct receptor_fraction_adapt expression_pct mutatescaled_receptor_fraction_adapt scale_quantile_adaptedreceptor_fraction_adapt express fraction receptor step score ligandreceptor interact base express strength receptor way give higher score strongli express receptor certain ligand certain celltyp effect rank individu ligand later help priorit import receptor per ligand next factor regard receptor see later r exprs_sender_receiv lr_network inner_joinexprs_tbl_ligand cligand inner_joinexprs_tbl_receptor creceptor inner_joinde_sender_receiv distinctnich sender receiv ligand_scaled_receptor_expression_fraction_df exprs_sender_receiv group_byligand receiv mutaterank_receptor_express dense_rankreceptor_express rank_receptor_fract dense_rankreceptor_fract mutateligand_scaled_receptor_expression_fract rank_receptor_fract maxrank_receptor_fract rank_receptor_express maxrank_receptor_express distinctligand receptor receiv ligand_scaled_receptor_expression_fract bonafid distinct ungroup priorit ligandreceptor ligandtarget link step combin calcul inform priorit ligandreceptortarget link scale everi properti interest final priorit score weight sum scale score properti interest provid user option consid follow properti priorit weight defin prioritizing_weight ligand de score nichespecif express ligand default minimum logfc sender interest sender nich higher min logfc higher nichespecif ligand therefor recommend give factor high weight prioritizing_weight argument scaled_ligand_scor recommend weight least max scale ligand express scale express ligand one sender compar cell type dataset might use rescu potenti interest ligand high scale express valu rel small min logfc compar nich one reason logfc might small occur gene pick effici use sequenc technolog reason low rna express ligand exampl observ mani ligand tgfbetabmp famili pick effici singlenuclei rna sequenc compar singlecel sequenc prioritizing_weight argument scaled_ligand_expression_sc recommend weight unless technic reason lower gene detect use nucseq recommend use higher weight ligand express fraction ligand express smaller fraction cell cell type defin exprs_cutoffdefault get lower rank proport fraction eg ligand express cell rank higher ligand express cell opt weight base fraction instead remov ligand express cell cutoff interest ligand could remov way fraction express taken account priorit alreadi higher cutoff prioritizing_weight argument ligand_fract recommend weight ligand spatial de score spatial express specif ligand nich interest specif tissu locat sender cell type nich also present locat inform priorit ligand sender look de spatial locat interest compar locat prioritizing_weight argument scaled_ligand_score_spati recommend weight applic receptor de score nichespecif express receptor default minimum logfc receiv interest receiv nich higher min logfc higher nichespecif receptor base experi dont suggest give high import ligand de might depend specif case studi prioritizing_weight argument scaled_receptor_scor recommend weight least lower scaled_ligand_scor scale receptor express scale express receptor one receiv compar cell type dataset might use rescu potenti interest receptor high scale express valu rel small min logfc compar nich one reason logfc might small occur gene pick effici use sequenc technolog prioritizing_weight argument scaled_receptor_expression_sc recommend weight receptor express fraction receptor express smaller fraction cell cell type defin exprs_cutoffdefault get lower rank proport fraction eg receptor express cell rank higher receptor express cell opt weight base fraction instead remov receptor express cell cutoff interest receptor could remov way fraction express taken account priorit alreadi higher cutoff prioritizing_weight argument receptor_fract recommend weight receptor express strength factor let us give higher weight highli express receptor ligand receiv let us rank higher one member receptor famili higher express member prioritizing_weight argument ligand_scaled_receptor_expression_fract recommend valu minimum receptor spatial de score spatial express specif receptor nich interest specif tissu locat receiv cell type nich also present locat inform priorit receptor receiv look de spatial locat interest compar locat prioritizing_weight argument scaled_receptor_score_spati recommend weight applic absolut ligand activ priorit ligandreceptor pair base predict effect ligandreceptor interact gene express receiv cell type absolut ligand activ accord absolut enrich target gene ligand within affect receiv gene prioritizing_weight argument scaled_act recommend weight unless absolut enrich target gene specif interest normal ligand activ priorit ligandreceptor pair base predict effect ligandreceptor interact gene express receiv cell type normal activ done found datasetsconditionsnich higher baselin activ valu other normal ligand activ accord rel enrich target gene ligand within affect receiv gene prioritizing_weight argument scaled_activity_norm recommend weight least prior knowledg qualiti lr interact nichenet lr network consist two type interact lr pair document curat databas lr pair predict base gene annot ppi former categor bona fide interact rank bona fide interact higher exlud potenti interest nonbonafid one give bona fide interact score nonbonafid interact score fof prioritizing_weight argument bona_fid recommend weight least r prioritizing_weight cscaled_ligand_scor scaled_ligand_expression_sc ligand_fract scaled_ligand_score_spati scaled_receptor_scor scaled_receptor_expression_sc receptor_fract ligand_scaled_receptor_expression_fract scaled_receptor_score_spati scaled_act scaled_activity_norm bona_fid note set give substanti weight de ligandreceptor pair compar activ user chang want like set chang would better tackl specif biolog question want address r output listde_sender_receiv de_sender_receiv ligand_scaled_receptor_expression_fraction_df ligand_scaled_receptor_expression_fraction_df sender_spatial_de_process sender_spatial_de_process receiver_spatial_de_process receiver_spatial_de_process ligand_activities_target ligand_activities_target de_receiver_processed_target de_receiver_processed_target exprs_tbl_ligand exprs_tbl_ligand exprs_tbl_receptor exprs_tbl_receptor exprs_tbl_target exprs_tbl_target prioritization_t get_prioritization_tablesoutput prioritizing_weight prioritization_tablesprioritization_tbl_ligand_receptor filterreceiv nichesreceiv head tibbl x nich receiv sender ligand_receptor ligand receptor bonafid ligand_scor ligand_signif ligand_pres ligand_expressi chr chr chr chr chr chr lgl dbl dbl dbl dbl pemt_h malignan tcel ptprcmet ptprc met fals pemt_h malignan tcel ptprcegfr ptprc egfr fals pemt_h malignan tcel ptprccd ptprc cd fals pemt_h malignan tcel ptprcerbb ptprc erbb fals pemt_h malignan tcel ptprcifnar ptprc ifnar fals pemt_h malignan tcel tnftnfrsf tnf tnfrsf true pemt_h malignan myelo serpinalrp serpi lrp true pemt_h malignan myelo ilbilrap ilb ilrap true pemt_h malignan myelo ilrnilr ilrn ilr true pemt_h malignan tcel ptprcinsr ptprc insr fals variabl ligand_expression_sc dbl ligand_fract dbl ligand_score_spati dbl receptor_scor dbl receptor_signific dbl receptor_pres dbl receptor_express dbl receptor_expression_sc dbl receptor_fract dbl receptor_score_spati dbl ligand_scaled_receptor_expression_fract dbl avg_score_ligand_receptor dbl activ dbl activity_norm dbl scaled_ligand_scor dbl scaled_ligand_expression_sc dbl scaled_receptor_scor dbl scaled_receptor_expression_sc dbl scaled_avg_score_ligand_receptor dbl scaled_ligand_score_spati dbl scaled_receptor_score_spati dbl scaled_ligand_fraction_adapt dbl scaled_receptor_fraction_adapt dbl prioritization_tablesprioritization_tbl_ligand_target filterreceiv nichesreceiv head tibbl x nich receiv sender ligand_receptor ligand receptor bonafid target target_scor target_signif target_pres chr chr chr chr chr chr lgl chr dbl dbl dbl pemt_high_nich malign tcell ptprcmet ptprc met fals ehf pemt_high_nich malign tcell ptprcmet ptprc met fals gadd pemt_high_nich malign tcell ptprcmet ptprc met fals serpi pemt_high_nich malign tcell ptprcegfr ptprc egfr fals ehf pemt_high_nich malign tcell ptprcegfr ptprc egfr fals gadd pemt_high_nich malign tcell ptprcegfr ptprc egfr fals serpi pemt_high_nich malign tcell ptprccd ptprc cd fals ehf pemt_high_nich malign tcell ptprccd ptprc cd fals gadd pemt_high_nich malign tcell ptprccd ptprc cd fals serpi pemt_high_nich malign tcell ptprcerbb ptprc erbb fals ehf variabl target_express dbl target_expression_sc dbl target_fract dbl ligand_target_weight dbl activ dbl activity_norm dbl scaled_act dbl scaled_activity_norm dbl prioritization_scor dbl prioritization_tablesprioritization_tbl_ligand_receptor filterreceiv nichesreceiv head tibbl x nich receiv sender ligand_receptor ligand receptor bonafid ligand_scor ligand_signif ligand_pres ligand_expressi chr chr chr chr chr chr lgl dbl dbl dbl dbl pemt_l maligna endoth flrp f lrp true pemt_l maligna endoth platlrp plat lrp true pemt_l maligna caf_low fgffgfr fgf fgfr true pemt_l maligna caf_low nlgnnrxn nlgn nrxn true pemt_l maligna caf_low rspolgr rspo lgr true pemt_l maligna caf_low compsdc comp sdc true pemt_l maligna caf_low semacnrp semac nrp true pemt_l maligna caf_low slitsdc slit sdc true pemt_l maligna endoth ililrap il ilrap fals pemt_l maligna caf_low clrp c lrp true variabl ligand_expression_sc dbl ligand_fract dbl ligand_score_spati dbl receptor_scor dbl receptor_signific dbl receptor_pres dbl receptor_express dbl receptor_expression_sc dbl receptor_fract dbl receptor_score_spati dbl ligand_scaled_receptor_expression_fract dbl avg_score_ligand_receptor dbl activ dbl activity_norm dbl scaled_ligand_scor dbl scaled_ligand_expression_sc dbl scaled_receptor_scor dbl scaled_receptor_expression_sc dbl scaled_avg_score_ligand_receptor dbl scaled_ligand_score_spati dbl scaled_receptor_score_spati dbl scaled_ligand_fraction_adapt dbl scaled_receptor_fraction_adapt dbl prioritization_tablesprioritization_tbl_ligand_target filterreceiv nichesreceiv head tibbl x nich receiv sender ligand_receptor ligand receptor bonafid target target_scor target_signif target_pres chr chr chr chr chr chr lgl chr dbl dbl dbl pemt_low_nich malign endoth flrp f lrp true etv pemt_low_nich malign endoth platlrp plat lrp true cldn pemt_low_nich malign endoth platlrp plat lrp true etv pemt_low_nich malign caf_low fgffgfr fgf fgfr true etv pemt_low_nich malign caf_low fgffgfr fgf fgfr true wnta pemt_low_nich malign caf_low nlgnnrxn nlgn nrxn true cldn pemt_low_nich malign caf_low nlgnnrxn nlgn nrxn true etv pemt_low_nich malign caf_low rspolgr rspo lgr true ddc pemt_low_nich malign caf_low rspolgr rspo lgr true egfl pemt_low_nich malign caf_low compsdc comp sdc true cldn variabl target_express dbl target_expression_sc dbl target_fract dbl ligand_target_weight dbl activ dbl activity_norm dbl scaled_act dbl scaled_activity_norm dbl prioritization_scor dbl visual differenti nichenet output differenti express ligand express visual need defin import ligandreceptor pair per nich first determin nich highest score found ligandligandreceptor pair get top ligand per nich r top_ligand_niche_df prioritization_tablesprioritization_tbl_ligand_receptor selectnich sender receiv ligand receptor prioritization_scor group_byligand top_n prioritization_scor ungroup selectligand receptor nich renametop_nich nich top_ligand_receptor_niche_df prioritization_tablesprioritization_tbl_ligand_receptor selectnich sender receiv ligand receptor prioritization_scor group_byligand receptor top_n prioritization_scor ungroup selectligand receptor nich renametop_nich nich ligand_prioritized_tbl_oi prioritization_tablesprioritization_tbl_ligand_receptor selectnich sender receiv ligand prioritization_scor group_byligand nich top_n prioritization_scor ungroup distinct inner_jointop_ligand_niche_df filternich top_nich group_bynich top_n prioritization_scor ungroup get top ligand per nich look first top ligandreceptor pair kc take top score receptor per priorit ligand r receiver_oi malignant_high filtered_ligand ligand_prioritized_tbl_oi filterreceiv receiver_oi pullligand uniqu prioritized_tbl_oi prioritization_tablesprioritization_tbl_ligand_receptor filterligand filtered_ligand selectnich sender receiv ligand receptor ligand_receptor prioritization_scor distinct inner_jointop_ligand_receptor_niche_df group_byligand filterreceiv receiver_oi top_n prioritization_scor ungroup visual minimum lfc compar nich r lfc_plot make_ligand_receptor_lfc_plotreceiver_oi prioritized_tbl_oi prioritization_tablesprioritization_tbl_ligand_receptor plot_legend fals height null width null lfc_plot differential_nichenet_pemt_filesfiguregfmunnamedchunkpng show spatiald addit inform r lfc_plot_spati make_ligand_receptor_lfc_spatial_plotreceiver_oi prioritized_tbl_oi prioritization_tablesprioritization_tbl_ligand_receptor ligand_spati include_spatial_info_send receptor_spati include_spatial_info_receiv plot_legend fals height null width null lfc_plot_spati differential_nichenet_pemt_filesfiguregfmunnamedchunkpng ligand express activ target gene activ target gene infer cf default nichenet visual ligand activ ligandtarget link r exprs_activity_target_plot make_ligand_activity_target_exprs_plotreceiver_oi prioritized_tbl_oi prioritization_tablesprioritization_tbl_ligand_receptor prioritization_tablesprioritization_tbl_ligand_target outputexprs_tbl_ligand outputexprs_tbl_target lfc_cutoff ligand_target_matrix plot_legend fals height null width null exprs_activity_target_plotcombined_plot differential_nichenet_pemt_filesfiguregfmunnamedchunkpng base plot infer mani hypothes follow interestingli il famili ligand seem activ induc de gene high pemt low pemt malign cell mainli express myeloid cell cell type uniqu pemthigh tumor import ligandreceptor pair high differenti express conditionspecif ligand activ target gene enrich interest predict key regul intercellular commun process interest plot contain much inform look mani hit top ligand make plot cours less ligand well eg top r filtered_ligand ligand_prioritized_tbl_oi filterreceiv receiver_oi top_n prioritization_scor pullligand uniqu prioritized_tbl_oi prioritization_tablesprioritization_tbl_ligand_receptor filterligand filtered_ligand selectnich sender receiv ligand receptor ligand_receptor prioritization_scor distinct inner_jointop_ligand_receptor_niche_df group_byligand filterreceiv receiver_oi top_n prioritization_scor ungroup exprs_activity_target_plot make_ligand_activity_target_exprs_plotreceiver_oi prioritized_tbl_oi prioritization_tablesprioritization_tbl_ligand_receptor prioritization_tablesprioritization_tbl_ligand_target outputexprs_tbl_ligand outputexprs_tbl_target lfc_cutoff ligand_target_matrix plot_legend fals height null width null exprs_activity_target_plotcombined_plot differential_nichenet_pemt_filesfiguregfmunnamedchunkpng circo plot priorit ligandreceptor pair top much visual circo plot visual top r filtered_ligand ligand_prioritized_tbl_oi filterreceiv receiver_oi top_n prioritization_scor pullligand uniqu prioritized_tbl_oi prioritization_tablesprioritization_tbl_ligand_receptor filterligand filtered_ligand selectnich sender receiv ligand receptor ligand_receptor prioritization_scor distinct inner_jointop_ligand_receptor_niche_df group_byligand filterreceiv receiver_oi top_n prioritization_scor ungroup colors_send brewerpaln prioritized_tbl_oisend uniqu sort length name spectral magrittrset_namesprioritized_tbl_oisend uniqu sort colors_receiv clavend magrittrset_namesprioritized_tbl_oireceiv uniqu sort circos_output make_circos_lrprioritized_tbl_oi colors_send colors_receiv differential_nichenet_pemt_filesfiguregfmunnamedchunkpng differential_nichenet_pemt_filesfiguregfmunnamedchunkpng interpret result toprank differenti lr pair seem come cell type present pemthigh tumor might partial due biolog uniqu cell type one condit like import might also due way priorit fact uniqu cell type dont counterpart nich myeloid cell cell differ cell tumor microenviron ligand show strong differenti express differenti express myeloidtcel vs myofibroblastscafsendotheli cell lowpemt like pronounc compar differenti express cell cell type differ nichecondit caf pemthigh vs caf pemtlow conclus advantag differenti nichenet cope conditionspecifc cell type user awar final gener score might bias toward conditionspecif sender cell type therefor suggest also look top lr pair per sender cell type first figur case studi sender cell type conditionspecif visual condit pemtlow r receiver_oi malignant_low filtered_ligand ligand_prioritized_tbl_oi filterreceiv receiver_oi top_n prioritization_scor pullligand uniqu prioritized_tbl_oi prioritization_tablesprioritization_tbl_ligand_receptor filterligand filtered_ligand selectnich sender receiv ligand receptor ligand_receptor prioritization_scor distinct inner_jointop_ligand_receptor_niche_df group_byligand filterreceiv receiver_oi top_n prioritization_scor ungroup lfc_plot make_ligand_receptor_lfc_plotreceiver_oi prioritized_tbl_oi prioritization_tablesprioritization_tbl_ligand_receptor plot_legend fals height null width null lfc_plot differential_nichenet_pemt_filesfiguregfmunnamedchunkpng note limit comparison default nichenet default nichenet pipelin express ligandreceptor pair priorit base ligand activ alon differenti nichenet pipelin also draw inform base differenti express lr pair compar nich applic spatial locat focu differenti express ligandreceptor pair use default priorit weight de activ tend find mani differ hit default nichenet pipelin differenti nichenet tend find highd lowact hit wherea default nichenet find lowd highact hit note highd lowact hit might realli import low nichenet activ due limit nichenet activ predict eg improperincomplet prior knowledg within nichenet ligand might also high de activ dont strong signal effect eg ligand involv cell adhes opposit pair lowd highact strongli priorit differenti nichenet follow consid ligand regul posttranscript high predict activ might still reflect true signal high predict activ valu might due limit nichenet inaccur prior knowledg lowd ligand import biolog process interest although highd famili member ligand may sinc signal famili member tend similar high activ one condit might due downregul condit lead high activ low de current ligand activ automat calcul upregul gene per condit downregul gene could also sign ligand activ ligandreceptor pair high de high activ consid good candid regul process interest recommend test candid experiment valid refer browaey r saelen w saey nichenet model intercellular commun link ligand target gene nat method doi guilliam et al spatial proteogenom reveal distinct evolutionarili conserv hepat macrophag nich cell doijcel div idref classrefer cslbibbodi hangingind div idrefpuram_singlecell_ classcslentri puram sidharth v itay tirosh anuraag parikh anoop p patel keren yizhak shawn gillespi christoph rodman et al singlecel transcriptom analysi primari metastat tumor ecosystem head neck cancer cell e httpsdoiorgjcel div div paramet optim via mlrmbo robin browaey github markdown built use rmarkdownrendervignettesparameter_optimizationrmd output_format github_docu pleas dont run vignett show optim hyperparamet data sourc weight via modelbas optim see manuscript inform optim requir intens parallel comput perform optim parallel gridengin cluster via qsub packag httpscranrprojectorgwebpackagesqsubqsubpdf script mere illustr adapt user work system input data use vignett found doihttpszenodoorgbadgedoizenodosvghttpsdoiorgzenodo first load requir packag network use construct model evalu optim procedur r librarynichenetr librarytidyvers libraryqsub librarymlrmbo nichenet framework ligandtarget link predict base collect biolog knowledg ligandreceptor signal gene regulatori interact lr_network readrdsurlhttpszenodoorgrecordfileslr_networkrd sig_network readrdsurlhttpszenodoorgrecordfilessignaling_networkrd gr_network readrdsurlhttpszenodoorgrecordfilesgr_networkrd load ligand treatment valid dataset tri optim paramet maxim target gene ligand activ predict vignett optim dataset altern select specif subset dataset evalu final perform leftout dataset r ligand treatment express dataset use valid download zenodo expression_settings_valid readrdsurlhttpszenodoorgrecordfilesexpression_settingsrd defin optim wrapper function config inform qsub packag r mlrmbo_optimization_wrapp function librarynichenetr librarymlrmbo libraryparallelmap librarydplyr output mlrmbo_optim returnoutput qsub_config create_qsub_config remot myusermyclusteraddressorg local_tmp_path tmprgridengin remote_tmp_path scratchpersonalmyuserrgridengin num_cor memori g wait fals max_wall_tim perform optim r additional_arguments_topology_correct listsource_nam source_weights_dfsourc uniqu algorithm ppr correct_topolog fals lr_network lr_network sig_network sig_network gr_network gr_network set lapplyexpression_settings_validationconvert_expression_settings_evalu secondary_target fals remove_direct_link cutoff_method quantil nr_datasourc additional_arguments_topology_correctionsource_nam length obj_fun_multi_topology_correct makemultiobjectivefunctionnam nichenet_optim descript data sourc weight hyperparamet optim expens blackbox function fn model_evaluation_optim parset makeparamset makenumericvectorparamsource_weight len nr_datasourc lower upper makenumericvectorparamlr_sig_hub len lower upper makenumericvectorparamgr_hub len lower upper makenumericvectorparamltf_cutoff len lower upper makenumericvectorparamdamping_factor len lower upper hassimplesignatur fals nobject noisi fals minim cfalsefalsefalsefals setse run iter dese evalu parallel start design job_mlrmbo qsub_lapplyx fun mlrmbo_optimization_wrapp object_envir environmentmlrmbo_optimization_wrapp qsub_config qsub_config qsub_environ null qsub_packag null obj_fun_multi_topology_correct additional_arguments_topology_correct job finis take day shorter run time reduc number iter run r res_job_mlrmbo qsub_retrievejob_mlrmbo get optim paramet set result analysi r optimized_paramet res_job_mlrmbo process_mlrmbo_nichenet_optimizationsource_nam source_weights_dfsourc uniqu would interest gener contextspecif model could possibl would like optim paramet specif dataset interest gener ligand treatment dataset awar overfit though data dont know true activ ligand could optim target gene predict perform ligand activ perform order would need chang express set optim function includ data use function model_evaluation_optimization_appl instead model_evaluation_optim defin function paramet makemultiobjectivefunct shown