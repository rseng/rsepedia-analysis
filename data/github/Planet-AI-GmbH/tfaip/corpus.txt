python testhttpsgithubcomplanetaigmbhtfaipactionsworkflowspythontestymlbadgesvghttpsgithubcomplanetaigmbhtfaipactionsworkflowspythontestyml python testhttpsgithubcomplanetaigmbhtfaipactionsworkflowspythonpublishymlbadgesvghttpsgithubcomplanetaigmbhtfaipactionsworkflowspythonpublishyml _tfaip_ gener power research framework deep learn base tensorflow tfaip pythonbas research framework develop organ deploy deep learn model power tensorflowhttpswwwtensorfloworg enabl implement simpl complex scenario structur highli configur paramet directli modifi command line read docshttpstfaipreadthedocsio exampl tutorialfullexamplestutorialfullscenario learn mnist allow modifi graph train also hyperparamet optim bash export pythonpathpwd set pythonpath exampl dir found chang graph tfaiptrain examplestutorialful modelgraph mlp modelgraphnod modelgraphactiv relu tfaiptrain examplestutorialful modelgraph mlp modelgraphnod modelgraphactiv tanh tfaiptrain examplestutorialful modelgraph cnn modelgraphfilt modelgraphdens chang optim tfaiptrain examplestutorialful traineroptim rmsprop traineroptimizerbeta traineroptimizerclip_global_norm train model easili integr workflow predict provid data python predictor tutorialscenariocreate_predictorpath_to_trained_model predictorparam sampl predictorpredictdata printsampleoutput practic _tfaip_ follow rule object orient ie code scenario eg imageclassif mnist text recognit nlp etc organ implement class default scenariohttpstfaipreadthedocsioenlatestdocscenariohtml must implement modelhttpstfaipreadthedocsioenlatestdocmodelhtml datahttpstfaipreadthedocsioenlatestdocdatahtml see hereexamplestutorialful complet code run upper exampl mnist see hereexamplestutorialmin minim setup setup setup _tfaip_ creat virtual python least environ instal tfaip pip packag pip instal tfaip bash virtualenv p python venv sourc venvbinactiv pip instal tfaip pip instal tfaipdevel instal addit developmenttest requir look wikihttpstfaipreadthedocsioenlatestdocinstallationhtml setup instruct run tutori setup succeed launch train tutori implement common mnist scenario bash export pythonpathpwd set pythonpath exampl dir found tfaiptrain examplestutorialful gpu select specifi id tfaiptrain examplestutorialful devicegpu next step start read minimum tutorialexamplestutorialmin option look full tutorialexamplestutorialful see featur docshttpstfaipreadthedocsioenlatest provid full descript tfaip set _new custom scenario_ copi gener templateexamplestemplategener implement abstract method consid renam class launch train provid path packagenam new scenario _must_ locat pythonpath featur _tfaip_ _tfaip_ provid differ featur allow design gener scenario maximum flexibl high perform code design _fulli objectoriented_ implement class abstract function overwrit function extend adapt modifi default function _type support_ _tfaip_ fulli type simplifi work ide eg use pycharm use python dataclass modul set paramet automat convert paramet command line paiargparsehttpsgithubcomplanetaigmbhpaiargpars packag datapipelin everi scenario requir setup datapipelin read transform data tfaip offer easili implement modifi even complex pipelin defin multipl dataprocessor usual implement small oper map input sampl output sampl eg one dataprocessor load data inputfilenam outputimag anoth one appli normal rule anoth one appli data augment etc great advantag setup data processor run python automat parallel tfaip speed set run_paralleltru deeplearningfeatur sinc _tfaip_ base tensorflow full api avail design model graph even data pipelin furthermor tfaip support addit common techniqu improv perform deeplearn model box warmstart ie load pretrain model emaweight earlystop weightdecay variou optim learningr schedul contribut highli encourag user contribut scenario improv _tfaip_ pleas read contribut guidelineshttpstfaipreadthedocsioenlatestdocdevelopmenthtml benchmark time obtain intel core th gen cpu mnist follow tabl compar mnist tutori kera minimum tutorialexamplestutorialmin kera code adopt use network architectur hyperparemt set batch size epoch train code time per epoch train acc val acc best val acc kera _tfaip_ _tfaip_ kera result compar accuraci expect sinc actual code train graph fundament ident _tfaip_ howev bit slower due overhead input pipelin addit function eg benchmark automat track best model overhead neglig almost realworld scenario due clearli larger network architectur comput time infer backpropag becom bottleneck data pipelin integr purepython oper eg numpi tfdatadataset appli highlevel preprocess slow default sinc tfdatadatasetmaphttpswwwtensorfloworgapi_docspythontfdatadatasetmap cooper tfpy_functionhttpswwwtensorfloworgapi_docspythontfpy_funct run parallel therefor block python gil _tfaip_ curcumv issu provid option paralleliz input pipelin follow tabl show time second two differ task python appli pure python function data numpi appli sever numpi oper data mode task thread thread thread thread tfpy_funct python _tfaip_ python tfpy_funct numpi _tfaip_ numpi python task clearli show tfdatadatasetmap abl util multipl thread speedup numpi task occur possibl due paral numpi api c titl _tfaip_ gener power research framework deep learn base tensorflow tag python deep learn tensorflow kera research highlevel framework gener author name christoph wick orcid affili name benjamin kühn affili name gundram leifert affili name konrad sperfeld affili name tobia strauß affili name jochen zöllner orcid affili name tobia grüning orcid affili affili name planet ai gmbh warnowuf rostock germani index name institut mathemat univers rostock rostock germani index date march bibliographi paperbib summari _tfaip_ pythonbas research framework develop structur deploy deep learn project power tensorflow tensorflowwhitepap intend scientist univers organ research develop option deploy deep learn model _tfaip_ enabl simpl complex implement scenario imag classif object detect text recognit natur languag process speech recognit scenario highli configur paramet directli modifi command line api statement need implement scenario research develop typic compris sever task exampl set graph eg network architectur train eg optim learn rate schedul data pipelin eg data sourc current framework tensorflow kera see next section implement realiz one sever unstructur file python becom difficult maintain read bigger scenario furthermor compar framework also provid basic function recurr obstacl research develop typic redund scenario _tfaip_ resolv follow differ aspect eleg robust way research scenario usual configur via command line interfac cli usual must implement user _tfaip_ alreadi provid power cli dynam creat upon runtim pars nest dataclass hierarchi add new paramet even new set sub paramet user simpli add new field respect dataclass compar approach possibl paramet simultan avail cli dynam approach _tfaip_ show avail argument prevent user make mistak set paramet without effect current configur eg set factor adam optim even though rmsprop select default cli _tfaip_ provid command adapt variou hyperparamet learn rate schedul optim log debug profil earli stop furthermor compon scenario fulli custom allow exampl dynam configur network architectur eg insert layer chang paramet featur help research set variou experi exampl optim hyperparamet test novel idea comparison framework tensorflow _tfaip_ requir user implement scenario objectori way encourag annot code type particularli advantag larger complex scenario codebas grow accordingli use _tfaip_ lead clean structur modular readabl code limit poor code style facilit mainten practic scenario creat implement predefin interfac eg lossfunct graph construct research develop tediou step data prepar often compris convers data format requir framework tensorflowback _tfaip_ allow integr python code data pipelin howev run truli parallel multipl process result quit often bottleneck speedup tensorflow user transform python tensorflow oper labori sometim even imposs complic debug _tfaip_ tackl issu provid sophist pipelin setup base data processor appli simpl transform oper pure python code automat execut parallel anoth import step simplifi _tfaip_ deploy scenario framework plain tensorflow kera allow easili load train model predict howev includ data process predict api _tfaip_ instead automat appli preprocess infer train model option transform output postprocess pipelin one step inform pipelineconstruct embed within model enabl store load model differ data pipelin even scenario handi exampl certain preprocess step requir one specif model input expect final _tfaip_ automat log train process use tensorboard provid util script resum crash stop train set array train configur via excel sheet state field effici research area deep learn requir integr highli sophist opensourc framework tensorflow tensorflowwhitepap pytorch pytorch_ caff jiacaff cntk cntk trax trax framework provid effici tool freeli design deep learn scenario size complex howev number line code grow project structur meaning compon maintain compon almost ident deep learn scenario modul graph model data train valid predict ie applic train model furthermor support dynam paramet adapt instanc via command line desir effici research therefor obtain clean code base highli desir implement abstract templat alreadi set interact among modul provid basic function requir usecas _tfaip_ extens tensorflow solv thu help develop effici handl maintain small also largescal project research environ recent sever automl approach emerg eg googl cloud microsoft azur automl target develop limit machin learn expertis enabl train model autom process like network construct featur engin hyperparamet tune contrast _tfaip_ target research expertis deep learn actual design new network architectur data process pipelin setup train limit experi capac softwar engin _tfaip_ help structur maintain code base herebi also solv recurr problem like occur develop see next section _tfaip_ function follow highlight main function _tfaip_ basic concept _tfaip_ split paramet actual object wherebi paramet use instanti correspond object allow build hierarch paramet tree node replac paramet paramet also replac defin via command line enabl dynam adapt exampl even complet graph model research environ simplifi hyperparamet search setup experi classtempl defin logic structur realworld scenario scenario requir definit model data class wherebi basic function train export load model use data alreadi provid set data pipelin data gener list data processor implement defin raw data flow prepar data automat fed neural network sinc data processor written pure python simpl set debug data process pipelin speed data sampl gener pipelin automat run parallel model compris inform loss metric graph scenario templat herebi requir user implement method superordin modul connect automat _tfaip_ track train valid process util tensorboard provid tensorflow tensorboard extend custom data exampl plot precisionrecal pr curv render imag predict modul load train scenario easili appli new data deploy sinc model store pre postprocess pipelin addit data handl perform scenario follow predefin setup share research code clearer consequ easier review extend appli exampl modular simplifi process sever user work togeth scenario import featur _tfaip_ consist use python type modul includ type check lead clean understand code fewer error develop furthermor enabl ide pycharm pycharm perform autocomplet rare case highli gener api _tfaip_ might suffici tackl scenario option custom function implement base class exampl trainer data pipelin _tfaip_ document tutori help new user becom familiar _tfaip_ comprehens document sever tutori exampl scenario realworld usecas avail first _tfaip_ provid two tutori solv classif mnist _minimal_ scenario show minim implement requir implement common mnisttutori _tfaip_ _full_ scenario implement usecas highlight differ advanc featur _tfaip_ exampl provid transfer offici tensorflow tutori _tfaip_ framework scenario show power framework complex scenario logic split meaning part compon exampl compris automat text recognit atr singl text line imag imag classif fine tune bert final templat two basic scenario allow set new scenario copi basic code modifi afterward requir file class alreadi set sole abstract method implement class renam usag _tfaip_ research divers activ research project alreadi base _tfaip_ zoellner integr _tfaip_ solv natur languag process nlp problem sinc releas opensourc atr engin calamari wick_calamari_ base _tfaip_ research exampl recent public atr use transform use _tfaip_ wick_bidirectional_ acknowledg author would like thank opensourc commun especi develop maintain python tensorflow numpi sinc packag empow _tfaip_ work partial fund european social fund esf ministri educ scienc cultur mecklenburgwestern pomerania germani within project neiss grant esfbma refer tfaip exampl directori compris tutori usecas base _tfaip_ usecas provid basic implement must clearli extend actual realworld applic exampl orient tutori tensorflowhttpswwwtensorfloworgtutori requir exampl addit requir instal run shell pip instal examplesrequirementstxt list scenario mnisttutori mnist scenario design tutori show basictutorialmin extendedtutorialful featur _tfaip_ templatetempl templat set new scenario imag classificationimageclassif imag classif flower five class correspond tensorflow tutori avail herehttpswwwtensorfloworgtutorialsimagesclassif atratr linebas automat text recognit textfinetun berttextfinetuningbert finetun bert task decid whether two sentenc semant equival minim tutori welcom minim tutori show exampl mnist _tfaip_ structur custom scenario must implement scenario central class tutorialscenario option parametr tutorialscenarioparam addit paramet requir overal scenario tutorialscenario glue togeth datapipelin train data origin model graph data tutorialdatadatapi defin input target shape scenario case mnist input imag label img shape x dtype uint target gt simpl scalar use shape dtype uint python class tutorialdatadatabasedatabaseparam def _input_layer_specsself return img tftensorspecshap dtypeuint def _target_layer_specsself return gt tftensorspecshap dtypeuint train datagener next step load train data done tutorialdatagener note correspond paramet class actual instanti gener first load kerasdataset select desir partit depend pipelin mode gener datagener must overwrit __len__ return number sampl dataset gener provid sampl gener return load convert sampl python class tutorialdatageneratordatageneratortutorialdatageneratorparam def __init__self mode pipelinemod param tutorialdatageneratorparam super__init__mod param dataset getattrkerasdataset paramsdataset train test datasetload_data data train mode pipelinemodetrain els test selfdata to_samplesdata def __len__self return lenselfdata def generateself iterablesampl return selfdata afterward paramet defin trainerpipelineparamsbas must defin paramet set defin creat train data option valid data one train_val tutorialdatageneratorparamsset use train valid split two differ paramet train valid python pai_dataclass dataclass class tutorialtrainergeneratorparamstrainerpipelineparamsbasetutorialdatageneratorparam tutorialdatageneratorparam train_val tutorialdatageneratorparam fielddefault_factorytutorialdatageneratorparam metadatapai_metamodeflat def train_genself tutorialdatageneratorparam return selftrain_v def val_genself optionaltutorialdatageneratorparam return selftrain_v train pipelin setup model graph defin model graph tutorialmodel tutorialgraph describ correspond tutorialmodelparam class python pai_dataclass dataclass class tutorialmodelparamsmodelbaseparam n_class int fielddefault metadatapai_meta helpth number class depend select dataset number class must specifi could deriv data tutorialgraph inherit graphbas use tutorialmodelparamsstructur graphbas keraslay recommend tensorflow first creat layer __init__ function connect call method cnn two conv pool layer two dens layer ff creat input layer shape defin datadata abovedata therefor dict one entri img call function must also return dict tensor key later use access output eg loss metric python class tutorialgraphgraphbasetutorialmodelparam def __init__self param tutorialmodelparam nameconv kwarg supertutorialgraph self__init__param namenam kwarg selfconv convdkernel_s filter stride paddingsam nameconv selfpool maxpooldpool_s stride namepool selfconv convdkernel_s filter stride paddingsam nameconv selfpool maxpooldpool_s stride namepool selfflatten keraslayersflatten selfff ffout_dimens namef_ff activationrelu selflogit ffout_dimensionself_paramsn_class activationnon nameclassifi def callself input kwarg rescaled_img kexpand_dimskcastinputsimg dtypefloat conv_out selfpoolselfconvselfpoolselfconvrescaled_img logit selflogitsselfffselfflattenconv_out pred ksoftmaxlogit axi cl kargmaxpr axi return pred pred logit logit class cl correspond tutorialmodel must defin creat graph construct tutorialgraph next defin _loss inputs_target join dict input target come tutorialdatadata output outputdict previous defin tutorialgraph loss output graph must therefor wrap keraslay sparse_categorical_crossentropi wrap within lambdalay metric comput select gt target class output pass kerasmetricsaccuraci differ also complex method defin metric see full tutorialful exampl loss metric must return dict key use display inform log tensorboard final option defin determin best model _best_logging_settings_ select model max acc print use humanread inform valid _print_evaluatefunct receiv singl sampl unbatch display target predict predict correct python class tutorialmodelmodelbasetutorialmodelparam def create_graphself param tutorialmodelparam graphbas return tutorialgraphparam def _lossself inputs_target output dictstr anytensor return loss tfkeraslayerslambda lambda x tfkerasmetricssparse_categorical_crossentropyx from_logitstru nameloss inputs_targetsgt outputslogit def _metricself return acc metricdefinitiongt class kerasmetricsaccuraci def _best_logging_settingsself return max acc def _print_evaluateself input output dictstr anynumpi target dictstr anynumpi data print_fnprint correct outputsclass targetsgt print_fnfpredgt outputsclass correct els targetsgt p outputspredoutputsclass launch train train start call bash tfaiptrain tutorialmin read finish tutori look full tutorialful docshttpstfaipreadthedocsio full tutori tutori show use implement option handi featur tfaip go minim tutorialmin see scenario implement requir class function tutori set train mnist data use predict digit imag file overview follow featur cover tutori set datapipelin use dataprocessor see heredata set differ data gener trainingdatatraining_data_generationpi predictiondataprediction_data_generationpi see also heredata select configur differ dynam graphsdynamicgraph write imag file tensorboard see heremodelpi set predictor vote predict multipl individu model see herepredictorpi evalu dynam graph dynam graph allow chang setup layer paramet set command line first setup static graphgraphstutorialgraphpi handl creation dynam layer mnist graph also add final output addit layer sinc obligatori furthermor data normal reshap next creat base class base paramsgraphsbackendpi deriv keraslayerslay must layer implement variant add abstract method paramet defin creat layer cl class type return assum first argument __init__ paramet option defin gener typevar paramet use defin actual paramet type actual implement layer implement base class base paramet tutori cnngraphscnnpi mlpgraphsmlppi setup provid final add paramet select layer base param call graph modelparam option set choic flag pai_meta provid list avail paramet select static graphgraphstutorialgraphpi call abstract cl method retriev actual implement instanti fine tune bert tutori fine tune bert tutori map correspond tensorflow tutorialhttpswwwtensorfloworgofficial_modelsfine_tuning_bert _tfaip_ train bert cover tutori applic ie predict miss note instead larg bert tutori use albert hug facehttpshuggingfacecoalbertbasev pretrain model task decid whether sentenc semant equival eg two sentenc ident rover act robot geologist search evid past water rover act robot geologist move six wheel equival run run train scenario execut clone dir bash export pythonpathpwd requir scenario detect train tfaiptrain examplestextfinetuningbert traineroutput_dir ftbert_model tensorboard use view train process tensorboard logdir open httplocalhost tfaipmonitorpythonproject refer offici tensorflow tutorialhttpswwwtensorfloworgofficial_modelsfine_tuning_bert model zoo divers pretrain network avail hug facehttpshuggingfaceco templat scenario use blueprint set new listfilescenario implement recommend function test testpi file compris standard test run newli implement scenario especi test_data use debug input pipelin templat scenario use blueprint set new scenario implement recommend function test testpi file compris standard test run newli implement scenario especi test_data use debug input pipelin imag classif scenario imag classif tutori map correspond tensorflow tutorialhttpswwwtensorfloworgtutorialsimagesclassif _tfaip_ improv data augment dropout omit tutori integr exercis run run train scenario execut clone dir bash export pythonpathpwd requir scenario detect train tfaiptrain examplesimageclassif traineroutput_dir ic_model tfaiptrain examplesimageclassif traineroutput_dir ic_model devicegpu run train first gpu avail tfaiptrain examplesimageclassif modelconv_filt modeldens traineroutput_dir ic_model devicegpu tri differ larger model tensorboard use view train process tensorboard logdir open httplocalhost predict tfaippredict export_dir ic_modelbest dataimage_fil examplesimageclassificationexamplespxred_sunflowerjpg possibl output imag like belong sunflow percent confid refer offici tensorflow tutorialhttpswwwtensorfloworgtutorialsimagesclassif planet ai gmbh offer intellig imag analysishttpsplanetaideapplicationsimageanalysi abl local identifi mani visual categori imag video skill often util engin preprocess imag video segment certain object also use standalon solut atr scenario atrscenario exampl show implement linebas atrengin provid cnnlstmnetwork architectur train ctcalgorithm tutori show fundament includ requir algorithm document analysi gener part real ocrdocumentanalysi engin run run train scenario execut clone dir bash export pythonpathpwd requir scenario detect train tfaiptrain examplesatr traineroutput_dir atr_model tfaiptrain examplesatr traineroutput_dir atr_model devicegpu run train first gpu avail valid best model tfaiplav export_dir atr_modelbest dataimage_fil examplesatrworkingdiruw_linestestpng predict tfaippredict export_dir atr_modelbest dataimage_fil examplesatrworkingdiruw_linestestpng note predict print raw output network data work dirworkingdir provid exampl line uw dataset load default refer planet ai gmbh offer intellig document analysi suit idahttpsplanetaideapplicationsdocumentanalysi abl read even understand broad spectrum document ancient handwritten document modern machinegener one xlsx experiment tool design schedulinglog experi use xlsx file pass xlsx file pars xlsx desir gpu schedul option python execut target virtual env via python set updat write metric loss lastli calcul epoch schedul experi new sheet xlsx file launch workingdir note tool current requir python exampl run gpu tfaipexperiment xlsx demoxlsx gpu run cpu tfaipexperiment xlsx demoxlsx cpu xlsx file first row user option arbitrari user paramet result option arbitrari result experi must manual insert skip requir skip experi xlsx file pars script requir script run typic tfaiptrain expect script dir experi stop whatev reason skip finish train replac tfaiptrain tfaipresumetrain alreadi start finish train id requir id run best practic simpli use run integ cleanup requir cleanup output directori implement param requi tag mark begin paramet pass script second row param defin paramt group default group name eg optimizer_param pass follow paramet optimizer_param flag empti use previou group definit third row param label setup specifi paramet name eg epoch without dash option pass addit flag eg post_distortionssplitempti split split valu paramet individu arg empti allow paramet empti ad list note default empti null valu omit remark dont use formula xlsx file model model glue togeth sever part defin setup neural network eg reflossdocmodelloss refmetricsdocmodelmetr implement model requir overrid base class refmodelbasetfaipmodelmodelbas paramet refmodelbaseparamstfaipmodelmodelbaseparam see follow exampl tutori codeblock python pai_dataclass dataclass class tutorialmodelparamsmodelbaseparam n_class int fielddefault metadatapai_meta helpth number class depend select dataset staticmethod def cl return tutorialmodel def graph_clsself examplestutorialmingraph import tutorialgraph return tutorialgraph class tutorialmodelmodelbasetutorialmodelparam pass paramet overrid implement modelbaseparam requir overrid cl graph_cl return class type actual model refgraphdocgraphgraph loss loss function defin optim target model two way defin loss loss use keraslossesloss loss use tensor output multipl loss refweighteddocmodelloss weight outputvalu loss weight loss display consol reftensorboarddocmodeltensorboard overwrit _loss return dictionari loss key display label metric valu tensorvalu loss use keraslossesloss instanti loss __init__funct call _loss altern return scalarvalu tensor codeblock python def __initself arg kwarg super__init__arg kwarg selfscc_loss keraslossessparsecategoricalcrossentropyfrom_logitstru namekeras_loss def _lossself input target output dictstr anytensor return keras_loss selfscc_losstargetsgt outputslogit either call kerasloss raw_loss tfkeraslossessparse_categorical_crossentropytargetsgt outputslogit from_logitstru add raw loss loss weight multipl loss defin _loss_weight function implement return weight loss upper loss weight factor implement loss weight factor codeblock python def _loss_weightsself optionaldictstr float return keras_loss extended_loss metric similar loss model defin metric outputvalu metric display consol reftensorboarddocmodeltensorboard metric comput train valid data except refpur pythondocmodelpurepython metric one sole comput valid set overwrit _metric return list call kerasmetricmetr name metric use display codeblock python def __initself arg kwarg super__init__arg kwarg selfacc_metr kerasmetricsaccuracynameacc def _metricself input target output return selfacc_metrictargetsgt outputsclass custom metric must implement kerasmetricsmetr also possibl comput actual valu metric tensor beforehand wrap kerasmetricsmean purepython metric pure python metric defin model instead refevaluatordocscenarioevalu provid maximum flexibl sinc comput refload validatedoctrainingextend pure python log best model reftrainingdoctrainingtrain best model track automat export best best model determin model _best_logging_set default minimum loss sinc everi model provid inform want track best model exampl metric overwrit function instanc model defin refmetricdocmodelmetr acc use codeblock python def _best_logging_settingsself return max acc first return valu either max min second argument name metric loss output valid valid first exampl pass model _print_evalu function use display current state train humanread form mnisttrain could target class predict probabl eg codeblock python def _print_evaluateself sampl sampl data print_fnprint output target sampleoutput sampletarget correct outputsclass targetsgt print_fnfpredgt outputsclass correct els targetsgt p outputspredoutputsclass note sampl alreadi unbatch function also access dataclass map eg codec must appli tensorboard train output loss metric train valid set automat tensorboard data store output_dir defin training_trainingmd case addit refarbitrari datadocmodelarbitrari data imag raw data eg refprcurvesdocmodelprcurv shall written tensorboard arbitrari data add arbitrari addit data tensorboard ensur layer ad data inherit tfaiplayerbas provid method add_tensorboard must call tensorboardwrit valu follow exampl show write output convlay imag tensorboard tensorboardwrit receiv raw numpi data call provid func handl process raw data write tensorboard codeblock python def handlenam str valu npndarray step int creat imag data numpi array b w h c valueshap ax_dim intnpceilnpsqrtc out_conv_v npzerosb w ax_dim h ax_dim rangec x ax_dim ax_dim out_conv_v x wx w hy h valu write imag use name_for_tb step tfsummaryimagenam out_conv_v stepstep class layerstfaiplayerbas def __init__self arg kwarg super__init__arg kwarg selfconv_lay convd selfconv_mat_tb_writ tensorboardwriterfunchandl dtypefloat nameconv_mat def callself input kwarg conv_out selfconv_layerinput selfadd_tensorboardselfconv_mat_tb_writ conv_out return conv_out prcurv metric eg prcurv return binari data alreadi serial tensorboard data automat written tensorboard export addit graph codeblock python def _export_graphsself input dictstr tftensor output dictstr tftensor target dictstr tftensor dictstr tfkerasmodel overrid function del target requir default implement return default tfkerasmodelinputsinput outputsoutput function defin graph export default graph defin input output overrid function export differ addit graph eg want export encod encoderdecod setup return dict label kerasmodelsmodel export rootgraphconstruct root graph overwritten full flexibl creat graph case option codeblock python staticmethod def root_graph_cl typerootgraph tfaipmodelgraphbas import rootgraph return rootgraph predict refscenariodocscenarioscenario reftraineddoctrainingtrain evalu lavdocevaluationload valid lav predictor use appli result model new data similar lav predict perform command line tfaippredict programmat result sampl predictor pass refpost_procpipelinedocdatadata commandlin codeblock shell tfaippredict export_dir path_to_exported_model datadata_generator_param predictpredictor_param pipelinepipeline_param tfaippredict requir least path refexporteddoctrainingexport checkpoint save model model export_dir data flag use modifi input data predict flag set predictor anoth option flag pipelin allow specifi datapipelineparam eg number thread batch size programmat creat predictor call scenariocreate_predictormodel str param predictorparam overrid scenariopredictor_cl use custom predictor result object use predict given datageneratorparam raw input data predict_raw basic output datagener predict datapipelin predict_pipelin predict tfdatadataset predict_databas output function gener sampl predict sampl hold input output option avail data predictor_paramsinclude_target flag set also target exampl codeblockpython predictor myscenariocreate_predictorpath_to_saved_model predictorparam predict raw data sampl predictorpredict_rawsampleinputsnpzero printsampl predict data gener data mydatagener sampl predictorpredictdata printsampl tfaiptrainerschedul weight decay automodul tfaiptrainerschedulerschedule_weightdecay learn rate automodul tfaiptrainerschedulerlearningrate_param automodul tfaiptrainerschedulerlearningr constant automodul tfaiptrainerschedulerconstant_param automodul tfaiptrainerschedulerconst cosin decay automodul tfaiptrainerschedulercosine_decay_param automodul tfaiptrainerschedulercosine_decay exponenti decay automodul tfaiptrainerschedulerexponential_decay_param automodul tfaiptrainerschedulerexponential_decay tfaiptrainercallback earli stop automodul tfaiptrainercallbacksearlystoppingparam automodul tfaiptrainercallbacksearlystoppingcallback benchmarkcallback automodul tfaiptrainercallbacksbenchmark_callback emacallback automodul tfaiptrainercallbacksema_callback extractlogscallback automodul tfaiptrainercallbacksextract_log lavcallback automodul tfaiptrainercallbackslav_callback loggercallback automodul tfaiptrainercallbackslogger_callback progbarcallback automodul tfaiptrainercallbacksprogbar tensorboardcallback automodul tfaiptrainercallbackstensor_board_callback tensorboarddatahandlercallback automodul tfaiptrainercallbackstensor_board_data_handl tensorflowfixcallback automodul tfaiptrainercallbackstensorflow_fix trainparamsloggercallback automodul tfaiptrainercallbackstrain_params_logg debug sooner later point develop debug essenti sinc tfaip use tensorflow allow eager execut debug drastic simplifi comput graph manual trace debugg unfortun rare circumst lead code run eager graph mode usual reason oper use allow eagermod file show effici debug refdatapipelinedocdebuggingdatapipelin refmodeldocdebuggingmodel refgraphdocdebugginggraph reflossdocdebuggingloss refmetricsdocdebuggingmetr refprofiledocdebuggingprofil use tensorboard help detect bottleneck datapipelin debug datapipelin usual first step sinc help verifi data integr tfdatadataset debug easili tfaip pipelin base refdataprocessorsdocdatadata easili debug follow set datareftestdocinstallationtest scenario refdatadocdatadata class disabl multiprocess set run_parallelfals pre_proc post_proc paramet dataparam creat datapipelin call pipelinegenerate_input_sampl sampl return gener sampl unbatch input tfdatadataset option call pipelinegenerate_input_batch batch access output tfdatadatasetas_numpy_iter note make debug pipelin imposs tfdatadataset access use want verifi batch pad output dataset debug datapipelin exampl tutori codeblock python class testtutorialdataunittesttestcas def test_data_loadingself trainer_param tutorialscenariodefault_trainer_param data tutorialdatatrainer_paramsscenariodata trainer_paramsgentrain_datadatagenerate_input_samplesauto_repeat sampl sampl sampl printsampl unbatch debug trainer_paramsgentrain_datadatagenerate_input_batchesauto_repeat batch batch batch printbatch batch prepar input target tupl debug use print note generate_input_sampl run infinit train_data auto_repeatfals set gener epoch data model allow debug model enabl eager mode pass trainerforce_eag true reftrainingdoctrainingtrain lavrun_eagerli true reflavdocevaluationload valid lav full comput graph follow graph train addit pass scenariodebug_graph_construct evalu predict graph comput reflossdocdebuggingloss refmetricsdocdebuggingmetr real data recommend use flag error occur graph construct loss loss fulli debug eager mode metric metric model fulli debug eager mode also metric defin refevaluatordocscenarioevalu alway debug sinc run pure python profil profil use detect bottleneck scenario slow train pass trainerprofil true flag write full profil train graph mode requir tensorboard also look offici document httpswwwtensorfloworgtensorboardtensorboard_profiling_kerasuse_the_tensorflow_profiler_to_profile_model_training_performance_ optim input pipelin mani case input pipelin slow gener sampl model howev sever paramet tweak first enabl parallel process pipelin set run_parallel true increas number thread pipelin trainnum_process chang default behaviour prefetch trainprefech verifi size sampl small possibl python requir pickl data parallel drastic slow queuespe observ crucial problem input data size order mb consid chang data type eg uint instead int optim model standard way increas throughput model increas batch size memori gpu exceed trainbatch_s instal tfaip avail pypi httpspypiorgprojecttfaip_ thu instal pip codeblock shell pip instal tfaip prerequisit need instal follow system python later includ python develop packag ubuntu apt instal python pythondev avail distribut use deadsnak repo httpslaunchpadnetdeadsnakesarchiveubuntuppa_ ubuntu base distro gcc compil build essenti ubuntu apt instal buildessenti option cudacudnn lib gpu support see tensorflow httpswwwtensorfloworginstallsourcetested_build_configurations_ version requiredcompat setup virtual environ setup venv instal python must replac python later check python version codeblock shell virtualenv p python path_to_venv sourc path_to_venvbinactiv pip instal u pip recommend get latest version pip pip instal tfaip possibl bug pycocotool current numpi pycocotool fals compil run codeblock shell pip uninstal pycocotool pip instal nocachedir pycocotool fix venv reinstal recompil pycocotool test tfaip provid set test list test directori use unittest framework run test call python unittest pytest run test command line pycharm rightclick test select run unittest test shiftshift write run choos run unittest test cicd test automat run cicd develop setup develop support clone code instal requir fresh virtual environ link tfaip sourc virtualenv codeblock shell git clone httpsgithubcomplanetaigmbhtfaipgit git clone gitgithubcomplanetaigmbhtfaipgit cd tfaip virtualenv p python venv sourc venvbinactiv pip instal u pip recommend get latest version pip pip instal r requirementstxt pip instal r devel_requirementstxt requir requir test develop python setuppi develop develop contribut highli encourag user tfaip contribut scenario also welcom improv bug fix core class document creat github issu httpsgithubcomplanetaigmbhtfaipissues_ report bug seek support open pull request want contribut pull request checklist send pull request make sure follow read present contribut guidelin read code conduct httpsgithubcomtensorflowtensorflowblobmastercode_of_conductmd_ check chang consist guidelin check chang consist code style run unit test guidelin includ unit test contribut new featur help prove code work correctli b guard futur break chang lower mainten cost bug fix also gener requir unit test presenc bug usual indic insuffici test coverag keep api compat mind chang code tfaip everi pr requir sever cpu time ci test discourag submit pr fix one typo one warn etc recommend fix issu file level least eg fix typo file fix compil warn file etc test follow test best practic guid licenc includ licens top new file codeblock python copyright tfaip author right reserv file part tfaip tfaip free softwar redistribut andor modifi term gnu gener public licens publish free softwar foundat either version licens option later version tfaip distribut hope use without warranti without even impli warranti merchant fit particular purpos see gnu gener public licens detail receiv copi gnu gener public licens along tfaip see httpwwwgnuorglicens code style tfaip follow black python style guid httpsblackreadthedocsio_ pep httpspeporg_ short name packag lowercas separ eg ctctransform name file snake case eg data_param name class camelcas eg dataparamsatr name variabl snake case manual run black file call codeblock shell black automat appli black code style file commit precommit hook run codeblock shell precommit instal appli precommit hook call codeblock shell precommit run allfil integr black ide eg pycharm see httpsblackreadthedocsioenstableintegrationseditorshtml_ unittest unittest run call codeblock shell pytest run test parallel instal pytestxdist via pip instal pytestxdist call codeblock shell pytest n run test parallel note requir consider amount ram contribut scenario welcom user share scenario implement tfaip help user becom familiar tfaip also see alreadi exist solut certain problem simpli creat issu provid link scenario brief explan similar tfaip exampl expect scenario ship unittest document tfaiptrain toctre maxdepth caption modul callback tfaiptrainercallback optim tfaiptraineroptim schedul tfaiptrainerschedul warmstart tfaiptrainerwarmstart trainer automodul tfaiptrainertrain trainerparam automodul tfaiptrainerparam paramet class paramet use control everi modul tfaip includ hyperparamt train select graph modifi data pipelin etc modul split class provid actual implement paramet dataclass hold paramet eg trainer trainerparam paramsclass tfaip wrap dataclass pai_dataclass allow easili add new paramet support type automat access command line command line support provid paiargpars httpsgithubcomplanetaigmbhpaiargparse_ automat convert dataclass hierarchi command line argument follow primari paramet class list refscenariobaseparamsdocscenarioscenario refdatabaseparamsdocdatadata refmodelparamsdocmodelmodel refevaluatorparamsdocscenarioevalu reftrainerparamsdoctrainingtrain refdeviceparamsdocdevice_configdevic configur refoptimizerparamsdoctrainingoptim reflearningrateparamsdoctraininglearn rate refwarmstartparamsdoctrainingwarmstart reflavparamsdocevaluationload valid lav refpredictorparamsdocpredictionpredict paramet paramet shall avail train load model eg refresum trainingdoctrainingresum train reflavdocevaluationload valid lav must ad param class within hierarchi see custom paramet class allow add addit paramet class must wrap pai_dataclass dataclass make sure use descript name name field store dataclass eg codeblockpython pai_dataclass dataclass class backendparam addit paramet set could defin backend eg convolut neural net conv_filt listint fielddefault_factorylambda pai_dataclass dataclass class modelparamsmodelbaseparam default paramet set model param backend backendparam fielddefault_factorybackendparam subclass paramet class subclass dataclass inherit field parent tfaip use extend paramet almost everi modul note reason everi field must least dummi default valu requir paramet set command line must specifi set metadata field metadatapai_metarequiredtru hidden paramet hide paramet command line set field metadata mode ignor field metadatapai_metamodeignor paramet consid state paramet set chang train eg trainerparamsexport_best_st set scenario exchang inform eg dataparam could defin num_class pass modelparamsnum_class initi share paramet implement __post_init__ function parent dataclass possibl els overrid scenariobasecreate_model scenariobasecreate_data etc specifi paramet directli actual class instanti command line paramet hierarchi pars flatten allow set paramet command line follow type support see httpsgithubcomplanetaigmbhpaiargparsesupportedtypes_ full list exampl httpsgithubcomplanetaigmbhpaiargparseexamples_ primit type str int float bool enum intenum strenum list liststr listint listfloat listenum dataclass defin pai_dataclass dataclass also dict list name convent dataclass snake mode default dc_metamodesnak ad snake mode eg trainbatch_s dataclass flat mode pai_metamodeflat ad root paramet eg model trainer meta data httpsgithubcomplanetaigmbhpaiargparsemetadata_ specifi exampl add help string chang mode exampl codeblockpython dataclass import dataclass field type import list pai_dataclass dataclass class exampleparam exampl type fielddefaultdefault_valu metadatapai_metahelphelp str exampl epoch int fielddefault metadatapai_metahelpnumb epoch train factori gpu listint fielddefault_factorylist metadatapai_metahelpgpu use static paramet static paramet paramet must know creat certain class modelbas databas graphbas predictorbas lav evalu rootgraph hereto add paramet addit argument respect __init__ function overrid respect paramet function scenariobas see httpsgithubcomplanetaigmbhtfaiptreemasterexampleshowtosstaticmodelparameters_ usag modelbas databas graphbas use want pass paramet databas instanti modelbas evalu eg size load codec token see usag atr exampl httpsgithubcomplanetaigmbhtfaiptreemasterexamplesatrscenariopy_ tfaipmodel modelbas automodul tfaipmodelmodelbas modelbaseparam automodul tfaipmodelmodelbaseparam tfaipdata databas automodul tfaipdatadata databaseparam automodul tfaipdatadatabaseparam data data class respons load eg imag text process eg data augment sampl sampl singl instanc data process network preprocess pipelin handl data fed refmodeldocmodelmodel appli list dataprocessor eventu set tfdatadataset furthermor postprocess pipelin ad process data eg prune produc network figur show overview preprocess pipelin provid tfaip actual pipelin lower half purpl creat list dataprocessorparam upper half orang input pipelin datageneratorparam golden depend step train lav predict usual listsfiledatageneratorparam simpli gener filenam pars text file see scenariodocscenariolistfilescenario set listfilescenario figur resourcesdatapipeline_workflowpng alt datapipelin workflow figur data process pipelin implement data class extend tfaipdatadata import databas implement follow codeblock python pai_dataclass dataclass class dataparamsdatabaseparam staticmethod def cl return data class datadatabasedataparam abstractmethod def _input_layer_specsself dictstr tftensorspec rais notimplementederror abstractmethod def _target_layer_specsself dictstr tftensorspec rais notimplementederror classmethod def default_paramscl option overwritten p superdefault_param ppre_procprocessor option pass list dataprocessorparam defin input pipelin see orang box figur return p extend databaseparam return actual implement cl method recommend separ python file eg call paramspi requir overrid two requir method overwrit return dict map node name tftensorspec eg codeblock python def _input_layer_specsself dictstr tftensorspec shape type input data graph return img tftensorspecshap dtypefloat def _target_layer_specsself dictstr tftensorspec shape type input data graph return tgt tftensorspecshap dtypeint fix x input imag class label target batch dimens must omit batch perform automat import scalar allow allow shape scalar n vector hwc tensor option overrid default array automat pad zero overwrit _padding_valu provid differ valu codeblock python def _padding_valuesself dictstr anynumpi return img prepostprocess pipelin dataprocessor enabl modifi data consum produc list sampl two type data processor mappingdataprocessor similar default map function python produc one output sampl input sampl map generatingdataprocessor similar gener python n sampl consum sampl produc wherebi mn mn equal legitim dataprocessor defin construct correspond dataprocessorparam dataprocessor definit follow show simpl dataprocessor load imag gt drive base filenam option add paramet eg color mode case processor param codeblock python pai_dataclass dataclass class loadsampleprocessorparamsdataprocessorparam def clsself return loadsampleprocessor class loadsampleprocessormappingdataprocessor def applyself sampl return sampl new_inputsload_imagesampleinput chang input new_targetsload_gtsampletarget chang target set overrid default_param dataclass set default preprocess pipelin codeblock python classmethod def default_paramscl listfiledataparam setup default process pipelin param superdefault_param paramspre_proc sequentialdataprocessorpipelin run_paralleltru set true pipelin shall run parallel processor loadsampleprocessorparam load sampl gt augmentprocessorparamsmodespipelinemodetrain appli data augment train finalizeprocessorparam final sampl ie bring correct form matchin input target layer spec return param mode dataprocessor shown previou code dataprocessorparam provid field appli processor augmentprocessorparam ie data augment shall appli train pipelin resourc quit often model requir resourc train also later applic typic resourc file need serv export model dataclass automat handl export resourc via resourcemanag copi resourc export dir automat adapt search path resourc defin resourc paramet codeblock python pai_dataclass dataclass class dataparamsdatabaseparam charmap resourc fielddefaultnon metadatapai_metahelpfil specifi charact map use requiredtru configencoderresourceencod decoderresourcedecod exampl charact map automat copi resourc dir export model develop section provid addit inform actual implement data pipelin tfaip read interest understand extend tfaip follow imag provid overview relev class figur resourcesdatapipeline_overviewpng alt datapipelin overview figur overview class with data modul look code document descript individu class follow small overview red databaseparam databas defin overal structur data pipelin connect dataprocessorparam call get_or_create_pipelin create_pipelin datapipelin prepar yellow datagener provid data preprocess pipelin actual implement depend scenario mode eg differ data sourc train lav predict orang creation definit differ dataprocessor type user overrid mappingdataprocessor generatingdataprocessor multipl mappingdataprocessor join sequenceprocessor faster execut send complet block spawn process upon parallel green set actual pipelin use paramet default sequenceprocessorpipelineparam suffic howev generatingdataprocessor play role might sensibl provid custom group done via compoundprocessorpipelineparam note sequenceprocessorpipelineparam convert automat compoundprocessorpipelineparam see figur blue class use actual data process set mappingdataprocessor mappingsampleprocessorpipelin one generatingdataprocessor generatingsampleprocessorpipelin class correspond parallel version see lower half figur construct actual processor call dataprocessorparamscr perform within class ensur paramet pass spawn process actual class might serializ via pickl yellow lower right tfdatasetgener option overwritten datapipelin chang creation tfdatadataset inject addit data map perform tensorflow tfaippredict predictorbas automodul tfaippredictpredictorbas predictorparam automodul tfaippredictparam predictor automodul tfaippredictpredictor multimodelpredictor automodul tfaippredictmultimodelpredictor train section deal refstart doctraininglaunch train refresumedoctrainingresum train via command line modifi reftrain hyperparametersdoctrainingparamet commandlin use command line launch resum train launch train train scenario perform trainpi script launch tfaiptrain codeblock shell tfaiptrain scenario_modul param scenario_modul must locat pythonpath either give full name scenario class scenario file parent modul codeblock shell tfaiptrain tfaipscenariotutorialfullscenariotutorialscenario tfaiptrain tfaipscenariotutorialfullscenario tfaiptrain tfaipscenariotutorialful first option requir multipl scenario locat singl python file resum train train resum use python resume_trainingpi tfaipresumetrain specifi checkpoint that eg codeblock shell tfaiptrain tfaipscenariotutorialful traineroutput_dir model_output cancel tfaipresumetrain model_output resum train adapt paramet eg extend epoch support directli yet howev manipul trainer_param output_dir manual adapt set debug train use debugg call tfaipscriptstrainpi instead tfaiptrain runconfigur eg pycharm see refheredocdebuggingdebug inform valid train valid train use comput print valid perform comput best perform model see refearlystoppingdoctrainingearlystop valid option perform provid valid list eg vallist reflistfilescenariodocscenariolistfilescenario default default valid perform kera thereto comput provid loss metric respect refmodeldocmodelmodel default valid run everi epoch defin trainerparamsval_every_n paramet default note default valid perform train graph therefor scenario requir differ predict graph eg encoderdecodermodel use extend valid extend possibl run clean valid via lav_evaluationmd train ie load current predict graph appli valid list enabl set trainerparamslav_every_n paramet specifi epoch run eg trainerlav_every_n first last epoch alway valid lav enabl default lav use valid gener overwritten respect trainingpipelinegeneratorparam note reflistfilescenariodocscenariolistfilescenario alreadi provid addit paramet lavlist default vallist lav evalu metric includ one refevaluatordocscenarioevalu print also reftensorboarddoctrainingtensorboard paramet import paramet train output_dir defin store log export model checkpoint set traineroutput_dir my_output_dir paramet introduc follow log tfaip use log modul python set log level use tfaip_log_level environ variabl eg tfaip_log_leveldebug default log level set info log event written log print also written trainlog learn rate learn rate adapt use trainerlearning_r field must set learningrateparam structur learningrateparam alway provid lrfield modifi overal learn rate default exampl learning_ratelr chang schedul set learn rate field directli learning_r exponentialdecay paramet schedul set similarli eg learning_ratedecay optim optim trainer chang adapt via traineroptim field optimizerparam structur tfaip support differ optim default adam adamax adabelief rmsprop sgd one come custom paramet exampl optim adamax adap paramet optim call eg optimizerepsilon e gradientclip optim support gradientclip base tensorflowoptim httpswwwtensorfloworgapi_docspythontfkerasoptimizersoptimizer_ clip_valu clip_norm clip_global_norm exampl optimizerclip_global_norm weightdecay global weight decay appli weight provid adam sgd optim addit weight_decay field default altern implement weightdecay directli defin layer recommend tensorflow httpswwwtensorfloworgtutorialskerasoverfit_and_underfitcombined_l_dropout_ exampl optimizerweight_decay emaweight tfaip support comput exponenti move averag ema weight enabl trainercalc_ema mani case lead improv result drawback gpumemori requir train note export model alway save along ema checkpoint compris ema last weight ie current state trainer furthermor ema weight use valid paramet expect ema rate rate comput automat exampl trainercalc_ema train scope use trainerno_train_scop pass regex defin layer exclud train note parent layer match children also train exampl trainerno_train_scop conv warmstart warmstart model train predefin weight support see warmstartparam option exampl warmstartmodel path_to_warmstart_model customis warm start pass custom paramet warmstart mywarmstart need inherit warmstartparam devic see refdeviceconfig docdevice_configdevic configur set trainerdevic exampl devicegpu earlystop set earli stop via earlystoppingparam trainerearly_stop allow trainer automat determin differ constraint stop monitor base best model determin refset modeldocmodellog best model enabl earli stop set n_to_go number epoch stop train improv achiev modifi test everi epoch increas frequenc default ie test everi epoch furthermor specifi lower_threshold upper_threshold depend mode setup monitor valu must least one threshold earli stop start one reach train stop immedi exampl monitor max accurari upper_threshold lower_threshold train stop accuraci least reach earli stop could kick howev accuraci exce equal train stop immedi therefor set upper_threshold sensibl monitor accuraci export checkpoint save model train sever modelsweight log checkpoint store complet state weight optim use resum train best save model store best model valid set export save model final state model last model two format checkpoint weight store use continu train refwarmstartdoctrainingwarmstart save model serv model weight store use lav api eg java also use refwarmstartdoctrainingwarmstart custom export model default export graph use avail input output tensor ie input output refcreat graphdocgraphgraph modifi add addit graph export overrid _export_graphsdocmodelexport addit graph function modelbas tensorboard train monitor tensorboard httpswwwtensorfloworgtensorboard_ hereto tfaip automat store metric loss train valid lav dataset output_dir display tensorboard launch tensorboard via tensorboard log_dir path_to_the_model bind_al addit output imag prcurv setup refmodel docmodeltensorboard benchmark profil train full train profil use tensorboard instal requir tensorboard_plugin_profil set trainerprofil true benchmark input pipelin quit often bottleneck model input data pipelin abl produc enough sampl per second replac tfaiptrain tfaipbenchmarkinputpipelin run profil number sampl per second default benchmark run infinit termin process stop benchmark tfaiptraineroptim optim automodul tfaiptraineroptimizeroptim gradient accumul optim automodul tfaiptraineroptimizergradient_accumulation_optim weight move averag automodul tfaiptraineroptimizerweights_moving_averag data pipelin data pipelin use standalon without requir setup full data class use simpli appli data pipelin compris list processor codeblock python tfaipimport import databaseparam obtain creat data param scenario param also includ data_param scenariodata_param run preproc pipelin arbitrari pipelin pipeline_param data_paramspre_proc creat sampl empti also datageneratorparam instanc sampl sampl creat pipelin pipelin pipeline_paramscreatedatapipelineparamsnum_process limit data_param appli pipelin sampl retriev output enumeratepipelineapplysampl printi load valid lav file describ evalu train model perform loadandvalid lav lav load refexport modeldoctrainingexport checkpoint save model appli provid data final comput refmetricsdocmodelmetr reflossesdocmodelloss defin refmodeldocmodelmodel also output option provid refevaluatordocscenarioevalu call lav via command line load valid model use save modelhttpgiteaplanetaidepaitf_aipwikimodelexport eg export best tfaiplav script usag codeblockshel tfaiplav export_dir path_to_saved_model paramet lavparam pipelineparam lavparam access directli via lav eg codeblockshel lavbatch_s lavnum_process deviceparam set eg codeblockshel lavdevicegpu datageneratorparam tfaiplav allow adapt data gener paramet use chang evalu data default valid gener train use reflistfilescenariodocscenariolistfilescenario evalu list chang codeblockshel datalist other_val_list paramet specifi runeagerli run lav eagermod use debug dump dump target predict pickl file implement custom lav lavextract_dump_data modifi dump implement custom lav default lav modul extend chang default behaviour forget regist refscenariodocscenarioscenario scenariobaselav_cl scenariobasecreate_lav tfaipevalu evaluatorbas automodul tfaipevaluatorevalu evaluatorparam automodul tfaipevaluatorparam tfaip document contain necessari inform effect work tfaip depict structur concept tfaip provid step step tour throughout necessari compon tfaip offer two tutori new tfaip look minim tutori httpsgithubcomplanetaigmbhtfaiptreemasterexamplestutorialmin_ get impress tfaip structur quickli set new scenario copi either tutori httpsgithubcomplanetaigmbhtfaiptreemasterexamplestutorial_ templat httpsgithubcomplanetaigmbhtfaiptreemasterexamplestemplate_ templat show common function must implement search rais notimpl comment written squar bracket set custom scenario toctre maxdepth caption document instal docinstal paramet docparamet scenario docscenario data docdata data pipelin docdatapipelin model docmodel graph docgraph train doctrain evalu docevalu predict docpredict devic configur docdevice_config debug docdebug develop docdevelop toctre maxdepth caption tutori templat exampl minim tutori httpsgithubcomplanetaigmbhtfaiptreemasterexamplestutorialmin full tutori httpsgithubcomplanetaigmbhtfaiptreemasterexamplestutorialful gener templat httpsgithubcomplanetaigmbhtfaiptreemasterexamplestemplategener listfil templat httpsgithubcomplanetaigmbhtfaiptreemasterexamplestemplatelistfil exampl httpsgithubcomplanetaigmbhtfaip_example_scenario toctre maxdepth caption modul tfaipdata tfaipdata tfaipevalu tfaipevalu tfaiplav tfaiplav tfaipmodel tfaipmodel tfaipscenario tfaipscenario tfaippredict tfaippredict tfaiptrain tfaiptrain indic tabl refgenindex refmodindex refsearch graph tfaip graph must inherit genericgraphbas subclass graphbas alreadi encapsul option method graph construct graphbas exampl multilayerperceptron mlp graph mnist shown follow code exampl excerpt tutori codeblock python class tutorialgraphgraphbasetutorialmodelparam def __init__self param tutorialmodelparam nameconv kwarg supertutorialgraph self__init__param namenam kwarg creat layer selfflatten flatten selfff dens namef_ff activationrelu selflogit denseself_paramsn_class activationnon nameclassifi def build_graphself input trainingnon connect layer return dict output rescaled_img kcastinputsimg dtypefloat logit selflogitsselfffselfflattenrescaled_img pred ksoftmaxlogit axi cl kargmaxpr axi pred pred logit logit class cl return layer instanti __init__ function appli build_graph function sole abstract method graphbas genericgraphbas genericgraphbas class provid flexibl creat graph includ differ graph train build_train_graph predict build_prediction_graph exampl requir implement sequencetosequ model decod depend model teacherforc train decod predict furthermod method pre_proc_target overwritten appli preprocess dataset target fed metric tfaipscenario scenariobas automodul tfaipscenarioscenariobas scenariobaseparam automodul tfaipscenarioscenariobaseparam listfil listfilescenario automodul tfaipscenariolistfilelistfilescenario paramet automodul tfaipscenariolistfileparam data gener automodul tfaipscenariolistfiledatagener tfaiplav lav automodul tfaiplavlav multilav automodul tfaiplavmultilav lavparam automodul tfaiplavparam callback automodul tfaiplavcallbackslav_callback automodul tfaiplavcallbacksdump_result devic configur definit devic visibl use tfaip thu tensorflow defin via deviceconfigparam use reftrainingdoctrainingdevic refvalidationdocevaluationlavparam predict structur also allow modifi distributionstrategi train sever gpu select gpu default tfaip use gpu modifi use gpu set deviceconfigparamsgpu flag expect list gpu indic eg codeblock trainerdevicegpu use gpu index altern environ variabl cuda_visible_devic set tfaip use gpu train multigpu setup set deviceconfigparamsdist_strategi flag mirror central_storag defin use multipl devic scenario scenario contain implement custom task shall solv tfaip scenario glue togeth compon must implement see figur figur resourcesscenariopng alt scenario overview figur scenario overview scenariobas green creat refmodeldocmodelmodel blue refdatadocdatadata purpl reftrainingdoctrainingtrain red refload validatedocevaluationload valid lav lav orang refpredictiondocpredictionpredict yellow access scenario also instanti scenariobas allow implement custom overrid scenario directori scenario set directori compris follow file scenariopi defin basic scenario inform modelpi defin refmodeldocmodelmodel neural net datapi defin input refdatadocdatadata pipelin model graphspi defin refgraphsdocgraphgraph model paramspi option recommend store paramet data model scenario note data param implement alway implement differ file data els occurr warn data pipelin tfaip set clone repositori scenario class locat tfaipscenarioxxxscenariopi xxx scenario name eg atr refinstalleddocinstallationinstal via pypi ie pip instal tfaip arbitrari directori use locat scenario implement scenario implement scenariobas first refsetup directori filesdocscenarioscenario directori scenariopi paramspi implement myscenarioparam codeblock python pai_dataclass dataclass class myscenarioparamsscenariobaseparamsmydataparam mymodelparam pass mydataparam mymodelparam implement databaseparam modelbaseparam defin paramet data model next implement actual scenario codeblock python class myscenarioscenariobasemyscenarioparam mytrainerpipelineparam pass mytrainerpipelineparam defin input data sourc train extend either trainerpipelineparamsbas trainerpipelineparam deriv listfilescenario alreadi implement trainerpipelineparam assum list file input see refheredocscenariolistfilescenario develop scenario defin sever gener use instanti actual class tmodel tdata tscenarioparam ttrainerpipelineparam listfilescenario replac ttrainerpipelineparam listfiletrainerpipelineparam addit modul follow addit methodsfunction scenario option implement list evalu quit often defin metric difficult pure tensorflowoper trivial use python numpi furthermor metric also first comput postprocessing_datamd purpos tfaip offer evalu similar kerasmetr howev advantag anyth comput flexibl evalu option parametr evaluatorparam similar kerasmetr evalu requir overwrit two function name update_st result update_st receiv postprocess unbatch sampl updat intern state final result shall yield dictionari metric evalu follow contextdesign python metric __enter_ valid __exit_ receiv result use mechan clear intern state evalu attach scenario use evaluator_clsmethod exampl full tutori provid exampl codeblock python class mnistevaluatorevalu def __init__self param supermnistevalu self__init__param selftrue_count selftotal_count def __enter__self selftrue_count selftotal_count def update_stateself sampl sampl selftotal_count selftrue_count npsumsampletargetsgt sampleoutputsclass def resultself dictstr anynumpi return eval_acc selftrue_count selftotal_count add scenario codeblock python classmethod def evaluator_clscl return mnistevalu tensorboard train comput metric result written tensorboard also allow comput custom data eg imag prcurv within evalu refmodeldocmodeltensorboard defin write arbitrari data tensorboard listfilescenario listfilescenario abstract scenariobas alreadi provid addit function use list file input sourc list file simpl text file line path sampl eg imag codeblock pathtoimage_png pathtoimage_png pathtoimage_png follow show extend listfilescenario assum new scenario model model correspond param modelparam data correspond dataparam work list file new scenario call scenario requir set param correspond implement note class empti sinc case extra function requir codeblock python pai_dataclass dataclass class scenarioparamsscenariobaseparamsdataparam modelparam pass class scenariolistfilescenarioscenarioparam pass tfaiptrainerwarmstart warmstartparam automodul tfaiptrainerwarmstartwarmstart_param warmstart automodul tfaiptrainerwarmstartwarmstart