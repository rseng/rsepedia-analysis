titl omg scalabl flexibl simul test environ toolbox intellig microgrid control tag python openmodelica microgrid reinforc learn energi system simul test control author name stefan heid affili name daniel weber affili name henrik bode affili name eyk hüllermeier affili name oliv wallscheid orcid affili affili name chair intellig system machin learn paderborn univers paderborn germani index name chair power electron electr drive paderborn univers paderborn germani index date may bibliographi paperbib summari openmodelica microgrid gym omg toolbox provid transient simul framework local energi grid base power electron convert openmodelica use backend allow user set arbitrari electr grid design via wellknown graphic user interfac plugandplay fashion fritzson simul configur use python interfac make easi integr softwar modul realiz test close control loop addit openai gym interfac provid connect datadriven reinforc learn algorithm investig intellig microgrid control approach openai labelfigomgomgpng _fig overview interconnect differ part omg toolbox openmodelica openaigym logo properti respect owners_ background microgrid control micro smartgrid msg play import role integr renew energi sourc convent electr grid provid power suppli remot area lund due high effici flexibl power electron convert larg use drive modern msg power electron describ applic solidst electron control convers electr power larg perform semiconductor switch devic diod power transistor includ energi convers term voltag current amplitud frequenc phase angl well number phase two electr energi system connect control msg challeng task due high requir energi avail safeti voltag qualiti particularli demand due wide rang differ msg topolog depend field applic like industri campus residenti area remot offgrid electrif kroposki result high demand comprehens test new control concept develop phase comparison state art ensur feasibl appli particular datadriven control approach reinforc learn rl stabil oper behavior evalu priori garcia state field omg pythonbas packag model simul microgrid base power electron energi convers openmodelica fritzson librari enabl user defin microgrid ie local electr grid contain arbitrari sourc storag load flexibl scalabl way use certain predefin exampl grid due componentori model framework base openmodelica dynam process small time scale focu allow accur control test investig transient steadyst essenti differ alreadi avail opensourc solut simul electr energi network contrast gener depict largescal transmiss network abstract model quasistationari state eg pypsa brown pandapow thurner addit pure model simul microgrid basic build block set hierarch control framework inner primari level guerrero provid omg interfac control reinforc learn api design provid userfriendli interfac connect model microgrid simul environ wide rang control method classic linear feedback control model predict control techniqu cf fig moreov standard openai gym interfac openai also avail train datadriven control approach like rl enabl user want integr contemporari opensourc pythonbas rl toolbox stabl baselin stablebaselin tfagent tfagent kerasrl plappertkerasrl mani auxiliari function essenti oper microgrid ship omg coordin transform basic control class monitor wrapper phaselock loop frequenc phase angl extract follow structur nearli everi control approach includ datadriven rl implement test omg rel short amount time highlight challeng datadriven control approach safetycrit environ applic exampl use safe bayesian optim berkenkamp autom control design provid toolbox intend use target audienc omg design use student academ industri research field control energi engin data scienc primari object toolbox facilit entri new user model control test microgrid provid platform differ control method includ rl compar defin condit benchmark featur omg toolbox provid follow key featur librari scalabl flexibl design local electr grid openmodelica user select wide rang differ grid compon connect plugandplay approach dynam simul local electr grid compon level includ singl multiphas system well ac dc oper easi exchang model comput platform simul model use fmi standard fmi c code insid pyfmi pyfmi access python appropri numer solver underli system ordinari differenti equat easili chosen within usual python packag eg scipi due usag cosimul calcul evalu monitor everi singl time step cover state action auxiliari quantiti provid interfac manual autom inspect latter particularli use automat train datadriven control approach reinforc learn larg varieti predefin parameteriz control droop voltag current multi singlephas avail easi implement userdefin control structur possibl monitor tool follow live perform rl agent map overal grid behaviour depend select paramet set interest use case appli safe datadriven learn highlight requir safeti delic control environ avail exampl detail exampl shown omg whitepap httpsarxivorgpdfpdf includ implement evalu safe bayesian control berkenkamp safeopt learn algorithm appli automat control tune problem safetyrelev state constraint differ microgrid topolog eg differ number invert load characterist furthermor provid evalu tool enabl user compar perform differ rl algorithm manual tune invert avail instal omg support test linux window mac user ask run toolbox linux vm packag instal conda environ pyfmi instal via conda instal c condaforg pyfmi omg packag pip python packag manag use pip instal openmodelica_microgrid_gym command sourc code guid dataset avail github repositori httpsgithubcomupbleaopenmodelicamicrogridgym individu contribut author follow shown main field individu contributor omg heid main softwar architectur softwar modul integr unit test weber applic exampl controlrel auxiliari featur eg basic expert control unit test h bode design specif openmodelica librari creat omg grid model simul data transfer openmodelica python unit test wallscheid concept design idea gener test technic feedback administr project manag e hüllermeier administr project manag conceptori feedback acknowledg author kindli acknowledg valuabl contribut advic regard grid control design jarren lang author would also like acknowledg fund support work paderborn univers research grant refer highlight shell contribut contribut welcom greatli appreci everi littl bit help credit alway given contribut mani way type contribut report bug report bug httpsgithubcomupbleaopenmodelica_microgrid_gymissu report bug pleas includ oper system name version detail local setup might help troubleshoot detail step reproduc bug fix bug look github issu bug anyth tag bug help want open whoever want implement implement featur look github issu featur anyth tag enhanc help want open whoever want implement write document openmodelica microgrid gym could alway use document whether part offici openmodelica microgrid gym doc docstr even web blog post articl submit feedback best way send feedback file issu httpsgithubcomupbleaopenmodelica_microgrid_gymissu propos featur explain detail would work keep scope narrow possibl make easier implement rememb volunteerdriven project contribut welcom get start readi contribut here set openmodelica_microgrid_gym local develop fork openmodelica_microgrid_gym repo github clone fork local git clone gitgithubcomyour_name_hereopenmodelica_microgrid_gymgit instal local copi virtualenv assum virtualenvwrapp instal set fork local develop mkvirtualenv openmodelica_microgrid_gym cd openmodelica_microgrid_gym python setuppi develop creat branch local develop git checkout b nameofyourbugfixorfeatur make chang local your done make chang check chang pass pytest pytest commit chang push branch github git add git commit detail descript chang git push origin nameofyourbugfixorfeatur submit pull request github websit pull request guidelin submit pull request check meet guidelin pull request includ test pull request add function doc updat put new function function docstr add featur list readmerst pull request work python pypi check httpstraviscicomupbleaopenmodelica_microgrid_gympull_request make sure test pass support python version tip run subset test pytest teststest_openmodelica_microgrid_gym deploy remind maintain deploy make sure chang commit includ entri historyrst run bumpvers patch possibl major minor patch git push git push tag travi deploy pypi test pass credit develop lead lea uni paderborn upbleamailupbd contributor none yet first histori next chang modelicaenv introduc action clip model_param none valu pass openmodelica env allow initi model_param neg time valu introduc initi fix introduc abort reward env episod termin introduc obs_output defin subset histori given observ agent fix omgnetmasterinvert default valu use overwrit pass valu add random process wrapper obstempl test reset test initi env api modelicaenv use network __init__ remov timestep model_output model_input ad network delay buffer network compon specifi class structur use config file correspond fmu see netfold ad nois safeoptag __init__ perform paramet calcul aux_ctlcontol __init__ timestep undersampl chang ad output clip plotmanag exampl updat chang api experi model valid experi file experi environ manag testbench connect via ssh depend decreas languag level python api modelicaenv reward function paramet vis_col also support plot templat emptyhistori descend updat append agent ad properti staticcontrolag descend small chang constructor param specif obs_templ ad properti safeoptag ad properti runner plot disabl exampl ad exampl plot perform speedup depend increas languag level python best paramet set output termin safeopt agent _ proper action observ space _ resolv problem relat environ codemodel_param _ document improv exampl instal _ httpsgithubcomupbleaopenmodelicamicrogridgymissu _ httpsgithubcomupbleaopenmodelicamicrogridgymissu _ httpsgithubcomupbleaopenmodelicamicrogridgymissu correct pip instal requir first releas pypi openmodelica microgrid gym build cov nbsp nbsp python pypi download nbsp nbsp licens doc whitepap joss nbsp unicod ua nobreak space build imag httpsgithubcomupbleaopenmodelicamicrogridgymactionsworkflowsbuild_and_testymlbadgesvg target httpsgithubcomupbleaopenmodelicamicrogridgymactionsworkflowsbuild_and_testyml cov imag httpscodecovioghupbleaopenmodelicamicrogridgymbranchmastergraphbadgesvg target httpscodecovioghupbleaopenmodelicamicrogridgym licens imag httpsimgshieldsiogithublicenseupbleaopenmodelicamicrogridgym target licens python imag httpsimgshieldsiopypipyversionsopenmodelicamicrogridgym target httpspypipythonorgpypiopenmodelica_microgrid_gym pypi imag httpsimgshieldsiopypivopenmodelica_microgrid_gym target httpspypipythonorgpypiopenmodelica_microgrid_gym download imag httpsimgshieldsiopypidwopenmodelicamicrogridgym target httpspypistatsorgpackagesopenmodelicamicrogridgym doc imag httpsimgshieldsiobadgedocsuccesssuccess target httpsupbleagithubioopenmodelicamicrogridgym whitepap imag httpsimgshieldsiobadgearxivwhitepaperinform target httpsarxivorgpdfpdf joss imag httpsjosstheojorgpapersjossstatussvg target httpsdoiorgjoss figur httpsgithubcomupbleaopenmodelicamicrogridgymrawdevelopdocspicturesomg_flowpng openmodelica microgrid gym omg packag softwar toolbox simul control optim microgrid base energi convers power electron convert main characterist toolbox plugandplay grid design simul openmodelica well readytogo approach intuit reinfroc learn rl approach python interfac omg toolbox built upon openai gym_ environ definit framework therefor toolbox specif design run reinforc learn algorithm train agent control power electron convert microgrid nevertheless also arbritari classic control approach combin test use omg interfac _openai gym httpsgymopenaicom free softwar gnu gener public licens v document httpsupbleagithubioopenmodelicamicrogridgym video tutori follow short youtub video introduct get fist impress use omg httpswwwyoutubecomwatchvrwbnfvci_di instal instal python environ short instal guid window linux openmodelica_ hardli support mac suggest instal linux vm reason run omg linux vm strongli recommend mac user sinc possibl instal pyfmi_ packag necessari commun python interfac environ via pip recommend instal packag advanc conda environ window linux support offici conda instal pc instal miniconda_ python creat new conda environ eg pycharm instal pyfmi condaforg channel termin conda instal c condaforg pyfmi instal openmodelica microgridgym pypi recommend pip instal openmodelica_microgrid_gym _openmodelica httpsopenmodelicaorgdownloaddownloadmac _miniconda httpscondaioenlatestminicondahtml _pyfmi httpsgithubcommodeloncommunitypyfmi instal openmodelica omg creat use omedit_ v case instal issu resort prebuilt virtual machine_ _omedit httpsopenmodelicaorgdownloaddownloadwindow _virtual machin httpsopenmodelicaorgdownloadvirtualmachin get start environ initi run like openai gym codeblock python import gym __name__ __main__ env gymmakeopenmodelica_microgrid_gymmodelicaenvv max_episode_stepsnon netnetnetyaml model_pathomg_gridgridnetworkfmu envreset _ rang envrend envstepenvaction_spacesampl take random action envclos omg use fmi standard_ exchang model openmodelica python _fmi standard httpsfmistandardorg exampl network consist two invert three filter induct load figur httpsgithubcomupbleaopenmodelicamicrogridgymrawmasterdocspicturesomeditjpg either use one provid fmu window linux bit includ gridnetworkfmu creat run openmodelica_microgrid_gymfmu omc create_fmumo window user might need open termin openmodelica click tool openmodelica command prompt make sure command omc get recogn run staticctrlpi start simul manual tune cascad pipi control figur httpsgithubcomupbleaopenmodelicamicrogridgymrawmasterdocspicturescontroljpg scale align center save bayesian approach reinforc learn agent provid examplesberkamkamppi figur httpsgithubcomupbleaopenmodelicamicrogridgymrawmasterdocspictureskp_kp_jpng figwidth align center use pytest omg provid big rang test ensur correct work toolbox chang done window machin test start termin via pytest standard test os develop linux case notic test_modelicapi window pc might throw error sinc linux everyth work fine seem numer issu connect fmu citat white paper pleas find white paper omg toolbox includ exemplari usag scenario httpsarxivorgab pleas use follow bibtex entri cite us articleomgcod titl omg scalabl flexibl simul test environ toolbox intellig microgrid control author stefan heid daniel weber henrik bode eyk hüllermeier oliv wallscheid year doi joss url httpsdoiorgjoss publish open journal volum number page journal journal open sourc softwar articleomgwhitepap titletoward scalabl flexibl simul test environ toolbox intellig microgrid control authorhenrik bode stefan heid daniel weber eyk hüllermeier oliv wallscheid year eprinthttparxivorgab archiveprefixarxiv primaryclasseesssi contribut pleas refer contribut guide_ _contribut guid httpsgithubcomupbleaopenmodelicamicrogridgymblobmastercontributingrst credit packag creat cookiecutter_ audreyrcookiecutterpypackage_ project templat _cookiecutt httpsgithubcomaudreyrcookiecutt _audreyrcookiecutterpypackag httpsgithubcomaudreyrcookiecutterpypackag welcom openmodelica microgrid gym toolbox document openmodelica microgrid gym omg packag softwar toolbox simul power electronicsdriven microgrid train test reinforc learn agent compar classic control approach content exampl section avail use case present default configur quick start one select use box document base class import develop modul like reward function refer gener part basic interfac modul specifi creation addit grid constel openmodelica nightli build recommend use toctre maxdepth titlesonli caption user guid partsuser_guidegetting_start partsuser_guideopenmodelica partsuser_guidefmu partsuser_guidepythoncod partsuser_guideexampl partsuser_guidecontroller_tun toctre maxdepth titlesonli caption api apiomgag apiomgaux_ctl apiomgenv apiomgexecut apiomgnet apiomgutil gener apidoc sphinxapidoc docsapi openmodelica_microgrid_gym e delet modulerst remov packag modul name execut regex packag execut regex modul indic tabl refgenindex refmodindex refsearch exampl toctre maxdepth titlesonli hidden examplescreating_env examplesbasic_ag examplesplot examplessingle_inverter_current_control_safe_opt examplestwo_inverter_static_droop_control basic exampl get idea toolbox work setup environ agent use plot three basic exampl shown use network present first invert use creat environment_ write simpl agent_ modifi plotting_ _creat environ examplescreating_env _write simpl agent examplesbasic_ag _modifi plot examplesplot advanc exampl singl invert current control_ two invert static droop control_ _singl invert current control examplessingle_inverter_current_control_safe_opt _two invert static droop control examplestwo_inverter_static_droop_control toolbox instal gener remark follow instal hint introduct python code written omg toolbox present instal requir short instal guid window linux openmodelica httpsopenmodelicaorgdownloaddownloadmac__ hardli support mac suggest instal linux vm reason run omg linux vm httpsopenmodelicaorgdownloadvirtualmachine__ strongli recommend mac user recommend instal omg via pip pip instal openmodelica_microgrid_gym altern clone github repositori list requir provid homedirectori literalinclud requirementstxt hint run window pyfmi might throw error instal via pip instal via conda run conda instal c condaforg pyfmi simul set heart program structur creation environ via gymmak main programm folder exampl nearli everi simul set done directli import one describ follow inform see apidocument apiomgenvmodelicahtml__ time_step step size simul second larg timestep may result numer issu small timestep result high simul time e seem good compromis mani real control oper timestep like reward_fun callabl reward function rlalgorithm minim valu reward exampl use lower bound safe bayseian algorithm see single_inverter_current_control_safe_optpi adjust problemspecif solver_method solver use ode system everi solver scipyintegratesolve_ivp httpsdocsscipyorgdocscipyreferencegeneratedscipyintegratesolve_ivphtml__ select though highli recommend use implicit one default solver lsoda integr stiff detect nonstiff system becom solv faster adam method stiff system bdf model_param paramet simul chang compar default valu openmodelica model also usabl loadstep replac switch openmodelicamd__ exampl increas resistor load second ohm ohm def ft return els model_paramsrlresistorr f rlresistorr f rlresistorr f function codef pass callabl function refer environ evalu function everi timestep pass timestep paramet function automat set v_dc dc suppli voltag v_dc set either directli openmodelica model openmodelicahtmlsettingofvdc__ via python default valu v chang environ creation line model_paramsinverterv_dc inverterv_dc set everi three phase invert take care set param everi invert default suppli voltag v data log enabl log root logger need initi main function call import numpi np loggingbasicconfig __name__ __main__ ctrl dict inform log level see log standard librari httpsdocspythonorglibrarylogginghtml__ control tune hint current control primari invert droop word constant main frequenc appli short circuit invert tune kp ki current control tune kp ki final kp cant tune time tri tune max current peak current limit maximum allow nomin oper ensur tune allow current exceed peak current limit real world scenario invert shutoff explod voltag control primari invert droop open circuit load invert tune kp ki voltag control tune kp ki final kp cant tune time pll secondari invert primari invert provid constant frequenc start tune kp ki pll nois frequenc output pll accept long output phasor pll accur match incom voltag signal secondari invert power electron disconnectedopencircuit possibl inject step chang frequenc setpoint primari invert watch accur pll track extern voltag refer continu tune necessari current control secondari invert pll secondari invert lock primari invert tune kp ki current control droop stage might need creat step chang setpoint test accur track tri tune max current peak current limit maximum allow nomin oper droop primari invert isnt realli tune step paramet wont affect system droop secondari invert firstli filter frequenc voltag feedback droop control set tune droop tune droop control secondari invert frequenc filter frequenc feedback pll affect droop paramet thu consid tune get start figur picturesomg_flowpng alt user guid cover openmodelica microgrid gym omg toolbox featur topic area follow step introduc detail way differ chapter user guid first step creat microgrid openmodelicahtml__ environ train reinforc learn agent power electronicdriven microgrid addit omg toolbox use pure simul classic control purpos use openmodelica model python interfac microgrid model built open sourc softwar openmodelica httpswwwopenmodelicaorg__ easili adapt figur picturesnetworkpng alt transfer python need get export function mockup unit fmu httpsfmistandardorg__ creation process fmu shown fmuhtml__ use build gym environ like exampl openai gym httpsgymopenaicom__ omg gym environ defin exampl examplestwo_inverter_static_droop_controlpi creat environ network simul python one hand possibl test predefin static control design like describ exampleshtmltwoinverterstaticdroopcontrolpy__ figur picturesabcpng alt howev main function toolbox appli reinforc learn approach util omg interfac optim microgrid control shown exampl exampleshtmlsingleinvertercurrentcontrolsafeoptpy__ figur pictureskp_kp_jpng alt basic exampl get idea toolbox work setup environ agent two basic exampl shown use network present first invert use creat environ follow minim exampl setup run environ necessari definit model input case three phase first invert model output shown simul result model path rel locat fmu file contain network simul paramet exampl stepsiz default valu use initialis environ need reset envrend defin output plot simul perform step differ random number provid everi three previous defin model_input afterward inductor current lcfilter lcshown figur plot result three increas due random function noisi line literalinclud examplesbasic_envpi lineno creat agent runner addit environ agent creat runner use runner class take care initi termin agent environ well execut multipl episod class handl inform exchang agent environ like present high level code architectur shown figur pictureshighlevelpng width alt sinc input use agent environ defin advanc although agent get inform environ small exampl action still random number environ afterward agent runner get defin runner run one episod literalinclud examplessimple_agentpi lineno function mockup unit fmu fmi fmu function mockup interfac fmi httpsfmistandardorg__ free standard defin contain interfac exchang dynam model use combin xml file binari c code zip singl file gener file exchang call function mockup unit fmu binari platformspecif linux user cant run fmu creat window machin two version fmi standard omg toolbox use fmi furthermor two simul type cosimul cs model exchang cosimul includ solver fmu model exchang provid possibl use solver python due lack implicit solver cs omg toolbox use creat fmu best way creat fmu omg toolbox run create_fmumo file folder omg_grid termin make sure openmodelica httpsopenmodelicaorgdownloaddownloadwindows__ instal latest version openmodelica packag folder script run create_fmumo command omc creat fmu model network grid folder pathomg_grid omc create_fmumo window user might need open termin openmodelica click tool openmodelica command prompt make sure command omc get recogn creat fmu model gener chang omg_gridgridsnetwork last line create_fmumo omg_gridgridsyournetworksnam openmodelicascriptingloadfilepackagemo geterrorstr setcommandlineoptionsdnewinst geterrorstr setcommandlineoptionsdiniti geterrorstr setcommandlineoptionssimcodetargetcpp geterrorstr setcommandlineoptionsddisabledirectionalderiv geterrorstr openmodelicascriptingtranslatemodelfmuomg_gridgridsnetwork version fmutyp geterrorstr line set flag fmucreat targetlanguag c instead default c miss implement direct deriv c necessari solver python possibl creat fmu directli openmodelica file export fmu set done tool option simul target languag translat flag tool option fmu version type name path way recommend possibl miss flag like initi furthermor problem provid direct deriv occur test merg fmu mention fmu work oper system creat though possibl combin previous gener fmu allow usag differ platform first gener fmu differ platform model run python file merge_fmuspi select fmu combin choos target file need exist script check sever point fmu gener version librari care small chang like paramet variat might detect fmu contain binari differ platform annot window sometim script throw error tempfold script still work merg fmu result file need renam fmu end directli use openmodelica openmodelica httpsopenmodelicaorg__ opensourc modelicabas model simul environ intend industri academ usag instal openmodelica model shown creat use omedit httpsopenmodelicaorgdownloaddownloadwindows__ v use linux os sometim may lead problem tri instal openmodelica case tri download prebuilt virtual machin httpsopenmodelicaorgdownloadvirtualmachine__ mac user strongli encourag run openmodelica well omg toolbox linux vm creat microgrid openmodelica microgrid creat user defin librari start run file gridmo directli folder omg_grid packag contain compon requir creat power electron driven microgrid well exampl network figur pictureslibraryjpg alt contain sever folder predefin compon filter load etc well microgrid fmu export python standalon exampl run directli openmodelica figur picturesomeditjpg alt main compon microgrid threephas invert consist three input voltag control cascad pipi control python default nomenclatur input ip nverter p hase etc chang python code model_inputon two envgymmak call import use filtersload inductor capacitor leav checkbox initi provid set chang like result error creat fmu run python file provid exampl design two invert underli model easili extend order investig complex microgrid topolog extend exampl showcas also plane futur releas power loss default exampl network power loss invert filter includ latter ad use part filterlossesfilt packag instead filteridealfilt packag due big increas compon equat odesystem simul time increas model loss insid power electron convert ad model python interfac script recommend integr eg switch loss directli openmodelia model requir reduc simul step size significantli larger simul demand power loss model recommend creat user defin filter resistor need calcul modifi creat new packag ctrln special packag duplic part modifi new packag rightclick duplic select previous creat packag path modifi switch transistor model switchinglik event insid model eg trigger loadstep ad remov load desir difficult implement possibl openmodelica switch openmodelica like mani free model languag design resistor close switch low resist open switch high one remov load still connect grid connect resistor dimens caus numer issu simul ode system becom stiff solver avail stiff equat system like bdf radau one automat stiff detect use switch often run nonconverg system execut error work altern parametervari load possibl chang paramet load simul appli loadstep way see topic python code pythoncodehtml__ set v_dc dc suppli voltag v_dc set either directli openmodelica model via python pythoncodehtmlsettingofvdc__ om model doubleclick network invert chang paramet v_ dc demand valu three phase invert suppli dc voltag default valu v default valu chang rightclick invert open class select text view top left corner model canva chang number follow code line demand default valu paramet real v_dc phaselock loop pll pll block work simul openmodelica structur reason pll calcul python creat environ follow minim exampl setup run environ necessari definit model input case three phase first invert model output shown simul result model path rel locat fmu file contain network simul paramet exampl stepsiz default valu use initialis environ need reset envrend defin output plot simul perform step differ random number provid everi three previous defin model_input afterward inductor current lcfilter lcshown figur plot result three increas due random function noisi line literalinclud examplesbasic_envpi linenossingl invert current control exampl three phase invert suppli load rl via filter lc like shown figur model fmu built creat environ figur picturesmodelpng optim method develop berkenkamp et al_ call safe control optim safeopt use take gaussian process bayesian optim safe determin optim control paramet goal standard pi current control suppli exemplari dcurrent load _berkenkamp et al httpsarxivorgab gener fmu fmuhtml__ use environ build gym env like exampl openai gym httpsgymopenaicom gym enviro defin examplessingle_inverter_current_control_safe_optpi gener gym environ use reward function plot inductor valu current lcfilter control like shown figur simul timestep delta_t fmu gridnetwork_singleinverterfmu gener model plot use setpoint invert modul indic ip input inductor current capacitor voltag lcfilter output figur picturesi_abc_bk_kp_kipng agent use simpl rlexampl taken class codesafeoptag contain control codemultiphasedqcurrentsourcingcontrol consist multiphas pi control control current across inductor lcfilter also droop control implement calcul eg frequenc drop due load chang agent task find better paramet current control kp ki therefor defin mutable_param eg examplessingle_inverter_current_control_safe_optpi adopt episod safeopt algorithm use gaussian process estim perform control thu bound lengthscal cf examplessingle_inverter_current_control_safe_optpi gain paramet kp ki defin one adjust one paramet kp ki case case use algorithm therefor follow flag paramet adjust accoridngli adjust kp set codeadjust kp adjust ki set codeadjust kp adjust kp ki set codeadjust kpi due safeopt agent need safe start point kp ki tri calcul safe paramet better perform perform calcul use reward function environ meanrooterror rme measur current setpoint calcul addit barrier function use penal overcurr barrier function adjust use paramet mu safe threshold agent set safe_thresholdtim initi perform cf agentssafeoptpi exampl safe_threshold initi reward safe threshold would end script coderunn use execut episod use agent control environ everi episod control current perform function function kp andor ki plot exemplari result shown codeadjust kp agent tri find optim valu proport gain kp control rang lengthscal figur xaxi valu kp yaxi perform valu calcul use reward function mention figur pictureskp_jpng codeadjust ki agent tri find optim valu integr gain ki control rang lengthscal figur xaxi valu ki yaxi perform valu calcul use reward function mention figur pictureski_jpng due algorithm unsaf point right kp well ki due overcurr due bad perform due perman control error result current kp ki unsaf point right figur shown pictur due high error compar refer valu dcurrent perform bad algorithm defin unsaf comparison perform reach use initi control paramet figur picturesi_abc_ki_j_badpng codeadjust kpi agent tri find optim valu proport gain kp well integr gain ki control rang lengthscal kp rang lengthscal ki figur xaxi valu kp yaxi valu ki zaxi perform valu calcul use reward function figur pictureskp_ki_jpng result algorithm print consol form like iter perform j param kp ki j param best perform short exampl produc paramet set kp ki creat agent runner addit environ agent creat runner use runner class take care initi termin agent environ well execut multipl episod class handl inform exchang agent environ like present high level code architectur shown figur pictureshighlevelpng width alt sinc input use agent environ defin advanc although agent get inform environ small exampl action still random number environ afterward agent runner get defin runner run one episod literalinclud examplessimple_agentpi linenostwo invert static droop control exampl fmu gener openmodelica gym environ contain two invert connect via filter suppli parallel rc load use shown figur exampl use control defin auxiliari one invert set voltag form invert direct droop control eg frequenc drop due appli power control use current sourc invert invers droop control react frequenc voltag chang due droop control paramet powerreact power chang default set plot abc signal well dq signal master slave provid default follow small network simul figur picturesnetworkpng short introduct experiment control tune hint found controller_tuninghtml__ control work fine three phase voltag similar follow one one plot figur picturesabcpng demand signal provid fmu save simul plot ad viz_colsmdq slavefreq lcl gymmak command make sure demand signal fmu list model_output model_output lc inductori inductori inductori capacitorv capacitorv capacitorv rl finductorii rang lcl inductori inductori inductori capacitorv capacitorv capacitorv hint everi possibl variabl provid fmu seen easiest openmodelica run simul without input signal everi result voltag current bottom right side select compon model tree structur click compon reach variabl show whole variabl name exampl lclinductori top plot window paramet control like control frequenc delta_t voltag frequenc droop characterist set directli main functioncr plot environ variabl exampl shown environ variabl plot plot adjust environ get object class plottmpl chosen environ variabl visual style linestyl color group detect comparison environ variabl plot ajdust label save figur done via callabl like shown exampl literalinclud examplesplottingpi linenosomgutilfastqueu automodul openmodelica_microgrid_gymutilfastqueu member undocmemb showinherit omgenvpyfmi automodul openmodelica_microgrid_gymenvpyfmi member undocmemb showinherit omgagentsstaticctrl automodul openmodelica_microgrid_gymagentsstaticctrl member undocmemb showinherit omgaux_ctlinverter_control automodul openmodelica_microgrid_gymaux_ctlinverter_control member undocmemb showinherit omgaux_ctlbas automodul openmodelica_microgrid_gymaux_ctlbas member undocmemb showinherit omgaux_ctlfilt automodul openmodelica_microgrid_gymaux_ctlfilt member undocmemb showinherit omgag submodul toctre omgagentsag omgagentsepisod omgagentssafeopt omgagentsstaticctrl omgagentsutil modul content automodul openmodelica_microgrid_gymag member undocmemb showinherit omgnet submodul toctre maxdepth omgnetbas omgnetcompon modul content automodul openmodelica_microgrid_gymnet member undocmemb showinherit omgaux_ctldroop_control automodul openmodelica_microgrid_gymaux_ctldroop_control member undocmemb showinherit omgenvmodelica automodul openmodelica_microgrid_gymenvmodelica member undocmemb showinherit omgaux_ctlpi_control automodul openmodelica_microgrid_gymaux_ctlpi_control member undocmemb showinherit omgaux_ctl submodul toctre omgaux_ctlbas omgaux_ctlfilt omgaux_ctlparam omgaux_ctlobserv omgaux_ctldroop_control omgaux_ctlpi_control omgaux_ctlinverter_control modul content automodul openmodelica_microgrid_gymaux_ctl member undocmemb showinherit omgaux_ctlparam automodul openmodelica_microgrid_gymaux_ctlparam member undocmemb showinherit omgexecut submodul toctre omgexecutionrunn omgexecutioncallback modul content automodul openmodelica_microgrid_gymexecut member undocmemb showinherit omgenv submodul toctre omgenvmodelica omgenvpyfmi omgenvplot omgenvplotmanag modul content automodul openmodelica_microgrid_gymenv member undocmemb showinherit omgagentsutil automodul openmodelica_microgrid_gymagentsutil member specialmemb excludememb __dict____module____repr____weakref__ undocmemb showinherit omgutilrandproc automodul openmodelica_microgrid_gymutilrandproc member undocmemb showinherit omgexecutioncallback automodul openmodelica_microgrid_gymexecutioncallback member undocmemb showinherit omgagentsag automodul openmodelica_microgrid_gymagentsag member undocmemb showinherit omgutilrecord automodul openmodelica_microgrid_gymutilrecord member undocmemb showinherit omgagentsepisod automodul openmodelica_microgrid_gymagentsepisod member undocmemb showinherit omgutiltransform automodul openmodelica_microgrid_gymutiltransform member undocmemb showinherit omgnetbas automodul openmodelica_microgrid_gymnetbas member undocmemb showinherit omgutilitertools_ automodul openmodelica_microgrid_gymutilitertools_ member undocmemb showinherit omgexecutionrunn automodul openmodelica_microgrid_gymexecutionrunn member undocmemb showinherit omgnetcompon automodul openmodelica_microgrid_gymnetcompon member undocmemb showinherit omgagentssafeopt automodul openmodelica_microgrid_gymagentssafeopt member undocmemb showinherit omgutil submodul toctre omgutilfastqueu omgutilitertools_ omgutiltransform omgutilrandproc omgutilrecord modul content automodul openmodelica_microgrid_gymutil member undocmemb showinherit omgenvplotmanag automodul openmodelica_microgrid_gymenvplotmanag member undocmemb showinherit omgaux_ctlobserv automodul openmodelica_microgrid_gymaux_ctlobserv member undocmemb showinherit omgenvplot automodul openmodelica_microgrid_gymenvplot member undocmemb showinherit