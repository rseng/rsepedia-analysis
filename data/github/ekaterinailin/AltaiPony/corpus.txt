fill inform open issu need creat improv provid clear concis descript issu provid exampl provid link minim code snippet demonstr issu python import lightkurv option insert code goal expect behaviour describ behavior expect differ behavior observ exampl minimum viabl product first releas includ queri via lightkurv light curv detrend lightkurv ksc flare search flare character injectionrecoveri diagnost statist analysi tool fix lightcurv version altaipony__version__ return version number avail compat lightcurv doc subpag ad detrend experiment detrend function provid fix link readm joss version cibadg docsbadg licensebadg requirementsbadg jossbadg zenodobadg jossbadg imag httpsjosstheojorgpapersjossstatussvg target httpsdoiorgjoss zenodobadg imag httpszenodoorgbadgedoizenodosvg target httpsdoiorgzenodo cibadg imag httpstravisciorgekaterinailinaltaiponysvgbranchmast target httpstravisciorgekaterinailinaltaiponi docsbadg imag httpsreadthedocsorgprojectsaltaiponybadgeversionlatest target httpsaltaiponyreadthedocsioenlatestbadgelatest alt document statu licensebadg imag httpsimgshieldsiogithublicensemashapeapistatussvg target httpsgithubcomekaterinailinaltaiponyblobmasterlicens alt github requirementsbadg imag httpsrequiresiogithubekaterinailinaltaiponyrequirementssvgbranchmast target httpsrequiresiogithubekaterinailinaltaiponyrequirementsbranchmast alt requir statu imag logopng height px width px alt logo credit elizaveta ilin altaiponi detrend light curv kepler k tess mission search flare inject recov synthet flare account detrend nois loss flare energi determin energydepend recoveri probabl everi flare candid use ksc lightkurv cover well panda numpi pytest astropi find document altaiponyreadthedocsio_ instal use pip instal altaiponi pip instal altaiponi instal directli repositori git clone httpsgithubcomekaterinailinaltaiponygit cd altaiponi python setuppi instal get start see notebook_ easi introduct also docs_ problem often someth work altaiponi document useless troubleshoot done dive extens lightkurv docs_ otherwis alway shoot ekaterina email_ directli open issu github_ mani forese problem due bug altaiponi bad instruct websit contribut altaiponi altaiponi activ develop github_ use altaiponi research find miss function recommend open issu github_ shoot ekaterina email_ pleas either two open pull request may save lot develop time cite work end use packag scienc pleas cite ilin et al a_ davenport b_ pleas also cite lightkurv indic doc _ depend method use may also want cite maschberg kroupa _ mmle power law fit wheatland _ mcmc power law fit aigrain et al _ softwar _ ksc detrend ekaterina ilin sarah j schmidt katja poppenhäg jame r davenport martti h kristiansen mark omohundro flare open cluster k ii pleiad hyad praesep ruprecht astronomi astrophys volum ida pp httpsdoiorg b jame r davenport kepler catalog stellar flare astrophys journal volum issu articl id pp httpsdoiorgx httpsdocslightkurveorgaboutcitinghtml thoma maschberg pavel kroupa estim expon upper limit goodnessoffit test truncat powerlaw distribut monthli notic royal astronom societi volum issu may page httpsdoiorgjx wheatland michael bayesian approach solar flare predict astrophys journal httpsdoiorg aigrain suzann parviainen hannu pope benjamin ksc flexibl systemat correct detrend k light curv use gaussian process regress monthli notic royal astronom societi volum issu p httpsdoiorgmnrasstw aigrain suzann parviainen hannu pope benjamin ksc k systemat correct astrophys sourc code librari record ascl httpsuiadsabsharvardeduabsasclsoftaabstract _appaloosa httpsgithubcomjradavenportappaloosa _altaiponyreadthedocsio httpsaltaiponyreadthedocsioenlatest _notebook httpsgithubcomekaterinailinaltaiponyblobmasternotebooksgetting_startedipynb _doc httpsaltaiponyreadthedocsioenlatest _github httpsgithubcomekaterinailinaltaiponyissuesnew _email eilinaipd frequent ask question detect flare flare flare kepler tess light curv seri data point fullfil flare definit criteria altaiponi flare posit excurs detrend light curv certain nois threshold play around number paramet detail explain section defin flare candidates_ default set flare detect default set flare detect explain section defin flare candidates_ altaiponi handl ramp up end tess orbit altaiponi current explicitli handl ramp up caus fals posit detect use pdcsap_flux instead sap_flux flux avoid problem part howev algorithm deal pass custom detrend function flarelightcurvedetrendcustom funcyour custom function func take flarelightcurv argument arbitrari number keyword argument also return flarelightcurv defin start stop time flare start stop time flare candid mark first last timestamp fullfil flare definit criteria accordingli start stop cadenc indic use mask flare exampl import numpi np take tabl flare candid flarelightcurv flc find indic flareindic listnparangerowistart rowistop row flcflaresiterrow flatten list l sublist l sublist mask flare flcdetrended_fluxl npnan _defin flare candid httpsaltaiponyreadthedocsioenlatesttutorialsaltaihtmldefiningflarecandid altaiponi document master file creat sphinxquickstart wed sep adapt file complet like least contain root toctre direct flare scienc kepler k tess light curv altaiponi toolbox statist flare studi photometr time seri kepler k tess includ flare search character injectionrecoveri diagnost statist analysi flare frequenc distribut along extens document tutori jump get started_ get overview k light curv best detrend use ksc _ tess kepler employ savitzkygolay filter use method lightkurve_ keplerlightcurv tesslightcurv class altaiponi use inject recov synthet flare signatur jump core class here_ altaiponi featur flare candid definit appaloosa b_ _userdoc toctre caption altaiponi maxdepth instal tutorialsindex apiindex faq problem often someth work altaiponi document useless troubleshoot done dive extens lightkurv docs_ otherwis alway shoot ekaterina email_ directli open issu github_ mani forese problem due bug altaiponi bad instruct websit contribut altaiponi altaiponi activ develop github_ use altaiponi research find miss function recommend open issu github_ shoot ekaterina email_ pleas either two open pull request may save lot develop time cite work end use packag scienc pleas cite ilin et al a_ davenport b_ pleas also cite lightkurv indic doc _ depend method use may also want cite maschberg kroupa _ mmle power law fit wheatland _ mcmc power law fit aigrain et al _ softwar _ ksc detrend ekaterina ilin sarah j schmidt katja poppenhäg jame r davenport martti h kristiansen mark omohundro flare open cluster k ii pleiad hyad praesep ruprecht astronomi astrophys volum ida pp httpsdoiorg b jame r davenport kepler catalog stellar flare astrophys journal volum issu articl id pp httpsdoiorgx httpsdocslightkurveorgaboutcitinghtml thoma maschberg pavel kroupa estim expon upper limit goodnessoffit test truncat powerlaw distribut monthli notic royal astronom societi volum issu may page httpsdoiorgjx wheatland michael bayesian approach solar flare predict astrophys journal httpsdoiorg aigrain suzann parviainen hannu pope benjamin ksc flexibl systemat correct detrend k light curv use gaussian process regress monthli notic royal astronom societi volum issu p httpsdoiorgmnrasstw aigrain suzann parviainen hannu pope benjamin ksc k systemat correct astrophys sourc code librari record ascl httpsuiadsabsharvardeduabsasclsoftaabstract _ksc httpsgithubcomoxesksc _appaloosa httpsgithubcomjradavenportappaloosa _lightkurv httpsgithubcomkeplergolightkurv _doc httpdocslightkurveorgindexhtml _email eilinaipd _github httpsgithubcomekaterinailinaltaiponi _here httpsaltaiponyreadthedocsioenlatestapialtaiponyflarelcflarelightcurvehtml _quickstart httpsaltaiponyreadthedocsioenlatestinstallhtml _get start httpsaltaiponyreadthedocsioenlatestinstallhtmlgettingstart quickstart instal use pip instal altaiponi pip instal altaiponi instal directli repositori git clone httpsgithubcomekaterinailinaltaiponygit cd altaiponi python setuppi instal packag depend lightkurv ksc numpi panda packag instal automat look requirementstxt repositori see extens list get start work kepler tess light curv similar k light curv need extra attent treat separ mission notebook guid basic applic recommend take look find data_ tutori kepler light curv work keplerlightcurv object ie light curv origin kepler mission tri this_ notebook show fetch light curv mast detrend savitzkygolay_ filter scipy_ find flare tess light curv work tesslightcurv object ie light curv tess mission may want tri other_ notebook instead one also test inject recoveri featur altaiponi obtain recoveri probabl correct equival durat ed aka luminos independ flare energi k light curv work keplerlightcurv object ie light curv k mission last notebook_ run ksc gp detrend find flare typic k long cadenc light curv despit heavi instrument artifact next step defin flare find tri basic altaiponi light curv start adjust flare find paramet applic explain find flares_ tutori test perform flare find algorithm may want test perfom chosen flare find setup inject recov synthet flare light curv altaiponi provid framework explain synthet flare inject recovery_ tutori check visualization_ notebook nice plot analyz flare frequenc distribut statist analysi flare altaiponi also featur set tool analysi flare frequenc distribut includ visual differ method power law fit starter check tutori flare frequenc distribut power laws_ want go hand start beginner_ notebook advanc applic like work sampl multipl star flare go advanced_ notebook _aigrain et al httpasclnet _fork httpsgithubcomekaterinailinksc _notebook httpsgithubcomekaterinailinaltaiponyblobmasternotebooks_getting_startedipynb _thi httpsgithubcomekaterinailinaltaiponyblobmasternotebooks_kepler_light_curves_with_flaresipynb _savitzkygolay httpwwwstatisticsuinfofundstat_engcc_filter_savgolayhtml _scipi httpsdocsscipyorgdocscipyreferencegeneratedscipysignalsavgol_filterhtml _other httpsgithubcomekaterinailinaltaiponyblobmasternotebooks_tess_light_curves_with_flaresipynb _in tutori httpsaltaiponyreadthedocsioenlatesttutorialsaltaihtml _find flare httpsaltaiponyreadthedocsioenlatesttutorialsaltaihtml _find data httpsaltaiponyreadthedocsioenlatesttutorialslciohtml _synthet flare inject recoveri httpsaltaiponyreadthedocsioenlatesttutorialsfakeflareshtml _visual httpsgithubcomekaterinailinaltaiponyblobmasternotebooks_visualize_injection_recoveryipynb _beginn httpsgithubcomekaterinailinaltaiponyblobmasternotebooks_beginner_flare_frequency_distributions_and_power_lawsipynb _advanc httpsgithubcomekaterinailinaltaiponyblobmasternotebooks_advanced_flare_frequency_distributions_and_power_lawsipynb _flare frequenc distribut power law httpsaltaiponyreadthedocsioenlatesttutorialsffdshtml find data sever way creat flarelightcurv altaiponi quickstart need target tic epic kic campaign quarter sector local tess kepler k light curv read from_path also queri mast fom_mast read light curv directli convert target pixel file latter requir want use ksc detrend familiar lightkurve_ advantag case fetch tess light curv mast altaiponylcio import from_mast flc from_mastt modelc missiontess c call flcplot show imag ticplotpng width alt tess flare light curv k target pixel file convert flarelightcurv use extra argument like flux_typ cadenc aperture_mask flc from_mastep modetpf missionk c flux_typepdcsap_flux cadencelong aperture_maskdefault flcplot imag epicplotpng width alt k flare light curv also fetch remot file detrend store altaiponi light curv read back like flc from_mastt modelc missiontess c dflc flcdetrendsavgol dflcto_fitsponylcfit altaiponylcio import from_path rflc from_pathponylcfit modealtaiponi missiontess modul altaiponylcio automodapi altaiponylcio nohead noinheritedmemb noinheritancediagram _lightkurv httpsgithubcomkeplergolightkurv synthet flare inject recoveri character well detrend flare find procedur actual find character flare light curv inject synthet flare run procedur compar recov event inject one altaiponi shape flare gener use empric flare model davenport et al _ run seri inject call sample_flare_recoveri method flarelightcurv altaiponylcio import from_mast flc from_mastt modelc c missiontess flc flcdetrendsavgol flc fake_flc flcsample_flare_recoveryinject_before_detrendingtru modesavgol iter fakefreq ampl dur flc origin light curv new attribut fake_flar dataframe_ includ follow column amplitud synthet flare rel amplitud duration_d synthet flare durat day _ ed_inj inject equival durat second peak_tim time synthet flare flux peak column appear flare attribut flarelightcurv see here_ respect row valu synthet flare recov result otherwis altaiponi could rediscov flare fake_flc like origin one without fake_flar attribut instead flux contain synthet flare last iter run sample_flare_recoveri return often use see one actual inject import matplotlibpyplot plt fig ax pltsubplotsfigs fakeflcplotaxax cr labelt inject flare flcplotaxax ck imag ticplotinjectedpng width alt tess flare light curv inject flare visual result let pick gj famou flare star inject recov flare look result follow step inject synthet flare setup produc minimum number flare per light curv chunk per iter tess light curv gj split two uniterrupt segment therefor run iter get faster result increas fakefreq altaiponylcio import from_mast flc from_mastgj modelc c missiontess flc flcdetrendsavgol flc fake_flc flcsample_flare_recoveryinject_before_detrendingtru modesavgol iter fakefreq ampl dur look fraction inject equival durat flare differ recov amplitud durat recov fig flcplot_ed_ratio_heatmapflares_per_bin plttitlegj imag edratiopng width alt ed ratio recov flare gj similarli illustr fraction flare differ inject amplitud fullwidthathalfmaximum valu matht_ davenport et al _ recov fig flcplot_recovery_probability_heatmapflares_per_bin plttitlegj imag recprobpng width alt recoveri probabl synthet flare gj flare character synthet flare use character flare candid origin light curv call characterize_flar method flarelightcurv flc flccharacterize_flaresampl_bin dur_bin method tile sampl fake flare amplitud durat bin twice first tile sampl matrix base recov amplitud durat second inject properti includ also inject flare recov first matrix use map flare candid recov equival durat valu account loss dealt ed photometr nois introduc detrend procedur chose inject_before_detrendingtru typic inject amplitud durat flare tile matrix use second matrix deriv candid recoveri probabl ratio lost recov inject flare result map store flare attribut contain follow addit column tabl dur tstop tstart ed_ratio ratio recov ed inject ed synthet flare matrix tile contain flare measur properti similar candid flare ed_ratio_count number synthet flare tile ed_ratio_std standard deviat ed ratio tile ed_corr rec_err ed_ratio ed_corr_err quadrat propag uncertainti includ ed_rec_err ed_ratio_std ed_ratio amplitud amplitude_ratio amplitude_ratio_count amplitude_ratio_std amplitude_corr amplitude_corr_err uncertainti propag amplitude_ratio_std amplitude_ratio durat day duration_ratio duration_ratio_count duration_ratio_std duration_corr duration_corr_err column recoveri probabl recovery_prob float recovery_probability_count recovery_probability_std properti alway refer amplitud durat fwhm subset paramet flcflare could look like imag characterizedpng width alt character flare rubric footnot moment meaning quantiti decay flare goe infitini may defin full width flux someth approxim later get distract need map inject recov flare hang around tabl _datafram httpspandaspydataorgpandasdocsstablereferenceapipandasdataframehtml _here httpsaltaiponyreadthedocsioenlatestapialtaiponyflarelcflarelightcurvehtmlaltaiponyflarelcflarelightcurv _davenport et al httpsuiadsabsharvardeduabsapjdabstract flare frequenc distribut power law tri everyth section tutori notebook github repositori found flare comput statist measur use flare tabl ffd modul allow comput flare frequenc distribut use convert flare tabl cumul flare frequenc distribut fit power law expon mathalpha intercept mathbeta plot result function cumul form test power law assumpt must reject test distribut truncat high energi end appli statist correct flare properti use ed_corr recovery_prob attribut flare flare tabl may obtain perform inject recoveri synthet flare flarelightcurvecharacterize_flar final flare tabl contain contribut multipl star think gener flare describ power law differ detect threshold use multiple_star keyword account first order approxim note result sampl less flare interpret caution simpl flare sampl simplest case one star observ certain time high cadenc low nois result light curv obtain tabl flare candid instanc use flarelightcurvefind_flar directli use flarelightcurveflar tabl pandasdatafram recov flare energi column name ed_rec assum flarelightcurv call flc requir attribut flcflare creat ffd object altaiponyffd import ffd simple_ffd ffdfflcflare simple_ffdf contain tabl energi flare also specifi observ time took detect event list tabl simple_ffdtot_obs_tim unit know one use specifi tot_obs_tim ffd frequenc instead number count ie simple_ffdtot_obs_tim convert flare tabl cumul flare frequenc distribut first method appli anyth els ffded_and_freq give sort array energi correspond frequenc number count event certain energi cumul flare frequenc distribut import matplotlibpyplot plt ed freq count simple_ffded_and_freq pltfigurefigs pltscatter freq ck pltxscalelog pltyscalelog pltxlabel pltylabelcumul number flare per time imag ffdjpg width alt simpl ffd fit power law ffd next let fit power law distribut use modifi maximum likelihood estim mmle approach detail maschberg kroupa _ find slope mathalpha simpl least squar fit estim intercept mathbeta simple_ffdfit_powerlawmml result access simple_ffdalpha simple_ffdalpha_err simple_ffdbeta simple_ffdbeta_err respect uncertainti mathbeta bootstrap altern bayesian flare predict approach explain wheatland _ find mathalpha mathbeta use mcmc method simple_ffdfit_powerlawmcmc result access simple_ffdalpha simple_ffdalpha_up_err simple_ffdalpha_low_err simple_ffdbeta simple_ffdbeta_up_err simple_ffdbeta_low_err respect upper lower uncertainti repres th th percentil margin posterior distribut mathalpha mathbeta mcmc method prefer fit mathbeta mathalpha simultan sampl may costli quick estim paramet plot result function cumul form use plot_powerlaw plot result top ffd code snippet fig ax pltsubplot figsiz axscatt freq ck axset_xscalelog axset_yscalelog axset_xlabel axset_ylabelcumul number flare per time simple_ffdplot_powerlawax cr labelfralphasimple_ffdalphaf pltlegend imag powerlawjpg width alt simpl ffd powerlaw statist test test power law assumpt must reject stabilis kolmogorovsmirnov statist suggest maschberg kroupa _ test must reject power law hypothesi ffd meaning absolut term whenev compar ffd andor power law fit give us better sens statist robust sampl differ signific level hypothesi test must defin signific level per default limit must reject nullhypothesi context hypothesi distribut follow power law paramet calcul ffdis_powerlawsig_level test distribut truncat high energi end interest question flare statist whether high energi limit seen ffd given star hard tell eye highenergi tail sparsli popul event loglog plot decept may howev ask small highest observ energi consist infinit power law distribut ffdis_powerlaw_trunc perform exceed test leftsid hypothesi test suggest maschberg kroupa _ gener random sampl power law distribut determin maximum energi power law distribut power law expon minimum detect energi total number event larg fraction maximum energi random sampl maximum detect energi like power law distribut fact truncat default valu use percentil math imag truncationpng width alt exceed test ffd deal multistar sampl exampl involv case flare sampl stem multipl light curv differ detect limit andor character use flarelightcurvecharacterize_flar demonstr this_ notebook github rubric footnot github httpsgithubcomekaterinailinaltaiponyblobmasternotebooksbeginner_flare_frequency_distributions_and_power_lawsipynb thoma maschberg pavel kroupa estim expon upper limit goodnessoffit test truncat powerlaw distribut monthli notic royal astronom societi volum issu may page httpsdoiorgjx wheatland bayesian approach solar flare predict astrophys journal httpsdoiorg _thi httpsgithubcomekaterinailinaltaiponyblobmasternotebooksadvanced_flare_frequency_distributions_and_power_lawsipynb detrend light curv altaiponi current featur three differ detrend aproach aim remov astrophys instrument trend time seri preserv flare call detrend flarelightcurv detrended_flc flcdetrenddetrend method kwarg detrend method pass one follow ksc wish detrend k light curv best way deal among issu k kepler spacecraft roll see _ _ _ detail savgol appli savitkygolay _ filter light curv method quick give good result kepler tess light curv may play window_length keyword get optim result custom use detrend pipelin pass function take flarelightcurv return flarelightcurv flcdetrendcustom funcyour custom detrend function _ ekaterina ilin sarah j schmidt katja poppenhäg jame r davenport martti h kristiansen mark omohundro flare open cluster k ii pleiad hyad praesep ruprecht astronomi astrophys volum ida pp httpsdoiorg aigrain suzann parviainen hannu pope benjamin ksc flexibl systemat correct detrend k light curv use gaussian process regress monthli notic royal astronom societi volum issu p httpsdoiorgmnrasstw aigrain suzann parviainen hannu pope benjamin ksc k systemat correct astrophys sourc code librari record ascl httpsuiadsabsharvardeduabsasclsoftaabstract savitzki abraham golay j e smooth differenti data simplifi least squar procedur analyt chemistri volum issu httpsdoiorgaca one function use detrend kepler tess short min min cadenc light curv current access via altaiponycustomdetrendcustom_detrend document test detail soon ilin prep find flare first youll need detrend light curv detail detrend here_ let pick tess light curv rawflc from_mastt modelc c missiontess raw flarelightcurv call rawflc kepler tess light curv use flc rawflcdetrendsavgol follow snippet show differ raw flux still store flcflux detrend flux flcdetrended_flux import matplotlibpyplot plt pltfigurefigs pltplotflctim flcflux npnanmedianflcflux cr labelpdcsap_flux pltplotflctim flcdetrended_flux npnanmedianflcdetrended_flux b labeldetrend flux pltxlabeltim bkjd day pltylabelrflux es pltxlimflctim flctime pltylim pltlegendlocfonts imag ticplotdetrendpng width alt detrend tess flare light curv note k difficult comput intens doabl flc rawflcdetrendksc detrend light curv flc search flare flc flcfind_flar return initi light curv new attribut flare dataframe_ follow column ampl_rec recov amplitud measur rel quiescent stellar flux ed_rec recov equival durat flare light curv quiescent flux subtract ed_rec_err minimum uncertainti equival durat deriv uncertainti flare flux valu see davenport _ detail eq cstart cstop istart istop tstart tstop start end flare candid unit cadenc array index actual time day dur tstoptstart total_n_valid_data_point number data point search flare epoch detrend light curv case look like imag flaretablepng width alt detrend tess flare light curv flare basic flare definit flarelightcurvefind_flar flare candid definit follow criteria chang et al _ eqn ad flare candid data point must posit excurs median quiescent flux valu posit offset must least mathn_ mathsigma local scatter light curv local scatter given explicitli sigma keyword flarelightcurvedetrended_flux_err use instead equal pdcsap_flux_err kepler tess light curv posit offset flarelightcurvedetrended_flux_err must least mathn_ mathsigma local scatter number consecut data point fulfil criteria must least mathn_ pass mathn_ sigma explicitli like flarelightcurvefind_flaresn n n sigmalocal_scatter_array default set n n n sigma default flarelightcurvedetrended_flux_err want pass array local scatter valu keyword argument sigma find_flar mathn_ specif automat becom restrict criterion scenario choos n n check criterion note appli find_flar method detrend light curv avoid accid list flare candid obtain diffent set criteria singl tabl want tri differ set creat copi flarelightcurv set note anoth argument tinker minsep keyword default minsep mean candid flare event within data point combin one extend flare definit addit basic flare definit suffici flare candid detect may want add decay phase flare candid flag data point use look precis energi estim better mask cover gradual tail flare set extend teh previou command like flarelightcurvefind_flaresn n n sigmalocal_scatter_array addtailstru tailthreshdiffdecreas n n addtail flag set datapoint ad detect stop time flare candid posit outlier fulfil n criterion n reduc tailthreshdiff fulfil n criterion n reduc tailthreshdiff data point ad success point longer meet either one criteria _here httpsaltaiponyreadthedocsioenlatesttutorialslciohtml _datafram httpspandaspydataorgpandasdocsstablereferenceapipandasdataframehtml _davenport httpsiopscienceioporgarticlex _chang et al httpsuiadsabsharvardeduabsapjcabstract tutori toctre caption tutori detail flare studi maxdepth lcio detrend altai fakeflar ffd ffd ffd stand flare frequenc distribut class altaiponi allow analys statist properti flare sampl modul altaiponyffd api document toctre caption core function maxdepth flarelc ffd flarelightcurv flarelightcurve_ core class altaiponi light curv detrend flare find character modul altaiponyffd automodapi altaiponyflarelc nohead inheritedmemb