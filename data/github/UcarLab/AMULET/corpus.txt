amulet atacseq multiplet estim tool count base method detect multiplet singl nucleu atacseq snatacseq data public httpsdoiorgsx note jar file run use bam file found releas httpsgithubcomucarlabamuletreleas licens amulet provid gplv licens see licens note amulet code releas mit licens ie code associ r system requir python follow librari numpi panda scipi statsmodel pip instal numpi panda scipi statsmodel use bam file java se build higher instal system requir satisfi download latest releas unzip file prefer output directori enabl shell script execut use chmod eg chmod x amuletsh shell file run java portabl jar need recompil platform run amulet run amulet consist two part identifi loci uniqu align read cell detect multiplet loci read expect bash shell script combin step run independ well latter multiplet detect may use run multiplet detect use qvalu differ default bash shell script run use bash shell script provid follow argument path bam file eg possortedbam cellrang path barcod cell_id map csv format eg singlecellcsv cellrang path list chromosom use analysi eg human_chromosomes_noxytxt path known repetit element eg restrictionlist_repeats_segdups_rmsk_hgb depend genom path exist output directori write output file path script directori fragment file exampl amuletsh pathtofragmentstsvgz pathtosinglecellcsv pathtohuman_autosomestxt pathtorepeatfilterb pathtooutput pathtoshellscript bam file exampl amuletsh pathtopossortedbam pathtosinglecellcsv pathtohuman_autosomestxt pathtorepeatfilterb pathtooutput pathtoshellscript note know input bam file coordin sort get error messag say pleas use forcesort option problem samread librari recogn flag correctli header exampl amuletsh forcesort pathtopossortedbam pathtosinglecellcsv pathtohuman_autosomestxt pathtorepeatfilterb pathtooutput pathtoshellscript advanc option argument use common cellrang output use follow option adjust differ cellrang output differ input gener expectedoverlap expect number read overlap default maxinserts maximum insert size bp read pair default startbas amount base add start posit bam default frag default endbas amount base add end posit bam default frag default bam input bambc bam file attribut use extract barcod read default cb forcesort forc input bam file treat sort bcidx column index count csv file barcod cell id map barcod default cellidx column index count csv file barcod cell id map cell id default iscellidx column index count csv file barcod cell id map determin barcod correspond cell default mapqthresh threshold filter low map qualiti read comparison default maxinserts maximum insert size bp read pair default exampl amuletsh bambc cb bcidx pathtopossortedbam pathtosinglecellcsv pathtohuman_autosomestxt pathtorepeatfilterb pathtooutput pathtoshellscript amuletsh bcidx cellidx iscellidx pathtopossortedbam pathtosinglecellcsv pathtohuman_autosomestxt pathtorepeatfilterb pathtooutput pathtoshellscript run overlap counter multiplet detect independ fragment file overlap counter detect overlap tsvtxttsvgztxtgz use python run fragment overlap counter use python fragmentfileoverlapcounterpi provid follow input argument fragmentfil path fragment file eg fragmentstsvgz cellrang bcmap path barcod cell_id map csv format eg singlecellcsv cellrang chrlist path list chromosom use analysi eg human_autosomestxt outdir path exist output directori write output file exampl python fragmentfileoverlapcounterpi bamfil bcmap chrlist outdir option argument expectedoverlap expect number read overlap default maxinserts maximum insert size bp read pair default startbas amount base add start posit default endbas amount base add end posit neg default bam overlap counter detect overlap bam use java run overlap counter jar file use java jar snatacoverlapcounterjar provid follow input argument bamfil path bam file eg possortedbam cellrang bcmap path barcod cell_id map csv format eg singlecellcsv cellrang chrlist path list chromosom use analysi eg human_autosomestxt outdir path exist output directori write output file exampl java jar snatacoverlapcounterjar bamfil bcmap chrlist outdir option argument expectedoverlap expect number read overlap default bambc bam file attribut use extract barcod read default cb forcesort forc input bam file treat sort bcidx column index count csv file barcod cell id map barcod default cellidx column index count csv file barcod cell id map cell id default iscellidx column index count csv file barcod cell id map determin barcod correspond cell default mapqthresh threshold filter low map qualiti read comparison default maxinserts maximum insert size bp read pair default startbas amount base add start posit default endbas amount base add end posit neg default exampl java jar snatacoverlapcounterjar bambc cb bamfil bcmap chrlist outdir java jar snatacoverlapcounterjar bambc cb cellidx bamfil bcmap chrlist outdir multiplet detect python multiplet detect python file requir input argument overlap path overlapstxt output overlap counter overlapsummari path overlapsummarytxt output overlap counter outdir path exist output directori write output file option argument rfilter bed file known problematicrepetit region exclud multiplet detect q qvalu threshold detect multiplet qrep qvalu threshold infer repetit region exclud multiplet detect exampl python amuletpi rfilter pathtorepeatsb overlap overlapsummari outdir interpret result overlap counter overlap counter script produc four output file describ run data overlapstxt overlapsummarytxt statsummarytxt runtimetxt overlapstxt tab delimit file follow column chr chromosom genom region overlap start start posit overlap end end posit overlap cell id cell id eg _cell_ _cell_ etc cellrang min overlap count minimum number read overlap within region max overlap count maximum number read overlap within region mean map qualiti averag map qualiti read within region max map qualiti max map qualiti read within region start start posit read within region cell id end end posit read within region cell id overlapsummarytxt tab delimit file follow column cell id cell id eg _cell_ _cell_ etc cellrang number valid read pair total number valid read pair cell ie forward strand read mate number overlap total number overlap observ cell merg barcod read barcod associ cell id total number read total number read forward revers strang read count independ statsummarytxt file contain follow inform total read total number read bam file duplic read total number read flag duplic low map qualiti read total number read map qualiti valid read pair total number read pair pass follow readpairedflag true readunmappedflag fals mateunmappedflag fals secondaryorsupplementari fals duplicatereadflag fals referencerindex matereferenceindex ie read pair map chromosom insert size posit bp nucleosom map qualiti read chromosom chromosom list provid mean read length averag length forward strand read mean insert size averag length end end insert size runtimetxt show runtim second identifi instanc read overlap multiplet detect multiplet detect python script produc three output file multipletprob multipletcellids_xxtxt multipletbarcodes_xxtxt xx correspond qvalu threshold use call multiplet multipletprobabilitiestxt tab delimit file follow column cell_id cell id eg _cell_ _cell_ etc cellrang barcod cell barcod pvalu poisson probabl obtain cumul distribut function qvalu fdr correct pvalu multipl hypothesi test multipletcellids_xxtxt file multipletcellid prefix correspond multiplet cell id qvalu threshold specifi xx ie xx exampl impli qvalu threshold multipletbarcodes_xxtxt file multipletbarcod prefix correspond multiplet cell barcod qvalu threshold specifi xx ie xx exampl impli qvalu threshold titl doublet annot pipelin author alper eroglu date r sysdat output rmarkdownhtml_vignett vignett vignetteindexentrydoublet annot pipelin vignetteengineknitrrmarkdown vignetteencodingutf r init includ fals knitropts_chunkset comment echo true first requir packag pipelin load r setup messagefals libraryseurat librarysignac librarydplyr librarytidyr librarytextclean libraryggplot librarymass librarystringr librarymclust function requir pipelin ad r sourcergetmarkerpeak_methodr sourcerannotatedoublets_methodr id doublet cell read follow format r doublet readtabledataexample_doublets_pbmctxt asvector headdoublet seurat object process signac pipelinehttpssatijalaborgsignacarticlespbmc_vignettehtml load r cachetru pbmcatac readrdsfil dataexample_seurat_pbmcrd pbmcatac cell seurat object must format doublet id r headcolnamespbmcatac peak follow format r headrownamespbmcatac desir group chosen annot set identifi seurat object r fig messagef figheight figwidth identspbmcatac grouped_clust dimplotpbmcatac ptsize label repel pipelin work best cell per group annot set desir r cellspergrouppbmcatac marker peak found cluster requir number cell column datafram return one column contain id peak cluster peak belong requir step user creat person marker peak use findallmarkershttpssatijalaborgseuratvde_vignettehtml metod seurat care uniform number peak group chose name format column must follow cluster_id r cachet marker_peak getmarkerpeakspbmcatac doublet doublet n_peak min_cel headmarker_peak read count distribut doublet cell marker peak found use inform typeshomotypicheterotyp origin cluster found data frame contain read count distribut cluster also report r cachetru doublet_annot annotatedoubletsobj pbmcatac marker_peak marker_peak doublet doublet headdoublet_annot data frame ad seurat object meta data cell report singlet r pbmcatac addmetadatapbmcatac doublet_annotationscdoublet dtype dannot drop fals pbmcatacmetadataisnapbmcatacmetadatadtyp dtype singlet pbmcatacmetadataisnapbmcatacmetadatadoublet doublet singlet pbmcatacmetadataisnapbmcatacmetadatadannot dannot singlet doublet identifi count base doublet detect part atacdoubletdetector r fig messagef figheight figwidth dimplotpbmcatac groupbi doublet ptsize col csinglet grey doublet purpl order cdoublet singlet type doublet found doublet annot pipelin r fig messagef figheight figwidth dimplotpbmcatac groupbi dtype ptsize col csinglet grey homotyp red heterotyp blue order cheterotyp homotyp singlet