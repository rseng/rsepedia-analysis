readmemd gener readmermd pleas edit file nfgwaspipelin nextflow genomewid associ studi gwa pipelin built withhttpsimgshieldsiobadgebuiltwithnextflowbrightgreensvghttpswwwnextflowio compatibilityhttpsimgshieldsiobadgecompatibilitylinuxfosxbluesvg github issueshttpsimgshieldsiogithubissuesmontilabnfgwaspipelinesvghttpsgithubcommontilabnfgwaspipelineissu instal clone repositori bash git clone httpsgithubcommontilabnfgwaspipelin init path test data provid multipl toy dataset test pipelin ensur path depend properli setup set toy data path local directori run follow script bash cd nfgwaspipelin python utilspathspi download nextflow execut nextflow requir posix compat system linux os x etc java later instal download option make nextflow file access path variabl specifi full path nextflow time curl httpsgetnextflowio bash quick start docker creat prebuilt docker imag depend instal get start first make sure docker installedhttpsdocsdockercomgetdock pull imag onto local machin docker pull montilabgwaslatest option could build imag dockerfil specifi depend requir note might take docker build tag montilabgwaslatest run docker nextflow gwasnf c gwasconfig withdock montilabgwa expect output bash n e x f l w version launch gwasnf jolly_fermi revis ebd g w p p e l n e indir pathdata outdir pathresult vcf pathdatatoy_vcfcsv pheno pathdatapheno_file_logisticcsv snpset pathdatasnpsettxt phenotyp outcom covar agesexpcpcpcpc model logist test score ref hg warm executor local executor local bbe process qc_miss fafbd process annovar_ref fffa process qc_mono ad process vcf_to_gd ee process merge_gd cf process nullmod_skip_pca_grm edb process gwas_skip_pca_grm baeae process caf_by_group_skip_pca_grm ecd process merge_by_chr feebd process combine_result bd process annovar_input af process plot f process annovar db process add_annovar efcf process report complet oct durat cpu hour succeed altern docker run pipelin hpc support docker bu share comput cluster load depend run pipelin follow addit need instal follow r packag seqarray genesi biobas seqvartool dplyr snprelat ggplot datat reshap latexexp knitr ebimag genomicrang txdbhsapiensucschgknowngen gmmat ezknitr modul load r modul load vcftool modul load bcftool modul load plinkalm modul load annovarapr modul load pandoc nextflow gwasnf c gwasconfig underli structur output folder readme_filesfiguregfmunnamedchunkpng input configur mandatori input file format phenotyp file csv file first column uniqu id subject name column number column fix group variabl option categor variabl call longitudin phenotyp file shoud longformat pca_grm process turnedoff pc present phenotyp file call exampl datapheno_file_linearcsv datapheno_file_logisticcsv datakg_pheno_linearcsv datakg_pheno_logisticcsv datakg_pheno_longitudinalcsv r phenodat readcsvdatapheno_file_linearcsv kableheadphenodat id outcom age sex pc pc pc pc group _rc__rc f group _rc__rc f group _rc__rc f group _rc__rc group _rc__rc f group _rc__rc group genotyp file vcfgz file vcfgz file least contain gt column id column would end snpid final output vcffile contain ds column use dosag gwa imputedt exampl datavcfvcf_filevcfgz datakg_vcfkg_phase_subset_chrvcfgz map file csv file twocolumn csv file map prefix vcfgz file result chromosom name correspond prefix header exampl datatoy_vcfcsv datakg_vcfcsv r mapdat readcsvdatatoy_vcfcsv headerf kableheadmapdat v v chr_ nfgwaspipelinedatavcfvcf_filevcfgz chr_ nfgwaspipelinedatavcfvcf_filevcfgz chr_ nfgwaspipelinedatavcfvcf_filevcfgz chr_ nfgwaspipelinedatavcfvcf_filevcfgz chr_ nfgwaspipelinedatavcfvcf_filevcfgz chr_ nfgwaspipelinedatavcfvcf_filevcfgz option input file format snp set two column txt file seper first column shoud chromosom second column physic posit fix header chrpo exampl datasnpsettxt r snpdat freaddatasnpsettxt kableheadsnpdat chr po genet relationship matrix symmetr matrix save rd format column subject replac kinship matrix r grm readrdsdatagrmrd kablegrm hg hg hg hg hg hg hg hg hg hg gwa exampl input file phenotyp csv r phenodat readcsvdatakg_pheno_logisticcsv kableheadphenodat sampleid popul sex outcom hg gbr f hg gbr hg gbr f hg gbr f hg gbr hg gbr f map file r mapdat readcsvdatakg_vcfcsv headerf kableheadmapdat v v chr_ nfgwaspipelinedatakg_vcfkg_phase_subset_chrvcfgz chr_ nfgwaspipelinedatakg_vcfkg_phase_subset_chrvcfgz chr_ nfgwaspipelinedatakg_vcfkg_phase_subset_chrvcfgz chr_ nfgwaspipelinedatakg_vcfkg_phase_subset_chrvcfgz chr_ nfgwaspipelinedatakg_vcfkg_phase_subset_chrvcfgz chr_ nfgwaspipelinedatakg_vcfkg_phase_subset_chrvcfgz genotyp file see map file execut bash run config file nextflow run gwasnf c pwdconfigsgwas_kg_logisticconfig run equival command nextflow run gwasnf vcf_list pwddatakg_vcfcsv pheno pwddatakg_pheno_logisticcsv phenotyp outcom covar sexpcpcpcpc pca_grm model logist test score gwa group popul min_maf max_pval_manhattan max_pval ref_genom hg genebas exampl input file phenotyp csv r phenodat readcsvdatakg_pheno_linearcsv kableheadphenodat sampleid popul sex outcom hg gbr f hg gbr hg gbr f hg gbr f hg gbr hg gbr f map file r mapdat readcsvdatakg_vcfcsv headerf kableheadmapdat v v chr_ nfgwaspipelinedatakg_vcfkg_phase_subset_chrvcfgz chr_ nfgwaspipelinedatakg_vcfkg_phase_subset_chrvcfgz chr_ nfgwaspipelinedatakg_vcfkg_phase_subset_chrvcfgz chr_ nfgwaspipelinedatakg_vcfkg_phase_subset_chrvcfgz chr_ nfgwaspipelinedatakg_vcfkg_phase_subset_chrvcfgz chr_ nfgwaspipelinedatakg_vcfkg_phase_subset_chrvcfgz genotyp file see map file execut bash run config file nextflow run gwasnf c pwdconfigsgene_kg_linearconfig run equival command nextflow run gwasnf vcf_list pwddatakg_vcfcsv pheno pwddatakg_pheno_linearcsv phenotyp outcom covar pcpcpcpc pca_grm model linear test score gene_bas group popul max_pval ref_genom hg gwla exampl input file phenotyp csv r phenodat readcsvdatakg_pheno_longitudinalcsv kableheadphenodat sampleid popul sex age deltaag outcom hg gbr f hg gbr f hg gbr hg gbr hg gbr f hg gbr f map file r mapdat readcsvdatakg_vcfcsv headerf kableheadmapdat v v chr_ nfgwaspipelinedatakg_vcfkg_phase_subset_chrvcfgz chr_ nfgwaspipelinedatakg_vcfkg_phase_subset_chrvcfgz chr_ nfgwaspipelinedatakg_vcfkg_phase_subset_chrvcfgz chr_ nfgwaspipelinedatakg_vcfkg_phase_subset_chrvcfgz chr_ nfgwaspipelinedatakg_vcfkg_phase_subset_chrvcfgz chr_ nfgwaspipelinedatakg_vcfkg_phase_subset_chrvcfgz genotyp file see map file execut bash run config file nextflow run gwasnf c pwdconfigsgwla_kg_linear_slopeconfig run equival command nextflow run gwasnf vcf_list pwddatakg_vcfcsv pheno pwddatakg_pheno_longitudinalcsv phenotyp outcom covar sexagepcpcpcpc pca_grm model linear test score longitudin random_slop deltaag group popul min_maf max_pval_manhattan max_pval ref_genom hg help command bash see explan paramet help command nextflow gwasnf help n e x f l w version launch gwasnf tiny_vent revis cdedf usag mandatori argument vcf_list string path twocolumn map csv file id file_path pheno string path phenotyp file phenotyp string name phenotyp column option argument gds_input logic true ignor vcf input start gd file skip qc_miss qc_mono vcf_to_gd step gds_list string path twocolumn map gd file id file_path outdir string path master folder store result covar string name covari includ analysi model separ comma eg agesexeduc qc logic true run qc_missfilt genotyp call max_miss qc_mono drop monomorph snp max_miss numer threshold qc_miss filter genotyp call valu pca_grm logic true run pcair gener pca relat individu pcrelat gener genom relationship matrix snpset string path two column txt file separ comma chrpo effect pca_grm true grm string path genom relationship matrix effect pca_grm fals model string name regress model gwa linear logist test string name statist test signific score scorespa binomirar cmp detail see httpsrdrriobiocgenesismanassoctestsinglehtml gwa logic true run gwa imput logic true use dosag regress model ds column need input vcf file gene_bas logic true run aggreg test gene base hg refer genom max_maf numer threshold maximun minor allel frequenc snp aggreg method string name aggreg test method burden skat fastskat smmat skato longitudin logic true run genomewid longitudianl analysi random_slop string set null random intercept model run els run random slope random intercept model group string name group variabl base allel frequenc subgroup calcul left empti dosag logic true also calcul dosag addit allel frequenc slow larg singl gd input min_maf numer threshold minimun minor allel frequenc snp includ qq manhattanplot max_pval_manhattan numer threshold maximun pvalu snp show manhattanplot max_pval numer threshold maxumun pvalu snp annot ref_genom string name refer genom annot hg hg contribut file issu notifi maintain your work fork repo develop test code chang add doc make sure commit messag clearli describ chang send pull request write code file issu use issu tracker start discuss possibl someon els alreadi work idea approach quit right function exist alreadi ticket file issu tracker use hash style guid write utf use modular architectur group similar function process config etc alway use space indent dont use tab tri limit line length charact function process name alway lowercas use snake case config live config folder new featur test current test dataset must provid one look exist style adher accordingli fork repositori sure add relev test make pull request doc updat automat merg master also build doc make sure theyr readabl make pull request made chang test updat document make pull request move everyth back main branch repositori sure refer origin issu pull request expect backandforth regard style complianc rule ad depend chang requir addit depend pleas demonstr chang updat docker imag titl nfgwaspipelin nextflow genomewid associ studi pipelin tag r nextflow gwa genebas analysi longitudianl gwa author name zeyuan song affili multipl affili must quot name anastasia gurinovich affili name anthoni federico affili name stefano monti affili name paola sebastiani affili affili name depart biostatist boston univers school public health massachusett avenu rd floor boston usa index name section comput biomedicin boston univers school medicin east concord st boston usa index name institut clinic research health polici studi tuft medic center washington street boston usa index name bioinformat program boston univers cummington mall boston usa index date novemb bibliographi paperbib summari tool conduct genomewid associ studi gwa systemat autom reproduc manner overdu develop autom gwa pipelin combin multipl analysi tool includ bcftool vcftool r packag snprelategenesisgmmat annovar nextflow portabl flexibl reproduc reactiv workflow framework develop pipelin gwa pipelin integr step data qualiti control assess genet associ analys includ analysi crosssect longitudin studi either singl variant genebas test unifi analysi workflow pipelin implement nextflow depend distribut docker code publicli avail github statement need genomewid associ studi gwa led discoveri highli reproduc variant associ human complex trait diseas tam mani softwar tool avail conduct gwa use crosssect data standard multivari linear logist regress howev analysi longitudin familybas studi requir use advanc statist method mix effect model surviv analysi conduct gwa complex data often investig reli multipl program adhoc link result gener step program focus specif aspect analysi eller approach make difficult keep track analysi step paramet includ data clean filter calcul genomewid princip compon limit reproduc analys address problem develop gwa pipelin provid comprehens comput environ manag genomewid genotyp data conduct analys continu binari trait use mix effect model summar annot visual result materi method featur pipelin implement nextflow portabl scalabl paralleliz reactiv workflow framework dataintens pipelin di nextflow gwa pipelin design automat parallel workflow step denot process requir user manual handl intermedi data step thu improv traceabl reproduc addit pipelin remain flexibl allow user custom paramet option configur file ad process ie addit analyt step nextflow framework standard simpl advanc nextflow user defin incorpor addit process pipelin framework execut part custom pipelin workflow figur depict workflow input requir file includ vcf file chromosom commadelimit phenotyp file includ sampl id phenotyp covari option user provid file list singl nucleotid polymorph snp comput genomewid princip compon genet relationship provid kinship matrix known relat qualiti control pipelin remov monomorph snp variant percent miss valu provid threshold clean vcf file convert genom data structur gd file format comput effici data storag zheng princip compon analysi genet relationship infer option step use pcair pcrelat algorithm conomosconomo estim genet relationship matrix studi subject grm genomewid princip compon pc adjust popul structur user option provid pc covari andor grm associ test pipelin conduct three type analys qualit quantit trait gwa individu snp genebas test genomewid longitudin analys turn correspond logic option configur file three analys fit null model first iter whole genom test one variant gene time test crosssect data base r packag genesi gogarten test longitudin data base r packag gmmat use gener mix effect model chen output visual manhattan qqplot valu genom control gener three analys output file includ snp result annot annovar minor allel frequenc maf subgroup individu defin user final htmlreport analysi gener configur file singl configur file contain pipelin option paramet provid user custom file deploy specif analysi process exampl user may run gwa cohort unrel individu turn grm step reduc complex new user essenti paramet modifi configur file advanc user modifi paramet dive origin code instal execut pipelin clone httpsgithubcommontilabnfgwaspipelin docker contain built assist instal necessari tool pipelin ensur access specif version tool packag two method execut pipelin user execut pipelin command line interfac specifi paramet configur file avail option either obtain command help configur file configur file specifi user set path input file specifi analysi correspond paramet file path paramet set execut either run local scale variou highperform comput environ output error handl output file automat arrang nest folder structur fig lowestlevel subfold hold output log file execut process addit nextflow creat work folder hold intermedi output file serv record run error encount run user fix specif error rerun pipelin resum command resum pipelin automat use cach file previou run continu process fix di conclus discuss gwa pipelin provid userfriendli onestep analysi tool workflow balanc flexibl reproduc requir limit option paramet run studi specif analys user may need modifi paramet origin script three type analys current avail nextflowbas pipelin easi extend new tool method plan includ complex model analys surviv analysi next version pipelin figur figur nfgwaspipelinepng acknowledg thank harold bae aparna bhutkar help work support fund nihnia uag longev consortium uhag omic profil centenarian refer