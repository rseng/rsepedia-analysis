scikitfem scikitfem pure python librari perform finit element assemblyhttpsenwikipediaorgwikifinite_element_method main purpos transform bilinear form spars matric linear form vector hrefhttpscolabresearchgooglecomgithubkinnalascikitfemnotebooksblobmasterexipynbimg srchttpscolabresearchgooglecomassetscolabbadgesvga hrefhttpspypiorgprojectscikitfem altpypiimg srchttpsimgshieldsiopypivscikitfem hrefhttpsscikitfemreadthedocsio altdocumentationimg srchttpsreadthedocsorgprojectspipbadgeversionst hrefhttpsjosstheojorgpapersabaedfdb altstatusimg srchttpsjosstheojorgpapersabaedfdbestatussvg librari minim depend contain compil code support onedimension triangular quadrilater tetrahedr hexahedr finit element includ special element raviartthoma nédélec mini crouzeixraviart argyri instal recent releas instal simpli pip instal scikitfemal remov instal option depend meshio mesh inputoutput matplotlib creat simpl visual minim depend numpi scipi also tri librari browser googl colabhttpscolabresearchgooglecomgithubkinnalascikitfemnotebooksblobmasterexipynb exampl solv poisson problem see also expyhttpsgithubcomkinnalascikitfemblobmasterdocsexamplesexpi python skfem import skfemhelp import dot grad creat mesh meshtrirefin point element meshtripoint element e elementtrip basi basism e shorthand cellbasi bilinearform def laplaceu v _ return dotgradu gradv linearform def rhsv _ return v laplaceassemblebasi b rhsassemblebasi dirichlet boundari condit b enforcea b dmboundary_nod solv linear system x solvea b plot solut skfemvisualsmatplotlib import plot savefig plotm x shadinggouraud colorbartru savefigsolutionpng mesh initi manual load extern file use meshiohttpsgithubcomnschloemeshio creat help special constructor python import numpi np skfem import meshlin meshtri meshtet mesh meshlinenparray mesh meshtri nparray nparray mesh meshtriloaddocsexamplesmeshessquaremsh requir meshio mesh meshtetinit_tensornplinspac support mani common finit elementshttpsgithubcomkinnalascikitfemblobmasterskfemelement__init__pyl stiff matrix assembl use secondord tetrahedra python skfem import basi elementtetp basi basismesh elementtetp quadrat tetrahedron laplaceassemblebasi type scipysparsecsr_matrix exampl found galleryhttpsscikitfemreadthedocsioenlatestlistofexampleshtml benchmark follow benchmark docsexamplesperformancepi demonstr time spent finit element assembl comparison time spent linear solv given number calcul use thinkpad x carbon laptop th gen note time illustr depend eg type element use number quadratur point use type linear solver complex form benchmark solv laplac equat use linear tetrahedr element default direct spars solver scipysparselinalgspsolv degreesoffreedom assembl linear solv nan nan nan nan document project document use sphinx doc built version found read docshttpsscikitfemreadthedocsioenlatest direct link addit resourc exampl test suitehttpsscikitfemreadthedocsioenlatestlistofexampleshtml exampl fenic tutorialhttpsgithubcomgdmcbainfenicstutoinskfem get help encount issu use github issu tracker find help document use github discuss ask questionshttpsgithubcomkinnalascikitfemdiscuss tri provid snippet code fail includ also version librari use version found follow python import skfem printskfem__version__ depend minim depend instal scikitfem numpyhttpsnumpyorg scipyhttpswwwscipyorg addit mani exampleshttpsscikitfemreadthedocsioenlatestlistofexampleshtml use matplotlibhttpsmatplotliborg visual meshiohttpsgithubcomnschloemeshio loadingsav differ mesh file format exampl demonstr use extern packag see requirementstxt list test depend test test run github action makefil repositori root target run test contain local use docker exampl make test_pi run test use py branch kinnalascikitfemdockeractionhttpsgithubcomkinnalascikitfemdockeract releas test kinnalascikitfemreleasetestshttpsgithubcomkinnalascikitfemreleasetest licens content skfem pypi packag scikitfem licens claus bsd licens exampl docsexampl snippet document may differ licens acknowledg project start work grant finnish cultur foundationhttpsskrfi version prepar work project fund academi finlandhttpsakareportakafiibi_appswfservletibif_exx_hakkuvausclicked_onhaknrouilangen approach use finit element assembl inspir work hannukainen juntunenhttpsaumathworkscommatlabcentralfileexchangehjfem_lit contribut happi welcom contribut librari reason project first timer includ report bughttpsgithubcomkinnalascikitfemissu write examplehttpsgithubcomkinnalascikitfemtreemasterdocsexampl improv testshttpsgithubcomkinnalascikitfemtreemastertest find typo document contribut code scikitfem agre releas bsdclaus see licensemd cite librari appreci cite follow articl scientif work articleskfem doi joss year volum number page author tom gustafsson g mcbain titl scikitfem python packag finit element assembl journal journal open sourc softwar changelog format base keep changeloghttpskeepachangelogcomen project adher semant versioninghttpssemverorgspecvhtml respect document andor test featur unreleas chang discretefield subclass ndarray instead namedtupl consequ compon discretefield index insid form like u use ugrad instead chang write wu wu insid form definit equival previous wu wuvalu chang meshdraw use matplotlib default call meshdrawvedo use vedo chang skfemvisualsmatplotlib use jet default colormap chang boundaryfacetbasi alia facetbasi instead way around deprec discretefieldvalu remain backwardscompat deprec drop ad meshplot wrapper skfemvisualsplot ad basisplot wrapper skfemvisualsplot ad basisrefinterp support vectori field ad skfemvisualsmatplotlibplot basic quiver plot vector field ad meshfacets_around construct set facet around subdomain ad meshload tri load orient boundari interfac ad orientedboundari subclass ndarray facet index array orient inform per facet avail orientedboundaryori ad facetbasi use facet orient present calcul trace normal vector ad skfemvisualsmatplotlibdraw visual orient boundariestru given ad meshfacets_satisfi allow specifi keyword argument normal orient result interfac ad facetbasi constructor keyword argument side allow chang side facet use calcul basi function valu gradient fix improv backward compat asmassembl keyword argument fix save format issu meshio fix cellbasi properli support element argument fix basisinterpol properli interpol compon elementcomposit ad basisproject gener easi use altern project ad basi facetbasi kwarg element facet string refer subdomain boundari tag ad elementquadrt lowestord quadrilater raviartthoma element fix function return first compon form nonscalar output ad skfemhelpersmul matrix multipl ad basissplit also split elementvector compon fix elementdg includ wildcard import fix automat visual meshtri meshquad jupyt notebook rais except chang meshio option depend chang elementcomposit use discretefield repres zero ad support argument type basisget_dof ad version inform skfem__version__ ad preserv meshboundari uniform refin meshlin meshtri meshquad fix refin quadrat mesh fall back refin algorithm firstord mesh instead crash fix edg case adapt refin meshtet fail produc valid mesh deprec basisfind_dof favor basisget_dof deprec merg dofsview object via surpris behavior edg case fix mappingisoparametr pickl ad meshsavemeshload exportsimport meshsubdomain meshboundari ad meshload option write mesh data list pass via keyword argument eg outdata data point_data ad meshload skfemiomeshiofrom_fil support addit keyword argument force_meshio_typ load mesh file multipl element type written file one element type time ad asm accept list base assembl form use base sum result use jump term mix mesh see exampl ad meshwith_boundari allow definit intern boundariesinterfac via flag boundaries_onlyfals ad meshtridg meshquaddg meshhexdg meshlinedg new mesh type describ mesh discontinu topolog eg period mesh see exampl ad elementhexdg transform hexahedr h element dgl element ad elementtripdg elementquaddg elementhexdg elementlinepdg shorthand elementtridgelementtrip etc ad elementtriskeletonp elementtriskeletonp defin lagrang multipli skeleton mesh see exampl ad trilinearform assembl spars tensor eg deal unknown materi data ad meshtriori ccw orient triangular mesh use debug interfac extern tool ad partial support meshwedg elementwedg lowest order wedg mesh element ad elementtrip cubic triangular lagrang element ad elementtrip quartic triangular lagrang element ad elementtriparampl paramet nonconform triangular element plate ad elementtribdm lowest order brezzidouglasmarini element ad meshdrawshow visual mesh interact requir vedohttpsvedoembl ad adapt refin meshtet fix mappingisoparametr x faster larg mesh thank addit cach fix meshhexsav work properli fix meshload ignor unpars cell_set insert meshio msh chang mesh string represent inform chang formassembl allow keyword argument list dict type discretefield dd ndarray object allow ndarray pass automat basisinterpol conveni chang meshlin function initi meshlin alia meshlin chang facetbasi shorthand boundaryfacetbasi longer initi interiorfacetbasi mortarfacetbasi keyword argument side pass constructor remov deprec meshdefine_boundari method ad elementtriccr elementtetccr conform crouzeixraviart finit element fix meshmirror return wrong mesh point origin use fix meshlin constructor accept numpi array plain python list fix meshelement_find cellbasisprob cellbasisinterpol work properli small number element larg number input point fix meshtet meshtrielement_find robust degener element fix meshelement_find cellbasisprob cellbasisinterpol rais except queri point outsid domain ad basi shorthand cellbasi ad cellbasi new prefer name interiorbasi ad boundaryfacetbasi new prefer name exteriorfacetbasi ad utilspen altern condens enforc essenti boundari condit ad interiorbasispoint_sourc ex ad elementtetdg similar elementtridg tetrahedr mesh fix meshlineelement_find ad complet rewritten mesh base class immut use element class defin order node better support highord gener mesh type futur ad new quadrat mesh type meshtri meshquad meshtet meshhex ad interiorbasisprob like interiorbasisinterpol return matrix oper solut vector interpol given point ad overload discretefield eg multipl summat subtract explicitli support insid form definit ad meshhexto_meshtet split hexahedra tetrahedra ad meshhexelement_find interpol finit element solut hexahedr mesh via interiorbasisinterpol ad meshwith_boundari function replac meshdefine_boundari ie defin boundari via boolean lambda function ad meshwith_subdomain defin subdomain via boolean lambda function ad skfemutilsproject replac skfemutilsproject differ intuit order argument ad skfemutilsenforc set essenti boundari condit chang matrix row zero diagon one deprec skfemutilsproject favor skfemutilsproject deprec meshdefine_boundari favor meshwith_boundari remov meshrefinescaletransl replac meshrefinedscaledtransl remov skfemmodelshelp avail skfemhelp remov discretefieldfdfddfhod avail discretefieldvaluegradhessgrad remov python support remov skfemutilsl_project remov skfemutilsderiv chang meshrefin attempt fix index meshboundari refin chang skfemutilssolv use scipysparseeig instead scipysparseeigsh default old behavior retain explicitli pass solversolver_scipy_eigs_sym fix high memori usag skfemvisualsmatplotlib relat plot deprec side keyword argument facetbasi favor explicit interiorfacetbasi mortarfacetbasi ad interiorfacetbasi integr interior facet eg evalu error estim jump implement dg method ad mortarfacetbasi integr mortar mesh ad interiorbasiswith_el reiniti equival basi use differ element ad formparti appli functoolsparti form function wrap form fix includ explicit python support deprec list tupl keyword argument type asm deprec meshdmirror favor gener meshmirror deprec meshrefin meshscal meshtransl favor meshrefin meshscal meshtransl ad meshrefin meshscal meshtransl new method return copi instead modifi self ad meshmirror mirror mesh use normal point ad function support form evalu vector tensor ad elementhex piecewis constant element hexahedr mesh ad facetbasistrac restrict exist solut lower dimension mesh boundari interfac fix meshlinerefin correctli perform adapt refin onedimension mesh ad elementlinep onedimension piecewis constant element ad skfemhelperscurl calcul rotat gradient twodimension element ad meshtetinit_bal mesh ball fix elementquad compat facetbasi fix remov unnecessari depend fix make precondition testex robust fix remov test pypi distribut deprec l_project replac project deprec deriv replac project ad meshtetelement_find meshlineelement_find use interiorbasisinterpol ad elementtricr nonconform crouzeixraviart element stoke flow ad elementtetcr tetrahedr nonconform crouzeixraviart element ad elementtrihermit extens elementlinehermit triangular mesh fix fix meshvalid unsign mesht fix optim meshdboundary_edg test run laptop million element ad elementhex triquadrat hexahedr element ad meshtriinit_circl constructor circl mesh fix meshdboundary_edg consequ basisfind_dof slow use lot memori due exhaust search edg deprec project support function like lambda x x instead lambda x z x futur ad support complexvalu form bilinearform linearform take option argument dtype default npfloat also npcomplex ad dofs__or__ dofs__add__ merg degreeoffreedom set ie dof object use oper ad dofsdrop dofskeep filter degreeoffreedom set remov support oldstyl decor bilinear_form linear_form function deprec sinc fix facetbasi initi elementquadp ad meshquad_splitquad alias meshquadto_meshtri ad mesh__add__ merg mesh use oper duplic node join ad elementhex node quadrat hexahedr serendip element ad elementlinemini miniel onedimension mesh fix meshdboundary_edg broken case hexahedr mesh fix skfemutilsproject work elementglob ad elementtetmini miniel tetrahedr mesh fix meshdboundary_edg incorrectli return edg node boundari deprec oldstyl form constructor bilinear_form linear_form function chang basisinterpol return discretefield object instead ndarray tupl chang basisinterpol work properli vectori highord element interpol compon higher order deriv chang formassembl accept keyword argument type discretefield pass form chang renam skfemimport skfemio chang renam skfemmodelshelp skfemhelp chang skfemutilssolv expand also solut eigenvalu problem ad newstyl form constructor bilinearform linearform function ad skfemiojson serial mesh tofrom jsonfil ad elementlinepp pth order onedimension element ad elementquadp pth order quadrilater element ad elementquaddg transform quadrilater h element dg element ad elementquadbf bognerfoxschmit element biharmon problem ad elementtrimini miniel stoke problem ad elementcomposit use multipl element one bilinear form ad elementquad quadrat serendip element ad elementlinehermit cubic hermit element eulerbernoulli beam ad meshdefine_boundari defin name boundari ad basisfind_dof find degreeoffreedom indic ad meshfrom_basi defin highord mesh ad basissplit split multicompon solut ad mortarmap basic support mortar method ad basi constructor accept quadratur keyword argument specifi custom quadratur rule titl scikitfem python packag finit element assembl tag python numer finit element method author name tom gustafsson orcid affili name g mcbain orcid x affili affili name depart mathemat system analysi aalto univers index name memjet north ryde pti ltd macquari park nsw australia index date june bibliographi paperbib summari partial differenti equat pdessuch navierstok equat fluid mechan maxwel equat electromagnet schrödinger equat quantum mechanicsar basic build block modern physic engin finit element method fem flexibl comput techniqu discret solut pde especi case complex spatial domain conceptu fem transform timeindepend tempor discret pde system linear equat axb scikitfem lightweight python librari creation assembl finit element matrix vector b user load comput mesh pick suitabl basi function provid pde weak formul fenicsbook result spars matric vector compat scipi scipi ecosystem purpos prior art exist sever open sourc packag framework implement finit element method scikitfem develop simpl lightweight altern exist python packag focu comput experiment custom pdebas model develop reli pure interpret python code top numpyscipi base make scikitfem easi instal portabl across multipl oper system relianc plain numpi array scipi spars matric enabl interoper variou packag python ecosystem meshio meshio pacopi pacopi pyamg pyamg contrast ngsolv ngsolv fenic fenic firedrak firedrak sfepi sfepi getfem getfem scikitfem contain compil code make instal quick straightforward specif target finit element assembl instead encapsul entir finit element analysi pre postprocess singl framework consequ provid endtoend experi come eg specif physic model distribut comput aim gener term pde henc support varieti finit element scheme current scikitfem includ basic support h hmathrmdiv hmathrmcurl hconform problem well variou nonconform scheme scikitfem accept weak form depend valu deriv trial test function highord deriv local mesh paramet nonuniform materi coeffici field defin quadratur point exist finit element solut iter relat eg nonlinear problem newton method variant paramet continu adapt mesh refin evalu function mark strategi implement user although provid basic tool interpol routin conform mesh refin exampl use appli boundari condit linear system b provid elimin penal correct degreesoffreedom implement inhomogen period boundari condit done separ either use variou helper routin scikitfem mean scikitfem explicit support distribut comput although could use build block parallel comput paramet sweep domain decomposit techniqu exampl enabl work document scikitfem contain exampl demonstr librari use result exampl highlight autoreffigexampl sever public alreadi util comput result scikitfem eg mcbain gustafsson gustafsson addit scikitfem use recent publish python packag batteri model pybamm top left combin triangular quadrilater element use solv linear elast contact problem top right lowest order tetrahedr nédélec element use solv hmathrmcurlconform model problem nabla time nabla time e e f color correspond magnitud vector field e bottom taylorhood element use solv navierstok flow backwardfac step differ reynold number first last twodimension figur gener use scikitfem wrap matplotlib hunter threedimension postprocess special usual left export eg vtk xdmf format via meshio meshio subsequ render eg paraview ahren done second figurelabelfigexamplesexamplespng acknowledg tom gustafsson receiv extern fund finnish cultur foundat academi finland decis nr work project refer advanc topic section contain advanc discuss around featur scikitfem aim develop detail understand librari _form anatomi form consid form basic build block finit element assembl thu use understand form use scikitfem express correctli bilinear form correspond laplac oper mathdelta math au v int_omega nabla u cdot nabla v mathrmdx order express scikitfem write integrand python function doctest skfem import bilinearform skfemhelp import grad dot bilinearform def integrandu v w return dotgradu gradv note use helper funcskfemhelpersgrad funcskfemhelpersdot option without helper last line would read eg ugrad vgrad ugrad vgrad insid form u v type classskfemelementdiscretefield return valu numpi array exampl bodi load math bv int_omega sinpi x sinpi v mathrmdx written doctest import numpi np skfem import linearform linearform def loadingv w return npsinnppi wx npsinnppi wx v note last argument w dictionari classskfemelementdiscretefield object _getattr_ overridden wx correspond wx key popul default eg wx global quadratur point addit form depend local mesh paramet wh finit element function see refpredefin moreov boundari form assembl use classskfemassemblyfacetbasi depend outward normal vector wn one exampl form math lboldsymbolv int_parti omega boldsymbolv cdot boldsymboln mathrmd written doctest skfem import linearform skfemhelp import dot linearform def loadingv w return dotwn v form definit alway return twodimension numpi array verifi use python debugg codeblock python skfem import skfemhelp import grad dot bilinearform def integrandu v w import pdb pdbset_trac breakpoint return dotgradu gradv save snippet testpi run via python testpi allow experi codeblock none tomtunkkisrcscikitfem python testpi asmintegrand basismeshtri elementtrip hometomsrcscikitfemtestpyintegrand return dotgradu gradv pdb dotgradu gradv array notic dotgradu gradv numpi array shape number element x number quadratur point per element return valu alway shape matter mesh element type use modul modskfemhelp contain function make form readabl notic shape ugrad expect also return valu codeblock none tomtunkkisrcscikitfem python testpi asmintegrand basismeshtri elementtrip hometomsrcscikitfemtestpyintegrand return dotgradu gradv pdb ugrad array _dofindex index degreesoffreedom warn section contain detail order dof read find answer reffinddof finit element assembl linear system math ax b order unknown vector mathx dof order automat base mesh element type possibl investig manual dof match differ topolog entiti node facet edg element mesh note nomenclatur scikitfem edg exist threedimension mesh facet someth alway share two element mesh particular refer edg triangular quadrilater mesh facet exampl consid triquadrat hexahedr element default cube mesh doctest skfem import meshhex skfem meshhex object number element number vertic number node basi basism elementhex basi skfem cellbasismeshhex elementhex object number element number dof size b plot skfem import skfemvisualsmatplotlib import drawmeshhex dof correspond node vertic mesh doctest basisnodal_dof array mean first zeroth entri dof array correspond first nodevertex finit element mesh see mp list nodesvertic plot skfem import skfemvisualsmatplotlib import meshhex basi basism elementhex ax drawm dof basisnodal_dofsflatten axtextbasisdofloc dof strdof similarli dof correspond edg medg list edg facet mfacet list facet mesh doctest basisedge_dof array basisfacet_dof array plot skfem import skfemvisualsmatplotlib import meshhex basi basism elementhex ax drawm dof basisedge_dofsflatten axtextbasisdofloc dof strdof plot skfem import skfemvisualsmatplotlib import meshhex basi basism elementhex ax drawm dof basisfacet_dofsflatten axtextbasisdofloc dof strdof dof nodal_dof edge_dof facet_dof share neighbour element preserv continu remain dof intern element share doctest basisinterior_dof array dof associ either node nodal_dof facet facet_dof edg edge_dof element interior_dof galleri exampl page contain overview exampl contain sourc code repositori httpsgithubcomkinnalascikitfemblobmasterdocsexamples_ poisson equat exampl poisson equat unit load exampl solv poisson problem mathdelta u dirichlet boundari condit mathu unit squar use piecewiselinear triangular element plot caption solut exampl docsexamplesex import visual visual see sourc code exampl httpsgithubcomkinnalascikitfemblobmasterdocsexamplesexpy_ inform _ex exampl discontinu galerkin method exampl solv poisson problem mathdelta u mathu boundari use discontinu galerkin method finit element basi piecewisequart discontinu element edg plot caption solut exampl docsexamplesex import visual visual see sourc code exampl httpsgithubcomkinnalascikitfemblobmasterdocsexamplesexpy_ inform exampl postprocess exampl demonstr postprocess valu function boussinesq kfactor plot caption solut exampl docsexamplesex import visual visual see sourc code exampl httpsgithubcomkinnalascikitfemblobmasterdocsexamplesexpy_ inform exampl laplac mix boundari condit exampl solv mathdelta u mathomegaxyxythetapi mathtan theta yx mathu mathi mathu mathx mathfracparti uparti n rest boundari plot caption solut exampl docsexamplesex import visual visual see sourc code exampl httpsgithubcomkinnalascikitfemblobmasterdocsexamplesexpy_ inform _ex exampl laplac inhomogen boundari condit exampl demonstr impos coordinatedepend dirichlet condit laplac equat mathdelta u solut satisfi mathux boundari squar domain plot caption solut exampl docsexamplesex import visual visual see sourc code exampl httpsgithubcomkinnalascikitfemblobmasterdocsexamplesexpy_ inform exampl onedimension poisson equat exampl solv mathu math boundari condit mathuu figur httpsuserimagesgithubusercontentcombbceeacfaaeepng solut exampl see sourc code exampl httpsgithubcomkinnalascikitfemblobmasterdocsexamplesexpy_ inform exampl threedimension poisson equat exampl solv mathdelta u mathu boundari use linear tetrahedr element precondit conjug gradient method note exampl make use extern packag pyamg httpspypiorgprojectpyamg__ pyamgcl httpspypiorgprojectpyamgcl__ instal figur httpsuserimagesgithubusercontentcomabfbfeacbfpng solut exampl crosssect tetrahedr mesh figur creat use paraview httpswwwparavieworg__ see sourc code exampl httpsgithubcomkinnalascikitfemblobmasterdocsexamplesexpy_ inform exampl adapt poisson equat exampl solv exampl adapt lshape domain use linear element error indic read matheta_k h_k f_k matheta_ h_e nabla u_h cdot n _e element mathk edg math plot caption final solut exampl docsexamplesex import visual visual see sourc code exampl httpsgithubcomkinnalascikitfemblobmasterdocsexamplesexpy_ inform exampl mix poisson equat exampl solv mix formul poisson equat use lowest order raviartthoma element figur httpsuserimagesgithubusercontentcomcdfddeaadaafadpng piecewis constant solut field figur creat use paraview httpswwwparavieworg__ see sourc code exampl httpsgithubcomkinnalascikitfemblobmasterdocsexamplesexpy_ inform exampl point sourc point sourc requir differ assembl linear form exampl comput green function disk ie solut dirichlet problem poisson equat sourc term concentr singl interior point mathboldsymbol mathdelta u delta boldsymbolx boldsymbol plot caption scalar potenti disk point sourc docsexamplesex import visual visual see sourc code exampl httpsgithubcomkinnalascikitfemblobmasterdocsexamplesexpy_ inform exampl hybridiz discontinu galerkin method exampl solv poisson equat unit load use techniqu finit element basi first discontin across element edg continu recov help lagrang multipli defin mesh skeleton ie skeleton mesh consist edg origin mesh plot caption solut exampl skeleton mesh docsexamplesex import visual visual see sourc code exampl httpsgithubcomkinnalascikitfemblobmasterdocsexamplesexpy_ inform exampl mix mesh exampl solv poisson equat unit load mesh consist triangl quadrilater support mix mesh preliminari work element nodal intern degreesoffreedom share face edg dof mesh type workinprogress plot caption solut exampl mesh triangl quadrilater docsexamplesex import visual visual see sourc code exampl httpsgithubcomkinnalascikitfemblobmasterdocsexamplesexpy_ inform solid mechan exampl kirchhoff plate bend problem exampl solv biharmon kirchhoff plate bend problem mathd delta u f unit squar constant load mathf bend stiff mathd combin clamp simpli support free boundari condit plot caption solut exampl docsexamplesex import visual visual see sourc code exampl httpsgithubcomkinnalascikitfemblobmasterdocsexamplesexpy_ inform exampl linear elast eigenvalu problem exampl solv linear elast eigenvalu problem mathmathrmdivsigmau lambda u displac fix left boundari plot caption fifth eigenmod exampl docsexamplesex import visual visual see sourc code exampl httpsgithubcomkinnalascikitfemblobmasterdocsexamplesexpy_ inform exampl linear contact problem exampl solv singl inter contact problem two elast bodi use nitsch method triangular quadrilater secondord element use discret two elast bodi plot caption displac mesh von mise stress exampl docsexamplesex import visual visual see sourc code exampl httpsgithubcomkinnalascikitfemblobmasterdocsexamplesexpy_ inform exampl argyri basi function exampl visual mathccontinu fifth degre argyri basi function simpl triangular mesh element use conform discret biharmon problem plot caption argyri basi function exampl correspond middl node edg connect docsexamplesex import visual visual see sourc code exampl httpsgithubcomkinnalascikitfemblobmasterdocsexamplesexpy_ inform exampl threedimension linear elast exampl solv threedimension linear elast equat mathmathrmdivsigmau use trilinear hexahedr element dirichlet condit set oppos face cube one face remain fix displac slightli outward figur httpsuserimagesgithubusercontentcomcceabbcdccbcpng displac mesh exampl figur creat use paraview httpswwwparavieworg__ see sourc code exampl httpsgithubcomkinnalascikitfemblobmasterdocsexamplesexpy_ inform exampl structur vibrat exampl demonstr solut threedimension vectorvalu eigenvalu problem consid vibrat elast structur figur httpsuserimagesgithubusercontentcombdfacdabbaapng first eigenmod exampl see sourc code exampl httpsgithubcomkinnalascikitfemblobmasterdocsexamplesexpy_ inform exampl eulerbernoulli beam exampl solv eulerbernoulli beam equat mathei u boundari condit mathuu use cubic hermit element exact solut mathx mathu figur httpsuserimagesgithubusercontentcomebcceacddfdadpng solut exampl see sourc code exampl httpsgithubcomkinnalascikitfemblobmasterdocsexamplesexpy_ inform exampl nearli incompress hyperelast exampl demonstr implement two field mix formul nearli incompress neohookean solid figur httpsuserimagesgithubusercontentcomaaedeafpng displac contour exampl figur creat use paraview httpswwwparavieworg__ see sourc code exampl httpsgithubcomkinnalascikitfemblobmasterdocsexamplesexpy_ inform exampl hyperelast exampl demonstr newton method appli classic formul hyperelast neohookean solid figur httpsuserimagesgithubusercontentcomfabfecacaddbdpng deform mesh exampl figur creat use vedo httpsgithubcommarcomusyvedo__ see sourc code exampl httpsgithubcomkinnalascikitfemblobmasterdocsexamplesexpy_ inform fluid mechan exampl stoke equat exampl solv creep flow problem primit variabl ie veloc pressur instead streamfunct govern stoke momentum math nudeltaboldsymbolu rhonabla p boldsymbolf continu equat mathnablacdotboldsymbolu figur httpsuserimagesgithubusercontentcomddfeaaacddbpng streamlin exampl see sourc code exampl httpsgithubcomkinnalascikitfemblobmasterdocsexamplesexpy_ inform exampl creep flow via streamfunct exampl solv creep flow problem via streamfunct formul streamfunct mathpsi twodimension creep flow govern biharmon equat mathnu deltapsi mathrmrotboldsymbolf mathnu kinemat viscos assum constant mathboldsymbolf volumetr bodyforc mathmathrmrotboldsymbolf partial f_yparti x partial f_xpartial boundari condit wall mathpsi constant wall imperm normal compon gradient vanish slip figur httpsuserimagesgithubusercontentcomdcdfeabfeddpng veloc field exampl see sourc code exampl httpsgithubcomkinnalascikitfemblobmasterdocsexamplesexpy_ inform exampl stoke flow inhomogen boundari condit exampl solv stoke flow backwardfac step parabol veloc profil inlet figur httpsuserimagesgithubusercontentcombeceafccfdepng streamlin exampl see sourc code exampl httpsgithubcomkinnalascikitfemblobmasterdocsexamplesexpy_ inform exampl backwardfac step exampl use pacopi httpspypiorgprojectpacopy__ extend stoke equat backwardfac step exampl finit reynold number mean defin residu nonlinear problem deriv respect solut reynold number note exampl requir extern packag pacopi httpspypiorgprojectpacopy__ figur httpsuserimagesgithubusercontentcomccaeaefbepng streamlin exampl mathmathrmr see sourc code exampl httpsgithubcomkinnalascikitfemblobmasterdocsexamplesexpy_ inform exampl linear hydrodynam stabil linear stabil onedimension solut navierstok equat govern orrsommerfeld equat httpsenwikipediaorgwikiorresommerfeld_equation_ express term streamfunct mathphi perturb give twopoint boundari valu problem mathalphaphipm phipm complex fourthord ordinari differenti equat math leftalphafracmathrm dmathrm dzrightphi mathrm jalpha rleft c uleftalphafracmathrm dmathrm dzrightphi uphi right mathuz base veloc profil mathc mathalpha wavespe wavenumb disturb mathr reynold number figur httpsuserimagesgithubusercontentcomedcaeafbbpng result exampl see sourc code exampl httpsgithubcomkinnalascikitfemblobmasterdocsexamplesexpy_ inform exampl krylovuzawa method stoke equat exampl solv stoke equat iter squar domain figur httpsuserimagesgithubusercontentcomabdcbeacfbbfcepng pressur field exampl see sourc code exampl httpsgithubcomkinnalascikitfemblobmasterdocsexamplesexpy_ inform exampl block diagon precondit stoke solver exampl solv stoke problem three dimens algorithm scale reason fine mesh million tetrahedra minut note exampl requir implement algebra multigrid either pyamgcl httpspypiorgprojectpyamgcl_ pyamg httpspypiorgprojectpyamg_ figur httpsuserimagesgithubusercontentcomadbbebacfcepng veloc pressur field exampl clip plane spanwis symmetri z figur creat use paraview httpswwwparavieworg_ see sourc code exampl httpsgithubcomkinnalascikitfemblobmasterdocsexamplesexpy_ inform exampl period mesh exampl solv advect equat period squar mesh figur httpsuserimagesgithubusercontentcomadecffedbcdafaaeapng solut exampl period mesh see sourc code exampl httpsgithubcomkinnalascikitfemblobmasterdocsexamplesexpy_ inform heat transfer exampl insul wire exampl solv steadi heat conduct gener insul wire radial coordin govern equat read find matht satisfi mathnabla cdot k_ nabla ra mathnabla cdot k_ nabla arb boundari condit mathk_ fracparti tpartial r h mathrb figur httpsuserimagesgithubusercontentcomdbfceeaaddadepng solut exampl see sourc code exampl httpsgithubcomkinnalascikitfemblobmasterdocsexamplesexpy_ inform exampl heat equat exampl solv heat equat mathfracparti tpartial kappadelta domain mathxw_ mathyw_ initi valu matht_xi cosfracpi xw_cosfracpi yw_ use gener trapezoid rule theta method fast timestep factor evolut matrix figur httpsuserimagesgithubusercontentcombceaffcbgif solut exampl see sourc code exampl httpsgithubcomkinnalascikitfemblobmasterdocsexamplesexpy_ inform exampl forc convect exampl solv plane graetz problem govern advectiondiffus equat mathmathrmp ufracparti tpartial x nabla veloc profil mathu péclet number mathmathrmp mean veloc time width divid thermal diffus figur httpsuserimagesgithubusercontentcomfacceaadfbpng solut exampl see sourc code exampl httpsgithubcomkinnalascikitfemblobmasterdocsexamplesexpy_ inform exampl restrict problem subdomain exampl extend exampl restrict solut subdomain figur httpsuserimagesgithubusercontentcomeacaeadabpng solut exampl see sourc code exampl httpsgithubcomkinnalascikitfemblobmasterdocsexamplesexpy_ inform exampl conjug heat transfer exampl extend exampl conjug heat transfer give finit thick thermal conduct one wall exampl modifi configur exist fulli develop solut found close form given uniform heat flux wall temperatur field asymptot superposit uniform longitudin gradient transvers profil note exampl requir extern packag pygmsh httpspypiorgprojectpygmsh__ figur httpsuserimagesgithubusercontentcomdeedebacbdadacpng comparison inlet outlet temperatur profil exampl see sourc code exampl httpsgithubcomkinnalascikitfemblobmasterdocsexamplesexpy_ inform exampl onedimension heat equat exampl reduc twodimension heat equat exampl demonstr special postprocess requir figur httpsuserimagesgithubusercontentcomebaedadaagif solut exampl see sourc code exampl httpsgithubcomkinnalascikitfemblobmasterdocsexamplesexpy_ inform electromagnet miscellan exampl nonlinear minim surfac problem exampl solv nonlinear minim surfac problem mathnabla cdot leftfracsqrt u nabla u right mathug prescrib boundari squar domain nonlinear problem linear use newton method analyt jacobian calcul hand figur httpsuserimagesgithubusercontentcomccdeaeaadpng solut exampl see sourc code exampl httpsgithubcomkinnalascikitfemblobmasterdocsexamplesexpy_ inform exampl legendr equat exampl solv eigenvalu problem math x u k u math figur httpsuserimagesgithubusercontentcomcdbceeacbfapng six first eigenmod exampl see sourc code exampl httpsgithubcomkinnalascikitfemblobmasterdocsexamplesexpy_ inform exampl bratugelfand exampl solv bratugelfand twopoint boundari valu problem mathu lambda mathrm eu math x mathuu mathlambda paramet note exampl requir extern packag pacopi httpspypiorgprojectpacopy__ figur httpsuserimagesgithubusercontentcomccfceaababpng result exampl see sourc code exampl httpsgithubcomkinnalascikitfemblobmasterdocsexamplesexpy_ inform exampl curv element exampl solv eigenvalu problem mathdelta u lambda u boundari condit mathu_parti omega use isoparametr map via biquadrat basi finit element approxim use fifthord quadrilater figur httpsuserimagesgithubusercontentcomcecbeadeecpng eigenmod exampl curv mesh see sourc code exampl httpsgithubcomkinnalascikitfemblobmasterdocsexamplesexpy_ inform exampl hcurl conform model problem exampl solv vectorvalu problem mathnabla time nabla time e e f domain mathomega boundari condit math time n_partial omega use lowest order nédélec edg element figur httpsuserimagesgithubusercontentcomcceadfdfdaapng solut exampl color given magnitud vector field figur creat use paraview httpswwwparavieworg__ see sourc code exampl httpsgithubcomkinnalascikitfemblobmasterdocsexamplesexpy_ inform exampl characterist imped veloc factor exampl solv seri induct per meter parallel capacit per meter rg coaxial cabl valu use comput characterist imped veloc factor cabl figur httpsuserimagesgithubusercontentcomeccceaeaaeepng result exampl see sourc code exampl httpsgithubcomkinnalascikitfemblobmasterdocsexamplesexpy_ inform document scikitfem scikitfem httpsgithubcomkinnalascikitfem_ pure python librari perform finit element assembl httpsenwikipediaorgwikifinite_element_method_ main purpos transform bilinear form spars matric linear form vector librari support triangular quadrilater tetrahedr hexahedr mesh well onedimension problem note instal librari simpl run codeblock bash pip instal scikitfemal remov instal option depend meshio matplotlib tabl content toctre self gettingstart howto advanc listofexampl api howto guid section contain goalori guid featur scikitfem _finddof find degreesoffreedom often goal constrain dof specif part boundari current main tool find dof methskfemassemblybasisabstractbasisget_dof doctest skfem import meshtri basi elementtrip meshtrirefin basi basism elementtrip plot skfem import skfemvisualsmatplotlib import meshtrirefin basi basism elementtrip ax drawm dof basisnodal_dofsflatten axtextbasisdofloc dof strdof provid indic function methskfemassemblybasisabstractbasisget_dof find dof match facet doctest dof basisget_dofslambda x x dofsnod u array dofsfacet u array element one dof per node one dof per facet facet number scheme start zero howev correspond dof offset total number nodal dof doctest dofsfacetu array plot skfem import skfemvisualsmatplotlib import meshtrirefin basi basism elementtrip ax drawm dof basisfacet_dofsflatten axtextbasisdofloc dof strdof key dictionari indic type dof accord follow tabl key descript u point valu u_n normal deriv u_x partial deriv wrt mathx u_xx second partial deriv wrt mathx un normal compon vector field eg raviartthoma ut tangenti compon vector field eg nédélec u first compon vector field u_x partial deriv first compon wrt mathx u first compon first compon composit field na descript avail eg hierarch bubbl dof array dof key u obtain follow doctest dofsallu array dofsflatten dof matter key array set facet tag name tag pass methskfemassemblybasisabstractbasisget_dof doctest dof basisget_dofsleft dofsflatten array mani dof type welldefin locat dof locat found follow doctest basisdofloc dofsflatten array plot skfem import skfemvisualsmatplotlib import meshtrirefin basi basism elementtrip dof basisget_dofsleft ax drawm dof dofsflatten axplotbasisdofloc dof ro axtextbasisdofloc dof strdof see refdofindex detail _lproj perform project use mathl project find discret counterpart function transform one finit element basi anoth suppos mathu_xi x defin boundari domain want find correspond discret function extend zero interior domain could explicitli assembl solv linear system correspond find mathwidetildeu_ v_h satisfi math int_parti omega widetildeu_ vmathrmd int_parti omega u_ vmathrmdsquad foral v v_h howev common shortcut methskfemassemblyabstractbasisproject doctest import numpi np skfem import meshquadrefin basi facetbas elementquad u lambda x x x ut basisprojectu npabsnproundut array e e e e e e e e e e e e e e e e e e e e e e e e plot import skfem fem femmeshquadrefin basi femfacetbas femelementquad u lambda x x x ut basisprojectu ibasi feminteriorbas femelementquad skfemvisualsmatplotlib import plot draw ax drawibasi plotibasi ut nref axax colorbartru shadinggouraud also project entir domain doctest basi basism elementquad f lambda x npsin nppi x fh basisprojectf npabsnproundfh array plot import skfem fem femmeshquadrefin basi femcellbas femelementquad f lambda x npsin nppi x fh basisprojectf skfemvisualsmatplotlib import plot draw ax drawbasi plotbasi fh nref axax colorbartru shadinggouraud project one finit element basi anoth doctest basi basiswith_elementelementquad fh basisprojectbasisinterpolatefh npabsnproundfh array plot skfem import meshquadrefin basi cellbas elementquad basi basiswith_elementelementquad f lambda x npsin nppi x fh basisprojectf fh basisprojectbasisinterpolatefh skfemvisualsmatplotlib import plot draw ax drawbasi plotbasi fh nref axax colorbartru shadinggouraud interpol gradient quadratur point project doctest f lambda x npsin nppi x fh basisprojectf p fh basisprojectbasisinterpolatefhgrad dfdx npabsnproundfh array plot skfem import meshquadrefin basi cellbas elementquad basi basiswith_elementelementquad f lambda x npsin nppi x fh basisprojectf fh basisprojectbasisinterpolatefhgrad skfemvisualsmatplotlib import plot draw ax drawbasi plotbasi fh nref axax colorbartru shadinggouraud _predefin discret function form use finit element function insid form interpol quadratur point exampl consid fixedpoint iter nonlinear problem math beginalign nabla cdot u tfracnabla u quad textin omega u quad texton partial omega endalign repeatedli find mathu_k h_omega satisfi math int_omega u_k tfrac nabla u_k cdot nabla v mathrmdx int_omega vmathrmdx everi mathv h_omega bilinear form depend previou solut mathu_k doctest import skfem fem skfemmodelspoisson import unit_load skfemhelp import grad dot fembilinearform def bilinfu v w return wu_k dotgradu gradv previou solut mathu_k interpol quadratur point use methskfemassemblycellbasisinterpol provid methskfemassemblybilinearformassembl keyword argument doctest femmeshtrirefin basi fembas femelementtrip b unit_loadassemblebasi x bcopi itr rang fix point iter bilinfassemblebasi u_kbasisinterpolatex x femsolvefemcondensea b iminterior_nod printroundxmax plot import skfem fem skfemmodelspoisson import unit_load skfemhelp import grad dot fembilinearform def bilinfu v w return wu_k dotgradu gradv femmeshtrirefin basi fembas femelementtrip b unit_loadassemblebasi x bcopi itr rang fix point iter bilinfassemblebasi u_kbasisinterpolatex x femsolvefemcondensea b iminterior_nod skfemvisualsmatplotlib import plotbasi x colorbartru nref shadinggouraud note insid form definit w dictionari user provid argument addit default key default wx access also wx correspond global coordin wh access also wh correspond local mesh paramet assembl jump term shorthand funcskfemassemblyasm support special syntax assembl form list base sum result form math buv sum_ mathcale_h int_ uvmathrmd jump mathu u_ u_ mathv v_ v_ interior edg split math buv sum_ mathcale_h leftint_ u_ v_mathrmd int_ u_ v_mathrmd int_ u_ v_mathrmd int_ u_ v_mathrmdsright normal would assembl four form separ instead provid list base call funcskfemassemblyasm doctest import skfem fem femmeshtri e femelementtrip base feminteriorfacetbas e sidek k jumpform fembilinearformlambda u v p sumpidx u v femasmjumpform base basestoarray array exampl practic usag see refex _gettingstart get start support python instal comput instal packag via codeblock bash pip instal scikitfemal specifi includ meshio mesh inputoutput matplotlib simpl visual minim depend numpi scipi also instal scikitfem googl colab httpscolabresearchgooglecom_ execut codeblock bash pip instal scikitfem step clarifi problem tutori solv poisson problem math beginalign delta u f quad textin omega u quad texton partial omega endalign mathomega squar domain mathfxysin pi x sin pi weak formul read find mathu h_omega satisfi math int_omega nabla u cdot nabla v mathrmdx int_omega fvmathrmdx quad foral v h_omega note mathh_omega space function zero boundari mathparti omega finit energi squar integr first deriv finit step express form code next write form math au v int_omega nabla u cdot nabla v mathrmdx quad textand quad lv int_omega f v mathrmdx sourc code form written function decor follow doctest import skfem fem skfemhelp import dot grad helper make form look nice fembilinearform def au v _ return dotgradu gradv doctest import numpi np femlinearform def lv w x wx global coordin f npsinnppi x npsinnppi return f v inform see refform step creat mesh default constructor classskfemmeshmesh initi unit squar doctest mesh femmeshtrirefin refin thrice mesh skfem meshtri object number element number vertic number node name boundari facet left bottom right top plot skfem import meshtrirefineddrawboundariestru step defin basi mesh combin finit element form global basi choos piecewiselinear basi doctest vh fembasismesh femelementtrip vh skfem cellbasismeshtri elementtrip object number element number dof size b step assembl linear system everyth place finit element assembl result matrix type scipysparsecsr_matrix load vector type ndarray doctest aassemblevh l lassemblevh ashap lshape step find boundari dof set boundari condit requir find degreesoffreedom dof boundari empti call methskfemassemblybasisabstractbasisget_dof match boundari dof doctest vhget_dof skfem dofsviewmeshtri elementtrip object number nodal dof u step elimin boundari dof solv boundari dof must elimin linear system mathaxl set mathu boundari done use funcskfemutilscondens output pass funcskfemutilssolv simpl wrapper scipi spars solver doctest x femsolvefemcondensea l dd xshape plot skfem import skfemvisualsmatplotlib import skfemhelp import dot grad import numpi np basi basismeshtrirefin elementtrip bilinearformlambda u v _ dotgradu gradv l linearformlambda v w npsinnppi wx npsinnppi wx v solvecondenseaassemblebasi lassemblebasi dbasisget_dof ax drawbasi plotbasi axax nref colorbartru shadinggouraud step calcul error exact solut known math ux frac pi sin pi x sin pi thu make sens verifi error small doctest femfunct def errorw x wx uh wuh u npsinnppi x npsinnppi nppi return uh u rounderrorassemblevh uhvhinterpolatex e detail api descript section contain api document commonli use interfac librari modul skfemmesh automodul skfemmesh abstract class mesh autoclass skfemmeshmesh member load save refin facets_satisfi nodes_satisfi elements_satisfi class meshtri autoclass skfemmeshmeshtri autoclass skfemmeshmeshtri member __init__ init_symmetr init_sqsymmetr init_refdom init_tensor init_lshap init_circl load autoclass skfemmeshmeshtri member init_circl load class meshquad autoclass skfemmeshmeshquad autoclass skfemmeshmeshquad member __init__ init_refdom init_tensor to_meshtri load autoclass skfemmeshmeshquad member load class meshtet autoclass skfemmeshmeshtet autoclass skfemmeshmeshtet member __init__ init_refdom init_tensor init_bal load autoclass skfemmeshmeshtet member init_bal load class meshhex autoclass skfemmeshmeshhex autoclass skfemmeshmeshhex member __init__ init_tensor to_meshtet load class meshlin autoclass skfemmeshmeshlin autoclass skfemmeshmeshlin member __init__ modul skfemassembl automodul skfemassembl autofunct skfemassemblyasm abstract class abstractbasi subclass classskfemassemblybasisabstractbasi repres global finit element basi evalu quadratur point autoclass skfemassemblybasisabstractbasi member get_dof class cellbasi autoclass skfemassemblybasi autoclass skfemassemblycellbasi member __init__ interpol project class facetbasi autoclass skfemassemblyboundaryfacetbasi autoclass skfemassemblyfacetbasi member __init__ class interiorfacetbasi autoclass skfemassemblyinteriorfacetbasi member __init__ abstract class form class bilinearform autoclass skfemassemblybilinearform member assembl class linearform autoclass skfemassemblylinearform member assembl class function autoclass skfemassemblyfunct member assembl element modul skfemel automodul skfemel showinherit autosummari skfemelementelementh skfemelementelementvector skfemelementelementhdiv skfemelementelementhcurl skfemelementelementglob skfemelementelementdg skfemelementelementcomposit skfemelementelementtrip skfemelementelementtrip skfemelementelementtrip skfemelementelementtrip skfemelementelementtrip skfemelementelementtricr skfemelementelementtriccr skfemelementelementtrirt skfemelementelementtrimorley skfemelementelementtriparampl skfemelementelementtriargyri skfemelementelementtrimini skfemelementelementtrihermit skfemelementelementtriskeletonp skfemelementelementtriskeletonp skfemelementelementtribdm skfemelementelementquad skfemelementelementquad skfemelementelementquad skfemelementelementquad skfemelementelementquadp skfemelementelementquadbf skfemelementelementquadrt skfemelementelementtetp skfemelementelementtetp skfemelementelementtetp skfemelementelementtetrt skfemelementelementtetn skfemelementelementtetmini skfemelementelementtetcr skfemelementelementtetccr skfemelementelementhex skfemelementelementhex skfemelementelementhex skfemelementelementhex skfemelementelementlinep skfemelementelementlinep skfemelementelementlinep skfemelementelementlinepp skfemelementelementlinehermit skfemelementelementlinemini note element global basi calcul quadratur point store insid classskfemelementdiscretefield object differ element type precalcul differ field classskfemelementdiscretefield eg mathhdiv finit element natur precalcul discretefielddiv high order deriv creat use subclass classskfemelementelementglob autoclass skfemelementdiscretefield modul skfemutil function solv autofunct skfemutilssolv function condens autofunct skfemutilscondens function enforc autofunct skfemutilsenforc modul skfemhelp automodul skfemhelp autofunct skfemhelpersgrad autofunct skfemhelpersdiv autofunct skfemhelperscurl autofunct skfemhelpersd autofunct skfemhelpersdd autofunct skfemhelpersddd autofunct skfemhelpersdddd autofunct skfemhelperssym_grad autofunct skfemhelpersdot autofunct skfemhelpersddot autofunct skfemhelpersdddot autofunct skfemhelpersmul autofunct skfemhelperstrac autofunct skfemhelperstranspos autofunct skfemhelpersprod autofunct skfemhelpersinv