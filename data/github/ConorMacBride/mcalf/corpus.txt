titl mcalf multicompon atmospher line fit tag python astronomi solar physic spectrum spectra fit absorpt emiss voigt author name conor macbrid orcid affili name david b jess orcid affili affili name astrophys research centr school mathemat physic queen univers belfast belfast bt nn uk index name depart physic astronomi california state univers northridg northridg ca usa index date april bibliographi paperbib summari determin accur veloc measur observ sun vital import solar physicist studi wave dynam solar atmospher weak chromospher absorpt line due dynam event solar atmospher often consist multipl spectral compon isol compon allow veloc field dynam quiescent regim studi independ howev isol compon particularli challeng due wide varieti spectral shape present dataset mcalf provid novel method infrastructur determin doppler veloc larg dataset spectrum fit model adapt specif spectral shape statement need mcalf opensourc python packag accur constrain veloc inform spectral imag observ use machin learn techniqu softwar packag intend use solar physicist tri extract lineofsight lo doppler veloc inform spectral imag observ stoke measur sun toolkit use defin spectral model optimis particular dataset packag particularli suit extract veloc inform spectral imag observ individu spectra contain multipl spectral compon multipl compon typic present activ solar phenomena occur within isol region solar disk spectra within region often larg emiss compon superimpos top underli absorpt spectral profil quiescent solar atmospher felip abl extract veloc inform observ would provid solar physicist wider rang data product use scienc stangalini packag implement novel approach autom classif spectral profil prior fit model sampl model provid ibi ca textscii Ã¥ spectral imag sunspot dataset dataset typic contain spectra multipl atmospher compon packag support isol individu compon veloc inform constrain compon method implement ibi model discuss extens macbrid also sever ongo research project use model extract veloc measur use sampl model well separ base templat model built upon custom model easili built specif dataset custom model design take account spectral shape particular spectrum dataset train neural network classifi use sampl spectra dataset label spectral shape spectral shape spectrum dataset found fit algorithm adjust spectrum base particular spectral shape neural network assign toolkit natur packag also allow possibl utilis exist machin learn classifi supervis hierarch kmean classifi introduc pano cluster solar flare spectra base profil shape packag design run parallel larg data cube well serial spectrum process isol packag scale well across mani processor core numer function provid plot result clearli showcas autoreffigexampl mcalf api also contain mani use function potenti integr python packag full document well exampl use mcalf provid mcalfmacbridemehttpsmcalfmacbridem overview plot function includ mcalflabelfigexamplefigurepdf acknowledg cdm would like thank northern ireland depart economi award phd studentship dbj wish thank invest ni randox laboratori ltd award research develop grant rden allow comput techniqu employ develop dbj would also like thank uk scienc technolog facil council stfc consolid grant sttx author wish acknowledg scientif discuss wave lower solar atmospher walsa wwwwalsateamhttpswwwwalsateam team support research council norway project royal societi award hookebsctm refer