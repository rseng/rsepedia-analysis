docssource_staticimgneuralhydlogoblackpng python librari train neural network strong focu hydrolog applic packag use extens research last year use variou academ public core idea packag modular place allow easi integr new dataset new model architectur trainingrel aspect eg loss function optim regular one core concept code base configur file let anyon train neural network without touch code neuralhydrolog packag built top deep learn framework pytorchhttpspytorchorg sinc proven flexibl use research purpos ai earth scienc group institut machin learn johann kepler univers linz austria use code daytoday research continu integr new research find public repositori document neuralhydrologyreadthedocsiohttpsneuralhydrologyreadthedocsio research blog neuralhydrologygithubiohttpsneuralhydrologygithubio bug reportsfeatur request httpsgithubcomneuralhydrologyneuralhydrologyissueshttpsgithubcomneuralhydrologyneuralhydrologyissu contact question comment regard usag repositori pleas use discuss sectionhttpsgithubcomneuralhydrologyneuralhydrologydiscuss github bug report featur request pleas open issuehttpsgithubcomneuralhydrologyneuralhydrologyissu github special case also reach us email neuralhydrologyatgooglegroupscom name bug report creat report help us improv titl bug titl describ bug label assigne describ bug clear concis descript bug reproduc step reproduc behavior eg data use command execut modifi code etc expect behavior clear concis descript expect happen descript dataset provid detail dataset use eg outofthebox camel dataset creat csvnetcdf file case provid data sampl might benefici log screenshot pleas provid full stack trace except occur applic add screenshot help explain problem desktop environ pleas complet follow inform os eg linux window io git commit clone repo version number neuralhydrology__about__pi python version list instal python packag use conda creat list via conda env export addit context add context problem name featur request suggest idea project titl request titl describ featur request label assigne featur request relat problem pleas describ clear concis descript problem ex im alway frustrat describ solut youd like clear concis descript want happen describ altern youv consid clear concis descript altern solut featur youv consid addit context add context screenshot featur request contribut neuralhydrolog welcom neuralhydrolog contribut guid first thank consid contribut neuralhydrolog follow set guidelin contribut neuralhydrolog intend make contribut easi possibl contributor us maintain project kind contribut mani way contribut project name file bug report featur request github issu contribut bug fix pull request contribut new featur new model new dataset etc pull request improv document httpsneuralhydrologyreadthedocsio__ new tutori better descript even fix typo follow section give guidanc option report bug featur request youv come across behavior think bug miss featur first step check alreadi known take look github issu page httpsgithubcomneuralhydrologyneuralhydrologyissues__ cant find anyth relat your welcom creat issu note pleas use issu page httpsgithubcomneuralhydrologyneuralhydrologyissues__ bug report featur request leav discuss httpsgithubcomneuralhydrologyneuralhydrologydiscussions__ open discuss eg project idea engag user creat issu bug report couldnt find open issu address problem open new one pleas make sure use meaning titl clear descript includ much relev detail possibl ideal bug report contain descript reproduc bug command execut modif code etc full stack trace except occur configur yaml file use experi neuralhydrolog version use experi git commit clone repo version number neuralhydrology__about__pi descript dataset use experi use outofthebox camel dataset creat csvnetcdf file list python packag instal environ your use conda creat list via conda env export consol output config file stack trace environ file pleas tri format code directli issu use github code block httpsdocsgithubcomengithubwritingongithubworkingwithadvancedformattingcreatingandhighlightingcodeblocks__ syntax link gist httpsgistgithubcomdiscover__ contribut code pull request wrote code fix bug provid new function use use pull request pr merg chang project pr pleas provid small descript chang made includ refer issu pr solv one exist well take look pr small code review might outlin chang necessari merg pr project pleas dont feel overwhelm chang requestsit entir normal code review go back forth time code readi merg everyon happi chang pr well approv merg master branch environ setup quick start section httpsneuralhydrologyreadthedocsioenlatestusagequickstarthtml__ contain inform set environ instal requir depend packag well download data make code chang youll need fork repositori github describ process commit push chang git repositori goe beyond scope guid inform creat pull request see exampl tutori httpsmakeapullrequestcom__ github document httpsdocsgithubcomenpullrequestscollaboratingwithpullrequestsproposingchangestoyourworkwithpullrequestscreatingapullrequest__ code style possibl wed happi code alreadi format accord code style use yapf httpsgithubcomgoogleyapf__ configur file httpsgithubcomneuralhydrologyneuralhydrologyblobmasterstyleyapf__ ensur code use line length indent style etc your use visual studio code ide add follow line set file projectrootvscodesettingsjson codeblock editorformatonsav true pythonformattingprovid yapf set make sure whenev save chang yapf autoformat chang file accord style guid cant get yapf run dont worryw format last step merg pr document neuralhydrolog document httpsneuralhydrologyreadthedocsio__ automat gener file locat doc folder pr introduc chang document youll find relev file particularli new configur argument pleas add descript argument configur argument page httpsgithubcomneuralhydrologyneuralhydrologyblobmasterdocssourceusageconfigrst__ build document webpag local see everyth render correctli simpli run make html doc folder pleas check output command make sure broken link etc output red warn error afterward start local server via python httpserver docsbuildhtml server run access local document page browser url localhost continu integr test github repositori contain suit test case run automat everi pull request test case must run success merg contribut youll see statu test case bottom pull request ideal youv made sure test run smoothli local machin submit pr test case use pytest httpsdocspytestorg__ test framework run test case via python pytest test specif test case via python pytest testtest_config_runspi k test_daily_regression_nan_target your use ide might also autodetect test case provid option run via ide gui ideal creat pr fix bug add new featur pr would also contain one test case make sure bug doesnt happen dont chang futur would break new featur find exampl test case test folder dont know write test case dont worryy still creat pr well discuss creat test code review includ contributingrst neuralhydrolog document master file creat sphinxquickstart mon aug adapt file complet like least contain root toctre direct welcom neuralhydrolog document document neuralhydrolog python packag sourc code avail github httpsgithubcomneuralhydrologyneuralhydrology_ document page youll find docquickstart guid usagequickstart stepbystep instruct instal requir dataset commandlin usag weve also written doctutori tutorialsindex walk code exampl train first model docmodelzoo usagemodel list model come prepackag instal add model final docapi doc apineuralhydrolog show indepth inform modul class function within neuralhydrolog might also interest research blog httpsneuralhydrologygithubio_ post news paper project toctre maxdepth caption content usagequickstart usagemodel tutorialsindex usageconfig apineuralhydrolog contribut modelzoo follow section give overview implement model neuralhydrolog conceptu model packag consist two part model class constitut core model model head relat output model class predict variabl section model heads_ provid list implement model head section model classes_ list model class want implement model within packag best start section implement new model_ provid necessari detail model head head model use top model class relat output model classes_ predict variabl current four model head avail regression_ gmm_ cmal_ umal_ latter three head provid option probabilist model detail overview found klotz et al uncertainti estim deep learn rainfallrunoff model httpsarxivorgabs__ regress pyclassneuralhydrologymodelzooheadregress provid singl layer regress head includ differ activ option output name linear relu softplu possibl obtain probabilist predict regress head use montecarlo dropout usag defin configyml set mc_dropout sampl behavior govern pick number sampl n_sampl approach handl neg sampl negative_sample_handl gmm pyclassneuralhydrologymodelzooheadgmm implement gaussian mixtur model head mixtur densiti network gaussian distribut compon gaussian compon defin two paramet mean varianc set weight current implement gmm head use two layer specif output activ use varianc pyfunctorchexp weight pyfunctorchsoftmax number compon set configyml use n_distribut addit sampl behavior infer defin configyml set number sampl n_sampl approach handl neg sampl negative_sample_handl cmal pyclassneuralhydrologymodelzooheadcm implement countabl mixtur asymmetr laplacian head mixtur densiti network asymmetr laplac distribut compon name homag umal_ provid uncount extens cmal compon defin three paramet locat scale asymmetri link set weight current implement cmal head use two layer specif output activ use compon scale pyclasstorchnnsoftplu asymmetri pyfunctorchsigmoid weight pyfunctorchsoftmax preliminari experi heurist achiev better result number compon set configyml use n_distribut addit one sampl cmal behavior defin set number sampl n_sampl approach handl neg sampl negative_sample_handl umal pyclassneuralhydrologymodelzooheadcm implement uncount mixtur asymmetr laplacian head mixtur densiti network use uncount amount asymmetr laplac distribut compon uncount properti achiev implicitli learn condit densiti approxim need montecarlo integr use sampl asymmetri paramet umal compon defin two paramet locat scale link set weight current implement use two hidden layer output activ scale major differ origin implement sinc upper bound use pyfunctorchsigmoid infer number compon weight use montecarlo approxim defin configyml n_tau addit argument umal_extend_batch allow explicitli account integr step train repeatedli sampl asymmetri paramet extend batch n_tau furthermor depend use output activ sampl asymmetri paramet yield unwarr model behavior therefor lower upperbound sampl adjust use tau_down tau_up option config yml sampl umal defin choos number sampl n_sampl approach handl neg sampl negative_sample_handl model class basemodel abstract base class model deriv use class model train cudalstm pyclassneuralhydrologymodelzoocudalstmcudalstm network use standard pytorch lstm implement featur x_d x_ x_one_hot concaten pass network time step staticsdynamics_embed use staticdynam input pass embed network concaten initi forget gate bia defin configyml initial_forget_bia set accordingli model initi customlstm pyclassneuralhydrologymodelzoocustomlstmcustomlstm variant cudalstm return gate state activ time step class mainli implement exploratori reason use method modelcopy_weight copi weight cudalstm model customlstm model allow use fast cuda implement train use class infer detail output howev also use model train model customlstm configyml starter modif lstm cell note howev runtim model consider slower optim counterpart ealstm pyclassneuralhydrologymodelzooealstmealstm implement entityawar lstm introduc kratzert et al toward learn univers region local hydrolog behavior via machin learn appli largesampl dataset httpshesscopernicusorgarticleshesshtml__ static featur x_ andor x_one_hot use comput input gate activ dynam input x_d use gate network initi forget gate bia defin configyml initial_forget_bia staticsdynamics_embed use staticdynam input first pass embed network output static embed network pass input gate consist singl linear layer embcudalstm deprec beta use cudalstm_ statics_embed pyclassneuralhydrologymodelzooembcudalstmembcudalstm similar cudalstm_ differ static input x_ andor x_one_hot pass embed network concaten dynam input x_d time step gru pyclassneuralhydrologymodelzoogrugru network use standard pytorch gru implement featur x_d x_ x_one_hot concaten pass network time step staticsdynamics_embed use staticdynam input pass embed network concaten _mclstm mclstm pyclassneuralhydrologymodelzoomclstmmclstm concept massconserv model architectur inspir lstm recent propos hoedt et al httpsarxivorgabs_ implement includ librari exact model configur use hydrolog experi link public detail see appendix b input model split two group mass input whose valu store memori cell model target calcul ii auxiliari input use control gate within model implement singl mass input per timestep eg precipit allow specifi config argument mass_input make sure exclud mass input featur well target variabl standard featur normal done use custom_norm config argument set center scale key none exampl mass input name precipit target featur name discharg would look like codeblock yaml custom_norm precipit center none scale none discharg center none scale none input specifi dynamic_input config argument use auxiliari input possibl embed static input eg catchment attribut config argument head ignor model model predict alway comput sum outgo mass exclud trash cell output mtslstm pyclassneuralhydrologymodelzoomtslstmmtslstm newli propos model gauch et al rainfallrunoff predict multipl timescal singl long shortterm memori network httpsarxivorgabs__ model allow train tempor resolut eg daili hourli input return multitimescal model predict accordingli detail tutori follow shortli odelstm pyclassneuralhydrologymodelzooodelstmodelstm pytorch implement odelstm propos lechner hasani httpsarxivorgabs_ model use unevenli sampl input queri return predict arbitrari time step transform pyclassneuralhydrologymodelzootransformertransform encod portion standard transform network selfattent use standard pytorch transformerencod implement featur x_d x_ x_one_hot concaten pass network time step unless number input divis number transform head transformer_nhead necessari use embed network guarante achiev use staticsdynamics_embed staticdynam input pass embed network concaten embed network map static dynam featur size staticsdynamics_embeddinghidden total embed size sum valu instead decod model use standard head eg linear model requir follow hyperparamet specifi config file transformer_positional_encoding_typ choic sum concaten posit encod model input transformer_positional_dropout fraction dropout appli posit encod transformer_nhead number selfattent head transformer_dim_feedforward dimens feedforward network selfattent head transformer_dropout dropout feedforward network selfattent head transformer_nlay number stack selfattent feedforward layer implement new model list show skeleton templat model use start implement model implement model make sure modifi pyfuncneuralhydrologymodelzoo__init__get_model furthermor make sure select uniqu model abbrevi use specifi model configyml file codeblock python type import dict import torch neuralhydrologymodelzoobasemodel import basemodel class templatemodelbasemodel def __init__self cfg dict initi model model receiv input config dictionari entir model implement class potenti use modul fc fcpi class get model input return predict model inherit basemodel implement univers function basemodel also defin output_s use given attribut selfoutput_s paramet cfg dict configur run read config file addit key number basin supertemplatemodel self__init__cfgcfg creat model part def forwardself data dictstr torchtensor dictstr torchtensor forward pass model convent forward pass accept dict input tensor usual dict contain x_d possibl x_ x_one_hot x_d x_ avail multipl frequenc key x_d x_ frequenc suffix x_d_h hourli data furthermor definit model return dict contain network predict y_hat potenti addit key lstmbase model stick convent return least follow three tensor y_hat h_n c_n multifrequ case y_hat_h y_hat_d etc paramet data dictstr torchtensor dictionari tensor x_d shape batch size sequenc length featur contain dynam input data x_ shape batch size featur contain static input featur concaten defin config static_attribut evolving_attribut case singl camel attribut static input featur defin config x_ present x_one_hot shape batch size number basin contain one hot encod basin case use_basin_id_encod set fals config x_one_hot present note input data avail multipl frequenc via use_frequ input tensor suffix _freq indic tensor frequenc return network predict return dictionari key y_hat multipl frequenc predict y_hat_freq furthermor make sure return predict time step even want train sequencetoon predict use train network control train_epoch function neuralhydrologytrainingbasetrainerpi return valu hidden state h_n cell state c_n return valu possibl implement forward pass pass quick start prerequisit first step need python environ requir depend recommend way use minianaconda creat new environ use one predefin environ file environ httpsgithubcomneuralhydrologyneuralhydrologytreemasterenvironments__ make sure select correct file depend system dont cudacap gpu use codeblock conda env creat f environmentsenvironment_cpuyml cudacap gpu use either environment_cuda_yml environment_cuda_yml depend hardwar prefer use minianaconda make sure python environ python packag instal list environ file next step execut within python environ instal two way instal neuralhydrolog edit nonedit want run experi exist dataset exist model use nonedit instal instal latest releas pypi codeblock pip instal neuralhydrolog instal packag directli current master branch repositori includ chang yet part releas run codeblock pip instal githttpsgithubcomneuralhydrologyneuralhydrologygit want tri implement model dataset youll need edit instal start download clone repositori local machin use git run codeblock git clone httpsgithubcomneuralhydrologyneuralhydrologygit dont know git also download code httpsgithubcomneuralhydrologyneuralhydrologyzipballmaster__ extract zipfil clone download zipfil youll end directori call neuralhydrolog neuralhydrologymast next well go directori instal local edit copi packag codeblock cd neuralhydrolog pip instal e instal procedur edit nonedit version add packag python environ instal three bash script nhrun nhrunschedul nhresultsensembl detail see data train evalu model requir dataset your unsur start common dataset camel us avail camel us ncar httpsralucaredusolutionsproductscamels_ dataset use tutori dedic tutori tutorialsdataprerequisitesnblink_ download instruct might want look train model train model prepar configur file run nhrun train configfil pathtoconfigyml want train multipl model make use nhrunschedul command place config folder run nhrunschedul train directori pathtoconfig_dir runspergpu x gpuid x specifi mani model train parallel singl gpu specifi gpu use train use id specifi nvidiasmi evalu model evalu train model test set run nhrun evalu rundir pathtorun_dir option argument epoch n n epoch evalu specifi weight last epoch use evalu run specif directori similarli train run nhrunschedul evalu directori pathtoconfig_dir runspergpu x gpuid merg predicton number run store dir one averag ensembl use nhresultsensembl script nhresultsensembl rundir dir dir outputdir pathtooutputdirectori metric nse mse metric specifi metric calcul averag predict configur argument page provid list possibl configur argument check file examplesconfigymlexampl httpsgithubcomneuralhydrologyneuralhydrologyblobmasterexamplesconfigymlexample__ exampl config file could look like gener experi configur experiment_nam defin name experi use folder name datetim string well name tensorboard run_dir full rel path run directori store empti run store current_working_dirrun train_basin_fil full rel path text file contain train basin use data set basin id one id per line validation_basin_fil full rel path text file contain valid basin use data set basin id one id per line test_basin_fil full rel path text file contain train basin use data set basin id one id per line train_start_d start date train period first day discharg format ddmmyyyy also list date specifi multipl train period list specifi train_end_d must also list equal length correspond pair start end date denot differ period train_end_d end date train period last day discharg format ddmmyyyy also list date list specifi also train_start_d must list equal length validation_start_d start date valid period first day discharg format ddmmyyyy also list date similar train period specif validation_end_d end date valid period last day discharg format ddmmyyyy also list date similar train period specif test_start_d start date test period first day discharg format ddmmyyyy also list date similar train period specif test_end_d end date valid period last day discharg format ddmmyyyy also list date similar train period specif per_basin_train_periods_fil altern specifi global train period basin use train_start_d train_end_d also possibl use individu period basin work creat dictionari one key per basin id basin id dictionari contain two key start_dat end_dat contain list panda timestamp indic start end date train period start_dat end_dat list even case singl period per basin see exampl use pickl librari store dictionari disk use path pickl file valu config argument codeblock import panda pd date basin_a start_dat pdto_datetim end_dat pdto_datetim basin_b start_dat pdto_datetim pdto_datetim end_dat pdto_datetim pdto_datetim per_basin_validation_periods_fil per_basin_train_periods_fil indic individu period use valid period per_basin_test_periods_fil per_basin_train_periods_fil indic individu period use test period seed fix random seed empti random seed gener run devic devic use format cuda cuda etc gpu cpu valid set validate_everi integ specifi interv valid perform empti valid done train validate_n_random_basin integ specifi mani random basin use per valid valu larger n_basin clip n_basin metric list metric calcul validationtest see pymodneuralhydrologyevaluationmetr list avail metric also dictionari list keyvalu pair correspond one target variabl metric comput target like possibl comput differ metric per target valid andor evalu train save_validation_result truefals true store valid result disk pickl file otherwis use tensorboard gener model configur model defin model class ie core model use name match valu function httpsgithubcomneuralhydrologyneuralhydrologyblobmasterneuralhydrologymodelzoo__init__pyl__ eg cudalstm ealstm mtslstm head predict head use top output model class current support regress gmm cmal umal make sure pass necessari option depend choic head see hidden_s hidden size model class case lstm reflect number lstm state initial_forget_bia initi valu forget gate bia output_dropout dropout appli output lstm regress head ignor head regress output_activ activ use output neuron linear layer current support linear relu softplu empti linear use mc_dropout truefals wheter montecarlo dropout use sampl infer gmm head ignor head gmm n_distribut number distribut use gmm head n_sampl number sampl gener per timestep gmm negative_sample_handl account neg sampl possibl valu none noth clip clip valu zero truncat resampl valu drawn zero last option chosen addit argument negative_sample_max_retri control often valu resampl negative_sample_max_retri number repeat sampl truncat option negative_sample_max_retri argument mc_dropout truefals whether montecarlo dropout use sampl infer cmal head ignor head cmal n_distribut number distribut use cmal head n_sampl number sampl gener per timestep cmal negative_sample_handl approach handl neg sampl possibl valu none noth clip clip valu zero truncat resampl valu drawn zero last option chosen addit argument negative_sample_max_retri control often valu resampl negative_sample_max_retri number repeat sampl truncat option negative_sample_max_retri argument mc_dropout truefals whether montecarlo dropout use sampl infer umal head ignor head umal n_tau number tau sampl approxim uncount distribut umal_extend_batch truefals whether batch extend n_tau time account specif approxim densiti alreadi train tau_down lower sampl bound asymmetri paramet smaller tau_up tau_up upper sampl bound asymmetri paramet larger tau_down n_sampl number sampl gener per timestep umal negative_sample_handl approach handl neg sampl possibl valu none noth clip clip valu zero truncat resampl valu drawn zero last option chosen addit argument negative_sample_max_retri control often valu resampl negative_sample_max_retri number repeat sampl truncat option negative_sample_max_retri argument mc_dropout truefals whether montecarlo dropout use sampl infer multitimescal train set use model mtslstm transfer_mtslstm_st specifi hidden cell state transfer lower higher frequenc configur dictionari key h hidden state c cell state possibl valu none linear ident transfer_mtslstm_st provid empti default linear transfer shared_mtslstm fals use distinct lstm individu weight timescal true use singl lstm timescal use onehotencod identifi current input timescal case transfer_mtslstm_st use configur hidden cell state transfer transform set use model transform transformer_nlay number multihead selfattent layer transform encod transformer_positional_encoding_typ choic sum concaten use chang way posit encod use transform embed layer sum mean posit encod ad valu input layer concaten mean embed concaten addit input featur transformer_dim_feedforward dimens dens layer use selfattent layer transform encod transformer_positional_dropout dropout appli posit encod use transform encod transformer_dropout dropout use transform encod layer transformer_nhead number parallel transform head odelstm set use model odelstm ode_method method use solv ode one euler rk heun ode_num_unfold number iter break ode solv step ode_random_freq_lower_bound lowest frequenc use randomli aggreg first slice input sequenc see document odelstm class detail frequenc random mclstm set use model mclstm mass_input list featur use mass input mclstm model ie whose quantiti conserv time current mclstm configur implement support singl mass input make sure exclud featur default normal see refmclstm mclstm descript embed network set set defin fulli connect network use variou place embed network static dynam featur singlefrequ model option extend input gate network ealstm model multitimescal model set ignor statics_embed none default dict defin embed network static input dictionari follow key type default fc type embed net current fc fullyconnect net support hidden list integ defin number neuron per layer fulli connect network last number number output neuron must least length one activ default tanh activ function network support valu tanh sigmoid linear activ function appli output neuron alway linear activ function activ function output neuron appli main model class dropout default dropout rate appli embed network note ealstm alway addit linear layer map ealstm hidden size mean embed layer output size equal hidden_s dynamics_embed none default dict defin embed network dynam input see statics_embed descript dictionari structur train set optim specifi optim use current support adam standard new optim ad pyfuncher neuralhydrologytrainingget_optim loss loss use current support mse nse rmse gmmloss cmalloss umalloss new loss ad pymodher neuralhydrologytrainingloss allow_subsequent_nan_loss defin number train step loss valu nan ignor error rais instead train loop proce next iter step target_loss_weight list float valu specifi pertarget loss weight train multipl target combin loss default weight target n n number target variabl order weight correspond order target_vari regular list option regular term current support tie_frequ coupl predict frequenc via mse term new regular ad pymodher neuralhydrologytrainingregular learning_r learn rate either singl number constant learn rate dictionari dictionari key must integ reflect epoch learn rate chang correspond valu key defin initi learn rate batch_siz minibatch size use train epoch number train epoch use_frequ defin time step frequenc use daili hourli use panda frequenc string httpspandaspydataorgpandasdocsstableuser_guidetimeserieshtmltimeseriesoffsetaliases__ defin frequenc note string need includ valu eg instead use predict_last_n seq_length must dictionari no_loss_frequ subset frequenc use_frequ evaluationonli ie model get input produc output frequenc list consid calcul loss regular term seq_length length input sequenc use_frequ use need dictionari map frequenc sequenc length els int predict_last_n defin time step use calcul loss count backward cant larger seq_length sequencetoon would predict_last_n sequencetosequ eg sequenc length predict_last_n use_frequ use need dictionari map frequenc predict_last_nvalu els int target_noise_std defin standard deviat gaussian nois ad label train set zero leav empti add nois clip_gradient_norm valu clip norm gradient specif valu train leav empti clip num_work number parallel thread use data loader save_weights_everi interv weight model store disk mean store weight epoch default otherwis specifi finetun set ignor mode finetun finetune_modul list model part train finetun part list updat check document model see list avail modul part logger set log_interv interv train loss log default log_tensorboard truefals true write log result tensorboard file default specifi true log_n_figur integ valu greater save predict plot n specif random basin valid save_git_diff set true neuralhydrolog git repositori uncommit chang git diff store run directori use option make sure run data directori either locat insid git repositori part gitignor file otherwis git diff may becom larg use lot disk space make sure everyth configur correctli simpli check output git diff head contain code chang data set dataset defin data set use current support camels_u camel data set newman et al camels_gb gb version camel coxon et al camels_cl cl version camel alvarezgarreton et al hourly_camels_u hourli data camel basin data_dir full rel path root directori data set train_data_fil empti use pickl file path train data use creat data set multipl time save disk space time empti creat new data set option store data run directori save_train_data true cache_validation_data truefals true cach valid data memori time train speed overal train time default true sinc even larger dataset usual gb memori modern machin handl dynamic_input list variabl use time seri input name must match exact name defin data set note case multipl input forc product append forc product behind variabl eg prcpmmday daymet product prcpmmday_daymet train multipl frequenc cf use_frequ possibl defin dynam input frequenc individu dynamic_input must dict map frequenc list variabl eg use precipit daymet daili nldashourli hourli predict dynamic_input prcpmmday_daymet h total_precipitation_nldas_hourli target_vari list target variabl name must match exact name defin data set clip_targets_to_zero option list target variabl clip zero comput metric eg use comput zeroclip metric valid train epoch affect data save disk evalu alway raw model output save result file therefor eventu need manual clip target zero load model output file want reproduc metric valu duplicate_featur use duplic time seri featur eg differ normal either str list dictionari map string int string duplic correspond featur list duplic featur list use dictionari specifi exact number duplic like duplic featur append _copyn n counter start lagged_featur use add lag copi anoth featur list avail inputoutput featur dictionari map string int list int string specifi featur name int number lag time step valu posit neg see panda shift httpspandaspydataorgpandasdocsstablereferenceapipandasdataframeshifthtml__ detail list integ provid uniqu valu consid append _shiftn lag featur n shift count custom_norm dictionari map time seri featur name center andor scale use argument allow overwrit default zero mean unit varianc normal per featur support option center none none mean median min nonenon set center paramet mean featur mean median featur median min featur minimum respect support option scale none none std minmax nonenon set scale paramet std featur standard deviat minmax featur max minu featur min combin center min scale minmax result minmax featur scale rang additional_feature_fil path pickl file list path multipl file contain dictionari key correspond one basin id valu datetim index panda datafram allow option add arbitrari data includ standard data set convent column use static input valu use specif sampl row datetim target discharg valu evolving_attribut column datafram load additional_feature_fil use static featur valu use static input evolv time convent valu use specif input sequenc row datetim last time step sequenc name must match column name datafram leav empti use addit static featur use_basin_id_encod truefals true creat basinonehot encod addit static featur vector sampl static_attribut static attribut use eg static camel attribut camel dataset leav empti none use hydroatla attribut use hydroatlas_attribut instead name must match exact name defin data set hydroatlas_attribut hydroatla attribut use leav empti none use name must match exact name defin data set camel us specif ignor dataset camels_u hourly_camels_u forc either string list string correspond forc product camel data set also support maurer_extend nldas_extend hourly_camels_u nldas_hourli tutori tutori base jupyt notebook host github want run code find notebook exampl folder httpsgithubcomneuralhydrologyneuralhydrologytreemasterexamples__ neuralhydrolog github repositori data prerequisit tutori need data train evalu model exampl use publicli avail camel us dataset docthi tutori dataprerequisit guid download process differ dataset piec explain code expect local folder structur introduct neuralhydrolog your new neuralhydrolog packag docthi tutori introduct place get start walk basic commandlin api usag pattern get train evalu first model ad new model gate recurr unit gru know basic might want add model use gru httpsenwikipediaorgwikigated_recurrent_unit__ model exampl docthi tutori addinggru show add model neuralhydrolog codebas ad new dataset camelscl alway use unit state camel dataset get bore docthi tutori adddataset show add new dataset chilean version camel multitimescal predict one paper httpsarxivorgabs__ introduc multitimescal lstm predict multipl timescal simultan need predict subdaili granular want gener daili hourli predict timescal docthi tutori multitimescal explain get inspect intern lstm model interpret ongo research topic show previou public eg one httpsarxivorgabs__ lstm intern link physic process docthi tutori inspectlstm show extract model intern librari finetun model common way increas model perform deep learn model call finetun first model train larg divers dataset second model finetun actual problem interest docthi tutori finetun show perform finetun librari toctre maxdepth caption content dataprerequisit introduct addinggru adddataset multitimescal inspectlstm finetun loss automodul neuralhydrologytrainingloss member undocmemb showinherit genericdataset automodul neuralhydrologydatasetzoogenericdataset member undocmemb showinherit nhtrain automodul neuralhydrologytrain member undocmemb showinherit toctre maxdepth neuralhydrologytrainingbasetrain neuralhydrologytraininglogg neuralhydrologytrainingloss neuralhydrologytrainingregular neuralhydrologytrainingtrain nhmodelzoo automodul neuralhydrologymodelzoo member undocmemb showinherit toctre maxdepth neuralhydrologymodelzoobasemodel neuralhydrologymodelzoocudalstm neuralhydrologymodelzoocustomlstm neuralhydrologymodelzooealstm neuralhydrologymodelzooembcudalstm neuralhydrologymodelzoofc neuralhydrologymodelzoogru neuralhydrologymodelzoohead neuralhydrologymodelzooinputlay neuralhydrologymodelzoomclstm neuralhydrologymodelzoomtslstm neuralhydrologymodelzooodelstm neuralhydrologymodelzootempl neuralhydrologymodelzootransform transform automodul neuralhydrologymodelzootransform member undocmemb showinherit odelstm automodul neuralhydrologymodelzooodelstm member undocmemb showinherit basedataset automodul neuralhydrologydatasetzoobasedataset member undocmemb showinheritanceembcudalstm automodul neuralhydrologymodelzooembcudalstm member undocmemb showinherit customlstm automodul neuralhydrologymodelzoocustomlstm member undocmemb showinherit util automodul neuralhydrologydatautilsutil member undocmemb showinherit ealstm automodul neuralhydrologymodelzooealstm member undocmemb showinherit basemodel automodul neuralhydrologymodelzoobasemodel member undocmemb showinherit mclstm automodul neuralhydrologymodelzoomclstm member undocmemb showinherit mtslstm automodul neuralhydrologymodelzoomtslstm member undocmemb showinherit camelsgb automodul neuralhydrologydatasetzoocamelsgb member undocmemb showinheritancedischargeinput automodul neuralhydrologydatautilsdischargeinput member undocmemb showinherit tester automodul neuralhydrologyevaluationtest member undocmemb showinherit nh_results_ensembl modul automodul neuralhydrologyutilsnh_results_ensembl member undocmemb showinherit nh_run automodul neuralhydrologynh_run member undocmemb showinherit plot automodul neuralhydrologyevaluationplot member undocmemb showinherit nhdatasetzoo automodul neuralhydrologydatasetzoo member undocmemb showinherit toctre maxdepth neuralhydrologydatasetzoobasedataset neuralhydrologydatasetzoocamelscl neuralhydrologydatasetzoocamelsgb neuralhydrologydatasetzoocamelsu neuralhydrologydatasetzoogenericdataset neuralhydrologydatasetzoohourlycamelsu neuralhydrologydatasetzootempl templatedataset automodul neuralhydrologydatasetzootempl member undocmemb showinheritancepet automodul neuralhydrologydatautilspet member undocmemb showinherit gru automodul neuralhydrologymodelzoogru member undocmemb showinherit neuralhydrolog api automodul neuralhydrolog member undocmemb showinherit toctre maxdepth neuralhydrologydatasetzoo neuralhydrologydatautil neuralhydrologyevalu neuralhydrologymodelzoo neuralhydrologytrain neuralhydrologyutil main entri point toctre maxdepth neuralhydrologynh_run neuralhydrologynh_run_schedul neuralhydrologyutilsnh_results_ensembl logger automodul neuralhydrologytraininglogg member undocmemb showinherit nhutil automodul neuralhydrologyutil member undocmemb showinherit toctre maxdepth neuralhydrologyutilsconfig neuralhydrologyutilsconfigutil neuralhydrologyutilserror regular automodul neuralhydrologytrainingregular member undocmemb showinherit climateindic automodul neuralhydrologydatautilsclimateindic member undocmemb showinherit nhdatautil automodul neuralhydrologydatautil member undocmemb showinherit toctre maxdepth neuralhydrologydatautilsclimateindic neuralhydrologydatautilsdischargeinput neuralhydrologydatautilspet neuralhydrologydatautilsutil inputlay automodul neuralhydrologymodelzooinputlay member undocmemb showinherit head automodul neuralhydrologymodelzoohead member undocmemb showinherit error automodul neuralhydrologyutilserror member undocmemb showinherit config automodul neuralhydrologyutilsconfig member undocmemb showinherit configutil automodul neuralhydrologyutilsconfigutil member undocmemb showinherit signatur automodul neuralhydrologyevaluationsignatur member undocmemb showinherit camelsu automodul neuralhydrologydatasetzoocamelsu member undocmemb showinherit evalu automodul neuralhydrologyevaluationevalu member undocmemb showinherit fc automodul neuralhydrologymodelzoofc member undocmemb showinherit nhevalu automodul neuralhydrologyevalu member undocmemb showinherit toctre maxdepth neuralhydrologyevaluationevalu neuralhydrologyevaluationmetr neuralhydrologyevaluationplot neuralhydrologyevaluationsignatur neuralhydrologyevaluationtest basetrain automodul neuralhydrologytrainingbasetrain member undocmemb showinherit cudalstm automodul neuralhydrologymodelzoocudalstm member undocmemb showinherit templatemodel automodul neuralhydrologymodelzootempl member undocmemb showinherit camelscl automodul neuralhydrologydatasetzoocamelscl member undocmemb showinherit train automodul neuralhydrologytrainingtrain member undocmemb showinherit hourlycamelsu automodul neuralhydrologydatasetzoohourlycamelsu member undocmemb showinheritancenh_run_schedul automodul neuralhydrologynh_run_schedul member undocmemb showinherit metric automodul neuralhydrologyevaluationmetr member undocmemb showinherit