tinker next gener tinker gpu support badg doc statushttpsreadthedocsorgprojectstinkermanualbadgeversionlateststyleflathttpstinkermanualreadthedocsio introduct tinker complet rewrit extens canon tinker softwar current tinker tinker implement c code openacc direct cuda kernel provid excel perform gpu present tinker build object librari tinker provid gpu version tinker analyz bar dynam minim testgrad program exist tinker file format forc field paramet file fulli compat tinker nearli tinker keyword function ident tinker time plan port much remain portion fortran tinker c tinker code base instal step prerequisitesdocmanualminstallpreqrst download canon tinker import get requir versiondocmanualminstalltinkerrst build tinker cmakedocmanualminstallbuildwithcmakerst cite tinker see citationshttpstinkerdocreadthedocsioenlatesttextcitehtml detail user manual progress html version host readthedocshttpstinkermanualreadthedocsio pdfhttpstinkermanualreadthedocsio_downloadsenlatestpdf version access webpag tri merg document tinkerdochttpstinkerdocreadthedocsio featur progress tracker pleas visit github project pagehttpsgithubcomtinkertoolstinkerproject detail use github issueshttpsgithubcomtinkertoolstinkerissu bug track github discussionshttpsgithubcomtinkertoolstinkerdiscuss gener discuss python script use script run bash tinkerdock cudavers stage bash use command tinkerdock h see valid valu cudavers stage step instal docker ubuntu remov old docker version necessari bash sudo apt remov docker dockerengin dockerio containerd runc updat apt bash sudo apt updat sudo apt instal cacertif curl gnupg lsbreleas fix curl packag necessari add docker offici gpg key bash curl fssl httpsdownloaddockercomlinuxubuntugpg sudo gpg dearmor usrsharekeyringsdockerarchivekeyringgpg choos stabl version instal bash echo deb archdpkg printarchitectur signedbyusrsharekeyringsdockerarchivekeyringgpg httpsdownloaddockercomlinuxubuntu lsb_releas cs stabl sudo tee etcaptsourceslistddockerlist devnul sudo apt updat sudo apt instal dockerc dockercecli containerdio instal nvidia contain toolkit bash distribut etcosreleaseecho idversion_id curl l httpsnvidiagithubionvidiadockergpgkey sudo aptkey add curl l httpsnvidiagithubionvidiadockerdistributionnvidiadockerlist sudo tee etcaptsourceslistdnvidiadockerlist sudo apt updat sudo apt instal nvidiacontainertoolkit sudo systemctl restart docker manag docker nonroot user reboot system bash sudo groupadd docker sudo usermod ag docker user sudo reboot index page tinker document master file creat sphinxquickstart fri may adapt file complet like least contain root toctre direct includ mreplacerst tinker user manual toctre caption content maxdepth mintro minstallindex mtutorialindex mfeatindex melecindex mkeyindex toctre caption refer mzref html toctre caption index genindex nbsp unicod ua nonbreak space rad replac rad sup ang unicod uc angstrom ang replac ang sup deg replac deg sup deg replac deg sup deg replac deg sup e replac e sup bohr replac bohr sup pm unicod ub plusminu sign x unicod ud multipl sign role rawlatexraw format latex role rawhtmlraw format html replac rawhtmlspan styletextdecorationlinethrough stylefontvariantsmallcapstinkerspan rawlatexsouttextsctink replac rawhtmlspan styletextdecorationlinethrough stylefontvariantsmallcapstinkerspan rawlatexsouttextsctink introduct html refer bibliographi refsbib cite style unsrtmodifi build tinker cmake configur cmake skip section familar cmake suppos current work directori hometink want creat build directori call buildcmak hometink mkdir buildcmak cd buildcmak toplevel cmakeliststxt file parent directori noth els configur command cmake would gener makefil altern way specifi build sourc directori cmake eg codeblock bash cmake b hometinkerbuildcmak hometink cmake instal also provid command line gui ccmake simpl gui program cmakegui replac cmake command configur compil set cxx cudacxx fc specifi nondefault c cuda fortran compil respect environment variabl support cmake cmake script check custom environment variabl acc gpu code set build script take guess openacc compil acc also use c compil valu cxx set neglect configur tinker follow option pass cmake program default valu one prefix option cmake provid two standard way let user custom valu chang valu interact ccmake command line gui pass new valu cmake via command line argument cmake doptionnewvalu addit two canon method default valu also set correspond environment variabl document env note prefix environment variabl two equival exampl tinker configur follow item valu opt releas host prec cuda_dir usrlocalcuda compute_cap cmakeliststxt locat hometink codeblock bash use environment variabl optreleas host precm cuda_dirusrlocalcuda compute_cap cmake hometink use cmake doption cmake hometink dcmake_build_typereleas dhost dprecm dcuda_dirusrlocalcuda dcompute_cap dcmake_build_typ opt releas standard cmake_build_typ option build type case insensit debug releas relwithdebinfo releas debug info minsizerel minimum size releas dcmake_install_prefix instal default valu instal execut cmake_install_prefix option set make instal configur instal anyth differ default cmake behavior instal program usrloc dstd std c syntax standard sourc code ccompliant problem compil c set user make sure compil ccompliant dprec prec mix precis floatingpoint number flag doubl floatingpoint number treat realdoubl valu realsingl valu flag singl mix precis flag mixedm use real real number differ place note flag chang precis variabl hardcod float doubl type ddeterministic_forc deterministic_forc auto flag use determinist forc featur implicitli enabl mix singl precis explicitli disabl set flag explicitli enabl valu gener evalu energi forc etc twice dont expect get two ident answer may care much differ usual neglig see cosx cosi httpsisocpporgwikifaqnewbiefloatingpointarith_ wherea md two simul initi configur easili diverg due accumul differ whatev reason will elong process inevit diverg cost slightli slower simul speed determinist forc use fixedpoint arithmet help dhost host flag compil gpu valu cpu valu version dcompute_cap compute_cap gpu code cuda comput capabl multipli gpu valid valu noninclus etc commasepar eg multipl comput capabilit increas size execut full list comput capabl found nvidia websit httpsdevelopernvidiacomcudagpus_ dcuda_dir cuda_dir usrlocalcuda gpu code toplevel cuda instal directori directori includ lib lib found option supersed cuda instal identifi offici cudacxx environment variabl sometim pgi compil nvcc compil compat instanc although pgi support cuda default cuda version configur pgi may extern nvcc version one solut pass cuda_homecuda_dir pgi compil case cuda_dir set usrlocalcuda dfftw_dir fftw_dir cmake_binary_dirfftw cpu code toplevel fftw instal includefftwh liblibfftw static librari expect found make tinker follow makefil target gener cmake run make j default target make target j other tinker compil link tinker execut alltest compil link alltest execut default make two target tinker alltest execut default target test run unit test random order exit first error man gener user manual doc gener develop guid prerequisit hardwar rel recent nvidia gpu mandatori gpu code noth special need cpu code oper system compil order compil gpu code recent nvidia hpc sdk httpswwwdevelopernvidiacomhpcsdk_ prefer openacc direct due limit gpu code unavail maco linux need gnu intel fortran compil recent c compil support c syntax gpu code nvidia hpc sdk openacc support cuda nvcc nvidia driver instal correctli nvidiasmi avail success built tinker window wsl ubuntu cuda nvhpc pleas proceed nvidia webpag httpsdocsnvidiacomcudawsluserguideindexhtml_ detail use nvidia hpc sdk cluster prior rebrand current nvidia hpc sdk known pgi compil suit jan work cluster still run red hat gcc default without root privileg although sever recent gcc pgi version avail via modul program recent pgi compil still configur gcc default bad support c sinc didnt root privileg cluster use custom localrc file run follow command reconfigur pgi compil gcc codeblock bash makelocalrc pgilinuxllvm gcc usrlocalgccbingcc gpp usrlocalgccb g usrlocalgccbingfortran dir_for_new_config x ad export pgi_localrcdir_for_new_configlocalrc bash resourc file updat apr compil new brand name nvhpc differ directori structur new command look like codeblock bash makelocalrc nvhpclinux_x_compil gcc usrlocalgccbingcc gpp usrlocalgccb g usrlocalgccbingfortran dir_for_new_config x add export nvlocalrcdir_for_new_configlocalrc shell resourc file fftw librari canon tinker requir fftw librari default compil openmp otherwis tinker use fftpack tinker underli libtinkera compil without openmp therefor fftw librari longer mandatori gpu code howev fftw librari requir cpu code two prebuilt fftw librari libfftw libfftw_thread need doubl precis cpu code two fftw librari libfftwf libfftwf_thread need mix singl precis cpu code nonmandatori util clangformat httpsclangllvmorgdocsclangformathtml_ format sourc code sphinx httpswwwsphinxdocorg_ gener user manual pdf version also depend tex httpswwwtugorgbeginhtml_ html theme pip doxygen httpswwwdoxygennl_ gener develop guid codeblock bash pip instal u sphinx pip instal pydatasphinxthem instal toctre preq tinker buildwithcmak download canon tinker sinc df dec httpsgithubcomtinkertoolstinkercommitdf_ download requir tinker version autom cmake script version prior commit pleas refer follow paragraph deprec use incorrect tinker version execut would like fail segfault sourc code clone git checkout tinker tinker git submodul codeblock bash checkout tinker cd tinker git submodul updat init deprec altern remov directori tinkertink clone tinker github httpsgithubcomtinkertoolstinker_ replac delet directori checkout requir version aad codeblock bash cd tinker rm rf tinker git clone httpsgithubcomtinkertoolstink cd tinker git checkout therequiredvers perman multipol includ replacerst definit unit electrostat potenti r due charg distribut nearbi math label pot phir fracpiepsilon_ int dsfracrhosr dsmathrmdx mathrmdi mathrmdz tinker use variabl electr chgpot modul repres factor mathpiepsilon_ default magnitud constant defin variabl coulomb unit modul unit kcalmol ang default valu modifi electir keyword note valu coulomb document outdat becom inconsist code pleas send us pull request expand mathr taylor seri mathpiepsilon_phir rewritten math label pot leftint dsrhosrightfracr sum_ileftint dsrhoss_irightnabla_ifracr sum_ijleftfracint dsrhoss_i s_jrightnabla_inabla_jfracr cdot three pair squar bracket give set definit monopol charg c dipol quadrupol moment q respect unit multipol moment use tinker paramet file intern calcul differ multipol paramet unit intern unit charg e e dipol e bohr e ang quadrupol e bohr e ang addit differ unit quadrupol moment tinker paramet file use tradit call traceless quadrupol maththeta differ definit q third term eqpot rewritten math sum_ijleftfracint dsrhoss_i s_j sdelta_ijright fracr_i r_jr henc traceless quadrupol defin math theta_ij fracint dsrhoss_i s_j sdelta_ij easi confirm mathsum_kxyz s_k s_k thu math theta_ij q_ij delta_ijsum_kxyzq_kk intern tinker scale maththeta math q theta energi express use q energi torqu gradient potenti energi math label pot u fracpiepsilon_int dsrhosphi potenti energi discret charg distribut eqpot math label pot ur phir cr phir dr phir qr cdot distanc math r_xr_yr_zboldsymbolrr_r_ pairwis atom quadrupol energi math u_ m_t t_ m_ multipol math m_ beginpmatrix c_ d_ q_ endpmatrix m_ beginpmatrix c_ d_ q_ endpmatrix matrix math t_ beginpmatrix nabla_ nabla_ nabla_ nabla_nabla_ nabla_nabla_ nabla_ nabla_nabla_ nabla_nabla_ endpmatrixfracr upper left x element matht_ math t_ time beginpmatrix r r_xr r_yr r_zr r_xr r_xr r r_xr_yr r_xr_zr r_yr r_xr_yr r_yr r r_yr_zr r_zr r_xr_zr r_yr_zr r_zr r endpmatrix ewald summat mathrk term differ form bn neverthelss still connect deriv nonewald ewald mathr mathb_mathrmerfcalpha rr mathr mathb_ mathr mathb_ mathr mathb_ mathr mathb_ mathr mathb_ bn term relat complementari boy function complementari error function mathx mathng math fracmathrmerfxx fracsqrtpif_x fracmathrmerfcxx fracsqrtpif_cx f_nx int_ expxttn dt f_ncx int_infti expxttn dt boy function gener upward downward recurs math f_nx fracxf_nx expxn f_ncx fracxf_ncx expxn energi torqu forc term energi torqu forc c mathphi c na mathphi c mathphi mathphitim mathphi q mathphi q mathphitim q mathphi q math taud phitim time e tau_iq sum_jksum_lxyz epsilon_ijkq_jlphi_kl mathepsilon_ijk levicivita symbol refer citempolepm electrostat toctre mpole polar qi induc dipol energi mathmu induc dipol extern field e induc field due induc dipol matheutmu induc dipol proport total field mathet math mu alpha et alphaeeu mathalpha polariz defin mathtildetalphat induc dipol solut linear equat math label udipol tildetmu e polar energi given math label polar u mu e int_mu dmu tildetmu mu e fracmutildetmu righthand side eqpolar st term contribut extern field nd term mutual self polar energi final polar energi math label polar u fracmu e gradient limit numer precis solut linear equat equdipol fulli precis math label udipol tildetmu epsilon e gradient induc dipol written math mu tildetepsilon e tildetmu polar gradient math u frac emu mu e frac epsilonmutildettildetepsilon e tildetmu mu e approx frac mu e mutildetmu mu e converg equdipol tight mathepsilon mathepsilon term drop conjug gradient tinker use follow conjug gradient algorithm cg spars matrix precondition denot citecgprecond obtain induc dipol relat tinker variabl routin tabul figur figcg width px align center cg term tinker variabl routin mathgamma mathbeta b mathr rsd mathm r zrsd mathp conj mathtildet p vec matht ufield mathm uscal polar model amoeba thole damp amoeba forc field adopt two polar scheme p extern field due perman multipol third scheme u mutual induc dipol interact u scheme groupbas p scheme atom connectivitybas tinker use cg iter solv follow linear equat math alphatumu_d e_d alphatumu_p e_p defin polar energi math label amoebapolar u fracmu_d e_p optimiz perspect eqamoebapolar minimum target function math f_mu_dmu_pfracleftfracmu_dtildetmu_p fracmu_ptildetmu_d e_dmu_pe_pmu_dright wherea way cg code tinker solv minimum anoth target function math f_mu_dmu_pfracleftfracmu_dtildetmu_d fracmu_ptildetmu_p e_dmu_de_pmu_pright differ two target function usual neglig unless loos converg method use comput induc dipol thole damp model charg distribut mathrho use replac point dipol model amoeba adopt second function form math rho fracapiexpau paper citetholedamp u polarizabilitysc distanc electrostat field potenti distanc r obtain gausss law math er phir fracr int_u du pi u rho fracexpaur math phir int_rinfti dr er fraclambda_r fracrleft fracaufracgammafracauright mathlambda_ serv mathb_ term ewald quadrupol interact mathlambda_n term also relat via deriv math phi fracrleftauexpauright phi fracrleftauauexpauright phi fracrleftauauexpauright math phi_i phifracr_ir phi_ij leftphifracphirrightfracr_i r_jr fracphirdelta_ij phi_ijk leftphifracphirfracphirrightfracr_i r_j r_kr leftfracphirfracphirrightfracsum r_k delta_ijr phi_ijkl leftphifracphirfracphirfracphirright fracr_i r_j r_k r_lr leftfracphirfracphirfracphirrightfracsum r_k r_ldelta_ijr leftfracphirfracphirrightsumdelta_kldelta_ij thu math lambda_r phir rightarrow lambda_ expau lambda_r phiphirr rightarrow lambda_ auexpau lambda_r phiphirphirr rightarrow lambda_ leftaufraca urightexpau lambda_r phiphirphirphirr rightarrow lambda_ leftaufraca ufraca urightexpau quasiintern frame _figqifram figur figqifram width px align center global frame g qi frame atom z direct qi frame chosen along distanc vector rotat matrix consid two vector u v two refer frame b r rotat matrix axe math r u_a u_b r v_a v_b sinc mathu_at v_au_bt v_b math rt ri tensor eg quadrupol moment q two refer frame associ math u_at q_a v_a u_bt q_b v_b easi prove math r q_a rt q_b two common transform use tinker local frame paramet provid b global frame calcul done global frame direct pairwis electrostat b quasiintern qi frame optim algebra shown numreffigqifram multipol interact qi frame distanc vector qi frame mani deriv simplifi shown follow tabl fr explicitli depend mathr_xr_yr_z gradient global frame qi frame mathparti frpartial x_ mathfrr_xr mathparti frpartial y_ mathfrr_yr mathparti frpartial z_ mathfrr_zr mathfr potenti energi eqpot use without modif qi frame sinc mathpartialphi_parti z_ e_z z direct gradient obtain z direct electrostat field ez math fracparti uparti ze_z c e_z e_z q cdot torqu comput way previou section math tau tau_ tau_ boldsymbolrtimesboldsymbolf u_xu_yu_ztimesr u_i r u_x r x direct gradient becom math u_x tau_yr u_i tau_xr depend direct distanc vector sign x direct gradient may flip detail follow note matha b stand matha b ambigu mathf mathf may stand mathf_xf_yf_z mathf_xxf_yyf_zzf_xyf_xzf_yz respect potenti term note mathphi_ mathphi_ mathphi_x mathpartialphi_parti x_ mathphi_i mathpartialphi_parti y_ mathphi_z mathpartialphi_parti z_ mathphi_xx mathpartialphi_parti x_ mathphi_yy mathpartialphi_parti y_ mathphi_zz mathpartialphi_parti z_ mathphi_xi mathpartialphi_parti x_partial y_ mathphi_xz mathpartialphi_parti x_partial z_ mathphi_yz mathpartialphi_parti y_partial z_ mathphi_ mathphi_ mathphi_x mathpartialphi_parti x_ mathphi_i mathpartialphi_parti y_ mathphi_z mathpartialphi_parti z_ mathphi_xx mathpartialphi_parti x_ mathphi_yy mathpartialphi_parti y_ mathphi_zz mathpartialphi_parti z_ mathphi_xi mathpartialphi_parti x_partial y_ mathphi_xz mathpartialphi_parti x_partial z_ mathphi_yz mathpartialphi_parti y_partial z_ charg term math phi_ t_ c_ b_ c_ phi_ t_ c_ beginpmatrix r b_ c_ endpmatrix phi_ t_ c_ beginpmatrix b_ c_ b_ c_ b_ r b_ c_ endpmatrix math phi_ t_ c_ b_ c_ phi_ t_ c_ beginpmatrix r b_ c_ endpmatrix phi_ t_ c_ beginpmatrix b_ c_ b_ c_ b_ r b_ c_ endpmatrix math e_z r b_ c_ e_z beginpmatrix b_ r b_ endpmatrix e_z beginpmatrix r b_ c_ r b_ c_ r b_ r b_ c_ endpmatrix dipol term math phi_ t_ d_ r b_ d_z phi_ t_ d_ beginpmatrix b_ d_x b_ d_i b_ r b_ d_z endpmatrix phi_ t_ d_ beginpmatrix r b_ d_z r b_ d_z r b_ r b_ d_z r b_ d_x r b_ d_i endpmatrix math phi_ t_ d_ r b_ d_z phi_ t_ d_ beginpmatrix b_ d_x b_ d_i b_ r b_ d_z endpmatrix phi_ t_ d_ beginpmatrix r b_ d_z r b_ d_z r b_ r b_ d_z r b_ d_x r b_ d_i endpmatrix math e_z b_ r b_ d_z e_z beginpmatrix r b_ d_x r b_ d_i r b_ r b_ d_z endpmatrix e_z beginpmatrix b_ r b_ d_z b_ r b_ d_z b_ r b_ r b_ d_z b_ r b_ d_x b_ r b_ d_i endpmatrix quadrupol term math phi_ t_ q_ r b_ q_zz phi_ t_ q_ beginpmatrix r b_ q_xz r b_ q_yz r b_ r b_ q_zz endpmatrix phi_ t_ q_ beginpmatrix b_ q_xx r b_ q_zz b_ q_yy r b_ q_zz b_ r b_ r b_ q_zz b_ q_xi b_ r b_ q_xz b_ r b_ q_yz endpmatrix math phi_ t_ q_ r b_ q_zz phi_ t_ q_ beginpmatrix r b_ q_xz r b_ q_yz r b_ r b_ q_zz endpmatrix phi_ t_ q_ beginpmatrix b_ q_xx r b_ q_zz b_ q_yy r b_ q_zz b_ r b_ r b_ q_zz b_ q_xi b_ r b_ q_xz b_ r b_ q_yz endpmatrix math e_z r b_ r b_ q_zz e_z beginpmatrix b_ r b_ q_xz b_ r b_ q_yz b_ r b_ r b_ q_zz endpmatrix e_z beginpmatrix r b_ q_yy r b_ q_zz r b_ q_xx r b_ q_zz r b_ r b_ r b_ q_zz r b_ q_xi r b_ r b_ q_xz r b_ r b_ q_yz endpmatrix van der waal potenti function featur method toctre potent potentvdw integr valenc potenti function includ replacerst _labelbond bond stretch bond term empir function bond deviat ideal bond length ie mathdelta b b b_ support amoeba forc field model tinker includ rd th order term math u kdelta b k_delta b k_delta b set rd th order coeffici zero give harmon function form note differ hook law mathu k x tinker usual drop coeffici mors oscil also implement tinker math u d_e expadelta b paramet hardwir approxim follow equat matha sqrtfrack d_e tinker convent includ forc constant de k _labelangl angl bend similar bond stretch angl bend term also empir function angl deviat ideal angl valu ie mathdeltathetathetatheta_ term cubic sextic ad gener harmon function form math u kdeltathetak_deltathetak_deltatheta k_deltathetak_deltatheta mmff forc field special treatment linear angl eg carbon dioxid sinc ideal angl alway mathpi rad deviat approxim math deltathetathetapifracthetafracpisim sinfracthetafracpicosfractheta keep quadrat term angl bend term simplifi math u kcostheta linear angl type special case shapesstyl fourier potenti function citeshapesff fold period refer fourier angl type tinker jargon follow form math u kcosnthetatheta_ addit anoth inplan angl type trigon center atom one project atom point x plane abc instead angl adb ideal actual angl valu angl axb see numreffiganglep _figanglep figur figanglep width px align center trigon center inplan angl _labelstrbnd stretchbend coupl function form bond stretch angl bend stretchbend coupl mm forc field citemmff math u k_delta b_ k_delta b_deltatheta even though forc constant k k implement two independ variabl tinker treat variabl origin literatur _labelurey ureybradley potenti ureybradley potenti energi account nonbond interact cubic quartic term ad harmon function form tinker math u kdelta u k_delta u k_delta u mathdelta u differ distanc deviat ideal valu coeffici k k usual zero _labelopbend outofplan bend tinker implement two type outofplan bend angl wilsondeciuscross formul citewdc outofplan angl mathchi associ bond bd numreffiganglep angl bd plane adc wherea alling formul use angl bd plane abc similar harmon bond stretch follow function form implement tinker math u kchi k_chi k_chi _labelimprop improp dihedr commonli use charmm forc field potenti function meant keep atom planar ideal angl mathphi_ defin dihedr dabc alway zero degre trigon atom abc peripher atom origin charmm paramet file trigon atom often list last cbad improp angl doubl count charmm protein paramet set sinc tinker use one improp paramet per site doubl forc constant tinker version charmm paramet symmetr paramet origin doubl count charmm valu handl tinker packag assign symmetr state use tinker forc constant divid symmetri number harmon function form implement tinker math u kphiphi_ coeffici forc coeffici may differ softwar packag _labelimptor improp torsion commonli use amber forc field defin hypothet torsion angl four atom success bond eg trigon center function form similar proper torsion math u sum_n v_ncosnphidelta_n n period mathdelta_n correspond phase shift _labeltors torsion angl function form implement tinker math u sum_n v_ncosnphidelta_n n period mathdelta_n correspond phase shift _labelpitor piorbit torsion angl fold fourier torsion angl potenti keep piorbit molecular structur eg ethylen planar math u vcosphipi _labelstrtor stretchtors coupl _labelangtor angletors coupl _labeltortor torsiontors coupl potenti energi extrapol predefin map mathphipsi angl integr ensembl _labelmontecarlobarostat mont carlo barostat _labelberendsenbarostat berendsen barostat _labelverlet verlet integr _labelrespa respa integr _labelnosehoov extend noséhoov chain author paper citemtknhc mtk discuss sever method nvt npt ensembl number section mtk method nvt npt isotrop cell fluctuat npt full cell fluctuat xorespa b xirespa b respa b respa b respa isothermalisobar integr implement fortran tinker nptxo aa tip noséhoov chain enabl keyword codeblock text integr nosehoov codeblock text thermostat nosehoov barostat nosehoov npt option dynam program _labellpiston langevin piston langevin piston method constant pressur citelpiston integr leapfrog framework tip langevin piston enabl keyword codeblock text integr lpiston codeblock text thermostat lpiston barostat lpiston npt option dynam program hippo forc field chgtrn integ real dispers integ real molecular dynam ensembl integr verlet respa nosehoov lpiston index integr seealso reflabelverlet reflabelrespa reflabelnosehoov reflabellpiston thermostat nosehoov lpiston index thermostat seealso reflabelnosehoov reflabellpiston barostat montecarlo berendsen nosehoov lpiston index barostat seealso reflabelmontecarlobarostat reflabelberendsenbarostat reflabelnosehoov reflabellpiston keyword section contain detail descript keyword paramet use defin alter cours tinker calcul keyword control file option sens tinker program run absenc keyfil simpli use default valu queri user need inform howev keyword allow use wide varieti algorithm procedur option mani unavail interact keyword read keyword control file program look first keyfil base name input molecular system end extens key file exist tinker tri use gener keyfil name tinkerkey locat directori input system neither systemspecif gener keyfil present tinker continu use default valu keyword option ask interact question necessari tinker search keyfil cours calcul relev keyword may present keyword must appear first word line blank space left keyword ignor content keyfil case insensit keyword take modifi ie tinker look line addit inform valu paramet relat keyword modifi inform read free format must complet contain line origin keyword line contain keyfil qualifi valid keyword line treat comment simpli ignor sever keyword take list integ valu atom number exampl modifi keyword integ simpli list explicitli separ space comma tab rang number desir specifi list neg first number rang follow separ last number rang exampl keyword line ligand could use add atom set ligand atom tinker calcul list avail tinker keyword sort group gener function along brief descript action possibl keyword modifi usag exampl toctre potent restrain hippo dynam fep parallel math valenc potenti includ replacerst bond stretch bondtyp harmon mors index bondtyp choos function form bond stretch potenti harmon option select taylor seri expans contain term harmon quartic mors option select mors potenti fit ideal bond length stretch forc constant paramet valu default use harmon potenti bondterm none index bondterm control use bond stretch potenti energi term absenc modifi option keyword turn use potenti none option turn use potenti energi term option turn potenti energi term except one bondunit real index bondunit set scale factor need convert energi valu comput bond stretch potenti unit kcalmol correct valu forc field depend typic provid header master forc field paramet file default valu use bondunit keyword given forc field paramet file keyfil bond integ real index bond provid valu singl bond stretch paramet integ modifi give atom class number two kind atom involv bond defin real number modifi give forc constant valu kcalmolang bond ideal bond length angstrom exampl follow bond nbsp nbsp b nbsp forc nbsp ideal bondcub real index bondcub set valu ang cubic term taylor seri expans form bond stretch potenti energi real number modifi give valu coeffici multipl quadrat coeffici term multipli bond stretch energi unit convers factor forc constant cube deviat bond length ideal valu give cubic contribut bond stretch energi default valu absenc bondcub keyword zero ie cubic bond stretch term omit bondquart real index bondquart set valu ang quartic term taylor seri expans form bond stretch potenti energi real number modifi give valu coeffici multipl quadrat coeffici term multipli bond stretch energi unit convers factor forc constant forth power deviat bond length ideal valu give quartic contribut bond stretch energi default valu absenc bondquart keyword zero ie quartic bond stretch term omit seealso reflabelbond angl bend angleterm none index angleterm control use bond angl bend potenti energi term absenc modifi option keyword turn use potenti none option turn use potenti energi term option turn potenti energi term except one angleunit real index angleunit set scale factor need convert energi valu comput bond angl bend potenti unit kcalmol correct valu forc field depend typic provid header master forc field paramet file default valu mathpi use angleunit keyword given forc field paramet file keyfil angl integ real index angl provid valu singl bond angl bend paramet integ modifi give atom class number three kind atom involv angl defin real number modifi give forc constant valu angl three ideal bond angl degre case one ideal bond angl given valu use occurr specifi bond angl three ideal angl given valu appli central atom angl attach addit hydrogen atom respect hydrogen environ option provid implement correspond featur alling mm forc field default unit forc constant kcalmolrad control via angleunit keyword exampl follow angl nbsp nbsp c nbsp nbsp forc nbsp ideal anglef integ real index anglef provid valu singl bond angl bend paramet shapesstyl fourier potenti function integ modifi give atom class number three kind atom involv angl defin real number modifi give forc constant valu angl angl shift degre period valu note forc constant given harmon valu nativ fourier valu default unit forc constant kcalmolrad control via angleunit keyword exampl follow anglef nbsp nbsp c nbsp nbsp forc nbsp ideal nbsp period anglep integ real index anglep provid valu singl project inplan bond angl bend paramet integ modifi give atom class number three kind atom involv angl defin real number modifi give forc constant valu angl two ideal bond angl degre case one ideal bond angl given valu use occurr specifi bond angl two ideal angl given valu appli central atom angl attach addit hydrogen atom respect hydrogen environ option provid implement correspond featur alling mm forc field default unit forc constant kcalmolrad control via angleunit keyword exampl follow anglep nbsp nbsp c nbsp nbsp forc nbsp ideal anglecub real index anglecub set valu deg cubic term taylor seri expans form bond angl bend potenti energi real number modifi give valu coeffici multipl quadrat coeffici term multipli angl bend energi unit convers factor forc constant cube deviat bond angl ideal valu give cubic contribut angl bend energi default valu absenc anglecub keyword zero ie cubic angl bend term omit anglequart real index anglequart set valu deg quartic term taylor seri expans form bond angl bend potenti energi real number modifi give valu coeffici multipl quadrat coeffici term multipli angl bend energi unit convers factor forc constant forth power deviat bond angl ideal valu give quartic contribut angl bend energi default valu absenc anglequart keyword zero ie quartic angl bend term omit anglepent real index anglepent set valu deg fifth power term taylor seri expans form bond angl bend potenti energi real number modifi give valu coeffici multipl quadrat coeffici term multipli angl bend energi unit convers factor forc constant fifth power deviat bond angl ideal valu give pentic contribut angl bend energi default valu absenc anglepent keyword zero ie pentic angl bend term omit anglesext real index anglesext set valu deg sixth power term taylor seri expans form bond angl bend potenti energi real number modifi give valu coeffici multipl quadrat coeffici term multipli angl bend energi unit convers factor forc constant sixth power deviat bond angl ideal valu give sextic contribut angl bend energi default valu absenc anglesext keyword zero ie sextic angl bend term omit seealso reflabelangl stretchbend coupl strbndterm none index strbndterm control use bond stretchingangl bend cross term potenti energi absenc modifi option keyword turn use potenti none option turn use potenti energi term option turn potenti energi term except one strbndunit real index strbndunit set scale factor need convert energi valu comput bond stretchingangl bend cross term potenti unit kcalmol correct valu forc field depend typic provid header master forc field paramet file default valu mathpi use strbndunit keyword given forc field paramet file keyfil strbnd integ real index strbnd provid valu singl stretchbend cross term potenti paramet integ modifi give atom class number three kind atom involv angl defin real number modifi give forc constant valu first bond first two atom class angl second bond angl respect default unit stretchbend forc constant kcalmolangrad control via strbndunit keyword exampl follow strbnd nbsp nbsp c nbsp nbsp forc nbsp forc seealso reflabelstrbnd ureybradley potenti ureyterm none index ureyterm control use ureybradley potenti energi term absenc modifi option keyword turn use potenti none option turn use potenti energi term option turn potenti energi term except one ureyunit real index ureyunit set scale factor need convert energi valu comput ureybradley potenti unit kcalmol correct valu forc field depend typic provid header master forc field paramet file default valu use ureyunit keyword given forc field paramet file keyfil ureybrad integ real index ureybrad provid valu singl ureybradley cross term potenti paramet integ modifi give atom class number three kind atom involv angl ureybradley term defin real number modifi give forc constant valu term target valu distanc angstrom default unit forc constant kcalmolang control via ureyunit keyword exampl follow ureybrad nbsp nbsp c nbsp nbsp forc nbsp ideal ureycub real index ureycub set valu ang cubic term taylor seri expans form ureybradley potenti energi real number modifi give valu coeffici multipl quadrat coeffici default valu absenc ureycub keyword zero ie cubic ureybradley term omit ureyquart real index ureyquart set valu ang quartic term taylor seri expans form ureybradley potenti energi real number modifi give valu coeffici multipl quadrat coeffici default valu absenc ureyquart keyword zero ie quartic ureybradley term omit seealso reflabelurey outofplan bend opbendtyp wdc alling index opbendtyp set type angl use outofplan bend potenti energi term choic use wilsondeciuscross wdc formul vibrat spectroscopi alling angl mmmm forc field default valu absenc opbendtyp keyword use wdc angl opbendterm none index opbendterm control use outofplan bend potenti energi term absenc modifi option keyword turn use potenti none option turn use potenti energi term option turn potenti energi term except one opbendunit real index opbendunit set scale factor need convert energi valu comput outofplan bend potenti unit kcalmol correct valu forc field depend typic provid header master forc field paramet file default mathpi use opbendunit keyword given forc field paramet file keyfil opbend integ real index opbend provid valu singl outofplan bend potenti paramet first integ modifi atom class outofplan atom second integ atom class central trigon atom third fourth integ give atom class two remain atom attach trigon atom valu zero third fourth integ treat wildcard repres atom type real number modifi give forc constant valu outofplan angl default unit forc constant kcalmolrad control via opbendunit keyword exampl follow opbend nbsp b nbsp nbsp nbsp forc opbendcub real index opbendcub set valu deg cubic term taylor seri expans form outofplan bend potenti energi real number modifi give valu coeffici multipl quadrat coeffici term multipli outofplan bend energi unit convers factor forc constant cube deviat outofplan angl zero give cubic contribut outofplan bend energi default valu absenc opbendcub keyword zero ie cubic outofplan bend term omit opbendquart real index opbendquart set valu deg quartic term taylor seri expans form outofplan bend potenti energi real number modifi give valu coeffici multipl quadrat coeffici term multipli outofplan bend energi unit convers factor forc constant forth power deviat outofplan angl zero give quartic contribut outofplan bend energi default valu absenc opbendquart keyword zero ie quartic outofplan bend term omit opbendpent real index opbendpent set valu deg fifth power term taylor seri expans form outofplan bend potenti energi real number modifi give valu coeffici multipl quadrat coeffici term multipli outofplan bend energi unit convers factor forc constant fifth power deviat outofplan angl zero give pentic contribut outofplan bend energi default valu absenc opbendpent keyword zero ie pentic outofplan bend term omit opbendsext real index opbendsext set valu deg sixth power term taylor seri expans form outofplan bend potenti energi real number modifi give valu coeffici multipl quadrat coeffici term multipli outofplan bend energi unit convers factor forc constant sixth power deviat outofplan angl zero give sextic contribut outofplan bend energi default valu absenc opbendsext keyword zero ie sextic outofplan bend term omit seealso reflabelopbend improp dihedr impropterm none index impropterm control use charmmstyl improp dihedr angl potenti energi term absenc modifi option keyword turn use potenti none option turn use potenti energi term option turn potenti energi term except one impropunit real index impropunit set scale factor need convert energi valu comput charmmstyl improp dihedr angl potenti unit kcalmol correct valu forc field depend typic provid header master forc field paramet file default valu mathpi use impropunit keyword given forc field paramet file keyfil improp integ real index improp provid valu singl charmmstyl improp dihedr angl paramet integ modifi give atom class number four kind atom involv torsion defin real number modifi give forc constant valu deviat target improp torsion angl target valu torsion angl respect default unit improp forc constant kcalmolrad control via impropunit keyword real number modifi give forc constant kcalmolrad ideal dihedr angl degre exampl follow improp nbsp nbsp nbsp b nbsp c nbsp forc nbsp ideal seealso reflabelimprop improp torsion imptorterm none index imptorterm control use amberstyl improp torsion angl potenti energi term absenc modifi option keyword turn use potenti none option turn use potenti energi term option turn potenti energi term except one imptorunit real index imptorunit set scale factor need convert energi valu comput amberstyl improp torsion angl potenti unit kcalmol correct valu forc field depend typic provid header master forc field paramet file default valu use imptorsunit keyword given forc field paramet file keyfil imptor integ realrealinteg tripl index imptor provid valu singl amberstyl improp torsion angl paramet first four integ modifi give atom class number atom involv improp torsion angl defin convent third atom class four trigon atom improp torsion center torsion angl comput liter defin four atom class order specifi keyword remain tripl realrealinteg modifi give halfamplitud kcalmol phase offset degre period particular improp torsion term respect period fold allow improp torsion paramet exampl follow imptor nbsp nbsp b nbsp c nbsp nbsp amplitud nbsp phaseoffset nbsp period seealso reflabelimptor torsion angl torsionterm none index torsionterm control use torsion angl potenti energi term absenc modifi option keyword turn use potenti none option turn use potenti energi term option turn potenti energi term except one torsionunit real index torsionunit set scale factor need convert energi valu comput torsion angl potenti unit kcalmol correct valu forc field depend typic provid header master forc field paramet file default valu use torsionunit keyword given forc field paramet file keyfil torsion integ realrealinteg tripl index torsion provid valu singl torsion angl paramet first four integ modifi give atom class number atom involv torsion angl defin remain tripl realrealinteg modifi give amplitud kcalmol phase offset degre period particular torsion function term respect period fold allow torsion paramet exampl follow torsion nbsp nbsp b nbsp c nbsp nbsp amplitud nbsp phaseoffset nbsp period seealso reflabeltors piorbit torsion angl pitorsterm none index pitorsterm control use piorbit torsion angl potenti energi term absenc modifi option keyword turn use potenti none option turn use potenti energi term option turn potenti energi term except one pitorsunit real index pitorsunit set scale factor need convert energi valu comput piorbit torsion angl potenti unit kcalmol correct valu forc field depend typic provid header master forc field paramet file default valu use pitorsunit keyword given forc field paramet file keyfil pitor integ real index pitor provid valu singl piorbit torsion angl potenti paramet two integ modifi give atom class number atom involv central bond torsion angl parameter real modifi give valu fold fourier amplitud kcalmol torsion angl porbit center defin bond atom class default unit stretchtors forc constant control via pitorsunit keyword exampl follow pitor nbsp nbsp b nbsp amplitud seealso reflabelpitor stretchtors coupl reflabelstrtor strtorterm none index strtorterm control use bond stretchingtorsion angl cross term potenti energi absenc modifi option keyword turn use potenti none option turn use potenti energi term option turn potenti energi term except one strtorunit real index strtorunit set scale factor need convert energi valu comput bond stretchingtorsion angl cross term potenti unit kcalmol correct valu forc field depend typic provid header master forc field paramet file default valu use strtorunit keyword given forc field paramet file keyfil strtor index strtor provid valu singl stretchtors cross term potenti paramet two integ modifi give atom class number atom involv central bond torsion angl parameter real modifi give valu stretchtors forc constant torsion angl defin atom class central bond default unit stretchtors forc constant control via strtorunit keyword angletors coupl angtorterm none index angtorterm control use angl bendingtorsion angl cross term absenc modifi option keyword turn use potenti none option turn use potenti energi term option turn potenti energi term except one angtorunit real index angtorunit set scale factor need convert energi valu comput angl bendingtorsion angl cross term unit kcalmol correct valu forc field depend typic provid header master forc field paramet file default valu mathpi use angtorunit keyword given forc field paramet file keyfil angtor integ real index angtor provid valu singl bond angl bendingtorsion angl paramet integ modifi give atom class number four kind atom involv torsion contain angl real number modifi give forc constant valu angl coupl fold torsion term default unit forc constant kcalmolrad control via angtorunit keyword seealso reflabelangtor torsiontors coupl tortorterm none index tortorterm control use torsiontors potenti energi term absenc modifi option keyword turn use potenti none option turn use potenti energi term option turn potenti energi term except one tortorunit real index tortorunit set scale factor need convert energi valu comput torsiontors potenti unit kcalmol correct valu forc field depend typic provid header master forc field paramet file default valu use tortorunit keyword given forc field paramet file keyfil tortor integ multipl line integ real index tortor provid valu singl torsiontors paramet first five integ modifi give atom class number atom involv two adjac torsion angl defin last two integ modifi contain number data grid point lie along axi torsiontors map exampl valu degre torsion angl space ie valu requir sinc data valu degre must suppli subsequ line contain torsiontors map data integ valu degre torsion angl target energi valu kcalmol seealso reflabeltortor free energi osrwel osrwlambda real set intern logic flag osrw true provid initi valu lambda osrwtor osrwvdw rotatablebond integ list parallel includ replacerst cudadeivc integ index cudadevic index cuda_devic follow integ valu start set cudaen gpu devic program valu overwritten environ variabl cuda_devic instanc node four cuda devic cuda_visible_devic environ variabl part cuda librari set cuda_visible_devic mean two cuda devic avaiabl thu valid valu cudadevic gpupackag cuda openacc index gpupackag index gpu_packag select code path gpu algorithm cuda openacc version implement default valu cuda valu overwritten environ variabl gpu_packag mathemat algorithm randomse integ index randomse follow integ valu set initi seed valu random number gener use tinker set randomse valu earlier run allow exact reproduct earlier calcul note hold across differ machin type randomse set posit integ less billion absenc randomse keyword seed chosen randomli base upon number second elaps current decad constraint restraint includ replacerst restrainterm none index restrainterm control use restraint potenti energi term absenc modifi option keyword turn use potenti none option turn use potenti energi term option turn potenti energi term except term restrainangl integ real index restrainangl implement flatwel harmon potenti use restrain angl three atom lie within specifi angl rang integ modifi contain atom number three atom whose angl restrain first real modifi forc constant kcalmoldeg restraint last two real modifi give lower upper bound degre allow angl valu angl lie lower upper bound restraint potenti zero outsid bound harmon restraint appli angl rang modifi omit atom restrain angl found input structur forc constant also omit default valu use restraindist integ real index restraindist implement flatwel harmon potenti use restrain two atom lie within specifi distanc rang integ modifi contain atom number two atom restrain first real modifi specifi forc constant kcalmolang restraint next two real modifi give lower upper bound angstrom allow distanc rang interatom distanc lie lower upper bound restraint potenti zero outsid bound harmon restraint appli distanc rang modifi omit atom restrain interatom distanc found input structur forc constant also omit default valu use restraingroup integ real index restraingroup implement flatwel harmon distanc restraint centersofmass two group atom integ modifi number two group must defin separ via group keyword first real modifi forc constant kcalmolang restraint last two real modifi give lower upper bound angstrom allow intergroup centerofmass distanc valu distanc rang modifi omit group restrain distanc found input structur forc constant also omit default valu use restrainplan xyz integ real index restrainplan provid abil restrain individu atom specifi plane orthogon coordin axi first modifi give axi x z perpendicular restraint plane integ modifi contain atom number atom restrain first real number modifi give coordin valu atom restrain along specifi axi second real modifi set forc constant kcalmolang harmon restraint potenti final real modifi defin rang specifi plane within restraint valu zero forc constant omit default valu use exclus rang omit taken zero restrainposit integ real integ real index restrainposit provid abil restrain atom group atom specifi coordin posit initi posit integ modifi contain atom number atom restrain first three real number modifi give x zcoordin atom tether fourth real modifi set forc constant kcalmolang harmon restraint potenti final real modifi defin sphere around specifi coordin within restraint valu zero coordin omit atom restrain origin forc constant omit default valu use exclus sphere radiu omit taken zero altern initi integ modifi neg second integ read follow two real number modifi atom rang absolut valu first integ second integ restrain current coordin first real modifi harmon forc constant kcalmolang second real defin sphere around atom within restraint valu zero forc constant omit default valu use exclus sphere radiu omit taken zero restraintors integ real index restraintors implement flatwel harmon potenti use restrain torsion angl four atom lie within specifi angl rang initi integ modifi contain atom number four atom whose torsion angl comput atom order list restrain first real modifi give forc constant kcalmoldeg restraint last two real modifi give lower upper bound degre allow torsion angl valu angl valu given wrap around across degre outsid allow angl rang harmon restraint appli angl rang modifi omit atom restrain torsion angl found input structur forc constant also omit default valu use program dynam program minim tutori let creat directori tutori home directori copi directori tinkerexampl tinkerparam codeblock text zwblade mkdir tutori cd tutori zwbladetutori cp r tinkerexampleparam zwbladetutori ls exampl param zwbladetutori cd exampl ls arkey dhfrkey dhfrkey dhfrseq arxyz dhfrxyz dhfrpdb dhfrxyz tutori also assum execut tinker path prefix directori tinker execut toctre filetyp cmdgui analyz minim dynam command line gui tinker program take interact input prompt messag tri selfexplanatori follow exampl use interact interfac short dhfr simul amoeba forc field warn simul run unless keyword ad key file demonstr interact interfac item valu input coordin file dhfrxyz dhfrxyz simul step time step fs time save ps ensembl nvt thermostat temperatur k codeblock text zwbladetutorialexampl tinker dynam tinker softwar tool molecular design version rc jan right reserv compil feb commit date wed feb commit bc enter cartesian coordin file name dhfrxyz joint ambercharmm benchmark dihydrofol reductas water atom ang cube ang nonbond cutoff xx pme enter number dynam step taken enter time step length femtosecond enter time save picosecond avail statist mechan ensembl microcanon nve canon nvt isoenthalpicisobar nph isothermalisobar npt enter number desir choic enter desir temperatur degre k familar interact interfac simpli append interact input program name codeblock text zwbladetutorialexampl tinker dynam dhfrxyz tinker softwar tool molecular design version rc jan right reserv compil feb commit date wed feb commit bc joint ambercharmm benchmark dihydrofol reductas water atom ang cube ang nonbond cutoff xx pme also use stdin redirect run tinker program save command line argument file use follow codeblock text zwbladetutorialexampl cat argstxt dhfrxyz zwbladetutorialexampl tinker dynam argstxt program analyz common file type find xyz key file exampl directori prm file param directori samplexyz xyz file basic tinker cartesian coordin file type contain titl line follow one line atom structur line contain sequenti number within structur atom symbol name x zcoordin forc field atom type number atom list atom connect current atom except program whose basic oper torsion space tinker calcul done version xyz format samplekey keyword paramet file alway extens key option present tinker calcul contain valu wide varieti switch paramet use chang cours comput default detail content file explain latter section molecular system specif keyfil case samplekey present tinker program look directori gener file name tinkerkey sampleprm potenti energi paramet file distribut tinker packag end extens prm although requir program file contain definit potenti energi function form forc field well valu individu energi paramet exampl mmproprm file contain energi paramet definit need proteinspecif version mm forc field