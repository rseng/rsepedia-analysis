titl cmfast v pythonintegr c code gener realiz cosmic cm signal tag python astronomi cosmolog simul author name steven g murray orcid affili name bradley greig orcid affili name andrei mesing orcid affili name julian b mu√±oz orcid affili name yuxiang qin orcid affili name jaehong park orcid affili name catherin watkinson orcid affili affili name school earth space explor arizona state univers phoenix usa index name arc centr excel allski astrophys dimens astro index name school physic univers melbourn parkvil vic australia index name scuola normal superior piazza dei cavalieri pisa itali index name depart physic harvard univers oxford st cambridg usa index name school physic astronomi queen mari univers london g jone build mile end road london e ns uk index name school physic korea institut advanc studi hoegiro dongdaemungu seoul republ korea index date sep bibliographi paperbib summari field cm cosmolog hyperfin spectral line neutral hydrogen appear restfram wavelength cm map larg swath univers histori develop radic last decad promis field revolution knowledg first star galaxi black hole time pattern imprint cosmic cm signal order interpret eventu observ data rang physic model develop simpl analyt model global histori hydrogen reioniz fulli hydrodynam simul evolut bright temperatur spectral line extrem lie especi versatil middleground fast seminumer model approxim full evolut relev field densiti veloc temperatur ioniz radiat lymanalpha neutral hydrogen cm etc advantag compar full firstprincipl hydrodynam simul significantli quicker run much use produc thousand realiz scale compar observ upcom lowfrequ radio telescop order explor wide paramet space still remain consist data amongst practition field cm cosmolog cmfast program becom de facto standard seminumer simul cmfast mesing mesing highperform c code use excurs set formal furlanetto identifi region ioniz hydrogen atop cosmolog densiti field evolv use first secondord lagrangian perturb theori zeldovich scoccimarro track thermal ioniz state intergalact medium comput xray soft uv ioniz uv cosmic radiat field base parametr galaxi model exampl follow figur contain slice lightcon field one axi correspond spatial tempor evolut variou compon field produc cmfast sampl compon field output cmfast cosmic evolut occur bottom top left right quantiti shown dark matter overdens field ii lymanalpha flux iii lymanwern flux iv xray heat rate v locallyaverag uvb vi critic halo mass star format atom cool galaxi vii critic halo mass star format molecularli cool galaxi viii cumul number recombin per baryon ix neutral hydrogen fraction x cm bright temperatur highresolut version figur avail httphomepagesnsitmesingermedialightcones_minihalopngyuxiangsplotsmallpngheightpx howev cmfast highli special code implement quit specif rel inflex inflex make difficult modifi behaviour code without detail knowledg full system disrupt work lack modular within code led widespread code branch research hack new physic featur interest c code lack streamlin api led deriv code run multipl realiz cmfast simul mont carlo simul cmmc greig rewrit larg portion code order serv purpos thu critic import field move forward understand rang scale physic model interest continu increas reformul cmfast code order provid fast modular welldocu welltest stabl simul commun featur cmfast v paper present cmfast v formul follow essenti guid principl keep core function previou version cmfast fulli integr python packag simpl intuit interfac great deal flexibl higher level order maintain best practic commun user develop coalesc formal collabor maintain project via github organ allow code consist monitor qualiti maintain high test coverag stylist integr depend releas strategi version peer code review also provid singl pointofrefer commun obtain code report bug request new featur get involv develop signific part work move python interfac develop robust seri underli python structur handl pass data python c via cffi librari foundat work provid platform futur version extend scientif capabl underli simul code primari new usabl featur cmfast v conveni python data object simplifi access process variou field form bright temperatur enhanc modular underli c function step simul decoupl arbitrari function inject process convers global paramet local struct enabl modular also obviat requir recompil order chang paramet simpl pipbas instal robust ondisk cachingwrit data effici simplifi read previous process data use hdf simpl highlevel api gener either coeval cube pure spatial field defin particular time full lightcon data ie coeval cube interpol cosmic time mimick actual observ improv except handl debug conveni plot routin simpl configur manag also intuit manag remain c global variabl comprehens api document tutori comprehens test suit continu integr strict semant versioninghttpssemverorg v focus establish stabl extend infrastructur also incorpor sever new scientif featur appear separ paper gener transfer function use class boltzmann code lesgourgu simul effect rel veloc dark matter baryon munoza munozb correct nonconserv ioniz photon park greig et al prep includ molecularli cool galaxi distinct properti qin calcul restfram uv luminos function base parametr galaxi model cmfast still activ develop amongst usabl perform improv futur version see sever new physic model implement includ millicharg dark matter model munoz forwardmodel cmb auxiliari data qina addit cmfast incorpor largescal infer code cmmc use creat larg dataset infer via machin learn hope new framework cmfast remain import compon cm cosmolog year come exampl cmfast support instal use conda mean instal simpl type conda instal c condaforg cmfast follow exampl run python interpret indepth exampl found offici document exampl simplic full lightcon may produc new cmfast v follow may run python interpret jupyt notebook python import pycmfast pc lightcon pcrun_lightcon redshift minimum redshift lightcon max_redshift user_param hii_dim n cell along side output cube dim origin highr cell number box_len size simul mpc flag_opt use_ts_fluct true dont assum satur spin temp inhomo_reco true use inhomogen recombin lightcone_quant compon store lightcon brightness_temp xh_box densiti global_quant compon store mean xh_box valu per redshift brightness_temp save uniqu filenam hash input paramet lightconesav make lightcon sliceplot pcplottinglightcone_sliceplotlightcon brightness_temp bright temperatur lightcon produc exampl code paperlightconepdfheightpx python plot global quantiti pcplottingplot_global_historylightcon xh global volumeaverag hydrogen neutral fraction produc exampl code paperxh_historypdfheightpx perform despit python code cmfast v diminish perform previou purec version utilis cffi provid interfac ccode python manag custom python class overse construct memori alloc c struct openmp parallel enabl within ccode provid excel speedup larg simul perform highperform machin simpl perform comparison v v last purec version run lightcon simul redshift rang snapshot spin temperatur fluctuat use_ts_fluct inhomogen recombin inhomo_reco fftw wisdom use_fftw_wisdom interpol tabl use_interpolation_t resolut hii_dim cell dim cell initi condit intelr xeonr cpu el v ghz sharedmemori core reveal clock time hour maximum ram gigabyt need vv note full lightcon simul expens perform take min calcul coeval box exclud initi condit instanc aforement time v includ minut gener initi condit also domin maximum ram requir addit minut per snapshot calcul requir field perturb ioniz spin temperatur bright temperatur guid user list perform benchmark variat simul run cmfast v note benchmark subject chang new minor version deliv particular oper mode reduc maximum memori consumpt plan near futur variat time hr memori gb refer singl core sharedmemori core sharedmemori core higher resolut br hii_dim dim lower resolut br hii_dim dim spin temperatur use minihalo fftw wisdom time cmfast team suggest use fewer sharedmemori core howev worth note perform vari differ machin user recommend calcul scalabl acknowledg work support part european research council erc european union horizon research innov programm aida result present reflect author view erc respons use jbm partial support nsf grant ast part research support european research council erc grant number firstdawn part research support australian research council centr excel sky astrophys dimens astro project number ce jp support part kia individu grant pg korea institut advanc studi refer