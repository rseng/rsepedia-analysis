merfin improv variant filter polish via kmer valid instal requir git v gcc v omp parallel git clone httpsgithubcomarangrhiemerfingit cd merfinsrc make j instal meryl merylutil clone submodul meryl merfin instal merfinbuildbin instal take less minut typic comput recommend genomescop httpsgithubcomtbenavigenomescop polish assembl evalu run merfin _more detail exampl expect run time found wikihttpsgithubcomarangrhiemerfinwikibestpracticesformerfin pleas read run merfin_ merfin use filter variant call accur genotyp filter refer anoth individu ie grch assess collaps duplic region assembl hist dump qv scaffold assembl hist k complet complet filter variant call polish polish refer individu determin kmer copi number except filter mode haploiddiploid peak estim must provid peak obtain kmer histogram comput use tool genomescop httpsgithubcomtbenavigenomescop kcov valu rule thumb peak chosen haploid peak partiallyphas assembl primari altern haplotig fullyphas assembl ie triobin triohifiasm diploid ie twice haploid peak pseudohaploid assembl haploid represent diploid genom addit peak recommend provid lookup tabl kmer multipl fit copi number probabl prob lookup tabl gener fitted_hist option ad genomescop httpsgithubcomtbenavigenomescop probabl estim copi kmer multipl priorit estim peak provid fit probabl significantli improv accuraci analys download instal run genomescop use follow option rscript genomescop kmer_histogram k k_size output_fold p ploidi fitted_hist ploidi verbos kmer_histogram tabdelimit column file genomescop usual gener meryl hist jellyfish k_size kmer length use histogram ploidi haploiddiploid default fitted_hist gener fit hist plot lookup_tabletxt assess collaps duplic output dump convert wigbw track visual igv ucsc genom browser shell awk beginprint track autoscaleonifchrchr print variablestep chromchr spanifprintf tn dump_output dump_outputwig gener chromosom size awk nr print c cprintf substr clength end print c genomefasta chrsize convert bigwig wigtobigwig dump_outputwig chrsize dump_outputbw assess correl data type multipl data type eg hifi illumina genomewid k agreement assess gener cartesian plot use output dump script scriptscartesian_plot assess per base qv merfin quickli produc merquryhttpsgithubcommarblmerquri qv estim scaffold genomewid averag hist use merquri qv estim consid kmer miss read set addit merfin produc qv estim account also kmer seen excess respect expect multipl predict read analys refin lookup tabl provid prob miss kmer includ plausibl low frequenc kmer copi kmer multipl estim weight probabl multipl estim correct filter variant call polish input vcf suppli polish option includ variant pass merfin screen filter vcf gener assembl polish bcftool view oz merfin_outputpolishvcf merfin_outputpolishvcfgz bgzip merfin output bcftool index merfin_outputpolishvcfgz bcftool consensu merfin_outputpolishvcfgz f assemblyfasta h polished_assemblyfasta h appli first allel gt posit merfin still activ develop feel free reach us question helper cd buildbin merfin usag merfin reporttyp sequenc seqfasta readmer readmeryl peak haploid_peak prob lookup_t vcf inputvcf output output predict kmer consequ variant call inputvcf given consensu sequenc seqfasta lookup kmer multipl consensu sequenc seqmeryl read readmeryl input sequenc vcf file fasta fastq uncompress gz bz xz compress readmer filter valu advanc filter requir new databas construct use meryl min ignor kmer valu max ignor kmer valu thread multithread meryl lookup tabl construct dump hist memori usag limit within reason sacrif kmer lookup speed lookup tabl requir memori allow program exit error memori dont use gb memori load mer k base evalu polish peak requir option prob peak requir input hard set copi infer multipl copi number recommend prob file option input vector probabl adjust multipl copi number case prob peak provid prob take higher prioriti peak multipl list vector tabl default seqfastameryl gener unless seqmer provid seqmer seqmeryl option input prebuilt sequenc meryl db exactli one report type must specifi filter filter variant within distanc k combin miss kmer assum refer sequenc differ individu requir sequenc readmer vcf output option comb n set max n combin variant evalu default nosplit without option combin larger n split debug output debug log outputthread_iddebuggz output outputfiltervcf variant chosen polish score variant variant within distanc k combin k assum refer sequenc individu requir sequenc readmer peak vcf output option comb n set max n combin variant evalu default nosplit without option combin larger n split prob file use probabl adjust multipl copi number recommend debug output debug log outputthread_iddebuggz output outputpolishvcf variant chosen use bcftool view oz outputpolishvcf bcftool consensu h f seqfata polish first alt heterozyg allel usual better support avg k hist gener center k histogram sequenc inputfasta posit k valu expect collaps copi neg k valu expect expand copi closer mean expect found kmer well balenc requir sequenc readmer peak output option prob file use probabl adjust multipl copi number recommend output k tab frequenc report qv end stderr dump dump readk asmk k per base kmer inputfasta requir sequenc readmer peak output option skipmiss skip miss kmer site print prob file use probabl adjust multipl copi number recommend output seqnam tab seqpo tab readk tab asmk tab k seqnam name sequenc kmer seqpo start posit base kmer sequenc readk normal read copi read multipl peak asmk assembl copi found seqmeryl k center k valu complet comput kmer complet use expect copi number kmer requir seqmer sequenc readmer peak option prob file use probabl adjust multipl copi number recommend output total kmer read number kmer expect copi number complet option output debug filter polish outputthread_iddebuggz use info debug seqnam tab varmerstart tab varmerend tab varmerseq tab score tab path varmerid uniqu number start varmerrang seqnamestartend posit base variant includ sequenc upstream downstream k bp varmerseq combin variant sequenc evalut nummiss total number miss kmer min k minimum k nonmiss kmer kmer miss max k maximum k nonmiss kmer kmer miss median k median k nonmiss kmer kmer miss avg k averag k nonmiss kmer kmer miss avg refalt k differ refer altern averag k delta kmer multipl cumul sum kmer multipl variat posit valu impli recov kmer neg valu impli overrepres kmer introduc record vcf record tab replac space nonrefer allel print gt acknowledg code develop part tt consortium chmpolish work group follow individu giulio formenti arang rhie brian walenz sergey koren adam phillippi special thank support integr fitted_hist option genomescop rhyker ranallobenavidez michael schatz gener lookup tabl discountin follow main readm instead script lookupr base genomescop httpqbcshledugenomescopegenomescop addit canon genomescop output gener fit read multipl valu probabl lookup_tabletxt given merfin lookup option gener accur k estim rscript lookupr kmer_histogram k_size output_fold ploidi verbos kmer_histogram tabdelimit column file genomescop usual gener meryl hist jellyfish k_size kmer length use histogram ploidi haploiddiploid default varmer variant evalu make sure vcf sort alreadi sort sort jvarkit cat inputvcf java jar sortvcfonrefjar r referencefasta sortedvcf gener purpos onelin sometim need append someth scaffold name fasta vcf eg distinguish parent haplotyp trio assembl use onelin sed stigdigit_mat