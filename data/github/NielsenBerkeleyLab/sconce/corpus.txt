sconc directori program sconc singl cell copi number cancer preprint httpswwwbiorxivorgcontentv depend sconc written c requir gnu make test v g test boost test v gsl test v addit r scriptsscript requir r test v ggplot test v reshap test v cowplot test v scale test v sconc develop test ubuntu instal instruct clone repo git clone gitgithubcomnielsenberkeleylabsconcegit run make build intermedi build directori creat execut name sconc option run sconc test file brief paramet descript sconc diploid file averag read depth across diploid cell gener use scriptsavgdiploidrscriptsavgdiploidr tumor file per window read depth tumor cell analyz meanvarcoeffil file defin coeffici relationship mean varianc neg binomi distribut use emiss probabl gener use scriptsfitmeanvarrlnshprscriptsfitmeanvarrlnshpr outputbas give basenam output filesoutputfil maxkploid give maximum allow ploidi recommend k input file tumor read depth file tab separ column chrtstarttendtreaddepth see simulationsreadmemdsimulationsreadmemd gener simul format real data tool like bedtool coveragehttpsbedtoolsreadthedocsioenlatestcontenttoolscoveragehtml use creat file bam file exampl chr chr chr chr chr chr chr chr chr chr averag diploid read depth file tab separ column chrtstarttendtmeanreaddepthtvarianceofreaddepth gener use scriptsavgdiploidrscriptsavgdiploidr given file provid list path observ diploid read depth exampl rscript scriptsavgdiploidr testdiploidfilelist testtest_healthy_avgb produc follow output head testtest_healthy_avgb chr chr chr chr chr chr chr chr chr chr mean varianc coeffici file one paramet valu pair per line gener use scriptsfitmeanvarrlnshprscriptsfitmeanvarrlnshpr exampl rscript scriptsfitmeanvarrlnshpr testdiploidfilelist testtestmeanvar produc follow output cat testtestmeanvar intercept slope poli exampl test run ensur sconc built script run correctli includ test file run follow time sconc diploid testtest_healthy_avgb tumor testtest_cancer_cellb meanvarcoeffil testtestmeanvar outputbas testtest_output_k maxkploid testtest_output_klog testtest_output_kerr output except time inform match provid testref file output file sconc creat follow file automat outputhmm file contain state hmm baum welch step state hmm bfg step outputb file contain copi number call tab separ bed format chrtstarttendtploidi outputviterbidecod tab separ file contain copi number call detail column coord chrstartend diploid_mean diploid_vari tumor observ tumor read count ploidy_k ploidi call rang k note file creat saveviterbidecod flag use sconc also print log messag stdout error messag stderr verbos flag use debug statement print stderr genom trace plot use includ scriptsplotgenometracerscriptsplotgenometrac script argument script arg pathtohealthyaveragebedfil arg pathtoobservedtumorreaddepthsbedfil arg pathtosconceoutputbedfil arg pathtooutputplot arg quot text plot titl ex sampl name arg option pathtogroundtruthploidybedfil ie simul use test file produc follow plot rscript scriptsplotgenometrac testtest_healthy_avgb testtest_cancer_cellb testtest_output_kb testtest_output_kpng genom trace sconc k testtrue_cancer_cellb refer genom tracetestref_k_simu_cancer_cell_png simul compil run simul program see simulationsreadmemdsimulationsreadmemd sconce_sim file describ simul program sconc compil compil program run make depend includ gener simul dataset run run sconce_sim infil paramfil option random seed creat follow file current work directori simu_cancer_cell_ observ read depth cancer cell simu_healthy_cell_ observ read depth healthi cell true_cancer_cell_ true ploidi cancer cell true_healthy_cell_ true ploidi healthi cell convert simu__cel file dummi genom coordin hg similar coordin first creat bin file refer genom format tab separ chrtstarttend make sure paramfil specifi number bin refer genom run past pathtoreferencebinfil awk print pathtosimufil awk beginofst print pathtooutput paramet file format line infil paramfil argument ignor ie good comment format infil vari line segment bin model line segment model infil format flag lineseg model genom length tumor cell flag coalesc simul healthi cell rate delet rate amplif mean delet length mean amplif length length edg lead root tree length simul time singl cell paramet growth rate model hudson slatkin alpha valu correspond neutral coalesc simul bin model infil format flag bin model genom length tumor cell flag coalesc simul healthi cell maximum ploidi k geometr distribut paramet probabl stop transit matrix must k row k col row must sum length edg lead root tree length simul time singl cell paramet growth rate model hudson slatkin alpha valu correspond neutral coalesc simul publish simul set use paramfil format paramfil format bin divid genom paramet r neg binomi must integ converg poisson r goe infin total expect number read note observ number random flag even coverag expect account cna exampl paramet file paramet file sconc paper dataset includ inputfil directori reproduc simul set use paramfiletxt set ad line segment model ek bin model note set b whole genom duplic cna requir call makediploidgenomenogapsdupl instead makediploidgenomenogap sconce_simc uncom makediploidgenomenogapsdupl line comment makediploidgenomenogap line recompil includ test file paramet set seed tumor cell cell