fateid algorithm fateid random forestsbas algorithm quantif fate bias multipot progenitor e probabl differenti toward particular cell lineag util singl cell express data design work well quantit singlecel rnaseq data incorpor uniqu molecular identifi fateid requir genebycel express matrix input group cell represet commit stage advanc differenti stage lineag access multipot progenitor popul socal target cluster defin cluster partit also directli gener fateid list specif marker gene lineag given instal download unzip unzip fateidmasterzip instal command line r cmd instal fateidmast directli r sourc installpackagesfateidmasterrepo null typesourc r start directori fateidzip download otherwis specifi full path altern instal r directli github use devtool installpackagesdevtool librarydevtool install_githubdgrunfateid run fateid analysi load packag libraryfateid see vignett detail exampl vignettefateid refer herman js sagar grün fateid infer cell fate bia multipot progenitor singlecel rnaseq data nat method may doi nmeth titl fateid refer manual date r sysdat output html_document vignett vignetteindexentryan introduct fateid vignetteengineknitrrmarkdown vignetteencodingutf r echofals knitropts_chunksetfigwidth figheight prerequisit manual explain run fateid algorithm sampl data fateid method quantif cell fate bia singl cell transcriptom dataset compris differ cell type emerg common progenitor fateid progenitor popul expect part dataset fateid algorithm design learn preexist bia progenitor cell one multipl altern termin fate strategi algorithm appli iter random forest classif randomforest order quantifi fate bia increasingli naiv progenitor use cell classifi previou iter train set fateid directli instal cran r eval fals installpackagesfateid instal fateid packag load r libraryfateid follow section describ applic fateid sampl data explain input return argument fateid function detail sinc extens descript avail man page function input data algorithm requir express data frame input cell column gene featur column name expect correspond cell id row name expect correspond gene id exampl data avail fateid packag dataset import order reproduc analysi refer manual r dataintestin dataset contain transcript count mous intestin epitheli cell posit lgrlineag report day lineag trace stemid e cell day old progeni lgrposit intestin stem cell r x intestinex headx moreov fateid requir partit cell gener cluster method exampl raceid algorithm use identifi cell cluster partit gener method provid part packag partit provid vector integ valu compon name correspond column name express data frame r intestiney headi cluster analysi inform presenc matur cell type dataset cell type distinct lineag correspond differ cluster e differ number partit exampl data cluster number compris enterocyt mark high express alpi gene cluster repres matur paneth cell high express defa cluster matur goblet cell high express clca rare cell type present low number therefor exclud analysi input fateid endpoint differenti trajectori e matur stage distinct cell lineag data set defin vector integ number repres correspond cluster partit r tar c partit cell type state prior cluster analysi avail fateid deriv partit base marker gene inform strategi list marker gene id need compon list contain one marker gene distinct lineag r fmarker listcdefa__chrdefa__chr clca__chr alpi__chr xf getpartxfmarkerfthrnulln headxfpart headxftar tar xftar xfpart getpart function extract top n cell express marker one lineag highli defin express threshold averag express across cell infer express level aggreg across marker lineag target cluster lineag given ensembl cell aggreg marker gene express higher threshold altern vector threshold express valu lineag also provid input argument fthr target cluster number reflect order compon fmarker list start cluster number compris remain cell exhibit marker gene express beyond mean expres top n cell express marker level fthr respect target cluster defin fateid option reclassifi remain cell use cell within target cluster input r rc reclassifyx tar clthr nbfactor usedistfals seed nbtreenul q rcpart function return partit novel assign reclassif replac previou partit base origin target cluster purpos step identifi cell pronounc bia toward one fate step option recommend obtain larger train set random forest function execut express data prior featur select sampl data data frame x contain gene variabl exceed background level combin technic biolog nois infer raceid altern full data frame contain gene use input r v intestinev rc reclassifyv tar clthr nbfactor usedistfals seed nbtreenul q rcpart reclassifi function also perform featur select base import sampl e featur import larger qquantil import distribut given class retain reduc express tabl return function replac origin input express data frame r x rcxf util function recommend input data subject featur select method featur select also perform util differenti gene express analysi r x getfeatvytarfpv function compar gene express within cell target cluster ensembl remain cell identifi gene significantli upregul target cluster pvalu lower fpv function return reduc express data frame use subsequ analysi gener reclassifi function recommend featur select sinc reflect inform use random forest classif comput fate bia core function fateid comput fate bia cell dataset exclud cell within target cluster cell assign lineag repres respect target cluster probabl one probabl chang infer fate bia cell r tar c x intestinex intestiney fb fatebiasx tar znull minnr minnrh adapttru confid nbfactor usedistfals seed nbtreenul apart featur select express data frame x partit vector target cluster tar fatebia function take argument input option argument z celltocel distanc matrix util identifi nonclassifi cell immedi neighborhood cell classifi one target cluster previou iter default distanc matrix comput zcorx distanc measur prefer distanc matrix provid argument fateid algorithm comput fatebia function perform iter calcul start set cell repres target cluster target cluster minnr neighbor cell shortest median distanc cell target cluster extract ensembl neighbor cell target cluster repres test set next iter minnr paramet thu control step size algorithm iter minnr cell time number target cluster classifi contribut train set next iter train set iter compris cell assign one target cluster respons vector given partit cell classif test set done base random forest vote cell receiv significantli random forest vote one target cluster versu cluster base sampl statist pvalu threshold assign target cluster contribut train set next iter cell without signific fate bia toward one target cluster incorpor train set next iter howev fraction vote interpret fate probabl record store cell anoth import paramet control cell contribut train set given iter minnrh cell target cluster contribut train set cell select minnrh cell shortest distanc cell within current train set paramet control gene express horizon differenti trajectori taken account classif test set minnrh set inf previous classifi cell signific fate bia one target cluster contribut train set howev gene express chang follow complex dynam along differenti trajectori becom detriment includ distant cell express matur marker express earliest stage differenti gener advis confin express horizon smaller valu order increas specif algorithm howev train set still larg enough warrant confid classif rule thumb minnrh paramet set larger valu depend size coverag dataset input data set larg larg number cell avail dataset lineag cover entir differenti trajectori paramet increas recommend test robust result chang minnrh step size minnr select base similar consider howev gener recommend keep number lower order avoid misclassif due insuffici resolut major dataset sever hundr cell use minnr minnrh fateid also permit dynam test set size minnr paramet adapt separ target cluster base classif success previou iter adapttru number success classifi cell determin iter ie number cell minimum fraction vote given confid paramet target cluster gave rise inclus cell test set weight deriv divid number maximum across target cluster ad pseudocount test set size minnr rescal cluster respect weight next iter lead decreas test set size henc slower classif previou classif success local neighbourhood low adapt scheme import number cell differ branch exhibit larg differ classif short branch reach naïv compart classif succ expect decreas progress branch futur iter slow classif matur stage highli popul branch still progress full speed altern approach fateid algorithm offer classif base distanc cell usedist set true distanc matrix z corx interpret featur matrix remain argument control paramet random forest algorithm usual adjust outlin man packag fatebia function return list five compon vote compon data frame random forest vote cell target cluster column name given concaten number target cluster row name given cell id prob compon structur vote cell normal one order repres fate probabl tr compon list vector vector contain cell id cell signific fate bia toward correspond target cluster signific fate bia mean significantli vote given cluster cluster base sampl statist pvalu fourth compon vector cell id order random forest iter classifi last compon list random forest object produc function randomforest randomforest packag object iter visual fate bia variou dimension reduct method commonli use singl cell transcriptom analysi order visual inspect cell popul structur fateid packag comput number dimension reduct represent enabl visual fate bia pseudotempor order princip curv comput r dr compdrx znull mctsnecmdumap k llen tsneperplex seed first two input paramet one fatebia function paramet k indic dimens dimension reduct represent comput typic one want inspect data visual two three dimens howev possibl also comput dimension reduct three dimens inspect data project onto subset dimens remain paramet main control paramet variou algorithm use dimension reduct function perform comput tsne map tsne use rtsne packag classic multidimension scale use cmdscale stat packag local linear embed use lle function lle packag umap comput umap packag speed comput subset dimension reduct represent select input paramet result plot plotfatemap function dimension reduct represent highlight partit plot dimension reduct algorithm dimens comput compdr exampl umap plot two dimens r plotfatemapydrkmumap plot three dimens open interact rgl devic allow rotat plot zoom r evalfals plotfatemapydrkmumap fate bia highlight dimension reduct represent provid name target cluster addit argument concaten cluster number eg fatebia output r plotfatemapydrkmumapfbfbgt approxim differenti trajectori princip curv comput dimension reduc space comput princip curv given target cluster cell contribut fraction random forest vote target cluster larger trthr argument given cell contribut signific bia target cluster comparison other pvalu deriv sampl statist princip curv plot map return function argument prc true r pr plotfatemapydrkmumaptrthrfbfbprctru naiv cluster repres common upstream progenitor cell type known number cluster also given input argument start order initi princip curv comput princip curv start start cluster end one target cluster enforc princip curv travers cell popul repres respect target cluster weight cell within initi target cluster increas fold princip curv comput princip curv comput return object plotfatemap list two object first argument pr list princip curv object target cluster comput principalcurv function princurv packag second argument trc list vector cell id princip curv target cluster contain id cell signific fate bia fate bia greater trthr respect cell id order posit along princip curv obtain point shortest distanc curv express gene aggreg express across group gene also highlight dimension reduct represent provid vector respect gene id addit paramet g option titl n plot express data data frame x use full one instead reduc one r v intestinev pr plotfatemapi dr k mumap gcdefa__chr defa__chr ndefa xv final ge list fb return fatebia function provid input function plot entropi fate bia base probabl differ target cluster entropi level fate bia indic level multipot larger fate bia entropi correspond multipot cell state execut ge function return vector fate bia entropi cell r e plotfatemapydrkmumapgefbfb head princip curv also comput directli without call plotfatemap function r pr prcurveyfbdrkmumaptrthrstart function input argument plotfatemap invok plotfatemap function inspect pseudotempor gene express chang fateid also provid function visual analysi pseudotempor gene express chang purpos cell fate bia toward target cluster extract princip curv analysi return cell along differenti trajectori pseudotempor order exampl cell fate bia toward cluster pseudotempor order extract follow command r n prtrct altern publish method pseudotempor order eg monocl censu diffus pseudotim dpt use select cell cell fate probabl second step input express data defin r v intestinev fs filtersetvnnminexprminnumb use full express data frame v without featur select second argument vector cell id correspond valid row name express tabl pseudotempor order filterset function use elimin lowli express gene trajectori subsequ analysi two addit argument discard gene express level minexpr higher least minnumb cell function return filter express data frame gene row cell column order input vector n third step selforgan map som pseudotempor express profil comput r sd getsomfsnbalpha map provid group similar express profil modul first input argument express data frame case use filter express tabl gener filterset function retain gene express trajectori consider pseudotempor express profil along differenti trajectori interest comput smoothen local regress smooth paramet alpha function return list follow three compon som object return function som packag som data frame x smoothen normal express profil data frame zs zscore transform pseudotempor express profil som process anoth function group node som larger modul produc addit zscore transform bin express data frame display r ps procsomsdcorthrminsom first input argument given som comput function getsom function two addit input paramet control group som node larger modul paramet corthr defin correl threshold correl zscore averag normal pseudotempor express profil neighbor node som exce threshold gene neighbor node merg larger modul modul least minsom gene kept function return list variou data frame normal zscoretransform bin express along assign gene modul som see help page detail output process som plot use plotheatmap function first order highlight cluster partit color scheme use plotfatemap gener altern function execut arbitrari userdefin scheme r fcol samplerainbowmaxi differ output data frame procsom function plot averag zscore modul deriv som r plotheatmappsnodesz xpartyn xcolfcol ypartuniquepsnod xgridfals ygridtru xlabfals zscore profil gene order som modul r plotheatmappsallz xpartyn xcolfcol ypartpsnod xgridfals ygridtru xlabfals normal express profil gene order som modul r plotheatmappsal xpartyn xcolfcol ypartpsnod xgridfals ygridtru xlabfals binar express profil gene zscore zscore zscore r plotheatmappsallb xpartyn xcolfcol ypartpsnod xgridfals ygridtru xlabfals order inspect gene within individu modul som gene extract given number modul modul number contain return argument node procsom function extract e g modul number r g namespsnodespsnod averag pseudotempor express profil group plot function plotexpress r plotexpressionf g n colfcol namenod clusterfals alpha typesnul way possibl plot express profil individu gene eg r plotexpressionf clca__chr n colfcol clusterfals alpha typesnul also possibl highlight data point specif symbol exampl reflect batch use type argument r plotexpressionf g n colfcol namenod clusterfals typessub_dn see help page detail explan input paramet final individu loesssmooth profil set gene plot graph normal sum express across cell one order display gene scale r group headg plotexpressionprofilef group n namenod clusterfals see help page detail explan input paramet differenti gene express analysi togeth fateid function differenti gene express analysi provid function implement approach similar deseq deseq neg binomi distribut fit transcript count two popul repres instanc two differ cell type default function execut normal data estim dispers paramet polynomi fit logtransform transcript count varianc function logtransform mean express done input data either pool cell two popul popul separ altern one also provid function variancemean depend input paramet e g depend comput raceid stemid outlier identif anoth option function also execut standard deseq deseq differenti express analysi run analysi express data frame need input togeth two vector cell id correspond subset column name data frame exampl function could use identifi gene differenti express cell origin cluster progenitor compart either bias toward enterocyt cluster goblet cell cluster fateprob r thr b cl c rownamesfbprobsfbprobsa thr aya cl b rownamesfbprobsfbprobsb thr b byb cl de diffexpnbvaabbdeseqfalsenormfalsevfitnulllocregfals use full express data frame without featur select input normal perform sinc v alreadi normal size chosen input paramet diffexpnb infer dispers paramet neg binomi transcript level distribut two popul base variancemean depend deriv raceid stemid altern local regress util locreg equal true anoth option run deseq deseq analysi deseq true function return list three compon result differenti gene express analysi store re compon data frame display mean express two set fold chang log foldchang two set pvalu differenti express pval benjaminihochberg correct fals discoveri rate padj result plot follow function r plotdiffgenesnbdemthrlthranameabnamebpadjfals inspect fate bia gene express enabl inspect fatespecif marker gene express fateid provid function plot express level two gene scatter plot gene could instanc repres marker two differ lineag function reveal whether express domain gene fall distinct cluster whether correl fate bia toward particular lineag visual correl gene express domain cluster origin cell genegen function call gene express data frame cluster partit input r genegeneintestinevintestineymuc__chrapoa__chr fate bia toward particular target cluster e g cluster highlight output fb fatebia function column name fbprob correspond target cluster e requir addit input paramet r genegeneintestinev intestiney muc__chr apoa__chr fbfb tnt plotnumfals see help page addit input argument identifi gene involv earli prime fate decis stage differenti inform extract gene high import valu see detail randomforest function randomforest packag classif given target cluster least one random forest iter r k impgenesfbt function requir output object fatebia function number target cluster concaten input addit option argument specifi cutoff import valu see help page return list two object one data frame mean import valu gene pass threshold least iter row iter column correspond data frame standard deviat import valu function also plot heatmap import valu hierarch cluster gene bug report question relat fateid pleas email directli linkmailtodominicgruengmailcom refer refer id fateid type articlejourn author famili herman given j famili sagar given famili grün given issu year month titl fateid infer cell fate bia multipot progenitor singlecel rnaseq datanocas containertitl nat method page volum issu id censu type articlejourn author famili qiu given x famili hill given famili packer given j famili lin given famili given famili trapnel given c issu year month titl singlecel mrna quantif differenti analysi censusnocas containertitl nat method page volum issu id stemid type articlejourn author famili grun given famili muraro given j famili boisset given j c famili wiebrand given k famili lyubimova given famili dharmadhikari given g famili born given droppingparticl van den famili es given j droppingparticl van famili jansen given e famili clever given h famili kone given e j p droppingparticl de famili oudenaarden given droppingparticl van issu year month titl de novo predict stem cell ident use singlecel transcriptom datanocas containertitl cell stem cell page volum issu id deseq type articlejourn author famili ander given famili huber given w issu year titl differenti express analysi sequenc count datanocas containertitl genom biol page r volum issu id deseq type articlejourn author famili love given famili huber given w famili ander given issu year titl moder estim fold chang dispers rnaseq data deseqnocas containertitl genom biol page volum issu id randomforest type articlejourn author famili breiman given l issu year titl random forestsnocas containertitl mach learn page volum issu id tsne type articlejourn author famili maaten given l droppingparticl van der famili hinton given g issu year titl visual data use tsnenocas containertitl j mach learn page volum id dpt type articlejourn author famili haghverdi given l famili buttner given famili wolf given f famili buettner given f famili thei given f j issu year month titl diffus pseudotim robustli reconstruct lineag branchingnocas containertitl nat method page volum issu id destini type articlejourn author famili anger given p famili haghverdi given l famili buttner given famili thei given f j famili marr given c famili buettner given f issu year month titl destini diffus map largescal singlecel data rnocas containertitl bioinformat page volum issu titl fateid refer manual date r sysdat output html_document vignett vignetteindexentryan introduct fateid vignetteengineknitrrmarkdown vignetteencodingutf r echofals knitropts_chunksetfigwidth figheight prerequisit manual explain run fateid algorithm sampl data fateid method quantif cell fate bia singl cell transcriptom dataset compris differ cell type emerg common progenitor fateid progenitor popul expect part dataset fateid algorithm design learn preexist bia progenitor cell one multipl altern termin fate strategi algorithm appli iter random forest classif randomforest order quantifi fate bia increasingli naiv progenitor use cell classifi previou iter train set fateid directli instal cran r eval fals installpackagesfateid instal fateid packag load r libraryfateid follow section describ applic fateid sampl data explain input return argument fateid function detail sinc extens descript avail man page function input data algorithm requir express data frame input cell column gene featur column name expect correspond cell id row name expect correspond gene id exampl data avail fateid packag dataset import order reproduc analysi refer manual r dataintestin dataset contain transcript count mous intestin epitheli cell posit lgrlineag report day lineag trace stemid e cell day old progeni lgrposit intestin stem cell r x intestinex headx moreov fateid requir partit cell gener cluster method exampl raceid algorithm use identifi cell cluster partit gener method provid part packag partit provid vector integ valu compon name correspond column name express data frame r intestiney headi cluster analysi inform presenc matur cell type dataset cell type distinct lineag correspond differ cluster e differ number partit exampl data cluster number compris enterocyt mark high express alpi gene cluster repres matur paneth cell high express defa cluster matur goblet cell high express clca rare cell type present low number therefor exclud analysi input fateid endpoint differenti trajectori e matur stage distinct cell lineag data set defin vector integ number repres correspond cluster partit r tar c partit cell type state prior cluster analysi avail fateid deriv partit base marker gene inform strategi list marker gene id need compon list contain one marker gene distinct lineag r fmarker listcdefa__chrdefa__chr clca__chr alpi__chr xf getpartxfmarkerfthrnulln headxfpart headxftar tar xftar xfpart getpart function extract top n cell express marker one lineag highli defin express threshold averag express across cell infer express level aggreg across marker lineag target cluster lineag given ensembl cell aggreg marker gene express higher threshold altern vector threshold express valu lineag also provid input argument fthr target cluster number reflect order compon fmarker list start cluster number compris remain cell exhibit marker gene express beyond mean expres top n cell express marker level fthr respect target cluster defin fateid option reclassifi remain cell use cell within target cluster input r rc reclassifyx tar clthr nbfactor usedistfals seed nbtreenul q rcpart function return partit novel assign reclassif replac previou partit base origin target cluster purpos step identifi cell pronounc bia toward one fate step option recommend obtain larger train set random forest function execut express data prior featur select sampl data data frame x contain gene variabl exceed background level combin technic biolog nois infer raceid altern full data frame contain gene use input r v intestinev rc reclassifyv tar clthr nbfactor usedistfals seed nbtreenul q rcpart reclassifi function also perform featur select base import sampl e featur import larger qquantil import distribut given class retain reduc express tabl return function replac origin input express data frame r x rcxf util function recommend input data subject featur select method featur select also perform util differenti gene express analysi r x getfeatvytarfpv function compar gene express within cell target cluster ensembl remain cell identifi gene significantli upregul target cluster pvalu lower fpv function return reduc express data frame use subsequ analysi gener reclassifi function recommend featur select sinc reflect inform use random forest classif comput fate bia core function fateid comput fate bia cell dataset exclud cell within target cluster cell assign lineag repres respect target cluster probabl one probabl chang infer fate bia cell r tar c x intestinex intestiney fb fatebiasx tar znull minnr minnrh adapttru confid nbfactor usedistfals seed nbtreenul apart featur select express data frame x partit vector target cluster tar fatebia function take argument input option argument z celltocel distanc matrix util identifi nonclassifi cell immedi neighborhood cell classifi one target cluster previou iter default distanc matrix comput zcorx distanc measur prefer distanc matrix provid argument fateid algorithm comput fatebia function perform iter calcul start set cell repres target cluster target cluster minnr neighbor cell shortest median distanc cell target cluster extract ensembl neighbor cell target cluster repres test set next iter minnr paramet thu control step size algorithm iter minnr cell time number target cluster classifi contribut train set next iter train set iter compris cell assign one target cluster respons vector given partit cell classif test set done base random forest vote cell receiv significantli random forest vote one target cluster versu cluster base sampl statist pvalu threshold assign target cluster contribut train set next iter cell without signific fate bia toward one target cluster incorpor train set next iter howev fraction vote interpret fate probabl record store cell anoth import paramet control cell contribut train set given iter minnrh cell target cluster contribut train set cell select minnrh cell shortest distanc cell within current train set paramet control gene express horizon differenti trajectori taken account classif test set minnrh set inf previous classifi cell signific fate bia one target cluster contribut train set howev gene express chang follow complex dynam along differenti trajectori becom detriment includ distant cell express matur marker express earliest stage differenti gener advis confin express horizon smaller valu order increas specif algorithm howev train set still larg enough warrant confid classif rule thumb minnrh paramet set larger valu depend size coverag dataset input data set larg larg number cell avail dataset lineag cover entir differenti trajectori paramet increas recommend test robust result chang minnrh step size minnr select base similar consider howev gener recommend keep number lower order avoid misclassif due insuffici resolut major dataset sever hundr cell use minnr minnrh fateid also permit dynam test set size minnr paramet adapt separ target cluster base classif success previou iter adapttru number success classifi cell determin iter ie number cell minimum fraction vote given confid paramet target cluster gave rise inclus cell test set weight deriv divid number maximum across target cluster ad pseudocount test set size minnr rescal cluster respect weight next iter lead decreas test set size henc slower classif previou classif success local neighbourhood low adapt scheme import number cell differ branch exhibit larg differ classif short branch reach naïv compart classif succ expect decreas progress branch futur iter slow classif matur stage highli popul branch still progress full speed altern approach fateid algorithm offer classif base distanc cell usedist set true distanc matrix z corx interpret featur matrix remain argument control paramet random forest algorithm usual adjust outlin man packag fatebia function return list five compon vote compon data frame random forest vote cell target cluster column name given concaten number target cluster row name given cell id prob compon structur vote cell normal one order repres fate probabl tr compon list vector vector contain cell id cell signific fate bia toward correspond target cluster signific fate bia mean significantli vote given cluster cluster base sampl statist pvalu fourth compon vector cell id order random forest iter classifi last compon list random forest object produc function randomforest randomforest packag object iter visual fate bia variou dimension reduct method commonli use singl cell transcriptom analysi order visual inspect cell popul structur fateid packag comput number dimension reduct represent enabl visual fate bia pseudotempor order princip curv comput r dr compdrx znull mctsnecmdumap k llen tsneperplex seed first two input paramet one fatebia function paramet k indic dimens dimension reduct represent comput typic one want inspect data visual two three dimens howev possibl also comput dimension reduct three dimens inspect data project onto subset dimens remain paramet main control paramet variou algorithm use dimension reduct function perform comput tsne map tsne use rtsne packag classic multidimension scale use cmdscale stat packag local linear embed use lle function lle packag umap comput umap packag speed comput subset dimension reduct represent select input paramet result plot plotfatemap function dimension reduct represent highlight partit plot dimension reduct algorithm dimens comput compdr exampl umap plot two dimens r plotfatemapydrkmumap plot three dimens open interact rgl devic allow rotat plot zoom r evalfals plotfatemapydrkmumap fate bia highlight dimension reduct represent provid name target cluster addit argument concaten cluster number eg fatebia output r plotfatemapydrkmumapfbfbgt approxim differenti trajectori princip curv comput dimension reduc space comput princip curv given target cluster cell contribut fraction random forest vote target cluster larger trthr argument given cell contribut signific bia target cluster comparison other pvalu deriv sampl statist princip curv plot map return function argument prc true r pr plotfatemapydrkmumaptrthrfbfbprctru naiv cluster repres common upstream progenitor cell type known number cluster also given input argument start order initi princip curv comput princip curv start start cluster end one target cluster enforc princip curv travers cell popul repres respect target cluster weight cell within initi target cluster increas fold princip curv comput princip curv comput return object plotfatemap list two object first argument pr list princip curv object target cluster comput principalcurv function princurv packag second argument trc list vector cell id princip curv target cluster contain id cell signific fate bia fate bia greater trthr respect cell id order posit along princip curv obtain point shortest distanc curv express gene aggreg express across group gene also highlight dimension reduct represent provid vector respect gene id addit paramet g option titl n plot express data data frame x use full one instead reduc one r v intestinev pr plotfatemapi dr k mumap gcdefa__chr defa__chr ndefa xv final ge list fb return fatebia function provid input function plot entropi fate bia base probabl differ target cluster entropi level fate bia indic level multipot larger fate bia entropi correspond multipot cell state execut ge function return vector fate bia entropi cell r e plotfatemapydrkmumapgefbfb head princip curv also comput directli without call plotfatemap function r pr prcurveyfbdrkmumaptrthrstart function input argument plotfatemap invok plotfatemap function inspect pseudotempor gene express chang fateid also provid function visual analysi pseudotempor gene express chang purpos cell fate bia toward target cluster extract princip curv analysi return cell along differenti trajectori pseudotempor order exampl cell fate bia toward cluster pseudotempor order extract follow command r n prtrct altern publish method pseudotempor order eg monocl censu diffus pseudotim dpt use select cell cell fate probabl second step input express data defin r v intestinev fs filtersetvnnminexprminnumb use full express data frame v without featur select second argument vector cell id correspond valid row name express tabl pseudotempor order filterset function use elimin lowli express gene trajectori subsequ analysi two addit argument discard gene express level minexpr higher least minnumb cell function return filter express data frame gene row cell column order input vector n third step selforgan map som pseudotempor express profil comput r sd getsomfsnbalpha map provid group similar express profil modul first input argument express data frame case use filter express tabl gener filterset function retain gene express trajectori consider pseudotempor express profil along differenti trajectori interest comput smoothen local regress smooth paramet alpha function return list follow three compon som object return function som packag som data frame x smoothen normal express profil data frame zs zscore transform pseudotempor express profil som process anoth function group node som larger modul produc addit zscore transform bin express data frame display r ps procsomsdcorthrminsom first input argument given som comput function getsom function two addit input paramet control group som node larger modul paramet corthr defin correl threshold correl zscore averag normal pseudotempor express profil neighbor node som exce threshold gene neighbor node merg larger modul modul least minsom gene kept function return list variou data frame normal zscoretransform bin express along assign gene modul som see help page detail output process som plot use plotheatmap function first order highlight cluster partit color scheme use plotfatemap gener altern function execut arbitrari userdefin scheme r fcol samplerainbowmaxi differ output data frame procsom function plot averag zscore modul deriv som r plotheatmappsnodesz xpartyn xcolfcol ypartuniquepsnod xgridfals ygridtru xlabfals zscore profil gene order som modul r plotheatmappsallz xpartyn xcolfcol ypartpsnod xgridfals ygridtru xlabfals normal express profil gene order som modul r plotheatmappsal xpartyn xcolfcol ypartpsnod xgridfals ygridtru xlabfals binar express profil gene zscore zscore zscore r plotheatmappsallb xpartyn xcolfcol ypartpsnod xgridfals ygridtru xlabfals order inspect gene within individu modul som gene extract given number modul modul number contain return argument node procsom function extract e g modul number r g namespsnodespsnod averag pseudotempor express profil group plot function plotexpress r plotexpressionf g n colfcol namenod clusterfals alpha typesnul way possibl plot express profil individu gene eg r plotexpressionf clca__chr n colfcol clusterfals alpha typesnul also possibl highlight data point specif symbol exampl reflect batch use type argument r plotexpressionf g n colfcol namenod clusterfals typessub_dn see help page detail explan input paramet final individu loesssmooth profil set gene plot graph normal sum express across cell one order display gene scale r group headg plotexpressionprofilef group n namenod clusterfals see help page detail explan input paramet differenti gene express analysi togeth fateid function differenti gene express analysi provid function implement approach similar deseq deseq neg binomi distribut fit transcript count two popul repres instanc two differ cell type default function execut normal data estim dispers paramet polynomi fit logtransform transcript count varianc function logtransform mean express done input data either pool cell two popul popul separ altern one also provid function variancemean depend input paramet e g depend comput raceid stemid outlier identif anoth option function also execut standard deseq deseq differenti express analysi run analysi express data frame need input togeth two vector cell id correspond subset column name data frame exampl function could use identifi gene differenti express cell origin cluster progenitor compart either bias toward enterocyt cluster goblet cell cluster fateprob r thr b cl c rownamesfbprobsfbprobsa thr aya cl b rownamesfbprobsfbprobsb thr b byb cl de diffexpnbvaabbdeseqfalsenormfalsevfitnulllocregfals use full express data frame without featur select input normal perform sinc v alreadi normal size chosen input paramet diffexpnb infer dispers paramet neg binomi transcript level distribut two popul base variancemean depend deriv raceid stemid altern local regress util locreg equal true anoth option run deseq deseq analysi deseq true function return list three compon result differenti gene express analysi store re compon data frame display mean express two set fold chang log foldchang two set pvalu differenti express pval benjaminihochberg correct fals discoveri rate padj result plot follow function r plotdiffgenesnbdemthrlthranameabnamebpadjfals inspect fate bia gene express enabl inspect fatespecif marker gene express fateid provid function plot express level two gene scatter plot gene could instanc repres marker two differ lineag function reveal whether express domain gene fall distinct cluster whether correl fate bia toward particular lineag visual correl gene express domain cluster origin cell genegen function call gene express data frame cluster partit input r genegeneintestinevintestineymuc__chrapoa__chr fate bia toward particular target cluster e g cluster highlight output fb fatebia function column name fbprob correspond target cluster e requir addit input paramet r genegeneintestinev intestiney muc__chr apoa__chr fbfb tnt plotnumfals see help page addit input argument identifi gene involv earli prime fate decis stage differenti inform extract gene high import valu see detail randomforest function randomforest packag classif given target cluster least one random forest iter r k impgenesfbt function requir output object fatebia function number target cluster concaten input addit option argument specifi cutoff import valu see help page return list two object one data frame mean import valu gene pass threshold least iter row iter column correspond data frame standard deviat import valu function also plot heatmap import valu hierarch cluster gene bug report question relat fateid pleas email directli linkmailtodominicgruengmailcom refer refer id fateid type articlejourn author famili herman given j famili sagar given famili grün given issu year month titl fateid infer cell fate bia multipot progenitor singlecel rnaseq datanocas containertitl nat method page volum issu id censu type articlejourn author famili qiu given x famili hill given famili packer given j famili lin given famili given famili trapnel given c issu year month titl singlecel mrna quantif differenti analysi censusnocas containertitl nat method page volum issu id stemid type articlejourn author famili grun given famili muraro given j famili boisset given j c famili wiebrand given k famili lyubimova given famili dharmadhikari given g famili born given droppingparticl van den famili es given j droppingparticl van famili jansen given e famili clever given h famili kone given e j p droppingparticl de famili oudenaarden given droppingparticl van issu year month titl de novo predict stem cell ident use singlecel transcriptom datanocas containertitl cell stem cell page volum issu id deseq type articlejourn author famili ander given famili huber given w issu year titl differenti express analysi sequenc count datanocas containertitl genom biol page r volum issu id deseq type articlejourn author famili love given famili huber given w famili ander given issu year titl moder estim fold chang dispers rnaseq data deseqnocas containertitl genom biol page volum issu id randomforest type articlejourn author famili breiman given l issu year titl random forestsnocas containertitl mach learn page volum issu id tsne type articlejourn author famili maaten given l droppingparticl van der famili hinton given g issu year titl visual data use tsnenocas containertitl j mach learn page volum id dpt type articlejourn author famili haghverdi given l famili buttner given famili wolf given f famili buettner given f famili thei given f j issu year month titl diffus pseudotim robustli reconstruct lineag branchingnocas containertitl nat method page volum issu id destini type articlejourn author famili anger given p famili haghverdi given l famili buttner given famili thei given f j famili marr given c famili buettner given f issu year month titl destini diffus map largescal singlecel data rnocas containertitl bioinformat page volum issu gener roxygen edit hand pleas edit document rfateid_functionsr namecompdr aliascompdr titlecomput dimension reduct represent usag compdr x z null ctsne cmd lle umap k llen tsneperplex umappar null seed argument itemxexpress data frame gene row cell column gene id given row name cell id given column name reduc express tabl includ featur gene use analysi itemzmatrix contain celltocel distanc use fate bia comput default codenul case correlationbas distanc comput codex code corx itemma vector dimension reduct represent comput follow represent comput codel locallylinear embed codecmd classic multidimension scale codedm diffus map codetsn tsne map codeumap umap default valu codeccmdtsneumap subset method select itemkvector integ repres dimens dimension reduct represent comput default valu code itemlleninteg number number neighbour use codel algorithm default valu itemtsneperplexityposit number perplex use tsne comput default valu itemumapparsumap paramet see pkgumap packag codeumapdefault default codenul codeumapdefault use codeumapparsinput automat set codedist sinc umap comput distanc object itemseedinteg seed initi equal codenul run yield slightli differ result due random random forest algorithm default codenul valu twodimension list dimension reduct represent store data frame compon compon name first dimens given one follow algorithm itemlleloc linear embed calcul lle function pkglle packag itemcmdclass multidimension scale comput codecmdscal function pkgstat packag itemtsnetsn map comput codertsn function pkgrtsne packag itemumapumap comput codeumap function pkgumap packag compon name second dimens concaten capit integ number dimens one compon dimens codek descript function comput dimension reduct represent specifi number dimens use number differ algorithm tsne cmd lle diffus map umap exampl x intestinex dr compdrxznullmcmdkllentsneperplex plotdrcmddpchcolgrey gener roxygen edit hand pleas edit document rfateid_functionsr namefilterset aliasfilterset titlefunct filter express data usag filtersetx n null minexpr minnumb argument itemxexpress data frame gene row cell column gene id given row name cell id given column name itemnord vector cell id includ cell id need column name codex provid cell id includ arbitray order default valu codenul itemminexprposit real number minimum express requir least codeminnumb cell gene fulfil criterion remov default valu itemminnumberposit integ number minimum number cell gene need express least level codeminexpr gene fulfil criterion remov default valu valu reduc express data frame gene row cell column order coden descript function discard lowli express gene express data frame gener roxygen edit hand pleas edit document rintestin doctypedata nameintestin aliasintestin titlesinglecel transcriptom data intestin epitheli cell format list follow compon describ itemxdata frame gene row cell column reduc data frame contain express variabl gene itemyvector contain cluster partit cell differ cell type itemvdata frame gene row cell column data frame contain express gene itemfcolvector contain colour valu cluster codey usag intestin valu none descript dataset contain gene express valu e transcript count intestin epitheli cell addit inform differ cell type sampl refer grün et al cell stem cell hrefhttpspubmedncbinlmnihgovpubm keyworddataset gener roxygen edit hand pleas edit document rfateid_functionsr nameplotdiffgenesnb aliasplotdiffgenesnb titlefunct plot differenti express gene usag plotdiffgenesnb x pthr padj true lthr mthr inf anam null bname null show_nam true argument itemxoutput function codediffexpnb itempthrr number number repres pvalu cutoff appli display differenti express gene default valu paramet codepadj see determin cutoff appli uncorrect pvalu benjaminihochberg correct fals discoveri rate itempadjlog valu codetru gene benjaminihochberg correct fals discoveri rate lower codepthr display codefals gene pvalu lower codepthr display itemlthrr number inf differenti express gene display log foldchang greater codelthr default valu itemmthrr number inf inf differenti express gene display log mean express greater codemthr default valu inf itemanamenam express set codea use input codediffexpnb provid name use axi label default valu codenul itembnamenam express set codeb use input codediffexpnb provid name use axi label default valu codenul itemshow_nameslog valu codetru gene name display differenti express gene default valu codefals itemaddit argument function codeplot valu none descript plot function visual output codediffexpnb function plot exampl x intestinex intestiney v intestinev tar c fb fatebiasxytarznullminnrminnrhnbfactorusedistfalseseednullnbtreenul thr rownamesfbprobsfbprobst b rownamesfbprobsfbprobst de diffexpnbvaabb plotdiffgenesnbdepthr gener roxygen edit hand pleas edit document rfateid_functionsr nameplotheatmap aliasplotheatmap titleheatmap express profil usag plotheatmap x xpart null xcol null xlab true xgrid fals ypart null ycol null ylab true ygrid fals cex argument itemxdata frame input data show column display xaxi row yaxi order given codex exampl column correspond cell pseudotempor order row contain gene express e row repres pseudotempor gene express profil itemxpartopt vector integ valu indic partit data point along xaxi instanc codexpart cluster assign cell id order compon column codex default valu codenul itemxcolopt vector valid color name number compon equal number differ valu codexpart provid color use highlight partit along xaxi base codexpart default valu codenul itemxlablog valu codetru averag posit indic partit valu along xaxi default valu codetru itemxgridlog valu codetru partit along xaxi indic vertic line repres boundari posit given valu codexpart itemypartopt vector integ valu indic partit data point along yaxi instanc codeypart assign gene id node selorgan map order compon row codex default valu codenul itemycolopt vector valid color name number compon equal number differ valu codeypart provid color use highlight partit along yaxi base codeypart default valu codenul itemylablog valu codetru averag posit indic partit valu along yaxi default valu codetru itemygridlog valu codetru partit along yaxi indic horizont line repres boundari posit given valu codeypart itemcexposit real number size axi label default valu none descript function allow plot normal zscore transform pseudotempor express profil permit highlight partit along xaxi yaxi exampl donttest x intestinex intestiney v intestinev fcol intestinecol tar c fb fatebiasxytarznullminnrminnrhnbfactorusedistfalseseednullnbtreenul dr compdrxznullmcmdkllentsneperplex pr prcurveyfbdrkmcmdtrthrstartnul n prtrct fs filtersetvnminexprminnumb sd getsomfsnbalpha ps procsomsdcorthrminsom plotheatmappsallexpartynxcolfcolypartpsnodesxgridfalseygridtruexlabfals gener roxygen edit hand pleas edit document rfateid_functionsr namegetpart aliasgetpart titleinfer cell type partit usag getpartx fmarker fthr null n argument itemxexpress data frame gene row cell column gene id given row name cell id given column name reduc express tabl includ featur gene use analysi itemfmarkerlist vector gene id correspond valid rownam codex gene id within compon codefmark consid marker gene one cell type dataset aggreg express gene compon compar threshold defin input argument codefthr coden cell exceed threshold assign cluster repres cell express respect marker gene itemfthrvector real posit number vector length list codefmark contain threshold aggreg express gene correspond compon codefmark null threshold infer coden topexpress cell gene respect compon codefmark itemnposit integ number compon codefmark express gene aggreg everi cell coden topexpress cell extract averag express across cell defin express threshold appli infer partit default valu valu list follow three compon itemparta vector partit e cluster assign cell itemtara vector number target cluster cluster compris cell enrich marker gene remain cluster correspond cell type upregul marker list codefmark order list itemthra vector express threshold valu appli compon list codefmark order list descript function perform infer cell type partit base express marker gene exampl x intestinex intestiney fmarker listcdefa__chrdefa__chr clca__chr alpi__chr xf getpartxfmarkerfthrnulln gener roxygen edit hand pleas edit document rfateid_functionsr namediffexpnb aliasdiffexpnb titlefunct differenti express analysi usag diffexpnb x b deseq fals method pool norm fals vfit null locreg fals argument itemxexpress data frame gene row cell column gene id given row name cell id given column name reduc express tabl includ featur gene use analysi input provid codeg see given correspond valid gene id e one rownam codex default valu codenul case cluster ident highlight plot itemavector cell id correspond column name codex differenti express set codea versu set codeb evalu itembvector cell id correspond column name codex differenti express set codea versu set codeb evalu itemdeseqlog valu codetru pkgdeseq use infer differenti express gene case recommend provid nonnorm input data codex default valu codefals itemmethodeith percondit pool deseq use paramet determin nois model fit set separ percondit pool set compris cell codea codeb default valu pool itemnormlog valu codetru total transcript count cell normal minimum number transcript across cell set codea codeb default valu codefals itemvfitfunct describ background nois model infer differenti express gene perform userspecifi nois model describ express varianc function mean express default valu codenul itemlocreglog valu codefals regress second order polynomi perfom determin relat varianc mean codetru local regress perform instead default valu codefals itemaddit argument pass low level function codedeseqdatasetfrommatrix valu codedeseq equal codetru function return output pkgdeseq case list follow two compon return itemcdsobject return pkgdeseq function codedeseqdatasetfrommatrix itemresdata frame contain result pkgdeseq analysi otherwis list three compon return itemvfa data frame three column indic mean codem varianc codev fit varianc codevm set codea itemvfa data frame three column indic mean codem varianc codev fit varianc codevm set codeb itemresa data frame result differenti gene express analysi structur codedeseq output display mean express two set fold chang log fold chang two set pvalu differenti express codepv benjaminihochberg correct fals discoveri rate codepadj descript function perform differenti express analysi two set singl cell transcriptom infer base nois model reli codedeseq approach exampl x intestinex intestiney v intestinev tar c fb fatebiasxytarznullminnrminnrhnbfactorusedistfalseseednullnbtreenul thr rownamesfbprobsfbprobst b rownamesfbprobsfbprobst de diffexpnbvaabb gener roxygen edit hand pleas edit document rfateid_functionsr namegenegen aliasgenegen titlecompar plot express level two gene usag genegen x g g cluster null fb null tn null col null tp plotnum true seed argument itemxexpress data frame gene row cell column gene id given row name cell id given column name reduc express tabl includ featur gene use analysi itemyclust partit vector integ cluster number cell order cell column x itemggen id correspond valid row name x express gene codeg versu gene codeg plot itemggen id correspond valid row name x express gene codeg versu gene codeg plot itemclustersvector valid cluster id express display cell cluster contain codeclust argument given cell cluster display default valu codenul itemfbfatebia object return function codefatebia default valu codenul codetn codefb provid input fate bia colour code itemtnnam target cluster e concaten codet number target cluster correspond column name codefbprob default valu codenul codetn codefb provid input fate bia colour code itemcolopt vector valid color name cluster codey order increas cluster number default valu codenul itemtptranspar point plot default valu e nontranspar itemplotnumlog valu codetru cluster number display top data point default valu codetru itemseedinteg number random seed determin colour scheme default valu none descript function produc scatter plot express level two gene allow plot cell select cluster permit highlight fate bia exampl x intestinex intestiney v intestinev tar c fb fatebiasxytarznullminnrminnrhnbfactorusedistfalseseednullnbtreenul genegenevymuc__chrapoa__chr genegenevymuc__chrapoa__chrfbfbtntplotnumfals gener roxygen edit hand pleas edit document rfateid_functionsr namereclassifi aliasreclassifi titlereclassif cell usag reclassifi x tar z null clthr nbfactor usedist fals seed null nbtree null q argument itemxexpress data frame gene row cell column gene id given row name cell id given column name reduc express tabl includ featur gene use analysi itemyclust partit vector integ cluster number cell order cell column x itemtarvector integ repres target cluster number element codetar correspond cluster cell commit toward particular matur state one cluster per differ cell lineag given use start point learn differenti trajectori itemzmatrix contain celltocel distanc use fate bia comput default codenul case correlationbas distanc comput codex code corx itemclthrr number zero one threshold fraction random forest vote requir assign cell contain within target cluster one cluster valu paramet suffici high reclassifi cell highconfid assign default valu itemnbfactorposit integ number determin number tree grown random forest number tree given number column th train set multipli codenbfactor default valu itemusedistlog valu codetru distanc matrix use featur matrix e codez equal codenul codecorx otherwis codefals gene express valu codex use default codefals itemseedinteg seed initi equal codenul run yield slightli differ result due radom random forest algorithm default codenul itemnbtreeinteg valu given specifi number tree random forest explicit default codenul itemqr valu zero one number specifi threshold use featur select base import sampl reduc express tabl gener contain featur import larger qquantil least one class e target cluster default valu itemaddit argument pass low level function coderandomforest valu list follow three compon itemparta vector revis cluster assign cell order input argument codey itemrfth random forest object gener reclassif enabl import sampl see pkgrandomforest itemxfa filter express tabl featur extract base import sampl featur import larger qquantil least one class retain descript function attempt reassign addit cell dataset one target cluster detail function use random forest base supervis learn assign cell contain target cluster one cluster cell within target cluster receiv fraction vote larger codeclthr one target cluster reassign cluster sinc function develop reclassifi cell assign high confid high valu codeclthr e g appli exampl x intestinex intestiney tar c rc reclassifyxytarznullnbfactorusedistfalseseednullnbtreenullq gener roxygen edit hand pleas edit document rfateid_functionsr nameplotexpress aliasplotexpress titleplot pseudotempor express profil usag plotexpress x g n logsc fals col null name null cluster fals alpha type null cex ylim null map true leg true seed ylab null argument itemxexpress data frame gene row cell column gene id given row name cell id given column name itemyclust partit vector integ cluster number cell order cell column codex itemga gene id correspond one rownam codex also vector gene id case aggreg express across gene id plot itemnord vector cell id includ cell id need column name codex itemlogsclog valu codetru logtransform valu plot default codefals untransform valu plot itemcolopt vector valid color name cluster codey order increas cluster number default valu codenul itemnameopt charact string argument correspond titl plot default valu codenul provid codeg given codenam equal codeg codeg respect codeg vector gene id itemclusterlog valu codetru partit along xaxi indic vertic line repres boundari posit given valu codey averag posit across cell cluster indic xaxi itemalphaposit real number pseudotempor express profil deriv local regress express valu across order cell use function codeloess packag pkgstat paramet control degre smooth larger valu return smoother profil default valu itemtypesopt vector id differ subset cell codey e g differ batch cell id display symbol color default valu codenul itemcexs data point default valu itemylimvector two numer valu lower upper limit valu shown yaxi default valu codenul whole rang shown itemmaplog codetru data point shown default valu codetru itemleglog codetru axe label shown default valu codetru itemseedinteg number random seed determin colour scheme default itemylabopt label yaxi default codenul axi label norm express valu none descript function allow plot pseudotempor express profil singl gene group gene exampl donttest x intestinex intestiney v intestinev fcol intestinecol tar c fb fatebiasxytarznullminnrminnrhnbfactorusedistfalseseednullnbtreenul dr compdrxznullmcmdkllentsneperplex pr prcurveyfbdrkmcmdtrthrstartnul n prtrct fs filtersetvnminexprminnumb sd getsomfsnbalpha ps procsomsdcorthrminsom plot averag profil gene node selforgan map g namespsnodespsnod plotexpressionvygncolfcolnamenod clusterfalsealphatypesnul gener roxygen edit hand pleas edit document rfateid_functionsr namegetfeat aliasgetfeat titlefeatur select base differenti express gene usag getfeatx tar fpv argument itemxexpress data frame gene row cell column gene id given row name cell id given column name reduc express tabl includ featur gene use analysi itemyclust partit vector integ cluster number cell order cell column x itemtarvector integ repres target cluster number element codetar correspond cluster cell commit toward particular matur state one cluster per differ cell lineag given use start point learn differenti trajectori itemfpvpvalu cutoff call differenti express gene cutoff benjaminihochberg correct fals discoveri rate default valu itemaddit argument pass low level function codediffexpnb valu filter express tabl featur extract base differenti express gene descript function perform featur select base infer differenti express gene target cluster remain cell detail function determin differenti express cell target cluster comparison remain cell use codediffexpnb function exampl x intestinex intestiney tar c xf getfeatxytarfpv gener roxygen edit hand pleas edit document rfateid_functionsr nameprcurv aliasprcurv titlecomput princip curv given dimension reduct represent usag prcurvey fb dr k cmd trthr null start null argument itemyclust partit vector integ cluster number cell order cell column x itemfbfatebia object return function codefatebia itemdrlist dimension reduct represent return function codecompdr itemkinteg number dimens use dimens present codedr default valu itemmnam dimension reduct algorithm use princip curv comput one codel codecmd codedm codetsn codeumap default valu codecmd compon codedr ie previous comput codecompdr itemtrthrr valu repres threshold fraction random forest vote requir inclus given cell comput princip curv codenul cell signific bia includ trajectori bia comput ratio number vote trajectori number vote trajectori second largest number vote mean trajectori largest number vote receiv bia siginifc comput base count statist differ number vote signific bia requir pvalu default valu codenul itemstartinteg number repres specifi start cluster number trajectori e common progenitor cluster argument option default valu codenul itemaddit argument pass low level function codeprincipal_curv valu list follow two compon itempra list princip curv object produc codeprincipal_curv function pkgprincurv packag compon correspond one differenti trajectori give rise one target cluster codefb object itemtrca list order cell id trajectori codepr descript function comput princip curv given dimension reduct represent specifi compon name object return codecompdr use pkgprincurv packag detail function comput princip curv differenti trajectori consid cell assign trajectori signific fate bia least codetrthr random forest vote respect simulaten comput plot princip curv see function codeplotfatemap exampl x intestinex intestiney tar c fb fatebiasxytarznullminnrminnrhnbfactorusedistfalseseednullnbtreenul dr compdrxznullmcmdkllentsneperplex pr prcurveyfbdrkmcmdtrthrstartnul gener roxygen edit hand pleas edit document rfateid_functionsr nameprocsom aliasprocsom titleprocess selforgan map pseudotempor express profil usag procsomsd corthr minsom argument itemsdoutput function codegetsom itemcorthrcorrel threshold e real number zscore averag normal pseudotempor express profil within node selforgan map comput correl zscore neighbour node comput correl greater codecorthr neighbour node merg default valu itemminsomposit integ number node selforgan map less codeminsom transcript discard default valu valu list follow seven compon itemkvector pearson correl coeffici node codei node codei popul node selforgan map itemnodesvector assign gene node final selforgan map merg compon node number compon name gene id itemnodesedata frame averag normal pseudotempor express profil node order node number itemnodeszdata frame zscore transform averag normal pseudotempor express profil node order node number itemalledata frame normal pseudotempor express profil gene selforgan map order node number itemallzdata frame zscore transform normal pseudotempor express profil gene selforgan map order node number itemallbdata frame binar pseudotempor express profil gene selforgan map order node number express cell zscore cell zscore otherwis descript function process selforgan map produc function codegetsom exampl donttest x intestinex intestiney v intestinev tar c fb fatebiasxytarznullminnrminnrhnbfactorusedistfalseseednullnbtreenul dr compdrxznullmcmdkllentsneperplex pr prcurveyfbdrkmcmdtrthrstartnul n prtrct fs filtersetvnminexprminnumb sd getsomfsnbalpha ps procsomsdcorthrminsom gener roxygen edit hand pleas edit document rfateid_functionsr nameplotexpressionprofil aliasplotexpressionprofil titleplot smooth pseudotempor express profil group gene usag plotexpressionprofil x g n logsc fals col null name null cluster fals alpha lwd ylim null seed ylab null argument itemxexpress data frame gene row cell column gene id given row name cell id given column name itemyclust partit vector integ cluster number cell order cell column codex itemga gene id correspond one rownam codex also vector gene id case separ profil plot gene codeg itemnord vector cell id includ cell id need column name codex itemlogsclog valu codetru logtransform valu plot default codefals untransform valu plot itemcolopt vector valid color name use profil gene codeg default valu codenul itemnameopt charact string argument correspond titl plot default valu codenul provid codeg given codenam equal codeg codeg respect codeg vector gene id itemclusterlog valu codetru partit along xaxi indic vertic line repres boundari posit given valu codey averag posit across cell cluster indic xaxi itemalphaposit real number pseudotempor express profil deriv local regress express valu across order cell use function codeloess packag pkgstat paramet control degre smooth larger valu return smoother profil default valu itemlwdlin width profil default valu itemylimvector two numer valu lower upper limit valu shown yaxi default valu codenul whole rang shown itemseedinteg number random seed determin colour scheme default itemylabopt label yaxi default codenul axi label norm express valu none descript function allow plot loesssmooth pseudotempor express profil group gene display gene express profil scale row sum normal one exampl donttest x intestinex intestiney v intestinev fcol intestinecol tar c fb fatebiasxytarznullminnrminnrhnbfactorusedistfalseseednullnbtreenul dr compdrxznullmcmdkllentsneperplex pr prcurveyfbdrkmcmdtrthrstartnul n prtrct fs filtersetvnminexprminnumb sd getsomfsnbalpha ps procsomsdcorthrminsom plot averag profil gene node selforgan map g samplenamespsnodespsnod plotexpressionprofilevygncolfcolnamenod alpha gener roxygen edit hand pleas edit document rfateid_functionsr namefatebia aliasfatebia titlecomput fate bia usag fatebia x tar z null minnr null minnrh null adapt true confid nbfactor usedist fals seed null nbtree null verbos fals argument itemxexpress data frame gene row cell column gene id given row name cell id given column name reduc express tabl includ featur gene use analysi itemyclust partit vector integ cluster number cell order cell column x itemtarvector integ repres target cluster number element codetar correspond cluster cell commit toward particular matur state one cluster per differ cell lineag given use start point learn differenti trajectori itemzmatrix contain celltocel distanc use fate bia comput default codenul case correlationbas distanc comput codex code corx itemminnrinteg number cell per target cluster select classif test set iter target cluster codeminnr cell highest similar cell train set select classif codez codenul use similar matrix step otherwis codecorx use default valu codenul codeminnr estim minimum half median target cluster size itemminnrhinteg number cell train set use classif train set codeminnrh cell highest similar train set select codez codenul use similar matrix step default valu codenul codeminnrh estim maximum half median target cluster size itemadaptlog codetru size test set target cluster adapt base classif success previou iter target cluster number success classifi cell determin ie number cell minimum fraction vote given codeconfid paramet target cluster gave rise inclus cell test set see codeminnr weight deriv divid number maximum across cluster ad pseudocount test set size codeminnr rescal cluster respect weight next iter default codetru itemconfidencer number see codeadapt paramet default itemnbfactorposit integ number determin number tree grown random forest number tree given number column th train set multipli codenbfactor default valu itemusedistlog valu codetru distanc matrix use featur matrix e codez equal codenul codecorx otherwis codefals gene express valu codex use default codefals itemseedinteg seed initi equal codenul run yield slightli differ result due radom random forest algorithm default codenul itemnbtreeinteg valu given specifi number tree random forest explicit default codenul itemverboselog codetru print inform consol itemaddit argument pass low level function coderandomforest valu list follow three compon itemprobsa data frame fraction random forest vote cell column repres target cluster column name given concaten codet target cluster number itemvotesa data frame number random forest vote cell column repres target cluster column name given concaten codet target cluster number itemtrlist vector compon contain id cell trajectori given target cluster compon name given concaten codet target cluster number itemrfllist randomforest object iter classif itemtrallvector cell id order random forest iter classifi one target cluster descript function comput fate bias singl cell base express data singl cell sequenc experi requir cluster partit target cluster repres commit state trajectori detail bia comput ratio number random forest vote trajectori number vote trajectori second largest number vote mean trajectori largest number vote receiv bia siginifc comput base count statist differ number vote signific bia requir pvalu cell assign trajectori exhibit signific bia trajectori exampl x intestinex intestiney tar c fb fatebiasxytarminnrminnrhadapttrueconfidencenbfactor headfbprob gener roxygen edit hand pleas edit document rfateid_functionsr nameimpgen aliasimpgen titleextract gene high import valu random forest classif usag impgenesfb tn ithr zthr argument itemfbfatebia object return function codefatebia codefb provid princip curv comput shown plot default valu codenul curv display codeg equal codenul itemtnnam target cluster e concaten codet number target cluster correspond column name codefbprob itemithrposit real number threshold requir import measur mean decreas accuraci classif upon remov see pkgrandomforest includ gene output import featur classi cell codetn default valu itemzthrposit real number threshold requir zscore import measur import divid standard deviat import includ gene output import featur classi cell codetn default valu valu function return list two element itemda data frame mean import valu gene surviv filter codeithr codezthr column correspond random forest iter start initi target cluster itemda data frame standard deviat import valu gene surviv filter codeithr codezthr column correspond random forest iter start initi target cluster function produc heatmap code hierarch cluster row use function codepheatmap pkgpheatmap packag descript function extract gene import valu classifi cell given target cluster exceed given threshold least one random forest iterationn exampl x intestinex intestiney tar c fb fatebiasxytarznullminnrminnrhnbfactorusedistfalseseednullnbtreenul k impgenesfbtithrzthr gener roxygen edit hand pleas edit document rfateid_functionsr nameplotfatemap aliasplotfatemap titleplot dimension reduct represent express data usag plotfatemap dr x null g null n null prc fals logsc fals k cmd kr null col null fb null trthr null start null tp seed argument itemyclust partit vector integ cluster number cell order cell column x itemdrlist dimension reduct represent return function codecompdr itemxexpress data frame gene row cell column gene id given row name cell id given column name reduc express tabl includ featur gene use analysi input provid codeg see given correspond valid gene id e one rownam codex default valu codenul case cluster ident highlight plot itemgeith name one trajectori codefb gene id correspond one rownam codex latter case input argument codex need provid vector gene id also provid case aggreg express across gene id plot codeg equal e entropi fate bia display default valu codenul case cluster ident highlight plot itemnopt charact string argument correspond titl dimension plot default valu codenul provid codeg given coden equal codeg g respect g vector gene id itemprclog codetru princip curv comput return default codefals itemlogsclog codetru gene express fate bia probabl plot log scale default valu codefals itemkinteg number dimens use dimens present codedr codek allow start version itemmnam dimension reduct algorithm use princip curv comput one codel codecmd codedm codetsn codeumap default valu codecmd compon codedr ie previous comput codecompdr itemkrinteg vector codek codekr indic dimens plot either two three possibl dimens default valu codenul case codekr given codemink itemcolopt vector valid color name cluster codey order increas cluster number default valu codenul itemfbfatebia object return function codefatebia codefb provid princip curv comput shown plot default valu codenul curv display codeg equal codenul itemtrthrr valu repres threshold fraction random forest vote requir inclus given cell comput princip curv codenul cell signific bia includ trajectori bia comput ratio number vote trajectori number vote trajectori second largest number vote mean trajectori largest number vote receiv bia siginifc comput base count statist differ number vote signific bia requir pvalu default valu codenul itemstartinteg number repres specifi start cluster number trajectori e common progenitor cluster argument option default valu codenul itemtptranspar point plot allow better visibl princip curv default valu e nontranspar itemseedinteg number random seed determin colour scheme default itemaddit argument pass low level function codeprincipal_curv valu codefb provid input argument codeprc equal codetru output correspond output codeprcurv otherwis ouput gener codeg equal e case vector fate bia entropi cell given descript function plot dimension reduct represent use output codecompdr function input allow display input cluster well color code fate bia probabl gene express exampl x intestinex intestiney v contain gene featur select like x v intestinev fcol intestinefcol tar c fb fatebiasxytarznullminnrminnrhnbfactorusedistfalseseednullnbtreenul dr compdrxznullmcmdkllentsneperplex plot princip curv pr plotfatemapydrkprctruemcmdcolfcolfbfbtrthrstartnulltp plot express gene apoa__chr plotfatemapydrxvgapoa__chrprcfalsekmcmdcolintestinefcol gener roxygen edit hand pleas edit document rfateid_functionsr namegetsom aliasgetsom titletopolog order pseudotempor express profil usag getsomx nb alpha argument itemxexpress data frame gene row cell column gene id given row name cell id given column name pseudotempor express profil gene defin order cell id e column codex itemnbposit integ number number node selforgan map default valu itemalphaposit real number pseudotempor express profil deriv local regress express valu across order cell use function codeloess packag pkgstat paramet control degre smooth larger valu return smoother profil default valu valu list follow three compon itemsoma codesom object return function codesom packag pkgsom itemxpseudotempor express profil e input express data frame codex smooth run mean local regress respectivey normal sum smoothen gene express valu across cell normal itemzsdata frame zscore transform pseudotempor express profil descript function comput topolog order pseudotempor express profil gene use dimension selforgan map exampl donttest x intestinex intestiney v intestinev tar c fb fatebiasxytarznullminnrminnrhnbfactorusedistfalseseednullnbtreenul dr compdrxznullmcmdkllentsneperplex pr prcurveyfbdrkmcmdtrthrstartnul n prtrct fs filtersetvnminexprminnumb sd getsomfsnbalpha