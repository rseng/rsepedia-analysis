deeprankgnn build statushttpsgithubcomdeeprankdeeprankgnnworkflowsbuildbadgesvghttpsgithubcomdeeprankdeeprankgnnact codaci badgehttpsapicodacycomprojectbadgegradeffbdeadeacaafcchttpsappcodacycomghdeeprankdeeprankgnnutm_sourcegithubcomutm_mediumreferralutm_contentdeeprankdeeprankgnnutm_campaignbadge_grad coverag statushttpscoverallsioreposgithubdeeprankdeeprankgnnbadgesvgbranchmasterhttpscoverallsiogithubdeeprankdeeprankgnnbranchmast doihttpszenodoorgbadgedoizenodosvghttpsdoiorgzenodo alttextdeeprank_gnnpng instal instal deeprankgnn need instal pytorch_geometr accord need find detail instruct pytorch_geometr httpspytorchgeometricreadthedocsioenlatestnotesinstallationhtml default cpu version pytorch instal also custom instal follow instruct pytorch httpspytorchorg depend instal instal latest releas deeprankgnn use pypi packag manag pip instal deeprankgnn altern get new develop clone repo instal code git clone httpsgithubcomdeeprankdeeprankgnn cd deeprankgnn pip instal e document found httpsdeeprankgnnreadthedocsio gener graph graphslin graph pdbpssm store datapdb datapssm gengraphpi script gener hdf file graph_residuehdf contain graph differ conform python graphgenmp import graphhdf pdb_path datapdb pssm_path datapssm ref dataref graphhdfpdb_pathpdb_pathref_pathrefpssm_pathpssm_path graph_typeresidueoutfilegraph_residuehdf graph interact network use graph interact network rather simpl python deeprank_gnnneuralnet import neuralnet deeprank_gnnginet import ginet databas hdfacb_residuehdf nn neuralnetdatabas ginet node_featuretyp polar bsa depth hse ic pssm edge_featuredist targetirmsd indexrang batch_siz percent nntrainnepoch validatefals nnplot_scatt custom gnn also possibl defin new network architectur specifi loss optim use train python def normalized_cut_dedge_index po row col edge_index edge_attr torchnormposrow poscol p dim return normalized_cutedge_index edge_attr num_nodesposs class customnettorchnnmodul def __init__self supernet self__init__ selfconv splineconvdnum_featur dim kernel_s selfconv splineconv dim kernel_s selffc torchnnlinear selffc torchnnlinear def forwardself data datax feluselfconvdatax dataedge_index dataedge_attr weight normalized_cut_ddataedge_index datapo cluster graclusdataedge_index weight data max_poolclust data datax feluselfconvdatax dataedge_index dataedge_attr weight normalized_cut_ddataedge_index datapo cluster graclusdataedge_index weight x batch max_pool_xclust datax databatch x scatter_meanx batch dim x feluselffcx x fdropoutx trainingselftrain return flog_softmaxselffcx dim devic torchdevicecuda torchcudais_avail els cpu model neuralnetdatabas customnet node_featuretyp polar bsa depth hse ic pssm edge_featuredist targetirmsd indexrang batch_siz percent modeloptim torchoptimadammodelparamet lr modelloss mseloss modeltrainnepoch hx support instal hxplorer httpsgithubcomdeeprankhxplor execut python file deeprank_gnnhxhxpi explor connect graph use deeprankgnn context menu right click name structur allow automat plot graph use plotli shown alttexth_deeprank_gnnpng run deeprankgnn pretrain model data herein provid pretrain model fold_treg_yfnat_b_e_lr_pt deeprankgnn paper doi exampl code run deeprankgnn new data pretrain model provid testpi usag python testpi also check deeprankgnn document usedeeprankgnnpaperspretrainedmodelhttpsdeeprankgnnreadthedocsioenlatesttutorialtrain_modelhtmlusedeeprankgnnpaperspretrainedmodel data use train model avail sbgridhttpsdatasbgridorgdataset pleas cite réau n renaud l c xue j j bonvin deeprankgnn graph neural network framework learn pattern proteinprotein interfac biorxiv doi httpsdoiorg detail code import glob import sy import time import datetim import numpi np deeprank_gnngraphgenmp import graphhdf deeprank_gnnneuralnet import neuralnet deeprank_gnnginet import ginet graph gener section path dock model pdb format pdb_path testsdatapdbatn path pssm file pssm_path testsdatapssmatn graphhdfpdb_pathpdb_path pssm_pathpssm_path graph_typeresidu outfileatn_residuehdf nproc predict section pretrained_model fold_treg_yfnat_b_e_lr_pt gnn ginet path graph database_test globglobhdf start_tim timetim model neuralnetdatabase_test gnn pretrained_model pretrained_model modeltestthresholdnon end_tim timetim print elaps time end_timestart_tim deeprankgnn gener hdf file predict provit hdf csv convert easili read python deeprankgnndeeprank_gnntoolshdf_to_csvpi yourhdf inform found deeprankgnn onlin documentationhttpsdeeprankgnnreadthedocsioenlatestindexhtml run deeprankgnn pretrain model data herein provid pretrain model tclass_ybio_interface_b_e_lr_pthtar deeprankgnn paper doi exampl code run deeprankgnn new data pretrain model provid testpi usag python testpi data use train model avail sbgridhttpsdatasbgridorgdataset pleas cite réau n renaud l c xue j j bonvin deeprankgnn graph neural network framework learn pattern proteinprotein interfac biorxiv doi httpsdoiorg detail code import glob import sy import time import datetim import numpi np deeprank_gnngraphgenmp import graphhdf deeprank_gnnneuralnet import neuralnet deeprank_gnnginet import ginet graph gener section path dock model pdb format pdb_path dcpdb path pssm file pssm_path dcpssm path graph hdf file database_test biological_vs_crystalhdf gener graph hdf file graphhdfpdb_pathpdb pssm_pathpssm biopythonfals graph_typeresidu outfiledatabase_test nproc benchmark mode add target valu test set comput perform metric detail provid deeprankgnn onlin documentationhttpsdeeprankgnnreadthedocsioenlatesttutorialgenerate_graphhtmladdyourtargetvalu add_targetgraph_pathdatabase_test target_namebio_interfac target_listbio_interfacestxt predict section pretrained_model tclass_ybio_interface_b_e_lr_pthtar gnn ginet start_tim timetim model neuralnetdatabase_test gnn pretrained_model pretrained_model targetbio_interfac target valu predict mode remov target argument metric comput line model neuralnetdatabase_test ginet pretrained_model tclass_ybio_interface_b_e_lr_pthtar modeltesthdf hdfprediction_phy_nonphyhdf end_tim timetim print elaps time end_timestart_tim evalu perform test_metr modelget_metricstest threshold printaccuracytest_metricsaccuraci printspecificitytest_metricsspecif printsensitivitytest_metricssensit printprecisiontest_metricsprecis printfprtest_metricsfpr printfnrtest_metricsfnr deeprankgnn gener hdf file predict provit hdf csv convert easili read python deeprankgnndeeprank_gnntoolshdf_to_csvpi yourhdf inform found deeprankgnn onlin documentationhttpsdeeprankgnnreadthedocsioenlatestindexhtml contribut guidelin welcom kind contribut softwar simpl comment question full fledg pull request httpshelpgithubcomarticlesaboutpullrequests_ pleas read follow code conduct code_of_conductrst_ contribut one follow case question think may found bug includ unexpect behavior want make kind chang code base eg fix bug add new featur updat document section outlin step case question use search function httpsgithubcomnlescjcerpychampissues__ see someon alreadi file issu issu search yield relev result make new issu appli question label appli label relev think may found bug use search function httpsgithubcomnlescjcerpychampissues__ see someon alreadi file issu issu search yield relev result make new issu make sure provid enough inform rest commun understand caus context problem depend issu may want includ sha hashcod httpshelpgithubcomarticlesautolinkedreferencesandurlscommitshas_ commit caus problem identifi inform name version number depend your use inform oper system appli relev label newli creat issu want make kind chang code base import announc plan rest commun start work announc form new issu import wait kind consensu reach idea good idea need fork repositori github profil creat featur branch latest master commit work featur branch make sure stay date master branch pull chang possibl upstream repositori follow instruct httpshelpgithubcomarticlesconfiguringaremoteforafork__ httpshelpgithubcomarticlessyncingafork__ make sure exist test still work run python setuppi test add test necessari updat expand document push httprogerdudlergithubiogitguide_ featur branch fork pychamp repositori github creat pull request eg follow instruct httpshelpgithubcomarticlescreatingapullrequest__ case feel like youv made valuabl contribut dont know write run test gener document dont let discourag make pull request help go ahead submit pull request keep mind might ask append addit commit pull request contributor coven code conduct pledg interest foster open welcom environ contributor maintain pledg make particip project commun harassmentfre experi everyon regardless age bodi size disabl ethnic gender ident express level experi educ socioeconom statu nation person appear race religion sexual ident orient standard exampl behavior contribut creat posit environ includ use welcom inclus languag respect differ viewpoint experi grace accept construct critic focus best commun show empathi toward commun member exampl unaccept behavior particip includ use sexual languag imageri unwelcom sexual attent advanc troll insultingderogatori comment person polit attack public privat harass publish other privat inform physic electron address without explicit permiss conduct could reason consid inappropri profession set respons project maintain respons clarifi standard accept behavior expect take appropri fair correct action respons instanc unaccept behavior project maintain right respons remov edit reject comment commit code wiki edit issu contribut align code conduct ban temporarili perman contributor behavior deem inappropri threaten offens harm scope code conduct appli within project space public space individu repres project commun exampl repres project commun includ use offici project email address post via offici social media account act appoint repres onlin offlin event represent project may defin clarifi project maintain enforc instanc abus harass otherwis unaccept behavior may report contact project team nrenaudesciencecenternl complaint review investig result respons deem necessari appropri circumst project team oblig maintain confidenti regard report incid detail specif enforc polici may post separ project maintain follow enforc code conduct good faith may face temporari perman repercuss determin member project leadership attribut code conduct adapt contributor coven httpswwwcontributorcovenantorg_ version avail httpswwwcontributorcovenantorgversioncodeofconducthtml graph graph gener graph automodul deeprank_gnngraph member undocmemb residu graph automodul deeprank_gnnresiduegraph member undocmemb graph gener automodul deeprank_gnngraphgen member undocmemb parrallel graph gener automodul deeprank_gnngraphgenmp member undocmemb graph neural network ginet layer graph interact network layer layer inspir sazan mahbub et al egat edg aggreg graph attent network transfer learn improv proteinprotein interact site predict biorxiv creat edg featur concaten node featur math e_ij leakyrelu a_ij w x_i w x_j appli softmax function order learn consid ignor neighbor node math alpha_ij softmaxe_ij sum node averag math z_i sum_j alpha_ij wx_j b_i herein add edg featur step math e_ij leakyrelu a_ij w x_i w x_j edge_attr automodul deeprank_gnnginet member undocmemb fout net layer layer describ eq protein interfac predit use graph convolut network alex fout et al nip math z x_i wc ni sum_j x_j wn b automodul deeprank_gnnfoutnet member undocmemb sgraphattent sgat layer new layer similar graph attent network simpler math z_i ni sum_j a_ij x_i x_j w b_i concaten oper ni number neighbor node sum_j run neighbor node matha_ij edg attribut node j automodul deeprank_gnnsgat member undocmemb neural network train evalu test neural network automodul deeprank_gnnneuralnet member undocmemb deeprankgnn document master file creat sphinxquickstart wed may adapt file complet like least contain root toctre direct welcom deeprankgnn document toctre maxdepth caption deeprankgnn overview instal toctre maxdepth caption tutori tutorialgenerate_graph tutorialtrain_model tutorialadvanc toctre maxdepth caption api apigraph_gener apigraph_neural_etwork apineural_network indic tabl refgenindex refmodindex refsearch overview deeprankgnn framework convert ppi interfac graph use learn interact pattern use graph neural network framework design adapt ppi relat research project figur deeprank_gnnpng align center deeprankgnn work two step process graph gener use proteinprotein complex gener ppi interfac graph go refcreat graphscreat graph model train tune train graph neural network make predict go reftrain moduletrain modul motiv proteinprotein interact ppi essenti cellular process live organ includ cell growth structur commun protect death acquir knowledg ppi fundament understand normal alter physiolog process propos solut restor past decad larg number ppi structur solv experiment approach eg xray crystallographi nuclear magnet reson cryogen electron microscopi given remark success convolut neural network cnn retriev pattern imag _ cnn architectur develop learn interact pattern ppi interfac _ _ cnn howev come major limit first sensit input ppi orient may requir data augment ie multipl rotat input data network forget orient learn process second size grid uniqu input data reflect varieti interfac size observ experiment structur may problemat larg interfac fit insid predefin grid size solut problem use instead graph neural network gnn definit graph nonstructur geometr structur hold orient inform rotat invari easili repres interfac vari size build previou tool deeprankhttpsgithubcomdeeprankdeeprank map atom residuelevel featur ppi grid appli cnn learn problemspecif interact pattern present deeprankgnn deeprankgnn convert ppi interfac graph use learn interact pattern deeprankgnn framework easili use commun adapt topic involv ppi interact framework allow user defin graph neural network featur target valu krizhevski sutskev hinton ge imagenet classif deep convolut neural network adv neural inf process syst renaud n geng c georgievska ambrosetti f ridder l marzella bonvin xue l deeprank deep learn framework data mine proteinprotein interfac biorxiv wang x terashi g christoff cw zhu kihara protein dock model evalu deep convolut neural network bioinformat advanc design gnn layer exampl import torch torchnn import paramet import torchnnfunct f import torchnn nn torch_scatt import scatter_mean torch_scatt import scatter_sum torch_geometricutil import remove_self_loop add_self_loop softmax torch_geometr import torch_geometricnninit import uniform torch_geometricnn import max_pool_x class ginet_layertorchnnmodul def __init__self in_channel out_channel number_edge_featur biasfals superegat self__init__ selfin_channel in_channel selfout_channel out_channel selffc nnlinearselfin_channel selfout_channel biasbia selffc_edge_attr nnlinearnumber_edge_featur biasbia selffc_attent nnlinear selfout_channel biasbia selfreset_paramet def reset_parametersself size selfin_channel uniforms selffcweight uniforms selffc_attentionweight uniforms selffc_edge_attrweight def forwardself x edge_index edge_attr row col edge_index num_nod lenx edge_attr edge_attrunsqueez edge_attrdim els edge_attr xcol selffcxcol xrow selffcxrow ed selffc_edge_attredge_attr creat edg featur concaten node featur alpha torchcatxrow xcol ed dim alpha selffc_attentionalpha alpha fleaky_relualpha alpha fsoftmaxalpha dim h alpha xcol torchzero num_nod selfout_channelstoalphadevic z scatter_sumh row dim outout return z def __repr__self return formatself__class____name__ selfin_channel selfout_channel design neural network architectur provid exampl make use intern edg extern edg perform convolut intern extern edg independ provid follow data convolut layer data_extinternal_edge_index data_extinternal_edge_attr intern edg data_extedge_index data_extedge_attr extern edg note gnn class must initi argument input_shap output_shap input_shape_edg class ginettorchnnmodul def __init__self input_shap output_shap input_shape_edg superginet_lay self__init__ selfconv ginet_layerinput_shap selfconv ginet_lay selfconv_ext ginet_layerinput_shap input_shape_edg selfconv_ext ginet_lay input_shape_edg selffc nnlinear selffc nnlinear output_shap selfclust mcl selfdropout def forwardself data act frelu data_ext dataclon interprotein interact graph first conv block datax actselfconv datax dataedge_index dataedge_attr cluster get_preloaded_clusterdataclust databatch data community_poolingclust data second conv block datax actselfconv datax dataedge_index dataedge_attr cluster get_preloaded_clusterdataclust databatch x batch max_pool_xclust datax databatch intraprotein interact graph first conv block data_extx actselfconv_ext data_extx data_extinternal_edge_index data_extinternal_edge_attr cluster get_preloaded_clusterdata_extclust data_extbatch data_ext community_poolingclust data_ext second conv block data_extx actselfconv_ext data_extx data_extinternal_edge_index data_extinternal_edge_attr cluster get_preloaded_clusterdata_extclust data_extbatch x_ext batch_ext max_pool_xclust data_extx data_extbatch fc x scatter_meanx batch dim x_ext scatter_meanx_ext batch_ext dim x torchcatx x_ext dim x actselffcx x fdropoutx selfdropout trainingselftrain x selffcx return x use gnn architectur deeprankgnn model neuralnetdatabas ginet node_featurenode_featur edge_featureedge_featur targettarget tasktask lrlr batch_sizebatch_s shuffleshuffl percent instal via python packag latest releas deeprankgnn instal use pypi packag manag pip instal deeprankgnn plan use deeprankgnn quickest way obtain code via github user would like contribut code host github_ httpsgithubcomdeeprankdeeprankgnn _github httpsgithubcomdeeprankdeeprankgnn instal code clone repositori git clone httpsgithubcomdeeprankdeeprankgnngit go cd deeprankgnn instal modul pip instal e test instal cd test pytest note ensur least pytorch instal python c import torch printtorch__version__ case pytorch geometr instal fail refer instal guid httpspytorchgeometricreadthedocsioenlatestnotesinstallationhtml _creat graph creat graph deeprankgnn automat gener residuelevel graph proteinprotein interfac node correspond singl residu type edg defin extern edg connect residu node chain b least pairwis atom distanc use defin neighbor intern edg connect residu node within chain least pairwis atom distanc use cluster node warn graph gener requir ensembl pdb file contain two chain chain chain b provid pssm matric comput evolutionari conserv node featur precalcul pssm matric download httpdconscnbcsic dcons_to_deeprank_pssmpi convert found tool folder convert dcon pssm format deeprankgnn pssm format make sure sequenc number match pdb residu number default follow featur assign node graph po xyz coordin chain chain id charg residu charg polar apolarpolarneg_chargedpos_charg one hot encod bsa buri surfac type residu type one hot encod follow featur comput pssm data provid pssm pssm score residu con pssm score residu ic inform content pssm shannon entropi follow featur option comput biopython use see next exampl depth averag atom depth atom residu distanc surfac hse half sphere exposur gener graph note pssm inform use comput pssm con ic node featur option exampl featur comput deeprank_gnngraphgenmp import graphhdf pdb_path datapdbatn pssm_path datapssmatn graphhdfpdb_pathpdb_path pssm_pathpssm_path biopythontru graph_typeresidu outfileatn_residuehdf nproc exampl biopython featur hse depth ignor deeprank_gnngraphgenmp import graphhdf pdb_path datapdbatn path dock model pdb format pssm_path datapssmatn path pssm file graphhdfpdb_pathpdb_path pssm_pathpssm_path graph_typeresidu outfileatn_residuehdf nproc exampl biopython featur hse depth pssm inform ignor deeprank_gnngraphgenmp import graphhdf pdb_path datapdbatn graphhdfpdb_pathpdb_path graph_typeresidu outfileatn_residuehdf nproc add target valu use customizegraph class add target valu graph benchmark dock model go next section deeprank_gnngraphgenmp import graphhdf deeprank_gnntoolscustomizegraph import add_target pdb_path datapdbatn pssm_path datapssmatn graphhdfpdb_pathpdb_path pssm_pathpssm_path graph_typeresidu outfileatn_residuehdf nproc add_targetgraph_path target_namenew_target target_listlist_of_target_valuestxt note list target valu respect follow format model_name_ model_name_ model_name_ model_name_ use separ eg tab use sep argument add_targetgraph_pathgraph_path target_namenew_target target_listlist_of_target_valuestxt sep dock benchmark mode dock benchmark mode provid path refer structur graph gener step know refer structur follow target valu automat comput base capri qualiti criteria _ assign graph irmsd interfac rmsd rmsd superimpos interfac residu lrmsd ligand rmsd rmsd chain b given chain superimpos fnat fraction nativ contact dockq see basu et al dockq qualiti measur proteinprotein dock model plo one bin_class binari classif irmsd rmsd capri_class rmsd rmsd rmsd rmsd rmsd deeprank_gnngraphgenmp import graphhdf pdb_path datapdbatn pssm_path datapssmatn ref datarefatn graphhdfpdb_pathpdb_path ref_pathref pssm_pathpssm_path graph_typeresidu outfileatn_residuehdf nproc note differ input file must respect follow nomenclatur pdb file atn_xxxpdb xxx may replac anyth pssm file atnapdbpssm atnbpdbpssm atnapssm atnbpssm refer pdb file atnpdb lensink mf méndez r wodak sj dock score protein complex capri rd edit protein _train modul train modul select node edg featur edg featur dist distanc node edge_featuredist note extern edg connect residu chain b least pairwis atom distanc use defin neighbor intern edg connect residu within chain least pairwis atom distanc use cluster node node featur po xyz coordin chain chain id charg residu charg polar apolarpolarneg_chargedpos_charg one hot encod bsa buri surfac pssm pssm score residu con pssm score residu ic inform content pssm shannon entropi type residu type one hot encod depth opt graph gen step averag atom depth atom residu distanc surfac hse opt graph gen step half sphere exposur node_featuretyp polar bsa ic pssm select target benchmark mode use deeprankgnn benchmark mode must specifi target often refer target valu precalcul graph gener step refer structur provid precalcul target irmsd interfac rmsd rmsd superimpos interfac residu lrmsd ligand rmsd rmsd chain b given chain superimpos fnat fraction nativ contact dockq see basu et al dockq qualiti measur proteinprotein dock model plo one bin_class binari classif irmsd rmsd capri_class rmsd rmsd rmsd rmsd rmsd note classif mode ie taskclass must provid list target class neuralnet eg class targetirmsd select hyperparamet regress reg classif class mode taskreg batch size batch_siz shuffl train dataset shuffletru learn rate lr load network step requir precalcul graph hdf format user may option input uniqu dataset chose automat split train set evalu set option input distinct trainingevaluationtest set option deeprank_gnnneuralnet import neuralnet deeprank_gnnginet import ginet databas atn_residuehdf model neuralnetdatabas ginet node_featurenode_featur edge_featureedge_featur targettarget tasktask lrlr batch_sizebatch_s shuffleshuffl percent note percent argument requir split input dataset train set test set use percent input dataset constitut train set constitut evalu set option deeprank_gnnneuralnet import neuralnet deeprank_gnnginet import ginet import glob load train dataset database_train globglobhdftrainhdf load valid dataset database_ev globglobhdfevalhdf load test dataset database_test globglobhdftesthdf model neuralnetdatabase_train ginet node_featurenode_featur edge_featureedge_attr targettarget tasktask lrlr batch_sizebatch_s shuffleshuffl database_ev database_ev train model exampl train network perform epoch modeltrainnepoch validatefals exampl train model evalu model epoch save best model ie model lowest loss write predict outputhdf modeltrainnepoch validatetru save_modelbest hdfoutputhdf warn last model save default set save_modelbest model associ lower loss gener previou epoch save default epoch number includ output name write intermedi model analysi plot loss evolut epoch modelplot_lossnameplot_loss analys perform benchmark condit follow analysi appli refer structur provid graph gener step plot accuraci evolut modelplot_accnameplot_accuraci plot hitrat threshold valu requir binaris target valu modelplot_hit_ratedataev threshold modepercentag namehitrate_ev get variou metric follow metric easili comput classif metric sensit sensit hit rate recal true posit rate specif specif true neg rate precis precis posit predict valu npv neg predict valu fpr fall fals posit rate fnr fals neg rate fdr fals discoveri rate accuraci accuraci auc auc hitrat hit rate regress metric explained_vari explain varianc regress score function max_error max_error metric calcul maximum residu error mean_abolute_error mean absolut error regress loss mean_squared_error mean squar error regress loss root_mean_squared_error root mean squar error regress loss mean_squared_log_error mean squar logarithm error regress loss median_squared_log_error median absolut error regress loss r_score r coeffici determin regress score function note classif metric calcul continu target soon threshold provid binaris data train_metr modelget_metricstrain threshold printtrain set accuraci train_metricsaccuraci printtrain set sensit train_metricssensit eval_metr modelget_metricsev threshold printevalu set accuraci eval_metricsaccuraci printevalu set sensit eval_metricssensit save modelnetwork modelsave_modelmodel_backuppthtar test model extern dataset load model modeltestdatabase_test threshold pretrain model deeprank_gnnneuralnet import neuralnet deeprank_gnnginet import ginet database_test atn_residuehdf model neuralnetdatabase_test ginet pretrained_model model_backuppthtar modeltestdatabase_test test_metr modelget_metricstest threshold printtest_metricsaccuraci short deeprank_gnnneuralnet import neuralnet deeprank_gnnginet import ginet databas atn_residuehdf edge_featuredist node_featuretyp polar bsa depth hse ic pssm targetirmsd taskreg batch_siz shuffletru lr model neuralnetdatabas ginet node_featurenode_featur edge_featureedge_featur targettarget indexnon tasktask lrlr batch_sizebatch_s shuffleshuffl percent modeltrainnepoch validatetru save_modelbest hdfoutputhdf modelplot_lossnameplot_loss train_metr modelget_metricstrain threshold printtrain set accuraci train_metricsaccuraci printtrain set sensit train_metricssensit eval_metr modelget_metricsev threshold printevalu set accuraci eval_metricsaccuraci printevalu set sensit eval_metricssensit modelsave_modelmodel_backuppthtar modeltestdatabase_test threshold use default set deeprank_gnnneuralnet import neuralnet deeprank_gnnginet import ginet databas globglobhdf_trainhdf dataset_test globglobhdf_testhdf targetirmsd model neuralnetdatabas ginet targettarget percent modeltrainnepoch validatetru save_modelbest hdfoutputhdf modelplot_lossnameplot_loss train_metr modelget_metricstrain threshold printtrain set accuraci train_metricsaccuraci printtrain set sensit train_metricssensit eval_metr modelget_metricsev threshold printevalu set accuraci eval_metricsaccuraci printevalu set sensit eval_metricssensit modelsave_modelmodel_backuppthtar modeltestdatabase_test threshold use deeprankgnn paper pretrain model see réau n renaud l c xue j j bonvin deeprankgnn graph neural network framework learn pattern proteinprotein interfac biorxiv doi httpsdoiorg get pretrain model httpsgithubcomdeeprankdeeprankgnntreemasterpaper_pretrained_models_ deeprankgnn github repositori httpsgithubcomdeeprankdeeprankgnn_ import glob import sy import time import datetim import numpi np deeprank_gnngraphgenmp import graphhdf deeprank_gnnneuralnet import neuralnet deeprank_gnnginet import ginet graph gener section pdb_path testsdatapdbatn pssm_path testsdatapssmatn graphhdfpdb_pathpdb_path pssm_pathpssm_path graph_typeresidu outfileatn_residuehdf nproc predict section gnn ginet pretrained_model fold_treg_yfnat_b_e_lr_pt database_test globglobatn_residuehdf start_tim timetim model neuralnetdatabase_test gnn pretrained_model pretrained_model modeltestthresholdnon end_tim timetim print elaps time end_timestart_tim output automat store test_datahdf note storag conveni predict store hdf file convert hdf csv provid tool directori