instal instruct specif abinit pleas refer offici web instal noteshttpsdocsabinitorginstal file abinitdocinstallationmd pleas report problem comment abinit forumhttpsforumabinitorg author giantomassi instal abinit easybuild page describ compil instal abinit easybuildhttpsgithubcomeasybuilderseasybuild python framework manag scientif softwar cluster allow one build entir softwar stack associ modul singl command inform easybuild pleas consult offici documentationhttpseasybuildreadthedocsioenlatest also recommend read tutorialhttpsulhpctutorialsreadthedocsioenlatesttoolseasybuild differ step requir build instal softwar discuss detail introduct lmod environ modul see lmod user guidehttpslmodreadthedocsioenlatestindexhtml note also easybuild configur file easyconfig differ abinit version differ toolchain avail githubhttpsgithubcomeasybuilderseasybuildeasyconfigstreedevelopeasybuildeasyconfigsaabinit interest learn use easybuild feel free ask sysadmin build abinit modul use one easyconfig alreadi avail hand love learn use new tool facilit work like organ softwar stack clean way automaticallygener modul continu read get start easybuild first let use modul spider command check whether abinit modul alreadi instal sh modul spider abinit abinit descript abinit packag whose main program allow one find total energi charg densiti electron structur system made electron nuclei molecul period solid within densiti function theori dft use pseudopotenti planewav wavelet basi version abinitfossb abinitintelb abinitintela abinitintelb abinitintelb detail inform specif abinit packag includ load modul use modul full name note name trail e extens provid modul exampl modul spider abinitintelb output show five abinit version alreadi instal good news directli load one modul sh modul load abinitintelb activ execut compil intel toolchain b bad news avail version rather old use easybuild command line interfac build recent version build softwar easybuild need eb python script eb alreadi path get follow error messag sh eb bash eb command found case issu modul spider easybuild follow instruct print termin load easybuild modul eg sh modul load easybuild eb optswarcheasybuildsoftwareeasybuildbineb execut eb option search abinit easyconfig sh eb abinit found valid index usreasybuildeasyconfig use found valid index usreasybuildeasyconfig use cfgsusreasybuildeasyconfig cfgsusreasybuildeasyconfig cfgsaabinitabinitintelaeb cfgsaabinitabinitbfossbeb cfgsaabinitabinitbintelbeb cfgsaabinitabinitintelbeb cfgsaabinitabinitintelbeb cfgsaabinitabinitfossbeb cfgsaabinitabinitintelbeb cfgsaabinitabinitintelbeb cfgsaabinitabinitintelaeb cfgsaabinitabinitintelaeb cfgsaabinitabinitbfossbeb cfgsaabinitabinitbintelbeb cfgsaabinitabinitintelbeb cfgsaabinitabinitintelbeb cfgsaabinitabinitfossbeb cfgsaabinitabinitintelbeb cfgsaabinitabinitintelbeb cfgsaabinitabinitintelaeb cfgsaabinitabinitfossbeb cfgsaabinitabinitintelbeb variou easyconfig file found differ abinit version differ toolchain foss b intel etc note output may chang depend version easybuild instal machin eb file ship easybuild instal recent easyconfig file found github repositoryhttpsgithubcomeasybuilderseasybuildeasyconfigstreedevelopeasybuildeasyconfigsaabinit import eb file typic follow name scheme nameversiontoolchainversionsuffixeb name reflect fact easyconfig file associ particular version libraryappl particular toolchainhttpseasybuildreadthedocsioenlatestcommontoolchainshtml exampl foss stand free open sourc softwar toolchain base gcc openmpi openblaslapack scalapack fftw wherea intel toolchain base intel compil mkl intel mpi applic base foss rel easi build sinc basic build block includ gcc compil suit compil sourc need contrari intel toolchain requir licens softwar valid licens must avail instal use worth mention applic compil intel toolchain usual perform foss version especi intel hardwar unfortun compil link intel toolchain requir preexist licens instal usual done sysadmin consequ build softwar intel easyconfig easi sysadmin hasnt alreadi instal intel toolchain lucki instal kindli provid two configur file abinit sh cfgsaabinitabinitfossbeb cfgsaabinitabinitintelbeb discuss build process let look meta modul section list releas avail machin sh modul avail meta modul releaseselicb releasesb sl releasesa releasesb releasesa releasesb sd useown releasesb ti sl snip name modul stand default mean easybuild use releas default sinc want build fossbeb b default releas proceed directli next step want build recip associ differ releas eg need load associ modul build code use eg sh modul load releasesa invok eb name easyconfig file two option dryrun robot dr prefer short version sh eb abinitfossbeb robot dryrun dryrun tell eb print requir depend without actual build softwar strongli suggest use option understand what go perform full instal robot option tell eb automat build instal depend search easyconfig file set predefin directori prepend addit directori search eb file like current directori pwd use syntax robotpathspwd multipl directori specifi use robotpathspathpath machin get follow result sh eb abinitfossbeb robot dryrun temporari log file case crash tmpebttdrnleasybuildhvtloslog found valid index usreasybuildeasyconfig use dri run print build statu easyconfig depend x usreasybuildeasyconfigsmmmeb modul x usreasybuildeasyconfigsbbisonbisoneb modul bison x usreasybuildeasyconfigszzlibzlibeb modul zlib x usreasybuildeasyconfigshhelpmanhelpmaneb modul helpman x usreasybuildeasyconfigsfflexflexeb modul flex x usreasybuildeasyconfigsbbinutilsbinutilseb modul binutil x usreasybuildeasyconfigsggcccoregcccoreeb modul gcccore x usreasybuildeasyconfigshhelpmanhelpmangcccoreeb modul helpmangcccor x usreasybuildeasyconfigsmmmgcccoreeb modul mgcccore x usreasybuildeasyconfigszzlibzlibgcccoreeb modul zlibgcccor x usreasybuildeasyconfigsbbisonbisongcccoreeb modul bisongcccor x usreasybuildeasyconfigsfflexflexgcccoreeb modul flexgcccor x usreasybuildeasyconfigsbbinutilsbinutilsgcccoreeb modul binutilsgcccor x usreasybuildeasyconfigsggccgcceb modul gcc x usreasybuildeasyconfigssszipszipgcccoreeb modul szipgcccor x usreasybuildeasyconfigsnncursesncursesgcccoreeb modul ncursesgcccor x usreasybuildeasyconfigseexpatexpatgcccoreeb modul expatgcccor x usreasybuildeasyconfigsbbzipbzipgcccoreeb modul bzipgcccor x usreasybuildeasyconfigsllibreadlinelibreadlinegcccoreeb modul libreadlinegcccor x usreasybuildeasyconfigsccurlcurlgcccoreeb modul curlgcccor x usreasybuildeasyconfigsppkgconfigpkgconfiggcccoreeb modul pkgconfiggcccor x usreasybuildeasyconfigsllibtoollibtoolgcccoreeb modul libtoolgcccor x usreasybuildeasyconfigsoopenblasopenblasgcceb modul openblasgcc x usreasybuildeasyconfigsccmakecmakegcccoreeb modul cmakegcccor x usreasybuildeasyconfigspperlperlgcccoreeb modul perlgcccor x usreasybuildeasyconfigsddoxygendoxygengcccoreeb modul doxygengcccor x usreasybuildeasyconfigsaautoconfautoconfgcccoreeb modul autoconfgcccor x usreasybuildeasyconfigsaautomakeautomakegcccoreeb modul automakegcccor usreasybuildeasyconfigsllibxclibxcgcceb modul libxcgcc x usreasybuildeasyconfigsaautotoolsautotoolsgcccoreeb modul autotoolsgcccor x usreasybuildeasyconfigsnnumactlnumactlgcccoreeb modul numactlgcccor x usreasybuildeasyconfigsxxorgmacrosxorgmacrosgcccoreeb modul xorgmacrosgcccor x usreasybuildeasyconfigsllibpciaccesslibpciaccessgcccoreeb modul libpciaccessgcccor x usreasybuildeasyconfigsnncursesncurseseb modul ncurs x usreasybuildeasyconfigsggettextgettexteb modul gettext x usreasybuildeasyconfigsxxzxzgcccoreeb modul xzgcccore x usreasybuildeasyconfigsllibxmllibxmlgcccoreeb modul libxmlgcccor x usreasybuildeasyconfigshhwlochwlocgcccoreeb modul hwlocgcccor x usreasybuildeasyconfigsoopenmpiopenmpigcceb modul openmpigcc x usreasybuildeasyconfigsggompigompibeb modul gompib x usreasybuildeasyconfigsffftwfftwgompibeb modul fftwgompib x usreasybuildeasyconfigssscalapackscalapackgompibeb modul scalapackgompib x usreasybuildeasyconfigshhdfhdfgompibeb modul hdfgompib x usreasybuildeasyconfigsnnetcdfnetcdfgompibeb modul netcdfgompib x usreasybuildeasyconfigsnnetcdffortrannetcdffortrangompibeb modul netcdffortrangompib x usreasybuildeasyconfigsffossfossbeb modul fossb homeusersgmgmatteotry_ebabinitfossbeb modul abinitfossb temporari log file tmpebttdrnleasybuildhvtloslog remov temporari directori tmpebttdrnl remov output indic depend alreadi instal check box libxcgcc abinitfossbeb must built sourc uncheck box final build instal abinit v fossb execut command without dryrun sh eb abinitfossbeb robot temporari log file case crash tmpebioajweasybuildvbwxiklog found valid index usreasybuildeasyconfig use resolv depend process easybuild easyconfig usreasybuildeasyconfigsllibxclibxcgcceb build instal libxcgcc fetch file creat build dir reset environ start iter unpack patch prepar configur build test instal take care extens creat build dir reset environ start iter unpack patch prepar configur build test instal take care extens restor iter postprocess saniti check clean creat modul permiss packag complet instal end success took min sec result build found log file homeuclmodlgmatteolocaleasybuildsoftwarelibxcgcceasybuildeasybuildlibxclog process easybuild easyconfig homeusersgmgmatteotry_ebabinitfossbeb build instal abinitfossb fetch file creat build dir reset environ unpack patch prepar configur build test instal take care extens restor iter postprocess saniti check clean creat modul permiss packag complet instal end success took min sec result build found log file homeuclmodlgmatteolocaleasybuildsoftwareabinitfossbeasybuildeasybuildabinitlog build succeed temporari log file tmpebioajweasybuildvbwxiklog remov temporari directori tmpebioajw remov see log messag eb compil libxc final abinit execut librari modul instal localeasybuild directori sh ls localeasybuild build ebfiles_repo modul softwar sourc tree localeasybuildmodul homeuclmodlgmatteolocaleasybuildmodul abinit fossblua libxc gcclua chem abinit fossblua homeuclmodlgmatteolocaleasybuildmodulesallabinitfossblua libxc gcclua homeuclmodlgmatteolocaleasybuildmodulesalllibxcgcclua sinc need load modul instal localeasybuildmodulesal must add directori modulepath recent version easybuild issu sh modul use useown useown modul avail execut command sh modul use localeasybuildmodulesal point version abinit depend avail user modul sh modul avail user modul abinitfossb libxcgcc final load brandnew abinit modul sh modul load abinitfossb check abinit execut path sh abinit localeasybuildsoftwareabinitfossbbinabinit correct version sh abinit v output ldd show execut dynam link version libxc wherea openbla fftw netcdf hdf mpi provid b releas foss expect sh ldd abinit libxcso homeuclmodlgmatteolocaleasybuildsoftwarelibxcgccliblibxcso xaaaaaccf libfftwfso optswarcheasybuildbsoftwarefftwgompibliblibfftwfso xaaaabd libfftwso optswarcheasybuildbsoftwarefftwgompibliblibfftwso xaaaabc libopenblasso optswarcheasybuildbsoftwareopenblasgccliblibopenblasso xaaaab libnetcdffso optswarcheasybuildbsoftwarenetcdffortrangompibliblibnetcdffso xaaaaaad libnetcdfso optswarcheasybuildbsoftwarenetcdfgompibliblibnetcdfso xaaaaab libhdf_hlso optswarcheasybuildbsoftwarehdfgompibliblibhdf_hlso xaaaaac libhdfso optswarcheasybuildbsoftwarehdfgompibliblibhdfso xaaaac libmpiso optswarcheasybuildbsoftwareopenmpigccliblibmpiso xaaaad binari work box abinit modul automat load depend need local instal prepend ld_library_path path see use modul show sh modul show abinitfossb whatisdescript abinit packag whose main program allow one find total energi charg densiti electron structur system made electron nuclei molecul period solid within densiti function theori dft use pseudopotenti planewav wavelet basi whatishomepag httpswwwabinitorg whatisurl httpswwwabinitorg conflictabinit loadfossb loadlibxcgcc loadhdfgompib loadnetcdfgompib loadnetcdffortrangompib prepend_pathcmake_prefix_pathhomeuclmodlgmatteolocaleasybuildsoftwareabinitfossb prepend_pathld_library_pathhomeuclmodlgmatteolocaleasybuildsoftwareabinitfossblib prepend_pathlibrary_pathhomeuclmodlgmatteolocaleasybuildsoftwareabinitfossblib prepend_pathpathhomeuclmodlgmatteolocaleasybuildsoftwareabinitfossbbin prepend_pathpkg_config_pathhomeuclmodlgmatteolocaleasybuildsoftwareabinitfossblibpkgconfig setenvebrootabinithomeuclmodlgmatteolocaleasybuildsoftwareabinitfossb setenvebversionabinit setenvebdevelabinithomeuclmodlgmatteolocaleasybuildsoftwareabinitfossbeasybuildabinitfoss beasybuilddevel q happen run sh modul load releasesa eb abinitfossbeb dr use custom easyconfig previou exampl use one offici easyconfig file ship easybuild packag case howev need perform custom build exampl may want compil latest stabl version abinit recent releas use differ version mayb need activ configur option present offici file case simpli copi origin easyconfig file chang accord need final pass custom file eb script first let look abinitfossbeb python easyblock configuremak name abinit version homepag httpswwwabinitorg descript abinit packag whose main program allow one find total energi charg densiti electron structur system made electron nuclei molecul period solid within densiti function theori dft use pseudopotenti planewav wavelet basi toolchain name foss version b toolchainopt usempi true pic true source_url httpswwwabinitorgsitesdefaultfilespackag sourc sourcelower_tar_gz checksum edabdcbaebcdfbcca depend libxc netcdffortran ensur mpi configopt withmpiy enableopenmpno blaslapack configopt withlinalgflavoropenbla linalg_libslebrootopenblaslib lopenbla fftw support configopt withfftflavorfftw fftw_libslebrootfftw lfftwf lfftw libxc support configopt withlibxcebrootlibxc hdfnetcdf configopt with_netcdfebrootnetcdf configopt with_netcdf_fortranebrootnetcdfminfortran configopt with_hdfebroothdf make sure freelinelengthnon ad fcflag configopt fcflagsfcflag freelinelengthnon runtest check sanity_check_path file bin x x abinit aim cutd conducti mrgddb mrgscr optic dir libpkgconfig moduleclass chem mean differ easyconfig paramet explain herehttpseasybuildreadthedocsioenlatestwriting_easyconfig_fileshtml case custom build requir chang one follow entri version string version number use download tarbal source_url toolchain version depend configopt string option pass abinit configur script chang version andor toolchain version straightforward use differ version abinit eg simpli chang valu version diff version version save new file abinitfossbeb execut eb abinitfossbeb robot instal new modul version everyth work box provid version still support version librari list depend token one compil version foss toolchain chang diff toolchain name foss version b toolchain name foss version provid releasesa avail cluster chang depend configopt requir basic understand abinit build system logic use easybuild autom compil need special eb file feel free contact abinit develop forum easybuild develop ask support author j van bever instal abinit ubuntu file describ instal abinit ubuntu procedur linuxbas system similar packag manag locat librari may differ explicit test done ubuntu page discuss instal abinit two differ approach use apt packag manag instal precompil version abinit compil abinit sourc use extern librari instal via apt possibl instal use binari file provid conda discuss use apt instal precompil version abinit type sudo apt instal abinit enter user password abinit instal smoothli depend warn version abinit like old one use abinit v print version number compil sourc ubuntu introduct sourc code latest stabl releas avail httpswwwabinitorgpackageshttpswwwabinitorgpackag compil sourc enabl one optim build activ mpi parallel custom linear algebra librari etc requir packag avail via apt instal syntax sudo apt instal packag use command apt search apt show search packag get info particular packag ubuntu packag instal execut bin folder eg usrbin locat execut found via unix command exampl gfortran show locat gfortran execut provid binari path packag interest compil code sourc socal develop packag denot dev suffix contain among other header file extens h provid declar prototyp name constant file usual instal includ folder eg usrinclud share librari file extens usual instal lib folder eg usrlib obtain locat file use command dpkg l packag dpkg packag prerequisit prerequisit first discuss qualit instal may depend linux distribut discuss compil sourc code possibl list prerequisit test ubuntu ubuntu similar ubuntubas distribut fortran compil possibl option gfortran gnu compil open sourc avail via eg apt gfortran packag ifort intel compil commerci compil slightli complic use optim intel architectur mpi librari instal want benefit parallel recommend possibl option open mpi apt libopenmpidev packag httpwwwopenmpiorghttpwwwopenmpiorg mpich apt libmpichdev packag httpwwwmpichorghttpwwwmpichorg depend distribut might need manual add mpidefaultdev packag metapackag mpi librari linear algebra librari instal fallback see next point avail insid abinit basic version lapack might want instal math librari especi parallel comput choos among bla libblasdev lapack liblapackdev scalapack libscalapackdev atla libatlasbasedev mkl intel might tri libmklfulldev packag mandatori librari hdf netcdf netcdffortran librari writeread binari file netcdf format librari avail via libhdfdev libnetcdfdev libnetcdffdev packag apt parallel io libpnetcdfdev requir libxc librari contain exchangecorrel potenti libxcdev packag note also possibl gener librari via abinit fallback sh cd fallback buildabinitfallbackssh latter case abinit configur file see later contain with_fallbacksy command requir instal requir packag apt assum rel simpl abinit build mpi support list command may chang depend linux distribut exact abinit version want compil librari want use sh compil sudo apt instal gfortran mpi librari choic open mpi sudo apt instal mpidefaultdev libopenmpidev math librari choic lapack bla sudo apt instal liblapackdev libblasdev mandatori librari sudo apt instal libhdfdev libnetcdfdev libnetcdffdev libpnetcdfdev libxcdev compil abinit normal user advis download latest stabl version websit replac newest version avail sh wget httpswwwabinitorgsitesdefaultfilespackagesabinittargz tar xzf abinittargz cd abinit creat work directori sh mkdir build cd build configur use sh configur withconfigfilemy_config_fileac my_config_fileac configur file discuss detail next section compil sh make j instal option sh make instal configur file configur script accept variabl flag custom configur exampl sh configur fcmpifort withmpiy tell abinit configur mpi build mpifort mpi wrapper obtain document differ variabl flag use sh configur help configur option detect automat configur exampl with_mpi set ye configur tri use parallel fortran compil mpifort automat detect mpi instal librari header h file instal open mpi packag via apt directori print termin use dpkg l libopenmpidev lot option must pass configur advis use extern configur file syntax sh configur withconfigfilemy_config_fileac exampl configur file build abinit mpi lapack bla automat detect libxc hdf netcdf sh mpi set with_mpiy enable_mpi_ioy linear algebra set with_linalg_flavornetlib linalg_libslusrlibx_linuxgnu llapack lbla mandatori librari with_libxcy with_hdfy with_netcdfy with_netcdf_fortrany note one use type flag _ insid config file eg withmpiy becom with_mpiy linalg_lib variabl explicitli set linux distrubut directori extract via dpkg l liblapackdev dpkg l libblasdev fine tune variabl flag particular linux distribut advis take look templat file abinitdocbuildconfigtemplateac exampl set linalg_lib templat file given line linalg_libslusrlocallib llapack lbla special librari might harder detect exampl follow section ad config file detect custom fft xml librari librari avail via apt libfftwdev libxmldev directori correspond librari header file found use dpkg l packag flag extract abinitdocbuildconfigtemplateac templat sh fast fourier set with_fft_flavorfftw fftw_cppflagsiusrinclud fftw_fcflagsiusrinclud fftw_libslusrlibx_linuxgnu lfftw lfftwf xml librari use multibinit with_libxmly libxml_fcflagsiusrlibx_linuxgnu libxml_libslusrincludelibxmllibxml lxmlf author torrent instal abinit maco file describ instal abinit maco use one follow approach homebrew packag manag macport packag manag compil sourc exampl macport abinit sourc use homebrewhttpbrewsh test maco high sierra maco mojav maco catalina homebrew offici formula abinit avail github repositoryhttpsgithubcomabinithomebrewtap prerequisit homebrew instal see httpbrewshinstal instal abinit first instal type brew tap abinittap instal abinit type brew instal abinit abinit instal smoothli depend note libxc netcdf fallback enabl default wannier bigdft avail homebrew atompaw instal separ formula follow extra option avail abinit formula withtestsuit run full test suit time consum withoutcheck skip buildtim test recommend withoutopenmp disabl openmp multithread withoutnetcdf build without netcdf support withoutlibxc build without libxc support withoutfftw build without fftw support withoutscalapack build without scalapack support use macportshttpwwwmacportsorg abinit avail macport project necessarili latest version procedur test mac os x v mountain lion v catalina prerequisit macport instal see httpswwwmacportsorginstallphp basic port alreadi instal gcc last version fortran variant fortran compil mpich openmpi mpi start prefer updat macport system sudo port selfupd sudo port upgrad outdat instal abinit instal abinit type sudo port instal abinit abinit port variant default abinit instal libxc wannier activ support fftw librari sudo port instal abinit xyz fftw xyx replac version abinit instal might skip xyz one version instal link abinit parallel linear algebra scalapack sudo port instal abinit xyz scalapack instal multithread openmp version abinit sudo port instal abinit xyz thread possibl mix previou variant sudo port instal abinit xyz fftwthreadsscalapack option avail see port info abinit compil sourc maco prerequisit maco xcode instal xcode command line tool type xcodeselect instal fortran compil instal possibl option gfortranformaco projecthttpsgithubcomfxcoudertgfortranformacosreleas gfortran binari httphpcsourceforgenethttphpcsourceforgenet gfortran binari httpsgccgnuorgwikigfortranbinariesmacoshttpsgccgnuorgwikigfortranbinariesmaco gfortran instal via packag manag macport homebrew fink intel fortran compil mandatori librari hdfhttpswwwhdfgrouporgsolutionshdf highperform data manag storag suit netcdfhttpswwwunidataucaredusoftwarenetcdf network common data form libxchttpstddftorgprogramslibxcdownload librari exchangecorrel function mpi librari instal want benefit parallel recommend possibl option mpich httpwwwmpichorghttpwwwmpichorg via packag manag openmpi httpwwwopenmpiorghttpwwwopenmpiorg via packag manag linear algebra librari instal default acceler framework instal maco abinit build system find might want instal parallel librari scalapack atla mkl etc abinit link acceler librari make sure code configur enablezdotbugfixy use otool l abinit print share librari requir program instal abinit sourc normal user advis get newest version websit replac newest version avail wget httpswwwabinitorgsitesdefaultfilespackagesabinittargz tar xzf abinittargz cd abinit creat work directori mkdir build cd build configur sequenti version use configur fcgfortran ccclang fcflags_extraffreelinelengthnon parallel version mpi instal configur fcmpif ccmpicc fcflags_extraffreelinelengthnon enablempi enablempiio gnu compil version beyond ffreelinelengthnon need replac ffreelinelengthnon fallowargumentmismatch compil make j instal option make instal rememb maco environ variant ld_library_path replac dyld_library_path exampl macportshttpwwwmacportsorg abinit sourc give exampl use abinit sourc get latest abinit version combin eas instal macport inde librari mandatori option use abinit avail macport project procedur test mac os x v big sur start prerequisit macport approach explain section use macportsusingmacport instal librari need abinit differ choic linear algebra mpi mention section compil sourcecompilingfromsourceundermaco focus choic openbla openmpi suppos gnu compil version use one might issu sudo port instal gcc sudo port instal openbla gccfortran sudo port instal openmpigcc gfortran sudo port instal fftw gfortran sudo port instal fftwsingl gfortran sudo port instal fftwlong gfortran sudo port instal hdf cxxgcchlopenmpi sudo port instal netcdf cdfdapxgccnetcdfopenmpi sudo port instal netcdffortran gccopenmpi sudo port instal libxc gcc option sudo port instal wannier accelerategcc sudo port instal atompaw accelerategcclibxc step one follow step describ subsect instal abinit sourc compil sourcecompilingfromsourceundermaco troubleshoot switch gnu compil version gnu compil version machin maco big sur v seen xcode need reinstal inde level abinit compil system librari lsystem found quit hard debug actual reinstal xcode might good practic solv problem use sudo rm rf librarydevelopercommandlinetool sudo xcodeselect instal might accept licenc screen also possibl first use sudo xcodebuild licens comment benefit option fallback wannier libpsml consult abinitfallback projecthttpsgitlababinitorgbuildbotabinitfallback gpu support abinit import gpu support current highli experiment use experienc develop encount problem pleas report yann pouillon anyth els gpurel paramet gpu support activ enablegpu option configur anoth option import withgpuflavor one select kind gpu support activ conveni option codenam withgpuprefix also provid order set automat relev paramet whenev possibl option avail well mainli finetun build paramet test purpos full descript option found abinitdocbuildconfigtemplateac file hesit ask question httpsforumabinitorg addit permit gpurel preprocessiong option have_gpu gener use have_gpu_seri serial gpu support have_gpu_mpi mpiawar gpu support cuda support present possibl ask singl doubleprecis cuda support configur script check cuda librari properli work howev whether doubleprecis actual support version cuda might ad futur call cuda routin care embed within defin have_gpu_cuda els endif preprocess block featur requir cuda work without correspond els part display error caus abinit abort permit cudarel preprocess option have_gpu_cuda gener use have_gpu_cuda_sp singleprecis calcul have_gpu_cuda_dp doubleprecis calcul highlevel routin directli access cuda featur put abinitsrc_manage_cuda lowlevel one abinitsharedcommonsrc_gpu_toolbox file belong nvidia must distribut abinit pleas discuss yann pouillon need insid abinit sourc tree build case cudarel develop done good coordin marc torrent yann pouillon cuda version take advantag multipl fft cuda fft batch abinit compil cuda version possibl build previou version test make chang cuda implement support devic capabilti revis magma support magma project aim develop dens linear algebra librari similar lapack heterogeneoushybrid architectur start current multicoregpu system recommend take advantag magma use abinit cuda magma distribut within abinit packag preliminari instal activ magma support build process use wihlinalgflavormagma configur level opencl support opencl support current discuss info come decis taken s_gpu support s_gpu librari provid higher perform better load balanc gpu hybrid comput share sever process eg mpi task support abinit futur version see httpligforgeimagfrprojectssgpu detail readm abinit abinit atomicscal simul softwar suit relev inform found abinit websitehttpswwwabinitorg forumhttpsforumabinitorg mani document file found doc directori see file installinstal gener compil instal instruct pleas see file copyingcopi copi condit licens copyright c abinit group file part abinit program free softwar redistribut andor modifi term gnu gener public licens publish free softwar foundat either version option later version program distribut hope use without warranti without even impli warranti merchant fit particular purpos see gnu gener public licens detail receiv copi gnu gener public licens along program see file copi write free softwar foundat inc templ place suit boston usa author jm beuken instal abinit v cento stepbystep recip describ build abinit fedorarhelcento nix distribut test __cento __ quick guid impatientquickguidefortheimpati quick guid impati mkl versionquickguidefortheimpatientmklvers prerequisit __fortran compiler__ possibl option gfortran gnu compil httpsgccgnuorghttpsgccgnuorg ifort intel compil commerci compil slightli complic use optim intel architectur __python interpreter__ v recommend __mpi library__ want benefit parallel recommend possibl option open mpihttpwwwopenmpiorg mpichhttpwwwmpichorg __linear algebra library__ possibl option mkl intel math kernel librari free downloadhttpssoftwareintelcomcontentwwwusendeveloptoolsmathkernellibrarychoosedownloadlinuxhtml recommend perform openblashttpswwwopenblasnet optim bla librari recommend gnu netlibhttpswwwnetliborg bla lapack scalapack atlashttpmathatlassourceforgenet automat tune linear algebra softwar __mandatori libraries__ hdfhttpswwwhdfgrouporgsolutionshdf highperform data manag storag suit netcdfhttpswwwunidataucaredusoftwarenetcdf network common data form libxchttpstddftorgprogramslibxcdownload librari exchangecorrel function __option libraries__ fftwhttpwwwfftworg librari comput discret fourier transform recommend gnu libxmlhttpxmlsoftorgdownloadshtml xml c parser recommend multibinit wannierhttpwwwwannierorg libpsmlhttpseslcecamorgpsml xmlfhttpsgitlabcomsiestaprojectlibrariesxmlf read pseudopotenti psml format instal tool librari mandatori librari instal dnf packag manag option librari compil sourc need step requir instal mpich fftw openbla dnf compil __a rel simpl parallel version abinit__ summar __instal compiler__ sudo dnf instal gccgfortran __instal mpi library__ mpich sudo dnf instal mpich mpichdevel __instal linear algebra library__ openbla sudo dnf instal openbla __instal mandatori libraries__ use hdf support parallel mpiio sudo dnf instal hdfmpich hdfmpichdevel sudo dnf instal netcdfmpichdevel netcdffortranmpichdevel sudo dnf instal libxc libxcdevel __instal fftw__ sudo dnf instal fftw fftwdevel __instal python interpreter__ sudo dnf instal python import continu import test whether develop environ properli configur check whether mpich packag instal execut follow command sh mpif version output sh bash mpif command found need find mpi wrapper instal instal mpich packag via dnf instal directori obtain use eg sh rpm ql mpichdevel grep mpif print sh usrlibmpichbinmpif path variabl need updat sh export pathusrlibmpichbinpath mpif version gnu fortran gcc red hat usrlibmpichbinmpif compil test instal abinit __download abinit__ normal user advis get latest stabl version websitehttpswwwabinitorgpackag replac newest version avail sh wget httpswwwabinitorgsitesdefaultfilespackagesabinittargz tar xzf abinittargz cd abinit __creat work directory__ sh mkdir build cd build __configur with__ sh configur withconfigfilemy_config_fileac my_config_fileac extern file provid configur flag option configur option present next sectiontheconfigfil __compil with__ make j j mean core use compil adjust valu accord number physic core avail machin run test suit issu sh cd test runtestspi fast j import end test one get someth like suit fail pass succeed skip disabl run_etim tot_etim fast complet averag time test stdev summari fail succeed pass skip disabl otherwis __problem__ compil see troubleshootingtroubleshoot __install__ option make instal configur file configur command take input variabl flag exampl sh configur withmpiy tell abinit enabl mpi support variabl flag support script found type sh configur help option detect automat script exampl option withmpiy abinit tri use parallel fortran compil found path eg mpifort tri detect directori contain librari associ header file requir mpi lot option need advis use config file ac file __our simpl parallel abinit__ build base openbla sh instal locat prefixhomeloc mpi set with_mpiy enable_mpi_ioy linear algebra set with_linalg_flavoropenbla linalg_libslusrlib lopenbla mandatori librari with_hdfy with_netcdfy with_netcdf_fortrany with_libxcy fft flavor with_fft_flavorfftw fftw_libslusrlib lfftw lfftwf enabl netcdf mode abinit use netcdf default io librari enable_netcdf_defaulty import name option ac file normal form initi remov option name charact string replac underscor _ follow simpl rule configur option withmpi becom with_mpi ac file go compil option librari fallback project wannier libpsmlxmlf enabl openmp use libxml quick guid impati build abinit follow compon gnu compil mpich openbla fftw instal requir packag sh sudo dnf instal gccgfortran sudo dnf instal mpich mpichdevel sudo dnf instal openbla sudo dnf instal hdfmpich hdfmpichdevel sudo dnf instal netcdfmpichdevel netcdffortranmpichdevel sudo dnf instal libxc libxcdevel sudo dnf instal fftw fftwdevel sudo dnf instal python get abinit tarbal sh wget httpswwwabinitorgsitesdefaultfilespackagesabinittargz tar xzf abinittargz cd abinit mkdir build cd build export pathusrlibmpichbinpath creat config file edit configac file sh instal locat prefixhomeloc mpi set with_mpiy enable_mpi_ioy linear algebra set with_linalg_flavoropenbla linalg_libslusrlib lopenbla mandatori librari with_hdfy with_netcdfy with_netcdf_fortrany with_libxcy fft flavor with_fft_flavorfftw fftw_libslusrlib lfftw lfftwf enabl netcdf mode abinit use netcdf default io librari enable_netcdf_defaulty compil abinit sh configur q withconfigfileconfigac make j test abinit sh cd test export openblas_num_thread runtestpi fast j nologo instal abinit sh make instal quick guid impati mkl version build abinit follow compon gnu compil mpich mkl instal need packag sh sudo dnf instal gccgfortran sudo dnf instal mpich mpichdevel sudo dnf instal hdfmpich hdfmpichdevel sudo dnf instal netcdfmpichdevel netcdffortranmpichdevel sudo dnf instal libxc libxcdevel sudo dnf instal python get abinit tarbal sh wget httpswwwabinitorgsitesdefaultfilespackagesabinittargz tar xzf abinittargz cd abinit mkdir build cd build export pathusrlibmpichbinpath creat configur file edit configac file sh instal locat prefixhomeloc mpi set with_mpiy enable_mpi_ioy linear algebra set with_linalg_flavormkl linalg_cppflagsimklrootinclud linalg_fcflagsimklrootinclud linalg_libslmklrootlibintel wlstartgroup lmkl_gf_lp lmkl_sequenti lmkl_core wlendgroup mandatori librari with_hdfy with_netcdfy with_netcdf_fortrany with_libxcy fft flavor with_fft_flavordfti fft_fcflagsimklrootinclud enabl netcdf mode abinit use netcdf default io librari enable_netcdf_defaulty compil abinit sh configur withconfigfileconfigac make j test abinit sh cd test export mkl_num_thread runtestpi fast j nologo instal abinit sh make instal neat new abinit test tool folder tool use fortran produc structur data output data use python side project smart test folder lower level tool handl convers data yaml document abinit develop maintain script contain sever script eas develop bzr_helper variou script facilit use bzr see document within mkroutinesh make new f routin correct robodoc header structur follow abinit rule mkmodulesh make new f modul ftto fixed_to_fre ftto perl script abl translat file written fortran fix format fortran free format rel well explain csh script fixed_to_fre driver ftto slightli chang output abirulespl sourc abirul script latter abl enforc automat abinit rule f file chang bash script chang automat express anoth whole set file make backup copi old version parent locat parent children f routin write routin varfileindexpi build file infosvarfileindexhtml refer input variabl insid input file test todo list document abinit first version todo written yann sever point adress mkdoc version still point worth discuss gener remark previs autotool support packag document reorgan relev section need discuss copyright histori inform might insert comment discuss file exist one format one multiformat depend store somewher known updat aim_helphtml uptod aimhelptexaimhelpp match aim_helphtml right one anaddb_helphtml uptod bandeps_help bare call document execut restart scratch check_list truli use mg xavier xavier could move file somewher conducti_manualtex complet accur uptod contributor format better file remov copyright notic cutd_help complet accur uptod cutd_helphtml match cutd_help right one remov link bottom remov copyright notic ddbsupgrad name ddbsupgradehowto reformat markdown elphon_manualp violat gpl sourc relicens format_kss complet accur uptod reformat markdown gwmanualtxt complet accur uptod reformat markdown known_problemsxyz gener automat databas present reversechronolog order make_help make_dev_help make_targz_help makefile_macros_help uptod chang autotool support mrgddb_helphtml bare format prepar text version markdown remov link bottom remov copyright notic new_user_guidehtml complet accur uptod other_cod probabl outofd setup databas paral_us complet accur uptod piezoelectrictxt note evolv lot reformat markdown plan complet accur uptod reformat markdown remov copyright notic problem_report uptod reformat markdown remov copyright notic respfn_helphtml complet accur uptod spacegrouphelpfilehtml spgrdefinitionhtml spgrdescriptionhtml spgrheadhtml spgrcopyrighthtml rewritten done mg tune complet accur uptod welcomehtml complet accur uptod prepar text version markdown may take time remov link bottom remov copyright notic featuresfeatur file extens vari choos one bare format almost plaintext reformat markdown remov copyright notic imag imag tutori noth installation_notesinstallhtm file extens vari choos one sourc even valid html improv layout prepar text version markdown may take time remov link bottom remov copyright notic macroave_docsreadm readi markdown remov copyright notic macroave_docsmacroavetexpspdf complet accur uptod macroave_docsmacroavetoc temporari file remov miscellan use complet accur uptod reformat discuss type prioriti notes_for_cod complet accur uptod reformat allow multiformat present presentationtex complet accur uptod presentationpresentationpdfgz small file anyway decompress psp_infosinfo file reformat order produc html pdf version inform release_notesrelease_not file extens vari choos one plaintext version requir gnu code standard bare format almost plaintext reformat markdown remov copyright notic theori complet accur uptod find explicit name tutorialhtml welcomehtml renam someth like summaryhtml sourc even valid html fix upgrad xhtml part pdf manual remov link top bottom remov copyright notic readme_conda conda_env author dca xg rc new user help file page give beginn introduct abinit resourc packag main abinit applic foreword abinit project group effort dozen peopl worldwid develop main abinit applic deliv mani file postprocessor test document abinit packag abinit project includ also resourc provid abinit web sitehttpswwwabinitorg github organizationhttpsgithubcomabinit read present page get grasp main abinit applic get theoret background case alreadi use anoth electron structur code quantum chemistri code might suffici read introduct citepayn never use anoth electron structur code quantum chemistri packag complet read go pace chap appendic l rm martin book citemartin gone present new user guid follow abinit tutorialtutori introduct abinit packag whose main program allow find total energi charg densiti electron structur system made electron nuclei molecul period solid within densiti function theori use pseudopotenti planewav basi augment plane wave even wavelet possibl abinit go beyond densiti function theori ie manybodi perturb theori gw approxim bethesalpeth equat timedepend densiti function theori dynam meanfield theori allenheinecardona theori find temperaturedepend electron structur abinit also includ option optim geometri accord dft forc stress perform molecular dynam simul use forc gener dynam vibrat phonon properti dielectr properti mechan properti thermodynam properti etc addit main abinit code differ util program provid suppos download abinit packag web site unpack instal might nevertheless continu read present web page get overview might prove fruit first download abinit packag least unpack see instal notesinstal note use name abinit refer directori contain abinit packag download practic version number append name give exampl abinit abinit packag version scheme explain later file abinit contain differ subdirectori exampl present file well descript file found abinitdoc subdirectori describ later main execut abinit compil main code present packag abinitsrc_mainabinit perhap anoth place depend instal run abinit need three thing access execut abinit input file pseudopotenti input file kind element unit cell item job run full list input variabl provid singl input file given abinit varsetallvarslist variabl detail descript input variabl given mani variabl set file includ basic variabl varsetbas groundstat calcul variabl varsetgst gw variabl varsetgw file handl variabl varsetfil parallelis variabl varsetpar densiti function perturb theori variabl varsetdfpt set exampl aim guid beginn avail tutorialindextutori test case input file found abinittest subdirectori eg fast vx seri v v vmbpt v v libxc paral tutox seri mani differ sort pseudopotenti use abinit found atom data fileshttpswwwabinitorgdownloadsatomicdatafil page abinit web site offici recommend pseudopotenti tabl paw jth tabl normconserv tabl oncvpsp also older set pseudopotenti inform pseudopotenti file found helpabinitabinit help file theorypseudopotentialspseudopotenti theori document abinit wikihttpswikiabinitorgdokuphpiddeveloperspseudo topicpseudospawpseudospaw topic warn subset exist pseudopotenti use test case locat abinittestspsps_for_test directori recommend product program packag addit abinit util program provid packag util program written fortran like main abinit program sourc also abinitsrc_main includ mrgddb anaddb allow one postprocess respons atom displac andor homogen electr field andor strain perturb gener abinit produc full phonon band structur thermodynam function piezoelectr properti superconduct properti name mrgddb merg deriv databas anaddb analysi deriv databas cutd use postprocess threedimension densiti potenti file gener abinit allow one deduc charg densiti select plane isodens plot along select line select point allow one also make hirshfeld decomposit charg densiti atom contribut foldbloch use unfold firstprincipl electron band structur aim also postprocessor threedimension densiti file gener abinit perform bader atominmolecul decomposit charg densiti atom contribut conducti allow one comput frequencydepend optic conduct util program written fortran python contain abinitscript postprocess numer tool pre process script distinguish allow one visual abinit output like abinit_eignc_to_bandstructurepi resourc outsid abinit packag addit abinit packag resourc obtain abinit github sitehttpsgithubcomabinit sourc latest version abinit packag actual mirror site resourc packag download point abipyhttpsgithubcomabinitabipi opensourc librari analyz result produc abinit includ visualis prepar input file workflow autom calcul socal highthroughput calcul provid interfac pymatgenhttppymatgenorg develop materi projecthttpmaterialsprojectorg abinit tutori base abipi avail abitutori repositoryhttpsgithubcomabinitabitutori pseudodojohttpwwwpseudodojoorg python framework gener valid pseudopotenti paw atom data file normal abinit user benefit lot project sinc abinit recommend tabl normconserv pseudopotenti gener thank recommend paw tabl also provid via pseudodojo interfac abiconfighttpsgithubcomabinitabiconfig hold area configur file use configurecompil abinit cluster might benefit instal abinit cluster abiflowshttpsgithubcomabinitabiflow provid flow highthroughput calcul abinit abicondahttpsgithubcomabinitabiconda contain conda recip build abinitrel packag like abipi might benefit instal abipi machin addit resourc abinit develop provid commun abinit packag portal github mani abinitindepend commerci free applic use visual abinit output interact abinit provid well maintain list link last section httpwwwabinitorgsponsorshttpwwwabinitorgsponsor cours might get brows web input variabl abinit overview import input variabl provid input file list specif geometri problem type atom natom total number atom unit cell ntypat number type atom typatnatom sequenc integ specifi type atom note atom coordin xcart xred must specifi order rprim unscal primit translat period cell column array one primit translat xcartnatom cartesian coordin bohr atom unit cell note use xred absent xrednatom fraction coordin atom locat note leav xcart use znuclntypat nuclear charg type element must agre nuclear charg found psp file specif planewav basi set brillouin zone wavevector sampl occup band ecut planewav kinet energi cutoff hartre kptopt option specifi kpoint grid kptopt automat gener use ngkpt shiftk ngkpt dimens threedimension grid kpoint occopt set occup electron level semiconductor metal specif type calcul done ionmov ionmov ion cell shape fix search equilibrium geometri molecular dynam iscf either posit number defin selfconsist algorithm usual band structur fix potenti optdriv gw calcul manybodi perturb theori rfelfd respons calcul electr field rfphon respons calcul atom displac specif numer converg calcul nstep maxim number selfconsist cycl order tolvr toler selfconsist converg ntime number molecular dynam relax step tolmxf forc toler structur relax hartreebohr output file output abinit run show sever file standard output usual one run command pipe standard output log file inspect warn error messag anyth goe wrong otherwis discard end run easili readabl format output goe standard output file gener abinit default extens abo error messag report latter file hand file usual kept archiv purpos addit wavefunct input start point output result calcul possibl charg densiti andor electrostat potenti ask three set data store unformat binari file nativ fortran netcdf format densiti state do also output format readabl file analysi geometri also provid geo file name file construct root name might differ input file output file either provid abinit provid user code append descriptor like wfk wavefunct den densiti pot potenti do densiti state also differ temporari file also construct root name amongst file statu file summar current statu advanc code long job helpabinitabinit help file contain detail code simplest sort job comput electron structur fix set atom posit within period unit cell electron structur mean set eigenvalu wavefunct achiev lowest dft energi possibl basi set number planewav code take descript unit cell atom posit assembl crystal potenti input atom pseudopotenti use either input wavefunct simpl gaussian gener initi charg densiti screen potenti use selfconsist algorithm iter adjust planewav coeffici suffici converg reach energi analyt deriv energi respect atom posit unit cell primit translat yield atom forc stress tensor code option adjust atom posit move forc toward zero adjust unit cell paramet move toward zero stress perform molecular dynam also use find respons atom displac homogen electr field full phonon band structur construct version logic finish help new user brief explan logic abinit version releas full name version three digit exampl first digit slowli vari one averag chang two three year indic major effort trend version level xy abinit major effort place groundstat properti total energi forc geometri optimis molecular dynam version xy responsefunct featur phonon dielectr respons effect charg interatom forc constant includ main addit characterist version xy distribut gnu gener public licenc setup document help user web site html format avail gw capabl version xy put lot effort speed abinit eg paw parallelis histor develop explain test gather directori v v v etc everi month releas product version abinit second digit even number increment usual goe addit featur releas note documentaboutreleasenot issu list addit capabl inform respect modif previou releas odd second digit use intern manag socal develop version abinit exampl two version differ last third digit capabl one largest last digit debug version debug new featur ad like addit bug order start use abinit pleas follow tutorialindexthi tutori learn compil code sourc pleas consult follow guid emb srchttpswikiabinitorglibexefetchphpmediabuildinstalling_abinitpdf typeapplicationpdf width heightpx get start mkdoc warn code support py python pyk strongli suggest especi build final version deploy pyk nativ support unicod instal python packag requir build static websit pip instal r requirementstxt instal mkdoc plugin cd abimkdocs_plugin python setuppi instal use conda may want creat new environ base python conda creat n abinitabimkdoc python sourc activ abinitabimkdoc instal packag pip see command mkdoc come builtin devserv let preview document work make sure abinit start custom server run mksitepi serv command dirtyreload option consol mksitepi serv dirtyreload regener databas save databas usersgmatteogit_reposabidocsdocteststest_suitecpkl initi websit gener complet gener markdown file input variabl code abinit info build document info clean site directori server serv http handler start watch chang handler start detect chang open http browser youll see default home page display use mksitepi help get list command mksitepi command help get document command note topic still yaml format wikilink syntax span stylebackgroundcolor eeefonts namestext span becom span stylebackgroundcolor eeefonts textnamespac span troubleshoot get error messag ascii use default encod machin add export lc_allen_usutf export langen_usutf bashrc sourc add new variabl yaml databas replac python modul variabl declar abinitabimkdocsvariables_codenamepi file consist list dictionari dictionari contain declar singl variabl associ document markdown format wikilink latex markdown extens use insid text exampl declar accuraci variabl python python variabl abivarnameaccuraci varsetbas vartypeinteg topicsplanewaves_bas scfcontrol_bas dimensionsscalar defaultv mnemonicsaccuraci text allow tune accuraci calcul set automat variabl accord follow tabl accuraci ecut e_min e_m e_m e_max e_max e_max pawecutdg ecut ecut ecut ecut ecut ecut fband parallel calcul timopt enforc ad new variabl easi edit python modul add new item end list templat provid add new bibtex entri citat must bibtex format provid enough inform python code gener appropri link websit publish work doi strongli recommend avoid cutpast bibtex file unit test enforc presenc particular entri bibtex document bibtex may fullfil requir much better solut use betterbib doi articl fetch data crossref produc bibtex entri betterbib avail python packag index simpli type pip instal betterbib use doibibtex command line doibibtex physrevlett add entri bibtex file use firstauthoryear convent key make sure duplic entri note bibtex id must form firstauthornameyear eg amadon start uppercas letter lower case fourdigit year possibl letter might ad case ambigu eg exist also amadona build html page use mksitepi serv run test teststest_bibtexpi pytest see next section valid chang run unit test unit test locat test directori execut test instal pytest pip instal pytest pytest v test use pytest v teststest_variablespi execut particular modul check link linkcheck build websit mksitepi build use linkcheck siteindexhtml linkserr import time linkcheck python instal note abinit page provid introduct instal abinit packag compil execut also discuss test whether compil success run intern test suit final give relat complement develop comment suggest improv procedur page welcom simpli contact abinit group discours forumhttpsdiscourseabinitorg overview vast major peopl will use abinit simpl user develop unixlinux maco work termin installationcompil step prerequisit need fortran compil c compil python interpret mandatori librari blaslapack fft netcdf hdf libxc possibl recommend librari mpi option librari wannier librari instal help fallback procedur see info step altern may want instal everyth sourc use procedur detail tutorialtutorialcompil get latest version abinit packagehttpswwwabinitorgpackag abinitxyztargz abinit web site inform avail herehowtogetaversionofabinit prepar configur file name hostnameac contain inform librari compil option step mandatori abinit configur script tri detect instal locat option provid automat detect procedur fail see inform well sectionhowtowritethehostnameacfil issu configur even better first creat tmp directori build cd tmp final run configur within build directori detail consult linkhttpswikiabinitorgdokuphpidbuildconfigur issu make make jn compil n processor eg make j use four processor step might take dozen minut depend compil option inform avail herehowtomaketheexecut option issu make instal instal packag root privileg need instal direct specifi via prefix note detail step might vari significantli depend oper system detail provid tutorialtutorialcompil cover scenario want build everyth sourc instal librari home directori also page focus macosinstall_maco centosinstall_cento ubuntuinstall_ubuntu discuss bypass compil extern librari use homebrew macport maco dnf cento apt ubuntu exampl configur file compil abinit cluster avail abiconfig packag github specif directori abinitvhttpsgithubcomabinitabiconfigtreemasterabiconfigclust configur file use buildbot testfarm avail autoconf_exampl sectiondevelopersautoconf_exampl abinit wikihttpswikiabinitorg also build abinit section might use particular current document fallback procedur avail herehttpswikiabinitorgdokuphpidbuildfallback configur option document pagehttpswikiabinitorgdokuphpidbuildconfigur succeed build execut would like check whether execut work properli pleas consult two section intern testshowtoruntheinternaltest automat testshowtomaketheautomatictest want much better handl abinit sourc code normal user download abinit gitlab github anyhow consult section developersfordevelop get version abinit assum f compil unixlinux maco x want compil sourc file perhap modifi andor add new file typic scenario user system administr follow _xyz_ repres abinit version order get abinit packag first download file abinit_xyz_targz packag webpagehttpswwwabinitorgpackag abinit web site issu sh gunzip abinitxyztargz tar xvf altern may use sh wget httpswwwabinitorgsitesdefaultfilespackagesabinitxyztargz tar xzf abinitxyztargz correctli done main directori denot abinit present document usual real name abinit_xyz_ whole set subdirectori creat includ sourc file insid _src_ directori tarbal fallback script creat librari directori _fallbacks_ document _doc_ directori complet set test pseudopotenti need automat test directori _tests_ script configur option need gener configur makefil _config_ directori obvious packag contain object file binari execut built make note also pseudopotenti product run ship packag tarbal contain sever dozen pseudopotenti test purpos abinittestspsps_for_test largest set pseudopotenti paw atom datafil product run found abinit atom data pseudopotenti paw dataset web pagehttpwwwabinitorgpspt pseudopotenti gener mani differ user might share might contact web site httpswwwabinitorg contain mani resourc includ link forum mail list abinit event etc last least tutori document page compil execut suppos f compil want compil sourc file case provid configur util inform locat f compil sometim even c compil adequ compil option want produc parallel binari locat mpi librari although present build tool power enough succeed build binari without give inform signific number platform observ still better specifi option explicitli order avoid suboptim execut downgrad capabl suppos lucki case build system abl detect requir build abinit rather simpl issu configur first creat tmp directori cd tmp configur make make jn compil n processor smp machin eg make j four processor might take two minut option make instal well might also one addit inform need case someth like sh configur fcgfortran make might work case let explain bit done possibl configur step produc set makefil file among thing take account inform machin hostnameac file take three minut less make step compil everyth accord makefil file produc previou step execut locat subdirectori abinitsrc_main chosen issu configur abinit directori issu configur anoth directori place accordingli import time requir build everyth highli depend compil platform ghz quadproc machin use make j whole compil minut platform one processor might one hour make command accept name target option argument compil one execut configur step issu sh make name_of_the_binari name_of_the_binari abinit cutd anaddb etc also sh make instal instal packag usrloc directori write hostnameac file let come back case build system need inform inform store file name hostnameac hostnam result execut command hostnam tip note command hostnam default return fulli qualifi domain name fqdn eg abirefpcpmuclacb first word return chain charact need eg abiref reason use hostnam templat hostnameac file locat abinitdocconfig name configtemplateac exampl file use test packag testfarm found abinitdocbuildconfigexampl equival autoconf_exampl sectiondevelopersautoconf_exampl addit exampl configur file cluster provid abiconfig project avail herehttpsgithubcomabinitabiconfigtreemasterabiconfigclust exampl provid abinitdocbuildconfigexampl directori contain five import variabl locat fc compil f c compil option locat mpi librari enabl hand mani addit control flag with_xyz need advanc use hostnameac file might place home directori insid new directori name abinitbuild opt solut everi time instal new version abinit configur file automat use configur script care anymor file first instal hand want play sever configur place hostnameac file abinit directori hostnameac file also seen build system prefer one locat abinitbuild insid build directori like abinittmp mention might even input option contain hostnameac file directli command line note order preced locat hostnameac file commandlin interfac case one possibl use decreas order preced command line overcom inform build directori abinittmp abinit top sourc directori abinit abinitbuild etcabinitbuild hostnameac file readi come back configuremak sequenc run intern test abinit code sever small intern test three basic one call fast v v one librari bigdft etsf_io libxc wannier issu automat check automat whether result correct test avail whether got packag web abinit archiv cours need compil abinit order run intern test moreov simpl implement procedur assum execut locat abinitsrc_main standard locat issu make begin fast suit simpli issu command sh make test_fast run second print text statu file report builtin test fast run finish cleanli moreov comparison total energi relev quantiti refer valu success mean problem present howev pleas run complet set abinit test gain better confid instal mean intern fast suit ran success get messag execut properli gener problem makefil drive intern test case tri solv problem contact somebodi abinit group addit small messag access gener file locat insid testsbuiltininput subdirectori suppos fast test ok might issu command sh make tests_in fast test execut follow intern test hope get posit diagnost test cours bigdft etsf_io libxc wannier need appropri librari instal order work properli inform intern test see abinittestsbuiltinreadm file might read new user guideguidenew_us order learn use code follow four basic tutori see entri page tutorialstutori use consid instal success might continu read present web page tri perform speed test well test execut automat test workhors script run test suit call runtestspi flexibl reason set test contain fast vx directori execut automat issu insid abinittest directori command sh runtestspi eg sh runtestspi j run test suit parallel core recommend procedur develop order execut test need larger disk space simpl instal code total addit disk space requir order gb command line option runtestspi numer pleas issu sh runtestspi help order access document exampl consult video asciicasthttpsasciinemaorgapnghttpsasciinemaorga let us examin differ subdirectori abinittest directori abinittestsfast simplest content describ detail test parallel version see directori testspar test respons function featur abinit test mrgddb anaddb see subdirectori testsv directori testsv testsv etc present test recent implement featur abinit testsfast sequenti version subdirectori contain basic set test code aim test whether code coher time success version exercis sever part code howev examin accuraci physic problem mainli number plane wave small test run selfconsist converg mb memori enough test input file test found abinittestsfastinput directori bottom input file section metadata paramet defin test metadata mention execut use output file analyz admit toler respect refer output file author test brief descript test run test directori simpli issu sh runtestspi fast abinittest directori script creat directori name test_suit result store directori output file automat compar set refer file abinittestsfastref thank gnu diff util correspond differ file prefix diff addit diff two level automat analysi one base python diff tool call fldiff produc fldiffreport file anoth output fldiff analyz produc brief report call report latter step perform case test case one directori perform includ case test differ directori perform onelin summari produc fldiff see later compar toler indic input file metadata ad end input file procedur produc file call report one line assess behaviour test succeed everyth ok pass test ok user product pass margin test within usual accept deviat like ok applic still improv develop team though fail problem deviat usual accept far conveni tool analyz automat test abinit vast major test case succeed pass platform use develop team louvainlaneuv problem mention file abinitknown_problem addit might specif problem test case platform also mention abinitknown_problem apart known problem mention file report file mention test case succeed pass compar tool fldiff float diff perform detail way comparison float number output file refer file case diff command use present run insid one directori one singl file call fldiffreport produc gather analysi test directori one test case two file differ number line fldiffreport file report compar two file usual problem seen level command sign appear sometim first column output file typic error messag announc someth went wrong case_ diff analysi pursu command sign differ contrast identifi float number ignor differ within prescrib toler differ relev exampl abl ignor differ time everyth goe fine test fldiff identifi differ date execut possibl version number possibl platform descript possibl overal execut time alway print even without differ success execut one test case may announc follow fldiffreport file case_ version abinit version abinit start date mon may start date mon apr overal time end sec cpu wall overal time end sec cpu wall summari case_ signific differ found fldiffreport file one section test_cas run begin number test case includ block three line number line someth happen follow content two line final onelin summari test case inform fldiff script found abinittestsscriptsfldiffpl file testsv directori contain test built spirit testfast directori exercis basic featur like treatment metal gga new pseudopotenti multidataset mode cell paramet optim spatial symmetri group databas develop develop time version abinit cours automat differ procedur compar recent run abinit code fast test case fldiffreport report file also avail mb memori enough test testsv directori contain test built spirit testsfast testsv directori exercis featur present version abinit packag mainli respons function featur use mrgddb anaddb code automat differ procedur compar recent run abinit code fast test case fldiffreport report file also avail mb memori enough test testsv testsv testsv testsv testsvmbpt testsv testsv testsv testsbigdft testsetsf_io testslibxc testswanni directori contain test built spirit testsfast testsv testsv directori exercis featur present version abinit packag notic use gw code util cutd aim paw interfac fallback automat differ procedur compar recent run abinit code like fast test case fldiffreport report file also avail mb memori enough test testspar testsmpiio need mpi support directori contain test built spirit testfast directori exercis parallel version abinit code script runtestspi consid one differ input file file use parallel code one process node perform differ parallel run increas number process node specifi metadata contain input file seri test diff fldiff util use automat fldiffreport report file produc automat develop note document avail page label developersdevelopersgit_and_gitlab well develop corner wikihttpswikiabinitorg follow section complement instal gitlab gener abinit distribut git autotool makemak want full handl packag compil modif file write script need addit prerequisit free softwar applic git automak autoconf libtool explicitli need minim version number upgrad gnu autoconf ftpftpgnuorggnuautoconfautoconftargz gnu automak ftpftpgnuorggnuautomakeautomaketargz gnu libtool ftpftpgnuorggnulibtoollibtooltargz gnu ftpftpgnuorggnummtargz tool pleas consult local comput guru andor follow page overview abinit developmenthttpswikiabinitorgdokuphpiddevelopersoverview step hike abinithttpswikiabinitorgdokuphpiddevelopershik buildbot test farmhttpswikiabinitorgdokuphpidbboverview want develop regular basi pleas gitlab access creat contact jeanmichel beuken describ page occasion might well reli abinit github web sitehttpsgithubcomabinit strongli advis subscrib abinit discours forumhttpsdiscourseabinitorg receiv latest inform concern new develop instal git obtain gitlab branch abinit intern server creat autonom copi sourc code top make develop explain abinit wiki gitlab abinit specificitieshttpswikiabinitorgdokuphpiddevelopersgitspecificities_git_abinit gitlab branch intern server permiss clonefetchpul also commitpush modif might altern download branch archiv abl commit branch start modifi abl includ afterward archiv work git clone creat local archiv daili work archiv link main abinit archiv effici techniqu recommend make independ manag work abl creat new branch one big advantag approach peopl work laptop develop commit safe without network connect make sure abinit prerequisit compil librari etc set ac file stage abl compil cd newli creat abinit directori issu sh configscriptsmakemak command initi whole set file script need autotool well global work abinit sourc initi might take two minut initialis proceed configuremak procedur describ section gener sourc packag want produc sourc packag abinit_xyz_targz compil test abinit issu sh make dist insid abinit author mg superconduct properti within isotrop eliashberg formal tutori explain comput phonon linewidth induc electronphonon eph interact metal system use eliashberg spectral function alphaf mcmillan equat estim superconduct critic temperatur t_c within isotrop eliashberg formal start present basic equat implement code connect abinit variabl discuss run isotrop t_ccalcul perform typic converg studi mgb_ wellknown phononmedi superconductor t_c k complet theoret introduct see citegiustino refer therein assum user alreadi complet two tutori rftutorialrf rftutorialrf hesh familiar calcul ground state vibrat properti metal user read fourth lesson altutorialbas well introduct page eph codetutorialeph_intro run exampl lesson take hour formal connect implement due interact electron vibrat energi get renorm phonon acquir finit lifetim manybodi effect describ phononelectron selfenergi pi_qqnuww dfracn_kk sum_mnkk g_mnnukk qq dfracf_nk f_mkqee_nk ee_mkq ww ieta contribut second order eph vertex g includ sum electron wavevector kk perform first bz eta posit real infinitesim gkkp eph matrix element discuss eph introductioneph_intro selfenergi depend temperatur via fermidirac distribut function fee factor two account spin degeneraci henceforth assum nonmagnet system scalar wavefunct ie nsppol nspinor thu electron energi ee eph matrix element g depend spin real part pi_qnu give correct vibrat energi due eph interact phonon linewidth gamma_qqnu full width half maximum twice imaginari part pi_qnu evalu bare phonon frequenc ww_qnu comput dfpt gamma_qqnut pi_qnuwwww_qnu use sokhotskiplemelj theoremhttpsenwikipediaorgwikisokhotskieplemelj_theorem lim_eta rightarrow dfracx pm ieta mp ipideltax mathcalpdfracx imaginari part pi rewritten pi_qqnuww_qnu dfracpin_kk sum_mnkk g_mnnukk qq f_nk f_mkqdeltaee_kk n ee_mkpq ww_qnu delta function enforc energi conserv scatter process phonon energi typic small compar electron energi energi differ ee_kk n ee_mkpq also small henc possibl approxim differ occup factor f_nk f_mkq approx fee_nk ee_kk n ee_mkpq fee_nk ww_qnu low deriv fermidirac occup function strongli peak around fermi level thu approxim fee_nk approx deltaee_nk ee_f neglect ww_qnu argument delta obtain socal doubledelta approxim dda phonon linewidth citeallen beginequationlabeleqdda_gamma gamma_qqnu dfracpi ww_qqnun_kk sum_mnkk g_mnnukk qq deltaee_kpq ee_f deltaee_kk n ee_f endequ given phonon wavevector qq dda restrict bz integr electron transit kk kq state fermi surfac fs henc dens kkmesh need converg gamma_qqnu converg rate expect slower requir electron do per spin ee_f gee_f dfracn_kk sum_nkk deltaee_nkk ee_f singl dirac delta involv note dda break small qq phonon frequenc neglect note also dda predict linewidth depend also worth stress anoth import contribut phonon lifetim induc nonharmon term taylor expans bornoppenheim energi surfac around equilibrium point within framework manybodi perturb theori nonharmon term lead phononphonon scatter process give substanti contribut lifetim especi high rest tutori howev nonharmon term ignor mainli focus comput imaginari part phonon selfenergi pi harmon approxim level implement eph_intmeth input variabl select techniqu integr doubl delta fs eph_intmeth default activ optim tetrahedron scheme citekawamura implement libtetrabz libraryhttplibtetrabzosdnjpen_buildhtmlindexhtml eph_intmeth replac dirac distribut gaussian function finit width later case one choos constant broaden sigma specifi hartre eph_fsmear adapt gaussian scheme activ eph_fsmear statedepend sigma_nk automat comput electron group veloc v_nk cite note adapt gaussian scheme intern use code also optim tetrahedron method employ sinc dda illdefin qq gamma import tetrahedron method accur requir broaden paramet note howev present implement comput cost doubl delta tetrahedron method quickli increas size kkmesh adapt gaussian scheme may repres valid altern especi dens kkmesh need valu fermi level ee_f automat comput ks eigenvalu store input wfk file accord two input variabl occopt tsmear variabl usual equal one use gsdfpt calcul although possibl chang valu ee_f eph calcul use three mutual exclus input variabl eph_fermi eph_extrael eph_dop may use one want studi effect dope within rigid band approxim concern comput electron do prtdo dosdelta tsmear sum band eqrefeqdda_gamma restrict bloch state within symmetr energi window thick eph_fsewin around ee_f valu chosen accord fs integr scheme eph_intmeth valu eph_fsmear standard gaussian addit detail given tutori kkmesh electron defin input variabl ngkpt nshiftk shiftk paramet must equal one use gener input wfk file pass eph code code comput gamma_qqnu qqpoint ibz associ eph_ngqpt_fin qqmesh dfpt potenti interpol start abinitio ddb_ngqpt qqmesh associ input dvdbddb file eph_ngqpt_fin specifi eph_ngqpt_fin ddb_ngqpt assum interpol scatter potenti qqspace perform phonon linewidth gamma_qqnu known ibz abinit comput isotrop eliashberg function defin alphafww dfracn_qq n_f sum_qqnu dfracgamma_qqnuww_qqnu deltaww ww_qq nu n_f densiti state do per spin fermi level eliashberg function equival express alphafww dfracn_qq n_kk n_f sum_kkqq mn nu g_mnnukk qq deltaee_kpq ee_f deltaee_kk n ee_f deltaww ww_qq nu physic perspect alphafww give strength phonon energi hbarww scatter electron state fs rememb abinit use atom unit henc hbar quantiti access experi experi shown alphafww qualit similar phonon do fww fww dfracn_qq sum_qqnu deltaww ww_qq nu surpris equat alphafww resembl one fww except weight factor fracgamma_qqnuww_qqnu also explain alphaf notat eliashberg function seen phonon do time posit frequencydepend prefactor alphaww warn converg alphafww usual requir fine kk qqmesh especi true fs significantli deviat free electron pictur spheric fs andor eph coupl strongli anisotrop mgb_ kkmesh affect qualiti individu gamma_qnu linewidth wherea dens qqmesh may need resolv fine detaul andor sampl region qqspace coupl strong techniqu use comput alphafww defin ph_intmeth note ph_ prefix instead eph_ gaussian ph_intmeth ph_smear smear linear tetrahedron method citeblochl ph_intmeth default implement alphafww function evalu linear mesh step ph_wstep cover entir rang phonon frequenc total eph coupl strength lambda dimensionless measur averag strength eph coupl defin first invers moment alphafww lambda int dfracalphafwwwwddww sum_qqnu lambda_qqnu introduc modedepend contribut lambda_qqnu dfracgamma_qqnupi n_f ww_qqnu warn due omega factor lowenergi mode expect contribut lambda highenergi mode hand alphafww go zero ww ww rightarrow integrand function finit acoust limit obvious system dynam stabl neg frequenc bz lambda explod mean found roomtemperatur superconductor principl t_c obtain solv isotrop eliashberg equat superconduct gap see eg citemargin mani applic prefer bypass explicit solut estim t_c use semiempir mcmillan equat citemcmillan improv version propos citeallen t_c dfracww_log exp biggl dfrac lambdalambda mu mu biggr mu describ screen electronelectron interact ww_textlog logarithm averag phonon frequenc defin ww_textlog exp biggl dfraclambda int dfracalphafwwwwlogwwddww biggr pratic applic mu treat extern paramet typic adjust reproduc experiment result default valu eph_mustar conclud brief theoret introduct would like stress present formal assum singl superconduct gap weak depend kk possibl averag anisotrop equat fs approxim becom valid socal dirtylimit metal impur impur tend smear anisotropi superconduct gap detail discuss isotropicanisotrop formul found citemargin todo transport properti normal metal state allen obtain approxim relat conduct metal transport spectral function ftr variant eliashberg spectral function f lowestord variat approxim lova citeallenb citeallen eph_transport get start tutorial_readm begin might consid work differ subdirectori tutori creat work_ephisotc abi_teststutorespfninput sh cd abi_teststutorespfninput mkdir work_ephisotc cd work_ephisotc lesson prefer focu eph calcul associ converg studi reason reli precomput dennc ddb dfpt potenti bypass gs dfpt part dennc file use perform nscf comput arbitrarili dens kkmesh dfpt potnc file merg mrgdv util produc dvdb databas requir eph code note file ship offici abinit tarbal rel larg order run exampl tutori need download file github repositoryhttpsgithubcomabinitmgb_ephisotc git instal machin easili fetch entir repositori sh git clone httpsgithubcomabinitmgb_ephisotcgit altern use wget sh wget httpsgithubcomabinitmgb_ephisotcarchivemasterzip curl sh curl l httpsgithubcomabinitmgb_ephisotcarchivemasterzip masterzip simpli copi tarbal click download button github web page unzip archiv renam directori sh unzip masterzip mv mgb_ephisotcmast mgb_ephisotc warn directori precomput file must locat insid _work_ephisotc_ must name mgb_ephisotc reason input file exampl tutori read data extern file specifi term rel path abipi script use perform gs dfpt step avail herehttpsgithubcomabinitmgb_ephisotcblobmainrun_mgb_phononspi order facilit comparison previou studi use normconserv pseudopotenti cutoff energi ecut ha experiment paramet hexagon mgb_ ca calcul perform xx ngkpt gammacent kkgrid electron coars marzari smear occopt tsmear ha dfpt comput done irreduc qqpoint correspond gammacent xx qqmesh coars see next section pleas keep mind sever paramet tune order reach reason compromis accuraci comput cost expect result obtain end lesson fulli converg clear real life one start converg studi lattic paramet vibrat properti function kkmesh tsmear embark eph calcul merg dfpt potenti merg dfpt potenti file copi first input file work_ephisotc sh cp abi_teststutorespfninputtephisotc_abi execut mrgdv tool use sh mrgdv tephisotc_abi first line tephisotc_abi specifi name output dvdb file follow number partial dfpt pot file full list file want merg dialog teststutorespfninputtephisotc_abi step produc tephisotc__dvdb file use next exampl execut sh mrgdv info tephisotc__dvdb show independ atom perturb avail md list irreduc perturb q vector idir ipert typeindepend foundy idir ipert typesymmetr foundno idir ipert typeindepend foundy idir ipert typeindepend foundy idir ipert typesymmetr foundno idir ipert typeindepend foundy idir ipert typesymmetr foundno idir ipert typesymmetr foundno idir ipert typesymmetr foundno independ perturb avail done analyz electron vibrat properti proceed eph calcul worth spend time analyz structur electron vibrat properti mgb_ detail use abipi script postprocess data store precomput netcdf file visual crystallin structur eg vesta use abiview script structur command md abiviewpi structur mgb_ephisotcflow_mgb_phononswtrunabi vesta full formula mg b reduc formula mgb abc angl site sp b c mg b b visual structur vesta write data xsf fmt xsf execut macosx open command open vesta arg usersgmatteogit_reposabinit_rmms_buildtestsxsf tip graphic applic support see abiviewpi structur help note abipi assum tool alreadi instal binari found path abipi command use abinit input file well output file netcdf format eg gsrnc mgb_ crystal socal alb_ prototyp structurehttpafloworgprototypeencyclopediaab_hp__a_d boron atom form graphitelik honeycomb layer separ layer mg atom structur may regard complet intercal graphit c replac b sinc mgb_ formal isoelectron graphit band dispers expect show similar graphit graphit intercal compound ephisotc_assetsmgb_structurepng use abiopen script plot electron band store gsr file produc nscf calcul second task first work ie wt sh abiopenpi mgb_ephisotcflow_mgb_phononswtoutdataout_gsrnc e command produc follow figur ephisotc_assetsmgb_ebandspng electron properti mgb_ intens discuss literatur see eg citemazin dispers quit similar graphit three bond sigma band correspond inplan sp hybrid boron layer two pi band bond pi antibond pi form b p_z orbit lowest band band plot fulli occupi sigma band two sigma band incomplet fill correspond rel flat state locat slightli ee_f along gammaa segment abinitio calcul show state contribut eph coupl due strong coupl e_g vibrat mode two band cross k point around ev pipi band comput socal fatband one use perforn nscf calcul kkpath prtdo left option exercis fatband plot produc abipi start fatbandsnc file avail herehttpsabinitgithubioabipygalleryplot_efatbandshtml tip highsymmetri kkpath automat comput abipi gener flow get explicit list highsymmetri kkpoint use abistruct script kpath command sh abistructpi kpath mgb_dennc kpath reduc coordin ndivsm kptopt kptbound gamma k gamma l h l k h valu do fermi level play import role discuss superconduct properti actual one quantiti subject converg studi respect kkgrid embark dfpteph calcul comput do tetrahedron method use ebands_edo command abitk sh abitk ebands_edo mgb_ephisotcflow_mgb_phononswtoutdataout_gsrnc read eigenvalu ibz gsrn file wfknc file support well command produc text file name out_gsrnc_edo visual sh abiopenpi out_gsrnc_edo e ephisotc_assetsmgb_matplotlib_fspng nest factor yet visual fs rather use discuss eph properti metal beginequ nqq sum_mnkk deltaee_kpq deltaee_kk n endequ note phonon linewidth geometr contribut due fermi surfac sinc gamma_qnu expect larg correspond qq wave vector connect two portion fs strictli speak true eph matrix element constant real materi amplitud g_mnnukk qq constant may enhancesuppress valu gamma_qnu particular mode yet visual fs rather use discuss eph properti metal reason use look fs extern graphic tool visual fs usual requir extern file electron energi full bz wherea abinitio code usual take advantag symmetri comput ee_nk ibz produc bxsf use visual fs eg xcrysden use ebands_bxsf command abitk util locat src_main provid gsrnc wfknc file energi comput kkmesh ibz sh abitk ebands_bxsf mgb_ephisotcflow_mgb_phononswtoutdataout_gsrnc command reconstruct ks energi full bz symmetri produc out_gsrnc_bxsf file open xcrysden use sh xcrysden bxsf out_gsrnc_bxsf ephisotc_assetsmgb_matplotlib_fspng tool fermisurf pyprocar read data bxsf format well minimalist matplotlibbas approach use use abiview script fs command sh abiviewpi fs mgb_ephisotcflow_mgb_phononswtoutdataout_gsrnc visual fs unit cell reciproc lattic ephisotc_assetsmgb_matplotlib_fspng tip bxsf file produc end gs calcul insid eph code set prtfsurf abitk quit handi alreadi file dont want write full abinit input file rerun calcul scratch focu vibrat properti mgb_ principl one comput phonon frequenc either anaddb eph code howev mani applic much easier autom entir process invok anaddb directli abiview script comput phonon band structur use ddb file produc xx qqmesh use sh abiviewpi ddb mgb_ephisotcflow_mgb_phononswoutdataout_ddb produc follow figur ephisotc_assetsmgb_phbandspng project phonon do right panel show lowenergi vibrat mev mainli mg charact wherea higher energi mode mainli involv motion b atom particular interest us twofold degener band locat mev along gammaa segment socal e_g vibrat mode coupl strongli two sigma band cross ee_f tip detail analysi reveal e_g involv inplan stretch bb bond visual phonon mode one use phononwebsit web app h miranda sh abiviewpi ddb mgb_ephisotcflow_mgb_phononswoutdataout_ddb open url httphenriquemirandagithubiophononwebsitephononhtmljsonhttplocalhost__abinb_workdir__mgblmnepjson use default browser webpag display correctli tri chang browser either via command line option directli shell eg export browserfirefox press ctrlc termin http server page work upload json file directli metal interatom forceconst shortrang yet guarante fourier interpol done start xx qqmesh captur fine detail vibrat spectrum obtain look reason vibrat instabl observ acoust mode tend zero linearli qq rightarrow note acoust sumrul enforc default via asr yet mean result fulli converg clearli seen compar phonon band comput xx xx abinitio qqmesh also case autom process use ddb command abicomp script take input arbitrari list ddb file call anaddb ddb file final compar result sh abicomppi ddb mgb_ephisotcflow_mgb_phononswoutdataout_ddb mgb_ephisotcq_ddb e ephisotc_assetsabicomp_phbandspng figur reveal vibrat spectrum interpol xx qqmesh underestim maximum phonon frequenc differ visibl mev especi e_g mode note also phonon frequenc metal also quit sensit kkmesh smear tsmear real life one perform accur converg studi note q_ddb file produc abipi script chang valu ngqpt variabl reason provid file obtain xx qqsampl size git repositori includ dfpt potenti around mb reason continu use xx ddb file take account compar result previou work first comput isotrop tc first exampl use rel simpl input file allow us introduc import variabl organ result copi tephisotc_abi work directori run code use sh abinit tephisotc_abi log err tip prefer run parallel eg two mpi process use sh mpirun n abinit tephisotc_abi log err without introduc input variabl mpi parallel eph code automat distribut workload kpoint spin detail concern mpi version given last section tutorialnotesonthempiparallel discuss mean differ variabl detail dialog teststutorespfninputtephisotc_abi activ comput gamma_qqnu metal use optdriv eph_task locat extern ddb dvdb wfk file specifi via getddb_filepath getdvdb_filepath getwfk_filepath respect sh getddb_filepath mgb_ephisotcflow_mgb_phononswoutdataout_ddb getwfk_filepath mgb_ephisotcflow_mgb_phononswtoutdataout_wfknc getdvdb_filepath tephisotc__dvdb ddb wfk file taken git repositori dvdb use file produc mrgdv previou section rememb said use rel path input file note also use new input variabl structur ad abinit v abifil prefix sh structur abifilemgb_ephisotcflow_mgb_phononswtoutdataout_dennc read crystallin structur extern file avoid repeat unit cell everi input file next variabl defin coars fine qqmesh ddb_ngqpt eph_ngqpt_fin respect sh ddb_ngqpt abinitio qmesh ddb dvdb eph_ngqpt_fin activ interpol dfpt potenti gamma_qnu comput fine grid dipdip treatment dipoledipol part ok metal dipdip set zero deal metal interatom forc constant shortrang provid ignor possibl kohnanomali citekohn kkpoint integr perform gaussian smear eph_intmeth ev eph_fsmear sh eph_intmeth gaussian method doubledelta integr eph_fsmear ev constant broaden gaussian function eph_fsewin ev energi window wavefunct note order acceler calcul decreas eph_fsewin default valu ev ev possibl gaussian method use sinc state whose energi standard deviat fermi level give neglig contribut doubl delta integr word gaussian techniqu optim valu eph_fsewin deduc eph_fsmear unfortun possibl tetrahedron method use extent also adapt broaden use hope next version code provid ha ev activ two trick make calcul faster sh mixprec boxcutmin explain document use mixprec boxcutmin signific effect final result yet default valu user suppos compar result withwithout trick especi boxcutmin run product calcul todo discuss ph_nqpath ph_qpath particular exampl there differ calcul done dipdip ddb contain eeinfti borneffect charg final specif kkmesh must term ngkpt nshiftk shiftk must equal one use gener input wfk file sh ngkpt nshiftk shiftk sh eph_task phonon do qmesh default tetrahedron method ph_ngqpt ph_intmeth phonon band along highsymmetri qpath ph_nqpath ph_qpath ph_ndivsm comput phonon band along qpath ph_nqpath ph_qpath gamma k gamma h l phonon do comput use dens ph_ngqpt qqmesh ph_intmeth integr scheme highsymmetri qqpath phonon band structur specifi ph_nqpath ph_qpath ph_ndivsm import dipdip set zero deal metal therefor ifc shortrang note default valu dipdip design polar semiconductor recommend overrid default behaviour perform calcul eph_task rememb discuss kmesh tsmear dfpt level output file discuss detail main output file produc eph run dialog teststutorespfnrefstephisotc_abo standard section info unit cell pseudopotenti find info electron do sh linear tetrahedron method mesh step mev npt emin emax ev number kpoint ibz fermi level e ev total electron do fermi level statesev e total number electron ef write electron do file tephisotc_o_ds_edo code output basic quantiti concern fermi surfac method bz integr doubl delta md fermi surfac info fs integr done adapt gaussian method total number kpoint full mesh spin number bz kpoint close fermi surfac maximum number band cross fermi level min band max band qqpoint ibz code output valu ww_qnu gamma_qnu lambda_qnu md qpoint e e e mode number frequenc ha linewidth ha lambdaqn e e e e e e e e e e e e e e e e e e e e e e e e e e e frequenc acoust mode gamma zero sinc asr automat set acoust rule automat enforc also linewidth acoust mode zero case howev code use rather simpl heurist rule sh abiviewpi ddb_asr mgb_ephisotcflow_mgb_phononswoutdataout_ddb final valu isotrop lambda sh lambda calcul produc follow output file sh ls tephisotc_o_d tephisotc_o_ds_afnc tephisotc_o_ds_nointp_afw tephisotc_o_ds_phdosnc tephisotc_o_ds_afw tephisotc_o_ds_nointp_ph_afw tephisotc_o_ds_phgamma tephisotc_o_ds_ebandsagr tephisotc_o_ds_phbandsagr tephisotc_o_ds_ph_afw tephisotc_o_ds_edo tephisotc_o_ds_phbstnc file without nc extens text file plot eg gnuplot xmgrace specif appl pomac fruit plant genu malu famili rosacea afnc netcdf file store result calcul format visual abiopen sh abiopenpi tephisotc_o_ds_afnc e produc follow plot ephisotc_assetsabiopen_tephisotc_o_ds_afpng first result interpret critic eye due coars sampl use yet alphafww alreadi show featur observ accur calcul report literatur broad peak mev give import contribut total lambda second smaller peak mev sharp deltalik peak artifact linear interpol hope disappear denser qqmesh use initi valu lambda ww_log md afw qmesh ddb_ngqpteph_ngqpt isotrop lambda omega_log ev kk compar result lambda report citemargin ephisotc_assetsmgb_margine_tablepng see first calcul underestim lambda almost factor two note howev previou studi use much denser sampl use least xx qqmesh phonon clear need densifi bz sampl get reliabl result yet result bad consid calcul took less xxx minut sequenti note exercis sinc wfk defin xx kkmesh easi activ interpol dfpt potenti go xx xx qqmesh keep wfk file use eph_ngqpt_fin previou input file densifi qqmesh phonon compar result obtain xx sampl use compar result obtain without mixprec boxcutmin may want run calcul parallel mpirun use tetrahedron method section repeat calcul done tephisotc_abi optim tetrahedron scheme citekawamura test show phonon linewidth sensit kkmesh integr scheme ii one test differ valu eph_fsewin find optimiz one reason optim tetrahedron scheme construct thirdord interpol function kkpoint state rel far fermi level contribut integrand eph_fsewin small part weigt lost find optim valu use md ndtset eph_intmeth tetra eph_fsewin ev eph_fsewin ev provid input file perform test one easili chang tephisotc_abi run calcul parallel compar result use af command abicomp script pass list afc file sh abicomppi af tephisotc_o_ds_afnc e ephisotc_assetsabicomp_phbandspng prepar converg studi wrt kmesh goal perform calcul gamma_qnu lambda_qnu differ kkqqmesh order analyz converg behaviour alphafww lambda due limit amount time avail tutori wont abl fulli reproduc publish result also still use xx abinitio qqmesh alreadi discuss enough describ vibrat properti token expect fourier interpol scatter potenti work perfectli coars abinitio sampl use nutshel make best hand minim comput cost sinc alreadi wfk file xx kkmesh make sens comput electron xx kkmesh compar follow configur todo discuss energi window sigma_erang connect fs window integr scheme alreadi mention introduct integr doubl delta requir dens kkmesh electron order obtain accur result gamma_qnu token converg fine detail alphafww lambda requir sampl enough phonon qqwavector ibz reason converg studi perform densifi mesh electron phonon addit converg studi wrt eph_fsmear ph_smear requir gaussian techniqu use rememb eph code qqmesh chang thank fourier interpol dynam matrixdfpt potenti wherea bloch state must comput explicitli run calcul differ mesh good idea sketch converg studi want perform let assum want test follow configur xx qqmesh without interpol follow kkmesh xx xx xx xx xx qqmesh interpol follow kkmesh xx xx xx pattern point clear need perform nscf comput four differ gammacent kkmesh xx xx xx xx comput cost nsc run increas quickli size kkmesh alreadi stress need electron state appropri energi window around fermi level kkmesh must multipl qqmesh need gener differ wfk file prepar converg studi nscf comput wfk becom quit cpuconsum memorydemand dens kkmesh need fortun optim part sinc comput gamma_qnu requir knowledg bloch state insid rel small energi window around ee_f similarli done ephmob tutorialephmob therefor take advantag starfunct skw interpol find kk wavevector whose energi insid sigma_erang energi window around fermi level choic optim window discuss afterward first strongli recommend test whether skw interpol reproduc abinitio result reason accuraci compar abinitio band structur interpol one use abitk skw_compar command sh abitk skw_compar mgb_ephisotcflow_mgb_phononswtoutdataout_gsrnc mgb_ephisotcflow_mgb_phononswtoutdataout_gsrnc ismet fist argument gsrnc wfknc file energi ibz use build starfunct interpol qualiti interpol obvious depend densiti kkmesh second file contain abinitio eigenvalu along kkpath comput standard nscf run exampl use precomput gsrnc file xx kkmesh skw interpol note note use ismet option els abitk complain comput gap code default assum semiconductor skw_compar command produc two netcdf file abinitio_ebandsnc skw_ebandsnc compar abicomp script eband command sh abicomppi eband abinitio_ebandsnc skw_ebandsnc p combiplot produc follow plot ephisotc_assetsskw_vs_abinitio_ebandspng figur show skw interpol nice reproduc abinitio dispers around ee_f discrep abinitio result interpol valu visibl correspond bandcross expect sinc skw fourierbas approach bandcross lead nonanalyt behaviour signal reproduc finit number fourier compon fortun band cross rel far fermi level henc enter play comput superconduct properti tip fit problemat use command line option sh abitk skw_compar ibz_wfk kpath_wfk lpratio rcut rsigma improv interpol take note skw paramet valu use call abinit einterp input variabl worst case scenario band cross oscil close fermi level handl enlarg sigma_erang energi window point confid skw interpol ok use locat kkwavevector much denser kkmesh whose energi insid sigma_erang window around fermi level done tephisotc_abi input file dialog teststutorespfninputtephisotc_abi import section input file reproduc sh optdriv wfk_task wfk_kpts_erang getwfk_filepath mgb_ephisotcflow_mgb_phononswtoutdataout_wfknc defin fine kmesh skw interpol sigma_ngkpt sigma_nshiftk sigma_shiftk sigma_erang ev select kpt fine mesh within energi window einterp paramet starfunct interpol default valu first part optdriv wfk_task activ comput kerangenc file abinitio energi ibz taken getwfk_filepath three variabl sigma_ngkpt sigma_nshiftk sigma_shiftk defin final dens kkmesh final sigma_erang defin energi window around fermi level einterp list paramet pass skw routin exampl use default valu may need chang einterp use differ option skw interpol use abitk skw_compar import deal metal entri sigma_erang must neg energi window refer ee_f cbmvbm use semiconductor rememb use valu window reason larg order account possibl oscil andor inaccuraci skw interpol around ee_f dialog teststutorespfnrefstephisotc_abo dialog teststutorespfnrefstephisotc_abo kerangenc file use perform nscf calcul gener custom wfk file dens kkmesh done tephisotc_abi input file dialog teststutorespfninputtephisotc_abi perform nscf calcul kptopt produc new wfk file dens kkmesh sh iscf tolwfr e kptopt import getkerange_filepath note note use getden_filepath syntax sh getkerange_filepath tephisotc_o_ds_kerangenc read den file initi nscf run getden_filepath mgb_ephisotcflow_mgb_phononswtoutdataout_dennc init gs wavefunct file option getwfk_filepath mgb_ephisotcflow_mgb_phononswtoutdataout_wfknc start nscf run precomput gs den file initi trial wafefunct getwfk_filepath acceler bit calcul todo discuss energi rang integr scheme converg studi wrt kqmesh point use wfk file perform eph calcul denser kkmesh use set similar one use tephisotc_abi except use eph_ngqpt_fin getwfk_filepath ngkpt dialog teststutorespfninputtephisotc_abi accur calcul want reproduc result find anoth github repositori dfpt comput perform xx kkmesh xx qqmesh phonon download repositori explain begin lesson merg partial pot file comput wfk file nscf run stare dennc file get eph calcul cpu take minut less xxx gb memori note mpi parallel eph calcul perform eph_task support differ level mpi parallel number mpi process level specifi via eph_np_pqbk input variabl note wrote mpi level instead isotrop t_c calcul band parallel support atom perturb qqpoint kkpoint spin eph_np_pqbk variabl option sens whatev number mpi process use eph code abl parallel calcul distribut kkpoint spin distribut howev may optim especi lot cpu avail andor need decreas memori requir per cpu decreas memori suggest activ parallel perturb x natom make memori wrr rr text x natom scale memori concern activ qqpoint parallel better effici import note code abl distribut memori wavefunct although state eph_fsewin energi window read store memori author ss xg yg nap fg tutori optic properti frequencydepend linear secondord nonlinear optic respons tutori aim show get follow physic properti semiconductor frequencydepend linear dielectr tensor frequencydepend secondord nonlinear suscept tensor frequencydepend electroopt suscept tensor simpl randomphas approxim sumoverst approach tutori help understand make use optic start first theoret background strongli suggest first read first two section helpopt tutori take hour tutorial_readm comput momentum matrix element begin might consid work differ subdirectori creat work_opt also need copi toptic_abi abi_teststutorialinput work_opt sh cd abi_teststutorespfninput mkdir work_opt cd work_opt cp toptic_abi readi run abinit prepar file need optic issu abinit toptic_abi log err examin input file dialog teststutorespfninputtoptic_abi comput concern crystal gaa zincblend structur atom per primit cell six dataset first dataset quit standard selfconsist determin ground state fix geometri occupi band treat densiti output use later dataset second dataset nonselfconsist calcul number band increas includ unoccupi state k point restrict irreduc brillouin zone third dataset use result second one produc wavefunct band full brillouin zone step could skip includ later cpu time save linear optic respons comput timerevers symmetri use comput might restrict half brillouin zone kptopt fourth fifth sixth dataset correspond comput ddk matrix element matrix element partial h partial k oper h hamiltonian note number band dataset note also nonselfconsist calcul moreov restrict nstep nline inde matrix element explicitli comput unperturb state requir also prtwf use use larger nstep would lead full comput deriv wavefunct respect wavevector optic matrix element unperturb state need thu valu nstep larger one would lead erron matrix element would wast time order suffici fast tutori k point sampl chosen extrem dens instead time time fcc lattic k point someth like time time fcc k point also cutoff energi ha small usual converg studi respons user moreov emphas gener result sumoverst approach use optic typic converg quit slowli k point mesh thu uttermost import test converg care run take less one minut ghz pc file toptic_o_ds_wfk toptic_o_ds_wf toptic_o_ds_wf toptic_o_ds_wf four file request optic run first file contain wavefunct fill empti state entir brillouin zone latter three contain matrix element partialparti k oper one file cartesian direct real prepar run adequ k point sampl cutoff energi last sever hour even day pc comput linear nonlinear optic respons next step comput linear nonlinear optic respons momentum matrix element avail readi determin optic respons second order current implement materi studi first read helpopticinputsect optic help file copi toptic_abi input file abi_teststutorialinput work_opt sh cp toptic_abi toptic_abi input file edit read care help variou input paramet file pleas see helpopt dialog teststutorespfninputtoptic_abi read input file run code usual use follow command assum optic path copi execut current directori need optic toptic_abi log err take second run produc numer output file examin output file header contain inform calcul see helpopticoutputsect optic help file file plot xmgrace gnuplot xmgrace instal comput pleas get web instal altern use prefer plot packag first look linear optic file xmgrace toptic___linoptout file contain xx compon dielectr tensor includ function energi magnitud real imaginari part tensor element graph see three curv one posit alway larger two other modulu dielectr function anoth one also alway posit imaginari part dielectr function last one real part larg number peak varianc experiment spectra much smoother origin discrep found spars k point sampl use order abl perform tutori quickli next section improv sampl start converg studi concern nonlinear optic graph xyz compon also quit bad mani isol broaden peak howev yyy one perfect inde vanish due symmetri reason visual imaginari part xmgrace toptic____chitotimout real part xmgrace toptic____chitotreout tip abipi instal machin use abiopen script expos option visual result store opticnc file abiopenpi toptic__opticnc expos snspaper optic_assetsabiopen_toptic_png would good time review helpoptictroubleshootingsect optic help file comparison includ tutori directori abinit packag ask administr access full abinit packag instal three file obtain much better k point sampl still low cutoff energi number band larger visual follow xmgrace abi_homedoctutorialoptic_assetstoptic_ref__linoptout linear optic obtain xx grid keep everyth els fix xmgrace abi_homedoctutorialoptic_assetstoptic_ref___chitotimout well xmgrace abi_homedoctutorialoptic_assetstoptic_ref___chitotreout nonlinear optic obtain xx grid keep everyth els fix concern linear spectrum compar underconverg result toptic_ref__linoptout experiment data converg theoret result book cohen ml chelikowski citecohen present comparison experiment data empir pseudopotenti method spectrum access book see experiment spectrum citephilipp theoret spectrum citehuang well sourc discuss first imaginari spectrum promin experiment featur spectrum two peak locat close ev ev approxim height spectrum zero ev direct band gap decreas wiggl beyond ev converg theoret spectra also show two peak locat although height markedli differ first one ev second one ev featur rather similar experiment one linear optic spectrum toptic_ref__linoptout note shoulder around ev peak ev respect approxim height comment order main differ experiment converg theoret spectra due presenc exciton electronhol bound state treat rather elementari theoret approach exciton transfer oscil strength second peak ev first one ev go beyond sumoverst approach still keep independentelectron approxim eg framework tddft adiabat lda correct problem one need use bethesalpet approxim reli fanci exchangecorrel kernel produc optic spectrum qualit agreement experiment data still trend correct eg chang peak posit pressur comparison differ semiconductor etc mani earli theoret spectra includ one citecohen agreement theoret experiment band gap artifici good straight dft one avoid band gap problem howev possibl add artifici scissoropticscissor shift make theoret band gap match experiment one theoret spectrum present addit defici respect one mostli due still coars sampl k space mani wiggl spectrum rather inaccur band structur cutoff energi realli low first peak appear shoulder second peak real part spectrum relat kramerskronig relat imaginari part note defici imaginari part spectrum translat real part first peak low second peak high spectrum correctli chang sign around ev stay neg ev simul empti state need obtain better behaviour also limit lowfrequ valu order correct increas cutoff energi k point sampl number unoccupi state similar consider appli nonlinear spectra faster comput imaginari part linear optic respons case imaginari part linear optic respons sever point make calcul easier timerevers symmetri use decreas number k point factor two also true comput real spectrum number unoccupi band reduc strict minimum need span target rang frequenc focu energi rang ev ev unoccupi band need copi input file toptic_abi work_opt cp toptic_abi dialog teststutorespfninputtoptic_abi issu abinit toptic_abi log err examin file toptic_abi two import chang respect file toptic_abi number unoccupi band reduc total number band instead applic valu kptopt previou simul chang order take advantag timerevers symmetri run finish sec ghz pc process wfk file obtain linear optic spectra copi toptic_abi input file work_opt cp toptic_abi dialog teststutorespfninputtoptic_abi examin toptic_abi file linear optic spectra built read input file run code usual use follow command optic toptic_abi log err visual file toptic___linoptout toptic___linoptout use xmgrace compar spectra look complet ident howev care look file edit show inde imaginari part similar calcul compon dielectr function broaden e e scissor shift e energi window eev eha energyev imepsw e e e e e e e e real part differ slightli seen line beyond energyev reepsw e e e e e e e e toptic___linoptout energyev reepsw e e e e e e e e toptic___linoptout small differ due number band nband toptic___linoptout nband toptic___linoptout increas number k point watch chang imaginari part spectrum peak merg start form smooth profil still complet smooth even time time inform give time correspond abinit run ghz pc kpoint grid cpu time x x sec x x sec x x sec x x sec x x sec x x sec x x sec x x sec x x sec grid order time time treatment optic also take sever minut due io minut time time grid might note first peak slowli develop increas number k point nevertheless stay much smaller converg one even smaller experiment one comput linear electroopt suscept calcul linear electroopt suscept follow init calcul describ first two section tutori calcul coeffici linear electroopt suscept one need modifi optic input file two addit keyword copi toptic_abi input file work_opt cp toptic_abi dialog teststutorespfninputtoptic_abi toptic_abi linear electroopt suscept calcul read input file run code usual use follow command optic toptic_abi log err calcul run second modern pc result calcul produc number file end chieo relat differ part linear electroopt tensor chieoabsout give absolut valu linear electroopt suscept chieoimout give imaginari compon calcul linear electroopt suscept chieoreout give real compon calcul linear electroopt suscept chieototimout give total imaginari part calcul linear electroopt suscept chieototreout give total real part calcul linear electroopt suscept gener low energi frequenc rang linear electroopt suscept linear experiment import low energi mean energi much less band gap energi titl parallel ground state author fb jb mt parallel ground state calcul explor kpointsplan wavesband parallel tutori discuss perform groundstat calcul hundredsthousand comput unit cpu core use abinit learn use keyword relat kgb parallel scheme k stand kpoint g refer wavevector planewav b stand band possibl use abinit level parallel focu tutori learn speedup calcul improv converg rate tutori take hour requir access cpu core parallel comput except last section requir cpu core suppos know alreadi basic abinit use refer citelevitt citebottin citeknyazev tutorial_readm introduct continu might work differ subdirectori tutori work_paral_kgb import follow name file mention subdirectori input file found abi_teststutoparalinput directori compar result refer output file locat abi_teststutoparalref follow run abinit _nn_ cpu core appear use specif command line accord oper system architectur comput use instanc mpirun n nn abinit inputabi use specif submiss file size system increas atom usual imposs perform ab initio calcul singl comput core basi set use solv problem plane wave band increas mdash linearli squar even exponenti mdash comput resourc limit two factor memori ie amount data store ram comput effici specif bottleneck therefor mandatori adopt parallel strategi distribut share data across larg number comput node parallel time consum routin tutori discuss improv perform use larg number comput unit cpu core decreas comput time given number cpu core reduc time need perform one electron iter improv effici reduc number electron iter improv converg test perform gold atom system tutori planewav cutoff energi strongli reduc practic reason simpl way begin automat distribut parallel easiest way activ kgb parallel abinit add one input variabl input file paral_kgb control everyth concern kgb parallel includ choic iter eigensolv wfoptalg use parallel dimfft choos strategi activ mdash good mdash flag autopar automat parallel use associ max_ncpu variabl maximum number cpu core want manual defin number process associ level parallel npkpt number process k point npband number process band npfft number process planewavesfft ok let start copi tgspw_abi file tutori directori work directori dialog teststutoparalinputtgspw_abi run abinit cpu core use mpi process openmp thread abinit stop without start calcul dont pay attent error messag end output file tgspw_abo see md search possibl proc distribut input cpu npkpt npfft npband bandpp mpiproc weight best possibl choic nproc print weight assign distribut processor indic advis select processor distribut high weight focu npband npfft see mpi process recommend distribut npbandxnpfft x second step launch abinit parallel core chang input file follow diff autopar max_ncpu npband npfft perform calcul use kgb parallel abinit somehow without understand got result sophist method part tri recov previou process distribut better understand shown pair npband x npfft input variabl variou valu x x x x x order perform calcul use tgspw_abi dialog teststutoparalinputtgspw_abi chang line correspond processor distribut first calcul diff npband npfft npband npfft second one diff npband npfft npband npfft run calcul npbandxnpfft x x x x x store output file renam follow time calcul retriev use shell command tgspw_abo tgspw_abo tgspw_abo tgspw_abo tgspw_abo time calcul retriev use shell command bash grep proc abo bash tgspw_abo proc individu time sec cpu wall tgspw_abo proc individu time sec cpu wall tgspw_abo proc individu time sec cpu wall tgspw_abo proc individu time sec cpu wall tgspw_abo proc individu time sec cpu wall far time concern best distribut one propos previou section x seem best one predict use autopar pretti good learn far consid time electron step howev local optim block precondit conjug gradient algorithm lobpcg mdash use abinit default paral_kgb mdash oper diagon block eigenvector block eigenvector concurr diagon npband process one block npband valu modifi size block chang accordingli exactli equal npband solut eigensolv modifi one calcul quickest look time need one iter slowest end mani step perform order see look converg rate end calcul last iter scf loop bash grep etot abo tgspw_abo etot e e e tgspw_abo etot e e e tgspw_abo etot e e e tgspw_abo etot e e e tgspw_abo etot e e e last column indic converg residu densiti use paw otherwis would residu potenti normconserv see quantiti smallest npband highest result expect converg better size block largest best converg obtain x distribut worst time measur alreadi third iter behaviour observ bash grep etot abo tgspw_abo etot e e e tgspw_abo etot e e e tgspw_abo etot e e e tgspw_abo etot e e e tgspw_abo etot e e e face dilemma calcul smallest number iter best converg best concern time one iter best effici vice versa best choic compromis follow choos x pair definit offer guarante concern converg time note could check converg chang npfft valu modifi even sophist band per process bandpp seen previou section best converg obtain size block largest size exactli equal npband valu possibl increas block size increas number mpi process possibl better answer ye input variabl name bandpp band per process enabl increas block size without chang number process dedic band work previoulsi block band diagon npband mpi process parallel bandpp activ process handl bandpp band block size equal npband x bandpp accordingli block size modifi usual increas play valu bandpp without chang number mpi process note fft still perform npfft mpi process follow use set previous perform electron step diff nstep bandpp default valu dialog teststutoparalinputtgspw_abi copi input file tgspw_abi run abinit cpu set bandpp bandpp output file name tgspw_bandppabo tgspw_bandppabo respect comparison two file show converg better second case conclus given number processor possibl improv converg increas bandpp howev see cpu time per iter increas bandpp increas bash grep proc tgspw_bandppabo tgspw_bandppabo tgspw_bandppabo proc individu time sec cpu wall tgspw_bandppabo proc individu time sec cpu wall look last iter bash grep etot tgspw_bandppabo tgspw_bandppabo tgspw_bandppabo etot e e e tgspw_bandppabo etot e e e bandpp calcul converg also compar xbandpp distribut x xbandpp x one calcul npbandxbandpp nbandxnpfft thu converg use input file chang accord diff npband bandpp npfft npband bandpp npfft run abinit mpi process name output file tgspw_bandppabo one calcul alreadi previou section nstep instead perform diff two output file tgspw_bandppabo tgspw_bandppabo see two calcul give exactli converg rate expect sinc case block size equal number fft processor npfft affect converg tip possibl adjust distribut process without chang converg reduc npband increas bandpp proport cpu time consumpt come previous explain mpi process handl bandpp band sequenti thu sequenti part code increas bandpp increas note careful depend number plane wave number band increas bandpp increas decreas cpu time usual start increas bandpp first decreas maintain cpu time continu increas bandpp increas cpu time experi also depend hardwar see next section use hybrid parallel improv import use mpi parallel time singl electron step theoret increas bandpp increas converg rate better hybrid parallel mpiopenmp modern supercomput comput unit cpu core equal distribut group node share memori access socal manycor architectur cpu core numer node could continu use share memori use mpi effici way take benefit comput best practic use hybrid parallel mix distribut memori parallel mpi node share memori parallel openmp insid node see also consequ perform iter diagon algorithm lobpcg let tri import use abinit mpi openmp make sure compil abinit enableopenmp activ openmp support link linear algebra librari support multithread like mklhttpssoftwareintelcomcontentwwwusendeveloptoolsoneapicomponentsonemkllinklineadvisorhtml note say set omp_num_threadsxx set environ export omp_num_threadsxx bash setenv omp_num_thread xx csh import use thread impos npfft best suppress input file tgspw_abi input file parallel set npband npfft thu use mpi process set bandpp run abinit use mpi process openmp thread set omp_num_thread copi output file tgspw_bandppthreadabo set npfft run abinit use mpi process openmp thread set omp_num_thread copi output file tgspw_bandppthreadabo note mpi x thread core dialog teststutoparalinputtgspw_abi let look time compar bash grep proc tgspw_bandppthreadabo tgspw_bandppthreadabo tgspw_bandppthreadabo proc individu time sec cpu wall tgspw_bandppthreadabo proc individu time sec cpu wall wee new output file show larger comput time process cpu disappoint realli keep mind time one mpi process ad time openmp task process pure mpi case thu sec per task hybrid case sec per task see wall time closer tho valu less real user time therefor thread run last wherea thread run last total core total cpu time use abinit x sec mpi case sec hybrid case much better best way confirm look wall time cumul task end output file bash grep overal tgspw_bandppthreadabo tgspw_bandppthreadabo tgspw_bandppthreadabooveral time end sec cpu wall tgspw_bandppthreadabooveral time end sec cpu wall abinit distribut workload block band diagon npband mpi process previous process handl bandpp band use openmp task mean bandpp x npband band comput parallel use nthread x npband task bandpp suppos multipl nthread get best perform principl effici pure mpi case scalar product matrix multipl algebra oper done parallel openmp task npfft use commun mpi process also reduc import use thread bandpp need multipl thread highli recommand choos number thread well strongli depend comput architectur case comput made node node socket contain given number cpu core core one node access ram socket access faster socket origin famou non uniform memori access effect numa number thread thu divisor total number core node better choos divisor number core socket inde abinit perform sensit numa effect follow let learn use abinit openmp thread first chang input file follow diff npband bandpp npband bandpp run abinit use mpi process thread still core renam output file tgspw_bandppthreadabo compar time thread case previou thread case bash grep overal tgspw_bandppthreadabo tgspw_bandppthreadabo tgspw_bandppthreadabooveral time end sec cpu wall tgspw_bandppthreadabooveral time end sec cpu wall improv abinit perform better principl ye previous explain increas block size lobpcg diagon algorithm let tri chang bandpp valu input file diff bandpp bandpp dont chang number thread keep obtain follow time diff grep overal tgspw_bandppthreadabo tgspw_bandppthreadabo tgspw_bandppthreadabooveral time end sec cpu wall tgspw_bandppthreadabooveral time end sec cpu wall new set give better resultbut second better converg diff grep etot tgspw_bandppthreadabo tgspw_bandppthreadabo tgspw_bandppthreadabo etot e e e tgspw_bandppthreadabo etot e e e converg cost help choos distribut processestask launch abinit autopar max_ncpu keyword max_ncpu equal total number target cpu core ie nthread x nmpi launch abinit mpi process omp_num_threadsnn tri max_ncpu omp_num_thread tip rule distribut workload npband x bandpp size block maxim divid number band nband bandpp multipl number openmp task nband multipl npband x bandpp case ideal distribut system depend kgb parallel note part cluster use therefor time tgspw_abi differ previou run previou section use cluster run tgspw_abi follow run perform gb parallel use level band andor fft system kpoint one add third level parallel perform full kbg parallel difficulti ad process level test full parallel restart input file tgspw_abi add denser kpoint grid case system kpoint irreduc brillouin zone ibz calcul parallel kpoint mpi process done use npkpt input variabl diff nkpt ngkpt npkpt need time process run abinit cpu core mpi tgspw_abi file time obtain output file tgspw_abo tgspw_abo bash grep proc tgspw_abo tgspw_abo tgspw_abo proc individu time sec cpu wall tgspw_abo proc individu time sec cpu wall quasiident mean scalabl abinit quasilinear kpoint level import want parallel calcul begin kpoint level follow band level activ fft level openmp thread time obtain output tgspw_abo lead hypothet speedup time approx good expect scale linear inde time need slightli longer sec one obtain tgspw_abo go let compar time spent routin input file use contain input variabl timopt activ time differ subpart run find result end output file refer first clue undestand perfect speedup come sequenti code parallel sequenti part mainli done outsid vtowfk level let look time spend well parallel subroutin vtowfk bash grep e vtowfk digit tgspw_abo tgspw_abo tgspw_abo vtowfk tgspw_abo vtowfk tgspw_abo vtowfk tgspw_abo vtowfk see kgb parallel perform realli well sinc wall time spent within vtowfk approxim equal approx approx speedup quasilinear vtowfk problem come part outsid vtowfk parallel respons neglig time spent sequenti part longer neglig parallel hundr processor time spent vtowfk correspond overal time dont parallel kpoint parallel behaviour relat amdhal lawhttpsenwikipediaorgwikiamdahls_law speedup program use multipl process parallel comput limit time need sequenti fraction program exampl program need hour use singl processor core particular portion hour parallel remain portion hour parallel regardless mani processor core minimum execut time less critic hour henc speedup limit case part loop kpoint parallel kgb parallel even part small mdash less mdash determin upper bound speedup subsupto futur discuss converg wfoptalg nlinesupsub author rangel tutori use wannier librari wannier interfac tutori tutori aim show use wannier interfac comput maxim local wannier function mlwf learn get mlwf abinit wannier basic variabl govern numer effici tutori take hour import note exampl tutori converg exampl show use code tutorial_readm summari wannier abinit wannier code comput mlwf see wwwwannierorghttpwwwwannierorg wannier use methodolog introduc n marzari vanderbilt highli recommend read follow paper understand basic citemarzari citesouzaa wannier function wf obtain bloch state mean formula citesouzaa may note freedom choic bloch orbit phase reflect shape spatial extent wf mean differ phase wf differ spatial local obtain mlwf minim spread wf respect choic phase done use steepestdesc algorithm see section citemarzari ground state calcul wannier code obtain mlwf requir two ingredi overlap m_mn langl u_mk u_nkb rangl cell period part bloch state u_nkrangl see eq citemarzari start guess project a_mn langl psi_mk g_n rangl bloch state psi_nk rangl onto trial local orbit g_nrangl see section citesouzaa abinit take bloch function ground state calcul comput two ingredi wannier execut wannier includ librari abinit process automat singl run ground state calcul comput mlwf first exampl silicon start make sure compil abinit enabl wannier may recompil code configur withconfigfilemyconfac myconfac defin sh instal prefix psml io librari eg usrloc with_wannierusrloc comput set mlwf silicon go extract wannier function correspond four valenc state silicon begin might consid work differ subdirectori tutori work_w copi file tw_abi wannierwin abi_teststutoplugsinput directori work_w cd abi_teststutoplugsinput mkdir work_w cd work_w cp tw_abi wannier also use secondari input file call wannierwin therefor must includ file folder cp wannierwin readi run abinit pleas type abinit tw_abi log err let examin input file tw_abi calcul run dialog teststutoplugsinputtw_abi input file look familiar inde primit cell silicon two data set first scf calcul nscf calcul call wannier librari new input variabl prtwant set order use wannier util let look second input file wannierwin dialog teststutoplugsinputwannierwin mandatori input file requir wannier librari mani variabl defin insid file case use num_wann num_it variabl use minim spread obtain mlwf particular num_wann defin number wannier function extract num_it set maximum number iter also variabl govern disentangl procedur outlin citesouzaa use simpl case complet list input variabl found wannier user guid see wwwwannierorghttpwwwwannierorg examin log file converg scf cycl reach see wannier librari call find follow line calcul overlap call wannier librari obtain maxim local wannier function wannierwin mandatori secondari input wannierwout output librari wannieramn contain project wannierrandomamn contain random project wanniermmn contain overlap wanniereig contain eigenvalu explan input output file wannier librari see mani new file creat input file wannier creat abinit wannierrandomamn contain list project use start guess wf a_mn matrix mention tutori wanniereig contain list eigenvalu kpoint band wanniermmn contain overlap cell period part bloch state m_mn matrix mention tutori unk file contain wavefunct real space everi kpoint file comput abinit wannier librari use output file wannier wannierwout main output file librari read care see detail calcul wannierchk file requir restart calcul case use wannier standalon mode case use obtain inform steepestdesc minim issu grep conv tw_o_ds_wwout obtain tabl follow form conv iter delta spread rm gradient spread ang time conv conv e conv e conv verifi final spread get around  similarli obtain inform disentangl procedur use exampl type grep di wannierwout obtain tabl follow form di iter omega_ii omega_ii delta frac time di di tip abipi instal machin use abiopen script wout command expos option visual iter abiopenpi tw_o_ds_wwout expos sn wannier_assetsabiopen_tw_o_ds_wpng visual wannier function see wannier function xcrysden format type xcrysden xsf tw_o_ds_w_xsf see isosurfac click toolsdata grid ok modifi isovalu put instanc check option render isovalu click ok altern one read xsf file vesta macosx user use command line open tw_o_ds_w_xsf vesta invok vesta directli termin wannier_assetstw_o_ds_w_png import import set istwfk equal everi kpoint avoid use symmetri reason formal use extract mlwf assum uniform grid kpoint see section iv citemarzari number wannier function extract minor equal number band _nband nwan_ disentangl routin call number kpoint equal ngkptngkptngkpt achiev use input variabl kptopt ngkpt nshiftk prefix wannier file sampl case _wannier_ possibl prefix w_ abo __w_ abo fourth line file file setup prefix abinit first look file name abo __wwin_ found look _wwin_ final _wannierwin_ paw case start assum alreadi complet tutori pawtutorialpaw pawtutorialpaw silicon add variabl pawecutdg paw atom data includ pseudopotenti file exampl alreadi prepar copi file tw_abi work_w cp tw_abi go reus wannierwin previou exampl run abinit abinit tw_abi log err expect result similar pw case import paw case unk file real wavefunct contribut insid sphere comput howev use plot wannier function defin initi project obtain mlwf four valenc band silicon import note valenc state mlwf obtain start random initi posit howev conduct state give accur start guess get mlwf go extract sp hybrid orbit silan sih_ start copi teststutoplug directori follow file cp tw_abi cp tw_o_ds_wwin run abinit abinit tw_abi log err run start examin input file open main input file tw_abi file divid three dataset dialog teststutoplugsinputtw_abi first scf calcul done follow nscf calcul includ band final third dataset read wavefunct previou one wannier librari call winiprj keyword use indic initi project given win file note may notic win file call tw_o_ds_wwin follow form prefix_dataset_wwin prefix taken third line file file dataset dataset number call wannier dataset exampl open win file initi project sp hybrid orbit center posit silicon atom written explicitli begin project sisp end project enorm freedom choic initi project instanc defin center cartesian coordin rotat axi pleas refer wannier user guid see part relat project see wwwwannierorghttpwwwwannierorg wannier abinit redo silicon case defin differ initi project calcul time consum start run calcul read cp tw_abi cp tw_o_ds_wwin abinit tw_abi log err initi project exampl extract sp orbit center silicon atom could also extract bond antibond orbit uncom comment requir line indic tw_o_ds_wwin see use r initi project block indic radial part gaussian function whose width control valu variabl zona main advantag radial function form hydrogen orbit time write amn file reduc interpol band structur go run wannier standalon mode comment follow line win file postproc_setup true use write nnkp file first run num_it uncom follow two line restart plot bands_plot true run wannier abi_homefallbacksexportsbinwannierxabinit tw_o_ds_w interpol band structur tw_o_ds_w_banddat plot band open gnuplot termin type gnuplot load tw_o_ds_w_bandgnu wannier_assetsload_tw_o_ds_w_bandpng author xg plotli true parallel dfpt formal atom displac homogen electr field strain tutori aim show use parallel properti comput basi densityfunct perturb theori dfpt part abinit ie respons atom displac comput phonon frequenc band structur respons homogen electr field dielectr constant born effect charg infrar characterist respons strain elast constant piezoelectr constant comput realiz one input variabl rfphon rfelfd rfstr nonzero activ optdriv suppos wellfamiliar calcul start present tutori see input variabl describ varsetdfpt tutori responsefunct tutorialrf subsequ tutori learn basic implement parallel dfpt calcul execut simpl quick calcul one dynam matrix fcc aluminum whose scale limit dozen comput core execut calcul whose scale much better would take hour sequenti use provid input file last section part would better access comput core although might also chang input paramet adjust machin hand part tutori computingcor machin recommend order perform scalabl measur suppos know alreadi basic parallel abinit explain tutori first introduct abinit paralleltutorialbasepar tutori take less two hour done power parallel comput avail tutorial_readm structur parallel dfpt part abinit let us recal first basic structur typic dfpt calcul summar box schema paral_dfpt_assetsdfpt_structurepng step done preliminari groundstat calcul either independ run comput use earlier dataset dfpt calcul parallelis step examin separ tutori step step timeconsum dfpt step present tutori dedic implement parallel explain gener differ file particular one sever ddb file explain relat tutori see eg responsefunct tutorialrf sever perturb usual treat one dataset henc perturbationloop step schema exampl one dataset although one consid one phonon wavevector primit atom displac wavevector determin symmetri treat turn step refer mrgddb anaddb postprocess ddb gener step timeconsum section parallel need equat consid comput firstord wavefunct potenti step box realli timeconsum part dfpt calcul present box schema paral_dfpt_assetsdfpt_equationspng parallel current implement dfpt part abinit base parallel distribut import array set firstord groundstat wavefunct wavefunct store complet memori link one comput core split differ part one wavefunct differ comput core neither real space reciproc space differ wavefunct might distribut differ comput core easili achiev combin k point spin band index parallel explain box schema paral_dfpt_assetswfspng parallel k point band index spin set wavefunct implement relev step except read initialis groundstat wavefunct extern file thu cpu timeconsum part dfpt comput parallel follow parallel input set groundstat wavefunct comput firstord chang potenti firstord densiti similar oper depend band k point case small system maximum achiev speedup limit input set groundstat wavefunct medium larg system maximum achiev speedup determin oper depend k point band indic final distribut set groundstat wavefunct comput core need partli parallel parallel band exploit continu might work differ subdirectori tutori work_paral_dfpt input file found abi_teststutoparalinput directori might adapt path directori decid perform run compar result refer output file locat abi_teststutoparalref follow mpirun abinit appear use specif command line accord oper system architectur comput use instanc mpirun np abinit comput one dynam matrix q fcc aluminum start treat case small system name fcc aluminum one atom per unit cell cours mani k point need sinc metal first step precomput ground state wavefunct driven file tdfpt_abi edit examin dialog teststutoparalinputtdfpt_abi one reli kpoint grid xx x shift k point band kpoint grid sampl well converg actual groundstat calcul symmetri use reduc drastic number k point k point irreduc brillouin zone deduc examin input file though order treat properli phonon calcul number band larger default valu would given nband inde sever unoccupi band play role respons calcul case etal occup exampl acoust sum rule might larg violat unoccopi band treat calcul fast actual launch mpirun n abinit tdfpt_abi log refer output file avail abi_teststutoparalref name tdfpt_abo obtain use comput core took second second step dfpt calcul see file tdfpt_abi dialog teststutoparalinputtdfpt_abi three perturb three atom displac two first perturb symmetri use third two symmetri use reduc number k point henc perfectli scalabl section code maximum speed k point band access comput core howev sequenti part code domin much much lower valu inde sequenti part actual percent code one processor depend machin run speedup might satur beyond depend machin note number processor use second step independ number processor use first step relev inform first step _wfk file first copi output groundstat calcul use input dfpt calcul cp tdfpt_o_wfk tdfpt_i_wfk _wfq file need gs wavefunct kq present gw wavefuct k launch calcul mpirun n abinit tdfpt_abi tdfpt_log refer output file given abi_teststutoparalref name tdfpt_abo edit examin inform calcul made four comput core mpi_nproc omp_nthread omp activ wall clock time less second proc individu time sec cpu wall calcul complet deliv warn comment log file overal time end sec cpu wall major result phonon frequenc phonon wavevector reduc coordin phonon energi hartre e e e phonon frequenc cm e e e test case quit fast play bit particular run sever time increas number comput core let us say comput core stage obtain satur speedup abl obtain decent speedup processor gain becom margin note howev result independ exquisit accuraci number comput core use let us explain time section present bit end output file major independ code section cpu wall time sec well time number call node begin_tim mpi_nproc omp_nthread mpi_rank cpu_tim wall_tim routin cpu wall number call gflop speedup efficac count fourwfpot nonlopappli nonlopforc fourwfgr dfpt_vtorhokpt loop getghc_setup mkffnl projbd dfpt_vtowfkcontrib other end_tim subtot major independ code section cpu wall time sec well total time number call begin_tim mpi_nproc omp_nthread mpi_rank world cpu_tim wall_tim routin cpu wall number call gflop speedup efficac count fourwfpot dfpt_vtorhompi nonlopappli nonlopforc fourwfgr dfpt_vtorhokpt loop getghc_setup mkffnl projbd dfpt_vtowfkcontrib getghcoth pspini newkptexcl rwwf other end_tim subtot made two group data first one correspond analysi time comput core node number second one sum comput core data first group note factor four two group reflect load balanc good let us examin second group data detail correspond decomposit timeconsum part code note subtot percent thu statist accur close actual abinit v must bug time decomposit sinc eg neg time announc other subroutin anyhow sever timeconsum part directli relat applic hamiltonian wavefunct name fourwfpot applic local potenti impli two fourier transform nonlopappli applic nonloc part hamiltonian nonlopforc comput nonloc part interatom forc fourwfgr fourier transform need build firstord densiti also quit notic dfpt_vtorhompi synchronis mpi parallel studi speedup brought kpoint parallel simpl test case give follow behaviour core div idplotly_plot stylewidthheightpxdiv script function plotlynewplotdocumentgetelementbyidplotly_plot x name ideal x name observ titl parallel speedup xaxi titlenumb core script processor one get speedup quit decent effici processor speedup effici effici processor speedup comput one perturb slab atom barium titan test atom slower highlight aspect dfpt parallel al fcc case consist comput one perturb qpt atom slab barium titan artifici termin doubl tiosubsub layer face reason kpoint sampl brillouin zone symmetri system perturb allow decreas sampl one quarter brillouin zone eg kpoint sampl ngkpt actual kpoint irreduc brillouin zone ground state calcul dfpt case one binari symmetri surviv calcul frozenwavefunct part symmetri use selfconsist part done k point correspond irreduc brillouin zone beyond core parallelis done also band prove much depend comput architectur lowcommun parallel kpoint sampl k point irreduc brillouin zone dfpt case allow potenti use effici larger number processor provid comput architectur network good enough occupi band ground state calcul addit conduct band explicitli treat allow better scf stabil thank iprcel note valu ecut use present tutori low obtain physic result around hartre also one atom displac consid phonon frequenc deliv end run meaningless previou case preparatori groundstat calcul need use input variabl autopar deliv best repartit processor among npkpt npband npfft achiev decent repartit usual within factor two processor select npkpt optim npband npfft npband npband would better inform speeup go core core quit increas number processor anyhow topic tutori gs calcul input file provid directori abi_teststutoparalinput preparatori step driven tdfpt_abi real dfpt test case driven tdfpt_abi refer output file present abi_teststutoparalref tdfpt__mpiabo tdfpt__mpiabo name convent number core use run ad name test tdfpt_abi file run core preparatori step take minut dfpt step take minut well dialog teststutoparalinputtdfpt_abi teststutoparalinputtdfpt_abi run test case tdfpt_ autopar abl run differ number processor compat nkpt nband ngfft detect abinit altern might decid explicitli defin npkpt npband npfft varianc tdfpt_ adapt input file need abl run arbitrari number processor launch groundstat comput type mpirun n abinit tdfpt_abi log copi output groundstat calcul use input dfpt calcul mv tdfpt_o_wfknc tdfpt_i_wfknc launch calcul mpirun n abinit tdfpt_abi log examin obtain output file test especi time refer file abi_teststutoparalrefstdfpt__mpiabo comput core time section deliv major independ code section cpu wall time sec well time number call node begin_tim mpi_nproc omp_nthread mpi_rank cpu_tim wall_tim routin cpu wall number call gflop speedup efficac count projbd nonlopappli dfpt_vtorhompi fourwfpot nonlopforc fourwfgr pspini major independ code section cpu wall time sec well total time number call begin_tim mpi_nproc omp_nthread mpi_rank world cpu_tim wall_tim routin cpu wall number call gflop speedup efficac count projbd nonlopappli fourwfpot dfpt_vtorhompi nonlopforc fourwfgr pspini other end_tim subtot notic run took second wall clock time sum major independ code section reason close might explor behaviour cpu time differ number comput core consid valu processor timeconsum routin benefit parallel kpoint band parallel effici work mani import section code projbd fourwfpot nonlopappli fourwfgr test product nkpt effect number k point current perturb time nband cours total speedup satur well valu nonparallel section code abovement list kpointband parallel exploit badli exploit sever section code dfpt_vtorhompi percent total time run processor pspini percent amount total howev scalabl band parallelis rather poor effect satur case alreadi happen processor studi speedup brought combin kpoint band parallel test case amd epyc machin cpu core give follow behaviour core div idplotly_plot stylewidthheightpxdiv script function plotlynewplotdocumentgetelementbyidplotly_plot x name ideal x name observ titl parallel speedup xaxi titlenumb core script addit band parallel effici run core bring speedup use k point parallel core give speedup howev behaviour disappoint beyond core even number processor multipl behaviour might differ machin better parallel seen number kpoint brought back converg valu xx tri processor hand set input file tdfpt_abi tdfpt_abo ngkpt replac ngkpt launch preliminari step dfpt step practic dfpt calcul vari number comput core latter could even consid vari number selfconsist iter see initialis effect small valu nstep target valu give converg result nstep instead nstep energi cutoff might also increas eg ecut hartre give much better valu inde larg valu k point larg valu nstep might abl obtain speedup one hundr dfpt calcul compar sequenti run see keep track time comput core number observ scale machin good commun network follow result observ wall clock time decreas proc individu time sec cpu wall processor proc individu time sec cpu wall processor next figur present speedup typic calcul increas number comput core also effici calcul schema paral_dfpt_assetsspeedupjpeg beyond comput core sequenti part code start domin realist comput paramet ecut domin beyond processor howev recent slow connect beyond core comput ngkpt case satur set alreadi beyond core follow behaviour refer taken respect time processor div idplotly_plot stylewidthheightpxdiv script function plotlynewplotdocumentgetelementbyidplotly_plot x name ideal x name observ titl parallel speedup xaxi titlenumb core script thu import gain understand scale typic run particular comput know paramet especi nkpt calcul core abinit scale usual good kpoint parallel possibl rang core speedup might still good depend detail last exampl end present tutori basic current implement parallel dfpt part abinit explain explor two test case one small cell materi lot k point anoth one mediums k point band parallel must use might reveal effici depend detail calcul comput architectur author bamadon ogingra tutori dftdmft dftdmft calcul srvosubsub tutori aim show perform dftdmft calcul use abinit learn dftdmft learn dftdmft calcul main input variabl control type calcul might use alreadi know paw calcul use abinit mandatori follow two tutori paw abinit pawtutorialpaw pawtutorialpaw also dftu tutorialtutorialdftu abinit might use know basic variabl common dft_u_ dftdmft tutori take one hour complet less access sever processor tutorial_readm dftdmft method summari key paramet dftdmft method aim improv descript strongli correl system gener highli correl materi contain rareearth metal transit metal partial fill f band thu local electron inform method pleas refer citegeorg citekotliar introduct mani bodi physic green function selfenergi imaginari time matsubara frequenc see eg citecoleman citetremblay sever paramet physic technic need discuss dftdmft calcul definit correl orbit abinit dmft implement done help project wannier orbit see citeamadon first part tutori explain import choic wannier function unitarili relat select set kohn sham ks wavefunct specifi abinit band index dmftbandi dmftbandf thu empti band necessari build wannier function requir dmft calcul ks hamiltonian correctli diagon use high valu nnsclo nline dmft calcul preced dft calcul roughli speak larger dmftbandfdmftbandi local radial part orbit note definit differ definit correl orbit dft_u_ implement abinit see citeamadona relat two express briefli discuss citeamadon definit coulomb exchang interact u j done dft_u_ variabl upawu jpawu could comput crpa method also avail abinit valu u j principl depend definit correl orbit tutori u j seen paramet dft_u_ approach dft_u_ two doubl count method avail see dmft_dc input variabl choic doubl count correct current default choic abinit dmft_dc correspond full local limit method resolut anderson model abinit hubbard method dmft_solv continu time quantum mont carlo ctqmc method dmft_solv static mean field method dmft_solv equival usual dft_u_ solut anderson hamiltonian dmft solut strongli depend temperatur temperatur tsmear import physic paramet calcul practic solut dftdmft scheme usual present doubl loop first local green function second electron local densiti cf fig citeamadon number iter loop respect given abinit keyword dmft_iter nstep use variabl dmft_rslf prtden abl restart calcul densiti file lastli one linear one logarithm grid use matsubara frequenc indic dmft_nwli dmft_nwlo typic valu converg studi larg number inform given log file use pawprtvol electron structur srvo lda might creat subdirectori abi_teststutopar directori use tutori follow name file mention subdirectori copi file tdmft_abi abi_teststutopar work directori sh cd abi_teststutoparalinput mkdir work_dmft cd work_dmft cp tdmft_abi dialog teststutoparalinputtdmft_abi run abinit mpirun n abinit tdmft_abi log_ run take time recommend use least processor fast calcul lda ground state srvo comput band structur second step variabl pawfatbnd allow creat file fatband see descript variabl list variabl width line along kpoint path band proport contribut given atom orbit particular kohn sham wavefunct low cutoff small number kpoint use order speed calcul time take look input file two dataset first one ground state calcul nnsclo nline order well diagon eigenfunct even empti state practic howev check residu wavefunct small end calcul calcul find e larg e would better nnsclo nline increas would take time calcul finish plot fatband vanadium l sever possibl avail purpos work simpl xmgrace packag need instal alreadi avail machin xmgrace tdmft_o_ds_fatbands_at_v_is_l par inputtdmft_fatbandpar band structur given ev fatbandvdmft_assetsfatbandvjpg fatband oxygen atom l xmgrace tdmft_o_ds_fatbands_at_o_is_l tdmft_o_ds_fatbands_at_o_is_l tdmft_o_ds_fatbands_at_o_is_l par inputtdmft_fatbandpar fatbandvdmft_assetsfatbandojpg plot recov band structur srvo see comparison band structur fig citeamadon main charact band band mainli _d_ band mainli oxygen _p_ howev clearli see import hybrid fermi level ev middl band one easili check band mainli _dt g_ band mainli _esubgsub_ use pawfatbnd tdmft_abi relaunch calcul file tdmft_o_ds_fatbands_at_v_is_l_m tdmft_o_ds_fatbands_at_v_is_l_m tdmft_o_ds_fatbands_at_v_is_l_m give respect _xy_ _yz_ xz fatband ie _dt g_ tdmft_o_ds_fatbands_at_v_is_l_m tdmft_o_ds_fatbands_at_v_is_l_m give _zsupsup_ _xsupsupysupsup_ fatband ie _esubgsub_ conclus studi kohn sham band mainli _tsubgsub_ band cours could anticip classic crystal field theori vanadium center octahedron oxygen atom _d_ orbit split _tsubgsub_ _esubgsub_ _tsubgsub_ orbit direct toward oxygen atom _tsubgsub_lik band lower energi fill one electron wherea _esubgsub_lik band higher empti next section thu use _tsubgsub_lik band built wannier function dftdmft calcul electron structur srvo dftdmft calcul input file dmft calcul correl orbit screen coulomb interact frequenc mesh abinit correl orbit defin use project local orbit wannier function outlin definit requir defin given energi window project wannier function construct would like tutori appli dmft method _d_ orbit simplic subset _d_ orbit name _tsubgsub_ orbit _esubgsub_ orbit play minor role empti need defin _tsubgsub_ orbit use wannier function seen orbit resolv fatband kohn sham wave function contain import weight _tsubgsub_ atom orbit mainli _t subgsub_lik band also oxygen band use _tsubgsub_lik band defin wannier function also _tsubgsub_lik _op_ like band first case correspond input file tdmft_abi case dmftbandi dmftbandf put electron interact _tsubgsub_ orbit use first lpawu also keyword dmft_tg order restrict applic interact _tsubgsub_ orbit notic also launch dmft calcul lda perfectli converg includ empti state check nline nnsclo input file input file tdmft_abi thu contain two dataset first one well converg lda calcul second dftdmft calcul notic dmft variabl use input file check mean input variabl glossari particular use dmft_solv dmft dataset order use densitydens continu time quantum mont carlo ctqmc solver see citegul well abinit paper citegonz detail ctqmc implement abinit note number imaginari frequenc dmft_nwlo set least twice valu dmftqmc_l discret imaginari time choos temperatur k lower temperatur number matsubara frequenc higher use fast calcul small valu paramet especi dmft_nwlo dmftqmc_l dmftqmc_n let discuss valu effect coulomb interact u upawu j jpawu valu u j use abinit dmft use convent dft_u_ calcul abinit cf citeamadona howev calcul ref citeamadon use u j usual convent _tsubgsub_ system found citelechermann eq see also appendix citefresard correspond slater integr f show u_abinitu j j_abinit j order use u ev j ev latter convent citeamadon use abinit upawu ev jpawu ev fof_sla launch calcul copi file inputtdmft_abi work directori run abinit mpirun n abinit tdmft_abi log_ dialog teststutoparalinputtdmft_abi dftdmft calcul log file go brows quickli log file log_ calcul start start dmft calcul first definit logarithm grid frequenc prepar data dmft calcul project kohn sham wavefunct truncat atom orbit comput eq citeamadon unnorm orbit built eq citeamadon occup matrix orbit basi symetris occup normal orbit basi symetris norm let compar number quantiti preced lda calcul converg dmatpuopt use dmftbandi dmftbandfnband symetris occup exactli equal occup matrix given usual dft_u_ occup matrix written log file dmatpuopt see discuss citeamadon case case dmftbandi condit fulfil concern norm orbit two factor play role firstli number kohn sham function use infinit cf eq b citeamadon case take account band emphas limit approach physic choic concern wannier function physic choic induc intermedi wave function low norm secondli atom orbit use project cut paw radiu consequ even would use complet set ks wavefunct thu closur relat norm could one case could norm truncat atom function _d_ orbit vanadium use calcul number found log file search phphiint grep phphiinticount log_ see also discuss section b citeamadon next lda green function comput dft green function calcul green function integr comput occup matrix interestingli densiti matrix must equal densiti matrix comput unnorm correl orbit case mean frequenc grid suffici larg case find error small e exercis decreas number frequenc see error becom larger true orthonorm wannier function built green function comput basi dft green function calcul renorm psichi occup matrix see orthonorm orbit necessari built wannier function occup matrix logic increas defin interact selfenergi interact kernel comput u j self energi read disk file exist green function comput self energi fermi level comput dmft loop start dmft loop start log contain lot detail calcul especi pawprtvol order synthet overview calcul especi use detect possibl diverg calcul follow command extract evolut number electron lda lda wannier function dmft number electron function iter care number electron comput differ explain log file grep e nb e iter log_ besid dmft calcul one ctqmc calcul start qmc thermal sake effici dmft loop calcul done dft loop cf fig citeamadon end calcul occup matrix written polar spin compon see total number electron close one chang much function iter output calcul find self energi file tdmft_o_dsselfomega_iatom_isppol green function file gtaudat self energi use selfenergi comput quasiparticl renorm weight first extract first six matsubara frequenc head n tdmft_o_dsselfomega_iatom_isppol selfdat plot imaginari part selfenergi imaginari frequenc xmgrace block selfdat bxi use xmgrace click _data_ _transformations_ _regression_ th order fit selfdmft_assetsselfjpg slope zero frequenc obtain number quasiparticl renormalis weight obtain use z green function correl orbit impur local green function correl orbit written file gtaudat plot function imaginari time interv   invers temperatur hartre plot green function six _tsubgsub_ orbit use eg xmgrace xmgrace nxi gtaudat gtaudmft_assetsgtaujpg six _t g _ orbit degener six green function must similar within stochast nois moreov imaginari time green function must neg valu g orbit equal opposit number electron orbit ni optionn check green function rough way check import stochast nois exampl chang simplic number step dmft calcul nstep use much smaller number step mont carlo solver dmftqmc_n save previou gtaudat file cp gtaudat gtaudat_sav relaunch calcul complet compar new green function old one previou valu dmftqmc_n use xmgrace xmgrace nxi gtaudat_sav nxi gtaudat one obtain gtaudmft_assetsgtaujpg one natur see stochast nois much larger case stochast nois induc variat physic quantiti number electron electron densiti energi function number iter noisi finish comparison copi save green function gtaudat order continu tutori precis green function gtaudat cp gtaudat_sav gtaudat local spectral function use imaginari time green function contain file gtaudat comput spectral function real frequenc analyt continu done quantum mont carlo data use maximum entropi method maximum entropi code publish recent bergeron download herehttpswwwphysiqueusherbrookecamaxentindexphpmain_pag pleas cite relat paper citebergeron use code public code lot option definit method understood user guid read real use goal dftdmft tutori introduc maximum entropi method see citebergeron refer therein give quick way obtain spectral function first instal code armadillo librari follow guidelineshttpswwwphysiqueusherbrookecamaxentindexphpdownload launch current directori order gener default input file omegamaxent_input_paramsdat omegamax edit file omegamaxent_input_paramsdat modifi first seven line data file gtaudat option preprocess time paramet data paramet boson data yesno imaginari time data yesno ye relaunch code omegamax plot spectral function xmgrace omegamaxent_final_resultoptimal_spectral_function_dat chang unit hartre ev spectral function spectralfunctiondmft_assetsspectralfunctionjpg even calcul well converg recogn spectral function quasiparticl peak well hubbard band ev ev fig citeamadon electron structur srvo choic correl orbit previous _tsubgsub_lik band use definit wannier function hybrid _tsubgsub_ orbit oxygen _p_ orbit wannier function would pure atom orbit would chang energi window increas import hybrid consequ built wannier function larg window includ oxygen _p_ like band definit wannier function creat new input file cp tdmft_abi tdmft_abi use dmftbandi tdmft_abi code built wannier function larger window includ _op_ like band thu much local launch calcul calcul long decid restart second dataset directli converg lda calcul instead redo lda calcul new dmft calcul abinit tdmft_abi log_ case occup norm larger state taken account occup matrix symetris occup norm symetris norm let us compar total number electron norm two energi window center energi window _tsubgsub_lik band _tsubgsub_lik _op_ like band dmftbandidmftbandf norm lda number electron lda number electron center larg window use kohn sham state occup norm larger mainli import weight _d_ orbit oxygen band hybrid concern norm remind case larger norm mean select band calcul took account weight truncat atom orbit among kohn sham band moreov orthonorm check differ lda number electron still larg versu even orthonorm effect larger small window case end dftdmft calcul occup matrix written polar spin compon similarli previou calcul spectral function plot use maximum entropi code find spectral function hybrid peak ev describ fig citeamadon spectralfunctiondmft_assetsspectralfunctionjpg resolv lower hubbard band would requir converg calcul one comput renorm weight give show valu u j interact weaker effect larg window wannier function inde valu screen interact u larger wannier function local see discuss citeamadon electron structur srvo intern energi intern energi obtain grep e iter e intern log_ select second occurr iter doubl count express accur iscf converg express equal also dftdmft gather data center iter intern energi ha e e e e e e e e e e center plot evolut intern energi function iter internaldmft_assetsinternaljpg notic intern energi dftdmft calcul converg function iter finit statist nois function iter first intern energi start converg modif energi induc self consist cycl larger statist nois intern energi fluctuat around mean valu statist nois larger toler calcul never converg given precis total energi expect practic solut increas number quantum mont carlo step dmftqmc_n order lower statist nois also anoth solut averag last valu intern energi electron structur srvo dftdmft equilibrium volum focu total energi creat new input file tdmft_abi cp tdmft_abi tdmft_abi use acel instead relaunch calcul note intern energi grep intern tdmft_abo redo anoth calcul acel plot dmft energi function acel center acel intern energi dmft center notic equilibrium volum weakli modifi strong correl case electron structur srvo kresolv spectral function go use omegamax direct analyt continu selfenergi matsubara frequenc real frequenc precis way analyt continu use auxiliari green function mention eg endnot ref citesakumaa first go relaunch converg calcul use tdmft_abi dialog teststutoparalinputtdmft_abi launch calcul might take time calcul take minut processor abinit tdmft_abi log_ go creat new directori analyt continu mkdir spectral first extract first matsubara frequenc noisi head n tdmft_o_dsselfrotformaxent_isppol_iflavor spectralselfdat directori launch omegamax gener input templat cd spectral omegamax edit input file omegamaxent_input_paramsdat omegamax specifi data contain selfdat contain finit valu infinit frequenc first line look like data file selfdat option preprocess time paramet data paramet boson data yesno imaginari time data yesno temperatur energi unit k_b finit valu infinit frequenc yesno ye relaunch omegamax omegamax plot imaginari part self energi real frequenc care file contain fact imsigma anoth analyt continu tool use one need give abinit imsigma sigma xmgrace omegamaxent_final_resultoptimal_spectral_functiondat need give abinit file order abinit use comput green function real frequenc deduc kresolv spectral function first copi self energi real axi self energi file grid file abinit cp omegamaxent_final_resultoptimal_spectral_functiondat self_radat cd creat file contain frequenc grid wc l self_radat tdmft_o_ds_spectralfunction_realfrequencygrid cat self_radat tdmft_o_ds_spectralfunction_realfrequencygrid particular case three self energi three tg orbit equal one analyt continu duplic result cp self_radat tdmft_i_dsself_raomega_iatom_isppol cat self_radat tdmft_i_dsself_raomega_iatom_isppol cat self_radat tdmft_i_dsself_raomega_iatom_isppol tdmft_i_dsself_raomega_iatom_isppol file contain three time self real axi selfenergi three orbit degener one would cours use differ real axi selfenergi orbit thu analyt continu copi file contain rotat self energi local basi use non cubic case matrix useless cp tdmft_o_dsunitarymatrix_for_diaglevel_iatom tdmft_i_dsunitarymatrix_for_diaglevel_iatom copi self energi imaginari frequenc restart also dmft_nwlo input file tdmft_abi tdmft_abi cp tdmft_o_dsselfomega_iatom_isppol tdmft_o_dsselfomega_iatom_isppol modifi tdmft_abi ndtset jdtset relaunch calcul abinit tdmft_abi log__dataset spectral function obtain file tdmft_o_ds_dftdmft_spectralfunction_kresolved_from_realaxisself copi file bandsdat cp tdmft_o_ds_dftdmft_spectralfunction_kresolved_from_realaxisself bands_dmftdat extract dft band structur fatband file readabl file gnuplot number kpoint use plot band structur obtain grep nkpt log__dataset grep band tdmft_o_ds_fatbands_at_v_is_l grep v band bands_dftdat use gnuplot script plot dialog teststutoparalinputtdmft_gnuplot gnuplot g n u p l version patchlevel last modifi copyright c thoma william colin kelley mani other gnuplot home httpwwwgnuplotinfo faq bug etc type help faq immedi help type help plot window hit h termin type qt gnuplot load tdmft_gnuplot spectral function thu look like internaldmft_assetsbandspng white curv lda band structur color plot dmft spectral function one note renorm bandwith well hubbard band mainli visibl high energi arount ev precis descript hubbard band would requir converg calcul electron structur srvo conclus sum import physic paramet dftdmft definit correl orbit choic u j doubl count import technic paramet frequenc time grid well number step mont carlo dmft loop dft loop show tutori comput correl orbit spectral function quasiparticl renorm weight total intern energi kresolv spectral function author jwz phg mveithen xg nap tutori static nonlinear properti electron nonlinear suscept nonreson raman tensor electroopt effect tutori show obtain follow nonlinear physic properti insul nonlinear optic suscept raman tensor lo mode electroopt coeffici studi compound alp preliminari step need comput nonlinear properti also obtain sever linear respons properti born effect charg dielectr constant proper piezoelectr tensor clamp relax ion final also comput deriv suscept tensor respect atom posit raman tensor use finit differ user alreadi complet sever advanc tutori includ responsefunct tutorialrf responsefunct tutorialrf polar finit electr fieldstutorialffield elast propertiestutorialelast tutori take hour minut tutorial_readm groundstat properti alp gener paramet begin might consid work differ subdirectori tutori exampl creat work_nlo abi_teststutorespfninput order save time might immedi start run calcul copi file tnlo_abi abi_teststutorespfninput work_nlo run abinit file take sever minut desktop pc tutori assum groundstat properti alp previous obtain correspond converg studi done let us emphas experi accur trustabl result third order energi deriv usual requir extrem high level converg even alway appar care converg studi must explicitli perform practic studi attempt tutori usual converg test must done properti interest thu insuffici determin paramet give proper converg total energi use blindli nonlinear properti adopt follow set gener paramet quit similar tutori polar finit electr fieldtutorialffield acel e rprim e e e e e e e e e ecut ecutsm dilatmx nband number occupi band ngkpt nshiftk shiftk pseudopotenti pseudodojo_nc_sr__pw_standard_pspppsp pseudodojo_nc_sr__pw_standard_pspalpsp principl acel use one correspond optim structur ecut ngkpt combin nshiftk shiftk chosen calcul unfortun purpos tutori order limit durat run work unusu low cutoff ha optim lattic constant unrealist equal bohr instead converg valu follow lattic constant arbitrarili fix bohr comparison result ecut also report case obtain optim lattic constant bohr would like tri later converg test structur optim done use file abi_teststutorespfninputtnlo_abi dialog teststutorespfninputtnlo_abi go might refresh memori concern variabl ecutsm dilatmx nbdbuf linear nonlinear respons densiti function perturb theori dfpt theoret support section tutori might consid read citeveithen first part tutori describ comput variou linear nonlinear respons directli connect secondord third order deriv energi use dfpt n theorem comput energi deriv third order requir knowledg groundstat firstord wavefunct see citegonz citegonz studi therefor includ follow step comput groundstat wavefunct densiti ii determin wavefunct deriv construct relat databas second third order energi deriv iii combin differ databas analysi get physic properti interest step close relat done dielectr dynam properti except addit databas thirdord energi deriv comput run select thirdord deriv implement present abinit concern respons electr field atom displac nonlinear optic suscept relat thirdord deriv energi respect electr field clamp nuclei posit raman suscept mix thirdord deriv energi twice respect electr field clamp nuclei posit respect atom displac electroopt coeffici relat thirdord deriv energi respect electr field two optic field clamp ionic posit one static field ionic posit allow relax variou step combin singl input file two implement avail abinit comput thirdord deriv includ least one electr field perturb tensor mention first present pead method describ citeveithen present full dfpt method describ citegonz citeromero latter case input file slightli modifi reader interest full dfpt read pead part first full dfpt implement avail paw pseudopotenti respons electr field atom displac strain pead let us examin file tnlo_abi dialog teststutorespfninputtnlo_abi purpos build databas second third energi deriv respect electr field atom displac strain edit made dataset first four data set nearli typic linear respons calcul selfconsist calcul ground state irreduc brillouin zone non selfconsist calcul ground state get wavefunct full brillouin zone comput deriv wavefunct respect k point use dfpt second deriv energi relat firstord wavefunct respect electr field atom displac strain final third deriv calcul specif featur must howev explicitli specifi order prepar nonlinear respons step dataset first mandatori specifi nbdbuf nband number valenc band fill band treat also dataset requir impos prtden prepanl prtden prepanl purpos prtden obtain first order densiti addit first order wavefunct purpos prepanl constrain kptopt even comput phonon abinit usual take advantag symmetri irrespect kptopt ii comput electr field deriv direct space irrespect symmetri note also strain perturb use dataset inform provid necessari obtain relax ion properti examin later input dataset trigger variou thirdord deriv comput section includ follow getwfk getden getwf kptopt optdriv de_pert_elfd de_pert_phon de_pert_atpol de_pert_dir de_pert_elfd de_pert_dir de_pert_elfd de_pert_dir first three line retriev ground state firstord densiti wavefunct optdriv trigger rdorder energi calcul final de input variabl determin perturb rd order deriv direct notic comput three deriv respect electr field de_pert_elfd de_pert_elfd de_pert_elfd combin give necessari data nonlinear optic suscept also includ de_pert_phon atom unit cell de_pert_atpol combin later electr field perturb yield necessari inform raman tensor final three perturb class comput perturb three spatial direct done begin tutori make run quick look output file verifi everyth ok contain valu second third energi deriv howev immedi interest sinc inform present conveni format relev inform fact also store databas file ddb gener independ second third energi deriv end run step keep databas use later global conveni analysi result use anaddb respons electr field atom displac strain full dfpt alreadi done reader read part pead method contrari pead full dfpt electr field treat analyt way done comput secondord deriv energi see responsefunct tutorialrf one need first order wavefunct deriv respect kpoint dataset tnlo_abi comput second order energi deriv electr field perturb dataset tnlo_abi turn thirdord deriv energi context need second deriv wavefunct respect electr field kpoint comput latter one also need second deriv wavefunct respect kpoint total need two addit set wavefunct deriv compar file tnlo_abi tnlo_abi dialog teststutorespfninputtnlo_abi first four dataset ident produc ground state quantiti firstord wf deriv second deriv energi exactli way comput nonlinear term two addit dataset comput need secondord wf deriv see dataset similar dataset comput ddk wf deriv except keyword activ secondord wf deriv comput rf_dkdk rf_dkde read need file rf_dkdk getddk prepanl rf_dkde getddk getdkdk getden getdelfd prepanl use prepanl make use crystal symmetri comput direct need nonlinear term latter comput dataset compar tnlo_abi contain three addit line getddk getdkd usepead first two argument specifi file read get ddk ddkde wf deriv usepead keyword control implement use use full dfpt alreadi done run code tnlo_abi even small cutoff ha nonlinear suscept tensor differ percent compar pead full dfpt firstord chang electron dielectr suscept tensor differ less one percent differ come converg effect reduc increas cutoff energi importantli number kpoint note set paramet full dfpt method take obvious cpu time pead comput secondord wf deriv howev expect full dfpt method converg faster number kpoint one could actual save cpu time memori use full dfpt get converg result pead case code produc ddb file use rest tutori merg ddb stage use either pead full dfpt method relev energi deriv obtain store individu databas follow use data produc pead one use full dfpt instead compar individu databas must combin helpmrgddbmrgddb merg util order get complet databas tnlo_ddbout explicitli merg file tnlo_o_ds_ddb tnlo_o_ds_ddb input file pipe mrgddb provid tnlo_abi dialog teststutorespfninputtnlo_abi use perform merg via abi_homesrc_mainmrgddb tnlo_abi analysi ddb readi analysi result use helpanaddbanaddb copi file abi_teststutorespfninputtnlo_abi abi_teststutorespfninputtnlo_fil worknlo dialog teststutorespfninputtnlo_fil teststutorespfninputtnlo_abi alreadi use anaddb previous locat directori abinit mrgddb might copi make alia present input similar one use analysi dynam dielectr respons except new flag need activ strain perturb need specifi anaddbelaflag anaddbpiezoflag anaddbinstrflag elaflag piezoflag instrflag nonlinear respons need nlflag ramansr alphon prtmbm anaddbnlflag activ nonlinear respons anaddbramansr impos sum rule firstord chang electron dielectr suscept atom displac hereaft refer fracd chid tau condit invari chi translat whole crystal similar acoust sum rule phonon gamma charg neutral sum rule effect charg z anaddbprtmbm allow get mode mode phonon contribut ion electroopt coeffici anaddbalphon allow get previou mode mode contribut align eigenvector cartesian axi coordin input princip axi alway align z conveni analysi result final second list phonon specifi anaddbnphl anaddbqphl must also explicitli consid obtain raman effici longitudin mode way similar comput frequenc longitudin mode frequenc gamma wave vector list nphl qphl run code anaddb abi_homesrc_mainanaddb tnlo_fil result file tnlo_abo variou interest physic properti directli access output meaning unit go file identifi result mention note order given order appear tnlo_abo jump differ section tnlo_abo find comparison report parenthesi valu obtain ecut nonlinear respons bracket result citeveithen born effect charg al z_al optic phonon frequenc gamma w_to cm w_lo cm linear optic dielectr constant electron dielectr tensor static dielectr constant relax ion dielectr tensor quantiti piezoelectr coeffici relat strain respons extens discuss tutori strain perturb proper piezoelectr coeffici clamp ion cm relax ion cm final differ quantiti relat nonlinear respons nonlinear optic suscept directli provid output pmv see valu comput ecut far well converg result d_ pmv electroopt coeffici ask mode mode decomposit output provid individu contribut report summari result concern clamp r_ coeffici electron eo constant pmv full ionic eo constant pmv total eo constant pmv raman properti code directli report raman suscept alpha transvers longitudin lo optic mode gamma alphato alphalo basic quantiti deriv raman suscept partialchipartialtau also report separ chi_d tau_ bohr al cubic semiconductor common report raman polariz optic phonon mode gamma follow express citeveithen omega_ partialchipartialtau sqrtmu omega_alpha omega_ primit unit cell volum report ucvol exampl tnlo_abo mu reduc mass system mu m_al m_p alpha raman suscept tensor raman polariz unit length use alphato alphalo along mu omega_ atom unit convert length bohr angstrom find ato unit ang alo unit ang finit differ calcul raman tensor comparison dfpt calcul comput fracd chid tau al nucleu finit differ practic achiev comput linear optic suscept differ posit al nucleu done file abi_teststutorespfninputtnlo_abi dialog teststutorespfninputtnlo_abi file use unrealist low cutoff energi ecut ha calcul take minut standard desktop pc run calcul copi abi_teststutorespfninputtnlo_abi work directori run abinit time modifi cutoff ecut ha order obtain realist result run take twice along ha version input file tnlo_abi contain dataset arrang doubl loop ndtset udtset input variabl ndtset indic total set usual udtset variabl indic outer loop set inner loop four set outer loop three set atom posit set xcart first equilibrium second two aluminum shift bohr along x tau equilibrium xcart e e e e e e tau aluminum shift along x bohr xcart e e e e e e tau aluminum shift along x bohr xcart e e e e e e three set posit standard fourset dfpt calcul electr field respons clamp ion posit execut ground state wavefunct irreduc brillouin zone ground state wavefunct full brillouin zone respons chang k vector respons electr field yield dielectr tensor run calcul follow avail output file tnlo_abo quot result ecut tau dielectr tensor cartesian coordin j j matrix element dir pert dir pert real part imaginari part tau dielectr tensor cartesian coordin j j matrix element dir pert dir pert real part imaginari part tau dielectr tensor cartesian coordin j j matrix element dir pert dir pert real part imaginari part extract valu dchi_dtau_ al dielectr tensor hereaft call ep use follow finitediffer formula unit bohr dchi_dtau_ pi eps_tau eps_tautau pi valu close obtain ecut dfpt converg reach bewar k point converg extrem slow much slower properti approach yield result might therefor ask approach conveni use practic guid note finitediffer approach give result similar dfpt one similar cutoff kpoint grid howev tediou individu atom displac must success consid becom cumbersom complex crystal result must convert appropri unit risk error manipul dfpt approach conveni avoid consider oper intervent everyth report togeth dchi dtau also full raman polariz tensor appropri unit therefor consid better choic plot raman spectrum output anaddb analysi exampl tnlo_abo perform use plot simul raman spectrum includ peak posit intens compar experi mani detail process outlin citecaraca postprocess script written python avail abinit packag see abi_homescriptspost_processingraman_specpi instal whole abinit packag use compil execut document web make extra effort download full packag mention abinit instal note program read input file set anaddb file read output file base name variou process paramet continu suggest copi script work directori make link run python raman_specpi help give outlin input file format dont afraid open read raman_specpi file detail file input start minim input file raman_specpi tnlo_abo run filenam anaddb run creat raman tensor filenam tnlo_abo base name raman_specpi output file outnam alpout temperatur kelvin spectrum default zero k temp number frequenc default n_freq min max frequenc default band found default unit cm user instead specifi ha hz min_freq max_freq lorentzian broaden appli default zero default unit cm user instead specifi ha hz spread calcul type powder calctyp copi editor save exampl alpinput execut python raman_specpi alpinput complet examin variou output file produc name start alpout human readabl ascii file welldocu exampl visual powder spectrum mode predict anaddb run plot first two column alpout_spec give frequenc intens powderaverag raman spectrum result powderaverag spectra plot gnuplot shown cubic structur calcul result spectra contain singl raman mode correspond xy polar nlo_assetsalpramanecutpng final one includ calcul frequencydepend dielectr tensor anaddb calcul see anaddbdieflag program extract dielectr tensor print file author mg ms tutori bethesalpet calcul absorpt spectra includ exciton effect tutori discuss calcul macroscop dielectr function includ exciton effect within bethesalpet bs approach crystallin silicon use test case brief descript formal found theorybsebethersalpet note user familiar four basic tutori abinit first gw tutorialtutorialgw visualis tool cover tutori power visualis procedur develop abipi context reli matplotlib see readm abipyhttpsgithubcomabinitabipi abipi tutorialshttpsgithubcomabinitabitutori tutori take one hour complet tutorial_readm preparatori step wfk scr file start might consid work differ subdirectori tutori work_b copi input file abi_teststutorialinputtbs_abi work directori work_b make sure sipsp pseudopotenti need run tutori place abi_pspdirpseudodojo_nc_sr__pw_standard_psp run immedi calcul command abinit tbs_abi tbs_log err analyz input file code run input file locat abi_teststutorialinputtbs_abi header report brief descript calcul read care worri part clear go discuss calcul step step fashion dialog teststutorialinputtbs_abi input file gener two wfk file scr file need subsequ bethesalpet comput first dataset perform rather standard groundstat calcul gammacent xx grid k point full brillouin zone fold k point irreduc wedg groundstat densiti use dataset gener two wfk file standard nscf run conjugategradi method note wfk file comput dataset contain band xx gammacent kmesh wherea wfk file produc dataset band xx kmesh shift along direct shiftk shift break symmetri kmesh gammacent kmesh contain point ibz shift kmesh break symmetri crystal lead point ibz actual ibz coincid full brillouin zone second mesh clearli ineffici might wonder use bizarr sampl besid need gener two differ wfk file inde approach strongli differ one follow gw tutori good reason anticip optic spectra converg slowli bz sampl symmetrybreak kmesh lead faster converg nkpt standard symmetr kmesh commonli use groundstat gw calcul explain bizarr shift still two wfk file simpli use wfk file shift kmesh comput screen reason screen calcul done mani empti band shift kmesh would memori demand code alloc huge portion memori whose size scale nband nkpt symmetri use reduc number kpoint summar wfk symmetr kpoint sampl band use comput screen wfk file shift kmesh band use construct transit space employ solv bethesalpet equat two kmesh differ shift thu produc set qpoint list qpoint screen defin possibl differ kpoint wfk file mean bethesalpet run use scr file gener symmetr mesh even though transit space construct shift kmesh lengthi discuss need clarifi rather technic point final proceed analyz screen comput perform last dataset tbs_abi scr file calcul dataset use nband ecutep ha first gw tutorialtutorialgw valu found give qp energi converg within ev confid scr file well converg safe use perform converg test bethesalpet part note effici reason static limit w comput nfreqr static limit w need standard bse calcul nfreqim inde standard formul bethesalpet equat static limit screen interact need construct coulomb term bs hamiltonian use singl frequenc allow us save cpu time screen part keep mind scr file use either bethesalpet comput gw calcul employ plasmonpol model correspond ppmodel point calcul complet still one thing move next paragraph said need wfk file shift kmesh scr file bs calcul delet also good idea renam preciou file use meaning name eg mv tbs_o_ds_wfk _gamma_wfk mv tbs_o_ds_wfk _shifted_wfk mv tbs_o_ds_scr _scr import list kpoint specifi bs input file must equal one use gener wfk file two new wfk file new scr file must gener scratch want chang kpoint sampl use construct transit space comput absorpt spectrum within tammdancoff approxim section intend show perform standard exciton calcul within tammdancoff approxim tda use haydock iter techniqu input file abi_teststutorialtutorialinputtbs_abi run job connect calcul output result produc tbs_abi use unix command ln _shifted_wfk tbs_i_wfk ln _scr tbs_i_scr creat two symbol link shift wfk scr file reason clear afterward discuss input file job last minut modern machin worth run inspect input file copi file abi_teststutorialinputtbs_abi work directori issu abinit tbs_abi tbs_log err put job background examin tbs_abi open abi_teststutorialinputtbs_abi prefer editor go next section discuss import variabl govern typic bs comput dialog teststutorialinputtbs_abi structur input file first need set optdriv call bse routin optdriv bs calcul variabl irdwfk irdscr similar ird variabl abinit use read file produc previou paragraph irdwfk read wfk file produc tbs_ irdscr read scr file produc tbs_ code expect find input wfk file input scr file reason creat two symbol link run code list five variabl specifi construct exciton hamiltonian bs_calctyp l construct ks orbit energi mbpt_sciss ev scissor oper use correct ks band structur bs_exchange_term exchang term includ bs_coulomb_term coulomb term includ use full matrix w_gg bs_coupl tammdancoff approxim valu bs_calctyp specifi independentparticl polariz construct kohnsham orbit energi read wfk file simul selfenergi correct ks energi correct scissor oper energi mbpt_sciss ev permit us avoid cumbersom gw calcul state includ transit space use scissor oper reason approxim silicon might fail complic system gw correct simul term simpl rigid shift initi ks band structur remain three variabl specifi construct exciton hamiltonian bs_exchange_term tell code calcul exchang part kernel henc calcul includ localfield effect variabl bs_coulomb_term use select among differ option avail coulomb term pleas take time read descript variabl relev equat theorybsebethesalpet note final bs_coupl specifi offdiagon coupl block neglect tammdancoff approxim particular combin paramet thu correspond bethesalpet calcul within tammdancoff approxim local field effect includ specif band use construct transit space bs_loband nband case band around gap whose index includ basi set frequenc mesh macroscop dielectr function specifi bs_freq_mesh bs_freq_mesh ev frequenc mesh triplet real valu defin linear mesh cover rang ev step ev number frequenc point mesh signific effect cpu time import stress number band includ transit space defin conjunct number kpoint frequenc rang describ consequ bs_loband nband subject accur converg studi paramet defin control algorithm employ calcul macroscop dielectr function bs_algorithm haydock method default valu bs_haydock_nit max number iter haydock method bs_haydock_tol toler iter method zcut ev complex shift avoid diverg continu fraction bs_algorithm specifi algorithm use calcul macroscop dielectr function case use iter haydock techniqu whose maximum number iter given bs_haydock_nit iter algorithm stop differ two consecut evalu optic spectra less bs_haydock_tol input variabl zcut give complex shift avoid diverg continu fraction physic point view paramet mimic experiment broaden absorpt peak test due coars kmesh use valu slightli larger default one ev order facilit converg haydock algorithm ideal one perform converg studi decreas valu zcut increas number kpoint kpoint sampl specifi set variabl kptopt option automat gener k point ngkpt mesh coars optic properti nshiftk shiftk shift break symmetri kmesh chksymbreak mandatori use symmetrybreak kmesh bs code import valu kptopt ngkpt nshiftk shiftk must equal one use specifi grid wfk file chksymbreak use bypass check symmetri break otherwis would make code stop last section input file ecutwfn cutoff wavefunct ecutep cutoff w bare v use calcul bs matrix element inclvkb commut optic limit correctli evalu specifi paramet use calcul kernel matrix element matrix element dipol oper alreadi encount variabl first gw tutorialtutorialgw gw tutori mean hope familiar detail discuss role play variabl bs code found theorybsebethersalpet note output file output file tbs_abo report basic paramet calcul eventu warn issu iter method converg pleas take time understand structur could answer follow question mani transit includ basi set mani direct use evalu optic limit valu lorentzian broaden use continu fraction digress main output file final proceed analys output data comput import result store five differ file tbs_o_bsr tbs_o_haydr_sav tbs_o_rpa_nlf_mdf tbs_o_gw_nlf_mdf tbs_o_exc_mdf follow provid brief descript format content output file tbs_o_bsr binari file store upper triangl reson block matrix hermitian henc nonredund part comput save file bsr file use restart run previou comput use variabl getbsreso irdbsreso restart capabl use restart haydock method converg achiev execut haydock comput differ valu zcut getbsreso irdbsreso also handi one want includ coupl top preexist tda calcul sinc code use two differ file store reson coupl block bsc prefix use file store coupl term tbs_o_haydr_sav binari file contain result haydock method coeffici tridiagon matrix three vector employ iter algorithm usual use restart algorithm converg achiev see relat input variabl gethaydock irdhaydock tbs_o_rpa_nlf_mdf tbs_o_gw_nlf_mdf rpa spectrum without local field effect obtain ks energi gw energi respect mnemon nlf stand local field mdf stand macroscop dielectr function tbs_o_exc_mdf format file report macroscop dielectr function exciton effect exc_mdf file contain import result calcul worth spend time discuss format first header report basic paramet calcul sh macroscop dielectr function obtain bs equat rpa l ks energi ks wavefunct local field effect includ resonantonli calcul coulomb term construct full wgg scissor oper energi ev toler npwep npwwfn nband loband nkibz nkbz lorentzian broaden ev list qpoint give direct incid photon sh list qpoint optic limit q reduc coord q reduc coord q reduc coord q reduc coord q reduc coord q reduc coord default code calcul macroscop dielectr function consid six differ direct qspace three basi vector reciproc lattic three cartesian axi possibl specifi custom direct use input variabl gw_nqlwl gw_qlwl come section real imaginari part macroscop dielectr function frequenc differ direct sh omega ev reepsq imepsq reepsq visual data use prefer softwar instanc gnuplot gnuplot p tbs_o_exc_mdf u w l plot imaginari part macroscop dielectr function absorpt spectrum first qpoint obtain graphic similar one report bse_assetstbs_png note result converg postpon discuss converg test next paragraph tutori import featur spectrum presenc two peak locat around ev understand natur peak role play bs kernel use compar exciton spectra rpa result obtain without local field effect use sequenc gnuplot command gnuplot p tbs_o_exc_mdf u w l rep tbs_o_rpa_nlf_mdf u w l rep tbs_o_gw_nlf_mdf u w l plot absorpt spectrum obtain three differ approach final result report figur bse_assetstbs_png rpak spectrum underestim experiment optic threshold due well know band gap problem dft importantli amplitud first peak underestim problem solv localfield effect correctli includ calcul rpagw result qp correct simul mbpt_sciss show signific improv rpak rpagw spectrum shift toward higher frequenc due open gap shape two spectra similar particular amplitud first peak still underestim contrari inclus bs kernel lead import chang optic threshold well amplitud first peak simpl analysi tell us first peak absorpt spectrum silicon strong exciton charact correctli describ within rpa first bs spectrum converg bare resembl experiment result nevertheless unconverg calcul alreadi abl captur import physic tip abipi instal machin use abiopen script expos option visual dielectr function store mdfnc file abiopenpi tbs_o_mdfnc expos seaborn bse_assetsabiopen_tbs_o_mdfpng inform mdf file postprocess tool provid abipi pleas consult mdffilenb option exercis chang valu lorentzian broaden zcut use avoid diverg continu fraction restart haydock algorithm _bsr _haydr_sav file use appropri variabl main effect broaden final spectrum number iter need converg depend broaden use appropri valu bs_exchange_term bs_coulomb_term calcul bs spectrum without local field effect compar result obtain without local field effect modifi input file tbs_abi code read reson block produc previou run calcul spectrum employ method base direct diagon use irdbsreso restart run rememb renam file reson block compar cpu time need two algorithm function number transit transit space one best scale preliminari discuss converg studi converg exciton spectrum requir care analysi mani differ paramet bs_loband nband ecutwfn ecutep ngkpt nshiftk shiftk sinc memori requir scale quadrat number kpoint full brillouin zone time number valenc band time number conduct band includ transit space import find good compromis accuraci comput effici first one select frequenc rang interest sinc choic import effect number valenc conduct state includ transit space optic spectrum expect converg faster number band gw correct sinc transit whose energi close frequenc rang investig expect contribut ecutwfn usual play secondari role sinc affect accuraci oscil matrix element suggest avoid truncat initi basi set set ecutwfn valu slightli larger valu ecut use gener wfk file one truncat initi planewav basi set experienc memori problem although kind problem usual solv increas number processor altern appropri choic gwmem valu ecutep affect accuraci matrix element coulomb term fundament term drive creation exciton consequ ecutep subject accur converg test rule thumb ecutep chosen equal sometim even smaller valu need converg gw correct alreadi state optic spectra converg slowli brillouin zone sampl converg number kpoint thu repres import tediou part converg studi reason studi done converg valu paramet alreadi found converg respect number band transit space section take advantag multidataset capabl abinit perform calcul differ valu bs_loband nband run test take time read input file abi_teststutorialinputtbs_abi dialog teststutorialinputtbs_abi converg number transit perform defin two dataset differ valu nband bs_loband ndtset bs_loband nband bs_loband nband paramet defin build exciton hamiltonian similar one use tbs_abi differ valu use bs_coulomb_term ie bs_coulomb_term coulomb term evalu within diagon approxim allow us save cpu time comput coulomb term also case run test connect tbs_abi wfk scr file produc first step note tbs_abi use irdwfk irdscr read extern file henc creat symbol link dataset sh ln _scr tbs_i_ds_scr ln _scr tbs_i_ds_scr ln _shifted_wfk tbs_i_ds_wfk ln _shifted_wfk tbs_i_ds_wfk final run test abinit tbs_abi tbslog err job last minut patient let us hope calcul complet examin output result use follow sequenc gnuplot command gnuplot p tbs_o_ds_exc_mdf u w l rep tbs_o_ds_exc_mdf u w l plot graphic absorpt spectrum obtain differ transit space obtain graphic similar equal one bse_assetstbspng note inde figur produc dataset order highlight converg behaviour result obtain bs_loband nband clearli unconverg basi set contain transit abl describ frequencydepend polariz energi rang investig converg spectrum includ three higher occupi state first four conduct band blue curv correspond bs_loband nband note ad first occupi band curv give result almost top due fact silicon bottom first band locat around ev top conduct band therefor inclus lead signific improv transit space frequenc rang ev complet also report result obtain separ calcul done bs_loband nband show four empti state enough converg spectrum therefor fix number band transit space use bs_loband nband proceed analys converg spectrum respect number planewav screen tip abipi instal machin use abicomp script mdf command expos option compar multipl dielectr function abicomppi mdf tbs_o_ds_mdfnc expos seaborn bse_assetsabicomp_tbs_opng tip expert user use irdwfk irdscr handi sever dataset read extern file forc use differ name input dataset work around annoy one introduc fictiti dataset say dataset let code use output nonexist dataset input real dataset exampl help clarifi instead use lengthi list link done might use much simpler sequenc command ln _shifted_wfk tbs_o_ds_wfk ln _scr tbs_o_ds_scr provid input file replac irdwfk irdscr getwfk trick read file tbs_o_ds_wfk dataset getscr trick scr file converg respect number planewav screen first run calcul take time understand done abi_teststutorialinputtbs_abi structur input file similar one tbs_abi main differ first section ndtset ecutep ecutep bs_coulomb_term instruct code execut two calcul direct term construct use differ valu ecutep also relax diagonalonli approxim screen set bs_coulomb_term nonloc wrr rr correctli taken account import stress necessari recalcul scr file scratch modifi valu ecutep use bs run scr file calcul preparatori step contain gvector whose energi extend ecutep ha maximum cutoff energi use converg test valu ecutep specifi input file smaller one store disk code read sub block initi matrix warn messag issu valu specifi input file larger one avail scr file final run calcul usual copi abi_teststutorialinputtbs_abi work directori work_b creat bunch symbol link input wfk scr file ln _scr tbs_i_ds_scr ln _scr tbs_i_ds_scr ln _shifted_wfk tbs_i_ds_wfk ln _shifted_wfk tbs_i_ds_wfk issu abinit tbs_abi tbslog err execut test take around minut dialog teststutorialinputtbs_abi calcul complet plot spectra obtain differ ecutep use gnuplot gnuplot p tbs_o_ds_exc_mdf u w l rep tbs_o_ds_exc_mdf u w l show result converg studi done four differ valu ecutep highlight converg behavior bse_assetstbspng spectrum found converg quickli ecutep curv obtain ecutep ha almost indistinguish final estim ecutep therefor ha note valu smaller one requir converg qp correct within ev first gw tutorialtutorialgw gw tutori obtain ha gener behavior sens bethesalpet spectra unlik gw correct sensit truncat planewav expans w reason bs spectra obtain even w treat within diagon approxim altern model dielectr function note also two peak affect differ way chang ecutep first peak affect behavior consist affirm first peak silicon strong exciton charact converg respect number kpoint last paramet check converg number kpoint converg studi repres tediou difficult part sinc requir gener new wfk file new scr file kmesh list kpoint wavefunct set qpoint screen must consist file abi_teststutorialinputtbs_abi gather differ step standard bs calcul gener two wfk file screen calcul bs run singl input calcul done converg paramet found previou studi ngkpt intent left undefin dialog teststutorialinputtbs_abi use tbs_abi templat perform bs calcul differ kmesh exampl might tri compar three mesh xx xx xx facilit analysi result suggest run calcul differ directori keep output result separ awar cpu time well memori requir increas quickli number divis mesh exampl cpu time requir differ kmesh intel xeon x xx overal time end sec cpu wall xx overal time end sec cpu wall xx overal time end sec cpu wall xx overal time end sec cpu wall xx overal time end sec cpu wall xx overal time end sec cpu wall xx like dens sampl afford singlecpu machin conveni collect result converg test figur bse_assetstbspng anticip spectrum converg slowli number kpoint first calcul done xx grid sever unconverg accur result obtain xx kmesh even sampl lead converg result frequenc ev problem common bs comput sens extrem difficult achiev global converg spectra analysi show trust xx result ev rang correct descript spectrum higher energi would requir inclus kpoint possibl band band dispers correctli taken account even rpa spectrum converg high frequenc xx use stress zcut play import role converg test exampl result obtain xx xx kmesh brought closer xx increas lorentzian broaden compar theori experi common treat zcut _a posteriori_ paramet chosen produc best agreement experi addit exercis use bs_coupl perform exciton calcul silicon includ coupl term compar imaginari part macroscop dielectr function obtain without coupl find signific differ caveat calcul coupl use haydock method much cpu demand might decreas input paramet result reason time calcul oneshot gw correct silicon follow first gw tutorialtutorialgw use _gw file produc code calcul absorpt spectrum learn use abipi autom bs calcul describ jupyt notebookhttpsnbviewerjupyterorggithubabinitabitutorialsblobmasterabitutorialsbselesson_bseipynb note mpi implement section discuss approach use parallel two step bs run ie construct h matrix evalu macroscop dielectr function first import stress unlik gw code bs routin employ kind memori distribut wavefunct entir set orbit use construct transit space store node choic dictat fact size h usual much larger array use store wavefunct henc much import distribut matrix wavefunct besid state node simplifi calcul sever intermedi quantiti need runtim memori alloc wavefunct screen thu scale number processor howev memori demand calcul real space orbit calcul fli increas comput time instead option control second digit input variabl gwmem discuss mpi parallel bethesalpet routin consid two step separ first step upper triangl reson coupl block distribut among node cpu comput portion store result temporari array end comput portion upper triangl commun master node write binari file bsr bsc second step node read data store extern file order build exciton hamiltonian matrix distribut use columnblock partit matrixvector multipl requir haydock iter scheme easili perform parallel see schemat represent report similar distribut scheme also employ conjugategradi minim balanc distribut comput work number processor divid total number reson transit paral_mbt_assetsmpi_mvpng author mg compil abinit tutori explain compil abinit includ extern depend without reli precompil librari packag manag root privileg learn use standard configur make linux tool build instal softwar stack includ mpi librari associ mpif mpicc wrapper requir compil mpi applic assum alreadi standard unixlik instal provid basic tool need build softwar sourc fortranc compil make chang requir maco briefli mention need window user instal cygwinhttpscygwincomindexhtml provid posixcompat environ altern use window subsystem linuxhttpsdocsmicrosoftcomenuswindowswslabout note procedur describ tutori test linuxmaco henc feedback suggest window user welcom tip last part tutori discuss advanc topic use modul supercomput center compil link intel compil mkl librari well openmp thread may want jump directli section alreadi familiar softwar compil follow make extens use bash shell henc familiar termin assum quick introduct command line pleas consult ubuntu tutorialhttpsubuntucomtutorialscommandlineforbeginnersoverview first time use configur make approach build softwar strongli recommend read guidehttpswwwcodecoffeecomsoftwareinstallationconfiguremakeinstal proceed next step hand interest compil compon sourc may want consid follow altern compil extern librari provid aptbas linux distribut eg ubuntu info avail hereinstall_ubuntu compil extern librari fedorarhelcento linux distribut info avail hereinstall_cento homebrew bottl macport maco info avail hereinstall_maco automat compil gener modul cluster easybuild info avail hereinstall_easybuild compil abinit use intern fallback buildabinitfallbackssh script automat gener configur mandatori depend found use precompil binari provid condaforg linux maco user start also worth read document prepar marc torrent introduc import concept provid detail descript configur option support abinit build system note slide written abinit v henc exampl chang order compat build system version yet document repres valuabl sourc inform emb srchttpsschoolabinitorgimageslecturesabischool_installing_abinit_lecturepdf typeapplicationpdf width heightpx import aim tutori teach compil code sourc guarante recip work box everi possibl architectur best explain setup environ avoid typic pitfal cover possibl case fortun internet provid lot resourc search engin stackoverflow best friend case one find solut copi error messag search bar complic issu ask help abinit discours forumhttpsdiscourseabinitorg contact sysadmin cluster rememb provid enough inform system problem encount get start sinc abinit written fortran need recent fortran compil support f specif well c compil time write today c compil option requir advanc featur treat tutori follow focus gnu toolchain ie gcc c gfortran fortran sequenti compil adequ dont need compil parallel mpi applic compil mpi code inde requir instal addit librari special wrapper mpicc mpif mpiifort replac sequenti compil import scenario cover detail next section time mainli focu compil sequenti applicationslibrari first let make sure gfortran compil instal machin issu termin follow command sh gfortran usrbingfortran tip command return absolut path execut unix tool extrem use pinpoint possibl problem use lot rest tutori case lucki fortran compil alreadi instal usrbin immedi use build softwar stack gfortran instal may want use packag manag provid linux distribut instal ubuntu instanc use sh sudo aptget instal gfortran get version compil use version option sh gfortran version gnu fortran gcc red hat copyright c free softwar foundat inc start version abinit requir gfortran v consult releas note check whether gfortran version support latest abinit releas let check whether make alreadi instal use sh make usrbinmak hope c compil gcc alreadi instal machin sh gcc usrbingcc point basic build block need compil abinit sourc proceed next step tip life get hard maco user appl offici support fortran need instal gfortran gcc either via homebrewhttpsbrewsh macporthttpswwwmacportsorg altern one instal gfortran use one standalon dmg instal provid gfortranformaco projecthttpsgithubcomfxcoudertgfortranformacosreleas note also maco user need instal make via xcodehttpsdeveloperapplecomxcod info found pageinstall_maco compil bla lapack bla lapack repres workhors mani scientif code optim implement crucial achiev good perform principl step skip decent linux distribut alreadi provid precompil version alreadi mention introduct geek prefer compil everyth sourc moreov compil blaslapack repres excel exercis give us opportun discuss basic concept reveal use part tutori first let creat new directori insid home let call local use command sh cd home mkdir local tip home standard shell variabl store absolut path home directori use sh echo home directori home print valu variabl syntax use chain command togeth next command execut preced command exit without error accur exit return code use trick lot exampl reduc number line type termin one easili cut past exampl termin creat src subdirectori insid homeloc sh cd homeloc mkdir src cd src src directori use store packag sourc file compil code wherea execut librari instal homelocalbin homelocallib respect use homeloc work normal user instal softwar usrloc root privileg requir sudo make instal would need moreov work insid homeloc allow us keep softwar stack well separ librari instal linux distribut easili test new librari andor differ version without affect softwar stack instal distribut download tarbal openbla websitehttpswwwopenblasnet sh wget httpsgithubcomxianyiopenblasarchivevtargz wget avail use curl option specifi name output file sh curl l httpsgithubcomxianyiopenblasarchivevtargz vtargz tip get url associ html link insid browser hover mous pointer link press right mous button select copi link address copi link system clipboard past text termin select copi action menu activ click right button altern one press central button mous wheel use cmd v maco trick quit handi fetch tarbal directli termin uncompress tarbal sh tar xvf vtargz cd directori sh cd openbla execut sh make j use_thread use_lock build singl thread version tip default openbla activ thread see faq pagehttpsgithubcomxianyiopenblaswikifaqmultithread case prefer use sequenti version abinit mainli optim mpi j option tell make use process build code order speed compil adjust valu accord number physic core avail machin end compil get follow output note singl thread md openbla build complet bla cbla lapack lapack os linux architectur x_ binari bit c compil gcc command line cc fortran compil gfortran command line gfortran librari name libopenblas_haswellra singl thread instal librari run make prefixpathtoyourinstal instal side note compil plain make would give md librari name libopenblas_haswellpra multi thread max numthread indic openbla librari support thread may notic particular case make build librari also run unit test valid build mean make complet success confid build ok proceed instal packag use standard approach provid make check option execut make order run test suit instal packag instal openbla homeloc issu sh make prefixhomeloc instal point follow includ file instal homelocalinclud sh ls homelocalinclud cblash fblash lapackeh lapacke_configh lapacke_manglingh lapacke_utilsh openblas_configh follow librari instal homelocallib sh ls homelocalliblibopenbla homegmatteolocalliblibopenblasa homegmatteolocalliblibopenblas_haswellra homegmatteolocalliblibopenblasso homegmatteolocalliblibopenblas_haswellrso homegmatteolocalliblibopenblasso file end share librari stand share object wherea file static librari compil sourc code reli extern librari name librari without lib prefix file extens well directori librari locat must pass linker name librari usual specifi l option directori given l accord simpl rule order compil sourc code use blaslapack routin one use follow option lhomelocallib lopenbla use similar syntax help abinit configur script locat extern linear algebra librari import may notic havent specifi file extens librari name static share librari found linker give prefer link share librari unless static option use dynam default behaviour sever linux distribut assum dynam link follow compil c fortran code requir includ file declar prototyp definit name constant need specifi locat includ file via option case previou option augment sh lhomelocallib lopenbla ihomelocalinclud approach quit common c code h file must includ compil properli less common modern fortran code includ file usual replac mod file ie fortran modul produc compil whose locat usual specifi via j option still option includ file valuabl also compil fortran applic librari fftw mkl reli fortran includ file whose locat pass compil via instead j see also offici gfortran documentationhttpsgccgnuorgonlinedocsgfortrandirectoryoptionshtmldirectoryopt worri rather technic point clear extern librari requir peculiar abinit build system provid sever option autom detect extern depend final linkag import thing awar compil abinit requir correct specif l l librari includ file j fortran modul elabor topic discuss configur option support abinit build system httpsgccgnuorgonlinedocsgcclinkoptionshtml sh nm homelocalliblibopenblasso list symbol present librari sinc instal packag nonstandard directori homeloc need updat two import shell variabl path ld_library_path first time hear path ld_library_path pleas take time learn mean environ variabl inform path avail herehttpwwwlinfoorgpath_env_varhtml see pagehttpstldporghowtoprogramlibraryhowtosharedlibrarieshtml ld_library_path add two line end homebash_profil file sh export pathhomelocalbinpath export ld_library_pathhomelocallibld_library_path execut sh sourc homebash_profil activ chang without start new termin session use sh echo path echo ld_library_path print valu variabl linux box get sh echo path homegmatteolocalbinusrlocalbinusrbinusrlocalsbinusrsbin echo ld_library_path homegmatteolocallib note homegmatteolocalbin prepend previou valu path invok execut locat homelocalbin type base name shell without enter full path warn use sh export pathhomelocalbin good idea shell stop work explain tip maco user replac ld_library_path dyld_library_path rememb also one use env print environ variabl defin session pipe result unix tool tri eg sh env grep ld_ print variabl whose name start ld_ conclud section anoth tip time time compil complain display import messag languag support improperli configur comput happen recommend export two variabl sh export langc export lc_allc reset languag support basic default make sure get messag compil english compil libxc point difficult compil instal libxchttpswwwtddftorgprogramslibxc librari provid mani use xc function pbe metagga hybrid function etc libxc written c built use standard configur make approach extern depend need except basic c librari avail decent linux distribut let start fetch tarbal internet sh get tarbal note option use wget specifi name output file cd homelocalsrc wget httpwwwtddftorgprogramslibxcdownphpfilelibxctargz libxctargz tar zxvf libxctargz configur packag standard prefix option specifi locat librari execut includ file fortran modul man page etc instal execut make instal default usrloc sh cd libxc configur prefixhomeloc final build librari run test instal sh make j make check make instal point follow includ file homelocalinclud sh gmatteobob libxc ls localincludexc homegmatteolocalincludelibxc_funcs_mmod homegmatteolocalincludexc_f_types_mmod homegmatteolocalincludexch homegmatteolocalincludexc_funcsh homegmatteolocalincludexc_f_lib_mmod homegmatteolocalincludexc_funcs_removedh homegmatteolocalincludexc_f_lib_mmod homegmatteolocalincludexc_versionh mod fortran modul gener compil need compil fortran sourc use libxc fortran api warn mod file compil versiondepend word one use mod file compil code differ fortran compil moreov expect abl use modul compil differ version compil especi major version chang one reason version fortran compil employ build softwar stack import final follow static librari instal locallib sh ls localliblibxc homegmatteolocalliblibxca homegmatteolocalliblibxcfa homegmatteolocalliblibxcfa homegmatteolocalliblibxcla homegmatteolocalliblibxcfla homegmatteolocalliblibxcfla libxc c librari libxcf librari f api libxcf librari f api libxcf libxcf depend c librari work done present abinit requir f api use lhomelocallib lxcf lxc librari ihomelocalinclud includ file note libxcf come c librari libxc done purpos libxcf depend libxc fortran api call c implement invert order librari like trigger error undefin refer last step compil linker tri build final applic thing becom even complic build applic use mani differ interdepend librari order librari pass linker crucial import fortun abinit build system awar problem depend bla lapack fft libxc mpi etc automat put right order dont worri point although worth know compil instal fftw fftw c librari comput fast fourier transform one dimens abinit alreadi provid intern implement fft algorithm implement fortran henc fftw consid option depend nevertheless recommend intern implement realli care perform reason fftw even better dfti librari provid intel mkl usual much faster intern version import fftw easi instal linux machin gcc gfortran fftalg variabl defin implement use correspond fftw implement default valu fftalg automat set configur script via prepreprocess option word activ support fftw dfti configur time abinit use fftalg default fftw sourc code download fftworghttpwwwfftworg tarbal latest version avail httpwwwfftworgfftwtargz sh cd homelocalsrc wget httpwwwfftworgfftwtargz tar zxvf fftwtargz cd fftw compil procedur similar one alreadi use libxc packag note howev abinit need singleprecis doubleprecis version mean need configur build instal packag twice build singl precis version use sh configur prefixhomeloc enablesingl make j make check make instal configur step make sure configur find fortran compil abinit need fortran interfac md check gfortran gfortran check whether use gnu fortran compil ye check whether gfortran accept g ye check libtool support share librari ye check whether build share librari check whether build static librari ye let look librari weve instal sh ls homelocalliblibfftw homegmatteolocalliblibfftwfa homegmatteolocalliblibfftwfla f end stand float c jargon singl precis note static librari built build share librari one use enableshar configur configur doubl precis version default behaviour extra option need sh configur prefixhomeloc make j make check make instal step two librari singl doubl precis api sh ls homelocalliblibfftw homegmatteolocalliblibfftwa homegmatteolocalliblibfftwfa homegmatteolocalliblibfftwla homegmatteolocalliblibfftwfla compil abinit fftw support one use lhomelocallib lfftwf lfftw ihomelocalinclud note unlik libxc dont specifi differ librari fortran c fftw bundl c fortran api librari fortran interfac includ default provid fftw configur script find fortran compil case know fftw librari support fortran gfortran found configur may true use precompil librari instal via packag manag make sure fortran api use nm tool get list symbol librari use grep search fortran api instanc check whether librari contain fortran routin multipl singleprecis fft sfftw_plan_many_dft version multipl doubleprecis fft dfftw_plan_many_dft sh gmatteobob fftw nm homelocalliblibfftwfa grep sfftw_plan_many_dft sfftw_plan_many_dft_ sfftw_plan_many_dft__ sfftw_plan_many_dft_cr_ c sfftw_plan_many_dft_cr__ f sfftw_plan_many_dft_rc_ sfftw_plan_many_dft_rc__ gmatteobob fftw nm homelocalliblibfftwa grep dfftw_plan_many_dft dfftw_plan_many_dft_ dfftw_plan_many_dft__ dfftw_plan_many_dft_cr_ c dfftw_plan_many_dft_cr__ f dfftw_plan_many_dft_rc_ dfftw_plan_many_dft_rc__ use fftw librari without fortran support abinit configur script complain librari call fortran need dig configlog understand what go note present need compil fftw mpi support abinit implement version mpifft algorithm base sequenti fftw version mpi algorithm implement abinit optim planewav code support zeropad composit transform applic local part ks potenti also use mkl fftw fft mkl librari export symbol fftw mean linker receiv multipl definit procedur behaviour undefin use either mkl fftw eg openbla instal mpi section discuss compil instal mpi librari step requir want run abinit multipl process andor need compil mpibas librari pblasscalapack hdf librari support parallel io worth stress mpi instal provid two script mpif mpicc act sort wrapper around sequenti fortran c compil respect script must use compil parallel softwar use mpi instead sequenti gfortran gcc mpi librari also provid launcher script instal bin directori mpirun mpiexec must use execut mpi applic exec num_proc mpi process syntax sh mpirun n num_proc exec exec_arg warn keep mind sever mpi implement avail around openmpi mpich intel mpi etc must choos one implement stick build softwar stack word librari execut requir mpi must compil link execut mpi librari dont tri link librari compil eg mpich build code mpif wrapper provid eg openmpi token dont tri run execut compil eg intel mpi mpirun launcher provid openmpi unless look troubl command quit handi pinpoint possibl problem especi multipl instal mpi path good idea tutori employ mpich implement download webpagehttpswwwmpichorgdownload termin issu sh cd homelocalsrc wget httpwwwmpichorgstaticdownloadsmpichtargz tar zxvf mpichtargz cd mpich download uncompress tarbal configurecompiletestinstal librari sh configur prefixhomeloc make j make check make instal instal complet obtain messag possibl last messag might look sh librari instal homegmatteolocallib ever happen want link instal librari given directori libdir must either use libtool specifi full pathnam librari use llibdir flag link least one follow add libdir ld_library_path environ variabl execut add libdir ld_run_path environ variabl link use wlrpath wllibdir linker flag system administr add libdir etcldsoconf see oper system document share librari inform ld ldso manual page reason add homelocallib ld_library_path clear let look mpi execut instal homelocalbin sh ls homelocalbinmpi homegmatteolocalbinmp homegmatteolocalbinmpiexec homegmatteolocalbinmpifort homegmatteolocalbinmpicc homegmatteolocalbinmpiexechydra homegmatteolocalbinmpirun homegmatteolocalbinmpichvers homegmatteolocalbinmpif homegmatteolocalbinmpivar homegmatteolocalbinmpicxx homegmatteolocalbinmpif sinc ad homelocalbin path see mpi actual point version instal sh mpif localbinmpif alreadi mention mpif wrapper around sequenti fortran compil show fortran compil invok mpif use sh mpif v mpifort mpich version use builtin spec collect_gccgfortran collect_lto_wrapperusrlibexecgccx_redhatlinuxltowrapp target x_redhatlinux configur configur enablebootstrap enablelanguagesccobjcobjcfortranadagolto prefixusr mandirusrshareman infodirusrshareinfo withbugurlhttpbugzillaredhatcombugzilla enableshar enablethreadsposix enablecheckingreleas enablemultilib withsystemzlib enable__cxa_atexit disablelibunwindexcept enablegnuuniqueobject enablelinkerbuildid withlinkerhashstylegnu enableplugin enableinitfiniarray disablelibgcj withisl enablelibmpx enablegnuindirectfunct withtunegener witharch_i buildx_redhatlinux thread model posix gcc version red hat gcc c includ file h fortran modul mod instal homelocalinclud sh ls homelocalincludempi homegmatteolocalincludempih homegmatteolocalincludempicxxh homegmatteolocalincludempimod homegmatteolocalincludempifh homegmatteolocalincludempi_basemod homegmatteolocalincludempioh homegmatteolocalincludempi_constantsmod homegmatteolocalincludempiofh homegmatteolocalincludempi_sizeofsmod principl locat directori must pass fortran compil either j mpimod modul mpi option mpifh includ file mpi fortun abinit build system automat detect mpi instal set compil option automat provid instal root homeloc instal hdf netcdf abinit develop tri move away fortran binari file format portabl difficult read highlevel languag python reason abinit v hdf netcdf becom hardrequir mean configur script abort librari found section explain build hdf netcdf sourc includ support parallel io netcdf built top hdf consist two differ layer lowlevel c librari fortran bind ie fortran routin call lowlevel c implement highlevel api use abinit perform io oper netcdf file build librari requir abinit compil three differ layer bottomup fashion start hdf packag hdf netcdfc netcdffortran sinc want activ support parallel io need compil librari use wrapper provid mpi instal instead use gcc gfortran directli let start download hdf tarbal download pagehttpswwwhdfgrouporgdownloadshdfsourcecod uncompress archiv tar usual configur packag sh configur prefixhomeloc cchomelocalbinmpicc enableparallel enableshar weve use cc variabl specifi c compil step crucial order activ support parallel io tip tabl commonlyus predefin variabl avail herehttpswwwgnuorgsoftwaremakemanualhtml_nodeimplicitvariableshtml end configur step get follow output sh c flag share c librari ye static c librari ye fortran c java featur parallel hdf ye parallel filter dataset write ye larg parallel io ye highlevel librari ye threadsafeti default api map v deprec public symbol ye io filter extern deflatezlib mpe direct vfd dmalloc packag w extra debug output none api trace use memori checker memori alloc saniti check function stack trace strict file format check optim instrument line sh parallel hdf ye tell us hdf build support parallel io fortran api activ problem abinit interfac hdf fortran bind provid netcdffortran word abinit requir _netcdffortran_ hdf fortran bind issu make j num follow make check final make instal note make check may take time may want instal immedi run test anoth termin continu tutori let move netcdf download c version fortran bind netcdf websitehttpswwwunidataucaredudownloadsnetcdf unpack tarbal file usual sh wget ftpftpunidataucaredupubnetcdfnetcdfctargz tar xvf netcdfctargz wget ftpftpunidataucaredupubnetcdfnetcdffortrantargz tar xvf netcdffortrantargz compil c librari use sh cd netcdfc configur prefixhomeloc cchomelocalbinmpicc ldflagslhomelocallib cppflagsihomelocalinclud mpicc use c compil cc environ variabl specifi ldflag cppflag want link instal hdf end configur step obtain sh netcdf c configur summari gener netcdf version dispatch version configur wed apr cest host system x_pclinuxgnu build directori homegmatteolocalsrcnetcdfc instal prefix homegmatteoloc compil option c compil homegmatteolocalbinmpicc cflag cppflag ihomegmatteolocalinclud ldflag lhomegmatteolocallib am_cflag am_cppflag am_ldflag share librari ye static librari ye extra librari lhdf_hl lhdf lm ldl lz lcurl featur netcdf api ye hdf support hdf support ye netcdf api ye nc parallel support ye pnetcdf support dap support ye dap support ye byterang support diskless support ye mmap support jna support cdf support ye erang fill support relax boundari check ye section sh hdf support ye netcdf api ye nc parallel support ye tell us configur detect instal hdf support parallelio activ use standard sequenc command compil instal packag sh make j make check make instal instal complet use ncconfig execut inspect featur provid librari weve instal sh ncconfig homegmatteolocalbinncconfig instal directori ncconfig prefix homegmatteoloc get summari option use build c layer avail featur use sh ncconfig netcdf built follow featur cc homegmatteolocalbinmpicc cflag ihomegmatteolocalinclud lib lhomegmatteolocallib lnetcdf static lhdf_hl lhdf lm ldl lz lcurl snip ncconfig quit use print compil option requir build c applic requir netcdfc cflag lib unfortun tool enough abinit need fortran bind well compil fortran bind execut sh cd netcdffortran configur prefixhomeloc fchomelocalbinmpif ldflagslhomelocallib cppflagsihomelocalinclud fc point mpif wrapper cc need info build netcdffortran see offici documentationhttpswwwunidataucaredusoftwarenetcdfdocsbuilding_netcdf_fortranhtml issu sh make j make check make instal inspect featur activ fortran librari use nfconfig instead ncconfig note nf prefix sh nfconfig homegmatteolocalbinnfconfig instal directori nfconfig prefix homegmatteoloc get summari option use build fortran bind list avail featur use sh nfconfig netcdffortran built follow featur cc gcc cflag ihomegmatteolocalinclud ihomegmatteolocalinclud fc homegmatteolocalbinmpif fflag ihomegmatteolocalinclud flib lhomegmatteolocallib lnetcdff lhomegmatteolocallib lnetcdf lnetcdf ldl lm hasf hasf ye hasnc ye hasnc ye prefix homegmatteoloc includedir homegmatteolocalinclud version netcdffortran tip nfconfig quit handi pass option abinit configur script instead type full list librari flib locat includ file fflag deleg bore task nfconfig use backtick syntaxhttpsunixstackexchangecomquestionsunderstandingbacktick sh netcdf_fortran_libsnfconfig flib netcdf_fortran_fcflagsnfconfig fflag altern one simpli pass instal directori use syntax sh withnetcdffortrannfconfig prefix let configur detect netcdf_fortran_lib netcdf_fortran_fcflag us compil abinit section final discuss compil abinit use mpi compil librari instal previous first download abinit tarbal pagehttpswwwabinitorgpackag use eg sh wget httpswwwabinitorgsitesdefaultfilespackagesabinittargz use version may want download latest product version take advantag new featur benefit bug fix got tarbal uncompress type sh tar xvzf abinittargz cd newli creat abinit directori actual start compil type sh configur help take time read document differ option document mention import environ variabl use specifi compil compil flag alreadi encount variabl previou exampl md influenti environ variabl cc c compil command cflag c compil flag ldflag linker flag eg llib dir librari nonstandard directori lib dir lib librari pass linker eg llibrari cppflag object cc preprocessor flag eg iinclud dir header nonstandard directori includ dir cpp c preprocessor cxx c compil command cxxflag c compil flag fc fortran compil command fcflag fortran compil flag besid standard environ variabl cc cflag fc fcflag etc build system also provid special option activ support extern librari libxc instanc md libxc_cppflag c preprocess flag libxc libxc_cflag c flag libxc libxc_fcflag fortran flag libxc libxc_ldflag linker flag libxc libxc_lib librari flag libxc accord seen compil libxc one pass configur follow option sh libxc_libslhomelocallib lxcf lxc libxc_fcflagsihomelocalinclud altern one use highlevel interfac provid withlibnam option specifi instal directori sh withlibxchomelocallib case configur tri automat detect option easiest approach configur detect depend properli may need inspect configlog error messag andor set option manual httpswwwcprogrammingcomtutorialsharedlibrarieslinuxgcchtml exampl take advantag highlevel interfac provid with_xxx option tell build system extern depend locat instead pass option explicitli previou exampl execut configur top level directori packag abinit prefer thing much cleaner way use build directori advantag approach keep object file execut separ sourc code allow us build differ execut use sourc tree exampl one build directori version compil gfortran anoth build directori intel ifort compil build done compil differ compil option let call build directori build_gfortran sh mkdir build_gfortran cd build_gfortran defin option pass configur script instead use command line done previou exampl use extern file myconfac collect option syntax read option file sh configur withconfigfilemyconfac doubl quotat mark may need portabl reason note use configur work insid build directori build_gfortran configur script locat top level directori packag import name option myconfac normal form initi remov option name charact string replac underscor _ follow simpl rule configur option withmpi becom with_mpi ac file also note configur file possibl use shell variabl reus output extern tool use backtick syntaxhttpsunixstackexchangecomquestionsunderstandingbacktick nfconfig flib prefer nfconfig flib trick allow us reduc amount type configur file easili reus machin exampl configur file use highlevel interfac with_libnamedirpath much possibl except linalg fftw explicit valu libname_lib libname_fcflag also report comment section sh mpi support build system expect find subdirectori name bin lib includ insid with_mpi directori with_mpihomeloc flavor linear algebra librari use default netlib with_linalg_flavoropenbla librari flag linear algebra default unset linalg_libslhomelocallib lopenbla optim fft support flavor fft framework support default auto highlevel interfac work yet pass option explicitli with_fftwhomelocallib explicit option fftw with_fft_flavorfftw fftw_libslhomelocallib lfftwf lfftw fftw_fcflagslhomelocalinclud libxc instal prefix libxc default unset with_libxchomeloc explicit option libxc libxc_libslhomelocallib lxcf lxc libxc_fcflagsihomelocalinclud netcdf instal prefix netcdf default unset with_netcdfncconfig prefix with_netcdf_fortrannfconfig prefix explicit option netcdf with_netcdfy netcdf_fortran_libsnfconfig flib netcdf_fortran_fcflagsnfconfig fflag instal prefix hdf default unset with_hdfhomeloc explicit option hdf hdf_libsnfconfig flib hdf_fcflagsnfconfig fflag enabl openmp default enable_openmpno document templat support option found dialog buildconfigtemplateac copi content exampl myconfac run sh configur withconfigfilemyconfac everyth goe smoothli obtain follow summari md final remark core build paramet c compil gnu version fortran compil gnu version architectur intel xeon bit debug basic optim standard openmp enabl collaps ignor mpi enabl ye flavor auto mpi inplac mpiio enabl ye gpu enabl flavor none libxml enabl libpsml enabl xmlf enabl hdf enabl ye mpi support ye netcdf enabl ye mpi support ye netcdff enabl ye mpi support ye fft flavor fftw lib userdefin linalg flavor openbla lib userdefin build workflow monolith deprec option use configur complet may type make build abinit make jn n number avail processor import pleas take time read care final summari make sure get expect lot typo configur error easili spot level might find use look exampl avail pagedevelopersautoconf_exampl addit configur file cluster found abiconfig packagehttpsgithubcomabinitabiconfig configur script gener sever makefil requir make well configh includ file preprocess option use build abinit file includ everi abinit sourc file defin featur activ deactiv compilationtim depend librari avail machin let look select portion configh c defin work mpi instal defin have_mpi defin mpi implement obsolet broken undef have_mpi defin mpi implement defin have_mpi defin want mpi io support defin have_mpi_io defin parallel netcdf librari undef have_netcdf_mpi file tell us build abinit mpi support librari implement mpi specif mpi implement support parallel mpiio note mean netcdf support mpiio exampl inde have_netcdf_mpi undefin mean librari parallelio capabl cours end user mainli concern final summari report configur script understand whether particular featur activ advanc user may find content configh valuabl understand what go final compil packag eg make j compil complet success end bunch execut insid src_main note howev fact compil complet success necessarili impli execut work expect mani differ thing go wrong runtimehttpsenwikiquoteorgwikimurphys_law first let tri execut sh abinit version tip parallel build may need use sh mpirun n abinit version even sequenti run certain mpi librari abl bootstrap mpi librari without mpirun mpiexec cluster slurm syadmin may ask use srun instead mpirun get summari option activ build run abinit b option build prefer verbos version sh src_mainabinit b execut crash may want execut sh make test_fast run basic test someth goe wrong execut binari run test checkout troubleshootingtroubleshoot section possibl solut final may want execut runtestspi python script test directori order valid build run product calcul sh cd test testsruntestspi v j usual use sh testsruntestspi help list avail option detail discuss given pagedeveloperstestsuite_howto asciicasthttpsasciinemaorgapnghttpsasciinemaorga dynam librari ldd sinc decid compil dynam link extern librari includ final execut actual librari load oper system os runtim execut binari os search dynam librari use list directori specifi ld_library_path dyld_library_path maco typic mistak execut abinit wrong ld_library_path either empti differ one use compil code differ work assum know read section linux one use ldd tool print share object share librari requir program share object specifi command line sh ldd src_mainabinit linuxvdsoso xfffbea libopenblasso homegmatteolocalliblibopenblasso xfc libnetcdffso homegmatteolocalliblibnetcdffso xfcede libnetcdfso homegmatteolocalliblibnetcdfso xfcb libhdf_hlso homegmatteolocalliblibhdf_hlso xfcc libhdfso homegmatteolocalliblibhdfso xfc libzso liblibzso xfcf libdlso liblibdlso xfcd libgfortranso liblibgfortranso xfca libmso liblibmso xfc libmpifortso homegmatteolocalliblibmpifortso xfca libmpiso homegmatteolocalliblibmpiso xfcffb libquadmathso liblibquadmathso xfcfda libgcc_sso liblibgcc_sso xfcfb libcso liblibcso xfcfa snip expect execut use openbla netcdf hdf mpi librari instal homelocallib plu basic lib come libeg libgfortran ad compil tip maco replac ldd otool syntax sh otool l abinit see entri like sh systemlibraryframeworksaccelerateframeworkversionsaframeworksveclibframeworkversionsaliblapackdylib compat version current version systemlibraryframeworksaccelerateframeworkversionsaframeworksveclibframeworkversionsalibblasdylib compat version current version mean link maco veclib case make sure use enablezdotbugfixy configur packag otherwis code crash runtim due abi incompat call convent function return complex valu tell maco care fortran wonder differ api abi pleas read stackoverflow posthttpsstackoverflowcomquestionswhatisanapplicationbinaryinterfaceabi understand ld_library_path import let tri reset valu variabl sh unset ld_library_path echo ld_library_path rerun ldd otool understand what happen possibl execut abinit empti ld_library_path would fix problem troubleshoot problem appear differ level configur time compil time runtim ie execut code configurationtim error usual due misconfigur environ miss hard depend critic problem softwar stack make configur abort unfortun error messag report configur alway selfexplanatori pinpoint sourc problem need search clue _configlog_ especi error messag associ featurelibrari trigger error easi look sinc configur sometim perform multipl test detect architectur test suppos fail consequ error messag report configlog necessarili relev even find test make configur abort error messag may obscur difficult deciph case ask help forum rememb provid enough info architectur compil option importantli copi _configlog_ without file inde almost imposs understand what go exampl help let assum compil cluster use modul provid sysadmin specif openmpi_intel_sp modul suppos provid openmpi implement mpi librari compil particular version intel compil rememb said use version compil obvious need load modul run configur order setup environ issu sh modul load openmpi_intel_sp modul seem work error messag print termin mpicc show compil ad path point tri configur abinit sh with_mpi_prefixmpi_hom mpi_hom environ variabl set modul load use eg env grep mpi unfortun configur script abort begin complain c compil work text check gcc cmsharedappsopenmpiintel_spbinmpicc check c compil default output file name configur error homegmatteoabinitbuild configur error c compil creat execut see configlog detail let analyz output configur line md check gcc cmsharedappsopenmpiintel_spbinmpicc indic configur abl find mpicc mpi_homebin intern test execut make sure wrapper compil rather simpl fortran program use mpi test fail configur abort immedi pretti explanatori messag md configur error c compil creat execut see configlog detail want understand configur fail open _configlog_ editor search error messag toward end log file exampl one search string c compil creat execut immedi line find follow section note configlog sh configur check whether c compil work configur cmsharedappsopenmpiintel_spbinmpicc conftestc cmsharedappsopenmpiintel_spliblibmpiso undefin refer ibv_reg_xrc_rcv_qpibverbs_ cmsharedappsopenmpiintel_spliblibmpiso undefin refer ibv_modify_xrc_rcv_qpibverbs_ cmsharedappsopenmpiintel_spliblibmpiso undefin refer ibv_open_xrc_domainibverbs_ cmsharedappsopenmpiintel_spliblibmpiso undefin refer ibv_unreg_xrc_rcv_qpibverbs_ cmsharedappsopenmpiintel_spliblibmpiso undefin refer ibv_query_xrc_rcv_qpibverbs_ cmsharedappsopenmpiintel_spliblibmpiso undefin refer ibv_create_xrc_rcv_qpibverbs_ cmsharedappsopenmpiintel_spliblibmpiso undefin refer ibv_create_xrc_srqibverbs_ cmsharedappsopenmpiintel_spliblibmpiso undefin refer ibv_close_xrc_domainibverbs_ configur configur result configur fail program confdefsh defin package_nam abinit defin package_tarnam abinit defin package_vers defin package_str abinit defin package_bugreport httpsbugslaunchpadnetabinit defin package_url defin packag abinit defin version defin abinit_vers defin abinit_version_major defin abinit_version_minor defin abinit_version_micro defin abinit_version_build defin abinit_version_bas defin have_os_linux end confdefsh int main return line sh configur cmsharedappsopenmpiintel_spbinmpicc conftestc tell us configur tri compil c file name conftestc return valu store shell variabl nonzero thu indic failur sh configur configur result fail program c main line configur fail program rather simpl piec code mpicc compil abl compil look care line invoc mpicc see lot undefin refer function libibverb librari sh configur cmsharedappsopenmpiintel_spbinmpicc conftestc cmsharedappsopenmpiintel_spliblibmpiso undefin refer ibv_reg_xrc_rcv_qpibverbs_ look like mess system configur necessarili problem abinit build system perhap chang environ mayb system upgrad modul simpli broken case send configlog sysadmin hesh fix problem use anoth recent modul obvious one encount case modul properli configur yet configur script abort know deal softwar stack case _configlog_ key pinpoint problem sometim find problem rather simpl solv instanc use fortran modul file produc gfortran tri compil intel compil perhap tri use modul produc differ version compil perhap forgot add includ directori requir extern librari compil find includ file mayb typo configur option takehom messag sever mistak detect inspect log messag report configurelog know search compilationtim error usual due syntax error portabl issu fortran construct support particular version compil first two case pleas report problem forum later case need recent version compil sometim compil abort intern compil error consid bug compil rather error abinit sourc code decreas optim level compil particular routin trigger error use even problemat case may solv problem els tri recent version compil made nontrivi chang code modif datatypesinterfac run make clean recompil runtim error difficult fix may requir use debugg basic understand linux signalshttpsenwikipediaorgwikisignal_ipc focu two common scenario sigil sigsegv code rais sigil signal mean cpu attempt execut instruct didnt understand like executableslibrari compil wrong architectur may happen cluster cpu famili avail frontend differ one avail comput node aggress optim option march xhost etc use remov optim option use much safer level may help altern one configur compil sourc directli comput node use compil option compat frontend comput node ask sysadmin detail warn never ever run calcul cpu belong differ famili unless know mani mpi code assum reproduc binari level differ mpi process set bit input produc set bit output run heterogen cluster select queue cpu famili make sure code compil option compatibil comput node segment fault sigsegv usual due bug code may also trigger nonport code misconfigur softwar stack report kind problem forum pleas add input file develop tri reproduc problem keep mind howev problem may reproduc architectur ideal solut would run code control debugg use backtrac locat line code segment fault occur attach backtrac issu forum note run gdb use debugg sequenti realli simpl first make sure code compil g option gener sourcelevel debug inform use gdb gnu debugg perform follow oper load execut gnu debugg use syntax sh gdb path_to_abinit_execut run code run command pass input file argument sh gdb run tin wait error eg sigsegv print backtrac sh gdb bt ps avoid debug code compil ofast backtrac may reliabl sometim even default reliabl resort print statement bisect braket problemat piec code compil abinit cluster intel toolchain modul intelbas cluster suggest compil abinit intel compil _icc_ _ifort_ mkl order achiev better perform mkl librari inde provid highlyoptim implement bla lapack fft scalapack lead signific speedup simplifi consider compil process concern mpi intel provid implement intel mpi also possibl employ openmpi mpich provid librari compil intel compil follow assum cluster scientif softwar manag modul easybuildhttpseasybuildreadthedocsioenlatestindexhtml framework proceed next step worth summar import modul command note modul command list modul instal cluster use sh modul avail syntax load modul module_nam sh modul load module_nam sh modul list print list modul current load list modul contain string use sh modul spider string requir lmod lua final sh modul show module_nam show command modul file use debug complet introduct environ modul pleas consult pagehttpssupportcecihpcbedoc_contentsusingsoftwareandlibrariesusingpreinstalledsoftwareindexhtml first thing locat modul prove mkl mpi librari sorri repeat step crucial mpi modul defin toolchain mpi librari compil librari must compil toolchain cluster activ intel mpi execut sh modul load releasesb modul load intelb modul load iimpib load b intel mpi easybuild toolchainhttpseasybuildreadthedocsioenlatestcommontoolchainshtml cluster may need load differ modul effect level shell environ specif mpiifort path note mpiifort wrap intel ifort sh mpiifort v mpiifort intelr mpi librari updat linux copyrightc intel corpor right reserv ifort version directori librari requir compilermpi ad ld_library_path cpath store locat search includ file last least env defin intelspecif variableshttpssoftwareintelcomcontentwwwusendevelopdocumentationmpideveloperreferencewindowstopenvironmentvariablereferencecompilationenvironmentvariableshtml whose name start i_ sh env grep i_ i_mpi_rootoptceciswarcheasybuildbsoftwareimpiiccifortgcc sinc i_mpi_root point instal directori intel mpi use environ variabl tell configur locat mpi instal sh with_mpii_mpi_root fcmpiifort use intel wrapper import ccmpiicc see warn cxxmpiicpc with_optim_flavoraggress fcflagsg option use with_optim_flavoraggress let configur select compil option tune perform set option explicitli via fcflag warn intel mpi instal two set mpi wrapper mpiicc mpicpc mpiifort mpicc mpicxx mpif use intel compil gnu compil respect use show option eg mpif show display underli compil expect sh mpif v mpif intelr mpi librari updat linux collect_gccgfortran snip thread model posix gcc version gcc show mpif wrap gnu gfortran unless realli need use gnu compil strongli suggest wrapper base intel compil _mpiicc_ _mpicpc_ _mpiifort_ run configur option see section begin build system test basic capabl fortran compil configur stop level mean there sever problem toolchain text fortran support check mpiifort optceciswarcheasybuildbsoftwareimpiiccifortgccbinmpiifort check whether use gnu fortran compil check whether mpiifort accept g ye check type fortran compil intel section configur test mpi implement note multicor architectur support text multicor architectur support check whether enabl openmp support check whether enabl mpi ye check mpi paramet set yon check whether mpi c compil set ye check whether mpi c compil set ye check whether mpi fortran compil set ye check mpi c preprocess flag check mpi c flag check mpi c flag check mpi fortran flag check mpi linker flag check mpi librari flag check whether mpi c api work ye check whether mpi c environ work ye check whether mpi c api work ye check whether mpi c environ work ye check whether mpi fortran api work ye check whether mpi fortran environ work ye check whether build mpi io code auto check level mpi support fortran compil configur forc mpi standard level support check whether mpi librari support mpi_integ ye check whether mpi librari support mpi_create_type_struct ye check whether mpi librari support mpi_ibcast mpi ye check whether mpi librari support mpi_iallgath mpi ye check whether mpi librari support mpi_ialltoal mpi ye check whether mpi librari support mpi_ialltoallv mpi ye check whether mpi librari support mpi_igatherv mpi ye check whether mpi librari support mpi_iallreduc mpi ye configur configur dump mpi paramet diagnost configur configur configur configur option configur configur enable_mpi_inplac configur enable_mpi_io configur with_mpi ye configur with_mpi_level configur configur intern paramet configur configur mpi enabl requir ye configur mpi c compil set requir ye configur mpi c compil work requir ye configur mpi fortran compil set requir ye configur mpi fortran compil work requir ye configur mpi environ usabl requir ye configur mpi c compil set option ye configur mpi c compil work option ye configur mpiinplac enabl option configur mpiio enabl option ye configur mpi configur type comput yon configur mpi fortran level support detect configur mpi_get_library_vers avail detect unknown configur configur requir paramet must set ye configur configur andor build configur mpi support like fail configur check whether activ gpu support far good compil mpi seem work proceed setup extern librari cluster modul load intelb also defin mklroot env variabl sh env grep mkl mklrootoptceciswarcheasybuildbsoftwareimkliimpibmkl ebversionimkl use conjunct highli recommend mkllinklineadvisorhttpssoftwareintelcomenusarticlesintelmkllinklineadvisor link mkl cluster may need load mkl modul explicitli composerx parallelstudiox let discuss configur abinit mkl start simplest case bla lapack mkl fft mkl dfti scalapack openmp thread option select mkllinklineadvisorhttpssoftwareintelcomenusarticlesintelmkllinklineadvisor enabl configur softwar stack compilation_assetslink_line_advisorpng option selfexplanatori perhap tricki part select interfac layer one select bit integ simpli mean compil link code default integ bit wide default behaviour note thread layer set sequenti openmp thread chose link mkl librari explicitli get full link line compil option use option configur file sh blaslapack mkl with_linalg_flavormkl linalg_cppflagsimklrootinclud linalg_fcflagsimklrootinclud linalg_libslmklrootlibintel lmkl_intel_lp lmkl_core lmkl_sequenti lpthread lm ldl fft mkl with_fft_flavordfti fft_cppflagsimklrootinclud fft_fcflagsimklrootinclud fft_libslmklrootlibintel lmkl_intel_lp lmkl_core lmkl_sequenti lpthread lm ldl warn use mkl fftw fft mkl librari export symbol fftw mean linker receiv multipl definit procedur behaviour undefin use either mkl fftw eg openbla run configur option obtain follow output linear algebra support section note linear algebra support text linear algebra support check request linear algebra flavor mkl check serial linear algebra detect sequenc mkl check mpi linear algebra detect sequenc mkl check mpi acceler linear algebra detect sequenc none check detect linear algebra librari verifi check bla support specifi librari ye check axpbi support bla librari ye check gemmm bla librari ye check mkl_imatcopi specifi librari ye check mkl_omatcopi specifi librari ye check mkl_omatadd specifi librari ye check mkl_setget_thread specifi librari ye check lapack support specifi librari ye check lapack c api support specifi librari check plasma support specifi librari check blac support specifi librari check elpa support specifi librari check linear algebra paramet set env flavor kwd check actual linear algebra flavor mkl check linear algebra c preprocess flag none check linear algebra c flag none check linear algebra c flag none check linear algebra fortran flag ioptceciswarcheasybuildbsoftwareimkliimpibmklinclud check linear algebra linker flag none check linear algebra librari flag loptceciswarcheasybuildbsoftwareimkliimpibmkllibintel lmkl_intel_lp lmkl_core lmkl_sequenti lpthread lm ldl configur warn parallel linear algebra avail excel configur detect work blaslapack instal plu mkl extens mkl_imatcopi etc blac scalapack parallel linear algebra detect expect havent ask librari mkllinklineadvisor gui section configur check presenc fft librari dfti mkl goedeck mean intern fortran version note optim fft support text optim fft support check fft flavor enabl dfti goedeck check fft flavor dfti check fft c preprocess flag check fft c flag check fft fortran flag check fft linker flag check fft librari flag check fft flavor tri dfti check whether enabl dfti ye check dfti paramet set mkl check dfti c preprocess flag none check dfti c flag none check dfti fortran flag ioptceciswarcheasybuildbsoftwareimkliimpibmklinclud check dfti linker flag none check dfti librari flag loptceciswarcheasybuildbsoftwareimkliimpibmkllibintel lmkl_intel_lp lmkl_core lmkl_sequenti lpthread lm ldl check whether dfti librari work ye check actual fft flavor use dfti line text check whether dfti librari work ye tell us dfti found link although necessarili mean final execut work box tip may notic also possibl use mkl gnu gfortran case need use differ set librari includ socal compat layer allow gcc code call mkl routin also mkl scalapack requir either intel mpi mpich note option exercis compil abinit blasscalapack mkl scalapack elpa may lead signific speedup run gs calcul larg nband see also np_slk input variabl compil libxc netcdfhdf intel point one check whether cluster provid modul libxc netcdffortran netcdfc hdf compil toolchain use modul spider netcdf modul keyword netcdf find modul hope find preexist instal netcdf hdf possibl mpiio support librari quit common hpc center load modul ncconfig nfconfig path use prefix option specifi instal directori done previou exampl unfortun libxc hdf provid similar tool find instal directori lib pass configur libxc hdf sh with_netcdfncconfig prefix with_netcdf_fortrannfconfig prefix with_hdfinstallation_dir_for_hdf with_hdfebroothdf libxc with_libxcebrootlibxc tip may encount problem libxc librari rather domainspecif hpc center instal cluster provid libxc difficult reus expertis acquir tutori build version instal miss depend insid homeloc rememb load correct modul mpi associ compil configur configur ccmpiicc fcmpiifort intel compil use instal librari prepend homelocallib ld_library_path use with_libnam option conjunct homelocallib ac file run configur ac file worst case scenario neither netcdfhdf libxc instal may want use intern fallback procedur goe follow start configur minimalist set option mpi mkl linalg fft build system detect hard depend miss gener buildabinitfallbackssh script fallback directori execut script build miss depend use toolchain specifi initi configur file final reconfigur abinit fallback compil abinit support openmp thread tip quick introduct mpi openmp comparison two parallel program paradigm see presentationhttpsprincetonuniversitygithubiopubootcampsessionsparallelprogrammingintro_pp_bootcamp_pdf compil abinit openmp difficult everyth boil use thread version bla lapack fft pass enable_openmpy abinit configur script openmp activ also level abinit fortran code contrari answer question use openmp thread calcul mani thread use parallel speedup expect much difficult sever factor taken account note keep long stori short one use openmp thread start trigger limit bottleneck mpi implement especi level memori requir term parallel scalabl problem usual observ calcul larg natom mpw nband matter fact make sens compil abinit openmp calcul rel small inde abinit mainli design mpiparallel mind instanc calcul done rel larg number kkpoint benefit mpi openmp especi number mpi process divid number kkpoint exactli even wors compil code openmp support plan use thread openmp version addit overhead due creation thread section rememb also increas number thread necessarili lead faster calcul true mpi process there alway optim valu number thread mpi process beyond parallel effici start deterior unfortun valu strongli hardwar softwar depend need benchmark code run product calcul last least openmp thread necessarili posix thread henc librari provid open posixthread link openmp version necessari preambl let discuss compil thread version activ openmp support fortran routin abinit pass sh enable_openmpy configur script via configur file automat activ compil option need enabl openmp abinit sourc code eg fopenmp option gfortran cpp variabl have_openmp _configh_ note option part stori signific fraction walltim spent extern blasfft routin expect big speedup link thread librari build softwar stack blaslapack fft reconfigur correct option openmp version issu make make instal build thread version also note librari may chang fftw exampl ship openmp version _libfftw_omp_ see offici documentationhttpwwwfftworgfftw_docinstallationandsupportedhardware_fsoftwarehtmlinstallationandsupportedhardware_fsoftwar henc list librari fftw_lib chang accordingli life much easier use intel mkl case matter select openmp thread thread layer mkllinklineadvisor interfacehttpssoftwareintelcomenusarticlesintelmkllinklineadvisor pass option abinit build system togeth enable_openmpy import use thread librari rememb set explicitli number thread eg sh export omp_num_thread either bash_profil submiss script default openmp use avail cpu easi overload machin especi one use thread conjunct mpi process run thread applic mpi suggest alloc number physic cpu equal number mpi process time number openmp thread comput intens applic dft code less chanc improv perform hyperthread technolog usual refer number logic cpu also recommend increas stack size limit use eg sh ulimit unlimit sysadmin allow run abinit test suit eg two openmp thread use option runtestspi author sp tutori tdepe temperaturedepend electron structur tutori aim show get follow physic properti period solid zeropointmot renorm zpr eigenenergi temperaturedepend eigenenergi lifetimebroaden eigenenergi take hour theori relat temperaturedepend calcul pleas read follow paper citeponc citeponc citeponcea three way comput temperatur depend abinit use anaddb histor first implement use postprocess python script way provid option effici less disk space less memori demand option requir netcdf abinit python tutori focu approach use interpol perturb potenti new way cover zpr tdepend band structurestutorialephzpr tutori import order run python script need python higher python support numpi higher netcdf netcdf python scipi higher done sudo aptget instal netcdfbin sudo aptget instal pythondev pip instal numpi pip instal scipi pip instal netcdf list configur file cluster avail abiconfig repositoryhttpsgithubcomabinitabiconfig prebuilt abinit execut use abinit b get list librariesopt activ build see netcdf trio flavor section connector fallback linalg flavor netlib fft flavor goedeck hdf ye netcdf ye netcdf fortran ye libxc ye wannier tutorial_readm visualis tool cover tutori power visualis procedur develop abipi context reli matplotlib see readm abipyhttpsgithubcomabinitabipi abipi tutorialshttpsgithubcomabinitabitutori calcul zpr eigenenergi q refer input file tutori locat abinitteststutorespfninput correspond refer output file abinitteststutorespfnref prefix file tdepe usual use shorthand abinit indic root directori abinit packag deploy often consid path rel directori first examin teststutorespfninputtdepes_abi input file dialog teststutorespfninputtdepes_abi note three dataset ndtset first dataset correspond standard selfconsist calcul unshift eight kpoint grid produc eg groundstat eigenvalu file tdepes_o_ds_eignc well densiti file tdepes_o_ds_den latter read getden initi second dataset calcul nonselfconsist run specif gamma point real recomput respect dataset extract subset eight kpoint grid second dataset produc wavefunct file tdepes_o_ds_wfq read third dataset getwfq well tdepes_o_ds_wfk file first dataset getwfk third dataset correspond dfpt phonon calcul rfphon displac atom rfatpol direct rfdir induc creation deriv databas file tdepes_o_ds_ddb electronphonon matrix element produc ieigrf option gener need netcdf file tdepes_o_ds_eigrdnc tdepes_o_ds_gkknc order run abinit suggest creat work directori call work subdirectori abinitteststutorespfninput copymodifi relev file explicitli cd abinitteststutorespfninput mkdir work cd work cp tdepesin final issu abinit tdepes_abi calcul produc sever _eignc _ddb eigrdnc eigidnc file contain respect eigenvalu gs perturb secondord deriv total energi respect two atom displac electronphonon matrix element use comput renorm eigenenergi electronphonon matrix element use comput lifetim electron state copi three postprocess python file abinitscriptspost_processingtemperaturedepend make sure directori contain output file produc code issu cp abinitscriptspost_processingtemperaturedependencetemperature_finalpi cp abinitscriptspost_processingtemperaturedependencerf_finalpi cp abinitscriptspost_processingplot_bspi abinit replac proper path well python file contain requir class abinitscriptspost_processingmrgeigncpi directori calcul simpli run python script follow command python temperature_finalpi enter inform ask script typic follow data contain abinitteststutorespfninputtdepes__temperaturein number cpu static zpr comput allenheinecardona theori temperature_ prefix output file valu smear paramet ahc ev gaussian broaden eliashberg function pdo ev energi rang pdo eliashberg calcul ev min max temperatur temperatur step number qpoint comput gamma tdepes_o_ds_ddb name responsefunt rf ddb file tdepes_o_ds_eignc eigenvalu mathbfkq tdepes_o_ds_eigrdnc secondord electronphonon matrix element tdepes_o_ds_gkknc name gkk file tdepes_o_ds_eignc name unperturb eignc file eigenvalu k altern copi exampl file work directori yet done run python temperature_finalpi tdepes__temperaturein dialog teststutorespfninputtdepes__temperaturein warn rememb instal librari requir script run pip use pip instal netcdf conda instal netcdf use condahttpsdocscondaioenlatestminicondahtml see screen output similar shell start h ____ ____ _ _ _ _ _ ___ _ __ ___ _ __ ___ _ __ __ _ _ _ _ _ __ ___ _ _ ____ __ _ _ _ _ _ __ _ __ __ _ __ _______ __ _ __ _ _ _ __ _ _ ______ _ _ __ ____ _________ ___ _ version script comput staticdynam zeropoint motion temperatur depend eigenenergi due electronphonon interact electron lifetim also comput warn first qpoint must gamma point enter number cpu want multithread defin type calcul want perform type want run nonadiabat ahc calcul want run static ahc calcul want run static ahc calcul without control activ space recommend note need _eigrdnc _gkknc file obtain abinit option ieigrf enter name output file enter valu smear paramet ahc ev enter valu gaussian broaden eliashberg function pdo ev enter energi rang pdo eliashberg calcul ev eg introduc min temperatur max temperatur temperatur step eg enter number qpoint enter name ddb file enter name eigq file enter name eigrd file enter name gkk file enter name unperturb eignc file gamma insid dynamic_zpm_temp def qpoint wtq reduc coord warn eigenvalu neg valu e proceed valu comput activ space comput gener gf eliashberg electronphonon spectral function end h runtim second minut python code gener follow file temperature_txt text file contain zeropoint motion renorm zpr kpoint band also contain evolut band temperatur kgamma end file fanddw contribut also report temperature__epnc netcdf file contain number kpoint band temperatur real part number zpr correct imaginari part lifetim temperature_brdtxt text file contain lifetim electron state kpoint band also contain evolut band temperatur kgamma exampl visual temperatur depend kgamma lumo band band section temperature_txt file examin contribut qgamma tdepes_assetsplotpng see lumo correct goe temperatur calcul converg homo eigenenergi correct go temperatur gener zpr correct well temperatur depend usual close gap semiconductor usual check whether input paramet give converg valu cours import obsolet abinit compil netcdf case first use helpmrgddbmrgddb merg _ddb _eigrd_eigid sinc one qpoint perform step static temperatur depend gf comput thank anaddb file file tdepes_fil input file teststutorespfninputtdepes_abi inform contain file file understood look echo read standard output give name format input file tdepes_abi give name format output file tdepes_out give name input deriv databas tdepes_o_ds_ddb give name output molecular dynam dummyomd give name input elphon matrix element gkk file tdepes_o_ds_eigrd give root name elphon output file tdepes__ana give name file contain ddk filenam elphontransport dummyddk dialog teststutorespfninputtdepes_abi concern anaddb input file note electronphonon analysi trigger anaddbthmflag well anaddbtelphint launch anaddb command anaddb tdepes_abi anaddb might replac proper locat anaddb execut run gener file tdepes_out_ep_gf gf spectral function repres contribut phonon mode energi e chang electron eigenenergi accord equat tdepes_out_ep_pd file contain phonon densiti state tdepes_out_ep_tb file contain eigenenergi correct well temperatur depend one check result python script approach end obsolet converg calcul respect grid phonon wavevector converg studi respect paramet reli obviou modif input file detail previou section howev use one qpoint phonon wavevector need nontrivi generalis procedur qpoint need treat differ dataset current version abinit describ approach abinit compil netcdf support approach anaddb similar describ previou section note howev anaddb support integr homogen qpoint grid code perform qwavevector integr either random qpoint homogen monkhorstpack mesh grid use ref citeponc see eg fig paper random integr method creat script gener random qpoint perform abinit calcul point gather result analyz temperature_finalpi script detect use random integr thank weight qpoint store _eigrdnc file perform integr accordingli random integr converg slowli smooth manner howev sinc method littl bit less userfriendli one base homogen grid focu homogen integr case user must specifi abinit input file homogen qpoint grid use input variabl like ngqpt qptopt shiftq nshiftq ie variabl whose name similar use specifi kpoint grid electron sever difficulti first sinc focu kgamma point expect abl use symmetri decreas comput load gamma invari symmetri oper crystal symmetri oper crystal use decreas number qwavevector use well decreas kpoint grid correspond selfconsist phonon comput differ behaviour kgrid qgrid handl abinit convent case nsym kpoint grid gener full brillouin zone without use symmetri qpoint grid qptopt gener irreduc brillouin zone despit nsym order gener qpoint grid fold irreduc brillouin zone one need use anoth valu qptopt particular qptopt use gener q point full brillouin zone second number abinit dataset expect given input file user determin ontheflight abinit still number dataset determin number q point thu user comput abl launch real qpoint calcul sinc determin ndtset determin number irreduc q point well easiest procedur comput equival kpoint grid quick run exampl clarifi suppos one look number qpoint correspond ngqpt qptopt nshiftq shiftq one make quick abinit run teststutorespfninputtdepes_abi note sever input variabl chang respect teststutorespfninputtdepes_abi ndtset nstep prteband ngkpt nshiftk shiftk nsym exampl new valu ndtset nstep definit prteband allow fast run nline might specifi well even run might interrupt second sinc number k point quickli avail kpoint grid specifi thank ngkpt nshiftk shiftk replac correspond input variabl qpoint grid use symmetri reenabl thank nsym run issu abinit tdepes_abi number point seen output file nkpt list eight kpoint given kpt e e e e e e e e e e e e e e e e e e e e e e e e readi launch determin _eignc _ddb eigrdnc eigidnc file qpoint gamma calcul previou section reli three dataset qpoint permit wellstructur set calcul although redund inde first dataset correspond unperturb groundstat calcul ident q done quickli converg wavefunct alreadi avail second dataset correspond nonselfconsist groundstat calcul kq also quick thank previous avail wavefunct third dataset correspond dfpt calcul kq cpu intens part compar first run tutori replac ndtset ndtset udtset input file teststutorespfninputtdepes_abi adjust accordingli input variabl datasetdepend dialog teststutorespfninputtdepes_abi pleas refer helpabinitdefiningadoubleloopdatasetexplan usag doubleloop dataset confus mean udtset usag correspond metacharact inde also introduc iqpt iqpt translat iqpt iqpt iqpt iqpt iqpt iqpt iqpt allow perform calcul three dataset qpoint issu abinit tdepes_abi significantli longer abinit run still less two minut also produc mani file run finish copi file teststutorespfninputtdepes__temperaturein work directori yet done launch python script temperature_finalpi tdepes__temperaturein dialog teststutorespfninputtdepes__temperaturein examin homo lumo band kgamma xx qpoint grid give differ result previous zeropoint renorm zpr chang bandgap k band band ev ev mean bandgap close mev k close mev k comparison converg direct bandgap zpr diamond mev ref citeponc matter fact diamond requir extrem dens qpoint grid xx converg bright side qpoint calcul independ thu parallel scale ideal run separ job differ qpoint quit easi thank dtset approach calcul eigenenergi correct along highsymmetri line calcul electron eigenvalu correct due electronphonon coupl along highsymmetri line requir use dataset per qpoint moreov choic arbitrari kwavevector break symmetri crystal differ dataset requir comput follow quantit psi_khom groundstat wavefunct homogen kpoint sampl psi_kb groundstat wavefunct comput along bandstructur kpoint sampl psi_khomq groundstat wavefunct shift homogen kqpoint sampl n perturb densiti integr homogen kq grid psi_kbsq groundstat wavefunct obtain read perturb densiti previou dataset read previou quantiti obtain elph matrix element along bandstructur physic quantiti integr homogen grid use teststutorespfninputtdepes_abi input file dialog teststutorespfninputtdepes_abi note use usual input variabl defin path brillouin zone build electron band structur kptbound kptopt ndivsm note also defin qptopt number qpoint thu easi determin product ngqpt valu time nshiftq rough grid chosen even less dens one section issu abinit tdepes_abi significantli longer abinit run minut also produc mani file use teststutorespfninputtdepes__temperaturein python script dialog teststutorespfninputtdepes__temperaturein usual syntax temperature_finalpi tdepes__temperaturein section seem correct k point comput section cours high symmetri point comput section valu good idea check run script file tdepes_bisfil copi plot script plotepb python file abinitscriptspost_processingplot_bspi directori calcul run script plot_bspi follow input data temperature__epnc l gamma x w k l w x k gamma directli plot_bspi tdepes__plot_bsabi give follow bandstructur tdepes_assetsplotpng solid black line tradit electron bandstructur dash line electron eigenenergi electronphonon renorm defin temperatur k final area around dash line lifetim electron eigenst notic spike electronphonon case complet underconverg calcul respect qpoint sampl possibl converg calcul use ecut ha ngkpt grid xx increas ngqpt grid get converg result converg studi zpr invers lifetime ev k qgrid nb qpt   min x ibz zpr  zpr  zpr  xx xx xx xx xx xx see limit factor converg studi converg lumo band gamma band lowest energi lowest line gamma x therefor band rather unstabl also seen fact larg electron broaden mean state decay quickli anoth state use rel dens qgrid xx obtain follow converg bandstructur high temperatur k tdepes_assetsplotpng show renorm high temperatur k order highlight broaden renorm occur want accur valu zpr k look tabl import use extrem fine qpoint grid acoust phonon frequenc qpoint close gamma wrongli determin abinit inde order correct phonon frequenc close gamma one impos acoust sum rule anaddb asranaddb howev featur avail python script instead script reject contribut acoust phonon close gamma phonon frequenc lower e ha otherwis one get unphys larg contribut one tune paramet edit variabl tol e begin script exampl last xx calcul set e import possibl speed converg respect increas qpoint densiti notic renorm behav analyt increas qpoint grid smaller broaden therefor possibl extrapol result differ analyt behavior extist depend materi polar state consid band extrema inform found ref citeponc author jw mt electronpositron annihil calcul positron lifetim momentum distribut silicon tutori aim show perform twocompon densityfunct theori tcdft calcul paw framework obtain follow physic properti positron lifetim perfect materi lifetim positron local vacanc electronpositron momentum distribut descript implement tcdft abinit see citewiktor user familiar four basic tutori abinit first paw tutorialtutorialpaw tutori take hour tutorial_readm comput positron lifetim si lattic begin might consid work differ subdirectori tutori work_positron sh cd abi_teststutorialinput mkdir work_positron cd work_positron cp tpositron_abi tutori begin calcul positron lifetim silicon lattic perfect materi positron deloc assum densiti approach zero affect electron densiti perform calcul two step calcul groundstat electron densiti without positron calcul groundstat positron densiti presenc electron densiti step two densiti use calcul positron lifetim proport invers overlap electron positron densiti step calcul consid _zeropositron densiti limit_ correspond convent scheme conv tpositron_abi file find two dataset dialog teststutorialinputtpositron_abi first dataset standard groundstat calcul second one introduc positron system see case set positron dataset positron gs calcul getden presenc previou electron densiti kptopt use kgamma point ixcpositron use boronski nieminen parametr set positron correspond positron groundstat calcul consid electron perturb presenc positron _zeropositron densiti limit_ electron densiti read file result dataset consid positron complet deloc consid gamma point _brillouin_ zone keyword ixcpositron select electronpositron correl function enhanc factor calcul use function parametr boronski nieminen citeboronski use data provid arponen pajann citearponen run calcul work directori work_positron copi file tpositron_abi issu abinit tpositron_abi log calcul take second look tpositron_abo file find positron lifetim calcul rpa limit lifetim comput zeropositron densiti limit arponen pajann provid boronski nieminen ref boronski rm nieminen phi rev b enhanc factor boronski nieminen rpa limit ref boronski rm nieminen phi rev b positron lifetim ps e lifetim ps agre well valu ps calcul number valenc electron citewiktor experiment valu ps citepanda import use zero positron densiti limit approxim use exampl anoth valu ixcpositron would theoret need box infinit size positron complet delocalis crystal avoid use posocc input paramet numer equival calcul densiti positron box size n x positron box size n x thu calcul lifetim positron primit cell set posocc small valu valu must obvious test comput positron lifetim si monovac perform positron lifetim calcul monovac silicon convent scheme appli perfect lattic previous note positron local insid vacanc _zeropositron densiti limit_ appli anymor howev case convent scheme prove yield result agreement experi purpos tutori gener defect cell contain atom supercel small get converg result calcul rel fast dialog teststutorialinputtpositron_abi issu abinit tpositron_abi log calcul finish look tpositron_abo file look report lifetim lifetim comput zeropositron densiti limit arponen pajann provid boronski nieminen ref boronski rm nieminen phi rev b enhanc factor boronski nieminen rpa limit ref boronski rm nieminen phi rev b positron lifetim ps e observ positron local insid vacanc lifetim increas ps major positron densiti local vacanc region electron densiti small overlap electron positron densiti reduc lifetim increas work_positron directori also find tpositron_o_ds_den_positron file contain positron densiti visual file use eg _cutd_ _xcrysden_ _vmd_ see positron local insid vacanc see positron red isodens maximum densiti local silicon monovac look like positron_assetsposdensitypngwidth perform selfconsist electronpositron calcul si vacanc perform selfconsist calcul positron electron densiti calcul take minut alreadi issu use tpositron_abi input file abinit tpositron_abi log dialog teststutorialinputtpositron_abi calcul significantli longer previou one electron positron step repeat converg criterion reach tpositron_abi one dataset set positron perform automat calcul electron positron densiti converg control postoldf mean repeat electron positron step energi differ lower ha valu alway larger toldf calcul still use ixcpositron mean use gggc scheme see citegilgien citewiktor calcul finish look positron lifetim tpositron_abo lifetim comput zeropositron densiti limit arponen pajann provid boronski nieminen ref boronski rm nieminen phi rev b enhanc factor boronski nieminen rpa limit ref boronski rm nieminen phi rev b positron lifetim ps e includ selfconsist increas positron lifetim local insid vacanc becom stronger positron electron densiti allow relax relax vacanc accord forc due electron positron addit selfconsist lifetim positron insid vacanc strongli affect relax atom due forc come electron positron alreadi start relax tpositron_abi input file vacanc issu abinit tpositron_abi log calcul switch atom relax set ionmov need calcul forc abl move atom set optforc provid tpositron_abi file perform relax step ntime save time step would need converg positron lifetim dialog teststutorialinputtpositron_abi look positron lifetim rpa limit ionic step positron lifetim ps e positron lifetim ps e positron lifetim ps e positron lifetim ps e vacanc relax outward positron lifetim increas step enough relax defect complet lifetim still chang inde set ntime deliv positron lifetim ps e positron lifetim ps e positron lifetim ps e positron lifetim ps e positron lifetim ps e positron lifetim ps e positron lifetim ps e positron lifetim ps e positron lifetim ps e although result ionic step differ less one percent differ final result one percent converg reach ionic step also rememb atom supercel larg enough get converg result tabl iv citewiktor see converg result positron lifetim si monovac within variou method comput electronpositron momentum distribut doppler spectrum si lattic last part tutori calcul electronpositron momentum distribut _doppler spectrum_ silicon lattic convent scheme type calcul much time memori consum _lifetime_ calcul use electron positron _wavefunctions_ _densities_ alreadi issu abinit tpositron_abi log take look input file tpositron_abi dialog teststutorialinputtpositron_abi momentum distribut calcul activ posdoppl also notic instead two dataset first part tutori use automat electronpositron loop set posnstep done need full electron positron wavefunct memori case positron addit momentum distribut calcul requir use full kpoint grid input file set kptopt option manual set kpoint istwfk timerevers symmetri optim nkpt correspond xx grid kpt kpoint coordin reciproc space grid use electron positron calcul positron _wavefunction_ first point taken momentum distribut calcul gamma point alway given first calcul momentum distribut need includ _core_ _valence_ electron _wavefunctions_ core electron read file one per atom type need provid _core wf file_ name span stylecolorgreenpsp_file_namecorewfxmlspan psp_file_nam name paw atom dataset file without xml suffix _core wf files_ obtain atompaw tool see tutori gener paw dataset pawtutorialpaw use prtcorewf keyword find core wavefunct file use calcul abi_pspdirsildapwpawabinitcorewf note use paw dataset _abinit legaci proprietari format_ abinit suffix core wavefunct file name psp_file_namecorewfabinit also obtain atompaw tool use prtcorewf keyword calcul complet find tpositron_o_doppl file contain _momentum distribution_ fft grid use abi_homescriptspost_processingposdopspectraf tool gener project _doppler spectra_ direct calcul low highmomentum contribut momentum distribut call w paramet see citewiktor studi effect paw dataset complet positron lifetim momentum distribut calcul within paw method sensit number valenc electron paw dataset due fact easi describ positron _wavefunction_ tend zero nucleu use electron atom orbit paw basi set case need complet describ electron _wavefunctions_ simplest way make paw dataset complet includ semicor electron also possibl add partial wave correspond semicor electron basi use positron wave function descript keep initi number valenc electron done citewiktor howev second method less straightforward previou calcul done valenc electron p see happen includ p state paw dataset use si_paw_pw_elxml paw dataset includ addit valenc electron tip gener new dataset use atompaw tool add semicor state input file modifi follow replac c v select orbit _electron configuration_ section decreas paw augment radiu semicor state local dont forget add prtcorewf keyword creat core orbit file rerun lifetim calcul new atom dataset dialog teststutorialinputtpositron_abi abinit tpositron_abi log find positron lifetim calcul rpa limit lifetim comput zeropositron densiti limit arponen pajann provid boronski nieminen ref boronski rm nieminen phi rev b enhanc factor boronski nieminen rpa limit ref boronski rm nieminen phi rev b positron lifetim ps e valu significantli lower ps achiev valenc electron first step therefor import alway test paw dataset complet positron calcul paw dataset complet even import _doppler spectra_ calcul recalcul momentum distribut includ _valenc electrons_ use tpositron_abi dialog teststutorialinputtpositron_abi abinit tpositron_abi log process new tpositron_o_doppl file copi file rho_ rho_ rho_ fifth step instanc siel_ siel_ siel_ plot _doppler spectra_ direct calcul valenc electron obtain figur like positron_assetsdopplerpngwidth dataset valenc electron complet enough describ positron wavefunct around nucleu reflect unphys high probabl high momenta spectrum explan influenc paw dataset _doppler spectra_ found citewiktor case need gener dataset momentum distribut calcul follow tutori gener paw dataset pawtutorialpaw author fr first tutori multibinit build harmon lattic model run dynam lesson aim show build harmon model use secondprincipl approach lattic dynam simul base atom potenti fit firstprincipl calcul begin import read refer citewojdel lesson learn comput model ddb gener xml model run dynam within multibinit tutori knowledg densiti function theori dft densiti function perturb theori dfpt alreadi acquir addit dfpt key featur abinit multibinit thu order learn use dfpt produc relat ddb associ code merg differ ddb file pleas look tutori lessonrf phonon respons lessonelasticstrain respons lessonrf mrgddb continu tutori abl comput full dfpt calcul complet ddb file therebi tutori provid input abinit find howev previous cite tutori agat softwar use make analysi result also requir tutori instal debian sudo addaptrepositori ppapitidiablotinabiout sudo aptget updat sudo aptget instal abiout tutorial_readm harmon part lattic model describ citewojdel construct model start defin refer structur rs system studi schema lattice_model_assetsreferencepng fig exampl cubic rs made two differ black red atom speci choic rs fundament sinc model base perturb act choic done make sure system fulli relax perform singl dft calcul system order gener ddb file tutori take exampl materi without instabl perovskit catio pnma phase rs consid perturb set atom displac boldsymbolu lattic strain boldsymboleta schema lattice_model_assetsdeformationpng fig exampl lattic perturb atom displac strain harmon level express potenti energi sum three contribut function set perturb boldsymbolu boldsymboleta displaystyl eharmboldsymboluboldsymboleta eharmboldsymbolu eharmboldsymboluboldsymboleta eharmboldsymboleta calcul requir comput phonon respons includ short rang dipoledipol interact displaystyl eharmboldsymbolu longrightarrow underbracefracparti eparti boldsymbolu_substacktextinteratomictextforc constant underbracefracparti eparti boldsymbolcale_textdielectr tensor underbracefracparti epartialboldsymbolcal partial boldsymbolu_texteffect charg comput strain respons displaystyl eharmboldsymboleta longrightarrow underbracefracparti eparti boldsymboleta_textelast constant comput strainphonon coupl displaystyl eharmboldsymboluboldsymboleta longrightarrow underbracefracparti epartialboldsymboletapartialboldsymbolu_substacktextintern strain note need quantiti relat harmon part comput use topicdfptdfpt method obtain store databas ddb file case insul dipoledipol interact recomput directli multibinit therebi need provid ddb file clampedion dielectr tensor born effect charg note forget includ final ddb file ddb obtain rs singl dft calcul still use helpmrgddb mrgddb inde ddb file also output dft calcul order build model import includ ddb file use tutori take exampl materi without lattic instabl perovskit catio_ pnma phase option exercis longrightarrow comput phonon band structur helpanaddbanaddb download complet ddb file result previou calcul dialog teststutomultibinitinputtmulti_ddb start might consid work differ subdirectori lesson creat work_latticemodel file abinitteststutomultibinitinputtmulti_fil list file name root name copi work_latticemodel directori look file content see tutomulti_abi tutomulti_abo tmulti_ddb mention guid helpmultibinit multibinit tutomulti_abi main input file tutomulti_abo main output tmulti_ddb ddb contain system definit list energi deriv time copi file abinitteststutomultibinitinputtmulti_ddb abinitteststutomultibinitinputtmulti_ddb work_latticemodel directori read care input file dialog teststutomultibinitinputtmulti_abi run would take less second multibinit tmulti_fil tmulti__stdout result output file tmulti_abo similar one dialog teststutomultibinitrefstmulti_abo run perform aim read ddb file gener short rang interatom forc constant extract inform relat harmon part model find insid output file born effect charg clampedion elast tensor intern strain coupl paramet take time open read tmulti_abo file ddb file complet gener xml file requir input variabl multibinitprt_model longrightarrow gener xml file activ take time read possibl option multibinitprt_model multibinitngqpt longrightarrow specifi qpoint mesh includ tmulti_ddb file multibinitdipdip longrightarrow disabl comput dipoledipol interact dont need comput gener xml file multibinit abl regener dipoledipol interact next run remind default option part run use option run see directori tmulti__modelxml take time open read file see contain inform system definit lattic paramet atom posit data harmon part potenti xml file readi use input multibinit copi work directori file abinitteststutomultibinitinputtmulti_fil see insid tutomulti_abi tutomulti_abo tmulti__modelxml ddb file replac xml file forget copi abinitteststutomultibinitinputtutomulti_abi directori run multibinit tmulti_fil tmulti__stdout tutomulti_abi multibinitprt_model still set one multibinit write model xml file useless stage copi one read input set input variabl case multibinit read write xml file two last exampl shown multibinit abl read either ddb file xml input system definit harmon part potenti run first dynam copi file abinitteststutomultibinitinputtutomulti_ work directli look dialog teststutomultibinitinputtmulti_abi simul start ddb correctli account dipoledipol interact visual dynam agat softwar agat tmulti_abo_histnc also tri use effect potenti xml file instead dipoledipol interact correct see visual track multibinit tutori finish author xg second tutori dfpt phonon band structur thermodynam properti tutori learn postprocess raw data abinit dfpt calcul get follow physic properti period solid interatom forc constant phonon band structur thermodynam properti visualis tool cover tutori power visualis procedur develop abipi context reli matplotlib see readm abipyhttpsgithubcomabinitabipi abipi tutorialshttpsgithubcomabinitabitutori tutori take hour tutorial_readm gener deriv databas begin might consid work differ subdirectori tutori creat work_rf abi_teststutorespfninput copi file trf_abi abi_teststutorespfninput work_rf sh cd abi_teststutorespfninput mkdir work_rf cd work_rf cp trf_abi tutori start gener databas might quit timeconsum suggest start immedi comput abinit trf_abi log take minut complet pc ghz order interatom forc constant ifc calcul comput associ phonon band structur thermodynam properti first theoret background let us assum read litteratur rel first tutori dfpttutorialrf might find addit materi relat present section citegonzea especi section ix citele citebaroni havent read part refer strongli advis take time read short idea order comput properti phonon frequenc need full brillouin zone one use elabor fourier interpol dynam matric need comput directli other comput interpol schemat represent differ step requir comput dynam matrix ibz postprocess result anaddb given rf_assetsph_dde_workflowpng let us look input file trf_abi dialog teststutorespfninputtrf_abi calcul done ala crystallin materi first tutori dfpt mani input paramet also quit similar level descript unit cell choic cutoff energi k point grid still input file rather complex one singl run one produc deriv databas ddb need rest tutori start groundstat calcul dataset follow comput respons ddk perturb dataset respons electr field phonon gamma dataset dataset gener dynam matric q wavevector gamma present v one comput one q point per dataset mani dataset need also valu q wavevector determin automat must correspond q wavevector need anaddb util see later form reduc set symmetryinequival wavevector correspond regularli space grid principl might includ gamma point recommend set order fourier interpol introduc error import point tip order minim number preliminari nonselfconsist calcul advis take q point mesh adjust k point mesh use electron structur q wavevector connect two k point wavevector grid set q wavevector gener straightforwardli run gs calcul kptopt nshiftk shiftk includ gamma take output kpt set file qpt set one might set nstep nline one iter run even nstep prtvol real dft calcul done input file abi_teststutorespfninputtrf_abi precis input file use gener set k point copi present work_rf directli well accompani trf_file examin file run calcul rapid wont hurt trf_ job follow k point set obtain kpt e e e e e e e e e e e e e e e e e e e e e e e e promis q point set trf_abi file might worth examin detail one deriv databas creat trf_ run suppos file trf_o_ds_ddb alreadi creat correspond third dataset name respons q electr field open file read helprespfnddb section respfn help file examin trf_o_ds_ddb file care seven similar file gener trf_ run contain header differ dte block duti mrgddb util next section gather inform merg singl ddb file might two possibl either trf_ run finish continu tutori section mrgddb util run finish latter case instead wait trf_ finish suggest pursu section use ddb file one found abi_teststutorespfnref name teststutorespfnrefstrf_ddbabotrf_ddbabo instead one would result section copi file present directori go section section tutori might come back section afterward manipul deriv databas mrgddb util use mrgddb util describ helpmrgddbhelp file pleas read care use mrgddb creat merg ddb eight ddb correspond dataset trf_ job contain dynam matric q point well respons electr field dielectr tensor born effect charg name new ddb trf_ddbabo note includ also ddb dataset wont hurt contain forc stress need comput phonon band structur interatom forc constant thermodynam properti file abi_teststutorespfninputtrf_abi exampl input file mrgddb dialog teststutorespfninputtrf_abi copi work_rf directori run merg follow mrgddb trf_abi note chevron call analysi deriv databas introduct use anaddb util describ helpanaddbhelp file pleas read care anaddb util abl perform mani differ task govern select set input variabl also input variabl common mani differ task list task done one run govern differ flag list flag anaddbdieflag anaddbelaflag anaddbelphflag anaddbifcflag anaddbinstrflag anaddbnlflag anaddbpiezoflag anaddbpolflag anaddbthmflag pleas take time read descript flag note flag might requir allow run anoth task tutori focu flag anaddbifcflag anaddbthmflag comput interatom forc constant copi file trf_abi trf_file abi_teststutorespfninput work_rf directori open file trf_abi note anaddb use old format start calcul mean need file file also note anaddbifcflag activ dialog teststutorespfninputtrf_fil teststutorespfninputtrf_abi relat input variabl split three group first group variabl defin grid q wavevector anaddbbrav anaddbngqpt anaddbnqshft anaddbqshft unfortun name input variabl mean exactli name use gener k point abinit shame remnant histori pleas read care document describ input variabl second group variabl allow impos acoust sum rule dynam matric charg neutral born effect charg proceed analysi anaddbasr anaddbchneut pleas read care explan input variabl final third group variabl relat specif analysi ifc anaddbdipdip anaddbifcana anaddbifcout anaddbnatifc anaddbatifc also spend time read associ document issu anaddb trf_file trf_log last second file trf_abo contain list interatom forc constant well analysi dialog teststutorespfnrefstrf_abo open file find follow paragraph analysi interatom forc constant given column total forc constant column ewald part column shortrang part column relat displac gener atom along x column relat displac gener atom along column relat displac gener atom along z interatom forc constant output nuclei specifi input variabl anaddbatifc atom consid ifc respect nuclei given order increas distanc pair nuclei involv atom first output ifc cartesian coordin well decomposit ewald shortrang part analysi respect local system coordin latter chosen diagon ifc tensor case selfforc constant case first vector vector join two nuclei order decompos ifc longitudin transvers compon comput phonon band structur effici interpol copi file trf_abi trf_file abi_teststutorespfninput work_rf directori open trf_abi dialog teststutorespfninputtrf_fil teststutorespfninputtrf_abi note anaddbifcflag activ inde order comput phonon band structur use fourier interpol ifc requir two first group variabl need gener ifc still defin third group variabl restrict anaddbdipdip come input variabl need defin list q wavevector band structur anaddbeivec flag turn analysi phonon eigenvector anaddbnphl number qpoint phonon interpol anaddbqphl list qpoint phonon interpol anaddbnphl number qdirect loto correct anaddbqphl list qdirect loto correct issu anaddb trf_file trf_log last second file trf_abo contain list eigenvalu need qwavevector iopen look differ section file note interatom forc constant comput need fourier interpol print dialog teststutorespfnrefstrf_abo pleas open also output file name trf__bepsfreq contain frequenc format suitabl graphic output use program bandep latter document describ present tutori copi file trf_abi trf_file work_rf directori note like anaddb bandep use old format use file file issu bandep trf_file trf_log dialog teststutorespfninputtrf_fil teststutorespfninputtrf_abi file trf_aboep produc ep file ep stand encapsul postscript use program ghostview vizual command issu depend way configur machin follow might perhap work gv trf_aboep see nice phonon band structur ala well nice two strang dip highest phonon band gamma point due lack loto split anaddb treatment first list vector correct phonon band structur rf_assetstrf_abopng correct loto split follow littl hack open file trf__bepsfreq note valu frequenc sixth column discontinu exactli gamma point three first column give k point coordin line e e e e e e replac valu sixth column line correct valu includ loto split find file trf_abo end second list vector line read e e e e e e run bandep phonon band structur perfect compar ala phonon band structur publish citegiannozzi cours one make converg studi k q point grid separ well energi cutoff also test lda gga left user look paper citepetretto care analysi phonon dispers converg abinit plot phonon band abipi abipi instal machin use abiopen script expos option visual phonon band structur store phbstnc file produc anaddb instanc sh abiopenpi trf__phbstnc expos seaborntalk produc follow plot without loto split rf_assetsabiopen_trf__phbstpng left phonon band without loto split right plot band connect estim overlap eigenvector adjac qpoint altern start ddb file use abiview script case abipi gener anaddb input file variabl requir handl plot loto split invok anaddb us final plot result two line sh copi tutori output file correct file extens ddb otherwis abiview know handl file cp trf_ddbabo trf__ddb abiviewpi ddb trf__ddb snstalk rf_assetsabiview_ddb_trf__ddbpng also compar result phonon band structur avail materials_project first let find materi project identifi associ particular phase ala cours one could use materi project web interfac also shell pass abinit input file abistruct script shell abistructpi mp_match trf_abi found structur materi project databas use verbos get info abivar input mp full formula al reduc formula ala abc angl spglib space group info magnet symmetri taken account spacegroup fm hall f abinit spg_number none crystal_system cubic lattice_typ cubic point_group idx symbol reduced_coord wyck eqidx al natom ntypat typat znucl xred acel rprim abipi found one entri mp databas match structur given input file gener correspond input file know phase ala correspond mp look phonon band structur comput citepetrettoa httpsmaterialsprojectorgmaterialsmp tip inform abipi api pleas consult ddbfilenb learn autom dfpt calcul python see jupyt notebookhttpsnbviewerjupyterorggithubabinitabitutorialsblobmasterabitutorialsdfptlesson_dfptipynb thermodynam properti give short exampl use anaddb comput thermodynam properti part anaddb like farthest clean stabl usag explor input variabl user abl produc figur data like one sio quartz stishovit publish citele copi file trf_abi abi_teststutorespfninput work_rf look ddb trf_ trf_ use name trf_ddbabo dialog teststutorespfninputtrf_fil teststutorespfninputtrf_abi follow addit input variabl present anaddbthmflag anaddbngqpt anaddbngrid anaddbqshft anaddbnchan anaddbnwchan anaddbthmtol anaddbntemp anaddbtemperinc anaddbtempermin examin input file input variabl run anaddb usual open output file abl find crucial section fjmolc ejmolc sjmolck cjmolck omega_meancm molc abbrevi molecel number avogadro time atom unit cell e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e one find phonon free energi phonon intern energi phonon entropi phonon heat capac atom temperatur factor also comput exampl present testv_ import forget work harmon approxim beyond temperatur anharmon effect sizeabl contribut author jbjbieder parallel molecular dynam perform molecular dynam calcul use parallel tutori aim show perform molecular dynam abinit use parallel comput learn launch molecular dynam calcul main input variabl govern converg numer effici suppos know alreadi basic parallel abinit explain tutori first introduct abinit paralleltutorialbasepar ground state plane wavestutorialparal_gspw tutori take hour done requir least cpu core parallel comput tutorial_readm tip tutori imag plot easili obtain use postprocess tool qagatehttpsgithubcompitidiablotinqag agatehttpsgithubcompitidiablotinag core engin postprocess tool work though summari molecular dynam method basic idea underli ab initio molecular dynam aimd comput forc act nuclei electron structur calcul perform molecular dynam trajectori gener aimd calcul assum system compos nuclei electron born oppenheim approxim valid dynam nuclei treat classic groundstat electron surfac allow equilibrium thermodynam dynam properti system finit temperatur comput exampl melt temperatur phase transit atom vibrat structur factor also xane ir spectrum obtain techniqu aimd deal supercel hundr thousand atom usual larger better addit molecular dynam simul perform day week even month therefor time consum done without help high speed massiv parallel comput follow run abinit nn cpu core appear use specif command line accord oper system architectur comput use instanc mpirun n nn abinit inputabi use specif submiss file tutori one need work directori work_paral_moldyn eg command sh mkdir p abi_teststutoparalinputwork_paral_moldyn cd abi_teststutoparalinputwork_paral_moldyn perform molecular dynam abinit differ algorithm molecular dynam see input variabl ionmov valu dtion control ion time step atom unit time one atom time unit x supsup second valu planck constant default valu tri sever valu dtion order establish stabl effici choic exampl valu decreas high pressur except isothermalisenthalp ionmov ensembl input variabl optcel must default valu also defin maxim number timestep molecular dynam usual set input variabl ntime larg valu sinc end molecular dynam simul alway stop restart calcul conveni use input variabl restartxf input file tmoldyn_abi exampl file contain data molecular dynam simul use isokinet ensembl ionmov fcc aluminum dialog teststutoparalinputtmoldyn_abi open tmoldyn_abi file look care unit cell defin end xx fcc supercel contain atom al ionmov set isokinet ensembl sinc ntime set abinit carri time step molecular dynam calcul perform temperatur k see key variabl mdtemp give initi final temperatur simul kelvin temperatur chang linearli initi temperatur mdtemp itim final temperatur mdtemp end ntime timestep temperatur stay constant whole simul note note use temperatur ion electron occopt set fermidirac smear tsmear set kelvin noth prevent use differ electron ionic temperatur know temperatur number electron band nband set note aimd nsym set remov use symmetri molecular dynam simul alway larg calcul deal supercel hundr thousand atom therefor alway perform parallel tmoldyn_in paral_kgb set activ parallelis kpoint gvector band three follow keyword give number processor level parallelis sinc kpoint simul ngkpt set npkpt set npband bandpp uniqu block npfft kept run calcul parallel cpu core chang distribut processor level parallelis tri find effici one sinc molecular dynam last week crucial find appropri distribut reduc comput time maximum use timopt get inform time repartit simul look output file iter see coordin forc veloc kinet total energi addit abinit gener _histnc file contain whole histori molecular dynam simul atom posit veloc primit translat stress tensor energi time step file use restart calcul want perform time step extract necessari inform make use molecular dynam simul tmoldyn_abi add keyword restartxf set run calcul directori look new output file number time step indic total number step iter intern cycl sinc alreadi perform step molecular dynam total number time step first iter previou calcul check compar tmoldyn_abo tmoldyn_abo one _histnc file contain histori two calcul calcul plot sever quantiti need diag_moldynpi python script find abi_homedoctutorialparal_moldyn_asset directori link hereparal_moldyn_assetsdiag_moldynpi run script python diag_moldynpi warn script diag_moldynpi use python work python read standard output averag valu standard deviat total energi temperatur pressur also gener sever file contain pressur energi stress posit temperatur plot file observ behavior quantiti molecular dynam note time step far suffici equilibr physic quantiti pressur common number reach goal would exceed time alloc tutori tip use agat qagat open visual _histnc file consol averag standard deviat sever quantiti like temperatur pressur stress automat display plot evolut pressur respect time step issu plot p replac plot print data save imag write ascii file converg kpoint supercel size previou section learn perform molecular dynam abinit use fcc supercel atom kpoint section make converg studi respect paramet comput converg kpoint file tmoldyn_abi tmoldyn_abi input file xx xx kpoint grid respect kpoint irreduc brillouin zone dialog teststutoparalinputtmoldyn_abi teststutoparalinputtmoldyn_abi sinc parallelis effici kpoint level alway put nkpt largest possibl valu increas npfft npband follow rule input file use diag_moldynpi script chang name previou file press press save run abinit parallel cpu core tmoldyn_abi cpu core tmoldyn_abi end calcul use diag_moldynpi script save result press press plot pressur term kpoint grid compar averag valu tip altern use agat qagat directli produc follow pictur open tmoldyn_o_histnc plot p holdtru open tmoldyn_o_histnc plot p open tmoldyn_o_histnc plot p output kpoint kpointsparal_moldyn_assetskpointspng said previous simul short complet convinc see need least xx kpoint grid atom cell time increas ntime run abinit comput converg cell size also check cell suffici larg give reliabl physic quantiti previou section use xx fcc supercel tmoldyn_abi input file xx fcc supercel therefor contain atom nband acel scale accordingli take account new size cell run abinit parallel cpu core diag_moldynpi note output file big refer provid comparison save pressur press tmoldyn_abi cell xx kpoint grid note output file big refer provid comparison run adequ number core save pressur press plot press press compar averag valu see size cell one kpoint suffici tip altern use agat qagat directli produc follow pictur open tmoldyn_o_histnc plot p holdtru open tmoldyn_o_histnc plot p atomsparal_moldyn_assetsatomspng go increas cell size xx fcc cell file tmoldyn_in atom cours nband acel scale calcul last min cpu core note output file big refer provid comparison run save pressur press plot press press press remov first step compar pressur averag valu tip altern use agat qagat directli produc follow pictur open tmoldyn_o_histnc plot p holdtru open tmoldyn_o_histnc plot p open tmoldyn_o_histnc plot p cellsparal_moldyn_assetscellpng see even pressur converg term kpoint atom supercel suffici give reliabl pressur xx supercel kpoint seem adequ size see also bigger cell pressur fluctuat consider reduc note made converg studi use pressur criteria result depend physic quantiti look pressur temperatur energi dynam matric observ displac fluctuat alway check cell larg enough give correspond uncertainti also reduc time necessari tutori set valu ecut ha small al closer ha final simplic chang valu ngkpt chang grid kpoint default abinit use shiftk one kpoint gener xx gid gamma get gamma point decreas execut time half set shiftk check valu kpt output file comput melt temperatur al given pressur exampl done molecular dynam go calcul melt temperatur aluminum use socal heat melt hum method method solid phase heat gradual melt occur let start temperatur k work fast use atom supercel kpoint note output file big refer provid comparison run abinit parallel cpu core diag_moldynpi save pressur press plot atom posit see temperatur cell solid tip altern use agat qagat directli produc follow pictur posit obtain directli plot posit yz yz replac xy xz chang plan note atom border display contrario anim xcartparal_moldyn_assetsxcartpng video idvideo_md control autoplay loop stylewidth sourc srcparal_moldyn_assetsmp typevideomp browser support video tag download file hereparal_moldyn_assetsmp video increas temperatur k forget also chang electron temperatur tsmear run abinit save pressur look posit cell still solid set temperatur k look posit ion move across cell come back equilibrium posit cell melt liquid plot pressur three simul xcartparal_moldyn_assetsxcartpng video idvideo_md control autoplay loop stylewidth sourc srcparal_moldyn_assetsmp typevideomp browser support video tag download file hereparal_moldyn_assetsmp video tip run three temperatur run use ndtset specifi dtset valu mdtemp tsmear exampl file given tmoldyn_abi dialog teststutoparalinputtmoldyn_abi tip produc follow plot use agat qagat follow command open tmoldyn_o_ds_histnc plot p holdtru open tmoldyn_o_ds_histnc plot p open tmoldyn_o_ds_histnc plot p meltingparal_moldyn_assetsmeltingpng clearli observ discontinu chang pressur due volum differ solid liquid phase give melt temperatur k gpa one care inde addit crude paramet use ecut natom hum method intrins drawback hum crystal heat homogen melt initi bulk result overh effect author mt gg jb parallel imag string method string method comput minimum energi path parallel tutori aim show use parallel imag perform calcul minimum energi path mep use string method learn run string method parallel architectur main input variabl govern converg numer effici parallel imag algorithm use imag eg pathintegr molecular dynam hyperdynam linear combin imag differ valu imgmov parallel imag use algorithm suppos know alreadi basic parallel abinit explain tutori first introduct abinit paralleltutorialbasepar ground state plane wavestutorialparal_gspw tutori take hour requir least cpu core parallel comput tutorial_readm summari string method string method citeweinan algorithm allow comput minimum energi path mep initi _i_ final _f_ configur inspir nudg elast band neb method chain configur join _i_ _f_ progress driven mep use iter procedur iter consist two step evolut step imag move follow atom forc reparametr step imag equal redistribut along string algorithm present implement abinit socal simplifi string method citeweinan design sampl smooth energi landscap continu might work differ subdirectori tutori work_paral_imag import follow name file mention subdirectori input file found abi_teststutoparalinput directori compar result refer output file locat abi_teststutoparalref follow run abinit _nn_ cpu core appear use specif command line accord oper system architectur comput use instanc mpirun n nn abinit inputabi use specif submiss file tip tutori imag plot easili obtain use postprocess tool qagatehttpsgithubcompitidiablotinqag agatehttpsgithubcompitidiablotinag core engin postprocess tool work though comput initi final configur propos comput energi barrier transfer proton hydronium ion hsubsubosupsup onto nhsubsub molecul beginequ nonumb rm h_o nh_ rightarrow h_o nh_ endequ start hydronium ion ammoniac molecul obtain final state water molecul ammonium ion nhsubsubsupsup process mep barrier depend distanc hydronium ion nhsubsub molecul thu choos fix atom hsubsubosupsup n atom nhsubsub given distanc  bohr calcul perform use lda exchangecorrel function visual initi final state reaction h atom white atom red n atom blue initi stateparal_images_assetsinitialpng final stateparal_images_assetsinitialpng tip obtain imag open timages_abi timages_abi file agat qagat use string method necessari optim initi final point input file timages_abi timages_abi contain respect two geometri close initi final state system first optim properli initi final configur use instanc broyden algorithm implement abinit dialog teststutoparalinputtimages_abi teststutoparalinputtimages_abi open timages_abi file look care unit cell defin begin note keyword natfix iatfix use keep fix posit n atom cell tetragon size larger along x period imag system separ  bohr vacuum three direct keyword cellcharg use remov electron system thu obtain proton molecul neutral recov ad uniform compens charg background although input file run singl core paral_kgb keyword set activ lobpcg citebottin algorithm note use bandpp acceler converg import system larger requir cpu time usual variabl parallel npkpt npband npfft npspinor could use wise run calcul sequenti first initi configur timages_abi final one timages_abi obtain follow posit initi configur xcart e e e e e e e e e e e e e e e e e e e e e e e e final configur xcart e e e e e e e e e e e e e e e e e e e e e e e e relat keyword properli optim initi final state process turn comput mep let us first look relat keyword imgmov select algorithm use replica unit cell string method choos nimag give number replica unit cell includ initi final one note nimag default valu sever print input variabl chang one zero might want explicitli set prtgsr print _gsr file get visual possibl use abipi dynimagenimag array flag specifi imag evolv evolv evolv ntimimag give maximum number iter relax string tolimg converg criterion hartre total energi averag nimag imag fxcartfactor time step bohrsupsuphartre evolut step string method time abinitv steepestdesc algorithm implement npimag give number processor among work load imag level share dynam imag consid imag dynimag input variabl automat set abinit number processor larg enough prtvolimg govern print volum output file full output intermedi minimum output comput mep without parallel imag start string method first test purpos use parallel imag thu perform one step string method dialog teststutoparalinputtimages_abi open timages_abi file look initi final configur specifi end keyword xcart nimagexcart_lastimg default abinit gener intermedi imag linear interpol two configur first calcul sampl mep point fix correspond initi final state evolv nimag thu set npimag variabl use yet parallel imag ntimimag set one time step sinc parallel imag use calcul still run cpu core comput mep use parallel imag perform complet comput mep use parallel imag dialog teststutoparalinputtimages_abi open timages_abi file keyword npimag ad set ntimimag increas calcul thu run cpu core converg string method algorithm control tolimg set ha order obtain lisibl output file decreas print volum set prtvolimg run abinit cpu core calcul complet abinit provid configur sampl minimum energi path initi _i_ final _f_ state plot total energi configur respect reaction coordin join _i_ _f_ give energi barrier separ _i_ _f_ case natur reaction coordin distanc hop proton atom hsubsubo dsubohsub equival distanc proton n atom dsubhnsub graph show total energi function oh distanc along mep indic barrier cross hsubsubo nhsubsub ev th imag give approxim geometri transit state note initi state oh distanc significantli stretch due presenc nhsubsub molecul tip note total energi replica simul cell found end output file section outvar echo valu variabl comput total energi print etotal_img etotal_img etotal_img tip also look atom posit imag cartesian coordin xcart_img xcart_img reduc coordin xred_img xred_img comput oh distanc tip issu command plot xy xdistanc dunita yetot eunitev agat qagat courb paral_images_assetscurvepng total energi function oh distanc path comput imag tolimg close x coordin proton first coordin xcart th atom output file keyword npimag automat set abinit autopar set let us test function edit timages_abi file comment npimag line add autopar run calcul cpu core open output file look npimag valu converg mep like physic quantiti mep converg respect numer paramet two import number point along path nimag converg criterion tolimg nimag increas number imag fix evolv recomput mep dont forget updat dynimag cpu core avail set npimag run abinit cpu core graph superimpos previou mep grey curv calcul imag new one obtain use imag cyan curv see global profil almost modifi well energi barrier curv paral_images_assetscurvepng total energi function oh distanc path comput imag tolimg grey curv one comput imag tolimg red curv tip imag obtain agat qagat follow command open timages__mpio_histnc imag calcul plot xy xdistanc dunita yetot eunitev holdtru open timages__mpi_o_histnc imag calcul plot xy xdistanc dunita yetot eunitev replac plot print get gnuplot script follow anim made put togeth imag obtain end calcul _i_ _f_ _f_ _i_ allow visual mep tip open timages_o_histnc file agat qagat produc anim video idvideo_str control autoplay loop stylewidth sourc srcparal_images_assetsstringvideomp typevideomp sourc srcparal_images_assetsstringvideowebm typevideowebm browser support video tag download file hereparal_images_assetsstringvideomp video tolimg come back nimag first increas tolimg recomput mep much faster previou case decreas tolimg recomput mep gain cpu time start calcul use imag obtain end calcul use tolimg input file start imag specifi keyword xcart nimagexcart_img nimagexcart_img nimagexcart_img copi directli output file obtain previou section graph superimpos path obtain imag tolimg grey curv one imag tolimg cyan curv imageparal_images_assetscurvepng total energi function oh distanc path comput imag tolimg cyan curv one comput imag tolimg grey curv author jwz phg mveithen xg tutori polar finit electr field polar respons finit electr field alp tutori describ obtain follow physic properti insul polar born effect charg finit differ polar born effect charg finit differ forc dielectr constant proper piezoelectr tensor clamp relax ion case linear respons born effect charg dielectr constant piezoelectr tensor treat independ tutori responsefunct tutorialrf elast propertiestutorialelast use densityfunct perturb theori learn obtain quantiti use finit differ techniqu within abinit end describ comput polar berri phase formul perform finit electr field calcul basic theori berri phase comput polar propos r kingsmith vanderbilt citekingsmith longer excel paper vanderbilt r kingsmith citevanderbilt clarifi mani aspect theori good overview subject may found review articl citeresta book citevanderbilt order gain theoret background need perform calcul finit electr field consid read follow paper citesouza citenun httpswwwabinitorgsitesdefaultfilesphdmveithenpdfm veithen phd thesi final extens paw formal specif abinit discuss citegonz citezwanzig tutori take hour minut tutorial_readm groundstat properti alp gener paramet begin might consid work differ subdirectori tutori exampl creat work_ffield abi_teststutorespfninput tutori assum groundstat properti alp previous obtain correspond converg studi done adopt follow set gener paramet acel e ecut ecutsm dilatmx nband number occupi band ngkpt nshiftk shiftk pseudopotenti pseudodojo_nc_sr__pw_standard_pspppsp pseudodojo_nc_sr__pw_standard_pspalpsp principl acel use one correspond optim structur ecut ngkpt combin nshiftk shiftk chosen calcul purpos tutori order limit durat run work low cutoff ha optim lattic constant equal time sqrtmathrmbohr nonetheless valu close obtain highli converg geometri optim bohr alway adapt tutori research critic perform full converg studi go might refresh memori concern variabl ecutsm dilatmx ngkpt nshiftk shiftk note well pseudopotenti use freeli avail httpwwwpseudodojoorgpseudo dojo one chosen p al use perdewwang parameter local densiti approxim lda done facilit comparison result tutori nonlinear propertiestutorialnlo berri phase calcul polar zero field section learn perform berri phase calcul polar practic problem tri comput born effect charg finit differ polar finit atom displac alp copi file tffield_abi work_ffield sh cd abi_teststutorespfninput mkdir work_ffield cd work_ffield cp tffield_abi dialog teststutorespfninputtffield_abi note two pseudopotenti mention input file one phosphoru atom one aluminum atom first list p case defin first type atom second list al defin second type atom might first time encount situat one type atom tutori contrast four basic tutori use one type atom follow input variabl must present ntypat typat start calcul take second typic desktop machin meantim examin tffield_abi file includ three comput see section label atom posit correspond first refer optim structur tau structur al atom displac bohr right left refer tau tau typic amplitud atom displac kind finit differ comput notic also displac given use xcart explicitli cartesian direct atom unit rather primit cell axe would use xred make correspond polar output cartesian direct much simpler understand two implement berri phase within abinit one trigger posit valu berryopt implement na sai one trigger neg valu berryopt implement marek veithen suitabl comput polar howev focu implement marek veithen two reason first result directli provid cartesian coordin end run implement na sai report reduc coordin second implement marek veithen one use finit electr field calcul describ next section final note also veithen implement work kptopt na sai implement restrict kptopt less conveni input file typic selfconsist ground state calcul addit usual variabl berri phase calcul simpli need includ berryopt rfdir berryopt rfdir make run open output file look occurr berri output report valu berri phase individu kpoint string comput polar berri phase reciproc vector reduc coordin cartesian coordin atom unit number string number k point string summari result electron berri phase e ionic phase e total phase e remap e polar e au chargebohr polar e cm remap avoid quantum polar discuss citedjani indeterminaci quantum phase directli relat quantum polar lead spuriou effect see fig abovement paper remap interv indeterminaci remov howev remov quantum polar two calcul might give fals impress one polar branch two calcul actual branch made differ remap crosscheck polar result comput born effect charg multipli displac two geometri excel way estim amplitud polar subtleti berri phase explain citevanderbilt also appli first note neither electron berri phase ionic phase vanish highli symmetr case contrari intuit even though alp invers symmetri tetrahedr symmetri would enough make ordinari vector vanish latticevalu vector vanish lattic transform tetrahedr point group ionic phase correspond actual latticevalu vector concern electron phase exactli vanish unless sampl k point becom continu go file find final result cartesian coordin collect differ valu tau tau polar cartesian coordin au total e e e polar cartesian coordin cm total e e e tau polar cartesian coordin au total e e e polar cartesian coordin cm total e e e tau polar cartesian coordin au total e e e polar cartesian coordin cm total e e e previou data extract born effect charg al valu use au order find charg electron unit correspond volum primit unit cell must specifi atom unit z omega_ fracptau ptau tau frac time time comparison calcul use densityfunct perturb theori dfpt done use file abi_teststutorespfninputtffield_abi dialog teststutorespfninputtffield_abi actual file tffield_abi lead comput born effect charg also comput piezoelectr constant see later review use dfpt tutori responsefunct tutorialrf tutori responsefunct tutorialrf tutori note interest featur tffield_abi use berryopt second data set input variabl caus comput ddk wavefunct use finit differ formula rather dfpt approach trigger rfddk although strictli requir present dfpt calcul finit differ approach necessari variou berri phase comput polar order maintain phase coher wavefunct neighbor k point therefor present tutori use finit differ approach order compar result berri phase comput dfpt accur warn use kpoint overlap berri phase calcul necessari caus result converg much slowli kpoint mesh densiti type calcul critic product work use berri phase method check care converg respect kpoint mesh densiti go ahead run input file look output file identifi place born effect charg written search phrase effect charg valu get dfpt surprisingli good agreement abovement valu level agreement fortuit unconverg calcul method finitediffer dfpt tend valu better converg calcul ddb file gener abi_teststutorespfninputtffield_abi use input anaddb process use input file tffield_abi tffield_fil file dialog teststutorespfninputtffield_fil teststutorespfninputtffield_abi note abinit program take input file argument anaddb postprocess program depend gener multipl input file therefor conveni pipe file whose content name file anaddb ultim use present case pipedin file tffield_fil written ddb file name tffield_o_ds_ddb defin third line tffield_fil event mismatch either edit tffield_fil match ddb chang name ddb file dfpt calcul yield follow piezoelectr constant found tffield_abo proper piezoelectr constant clamp ion unitcm proper piezoelectr constant relax ion unitcm dialog teststutorespfnrefstffield_abo piezoelectr constant chang polar function strain citewu row strain direct use voigt notat direct column polar direct barm crystal class alp nonzero piezoelectr element associ shear strain voigt notat strain e_ e_ e_ citeny relax ion valu ionic relax larg suppress electron piezoelectr difficult converg clamp ion result berri phase approach comput polar also use comput piezoelectr constant finit differ polar respect strain done consid clamp ion relax ion configur purpos look file tffield_abi clamp ion tffield_abi relax ion dialog teststutorespfninputtffield_abi teststutorespfninputtffield_abi input file finit strain appli multipli e_ voigt notat strain tensor dimensionless unit cell vector leftbeginmatrix e_ e_ endmatrixright leftbeginmatrix sqrt sqrt sqrt sqrt sqrt sqrt endmatrixright leftbeginmatrix sqrt sqrt e_sqrt e_sqrt sqrt e_sqrt sqrt e_sqrt endmatrixright dont forget input file vector read row number column notic relax ion case input file includ ionmov optcel order relax ion posit fix cell geometri calcul give follow final result obtain take finit differ express strain differ electr field cm clamp ion case cm relax ion case exampl clamp ion piezoelectr constant obtain tffield_abo dataset polar cartesian coordin cm total e e e dataset polar cartesian coordin cm total e e e differ e obtain strain e obtain train give finit differ divid total chang strain give note finit electr field calcul section learn perform calcul finit electr field copi file abi_teststutorespfninputtffield_abi work_ffield dialog teststutorespfninputtffield_abi start run immedi perform finit field calcul clamp atom posit look input file identifi featur specif finit field calcul gener paramet one specifi nband nbdbuf kptopt nband nbdbuf kptopt first step dataset code must perform berri phase calcul zero electr field purpos necessari set valu berryopt rfdir berryopt rfdir warn use berryopt initi finit field calcul must begin berryopt differ step correspond variou valu electr field set efield step import take care follow paramet shown exampl dataset berryopt efield getwfk electr field appli along direct must increment step step possibl go high field directli step wavefunct previou step must use field get larg import check significantli exceed critic field zener breakthrough drop potenti bornvon karmann supercel must smaller gap practic number kpoint must enlarg reach converg howev time critic field becom smaller practic reason field still reach kpoint grid provid reason degre converg compromis must howev found calcul quit long input file limit small number small field three case select e e e time later perform exhaust calcul larger set field variou quantiti extract finit field calcul clamp ion use finit differ techniqu born effect charg z extract differ forc differ electr field optic dielectr constant deduc polar differ field clamp ion piezoelectr tensor deduc stress tensor differ field illustr focu comput z examin output file field file contain variou quantiti collect present purpos look evolut forc field extract follow result output file e cartesian forc hartreebohr end e cartesian forc hartreebohr end e cartesian forc hartreebohr end finit electr field forc atom direct written f_ai z_aiie omega_ fracdchidtau e valu posit neg field nearli show quadrat term almost neglig clearli appear figur field depend forc larger rang electr field plot ffield_assetstffield__forpng therefor extract good accuraci born effect charg z_mathrm al fracf_mathrm ale f_mathrm aletim fractim time valu similar valu report dfpt calcul electr field fit gener express forc includ e term find dchidtau term given input file tffield_abi use field find dchidtau al go back output file also look evolut polar field e polar cartesian coordin au total e e e e polar cartesian coordin au total e e e e polar cartesian coordin au total e e e finit electr field polar term linear quadrat suscept si unit p_i epsilon_chi_ij e_j epsilon_chi_ijk e_je_k atom unit p_i fracpichi_ij e_j fracpichi_ijk e_je_k piepsilon_ atom unit chang polar posit neg field nearli show quadrat term almost neglig clearli appear figur field depend polar larger rang electr field plot ffield_assetstffield__polpng therefor extract linear optic dielectr suscept chi_ pifracp_ p_etim pifractim time rel permitt also known dielectr constant epsilon_epsilon_ chi_ valu bit valu obtain dfpt tffield_abi typic finit field calcul converg densiti k point grid slowli dfpt calcul calcul electr field fit gener express polar includ e term find non linear optic suscept chipi atom unit tffield_abi find chipi si unit chi mathrmpmv d_ mathrmpmv relationship chi_ijk tensor d_ij tensor quantiti report abinit nonlinear optic dfpt comput involv varieti symmetri explain detail book citeboyd look evolut stress electr field see graphic also abl extract piezoelectr constant tri exercis calcul clamp ion get clamp ion proper piezoelectr constant obtain cm relationship variou respons function condit strain stress field forth discuss depth citewu ffield_assetstffield__stresspng modifi previou input file perform finit field calcul combin ion relax similarli tffield_abi modifi tffield_abi give access relax ion proper piezoelectr constant output run analyz result way obtain cm relax ion piezoelectr constant author drh tutori elast properti elast piezoelectr properti tutori show calcul physic properti relat strain insul metal rigidatom elast tensor rigidatom piezoelectr tensor insul intern strain tensor atom relax correct elast piezoelectr tensor complet tutori rftutorialrf rftutorialrf introduc densityfunct perturb theori dfpt featur abinit start tutori learn use addit dfpt featur abinit use relev part associ code mrgddb anaddb visualis tool cover tutori power visualis procedur develop abipi context reli matplotlib see readm abipyhttpsgithubcomabinitabipi abipi tutorialshttpsgithubcomabinitabitutori tutori take two hour tutorial_readm groundstat geometri hypothet wurtzit alp begin might consid work differ subdirectori tutori creat work_elast abi_teststutorespfninput also copi file telast_abi abi_teststutorespfninput work_elast sh cd abi_teststutorespfninput mkdir work_elast cd work_elast cp telast_abi may wish start calcul less one minut standard ghz machin read follow abinit telast_abi telast_log open input file telast_abi editor examin read discuss dialog teststutorespfninputtelast_abi hypothet wurtzit structur alp retain tetrahedr coordin atom actual zincblend structur alp hexagon lattic chosen tutori atom posit complet determin symmetri atom posit lattic constant optim begin dfpt calcul especi relat strain properti gs structur optim treat tutori introduc new featur look follow new input variabl discuss getxr iatfix natfix strfact two dataset specifi telast_abi first let us examin common input data specifi start guess acel give accur decim specif rprim definit atom type atom follow tutori dfpttutorialrf reduc atom posit xred start approxim replac converg result remain input file acel work fix plane wave cutoff ecut ha introduc ecutsm ha tutori tutorialbas smear cutoff produc smoothli vari stress lattic paramet optim keep valu ecutsm dfpt calcul well sinc chang optim run valu could reintroduc nonzero forc stress kpoint grid must explicitli specifi shiftk sinc default valu result grid shift break hexagon symmetri rf strain calcul check exit error messag grid proper symmetri selfconsist procedur follow tutori rftutorialrf dataset optim atom posit keep lattic paramet fix set ionmov tutori tutorialbas optim step proceed maximum forc compon atom less tolmxf alway advis relax forc begin lattic paramet optim dataset optim lattic paramet optcel tutori tutorialbas howev tutori treat cubic si atom posit reduc coordin remain fix present gener case reduc atom coordin must reoptim lattic paramet optim note necessari includ getxr second dataset initi relax coordin coordin lattic paramet optim actual take place simultan comput stress step act forc lattic paramet introduc strfact scale stress may compar tolmxf converg test appli forc default valu probabl good choic mani system awar happen hexagon symmetri know posit atom ab basal plane fix howev uniform translat along c axi atom leav structur invari rel displac al plane along c axi physic relev fix al posit reduc caxi coordin relat symmetri introduc natfix iatfix constrain structur optim realli cosmet purpos sinc let slide arbitrari amount otherwis would wont chang result howev probabl wouldnt want publish result way may well develop good habit shall examin result structur optim run alway first examin log file make sure run termin cleanli number warn none appar seriou next let us edit output file telast_abo dialog teststutorespfnrefstelast_abo first thing look see whether abinit recogn symmetri system set new data file easi make mistak valuabl check see dataset space group p_ c bravai hp primit hexag correct next confirm structur optim converg follow line tell us thing ok dataset broydmd step gradient converg max grad forcestress e tolmxf e habohr free atom dataset broydmd step gradient converg max grad forcestress e tolmxf e habohr free atom also confirm stress relax cartesian compon stress tensor hartreebohr sigma e sigma e sigma e sigma e sigma e sigma e would good time copi telast_abi work directori sinc use present output start next run locat optim lattic paramet reduc atom coordin near end telast_abo acel e e e bohr xred e e e e e e e e e e e e editor copi past telast_abi indic place common input data area sure chang acel xred acel xred sinc common valu appli dataset next set calcul responsefunct calcul sever second deriv total energi comput second deriv total energi dte respect perturb need comput elast piezoelectr properti may want review first paragraph helprespfn studi tutori rftutorialrf introduc one new input variabl strain perturb rfstr treatment strain perturb subtl aspect would good idea read metric tensor formul strain densityfunct perturb theori r hamann xifan wu karin rabe david vanderbilt citehamann especi sec ii sec iv rf calcul learn tutori rftutorialrf togeth strain review variabl rfphon rfatpol rfdir rfelfd yet done see end previou section copi telast_abi work_elast start calcul read less minut standard ghz machin assum know command use launch abinit look telast_abi editor follow discuss dialog teststutorespfninputtelast_abi set selfcontain calcul three dataset first simpli gs run obtain gs wave function need dfpt calcul remov converg test common input data remind differ test need differ dataset set tight limit converg selfconsist potenti tolvr sinc specifi nband band occupi potenti test also assur us wave function well converg issu come section metal could use output wave function telast_o_ds_wfk input rf calcul skip dataset redo gs calcul take rel littl time simpl system dataset involv calcul deriv wave function respect brillouinzon wave vector socal ddk wave function recal auxiliari quantiti need comput respons lessonrfelectr field perturb introduc tutori rftutorialrf would good idea review relev part helprespfnsect respfn_help file examin section telast_abi note electr field well strain uniform perturb defin qpt rfelfd specifi want ddk calcul perform requir iscf ddk wave function use calcul piezoelectr tensor born effect charg gener need k deriv three reduc direct rfdir sinc potenti selfconsist ddk calcul must specifi converg term wave function residu use tolwfr final dataset perform actual calcul need dte elast piezoelectr tensor set rfphon turn atom displac perturb need atom rfatpol direct rfdir abinit calcul firstord wave function atom direct turn use calcul dte respect pair atom displac respect one atom displac one compon electr field quantiti interatom forc constant gamma born effect charg use later comput atom relax contribut elast piezoelectr tensor firstord wave function strain perturb comput next set rfstr specifi want uniaxi shear strain treat rfdir cycl strain xx yy zz uniaxi yz xz xy shear note perturb abinit treat reduc coordin strain better dealt cartesian coordin reason discuss refer cite wave function use comput three type dte deriv respect two strain compon give us socal rigidion elast tensor deriv respect one strain one electr field compon give us rigidion piezoelectr tensor final deriv respect one strain one atom displac yield internalstrain forcerespons tensor intermedi quantiti necessari comput atom relax correct rigidion quantiti tutori dfpttutorialrf specifi converg term residu potenti firstord potenti use tolvr run complet abinit creat quit file among telast_abo main output file telast_o_ds_ddb first deriv energi gs calcul telast_o_ds_ddb second deriv rf calcul telast_o_ds_wfk gs wave function telast_o_ds_wf ddk wave function telast_o_ds_wf rf firstord wave function variou perturb deriv databas ddb file ascii readabl primarili subsequ analysi anaddb undertak next section final variou wave function binari file primarili use subsequ calcul could cut number need iter exampl converg test file name gener accord follow convent root name default taken name abi file follow number dataset produc file final firstord wave function wf file final pertcas number describ helprespfnsect helprespfnrespfn_help file telast_abi specifi atom displac symmetryinequival perturb treat pertcas list incomplet case specifi input data treat strain perturb first take look end log file make sure run complet without error might wish take look warn appear harmless next edit telast_abo file search backward etot find iter detotalha deltaeha residm vre etot e e e etot e e e etot e e e etot e e e etot e e e etot e e e etot e e e etot e e e etot e e e scf step vre e tolvr e converg abinit solv set schroedingerlik equat firstord wave function function minim variat express dte technic call selfconsist sternheim equat energi converg look similar gs calcul fact vre residu selfconsist firstord potenti reach tolvr well within nstep iter indic dte calcul perturb xy strain converg would pay examin case differ perturb unless look warn log anoth converg item examin abo file seventeen compon ndorder total energi hartre thorder hamiltonian combin storder wavefunct kin e eigvalu e local e storder hamiltonian combin st thorder wf loc psp e hartre e xc e kin e eventu occup nonloc contribut edocc e enl e enl e give relax energi shift occ erelax e nonrelax contribut frozenwavefunct ewald frhart e frkin e frloc e nonrelax contribut frozenwavefunct ewald frnonl e frxc e ewald e nonrelax contribut pseudopotenti core energi pspcore e result detot e ha also detot e ev derelax e ha denonrelax e ha nonvar detot e ha detail breakdown contribut dte probabl limit interest compar detot nonvar detot last three line firstord wave function present perturb minim variat express second deriv respect perturb saw variou dte given elast tensor etc output ddb file comput use nonvari express use nonvari express mix second deriv respect present perturb perturb interest comput directli present firstord wave function disadvantag nonvari result error linearli proport converg error gs firstord wave function sinc error variat detot secondord wavefunct converg error compar nonvari result diagon second deriv give idea accuraci latter perhap indic need tighter converg toler gs rf wave function discuss x gonz c lee phi rev b citegonzea sec ii atomicdisplac perturb correspond breakdown dte head thirteen compon let us take look result want variou dte begin comput deriv databas ndorder matrix noncartesian coordin mass includ asr includ cartesian coordin strain term ucvol factor elast tensor compon includ j j matrix element dir pert dir pert real part imaginari part raw dte reduc coordin atomdisplac electricfield perturb cartesian coordin strain perturb result organ appear file telast__ds_ddb use later input autom analysi convert use notat unit anaddb breakout variou type dte follow convert cartesian coordin atom unit dynam matrix cartesian coordin specifi input asr impos j j matrix element dir pert dir pert real part imaginari part contain interatom forc constant data use later includ atom relax effect asr refer acoust sum rule basic way make sure forc sum zero atom displac effect charg cartesian coordin phonon respons specifi input asr impos j j matrix element dir pert dir pert real part imaginari part born effect charg use find atom relax contribut piezoelectr tensor rigidatom elast tensor cartesian coordin j j matrix element dir pert dir pert real part imaginari part rigidatom elast tensor dte respect pair strain recal pert natom natom unaxi shear strain respect intern strain coupl paramet cartesian coordin zero averag net forc deriv impos j j matrix element dir pert dir pert real part imaginari part dte respect one strain one atom displac need atom relax correct elast tensor piezoelectr tensor set paramet limit direct interest examin case think high symmetri may elimin need correct probabl wrong nonzero term indic correct rigidatom proper piezoelectr tensor cartesian coordin strain respons j j matrix element dir pert dir pert real part imaginari part final piezoelectr tensor dte respect one strain one uniform electr field compon ye nonzero element anaddb calcul atomrelax effect section run program anaddb analyz ddb file gener prior rf calcul copi telast_abi work_elast directori go helpanaddbanaddb help file introduct bulk materi help file contain descript variabl read descript anaddbelaflag anaddbpiezoflag anaddbinstrflag anaddbchneut theori underli incorpor atomrelax correct recommend see x wu vanderbilt r hamann citewu anaddb lot thing calcul frequencydepend dielectr tensor interpol phonon spectrum make nice phonon dispers plot calcul raman spectra etc focus minimum need elast piezoelectr constant zero electr field also mention helpmrgddbmrgddb anoth util program use combin ddb file gener sever differ dataset differ run singl ddb file analyz anaddb one particular usag would combin ddb file produc gs run contain firstderiv inform stress forc rf ddb anticip anaddb futur releas implement finitestress correct elast tensor discuss note r oganovtheorydocumentselasticityoganovpdf would good time edit telast_abi observ simpl consist noth four variabl list set appropri valu dialog teststutorespfninputtelast_abi telast_fil file also need anaddb copi teststutorespfninput directori dialog teststutorespfninputtelast_fil first two line specifi abi abo file third line specifi ddb file last line dummi name would use connect capabl anaddb run calcul anaddb telast_fil telast_log calcul take second edit log file go end make sure calcul termin without error next examin telast_abo header inform come tabl give forcerespons displacementrespons intern strain tensor repres respect forc atom displac atom respons unit strain specifi type number limit interest us repres import intermedi quantiti treatment atom relax see x wu citewu paper cite next come elast tensor output elast tensor clamp ion unitgp elast tensor relax ion unitgp fix electr field boundari condit label row column repres xx yy zz yz xz xy strain stress convent voigt notat clampedion result calcul telast_ rf run simpli convert standard gpa unit anaddb term clamp ion clamp atom rigid atom use variou place interchang similarli relax relaxedion result calcul anaddb combin dte intern strain interatom forc constant store input ddb file compar clamp relax result see diagon elast constant decreas valu plausibl sinc allow intern degre freedom relax make materi less stiff tensor symmetr certain tensor element zero ident symmetri good idea check properti standard text j f nye physic properti crystal oxford u p oxford citeny departur expect symmetri last decim place due either converg error larg incorrectli specifi geometri howev see final comment symmetri later obtain compon elast tensor clamp ion finit differ valu gpa note unitgp indic next telast_abo find piezoelectr tensor result proper piezoelectr constant clamp ion unitcm ddb_piezo warn acoust sum rule violat met eigenvalu accoust mode larg gamma point increas cutoff energi kpoint sampl three eigenvalu e e e proper piezoelectr constant relax ion unitcm column repres x z electr polar row voigt strain clampedion result calcul telast_ rf run simpli scale convent unit anaddb ion relax contribut base dte intern strain interatom forc constant born effect charg typic constitut much larger correct piezoelectr tensor elast tensor symmetri check slight discrep seen remov set tolvr telast_abi one awar piezoelectr tensor ident zero materi center symmetri also warn messag purpos tutori ecut select larg enough chang ecut ha ha elimin problem sinc deal hypothet materi experiment data compar result next section calcul number finitediffer method gain confid rf approach finitediffer calcul elast piezoelectr constant copi telast_abi work_elast directori dialog teststutorespfninputtelast_abi edit telast_abi see four dataset first two caxi contract second two expand specifi chang third row rprim common data essenti telast_abi relax acel valu xred telast_abo alreadi includ dataset selfconsist converg gs wave function strain lattic comput stress dataset introduc new variabl berryopt electr polar solid subtl topic rigor resolv thirti year ago understood bulk properti quantit describ berri phase formul introduc r kingsmith vanderbilt phi ref b citekingsmith calcul gs calcul integr gradient respect k gs wave function brillouin zone gs calcul gradient approxim finitediffer express construct neighbor point k mesh close relat ddk wave function use rf calcul section introduc lessonrftutori dfpt section use berryopt util improv code calcul must specifi rfdir cartesian compon polar comput run telast_abi calcul take minut two edit telast_abo calcul elast constant need find stress sigma sigma see four dataset stress result slight differ exampl dataset dataset ident despit tight limit still converg issu look follow converg result dataset scf step vre e tolvr e converg dataset scf step vre e tolvr e converg sinc dataset better converg use coher use also dataset result choos gpa unit cartesian compon stress tensor gpa pressur e gpa sigma e sigma e sigma e sigma e sigma e sigma e cartesian compon stress tensor gpa pressur e gpa sigma e sigma e sigma e sigma e sigma e sigma e let us comput numer deriv sigma compar rf result recal dimensionless strain find gpa compar well valu gpa element rigidion elast tensor found anaddb calcul section recal strain stress zz voigt similarli numer deriv sigma gpa compar gpa elastictensor element comput good agreement found simpl numer differenti requir accur relax lattic stress unstrain structur small similar numericalderiv comparison system finit stress complic discuss note r oganovtheorydocumentselasticityoganovpdf numericalderiv comparison relaxedion result extrem challeng sinc requir relax atom forc exceedingli small limit let us examin electr polar found dataset focus cm result polar e cm polar e cm polar e cm polar e cm polar e cm polar e cm label cartesian x z compon respect x compon zero within numer accuraci must symmetri numer differenti z compon yield cm compar z element rigidion piezoelectr tensor section cm two result compar well might wish wrong two possibl first rf calcul produc proper piezoelectr tensor numer differenti polar produc improp piezoelectr tensor subtl point refer vanderbilt j phi chem solid citevanderbilt impropertoprop transform effect certain tensor element howev particular combin crystal symmetri choic strain correct second possibl subject next section altern dfpt calcul piezoelectr constant gs calcul polar section use effect finit differ approxim ddk wave function rf calcul section use analyt result base rf approach sinc k grid determin ngkpt nshiftk rather coars probabl sourc discrep sinc issu note previous connect calcul born effect charg na sai k rabe vanderbilt phi rev b citesai abinit incorpor abil use finitediffer ddk wave function gs calcul rf calcul electricfieldrel dte copi telast_abi work_elast edit telast_abi dialog teststutorespfninputtelast_abi compar previou rf data telast_abi note dataset common data enter relax structur result essenti ident dataset replac nonselfconsist gs calcul berryopt specifi perform finitediffer ddk wave function calcul finitediffer firstord wave function implicit actual calcul gs polar calcul restrict rfdir sinc interest piezoelectr constant compar dataset telast_abi figur drop run telast_abi calcul take minut simplif edit telast_abo look piezoelectr tensor rigidatom proper piezoelectr tensor cartesian coordin strain respons j j matrix element dir pert dir pert real part imaginari part dialog teststutorespfnrefstelast_abo immedi see problem output like file atom unit comput numer deriv convent cm unit might think simpli run anaddb convers present version happi incomplet ddb file telast_ gener produc desir result left exercis student dig convers factor literatur better yet sourc code cheat tell au cm thu new rf result rigid ion piezoelectr constant cm compar result found section completelyg finit differ calcul cm agreement excel fulli rf calcul section fact converg much rapidli k sampl partialfinitediffer method introduc worthwhil learn believ alway pay altern way test result besid didnt take much time found convers factor yet final word alp calcul studi use converg paramet sake speed alway duti user check precis numer calcul respect paramet calcul responsefunct calcul elast constant al metal metal exist partial occupi band complic featur rf well gs calcul would good time review tutori tutorialbas dealt detail interplay ksampl converg fermisurfac broaden especi lessonbasesect tutori copi telast_abi work_elast begin run read sinc involv converg studi multipl dataset may take two minut dialog teststutorespfninputtelast_abi run progress edit telast_abi tbase_abi set udtset specifi doubl loop present case howev outer loop success larger mesh k point inner loop success gs selfconsist run optim acel gs densitygener run next step nonselfconsist gs run converg unoccupi slightlyoccupi band rf run symmetryinequival elast constant section separ gs structur optim run transfer result hand rf run section converg test combin step use getcel transfer optim coordin first dataset inner loop forward rest complic structur intern coordin also optim would need use getxr transfer telast_abi specif data innerloop dataset similar telast_abi innerloop dataset bit hack need densiti innerloop dataset could set prtden dataset would produc separ densiti file everi step structur optim isnt clear automat pick last one dataset pick wave function dataset one file produc optim structur one iter fix geometri write densiti file innerloop dataset nonselfconsist run whose purpos ensur wave function specifi nband well converg metal specifi enough band make sure fermi surfac properli calcul band fermi level small occup nearzero occup energi exceed fermi energi time tsmear littl effect selfconsist potenti tolvr test dataset doesnt ensur converg use tolwfr innerloop dataset partial occupi unoccupi band nband play differ role construct firstord wave function mani unoccupi band beyond nband arent explicitli treat abinit discuss de gironcoli phi rev b citedegironcoli set nband exactli equal number occupi band rf calcul semiconductor insul avoid deal issu converg unoccupi band could avoid extra step simpli use tolwfr instead tolvr dataset perhap experi shown necessarili lead wellconverg potenti recommend consider appli phonon calcul metal particular qpt phonon calcul interatom forc constant need find atomrelax contribut elast constant nontrivi structur section section data specif elastictensor rf calcul innerloop dataset familiar take advantag fact cubic symmetri symmetryinequival elast constant c_ c_ c_ abinit unfortun analysi automat specifi rfdir avoid duplic calcul note atom relax taken account complex structur full set direct must use telast_ calcul finish first look telast_log usual make sure run complet without error next would good idea look band occup occ dualloop dataset index report end follow end dataset highest band fourth case zero small occup need increas nband decreas tsmear use newli perfect knowledg abinit perturb index convent scan telast_abo find c_ c_ c_ three k sampl choic rigidatom elast tensor head also find lattic constant case whose converg studi tutori tutorialbas abl cutandpast tabl like follow c_ c_ c_ acel ngkpt ngkpt ngkpt immedi see lattic constant converg consider rapidli k sampl elast constant ngkpt acel converg cs error ngkpt cs converg better even largest c_ accept tutori tutorialbas ngkpt converg control tsmear smaller broaden denser k sampl need get smooth variat occup presum stress strain explor tsmear converg tutori may wish also even lattic paramet type smear function play import role prefer smear occopt appar perform wors standard fermidirac broaden occopt use inde occopt tsmear one obtain c_ c_ c_ acel ngkpt ngkpt ngkpt ngkpt ngkpt ngkpt ngkpt reason supposedli superior smooth function perform poorli context investig cours tsmear differ mean case perhap valu ha kelvin occopt might yield larg error anyhow see predict acel main thing learn check converg respect relev paramet alway user respons simpl system includ main physic featur complex system interest usual suffic test dont get caught publish result anoth research refut converg ground blame mistak abinit make comparison experi use comput valu convert cs standard unit habohr e gpa use zerotemperatur extrapol experiment result p sutton phi rev citesutton find c_gpa c_gpa c_gpa calcul tk calcul tk gaussian ha experi tk good agreement numer valu yet definit one converg studi anyhow said isnt much literatur dft calcul full set elast constant mani calcul bulk modulu kc_c_ cubic case typic within experi lda run telast_ ixc perdewburkeenzerhof gga increas calcul cs wouldnt expect make larg differ nearlyfreeelectron metal comment symmetri import bear mind way tensor like elast tensor appear function frame use thu aluminum fcc case consid nonzero element _c__ _c__ _c__ _provid crystal axe align laboratori frame_ arbitrari align crystal axe mani _c_ij_ element nonzero confus easi see happen imagin actual measur elast tensor element start convent cubic cell appli pressur one face measur _c__ turn cell random angl youll measur respons mixtur _c__ _c__ within abinit aluminum fcc cell describ use angdeg acel axi primit cell align along laboratori _z_ axi lead convent cell align laboratori frame result elast tensor correct appear complic illustr rotat back simpl frame hand bear mind four indic fourthrank elast tensor rotat easier start convent align unit cell use standard text like bradley cracknel mathemat theori symmetri solid oxford citebradley find standard primit cell descript bravai lattic type align much possibl standard laboratori frame author gb mg phononlimit mobil tutori discuss comput phononlimit carrier mobil semiconductor within selfenergi relax time approxim serta momentum relax time approxim mrta take specif case ala exampl assum user alreadi complet two tutori rftutorialrf rftutorialrf hesh familiar calcul ground state respons properti particular phonon born effect charg dielectr tensor user read introduct tutori eph codetutorialeph_intro run exampl lesson take hour formal start worth summar import equat implement code detail descript abinit implement pleas consult citebruninb goal find approxim solut linear boltzmann transport equat bte citeashcroft within sertamrta approxim citegiustino sertamrta accur constant relax time approxim crta microscop eph scatter mechan includ thu lead carrier lifetim tau depend band index n wavevector kk keep mind howev serta mrta still approxim solut bte rigor approach would requir solv bte iter andor inclus manybodi effect differ level review differ possibl approach see review paper citeponc serta transport linewidth given imaginari part electronphonon eph selfenergi evalu ks energi citegiustino linewidth electron state nkk due scatter phonon given beginequ beginsplit lim_eta rightarrow imsigmafm_nkkenk pi sum_mnu int_bz fracdqqomega_bz gkkp time left n_qnu f_mkkqq deltaenk emkq wqnu right left n_qnu f_mkkqq deltaenk emkq wqnu right endsplit labeleqimagfanks_selfen endequ nu phonon mode final electron state scatter n_qnut boseeinstein occup number f_mkkqqt ef fermidirac occup function enk energi electron state wqnu phonon frequenc phonon wavevector qq integr perform bz phonon wavector gkkp eph matrix element fanmigd fm part contribut linewidth debyewal term hermitian serta transport lifetim tau_nmathbfk invers proport eph selfenergi linewidth beginalign fractau_nkk lim_eta rightarrow imsigmafm_nkkenk labeleqfanlifetim endalign mrta backscatt includ express transport lifetim beginequ beginsplit fractau_nkk pi sum_mnu int_bz fracdqqomega_bz gkkp left fracvnk cdot vmkqvnk right time left n_qnu f_mkkqq deltaenk emkq wqnu right left n_qnu f_mkkqq deltaenk emkq wqnu right endsplit labeleqmrta endequ vnka alphath cartesian compon veloc oper vnk pderenkkk langl nk dfracpartialhpartialkk nk rangl comput dfpt import note present formal take account contribut transport lifetim given scatter process defect ioniz impur dope semiconductor ee interact grain boundari scatter etc effect may relev depend system andor temperatur investig treat tutori mainli focus room temperatur nondegener semiconductor condit eph scatter one import contribut last least assum carrier describ bloch state welldefin excit energi band pictur polaron effect discuss tutorialtutorialephzpr captur present approach gener transport coeffici defin beginequ mclm_alphabeta sum_n int fracdkkomega_bz vnka vnkb tau_nkk enkefm leftfracparti fpartialvarepsilonright_enk labeleqtransport_lc endequ quantiti use obtain differ transport tensor electr conduct sigma peltier pi seebeck coeffici charg carrier contribut thermal conduct tensor citemadsen electr conduct tensor instanc given beginequ sigma_alphabeta fracomega mcl_alphabeta labeleqtransport_sigma endequ divid hole electron contribut beginequ sigma n_e mu_e n_h mu_h labeleqmobl endequ n_e n_h electron hole concentr conduct valenc band respect mu_e mu_h electron hole mobil obtain select conduct valenc state n eq eqrefeqtransport_lc electron beginequ beginsplit n_e sum_nin textcb int dfracdkkomega_bz f_nkk mu_e dfracn_ omega mcl_nin textcb endsplit endequ nintextcb denot state conduct band similar express hold hole zero total carrier concentr fermi level ef locat insid band gap n_e n_h typic comput mobil requir differ step summar introduct page eph codetutorialeph_intro describ eph relat part ie bluebox workflow present previou page purpos use eph_task comput imaginari part se ks energi explain import aspect relat kind calcul ground state comput obtain den wfk file dfpt calcul set qqpoint ibz associ homogen mesh dfpt run read wfk file produc previou step produc partial ddb pot file merg partial ddb pot file mrgddb mrgdv respect comput gs wavefunct kkmesh much denser one use dfpt part eph properti converg much slower phonon interpol eph scatter potenti qqspace comput lifetim relev kkpoint contribut mobil comput transport properti step summar follow graph ephmob_assetsworkflowpng styleheightpxwidthpx result calcul save netcdf format sigpephnc file main output file use output select quantiti mainli test purpos postprocess visualis tool provid abipi see eg readm abipyhttpsgithubcomabinitabipi abipi tutorialshttpsgithubcomabinitabitutori tutorial_readm ground state phonon fcc ala begin might consid creat differ subdirectori work creat work_ephmob file tephmob_abi input file first step gs dfpt perturb qqpoint ibz copi work directori sh cd abi_tutorespfninput mkdir work_ephmob cd work_ephmob cp tephmob_abi dialog teststutorespfninputtephmob_abi step might quit timeconsum may want immedi start job background sh abinit tephmob_abi tephmob_log err calcul done ala crystallin materi first two dfpt tutori detail first step pleas refer first second tutori dfpt import sinc ala polar semiconductor need comput dfpt born effect charg bmz well static dielectr tensor bmeeinfti quantiti use treat longrang lr part dynam matrix fourier interpol phonon frequenc well fourier interpol dfpt potenti discuss eph introduct partial ddb pot file produc end dfpt run need perform eph calcul file contain first order wavefunct wf due atom perturb need merg deriv databas potenti dfpt calcul complet use mrgddb tool merg eight partial ddb file correspond dataset tephmob_ partial ddb file contain dynam matric qqpoint ibz well dielectr tensor born effect charg name new ddb file tephmob__ddb file abi_tutorespfninputtephmob_abi exampl input file mrgddb dialog teststutorespfninputtephmob_abi copi file work_ephmob directori run mrgddb use sh mrgddb tephmob_abi tip altern one specifi name output ddb list input ddb file merg directli via command line approach quit handi especi use conjuct shell glob star syntax sh mrgddb tephmob__ddb tephmob_o_ds_ddb use mrgddb help access document use mrgdv tool merg dfpt pot file correspond dataset tephmob_ name new file tephmob__dvdb file abi_tutorespfninputtephmob_abi exampl input file mrgdv dialog teststutorespfninputtephmob_abi copi work_ephmob directori merg file sh mrgdv tephmob_abi tip altern one use command line sh mrgdv merg tephmob__dvdb tephmob_o_ds_pot use mrgdv help access document phononrel file need comput mobil ddb use fourier interpol phonon frequenc arbitrarili dens qqmesh dvdb use fourier interpol dfpt scatter potenti citebruninb ingredi still miss wfk file gs wavefunct dens kkmesh warn real comput alway comput electron band structur along kkpath qualit understand band dispers posit band edg valu band gap note also sever part eph code assum vibrat instabl present alway look phonon spectrum comput code expect obtain meaning result pure imaginari phonon frequenc aka neg frequenc present calcul dens wfk file converg transport properti requir care converg test kkpoint qqpoint dens qqmesh need obtain highqual lifetim wherea dens kksampl need good sampl electron hole pocket studi explain later left addit excercis tutori inde need find compromis accuraci comput cost henc singl kkmesh use exampl comput dens wfk file similar nscf band structur comput main differ need wavefunct kkmesh instead kkpath wavevector need evalu integr bz file abi_tutorespfninputtephmob_abi exampl comput dialog teststutorespfninputtephmob_abi consist two part first one dataset comput gs wavefunct second one dataset comput dens wfk use comput mobil also comput anoth denser wfk file use doublegrid method explain later mainli interest electron mobil conduct band need includ enough empti band nscf wfk comput nband copi file work_ephmob directori run abinit sh abinit tephmob_abi tephmob_log err import last part tutori explain avoid nscf comput kkpoint ibz produc partial wfk file contain wavevector relev transport properti trick crucial reach dens mesh also use coarser mesh want acceler nscf part reduc size wfk file calcul mobil begin explain specifi basic input variabl requir standard mobil calcul file abi_tutorespfninputtephmob_abi exampl comput dialog teststutorespfninputtephmob_abi first need read wfk ddb dvdb file produc previous sinc possibl run mobil calcul singl input file dataset use string specifi path input file sh getwfk_filepath tephmob_o_ds_wfk getddb_filepath tephmob__ddb getdvdb_filepath tephmob__dvdb copi input file work_ephmob directori run code sh abinit tephmob_abi tephmob_log err job take sim second recent cpu discuss mean eph variabl detail optdriv activ eph driver eph_task tell abinit need imaginari part eph selfenergi ks energi homogen kkmesh correspond wfk file specifi ngkpt code abort error ngkpt one found input wfk file present multipl shift nshiftk support ddb_ngqpt defin initi qqgrid use dfpt comput exampl eph_ngqpt_fin defin dens qqmesh scatter potenti interpol eph matrix element comput warn ngkpt eph_ngqpt_fin commensur specif ngkpt must multipl qqmesh eph_ngqpt_fin wfk contain kk kqpoint case ngkpt eph_ngqpt_fin howev possibl use fewer qqpoint note also ngkpt necessarili correspond kkmesh use comput transport quantiti see follow discuss work within rigid band approxim introduc small electron dope eph_dop e correspond e electron per cm obtain result repres intrins mobil suggest use small valu instanc electron per cm altern one specifi dope via eph_extrael eph_fermi also set occopt correctli comput locat fermi level use fermidirac occup function deal physic temperatur fictiti broaden numer integr purpos list physic temperatur specifi tmesh note comput cost increas number temperatur although necessarili linear fashion initi converg studi suggest start rel small number temperatur cover rang interest tmesh densifi aftwerward keep trang converg paramet found note transport properti low temperatur difficult converg deriv fermidirac distribut strongli peak around fermi level henc dens sampl need converg bz integr nutshel avoid low temperatur unless realli interest regim tutori use dens kk qqmesh rule thumb qqmesh twice dens direct kkmesh need achiev fast converg integr citebruninb case ngkpt eph_ngqpt_fin use sigma_ngkpt allow downsampl kkmesh use integr set half valu ngkpt exampl given tutori possibl except system small effect mass eg gaa dens kksampl need sampl electron hole pocket case use sampl electron phonon may enough converg default code use tetrahedron method citeblochl perform integr qqmesh allow effici filter qqpoint contribut lifetim sinc transit compat energi crystallinemomentum conserv use tetrahedron method automat activ eph_task set possibl chang behaviour use eph_intmeth albeit recommend calcul becom significantli slower sigma_erang variabl defin energi window vbm cbm lifetim comput sinc mobil integr involv deriv fermidirac occup function center fermi level possibl restrict comput kkpoint contribut mobil integr valu deriv inde decreas rapidli go fermi level henc state close band edg contribut variabl subject converg studi explain next section valu ev repres good start point analysi hope next version paramet automat comput code boxcutmin mixprec use acceler comput see introductori tutorialtutorialeph_intro examin log file detail standard output input variabl code report differ paramet use treatment longrang part dfpt potenti born effect charg highfrequ dielectr constant dynam quadrupol tensor make sure order obtain accur interpol scatter potenti see discuss citebrunin import present today inclus dynam quadrupol eph code avail public version follow log file sh dielectr tensor ye born effect charg ye quadrupol electr field code output differ quantiti instanc abinit find list kkpoint belong dens mesh locat within energi window sigma_erang sh found kpoint within erang ev initi kkpoint ibz comput valu fermi level aka electron chemic potenti mu_et function comput print afterward make sure mu_e far enough band edg comput mobil consid intrins valu d_v d_c larg compar kt els enter degener regim highlydegener case fermi level insid band addit physic phenomena start play role sh posit cbmvbm respect fermi level notat mu_e fermi level d_v mu_e vbm d_c cbm mu_e tk kt ev mu_e ev d_v ev d_c ev abinit read wfk file interpol scatter potenti obtain eph matrix element use tetrahedron method allow significantli reduc qqpoint sh qpoints_oracl calcul tau_nk need qpoint ibz nqibz_eff nqibz done code start loop kkpoint lifetim need sh comput selfenergi matrix element kpoint e e e find variou inform kkpoint total number qqpoint irreduc zone defin littl group kk call ibzk code number qqpoint textibz_k contribut imaginari part sigma_nk case number much smaller total number qqpoint textibz_k walltim step take final result lifetim tau tephmob_abo file sh kpoint e e e k mu_e b ek seek tauek dek dialog teststutorespfnrefstephmob_abo tip alreadi mention introduct result store sigephnc file abipi one easili access data comput instanc one plot electron linewidth function ks energi use abiopen script sh abiopenpi tephmob_o_sigephnc expos ephmob_assetslinewidthspng well figur impress normal comput kkwavevector still point worth discuss note linewidth cbm small low temperatur cbm inde phonon absorpt allow vibrat state popul low linewidth cbm incres sinc high energi phonon state start popul scatter channel becom avail end main output file diagon element sertamrta mobil tensor sigma_ij report three cartesian direct temperatur sh cartesian compon serta mobil tensor xx temperatur k eh densiti cm eh mobil cmv e e e e e e e e e e e e cartesian compon mrta mobil tensor xx temperatur k eh densiti cm eh mobil cmv e e e e e e e e e e e e temperatur first given electron e hole h densiti follow correspond sertamrta mobil input file consid electron explain valu hole zero particular case differ serta mrta larg two approxim may give significantli differ result system accord recent work mrta result expect closer one obtain iter solv bte tip also run transport driver standalon mode set eph_task provid alreadi lifetim extern sigephnc file specifi via getsigeph_filepath task rel fast even serial execut although part particular comput doslik quantiti benefit mpi know obtain mobil semiconductor given kk qqmesh give addit detail converg studi discuss extra trick significantli decreas comput cost converg wrt energi rang first converg studi consist determin energi rang around band edg use comput tau_nkk perform mobil comput fix kk qqmesh increas valu sigma_erang tip code comput electron hole mobil singl run recommend procedur qqpoint filter expect less effici moreov electron hole may requir differ kksampl converg depend dispers band consequ suggest comput electron hole differ input file file abi_tutorespfninputtephmob_abi exampl comput dialog teststutorespfninputtephmob_abi copi input file work_ephmob directori run abinit sh abinit tephmob_abi tephmob_log err run take minut analyz variat mobil respect sigma_erang todo add script analyz converg wrt sigma_erang studi show energi window cbm enough converg use valu subsequ calcul warn one perform converg studi kkmesh alreadi dens enough captur band dispers correctli case use mesh dens comput mean increas sigma_erang addit kkpoint includ sampl coars case first three dataset kkpoint last two dataset kkpoint finer mesh use number kkpoint would increas monoton way instanc silicon kkmesh could use determin sigma_erang quantiti seebeck etc may differ converg behaviour principl one run singl calcul rel larg sigma_erang decreas window rta part trick howev yet implement converg wrt kq mesh energi window set start converg mobil respect dens kk qqmesh previou comput use kk qqmesh quit far converg give idea silicon requir kkmesh qqmesh reach converg within tip rule thumb qqmesh twice dens direct kkmesh need obtain accur valu linewidth achiev fast converg integr kkspace citebruninb possibl except system small effect mass eg gaa dens kksampl need sampl electron hole pocket case use sampl electron phonon may enough converg tutori use ngkpt eph_ngqpt_fin use sigma_ngkpt allow downsampl kkmesh use integr set half valu ngkpt comput mobil qqmesh twice dens kkmesh two possibl approach run comput ngkpt nshiftk shiftk eph_ngqpt_fin sigma_ngkpt use sigma_ngkpt select kkpoint sigma_nk belong mesh lifetim comput qqmesh run comput ngkpt nshiftk shiftk eph_ngqpt_fin sigma_ngkpt follow approach comput lifetim kk integr perfom qqmesh run transport driver set eph_task transport_ngkpt downsampl kkmesh use integr mobil kkspace second option advantag deliv two mobil oneshot would overkil kq sampl alreadi enough run previou input file densifi differ mesh densest grid might need run multipl mpi process obtain someth like k ephmob_assetstephmob_convpng sorri repeat input tutori tune make comput quit fast final result far converg order get sensibl result one use denser dfpt qqmesh around larger cutoff energi ecut obvious paramet depend system investig doublegrid techniqu anoth possibl improv result without increas comput time significantli doublegrid dg techniqu citebruninb method coars sampl use kk qqmesh eph matrix element finer mesh use interpol weight delta function associ phonon absorptionemiss techniqu allow one acceler converg keep comput cost memori requir reason level import effici dg approach depend strength polar frohlich diverg diverg difficult integr numer coars qqmesh eph matrix element densifi dg techniqu requir second wfk file contain ks eigenvalu fine mesh specifi path fine wfk file use getwfkfine_filepath sh getwfkfine_filepath tephmob_o_ds_wfk file abi_tutorespfninputtephmob_abi first dataset exampl comput dialog teststutorespfninputtephmob_abi copi input file work_ephmob directori run abinit sh abinit tephmob_abi tephmob_log err log file find inform doublegrid method sh coars fine serta mobil obtain k cmv use qqmesh matrix element well would give use sigma_ngkpt result inde improv sinc use mesh electron phonon give also use finer mesh alway multipl initi coars mesh case etc worth notic accord test littl use go beyond mesh three time dens coars one use fine mesh energi give mobil cmv mesh lead cmv improv inde rather limit import rule thumb consid use dg method system tetrahedron filter abl reduc number qqpoint integr signific fraction kkpoint sigma_erang energi window may happen multipl equival pocket thu mani intravalley scatter channel case comput tau_nk may requir sever minut per kkpoint calcul perform kk qqmesh start expens bz sampl get denser inplac restart result calcul store singl sigephnc file kkpoint spin consid list kkpoint initi begin calcul intern tabl netcdf file store statu kkpoint whether comput mean calcul kill resourc manag due time limit reus sigeph file perform automat inplac restart set eph_restart input file rerun job import harm set eph_restart begin keep mind code restart calcul scratch kkpoint sigephnc comput backup copi kept recommend use option multidataset mode multidataset evil come highperform transport calcul sigephnc routin comput carrier mobilit automat invok eph_task use rtanc file final result produc howev case one would like comput mobil start preexist sigephnc without perform full calcul scratch case use eph_task specifi name sigephnc file getsigeph_filepath advanc input variabl transport_ngkpt use downsampl kkmesh use mobil integr mpi parallel memori requir five differ mpi level use distribut workload memorydemand data structur default code tri reach compromis memori requir time solut activ parallel perturb qqpoint parallel input provid user howev specifi manual mpi distribut across five differ level use eph_np_pqbk list integ product five number must equal total number mpi process first entri defin number process parallel perturb allow valu rang natom divisor natom distribut work equal higher number lower memori requir price increas mpi commun second entri determin parallel qqpoint ibz parallel level allow one decreas comput time well memori although alway possibl distribut load equal among process parallel band usual relev mobil comput state close vbm cbm usual includ mpi parallel kkpoint spin effici requir hdf mpiio support besid memori wont scale use addit two level memori requir control want boost calcul reduc memori requir mention memori scale number mpi processor use qqpoint perturb commun howev might tricki system start experi memori shortag prevent run mani mpi process problem show dens kkqq mesh rule thumb mobil calcul mesh denser eg xx start memori demand execut slow sever algorithm intern tabl bz sampl tetrahedron method start domin doubl grid techniqu help mitig bottleneck case may tri reduc slightli valu sigma_erang reduc memori requir note also eph code alloc rel small buffer store bloch state involv transport calcul unfortun kkpoint easi distribut mpi moreov size array depend electron dispers system sever rel flat band around band edg requir memori reduc memori wavefunct code use intern buffer singl precis option enabl configur time use enable_gw_dpcno default behaviour trick solv problem consid use openmp thread code highlyoptim openmp coupl thread may use avoid replic memori mpi level rule thumb openmp thread ok provid link thread fft bla librari compil abinit openmp support link thread librari see correspond section compil tutorialtutorialcompil warn last least use dataset split calcul differ input file optim number mpi process accord dimens problem warn part discuss move eph_intro skw use also phgamma comput wfk kpoint close band edg alreadi seen previou section rel small number kkpoint close band edg usual suffici converg mobil yet nscf run comput wfk file kkpoint ibz henc spent lot resourc comput store state need phononlimit mobil principl possibl restrict nscf calcul relev kkpoint provid cheap goodenough method predict whether wavevector insid energi window without solv ks eigevalu problem exactli exampl one use starfunct interpol shanklandkoellingwood skw citeshankland citekoel citemadsen citemadsen requir input set eigenvalu ibz singl paramet defin basi set interpol sever technic problem address level intern implement idea rel simpl goe follow comput ks eigenvalu rel coars kkmesh ibz use coars wfk file interpol eigenvalu much denser kkmesh specifi user find wavevector dens mesh insid energi window specifi user store list kkpoint extern file kerangenc use extern file run nscf calcul kkpoint end nscf job abinit produc custom wfk file dens mesh use run calcul phononlimit mobil exampl help clarifi suppos comput wfk file nscf run use xx kkmesh let call _wfk want comput mobilit much denser xx kkmesh case use optdriv wfk_task wfk_kpts_erang read wfk file specifi getwfk_filepath find wavevector belong sigma_ngkpt kkmesh insid energi window defin sigma_erang produc kerangenc file paramet defin skw interpol specifi einterp typic input file step look like sh optdriv wfk_task wfk_kpts_erang getwfk_filepath _wfk defin fine kmesh interpol sigma_ngkpt sigma_nshiftk sigma_shiftk sigma_erang ev select kpt fine mesh within energi window einterp paramet starfunct interpol input produc kerangenc file let call out_kerang use via getkerange_filepath variabl start point perfom nscf run follow variabl sh getkerange_filepath out_kerangenc getden_filepath _den read den file initi nscf run getwfk_filepath _wfk init gs wavefunct file option iscf tolwfr e kptopt import variabl must consist valu sigma_ngkpt sigma_shiftk use previou step ngkpt nshiftk shiftk part produc custom fortran wfk file ngkpt state list kerangenc netcdf file comput wkf file use eph code comput mobilit exampl see testv_ testv_ note two test execut multidataset mode singl input file also keep mind qualiti interpol depend initi coars kkmesh recommend look interpol see discuss end introductori tutorialtutorialeph_intro import also good idea use energi window larger one employ comput mobil eph code rule thumb increas sigma_erang ev comput kerangenc file howev test case author spesant mcote xg bamadon tutori dftu project densiti state nio tutori aim show perform dftu calcul use abinit see also citeamadona learn dftu calcul main input variabl control type calcul suppos alreadi know paw calcul use abinit pleas follow two tutori paw abinit pawtutorialpaw pawtutorialpaw case tutori take hour complet tutorial_readm short summari dftu method standard local densiti approxim lda exchang correl energi fit homogen electron ga result function work well vast number compound crystal interact electron import repres lda alon gener highli correl materi contain rareearth metal transit metal partial fill f band thu local electron lda tend deloc electron crystal electron feel averag coulomb potenti highli correl materi larg coulomb repuls local electron might well repres function lda way avoid problem add hubbardlik localis term lda densiti function approach known dftu formerli refer ldau actual implement separ local f electron hubbard term act deloc one p electron latter correctli describ usual lda calcul order avoid doubl count correl part local electron alreadi includ lda although averag manner anoth term call doublecount correct subtract hamiltonian abinit two doublecount correct current implement full local limit fll citeliechtenstein usepawu around mean field amf citeczyzyk usepawu system result might depend choic doublecount method howev two method gener give similar result ground state calcul nio use lda continu might consid work differ subdirectori tutori work_dftu follow name file mention subdirectori copi file tdftu_abi abi_teststutorialinput work_dftu directori sh cd abi_teststutorialinput mkdir work_dftu cd work_dftu cp tdftu_abi dialog teststutorialinputtdftu_abi run code usual job take less second laptop calcul lda ground state nio crystal low cutoff small number kpoint use order speed calcul time take look input file nio crystal rocksalt structur one ni one atom primit cell crystallograph primit cell howev nio known exhibit antiferromagnet order low temperatur along direct electron point view true unit cell two ni two atom local magnet moment around first ni atom sign opposit one ni atom take time examin valu use input variabl xred rprim note last line typat spinat nsppol nspden defin antiferromagnet order along direct convent cubic cell take look output file tdftu_out see integr total densiti paw sphere see pawtutorialpaw pawtutorialpaw tutori paw formal valu roughli estim magnet moment nio integr electron magnet densiti atom sphere radiusratsphiatom smear ratsm diffupdnapproxim z local magnet moment atom radiu up_dens dn_densiti totalupdn diffupdn atom output file list typat variabl first two nickel atom last two oxygen atom result indic spin locat nickel atom doubl primit cell fortun lda succe give antiferromagnet ground state nio result agre experiment data magnet moment differ spin nickel atom rang around accord experi citecheethamciteneubeckcitesawatzki citehufn also fermi level ha see tdftu_abo file one see tdftu_o_eig file contain eigenvalu three kpoint calcul band gap obtain last th occupi band ha k point first th unoccupi band ha kpoint approxim ev lower measur valu ev valu could modifi use wellconverg paramet would still much lower expect easier graphic way evalu gap would plot densiti state see last section tutori make abstract effect insuffici converg paramet reason discrep dftlda data experi first fact dft theori ground state second lack correl lda alon homogen electron ga correctli repres interact among electron ni atom want improv function abl manag strong correl nio dftu fll doublecount seen previous lda give good result magnet band gap compar experi stage tri improv correspond calcul experiment data first use dftldau full local limit fll doublecount method fll amf doublecount express given paper list use adequ number electron spin hubbard term rotat invari interact use note import notic order use dftu abinit must employ paw pseudopotenti run abinit tdftu_abi input file calcul take also less second laptop calcul take look input file dialog teststutorialinputtdftu_abi variabl describ dftu paramet ad previou file paramet kept constant preced calcul first must set variabl usepawu one fll method two amf method order enabl dftu calcul lpawu give atom speci znucl valu angular momentum l dftu correct appli choic porbit dorbit forbit treat orbit dftu present version abinit also want appli dftu correct speci set variabl case nio put lpawu ni note current implement appli dftu correct insid atom sphere check approxim realist relaunch calcul pawprtvol equal three search phphiint log file pawpuxinit icount phphiinticount line indic norm atom wavefunct insid atom sphere rather close one case nickel approxim thu realist case norm small close discuss citegenest final describ articl cite fll amf must defin screen coulomb interact electron treat dftu help variabl upawu screen exchang interact jpawu note choos energi unit indic end line unit abbrevi eg ev ha nio use variabl gener accept type compound upawu ev jpawu ev take look result calcul magnet moment integr electron magnet densiti atom sphere radiusratsphiatom smear ratsm diffupdnapproxim z local magnet moment atom radiu up_dens dn_densiti totalupdn diffupdn nio found antiferromagnet moment reason agreement experiment result moreov system larg gap insul ev band gap th band k point eigenenergi ha much lower eigenenergi th band k point name ha see tdftu_o_eig file number approxim sinc rough sampl k point realli appropri evalu band gap still one obtain right physic word caution order case one obtain systemat good result dftu method first trial inde due natur modif energi function landscap energi function might present numer local minima see exampl citejomard citedorado unlik dftu simpl lda without u nonspinpolar case usual one minimum global minimum converg selfconsist algorithm alway find solut name global minimum alreadi true case spin polar calcul might sever stabl solut scf cycl like ferromagnet ferromagnet usual mani local minima use spinat input variabl allow one adequ select global physic characterist sought solut contrast u spinat input variabl primit one need abl initi spindens matrix atom site u present order guid scf algorithm fact spinat work nio come rel simplic system initi densiti matrix begin run tdftu_abi file continu order help dftu find ground state defin initi densiti matrix correl orbit dmatpawu orbit variabl must contain time squar matric one squar matrix per nsppol atom case squar matric also enabl featur usedmatpu must set nonzero valu default posit densiti matrix kept dmatpawu valu usedmatpu valu step calculationtdftu_abi usedmatpu thu spindens matrix kept constant scf step let examin input dmatpawu dialog teststutorialinputtdftu_abi understand densiti matrix use variabl dmatpawu input file look section variabl dmatpawu section show order orbit densiti matrix help section one understand densiti matrix correspond orbit fill except e_g orbit one spin log file usual output file find step calcul densiti matrix follow impos densiti matrix first scf step initi densiti matrix longer impos section log file impos occup matric echo occup matrix correl orbit kept constant equal dmatpawu input file atom impos occup matrix spin atom impos occup matrix spin atom impos occup matrix spin atom impos occup matrix spin gener dftu function meet problem multipl local minima much usual lda gga function one often get trap local minimum tri differ start point might import amf doublecount method use implement doublecount term dftu abinit known amf fll method method use number electron spin independ complet interact um_m_m_m_ jm_m_m_m_ preced run start fix densiti matrix orbit might start calcul tdftu_abi skip calcul reli refer file provid abi_teststutorialref directori examin tdftu_abi file dialog teststutorialinputtdftu_abi differ input file compar tdftu_abi valu usepawu obtain band gap ev valu band gap amf fll differ howev rememb result well converg contrast magnet integr electron magnet densiti atom sphere radiusratsphiatom smear ratsm diffupdnapproxim z local magnet moment atom radiu up_dens dn_densiti totalupdn diffupdn similar dftu fll system differ import fll design work well system occup orbit spin amf use orbit occup near averag occup project densiti state dftu use prtdo comput project f densiti state inform project densiti state detail see pawtutorialpaw tutori author xg rc second basic tutori hsubsub molecul converg studi tutori aim show get converg valu follow physic properti bond length atomis energi learn numer qualiti calcul make converg studi respect number planewav size supercel final consid effect xc function problem relat use differ pseudopotenti examin also finish read helpabinit tutori take hour tutorial_readm summari previou tutori studi h_ molecul big box use ha cutoff energi xx bohr supercel localdens approxim well localspindens approxim perdewwang parametr ixc pseudopotenti pseudodojo httpwwwpseudodojoorg stage compar result bond length bohr atomis energi bond length ha ev experiment data well theoret data use much accur techniqu dft bond length bohr atomis energi ev bond length rather bad atomis energi bit low converg ecut comput bond length correspond atomis energi one run begin might consid work differ subdirectori tutori work comput mani time bond length atomis energi worth make singl input file associ oper tri use dataset tri combin abi_teststutorialinputtbase_abi tbase_abi tri posit h atom one h_ atom optim geometri sh cd abi_teststutorialinput mkdir work cd work cp tbase_abi input file tbase_abi exampl file job dialog teststutorialinputtbase_abi tbase_abo exampl output file dialog teststutorialrefstbase_abo execut code abinit tbase_abi log run take less one minut obtain valu etot e etot e xcart e e e e e e similar determin tutori tutorialbas although obtain one run also check residu forc lower converg issu discuss helpabinitnumericalqualitysect abinit help file numer qualiti read way read mani part abinit help file miss section part helpabinit helpabinitpseudopotentialfil helpabinitnumericalqu also miss descript mani input variabl suggest finish read entir abinit help file knowledg input variabl come long run b mani converg paramet alreadi identifi focu ecut acel converg scf cycl geometri determin well control thank toldf toldff tolmxf might case physic properti k point converg studi done isol system big box addit inform gain ad kpoint beyond one boxcut valu see boxcutmin automat chosen larger abinit see determin input variabl ngfft preprocess use ionmov determin geometri converg ecut ii check converg respect ecut choic differ run tbase_abi file differ valu ecut doubl loop dataset propos abi_teststutorialinputtbase_abi valu ecut chosen ha ha step ha want make doubl loop might benefit read helpabinitloopdoubleloop section abinit_help file like seen big increas cpu time need calcul also look increas memori need calcul go back begin output file output data follow etot e etot e etot e etot e etot e etot e etot e etot e etot e etot e etot e etot e xcart e e e e e e xcart e e e xcart e e e e e e xcart e e e xcart e e e e e e xcart e e e xcart e e e e e e xcart e e e xcart e e e e e e xcart e e e xcart e e e e e e xcart e e e correspond atomis energi interatom distanc ecut ha atomis energi ha interatom distanc bohr order obtain rel accuraci bond length atomis energi one use kinet cutoff energi ha keep mind valu final run converg acel techniqu ecut use converg acel explor acel start step keep ecut studi inde rather gener rule littl crossinflu converg ecut converg acel file abi_teststutorialinputtbase_abi use exampl dialog teststutorialinputtbase_abi output result abi_teststutorialrefstbase_abo follow etot e etot e etot e etot e etot e etot e etot e etot e etot e etot e etot e etot e xcart e e e e e e xcart e e e xcart e e e e e e xcart e e e xcart e e e e e e xcart e e e xcart e e e e e e xcart e e e xcart e e e e e e xcart e e e xcart e e e e e e xcart e e e correspond atomis energi interatom distanc acel bohr atomis energi ha interatom distanc bohr order reach converg atomis energi interatom distanc one need acel use acel final run solid size unit cell smaller treat lot vacuum supercel h_ studi pseudopotenti turn realli easi cours number state treat minim allow reason cpu time still final calcul local spin densiti approxim use correct valu ecut acel well modifi tbase_abi file make calcul acel ecut still use doubl loop featur udtset reduc singl loop minim modif file file abi_teststutorialinputtbase_abi taken exampl input file dialog teststutorialinputtbase_abi abi_teststutorialrefstbase_abo exampl output file dialog teststutorialrefstbase_abo sinc calcul singl ecut acel pair total cpu time much previou determin optim valu seri calcul howev memori need still increas bit output data etot e etot e xcart e e e e e e xcart e e e correspond atomis energi ha ev interatom distanc bohr final data local spin densiti approxim witou choic pseudopotenti valu ixc correspond perdewwang citeperdewa parameter lda xc function principl use ixc express local spin densiti approxim ixc possibl valu give result sinc start xc energi homogen electron ga determin quantum mont carlo calcul possibl ixc older local densiti function could reli data use gener gradient approxim use perdewburkeernzerhof function propos citeperdew gga use anoth pseudopotenti lda principl redo ecut converg test possibl come conclus anoth valu ecut use howev special case hydrogen gener pseudopotenti small core includ orbit pseudopotenti issu lda gga similar redo ecut converg test import ecut often characterist pseudopotenti use calcul independ pseudopotenti acel converg test done sinc vacuum treat similarli lda gga final valu within gga easili obtain chang pseudopotenti respect one use tbase_abi dialog teststutorialinputtbase_abi etot e etot e xcart e e e e e e xcart e e e correspond atomis energi ha ev interatom distanc bohr final data gener gradient approxim experiment data bond length bohr atomis energi ev gga within experiment bond length experiment atomis energi lda within experiment bond length experiment atomis energi import forget typic accuraci lda gga vari class materi studi usual lda give small lattic paramet gga give larg lattic paramet well might class materi deviat larger see eg citelejaegher author jwz xg tutori properti nuclei observ near atom nuclei purpos tutori show comput sever observ interest moumlssbauer nmr nqr spectroscopi name electr field gradient isom shift tutori take hour tutorial_readm electr field gradient variou spectroscopi includ nuclear magnet reson nuclear quadrupol reson nmr nqr well moumlssbauer spectroscopi show spectral featur aris electr field gradient nuclear site note electr field gradient efg consid aris distribut charg within solid due extern electr field way efg observ spectroscop experi coupl nuclear electr quadrupol moment physic coupl describ variou text exampl citeslicht abinit comput field gradient site report gradient coupl base input valu nuclear quadrupol moment electr field gradient nuclear site aris distribut charg electron ionic solid gradient especi quit sensit detail distribut short rang necessari use paw formal comput gradient accur charg densiti nmathbf r potenti v given vmathbf rint fracnmathbf r mathbfrmathbfr dmathbf r electr field gradient v_ij fracpartialparti x_iparti x_jvmathbf r gradient comput nuclear site sourc charg aris paw decomposit see tutori pawtutorialpaw done code follow citeprofetacitezwanzig valenc space describ planewav express gradient fouriertransform nuclear site ion core gradient comput ewald sum method onsit paw contribut moment densiti integr real space around atom weight gradient oper code report contribut separ request electr field gradient comput perform end groundstat calcul take almost addit time tutori file stishovit polymorph sio_ addit typic ground state variabl two addit variabl ad prtefg quadmom dialog teststutorialinputtnuc_abi first variabl instruct abinit comput print electr field gradient second give quadrupol moment nuclei barn one type atom standard sourc quadrupol moment citepyykko consid silicon oxygen particular si zero quadrupol moment stabl isotop oxygen nonzero quadrupol moment run file tnuc_abi abinit find follow near end output file electr field gradient calcul atom typat cq mhz eta efg eigval eigvec efg eigval eigvec efg eigval eigvec total efg total efg total efg fragment give gradient first atom silicon note gradient zero coupl isthat quadrupol moment si zero although there gradient there noth nucleu coupl atom oxygen atom entri output atom typat cq mhz eta efg eigval eigvec efg eigval eigvec efg eigval eigvec total efg total efg total efg efg_el efg_el efg_el efg_ion efg_ion efg_ion efg_paw efg_paw efg_paw see electr field gradient coupl frequenc unit along asymmetri coupl tensor final three contribut total note valenc part efg_el small ionic part onsit paw part larger fact paw part largest calcul give poor result normconserv pseudopotenti need full accuraci paw captur behavior near nucleu experiment nuclear quadrupol coupl stishovit report pm mhz asymmetri pm citexianyuxu uncommon pawbas efg calcul give coupl valu percent larg often improv use paw dataset smaller paw radii expens expens calcul citezwanzig fermi contact interact fermi contact interact aris overlap electron wavefunct atom nucleu observ exampl moumlssbauer spectroscopi citegreenwood moumlssbauer spectra isom shift delta express si veloc unit delta fracpifracce_gammafracz e piepsilon_ psi r_a psi r_ deltalangl rrangl psir electron wavefunct nuclear site r absorb sourc respect c speed light e_gamma nuclear transit energi z atom number deltalangl rrangl chang nuclear size squar quantiti assum known moumlssbauer spectrum interest except psir fermi contact term abinit comput fermi contact term paw formal use observ deltar dirac delta function nuclear site citezwanzig like electr field gradient comput fermi contact calcul perform end ground state calcul take almost time tutori file sno_ like stishovit studi rutil structur addit typic ground state variabl one addit variabl need prtfc dialog teststutorialinputtnuc_abi run file inspect output look phrase fermicontact term calcul youll find fc output atom case sn atom typat yield contact term densiti atom unit a_ interpret moumlssbauer spectra need realli sourc absorb tutori provid also file alphasn grey tin nonmetal dialog teststutorialinputtnuc_abi run file find contact term check result use experiment data isom shift delta known compound comput deltalangl rrangl equat see citezwanzig use result togeth standard tin moumlssbauer paramet e_gamma kev experiment shift mmsec alphasn rel sno_ find deltalangl rrangl time mathrmfm decent agreement calcul time mathrmfm citesvan citesvan author mt second tutori projector augmentedwav paw techniqu gener paw atom dataset tutori aim show creat atom dataset projector augmentedwav paw method learn gener atom dataset control soft transfer alreadi know use abinit paw case see tutori pawtutorialpaw tutori take h tutorial_readm paw atom dataset introduct paw method base definit spheric augment region radiu r_c around atom system basi atom partialwav phi_i pseudiz partialwav tphi_i projector tprj_i dual tphi_i defin set _partialwaves_ _projectors_ function addit atom data store socal paw dataset paw dataset gener atom speci order reproduc atom behavior accur possibl requir minim cpu memori resourc execut abinit crystal simul two constraint obvious conflict paw dataset gener purpos tutori done accord follow procedur paramet defin paw dataset bold choos defin concern chemic speci name atom number solv atom allelectron problem given atom configur atom problem solv within dft formal use exchangecorrel function either schroding default scalarrelativist approxim _spheric problem_ solv radial grid atom problem solv given electron configur ionizedexcit one choos set electron consid frozen around nucleu core electron other electron valenc one use paw basi core densiti deduc core electron wave function smooth core densiti equal core densiti outsid given r_core match radiu comput choos size paw basi number partialwav projector choos partialwav includ basi later atom eigenfunct relat valenc electron bound state andor addit atom function solut wave equat given l quantum number arbitrari refer energi unbound state gener pseudo partialwav smooth partialwav build pseudiz scheme equal partialwav outsid given r_c match radiu associ projector function pseudo partialwav solut paw hamiltonian deduc atom hamiltonian pseudiz effect potenti local pseudopotenti built equal effect potenti outsid r_vloc match radiu projector partialwav orthogon chosen orthogon scheme build compens charg densiti use later order retriev total charg atom compens charg densiti locat insid paw sphere base analyt shape function analyt form local radiu r_shape chosen user choos two paw dataset gener produc atom file directli readabl abinit first one paw gener httpuserswfuedunataliepaperspwpawmanhtmlatompaw origin _n holzwarth_ second one httpwwwphysicsrutgersedudhvuspp ultrasoft uspp gener origin written _d vanderbilt_ tutori concentr atompaw highli recommend refer follow paper understand correctli gener paw atom dataset projector augmentedwav method citebloechl projector augment wave paw code electron structur citeholzwarth ultrasoft pseudopotenti projector augmentedwav method citekress electron structur packag two implement projector augmentedwav paw formal citetorr note revis form atompaw code n holzwarth httpwwwwfueduenataliepaperspwpawnotesatompawatompaweqnspdfpdf use gener code continu might consid work differ subdirectori tutori work_paw sh cd abi_teststutorialinput mkdir work_paw cd work_paw instal atompaw code internet browser enter follow url httpsuserswfuedunataliepaperspwpaw download last version targz file unzip untar enter atompawxyz execut sh mkdir build cd build configur make goe well get atompaw execut span stylecolorgreenatompawxyzbuildsrcatompawspan go directori span stylecolorgreendocspan open file span stylecolorgreenatompawusersguidepdfspan go p follow instruct note maco use httpsbrewshhomebrew packag manag instal atompaw type sh brew instal atompawrepoatompaw note follow name atompaw atompaw execut use atompaw follow process appli nickel next paragraph edit input file text editor content input explain herepaw_assetsatompawusersguidepdf run atompaw inputfil partial wave phi_i ps partialwav tphi_i projector tprj_i given wfni file logarithm deriv atom hamiltonian paw hamiltonian resolut given logderivl file summari atom _allelectron_ comput paw dataset properti found atom_nam file atom_nam first paramet input file result paw dataset contain atom_namexcfuncxml file normal xml file accord paw xml specificationshttpseslcecamorgpawxml recommend atom_namexcfuncpawabinit file proprietari legaci format abinit first basic paw dataset nickel test case nickel electron configur p p p first stage copi simpl input file atompaw work directori find span stylecolorgreenabi_homedoctutorialpawpaw_assetsniatompawinputspan edit file dialog tutorialpaw_assetsniatompawinput file built follow way allelectron calcul paramet st line defin span stylecolorgreenmaterialspan ni nd line choos span stylecolorgreenexchangecorrel functionalspan ldapw ggapb select scalarrelativist span stylecolorgreenwav equationspan nonrelativist scalarrelativist point logarithm span stylecolorgreengridspan ggapb scalarrelativist loggrid electron configur _how mani electron state need includ comput besid fulli partial occupi state recommend add state could reach electron solid nickel p state concern decid add computation_ rd line defin span stylecolorgreenelectron configurationspan line maximum n quantum number electron shell mean p follow line definit span stylecolorgreenoccup numbersspan partial occupi shell enter occup number _an excit configur may use paw dataset intend use context materi charg oxid although experi result highli depend chosen electron configuration_ choos p configur p shell partial occupi line end occup section select span stylecolorgreencor valenc electronsspan _in first approach select electron outer shell valenc particular thermodynam condit simul gener need includ semicor state set valenc electron semicor state gener need transit metal rareearth materials_ note wave function design valenc electron use partialwav basi core shell design c valenc shell v state first p state final state c c c v c c v v mean core core core valenc p core p core p valenc valenc partialwav basi gener line l_max span stylecolorgreenmaximum lspan partialwav basi l_max line span stylecolorgreenr_pawspan radiu _select slightli less half interatom distanc solid first choic r_paw au_ next line add span stylecolorgreenaddit _partialwaves_span phi_i need choos partialwav per angular momentum basi choic necessarili optim common one r_paw small enough partialwav per l may suffic first guess put span stylecolorgreenrefer energiesspan addit partialwav rydberg angular momentum first add add addit partialwav next line put valu rydberg unit repeat new partialwav final put n _note angular momentum valenc state alreadi includ partialwav basi p state alreadi basis_ present file n mean addit partialwav e_ref ry ad n mean addit p partialwav e_ref ry ad n mean addit partialwav e_ref ry ad final partialwav basi contain two two p two partialwav next line definit span stylecolorgreengener scheme pseudo partial wave tphi_ispan projector tprj_i _we begin simpl scheme ie bloechl scheme propos p blochl citebloechl probabl chang later make paw dataset efficient_ bloechl next line span stylecolorgreengener scheme local pseudopotenti v_locspan order get ps partialwav atom potenti pseudiz use arbitrari pseudiz scheme choos troulliermartin use wave equat l_loc e_loc ry first draft alway recommend put l_locl_max troulliermartin next two line xmlout make atompaw gener paw dataset xml format next line contain option abinit file default set paramet default valu xmlout default end keyword end file end stage run atompaw purpos simpli enter atompaw niatompawinput lot file produc examin summari paw dataset gener process written file name ni open look like complet calcul ni exchangecorrel type gga perdewburkeernzerhof radial integr grid logarithm r e h e n rmax e scalar relativist calcul aeatom converg iter nz delta e electron orbit energi n l occup energi e e e e e e e e e e e e e e e e total energi total complet calcul ni exchangecorrel type gga perdewburkeernzerhof radial integr grid logarithm r e h e n rmax e scalar relativist calcul scatom converg iter nz delta e valenc electron orbit energi n l occup energi e e e e e e total energi total valenc paw paramet lmax rc irc vloc normconserv troulliermartin l e e projector type bloechl gramschmidt ortho sinc compens charg shape zero rc number basi function n l energi cp coeff occ e e e e e e e e e e e e e e e e e e complet diagon ovlp info eigenvalu overlap oper basi projector e e e e e e summari paw energi total valenc energi smooth energi one center smooth kinet vloc energi smooth exchcorr onecent xc gener paw dataset contain span stylecolorgreenniggapbexmlspan file first draft sever paramet adjust order get accur result effici dft calcul note span stylecolorgreenniggapbexmlspan file directli usabl abinit check sensit paramet radial grid let tri select point logarithm grid check notic differ result appear replac second line span stylecolorgreenniatompawinputspan file run atompaw niatompawinput look ni file summari paw energi total valenc energi smooth energi one center smooth kinet vloc energi smooth exchcorr onecent xc see result obtain new grid close previou one expeci valenc energi keep point grid note could tri decreas size grid small grid give paw dataset small size kb run faster abinit accuraci affect note final r_paw valu rc ni file chang grid r_paw adjust order belong exactli radial grid look atompaw user guidepaw_assetsatompawusersguidepdf choos keep constant b relativist approxim wave equat _scalarrelativistic_ option give better result _nonrelativistic_ one sometim produc difficulti converg atom problem either allelectron resolut step paw hamiltonian solut step converg reach tri nonrelativist calcul recommend high z materi note follow note alway check ni file especi valu valenc energi find valenc energi comput exact atom problem valenc energi comput paw paramet two result close agreement adjust partialwav projector examin ae partialwav phi_i ps partialwav tphi_i projector tprj_i save file name wfni rang number partialwav use present exampl file contain column radiu r column ae partialwav phi_ir column ps partialwav tphi_ir column projector tprj_ir column plot curv function radiu use plot tool choic first partialwav projector ni exampl first partialwavepaw_assetswfnajpg phi_i meet tphi_i near last maximum minimum prefer chang valu match pseudiz radiu r_c maxima tphi_i tprj_i function roughli order magnitud tri get three way chang match radiu partialwav alway possibl paw sphere overlap solid chang pseudopotenti scheme see later two partialwav angular momentum l consider decreas magnitud projector possibl displac refer energi move energi away gener reduc magnitud projector big differ energi lead wrong logarithm deriv see follow section exampl plot wfn file relat second partialwav nd partialwavepaw_assetswfnajpg partialwav gener e_ref ry orthogon first partialwav eigenenergi equal ry see ni file two energi close orthogon process produc high partialwav tri replac refer energi addit partialwav exampl put e_ref ry instead e_ref ry line niatompawinput file run atompaw plot wfn file nd partialwavepaw_assetswfnbjpg ps partialwav projector order magnitud import note alway check two valenc energi valu ni file make sure close possibl choic projector andor partialwav certainli judici examin logarithm deriv examin logarithm deriv ie deriv lstate fracdlogpsi_led comput exact atom problem paw dataset print logderivl file logderivl file correspond angular momentum l contain five column data energi logarithm deriv lstate exact atom problem logarithm deriv pseudiz problem two colum relev section follow edit logderiv file edit three first column ni exampl l logarithm deriv follow properti curv superimpos much possibl construct superimpos energi correspond l partialwav superimposit good enough refer energi second l partialwav chang gener discontinu logarithm deriv curv appear ry le e_l ry reason choic choos refer energi e_ close refer energi produc hard projector function see section move refer energi away damag accuraci logarithm deriv three logarithm deriv curv current dataset l log derivativespaw_assetslogajpg l logderivativespaw_assetslogajpg l logderivativespaw_assetslogajpg see except l exact paw logarithm deriv match accord previou remark tri valu refer energi p addit partialwav first edit span stylecolorgreenniatompawinputspan file put e_ref ry addit state line run atompaw plot logderiv file get l log derivativespaw_assetslogbjpg put e_ref ry second p state line run atompaw plot logderiv file get l log derivativespaw_assetslogbjpg paw logarithm deriv match exact one reason interv note possibl chang interv energi use plot logarithm deriv default also comput point default add follow keyword end second line input file want atompaw output logarithm deriv energi point logderivrang addit inform relat logarithm deriv ghost state anoth possibl issu could presenc discontinu paw logarithm deriv curv energi exact logarithm deriv continu gener show presenc _ghost state_ first tri chang valu refer energi sometim make ghost state disappear use chang pseudopotenti scheme normconserv pseudopotenti sometim attract near r st solut chang quantum number use gener normconserv pseudopotenti gener suffici nd solut select ultrasoft pseudopotenti free norm conserv constraint simpli replac troulliermartin ultrasoft input file rd solut select simpl bessel pseudopotenti replac troulliermartin bessel input file case one notic decreas match radiu r_vloc one want keep reason physic result select valu r_vloc r_paw r_paw good choic chang valu r_vloc one explicit put match radii r_paw r_shape r_vloc r_core see user guidepaw_assetsatompawusersguidepdf last solut tri chang match radiu r_c one l partialwav case chang r_c remov ghost state case chang pseudopotenti match radiu one restart procedur step see exampl ghost state use span stylecolorgreenabi_homedoctutorialpaw_assetsnighostatompawinputspan file run atompaw dialog tutorialpaw_assetsnighostatompawinput look l logarithm deriv logderiv file look like ni l log derivativespaw_assetslogcjpg edit span stylecolorgreennighostatompawinputspan file replac troulliermartin ultrasoft run atompaw look logderiv file ghost state move edit file replac troulliermartin bessel line chang th line decreas r_vloc radiu run atompaw ghost state disappear start origin state span stylecolorgreennighostatompawinputspan file put match radiu p state put line run atompaw ghost state disappear test effici paw dataset let use span stylecolorgreenniatompawinputspan file nickel modif get file span stylecolorgreenniggapbepawxmlspan contain paw dataset design abinit test effici gener paw dataset final use abinit run dft comput determin size plane wave basi need reach given accuraci cutoff energi defin plane wave basi high higher hartre chang made input file copi span stylecolorgreenabi_teststutorialinputtpaw_abispan work directori edit activ dataset uncom line ndtset dialog teststutorialinputtpaw_abi run abinit comput total energi ferromagnet fcc nickel sever valu ecut end output file get ecut e hartre ecut e hartre ecut e hartre ecut e hartre ecut e hartre ecut e hartre ecut e hartre ecut e hartre etot e etot e etot e etot e etot e etot e etot e etot e etot converg mhartre achiev le e_cut le hartre etot converg mhartre achiev e_cut ge hartre good result paw dataset let tri optim st possibl use vanderbilt projector instead bloechl one vanderbilt projector gener local reciproc space bloechl one keyword bloechl replac vanderbilt atompaw input file r_c valu ad end file one ps partialwav see input file span stylecolorgreenabi_homedoctutorialpaw_assetsniatompawinputvanderbiltspan dialog tutorialpaw_assetsniatompawinputvanderbilt nd possibl use rrkj pseudiz scheme projector use input file atompaw span stylecolorgreenabi_homedoctutorialpaw_assetsniatompawinputspan see bloechl chang custom rrkj six r_c valu ad end file one correspond match radiu one ps partialwav repeat entir procedur atompaw abinit get new abinit output file _note check log derivatives_ dialog tutorialpaw_assetsniatompawinput ecut e hartre ecut e hartre ecut e hartre ecut e hartre ecut e hartre ecut e hartre ecut e hartre ecut e hartre etot e etot e etot e etot e etot e etot e etot e etot e etot converg mhartre achiev le e_cut le hartre etot converg mhartre achiev le e_cut le hartre reason result paw dataset rd possibl use enhanc polynomi pseudiz scheme projector edit span stylecolorgreenniatompawinputspan replac custom rrkj custom polynom may sometim improv ecut converg option exercis let go back vanderbilt projector repeat procedur atompaw abinit previou span stylecolorgreenniatompawinputvanderbiltspan file dialog tutorialpaw_assetsniatompawinputvanderbilt let tri chang pseudiz scheme local pseudopotenti tri replac troulliermartin keyword ultrasoft repeat procedur atompaw abinit abinit reach converg result ecut e hartre ecut e hartre ecut e hartre ecut e hartre ecut e hartre ecut e hartre ecut e hartre ecut e hartre etot e etot e etot e etot e etot e etot e etot e etot e etot converg mhartre achiev le e_cut le hartre etot converg mhartre achiev le e_cut le hartre note could tri bessel keyword instead ultrasoft one summari converg result ecut convergencepaw_assetsecutjpg final_remark local projector reciproc space gener predict look tprodi file file contain curv function q reciproc space variabl q given bohr unit connect abinit plane wave cutoff energi hartre unit e_cutfracq_cut quantiti calcul bound state sinc fourier transform extend function welldefin gener projector blochl scheme often give guaranti stabl calcul atompaw end without converg problem dft calcul run without diverg need high plane wave cutoff vanderbilt projector even custom projector sometim produc instabl paw dataset gener process andor dft calcul effici case chang projector gener scheme one restart procedur step test physic quantiti last step examin care physic quantiti obtain paw dataset copi span stylecolorgreenabi_teststutorialinputtpaw_abispan work directori edit activ dataset ubcom ndtset line use span stylecolorgreenabi_homedoctutorialpaw_assetsniggapbepawrrkjxmlspan paw dataset obtain span stylecolorgreenniatompawinput filespan run abinit may take dialog teststutorialinputtpaw_abi dialog tutorialpaw_assetsniggapbepawrrkjxml abinit comput converg ground state ferromagnet fcc nickel sever volum around equilibrium plot etot vs acel curv etot vs acellpaw_assetsacelletotaljpgwidth graph output file extract physic quantiti equilibrium cell paramet angstrom bulk modulu b gpa magnet moment equilibrium mu compar result publish result allelectron ggaflapw citekress angstrom b gpa mu ggapaw vasp code citekress angstrom b gpa mu experiment result citedewael angstrom b gpa alway compar result allelectron one paw comput experiment one addit remark use test sensit result atompaw input paramet see user guidepaw_assetsatompawusersguidepdf detail keyword analyt form cutoff radiu r_shape shape function use compens charg densiti definit default sinc function use gaussian shape influenc result bessel shape effici gener need smaller cutoff radiu r_shaper_paw match radiu r_core use gener pseudo core densiti atom core densiti inclus addit semicor state set valenc electron pseudiz scheme use get pseudopotenti vlocr paramet meticul check especi paw dataset use nonstandard solid structur thermodynam domain optional_exercis let add p semicor state paw dataset repeat procedur atompaw abinit span stylecolorgreenabi_homedoctutorialpaw_assetsniatompawinputsemicorespan file execut time bit longer electron treat abinit look a_ b mu variat note new paw dataset smaller r_paw radiu semicor state local angstrom b gpa mu real space optim rso experienc user section addit optim atom data present contribut case speedup converg ecut optim essenti produc effici paw dataset use advis experienc user tri idea quit simpl express differ atom radial function phi_i tphi_i tprj_i plane wave basi number plane wave depend local radial function reciproc space citekingsmiththi paper method enforc local reciproc space projector tprj_i present projector express reciproc space tprj_ig modifi accord follow scheme reciproc space divid region g lt g_max tprj_ig unchang g gt gamma tprj_ig set zero g_max le g le gamma tprj_ig modifi contribut tprj_ir conserv error w small possibl rsopaw_assetsrsopngwidth transform tprj_ig possibl tprj_ir defin outsid spheric augment region radiu r_ r_ r_c practic impos error w w maximum error admit total energi adjust g_max accord e_cut g_max le e_cut choos gamma g_max lt gamma lt g_max let atompaw code appli transform tprj_i deduc r_ radiu test work directori use dataset span stylecolorgreenabi_homedoctutorialpaw_assetsniatompawinputspan bloechl projector dialog tutorialpaw_assetsniatompawinput replac xml option penultim line xmlout default xmlout rsoptim valu g_maxfracgammag_max w run atompaw get new paw dataset file abinit run abinit use span stylecolorgreentpaw_abispan file compar result obtain section tri sever valu g_max keep fracgammag_max w constant compar effici atom data forget test physic properti rso comparisonpaw_assetsrsocompajpg note choos rso paramet fracgammag_max lt w lt good choic g_max adjust lower g_max faster converg low g_max produc unphys result author mver electronphonon tutori electronphonon interact superconduct properti al tutori demonstr obtain follow physic properti metal phonon linewidth invers lifetim due electronphonon interact eliashberg spectral function electronphonon coupl strength mcmillan critic temperatur resist electron part thermal conduct learn use electronphonon coupl part anaddb util impli preliminari calcul electronphonon matrix element phonon frequenc eigenvector standard abinit phonon calcul review succinctli note tutori cover legaci version electronphonon calcul new effici workflow present tutori introduct new eph workflowtutorialeph_intro old workflow still use compat spinor spin orbit coupl paw therefor also dftu deprec time futur visualis tool cover tutori power visualis procedur develop abipi context reli matplotlib see readm abipyhttpsgithubcomabinitabipi abipi tutorialshttpsgithubcomabinitabitutori tutori take hour tutorial_readm calcul ground state phonon structur fcc al begin might consid make differ subdirectori work creat work_eph abi_teststutorespfninput presum user alreadi follow tutori rftutorialrf rftutorialrf understand calcul ground state respons phonon use densityfunct perturb theori dfpt properti abinit copi file teph_abi work directori contain particular file name root name first run gsperturb sh cd abi_teststutorespfninput mkdir work_eph cd work_eph cp teph_abi dialog teststutorespfninputteph_abi immedi start run input file examin later abinit teph_abi log err dataset structur flow teph_abi file contain number dataset ds perform ground state ds phonon perturb ds cell fcc aluminium ddk perturb ds also calcul use obtain fermi veloc transport calcul section done abinit calcul wave function full grid kpoint use kptopt ds use calcul electronphonon matrix element full calcul densiti kpoint increas significantli follow dataset ds normal converg phonon frequenc ensur ds matrix element calcul electronphonon coupl ddk positionmomentum matrix element dens complet grid kpoint ds note separ matrix element calcul new version import variabl electronphonon coupl calcul prtgkk print file suffix gkk contain electronphonon matrix element calcul ds matrix element depend selfconsist perturb densiti file suffix denx get ds link variabl getden gkk therefor calcul arbitrarili dens kpoint mesh chosen ds even better singl scf step need sinc selfconsist requir enforc calcul matrix element kpoint symmetri disabl prtgkk set sure use normal selfconsist phonon run ds differ version converg calcul done use minim valu number paramet order make tractabl time appropri tutori result complet unconverg end tutori know run full electron phonon calcul abl improv converg edit file teph_abi examin sever variabl kinet energi cutoff ecut bit low number kpoint determin ngkpt much low electronphonon calcul requir precis determin fermi surfac metal impli dens kpoint mesh converg grid must check case al use nonshift xx kpoint grid converg calcul need xx point reconsid section qpoint grid xx select ngqpt qshift nqshift qptopt variabl must subgrid full kpoint grid must contain  point phonon gkk dataset qpoint select variabl iqpt guarante error transcript q coordin simplifi workflow unknown ahead time total number q henc dataset irreduc wedg one way check set iqpt larg valu error messag give size irreduc set valu acel fix round valu experi converg get physic result see tutori tutorialbas note valu e tolwfr tight even lower e even e accur result wavefunct use later explicitli matrix element anaddb oppos energi valu densiti averag wavefunct eigenenergi kpoint band electronphonon quantiti delic sum small matrix element near fermi surfac matrix element must accur howev set prtwf phonon calcul avoid save huge perturb wavefunct file disk need keep ground state wave function prtwf execut run first input second recent pc obtain valu etot e ha energi end dataset follow dataset calcul second order energi variat atom displac three reduc direct fcc unit cell done three differ phonon gamma x gener xx qpoint grid take care reduc coordin reciproc space point along cartesian direct along reciproc space lattic vector whole calcul follow line tutori rftutorialrf exampl dataset calcul perturb wavefunct kq k ground state kpoint mesh q dataset calcul dte e ha secondord energi variat movement uniqu atom along first reduc direct q main differ tutori rftutorialrf given deal metal perturb wrt electr field consid howev want transport calcul need ddk calcul anyway get electron band veloc ad dataset standard case abinit use symmetri oper nonstationari express calcul minim number dte differ mix second deriv total energi case use first deriv must calcul explicitli proud owner firstord matrix element file suffix _gkkx correspond copi netcdf format _gkkxnc correspond three direct perturb atom three qpoint _gkk file contain matrix element electronphonon interact extract use follow besid _gkk file _ddb file perturb contain dte differ phonon wavevector q merg dte ddb file use mrgddb copi follow content file teph_abi within work directori teph_ddbout total ddb al fcc system teph_o_ds_ddb teph_o_ds_ddb teph_o_ds_ddb use dialog teststutorespfninputteph_abi input file helpmrgddbmrgddb util take differ _ddb file merg singl one anaddb use determin phonon frequenc eigenvector teph_abi contain name final file comment line number _ddb file merg name mrgddb run command mrgddb teph_abi run second extract merg electronphonon matrix element use mrggkk merg similar last section must carri electronphonon matrix element done use mrggkk util input file abi_teststutorespfninputteph_abi shown teph_o_gkkbin name output file binari ascii output teph_o_ds_wfk gs wavefunct file number wf file gkk file perturb gkk file teph_o_ds_gkk name wf eventu gkk file teph_o_ds_gkk use dialog teststutorespfninputteph_abi matrix element section _gkk file extract concaten one binari file name teph_o_gkkbin follow line teph_abi give output format binari ascii name ground state wavefunct file fourth line contain integ give number _wf file also use salvag gkk number _gkk file number perturb _gkk file thu mrggkk function much like helpmrgddbmrgddb merg _gkk file alreadi contain sever perturb qpoint atom displac final name differ _wf _gkk file list mrggkk run exampl second gener case runtim depend size system larg number band kpoint extend minut basic anaddb calcul electronphonon quantiti gener theori electronphonon coupl eliashberg superconduct review citeallenatheori superconduct tc pb allen b mitrov first implement similar abinit citesavrasov citeliu file abi_teststutorespfninputteph_abi contain input need anaddb carri calcul electronphonon quantiti dialog teststutorespfninputteph_abi anaddb file path variabl like abinit tell find input ddb gkk file name output thermodynam output electron phonon output file new variabl head file turn calcul electronphonon quantiti elphflag path reciproc space along phonon linewidth band structur calcul nqpath qpath coulomb pseudopotenti paramet mustar anaddbelphflag flag turn calcul electron phonon quantiti first quantiti calcul phonon linewidth along path reciproc space exactli like band structur tutori tutorialbas path specifi variabl anaddbqpath give apex path reciproc space usual special point high symmetri number point given anaddbnqpath note qpath use normal phonon band structur calcul well provid anaddbqphl omit input file latter overrid qpath phonon linewidth print file suffix _lwd phonon band structur shown alreadi stabl xx kpoint grid phonon band structur aleph_assetsal_phonon_bspng phonon linewidth proport electron phonon coupl still depend phonon wavevector q electronphonon calcul present implement anaddb particular superconduct determin isotrop quantiti averag fermi surfac sum qpoint integr coupl reciproc space keep resolut phonon mode energi one calcul eliashberg spectral function alphaf alphaf function similar densiti state phonon weight accord coupl phonon electron output file suffix _af readi repres use graphic softwar xmgrace matlab opendx first invers moment alphaf give global coupl strength mass renorm factor lambda lambda use citemcmillanmcmillan formula modifi citeallenallen dyne anaddb calcul critic temperatur superconduct formula contain adjust paramet mustar approxim effect coulomb interact given input variabl anaddbmustar al kpoint grid given valu mustar anaddb output file show follow valu mkaf lambda omega e mkaf lambda omega e mkaf lambda omega e mkaf lambda omega e mkaf isotrop lambda e mkaf omegalog e ha e kelvin mkaf input mustar e mkaf macmillan tc e ha e kelvin could expect bad estim experiment valu k coupl strength sever underestim experi give logarithm averag frequenc bit high converg valu k citesavrasovsavrasov result critic temperatur mcmillan formula unphys alway regard critic lambda close lower chosen valu mustar t_c diverg aluminum good case thing improv easili fermi surfac larg isotrop coupl weak converg test integr techniqu section use default method integr fermi surfac employ smear do attribut gaussian weight kpoint function distanc fermi surfac anoth effici method integr kspace tetrahedron method also implement anaddb use set anaddbtelphint case kpoint grid must specifi explicitli input repeat variabl anaddbkptrlatt abinit output anaddb reconstruct differ tetrahedra fill reciproc unit cell gaussian case width smear control use input variabl anaddbelphsmear test calcul redon denser kpoint grid denser qpoint grid result alphaf lambda converg valu anaddbelphsmear also check make sure affect result normal limit small anaddbelphsmear dens kpoint grid valu obtain tetrahedron method usual converg sparser kpoint grid edit input file abi_teststutorespfninputteph_abi see main differ teph_abi choic tetrahedron integr method dialog teststutorespfninputteph_abi alreadi level see increas accuraci isotrop lambda valu around macmillan t_c kelvin much realist patient save output _lwd _af file run full tutori denser kpoint grid say xx abl observ differ converg al alphaf function relat quantiti converg minim kpoint grid xx transport quantiti within boltzmann theori electronphonon interact also respons resist normal metal relat phenomena even perfect crystal interact phonon limit electron life time vice versa calcul fairli simpli use boltzmann theori transport first order scatter phonon see eg citezimanelectron phonon ziman addit ingredi need calcul transport quantiti electr resist heat conduct limit electronphonon coupl fermi veloc ie group veloc wavepacket electron place fermi surfac true veloc charg move displac fermi sphere littl bit k space see eg citeashcroftashcroft mermin veloc relat simpli commut posit also use dielectr respons use ddk calcul see first dfpt tutori dfpttutorialrf phonon calcul gamma need includ electr field metal effect phonon neglig need addit dataset calcul ddk file along primit direct unit cell precis elph matrix element need perturb wavefunct perturb eigenvalu calcul ddk deriv prtgkk set output file name _gkkxx xx natom natom contain matrix element ddk perturb basic first part normal ddk file e field perturb without wave function coeffici anaddb input must specifi ddk file anaddb calcul fermi veloc variabl ddk_filepath point small file list ddk file use whose content case teph__ds_gkk teph__ds_gkk teph__ds_gkk abinit input file teph_abi alreadi obtain ddk file addit dataset ds follow line teph_abi tolwfr iqpt rfphon rfelfd prtwf copi addit ddk file teststutorespfninput directori run anaddb input teph_abi ad teph_abi follow line ifltransport ep_keepband see dialog teststutorespfninputteph_abi produc number addit file _af_tr contain equival eliashberg spectral function fermi speed factor mani phonon given energi much coupl electron fast electron go integr appropri function phonon energi one get resist function temperatur teph_out_ep_rho figur thermal conduct function temperatur teph_out_ep_wth electron contribut still miss phononphonon interact limit factor thermal conduct beyond k metal even higher temperatur electron often domin contain degre freedom resist al function teph_assetsteph__rhopng high behavior necessarili linear includ first order ep coupl neglect variat gkk fermi surfac inset show low behavior simpl polynomi textbook model see citeashcroftashcroft mermin see citesavrasovsavrasov paper refer valu simpl metal use well converg k q point grid miss factor bad given crude grid final note _rho _wth file contain seri tensor compon resist tensor x current respons along appli electr field along x mani system tensor diagon symmetri valu offdiagon term give estim symmetr error tini similarli differ diagon term due numer converg permil visibl figur green red line yy xx compon author xg rc first tutori hsubsub molecul without converg studi tutori aim show get follow physic properti pseudo total energi bond length charg densiti atomis energi learn two input file basic input variabl exist default action parser use multidataset featur also learn two output file well densiti file first tutori cover first section helpabinit first step detail tour input output file like tourist discov town coach bit freedom first step suppos good knowledg unixlinux visualis tool cover basic abinit tutori power visualis procedur develop abipi context reli matplotlib see readm abipyhttpsgithubcomabinitabipi abipi tutorialshttpsgithubcomabinitabitutori tutori take hour tutorial_readm comput pseudo total energi associ quantiti tutori one need work directori creat work subdirectori insid abi_teststutori eg command sh cd abi_teststutorialinput mkdir work abinitteststutorialinputwork cd work action tutori work directori let us run code tip helpabinitintrosect abinit help file explain run abinit might read follow command hereaft copi abi_teststutorialinputtbase_abi work cp tbase_abi later look file learn content tri run code work directori type abinit tbase_abi log wait second done look content work directori ls command get someth like sh ls log tbase_o_ddb tbase_o_eig tbase_o_outnc tbase_abi tbase_o_den tbase_o_eignc tbase_o_wfk tbase_abo tbase_o_ebandsagr tbase_o_gsrnc differ output file creat includ log file output file tbase_abo check everyth correct make diff tbase_abo refer file abi_teststutorialrefstbase_abo sh diff tbase_abo refstbase_abo less refer file use slightli differ file name get differ rather inoffens one like differ name input file slightli differ numer result time differ eg diff c version abinit mpi version prepar x__darwin_gnu comput version abinit mpi version prepar x__linux_gnu comput c start date mon jan h start date wed dec h c input file tbase_abi output file tbase_abo input file homebuildbotabinitalps_gnu__serialtrunk_beautyteststestbot_mpitutorial_tbase_tbase_abi output file tbase_abo c pspini atom type psp file usersgonze_researchabinit_gitbeautytestspsps_for_testspseudodojo_nc_sr__pw_standard_psphpsp pspatm open atom psp file usersgonze_researchabinit_gitbeautytestspsps_for_testspseudodojo_nc_sr__pw_standard_psphpsp pspini atom type psp file homebuildbotabinitalps_gnu__openmpitrunk_beautytestspsps_for_testspseudodojo_nc_sr__pw_standard_psphpsp pspatm open atom psp file homebuildbotabinitalps_gnu__openmpitrunk_beautytestspsps_for_testspseudodojo_nc_sr__pw_standard_psphpsp c c kinet e hartre e xc e kinet e hartre e xc e c band_energi e band_energi e c total cpu time smh total cpu time smh c run pc linux gnu fortran compil eg intel compil might also small numer differ order might also differ path file final might also default fft algorithm differ one refer machin case line mention fftalg differ fftalg get someth els ask help quick look begin output file tbase_abo part output file note dot dash insert first column import user use postprocess output file use automat tool rule ignor symbol place first column abinit output file suppos everyth went well detail differ step took place run code tbase_abi input file later tbase_abo log output file tip read pleas read helpabinitintrosect abinit help file time edit tbase_abi input file dialog teststutorialinputtbase_abi first glanc long line mostli comment tri understand everyth immedi gone read gener explan content format input file helpabinitinputsect abinit help file might examin detail input variabl alphabet order varsetallvarsindex variabl provid descript found differ file nonexhaust list varsetbasicbas variabl varsetfilesfil handl variabl varsetgstategroundst calcul variabl varsetgwgw variabl varsetparalparallelis variabl varsetdfptdens function perturb theori dfpt variabl howev number variabl rather larg note dozen input variabl need run first test case possibl default valu input variabl exist default valu mention fourth line section relat input variabl input variabl also preprocess order deriv conveni valu input variabl default exist avoid input variabl find tbase_abi particularli import input variabl take minut look input variabl tbase_abi acel ntypat znucl pp_dirpath pseudo natom typat xcart ecut nkpt nstep toldf diemac also look kpt iscf time look two output file run first open log file begin read nasti jump end twenti line end find number warn comment issu code execut might tri find file local keyword warn comment file experienc user present time ignor find inform messag log file helpabinitlogfilethi section abinit help file tip abipi instal machin use abiopen script extract messag abinit log file syntax abiopenpi log p get event found usersgonze_researchabinit_gitbeautyteststutorialinputworklog abinitcom m_dtfilf output file tbase_abo alreadi exist abinitcom m_dtfilf renam old tbase_abo tbase_abo abinitwarn m_ingeof toler symmetri e bigger e order avoid spuriou effect atom coordin symmetr store dataset intern variabl surpris fact input variabl xcart xred correspond one echo abinit latter use calcul order avoid symmetr eg specif debuggingdevelop decreas tolsym e lower abinitcom m_symfindf bravai lattic determin primit vector bravai symmetr real one iholohedri obtain take account atom posit start deform primit vector set abinitcom m_memevalf despit local part pseudopotenti lmnmax lnmax set abinitcom m_xgscalapackf xgscalapack auto mode abinitcom m_memevalf despit local part pseudopotenti lmnmax lnmax set abinitwarn m_drivexcf densiti went small lower xc_denpo point set xc_denpo e lowest e might due low boxcut low ecut pseudopotenti core charg low ecut estim initi densiti possibl workaround increas ecut defin input variabl densti valu larger guess decay length initi densiti preliminari lda ggapb use exot xc function num_error num_warn num_com complet true open tbase_abo file altern might look refer file provid dialog teststutorialrefstbase_abo find gener inform output file helpabinitoutputfileher also examin header tbase_abo examin report memori need read valu paramet examin echo preprocess input data reach messag chkinp check input paramet consist code stop input paramet consist stage mani default valu provid preprocess finish worth come back echo preprocess input data first examin tbase_abi file detail read mean variabl correspond input variabl file yet done examin variabl defin input file appear echo written tbase_abo search nband valu number electron state treat code comput count number valenc electron unit cell sum valenc electron brought pseudopotenti occupi lowest state look occ variabl ad state least one mayb depend size system ngfft valu number point threedimension fft grid deriv ecut dimens cell acel mpw maxim number plane wave mpw mention memori evalu section well complet right code took advantag timerevers symmetri valid kpoint decreas number planewav factor two full set plane wave search npw tbase_abo file code indic timerevers symmetri valu istwfk instead default istwfk nsym number symmetri system valu x matric symrel defin symmetri oper case none symmetri accompani translat would appear variabl tnon code automat analysi symmetri could altern set hand use symmetri builder describ later xred altern xcart specifi posit atom within primit cell start read descript remain tbase_abo file helpabinitmoreonthemainoutputfilesect abinit help file look tbase_abo file time read complet output file could answer follow question might numer differ platform platform quot result note q mani scf cycl need toldf criterion satisfi scf cycl need iter etothartre deltaeh residm vre etot e e e etot e e e etot e e e etot e e e etot e e e etot e e e scf step etot converg second time diff etot e toldf e note number step allow nstep larger number step effect need reach stop criterion rule alway check number step allow suffici reach target toler might play bit nstep eg set see abinit react side note tutori exampl nstep enough reach target toler defin one tolxxx input variabl howev alway case eg test case tutori dfpttutorialrf portabl problem could solv stop scf cycl requir toler note q energi like converg toldf inform contain piec output file ye energi converg toldf sinc stop criterion ask differ success evalu energi smaller toldf twice row evolut energi nice alway decreas smaller smaller amount note q valu forc atom habohr valu cartesian_forc hartreebohr e e e e e e force_length_stat min e max e mean e first atom locat cartesian coordin bohr forc vector point x direct x direct second atom locat h_ molecul would like expand note q differ eigenenergi two electron state eigenvalu hartre mention line eigenvalu hartre nkpt k point kpt nband wtk kpt reduc coord mention helpabinitaveragepotabinit help file absolut valu eigenenergi meaning differ eigenenergi well differ potenti differ hartre ev moreov rememb kohnsham eigenenergi formal connect experiment excit energi well said later gw tutori note q set prtvol input file run abinit find locat maximum electron densiti much electronsbohr maximum electron densiti electron per bohr cube reach midpoint two h atom total charg densiti elbohr maximum e reduc coord tip abipi instal machin use abiopen script expos option visual scf cycl main output file abiopenpi tbase_abo expos seaborn base_assetsabiopen_tbase_png info pleas consult jupyt notebookhttpsnbviewerjupyterorggithubabinitabitutorialsblobmasterabitutorialsbaselesson_baseipynb reformul present tutori use abipi comput interatom distanc method start everi time new input variabl mention read correspond descript section helpabinitaveragepotabinit help file complet descript mean term still indic awar even use tutori might appear descript input variabl read helpabinitparameterssect abinit help file three methodolog comput optim distanc two hydrogen atom one could comput total energi differ valu interatom distanc make fit differ point determin minimum fit function comput forc differ valu interatom distanc make fit differ valu determin zero fit function use automat algorithm minim energi find zero forc begin comput energi forc differ valu interatom distanc exercis allow learn use multipl dataset interatom distanc tbase_abi file bohr suppos decid examin interatom distanc bohr bohr step bohr calcul unix guru easi write script drive calcul chang automat variabl xcart input file gather data conveni form plot well unix guru easier path within abinit multidataset mode detail explan found section helpabinitmultidataset helpabinitseri helpabinitloop helpabinitfilenamesmultidataset abinit help file write input file comput describ interatom distanc bohr bohr step bohr might start tbase_abi tri defin seri use getwfk input variabl latter make comput much faster like look section describ irdwfk getwfk input variabl particular look mean getwfk also defin explicitli number state supercel band one use input variabl nband input file abi_teststutorialinputtbase_abi exampl file job dialog teststutorialinputtbase_abi abi_teststutorialrefstbase_abo refer output file dialog teststutorialrefstbase_abo run code tbase_abi might take fifteen second pc ghz sh cp tbase_abi abinit tbase_abi log examin output file quickli mani repetit section differ dataset get output energi gather final echo variabl etot e etot e etot e etot e etot e etot e etot e etot e etot e etot e etot e etot e etot e etot e etot e etot e etot e etot e etot e etot e etot e might tri plot data eo plotbase_assetsplotpng minimum energi list clearli dataset xcart e e e e e e xcart e e e e e e correspond distanc h atom bohr bohr forc chang sign also dataset fcart e e e e e e fcart e e e e e e two valu use linear interpol one get optim valu bohr note number scf cycl drop wavefunct read previou dataset comput interatom distanc method methodolog base automat comput minimum differ algorithm see input variabl ionmov valu present case one degre freedom optim best choic ionmov also defin maxim number time step optim set input variabl ntime larg enough stop criterion tolmxf use reason valu habohr defin forc threshold consid geometri converg code stop residu forc valu reach ntime also worth chang stop criterion scf cycl order sure forc gener trial interatom distanc suffici converg inde valu use toldf name might suffici total energi calcul definit accur comput properti chang toldf tolrff set latter input variabl input file tbase_abi exampl file job dialog teststutorialinputtbase_abi tbase_abo exampl output file dialog teststutorialrefstbase_abo run code input file second examin quietli file much smaller tbase_abo file get signific output data gather final echo variabl etot e fcart e e e e e e xcart e e e e e e accord data see xcart optim interatom distanc bohr good agreement estim tbase_abo time done home might tri chang stop criteria redo calcul see level converg interatom distanc note final valu fcart run might differ slightli one shown less one percent chang fluctuat quit often observ valu converg zero rememb ask code determin equilibrium geometri forc zero comput done differ platform tip abipi analyz easili result structur relax abiopen script abiopenpi tbase_o_histnc expos seaborn base_assetsabiopen_tbase_o_histpng comput charg densiti charg densiti alreadi comput geometri abovement run print quantiti start optim interatom distanc bohr make run fix geometri input variabl prtden must set understand correctli content prtden descript worth read much detail descript file name abinit helpabinit_file_names_in_abinitsect abinit_help file input file tbase_abi exampl input file run print densiti dialog teststutorialinputtbase_abi run take second densiti output tbase_o_den file tri edit luck file unformat written use ascii code even read descript provid abinit help file contain first header densiti number descript header present helpabinitheadersect abinit_help file bodi _den file present helpabinitdenfilesect appropri time read also descript potenti file wavefunct file file contain header densiti file see section helpabinitlocalpotfil helpabinitwfkfil densiti file read abinit restart calcul see input variabl iscf valu usual util call cutd util avail abinit packag might tri use gener twodimension cut densiti visual charg densiti contour read correspond helpcutdcutd help file tri run cutd analys tbase_o_den first tri translat unformat densiti data index format data use option adequ menu save index format data file tbase_xo_den_index edit file idea content _den file treatment might choos select anoth option particular access matlab choos option minor modif set ngxngyngz abl use file dimmbase_assetsdimm visual dimension isosurfac anoth option might use xcrysden softwar need use option densiti file netcdf format possibl use abipi export data differ format invok extern graphic tool exampl densiti isosurfac produc vesta discuss jupyt notebookhttpsnbviewerjupyterorggithubabinitabitutorialsblobmasterabitutorialsbaselesson_baseipynbanalysisofthechargedens httpsgithubcomabinitabipy_assetsblobmasterh_densitypngrawtru comput atomis energi atomis energi energi need separ molecul constitu atom neutral present case one must comput first total energi isol hydrogen atom atomis energi differ total energi h_ twice total energi h subtleti calcul isol atom mani case ground state isol atom spinpolar see variabl nsppol spinat highest occupi level might degener lowest unoccupi level spin case techniqu usual appropri metal use see tutori tutorialbas also often symmetri groundstat charg densiti spheric automat determin symmetri code base atom coordin disabl see input variabl nsym set case hydrogen lucki ground state spheric orbit highest occupi level lowest unoccupi level although degener differ spin defin hand occup spin see input variabl occopt set occ final order make numer error cancel import comput abovement differ box energi cutoff even locat box similar molecul case although latter might import input file tbase_abi exampl file job dialog teststutorialinputtbase_abi tbase_abo exampl output file dialog teststutorialrefstbase_abo run last second read output file note tini differ relat spinpolaris electron eigenvalu given spin spin case eigenvalu hartre nkpt k point spin kpt nband wtk kpt reduc coord eigenvalu hartre nkpt k point spin kpt nband wtk kpt reduc coord prtvol charg densiti sever point maximum minimum echo also spin polaris valu nspden occopt total charg densiti elbohr maximum e reduc coord next maximum e reduc coord minimum e reduc coord next minimum e reduc coord integr e spin densiti elbohr maximum e reduc coord next maximum e reduc coord minimum e reduc coord next minimum e reduc coord integr e spin densiti elbohr maximum e reduc coord next maximum e reduc coord minimum e reduc coord next minimum e reduc coord integr e magnet spin spin elbohr maximum e reduc coord next maximum e reduc coord minimum e reduc coord next minimum e reduc coord integr e rel magnet zeta maximum e reduc coord next maximum e reduc coord minimum e reduc coord next minimum e reduc coord zeta variabl ratio spindens differ charg densiti vari present case hydrogen spin densiti zeta variabl total energi etot e total energi h_ molecul see test etot e atomis energi thu ha differ total energi h_ molecul twice energi isol hydrogen atom stage compar result bond length bohr atomis energi bond length ha ev experiment data well theoret data use much accur techniqu see citekolo especi p bond length bohr atomis energi ev result experi bond length bohr atomis energi ev bond length rather bad atomis energi bit low wrong well sure input paramet discuss correct ecut planewav kinet energi cutoff acel supercel size pseudopotenti ixc even mention input variabl specifi kind exchangecorrel function use default deduc pseudopotenti choic exchangecorrel function mandatori produc pseudopotenti mix differ exchangecorrel function pseudopotenti gener abinit calcul bad practic use ha cutoff energi xx bohr supercel lda localdens approxim well localspindens approxim spinpolar case perdewwang parametr ixc lda pseudopotenti pseudodojo httpwwwpseudodojoorg copi abinit directori abi_pspdirpseudodojo_nc_sr__pw_standard_psp might look file abi_pspdirpseudodojo_nc_sr__pw_standard_pspreadmemd learn pseudopotenti see next tutorialtutorialbas address choic paramet except pseudopotenti author fbrunev xg second tutori gw treatment metal tutori aim show obtain selfenergi correct dft kohnsham eigenvalu within gw approxim metal case without use plasmonpol model band width fermi energi aluminum comput user may read paper f brunev n vast l rein phi rev b citebrunev inform result gw treatment aluminum also find analysi effect selfconsist quasiparticl solid present tutori howev avail abinit descript contour deform techniqu bypass use plasmonpol model calcul frequenc convolut g w found lebegu arnaud alouani p bloechl phi rev b citelebegu relev formula brief descript equat implement code found theorymbtgw note also suggest acknowledg effort develop gw part abinit cite citegonz abinit public user familiar four basic tutori abinit see tutori indextutori well first gw tutorialtutorialgw visualis tool cover tutori power visualis procedur develop abipi context reli matplotlib see readm file abipyhttpsgithubcomabinitabipi abipi tutorialshttpsgithubcomabinitabitutori tutori take one hour complet also includ read citebrunev citelebegu tutorial_readm preliminari kohnsham band structur calcul begin might consid work differ subdirectori tutori work_gw basic tutori tutorialbas comput differ properti aluminum within dftlda unlik silicon approxim outstand problem comput band structur nevertheless see agreement band structur experi improv significantli one use gw approxim directori work_gw copi file tgw_abi locat abi_teststutorialinput sh mkdir work_gw cd work_gw cp abi_teststutorialinputtgw_abi issu abinit tgw_abi tgw_log err dialog teststutorialinputtgw_abi run gener wfk file subsequ gw comput also provid band width aluminum note simpl fermidirac smear function use occopt larg smear tsmear ha kpoint grid quit rough unshift xx monkhorstpack grid kpoint full brillouin zone fold kpoint irreduc wedg ngkpt converg result would need xx grid shift kpoint full brillouin zone grid contain gamma point valenc band structur reach minimum output file present fermi energi fermi homo energi ev averag vxc ev well lowest energi gamma point eigenvalu ev nkpt k point kpt nband wtk kpt reduc coord occupi band width ev within pbe compar experiment valu ev see refer citebrunev calcul screen file let run calcul screen file immedi copi file tgw_abi also copi wfk file tgw_o_wfk tgw_i_wfk run calcul take second sh cp abi_teststutorialinputtgw_abi cp tgw_o_wfk tgw_i_wfk abinit tgw_abi log dialog teststutorialinputtgw_abi consid start gw calcul howev unlik case silicon previou gw tutori focuss quantiti close fermi energi span rang ev need consid much wider rang energi bottom valenc band lie around ev fermi level unfortun energi order magnitud plasmon excit rough evalu classic plasma frequenc homogen electron ga densiti equal averag valenc densiti aluminum ev henc use plasmonpol model may realli appropri follow comput gw band structur without plasmonpol model perform numer frequenc convolut practic conveni extend function frequenc full complex plane make use residu theorem integr path deform one transform integr along real axi integr along imaginari axi plu residu enclos new contour integr method extens describ citelebegu examin input file tgw_abi dialog teststutorialinputtgw_abi ten first line contain import inform find input variabl alreadi familiar like optdriv ecutep also new input variabl gwcalctyp nfreqim nfreqr freqremax purpos run simpli gener screen matric unlik plasmonpol model one need comput mani differ frequenc purpos new input variabl main variabl gwcalctyp set order specifi _non_ plasmonpol model calcul note number frequenc along imaginari axi govern nfreqim chosen quit small sinc function smooth direct contrast number frequenc need along real axi set variabl nfreqr usual larger find fermi energi bottom valenc band let run calcul band width immedi well studi input file get file tgw_abi sh cp abi_teststutorialinputtgw_abi cp tgw_o_wfk tgw_i_wfk cp tgw_o_scr tgw_i_scr abinit tgw_abi log comput gw quasiparticl energi gamma point aluminum differ one quasiparticl silicon howev determin fermi energi rais complet new problem one sampl whole brillouin zone get new energi quasiparticl energi determin fermi energi actual first step toward selfconsist examin input file tgw_abi dialog teststutorialinputtgw_abi first thirti line contain import inform find input variabl valu alreadi familiar like optdriv ecutsigx ecutwfn come input variabl gwcalctyp valu _x_ correspond contour integr valu _x_ correspond selfconsist calcul updat energi one find list k point band quasiparticl correct comput nkptgw kptgw bdgw number list kpoint simpli nkpt kpt one might specifi less kpoint though need updat list band rang bdgw gener basi dftlda eigenenergi consid band vicin fermi level band much much like remain much much fermi region present run interest state may cross fermi level go dft gw cours would easier select homogen rang whole brillouin zone eg would timeconsum output file one find quasiparticl energi gamma lowest band yaml selfenergy_e iteration_st dtset kpoint spin ks_gap qp_gap delta_qp_k data sigmaeedata band e_dft vxcdft en hhartre sigx sigcen z dsigcd sigen delta en_pert en_diago last column relev quantiti updat fermi energi also mention text new fermi energi e ha e ev last inform print case gwcalctyp lower combin quasiparticl energi gamma fermi energi give band width ev rememb experiment valu around ev comput gw spectral function plasmon satellit aluminum access nonplasmonpolemodel selfenergi real imaginari part addit benefit eg accur spectral function comput see citelebegu may interest see plasmon satellit aluminum account within gw approxim rememb spectral function proport multipl matrix element spectrum measur photoemiss spectroscopi pe pe photon imping sampl extract electron materi differ energi incom photon obtain electron give bind energi electron solid word quasiparticl energi band structur simpl metal addit process take place easili imping photon extract electron togeth global charg oscil sampl extract electron kinet energi lower direct process part energi gone plasmon electron appear larger bind energi see spectral function aluminum consist main peak correspond quasiparticl excit addit peak correspond quasiparticl plasmon excit togeth let run calcul immedi sh cp abi_teststutorialinputtgw_abi cp tgw_o_wfk tgw_i_wfk cp tgw_o_scr tgw_i_scr abinit tgw_abi log dialog teststutorialinputtgw_abi compar previou file tgw_abi input file contain two addit keyword nfreqsp freqspmax also comput gw selfenergi done gamma point spectral function written file tgw_o_sig simpl text file contain function frequenc ev real part selfenergi imaginari part selfenergi spectral function visual use prefer softwar instanc start gnuplot issu gnuplot p tgw_o_sig u w l abl distinguish main quasiparticl peak locat gw energi ev addit featur vicin gw eigenvalu minu plasmon energi ev ev ev tip abipi instal machin use abiopen script expos option visual result abiopenpi tgw_o_sigresnc e sn gw_assetsal_spectra_b_gammapng anoth file tgw_o_gw worth mention contain inform use subsequ calcul exciton effect within bethesalpet equat abinit code etsf softwar pagehttpwwwetsfeuresourcessoftwarecod author xg rc third tutori crystallin silicon tutori aim show get follow physic properti insul total energi lattic paramet band structur actual kohnsham band structur learn use kpoint well smear planewav kinet energi cutoff visualis tool cover tutori power visualis procedur develop abipi context reli matplotlib see readm abipyhttpsgithubcomabinitabipi abipi tutorialshttpsgithubcomabinitabitutori tutori take hour tutorial_readm comput total energi silicon fix number kpoint begin might consid work differ subdirectori tutori work follow command move work directori creat work directori move directori lessonbasefirst lessonbasesecond tutori copi file tbase_abi insid work directori command sh cd abi_teststutorialinput mkdir work cd work cp tbase_abi input file dialog teststutorialinputtbase_abi edit read care look follow new input variabl explan rprim xred use instead xcart kptopt ngkpt nshiftk shiftk kptrlatt easi take time diemac differ valu use variabl compar previou calcul isol molecul consid note also follow work fix ecut ha implicit real life converg test respect ecut suitabl ecut given correspond suggest ecut pseudopotenti accord pseudodojo websitehttpwwwpseudodojoorg silicon pseudopotenti taken relax lattic paramet result lattic paramet experiment valu read input file run code usual abinit tbase_abi log err read output file note total energi etot e start converg studi respect kpoint cours converg studi associ sampl brillouin zone examin differ grid increas resolut might tri follow seri grid ngkpt ngkpt ngkpt ngkpt howev associ number kpoint irreduc brillouin zone grow fast nkpt nkpt nkpt nkpt abinit comput automat number kpoint definit grid symmetri might nevertheless defin input nkpt valu input file case code compar comput valu grid input valu take opportun examin behaviour abinit problem detect let us suppos ngkpt one mention nkpt input file tbase_abi exampl dialog teststutorialinputtbase_abi messag get dozen line end log file yaml bug src_file m_kptsf src_line mpi_rank messag argument nkpt match number k point gener kptopt kptrlatt shiftk eventu symmetri nkpt howev note might due user nkpt explicit defin input file case pleas check input file action contact abinit group pleas attach output abinit b typic abinit error messag state problem caus code stop suggest might due error input file name erron valu nkpt expect valu nkpt mention notic input file might erron file problem occur mention well number line file comput nkpt specif grid kpoint easi task even import select specif econom grid best ratio accuraci integr brillouin zone number kpoint difficult help user provid abinit code abl examin automat differ kpoint grid propos best grid integr describ helpabinit see input variabl prtkpt associ characteris integr accuraci describ kptrlen tip gener list kpoint set done differ test case abi_testsv directli look output file abi_testsvref output file test one begin studi new materi strongli advis examin first list kpoint grid select least three effici one kpoint converg studi forget cpu time linearli proport number kpoint treat use kpoint take five time use kpoint even similar accuraci brillouin zone integr say valu kptrlen might grid reduc kpoint irreduc brillouin zone anoth reduc kpoint irreduc brillouin zone latter clearli prefer comput perspect converg studi respect kpoint order understand kpoint grid read citemonkhorst well mayb immedi meantim tri abovement converg studi input file tbase_abi exampl abi_teststutorialrefstbase_abo refer output file sh cd abi_teststutorialwork cp tbase_abi dialog teststutorialinputtbase_abi teststutorialrefstbase_abo output file look echo input variabl know preprocess particular ngkpt shiftk use gener list kpoint kpt weight wtk read inform kpt wtk output file evolut total energi differ kpoint grid etot e etot e etot e etot e differ dataset dataset rather small even dataset give accuraci ha converg valu total energi fix acel fix ecut ha determin lattic paramet input variabl optcel govern automat optimis cell shape volum automat optimis cell volum cubic crystal use optcel ionmov ntime dilatmx ecutsm read indic optcel dilatmx ecutsm particular optcel adequ cubic crystal major materi optim geometri must includ deform cell shape simpli global rescal usual valu optcel use test kpoint grid nkpt input file abi_teststutorialinputtbase_abi exampl dialog teststutorialinputtbase_abi abi_teststutorialrefstbase_abo refer output file dialog teststutorialrefstbase_abo obtain follow evolut lattic paramet acel e e e bohr acel e e e bohr follow small residu stress strten e e e e e e strten e e e e e e stress tensor given hartreebohrsupsup order compon rel differ acel acel converg lda valu silicon sipsp pseudopotenti pseudodojo websitehttpwwwpseudodojoorg bohr angstrom experiment valu angstrom degre celsiu see rwg wyckoff crystal structur ed wiley son newyork nist databasehttpsphysicsnistgovcgibincuuvalueasilsearch_forsilicon comput band structur fix paramet acel theoret valu fix also grid kpoint xx fcc grid equival xx monkhorstpack grid ask band valenc conduct band structur comput solv kohnsham equat mani differ kpoint along differ segment brillouin zone potenti enter kohnsham must deriv previou selfconsist calcul vari scan differ kpoint line suppos want make lgammaxugamma circuit least divis segment circuit obtain easili follow choic segment end point l gamma x gamma order enforc least divis segment one use input variabl ndivsm abinit gener roughli distanc point along segment despit segment differ length reciproc space note last gamma point anoth cell reciproc space first one choic allow construct xugamma segment easili kpoint specifi use reduc coordin agreement input set primit atom unit cell standard textbook often find l gamma x point given coordin convent atom cell abovement circuit convent coordin use atom nonconvent cell set input file first dataset usual scf calcul output densiti prtden second dataset fix iscf make nonselfconsist calcul defin getden take output densiti dataset set nband set kptopt defin three segment brillouin zone set ndivsm set kptbound l point gamma point x point gamma point anoth cell set enunit order eigenenergi ev toler criterion admit nonselfconsist calcul tolwfr set suppress toldf nstep paramet set make sure converg reach input file abi_teststutorialinputtbase_abi exampl dialog teststutorialinputtbase_abi abi_teststutorialrefstbase_abo refer output file dialog teststutorialrefstbase_abo find band structur start second dataset eigenvalu ev nkpt k point kpt nband wtk kpt reduc coord kpt nband wtk kpt reduc coord kpt nband wtk kpt reduc coord kpt nband wtk kpt reduc coord one need graphic tool repres data separ file _eig find list kpoint eigenenergi input variabl prteig set default even without graphic tool quick look valu l gamma x gamma kpt nband wtk kpt reduc coord kpt nband wtk kpt reduc coord kpt nband wtk kpt reduc coord kpt nband wtk kpt reduc coord last gamma exactli equival first gamma check top valenc band obtain gamma ev width valenc band ev lowest unoccupi state x ev higher top valenc band gamma si describ indirect band gap materi correct bandgap ev quantit quit wrong experiment valu ev degre celsiu minimum conduct band even slightli displac respect x see kpt underestim band gap wellknown famou dft bandgap problem order obtain correct band gap need go beyond kohnsham densiti function theori use gw approxim describ first gw tutorialtutorialgw experiment data band structur represent see book ml cohen jr chelikowski citecohen import subtleti worth comment nonselfconsist calcul like perform present band structur calcul iscf band converg within toler tolwfr inde two upper band default taken account appli converg criterion constitut buffer number buffer band govern input variabl nbdbuf happen highest two highest band separ gap nontreat band exhibit slow converg rate buffer allow achiev converg import nonbuff band present case band converg residu better tolwfr two upper band less converg still suffici graphic represent band structur order achiev converg band advis use nband use abipi autom bore step abipi packag provid sever tool facilit prepar band structur calcul analysi output result first one use abistruct script kpath command determin highsymmetri kpath file contain structur inform abinit input file netcdf output file etc highsymmetri kpath follow convent describ citesetyawan let tri sh abistructpi kpath tbase_abi abinit structur natom ntypat typat znucl xred acel rprim kpath reduc coordin tolwfr e iscf getden ndivsm kptopt kptbound gamma x w k gamma l u w l k u x visual band structur store gsrnc file use abiopen script command line abiopenpi tbase_o_ds_gsrnc expos snstalk base_assetsabiopen_tbase_o_ds_gsrpng also possibl compar multipl gsr file abicomp script syntax abicomppi gsr tbase_o_ds_gsrnc tbase_o_ds_gsrnc e snstalk produc follow figur base_assetsabicomp_tbase_o_gsr_filespng detail abipi api gsr file pleas consult gsrfilenb author mg zeropoint renorm band gap temperaturedepend band gap tutori explain comput electron selfenergi due phonon obtain zeropoint renorm zpr band gap temperaturedepend band energi within harmon approxim start brief overview manybodi formal context electronphonon eph interact discuss evalu eph selfenergi perform typic converg studi use polar semiconductor mgo exampl detail concern implement given citegonz citeromero addit exampl provid jupyt notebookhttpsnbviewerjupyterorggithubabinitabitutorialsblobmasterabitutorialssigephlesson_sigephipynb explain use abipi autom calcul postprocess result diamond assum user alreadi complet two tutori rftutorialrf rftutorialrf hesh familiar calcul ground state gs respons properti particular phonon born effect charg highfrequ dielectr tensor user read introduct tutori eph codetutorialeph_intro run exampl lesson take hour formal electronphonon selfenergi sigmatexteph describ renorm charg electron excit due interact phonon term ad electronelectron ee selfenergi sigmatexte encod manybodi effect induc coulomb interact beyond classic electrostat hartre potenti ee contribut estim use instanc gw approximationtutorialgw tutori mainli interest sigmatexteph temperatur depend semiconductor insul inde temperatur depend electron properti low origin eph interact thermal expans unit cell topic howev wont discuss lesson correct due sigmatexte obvious import well known ks gap comput ldagga systemat underestim compar experiment data nevertheless temperatur depend sigmatexte rather small long kt smaller fundament gap let say kt e_textg stateoftheart abinitio perturb method eph coupl describ within dft expand ks effect potenti second order atom displac vibrat properti comput dfpt citegonz citebaroni note anharmon effect may becom relev high includ present formal eph selfenergi consist two term frequencydepend fanmigd fm selfenergi static hermitian debyewal dw part see eg citegiustino refer therein sigmaephww sigmafmww sigmadwt diagon matrix element fm selfenergi ks basi set given beginequ beginsplit sigmafm_nkkomega sum_mnu int_bz fracdqqomega_bz gkq time left fracn_qnut f_mkkqqeft omega emkq wqnu eta right left fracn_qnut f_mkkqqeft omega emkq wqnu eta right endsplit labeleqfan_selfen endequ f_mkkqqeft n_qnut fermidirac boseeinstein occup function physic temperatur ef fermi level turn depend number electron per unit cell integr perform qqpoint brillouin zone bz volum omega_bz eta posit real infinitesim import mathemat point view one take limit eta rightarrow level implement infinitesim eta replac small finit valu given zcut variabl subject converg studi specif one monitor converg physic properti interest zcut rightarrow number qqpoint rightarrow infti converg studi start valu zcut compar typic phonon frequenc system usual ev smaller note default valu zcut ev valu reason gw calcul ev like larg comput sigmatexteph static dw term involv second order deriv ks potenti respect nuclear displac stateoftheart implement approxim dw contribut beginequ labeleqdw_selfen sigma_nkkdwt sum_qqnu n_qqnut dfracg_mnnudwkk qqee_nkk ee_mkk endequ g_mnnudwkkqq effect matrix element within rigidion approxim express term standard firstord gkq matrix element exploit invari qp energi infinitesim translat citegiustino level implement number band two sum defin nband qqmesh integr specifi eph_ngqpt_fin ddb_ngqpt dfpt potenti interpol list temperatur kelvin initi tmesh sake simplic omit tdepend next equat keep mind howev express sigma involv addit depend physic temperatur import eph code take advantag timerevers spatial symmetri reduc bz integr appropri irreduc wedg textibz_kk defin littl group kkpoint ie set point group oper crystal leav kkpoint invari within reciproc lattic vector gg calcul highsymmetri kkpoint gamma therefor much faster symmetri exploit smaller textibz_k symmetr procedur activ default disabl set symsigma test purpos note symsigma set code perform final averag qp result within degener subspac consequ accident degeneraci wont remov symsigma set note fm dw term converg slowli qqsampl moreov accur comput real part requir inclus larg number empti state order acceler converg nband eph code replac contribut given highenergi state certain band index solut nonselfconsist sternheim equat first state requir methodolog propos citegonz base quasistat approxim phonon frequenc denomin eq refeqfan_selfen neglect frequenc depend sigma approxim valu comput omega enk approxim justifi band suffici high energi respect nkk state must correct sternheim approach requir specif eph_stern getpot_filepath paramet correspond nband input variabl obvious larger number band store wfk file code abort condit fulfil quasiparticl correct due eph coupl strictli speak quasiparticl qp excit defin solut complex plane equat z ee_nk sigma_nktextephz provid nondiagon compon eph selfenergi neglect practic problem usual simplifi seek approxim solut along real axi follow two differ approach onthemassshel linear qp equat onthemassshel approxim qp energi simpli given real part selfenergi evalu bare ks eigenvalu eeqp_nk ee_nk sigma_nktextephee_nk approach equival thermal averag rayleighschroding perturb theori linear qp equat contrari selfenergi taylorexpand around bare ks eigenvalu qp correct obtain use eeqp_nk ee_nk z_nkre sigmatexteph_nkee_nk renorm factor z_nk given z_nk left releft fracpartialsigmatexteph_nkpartialeerightbigg_eeee_nk right note z_nk approxim equal area qp peak spectral function a_nkww dfracpi im g_nkomega dfracpi dfracim sigma_nkww ww ee_nk sigma_nkww im sigma_nkww sinc a_nkww integr valu z_nk rang usual indic presenc welldefin qp excit may accompani background possibl addit satellit valu z_nk greater one clearli unphys signal breakdown linear qp equat interpret result requir care analysi a_nkww andor addit converg test import approach implement abinit although note accord recent work onthemassshel approach provid result closer obtain advanc techniqu base cumul expans citeneri zpr excit energi defin differ qp energi evalu bare ks energi similar way one defin zpr gap differ qp band gap ks gap worth stress eph code comput qp correct nk state present input wfk file similar requir present gw code well consequ kkmesh ngkpt nshiftk shiftk wfk file chosen care especi band edg locat highsymmetri kkpoint note differ approach one use specifi set nk state sigma_nk approach pro con direct way consist specifi kkpoint band rang use three variabl nkptgw kptgw bdgw instanc order comput correct vbmcbm gamma silicon nonmagnet semiconductor valenc electron per unit cell one would use sh nkptgw kptgw nkptgw array bdgw nkptgw array give initi last band index nkptgw kpoint index valenc band given obvious input file provid zpr direct gap si indirect fundament gap flexibl approach requir specif three variabl obvious one know posit cbmvbm altern one use gw_qprang sigma_erang although sigma_erang usual employ transport calcul eph_task note gw_qprang mainli use comput correct occupi state plu conduct state import symsigma set default code may decid enlarg initi valu bdgw degener state particular kkpoint includ calcul typic workflow zpr typic workflow zpr calcul involv follow step see introductori eph tutorialtutorialeph_intro gs calcul obtain wfk den file kkmesh dens enough converg electron vibrat properti rememb set prtpot produc file ks potenti requir sternheim method dfpt calcul ibz qqpoint correspond abinitio ddb_ngqpt mesh use perform fourier interpol dynam matrix dfpt potenti simplest case one use qqmesh equal gs kkmesh submesh also fine dfpt calcul directli start wfk produc step rememb comput bmepsiloninfti bmz polar materi dynam quadrupol bmq quantiti need accur interpol phonon frequenc dfpt potenti nscf comput wfk file much denser kkmesh contain wavevector phononinduc qp correct want nscf run use den file produc step rememb comput enough empti state possibl perform converg studi wrt nband afterward merg partial ddb pot file mrgddb mrgdvdb respect start ddbdvdb file produc step wfk file obtain step perform zpr calcul eph_task get start tutorial_readm begin might consid work differ subdirectori tutori creat work_ephzpr abi_teststutorespfninput sh cd abi_teststutorespfninput mkdir work_ephzpr cd work_ephzpr tutori prefer focu use eph code henc use precomput ddb dfpt pot file bypass dfpt part also provid dennc file initi nscf calcul pot file gs ks potenti requir solv sternheim equat git instal machin one easili fetch entir repositori mb sh git clone httpsgithubcomabinitmgo_eph_zprgit altern use wget sh wget httpsgithubcomabinitmgo_eph_zprarchivemasterzip curl sh curl l httpsgithubcomabinitmgo_eph_zprarchivemasterzip masterzip simpli copi tarbal click download button avail github web page unzip file renam directori sh unzip masterzip mv mgo_eph_zprmast mgo_eph_zpr warn directori precomput file must locat work directori execut tutori must name mgo_eph_zpr abipi script use execut dfpt part avail herehttpsgithubcomabinitmgo_eph_zprblobmasterrun_zpr_mgopi note sever paramet tune reach reason compromis accuraci comput cost expect result obtain end lesson fulli converg specif use normconserv pseudopotenti cutoff energi ecut ha low ha dfpt comput done set irreduc qqpoint correspond gammacent xx qq mesh coars bmz bmeeinfti also comput underconverg set sinc abipi support multipl dataset directori correspond singl calcul particular dfpt task atom perturb ddk electr field perturb found insid w directori wtoutdata contain gs result wtoutdata gsr file energi highsymmetri kkpath extract use info output file sinc first tutori use precomput output file worth explain use termin command line util ncdump abitk abipi script extract use inform precomput file move eph calcul first netcdf file produc abinit store input file string format input_str netcdf variabl variabl may use need know input variabl use produc particular output file print valu input_str insid termin use ncdump util syntax sh ncdump v input_str mgo_eph_zprflow_zpr_mgowtoutdataout_dennc input_str jdtset nband ecut ngkpt nshiftk shiftk tolvr e nstep iomod prtpot diemac nbdbuf paral_kgb natom ntypat typat znucl xred acel rprim exampl tutori use new structur input variabl ad version initi unit cell extern file dont need repeat unit cell input file syntax sh structur abifilemgo_eph_zprflow_zpr_mgowtoutdataout_dennc abifil prefix tell abinit lattic paramet atom posit extract abinit binari file eg histnc dennc gsrnc etc format support well see document print crystallin structur termin use abitk fortran execut ship abinit packag crystal_print command md abitk crystal_print mgo_eph_zprflow_zpr_mgowtoutdataout_dennc info cryst object realrrecipg space primit vector cartesian coordin bohrbohr r g r g r g unit cell volum ucvol e bohr angl e e e degre timerevers symmetri present reduc atom posit iatom xred symbol mg crystallin structur use forthcom exampl print info format directli reus abinit input file use abitk crystal_abivar flow_zpr_mgowtoutdataout_dennc sinc want comput renorm band gap due phonon also use look ks gap obtain gs run command md abitk ebands_gap mgo_eph_zprflow_zpr_mgowtoutdataout_dennc direct band gap semiconductor fundament gap ev vbm ev k e e e cbm ev k e e e direct gap ev k e e e abitk command use netcdf file contain ks energi eg gsrnc wfknc warn valu gap consist result mgo given materialsprojecthttpsmaterialsprojectorgmaterialsmp rememb howev valu posit gap may vari some case even significantli depend kksampl case abitk report gap comput kkmesh den file produc scf calcul result mgo correct simpli cbmvbm gamma point point belong gs kkmesh system eg si may cbmvbm wavevector easili captur homogen mesh reliabl approach find locat cbmvbm perform band structur calcul highsymmetri kkpath abitk handi need call fortran routin termin perform basic task fortran best languag come postprocess data analysi kind oper inde much easier implement use highlevel languag python plot band structur use gs eigenvalu store gsrnc file use abiopen script provid abipi e option sh abiopenpi mgo_eph_zprflow_zpr_mgowtoutdataout_gsrnc e ephzpr_assetsmgo_ebandspng figur confirm gap direct gamma point vbm threefold degener soc includ merg partial ddb file mrgddb first let merg partial ddb file command sh mrgddb tephzpr_abi follow input file dialog teststutorespfninputtephzpr_abi list rel path partial ddb file mgo_eph_zpr directori sinc deal polar materi worth check whether final ddb contain born effect charg electron dielectr tensor instead run anaddb abinit check output file simpli use abiopen p option sh abiopenpi mgo_eph_zprflow_zpr_mgowoutdataout_ddb p ddb info number qpoint ddb guessed_ngqpt guess qmesh divis made abipi ecut ecutsm nkpt nsym usepaw nsppol nspinor nspden ixc occopt tsmear total energi fals forc fals stress tensor fals least one atom pertub true least one diagon electricfield perturb true least one born effect charg true strain term fals intern strain term fals piezoelectr term fals also invok anaddb directli python quick look phonon dispers text abiviewpi ddb mgo_eph_zprflow_zpr_mgowoutdataout_ddb comput phonon band do ddb file nqsmall ndivsm asr chneut dipdip lo_to_split automat dos_method tetra produc follow figur ephzpr_assetsabiviewpng result seem reason acoust mode go zero linearli qq rightarrow deal system instabl present phonon dispers show loto split typic polar materi note howev acoust sumrul automat enforc code alway good idea compar result withwithout asr indirect indic convergencereli calcul autom process ddb_asr command abiview text abiviewpi ddb_asr mgo_eph_zprflow_zpr_mgowoutdataout_ddb produc follow figur ephzpr_assetsmgo_phbands_asrpng import clearli indic break acoust sumrul neglig case break mainli due low cutoff energi employ calcul real life one stop redo dfpt calcul larger ecut possibl denser qqmesh sinc goal lesson teach run zpr calcul ignor seriou problem continu exampl ps want comput phonon band withwithout dipdip use text abiviewpi ddb_dipdip mgo_eph_zprflow_zpr_mgowoutdataout_ddb merg partial pot file mrgdv merg dfpt potenti mrgdv tool use command sh mrgdv tephzpr_abi follow input file dialog teststutorespfninputtephzpr_abi tip number end pot file correspond idir ipert pertub particular qqpoint pertcas index comput fortran pertcas idir ipert idir give direct ipert specifi perturb type ipert natom correspond atom perturb reduc direct ipert natom correspond ddk reduc direct ipert natom correspond electr field ipert natom correspond uniaxi stress cartesian direct ipert natom correspond shear stress cartesian direct dfpt pot file pertcas x natom therefor correspond atom pertub given qqpoint valu pertcas qpt report abinit header print header termin use abitk hdr_print command sh abitk hdr_print mgo_eph_zprflow_zpr_mgowtoutdataout_potnc echo part abinit file header first record codvsnheadformfform second record bantotintxcixcnatom ngfftnkpt nspdennspinor nsppolnsymnpspntypat occoptpertcaseusepaw ecutecutdgecutsm e e e ecut_eff e qptn e e e rprimd e e e rprimd e e e rprimd e e e stmbiastphyseltsmear e e e header contain addit record use prtvol output record discuss detail output file produc mrgdv dialog teststutorespfnrefstephzpr_stdout qqpoint found partial pot file code print list atom perturb merg databas md qpoint e e e present dvdb file list irreduc perturb q vector idir ipert typeindepend foundy idir ipert typesymmetr foundno idir ipert typesymmetr foundno idir ipert typeindepend foundy idir ipert typesymmetr foundno idir ipert typesymmetr foundno term symmetr mean particular idir ipert perturb reconstruct symmetri independ entri qqpoint independ entri avail code print follow messag end output file md independ perturb avail done warn dont get messag dvdb use eph code case check care dfpt input file list pot file merg also note possibl chang valu nsym level eph calcul symmetri automat inherit previou gsdfpt calcul comput wfk file empti state point ingredi ddb dvdb requir computeinterpol eph scatter potenti final start gener wfk file first nscf calcul use xx gammacent kkmesh band perform initi converg studi number empti state selfenergi gener wfk file denser mesh less band use sternheim method note use getden_filepath read dennc file instead getden irdden may run nscf calcul issu sh abinit tephzpr_abi tephzpr_log err input file given dialog teststutorespfninputtephzpr_abi point worth comment use nbdbuf mention document highest energi state requir iter converg avoid wast preciou comput time use buffer nband trick significantli reduc walltim nscf calcul complet first nband nbdbuf state converg within tolwfr obvious one use last nbdbuf state subsequ eph calcul trick highli recommend comput wfk file gw calcul import mobil calcul possibl reduc significantli cost wfk comput restrict nscf calcul kkpoint insid electron hole pocket relev transport unfortun optim possibl comput real part selfenergi integr must perform full textibz_kk hand zpr calcul take advang sternheim method reduc number empti band requir converg first zpr calcul first exampl use minimalist input file discuss import input variabl content main output file first may want start immedi comput issu sh abinit tephzpr_abi tephzpr_log err follow input file dialog teststutorespfninputtephzpr_abi tip run exampl parallel eg mpi process use sh mpirun n abinit tephzpr_abi tephzpr_log err eph code automat distribut workload use predefin distribut scheme necessarili effici term memori walltim last part tutori explain specifi particular mpi distribut scheme eph_np_pqbk input variabl let discuss mean differ variabl detail use optdriv enter eph code eph_task activ comput full selfenergi real imaginari part path extern file ddb wfk dvdb specifi three variabl getddb_filepath getwfk_filepath getdvdb_filepath excerpt input file sh getddb_filepath tephzpr__ddb ddb_ngqpt code expect find ddb ibz qpoint correspond xx qmesh getdvdb_filepath tephzpr__dvdb getwfk_filepath tephzpr_o_wfk xx kmesh band mesh electron ngkpt nshiftk shiftk must correspond one use input wfk file ddb_ngqpt set xx qqmesh use dfpt part gener ddb dvdb file integr qqspace perform eph_ngqpt_fin mesh eph_ngqpt_fin differ ddb_ngqpt code automat activ interpol dfpt potenti discuss introduct eph codetutorialeph_intro qqspace integr defin eph_intmeth zcut default standard quadratur naiv sum qqpoint weight account multipl linear tetrahedron method also implement effici look main output file dialog teststutorespfnrefstephzpr_abo first find section summar import paramet md number band eph selfenergi sum bsum_start bsum_stop symsigma timrev imaginari shift denomin zcut ev method qspace integr standard quadratur real imaginari part sigma comput number frequenc along real axi step ev number frequenc gener eliashberg function number temperatur e e k abinitio qmesh ddb file qmesh use selfenergi integr ngqpt number qpoint ibz asr chneut dipdip symdynmat number kpoint selfenergi correct includ final mkq state insid energi window ev list kpoint selfenergi correct e e e note note acoust sumrul asr charg neutral born effect charg chneut treatment dipoledipol interact dynam matrix dipdip activ default v find anoth section relat mpi parallel case run sequenti output chang run parallel see also eph_np_pqbk final messag inform user eph code either read qpt file dvdb contain case eph_ngqpt_fin defin input interpol scatter potenti ddb_ngqpt eph_ngqpt_fin md mpi parallel p alloc sum band my_bsum_start my_bsum_stop p number cpu parallel perturb p number perturb treat cpu p number cpu parallel qpoint p number qpoint ibz treat proc p number cpu parallel band p number cpu parallel spin p number cpu parallel kpoint p number kpoint sigma_nk treat proc md dvdb file contain qpoint ibz read dfpt potenti file md find eph_ngqpt_fin qpoint dvdb activ fourier interpol final section qp result spin kkpoint temperatur follow valu direct gap comput two approach linear qp equat otm md final result ev notat ek kohnsham energi eqp quasiparticl energi eqp ek differ qp ks energi seek real part selfenergi comput ks energi se imaginari part zek renorm factor fan real part fan term ek dw debyewal term dek ks energi differ band band deqp mean eqp otm onthemassshel approxim eqp ek sigmaomegaek tauek lifetim femtosecond comput ks energi mu_e fermi level given nelect kpoint e e e k mu_e b ek eqp eqpek seek seek zek fanek dw dek deqp ks gap assum bval bcond qp gap otm qp_gap ks_gap otm calcul produc follow output file sh ls tephzpr_o_ tephzpr_o_ebandsagr tephzpr_o_phbandsagr tephzpr_o_phdosnc tephzpr_o_phbstnc tephzpr_o_sigephnc ebandsagr electron band xmgrace format see also prteband phbstagr phonon band xmgrace format see also prtphband ph_ndivsm ph_nqpath ph_qpath phdosnc phonon do netcdf format see prtphdo given ph_ngqpt phbstnc phonon band structur netcdf format sigephnc netcdf file sigmatexteph result qp result store sigpephnc netcdf file kkpoint spin temperatur usual one use abiopen p option print print summari termin text abiopenpi tephzpr_o_sigephnc p sigmaeph calcul calcul type real imaginari part sigmaeph number kpoint sigma_nk sigma_ngkpt sigma_erang max bstart min bstop initi abinitio qmesh ngqpt nqibz qmesh selfenergi integr eph_ngqpt_fin kmesh electron mpdiv shift kptopt number band includ eph selfenergi sum zcut ha ev number temperatur k symsigma eliashberg function fals spectral function fals print qp result temperatur use verbos print result ks qp z factor onthemassshel otm direct gap ev k spin kpoint ks_gap qpz_gap qpz ks otms_gap otm ks gamma ks qp z factor onthemassshel otm direct gap ev k spin kpoint ks_gap qpz_gap qpz ks otms_gap otm ks gamma qpz stand result obtain linear qp equat otm result onthemassshel approach also plot import result replac p e expos sh abiopenpi tephzpr_o_sigephnc e produc ephzpr_assetsqpgaps_opng left qp direct gap gamma ad function otm result shown right panel case qp direct band gap decreas increas temperatur rememb mgo direct gap semiconductor socal varshni effect observ mani semiconductor zpr comput two approach differ mev expect linear qp equat reduc otm z factor close one sort fortuit cancel cbmvbm correct calcul z factor vbm cbm obtain z physic ground valu reason z correspond area qp peak spectral function valu indic welldefin qp excit valu reason still uncommon obtain unphys z factor eph calcul ie valu especi state far band edg eph selfenergi lot structur frequencyspac linear qp approach alway justifi reason rest tutori focus analysi otm result import comput imaginari part sigmatexteph ks energi strongli recommend use eph_task option activ sever import optim possibl full selfenergi want note howev eph_task abl provid full frequenc depend valu imaginari part ks eigenvalu comput spectral function eliashberg function therefor requir eph_task converg wrt nband point difficult write input file perform zpr calcul differ valu nband fix qqmesh matter ad follow set variabl previou input file sh ndtset nband nband exampl given dialog teststutorespfninputtephzpr_abi run calcul usual use sh abinit tephzpr_abi tephzpr_log err extract result output file dialog teststutorespfnrefstephzpr_abo altern use abipi abicomp script postprocess result store sigpeph file sh abicomppi sigeph tephzpr_o_ds_sigephnc e ephzpr_assetsqpgaps_opng figur left show converg otm zpr function nband figur right give correct ks band ga function obtain differ number band similar behaviour observ also linear equat result quit disappoint sens qp gap far converg converg rate even wors look qp energi behaviour observ gw care expens converg studi would reveal band need comput although feasibl would costli tutori therefor left extra exercis next section see eph code provid much effici algorithm acceler converg note exercis chang input file use mixprec boxcutmin rerun calcul compar previou result see signific differ walltim memori alloc wrr rr hint use sh grep log mem extract line impor memori alloc report reduc number band sternheim method activ sternheim approach need set eph_stern use getpot_filepath specifi extern file gs ks potenti file produc end gs calcul provid prtpot set input file import sternheim equat solv nonselfconsist use max nline nscf iter solver stop firstord wavefunct converg within tolwfr default valu two variabl provid specifi user input file code abort solver converg may happen first nband state well separ remain highenergi state increas nband solv problem user point view sternheim method requir add follow section initi input sh eph_stern getpot_filepath mgo_eph_zprflow_zpr_mgowtoutdataout_potnc nline tolwfr e default valu exampl input file provid dialog teststutorespfninputtephzpr_abi run sh abinit tephzpr_abi tephzpr_log err four calcul perform differ valu nband sh ndtset nband nband order monitor converg qp correct analyz converg behavior extract result main output file dialog teststutorespfnrefstephzpr_abo altern pass list sigeph file abicomp script use sigpeh command sh abicomppi sigeph tephzpr_o_ds_sigephnc e ephzpr_assetsqpgaps_opng converg much better note differ scale yaxi zpr converg mev nband valu one obtain sum band maximum number planewav mpw import big advang sternheim method dont need comput wfk file mani empti band order converg real part selfenergi mean one use comput power densifi kkmesh keep number empti state reason level produc wfk file band kkmesh inde way expens perform comput let say band note howev cost sternheim method quickli increas nband due orthogon process mean zpr calcul band occ empti without sternheim method much faster comput done eph_stern matter fact use sternheim method dont need band converg result note exercis gener new wfk nband mpw run zpr calcul without sternheim method compar sumoverst result sternheim one good idea use nband mpw converg zpr wrt qmesh fix valu nband perform converg studi qqsampl unfortun wont abl fulli converg result least get idea perform kind converg studi input tephzpr_abi comput wfk file differ kkmesh rel small number empti state final use wfk file perform zpr calcul ad sh ndtset nband ngkpt eph_ngqpt_fin getwfk_filepath tephzpr_o_ds_wfk ngkpt eph_ngqpt_fin getwfk_filepath tephzpr_o_ds_wfk ngkpt eph_ngqpt_fin getwfk_filepath tephzpr_o_ds_wfk eph_stern getpot_filepath mgo_eph_zprflow_zpr_mgowtoutdataout_potnc dialog teststutorespfninputtephzpr_abi run calcul usual sh abinit tephzpr_abi tephzpr_log err output file report conveni dialog teststutorespfnrefstephzpr_abo use sh abicomppi sigeph tephzpr_o_ds_sigephnc e analyz converg qqmesh ephzpr_assetsqpgaps_opng converg zpr shown left panel tdepend band gap obtain differ qqmesh report right panel obvious still far converg xx qqmesh best afford tutori clear one test denser qqmesh last least monitor behaviour zcut addit converg test cover lesson left exercis comput spectral function comput spectral function need specifi number frequenc via nfreqsp code comput a_nkww linear frequenc mesh center ks eigenvalu span interv ee_nk delta ee_nk delta delta given freqspmax odd number frequenc point enforc code nutshel one add eg sh nfreqsp freqspmax ev exampl input file avail dialog teststutorespfninputtephzpr_abi execut sh abinit tephzpr_abi tephzpr_log err plot spectral function a_nkww easi way use abipi extract data netcdf file two differ way use small python script call abipi api use abiopen interact netcdf file insid ipython advantag second approach interact python object interact environ first approach power need programmat api autom oper python script report note script plot a_nkww python usrbinenv python import sy abipyabilab import abiopen get file name command line open file filepath sysargv abifil abiopenfilepath plot sigmaomega aomega qp solut adjust paramet accord system abipi yet read mind abifileplot_qpsolution_skbspin kpoint band altern one use sh abiopenpi tephzpr_o_ds_sigephnc open sigephnc file insid ipython insid ipython termin issu ipython matplotlib abifileplot_qpsolution_skbspin kpoint band plot sigma_nkww a_nkww gamma point band index conduct band maximum note python indic start wherea abinit use fortran convent indic start nutshel one substract fortran band index call abipi function ephzpr_assetsqp_solutionpng comment order intersect blue solid dash line give graphic solut nonlinear qp equat eeqp_nk eeks_nk sigma_nktextepheeqp_nk restrict real axi wherea blue circl repres solut obtain linear qp equat renorm factor z particular state real part sigma almost linear around eeks_nk linear solut close nonlinear one may case howev real part highli nonlinear two approach give differ answer ii qp solut locat insid ks gap imsigma zero well strictli speak small yet finit use finit zcut calcul net result a_nkww present sharp peak correspond qp energi note also comput a_nkww integr number point nfreqsp small part weight lost numer integr easili fix increas resolut frequenc mesh iii particular nk state ww ee singl intersect sigma_nkww howev possibl configur multipl intersect may lead background andor addit satellit a_nkww provid imaginari part sigma_nkww suffici small energi rang iiii vertic red line second figur give onshel qp energi alreadi mention previous otm energi deriv static formal reduc linear qp result z surpris see qp peak differ otm energi still mean otm wrong actual puzzl fact background a_nkwwi strongli suppress phonon satellit clearli visibl obvious entir discuss base complet underconverg result care investig report citeneri indic accur descript dynam effect requir approxim inclus addit feynmann diagram cumul expans otm approxim give qp energi much closer qp peak obtain cumul method lengthi discuss somehow need justifi reason focus otm result tutori focu technic aspect particular compar spectral function selfenergi obtain differ set rememb tephzpr_abi comput a_nkww withwithout sternheim method question compar two calcul learn analysi compar result obtain withwo sternheim use abicomp sh abicomppi sigeph tephzpr_o_ds_sigephnc insid ipython type ipython matplotlib robotplot_selfenergy_convspin kpoint band produc figur real part imaginari part selfenergi spectral function obtain differ approach ephzpr_assetsaw_empty_vs_sternpng note follow imaginari part sigma_nkww affect sternheim method long explicitli includ enough nband band around nk state account phonon absorptionemiss full dynam selfenergi ii real part sigma_nkww obtain two method differ result interpret critic eye sternheim method inde design acceler converg sigma_nkeeks_nk wrt nband exactli reproduc behaviour sigma_nkww larg frequenc sinc static approxim word two approach properli converg one see real part two selfenergi agre around bare ks eigenvalu two curv star deviat larg ww test left addit excercis volunt addit exampl diamond see jupyt notebookhttpsnbviewerjupyterorggithubabinitabitutorialsblobmasterabitutorialssigephlesson_sigephipynb mpi parallel memori requir import differ respect eph_task comput imaginari part worth discuss detail comput imaginari part ks energi transport properti eph code abl filter kk qqpoint relev state around band edg store memori unfortun case full selfenergi calcul filter algorithm possibl mpi process need store kkwavevector ibz abl comput eph matrix element connect kk kq word wavefunct ibz mpidistribut lead signific increas memori requir especi dens mesh andor larg nband fortun code abl distribut band among mpi process band commun henc memori requir wavefunct scale nband np_band np_band number mpi process band commun see eph_np_pqbk zpr calcul prioriti follow use enough np_band mpi process decreas memori wavefunct ideal np_band divid nband distribut work equal maximum number mpi proc use level nband let exagger keep proc mpi level usual effici term walltim note band parallel benefici also sternheim method use solver oper mpidistribut band perhap parallel effici wont perfect memori wavefunct continu scale memori wavefunct reach reason level activ parallel perturb decreas memori wrr rr timestextnatom better effici eph_npert divid natom explain introduct page eph codetutorialeph_intro mpi level allow one reduc memori alloc wrr rr timestextnatom number proc commun divid natom memori wavefunct w control may want activ qqpoint parallel speedup calcul memori requir decreas though final use kkpoint parallel enough cpu avail boost calcul obvious kind parallel make sens comput qp correct sever kk point number np_kpt mpi process adjust accordingli keep mind howev kkpoint differ comput cost load imbal expect import final rememb set boxcutmin valu smaller eg lead signific decreas memori requir store w mixprec allow one decreas comput cost fft estim zpr gener frohlich model last least one estim correct zpr polar materi use gener frohlich model base ab initio effect mass comput dfpt citelaflamm formal detail xxx exampl input file avail testv_ eliashberg function fanmigd selfenergi rewritten term spectral represent beginequ sigmafm_nkkww int ddeeddww left fracnww feeww ee ww eta fracnww feeomega ee ww eta right alpha f_nkeeww endequ introduc real posit tindepend eliashberg function beginequ alpha f_nkeeww sum_mnu int_bz fracdqqomega_bz gkq deltae ee_mkqdeltaww wqnu endequ comput alpha f_nk activ set prteliash frequenc mesh phonon defin ph_wstep ph_smear frequenc mesh electron defin dosdelta tsmear adiabat approxim phonon frequenc denomin fanmigd term neglect fm term simplifi beginequ sigmaafm_nkkee_nk sum_mnu int_bz fracdqqomega_bz dfrac n_qnu gkq ee_nk emkq eta labeleqadiabatic_fan_selfen endequ adiabat zpr also express int ddww nww f_ww f_nkww given f_nkww sum_mnu int_bz fracdqqomega_bz gkq g_mnnudwkkqq dfracdeltaww wqnuee_nk ee_mkq author mt fj first tutori projector augmentedwav paw method projector augmentedwav approach use tutori aim show perform calcul within projector augmentedwav paw method learn launch paw calcul main input variabl govern converg numer effici suppos know use abinit _normconserv pseudopotentials_ ncpp tutori take hour tutorial_readm summari paw method projector augmentedwav approach introduc peter blochl projector augmentedwav method extens augment wave method pseudopotenti approach combin tradit unifi electron structur method base linear invert transform paw transform connect true wavefunct psi auxiliari pseudo soft wavefunct tpsi beginequ labeleqpaw_true_wavefunct psirangl tpsirangl sum_i sum_a biglphi_iarangl tphi_iarangl bigr langl tprj_iatpsirangl tpsirangl sum_a psi_arangl tpsi_arangl endequ relat base definit _augment regions_ atom sphere radiu r_c around atom partial wave phi_irangl form basi atom wavefunct tphi_irangl pseudiz partial wave obtain phi_irangl tprj_irangl dual function tphi_irangl call projector therefor possibl write everi quantiti depend psi_n densiti energi hamiltonian function tpsi_n find tpsi_n solv selfconsist equat paw method two main advantag tpsi alway possibl obtain true electron wavefunct psi converg compar _ultrasoft pseudopotential_ uspp one practic point view paw calcul rather similar normconserv pseudopotenti one notic one use special atom data file paw dataset contain phi_i tphi_i tprj_i play role pseudopotenti file tip highli recommend read follow paper understand correctli basic concept paw method citebloechl citekress implement paw method abinit detail citetorr describ specif notat formul use paw abinit continu might consid work differ subdirectori tutori work_paw follow name file mention subdirectori input file found abi_teststutorialinput directori import compar result refer output file locat abi_teststutorialref abi_teststutorialrefstpaw_addon directori present tutori name tpaw_abo input file tpaw_abi exampl file use comput total energi diamond experiment volum within _lda exchangecorrel functional_ copi tpaw_abi file work directori sh cd abi_teststutorialinput mkdir work_paw cd work_paw cp tpaw_abi execut abinit abinit tpaw_abi log code run quickli meantim read input file see paw input variabl dialog teststutorialinputtpaw_abi open tpaw_abi file chang line pseudopotenti inform replac pseudostm_pwtetercpspnc file pseudodojo_paw_pw_standardcxml run code abinit tpaw_abi log run stop almost immedi input file inde miss mandatori argument pawecutdg add line pawecutdg tpaw_abi run code complet success note time need paw run greater time need normconserv pseudopotenti run inde constant valu plane wave cutoff energi ecut paw requir comput resourc onsit contribut comput nonloc contribut paw dataset use projector per angular momentum nonloc contribut present normconserv pseudopotenti use one howev plane wave cutoff energi requir paw much smaller cutoff need normconserv pseudopotenti see next section paw calcul actual requir less cpu time let open output file tpaw_abo look insid rememb compar refer file abi_teststutorialref compar output file normconserv pseudopotenti run output file paw contain follow specif topic begin file specif default paw input variabl ngfftdg pawecutdg useylm mention section outvar echo valu preprocess input variabl use two fft grid mention coars grid specif use wavefunct getcut wavevector ngfft ecuthartre boxcutratio fine grid specif use densiti getcut wavevector ngfft ecuthartre boxcutratio specif descript paw dataset might follow tutori pawtutorialpaw devot build paw atom data complet understand file pseudopotenti descript pspini atom type psp file userstorrentmworkabinitgitbeautytestspsps_for_testspseudodojo_paw_pw_standardcxml pspatm open atom psp file userstorrentmworkabinitgitbeautytestspsps_for_testspseudodojo_paw_pw_standardcxml pspatm read pseudopotenti header xml form userstorrentmworkabinitgitbeautytestspsps_for_testspseudodojo_paw_pw_standardcxml pseudopotenti format paw basis_s lnmax lmn_size orbit sphere core radiu rc_sph radial mesh use mesh riaaexpbbi size aa e bb e shapefunct sin type shapefrsinpirrshppirrshp radiu shape function mmax radial grid use partial wave grid radial grid use projector grid radial grid use tcore densiti grid radial grid use vloc grid radial grid use pseudo valenc densiti grid mesh size vloc set avoid numer nois compens charg densiti taken account xc energypotenti pspatm atom psp read spline comput scf cycl section valu integr compens charg evalu two differ numer methodolog comput _augment regions_ spheric grid comput whole simul cell fft grid discuss two valu done forthcom section paw test compens charg insid sphere follow valu must close compens charg spheric mesh compens charg fine fft grid inform relat nonloc term pseudopotenti intens d_ij spheric densiti matrix augment wave occup rho_ij result concern paw augment region total pseudopotenti strength dij hartre atom atom augment wave occup rhoij atom atom end file find decomposit total energi direct calcul doubl count calcul energyterm iteration_st dtset comment compon total free energi hartre kinet e hartre e xc e ewald energi e psp_core e local_psp e spherical_term e total_energi e total_energy_ev e energytermsdc iteration_st dtset comment doublecount decomposit free energi band_energi e ewald energi e psp_core e xc_dc e spherical_term e total_energy_dc e total_energy_dc_ev e note paw total energi equal one obtain normconserv pseudopotenti case due arbitrari modif energi refer pseudopotenti construct paw compar total energi comput differ atom dataset meaning part energi calcul exactli gener abl compar number valenc energi differ paw potenti differ code converg respect planewav basi cutoff usual normconserv pseudopotenti case critic converg paramet cutoff energi defin size planewav basi normconserv pseudopotenti case input file tpaw_abi contain data use comput converg ecut diamond experiment volum dataset increas ecut valu ha ha might use tpaw_abi file standard normconserv pseudopotenti run abinit tpaw_abi log obtain follow _total energy_ valu see tpaw_abo etot e etot e etot e etot e etot e etot e etot e etot e etot e check etot converg mhartre level achiev e_cut hartre b projector augmentedwav case use input file section modifi last line tpaw_abi replac pseudostm_pwtetercpspnc file pseudodojo_paw_pw_standardcxml run code open abinit output file _abo_ obtain valu etot e etot e etot e etot e etot e etot e etot e etot e etot e check _etotal_ converg mhartre achiev _ le e_cut le hartree_ _etotal_ within mhartre final valu input paramet diamond paw calcul need lower cutoff compar calcul ncpp converg respect doubl grid fft cutoff ncpp calcul _plane wave_ densiti grid least twice bigger wavefunct grid direct paw calcul _plane wave_ densiti grid tunabl thank input variabl pawecutdg paw ecut doubl grid mainli need allow map densiti potenti locat augment region sphere onto global fft grid number point fourier grid locat sphere must larg enough preserv minim accuraci determin cutoff energi pawecutdg one sensit object affect grid transfer compens charg densiti integr augment region spheric grid must cancel integr whole simul cell fft grid use input file tpaw_abi differ tpaw_abi file ecut fix ha pawecutdg run ha dialog teststutorialinputtpaw_abi launch abinit file obtain valu file tpaw_abo etot e etot e etot e etot e etot e etot e etot e etot e etot e etot e see variat energi respect pawecutdg paramet well mha level principl suffici choos pawecutdg ha order obtain energi chang lower mha practic better keep secur margin pawecutdg ha th dataset energi chang lower mha choic enough note note step converg due sudden chang grid size see output valu ngfftdg occur increas pawecutdg avoid troubl due step better choos valu pawecutdg slightli higher converg compens charg similar behaviour possibl check output file scf cycl look paw test compens charg insid sphere follow valu must close compens charg spheric mesh compens charg fine fft grid two valu integr compens charg densiti must close note numer reason exactli integr radial grid use scheme integr fft grid _addit test_ want check converg respect ecut fix valu pawecutdg ha let modifi tpaw_abi file set pawecutdg ha let launch abinit obtain valu etot e etot e etot e etot e etot e etot e etot e etot e etot e check _etotal_ converg mhartre level achiev le e_cut le hartre note although pawecutdg alway check practic common use put bigger ecut keep constant calcul increas pawecutdg slightli chang cpu execut time memoryconsum note ecut alreadi high need high pawecutdg import test ecut converg pawecutdg remain constant obtain consist result plot paw contribut densiti state do use input file tpaw_abi file abinit use comput densiti state do see prtdo keyword input file also note kpoint use order increas accuraci do ecut set ha pawecutdg ha dialog teststutorialinputtpaw_abi launch code file obtain tpaw_abo do file tpaw_o_do abinit tpaw_abi log plot do file purpos use graphic tool plot column respect column exampl use xmgrace tool launch xmgrace block tpaw_o_do bxi stage usual densiti state plot noth specif paw edit tpaw_abi file comment prtdo line uncom add prtdo pawprtdo natsph iatsph ratsph prtdo requir output project do natsph iatsph select first carbon atom center project ratsph set radiu project area atom unit exactli radiu paw augment region gener best choic pawprtdo specif paw option abinit comput contribut project do let us rememb beginequ psirangl tpsirangl sum_i sum_a biglphi_iarangl tphi_iarangl bigr langl tprj_iatpsirangl endequ within paw total project do contribut smooth planewav pw contribut tpsirangl allelectron onsit ae contribut langl tprja_itpsirangl phi_iarangl pseudo onsit ps contribut langl tprja_itpsirangl tphi_iarangl execut abinit modifi input file get new do file name tpaw_o_dos_at edit look insid contain paw contribut mention angular momentum _in diamond case l l momenta considered_ plot file use th th th column respect nd one plot paw contribut l total do sum three contribut use xmgrace tool launch xmgrace block tpaw_o_dos_at bxi bxi bxi get project do projpaw_assetsdosprojjpg see smooth pw contribut ps onsit contribut close basi complet cancel could approxim do ae onsit part taken alon that exactli purpos pawprtdo option case ae onsit contribut comput given good approxim total project do main advantag option comput time greatli reduc do instantan comput howev see next section approxim valid tphi_i basi complet enough electron densiti mainli contain sphere defin ratsph test complet paw partial wave basi previou section use standard paw dataset _partial waves_ per angular momentum gener best compromis complet partial wave basi effici paw dataset _partial waves_ longer cpu time use abinit let look span stylecolorgreenabi_pspdirpseudodojo_paw_pw_standardcxmlspan file tag span stylecolorgreenvalence_statesspan span stylecolorgreenstatespan line indic number partial wave l angular momentum present file two l partial wave two l partial wave let open span stylecolorgreenabi_pspdirc_paw_pw_projxmlspan span stylecolorgreenabi_pspdirc_paw_pw_projxmlspan paw dataset file first dataset base one _partial wave_ per l second one base three _partial waves_ per l complet partial wave basi increas use span stylecolorgreenc_paw_pw_projxmlspan span stylecolorgreenpseudodojo_paw_pw_standardcxmlspan span stylecolorgreenc_paw_pw_projxmlspan let us plot do use two new paw dataset save exist tpaw_o_dos_at file name fi tpaw_o_proj_dos_at open tpaw_abi file modifi order use span stylecolorgreenc_paw_pw_projxmlspan paw dataset run abinit save new tpaw_o_dos_at file name fi tpaw_o_proj_dos_at open tpaw_abi file modifi order use span stylecolorgreenc_paw_pw_projxmlspan paw dataset run abinit save new tpaw_o_dos_at file name fi tpaw_o_proj_dos_at plot contribut project do two new do file get project do projpaw_assetsdosprojjpg project do projpaw_assetsdosprojjpg ad do obtain previou section comparison immedi see superposit plane wave part do pw ps onsit do depend complet partial wave basi look output file one paw dataset way estim complet partial wave basi compar deriv total energi look stress tensor partialwav basi e e e partialwav basi e e e partialwav basi e e e partialwav basi clearli complet partialwav basi result correct test use estim precis expect stress tensor least due partial wave basi complet compar result output file total energi eigenvalu occup note cpu time increas size partial wave basi recommend use systemat highprecis paw dataset want learn gener paw dataset differ partial wave basi might follow tutori gener paw dataset pawtutorialpaw check valid paw result valid comput check comparison known structur known result case diamond lot comput experiment result exist import valid paw calcul complet plane wave basi partial wave basi alway check comparison allelectron comput exist paw result done comparison experiment result paw method accuraci allelectron method result close case diamond allelectron result found fi citeholzwarth allelectron equilibrium paramet diamond within _local densiti approximation_ obtain fplapw wienk code angstrom b gpa experi give angstrom b gpa let test abinit use input file tpaw_abi file run abinit comput valu _etotal_ sever cell paramet around angstrom use standard paw dataset dialog teststutorialinputtpaw_abi abinit tpaw_abi log tpaw_abo file extract valu _acell_ valu _etotal_ put file plot graphic tool get diamond etot vs acellpaw_assetsetotalacellpng width curv extract cell valu a_ b method choic exampl birchmurnhagan spline fit get angstrom b gpa result excel agreement fplapw one addit comment paw abinit overlap paw augment region principl paw formal valid nonoverlap augment spheric region usual case small overlap sphere accept default abinit check distanc atom larg enough avoid overlap small volumin overlap accept default valu tune pawovlp input keyword overlap check even bypass pawovlp recommend warn small overlap accept augment region overlap compens charg densiti avoid compens charg densiti defin radiu name r_shape paw dataset analyt shape function overlap relat compens charg radiu check abinit warn eventu print also note control compens charg radiu shape function gener paw dataset see tutori gener paw dataset pawtutorialpaw b mix scheme selfconsist cycl decomposit total energi use effici mix scheme selfconsist loop crucial point minim number step achiev converg mix done potenti densiti default normconserv pseudopotenti calcul mix done potenti technic reason choic optim paw calcul thu default mix done densiti paw activ mix scheme control iscf variabl see differ option input variabl compar scheme edit tpaw_abi file tri iscf compar behaviour sc cycl case see final _total energy_ way reach complet differ look end file focu compon total free energi total energi decompos accord two differ scheme direct doubl count high converg scf cycl potentialdens residu small two valu observ converg valu reach rapidli direct energi mix potenti doubl count energi mix densiti thu default output file print direct energi mix potenti doubl count energi mix densiti also note paw _partial wave occupancies_ rho_ij also mix sc cycl default mix done way densiti c pawu correl materi system studi contain strongli correl electron dftu method use control usepawu lpawu upawu jpawu input keyword note formal implement abinit approxim ie valid tphia_i basi complet enough electron densiti mainli contain paw sphere approxim done one explain th section tutori consid smooth pw contribut ps onsit contribut close relat ae onsit contribut comput inde good approxim converg _selfconsist cycle_ ensur global minimum reach pawu sometim difficult use usedmatpu dmatpawu help see tutori dftututorialdftu print volum paw want get detail output concern paw comput use pawprtvol input keyword particularli use print detail _pseudopotenti strength_ d_ij _partial wave occupancies_ rho_ij e addit paw input variabl look varsetpawpaw variabl set find descript addit input keyword relat paw use tune comput order gain accuraci save cpu time see also descript variabl input file exampl topicpawpaw topic page warn standard comput variabl modifi author xg tutori tddft timedepend densiti function theori casida approach tutori aim show get follow physic properti finit system excit energi associ oscil strength frequencydepend polariz optic spectra casida approach within timedepend densiti function theori tutori take minut tutorial_readm brief theoret introduct order perform timedepend densiti function theori calcul tddft electron excit oscil strength casida approach first theoret background tddft first develop eighti direct calcul electron excit introduc much later casida cowork comprehens descript underli formal given timedepend densiti function respons theori molecular system theori comput method function e casida recent develop applic modern densiti function theori edit jm seminario elsevi amsterdam p httpdxdoiorg howev refer might hard get base tutori instead follow also earli paper citecasida citecasidaa citevasiliev first paper citecasida use main refer tutori paper learn tddft calcul electron excit energi start first usual groundstat calcul chosen xc function calcul produc spectrum kohnsham electron energi wide known differ occupi unoccupi kohnsham electron energi resembl excit energi differ energi excit state ground state although real theoret justif similar differ kohnsham electron energi start point casida approach framework tddft squar give main contribut diagon part matrix whose eigenvalu squar excit energi one add diagon matrix made squar kohnsham energi differ coupl matrix whose element fourwavefunct integr coulomb exchangecorrel kernel exchangecorrel kernel contribut differ spinsinglet spintriplet state differ spinsinglet spintriplet state see eq citecasidaa eq citevasiliev construct coupl matrix done basi exchangecorrel kernel deriv exchangecorrel function use groundstat requir theori sinc correspond hold exact function practic approxim xc potenti one xc kernel often differ see section iii citecasida big drawback current known xc potenti xc kernel observ system infinit least one direct eg polym slab solid case addit coupl matrix unabl shift edg kohnsham band structur fourwavefunct integr becom small redistribut oscil strength particular dft band gap problem solv tddft also casida approach reli discret kohnsham spectrum thu tddft approach electron excit energi abinit valid finit system atom molecul cluster actual one kpoint use box center must defin close center graviti system casida formal also give access oscil strength need obtain frequencydepend polariz correspond optic spectrum abinit implement oscil strength given secondrank tensor cartesian coordin well averag direct usual use molecul cluster left user gener polaris spectrum accord eg eq citecasidaa one also combin ground state total energi electron excit energi obtain bornoppenheim potenti energi curv excit state illustr formaldehyd citecasidaa given simplic rel modest cpu cost type calcul casida approach enjoy wide popular hundr paper publish basi methodolog still accuraci might expect see often test method see suit need read recent literatur first comput electron excit energi oscil strength n_ comput analys excit energi diatom molecul n_ rather simpl system cylindr symmetri allow interest understand although suppos familiar quantum number diatom molecul play import role understand way use abinit implement casida formal begin might consid work differ subdirectori tutori work_tddft copi file ttddft_abi work_tddft sh cd abi_teststutorialinput mkdir work_tddft cd work_tddft cp ttddft_abi issu abinit ttddft_abi log comput quit fast sec ghz pc let examin input file ttddft_abi dialog teststutorialinputttddft_abi two dataset first one correspond typic groundstat calcul occupi band densiti wavefunct written use second data set second dataset one tddft calcul done moreov nonselfconsist calcul occupi eigenfunct correspond eigenenergi also accomplish obtain set iscf pleas take time read inform valu iscf input variabl acquir mean context name boxcent td_mexcit td_maxen actual inform known use tddft abinit note occupi band defin dataset add unoccupi band dataset obtain total band box larg xx angstrom cutoff quit reason hartre request casida formal one k point use use perdewwang lda function self consist nonselfconsist calcul ixc deduc abinit look pseudopotenti file examin output file ttddft_abo dialog teststutorialrefsttddft_abo one jump second dataset section skip noninterest inform order reach follow inform tddft comput excit state split band occupi band unoccupi band give excit matrix diagon casida formal thu x matrix give excit energi follow list excit energi obtain differ kohnsham eigenvalu occupi unoccupi refer order increas energi order analyz tddft well experiment data next section let us mention kohnsham eigenfunct simul follow characterist first fifth state nondegener occupi sigma state even pariti second state nondegener occupi sigma state odd pariti third fourth state degener occupi pi state odd pariti sixth seventh state degener unoccupi pi state even pariti state nondegener unoccupi sigma state even pariti combin state give first nine kohnsham energi differ transit ha ev tot ene ha aver xx yy zz e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e without coupl matrix would excit energi spinsinglet spintriplet state coupl matrix modifi eigenenergi mix differ electron excit also lift degeneraci eg quadruplet form combin degener state give fourfold degener excit energi e ha tabl inde concern spinsinglet follow excit energi obtain see next section output file tddft singlet excit energi print correspond total energi excit ha ev total energi ha major contribut e e e e e e e e e e e e e e e e e e e e e e e e e e e excit energi number accord increas energi ha well ev total energi also given ad excit energi groundstat energi final two major contribut excit mention size contribut identif seen first second excit degener numer inaccuraci account mev differ mainli come first second kohnsham energi differ occupi state unoccupi state also true fourth excit come third kohnsham energi differ occupi state unoccupi state quadruplet kohnsham energi differ observ e ha split one doublet two singlet number lowest singlet doublet last singlet present lowest excit list oscil strength provid oscil strength element smaller e set zero excit ha averag xx yy zz xy xz yz e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e first six transit forbidden zero oscil strength seventh eighth transit allow sizeabl yy yz zz compon next one find excit energi spintriplet state tddft triplet excit energi print correspond total energi excit ha ev total energi ha major contribut e e e e e e e e e e e e e e e e e e e e e e e e e e e spintriplet energi markedli lower correspond spinsinglet energi also highest singlet deriv kohnsham quadruplet excit number oscil strength also follow stage posit compar experiment data tri improv qualiti calcul summar result obtain follow five lowestli spin singlet excit energi correspond quantum number deriv knowledg kohnsham state quantum number ev even pariti pi_g state ev odd pariti sigma_u state ev even pariti sigma_g state ev odd pariti delta_u state ev odd pariti pi_u state follow five lowestli spintriplet excit energi correspond quantum number ev even pariti pi_g state ev odd pariti sigma_u state ev odd pariti delta_u state ev even pariti sigma_g state ev odd pariti sigma_u state quantum number relat effect mirror plane need sigma state could attribut sole basi knowledg kohn sham orbit quantum number lowestli experiment spinsinglet excit energi see tabl iii citecasida follow ev even pariti pi_g state ev odd pariti sigma_u state ev odd pariti delta_u state lowestli experiment spintriplet excit energi ev odd pariti sigma_u state ev even pariti pi_g state ev odd pariti delta_u state ev odd pariti sigma_u state sever case agreement quit satisfactori order ev howev also notic discrep inde understand simul appear spinsinglet sigma_g state ev spinsinglet state invers spintriplet pi_g sigma_u state spintriplet state appear spintriplet sigma_g state ev spintriplet state still agreement tddft valu experiment valu much better anyth done sole basi kohnsham energi differ spinsinglet triplet ev even pariti pi_g state ev odd pariti sigma_u state ev mtwice odd pariti sigma_u delta_u state ev odd pariti pi_u state converg studi sever paramet subject converg studi context energi cutoff box size number unoccupi band start number unoccupi state input paramet chang input file valu nband follow result obtain nband energi given ev singlet singlet singlet singlet singlet triplet triplet triplet triplet triplet might tri obtain one comput nband take bit minut give result like converg within ev let us look data unfortun none mention discrep experiment data resolv although differ first second spintriplet state decreas significantli although see least band need obtain result converg within ev continu reli band tri understand import discrep keep cpu time low level next tri increas cutoff energi fairli easi one eg set doubl dataset loop follow result obtain ecut ha singlet singlet singlet singlet singlet triplet triplet triplet triplet triplet might tri obtain one comput ecut take coupl second give result like converg within ev modif respect result ecut ha quit small final examin effect cell size fairli easi e keep band stick ecut ha one eg set doubl dataset loop follow result obtain acel singlet singlet singlet singlet singlet triplet triplet triplet triplet triplet obvious cell size play import role spuriou appear state remark compar experiment data inde singlet triplet state energi increas strongli cell size state quickli stabil except still higher singlet state actual singlet switch triplet switch presenc singlet state sigma_g three lowest one triplet state sigma_g two discrep one lesson learn converg studi converg differ state quit differ usual converg lower excit state requir much effort quit difficult especi concern supercel size converg higher state stage simpli stop converg studi give result abinit calcul use ecut hartre acel band focus state alreadi converg compar result ldatdlda result citecasida experiment result present casida experiment singlet pi_g singlet sigma_u singlet delta_u triplet sigma_u triplet pi_g triplet delta_u triplet sigma_u calcul base pseudopotenti casida calcul allelectron one fact might account discrep calcul maxim ev cours user respons test influenc differ pseudopotenti hisher calcul agreement experiment data order ev except pi_g state ev particular note ldatdlda abl get correct order lowest two triplet state one problem intrins ldatdlda approxim choic exchangecorrel potenti kernel emphas citecasida choos differ function selfconsist part xc potenti gener coupl matrix xc kernel give better descript higherli state inde potenti r tail unlik lda gga like van leeuwenbaerend one citevanleeuwen reproduc fairli well ionis energi give much better descript rydberg state still lda kernel work pretti well order activ procedur set valu ixc dataset scf function valu ixc dataset xc function use kernel use pseudopotenti agre scf function dataset write end abinit implement strong restrict xc kernel use must ldatyp see list allow ixc valu descript iscf author dja calcul u j use cococcioni approach determin u dftu abinit cococcioni approach tutori aim show determin u dftu calcul consist fast easi way learn prepar input file determin use main paramet implement aim suppos alreadi know run abinit paw tutori pawtutorialpaw obvious also read tutori dftututorialdftu like tutori pawtutorialpaw gener paw atom data tutori take hour tutorial_readm summari linear respons method determin u linear respons method introduc sever author citecococcioni citecococcionicitedederichscitehybertsen citeanisimovcitepickett base fact u correspond energi local addit electron site uenenen citehybertsen reformul respons infinitesim chang occup orbit electron dn u second deriv energi respect occup ufracdelta edelta n first method fix occup cut hop term local orbit later proposit constrain occup lagrang multipli citedederichsciteanisimov lagrang multipli alpha correspond local potenti appli increas decreas occup electron note occup need vari electron occup shift infinitesim recommend read follow paper understand basic concept linear respons calcul calcul u ldau studi select iron compound cococcioni phd thesi intern school advanc studi sissa triest citecococcioni linear respons approach calcul effect interact paramet lda u method cococcioni de gironcoli physic review b citecococcioni read ground state constrain system applic cerium impur p h dederich blugel r zeller h akai phi rev lett citedederich calcul coulombinteract paramet lacuo use constraineddensityfunct approach hybertsen schluter n e christensen phi rev b citehybertsen densityfunct calcul effect coulomb interact metal v anisimov gunnarsson phi rev b citeanisimov reformul ldau method localorbit basi w e pickett c erwin e c ethridg phi rev b citepickett implement determin u abinit briefli discuss citegonz determin u abinit continu may consid work differ subdirectori tutori work_udet import follow name file mention subdirectori input file found abi_teststutorialinput directori compar result refer output file locat abi_teststutorialref directori present tutori name tudetabo input file tudet_abi exampl file prepar wave function process correspond output file refstudet_abo copi file tudet_abi work directori run abinit sh cd abi_teststutorialinput mkdir work_udet cd work_udet cp tudet_abi abinit tudet_abi log err meantim read input file see usual dftu calcul u dialog teststutorialinputtudet_abi set allow us read occup fe orbit lpawu cell contain atom minimum get reason respons matric converg electron structur high accuraci tolvr usual allow one determin occup precis ecut chosen low order acceler calcul suppress write wfk file input calcul u calcul finish run second one copi file tudet_abi work directori run abinit abinit tudet_abi tudet_log dialog teststutorialinputtudet_abi see tudet_abi file run use tudet_o_wfk input indata_prefix tudet_o tudet_abi symmetri relat specifi explicitli tudet_log verifi none symmetri connect atom atom symatm atom number reach start atom symatm atom number reach start atom import otherwis occup number freedom evolv separ atom surround atom appli perturb gener symmetri separ run specifi atom perturb done differ speci output read number symmetri nsym symmetri oper symrel nonsymmorph vector tnon alreadi done insert tudet_abi file note altern disabl symmetri nsym break specif symmetri displac impur atom preliminari run howev determin u posit ideal posit symmetri reduc rest usual enough set macro_uj run calcul u note also irdwfk tolvr need set explicitli default macro_uj calcul tudet_ converg look output see atom shift atvshift automat set atvshift mean spinspin orbit first fe atom shift ev ha second atom shift appli selfconsist reach twice posit shift neg shift grep scf tudet_abo line start ure ure ii nat r_max ujev u_asaev u_infev ure ure ure ure ure contain u differ supercel valu u comput use extrapol procedur propos citecococcioni work shown use two atom supercel dft calcul extrapol procedur allow estim valu u precis valu obtain use larger supercel dft calcul extrapol simplic tutori restrict two atom supercel dft calcul column nat indic mani atom involv extrapol supercel r_max indic maxim distanc impur atom supercel column u indic actual u calcul use calcul u_asa estim u extend projector u_inf estim projector extend even although enough set macro_uj tune run standard potenti shift st atom treat dftu potenti shift ev wish determin u second atom put pawujat chang size potenti shift use eg pawujv ev test show ev optim valu linear respons linear wide rang ev ujdet util gener calcul u abinit describ suffici posttreat goe beyond standard applic separ execut ujdet creat output abinit format easili cut part ujdet input variabl gener standard input file ujdet util type sed n markmarkp tudet_abo ujdetin note input ujdet util alway call ujdetin contain potenti shift appli vsh shift vsh vsh nonselfconsist calcul allow extract contribut u origin noninteract electron ga vsh vsh posit neg potenti shift appli occup occ calcul u even larger supercel uncom line scdim ujdetin add scdim specifi supercel scdim specifi maximum total number atom supercel run ujdet execut directori abinit execut rm ujdetol ujdet ujdetlog grep ure ujdetout ure ii nat r_max ujev u_asaev u_infev ure ure ure ure ure ure see u extrapol supercel contain atom valu u depend strongli extens projector use calcul want use u lmtoasa calcul use keyword pawujrad ujdetin file get grip u want use uncom line add asaradiu specif atom eg pawujrad run rm ujdetol ujdet ujdetlog give higher valu column u_asa run ev compar ev local projector u valu bigger author mg ms parallel manybodi calcul gsubsubwsubsub correct alphaquartz siosubsub tutori aim show perform parallel calcul gw part abinit discuss approach use parallel differ step typic gsubsubwsubsub calcul setup paramet run order achiev good speedup quartz siosubsub use test case suppos knowledg unixlinux know submit mpi job suppos know alreadi basic parallel abinit explain tutori first introduct abinit parallelbaseparmd follow run abinit nn cpu core appear use specif command line accord oper system architectur comput use instanc mpirun n nn abinit abinitabi use specif submiss file tutori take hour requir modern comput cluster cpu core tutorial_readm gener wfk file parallel begin creat work directori abi_teststutoparalinput whose name might work_mbt sh cd abi_teststutoparalinput mkdir work_mbt cd work_mbt input file necessari run exampl relat tutori locat directori abi_teststutoparalinput action tutori work directori note pseudopotenti need run tutori sipsp opsp locat directori abi_pspdirpseudodojo_nc_sr__pw_standard_psp first gw tutorialtutorialgw learn gener wfk file sequenti version code perform similar calcul take advantag kpoint parallel implement groundstat part first copi input file tmbt_abi work directori work_mbt cd work_mbt cp tmbt_abi open input file abi_teststutoparalinputtmbt_abi prefer editor look structur dialog teststutoparalinputtmbt_abi first dataset perform rather standard scf calcul obtain groundstat densiti second dataset read densiti file calcul kohnsham band structur includ mani empti state dataset wfk gener iscf nscf getden read previou densiti tolwfr stop criterion nscf cycl nband number occ empti band comput nscf cycl nbdbuf larg buffer help reduc number nscf step alreadi encount variabl first gw tutorialtutorialgw mean familiar thing worth stress calcul solv nscf cycl conjugategradi method paral_kgb nscf cycl execut parallel use standard parallel kpoint spin nkpt x nsppol block band distribut among node test use unshift xx grid k point full brillouin zone fold kpoint irreduc wedg henc theoret maximum speedup run abinit nn cpu core use nn mpirun n abinit tmbt_abi tmbt_log err keep mind avoid idl processor number cpu nn divid end run code produc file tmbt_o_ds_wfk need subsequ gw calcul three core wall clock time around minut tail tmbt_out proc individu time sec cpu wall calcul complet deliv warn comment log file overal time end sec cpu wall refer output file given abi_teststutoparalref name tmbt_abo note band enough obtain converg gw result might increas number band proport comput resourc comput screen parallel use adlerwis express part tutori comput rpa polariz adlerwis approach basic equat discuss theorymbttherpapolarizabilityinfourierspacesect gw note first copi file tmbt_abi work directori creat symbol link point wfk file gener previou step ln tmbt_o_ds_wfk tmbt_i_wfk open input file abi_teststutoparalinputtmbt_abi discuss structur dialog teststutoparalinputtmbt_abi set paramet control screen comput summar optdriv screen run irdwfk read input wfk file symchi use symmetri speedup bz integr awtr take advantag timerevers mandatori gwpara use gwpara parallel band ecutwfn cutoff wavefunct ecutep cutoff polariz nband number band rpa express occupi band inclvkb correct treatment optic limit variabl alreadi discuss first gw tutorialtutorialgw variabl deserv addit explan gwpara awtr gwpara select parallel algorithm use comput screen two differ approach implement gwpara trivial parallel kpoint full brillouin gwpara parallel band memori distribut method present advantag drawback discuss document variabl tutori focus gwpara sinc algorithm best mpiscal mostli import one allow signific reduct memori requir way default valu need mention explicitli input file option awtr specifi system present time revers symmetri possibl halv number transit calcul explicitli reson transit need note awtr mandatori gwpara use way awtr also default valu need mention explicitli input file run calcul parallel worth discuss import technic detail implement purpos suffic say gwpara use screen part code distribut wavefunct process unit own full set occupi band empti state distribut among node parallel comput invers dielectr matrix done three differ step schemat describ follow step node comput partial contribut rpa polariz sum_cnu sumtextocc_nu sumtextmystop_textcmystart step partial result collect node step master node perform matrix invers obtain invers dielectr matrix write final result file first second step algorithm expect scale well number processor step contrari perform sequenti thu detriment effect overal scale especi case larg screen matric larg npwep larg number frequenc point  note maximum number cpu use dictat number empti state use comput polariz importantli balanc distribut comput time obtain number processor divid number conduct state main limit present implement repres storag polariz matrix inde distribut henc node must enough memori store memori tabl whose size given npwepssupsup x nomega x byte nomega total number frequenc comput test perform barcelona supercomput center see figur reveal first second part mpi algorithm good scale routin cchi cchiq rpa express comput step scale almost linearli processor degrad total speedup observ larg number processor mainli due portion comput parallel name read wfk file matrix invers qloop paral_mbt_assetsscreening_speeduppng paral_mbt_assetsscreening_rel_timespng point import technic detail implement cover final run abinit nn cpu core use mpirun abinit tmbt_abi tmbt_log err run input file tmb_abi use differ number processor keep track time processor number test scalabl implement perform analysi report figur obtain paw use zno test case observ similar behavior also siosubsub let us look output result sinc tutori mainli focus run effici mpi comput perform converg studi siosubsub paramet use input file alreadi close converg kpoint sampl number empti state increas might modifi input file perform standard converg test follow procedur describ first gw tutorialtutorialgw main output file section report band distribut among node sequenti calcul screen take advantag timerevers symmetri maximum band index partial occupi state nbvw remain band divid among processor nbcw number band treat node valu report last line decreas comput done processor memori alloc wavefunct scale number processor use grep util extract inform log file calcul sequenti grep memori need tmbt_log memori need store ug mb memori need store ur mb _ug_ denot intern buffer use store fourier compon orbit whose size scale linearli npwwfn _ur_ array store orbit real space fft mesh keep mind size _ur_ scale linearli total number point fft box number usual much larger number planewav npwwfn number fft divis use gw code extract main output file use grep setmesh tmbt_out setmesh fft mesh size select x x total number point discuss theorymbtnotesonthecalculationoftheoscillatormatrixelementssect gw note fast fourier transform repres one cpu intens part execut reason code provid input variabl fftgw use decreas number fft point better effici second digit input variabl gwmem instead govern storag real space orbit use avoid storag costli array _ur_ price increas comput time manual parallel qpoint comput effort requir screen comput scale linearli number qpoint explain theorymbttherpapolarizabilityinfourierspacesect gw note code exploit symmetri screen function irreduc brillouin zone ibz calcul explicitli hand larg number qpoint might need achiev converg result typic exampl gw calcul metal optic properti within bethesalpet formal enough process unit avail linear factor due qpoint sampl trivial absorb split calcul qpoint sever independ run use variabl nqptdm qptdm result gather uniqu binari file mean mrgscr util see also automat test testv_ testv_ testv_ comput screen parallel use hilbert transform method discuss theorymbtrpa_fourier_spacegw_not algorithm base adlerwis express optim mani frequenc want paragraph therefor discuss use hilbert transform method calcul rpa polariz dens frequenc mesh equat implement code document theorymbthilbert_transformin section usual copi file tmbt_abi work directori creat symbol link point wfk file ln tmbt_o_ds_wfk tmbt_i_wfk input file abi_teststutoparalinputtmbt_abi open look structur dialog teststutoparalinputtmbt_abi snapshot import paramet govern algorithm report gwcalctyp contourdeform techniqu spmeth enabl spectral method nomegasf number point spectral function gwpara parallel band awtr take advantag timerevers mandatori gwpara use freqremax ev frequenc mesh polariz nfreqr nfreqim input file similar one use adlerwis calcul input variabl spmeth enabl spectral method nomegasf defin number  point linear mesh use spectral function ie number  theorymbthilbert_transformequ spectral function discuss theorymbthilbert_transformgw note spectral function hilbert transform method much memori demand adlerwis approach mainli larg valu nomegasf usual need converg result fortun particular distribut data employ gwpara turn well suit calcul spectral function sinc processor store treat subset entir rang transit energi algorithm therefor present good mpiscal sinc number  frequenc store consid hilbert transform decreas number processor run abinit nn cpu core use mpirun abinit tmbt_abi tmbt_log err test scale vari number processor keep mind also case distribut comput work well balanc number cpu divid number conduct state memori need store spectral function report log file grep sf_chiq tmbt_log memori requir sf_chiq gb note size array decreas processor use figur show electron energi loss function eelf siosubsub calcul use adlerwis hilbert transform method might tri reproduc result eelf report file tmbt_o_eelf much denser ksampl requir achiev converg paral_mbt_assetscompawspectpng comput oneshot gw correct parallel last paragraph discuss calcul gsubsubwsubsub correct parallel gwpara basic equat use comput selfenergi matrix element discuss theorymbtevaluation_gw_sigmathi part gw note run calcul copi file tmbt_abi work directori creat two symbol link scr wfk file ln tmbt_o_ds_wfk tmbt_i_wfk ln tmbt_o_scr tmbt_i_scr open input file abi_teststutoparalinputtmbt_abi dialog teststutoparalinputtmbt_abi import paramet calcul report optdriv sigma run irdwfk irdscr gwcalctyp ppmodel gsubsubwsubsub calcul plasmonpol approxim gwcalctyp uncom line use contourdeform techniqu rememb chang scr file gwpara parallel band symsigma enabl symmetr selfenergi matrix element ecutwfn cutoff wavefunct ecutep cutoff correl part ecutsigx cutoff exchang part nband number band correl part purpos suffic say input file defin standard oneshot calcul plasmonpol model approxim refer document first gw tutorialtutorialgw complet descript mean variabl also case use gwpara perform calcul parallel note howev distribut orbit employ self energi part significantli differ one use comput screen follow briefli describ twostep procedur use distribut wavefunct node read store memori state qp correct comput list state specifi kptgw bdgw nband band distribut use follow partit scheme paral_mbt_assetsband_distribution_sigmapng assum calcul done four node index box denot mpi rank virtu particular distribut adopt comput correl part expect scale well number cpu maximum number processor use limit nband note howev subset processor receiv occupi state band distribut step consequ theoret maximum speedup obtain exchang part limit avail occupi state differ mpi node involv run bestcas scenario qp correct want occupi state case inde node comput part self energi almost linear scale reach worstcas scenario quasiparticl correct want state eg band gap calcul ncpu nvalenc case inde nvalenc processor particip calcul exchang part summar mpi comput correl part effici number processor divid nband optim scale exchang part obtain node possess full set occupi state two figur show speedup sigma part function number processor selfenergi calcul quasiparticl state use nband occupi state note setup close worstcas scenario comput selfenergi matrix element csigm scale well processor larg number number cpu scale depart linear behavior due unbalanc distribut occupi band nonscal part implement init rdkss limit total speedup due amdhal law paral_mbt_assetssigma_analysispng implement present good memori scalabl sinc largest array distribut size screen scale number node default cpu store memori entir screen matrix qpoint frequenc order optim comput case larg matric howev possibl opt outofcor solut singl qpoint store memori data read extern scr file slower less memori demand option control first digit gwmem know distribut load effici final run calcul use mpirun abinit tmbt_abi tmbt_log err keep track time processor number test scalabl selfenergi part pleas note result test converg well converg calcul would requir xx kmesh sampl full bz cutoff energi ha screen matrix qp result converg extrem slowli respect number empti state converg qp gap within ev accuraci includ band screen state calcul selfenergi comparison lda band structur gsubsubwsubsub energi band quartz siosubsub report figur direct gap  open significantli lda valu ev ev one shot gsubsubwsubsub method use invit reproduc result take account calcul perform theoret lda paramet experiment structur use input file tutori paral_mbt_assetssio_ksgw_ppmpng basic rule effici parallel calcul rememb anyth possibl go wrong write input file tri keep short simpl one thing well avoid use differ valu optdriv input file runlevel employ differ approach distribut memori cpu time henc almost imposs find number processor produc balanc run dataset prime number theorem converg studi execut parallel paramet test interfer mpi algorithm exampl converg studi number band screen done separ input file gwpara use less split big calcul smaller run whenev possibl exampl screen calcul split qpoint calcul selfenergi easili split kptgw bdgw look leap use converg test estim cputim memori requir depend paramet test estim comput resourc help one launch final calcul converg paramet author xuhe nh spin model multibinit build spin model run spin dynam multibinit lesson aim show build spin model run spin dynam calcul begin import know theori spin dynam found literatur egcit evan cite eriksson lesson learn run spin dynam calcul multibinit determin critic temperatur magnet phase transit calcul spin cant angl system dzyaloshinskiimoriya interact tbj python packag use gener spin model found websit httpsgithubcommailhexutbjhttpsgithubcommailhexutbj onlin documen found httpstbjreadthedocsiohttpstbjreadthedocsioenlatest begin might consid work subdirectori tutori work_spindyn tutorial_readm heisenberg model formal spin model implement multibinit defin classic heisenberg model current version multibinit consid follow interact exchang interact singl ion anisotropi sia dzyaloshinskimoriya dm interact extern magnet field total energi read e eexcesia edmeext exchang energi eexc written eexc sum_ineq j j_ij vecs_icdotvecs_j convent use multibinit note vec normal j_ij j_ji hamiltonian minu sign mean interact ferromagnet j_ij site j defin model finit cell often primit cell interact site cell site two differ cell posit vector site j differ cell site denot vecr_jvecr_jvecr vecr combin lattic vector site j cell site lattic vector vecr due translat symmetri choos lattic vector site vecrvec henc denot heisenberg coeffici j_ijvecr drop prime site differ cell sia term written esiak_u sum_i vecs_icdot vece k_u vece amplitud direct singl ion anisotropi dm term written edm sum_ineq j vecd_ijcdot vecs_itimesvecs_j vecd_ij amplitud dm interact extern magnet field term written eext sum_i m_i vecs_icdot vech m_i denot magnet moment site vech magnet field build spin model file one way calcul heisenberg model paramet use spin forc theorem see citeliechtenstein citekatsnelson one perturb system rotat local spin abinit hamiltonian use plane wave basi set thu local spin directli access construct local wannier function rewrit hamiltonian wannier basi exchang paramet calcul hamiltonian citekorotin build wannier function hamiltonian abinit see tutori wanniertutorialwanni dft code interfac wannierhttpwwwwannierorg also use tbjhttpsgithubcommailhexutbj packag use calcul heisenberg model paramet gener input model multibinit data store xml xml netcdf nc file use input multibinit calcul tutori file provid pleas read tbj tutorialhttpstbjreadthedocsioenlatest see creat xmlnetcdf file run spin dynam basic use multibinit run spin dynam spin model xml file run spin dynam calcul multibinit exampl input file found abinitteststutomultibinitinputtmulti_ three file tmulti_fil file file give name input output file multibinit tmulti_abi main input file contain paramet spin dynam simul tmulti_xml file contain heisenberg model paramet copi three file directori eg work_spindyn tmulti_fil three file name given tmulti_abi tmulti_abo tmulti_xml give input output xml file name file tmulti_xml contain j_ij valu simpl toy system cubic lattic one atom per unit cell critic temperatur around k tmulti_abi variabl run spin dynam calcul given prt_model ncell number unit cell supercel spin_dynam switch spin dynam spin_init_st ferromagnet initi state spin_temperatur temperatur spin kelvin spin_ntime_pr time step thermol spin_ntim time step measur spin_nctim number time step two write netcdf spin_dt e time step second spin_projection_qpoint wave vector summat spin sublattic spin_write_traj write spin trajectori netcdf file run spin dynam multibinit cd work_spindyn multibinit f tmulti_fil tmulti_txt note file file deprec next version abinit multibinit two file requir follow variabl input file use specifi spin potenti file prefix output file spin_pot_fnam tmulti_xml outdata_prefix tmulti_abo run spin dynam without use file file multibinit tmulti_abi f tmulti_txt calcul done find output file name tmulti_abo netcdf file tmulti_abo_spinhistnc abo file find line give overview evolut system time begin spin dynam step iter time avg_mstm etothauc thermal run e e e e e e e e e measur run e e e e e e e e e avg_mst m_i epi vecqcdotvecr_i mean averag stagger magnet moment ms satur magnet moment spin wavevector vecq multibinitspin_projection_qpoint align valu avg_mstm deviat due thermal fluctuat last column state total energi system per unit cell two stage warm measur whole spin dynam process thermal spin evolv toward equilibrium state temperatur defin input file measur stage step sampl calcul observ end run summari calcul summari spin dynam end run averag spin sublattic sublattic m_ix m_iy m_iz m_i structur one magnet site unit cell sublattic separ line print sublattic allow us see spin differ sublattic align follow observ print temperatur cv chi binderu mst e e e e cv volum specif heat c_veek_b e mean averag energi per unit cell observ time zero temperatur c_v c_v atom unit chi chi isotherm suscept chifracparti mpartial h mmk_b averag total stagger magnet moment zero temperatur chi well defin binderu binder cumul u_fracmm heisenberg system u_ goe tt_c goe t_c mst stagger magnet moment defin msum_i m_i expi vecqcdotvecr_i mst normal satur magnet moment maximum netcdf file trajectori spin found analyz use postprocess tool come back valu chosen input variabl tmulti_abi file essenti choos valu result calcul meaning therefor recommend converg studi concern follow paramet time step multibinit spin_dt typic time step optim time step determin tri sever valu compar result equilibrium magnet order moment etc calcul small time step eg stage small box temperatur close zero use supercel size multibinitncel due period boundari condit spin period could correl lead artifici increas eg phase transit temperatur also certain quantiti sampl use small box henc requir test quantiti interest converg supercel size antiferromagnet structur gener structur nonzero wave vector box size allow spin fit qvector ie vecqcdot vecn integ structur easi sometim imposs find vecn case larg box usual requir thermal timemultibinit spin_ntime_pr thermal time least allow spin relax equilibrium state see much time need system get equilibrium state plot magnet moment function time note relax equilibrium state usual take much longer near phase transit temperatur therefor import test relax time measur time multibinit spin_ntim order calcul observ longer time eg time relax time requir enough sampl gener real world exampl lafeo_ common usag spin dynam calcul magnet quantiti eg magnet moment suscept specif heat function temperatur determin critic temperatur phase transit one magnet phase anoth occur set multibinitspin_var_temperatur specifi start temperatur final temperatur number step seri calcul carri see eg abinitteststutomultibinitinputtmulti_ note paramet input file set bad valu let tri tune make meaning calcul dynam disabl molecular dynam ncell size supercel small spin_dynam run spin dynam spin_ntime_pr thermol step enough spin_ntim measur step enough spin_nctim number time step two write netcdf spin_dt e time step larg spin_init_st ferromagnet initi state problemat spin_projection_qpoint wave vector spin order spin_var_temperatur variabl temperatur calcul spin_temperature_start start temperatur spin_temperature_end final temperatur smaller neel temp spin_temperature_nstep number temperatur step enough spin_sia_add add singl ion anistropi sia term spin_sia_kamp e amplitud sia ha larg use spin_sia_kdir direct sia spin_calc_thermo_ob calcul thermodynam relat observ note run sever calcul differ temperatur might take minut two run trajectori temperatur written _t_spin_histnc _t_spin_histnc file spin_temperature_step sever way find critic temperatur natur way use mt curv howev difficulti chang magnet moment abrupt critic temperatur valu sensit box size specif heat magnet suscept diverg t_c therefor reliabl determin critic temperatur specif heat addit advantag need know magnet order calcul anoth option calcul binder cumul defin u_ fracm less sensit box size also chang abruptli t_c quantiti found end variou calcul output file summari variou run temperatur cv chi binderu mst e e e e e e e e e e e e e e e e also found vart file easi plot observ function temperatur averag magnet sublattic also file input paramet well tune obtain curv differ quantiti like follow result see neel temperatur k experiment t_n lafeo k tmulti_spin_model_assetstmulti_png exampl dmi cant afmchain studi system dzyaloshinskiimoriya interact dmi system simpl chain unit cell consist two site b shown exchang b j mev dmi vecd mev arrow b mean d_ab d_abd_ba input file found abinitteststutomultibinitinputtmulti_ canting_dmispin_model_assetscanting_dmipng system exchang favor collinear spin align dmi favor spin perpendicular neighbor usual dmi much smaller exchang interact thu system cant afm spin align run spin dynam zero temperatur get ground state calcul cant angl prt_model dynam disabl molecular dynam ncell size supercel spin_dynam enabl spin dynam depondtmerten algorithm spin_ntime_pr warm step spin_ntim number step spin_nctim number time step two nc file write spin_dt time step spin_init_st start random spin_temperatur e spin temperatur usual better avoid spin_sia_add add singl ion anistropi sia term spin_sia_kamp e ev amplitud sia mev easi axi hard axi spin_sia_kdir direct sia easi axi along x add rel small mev singl ion anisotropi term easi axi along x note dmi vecd along zaxi therefor lower energi spin x compon xy plane energi isotrop henc sia along x use break symmetri tri rotat sia direct xy plane see result chang also tri sia zdirect see happen end spin dynam find follow output last snapshot spin show spin antiparallel align along easi axi x cant toward yaxi cant angl arctan end run averag spin sublattic sublattic m_ix m_iy m_iz m_i tip antiferromagnet spin spiral structur exampl magnet structur antiferromagnet unit cell multipl spin period sometim unit cell use contain full period spin eg simpl cubic afm lattic one atom primit cell use magnet wave vector calcul stagger magnet moment also use spin spiral structur etc spin_projection_qpoint author ms mt third tutori projector augmentedwav paw techniqu test paw dataset allelectron code tutori demonstr test gener paw dataset allelectron code compar result open elk fplapw code branch excit code avail gplv learn compar calcul _equilibrium lattice_ paramet _bulk modulus_ _band structure_ abinit paw result elk code assum alreadi know use abinit paw case tutori assum previou experi elk code strongli advis user familiaris bit code attempt similar comparison dataset tutori take hh tutorial_readm introduct quantiti compar compar result allelectron pseudopotenti code usual imposs compar total energi total energi allelectron code includ contribut _kinet energy_ _core orbitals_ pseudopotenti approach inform retain densiti distribut frozen core typic even paw implement differ total energi compar calcul given accuraci usual long cumbersom process howev thing calcul rel eas includ structur properti equilibrium lattic paramet bulk modulu well orbit energi ie band structur simpl bulk system note aim compar result similar numer condit necessarili mean calcul compar experiment result result calcul individu repres absolut converg valu given system howev ensur numer precis equival must take care use scalarrelativist exchangecorrel function match elk muffintin radii paw cutoff radii use kpoint grid similar qualiti use similar cutoff plane wave expans freez core elk code whenev possibl match frozen paw core abinit use similar atom onsit radial grid use carbon diamond structur exampl simpl solid band gap use magnesium exampl metal solid natur import keep thing simpl possibl benchmark paw dataset problem element natur occur pure solid phase element molecular pure state like oxygen nitrogen forth occur compound solid one solut compar result larger rang solid constitu alreadi well test instanc oxygen one could compar result zno mgo mno provid one alreadi satisfi oneself dataset zn mg mn pure form good one could also compar result molecul encourag time howev consist abinit requir supercel approach would make tutori long shall discuss prerequisit tutori prerequisit code compon script assum alreadi familiar content procedur tutori pawtutorialpaw pawtutorialpaw familiar input file atompaw issu creat paw dataset exactli reproduc result tutori need atompaw code gener paw dataset see tutori pawtutorialpaw section sh cd atompawxyz mkdir build cd build configur make elk code tutori design v avail herehttpssourceforgenetprojectselkfil use elk code well eo equationofst util calcul equilibrium lattic paramet auxiliari bash python _scripts_ comparison band structur avail directori abi_homedoctutorialpaw_assetsscript python script python requir also variou gnuplot script cours also need work copi abinit pleas make sure compon download work system continu tutori tutori also make extens use gnuplot pleas also ensur recent work version instal system note time tutori probabl newer version program avail cours better use latest version simpli state version code use tutori written specif numer result reproduc necessari carbon diamond carbon simpl datatset make _work directory_ atompaw gener could call c_atompaw copi file c_simpleinputpaw_assetsinputsc_simpleinput dialog tutorialpaw_assetsinputsc_simpleinput go run atompaw type assum set thing run atompaw type atompaw atompaw c_simpleinput code run ls content directori someth like c densiti logderiv potsc tprod wfn wfnsc cldapwpawxml dummi nc rvf vloc wfn cldapwpawxmlcorewf fort occwfn rvx wfn wfn compareabinit logderiv pota tau wfn wfn c_simpleinput logderiv potenti tprod wfn wfnae lot output use work graphic overview copi gnuplot _script_ plot_c_allppaw_assetsscriptsplot_c_allp folder open new termin window type xterm run gnuplot new termin window gnuplot command prompt type gnuplot load plot_c_allp get plot look like plot atompaw outputspaw_assetsimagesplot_c_all_png keep gnuplot termin plot window open work chang atompaw input file rerun updat plot retyp load command gnuplot window plot essenti inform atompaw output logarithm deriv deriv dataset green wavefunct projector momentum channel full wavefunct red pw part green projector blue well local potenti final show fourier transform projector product xaxi unit ha input directori also contain script plot graph individu encourag test modifi look insid c_simpleinput file dialog tutorialpaw_assetsinputsc_simpleinput see current dataset simpl basi state beyond p occupi valenc state carbon thu expect produc good result sinc almost flexibl paw dataset note scalarrelativist option turn strictli necessari light atom must alway ensur turn intend compar result elk code run basic converg test abinit dataset dataset file abinit alreadi gener cldapwpawxml file current directori make new subdirectori test current directori could call abinit_test instanc go copi file ab_c_testabipaw_assetsinputsab_c_testabi abinit input file contain sever dataset increment ecut input variabl perform ground state band structur calcul valu ecut thu intern abinit converg studi dataset expect converg result sooner later mean final result accur unless dataset good goal cours gener dataset converg quickli accur dialog tutorialpaw_assetsinputsab_c_testabi ab_c_testabi file contain pseudoscldapwpawxml pp_dirpath outdata_prefixoutputsab_c_test_o tmpdata_prefixoutputsab_c_test expect newli gener dataset directori also keep thing tidi assum output put subdirectori call output make sure creat start abinit run write mkdir output import may chang path reach psps_for_test repositori modifi varaibl pp_dirpath input file run abinit test mayb even separ new xterm window execut abinit ab_c_testabi log_c_test doubleindex dataset total first index run second check progress calcul issu ls output _o_d file appear calcul finish calcul run might want take look input file note line pertain increment ecut around line cutoff variabl ecut ecut pawecutdg ecutsm ecut increas increment ha initi valu final ecut ha note pawecutdg kept fix valu high enough expect good final valu ecut principl converg studi pawecutdg perform well good valu ecut found check basic converg attribut dataset converg total energi easili check issu grep command grep etot ab_c_testabo give output similar though text left etot ecut etot e etot e mha ha etot e mha ha etot e mha ha etot e mha ha etot e mha ha etot e mha ha etot e mha ha etot e mha ha valu might differ slightli last decim calcul diamond current paw carbon dataset converg precis total energi mha cutoff ha particularli good paw dataset also converg bit jumpi ecut ha indic number projector per angular momentum channel low b paramet apart ecut domin converg beyond point turn _band structure_ use script comp_bands_abinitabinitpypaw_assetsscriptscomp_bands_abinitabinitpi check converg band structur copi script directori abinit input file issu python comp_bands_abinitabinitpi outputsab_c_test_o_ds_eig outputsab_c_test_o_ds_eig ev print long seri column end see nval averag diff ev minimum diff ev maximum diff ev note abinit valu read fix format five decim place low valu four three decim figur may highest precis get provid statist differ band energi specif averag differ band structur calcul ecut ha dataset anoth ecut ha dataset differ dataset natur larg ev averag bandstructur first dataset far converg column output statist arrang pipe output data file python comp_bands_abinitabinitpi outputsab_c_test_o_ds_eig outputsab_c_test_o_ds_eig ev bands_ha_vs_hadat plot two band structur gnuplot directli enter gnuplot plot bands_ha_vs_hadat u w lp titl ha bands_ha_vs_hadat u w lp titl ha furnish graph look someth like comparison band vs hapaw_assetsimagesplot_c_band_png surprisingli band structur differ howev search dataset increas index ie ds ds ds yield dataset ie ecut ha alreadi converg level ev issu command python comp_bands_abinitabinitpi outputsab_c_test_o_ds_eig outputsab_c_test_o_ds_eig ev bands_ha_vs_hadat plot gnuplot plot bands_ha_vs_hadat u w lp titl ha bands_ha_vs_hadat u w lp titl ha give plot similar comparison band vs hapaw_assetsimagesplot_c_band_png convinc zoom band structur similar statist end bands_ha_vs_hadat file show converg within abinit nval averag diff ev minimum diff ev maximum diff ev carbon calcul equilibrium lattic paramet converg dataset cours mean dataset good ie reproduc result allelectron calcul independ verifi dataset good need calcul equilibrium lattic paramet _bulk modulus_ compar band structur elk calcul first need calcul total energi diamond abinit number lattic paramet around minimum total energi exampl input file ab_c_equiabipaw_assetsinputsab_c_equiabi new input file ten dataset increment lattic paramet alatt bohr step bohr look input file tell ecut set hartre copi abinit_test directori run dialog tutorialpaw_assetsinputsab_c_equiabi abinit ab_c_equiabi log_c_equi run done fairli quickli done check volum total energi use grep grep volum log_c_equi grep etot log_c_equi output someth like unit cell volum ucvol e bohr unit cell volum ucvol e bohr unit cell volum ucvol e bohr unit cell volum ucvol e bohr unit cell volum ucvol e bohr unit cell volum ucvol e bohr unit cell volum ucvol e bohr unit cell volum ucvol e bohr unit cell volum ucvol e bohr unit cell volum ucvol e bohr etot e etot e etot e etot e etot e etot e etot e minimum around etot e etot e etot e examin etot valu total energi inde go minimum also see given magnitud variat total energi ecut ha suffici extract equilibrium volum bulk modulu use eo bundl elk requir us put data eosin file creat file favorit editor enter follow five line data extract c diamond cname name materi natom number atom etyp equat state fit type vplt vplt nvplt start end pt fit nevpt number suppli point e e e e e e e e e e e e e e e e e e e e run eo execut locat srceo directori elk compil produc sever file file paramout contain inform need c diamond univers eo vinet p et al j phi conden matter p default unit atom hartre bohr etc v e b e b b gpa tell us equilibrium volum bulk modulu volum diamond fcc lattic depend lattic paramet fraca want convert volum lattic paramet multipli four take third root alatt bohr  equilibrium dataset carbon allelectron calcul order estim whether valu good need independ verif provid allelectron elk code elk input file match abinit diamond calcul elk_c_diamondinpaw_assetsinputselk_c_diamondin need copi file directori set elk run call c_elk need renam elkin requir input name elk calcul readi run elk code first time take look elkin file begin see line carbon diamond structur fcc task keyword defin done code perform groundstat calcul scratch restart gs calc stateout file calcul band structur defin plotd task set coreval cutoff energi ecvcut construct atom speci file cin speci atom number c carbon atom mass muffintin radiu number occ state p p dialog tutorialpaw_assetsinputselk_c_diamondin text exclam mark colon line defin data comment keyword task defin code case set calcul ground state given structur calcul band structur block ecvcut set coreval cutoff energi next input block speci defin paramet gener atom speci file given name cin first step need gener file need modifi perform main calcul therefor run code briefli run execut directori kill second use ctrlc instanc soon gener cin file look directori code kill probabl see lot file uppercas name elk output file also see cin file open see c spsymb carbon spname spzn spmass e rminsp rmt rmaxsp nrmt nstsp nsp lsp ksp occsp spcore f f f apword f apw apwdm apwv nlx nlorb lorbl lorbord f lorb lorbdm lorbv f lorbl lorbord f lorb lorbdm lorbv f lorbl lorbord f lorb lorbdm lorbv first four line contain inform pertain symbol name charg mass atom fifth line hold data concern numer grid distanc first grid point origin muffintin radiu maximum radiu onsit atom calcul number grid point subsequ line contain data occupi state one end f inform pertain fplapw onsit basi function first import thing check whether orbit includ valenc state paw dataset treat valenc speci file check f correspond state occup list spn spl spk spocc spcore f f f first two number n l quantum number atom state see state p state set valenc paw dataset note might case gener version elk use modifi accept adjust _cutoff energy_ determin whether state treat core valenc set line ecvcut coreval cutoff energi elkin file find mani state includ valenc anoth atom speci valu need adjust downward upward second thing need check whether number grid point _muffintin_ radiu use elk calcul roughli equival paw one look paw dataset gener ie cldapwpawxml file line radial_grid eqraexpdi e e istart iend idlog valu defin paw grid use wavefunct densiti potenti approxim match intens grid modifi fifth line cin file e sprmin rmt sprmax nrmt e sprmin rmt sprmax nrmt need comment speci gener input block elkin file construct atom speci file cin speci atom number c carbon atom mass muffintin radiu number occ state p p note import comment line speci file cin regener run elk modif lost time start elk code run produc lot file rare anyth output screen unless error messag track progress elk calcul use tail command tail f infoout get tail press crtlc calcul run might want familiaris differ input block elkin file elk run finish bandout file run directori analog band structur comparison use python script comp_bands_abinitelkpypaw_assetsscriptscomp_bands_abinitelkpi copi current directori previou abinit calcul subdirectori pathabinit_test write python comp_bands_abinitelkpi pathabinit_testoutputsab_c_test_o_ds_eig bandout ev get end line nval averag diff ev minimum diff ev maximum diff ev look like huge differ howev someth forgotten pipe data file write python comp_bands_abinitelkpi pathabinit_testoutputsab_c_test_o_ds_eig bandout ev bandsdat plot gnuplot gnuplot plot bandsdat u w lp titl abinit bandsdat u w lp titl elk get graph like comparison abinit elk band without shiftpaw_assetsimagesband_abinit_elk_ipng see band structur look alik differ absolut shift normal period system uniqu vacuum energi band energi alway defin arbitrari constant shift shift depend numer detail differ differ code use differ numer approach note elk input file keyword xctype control type lda gga exchangecorrel function howev decid upon refer pont like valenc band maximum vbm point nearbi align two band plot point still differ compar plot made see vbm ninth kpoint left band four script use previous accomod shift issu command python comp_bands_abinitelkpi pathabinit_testoutputsab_c_test_o_ds_eig bandout align ev keyword align present follow kpoint index band number order script align point natur make posit particular point fit perfectli look end output averag occupi state nval averag diff ev minimum diff ev maximum diff ev averag unoccupi state nval averag diff ev minimum diff ev maximum diff ev tell true rest point sinc script assum align vbm separ statist occupi unoccupi band uppermost unoccupi band fit badli depend precis ask abinit especi nbdbuf use fit quit bad gener averag ev differ occupi state ev differ unoccupi state plot ouput pipe bandsdat file execut gnuplot command get plot comparison abinit elk band shiftpaw_assetsimagesband_abinit_elk_iipng scale band plot small visibl differ two note deviat usual larger away highsymmetri point import choos point away well make comparison howev difficult conclud visual band structur bad dataset without use statist output _script_ without sens precis expect creat gold standard elk calcul also need calcul equilibrium lattic paramet bulk modulu diamond elk code unfortun elk use dataset variou lattic paramet use abinit structur search put one one hand code run lattic paramet abinit run increment make ten run total perform first simpli edit elkin file chang keyword line scale lattic paramet bohr scale lattic paramet bohr note also chang keyword frozencr fals time write error calcul total energi frozen corest mean elk input file must keyword line frozencr fals determin paramet depend total energi safe set true band structur calcul howev differ lattic paramet use frozen versu unfrozen core state allelectron calcul expect order bohr final dont need calcul band structur run might wand chang task keyword section line task task youv done modif run elk run finish look totenergyout latticeout file get converg total energi volum write save safe place edit elkin file forth youv calcul ten energi correspond ten lattic paramet valu end get list put eosin file c diamond elk cname name materi natom number atom etyp equat state fit type vplt vplt nvplt start end pt fit nevpt number suppli point valu might slightli differ last decim depend system run eo util get v b gpa alatt bohr  see initi primit abinit dataset gpa _bulk modulus_ bohr away correct valu lattic paramet principl order magnitud better let us see make carbon improv dataset know target valu experi see improv dataset techniqu well document tutori pawtutorialpaw here brief summari main point concern use keyword seri custom rrkj custom polynom custom polynom want maximum control converg properti projector check logarithm deriv care presenc ghost state dataset intend groundstat calcul need rule thumb least two projector per angular momentum channel occupi state need reproduc accur need perform calcul involv fock oper unoccupi state like gw calcul instanc probabl need least three projector might also want add extra projector complet unoccupi lchannel benchmark optim atom dataset carbon tri check converg properti equilibrium lattic paramet bulk modulu band input file c atom name number ldapw scalarrelativist loggrid logderivrang xc approx se type gridtyp pt logderiv maximum n l spdf partial fill shell p stop marker c core v valenc v p valenc l_max treat core radiu r_c add unocc sstate refer energi n unoccupi sstate add unocc pstate refer energi n unoccupi pstate custom polynom vanderbiltortho sinc complic scheme projector ultrasoft localis scheme core radiu occ state core radiu unoocc state core radiu occ p state core radiu unocc p state xmlout run atompawabinit convert prtcorewf noxcnhat nosplin noptim abinit convers option stop marker gener atom data file replac item old input file want make new directori studi might want tri modifi gnuplot script work correctli dataset wfn file order like core radiu list end mean number file chang exampl modif plot script plot_c_all_iippaw_assetsscriptsplot_c_all_iip download run gnuplot get plot like plot info second carbon datasetpaw_assetsimagesplot_c_all_iipng note much better fit logarithm deriv chang shape projector function blue wfn plot due complic scheme use optimis gener dataset like run abinit ecut test dataset ab_c_testabi abinit input file get etot converg like valu left help etot ecut etot e etot e mha ha etot e mha ha etot e mha ha etot e mha ha etot e mha ha etot e mha ha etot e mha ha etot e mha ha dataset alreadi seem converg mha ecut ha much effici comparison band unit ev dataset give nval averag diff ev minimum diff ev maximum diff ev also show much faster converg dataset accur enough well run abinit equilibrium paramet input file ab_c_equiabi get data eosin file c diamond second paw dataset cname name materi natom number atom etyp equat state fit type vplt vplt nvplt start end pt fit nevpt number suppli point e e e e e e e e e e e e e e e e e e e e fed eo give us equilibrium data v b gpa alatt bohr  comparison list previou valu equilibrium bulk modulu lattic volum v b paramet  st primit paw dataset  nd better paw dataset  elk allelectron obviou second dataset much better first one comparison converg valu band use command python comp_bands_abinitelkpi ab_c_test_o_ds_eig bandout align ev assum file need current directori extra command paramet end mean align th kpoint fourth band convert valu ev align band structur valenc band maximum statist print end someth like averag occupi state nval averag diff ev minimum diff ev maximum diff ev averag unoccupi state nval averag diff ev minimum diff ev maximum diff ev show precis averag slightli better ev four occupi four lowest unoccupi band pipe output file plot band visual inspect better dataset probabl mean best possibl like one construct dataset carbon even better converg properti even accur encourag experi tri make better one magnesium deal fermi energi metal system ad complic system metal treatment smear use order elimin sharp peak _densiti states_ do near fermi energi do technic integr groundstat calcul metal requir principl infinit kpoint grid order resolv fermi surfac practic smear function use usual quit larg finit number kpoint suffici smear function certain spread control smear paramet optimum valu paramet depend kpoint grid use kpoint grid becom denser optimum spread becom smaller valu converg toward ideal counterpart limit smear infinit dens grid problem abinit find optimum smear paramet take potenti time consum converg studi howev luck elk code option automat determin smear paramet thu use elk code first set rel dens kmesh calcul equilibrium bulk modulu lattic paramet band structur make sure match automat determin smear width importantli make sure match smear function use elk abinit calcul magnesium allelectron calcul elk input file prepar elk_mg_bandinpaw_assetsinputselk_mg_bandin suggest copi subdirectori dedic mg elk calcul mg_elk renam elkin take look insid input file dialog tutorialpaw_assetsinputselk_mg_bandin section familiar defin lattic vector structur etc mg atom hexagon unit cell coupl new line metal case metal option stype smear type gaussian autoswidth true automat determin swidth run elk file start groundstat run might take time due dens kpoint mesh automat determin smear width end calcul final valu swidth determin easili extract grep grep smear infoout furnish list automat determin smear width new smear width e new smear width e new smear width e new smear width e new smear width e new smear width e new smear width e new smear width e new smear width e new smear width e new smear width e new smear width e new smear width e new smear width e new smear width e new smear width e last valu one seek ie smear converg sinc elk file also calcul band structur bandout file end calcul compar abinit band structur one thing need check fermi energi grep fermi infoout fermi fermi fermi fermi fermi fermi fermi fermi fermi fermi fermi fermi fermi fermi fermi fermi last one fermi energi converg need later compar band structur align band plot fermi energi time calcul equilibrium lattic paramet prepar file elk_mg_equiinpaw_assetsinputselk_mg_equiin dialog tutorialpaw_assetsinputselk_mg_equiin copi directori renam elkin layout file look pretti much like one except band structur keyword miss switdth fix valu extract metal option stype smear type gaussian swidth e smear width calcul equilibrium lattic paramet go use bulk modulu quantiti defin respect scale entir cell oppos _young modulus_ instanc defin respect linear scale along lattic vector handi scale keyword elk accomplish us look region lattic defin defin lattic vector magnesium hexagon nativ structur ab  c  alpha beta gamma experiment degre celsiu scale factor appli lattic vector scale also need perform sever calcul like diamond case need chang valu scale keyword one good set valu would ie chang scale step seven valu total space around experiment equilibrium lattic structur run collect valu unit cell volum total energi seven run set number put eosin file depend system actual valu may differ slightli mg bulk metal natom number atom etyp equat state fit type vplt vplt nvplt start end pt fit nevpt number suppli point upon use eo util get standard type output paramout mg bulk metal univers eo vinet p et al j phi conden matter p default unit atom hartre bohr etc v e b e b b gpa translat term lattic paramet equilibrium scale factor given scale fracv_v_frac fracfrac v_ volum scale set multipli basi vector scale factor equilibrium bulk modulu lattic volum v b paramet b  c  inform need proceed abinit calcul magnesium abinit calcul usual best prepar separ subdirectori atom data abinit test assum subdirectori creat mkdir mg_atompaw mkdir mg_atompawabinit_test mkdir mg_atompawabinit_testoutput current directori mg_atompaw mg atompaw input use file mginputpaw_assetsinputsmginput dialog tutorialpaw_assetsinputsmginput note realli mani projector dataset two per angular momentum channel possibl make much better ad extra projector mayb even unoccupi dstate run atompaw look bundl plot_mg_allp file other like get feel qualiti dataset gener abinit dataset file make sure given mg_atompawmg_ldapwpawxml go subdirectori abinit test copi file ab_mg_testabipaw_assetsinputsab_mg_testabi ab_mg_equiabipaw_assetsinputsab_mg_equiabi file test converg alreadi set smear strategi equival elk one evidenc line dialog tutorialpaw_assetsinputsab_mg_testabi dialog tutorialpaw_assetsinputsab_mg_equiabi paramet metal tsmear e occopt insid occopt input variabl correspond exactli gaussian smear default elk code fact th order methfesselpaxton express citemethfessel possibl compar entri keyword stype elk manual entri occopt abinit run test input file comput sever core might want take advantag run abinit parallel test suit take time complet dens _kpoint mesh sampling_ make sure pipe screen log file log_mg_test run finish check converg properti ecut ha definit enough interest thing compar band structur first need check fermi energi abinit calcul grep grep fermi log_mg_test see long list fermi energi one iter final converg toward one number newocc new fermi energi nelect newocc new fermi energi nelect newocc new fermi energi nelect last one final _fermi energy_ abinit calcul abinitelk band comparison _script_ given _fermi energies_ two differ calcul align band structur copi bandout file elk calcul current directori well band comparison script comp_bands_abinitelkpi script also use align band differ fermi energi howev bandout file elk band alreadi shift fermi energi zero align abinit file requir python comp_bands_abinitelkpi outputsab_mg_test_o_ds_eig bandout fermi ev issu command provid final line nval averag diff ev minimum diff ev maximum diff ev mean averag accur ev pipe output file bands_abinit_elkdat go gnuplot use script plot_mg_bandsp gnuplot load plot_mg_bandsp get plot look someth like comparison mg abinit elk band alignet fermi levelpaw_assetsimagesband_abinit_elk_iiipng see band fit quit well final structur run ab_mg_equiabi file give us inform need creation eosin file mg bulk metal abinit natom number atom etyp equat state fit type vplt vplt nvplt start end pt fit nevpt number suppli point e e e e e e e e e e e e e e eo util run get equilibrium volum bulk modulu v b gpa convert lattic paramet compar elk run equilibrium bulk modulu lattic volum v b paramet b  c  elk b  c  abinit close decent dataset groundstat calcul probabl made even better encourag tri paw dataset gw calcul number issu consid make dataset gw calcul list care need taken logarithm deriv match much higher energi groundstat calcul least match well energi unoccupi state use calcul easiest way ensur increas number projector per state onsit basi need higher qualiti minimis truncat error due finit number onsit basi function projector requir projector per angular momentum channel rule thumb paw dataset gw least three projector per state particularli sensit thing qualiti expans pseudis planewav part term onsit basi check use densiti state do describ first paw tutorialtutorialpaw author xg welcom overview abinit tutori tutori aim teach use abinit unixlinux os variant maco aix etc might use oper system command adapt present nearli forti tutori avail two hour student work tutori cover basic lectur special depend tutori follow schema help understand depend center map idmap namemap area shaperect coord hrefbaseindexhtml area shaperect coord hrefspinindexhtml area shaperect coord hrefpawindexhtml area shaperect coord hrefpawindexhtml area shaperect coord hrefpawindexhtml area shaperect coord hrefnucindexhtml area shaperect coord hrefdftuindexhtml area shaperect coord hrefdmftindexhtml area shaperect coord hrefucalc_crpaindexhtml area shaperect coord hrefudetindexhtml area shaperect coord hreftddftindexhtml area shaperect coord hrefpositronindexhtml area shaperect coord hrefffieldindexhtml area shaperect coord hrefcutdindexhtml area shaperect coord hreffoldblochindexhtml area shaperect coord hrefwannierindexhtml area shaperect coord hrefdevelopersdevelopers_howtoindexhtml area shaperect coord hrefrfindexhtml area shaperect coord hrefopticindexhtml area shaperect coord hrefrfindexhtml area shaperect coord hrefelasticindexhtml area shaperect coord hreflattice_modelindexhtml area shaperect coord hrefspin_modelindexhtml area shaperect coord hrefnloindexhtml area shaperect coord hrefeph_introindexhtml area shaperect coord hrefeph_introindexhtml area shaperect coord hrefephmobindexhtml area shaperect coord hrefephzprindexhtml area shaperect coord hrefgwindexhtml area shaperect coord hrefgwindexhtml area shaperect coord hrefbseindexhtml area shaperect coord hrefbaseparindexhtml area shaperect coord hrefparal_gspwindexhtml area shaperect coord hrefparal_moldynindexhtml area shaperect coord hrefparal_imagesindexhtml area shaperect coord hrefparal_gswvlindexhtml area shaperect coord hrefparal_dfptindexhtml area shaperect coord hrefparal_mbtindexhtml map img styleheight px width px altschema srcindex_assetstutorial_flowchart_vpng usemapmap center base tutori present top orang block red repres addit tutori relat groundstat featur responsefunct featur explain tutori light brown block final manybodi perturb theori capabl demonstr tutori belong dark brown block righthand side block gather tutori relat parallel insid abinit visualis tool cover abinit tutori power visualis procedur develop abipi context reli matplotlib see readm abipyhttpsgithubcomabinitabipi abipi tutorialshttpsgithubcomabinitabitutori follow tutori read new user guideguidenew_us well page citepaynerev mod phi time brows chap appendic l book citemartinthi book r martin latter refer must yet use anoth electron structur code quantum chemistri packag tutori might find use learn test case contain subdirectori abinittest eg directori fast v v provid mani exampl input file look readm file directori tutori basic concept compil howto tutorialcompil explain compil abinit sourc includ extern librari advanc topic use modul supercomput center compil link intel compil mkl librari well openmp thread also discuss tutori present basic concept form global entiti skip tutori base deal h molecul get total energi electron energi charg densiti bond length atomis energi tutori base deal h molecul converg studi lda versu gga tutori base deal crystallin silicon insul definit kpoint grid smear cutoff energi comput band structur converg studi tutori base deal crystallin aluminum metal surfac occup number smear fermidirac distribut surfac energi converg studi tutori present special topic miscellan advanc tutori group tutori start without prerequisit tutori order except though tutori spin abinitspin present properti relat spin spinpolar calcul spinorbit coupl tutori use paw pawpaw present projectoraug wave method implement abinit altern normconserv pseudopotenti sizeabl accuraci cpu time advantag tutori gener paw atom data file pawpaw present gener atom data use paw method prerequisit paw tutori valid paw atom datafil pawpaw demonstr test gener paw dataset use abinit elk allelectron code diamond magnesium prerequisit paw paw tutori properti nucleinuc show comput electr field gradient prerequisit paw tutori wannierwanni deal wannier librari obtain maxim local wannier function tutori polar finit electr fieldffield deal comput polar insul eg ferroelectr dielectr materi thank berri phase approach also present comput materi properti presenc finit electr field also thank berri phase approach tutori electronpositron annihilationpositron show perform twocompon densityfunct theori tcdft calcul paw framework obtain positron lifetim perfect materi lifetim positron local vacanc electronpositron momentum distribut wavefunct densiti tutori cutdcutd deal use cutd util analys wavefunct densiti tutori foldbloch postprocessorfoldbloch deal use foldbloch util unfold band structur supercel calcul tutori dftudftu show perform dftu calcul use abinit lead comput project do nio prerequisit paw tutori dftdmftdmft show perform dftdmft calcul srvo use project wannier function prerequisit dftu tutori calcul effect interact u j crpa methoducalc_crpa show determin u valu constrain random phase approxim use project wannier orbit prerequisit dftu tutori determin u dftuudet show determin u valu linear respons method use dftu approach prerequisit dftu tutori tddfttddft deal comput excit spectrum finit system thank timedepend densiti function theori approach casida formal howto guid developersdevelopersdevelopers_howto introduc new develop develop new function abinit dfptrelat tutori addit group tutori densityfunct perturb theori phonon optic dielectr constant electronphonon interact elast respons nonlinear optic raman coeffici piezoelectr common addit inform need tutori dfpt rf respons function rf present basic dfpt within abinit exampl given studi dynam dielectr properti ala insul phonon gamma dielectr constant born effect charg loto split phonon whole brillouin zone creation deriv data base ddb present addit inform given tutori dfpt open door tutori dfpt rf respons function rf present analysi ddb introduc preceed tutori rf comput interatom forc comput thermodynam properti outcom tutori tutori opticopt util allow obtain frequenc depend linear optic dielectr function frequenc depend second order nonlinear optic suscept simpl sumoverst approxim addit inform given tutori dfpt dfpt optic need open door sever tutori group tutori start comput elast properti follow two multibinit tutori tutori nonlinear optic group electronphonon tutori tutori elast propertieselast present comput respect strain perturb respons elast constant piezoelectr first tutori multibinitlattice_model present basic use multibinit applic build harmon model use secondprincipl approach lattic dynam simul base atom potenti fit firstprincipl calcul second tutori multibinitspin_model present build spin model run spin dynam multibinit tutori static nonlinear propertiesnlo present comput respons beyond linear order within densityfunct perturb theori beyond simpl sumoverst approxim raman scatter effici nonreson case nonlinear electron suscept electroopt effect comparison finit field techniqu combin dfpt calcul finit differ calcul also provid introduct tutori electronphonon interactioneph_intro present electronphonon driver integr abinit execut discuss import technic detail relat implement associ input variabl drawbacksadvantag respect implement avail anaddb also discuss tutori mobil calculationsephmob explain comput phononlimit carrier mobil semiconductor within relax time approxim rta tutori zeropoint renorm temperaturedepend electron structureephzpr explain obtain electron selfenergi due phonon comput zeropoint renorm zpr band gap well temperaturedepend band gap whole electron structur two obsolet tutori electronphonon interact still present implement still avail time write supersed new implement describ abovement tutori prerequisit also tutori dfpt dfpt optic need obsolet tutori electronphonon interactioneph present use util mrgkk anaddb examin electronphonon interact subsequ calcul superconduct temperatur bulk system obsolet tutori temperatur depend electron structuretdep present comput temperatur depend electron structur zeropoint motion effect lifetimebroaden eigenenergi mbptrelat tutori anoth addit group tutori manybodi perturb theori gw approxim bethesalpet equat done sequenti first tutori gw gwgw deal comput quasiparticl band gap silicon semiconductor gw approxim much better kohnsham lda band structur plasmonpol model second tutori gw gwgw deal comput quasiparticl band structur aluminum gw approxim much better kohnsham lda band structur without use plasmonpol model tutori bethesalpet equat bsebs deal comput macroscop dielectr function silicon within bethesalpet equat tutori parallel concern parallel anoth set special tutori tutori suppos familiar correspond tutori sequenti calcul introduct abinit parallelbasepar read go next tutori parallel one simpl exampl parallel abinit shown parallel groundstat calcul plane wavesparal_gspw present combin kpoint k planewav g band b spinspinor parallel abinit kgb parallel comput total energi densiti ground state properti parallel molecular dynam calculationsparal_moldyn parallel base imagesparal_imag eg determin transit path neb string method pimd activ alon top parallel eg kgb parallel forc calcul parallel groundstat calcul waveletsparal_gswvl present parallel abinit wavelet use basi function instead planewav comput total energi densiti ground state properti parallel dfpt calculationsparal_dfpt need familiar calcul respons properti within abinit see tutori dfpt rfrf parallel manybodi perturb calcul gwparal_mbt allow speed calcul accur electron structur quasiparticl band structur includ manybodi effect note note featur abinit cover tutori complet featur list pleas see topicindextop page exampl use featur pleas see abinittest directori accompani readm file learn compil code sourc pleas consult guid emb srchttpswikiabinitorglibexefetchphpmediabuildinstalling_abinitpdf typeapplicationpdf width heightpx author ss xg tutori foldbloch unfold electron structur lattic hydrogen atom supercel often use electron structur calcul order model compound alloy defect etc band structur obtain directli calcul hard interpret due brillouin zone fold result reduc size supercel compar unperturb host unit cell unfold techniqu use abinit one present citerubel tutori aim demonstr unfold band structur supercel present basi convent bloch wave vector inher unperturb unit cell construct supercel hydrogen atom perform selfconsist cycl plot correspond band structur end recov familiar dispers relat use foldbloch util see also helpfoldbloch tutori take hour tutorial_readm creat hydrogen supercel structur let begin simplest structur lattic hydrogen atom conveni start point sinc hybrid sorbit result well known dispers relat energi eigenvalu function wave vector k eke_ coskb b lattic space reflect strength hybrid adjac sorbit detail pleas refer feynman lectur physic vol chapter model structur cubic lattic hydrogen atom space bohr apart primit cell contain one atom chose repres structur atom supercel larg cell redund case sinc noth disturb origin symmetri howev made choic purpos order observ zone fold foldbloch_assetsfigpng fig primit unit cell xx supercel b repres cubic lattic hydrogen atom sinc interest band structur need select path reciproc space use plot supercel expand z direct accordingli reciproc space shrink along direct select direct band structur plot affect zone fold foldbloch_assetsfigpng fig brillouin zone supercel begin might consid work differ subdirectori tutori work_foldbloch order use foldbloch need first gener wave function file wfk file purpos copi file teststutorialinputtfoldbloch_abi directori abinitteststutorialinputwork_foldbloch sh cd abi_teststutorialinput mkdir work_foldbloch cd work_foldbloch cp tfoldbloch_abi dialog teststutorialinputtfoldbloch_abi input file two dataset first gener wfk file second draw band structur readi run abinit issu follow abinit tfoldbloch_abi tfoldbloch_log gener self consist charg densiti hydrogen atom supercel structur wave function file tfoldbloch_o_ds_wfk need unfold foldbloch fold band structur proceed unfold let plot standard band structur supercel look signatur zone fold order sever possibl might eg reli abipi see matlab tutori init illustr use matlab need follow script energy_eigabinitsh plot_bandm locat abi_homedoctutorialfoldbloch_asset copi work directori execut energy_eigabinitsh script energy_eigabinitsh tfoldbloch_o_ds_eig gener output file tfoldbloch_o_ds_eigdat edit plot_bandm file point newli creat tfoldbloch_o_ds_eigdat file dataloadtfoldbloch_o_ds_eigdat run plot_bandm script matlab plot_bandm plot band structur atom hydrogen supercel creat lastli compar imag obtain band structur imag foldbloch_assetsfigpng fig atom hydrogen supercel band structur plot see band structur look like cosin function along direct ygamma zgamma band structur fold accord multipl along direct use construct supercel fig b tip abipi instal machin use abiopen script expos option visual band dispers abiopenpi tfoldbloch_o_ds_gsrnc expos foldbloch_assetsabiopen_tfoldbloch_o_ds_gsrpng bloch spectral weight foldbloch next step execut foldbloch use wave function file nd dataset multipl correspond direct use construct supercel xyz includ part command line argument exampl multipl use execut follow command foldbloch tfoldbloch_o_ds_wfk see follow foldbloch v build mar read eigenvalu tfoldbloch_o_ds_wfk iomod io_mode_mpi wfk_read_eigenvalu complet cpu wall time creat netcdf file without mpiio support tfoldbloch_foldblochnc process k point process k point process k point process k point process k point process k point number k point process data written tfoldblochfb data format kx ky kz eigenvalueha weight output tell us kpoint process total number kpoint process output file format data written take look tfoldblochfb first line follow let take moment analys output column correspond kx ky kz unfold band th column energi eigenvalu ha th column correspond spectral weight kpoint unfold confus kpoint weight repres multipl brillouin zone sinc supercel contain unit cell x x eigenvalu solut contain inform bloch wave vector ie unfold kpoint rel contribut kpoint determin spectral weight line repres unfold st eigenvalu ha eigenvalu correspond bloch wave vector nonzero weight weight total normal eigenvalu degener line look similar disord present form defect distort impur individu eigenst may express exclus bloch charact longer interest consequ transport optic properti appar fold band structur note whole output much bigger sampl provid band structur visual proceed next step unfold band structur let visual unfold band structur differ regular band structur plot though one addit dimens bloch spectral weight sever altern visual strategi use scatter plot point size proport spectral weight follow matlab script help build graph foldbloch output ubs_dotsmfoldbloch_assetsubs_dotsm make sure follow paramet ubs_dotsm set follow matlab kpath finpttfoldbloch_ofb matlab g reciproc latt vect bohr reciproc lattic vector inform must match tfoldbloch_abo realrrecipg space primit vector cartesian coordin bohrbohr r g r g r g unit cell volum ucvol e bohr angl e e e degre graph foldbloch output make sure init paramet set accordingli size supercel construct run script see follow graph foldbloch_assetshpng see unfold band structur perfectli reproduc anticip dispers relat eke_ coskb even estim magnitud hop matrix element adjac atom v_ssg band width ev result v_ssg ev analyz result abipi use abiopenpi tfoldbloch_foldblochnc open file insid ipython type request ipython ipython plot unfold band along path defin kbound x ipython prompt type type kbound klabel abifil kbound klabel rgamma x abifileplot_unfoldedkbound klabel titleunfold band foldbloch_assetsspectralw_unfoldedpng see also examplehttpabinitgithubioabipygalleryplot_foldblochhtmlsphxglrgalleryplotfoldblochpi author gz mt eb mjv tutori spin properti relat spin spin polar calcul ferro ferri magnet materi spinorbit coupl tutori aim show get follow physic properti total magnet ferromagnet ferrimagnet materi estim atom magnet moment analys total densiti state per spin direct analys densiti state per atom per spin direct effect spinorbit coupl non magnet system noncollinear magnet yet spinorbit coupl magnetocristallin anisotropi yet learn use featur abinit deal spin tutori take hour tutorial_readm ferromagnet materi bcc fe begin might consid work differ subdirectori tutori work_spin file tspin_xabi abi_teststutorialinput list input file spin tutori copi first one work_spin directori sh cd abi_teststutorialinput mkdir work_spin cd work_spin cp tspin_abi dialog teststutorialinputtspin_abi run calcul sh abinit tspin_abi log err mean time calcul done look input file read care go perform magnet calcul two new type variabl relat magnet nsppol spinat work low ecut ha small kpoint grid defin ngkpt xx monkhorstpack grid implicit real life converg test respect ecut ngkpt paramet even import magnet involv low energi differ small magnet densiti valu basic first exampl compar two case one take account magnet one take account done two dataset input dataset includ magnet dataset includ look output file magnet case dataset electron densiti split two part spinup spindown part correspond differ kohnsham potenti differ set eigenvalu whose occup given fermidirac function without ubiquit factor first kpoint instanc get magnet magnet case spin spin note occup magnet case differ spin channel mean eigenvalu shift turn due shift exchangecorrel potenti therefor effect potenti look output file compar spinup eigenvalu channel dn channel move output file look follow section integr electron magnet densiti atom sphere radiusratsphiatom smear ratsm diffupdnapproxim z local magnet moment atom radiu up_dens dn_densiti totalupdn diffupdn sum total magnet atom sphere total magnet exact dn last line report total magnet whole unit cell unit mu_b bohr magneton correpond differ integr densiti mu_b also report differ integr sphere around atom one atom give mu_b iron atom integr magnet atom sphere approxim one alway check sum integr atom magnet atom sphere close exact updn unit cell magnet case dataset without magnet integr electron densiti report sinc distinct spin channel look total energi dataset etot e etot e energi magnet calcul lower nonmagnet one expect magnet crystal system gain energi extra degre freedom given spin final also remark stress tensor affect presenc magnet would also true forc dont remark high symmetri symmetri structur forc zero symmetri howev would appar less symmetr materi interest consid detail distribut eigenvalu spin channel best done look respect densiti state do end set prtdo input file print do soon nsppol do data found file tspin_o_ds_do tspin_o_ds_do nonmagnet magnet case respect use plot softwar tradit order enhanc visibl do minor spin electron done use neg valu compar do magnet system fermi energi highlight vertic dash line spin_assetsbccfe_mag_dosjpg nonmagnet system spin_assetsbccfe_nonmag_dosjpg observ do channel shift respect footprint presenc nonzero total magnet crystal either ferro ferrimagnet integr do yield number electron spin direct see magnet aris fact electron fermi level magnet channel initi spinat posit valu could initi neg valu neg magnet spinat serv two purpos way initi break spin symmetri updown also start initi magnet moment ideal close enough final dft one sometim final nonzero magnet moment atom obtain initi spinat larger valu formal one spin dft sever local minima total energi depend start point end differ local minima note spinat three compon ie x z direct atom absenc spinorbit coupl collinear calcul relat direct magnet crystal axe collinear magnet calcul z compon spin read defin amplitud atom magnet moment treat scalar valu ie sign amplitud matter selfconsist loop affect densiti like nonmagnet case well spinmagnet reason might difficult reach converg magnet case nonmagnet case start larg enough magnet moment might help converg toward correct magnet ground sate also modifi tighter converg paramet might need exampl case cobalt order obtain correct nonzero magnet moment rather dens kpoint sampl brillouin zone must use eg xx rather small valu tsmear converg magnet calcul smaller valu tolrd eg instead default larger valu nline eg instead default andor reduc mix paramet diemix mostli diemixmag antiferromagnet exampl fcc fe well sort actual fcc fe display mani complic structur particular spin spiral spiral character direct along axi angl magnet respect axi step magnet come full circl simpl particular case angl axi step unit cell side spin direct altern plane perpendicular axi yield spiral stairway spin_assetsfcc_fe_convjpg instanc atom xy possess magnet atom xy would possess magnet etc describ structur unit cell two atom suffici two atom given opposit magnet help variabl spinat copi file abi_teststutorialinputtspin_abi work_spin dialog teststutorialinputtspin_abi input file run calcul edit tspin_in file briefli look two chang respect file tspin_abi unit cell basi vector rprim new spinat note also use nsppol nspden combin valu valid perform strictli antiferromagnet afm calcul nspden mean independ compon charg densiti nsppol mean independ compon wavefunct case abinit use socal shubnikov symmetri perform calcul twice faster nsppol nspden spin channel equival symmetri case perfect afm case symmetri crystal full fcc symmetri anymor sinc symmetri must preserv magnet atom abinit nevertheless abl detect symmetri belong shubnikov group correctli find cell primit would case vector spinat atom fm case run afm calcul comput time approxim second recent cpu look eigenvalu occup fill factor come symmetri consider aforement usual spin degeneraci potenti spinup equal potenti spindown shift antiferromagnet translat vector eigenenergi ident spinup spindown wavefunct shift one respect kpt nband wtk kpt reduc coord occup number kpt total magnet zero question know magnet order inde do use sinc mani electron howev look integr magnet around atom indic magnet moment carri atom integr electron magnet densiti atom sphere radiusratsphiatom smear ratsm diffupdnapproxim z local magnet moment atom radiu up_dens dn_densiti totalupdn diffupdn sum total magnet atom sphere total magnet exact dn give depend radiu use project charg densiti magnet atom magnet atom anoth way get integr atom magnet done use util cutd yield interpol magnet point space cutd one execut abinit packag instal togeth abinit moment cutd interact use primit script written python perform rough estim magnet atom look magnetizationpi programspin_assetsmagnetizationpi note believ perform integr magnet cube side acel around atom applic might consid adjust valu cutd string python script copi work_spin directori run program type python magnetizationpi see result atom magnet moment atom magnet moment also show magnet two atom opposit valu atom magnet bit differ one abinit output use slightli differ integr paramt anoth look fcc fe instead treat fcc fe directli afm materi make hypothes magnet structur run calcul like one bcc fe anticip two spin direct go differ even assum initi spin magnitud copi file abi_teststutorialinputtspin_abi work_spin dialog teststutorialinputtspin_abi run calcul input file look understand content note valu spinat job character magnet structur go use atom angular momentum project densiti state do weight project wave function angular momentum channel ie spheric harmon center atom system note do comput tetrahedron method rather time consum produc accur less smooth do smear method cpu time strongli depend number kpoint use reduc set take second modern comput specifi calcul need new variabl addit prtdo set natsph iatsph ratsph specifi atom around calcul perform radiu sphere specif select new dataset atom non selfconsist calcul run gener project densiti state first note valu total energi e ha show attain essenti state tspin etotal densiti state file tspin_o_ds_dos_at first atom tspin_o_ds_dos_at second atom extract densiti state carri magnet moment whose integr fermi level yield estim magnet atom note fermi level echo file tspin_o_ds_do fermi energi look integr siteproject densiti state comput total moment atom end one open file tspin_o_ds_dos_at contain inform pertain atom file selfdocu describ line content spin spin energyha l l l l l integr l l l l l look line contain energi find font colorredfont font colorredfont appar chang do project orbit orbit project sizeabl differ confirm look integr do differ dchannel differ rough agreement regard crude method integr previou calcul use calcul number kpoint project do plot updown integr do differ dchannel atom spin_assetsenergy_diff_fccfejpg note scatter graph due finit number digit integr do given file tspin_o_ds_dos_at tspin_o_ds_dos_at look do atom see corner atom face atom possess opposit magnet roughli cancel do comput tetrahedron method smooth smear method run averag allow better view ferrimagnet yet materi display particular form ferromagnet also view non compens antiferromagnet call ferrimagnet atom possess spin possess spin total spin magnet non zero happen gener system differ type atom differ magnet moment sometim rather complic structur magnetit spinorbit coupl soc heavi atom relativist descript electron structur becom necessari accomplish relativist dft approach normconserv pseudopotenti atom dirac equat solv l lchannel degeneraci lift accord eigenvalu ls oper l l degeneraci l l pseudiz associ wave function recov ad usual pseudopotenti projector spinorbit term gener form vrlsrangl ls langl ls potenti includ addit term use pseudopotenti pseudodojo choos gener fulli relativist option fr name sr mean semirelativist plane wave calcul wavefunct twocompon spinor spinup spindown compon compon coupl mean size hamiltonian matrix quadrupl cpu time enlarg consid heavier atom iron tantalum copi file abi_teststutorialinputtspin_abi work_spin run calcul dialog teststutorialinputtspin_abi input file contain one new variabl nspinor look also look so_psp set explicitli inform directli read pseudopotenti file one could forc nonso calcul set so_psp even pseudo fr run check recov split atom level perform calcul big box two calcul launch without soc easili follow symmetri differ level nonsoc calcul kpt nband wtk kpt reduc coord symmetri p applic soc consid twice mani level kpt nband wtk kpt reduc coord level perfectli degener due finit size simul box particular cubic shape give small crystal field split orbit e_g t_g state nevetheless comput split level obtain eg pchannel ha consid nist tablehttpswwwnistgovpmlatomicreferencedataelectronicstructurecalculationstantalum atom data obtain p split tabl ha split tabl ha obtain reason agreement better agreement could obtain improv converg paramet projector augmentedwav within projector augmentedwav paw method usual pseudohamiltonian express h k v_eff sigma_ij d_ij p_i rangl langl p_j two follow condit satisfi local paw basi complet enough electron densiti mainli contain paw augment region shown good approxim paw hamiltonian includ spinorbit coupl h simeq k v_eff sigma d_ijdso_ij p_i rangl langl p_j dso_ij project ls oper paw augment region immedi consequ possibl use standard p_i paw projector word possibl use standard paw dataset pseudopotenti perform calcul includ soc cours still necessari express wavefunct two compon spinor spinup spindown compon let look follow keyword pawspnorb activ spinorbit coupl within paw forc nspinor practic consid bismuth paw dataset file contain p electron valenc copi file abi_teststutorialinputtspin_abi work_spin one bismuth atom larg cell run calcul take second recent comput dialog teststutorialinputtspin_abi two dataset execut first without soc second one use pawspnorb result eigenvalu without soc eigenvalu hartre nkpt k point kpt nband wtk kpt reduc coord p soc kpt nband wtk kpt reduc coord p level perfectli degener due finit size non spheric shape simul box comput split level obtain dchannel ha pchannel ha consid nist tablehttpswwwnistgovpmlatomicreferencedataelectronicstructurecalculationsbismuth atom data obtain dchannel ha pchannel ha perfect agreement even small simul cell small valu planewav cutoff come gener paw dataset soc calcul accur atom refer exchang correl function littl impact larg soc split mainli kinet energi effect rotat magnet spinorbit coupl come soon spectacular manifest soc energi associ rotat magnetis respect crystal axi origin magneto crystallin anisotropi mca paramount technolog import summari tabl help know handl differ magnet calcul case abinit case msppol nspinor nspden nonmagnet collinear fm collinear afm noncollinear note noncollinear magnet done without soc soc use time revers symmetri kptopt howev symmetri presenc soc yet fulli implement pleas remov symmetri run noncollinear magnet soc ie kptopt nsym noncollinear magnet soc case much difficult converg scf might requir strongli reduc diemix mostli diemixmag mix flag might increas nline play neg valu nnsclo dftu correct also necessari magnet calcul use regular lda gga function ie hybrid fucntion gz would like thank b siberchicot use comment author xg rc fourth tutori aluminum bulk surfac tutori aim show get follow physic properti metal surfac total energi lattic paramet relax surfac atom surfac energi learn smear brillouin zone integr also bit precondit scf cycl tutori take hour minut tutorial_readm total energi lattic paramet fix smear kpoint grid begin might consid work differ subdirectori tutori work follow command move work directori creat work directori move directori previou tutori copi file tbase_abi insid work directori command sh cd abi_teststutorialinput mkdir work cd work cp tbase_abi tbase_abi input file edit read care dialog teststutorialinputtbase_abi look follow new input variabl occopt tsmear note also follow work fix ecut ha implicit real research applic converg test respect ecut suitabl ecut given order save time give lattic paramet experiment valu note softest pseudopotenti use hpspgth h need ha rather hard sipsp si need ha see end page discuss soft hard pseudopotenti input variabl diemac suppress aluminum metal default valu input variabl tailor case read input file run code usual take second abinit tbase_abi log err give quick look output file note fermi energi occup number comput automat fermi homo energi hartre averag vxc hartre eigenvalu hartre nkpt k point kpt nband wtk kpt reduc coord occup number kpt prteigr prtvol print kpoint also note compon total energi includ entropi term energyterm iteration_st dtset itim icycl comment compon total free energi hartre kinet e hartre e xc e ewald energi e psp_core e local_psp e non_local_psp e intern e ktentropi e total_energi e total_energy_ev e band_energi e converg studi respect kpoint cours converg studi associ sampl brillouin zone examin differ grid increas resolut might tri follow seri grid ngkpt ngkpt ngkpt ngkpt associ nkpt nkpt nkpt nkpt nkpt input file tbase_abi exampl dialog teststutorialinputtbase_abi tbase_abo refer output file dialog teststutorialrefstbase_abo run might take second modern pc see particular valu tsmear ha lattic paramet alreadi converg nkpt acel e e e bohr acel e e e bohr acel e e e bohr acel e e e bohr note usual strong crossconverg effect number kpoint valu broaden tsmear right procedur valu tsmear converg respect number kpoint compar kpoint converg valu differ valu tsmear follow restrict grid nkpt ida converg studi respect number kpoint broaden factor theoret converg rate function tsmear head case occopt cubic reli valu occopt tutori still might alway robust valu might yield difficulti find univoc fermi energi slightli wors converg rate quadrat obtain occopt actual recommend valu metal system converg rate obtain hypothesi infinit dens kpoint grid check evolut acel function tsmear follow valu tsmear use doubleloop capabl multidataset mode tsmear chang inner loop save cpu time wavefunct previou dataset excel transfer differ kpoint input file tbase_abi exampl dialog teststutorialinputtbase_abi tbase_abo refer output file dialog teststutorialrefstbase_abo output file evolut acel acel e e e bohr acel e e e bohr acel e e e bohr acel e e e bohr acel e e e bohr acel e e e bohr acel e e e bohr acel e e e bohr acel e e e bohr acel e e e bohr acel e e e bohr acel e e e bohr data analyz properli tsmear converg valu contain acel must compar acel acel acel acel differ acel consid converg respect number kpoint fix tsmear tsmear lowest one usual difficult converg valu acel inde wellconverg respect kpoint number use largest tsmear give acel induc small error lattic paramet particular valu tsmear one use second kpoint grid give acel summari summar choos work kpoint grid irreduc brillouin zone associ tsmear less error lattic paramet note error due brillouin zone sampl could add error due choic ecut mention previous order follow stick valu ecut tsmear tri use kpoint grid similar resolut final valu aluminum lattic paramet lda use alpsp pseudopotenti thu bohr correspond angstrom experiment valu celsiu angstrom henc theoret valu error caution converg paramet use properli assess accuraci pseudopotenti function associ total energi accuraci deduc etot e etot e etot e etot e etot e etot e etot e etot e etot e etot e etot e etot e etot e ha accuraci ha tip analyz converg total energi one use abicomp script provid abipi gsr command start interact ipython session interact directli abipi object load gsr file produc calcul use command abicomppi gsr tbase_ogsrnc insid ipython termin execut plot_converg method gsrrobot ipython robotplot_convergenceenergi sortbynkpt huetsmear produc plot total energi ev differ valu nkpt group tsmear base_assetsabicomp_tbase_opng surfac energi aluminum chang orient unit cell order studi aluminum surfac set supercel repres slab supercel chosen compat primit surfac unit cell correspond direct direct perpendicular surfac primit cell bulk aluminum base vector doubl cell first comput total energi associ doubl cell strictli need valuabl intermedi step toward studi surfac might start tbase_abi chang rprim still tri keep acel valu bulk aluminum determin previous difficult part passag doubl cell definit kpoint grid cours one could take homogen simpl cubic grid kpoint correspond exactli kpoint grid use primit cell tbase_abi would big problem would miss error cancel answer problem given input file abi_teststutorialinputtbase_abi dialog teststutorialinputtbase_abi procedur exact translat kpoint grid explain sorri see use homogen simpl cubic grid resolut primit cell case simpl rule estim roughli whether two grid differ cell resolut simpli multipli linear dimens kpoint grid number sublattic number atom cell exampl correspond product usual kpoint grid xx x x file tbase_in one xx x x grid kpoint anisotrop rough estim valid note also input variabl rprim chkprim input file run tbase_abi refer file abi_teststutorialrefstbase_abo find follow total energi etot e exactli twice total energi primit cell mention differ less ha due differ fft grid use two run affect exchangecorrel energi grid alway homogen primit grid chang orient lattic give mutual incompat lattic increas size fft grid would improv agreement surfac energi aluminum layer vacuum layer slab calcul first comput total energi associ three layer aluminum separ one layer vacuum kind minim slab one surfac layer one bulk layer one surfac layer one vacuum layer conveni take vacuum region multipl width aluminum layer mandatori supercel use doubl previou cell two layer aluminum atom along direct cours relax surfac might give import contribut total energi start tbase_abi modifi rprim doubl cell along atom posit well kpoint mesh latter suppos electron propag one slab imag direct k_z compon special kpoint taken one layer kpoint need along zdirect also allow relax atom posit relax lattic paramet lattic paramet along x must consid fix bulk valu z direct interest allow vacuum region collaps input file tbase_abi exampl dialog teststutorialinputtbase_abi tbase_abo refer output file dialog teststutorialrefstbase_abo run take second modern pc total energi first scf cycl atom posit equal start valu etot total energi three aluminum atom bulk section etot multipli three ha compar nonrelax slab energi bulk energi one obtain nonrelax surfac energi per surfac unit cell two surfac simul cell name ha ev total energi broyden relax etot e relax surfac energi per surfac unit cell obtain compar bulk energi relax slab energi give ha ev seem relax energi small compar surfac energi need converg studi surfac energi increas number vacuum layer one increas number vacuum layer layer instead prefer defin atom posit cartesian coordin coordin work vacuum layer case reduc coordin cell size increas input file tbase_abi exampl input file dialog teststutorialinputtbase_abi tbase_abo refer output file dialog teststutorialrefstbase_abo run order second modern pc broyden step first dataset notic warn scprqt warn nstep enough scf cycl converg maximum forc differ e exce toldff e input variabl nstep intent set rather low valu warn possibl converg difficulti scf converg might inde get difficult cell size default precondition see notic input variabl dielng good metalvacuum case interpret present run critic converg criterion close fulfil one keep mind see vacuum layer case one nonrelax total energi etot give unrelax surfac energi ha ev relax case etot e one converg requir level give relax surfac energi ha ev note differ unrelax relax case bit larger case one vacuum layer interact slab differ supercel vacuum layer case selfconsist slightli difficult vacuum layer broyden step suffici converg one might set nstep larger valu best chang precondition describ howev broyden step number beyond one take advantag previou wavefunct suffici converg reach total energi relax case etot e give relax surfac energi ha ev rather small ev differ vacuum layer case next run keep vacuum layer case know accuraci come calcul better ev one might investig vacuum layer case worth present tutori surfac energi increas number aluminum layer one increas number aluminum layer keep vacuum layer consid aluminum layer rather straightforward set also chang precondition one could use effect dielectr constant rather small mix coeffici order howev also anoth possibl use estim dielectr matrix govern iprcel comparison previou treatment scf one recomput result aluminum layer input file tbase_abi exampl dialog teststutorialinputtbase_abi tbase_abo refer output file dialog teststutorialrefstbase_abo run might take one minut longest four basic tutori start notic scf converg rather satisfactori case metal layer aluminum layer case one nonrelax total energi etot quantiti converg unlik test give unrelax surfac energi ha ev relax case etot e contrast differ test less microha give relax surfac energi ha ev aluminum layer case one nonrelax total energi etot give unrelax surfac energi ha ev relax case etot e give relax surfac energi ha ev aluminum layer case one nonrelax total energi etot give unrelax surfac energi ha ev relax case etot e give relax surfac energi ha ev rel differ surfac energi layer case order framework tutori pursu investig simpl applic concept alreadi explor inform addit warn work accomplish complet layer without relax see abi_teststutorialinputtbase_abi abi_teststutorialrefstbase_abo layer treat nonrelax energi surfac energi behav follow number aluminum layer surfac energi ev ev ev ev ev surfac energi converg rather difficult reach valu xx grid smear ha kinet energi cutoff ha alpsp pseudopotenti still oscil ev ev increas kpoint sampl might decreas slightli oscil note effect intrins comput properti metal surfac electron confin insid slab potenti subband direct normal surfac fermi energi oscil width slab effect might understood base comparison behaviour jellium slab error order ev due thin vacuum layer sourc error might recheck see kind accuraci need experiment data give surfac energi around ev sorri refer provid soft hard pseudopotenti context planewav basi soft pseudopotenti mean low ecut requir obtain converg wherea hard pseudopotenti impli high ecut need understood consid pseudowavefunct atom hard pseudopotenti pseudowavefunct sharp featur real space requir mani planewav describ hand soft pseudopotenti rather smooth pseudowavefunct need fewer planewav describ accur pseudowavefunct hard pseudopotenti design somewhat qualit rel pseudopotenti word pseudopotenti soft compar certain pseudopotenti hard respect anoth gener pseudopotenti describ light element nd line period tabl pseudopotenti includ semicor state consid hard strongli peak pseudowavefunct requir larg ecut discuss valid normconserv pseudopotenti paw pseudopotenti abl keep pseudowavefunct smooth mean requir lower ecut normconserv counterpart one main benefit author mg gb overview eph code page provid quick introduct new electronphonon driver integr abinit execut discuss import technic detail relat implement associ input variabl drawbacksadvantag respect implement avail anaddb also discuss new eph code first let tri answer question decid implement new code electronphonon calcul may know eph calcul avail anaddb execut long time anaddbbas implement essenti postprocess eph matrix element comput dfpt code approach present advantag well drawback one hand work requir comput eph matrix element implement directli dfpt routin mean eph calcul advanc featur paw soc noncollinear magnet etc readili avail anaddb version support dfpt part implement hand postprocess approach impli number kkqqpoint eph matrix element automat fix level dfpt run word want comput phononlimit mobil eg kk qqmesh need perform dfpt calcul sampl thu render comput almost imposs principl possibl use trick linear interpol eph matrix element densifi sampl order get decent interpol one usual need initi bz mesh significantli denser one need converg dfpt part alon matter fact electron phonon eph properti present complet differ converg rate silicon instanc mesh phonon electron enough converg electron densiti vibrat spectrum citepetretto contrari phononlimit mobil si requir kkgrid qqgrid reach rel error citebruninb roughli speak explicit comput phonon si qqmesh requir around natom dfpt calcul easili get idea cost fulli abinitio evalu eph matrix element qqpoint eph code bypass bottleneck interpol dfpt potenti qqspace bloch state comput nonselfconsist arbitrarili dens kkmesh net result three problem electron phonon electronphonon partli decoupl converg separ keep mind howev fact one easili densifi qqsampl eph code mean one use underconverg valu groundstat gs dfpt part inde qualiti interpol depend initi kk qqmesh takehom messag one alway converg care electron vibrat properti move eph comput inform differ eph anaddb see also citegonz detail eph implement avail citebruninb eph workflow typic eph workflow arrow denot depend differ step schemat repres figur eph_intro_assetseph_workflowpng styleheightpxwidthpx brown box standard dfpt calcul done rel coars kk qqmesh instanc si dfpt run produc partial ddb file portion full dynam matrix well pot file firstord deriv ks potenti refer dfpt potenti partial pot file merg mrgdv util produc singl dvdb file deriv vrr databas usual partial ddb file merg mrgddb see second tutori dfpttutorialrf eph driver blue box receiv input total ddb dvdb well gs wfk file usual produc differ kkmesh case even differ number band highenergi empti state need ingredi use comput interpol eph matrix element associ physic properti kkmesh wfk file must commensur qqmesh dvdb file eph calcul activ use optdriv eph_task defin physic properti comput read extern file one specifi filepath three variabl getwfk_filepath getddb_filepath getdvdb_filepath intern code start read ddb file construct interatom forc constant ifc realspac supercel rrspace extern file wfk dvdb may read depend valu eph_task eph code comput phonon band do final special routin invok depend valu eph_task follow physic properti comput imaginari part phe selfenergi metal eph_task give access phonon linewidth induc eph coupl eliashberg function superconduct properti within isotrop migdaleliashberg formal transport properti metal lova approxim real imaginari part eph selfenergi eph_task give access zeropoint renorm band gap qp correct due eph scatter function spectral function aww eliashberg function imaginari part eph selfenergi ks energi eph_task give access phononlimit carrier mobil electr conduct seebeck coeffici phononlimit carrier mean free path relax time scatter rate calcul done function temperatur dope nonpolar polar materi advanc option avail crystallin symmetri use throughout code order reduc number kk qqpoint must explicitli treat achiev good parallel effici cpu demand part parallel mpi employ distribut scheme qqpoint perturb band band level avail comput full selfenergi istwfk kptopt featur avail anaddb yet support eph time write today follow featur yet support eph paw calcul spinorbit coupl noncollinear magnet nspinor nspden nonloc part pseudopotenti appli useylm introduct focu part common differ subdriv ie comput vibrat properti via fourier interpol dynam matrix fourier interpol dfpt potenti use differ subdriv discuss detail special lesson phononlimit mobilitiestutorialephmob zpr tdepend band structurestutorialephzpr isotrop superconduct metalstutorialephisotc phonon band do eph sinc phonon frequenc displac need eph calcul surpris anaddb featur relat treatment dynam matrix integr eph code well mani case variabl name eph anaddb especi import variabl dipdip asr chneut howev import differ respect anaddb input file specif eph name ddb file specifi getddb_filepath wherea dfpt qqmesh associ ddb file given ddb_ngqpt two variabl mandatori perform eph calcul import abinit default valu dipdip asr chneut chang particular acoust sum rule charg neutral born effec charg enforc default respons user check whether break sum rule alway present due numer inaccuraci reason token make sure vibrat instabilti present embark big eph calcul spectrum present instabl around gamma due fourier interpol done coars qqsampl may tri use rifcsph variabl phonon do default eph code comput phonon do atomproject phdo interpol ifc dens qqmesh specifi ph_ngqpt default qqgrid may want increas valu accur result step linear frequenc mesh govern ph_wstep linear tetrahedron method citebloechl use default gaussian method activ via ph_intmeth ph_smear defin gaussian smear hartre unit default final result store phdosnc file format one produc anaddb comput phdo disabl set prtphdo make calcul bit faster summar comput phdo tetrahedron method xx gammacent qqmesh one use sh prtphdo disabl part ph_ngqpt visual result abipi execut sh abiopenpi out_phdosnc e variabl phonon band structur comput phonon band structur activ automat provid input file defin highsymmetri qqpath term ph_nqpath vertic list ph_qpath array ph_ndivsm variabl defin number divis use sampl smallest segment path number point segment proport length segment comput phonon band structur deactiv set prtphband final result store phbstnc file format one produc anaddb instanc section phonon band structur could look like sh prtphband ph_nqpath ph_qpath gamma x w k gamma obtain list highsymmetri qpoint one use abistruct script provid abipi sh abistructpi kpath in_ddb phonon band visual use sh abiopenpi out_phbstnc e electronphonon matrix element eph matrix element gkq defin beginequ gkq langl psi_mkkqqdelta_qnu vkspsi_nkk rangl labeleqelphon_mel endequ psi_nkk ks bloch state delta_qnu vk firstord variat selfconsist ks potenti induc phonon mode qnu scatter potenti express beginequ delta_qqnu vksrr eiqqcdotrr delta_qqnu vksrr labeleqdelta_vk endequ delta_qqnu vksrr lattic period function citegiustino note abinit comput respons atom perturb defin three variabl qpt rfdir rfatpol rfphon set connect phonon represent atom perturb employ dfpt code given beginequ delta_qqnu vksrr dfracsqrtwqnu sum_kappaalpha dfrace_kappaalphanuqqsqrtm_kappapartial_kappaalphaqq vksrr endequ e_kappaalphanuqq alphath cartesian compon phonon eigenvector atom kappa unit cell m_kappa atom mass partial_kappaalphaqq vksrr firstord deriv ks potenti obtain dfpt solv selfconsist system sternheim equat given kappaalpha qq perturb citegonz citebaroni dvdb file store partial_kappaalphaqq vksrr qqpoint ibz irreduc atom perturb rigor say dvdb file store local part dfpt potenti variat hartre xc local part pseudo rather technic point discuss detail citebruninb relev present discuss elabor import number irreduc atom perturb depend qqpoint symmetri system actual particular subset point group unperturb crystal exploit dfpt level fortun dont worri technic detail symmetri fulli support eph run dfpt calcul irreduc perturb ibz usual also comput wfk limit ibz eph code employ symmetri reconstruct differ quantiti runtim fourier interpol dfpt potenti eph code employ fourier interpol propos citeeiguren obtain scatter potenti arbitrari qqpoint interpol techniqu one use dfpt potenti store dvdb file comput qq rightarrow rr fourier transform beginequ labeleqdfpt_pot_realspac w_kappaalpharrrr dfracn_qq sum_qq eiqqcdotrr rr partial_kappaalphaqqvtextscfrr endequ sum n_qq bz qqpoint belong abinitio ddb_ngqpt grid partial_kappaalphaqqvtextscf repres latticeperiod first order deriv local part ks potenti associ atom kappa along cartesian direct alpha w_kappaalpharrrr known possibl interpol potenti arbitrari point tildeqq use invers transform beginequ labeleqdfpt_pot_interpol partial vscf_tildeqqkappaalpharr approx sum_rr eitildeqqcdotrr rr w_kappaalpharrrr endequ sum lattic vector insid bornvon karman supercel algorithm use defin rr point supercel correspond weight specifi dvdb_rspace_cel accuraci interpol depend local w_kappaalpha rrspace mean bornvon karman supercel correspond ddb_ngqpt grid larg enough captur spatial decay w_kappaalpharrrr function rr consequ ddb_ngqpt subject converg studi metal w_kappaalpha expect shortrang provid one ignor possibl kohn anomali contrari special numer treatment need semiconductor insul due presenc longrang lr dipolar quadrupolar field rrspace lr term determin nonanalyt behaviour scatter potenti longwavelength limit qq rightarrow citevogl handl lr part eph code use approach similar spirit one employ fourier interpol dynam matrix citegonz idea rel simpl one subtract lr part dfpt potenti comput eq eqrefeqdfpt_pot_realspac thu make realspac represent amen fourier interpol nonanalyt part eqeqrefeqv_long_rang restor back eq eqrefeqdfpt_pot_interpol interpol potenti tildeqq longrang part associ displac atom kappa along cartesian direct alpha model polar materi lead term given dipolar field citeverdi citesjakst beginequ labeleqv_long_rang vmathcall_kappaalphaqqrr dfracpiomega sum_gg neq qq dfracqg_betacdot bm z_kappaalphabeta ei qg cdot rr bmtau_kappa qg cdot bmvarepsiloninfti cdot qg endequ bmtau_kappa atom posit omega volum unit cell bmz bmvarepsiloninfti born effect charg tensor dielectr tensor respect summat cartesian direct beta impli term present polar materi nonzero bmz diverg q qq rightarrow henc singular integr system bmz bmvarepsiloninfti read automat ddb file present strongli recommend comput quantiti dfpt order prepar eph calcul semiconductor nonpolar materi born effect charg zero scatter potenti still nonanalyt due presenc jump discontinu discuss citebrunin nonanalyt behaviour fulli captur use gener express case lead term associ dynam quadrupol citeroyo express lr model includ dipol quadrupol term read beginequ vmathcall_kappaalphaqqrr partial_kappaalphaqq vlcrr fracpiomega sum_ggneqmathbfq frac iqg_beta z_kappaalphabeta qg_beta z_kappaalphabetacalqvtexthxccale_gammarr fracq_kappaalphabetagammaqg_gamma qg cdot bmvarepsiloninfti cdot qg ei qg cdot rr bmtau_kappa labeleqlrpot endequ import comput dynam quadrupol tensor within dfpt framework made avail futur releas togeth specif tutori comput store ddb eph code read automat use lr model todo discuss integr dfpt part implement fourier compon multipli gaussian filter efracqgalpha order damp short rang compon relev definit lr model alpha paramet specifi via dvdb_qdamp input variabl default valu work well major system investig far yet paramet subject converg test test purpos possibl deactiv treatment lr part set dvdb_add_lr also set one interest shortrang part eph scatter potenti import initi dfpt mesh point worth comment import initi dfpt qqmesh fourier interpol implicitli assum signal rrspace decay quickli henc qualiti interpol phonon frequenc interpol dfpt potenti abinitio point depend space initi qqmesh turn defin size bornvonkarman supercel word denser dfpt mesh larger realspac supercel better interpol especi qqpoint close gamma semiconductor atom displac induc dynam dipol quadrupol level densiti gener longrang scatter potenti potenti affect behaviour eph matrix element qq rightarrow qqmesh must dens enough captur full strenght coupl detail discuss found citebrunin citeverdi citesjakst practic point view impli one alway monitor converg physic properti respect initi dfpt qqmesh lr model implement abinit facilit converg nonanalyt behaviour qq rightarrow properli describ yet fourier interpol introduc oscil abinitio qqpoint oscil may affect qualiti physic result citebrunin trick acceler comput reduc memori requir subdriv implement special techniqu acceler calcul reduc memori requir focu techniqu common differ eph subdriv addit trick specif particular valu eph_task discuss detail associ lesson first note memori requir w_kappaalpharrrr array scale nfft productddb_ngqpt quantiti multipli natom mpi process store perturb memori mpi parallel perturb see eph_np_pqbk allow one decreas prefactor natom natom nprocs_pert also total number rrpoint nfft play import role level memori well level walltim optim part one decreas valu boxcutmin valu smaller eg aggress note one oblig run gsdfpt part boxcutmin eph code automat interpol dfpt potenti input fft mesh comput ecut boxcutmin differ one found dvdb file clarifi chang valu boxcutmin eph part ecut exact represent densitiespotenti ggspace obtain boxcutmin found use valu significantli affect result allow one decreas cost calcul memori factor signific fraction walltim eph spent perform fft requir appli firstord hamiltonian h use singl precis fft routin allow one decreas comput cost without loos precis trick activ set mixprec note featur avail code link fftw intelmkl import boxcutmin mixprec trick activ default user suppos perform preliminari test make sure qualiti result affect option default eph code store ks wavefunct singl precis array although major calcul done doubl precis arithmet except fft mixprec use precis use intern buffer specifi configur time sh enable_gw_dpcy store wavefunct doubl precis buffer default valu ie singl precis suggest chang option unless good reason termin discuss anoth trick directli relat eph code dfpt comput sinc eph code need first order chang wavefunct wf file suggest avoid output file use prtwf dfpt part file quit larg overal space disk scale nqpt natom prtwf set dfpt code write wf file dfpt scf cycl converg one still restart wavefunct need restart dfpt run first order wavefunct effect restart first order densiti starfunct interpol ks eigenvalu mention introduct eph implement bloch state comput nonselfconsist arbitrarili dens kkmesh without resort interpol scheme advantag approach calcul easili autom drawback comput cost nscf quickli increas densiti kkmesh nband henc big calcul cost nscf part may even greater eph comput howev physic properti whose comput requir knowledg ks state kkpoint ibz instanc comput mobil semiconductor requir knowledg ks state whose energi slight cmb vbm let say ev metal state close fermi level need comput superconduct properti standard formal word sever eph calcul delta function involv requir extrem dens bz mesh converg matter fact rel small fraction bz compat energi crystallinemomentum conserv neded point question natur aris avoid nscf comput kkpoint suppos give neglig contribut final physic result answer ye provid abl predict easi way reason accuraci ks eigenvalu ee_nk without actual solv ks equat aproach use eph code base starfunct interpol shanklandkoellingwood skw improv describ citepickett method singleparticl energi express term symmetr fourier sum beginequ labeleqskw_expans enk sum_rr c_nrr s_rrkk endequ star function s_rrkk defin beginequ labeleqstar_funct s_rrkk dfracnsum_mco eikkcdot mco rr endequ rr lattic vector sum n rotat crystallograph point group construct expans eqeqrefeqskw_expans fulfil basic symmetri properti singleparticl energi beginalign labeleqeigen_properti enk epsilon_nkg enk epsilon_nmcokk endalign principl expans coeffici eqeqrefeqskw_expans uniqu determin use number star function equal number ab initio kkpoint usual lead sharp oscil input eigenvalu avoid problem one use star function ab initio kkpoint constrain fit interpol function pass input energi rough function minim citepickett einterp variabl activ interpol electron eigenvalu user specifi number star function per ab initio kkpoint option fourier filter propos citeuehara case rcut given einterp rmax rmax maximum length lattic vector includ star expans einterp use interpol ks eigenvalu end ground state calcul hrefhttpsdocsabinitorgtestsvinputtintextttv interpol gw energi hrefhttpsdocsabinitorgtestslibxcinputtintextttlibxc bf optdriv case one employ python interfac provid abipi autom procedur exampl found hrefhttpsnbviewerjupyterorggithubabinitabitutorialsblobmasterabitutorialsgwlesson_gwipynbjupyt notebook einterp consist entri first element specifici interpol method starfunct interpol shanklandkoellingwood fourier interpol scheme see pickett bspline interpol mean entri depend interpol techniqu select case starfunct interpol einterp number starfunct per ab initio kpoint einterp nonzero activ fourier filter accord eq uehara case rcut given einterp rmax rmax maximum length lattic vector includ star expans einterp use einterp defin rsigma eq worth note qp energi must fulfil symmetri properti point group crystal g reciproc lattic vector oper point group therefor possibl employ starfunct interpol shankland koell wood improv version propos pickett fit ab initio result interpol techniqu construct pass initi point satisfi basic symmetri properti band energi stress howev fourierbas method problem presenc band cross may caus unphys oscil ab initio point without enter detail discuss special lesson one use skw algorithm find relev kkpoint perform abinitio nscf run wavevector order produc wfk file use eph code entir procedur perform automat way insid abinit run big eph calcul strongli recommend check whether skw interpol give reason result typic test would comput wfk file reason dens ibz let call file ibz_wfk perform nscf band structur calcul along highsymmetri kkpath cover import region bz eg band edg semiconductor step produc anoth wfk file use refer check interpol let call kpath_wkf use abitk execut src_main interpol ks energi use eigenvalu ibz_wfk compar result abinitio band structur store kpath_wfk syntax sh abitk skw_compar ibz_wfk kpath_wfk lpratio rcut rsigma option argument place squar bracket default valu indic prefer possibl replac wfk file gsrnc file sh abitk skw_compar ibz_gsrnc kpath_gsrnc ks energi need skw interpol compar band abipi use abicomp script eband command sh abicomppi eband abinitio_ebandsnc skw_ebandsnc p combiplot fit satisfactori may want tri one follow option order import increas abinitio mesh ibz_wfk increas valu lpratio play rcut rsigma damp oscil interpol note sometim difficult get complet rid spuriou oscil artifact skw interpol especi presenc degeneraci band crossinganticross rememb howev achiev perfect agreement skw interpol abinitio result crucial sinc skw band use find kkpoint suffici close band edg fermi level wavevector recomput afterward ksdft possibl oscil artifact disappear abinitio result nutshel need make sure skw band reason close abinitio result especi region around band edg semiconductor around fermi level metal small deviat skw abinitio band alway account increas valu sigma_erang use gener kerangenc file exampl input file comput wfk file kerang given last section mobil tutorialtutorialephmobhowtocomputeonlythekpointsclosetothebandedg todo recheck code perhap use abinitio band edg greatersmal skw one import thing skw reproduc posit band edg valu use posit skw band edg consist titl basic parallel abinit author yp xg tutori basic parallel parallel abinit gener environ mani situat sequenti code enough often would take much time get result also case want thing go fast comput resourc allow use one processor might also access memori one processor end possibl use abinit parallel dozen hundr even thousand processor tutori offer quick guid tour insid complex world emerg soon want use one processor suppos alreadi familiar abinit gone four basic tutori case strongli advis order truli benefit tutori strongli recommend acquaint basic concept parallel computinghttpsenwikipediaorgwikiparallel_comput particular almdalh lawhttpsenwikipediaorgwikiamdahls_law ration fact beyond number processor inher sequenti part domin parallel part give limit maxim speedup achiev gener broad avail multicor processor everybodi parallel machin hand abinit abl take advantag avail sever core capabl groundstat calcul molecular dynam linearrespons manybodi perturb theori tightli integr multicor processor socal smp machin mean symmetr multiprocess interlink within network base ethernet type connect number core composit machin easili exceed one hundr go sever million day abinit capabl use effici sever hundr comput core case even ten thousand comput core use effici actual start tutori associ one strongli advis get familiar parallel environ might rel simpl smp machin difficult power machin need least mpi see next section instal machin take time determin launch job parallel mpi resourc avail limit well perhap use batch system typic qsub sbatch command associ shell script hesit discuss system administr feel someth clear suppos follow know run parallel program familiar peculiar system pleas rememb standard way set parallel environ abl provid support beyond abinit characterist parallel environ differ softwar solut use benefit parallel abinit parallel base mpi signific addit speedup better distribut data allow run bigger calcul base openmp multithread librari write effort also focu graphic process unit gpu cuda magma latter describ present tutori mpi mpi stand messag pass interfac goal mpi simpli state develop wide use standard write messagepass program interfac attempt establish practic portabl effici flexibl standard messag pass main advantag establish messagepass standard portabl eas use distribut memori commun environ higherlevel routin andor abstract build upon lowerlevel messagepass routin benefit standard particularli obviou furthermor definit messagepass standard provid vendor clearli defin base set routin implement effici case provid hardwar support therebi enhanc scalabl see httpmpiforumorg point histori mpi reach critic popular level bunch project poppedup like daisi grass tendenc back gather merg instanc open mpi project combin technolog resourc sever project ftmpi lampi lammpi pacxmpi order build best mpi librari avail open mpi complet new mpicompli implement offer advantag system softwar vendor applic develop comput scienc research see httpswwwopenmpiorg openmp openmp applic program interfac api support multiplatform sharedmemori parallel program cc fortran architectur includ unix platform window nt platform jointli defin group major comput hardwar softwar vendor openmp portabl scalabl model give sharedmemori parallel programm simpl flexibl interfac develop parallel applic platform rang desktop supercomput httpwwwopenmporg openmp rare use within abinit version x specif purpos last version benefit multithread librari speedup like mkl fftw still mandatori new architectur multithread show better perform mpi multithread version linear algebra librari provid scalapack scalapack parallel version popular lapack librari linear algebra play role parallel sever part abinit especi lobpcg algorithm ground state calcul parallel bethesalpeth equat scalapack base mpi discuss use abinit tutori warn scalapack threadsaf mani version combin openmp scalapack result unpredict behaviour fastslow commun character datatransf effici two comput core whole set core complex task quit basic level one recogn quantiti data transfer per unit time import also time need initi transfer call latenc broadli speak one categor comput follow speed commun fast commun machin latenc low transfer time initi low parallelis part abinit smp machin machin fast interconnect usual limit network characterist exist residu sequenti part tutori develop abinit base fast commun machin set comput core plan use entir link use fast network includ connect base eg ethernet might abl benefit speedup announc tutori perform test actual machin gain knowledg perhap consid use multithread part abinit parallel parallel code delic complic task thu expect thing systemat go faster use processor pleas keep also mind situat parallel simpli imposs present time part abinit parallel tutori avail includ ground state plane wavestutorialparal_gspw ground state waveletstutorialparal_gswvl molecular dynamicstutorialparal_moldyn parallel imagestutorialparal_imag densityfunct perturb theori dfpttutorialparal_dfpt manybodi perturb theorytutorialparal_mbt note tutori ground state plane wavestutorialparal_gspw present complet overview parallel ground state includ four level parallelis rather complex cours also quit power allow use sever hundr processor albeit two level base treatment kpoint reciproc space treatment spin spinpolar collinear situat nsppol contrari quit easi use exampl parallel given next section simpl exampl parallel abinit tutorial_readm run job start might consid work differ subdirectori tutori work_par first one need copi input file abi_teststutori directori work directori name tbasepar_abi sh cd abi_teststutorialinput mkdir work_par cd work_par cp tbasepar_abi start immedi sequenti run abinit tbasepar_abi log err refer cpu time intel xeon c ghz run second input file abi might possibl modifi parallel execut one avoid unnecessari network commun inde everi node temporari scratch directori multicor case achiev provid path local disk temporari file input file use tmpdata_prefix variabl suppos processor access local temporari disk space name scratchus might add input abi file follow line tmpdata_prefixscratchusertbasepar_ note determin ahead time precis resourc need run save lot time use batch queue system also parallel run note _log_ file written exept main log file chang behaviour creat file name _log enforc creation log file bash touch _log contrari creat _nolog file want avoid log file parallel kpoint favor case parallel run treat kpoint concurr sinc calcul done independ one actual tbasepar_abi correspond investig fcc crystal lead requir larg number kpoint one want get accur descript ground state examin file note cutoff realist well grid kpoint give k point irreduc brillouin zone done output file sequenti run launch start read section like produc examin time output file last line give overal time cpu wall keep note assum compil abinit indic with_mpiy configur step multicor pc might succeed use two comput core issu run command mpi implement mention number processor want use well abinit command bash mpirun n abinit tbasepar_abi tbasepar_log depend particular machin mpirun might replac mpiexec n option varianc cluster mpich implement mpi set file address differ cpu let suppos call _cluster_ pc biprocessor machin file could one line like follow sleepypcpmuclacb cluster four machin might someth like tux tux tux tux issu run command mpi implement mention number processor want use well abinit command file contain cpu address pc biprocessor machin give follow bash mpirun np machinefil cluster srcmainabinit tbasepar_abi tbasepar_log examin correspond output file kept output sequenti job make diff two file notic numer result quit ident also see kpoint kept memori sequenti case keyword mkmem kpoint kept memori per processor parallel case time found end file exampl proc individu time sec cpu wall calcul complet deliv warn comment log file overal time end sec cpu wall correspond effect speedup job factor two let examin line begin proc correspond cpu wall clock time seen processor number processor index alway start number sec cpu time nearli amount wall clock time line start overal time correspond sum cpu time wall clock time processor summat quit meaning cpu time wall clock time job finish sec sec might tri increas number processor see whether cpu time share equal amongst differ processor wall clock time seen processor decreas point depend machin sequenti part abinit abl decreas wall clock time seen one processor worth tri use processor let us defin speedup time taken sequenti calcul divid time parallel calcul hope get curv similar one speedup kptbasepar_assetsbasepar_speeduppng speedup kpt parallelis _speedup k point parallelization_ red curv materi speedup achiev green one x line shape red curv vari depend hardwar configur one last remark number kpoint need multipl number processor exampl might tri run case processor treat lfloor rfloor k point time processor treat one k point maxim speedup instead tri avoid leav empti processor make abinit fail certain compil empti processor happen exampl use processor number k point extra processor use work run anyway confirm abinit processor aliv parallel spin parallel spin done along one kpoint work exactli way file tbasepar_abi abi_teststutori treat spinpolar system distort fcc iron one kpoint irreduc brillouin zone quit unphys sole purpos show spin parallel two processor kpoint parallel preced spin parallel processor one ought one kpoint see spin parallel need modifi input file provid local temporari disk space run test case sequenti parallel job run read input look close output log file sequenti parallel case quit similar actual apart mention two processor speedup manifest parallel processor hand might increas valu ngkpt one kpoint avail see kpoint spin parallel inde work concurr number comput core accomplish task balanc effici load processor alway straightforward use kpoint spinparallel ideal number processor use divid product nsppol nkpt eg nsppol nkpt quit effici use processor abinit nevertheless handl correctli number processor albeit slightli less effici final time determin processor biggest share work evidenc overhead beyond certain number processor effici parallel satur may even decreas due inevit overhead result increas amount commun processor loss effici highli depend implement link decreas charg processor detail implement mpi toolbox abinit abinitspecif mpi routin locat differ subdirectori abinitsrc _hide_mpi _manage_mpi _io_mpi _seqpar_mpi includ lowlevel commun handler header io helper hdr_io hdr_io_netcdf wavefunct io helper wff multiprocessawar output routin wrtout clean exit routin leave_new use wide rang routin might want look routin header detail descript parallel routin hint give advic parallel subroutin abinit expect much rememb remain mostli decis furthermor suppos familiar abinit intern sourc code anyway skip section without hesit primarili intend advanc develop first everi call mpi routin everi pure parallel section subroutin must surround follow preprocess direct dont use function provid m_xmpi modul fortran defin have_mpi endif usual function write argument commun retriev number processor commun xmpi_comm_sizecomm rank processor xmpi_comm_rankcomm exampl function fortran subroutin dosomethinargcomm defin argument integ intentin arg integ intentin com defin local argument integ rank integ size integ paramet master proc master retriev size rank size xmpi_comm_sizecomm rank xmpi_comm_rankcomm thing call xmpi_sum use wrappedfunct defin have_mpi call mpi_comm_splitcom endif master someth rank master thing endif call wrtoutstd_outonli master writecol call wrtoutstd_outeach proc write std_outper author volevano fbrunev mg xg first tutori gw quasiparticl band structur silicon gw approxim tutori aim show calcul selfenergi correct dft kohnsham ks eigenvalu gw approxim brief descript formal equat implement code found theorymbtgw_not differ formula gw formal written pdfgwapdf document valerio olevano also wrote first version tutori much consist discuss theoret aspect gw method refer reader review articl citeaulburquasiparticl calcul solid wg aulbur et al also avail herehttpswwwabinitorgsitesdefaultfilesquasiparticle_calculations_in_solidspdfbz suggest acknowledg effort develop gw part abinit cite citegonz abinit public user familiar four basic tutori abinit see tutori home pagetutori first tutori gw read second gw tutorialtutorialgw tutori take hour tutorial_readm gener exampl almost converg gw calcul begin might consid work differ subdirectori tutori work_gw end tutori tutorialbas comput ks band structur silicon approxim band dispers well band width reason band gap qualit wrong comput band gap much accur use socal gw approxim start exampl show perform singl input file calcul ground state densiti kohn sham band structur screen gw correct use reason valu paramet calcul discuss converg test postpon next paragraph see gw calcul much timeconsum comput ks eigenvalu let us run immedi calcul run explain done sh mkdir work_gw cd work_gw cp abi_teststutorialinputtgw_abi issu sh abinit tgw_abi log err pleas run job background take minut meantim read follow four step gw calcul order perform standard oneshot gw calcul one run converg ground state calcul obtain selfconsist densiti perform non selfconsist run comput ks eigenvalu eigenfunct includ sever empti state note unlik standard band structur calcul ks state must comput regular grid kpoint limit also present hybrid function calcul use optdriv comput independentparticl suscept chi regular grid qpoint least two frequenc usual omega pure imaginari frequenc order plasmon frequenc dozen ev invers dielectr matrix epsilon obtain via matrix invers store extern file scr list qpoint automat defin kmesh use gener ks state previou step use optdriv comput selfenergi sigma matrix element given set kpoint order obtain gw quasiparticl energi note kpoint must belong kmesh use gener wfk file step flowchart diagram standard oneshot run depict figur gw_assetsgw_flowchartpng input file tgw_abi precis structur four dataset first dataset perform scf calcul get densiti second dataset read previou densiti file perform nscf run includ sever empti state third dataset read wfk file produc previou step drive comput suscept dielectr matric produc anoth special file tgw_xo_ds_scr _scr screen actual invers dielectr matrix epsilon fourth dataset code calcul quasiparticl energi th th band gamma point edit tgw_abi file dialog teststutorialinputtgw_abi first half file find special input variabl dataset second half file one find datasetindepend inform name input variabl describ cell atom type number posit planewav cutoff energi scf converg paramet drive ks band structur calcul b gener kohnsham band structur wfk file dataset drive rather standard scf calcul worth notic use tolvr stop scf cycl want wellconverg ks potenti use subsequ nscf calcul dataset comput band set nbdbuf first state must converg within tolwfr highest energi state simpli consid check converg dataset scfg run nband tolvr e dataset definit paramet calcul wfk file nband number occ empti band comput nbdbuf appli converg criterium last band faster iscf getden tolwfr stop toler achiev import nbdbuf trick allow us save sever minim step last band usual requir iter converg iter diagon algorithm also note good idea increas significantli valu nbdbuf comput mani empti state rule thumb use nband even complic system realli make huge differ level wall time c gener screen scr file dataset calcul screen ks suscept chi invers dielectr matrix epsilon perform need set optdriv optdriv screen calcul getwfk input variabl similar get input variabl abinit getwfk obtain wfk file previou dataset case tell code use wfk file calcul previou dataset three input variabl describ comput nband band use screen calcul ecutep cutoff energi planewav set repres dielectr matrix case use band calcul ks respons function chi dimens chi well matric chi epsilon determin cutoff energi ecutep hartre yield planewav case final defin frequenc screen must evalu omega ev imaginari frequenc omega ev latter determin input variabl ppmfrq ppmfrq ev imaginari frequenc calcul screen two frequenc use calcul plasmonpol model paramet nonzero frequenc recommend use valu close plasmon frequenc plasmonpol model work well plasmon frequenc usual close hartre paramet screen calcul far one give converg electron energi loss function mathrmim epsilon_ spectra one start use indic eel calcul exist literatur comput gw energi dataset calcul selfenergi matrix element perform one need defin driver option well _wfk _scr file optdriv selfenergi calcul getwfk obtain wfk file dataset getscr obtain scr file previou dataset getscr input variabl similar get input variabl abinit come definit paramet need comput selfenergi comput suscept dielectr matric one must defin set band two set planewav nband band use selfenergi calcul ecutsigx dimens g sum sigma_x dimens sigma_c control npwep case nband control number band use calcul correl part selfenergi ecutsigx give number planewav use calcul sigma_x exchang part selfenergi size planewav set use comput sigma_c correl part selfenergi control ecutep larger valu use gener scr file initi converg studi advis set ecutsigx valu high ecut sinc anyway paramet much influenti total comput time note exact treatment exchang part requir principl ecutsigx ecut come paramet defin kpoint band indic quasiparticl energi comput nkptgw number kpoint calcul gw correct kptgw kpoint bdgw calcul gw correct band nkptgw defin number kpoint gw correct comput kpoint reduc coordin specifi kptgw bdgw give minimummaximum band whose energi calcul select kpoint import kpoint must belong kmesh use gener wfk file henc wish gw correct particular kpoint choos grid contain usual done take kpoint grid converg achiev shift least one kpoint place wish posit brillouin zone addit paramet call zcut studi relat selfenergi comput meant avoid diverg might occur calcul due integr pole along integr path e examin output file calcul end let examin output file open tgw_abo prefer editor find section correspond dataset dialog teststutorialrefstgw_abo descript unit cell pseudopotenti find list kpoint use electron grid qpoint irreduc part brillouin zone suscept dielectr matric comput kmesh wavefunct number point irreduc wedg reduc coordin weight e e e e e e e e e e e e e e e e e e togeth symmetri oper timerevers symmetri yield point full brillouin zone qmesh screen function number point irreduc wedg reduc coordin weight e e e e e e e e e e e e e e e e e e togeth symmetri oper timerevers symmetri yield point full brillouin zone qmesh set possibl momentum transfer point obtain possibl differ among kpoint mathbfq mathbfkmathbfk grid chosen gener wfk file last statement clear import choos homogen kpoint grid order minim number qpoint clear section code print paramet fft grid need repres wavefunct comput convolut requir screen matric inform mpi distribut band total number valenc electron comput integr densiti unit cell setmesh fft mesh size select x x total number point screen take advantag timerevers symmetri maximum band index partial occupi state nbvw remain band divid among processor nbcw number band treat node valenc densiti one obtain classic drude plasmon frequenc next line calcul averag densiti system evalu wigner radiu r_ comput drude plasmon frequenc number electron calcul densiti expect averag densiti n r_ omega_plasma ev valu use default ppmfrq fact second frequenc code calcul dielectr matrix adjust plasmonpol model paramet found drude plasma frequenc reason valu adjust model control paramet howev left user order check result chang chang ppmfrq one care finit system system semicor electron result depend much ppmfrq plasmonpol model appropri one go beyond take account full dynam depend screen see later contourdeform method howev plasmonpol model found work well larg rang solidst system focus real part gw correct band gap region end screen calcul macroscop dielectr constant print dielectr constant dielectr constant without local field note note converg dielectr constant guarante converg gw correct viceversa fact dielectr constant repres one element ie head full dielectr matrix even converg dielectr constant local field take somehow account also nondiagon element gw calcul whole epsilon matrix use build selfenergi oper dielectr constant report socal rpa dielectr constant due electron although evalu zero frequenc understood ionic respons includ term comput dfpt anaddb rpa dielectr constant restrict electron effect also one comput dfpt part abinit includ exchangecorrel effect enter fourth dataset dataset gener inform origin wfk file header descript unit cell kpoint qpoint descript fft grid jellium paramet echo paramet plasmonpol model invers dielectr function screen selfenergi oper construct one evalu gw energi state final result yaml selfenergy_e kpoint spin ks_gap qp_gap delta_qp_k data sigmaeedata band e vxcdft sigx sigc z dsigcd sige ee e desir kpoint gamma point state state one find differ inform sigmaeedata section e ks eigenenergi vxcdft give ks exchangecorrel potenti expect valu sigx give exchang contribut selfenergi sigc give correl contribut selfenergi evalu ks eigenenergi z renormalis factor dsigcd energi deriv sigc respect energi sigc give correl contribut selfenergi evalu gw energi ee differ gw energi ks eigenenergi e final gw quasiparticl energi case prior sigmaeedata section direct band gap also analyz ks_gap direct ks gap particular kpoint spin case spinpolar calcul qp_gap gw one delta_qp_k differ direct gap alway comput band whose number equal number electron cell divid two integ part case spinpolar calcul next one mean valu report code may wrong final qp energi obtain perturb approach order increas energi anymor alway good idea check gap report code correspond real qp direct gap warn metal two band systemat lie ks fermi energi concept direct gap relev case moreov one comput fermi energi qp system seen ks exchangecorrel potenti expect valu state valenc state rather close exchang selfenergi correct state correl correct small differ ks gw energi also small ev contrast exchang selfenergi much smaller averag kohnsham potenti state conduct state correl correct much larger state whole differ kohnsham gw energi larg nevertheless quit import compar size gap abipi instal machin use abiopen script print option extract result sigresnc file print termin abiopenpi tgw_o_ds_sigresnc p structur full formula si reduc formula si abc angl site sp b c si si abinit spacegroup spgid num_spatial_symmetri has_timerev true symmorph true kohnsham band number electron fermi level ev nsppol nkpt mband nspinor nspden smear scheme none tsmear_ev occopt direct gap energi ev initi state spin kpt weight band eig occ final state spin kpt weight band eig occ fundament gap energi ev initi state spin kpt weight band eig occ final state spin kpt weight band eig occ bandwidth ev valenc maximum locat spin kpt weight band eig occ conduct minimum locat spin kpt weight band eig occ tip call set_fermie_to_vbm set fermi level vbm nonmagnet semiconductor qp direct gap qp_dirgap ev kpoint gamma spin qp result kpoint spin ev kpoint gamma spin band e qpe qpe_diago vxcme sigxm sigcme vume ze detail sigresnc file abipi api see sigresfilenb prepar converg studi kohnsham structur wfk file screen scr file follow section perform differ converg studi order keep cpu time reason level use fake wfk scr data focu gw correct gamma point determin valu gw paramet need reach converg inde use coars kpoint grid one shift vari ecut common strategi find adequ specif gw paramet final calcul done suffici fine kpoint grid adequ ecut addit adequ specif gw paramet directori work_gw copi file tgw_abi sh cp abi_teststutorialinputtgw_abi edit tgw_abi file take time examin issu sh abinit tgw_abi tgw_log err step need wfk scr file produc run next run move tgwo_ds_wfk tgwo_ds_wfk tgwo_ds_scr tgwo_ds_scr next section intend show find converg valu paramet specif gw calcul follow paramet might use decreas cpu time andor memori requir addit wellknown k point sampl ecut optdriv one need studi converg respect ecutep nband simultan optdriv behaviour respect nband monitor mention global converg respect ecut number k point monitor well determin adequ paramet done independ determin adequ valu ecutep nband altogeth one determin adequ valu four paramet gw calcul instead two groundstat calcul ecut number k point adequ valu ecut number k point converg result might perhap groundstat calcul alway case test converg respect nband ecutep simultan optdriv side note actual technic paramet like ecutwfn ecutsigx howev one use default valu ecut paw pawecutdg tune well begin converg studi respect nband import paramet need selfenergi calcul optdriv selfenergi calcul need doubl dataset loop check converg ecutep paramet optdriv calcul reli previous determin scr file converg selfenergi respect number band let us check converg band gap respect number band calcul sigma_c fix screen file converg studi import howev time converg nband similar sigma_c chi_ valu taken proceed care converg two occur nband independ converg number band calcul sigma_c done defin five dataset increas nband ndtset nband nband directori work_gw copi file tgw_abi sh cp abi_teststutorialinputtgw_abi edit tgw_abi file take time examin issu sh cp tgw_o_ds_wfk tgw_o_ds_wfk cp tgw_o_ds_scr tgw_o_ds_scr abinit tgw_abi tgw_log err dialog teststutorialinputtgw_abi edit output file number band use selfenergi mention fragment output sigma fundament paramet plasmon pole model number planewav sigmax number planewav sigmac w number planewav wavefunct number band gather gw energi number band one get number band number band number band number band number band nband consid converg within mev fair compar experiment accuraci abipi one use abicomp script provid compar multipl sigresnc file use expos option visual qp gap extract differ netcdf file text abicomppi sigr tgw_o__sigresnc e sn output robotget_datafram nsppol qpgap nspinor nspden nband nkpt tgw_o_ds_sigresnc tgw_o_ds_sigresnc tgw_o_ds_sigresnc tgw_o_ds_sigresnc tgw_o_ds_sigresnc ecutwfn ecutep ecutsigx scr_nband sigma_nband tgw_o_ds_sigresnc tgw_o_ds_sigresnc tgw_o_ds_sigresnc tgw_o_ds_sigresnc tgw_o_ds_sigresnc gwcalctyp scissor_en tgw_o_ds_sigresnc tgw_o_ds_sigresnc tgw_o_ds_sigresnc tgw_o_ds_sigresnc tgw_o_ds_sigresnc gw_assetsabicomp_sigres_tgw_opng invok script without option open ipython termin interact abipi robot use nb option automat gener jupyt notebook open browser detail api provid sigr robot see sigresfilenb gwlessonnb gw calcul power abipi converg screen respect number band come back calcul screen adequ converg studi coupl chang paramet optdriv comput gw energi chang one reli converg macroscop dielectr constant assess converg gw energi consequ defin doubl loop dataset ndtset udtset dataset drive comput gw energi calcul selfenergi matrix element gw correct optdriv getscr ecutsigx nband dataset drive correspond comput screen calcul screen epsilon matrix optdriv latter seri vari two differ paramet ecutep nband let us begin nband converg studi rather import done time converg studi number band selfenergi note number band use calcul screen selfenergi lower larg amount resort extrapolar techniqu see input variabl gwcomp second check converg number band calcul screen done defin five dataset increas nband nband nband nband nband nband directori work_gw copi file tgw_abi sh cp abi_teststutorialinputtgw_abi edit tgw_abi file take time examin issu sh cp tgw_o_ds_wfk tgw_o_ds_wfk abinit tgw_abi tgw_log err dialog teststutorialinputtgw_abi edit output file number band use wavefunct comput screen mention fragment output epsilon paramet scr file dimens ep matrix file dimens ep matrix use number planewav wavefunct number band gather gw energi number band one get number band number band number band number band number band comput use band consid converg within mev note valu nband give converg dielectr matrix usual order magnitud one give converg sigma_c converg screen matrix respect number planewav check converg number plane wave calcul screen done defin six dataset increas ecutep ecutep ecutep directori work_gw get file tgw_abi sh cp abi_teststutorialinputtgw_abi edit tgw_abi file take time examin issu sh cp tgw_o_ds_wfk tgw_o_ds_wfk abinit tgw_abi tgw_log err dialog teststutorialinputtgw_abi edit output file number band use wavefunct comput screen mention fragment output epsilon paramet scr file dimens ep matrix gather gw energi number band one get dimens ep matrix dimens ep matrix dimens ep matrix dimens ep matrix dimens ep matrix dimens ep matrix ecutep npwep consid converg within mev stage know screen comput need ecutep ha nband cours skip difficult part converg test converg number kpoint import check converg paramet one howev might time consum sinc cpu time scale squar number kpoint roughli number kpoint increas rapidli one possibl grid next denser one leav present tutori consid alreadi know suffici kpoint grid last calcul discuss citesetten converg studi kpoint number band cutoff energi decoupl sens one start reasonabi coars kmesh find converg valu nband ecutep ecutsigx fix valu look converg respect bz mesh calcul gw correct band gap zone center tri perform gw calcul real problem calcul gw correct direct band gap bulk silicon gamma point directori work_gw get file tgw_abi sh cp abi_teststutorialinputtgw_abi edit tgw_abi file without examin comment line ngkpt densiti k point use automat test tutori uncom line ngkpt densiti k point need converg calcul issu sh abinit tgw_abi tgw_log err job last coupl minut worth run examin input file examin dialog teststutorialinputtgw_abi need usual part input file perform ground state calcul done dataset end dataset print densiti wavefunct file use set kpoint irreduc brillouin zone set kpoint shift contain gamma point dataset calcul screen screen calcul timeconsum decid decreas bit paramet found previou converg studi inde nband decreas cpu time part linear respect paramet exactli number conduct band thu cpu time decreas factor refer previou converg studi see absolut accuraci gw energi order ev would annoy absolut posit band energi requir bandoffset ioniz potenti finit system howev long interest gap energi fine enough final dataset calcul selfenergi matrix element gamma use previous determin paramet obtain follow result yaml selfenergy_e iteration_st dtset kpoint spin ks_gap qp_gap delta_qp_k data sigmaeedata band e vxcdft sigx sigc z dsigcd sige ee e dft energi gap gamma ev gw correct ev gw band gap found ev one compar obtain one get literatur exp ev landoltboernstein dft lda lda ev l hedin phi rev lda ev ms hybertsen louie prl lda flapw ev n hamada hwang aj freeman prb lda paw ev b arnaud alouani prb lda ev present work gw ev ms hybertsen louie prl gw ev ms hybertsen louie prb gw ev rw godbi schlueter lj sham prb gw flapw ev n hamada hwang aj freeman prb gw flapw ev w ku ag eguiluz prl gw ev present work valu spread interv ev depend detail calcul case pseudopotenti calcul depend cours pseudopotenti use howev gw result hardli accur ev present state art goe also sourc inaccuraci choic pseudopotenti arriv even ev also taken account choos level accuraci converg paramet gw calcul reason target numer sourc error due insuffici ecutep nband k point grid kept lower ev comput gw band structur final possibl calcul full gw band plot system via interpol three possibl techniqu first one base use wannier function interpol select point ibz obtain use direct gw approach citehamann need wannier plugin instal see directori testswanni test case exampl file gw calcul follow use wannier dialog testswannierinputtabi wannier interpol accur method handl band cross may requir addit work obtain well local wannier function anoth practic way follow fact qp energi similarli ks eigenvalu must fulfil symmetri properti eekpg eekk eeskk eekk gg reciproc lattic vector rotat point group crystal therefor possibl employ starfunct interpol shankland koell wood citeeuwema citekoel improv version propos citepickett fit abinitio result interpol techniqu construct pass initi point satisfi basic symmetri properti band energi stress howev fourierbas method problem presenc band cross may caus unphys oscil abinitio point reduc spuriou effect suggest interpol gw correct instead gw energi correct inde usual smoother kspace result fit stabl python exampl show construct interpol scissor oper abipi avail herehttpabinitgithubioabipygalleryplot_qpbands_with_interpolationhtmlsphxglrgalleryplotqpbandswithinterpolationpi third method use fact gw correct usual linear energi group band evid report plot gw correct respect order ks energi state one simpli correct ks band structur point use gw correct kpoint calcul explicitli use fit gw correct spars set point python exampl show construct energydepend scissor oper abipi avail herehttpabinitgithubioabipygalleryplot_qpbands_with_scissorhtmlsphxglrgalleryplotqpbandswithscissorpi advanc featur gw calcul user might switch second gw tutorialtutorialgw come back present section calcul without use plasmonpol model order circumv plasmonpol model gw frequenc convolut calcul explicitli along real axi tough job sinc g w pole along real axi therefor conveni use anoth path integr along imaginari axi plu residu enclos path consequ better evalu screen imaginari frequenc perform integr also real frequenc evalu contribut residu may enter path integr number imaginari frequenc set input variabl nfreqim regular grid real frequenc determin input variabl nfreqr set number real frequenc freqremax indic maximum real frequenc use method particularli suit output spectral function contain file outsig grid real frequenc use calcul spectral function set number frequenc input variabl nfreqsp maximum frequenc calcul input variabl freqspmax selfconsist calcul detail implement justif approxim retain found citebrunev ad input variabl getqp irdqp variabl concern read _qp file contain eigenvalu unitari transform matric previou quasiparticl calcul qp stand quasiparticl structur modifi input variabl selfconsist calcul gwcalctyp bdgw variabl gwcalctyp code calcul quasiparticl energi output qp file standard gw run variabl gwcalctyp code calcul quasiparticl energi output qp file variabl gwcalctyp code calcul quasiparticl energi wavefunct output qp file full selfconsist calcul quasiparticl wavefunct expand basi set ks wavefunct variabl bdgw indic size matric calcul diagon quasiparticl wavefunct consequ linear combin ks wavefunct min max valu bdgw correct selfconsist calcul consist follow run selfconsist ks calcul output wfk file screen calcul ks input output scr file sigma calcul ks input output qp file screen calcul wfk qp file input output new scr file sigma calcul wfk qp new scr file output new qp file screen calcul wfk new qp file output newer scr file sigma calcul wfk newer qp scr file output newer qp desir accuraci reach note hartreefock calcul dummi screen requir initi reason therefor correct hf calcul look like selfconsist ks calcul output wfk file screen calcul use low converg paramet ks input output dummi scr file sigma calcul ks input output qp file sigma calcul wfk qp file output new qp file sigma calcul wfk new qp file output newer qp file desir accuraci reach case selfconsist calcul output slightli complex instanc iter yaml selfenergy_e iteration_st dtset kpoint spin ks_gap qp_gap delta_qp_k data sigmaeedata band e_dft vxcdft en hhartre sigx sigcen z dsigcd sigen delta en_pert en_diago column band index band e_dft dft eigenvalu vxcdft diagon expect valu xc potenti dft bra ket en quasiparticl energi previou iter equal dft first iter hhartre diagon expect valu hartre hamiltonian equal e_dft vxcdft first iter sigx diagon expect valu exchang selfenergi sigcen diagon expect valu correl selfenergi evalu energi preceed iter z quasiparticl renorm factor z taken equal method hf sex cohsex model gw dsigcd deriv correl selfenergi respect energi sigen total selfenergi new quasiparticl energi delta energi differ respect previou step en_pert qp energi obtain usual perturb method en_diago qp energi obtain full diagon author dc mt parallel ground state use wavelet boron cluster alkan molecul tutori explain run calcul isol system use wavelet basisset parallel comput use mpi learn differ characterist parallel run use wavelet basisset test speedup small boron cluster atom follow test bigger alkan molecul tutori take minut requir sever cpu core possibl suppos know alreadi basic parallel abinit explain tutori first introduct abinit paralleltutorialbasepar tutori profit alreadi perform calcul use wavelet formal see topicwaveletstop page wavelet usewvl keyword import use wavelet basi set abinit compil bigdft librari download bigdft fallbackhttpswwwabinitorgfallback use withbigdft bigdft_lib bigdft_fcflag etc flag configur step tutorial_readm wavelet variabl parallel parallel wavelet formal use two purpos reduc memori load per node reduc overal comput time mpi parallel wavelet mode reli orbit distribut scheme orbit system investig distribut assign mpi process scheme reach limit number mpi process equal number orbit simul distribut orbit uniformli number processor must factor divisor number orbit case distribut optim code tri balanc load processor exampl orbit processor orbit distribut specif input variabl use parallel wavelet mode parallelis level orbit run abinit mpirun command enough command differ accord local mpi implement mpirun n nproc abinit infileabi logfil understand wavelet mode citat purpos one may read citegenoves speedup calcul boron cluster propos determin speedup calcul total energi cluster made boron atom boronparal_gswvl_assetsboronjpgwidth open file tgswvl_abi contain first definit wavelet basisset one may want test precis calcul vari wvl_hgrid wvl_crmult variabl purpos tutori use given valu bohr dialog teststutoparalinputtgswvl_abi run abinit processor overal time print end output file log proc individu time sec cpu wall read output file find number orbit calcul given keyword nband distribut scheme wavelet mode best distribut processor obtain processor creat four differ directori number processor instanc run four time abinit input file vari number processor abinit tgswvl_abi log speedup ratio time one processor time run n processor assum directori call one grep overal time run plot gnuplothttpwwwgnuplotinfo graphic tool issu gnuplot gnuplot command line type plot grep individu time abo tr u ttt w lp boron cluster x ideal speedup ttt repres time one processor replac ttt time command line speedup boron clusterparal_gswvl_assetsspeedupbpngwidth effici percent parallel process ratio speedup number processor one plot use gnuplothttpwwwgnuplotinfo plot grep individu time abo tr u ttt w lp boron cluster effici boron clusterparal_gswvl_assetsefficiencybpngwidth first conclus effici good one use one orbit per processor gener rule wavelet mode due implement good balanc speed effici obtain two orbit per processor one also see effici gener decreas number processor system rather small amount time spent overhead read input file initialis array impact perform let see focu calcul part time partit wavelet mode gener wvl_timingsyml file run warn eras exist copi text file yaml formathttpsenwikipediaorgwikiyaml read directli three section give time initialis process sectioninit time scf loop section wfn opt time postprocess section postprc note wvl_timingsyaml file creat timopt set input file let closer look scf section extract follow data actual figur vari run number processor wfn opt class time max min load rel flib lowlevel commun blaslapack e ps comput potenti convolut linear algebra e initi e total categori time max min load rel allreduc larg size class commun allreduc oper rho_comput class convolut opencl port precondit class convolut opencl port applylocpotkin class convolut opencl port exchangecorrel class potenti construct local xc potenti psolver comput class ps comput sg_fft relat oper init zero class flib lowlevel memset storag space allreduc small size class commun allreduc oper pot_commun class commun allgathrv grid psolver commun class commun mpi_alltoal mpi_allgatherv array alloc class flib lowlevel heap storag alloc untranscomm class commun alltoallv dii class applyproj class rma pattern rho_commun e class commun allreduc grid vector copi e class flib lowlevel memori copi array untransswitch e class rma pattern bla gemm e class blaslapack matrixmatrix multipl chol_comput e class linear algebra allreduc orb crtlocpot e class initi miscellan routin profil e class flib lowlevel profil perform total time wfn opt section one comput speedup effici wavelet mode accur n processor time speedup effici percentag wvl_timingsyaml file one see exampl time mostli spent commun precondionn comput densiti applic local part hamiltonian let categoris time inform commun time entri class commun time spent convolut entri class convolut linear algebra part entri class linear algebra blaslapack entri miscellan categori summat given file top section one obtain percentag per categori scf loop class percent timesec convolut commun potenti flib lowlevel ps comput linear algebra analys wvl_timingsyaml gener differ number processor see evolut differ categori orbit parallel array parallel number processor divisor number orbit processor fewer orbit other best distribut orbit point view wavelet mode also distribut scalar array like densiti potenti zplane real space part code may becom effici use bigger number processor like poisson solver part instanc run boron exampl processor plot speedup one also look standard output load balanc orbit load balanc poisson solver processor processor repartit orbit follow process treat orbit process treat orbit process treat orbit processor read log file poisson kernel initi mpi task poisson kernel creation boundari condit free memori requir per mpi task densiti mb kernel mb full grid array mb load balanc calcul densiti mpi task kernel mpi task mpi task complet lb per task lb_densiti lb_kernel expect one see load balanc per orbit bad processor noth load balanc scalar array distribut good sinc last processor reduc array thu useless run job processor give run time sinc load balanc better speedup calcul atom alkan let bigger molecul finer grid open file tgswvl_abi contain definit alkan chain atom provid orbit boronparal_gswvl_assetsalkanejpgwidth dialog teststutoparalinputtgswvl_abi run input file processor run one processor take less one hour time short one reduc wvl_hgrid input file _time measur run sever processor c_h_ alkan chain_ speedup ch alkan chainparal_gswvl_assetsspeedupcpng effici ch alkan chainparal_gswvl_assetsefficiencycpng time repartit ch alkan chainparal_gswvl_assetstimecpng obtain previous effici gener lower number processor divisor number orbit name conclus wavelet mode possibl effici decreas run time increas number processor effici limit increas amount time spent commun effici increas qualiti calcul accur calcul finer _hgrid_ effici code parallel author xg rc first tutori dfpt dynam dielectr properti ala tutori learn get follow physic properti insul densityfunct perturb theori dfpt phonon frequenc eigenvector gamma dielectr constant born effect charg loto split phonon frequenc eigenvector qpoint brillouin zone order learn use associ code mrgddb anaddb produc phonon band structur associ thermodynam properti pleas consult second tutori dfpttutorialrf tutori take hour tutorial_readm groundstat geometri ala begin might consid work differ subdirectori tutori creat work_rf abi_teststutorespfninput sh cd abi_teststutorespfninput mkdir work_rf cd work_rf cp trf_abi import refer directori contain exampl file tutori abi_teststutoriala basic tutori special nondfpt one abi_teststutorespfn case dfpt base part tutori note two pseudopotenti mention input file one aluminum atom one arsen atom first list trf_abi al defin first type atom input file see input variabl typat ntypat second defin second type atom might first time encount situat one type atom tutori varianc first four basic tutori warn access pseudopotenti input file expect defin variabl abi_pspdir environ copi file abi_teststutorespfninputtrf_abi work_rf input file read care dialog teststutorespfninputtrf_abi drive singl selfconsist calcul total energi ala gener correspond selfconsist charg densiti wavefunct use dfpt calcul note valu tolvr rather stringent wavefunct determin present run use later start point dfpt calcul number step nstep exampl file set alway choos larg enough valu nstep reach tolvr target danger follow blindli exampl tutori alway check converg calcul product work fix ecut ha kpoint grid defin kptrlatt xx monkhorstpack grid real life converg test respect paramet postpon discuss accuraci choic choic pseudopotenti end fifth section tutorialdfptcalculationoftheeffectofanhomogeneouselectricfield give accept accur result run time reason tutori make run second abinit trf_abi log err result main output file trf_abo similar one dialog teststutorespfnrefstrf_abo output file long quickli read entir note one obtain follow valu energi final echo section etot e etot e howev reli later purpos finit differ accur digit valu total energi found dozen line final echo total_energi e output file also mention forc atom vanish run made consid defin groundstat configur top respons perturb comput main output groundstat run wavefunct file trf_o_wfk alreadi renam trf_i_wfk use input wave function next run frozenphonon calcul second deriv total energi comput second deriv total energi respect atom displac differ mean purpos must first read helprespfnintrosect first paragraph section respfn help file auxiliari help file deal specif dfpt featur explain later detail signif differ input paramet introduc section respfn help file time order abl perform direct comparison result dfpt calcul choos perturb displac al atom along first axi reduc coordin copi file abi_teststutorespfninputtrf_abi work_rf input file open briefli look two chang respect trf_abi chang xred read wavefunct file use irdwfk input variabl warn need copi trf_o_wfk trf_i_wfk abinit find wavefunct calcul make run follow command differ file file refer trf_abi symmetri lower respect groundstat geometri number kpoint increas lot cours cpu time dialog teststutorespfninputtrf_abi teststutorespfnrefstrf_abo run possibl get valu total energi valu gradient total energi de respect chang reduc coordin dt rm dedt e max dedt e dedt hartre total_energi e chang reduc coordin xred al atom along first axi rather small make estim second deriv total energi respect reduc coordin thank finitediffer formula start first totalenergi differ total energi symmetr respect perturb linear term differ groundstat valu e hartre previou run perturb valu e hartre present one thu one half squar coordin chang time second deriv total energi dte number dte hartre altern start reduc gradient valu reduc gradient respect displac al atom along first reduc axi ha first order quantiti product dte reduc coordin differ estim dte thu ha agreement estim rather good hartre howev possibl much better thank use higherord finitediffer formula purpos one perform anoth calcul chang reduc coordin along first axi instead doubl perturb allow rather simpl higherord estim see later result calcul follow rm dedt e max dedt e dedt hartre total_energi e data take account perturb twice stronger procedur lead valu hartre finit differ energi hartre finit differ forc valu multipli combin data previou estim done thank higherord finitediffer formula differ estim largest perturb minu smallest one divid three subtract smallest estim far totalenergi estim concern differ ha divid three subtract hartre give hartre higherord procedur forc estim give hartre agreement totalenergi estim forc estim dte observ th digit inclus compar result dte directli comput dfpt capabl abinit last comment order one observ actionreact law fulfil approxim system inde forc creat second atom exactli equal magnitud forc first atom valu dedt mention show small nonneglig differ two atom exampl doubl perturb differ absolut valu first compon reduc forc actual forc cancel exactli translat symmetri perfect case break symmetri shown aris presenc exchangecorrel grid point grid move atom displac small variat total energi system move whole easi restor actionreact law subtract everi forc compon mean forc atom actual done gradient respect reduc coordin transform forc specifi cartesian coordin seen output file small displac cartesian forc hartreebohr end effect seen also level dte socal acoust sum rule impos frequenc three mode call acoust mode tend zero vanish wavevector also slightli broken case also rather easi reimpos acoust sum rule case take finer xc grid allow one reduc effect dfpt calcul second deriv total energi comput second deriv total energi respect atom displac dfpt capabl abinit copi file abi_teststutorespfninputtrf_abi work_rf input file examin chang respect trf_abi gather first part file common input variabl accordingli get familiar new input variabl rfphon rfatpol rfdir pay attent special use kptopt input variabl explain detail later warn need copi trf_o_wfk trf_i_wfk abinit find wavefunct calcul dialog teststutorespfninputtrf_abi understood purpos input variabl valu specifi common input variabl section make code run usual need analyz differ output file purpos read content helprespfnoutputsect respfn help file read quickli come back import point hereaft abinit creat sever differ file trf_log log file trf_abo output file possibl also trf_o_outnc abridg netcdf version trf_o_wf storder wavefunct file trf_o_den storder densiti file trf_o_pot storder potenti file trf_o_ddb deriv databas possibl also trf_o_ddbnc netcdf version let us look output file follow descript provid helprespfnoutputsect respfn help file dialog teststutorespfnrefstrf_abo abl find place iter minimis respect uniqu perturb take place iter detotalha deltaeha residm vre etot e e e etot e e e etot e e e etot e e e etot e e e etot e e e etot e e e data see dte determin dfpt techniqu excel agreement higherord finitediffer valu dte determin previou section hartre energi differ hartre forc differ read remain helprespfnoutputsect respfn help file also open trf_o_ddb file read correspond helprespfnddbsect respfn help file final excel agreement finitediffer formula dfpt approach call accuraci consider found helprespfnnumericalqualitysect respfn help file tip abipi one easili visual converg dfpt cycl abiopen script syntax abiopenpi trf_abo expos snstalk rf_assetsabiopen_trf_outpng dfpt calcul dynam matrix gamma posit comput full dynam matrix gamma point q copi file abi_teststutorespfninputtrf_abi work_rf input file test rf_ chang respect trf_abi gather first part file moreov chang respect trf_abi concern input variabl rfatpol rfdir name atom displac direct warn need copi trf_o_wfk trf_i_wfk abinit find wavefunct calcul dialog teststutorespfninputtrf_abi six perturb consid one might think cpu time rais accordingli true abinit abl determin perturb symmetr anoth perturb see helprespfnsymmetriessect respfn help file make run open file trf_abo notic respons two perturb comput explicitli respons four could deduc two first use symmetri list irreduc perturb q vector idir ipert idir ipert noth mysteri one two irreduc perturb al atom place rather symmetr local site perturb atom phonon frequenc obtain diagon dynam matrix atom mass taken account see amu given follow phonon wavevector reduc coordin phonon energi hartre e e e e e e phonon frequenc cm e e e e e e tip might wonder dash sign present first column two line give frequenc cm first column main abinit output file alway dedic sign need automat treat comparison respect refer file except becom abinit develop ignor sign present case interpret minu sign float number follow good bad news result good news inde three acoust mode frequenc rather close zero less cm rather good bad news come three frequenc compar experiment result theoret result inde present run one obtain three degener mode split seen paper ab initio calcul phonon dispers semiconductor citegiannozzi especi fig actual forgotten take account coupl atom displac homogen electr field exist case polar insul socal longitudin optic lo mode split appear mode transvers optic mode split lyddanesachstel loto split present simpl term standard textbook forgotten ab initio calcul phonon frequenc thu treat correctli homogen electr field type perturb ida dfpt calcul effect homogen electr field treatment homogen electr field perturb formal much complex treatment atom displac primarili chang potenti associ homogen electr field period thu satisfi bornvon karman period boundari condit purpos present tutori one read section iic abovement paper citegiannozzi reader find citegonz citegonzea detail inform perturb close relat abinit implement also extens discuss born effect charg citeghosez order comput respons solid homogen electr field abinit remain section respfn help file read section also present inform need comput phonon nonzero q wavevector subject next section present tutori section read part helprespfnsect yet read helprespfnsect helprespfnsect complet helprespfnsect posit comput full dynam matrix gamma q includ coupl homogen electr field copi abi_teststutorespfninputtrf_abi work_rf input file dialog teststutorespfninputtrf_abi teststutorespfnrefstrf_abo dfpt test chang respect trf_abi gather first part file unlik test howev multidataset mode use comput scratch groundstat properti comput effect ddk perturb effect perturb electr field well atom displac analysi output file even cumbersom previou one let us skip first dataset dataset section one perturb correctli select initi data relat q vector list irreduc perturb q vector idir ipert perturb wavevector redcoord perturb deriv vs k along direct analysi output particular perturb particularli interest except fsum rule ratio dfpt_looppert ek e fsum rule ratio e close becom closer ecut increas sampl k point improv present statu abinit frule ratio comput correctli ecutsm third dataset section three irreduc perturb consid initi data relat q vector list irreduc perturb q vector idir ipert idir ipert idir ipert much later dielectr tensor given dielectr tensor cartesian coordin j j matrix element dir pert dir pert real part imaginari part diagon isotrop correspond dielectr constant born effect charg given either comput deriv wavefunct respect electr field comput deriv wavefunct respect atom displac explain section ii citegonzea effect charg cartesian coordin electr field respons effect charg cartesian coordin phonon respons name born effect charg al atom one atom charg neutral sum rule fulfil exactli ecut increas sampl k point improv sum two charg goe closer zero final phonon frequenc comput phonon wavevector reduc coordin phonon energi hartre e e e e e e phonon frequenc cm e e e e e e phonon gamma nonanalyt direct cartesian coordin phonon energi hartre e e e e e e phonon frequenc cm e e e e e e phonon gamma nonanalyt direct cartesian coordin phonon energi hartre e e e e e e phonon frequenc cm e e e e e e phonon gamma nonanalyt direct cartesian coordin phonon energi hartre e e e e e e phonon frequenc cm e e e e e e four section first one effect homogen electr field simpli discard three next section electr field consid along three cartesian coordin present materi direction electr field influenc note still three acoust mode cm optic mode correct degeneraci two mode cm one lo mode cm valu compar experiment cm cm well theoret cm cm valu citegiannozzi discrep come low valu ecut use abinit ecut hartre give cm cm remain discrep may come partli pseudopotenti particularli soft comparison born effect charg also interest imposit neutral sum rule al born effect charg valu gianozzi et al experiment valu increas ecut hartre abinit give dielectr tensor delic valu gianozzi et al experiment valu agreement good fact attribut dft lack polarizationdepend citegonzea still agreement calcul theoret result good ecut hartre chang hartre give better k point sampl xx ecut hartre reduc valu chang pseudopotenti final improv agreement much harder alpsp aspsp pseudopotenti adequ ecut hartre xx monkhorstpack sampl reach valu note need chang ixc consid nband sinc electron al electron move pseudopotenti inform found search zion abo file use pseudopotenti illustr dielectr tensor much sensit quantiti other dfpt calcul phonon frequenc nonzero q comput phonon frequenc nonzero q actual simpler one gamma one must distinguish two case either q wavevector connect k point belong grid wavevector q gener case comput within reciproc space dfpt formal effici real space frozenphonon techniqu sinc use supercel complet avoid dfpt explan fact see exampl section iv citegonz copi file abi_teststutorespfninputtrf_abi work_rf input file dialog teststutorespfninputtrf_abi teststutorespfnrefstrf_abo rf test chang respect trf_abi gather first part file multidataset mode use comput scratch groundstat wave function comput differ dynam matric dfpt run minut ghz machin mean time might read abinit document helpmrgddbmrgddb_help helpanaddbanaddb_help result simul compar provid citegiannozzi agreement rather good despit low cutoff energi differ pseudopotenti x get cm cm cm cm get cm cm cm cm ecut hartre get cm cm cm cm l get cm cm cm cm get cm cm cm cm ecut hartre get cm cm cm cm q get cm cm cm cm acoust mode tend nearlylinearli zero optic mode close valu gamma cm cm note abinit tutori finish advis go second tutori dfpttutorialrf make postprocess analysi phonon dispers thermodynam properti etc author mc sp tutori analysi tool use cutd tutori cover featur avail program cutd help file program view helpcutd cutd program produc output read sever program present least xcrysden wwwxcrysdenorghttpwwwxcrysdenorg freeli avail known support output cutd program use treat data densiti file _den potenti file _pot wavefunct file _wfk tutori see use program obtain valu densiti line tutori take minut obtain densiti wavefunct file silicon first start simpl exampl view silicon densiti inform use cutd program first gener densiti wavefunct file run abinit program simpl case use last input file use tutori tutorialbas tbase_in input file contain two dataset one obtain selfconsist densiti obtain select number kpoint wavefunct output case need rerun stage fairli easi output file interest us tbase_o_ds_den tbase_o_ds_wfk tbase_o_ds_wfk import ask abinit output densiti set input paramet prtden input file done first dataset exampl note ds selfconsist dataset good densiti file tbase_o_ds_den physic relev care run nonselfconsist job may obtain densiti physic note wavefunct ds file tbase_o_ds_wfk monkhorst pack grid good selfconsist calcul often realli inspir physic reason often nonselfconsist run get relev wavefunct done case ds file tbase_o_ds_wfk contain interest wavefunct want analys get densiti given line readi use cutd program first must make sure compil program run command make abinit main directori everyth went well obtain abinit program accompani program particular cutd obtain cutd program issu command make cutd abinit main directori assum directori tutorialwork_tool cutd program access simpli type name write command cutd cutd program ask sever question order determin want tutori text come cutd program black input type red text version licenc see question name function densiti potenti wavef file enter densiti file tbase_o_ds_den see function file tbase_o_ds_den file contain format ascii data unformat binari header data answer gener output abinit unformat binari form press enter cutd print lot inform contain file explain densiti obtain point doubl check realli file want analys choic choic type point interpol data singl point line interpol data along line plane interpol data plane volum interpol data volum format data output bare data one column index data bare data preceed index molekel format data data coordin tecplot ascii format output xsf file xcrysden output dx file opendx comput atom charg use hirshfeld method netcdf file exit see mani option avail moment someth simpl get densiti along given line choos option given follow choic type line two cartesiandefin point line two crystallographicdefin point line defin direct select option get messag type first point coordin bohr xdir ydir zdir ask densiti along direct start origin extend two unit cell first point enter get messag type second point coordin bohr xdir ydir zdir look input file see cubic side length bohr get unit cell enter ask line resolut enter line resolut mani point calcul line typic enter larg number say ask file name enter name output file enter someth meaning si_den_dat analysi file defaultyesno enter finish cutd list file work directori see si_den_dat file look file see simpl two column file visual favorit plot softwar ex xmgrace gnuplot open file xmgrace obtain follow graph cutd_assetssi_den_png learn quit lot graph look input file see silicon atom origin anoth along diagon note also almost densiti origin line direct cross first siliconsilicon bond see larg densiti peak indic red arrow way cutd work socal trilinear interpol densiti fft grid densiti defin real space lead partit space small rectangular parallelepip parallelepip eight valu densiti corner use defin interpol linear dimens cube explicitli let us chose one corner origin defin reduc coordin vari insid parallelepip densiti insid parallelepip given densitydxdydz densiti c dx c dy c dz c dx dy c dx dz c dy dz c dx dy dz coeffici c c c c c c c determin knowledg densiti corner trilinear interpol guarante overal function space continu guarante deriv chang continu seen figur two abrupt chang slope close maximum complet spuriou featur avoid finer fft grid use determin densiti actual densiti profil along bond fine fft grid behav quit smoothli reach maximum mid point two atom contrast figur present previous note import point rememb visual densiti obtain pseudopotenti calcul core charg includ reason use pseudopotenti charg get valenc charg possibl includ core charg calcul use pseudo partial core charg fact core charg miss mean charg nucleu atom mean get low densiti nucleu center rememb physic effect locat silicon atom indic blue arrow author bamadon calcul u j use crpa use constrain rpa comput u j case srvosubsub tutori aim show perform calcul _u_ _j_ abinit use crpa method well adapt particular determin _u_ _j_ use dftdmft implement describ citeamadon might use alreadi know paw calcul use abinit mandatori follow two tutori paw abinit pawtutorialpaw pawtutorialpaw dft_u_ tutori abinit dftututorialdftu might use know basic variabl correl orbit first gw tutori abinit gwtutorialgw use learn comput screen converg relev paramet energi cutoff number band polariz tutori take two hour complet access processor tutorial_readm crpa method comput effect interact summari key paramet crpa method aim comput effect interact among correl electron gener highli correl materi contain rareearth metal transit metal partial fill _d_ _f_ band thu local electron crpa reli fact screen process decompos two step firstli bare coulomb interact screen non correl electron produc effect interact _wsubrsub_ secondli correl electron screen interact produc fulli screen interact _w_ citearyasetiawan howev second screen process taken account one use method describ accur interact among correl electron quantum mont carlo within dftdmft method avoid doubl count screen correl electron dftdmft method need input effect interact _wsubrsub_ goal tutori present implement method use project local orbit wannier orbit abinit implement crpa abinit describ citeamadon project local orbit wannier function present citeamadon discuss local wannier orbit similar begin dmft tutori see heredmftmd theredmftmd sever paramet physic technic import crpa calcul definit correl orbit first part tutori similar dmft tutori explain electron structur srvosubsub use understand definit wannier orbit variou extens wannier function unitarili relat select set kohn sham ks wavefunct specifi abinit band index dmftbandi dmftbandf thu empti band necessari build wannier function requir dmft crpa calcul ks hamiltonian correctli diagon use high valu nnsclo nline crpa dmft calcul preced dft calcul anoth solut use present tutori use specif non selfconsist calcul diagon hamiltonian _gw_ calcul concern local correl orbit gener larger dmftbandfdmftbandi local radial part wannier orbit final note wannier orbit use dmft crpa implement usual choic correl orbit dft_u_ implement particular abinit see citeamadona relat two express briefli discuss citegenest constrain polar calcul discuss section differ way defin constrain polariz suppress polar electron transit discuss section citeamadon one either suppress electron transit insid given subset kohnsham band case one use ucrpa choos first last band defin subset band use variabl ucrpa_band one also use energi window instead number band use ucrpa_window anoth solut use weight scheme lower contribut given transit function weight correl orbit band involv transit see eq citeamadon case still use variabl ucrpa_band variabl case use defin project local orbit wannier function use defin weight function polariz see eq citeamadon converg paramet polariz calcul screen calcul ecutep ecutwfn nband exchang part _gw_ effect interact ie ecutsigx ecutwfn recommend discuss appendix citeamadon use pawoptosc calcul carri sever atom use nsym calcul symmetr atom case electron structur srvo lda continu might consid work differ subdirectori tutori work_crpa follow name file mention subdirectori input file found abi_teststutoparalinput directori copi file tucrpa_abi abi_teststutoparalinput work_crpa sh cd abi_teststutoparalinput mkdir work_crpa cd work_crpa cp tucrpa_abi run code mpirun n abinit tucrpa_abi log_ run take time recommend use least processor fast calcul lda ground state srvo comput band structur second step variabl pawfatbnd allow creat file fatband see descript variabl list variabl width line along kpoint path band proport contribut given atom orbit particular kohn sham wavefunct low cutoff small number kpoint use order speed calcul time take look input file two dataset first one ground state calcul nnsclo nline order well diagon eigenfunct even empti state practic howev check residu wavefunct small end calcul calcul find e larg e would better nline nnsclo increas would take time calcul finish plot fatband vanadium l xmgrace tucrpa_o_ds_fatbands_at_v_is_l par inputtdmft_fatbandpar band structur given ev fatbandvucalc_crpa_assetsfatbandsvjpeg fatband oxygen atom l xmgrace tucrpa_o_ds_fatbands_at_o_is_l tucrpa_o_ds_fatbands_at_o_is_l tucrpa_o_ds_fatbands_at_o_is_l par inputtdmft_fatbandpar fatbandvucalc_crpa_assetsfatbandsojpeg plot recov band structur srvo see comparison band structur fig citeamadon main charact band band mainli _d_ band mainli oxygen _p_ howev clearli see import hybrid fermi level ev middl band one easili check band mainli _dtsubgsub_ band mainli _esubgsub_ use pawfatbnd tucrpa_abi relaunch calcul file tucrpa_o_ds_fatbands_at_v_is_l_m tucrpa_o_ds_fatbands_at_v_is_l_m tucrpa_o_ds_fatbands_at_v_is_l_m give respect _xy_ _yz_ _xz_ fatband ie _dtsubgsub_ tucrpa_o_ds_fatbands_at_v_is_l_m tucrpa_o_ds_fatbands_at_v_is_l_m give _zsupsup_ _xsupsupysupsup_ fatband ie _esubgsub_ conclus studi kohn sham band mainli _tsubgsub_ band cours could anticip classic crystal field theori vanadium center octahedron oxygen atom _d_ orbit split _tsubgsub_ _esubgsub_ _tsubgsub_ orbit direct toward oxygen atom _tsubgsub_lik band lower energi fill one electron wherea _esubgsub_lik band higher empti next section thu use _d_ like band built wannier function comput effect interact orbit definit screen orbit crpa model input file log file constrain polar calcul discuss briefli appendix citeamadon well section iii b citevaugi section ii b citesakuma one use differ scheme crpa calcul let us discuss differ model name _dd_ _dpdp_ _ddp_ _ddp_ b model notat ab b refer respect band alik blike charact moreov refer definit screen b refer definit correl orbit clarifi definit give exampl tsubgsubtsubgsub model _tsubgsub_ model correl orbit defin _tsubgsub_lik band band screen insid band taken account built constrain polariz note case _dd_ _dpdp_ model use ucrpa give result provid one use ucrpa_band equal dmftbandi dmftbandf dd model model correl orbit defin _d_ like band band screen insid band taken account dpdp model dp model correl orbit defin _d_ like oplik band band screen insid band taken account ddp model scheme wannier orbit construct _dpdp_ model howev scheme one supress screen insid _d_ like band ucrpa coher fact dmft appli orbit screen oplik band need taken account ddp b model model _ddp_ nevertheless case weight scheme use ucrpa abinit way comput interact relev depend way interact use aspect discuss ref citevaugi also mott insul selfconsist interact carri choic model discuss citeamadon input file crpa calcul correl orbit wannier function section present input variabl discuss extract use inform log file case _dd_ model input file typic crpa calcul tucrpa_abi contain four dataset usual _gw_ calcul see gw tutorialgwmda first one well converg lda calcul second non selfconsist calcul comput accur full empti state third comput constrain non interact polariz fourth comput effect interact paramet _u_ _j_ discuss four dataset next four subsect copi file work_crpa directori sh cp tucrpa_abi input file tucrpa_abi contain standard data perform lda calcul srvosubsub focu next subsect peculiar input variabl relat fact perform crpa calcul read follow section launch abinit calcul abinit tucrpa_abi log_ first dataset converg lda calcul first dataset simpl calcul densiti use lda use band use symmetri calcul nsym symmetri use nsym calcul _u_ _j_ valid full interact matrix describ section correct second dataset converg lda calcul definit wannier function present input variabl dataset discuss two import physic paramet relev dataset diagon kohnsham hamiltonian case dftdmft _gw_ calcul crpa calcul requir lda perfectli converg kohn sham eigenst precis determin includ empti state inde empti state necessari build wannier function comput polariz reason choos low valu tolwfr input file tucrpa_abi wannier function calcul converg comput wannier function dftdmft calcul precis use dftdmft implement usedmft wannier keyword dmftbandi dmftbandf emphas respect discuss model section dmftbandi dmftbandf use defin call band see dataset b band defin case _dd_ model choos _d_ like band start point dmftbandi dmftbandf thu equal first last _d_ like band name iscf perform non selfconsist calcul nbandkss number band kss file mean maximum possibl kssform format wavefunct file nbdbuf last four band perfectli diagon tolwfr criterion stop diagon comput wannier function usedmft mandatori enabl calcul wannier function dmft dmftbandi precis definit wannier function dmftbandf precis definit wannier function third dataset comput constrain polariz dielectr function third dataset drive comput constrain polariz dielectr function reproduc input variabl peculiar dataset add comment three import topic definit constrain polariz discuss model section constrain polariz defin thank blike band keyword relat definit ucrpa_band accord valu ucrpa ucrpa_band defin band transit neglect ucrpa defin wannier function use weight scheme see eq section ii citeamadon altern ucrpa energi window defin variabl ucrpa_window exclud transit case _dd_ model neglect transit insid _d_ like band choos ucrpa_band converg polariz nband ecutep two main variabl converg note one must studi role variabl directli effect interact paramet determin relev valu frequenc mesh polariz use one want plot frequenc depend effect interact eg citeamadon optdriv keyword launch calcul screen gwcalctyp screen use later gwcalctyp next dataset getwfk obtain wfk file previou dataset ecutep cutoff energi planewav set repres dielectr matrix import converg effect interact function paramet frequenc dielectr matrix nfreqr number real frequenc freqremax ev maxim valu frequenc freqremin ev minim valu frequenc nfreqim number imaginari frequenc ucrpa screen ucrpa_band defin band correspond _d_ contribut parallel gwpara fourth dataset comput effect interact fourth dataset drive comput effect interact similar comput comput exchang _gw_ calcul reproduc input variabl peculiar dataset add comment converg properti converg number plane wave eq appendix citeamadon show summat plane wave perform cutoff plane wave use summat ecutsigx similar eq fock exchang see theorymbtevaluation_gw_sigmagw note one comput bare interact ecutsigx thu main converg paramet dataset note discuss appendix citeamadon high valu ecutsigx necessari oscil matrix element paw contain fourier transform product atom orbit frequenc mesh must dataset optdriv selfenergi calcul gwcalctyp activ hf ucrpa getwfk obtain wfk file dataset getscr obtain scr file previou dataset ecutsigx dimens g sum sigma_x frequenc effect interact nfreqsp freqspmax ev freqspmin ev nkptgw number kpoint calcul gw correct bz use mqgrid reduc fine least srvo mqgriddg reduc fine least srvo parallel gwpara chang nsppol crpa calcul log file _dd_ model go brows quickli log file calcul bare interact atom orbit first begin log file find calcul bare interact atom wavefunct correspond angular momentum specifi lpawu input file lpawu simpl fast direct integr note inform complet use xml paw atom data one avail jth tabl avail abinit websit calcul diagon bare coulomb interact atom orbit assum wavefunct first refer energi paw atom data atom eigenvalu max valu radiu atom data file max valu mesh atom data file paw radiu paw valu mesh integr integr atom wavefunct rpaw atom wfn truncat rmax norm wfn bare interact renorm ev bare interact renorm wfn ev atom wfn truncat rmax norm wfn bare interact renorm ev bare interact renorm wfn ev variou quantiti comput one interest see bare interact comput wavefunct truncat larg radiu au ie virtual infinit find bare interact ev compar valu bare interact comput wannier orbit bare coulomb direct interact wannier orbit third dataset code write coulomb interact matrix uummmm bare interact first see diagon interact larger offdiagon term logic electron interact larger electron locat orbit recov interact matrix degeneraci _d_ orbit cubic symmetri remind list dmatpawu order orbit abinit _xy_ _yz_ _zsupsup_ _xy_ _xsupsupysupsup_ note also interact _tsubgsub_ _esubgsub_ orbit effect compar eg appendix c citevaugi usual slater parametr interact matric diagon bare interact smaller bare interact atom orbit ev discuss show wannier function obtain within _dd_ model less local atom orbit logic wannier function contain inde weight _p_ orbit interact matrix one comput averag element famou _u_ well averag diagon element sometim use anoth definit _u_ see eq citeamadon two quantiti written log file hubbard bare interact ul sum ummmm hubbard bare interact ul sum ummmm import speed calcul one need averag valu _u_ _j_ one use nsym input file case interact matrix anymor reproduc correct symmetri sever correl atom implement test mandatori use nsym bare exchang interact exchang interact matrix also written well averag offdiagon element _j_ hund coupl jummmm bare interact bare interact valu jull sum_mm ummmmummmm crpa effect interact given frequenc first frequenc zero crpa interact uummmm crpa interact hubbard crpa interact w ul sum ummmm hubbard crpa interact w ul sum ummmm hund coupl jummmm crpa interact crpa interact valu jull sum_mm ummmmummmm end calcul valu _u_ _j_ function frequenc gather averag u j function frequenc omega uomega jomega converg studi give result converg studi made reader comput expens recommand use least processor input file provid tucrpa_abi first case cutoff energi polaris ecutep number plane wave use calcul crpa polariz determin ecutep see theorymbtrpa_fourier_spacenot rpa calcul converg studi simpli increas valu ecutep give center ecutep ha _u_ ev _j_ ev center nband ecutsigx xx kpoint grid effect interact converg precis ev ecutep number band nband rpa polariz depend also number kohnsham band also discuss theorymbtrpa_fourier_spacenot rpa calcul center nband _u_ ev _j_ ev center ecutep ecutsigx xx kpoint grid effect interact converg precis ev nband cutoff energi calcul coulomb interact ecutsigx ecutsigx input variabl determin number plane wave use calcul exchang part selfenergi variabl use determin number plane wave use calcul effect interact studi converg give center ecutsigx ha _u_subbaresub ev _j_subbaresub ev _u_ ev _j_ ev center ecutep nband kpoint grid effect interact converg precis ev ecutsigx ha kpoint depend effect interact kpoint grid also import check center kpoint grid _u_subbaresub ev _j_subbaresub ev _u_ ev _j_ ev center ecutep nband ecutsigx effect interact converg ev kpoint grid converg paramet thu ecutepsecutsigxngkpt nband expect precis ev use instead ecutepsecutsigxngkpt nband lower comput cost case find valu _u_ _j_ ev ev _u_ probabl underestim ev effect interact differ model section comput use converg valu paramet valu effect interact model discuss section tabl give model valu dmftbandi dmftbandf ucrpa_band must use sum valu bare effect interact center model _d d_ _tsubgsubtsubgsub_ _dpdp_ _d dp_ _d dp_ b ucrpa dmftbandidmftbandf ucrpa_band _u_subbaresub ev _u_subbar diagsub ev _j_subbaresub ev _u_ ev _u_subdiagsub ev _j_ ev center even calcul perfectli converg respect kpoint result obtain _dd_ _dpdp_ _ddp_ model agreement within ev result obtain tabl v citeamadon refer cite tabl obtain result _tsubgsub_ orbit one must use specif input file tucrpa_abi use specif keyword peculiar case compar tucrpa_abi peculiar case common definit j deduc direct calcul interact matric use slater kanamori express see eg citelechermann citevaugi use valu _j_ comput code briefli comment physic result bare interact number band use larger wannier orbit extens smaller thu interact obtain wannier function obtain _dp_ band larger interact obtain wannier function obtain _d_ band also larger interact obtain atom orbit wannier function _dpdp ddp_ _ddp_ b one see role screen crpa interact one supress transit insid _d_ like _p_ like band _dpdp_ model _u_ larg transit insid _d_ like band suppress _u_ smaller _ddp_ model comparison _dpdp_ model screen effici lastli one use weight scheme comput polariz _u_ small inde case one show residu transit near fermi level due hybrid _d_ orbit _p_ orbit effici screen interact similar effect discuss citeamadon uo citesakuma transit metal oxyd final fulli screen interact discuss could also comput definit correl orbit use default valu ucrpa_band frequenc depend interact section go comput frequenc depend effect interact chang follow input variabl order comput effect interact ev use nsym order decreas comput cost frequenc effect interact nsym nfreqsp freqspmax ev freqspmin ev nfreqsp freqspmax ev freqspmin ev exampl input file found tucrpa_abi note decreas paramet speedup calcul importantli howev increas number kohn sham band calcul screen high frequenc involv high energi transit requir high energi state well semicor state calcul time consum reduc number frequenc follow figur plot frequenc use frequenc suffici see main tendenc extract valu _u_ frequenc use grep uomega tucrpa_out ufreqdat remov first line plot data dynamicalucalc_crpa_assetsdynamicaljpeg recov pictur main result found fig citearyasetiawan inde frequenc depend effect interact exhibit plasmon excit conclus tutori show comput effect interact srvo emphas import definit correl orbit definit constrain polariz fix bug ifram reset minim fix bug forgot restor state normal minim fix bug dialog lose focu restor fix bug invalid dialog posit collaps enhanc ad tooltip titl button updat jqueri jqueryui fix bug order titlebar button fix bug restor collaps publish jqueri plugin fix bug wrong restor size fix bug wrong restor posit long andor wide page fix bug cant reopen dialog close minim fix bug broken style reopen dialog close collaps mani intern fix make plugin modular jqueryui plugin make plugin compat jqueri jqueryui hin make plugin compat jqueri jqueryui new add option hide close button control icon new add function getstat retriev current statu extend dialog fix bug disabl resiz dialog collaps fix bug make minim dialog ontop overlay fix bug use positionabsolut instead positionfix ie fix bug button disappear anymor fix bug avoid titl overlap button dialog minim fix bug except invok restor method normal state fix bug open dialog min max restor resiz dialog disappear restor min wo trigger event go max dialog disappear anymor fix bug open dialog max restor wrong posit alway upperlefthand corner restor posit restor dialog size dialog appear correct posit hin fix bug buttonpan minim state fix bug titlebar wordwrap minim state appli titlebarnonetranspar init option enhanc titlebar featur appli dblclickcollaps init option enhanc doubleclick featur hin fix bug fire loaddialogextend event appli event init option defin eventcallback hin fix bug zeroconfig hin creation plugin jquerydialogextend project statushttpstillmaintainedcomrombjquerydialogextendpnghttpstillmaintainedcomrombjquerydialogextend build statushttpstravisciorgrombjquerydialogextendpngbranchmasterhttpstravisciorgrombjquerydialogextend download develop buildhttpsrawgithubcomrombjquerydialogextendmasterbuildjquerydialogextendj minifi libraryhttpsrawgithubcomrombjquerydialogextendmasterbuildjquerydialogextendminj compat jqueri jqueryui overview neat simpl absolut unobtrus extend instead replac origin jqueri ui dialog maxim minim button showhid close button doubleclick titl bar enhanc titl bar option configur icon custom event demo test tool httprombgithubiojquerydialogextendexamplehtmlhttprombgithubiojquerydialogextendexamplehtml test browser chrome firefox ie pleas support project donat bitcoin gtxhanceduhmhttppfueddsnqhlq option closabl type boolean usag enabledis close button default true maximiz type boolean usag enabledis maxim button default fals minimiz type boolean usag enabledis minim button default fals collaps type boolean usag enabledis collaps button default fals minimizeloc type string usag set align minim dialogu default left valid left right dblclick type boolean string usag set action doubl click default fals valid fals maxim minim collaps titlebar type boolean string default fals valid fals none transpar icon type object default close uiiconcircleclosethick new v maxim uiiconextlink minim uiiconminu restor uiiconnewwin valid ltjqueri ui icon classgt event load type load exampl specifi callback init option mydialogdialogextend load functionevt dlg bind event type note must bind dialogextendload event dialogextend creat mydialog binddialogextendload functionevt dialogextend beforecollaps type beforecollaps exampl specifi callback init option mydialogdialogextend beforecollaps functionevt bind event type mydialogbinddialogextendbeforecollaps functionevt beforemaxim type beforemaxim exampl specifi callback init option mydialogdialogextend beforemaxim functionevt bind event type mydialogbinddialogextendbeforemaxim functionevt beforeminim type beforeminim exampl specifi callback init option mydialogdialogextend beforeminim functionevt bind event type mydialogbinddialogextendbeforeminim functionevt beforerestor type beforerestor exampl specifi callback init option mydialogdialogextend beforerestor functionevt bind event type mydialogbinddialogextendbeforerestor functionevt collaps type collaps exampl specifi callback init option mydialogdialogextend collaps functionevt bind event type mydialogbinddialogextendcollaps functionevt maxim type maxim exampl specifi callback init option mydialogdialogextend maxim functionevt bind event type mydialogbinddialogextendmaxim functionevt minim type minim exampl specifi callback init option mydialogdialogextend minim functionevt bind event type mydialogbinddialogextendminim functionevt restor type restor exampl specifi callback init option mydialogdialogextend restor functionevt bind event type mydialogbinddialogextendrestor functionevt method collaps usag collaps dialog without doubleclick titl bar trigger dialogextendbeforecollaps dialogextendcollaps exampl mydialogdialogextendcollaps maxim usag maxim dialog without click button trigger dialogextendbeforemaxim dialogextendmaxim exampl mydialogdialogextendmaxim minim usag minim dialog without click button trigger dialogextendbeforeminim dialogextendminim exampl mydialogdialogextendminim restor usag restor dialog maximizedminimizedcollaps state without click button trigger dialogextendbeforerestor dialogextendrestor exampl mydialogdialogextendrestor state usag get current state dialog return string valu normal maxim minim collaps exampl switch mydialogdialogextendst case maxim alertth dialog maxim break case minim alertth dialog minim break case collaps alertth dialog collaps break default alertth dialog normal theme dialog class accord current state div classuidialog div classuidialogtitlebardiv div classuidialogcont uidialognormalmaximizedminimizedcollapseddiv div button wrap titl bar jqueri ui dialog note use dialogextend close button direct child titl bar anymor wrap button pane element div classuidialogtitlebar uiwidgethead uicorneral uihelperclearfix div classuidialogtitlebarbuttonpan classuidialogtitlebarclos uicorneral hrefa classuidialogtitlebarmaxim uicorneral hrefspan classuiicon iconsmaximizemaximizespana classuidialogtitlebarminim uicorneral hrefspan classuiicon iconsminimizeminimizespana classuidialogtitlebarrestor uicorneral hrefspan classuiicon iconsrestorerestorespana div div exampl basic config function mybuttonclickfunct divthi contentdiv dialog titl dialog dialogextend maximiz true dblclick maxim icon maxim uiiconarrowdiag exampl full config function mybuttonclickfunct divthi contentdiv dialog titl dialog titl button ok function thisdialogclos dialogextend closabl true maximiz true minimiz true collaps true dblclick collaps titlebar transpar minimizeloc right icon close uiiconcircleclos maxim uiiconcircleplu minim uiiconcircleminu collaps uiicontriangl restor uiiconbullet load functionevt dlg alertevttyp beforecollaps functionevt dlg alertevttyp beforemaxim functionevt dlg alertevttyp beforeminim functionevt dlg alertevttyp beforerestor functionevt dlg alertevttyp collaps functionevt dlg alertevttyp maxim functionevt dlg alertevttyp minim functionevt dlg alertevttyp restor functionevt dlg alertevttyp author mg configur compil page collect faq relat im new configur explain use pleas consult httpswikiabinitorgdokuphpidbuildconfigur obtain full list avail option document use configur help exampl option specifi fortran compil vendor appear with_fc_vendor config file type withfcvendor command line find detail instruct set variou option configur script templat file abinitdocbuildconfigtemplateac includ config file includ automat time build abinit undocu option templat withconfigfil option let use arbitrari name config file long specifi time command line disableconfigfil option forc abinit use config file obviou reason option store config file configur complain abinit built well mani reason configur fail first make sure ld_library_path dyld_library_path maco path environ variabl properli set run configur token one load modul configur environ propertli set configur keep fail need search insid configlog compil stop intern compil error usual indic bug compil report compil vendor bypass problem reduc optim level eg default even dont like idea compil sourc file suboptim option may tri disabl optim problemat sourc file use quick dirti recip run make till trigger intern compil error copi compil command trigger intern error add compil option execut command line compil modul run abinit due undefin refer error mean abinit execut dynam link extern librari os find librari runtim pleas make sure ld_library_path dyld_library_path maco properli set valu one use configuringcompil abinit error messag may show forgot load modul tri run execut suppos load modul use configuringcompil abinit precompil packag abinit ye pleas consult differ subsect avail installationinstal page find exampl configur file hpc cluster abiconfig packag provid configur file use configur compil abinit hpc cluster configur file contain header metadata json format follow configur option support abinit build system exampl abinit v avail herehttpsgithubcomabinitabiconfigtreemasterabiconfigclust easybuild recip abinit ye howto tutori also avail hereinstall_easybuild spack recip abinit ye present abinit support conda packag abinit ye conda instal abinit channel condaforg note howev reccomend use precompil version hpc cluster version provid spackeasybuild pa provid fallback abinit fallback packag builder extern depend abinit environ lack compon note inde extern librari compil mpi wrappercompil use build abinit unfortun hpc center provid complet set modul cover extern depend requir abinit worst case scenario modul avail work properli provid full support advanc featur abinit hpcgrade calcul capabl design let develop quickli test new version extern depend variou situat propos upgrad well allow endus run calcul favorit pc case depend miss comput abinit provid fallback librari build instal sourc compil abinit import feel free contact sysadmin cluster ask himher instal librari compil abinit openmp support compil abinit openmp support difficult understand openmp activ two differ level abinit fortran routin extern librari blaslapack fft activ openmp add ac file enable_openmpy fcflags_openmpfopenmp gfortran compil fcflags_openmpqopenmp intel fortran compil final rememb set environ variabl export omp_num_thread import mix mkl fftw especi activ openmp author mg mjv dfpt faq page collect faq relat dfpt part abinit use paral_kgb dfpt part dfpt code use complet differ parallel algorithm workload memori automat distribut runtim depend number mpi process perburb comput parallel k point band whatev size system one use sever dozen processor effici principl also possibl parallel perturb see paral_rf nppert keep mind approach optim point view worload distribut perturb list irreduc kpoint see discuss moreov one perturb converg with nstep iter abinit abort may end zero ddb file produc final also possibl run differ point concurr differ abinit run merg ddb file workflow abipi launch mani concurr job get irreduc qpoint phonon calcul phonon calcul irreduc perturb need calcul abinit anaddb complet symmetri particular dynam matrix complet symmetr qpoint get irreduc qpoint system small auxiliari calcul low ecut minim nband make new directori copi input file ground state set kpoint grid ngkpt equal qpoint grid want phonon set kptopt also dont forget set shiftk order get nonshift grid gamma point header log output file kpt point copi directli phonon input file qpoint one also use one one chang output format abistructpi abikmesh sicif ngkpt shiftk warn dynam matrix incomplet get follow warn phonon calcul dynam matrix incomplet phonon frequenc may wrong anyon know wrong fix warn given abinit problem calcul certain perturb given qpoint abinit tri immedi complet diagon dynam matrix gener possibl done full set irreduc perturb henc warn frequenc output mani may zero certain dynam matric calcul yet need continu calcul use mrgddb merg ddb file anaddb reconstruct dynam matrix follow whole rf tutori see phonon frequenc come anaddb run perturb faster comput other perturb break initi symmetri crystal thu subset crystallin symmetri use defin irreduc set wavevector use dfpt equat instanc phonon calcul gamma much faster calcul done nonzero qqpoint sinc symmetri exploit note howev even perturb qqpoint may differ workload best perform perturb principl comput differ run differ number mpi proc perturb converg fir tri restart firstord wfk file use irdwf getwf principl also possibl restart firstord densiti via getden use approach firstord wfk file avail may want use prtwf dfpt part produc firstord wfk file dfpt scf cycl converg order reduc amount data written disk may also tri increas nline good idea comput perturb parallel singl input file care perfom answer definit alreadi mention perturb differ workload much better comput differ perturb separ input file use mpi process heaviest perturb easi way comput phonon band structur ddb file abiviewpi ddb ddb_file reduc break asr easi way visual break asr abiviewpi ddb_asr ddb_file convert ddb phonopi format ye need use abipi convert two format author mg gener question page give beginn introduct abinit resourc packag main abinit applic print abinit version abinit version see abinit help addit command line option option check valid input without run full calcul abinit dryrun runabi abinit run get unphys result mani mistak done beginn relat incorrect start geometri check list check unit correct cell paramet atom posit rememb abinit use atom unit default use sever unit specifi user see abinit input paramet check typat atom type correct respect xred xcart check number atom natom coher list coordin xred xcart abinit read coordin natom nuclei ignor other tri visual primit cell numer possibl use abipi vesta xcrysden document abinit read vasp poscar netcdf extern file contain unit cell paramet atom posit see input variabl structur might help set geometri correctli relax first atom posit fix primit vector optim cell explicitli use first datadet optcel second dataset nonzero optcel tell abinit read optim atom posit use getxr getxcart second dataset forget use dilatmx bigger expect volum cell increas optim possibl atom posit relax make run chkdilatmx third run dilatmx see addit suggest document optcel abinit stop without finish task make sure get read error messag usual written end log file look like yaml error src_file m_kgf src_line mpi_rank messag follow error messag see error messag end log file error messag might found altern error file depend command use launch abinit also run batch behaviour might differ error messag might end anoth file log file run parallel error messag might written still anoth separ file entitl __abi_mpiabortfile__ abinit stop quickli consid run sequenti interact parallel neither batch eas understand happen sometim error messag prepar anoth messag give preliminari inform pleas sure identifi relev inform log file think obtain inform abinit suppos give tri identifi whether abinit stop geometri optim problem scf problem first case input geometri perhap crazi anyhow see next item troubleshoot page memori estim provid abinit begin run reliabl well depend valu report code case groundstat dfpt calcul repres reason estim like smaller real valu workspac array taken account unfortun easi estim memori requir gw bse eph calcul reli valu print code begin better idea memori footprint suggest use log file grep mem runlog paral_kgb algorithm support everywher paral_kgb refer particular mpidistribut wavefunct avail gs calcul total energi calcul relax molecular dynam well nscf band structur calcul variabl npkpt npband npfft npspinor relev paral_kgb abinit driver eg dfpt gw bse eph use complet differ approach parallel calcul distribut memori enforc time limit find old pseudo legaci pseudopotenti file avail herehttpswwwabinitorgsitesdefaultfilesprevatomicdatapsplinkspseudopotentialshtml mix ncpseudo paw two implement mutual exclus use upf pseudo abinit pseudo upf format support note matter format inde fundament differ formal implement abinit one use qe especi paw ncpseudo soc pseudodojo project provid ncpseudo run calcul xc function differ one use gener pseudo ye use ixc chang xc function input file tool print pseudo humanread format use abipi abiopenpi pseudo_fil p chkprim unit cell multipl highli symmetr crystal may end follow error messag chkprimit error accord symmetri finder unit cell primit multipl use nonprimit unit cell allow input variabl chkprim action either chang unit cell rprim angdeg set chkprim leave_new decis taken exit default abinit check unit cell primit ie contain smallest possibl number atom exampl instead convent cubic fcc unit cell atom rprim natom xred use follow unit cell vector rprim natom xred get primit unit cell axe separ angl degre anoth possibl angdeg natom xred use primit cell ensur fastest calcul best use symmetri oper gener listen abinit reduc unit cell good reason use primit cell overrid abinit forc use nonprimit unit cell set chkprim input file one possibl reason exampl make larg supercel crystal say xx primit unit cell want introduc defect pristin crystal calcul xx supercel possibl use get time energi moreov pure translat symmetri incorpor symmetri recognit algorithm might end number symmetri oper exce abinit intern maximum introduc defect cours lower supercel symmetri abinit longer complain cell primit chkprim longer use defect cell pspxc pseudopotenti equal ixc abinit complain exchang correl function variabl ixc use input specifi pseudopotenti atom data file use pspatm warn pseudopotenti file pspxc equal input ixc paramet must agre get xc abinit code psp construct action check psp design input file assum experienc user execut continu usual danger make uncontrol error compens vxc core pseudopotenti differ function howev import except lda function ixc basic ident differ function form fit data result mix ixc mostli harmless warn appear often mani pseudopotenti web site creat varieti ixc necessarili default valu abinit find spacegroup would expect firt make sure atom posit given enough digit let say six digit prefer xred xcart rememb one use fraction input file use syntax natom xred note whitespac token allow ie accept parser also lattic specifi term angdeg acel rather rprim may help solv possibl problem hexagon rhombohedr lattic seem sensit truncat error solv problem may tri gradual increas valu tolsym abistruct script provid simpli command line interfac allow invok abinit comput space group abistructpi abispg file tolsym also possibl use spglib librari command abistructpi spglib file although spglib take account symafm magnet symmetri author mg groundstat faq page collect faq relat gs part abinit dimens defin workload standard gs run gs run find set ks orbit psi_nk solv selfconsist problem beginalign h_ksn psi_nk epsilon_nk psi_nk nrr sum_nk f_nk psi_nksrr endalign number band n given nband number kpoint ibz nkpt number spin compon sigma given nsppol note assum scalar wavefunct either spin spin twocompon spinor requir nspinor period part bloch state expand planewav basi set accord u_nksrr sum_ggtextnpw_kk u_nksgg eiggrr given kk point textnpw_kk ggvector kinet energi kg textecut_texteff includ fourier seri textecut_texteff ecut dilatmx maximum number ggvector kpoint call mpw timerevers symmetri automat exploit halv number planewav particular kpoint see istwfk input variabl gs code store memori fourier compon u_nksgg fast fourier transform use go u_nksgg u_nksrr fft mesh defin first three entri ngfft array automat comput ecut boxcutmin also addit array depend natom especi paw use variabl report begin main output file keep mind strong interplay dimens mpi parallel parallel kpoint collinear spin rather effici wherea parallel band ggvector network intens warn conjug gradient solver default algorithm gs calcul use nkpt nsppol mpi process take advantag band gg parallelim use paral_kgb input file possibl autopar good idea set number band highest occupi state acceler gs calcul usual answer explan requir technic discuss ks solver principl workload well memori footprint proport nband first sight reduc number ks state seem smart choic hand larger number band allow eigenvalu solver oper larger hilbert subspac make huge differ level number iter requir converg especi true algorithm rmmdii method rmm_dii word band mean walltim per scf iter hand scf cycl expect reach converg less iter import case metal one need partial occupi state account tail occup function occopt broaden paramet tsmear decreas number band therefor bad idea abinit stop enough partial occupi state converg criterion recommend scf cycl well answer depend physic properti interest use toldf stop scf cycl excel choic interest total energi converg criteria much better interest physic properti tolvr excel choic comput den file need nscf band structur calcul sinc want make sure ks potenti well converg use nscf run structur relax md run one use toldff tolrff obtain accur forc atom move right direct relax step note howev highsymmetri system forc may zero symmetri avoid problem use tolvr tolwfr stringent converg criterion sinc take account converg nband nbdbuf state includ empti state recommend approach comput gs wavefunct use dfpt code manybodi part keep mind howev last state usual requir mani iter converg lowenergi state strongli recommend use tolwfr conjunct nbdbuf case nscf run tolwfr avail converg criterion scf cycl converg default scf algorithm scf see iscf excel compromis speed robust refer pulay ii fig n wood c payn p j hasnip j phi conden matter appear pareto frontier paramet kerker precondit also effect balanc speed robust default valu good metal system thoroughli discuss refer foolproof fast algorithm scf cycl converg see nre vre column output file reason insuffici underli accuraci solut schrdinger fix potenti transient nonlinear behaviour scf due either sudden chang occup number usual metal b longwavelength fluctuat potenti bigger gap start first address tune come without significantli slow abinit test differ valu diemac default larg suitabl fo metal tri run small valu perhap system bulk semiconductor molecul dope solid intermedi valu perhap might appropri work tri address set tolrd increas valu nline eg instead default well nnsclo eg instead default residm significantli lower without modif perhap problem solv still work residm look bad address revert back default valu tolrd nline nnsclo inde slow abinit tri use iscf slow uncondit converg algorithm provid diemix small enough stage converg might restart obtain den better algorithm nonlinear effect elimin stage author mg preprocess postprocess faq page collect faq relat preprocess postprocess tool well trick product prepar abinit input file use xyx file specifi unit cell ye see xyzfil use cif file specifi unit cell abinit accept cif file input possibl convert cif format abinit understand perhap easiest solut use abipi abistruct script abistructpi convert cif_fil also possibl gener cif file end gs calcul prtcif variabl although much easier use abipi perform task command line interfac abistructpi convert file f cif file file structur info gsrnc ddb file abinit input file etc import cif format lattic usual specifi term three angl form direct lattic vector alpha beta gamma length note six paramet enough specifi nine entri lattic matrix rprimd expect abinit sinc rigid rotat lattic give angl length report cif file cif parser implement pymatgen fix arbitrari use convent lead unexpect behaviour one tri convert abinit structur cif format reus cif file reconstruct structur sinc gurante get orient lattic vector tensor compon express reduc coordin obvious depend valu rprimd use calcul obvious one alway transform one lattic one order safe side suggest use cif file specifi initi lattic reli abinit usual variabl use poscar file abinit ye pleas consult document structur variabl note also possibl convert poscar abinit format abistructpi convert poscar convert structur primit use abipi abistructpi primit file wyckoff posit site symmetri use abipi abistructpi wyckoff file compar structur materi project databas use abipi abistructpi mp_match file visual structur abitk one read denwfk file produc xsf file abistructpi visual file vesta abistructpi visual help appnam appnam appnam applic name possibl option avogadro ovito v_sim vesta xcrysden mpl matplotlib mayavi vtk includ extern file input sure abinit support includ statement use includ extern file input file add line syntax includ name_of_file_to_be_included_in_the_input_fil must obvious chang argument name_of_fil keep quotat mark note includ standard variabl thu list variabl page easi way print warningscom log file warn comment error written yaml format abiopenpi log_fil print p easi way obtain highsymmetri kpath use abipi abistructpi kpath file easi way plot electron band structur import result gs run includ ks energi store gsrnc output file plot band structur matplotlib use abiopen script syntax abiopenpi gsr_file expos e option avail see abiopenpi help gener xmgrace file electron band use abiview command abiviewpi eband out_gsrnc xmgrace visual evolut cell structur relax run lattic parament atom posit forc relax step store histnc output file print abiopenpi hist_fil p visual result matplotlib use abiopenpi hist_fil e visual result matplotlib use abiviewpi hist out_histnc ovito visual relaxationmolecular dynam result ovito abiviewpi hist out_histnc xdatcar convert histnc xdatcar format caveat assum fix unit author mg ms bethesalpet equat abinit note provid brief introduct bethesalpet bs formal outlin import equat involv theori approach use comput bs kernel macroscop dielectr implement base planewav normconserv pseudopotenti also discuss convent use equat explain theorymbtmanybodi theori note much consist discuss theoret aspect bethesalpet equat found citeonida refer therein optic properti local field effect discuss bethesalpet problem worth remind basic result concern ab initio descript optic properti frequenc reciproc space microscop dielectr function relat irreduc polariz follow relat beginequ ee_gg_gg_qqww delta_gg_gg_ vqq gg_ tchi_gg_gg_qqww endequ invers dielectr function obtain via matrix invers macroscop dielectr function ee_mtextlfww directli relat invers singl element first gg_ gg_ element invers microscop dielectr matrix mean beginequationlabeleqabs_lf ee_mtextlfww lim_qq rightarrow dfracee_ qqww endequ microscop dielectr matrix one usual calcul within rpa gw calcul optic absorpt spectrum simpli given imaginari part ee_mtextlfww sometim especi compar experiment spectra real part simpli call ee_ imaginari part ee_ note equat differ beginequ labeleqabs_nlf ee_mtextnlfww lim_qq rightarrow ee_ qqww endequ due call localfield effect introduc presenc crystallin environ former quantiti local field lf accur latter one without local field nlf import reason two equat differ first express denomin first element invers whole microscop dielectr matrix element depend entir matrix simpli calcul take invers first element noninvert matrix theorymbtrpa_fourier_spacegw_not discuss calcul irreduc polariz thu absorpt spectrum within random phase approxim rpa turn howev rpa dielectr function evalu kohnsham orbit eigenvalu yield absorpt spectra quantit sometim even qualit disagr experi surpris sinc polariz kohnsham system expect reproduc respons fulli interact system import discrep experi found even dft gap correct replac ks eigenvalu quasiparticl energi calcul gw approxim indic far optic properti concern import physic correctli captur gw approxim fundament reason failur rpa trace back neglect electronhol interact manybodi languag includ vertex function replac vertex function local instantan function crude unrealist approxim manybodi polariz next section discuss obtain improv approxim vertex therefor improv approxim polariz take account mani bodi effect due electronhol interact bethesalpet equat nutshel schemat pictur differ level descript optic spectra avail abinit given bse_assetsschematic_dft_gw_bsesvg bethesalpet theori formul term twoparticl propag fourpoint function describ motion system two particl label l l subscript zero indic particl noninteract restrict start end point particl twopoint contract l give reduc independentparticl polariz accord chi l twopoint contract l give reduc manybodi polariz hatchi l confus irreduc polariz manybodi system denot tild formula theorymbtrpa_fourier_spacegw_not util work term reduc quantiti macroscop dielectr function local field effect obtain directli reduc polariz use beginequ ee_mtextlfww lim_qq rightarrow vqqtchi_qqww endequ comput reduc l directli possibl thu allow one avoid costli matrix invers dielectr function otherwis perform frequenc one show l satisfi dysonlik equat beginequ l l l k l longrightarrow l bigl l k l endequ involv bethesalpet kernel k beginequationlabeleqbse_kernel_lf k underbracedeltadeltabar v_exchang underbracedeltadeltaw_coulomb endequ bar symbol signifi coulomb interact taken without longrang fourier compon gg beginequ begincas bar vqq vqq quad textif qq neq bar vqq endcas endequ discuss citeonida local field effect lf includ formal exchang term coulomb term describ screen electronhol interact respons creation exciton interact principl alreadi contain w rewrit kernel way mostli algebra trick allow one easili separ contribut calcul optic spectrum without lf dysonlik equat l becom matrix problem particular basi set chosen expand fourpoint function involv problem standard approach polaris bs kernel express socal transit space ie product singleparticl orbit use beginequ f sum_ substackn_ n_ n_ n_ psi_n_ psi_n_ f_ n_ n_ n_ n_ psi_n_ psi_n_ endequ beginequ f_ n_ n_ n_ n_ int f psi_n_ psi_n_ psi_n_ psi_n_ dd endequ n_i shorthand notat denot band kpoint spin index expans exact provid set singleparticl orbit complet basi set hilbert space main advantag use transit space solv problem rpa polariz diagon represent beginequ chi_ n_ n_ n_ n_ ww dfrac f_n_ f_n_ ee_n_ ee_n_ ww delta_n_ n_ delta_n_ n_ endequ thu lead consider simplif mathemat formal algebra see citeonida complet deriv one find system energi gap dysonlik equat l express term effect twoparticl hamiltonian h accord beginequ l bigl hww bigrf endequ explicit form h f transit space given beginequ h left beginarrayccc vckkrangl cvkkrangl hline langl vckk r c hline langl cvkk c r endarray right endequ beginequ f left beginarrayccc vckkrangl cvkkrangl hline langl vckk hline langl cvkk endarray right endequ valenc state indic indic v v c c use conduct band r submatrix hermitian usual refer reson block c socal coupl block complex symmetr submatrix note due presenc coupl term bs hamiltonian nonhermitian although oper possess real spectrum inclus spin formal would requir extens discuss simplic limit analysi case spin unpolar semiconductor nsppol particular case matrix element reson block given beginequ r_vckkvckk ee_ckk ee_vkkdelta_vvdelta_ccdelta_kkkk bar v_vckkvckk w_vckkvckk endequ singl particl transit energi diagon matrix element v w defin beginequ bar v_n_ n_ n_ n_ delta_sigma_ sigma_ delta_sigma_ sigma_ iint psi_n_rr psi_n_rr bar vrrrr psi_n_rr psi_n_rr dd rr dd rr endequ beginequ w_n_ n_ n_ n_ delta_sigma_ sigma_ delta_sigma_ sigma_ iint psi_n_rr psi_n_rr wrrrrww psi_n_rr psi_n_rr dd rr dd rr endequ note particular static limit omega w involv last express coupl matrix element usual smaller reson one especi true bulk system due differ spatial behavior conduct valenc state solid state calcul therefor common practic ignor c block socal tammdancoff approxim assumpt exciton hamiltonian given hermitian oper bse_assetstdasvg variabl bs_coupl defin whether coupl block includ calcul macroscop dielectr function obtain contract manybodi l take optic limit gg gg compon along particular direct qqspace final result read beginequ ee_mww lim_qq rightarrow vqqlangl pqqbigl h ww bigrf pqqrangl endequ beginequ pqq_n_ n_ langl n_eiqqcdotrrn_ rangl undersetqq rightarrow approx delta_n_ n_ qq cdot langl n_rrn_ rangl oq endequ matrix element dipol oper transit space default code calcul macroscop dielectr function take limit along six differ direct q space three basi vector reciproc lattic three cartesian axi possibl chang default direct use variabl gw_nqlwl gw_qlwl solv bethesalpet problem point clear evalu macroscop dielectr function within bs formal twostep process construct h matrix transit space comput macroscop dielectr function use two equat report end previou section flowchart typic bethesalpet run schemat depict diagram bse_assetsbse_flowchartsvg wfk file repres ellipsi path left indic blue arrow repres rpa calcul optdriv produc scr file see also tutorialgwgw tutori wfk scr file avail final construct hamiltonian solv bethesalpet problem rectangl bottom flowchart bs comput common practic simul selfenergi correct employ scissor oper whose valu obtain either experi abinitio calcul scissor oper allow one avoid costli gw calcul perform kkpoint band includ transit space option path right indic yellow arrow correspond optdriv construct hamiltonian matrix repres signific portion overal cpu time due larg number transit need accur descript frequencydepend polariz hand also calcul macroscop dielectr function pose numer difficulti sinc expens matrix invers perform frequenc code implement differ method propos literatur avoid matrix invers frequenc variabl bs_algorithm use select among differ possibl bs_algorithm employ standard scalapack routin obtain spectral represent h term eigenvalu right eigenvector h beginequ begincas h lambdarangl ee_lambda lambdarangl o_lambdalambda langlelambdalambdarangl h sum_lambda lambda ee_lambda lambdarangl o_lambda lambda langlelambda endcas endequ discuss citealbrecht invers h ww obtain accord beginequ bigl h ww bigr sum_lambda lambda lambdarangl dfraco_lambda lambdaee_lambda ww langlelambda endequ elabor point sinc direct diagon advantag particular circumst explain document bs_algorithm avoid diagon use iter algorithm construct basi set h repres real symmetr tridiagon matrix citehaydock without enter detail one schemat repres haydock techniqu algorithm procedur transform dens hermitian matrix spars tridiagon one beginequ r r beginpmatrix endpmatrix longrightarrow beginpmatrix a_ b_ b_ a_ b_ b_ endpmatrix endequ coeffici tridiagon form know macroscop dielectr function evalu term continu fraction beginequ eeww propto cfrac ww a_ cfracb_ww a_ cfracb_cdot endequ small complex shift defin zcut use avoid singular along real axi number iter requir converg almost independ size problem usual order iter algorithm involv simpl matrixvector multipl effici perform bla call importantli easi parallel anoth distinct advantag haydock method less memori demand direct diagon sinc three temporari vector requir instead full set eigenvector note origin formul method present citehaydock assum hermitian oper thu use tda calcul refer reader citegrun gener method case coupl term neglect main drawback method give direct access exciton spectrum henc use calcul bind energi plot exciton wavefunct moreov time bs_algorithm use calcul coupl term includ bs_algorithm employ standard conjugategradi method calcul lowest eigenst hamiltonian present method still test support calcul coupl term kernel matrix element reciproc space implement employ planewav expand period part bloch state u twopoint function wrrrr becom qqdepend matrix reciprocalspac convent use transform document sectionmbtmdnot gw note matrix element exchang term evalu reciproc space use beginequ bar v_vckk vckk dfracv sum_gg neq bar vgg langl ckk eiggcdotrr vkk rangl langl vkkeiggcdotrrckk rangl endequ coulomb term calcul accord beginequ w_vckk vckk dfracv sum_gg_gg_ w_gg_gg_kkkkww langl vkkeiqq gg_cdot rrvkk rangl langl c kk eiqqgg_cdotrr ckk rangl endequ number ggvector w modifi coulomb interact specifi ecutep wavefuct enter oscil matrix element expand ggsphere energi ecutwfn comput oscil matrix element discuss theorymbtoscillator_notesthi section gw note input variabl bs_exchange_term use disabl comput exchang term option mainli use perform optic calcul without local field effect variabl bs_coulomb_term govern comput coulomb term cpudemand part due presenc doubl sum gg vector also import stress two equat kpoint index run full brillouin zone henc size hamiltonian defin number point full brillouin zone number point irreduc wedg matrix element dipol oper accur calcul optic properti requir correct treatment optic limit gg qq rightarrow oscil matrix element comput term deserv clarif due presenc fulli nonloc pseudopotenti term kohnsham hamiltonian linear expans first order q oscil matrix element result beginequ langl b_kmqeiqqcdotrrb_kk rangl undersetqq rightarrow approx iqqcdot langl b_kkrrb_kk rangl mcoq endequ assum b_ neq b_ differ two wave function kk qq kk neglect introduc term quadrat qq unfortun express directli use matrix element posit oper illdefin wavefunct obey bornvon karman period boundari condit reason first order contribut evalu use equival express citebaroni beginequ langl b_kmqeiqqcdotrrb_kkrangl undersetqq rightarrow approx dfrac langl b_kkiqqcdotnabla iqqcdot biglv_textnlrrbigrb_kk rangl varepsilon_b_kk varepsilon_b_kk endequ term involv momentum oper effici evalu reciproc space linear scale npwwfn treatment nonloc part pseudopotenti involv much cpudemand role play addit term usual margin case gw calcul qp correct obtain perform integr qqspace qq rightarrow compon invers dielectr matrix affect commut nonloc part pseudopotenti reason common practic especi gw converg test neglect contribut set inclvkb strictli speak howev approxim justifi case calcul bulk crystal provid bz sampl well converg particular care taken perform gw calcul nonperiod system due reduc dimension bz import commut nonloc part alway includ studi optic properti rpa bs level author g zerah non colinear magnet notat theoret consider denot spinor psialphabeta alpha beta two spin index magnet properti well repres introduc spin densiti matrix rhoalphabetarr sum_n f_n la rrpsi_nalphara lapsi_nbetarrra sum run state f_n occup state n rhoalphabetarr express scalar densiti rhorrsum_alpha rhoalphaalpharr magnet densiti vec mrr unit hbar whose compon m_irr sum_alphabeta rhoalphabetarr sigma_ialphabeta sigma_i pauli matric gener e_xc function rhoalphabetarr equival vec mrr rhorr therefor denot e_xcnrr vec mrr express v_xc take account express e_xc v_xcalphabetarrdelta e_xc delta rho rr delta_alphabeta sum_i delta e_xc delta m_i rr sigma_ialphabeta lda approxim due rotat invari e_xc inde function nrr mrr gga approxim contrari assum function nrr mrr gradient gener function vec mrr depend upon first order deriv rotat invari therefor use exactli function spin polar situat use local direct vec mrr polar direct delta e_xc delta m_i rr delta e_xc delta m_i rr widehat mrr widehat mrr mrr mrr ldagga formul n_uparrow n_downarrow n n_uparrown_downarrowm therefor set n_uparrow nm n_downarrownn_uparrow delta e_xc delta rho rr bigl delta e_xc delta n_uparrowrr delta e_xc delta n_downarrowrr bigr delta e_xc delta rr bigl delta e_xc delta n_uparrowrr delta e_xc delta n_downarrowrr bigr make connect usual spin polar case express v_xc ldagga v_xcrr delta e_xc delta rho rr delta_alphabeta delta e_xc delta rr widehat mrrsigma implement comput rhoalphabetarr sum_n f_n la rrpsialphara lapsibetarrra one would like use routin mkrho precis routin transform real quantiti wherea rhoalphabetarr hermitian complex element trick use real quantiti begineqnarray rhorr sum_n f_n la rrpsira lapsira rhorrsum_n f_n la rrpsira lapsira rhorrm_xrrsum_n f_n psipsi_n psipsi_n rhorrm_yrrsum_n f_n psii psi_n psii psi_n endeqnarray comput rhorr vec mrr help begineqnarray rhorrrhorrrhorr m_zrrrhorr rhorr endeqnarray inform noncollinear magnet see citehobb citeperdew xc function descript suggest acknowledg refer acknowledg file provid descript suggest acknowledg refer insert scientif paper whose result obtain thank abinit discuss also briefli problem coauthorship introduct next section find sever refer suggest cite paper benefit abinit howev wish first clarifi spirit present document written user code formal oblig respect abinit group within limit gnu gener public licens howev common practic scientif literatur acknowledg effort peopl made research possibl pleas note follow abinit project order viabl known robust tool test allow good scientif research facilit abinit project mention properli research paper recent idea algorithm code would fair cite might also regist abinit discours forumhttpsdiscourseabinitorg indirectli also help abinit develop group total number regist peopl forum often cite indic user commun size agreement gnu gener public licens request coauthorship articl whose scientif result obtain thank abinit abinit develop appli even recent implement featur avail public version govern gnu gpl licens think work could benefit collabor abinit develop contact abinit group possibl arrang case coauthorship discuss cours abinit develop also right declin give assist user list suggest abinit articl geng describ impact environ recent develop first list suggest cite paper benefit abinit project irrespect content abinit articl geng overview abinit project focu specif develop also strongli suggest citat particular see overview abinit capabl tabl ii four abinit articl geng geng geng geng might well consid irrespect ther content public quit gener well although older also mani articl focus describ specif capabl abinit follow list actual complet refer propos abinit see end output file see varsetallvarsdatabas inform input variabl topicindextop file well refer five gener paper idga gen least recent articl citegonz describ abinit project impact environ recent develop mention bibliographi section paper version paper format comput phi comm avail herehttpswwwabinitorgsitesdefaultfilesabinitpdf licenc allow author put web idga gen abinit articl citeromero describ abinit project overview specif develop also strong suggest citat bibliographi section paper version paper format j chem phi avail herehttpswwwabinitorgsitesdefaultfilesabinit_jpcpdf licenc allow author put web idga gen version abinit articl citegonz format comput phi comm avail herehttpswwwabinitorgsitesdefaultfilesabinitpdf licenc allow author put web idga gen abinit articl citegonz especi detail version paper format comput phi comm avail herehttpswwwabinitorgsitesdefaultfilesaboutabinit_cpc_vpdf licenc allow author put web idga gen abinit articl citegonz quit short pdf latter paper avail herehttpswwwabinitorgsitesdefaultfileszfk__pdf note redistribut copyright oldenburg wissenshaftverlag licenc allow author put web idga gen first paper abinit project citegonz might also consid citat idsa spe projectoraug wave method implement abinit use citetorr mention idsa spe mani ingredi need calcul respons atom displac homogen electr field dynam matric effect charg dielectr constant well fourier interpol implement anaddb code describ citegonz citegonzea idsa spe method use calcul respons homogen strain elast tensor piezoelectr tensor intern forcerespons tensor describ citehamann idsa spe static nonlinear capabl abinit use raman effici electroopt coeffici cite citeveithen idsa spe integr phonon degre freedom use anaddbthmflag cite citele idsa spe selfconsist capabl abinit beyond dft use gw cohsex hf etc cite citebrunev idsa spe complet relationship use speed converg respect number band gw calcul input variabl gwcomp gwencomp cite citebrunev idsa spe massiv parallel abinit coupl bandfft even coupl bandfftkpoint use cite citebottin avail arxivorghttpsarxivorgab idsa spe dftu method implement abinit use cite citeamadon idsa spe oncvpsp pseudopotenti use cite citehamann idsa spe van der waal dftd grimm function use cite citevantroey idsa spe temperatur depend electron structur zeropoint motion effect electron structur comput cite citeponc citeponc idsa spe direct dfpt comput effect mass use see topiceffectivemass cite citelaflamm idsa spe flexoelectr dynam quadrupol comput cite citeroyo idsa spe new procedur electronphonon calcul optdriv use cite citebrunin andor citebruninb author x gonz suzukawa mikami mg newcommandmcrmathcalr newcommandomcrhatmcr newcommandatmbf newcommandafmomcrunderlineomcr newcommandafmmcrunderlinemcr newcommandhhhat h newcommandnknkk newcommandrrmmcr newcommandritmcrt newcommandrmtrrtt newcommandaaalpha newcommandbbbeta newcommandsssigma newcommandmcjmathcalj newcommandomcahatmca newcommandthalftfrac newcommandmcemathcal newcommandmcamathcala represent convens one wavefunct abinit data structur theoret justif notat theoret consider bloch wavefunct character wavevector kk psi_bf kbf r eibf kcdotbf r u_bf kbf r u_bf kbf r period u_bf kbf rbf ru_bf kbf r bf r vector real space lattic represent plane wave read begineqnarray u_bf kbf rsum_bf gu_bf kbf geibf gcdotbf r psi_bf kbf rsum_bf gu_bf kbf g ei bf kbf gcdotbf r endeqnarray normal u_k read sum_bf gu_bf kbf g spinor wavefunct addit variabl spin sigma take two valu sigmauparrow spin sigmadownarrow spin follow relat hold u_bf kbf rsigma sum_bf gu_bf kbf gsigma eibf g cdot bf r psi_bf kbf rsigma sum_bf gu_bf kbf gsigma eibf kbf gcdotbf r sum_sigmasum_bf gu_bf kbf gsigma properti wavefunct scalar case groundstat wavefunct solv schrdinger equat h psi_nbf kra varepsilon_nbf kpsi_nbf kra h hamiltonian oper n label state band varepsilon_nbf k eigenvalu wavevector label eigenst come properti psi_bf kbf rbf r eibf kbf r psi_bf kbf r kk replac kk gg gg reciproc space lattic vector choos wavefunct kk kk gg equal make linear combin wavefunct energi choic gaug affect valu physic observ follow prefer work gaug psi_kk ggrr psi_kkrr keep notat simpl possibl timerevers symmetri nonmagnet case hamiltonian give follow relat psi_nbf kbf r psi_nbf kbf r bf k wavevector half reciproc lattic vector bf kbf g_ special relationship fourier coeffici wavefunct u_nbf kbf g u_nbf kbf g_bf gbf g_ u_nbf kbf gbf g_ u_nbf kbf gbf g_ coeffici gg bf gbf g_ relat allow decreas factor storag space specif bf k point acceler cpuintens part applic nonloc part fourier transform properti wavefunct spinor case one must distinguish two class hamiltonian hamiltonian spindiagon hamiltonian mix spin compon first class one find usual nonspinpolar nonspinorbit hamiltonian case spin upspin spin downspin part hamiltonian equal well spinpolar hamiltonian magnet field vari strength direct second class one find hamiltonian includ spinorbit split well noncollinear spin system first class wavefunct made entir either spinup compon spindown compon treat independ made opposit spin correspond nsppol second class one must stay spinor wavefunct correspond nspinor two class mutual exclus possibl thu nsppol nspinor wavefunct type scalar wavefunct spinpolar wavefunct spinor wavefunct inclus spinorbit coupl hamiltonian requir nspinor plane wave basi set sphere order avoid deal infinit number plane wave repres bloch wavefunct one select kinet energi lower cutoff energi e_rm cut set allow bf g vector denot mcs_kke_rm cut ggin mcs_kke_rm cut mboxif dfraclvertbf k grvert leq e_rm cut kinet energi cutoff comput input variabl ecut dilatmx give effect valu textecut_eff text ecut text dilatmx special kkpoint satisfi condit kk gg_ coeffici must store specif storag mode govern input variabl istwfk introduc follow kk point bigl bigr left fracright left frac right left frac fracright leftfrac right leftfrac fracright leftfrac frac right leftfrac frac fracright point number gg vector taken account decreas factor gg treat coeffici u_nbf kbf g recov treat thank u_nbf kbf g u_nbf kbf gbf g_ valu istwfk automat comput code basi kpoint coordin treatment timerevers symmetri specifi kptopt one disabl timerevers trick input file set explicitli valu istwfk syntax istwfk number plane wave text npw text ipwcdot text npw reduc coordin bf g contain array text kg mboxthes integ number case bf gred_ text kgtext ipw cr bf gred_ text kgtext ipw cr bf gred_ text kgtext ipw cr list gg vector comput routin text kpgsphf maximum number ggvector kpoint call mpw insid code fft grid fft box gener densiti wavefunct well applic local part potenti one need abl comput u_nkkrr dmesh rrpoint extrem fast valu u_nkkgg note spin spin part treat separ oper need specifi otherwis section fft algorithm start valu function beginalign z j_j_j_ mboxfor j_cdotsn_ j_cdotsn_ j_cdotsn_ endalign comput fast transform beginalign tildezl_l_l_ mboxfor l_cdotsn_ l_cdotsn_ l_cdotsn_ endalign tildezl_l_l_sum_j_j_j_ zj_j_j_ eipileftfracj_l_n_fracj_l_n_fracj_l_n_right want valu u_bf kbf r fft grid begineqnarray rred_fracn_fracn_cdot fracn_n_leftfracl_n_right rred_fracn_fracn_cdot fracn_n_leftfracl_n_right rred_fracn_fracn_cdot fracn_n_leftfracl_n_right endeqnarray fft algorithm comput cost scale nlogn n total number point mesh note howev obtain u_kkrr everywher discret set fft point given equat choic n_n_n_ discuss effect gred_ gred_n_ valu gred_ modulo n similar begineqnarray u_bf kbf rsum_bf g u_bf kbf g eipi bf g cdot bf r sum_bf g u_bf kbf g eipigred_rred_ gred_rred_ gred_rred_ endeqnarray let us repres u_kkrr segment fortran wf_real n_n_n_ first index refer real imaginari part three other integ valu l_l_l_ let us map c_bf kbf g coeffici similar segment fortran wf_reciproc n_n_n_ similar mean tt wf_reciprocalj_j_j_ begineqnarray j_tt modbf gred_n_ rightarrow j_inn_ j_tt modbf gred_n_ j_tt modbf gred_n_ endeqnarray begineqnarray lefteqn tt wf_realcdot l_l_l_ sumn__j_ sumn__j_ sumn__j_ tt wf_reciproc cdot j_j_j_ time eipifracj_l_n_fracj_l_n_fracj_l_n_ endeqnarray array index convent precis oper done fft algorithm fft effici minimis cach conflict array dimens n_ n_ n_ n_ n_ n_ begineqnarray n_ n_ textif n_ texti even els n_ n_ n_ textif n_ texti even els n_ n_ n_ textif n_ texti even els n_ endeqnarray fft mesh given ngfft paw requir addit dens fft mesh densiti potenti call ngfftdg wavefunct spatial symmetri spatial symmetri oper commut hamiltonian hs_bf begineqnarray hpsira varepsilonpsirightarrow s_bf thpsira varepsilon s_tpsira rightarrow hs_bf tpsira varepsilons_bf tpsi endeqnarray s_bf tpsira also eigenvector eigenvalu psira howev wavevector differ begineqnarray psi_nbf kbf rbf r eipi bf k bf r psi_nbf kbf r rightarrow s_bf psi_nbf kbf rbf r psi_nbf ks_bf tbf rbf r psi_nbf ksum_betas_alphabetar_betar_betat_beta psi_nbf ksum_betas_alphabetar_betat_betasum_betas_alphabetar_beta psi_nbf ks_tbf rsum_betas_alphabetar_beta noalignhboxs_alphabeta r_beta must vector real space lattic s_t leav lattic invari eipi sum_alphabeta k_alpha s_alphabeta r_beta psi_nbf ks_tbf r eipi bf kcdotbf rs_bf tpsi_nbf kbf r endeqnarray bf k_alpha sum_beta s_betaalpha k_beta vector reciproc space bf k_beta s_bf tbf k_beta sum_beta s_betaalpha k_beta ie invers transpos s_alphabeta use preceed result mean begineqnarray psi_nstbf k stackrelrm lc s_tpsi_nbf kbf r stackrelrm lc psi_nbf k sum_beta s_alphabetar_betat_beta endeqnarray begineqnarray longrightarrow u_nst kbf r eipi sum_alphabeta st_alphabeta k_beta r_alpha stackrelrm lc eipi sum_alphabeta k_alpha s_alphabetar_betat_beta time u_nbf ksum_beta s_alphabetar_betat_beta longrightarrow u_nst kbf r stackrelrm lc eipi sum_alphabeta k_alpha s_alphabeta t_beta u_nksum_beta s_alphabetar_betat_beta longrightarrow sum_bf g c_nstk bf g eipibf gcdotbf r stackrelrm lc eipi sum_alphabeta k_alpha s_alphabeta t_beta sum_bf g c_nbf kbf g eipi sum_alphabeta g_alphas_alphabeta r_betat_beta longrightarrow c_nst ksum_alpha g_alpha s_alphabeta stackrelrm lc eipi sum_alphabetak_alphag_alpha s_alphabeta t_beta c_nbf kbf g endeqnarray formula allow deriv coeffici c_n one bf k point symmetr bf k point symmetri properti effect space group symmetri electron energi wavefunct symmetri oper leav crystal unchang constitut space group besid translat symmetri oper space group contain proper improp rotat follow appropri fraction displac total citebassani gener element space group denot follow hatmcr_tt mcr real orthonorm matrix associ proper improp rotat tt correspond fraction translat fraction translat zero space group said symmorph abinit rotat real space call symrel correspond fraction translat store tnon array note symrel tnon given reduc coordin applic symmetri oper hatmcr_tt vector atm_i defin posit atom unit cell give beginequ omcr_tt atm_i equiv mcr atm_i tt atm_j rr endequ atm_j indic atom unit cell type atm_i may coincid atm_i rr suitabl lattic translat possibl zero applic symmetri oper hat mcr_tt gener function frr three spatial coordin convent defin beginequ omcr_tt f rr equiv fri rrtt endequ sinc omcr_tt commut hamiltonian hh crystal readili follow given psi_nkkrr eigenst hh omcr_tt psi_nkkrr also eigenst schrdinger problem eigenvalu beginequ begincas bigl hatmcr_tt hh bigr hh psi_nkkrr ee_nkkpsi_nkkrr endcas longrightarrow hhhatmcr_tt psi_nkk omcr_tthhpsi_nkk ee_nkkomcr_ttpsi_nkk endequ although omcr_ttpsi_nkkrr eigenenergi psi_nkkrr crystallin momentum differ oper hatmcr_tt space group transform bloch function vector kk new bloch wave function crystallin momentum mcr kk import properti seen follow beginequ labeleqrotation_of_psi beginalign bigl omcr_ttpsi_nk bigr rrrr quad psi_nk bigl ri rrrrtt bigr ei kkcdotri rrrrtt u_nk bigl rirrtt bigr quad eirit kkcdotrr psi_nk bigl ri rrttbigr eimcr kk cdot rr omcr_tt psi_nkrr endalign endequ rr arbitrari vector direct bravai lattic invari period part bloch wave function exploit note last equal follow orthogon mcr matrix refer cartesian frame refer orthogon rotat matrix hold anymor usual done abinit code symmetri oper express reduc coordin case correct matrix use oper reciproc space given transpos ri call symrec fortran code nondegener state one obtain beginequ labeleqrotation_wfn psi_mcrkkrr psi_kk rirrtt u_mcrkkgg u_kkmcrgg endequ equat use reduc number kkpoint matrix element evalu store sinc inform full brillouin zone reconstruct symmetri appropri irreduc wedg set equat summar use relationship commonli employ begineqnarray labeleqspace_group_symmetri begincas ee_mcrkk quad ee_kk u_mcrkkrr quad ei mcrkk cdottt u_kkbiglrrmrmtbigr u_mcrkkgg quad eimcrkkggcdottt u_kkrrmgg endcas endeqnarray time invari hamiltonian hh hh might introduc addit constraint begineqnarray labeleqtime_reversal_symmetri begincas ee_nk quad ee_kk u_nkrr quad u_nkkrr u_nkgg quad u_nkkgg endcas endeqnarray import stress set equat refeqspace_group_symmetri hold case nondegener state presenc degeneraci applic symmetri oper bloch wave function momentum kk belong set degener state mcc_nk produc new eigenst energi crystallin momentum mcr kk new eigenst given appropri linear combin degener state wave vector mcrkk explicitli beginequ labeleqsymmetry_for_degenerate_st omcr_ttpsi_nk rr psi_nkmcrrrtt sum_aa inmcc_nk d_aa nmcrpsi_aamcrkkrr psi_nmcrkkrr u_mcrkkgg u_kkmcrgg endequ d_aabbmcr unitari transform associ mcr citebassani equat refeqsymmetry_for_degenerate_st reduc refeqrotation_wfn state psi_nkrr nondegener sinc particular case d_aabbmcr delta_aabb magnet space group extens concept symmetri need order explain magnet properti crystal citelandau addit spatial arrang atom orient atom magnet moment also becom import system may turn usual spatial oper leav crystal unchang regard geometr structur revers orient spin let symbol mcj indic oper revers spin let mce denot ident oper combin oper consist ordinari symmetri oper follow mcj new type symmetri oper call complementari oper rule oper composit standard nonmagnet group easili extend includ mcj beginequ textif omca_ cdot omca_ omca_ textthen begincas mcj omca_ cdot mcjomca_ omca_ mcj omca_ cdot omca_ mcjomca_ omca_ cdot mcjomca_ mcjomca_ endcas endequ magnet group obtain replac symmetri element initi nonmagnet space group complementari oper result ensembl form group respect new algebra magnet space group sometim refer shubnikov group classifi accord three differ categori citebhagavantam shubnikov type iv group includ mcj explicitli socal grey group shubnikov type iv number group obtain take direct product convent space group group mcemcj shubnikov type iii group includ mcj explicitli contain complementari symmetri oper also call mix group shubnikov type iii total colorless group includ mcj either explicitli conjunct convent symmetri oper also name colorless group indistinguish convent space group henceforth order keep notat simpl possibl symmetri oper contain mcj denot underlin symbol afmomcr_tt said antiferromagnet charact contrari symmetri oper preserv orient spin project denot use standard notat omcr_tt said ferromagnet charact action magnet symmetri nondegener bloch state gener accord begineqnarray labeleqafm_symmetries_wf omcr_tt psiss_kkrr equiv psiss_kkrirrtt psi_mcrkkssrr afmomcr_tt psiss_kkrr equiv psiss_kkrirrtt psi_mcrkkssrr endeqnarray ss pm thalf use symmetri relat one verifi two spin compon electron densiti transform accord begineqnarray labeleqrho_vxc_afm_symmetri omcr_tt nssrr nss biglmcrrrttbigr nss rr afmomcr_tt nssrr nss biglmcrrrttbigr nssrr endeqnarray follow total charg consequ hartre potenti invari applic oper magnet group similar symmetri relationship hold two compon exchangecorrel potenti magnet charact symmetri oper store symafm array author mg newcommandlmlm newcommandylmy_ml newcommandrymathc newcommandrylmmathc y_ml newcommandrylmmathc y_ml newcommandlpl newcommandrrhatwidehatrr newcommandrrphatwidehatrr newcommandmcpmathcalp newcommanddfequiv requir mathtool newcommandlil_i newcommandmim_i newcommandnjn_j newcommandljl_j newcommandmjm_j renewcommandmpm newcommandmcgmathc g newcommandomcrhatmcr newcommandmcrmathcalr newcommandddoddomega newcommandlmlm newcommandmcrmmcr newcommandkpghatwidehatkpg newcommandrrpbf r newcommandgauntmathc g complex real spheric harmon complex spheric harmon complex spheric harmon ylm defin eigenfunct orbit angular momentum oper hat l hat l_z label two quantum number l relat eigenvalu hat l hat l_z beginequ hat l ylmthetaphi ylmthetaphi endequ beginequ hat l_z ylmthetaphi ylmthetaphi endequ explicit express beginequ ylmthetaphi n_lm p_mlcostheta eimphi endequ l take nonneg integ valu possibl valu integ l l two symbol theta phi use denot angular spheric coordin n_lm normal factor beginequ n_lm sqrtfraclpi dfraclmlm endequ p_ml associ legendr polynomi complex spheric harmon orthogon function sphere ie beginequ laylmy_mplpra_omega delta_llpdelta_mmp endequ lara_omega denot integr unit sphere furthermor form complet basi set sinc squareintegr function fthetaphi expand seri accord beginequ fthetaphi sum_linfti sum_mll a_lmylmthetaphi endequ complex spheric harmon satisfi two use properti commonli employ practic applic pariti properti beginequationlabeleqparity_property_ylm y_mldaggerrrhat y_ml rrhat endequ beginequ ylmrrhat l ylmrrhat endequ addit theorem beginequationlabeleqaddition_theorem_csh sum_m ylmrrhat ylmrrphat dfraclpimcp_l rrhatcdotrrphat endequ mcp_lq legendr polynomi equat refeqaddition_theorem_csh gener employ applic nonloc part hamiltonian case normconserv pseudopotenti useylm real spheric harmon idrsha real spheric harmon rsh obtain combin complex conjug function associ opposit valu rsh adequ basi function calcul atom symmetri import sinc directli relat irreduc represent subgroup d_ citeblanco moreov real half memori requir complex spheric harmon clearli advantag high angular momenta need sever rh valu store memori possibl definit rh citeblanco beginequationlabeleqdefinition_real_harmon rylm df begincas quad dfracmsqrtylm ylm quad quad y_l quad quad dfracmisqrty_lvertmrvertl y_lvertmrvertl quad endcas endequ equat refeqdefinition_real_harmon rewritten matrix notat beginequationlabelequnitaty_transformation_y_recmplx underlineryl ul underlineyl endequ underlineryl underlineyl column vector contain real spheric harmon order increas valu ul unitari matrix whose explicit express found citeblanco basic properti rsh easili deriv properti complex spheric harmon mean refeqdefinition_real_harmon realiti beginequ rylmrrhat rylmrrhat endequ pariti properti beginequ rylmrrhat l rylm rrhat endequ orthonorm beginequ larylmry_mplpra_omega delta_llp delta_mmp endequ certain onsit matrix element includ integr three real spheric harmon evalu exactli beginequationlabeleqgaunt_def gaunt_limiljmjlm df int ry_miliry_mlry_mjljddo endequ integr known literatur name gaunt coeffici due select rule integr equat refeqgaunt_def nonzero mimj lvertliljrvert ge lll dot ge lvertliljrvert note express mcg follow intern convent use insid abinit code slightli differ one report standard textbook symmetri transform rsh use symmetri properti fundament import simplifi determin electron structur greatli reduc number nonequival integr comput well size tabl store memori frequent one evalu valu rsh rotat point applic symmetri oper belong space group crystal usual occur kkdepend matrix element symmetr full brillouin zone start knowledg symmetr imag irreduc wedg effect proper improp rotat rsh deduc beginequ labeleqrsh_rot omcrrylmrrhat rylmmcrm rrhat sum_alpha dl_alpha mmcrrylmrrhat endequ spheric harmon given l transform linear combin rh l coeffici given beginequ dl_alpha mmcr df laryl_alphahatmcrrylmra endequ use expans term rsh mean unitari transform given refeqdefinition_real_harmon possibl rewrit rayleigh expans plane wave term rsh beginequ labeleqrayleigh_expansion_real_ylm eikpgcdotrr pi sum_lm il j_llvertkpgrvert rrylmkpghatrylmrrhat endequ j_lx spheric bessel function order l similar way electrostat potenti expand real spheric harmon basi set final express similar one obtain case complex spheric harmon beginequationlabeleqexpansion_coulombian_rsh dfraclvertrrrrprvert sum_linfti dfracpil sum_mlml dfracr_lr_l rylmrrhatrylmrrphat endequ r_ df minrr r_ df maxrr author giantomassi x gonz suzukawa mikami geometr consider real space three primit translat vector rr_ rr_ rr_ represent cartesian coordin atom unit rr_ rightarrow rprimd rr_ rightarrow rprimd rr_ rightarrow rprimd relat input variabl acel rprim angdeg atom posit specifi coordin bf x_tau tau dot n_atom n_atom number atom natom represent reduc coordin begineqnarray bf x_tau xred_tau cdot bf r_ xred_tau cdot bf r_ xred_tau cdot bf r_ textwher tau rightarrow iatom n_atom rightarrow natom xred_tau rightarrow xrediatom xred_tau rightarrow xrediatom xred_tau rightarrow xrediatom endeqnarray relat input variabl xcart xred volum primit unit cell call ucvol code begineqnarray omega bf r_ cdot bf r_ time bf r_ endeqnarray scalar product reduc represent valuat thank bf r cdot bf r left beginarrayccc rred_ rred_ rred_ endarray right left beginarrayccc bf r_ cdot bf r_ bf r_ cdot bf r_ bf r_ cdot bf r_ bf r_ cdot bf r_ bf r_ cdot bf r_ bf r_ cdot bf r_ bf r_ cdot bf r_ bf r_ cdot bf r_ bf r_ cdot bf r_ endarray right left beginarrayc rred prime_ rred prime_ rred prime_ endarray right bf r cdot bf r sum_ij rred_i bf rmet_ij rred prime_j bf rmet_ij metric tensor real space store rmet array bf rmet_ij rightarrow rmetij reciproc space three primit translat vector reciproc space gg_ gg_gg_ begineqnarray bf g_fracpiomegabf r_timesbf r_ rightarrow pi gprimd bf g_fracpiomegabf r_timesbf r_ rightarrow pi gprimd bf g_fracpiomegabf r_timesbf r_ rightarrow pi gprimd endeqnarray definit gg_i cdot rr_j pidelta_ij warn histor reason intern implement use convent gg_i cdot rr_j delta_ij mean factor pi must taken account fortran code dont use convent theori note keep equat simpl possibl reduc represent vector k reciproc space bf kkred_bf g_kred_bf g_ kred_bf gred_ rightarrow kred_kred_kred_ eg reduc represent bf g_ import reduc represent vector reciproc space lattic made triplet integ scalar product reduc represent evalu thank bf k cdot bf kleft beginarrayccc kred_ kred_ kred_ endarray right left beginarrayccc bf g_ cdot bf g_ bf g_ cdot bf g_ bf g_ cdot bf g_ bf g_ cdot bf g_ bf g_ cdot bf g_ bf g_ cdot bf g_ bf g_ cdot bf g_ bf g_ cdot bf g_ bf g_ cdot bf g_ endarray right left beginarrayc kred prime_ kred prime_ kred prime_ endarray right bf k cdot bf k sum_ij kred_ibf gmet_ijkr prime_j bf gmet_ij metric tensor reciproc space call gmet insid code take account intern convent use code correspond bf gmet_ij rightarrow pigmetij fourier seri period lattic quantiti function period lattic ie function fullfil properti urr rr urr repres discret fourier seri urr sum_gg uggeiggcdotrr fourier coeffici ugg given ugg fracomega int_omega urreiggcdotrrddrr appendix report convent use work fourier represent frequenc momentumspac volum unit cell denot omega v total volum crystal simul employ bornvon karman period boundari conditionciteashcroft beginequationlabeleqift_points_convent frr_rr_ fracv sum_substackqq gg_ gg_ ei qq gg_ cdot rr_f_gg_ gg_qqei qqgg_ cdot rr_ endequ beginequationlabeleqft_points_convent f_gg_gg_qq fracv iint_v eiqqgg_ cdot rr_frr_ rr_ei qqgg_ cdot rr_ddrr_ddrr_ endequ author mg newcommandaaalpha newcommandpstextp newcommandylmy_ml newcommandvlocv_textloc newcommandvvhat v newcommandvlocvv_textloc newcommandvnlv_textnl newcommandlmlm newcommandkkbf k newcommandkkpbfk newcommandkkhatwidehat kk newcommandkkphatwidehatkk newcommandjlj_l newcommandrrhatwidehatrr newcommandddtextd pseudopotenti kleynman byland form page report basic definit equat need evalu nonloc part hamiltonian mainli focu normconserv pseudopotenti provid consist introduct theori pseudopotenti beyond purpos section complet discuss topic found special articl avail literatur citehamann citebachelet citekleinman citehamann citetroulli citegonz citefuch gener norm conserv multipl projector optim normconserv vanderbilt pseudopotenti refer reader citehamann gener valid oncvpsp pseudopotenti describ pseudodojohttpwwwpseudodojoorg paper citesetten purpos summar say pseudopotenti construct order replac atom allelectron potenti core state elimin valenc electron describ pseudo wavefunct whose represent fourier space decay rapidli modern normconserv pseudopotenti construct scatter properti allelectron atom reproduc around refer energi configur first order energi follow procedur describ citehamann citehamann citetroulli modern ab initio code fulli separ kb form propos kleynman byland usual employ drastic reduc number oper requir applic nonloc part hamiltonian well memori requir store oper citekleinman kb form interact valenc electron ion type aa describ mean oper beginequationlabeleqkbsingleatom vv_psaa vlocaar sum_lm chi_lmaarae_laalachi_lmaa vloc_aarr sum_lm ylmu_laakbra e_laakb lau_laakbylm endequ vlocaar pure local potenti coulomb tail gammar note simplic discuss limit pseudopotenti singl projector per angular channel gener multiprojector pseudopotenti requir introduc addit n index kb energi ie e_nlaa projector chi_nlmaarr socal kleinmanbyland energi e_laa measur strength nonloc compon respect local part projector chi_lmaarr shortrang function express term complex spheric harmon ylmthetaphi multipli l atomdepend radial function beginequ labeleqkb_projector chi_lmaarr dfracrchi_laarylmthetaphi endequ beginequationlabeleqkbfunctionu u_laakb rr fracdelta v_laarru_laap rr normu_laarrdelta_laa endequ local function defin term shortrang pseudo eigenfuncion refer atom beginequationlabeleqkbenergi e_laakb fracla u_laap delta v_laa delta v_laa u_laap ra la u_laap delta v_laa u_laap ra endequ total nonloc part hamiltonian obtain sum differ atomcent contribut final express real space read beginequ vnlrr_rr_ sum_substackrr aatt_aa sum_lm larr_rrtt_aachi_lmaara e_laalachi_lmaarr_rrtt_aara endequ rr run site bravai lattic tt_aa posit atom type aa locat insid unit cell due nonloc oper fourier transform depend two separ indic kkgg_ kkgg_ instead simpl differ gg_gg_ shorthand notat kk kk gg use follow simplifi deriv use rayleigh expans planewav term spheric harmon ylmthetaphi spheric bessel function jlkr beginequationlabeleqpwinylmpl eikkcdotrr pisum_lm il jlkr ylmkkhatylmrrhat endequ fourier represent projector defin refeqkb_projector express beginequ lakkchi_lmaara fracpiomega lylmkkhat int_infti rjlkrchi_laarrdd r fracpiomega lylmkkhat f_laak endequ form factor f_laak relat atom type aa defin beginequationlabelwqdefformfactor f_laak df fracint_infti rj_l kru_laa delta v_laadd r normu_laa delta v_laa endequ final express total nonloc oper reciproc space beginequ labeleqvnlkbmatrixel vnlkkkkp fracpiomega sum_aa tt_aa sum_lm eikkkkpcdottt_aa ylmkkhatylmkkphat e_laa f_laak f_laak endequ note abinit employ iter eigenvalu solver solv ks equat mean need comput vnl psira ie need appli hamiltonian onto set trial eigenvector therefor full vnlkkkkp matrix never construct explicitli author mg ms manybodi theori abinit aim section introduc green function formal concept selfenergi set coupl equat propos hedin selfconsist solut hedin equat principl give exact green function interact system mainli focu aspect theori import understand differ step calcul role play input variabl use control run much consist rigor introduct physic concept green function selfenergi found standard textbook manybodi theori see exampl citeabrikosov citefett citemattuck green function selfenergi timeord green function g also call propag defin probabl amplitud propag ad remov electron manybodi system sinc probabl amplitud simpli given overlap final initi state g express beginequ g ileftlangl theta_n left hatt left hatpsihatpsidagg right right theta_n rightrangl endequ matrix element taken heisenberg represent hatt timeord oper creation annihil field oper act ground state nelectron manybodi hamiltonian convent use equat explain section notationnot green function contain part full inform carri manybodi wave function includ relev part studi charg excit addit singleparticl oper act system evalu green function known use physic inform charg excit energi manybodi system obtain express propag socal lehmann represent citeabrikosov citefett citemattuck purpos use introduc follow notat denot charg excit energi nelectron system citeonida beginequ varepsilon_i begincas e_in e_n textifvarepsilon_i mu e_ne_in textifvarepsilon_i mu endcas endequ e_n ground state energi electron system n electron set quantum number label excit state n pm electron final mu chemic potenti system import quantiti use follow socal lehmann amplitud schroding represent defin beginequ labeleqlehmann_amplitud psi_i rr equiv begincas langletheta_nhatpsirr theta_inrangl quadqquad ee_i mu langletheta_in hatpsirr theta_nrangl quadqquad ee_i mu endcas endequ lehmann represent green function beginequ labeleqlehmann_represent g rr_rr_ww sum_i fracpsi_irr_psi_irr_ wwee_i ietasignee_imu qquadeta rightarrow endequ make clear frequenc domain timeord green function contain complet excit spectrum correspond excit nparticl nparticl system henc locat pole green function complex plane provid inform need interpret process measur experi singl electron insert remov system figur give schemat represent locat pole timeord green function mbt_assetspoles_gsvg ioniz potenti energi requir remov electron system electron affin add electron chemic potenti typic taken middl gap metal system energi equal gap dyson equat beginequ labeleqg_eq_gsg g go int gosigmagdd endequ establish connect fulli interact g go green approxim noninteract system nonloc nonhermitian time depend potenti call selfenergi sigma sinc go suppos known exactli problem calcul g reduc calcul selfenergi selfenergi mere mathemat devic use roundabout way obtain g direct physic mean knowledg selfenergi oper allow one describ quantummechan state renorm electron manybodi system solv quasiparticl qp equat citeonida beginequ labeleqqp_equ bigl hat h_rr_ v_hrr_ bigr psirr_ intsigmarr_rr_eeqppsirr_ddrr_ eeqp psirr_ endequ qp eigenst obtain way use construct g accord lehmann represent note qp equat differ kohn sham equat sinc qp eigenvector eigenvalu direct physic mean use obtain charg densiti interact system describ properti charg excit hedin equat hedin citehedin show deriv set coupl integro differenti equat whose selfconsist solut principl give exact selfenergi system therefor exact g fundament build block employ formal irreduc polariz beginequationlabeleqchi_tilde_def tchi equiv dfracdelta n delta ueff ifracdelta gdelta ueff endequ describ linear respons densiti chang total effect potenti superposit extern potenti plu intern classic hartre potenti dynam screen interact w relat bare coulomb interact v invers dielectr function beginequ labelw_def w equiv int eevdd endequ dielectr matrix ee relat irreduc polariz tchi follow relat beginequ ee delta int v tchi dd endequ pentagon sketch figur show variou physic quantiti interrel mbt_assetshedin_pentagonsvg polar function renorm bare interact result screen interact w screen interact w mani bodi propag g vertex function gamma describ interact virtual hole electron excit citeonida essenti ingredi determin sigma iter start set g go set equat principl iter selfconsist term reach gw approxim practic solut hedin equat extrem complic numer relat contain function deriv equat vertex direct evalu vertex function challeng set equat howev iter assum iter actual need obtain physic meaning result wide use approach approxim solut hedin equat socal gw approxim citehedin consist approxim vertex function local instantan function beginequ gamma approx deltadelta equiv gammagw endequ approxim vertex insert full set hedin equat lead consider simplif set equat mbt_assetsgw_pentagonsvg thank neglect vertex correct irreduc polariz tchi given beginequationlabeleqrpa_with_g tchi igg endequ rewritten term orbit energi reduc rpa express propos adler citeadl wiser citewis real space selfenergi reduc simpl direct product dress electron propag g dynam screen interact w beginequ sigma gw endequ selfenergi simpl product spacetim domain becom convolut express frequencyspac beginequ sigmarr_rr_ww fracipi int grr_rr_wwww wrr_rr_wweiwwdeltaddww endequ ideal set gw equat still iter self consist term reach fulli selfconsist gw method scgw howev scgw calcul real system still challeng report literatur moreov util fulli scgw result still debat within scientif commun problem selfconsist typic improv total energi worsen spectral properti band gap optic spectra sinc obtain spectral inform often main reason difficult calcul first place mani author agre use selfconsist approach would need inclus kind vertex correct solut equat reason common approach employ _ab initio_ commun consist use best avail approxim g w start point perform singleiter parallelogram socal oneshot gw method gowo case selfenergi simpli given beginequ sigma igokswo endequ gok independentparticl propag kohnsham ks hamiltonian screen interact approxim rpa calcul ks energi wave function beginequ chi goksgok endequ perturb approach despit fundament differ manybodi theori dft kohnsham exchangecorrel potenti seen static local hermitian approxim selfenergi inde mani case kohn sham energi alreadi provid reason estim band structur usual qualit agreement experi observ suggest simpl albeit accur solut qp energi obtain use firstord perturb theori treat exchang correl potenti v_xc zerothord approxim nonloc energi depend selfenergi citehybertsen citehybertsen assumpt qp wavefunct equal ks orbit expand selfenergi oper around eek obtain close express eeqp beginequ labeleqimplicit_qp_energi eeqp eek z langlepsikssigmaeeksvxcpsiksrangl endequ beginequ labeleqz_factor z equiv left langl psik pdersigmaeeeekspsiksrangl right endequ socal renorm factor correspond make taylor expans selfenergi matrix element around ks energi depict mbt_assetsself_energy_taylorpng idrpa_fourier_spacea rpa polariz fourier space reciproc space frequenc domain impli fourier transform ft real space coordin time variabl independ particl polariz assum form mbt_assetschi_sc_trsvg transit valenc v conduct state c contribut simplic assum semiconductor timerevers invari convent use fourier transform discuss notationnot section number band use comput polariz specifi nband zcut give small complex shift use avoid diverg denomin frequenc mesh defin set variabl nfreqr nfreqim freqremax freqremin number exot grid choic avail input variabl begin gw_ cd_ eg gw_frqim_inzgrid shorthand notat denot matrix element plane wave sandwich two wavefunct ie oscil matrix element number planewav pw use describ wavefunct determin ecutwfn number ggvector use describ polariz ie number _g_ vector oscil matrix element determin ecutep oscil ubiquit manybodi part abinit calcul repres one cpu intens part execut reason devot separ sectionnotesonthecalculationoftheoscillatormatrixel discuss import technic detail concern comput principl set qqpoint screen matrix given possibl differ two crystallin momenta wavefunct store kss file control chosen kkpoint grid code howev exploit invari twopoint function action symmetri oper crystallin space group beginequ chirr_rr_ chi biglrirr_ttrirr_ttbigr endequ qqpoint irreduc brillouin zone ibz calcul explicitli frequenc reciproc space microscop dielectr function relat irreduc polariz follow relat beginequ ee_gg_gg_qqww delta_gg_gg_ vqq gg_ tchi_gg_gg_qqww endequ invers dielectr function obtain via matrix invers follow adler citeadl macroscop dielectr function ee_mtextlfww directli relat invers microscop dielectr matrix mean beginequ labeleqabs_lf ee_mtextlfww lim_qq rightarrow dfracee_ qqww endequ optic absorpt spectrum quantiti one compar experi given imaginari part note equat differ beginequ labeleqabs_nlf ee_mtextnlfww lim_qq rightarrow ee_ qqww endequ due call localfield effect introduc presenc crystallin environ spectra calcul typic output _lf _nlf file cours calcul note calcul oscil matrix element mani bodi calcul requir evalu integr involv oscil matrix element mbt_assetsoscillator_longvsvg k point belong full brillouin zone term evalu perform fast fourier transform fft real space product two wavefunct second express equat thank fft algorithm cputim requir scale almost linearli number point fft box moreov code implement refin algorithm instanc zeropad fft fftw interfac optim comput signific speedup compon depend numer fft librari use possibl alway advantag link use fftw librari gw calcul control set fftalg perform variou fft librari given type calcul benchmark fftprof util given set indic b_ b_ kk qq calcul oscil done four differ step two wavefunct irreduc wedg fft transform ggspace real space represent orbit rotat real space fft mesh obtain point kk kkqq full brillouin zone comput wavefunct product fft transform product obtain oscil thu requir three differ fft two transform construct product one fft get number fft significantli reduc precomput store memori real space represent orbit price reason increas memori alloc howev memori demand calcul real space orbit calcul fli increas comput time instead option control second digit input variabl gwmem third term equat defin oscil make clear product period part orbit nonzero fourier compon sphere whose radiu r_wfn r_wfn radiu ggsphere use wavefunct set ecutwfn avoid alias error fft one therefor use fft box enclos sphere radiu r_wfn lead signific increas comput effort well memori requir input variabl fftgw specifi setup fft box oscil use test alias error affect final result default set fftgw safe set fftgw fast inaccur set fftgw give maximum possibl accuraci signific comput cost idhilbert_transforma hilbert transform method comput effort evalu rpa polariz adlerwis express scale linearli number frequenc comput nfreqr nfreqim albeit larg prefactor increas fourth power number atom main reason linear scale frequenc depend factor sum transit henc distinct expens summat transit perform separ frequenc linear scale repres seriou problem especi mani frequenc want exampl comput qp correct within contour deform techniqu describ tutorialgwgw tutori comput bottleneck remov certain circumst employ effici algorithm propos citemiyak subsequ revisit citeshishkin spectral function mbt_assetssf_chisvg evalu term electron transit valenc conduct state dirac delta function approxim either mean triangular function center energi transit follow citeshishkin gaussian approxim follow citemiyak see relat input variabl spmeth spbroad spectral function evalu linear frequenc mesh cover entir set transit energi includ calcul number point mesh given nomegasf evalu spectral function rather effici thank presenc deltafunct express exampl spmeth cpu time requir comput spectral function arbitrarili dens frequenc mesh twice requir singl static comput base standard adlerwis express full polariz effici retriev mean less expens frequenc integr hilbert transform beginequ labeleqchi_hilbert_transform chi_gg_gg_ qqww int_infti tchimcs_gg_gg_ qqww time bigglfracwwwwideltafracwwwwideltabiggrddww endequ price paid howev larg tabl spectral function store memori hilbert transform perform pair gg_ gg_ sinc comput time requir transform scale quadrat number vector polariz govern ecutep cpu time spent part overcom comput time standard adlerwis formal larg ecutep theoret estim crossov point hard give depend mani factor howev mani frequenc need evalu optic spectra accur contour deform integr even map full grid complex plane hilbert transform method significantli faster use well worth consid ifevaluation_gw_sigmaa evalu gw selfenergi follow standard approach separ screen interact static bare coulomb term frequencydepend contribut accord beginequ w v ee v endequ matrix notat use particular decomposit w insert convolut defin sigma lead split selfenergi two differ contribut exchang correl beginequ sigmarr_rr_ww equiv sigma_xrr_rr_ sigma_crr_rr_ww endequ exchang part static turn mathemat structur fock oper hartreefock theori albeit construct quasiparticl amplitud beginequationlabeleqsigma_x sigma_xrr_rr_ sum_kkbz sum_nutextocc psi_nkkrr_psi_nkkrr_vrr_rr_ endequ dynam part sigma_cww account correl effect beyond sigma_x import stress comput effici code comput full selfenergi oper default matrix element state specifi kptgw bdgw comput use obtain qp correct express reciproc space diagon matrix element exchang part given mbt_assetsself_x_melsvg evalu term repres minor fraction overal cpu time sinc occupi state involv howev alway keep mind due long rang bare coulomb interact converg respect number plane wave use oscil _m_ ecutsigx usual slow much slower converg correl part shortrang plane wave cutoff converg independ other necessari given much larger valu comparison ecut ecutwfn ecutep anoth point worth note presenc express coulomb singular qq gg rightarrow mathemat point view integr welldefin sinc singular integr three dimension space thermodynam limit n_qq rightarrow infti reach hand finit number qqpoint use practic applic care numer treatment need avoid exceedingli slow converg respect bz sampl acceler converg number qqpoint code implement sever techniqu propos literatur refer document icutcoul extens discuss express matrix element correl part instead given mbt_assetsself_c_melsvg dynam effect contain frequenc convolut integr _j_ explicit express _j_ depend method use treat screen interact code implement four differ plasmonpol techniqu model frequenc depend w effici approxim way altern possibl use sophist frequenc integr contour deform method citelebegu accur qp calcul see relat variabl ppmodel gwcalctyp doubl sum ggvector perform plane wave contain within sphere energi ecutep larger valu use gener scr file state correl matrix element evalu linear frequenc mesh center around initi ks energi deriv need renorm factor obtain numer see nomegasrd omegasrdmax note contrast exchang term sum band index n extend infin although practic finit number state use specifi nband import also advis take special care converg respect nband ecutep gw calcul two paramet tend independ converg one low valu vice versa easili lead converg result citesetten plasmonpol model one major comput effort selfenergi calcul repres calcul frequenc depend screen interact need evalu convolut due rag behavior gww w ww along real axi numer real frequenc principl requir converg result note maximum frequenc need report prtvol hand sinc fine detail www integr reason expect approxim model abl captur main physic featur screen interact give suffici accur result consider reduct comput effort basic idea behind socal plasmonpol model frequenc depend www model term analyt express depend coeffici deriv first principl ie without adjust extern paramet four differ plasmonpol techniqu avail abinit input variabl ppmodel select method use ppmodel frequenc depend invers dielectr function model accord beginequ labeleqppmodel_imag textimee_gg_gg_qqww a_gg_gg_qq bigl deltawwww_gg_gg_qq deltawwww_gg_gg_qq bigr endequ beginequ labeleqppmodel_r textreee_gg_ gg_ qqww delta_gg_ gg_ dfracomega_gg_gg_qqwwtww_gg_gg_qq endequ two model differ approach use comput paramet ppmodel deriv paramet invers dielectr matrix correctli reproduc two differ explicitli calcul frequenc static limit ww addit imaginari point locat ppmfrq unless user overrid default valu calcul averag electron densiti system plasmon pole paramet ppmodel calcul reproduc static limit exactli fulfil gener frequenc sum rule relat imaginari part manybodi invers dielectr matrix plasma frequenc charg densiti citehybertsen discuss model correspond ppmodel refer reader origin paper cite document variabl contour deform techniqu contour deform method propos order avoid deal quantiti close real axi much possibl citelebegu integr real frequenc axi transform integr contour depict red figur integr real frequenc trade integr along imaginari axi plu contribut come pole integrand lie insid contour mbt_assetscontourpng beginequ labeleqgw_cd sigma_cww dfracipi bigl pii sum_z_pmcc lim_zrightarrow z_p gzwtextczzz_p int_inftyinfti gwwiwwwtextciww ddiww bigr endequ equat first sum restrict pole lie insid path mcc wcz repres frequenc depend part screen interact whose express reciproc space given beginequ wtextcqqww_gg_gg_ equiv bigltee_gg_gg_qqww delta_gg_gg_bigr tild v_gg_gg_qq endequ integr along imaginari axi expect converg quickli respect number sampl frequenc sinc integrand typic smooth residu integrand evalu complex pole contribut green function whose frequenc depend known notat follow shorthand notat employ equiv rr_t_ delta deltarr_rr_deltat_t_ int dd int ddrr_ int_inftyinfti dd t_ v vrr_rr_deltat_t_ rr_t_ eta_eta rightarrow vrr_ rr_ repres bare coulomb interact eta posit infinitesim fourier transform period lattic quantiti defin beginalignatlabeleqft_point_convent urr sum_gg uggeiggcdotrr quad ugg fracomega int_omega urreiggcdotrrddrr endalignat beginequationlabeleqift_points_convent frr_rr_ fracv sum_substackqq gg_ gg_ ei qq gg_ cdot rr_f_gg_ gg_qqei qqgg_ cdot rr_ endequ beginequationlabeleqft_points_convent f_gg_gg_qq fracv iint_v eiqqgg_ cdot rr_frr_ rr_ei qqgg_ cdot rr_ddrr_ddrr_ endequ volum unit cell denot omega v total volum crystal simul employ bornvon karman period boundari condit unless otherwis specifi hartre atom unit use throughout inform format pseudopotenti note implement format done fr detraux format abinit pseudopotenti allow use pseudopotenti tabl phi rev b paper c hartwigsen goedeck j hutter hgh paper present lda pseudopotenti element h rn even present twice possibl includ semicor state accuraci demonstr hgh paper note energi cutoff need get high accuraci might larger one usual need troulliermartin pseudopotenti converg studi import line must ad data mention tabl describ present file abinitv abl read format pseudopotenti file well later version abinit suppos user hgh tabl descript follow focu sn pseudopotenti tabl p one find sn data must put follow format read abinit file also found abinittestspsps_for_test directori name snpsphgh hartwigsengoedeckerhutt psp tin prb paper zatomzionpspdat pspcodpspxclmaxllocmmaxrwel rloc c c c c rs hs hs hs rp hp hp hp kp kp kp rd hd hd hd kd kd kd first follow three line ad begin data tabl hartwigsengoedeckerhutt psp tin prb paper zatomzionpspdat pspcodpspxclmaxllocmmaxrwel similar line must ad data element order make readabl abinit line simpli header might includ inform print without modif output abinit line describ atom number zatom ionic charg zion number valenc electron date pseudopotenti gener two first inform crucial third one realli import atom number hydrogen oxygen ionic charg number second number mention data tabl describ zion section vi paper line describ format pseudopotenti pspcod must format xc function use gener pseudopotenti pspxc must maxim angular momentum wavefunct describ pseudopotenti file lmax pure local pseudopotenti h lisc besc lmax p projector li b ar ksc au lmax p projector k ca cs ba hfsc ptsc ausc rn lmax p f projector cssc basc lasc lusc lloc mean set mmax mean set last number set line follow three line gener data tabl though name element zion reproduc note also line complet zero give format present begin section vi hgh paper five column first line column projector column spinorbit split readabl mean number also ad exampl pseudopotenti file exampl rloc c c c c read abinit thu unlik zero import add data tabl insid abinit pseudopotenti format treat routin pspinf call psplof local part pspnlf nonloc part matter numer accuraci note integr vrzionr r psplof perform analyt without cutoff author jmb xg page contain link error must detect linkcheck error abirefbib file entri citetestlink link error dxdoiorgg instead dxdoiorg entri citetestlinka diff doi url entri citetestlinkb diff doi physrevb url physrevb citat error error citat c end testlinkc citetestlinkc broken extern link error link enwwikipediaorg ww httpsenwwikipediaorgwikimarkdown error link httpsgithubcomabinitabiconfigg gg httpsgithubcomabinitabiconfigg variabl name error error name rfphon rfphongg rfphongg inform format pseudopotenti note implement format done r hamann format abinit normconserv separ pseudopotenti citehamann citehamann citekleinman design allow user wish experi pseudopotenti possibl nonstandard featur great flexibl correspond publicli avail tabul opensourc oncvpsp packag avail wwwmatsimresearchcomhttpwwwmatsimresearchcom produc pseudopotenti format annot exampl present detail follow second exampl incorpor spinorbit coupl extend discuss follow exampl separ section discuss spinorbit produc oncvpsp first produc pseudopotenti format would good idea wellconverg calcul isol atom big box confirm correctli recreat atom valenc level intend format best explain exampl present detail exampl excerpt psps_for_testsca_sicdrh anoth exampl pspcod psps_for_testso_sicdrh last data block file read subroutin pspinf comment line permit actual file blank line header line titl line atom number pseudoion charg date line pspcod identifi format pspxc identifi exchangecorrel function see ixc list input variabl document lmax give largest angular momentum potenti present lloc lmax indic local potenti independ angular momentum case lmax local potenti particular angular momentum channel choic arbitrari index correspond data block must consist valu assign header mmax give number radial grid point arbitrari rwell histor header holdov use line rchrg radiu beyond model core charg use zero neglig maximum radial mesh point must equal exceed valu fchrg signal model core charg present valu valu use otherwis qchrg histor holdov use line number bloechlkleinmanbyland projector nproj angular momentum l llmax valu nproj lloc must lloc lmax line extension_switch initi use valu may util signal presenc additon line header inform specialpurpos use futur valu use indic presenc spinorbit projector see spinorbit section experiment selfinteractioncorrect psp calcium r hamann zatomzionpspd pspcodpspxclmaxllocmmaxrwel rchrg fchrg qchrg nproj extension_switch first data block first line angular momentum l ekbii iinproj follow line label mmax st column radial grid index nd column radial grid mesh point linear mesh start rd column first bkb projector l th column second bkb projector l projector go smoothli zero decay neglig valu within rang radial grid gener nproj ekb projector column l mani want nproj zero lloc current l block omit may absent l block must ascend order second data block first line angular momentum l ekbii iinproj follow line label mmax st column radial grid index nd column radial grid mesh point rd column first bkb projector l third data block l fourth data block first line index correspond lloc header case local potenti correspond angular momentum lloc arbitrari case must lmax block must follow block projector l lmax follow line label mmax st column radial grid index nd column radial grid mesh point rd column local potenti lloclmax correspond block must occur proper l order among block nonloc projector last line ideal equal zionradmmax numer data approach zionr continu possibl sinc fourier transform extend infin analyt assum function form precis satisfi experiment potenti exampl result smallamplitud gibb oscil function q fouriertransform local potenti period piradmmax fifth last data block read subroutin pspcc line label mmax st column radial grid index nd column radial grid mesh point linear mesh start rd column rhoc pimodel core charg densiti th column rhoc dr th column rhoc dr th column rhoc dr th column rhoc dr block read header variabl fchrg spinorbit spinorbit coupl present file psps_for_tests_pt_roncvpsppsp pseudopotenti treat p core state valenc detail given spinorbit portion discuss section header line line number vanderbiltkleinmanbyland projector nproj scalarrelativist nonloc potenti angular momentum l llmax valu nproj lloc must lloc lmax line extension_switch indic spinorbit projector present line number vanderbiltkleinmanbyland projector nprojso spinorbit nonloc potenti angular momentum l llmax pt noptpsp r_core zatomzionpspd pspcodpspxclmaxllocmmaxrwel rchrg fchrg qchrg nproj extension_switch nprojso data block asabov scalarrelativist nonloc projector coeffici ekb grid indic grid point projector data block local potenti lloc data block asabov spinorbit nonloc projector coeffici ekb grid indic grid point projector nonlinear core correct use exampl model core charg deriv would last data block discuss introduc normconserv pseudopotenti input file format design r hamann offer addit flexibl previous avail abinit psp format well possibl improv perform certain respect new featur numer psp offer abil experi beyond exist tabul collect avail psp given basi function sum easili convert format linear radial grid follow advantag comput effici compar log grid core region grid highli redund psp b increas accuraci larg ecut valu space mesh point log grid larger radii usual still signific contribut psp becom larg introduc alias nois fourier transform psp fact code written doubl tripl etc linear grid interpol prior perform transform ensur accuraci base ecut c storag economi probabl import modern comput file easier read redund repeat grid data block function facilit inspect plot variou input allow number nonloc projector anugular momentum channel previous avail sever format without current flexibl direct input bloechlkleinmanbyland projector rather wave function semiloc poteni allow greater flexibl import exploratori applic selfinteractioncorrect psp projector appli wave function follow oper sum fkbnlm ekbnl fkbnlm nlm convent kleinmanbyland choic singl projector singl n would fkbrl vrl v_locrurl vrl semiloc normconserv pseudopotenti angular momentum l v_locr local potenti url radial schroeding equat solut bound scatter note ur convent r factor urr psir case energi ekb dimens energi definit fkb ekbl integr fkbrlurl dr inf pi factor bloechl gener see citebloechl possibl gener includ treatment self interact correct addit projector see citevogelbr final creat numer projector part psp gener process rather within abinit allow one solv radial schroding equat fulli nonloc form compar logarithm deriv pseudo allelectron wave function wide energi rang superior test transfer locat shallow ghost reson refer valenc state would miss standard ghost test citegonzea citegonz lead poor result abil use arbitrari local potenti rather one particular angular momentum channel help elimin ghost state citegonzea citegonzebr exampl calcium pseudopotenti convent choic dchannel lloc local potenti particuarli bad incipi shell repres shallow reson lead deep potenti potenti local nearli imposs avoid ghost state use p local potenti would avoid would place spuriou coreorthogon repuls term channel higher angular momenta f g h could lead error exampl lattic constant local potenti form smooth polynomi extrapol tailregion allelectron potenti origin abinit psp format includ abil form local potenti simpl averag semiloc potenti potenti would like still caus problem case spheric bessel function fourier transform pspf routin comput highli accur recurs method sbff angular momentum channel treat simultan increas accuraci effici compar sinco formul especi larg small argument abil experi variou model core charg nonlinear core correct citeloui advantag function suffici smooth lead potenti sever converg error especi respons function calcul format abinit intern gener higher deriv model core charg th deriv piecewiseconstruct model function look smooth caus havoc requir deriv present input file permit earli detect problem aid remedi releas x introduc abliti includ spinorbit coupl pt pseudopotenti use exampl initi gener two nonloc projector dirac wave function jl jl use vanderbilt gener norm conserv give much greater accuraci bloechl construct discuss abovecitehamann weight sum differ nonloc oper separ rediagon produc effici orthonorm projector scalarrelativist spinorbit term requir intern abinit detail descript projector see ref oper sr term spinor wave function straightforward gener sum fkbnlm ekbnl fkbnlm nlm fkb ekb appropri reinterpret sinc fkb pt exampl orthonorm ekb dimens energi projector neglig small energi e ha present neglect full flexibl use method gener sr term descript design new yamlbas test suit author tc mg yamlbas test design principl implement detail document discuss new yamlbas format use repres physic result main output file connect abinit test suit yaml syntax use defin toler paramet constraint also discuss new infrastructur consist set fortran modul output structur data yaml format python code pars output file analyz data motiv abinitv previou version abinit test suit base input file associ refer output file roughli speak automat test consist compar refer file output file lineori fashion comput differ floatingpoint number without knowledg mean import numer valu approach rigid rather limit oblig develop use singl usual larg toler account possibl larg fluctuat intermedi result wherea toler criteria ideal appli final result hope independ detail hardwar optim level parallel limit clearli seen compar result iter algorithm number iter requir converg inde may depend sever factor especi input paramet far converg differ parallel scheme stochast method use point view code valid realli matter final converg valu plu time solut perform end concern unfortun linebylin comparison algorithm miser fail condit continu insist number iter line two calcul consid test succeed therefor clear approach use far valid new develop abinit abl cope challeng pose highperform comput smarter flexibl approach need address limit ideal would like abl use differ toler particular quantiti select keyword abl replac check absolut rel differ threshold check quantiti smaller give threshold sort syntax appli differ rule depend iter state eg dataset index execut python code callback oper data perform advanc test requir sort postprocess provid easytous declar interfac allow develop defin logic compar select quantiti follow present new infrastructur design principl step requir defin yamlbas test goal project provid abinit develop reusabl tool implement physicsawar test physicsawar intend test develop custom toler logic use compar numer result thank fact new parser awar context mean numer valu extract output file new infrastructur consist set fortran modul output structur data yaml format well python code pars output file analyz data one goal project implement new pythonbas infrastructur allow develop implement rigor test portabl import physic quantiti ignor intermedi result goal achiev provid declar interfac allow develop defin logic use compar select physic quantiti also provid declar api check result comput abinitio code satisfi fundament physic mathemat rule energi conserv newton third law symmetri properti etc quit simpl sound especi one goal minim amount code work requir express logic therefor basic rule design principl abinit develop awar order take fulli advantag new infrastructur follow briefli describ philosophi employ implement yamlbas test suit syntax use defin test modif requir extend framework import new yamlbas testsuit reli librari provid python standard librari instal depend user mode use pip instal numpi pyyaml panda user depend avail new test system disabl warn messag print termin implement detail reason clear later implement smart algorithm requir metadata context word python code need basic understand mean numer valu extract output file must abl locat particular properti name posit insid output file reason import physic result written main output file ab_out use machineread yamlhttpsenwikipediaorgwikiyaml document yaml document start three hyphen follow option tag begin exclam mark eg etot three period signal end document follow rule one easili write dictionari contain differ contribut total free energi use yaml energyterm comment compon total free energi hartre kinet e hartre e xc e ewald energi e psp_core e local_psp e spherical_term e intern e ktentropi e total_energi e total_energy_ev e detail mean tag label connect test infrastructur given section time suffici say opt yaml humanread data serial languag alreadi use log file record import event warn error comment inde protocol employ abipi monitor statu abinit calcul mani program languag includ python provid support yaml henc rel easi implement post process tool base wellestablish python librari scientif comput numpi scipi matplotlib panda last least write yaml fortran repres insurmount problem provid one keep complex yaml document reason level fortran implement inde support subset yaml specif scalar array one two dimens dictionari map string scalar tabl csv format extens standard import yaml design handl larg amount data therefor use repres larg array perform critic humanread lost definit realli consid yaml list one thousand number humanread follow philosophi yaml suppos use print import result main output file consid replac binari netcdf file come store larg data structur lot metadata note also plan rewrit entir main output file yaml syntax prefer focu physic properti use new test procedur valid new develop approach inde facilit migrat new yamlbas approach select portion output file port new format thu maintain look feel rel close previou unstructur format tutori mainli focu user interfac ie syntax use defin yamlbas test technic detail relat intern implement see yaml configur file activ yaml mode paramet govern execut test specifi test_info section locat end input file option given ini file formathttpsenwikipediaorgwikiini_fil integr new yamlbas test preexist infrastructur obtain via two modif current specif specif files_to_test section accept option argument use_yaml allow valu ye activ yaml mode use yaml mode default use yaml mode deactiv legaci fldiff algorithm new option section yaml_test ad section contain two mutual exclus field file path yaml configur file path rel input file natur choic would use prefix input file eg tyaml configur file associ input file tin test multilin string yaml specif option may use realli short configur heavili reli default valu exampl test_info section activ yaml mode found testparal_ sh begin test_info setup execut abinit file psp_file vpaw srpaw opaw paral_info nprocs_to_test max_nproc ncpu_ files_to_test t_mpiout use_yaml ye tolnlin tolab e tolrel fld_option easi extra_info author b amadon cavignac keyword dmft fails_ifmpi descript dftdmft srvo use hubard code kgb parallel topic dmft parallel yaml_test file tyaml end test_info associ yaml configur file given dialog testsparalinputtyaml first exampl yaml configur file let us start minimalist exampl compar compon total free energi etot document absolut toler e ha yaml configur file look like yaml etot tol_ab e tol_ab keyword defin constraint appli children etot document word entri etot dictionari compar absolut toler e default valu rel differ tol_rel toler explicitli specifi order pass test absolut differ must smaller tol_ab condit fulfil test fail python list entri pass test howev case would like specifi differ toler particular entri instead reli global toler etot document exampl contain total energi ev total energi ev entri use differ absolut toler properti special rule syntax sinc unit differ absolut toler impact precis want achiev rel precis term achiev absolut precis though special rule use tol_rel constraint could someth like yaml etot tol_ab e total energi ev tol_rel e howev tol_ab constraint defin etot _inherited_ total energi ev mean comparison perform rel toler tol_rel e absolut toler tol_ab e time need even though use differ toler tol_ab total energi ev yaml etot tol_ab e total energi ev tol_ab e achiev rel precis test fail looser absolut precis total energi ev chang default valu rel differ suffici specifi constraint outsid document yaml tol_rel e etot tol_ab e total energi ev tol_ab e basic concept previou section present minim exampl configur file next paragraph discuss detail implement advanc test proceed exampl need introduc basic terminolog facilit discuss explain build test specif go stepbystep definit testparal_ first introduc import concept document tree yaml document dictionari treat tree whose node label leaf scalar special data structur identifi tag note howev tag mark leaf toplevel node yaml document label name tag config tree yaml configur also take form tree node special leaf repres paramet constraint structur match structur document tree thu one defin rule constraint paramet appli specif part document tree special rule defin special appli match node document tree children constraint constraint condit one impos test succeed constraint appli leaf document tree node depend natur constraint paramet paramet valu use constraint modifi behavior iter state iter state describ mani iter possibl level present run eg idtset itimimag use imag time use give inform current state run document implicitli associ iter state inform made avail test engin special yaml document iterstart tag tip get list constraint paramet run abinitteststesttoolspi explor type show type exampl show tol_eq learn specif constraint paramet convent document write data document tag uniqu identifi scale _iter state_ also describ structur document like use tag case identifi document comment field option recommend especi purpos document obviou complic exampl etot document simplest possibl document contain field real valu look resultsg document repres result store correspond fortran datatyp use abinit yaml document given yaml resultsg comment summari ground state result natom nsppol cut ecut e pawecutdg e converg delta e re e residm e diffor e etot e entropi e fermi e stress tensor tensor e e e e e e e e e cartesian forc cartforc e e e e e e e e e e e e e e e yaml document complic contain scalar field dictionari even array mg integ valu alway compar without toler still parser abl locat entir document via taglabel address entri name specifi toler rel differ scalar quantiti resultsg add new entri yaml configur file similarli energyterm yaml energyterm tol_ab e total_energy_ev tol_ab e tol_rel e resultsg tol_rel e point precis implicit toplevel set appli quantiti subject specif rule exampl exampl resultsg subject default absolut toler wherea default rel toler overridden simplic sake write resultsg part next exampl unfortun strict valu tol_rel becom problemat compar residu store converg dictionari case make sens check residu certain threshold ceil constraint yaml resultsg tol_rel e converg ceil e test fail one compon converg dictionari e note ceil constraint automat disabl check tol_rel tol_ab insid converg word scalar entri resultsg compar tol_rel default tol_ab wherea entri converg dictionari test ceil tip within explor shell show ceil list constraint disabl use ceil _exclude_ field focus scalar quantiti concept rel absolut differ unambigu defin compar vector matric field tensorcart tag leaf tree tester routin wont tri compar individu coeffici tol_rel howev still want check chang much purpos use tol_vec constraint appli array deriv basearray array tag basearray let us use capabl numpi array yaml defin array tol_vec check euclidean distanc refer output array sinc also want appli constraint cartesian_forc defin constraint top level resultsg yaml resultsg tol_rel e tol_vec e converg ceil e use filter select document iter state thank syntax present previou section one custom toler differ document differ entri note howev rule appli document found output file mean implicitli assum differ step calcul similar numer stabil howev case result particular dataset less numer stabl other exampl help clarifi test testparal_ use two dataset perform two differ comput first dataset comput dft densiti lda second dataset use lda densiti perform dmft comput entir calcul suppos take less minut henc input paramet sever converg numer nois propag quickli differ step consequ one expect dfmt result numer stabil lda part fortun one use filter specifi differ converg criteria two dataset filter mechan allow one associ specif configur set iter state filter defin separ section configur file node filter let declar two filter syntax yaml filter ks dtset dmft dtset simpli say want associ label ks document creat first dataset label dmft document creat second dataset chose name ks dmft absolut arbitrari pick anyth make sens test simplest filter declar possibl see herefiltersapi info filter declar use filter first associ configur alreadi wrote ks filter differ configur second dataset yaml file read yaml filter ks dtset dmft dtset ks energyterm tol_ab e total_energy_ev tol_ab e tol_rel e resultsg tol_rel e tol_vec e converg ceil e insert configur option ks node specifi rule appli first dataset creat new dmft node creat configur follow procedur end someth like yaml filter ks dtset dmft dtset ks energyterm tol_ab e total_energy_ev tol_ab e tol_rel e resultsg tol_rel e tol_vec e converg ceil e dmft tol_ab e tol_rel e resultsg converg ceil e diffor ignor true fermi tol_ab e tol_rel e stress tensor ignor true energyterm total_energy_ev tol_ab e tol_rel e energytermsdc tol_ab e total_energy_dc_ev tol_ab e tol_rel e filter api filter provid practic way specifi differ configur differ state iter without rewrit everyth scratch filter declar filter specifi current known iter dtset timimag imag time iter set integ defin three differ method singl integ valu eg dtset yaml list valu eg dtset map option member specifi boundari includ integ interv eg dtset omit default omit default upper boundari tip order never relev pars yaml unless write list cours consequ defin filter wherev want file filter overlap sever filter appli document even overlap note howev overlap filter must trivial order specif word one filter must subset one exampl ok _f_ includ _f_ ie specif yaml fine filter f dtset imag f dtset imag wherea second exampl rais error _f_ includ _f_ yaml rais error filter f dtset imag f dtset imag test defin default tree overridden userdefin tree filter tree use overrid less specif tree tree sequenti appli tree gener specif one overrid process often use though import know work default explicitli specifi file overridden mean constraint defin deeper level default tree done new tree origin constraint kept exampl let f f two filter f includ f yaml filter f dtset f dtset imag f resultsg tol_ab e converg ceil e diffor e f resultsg tol_rel e converg ceil e tester reach fifth imag first dataset config tree use follow yaml resultsg tol_ab e come applic f tol_rel e append without modifi anyth els appl f converg ceil e one overridden diffor e one kept behavior need use hard reset marker append name special want overrid complet replac let f tree yaml f resultsg converg ceil e result tree fifth imag first dataset yaml resultsg tol_ab e converg whole converg node overriden ceil e tip explor shell could great help know inherit tree overridden use equat callback equat callback special constraint actual effect defin directli configur file introduc increas flexibl configur file without chang python code equat take string input string interpret python express must return number absolut valu number compar valu tol_eq paramet tol_eq greater test succeed express also result numpi array case return valu euclidean norm array compar tol_eq valu minim exampl yaml energyterm tol_eq e equat thisetot thistot energyev equat work exactli list string valu string differ express test independ other case test object refer refer object refer ref callback requir bit python code sinc invok method structur suppos tag atomspe associ document class atomspe atomspe class method not_going_anywher check atom go tri leav box would like pass kind toler d_min minim distanc atom approach border box signatur method not_going_anywhereself test d_mindefault_valu return true fals instanc faildetail see __add new constraint__ explan note self refer instanc use follow configur yaml atomspe callback method not_going_anywher d_min e command line interfac abinitteststesttoolspi script provid command line interfac facilit creation new test explor yaml configur file syntax testtoolspi command option run script without argument get list possibl command use testtoolspi command help display option support command list avail command fldiff interfac fldiffpi modul command use compar output refer file without execut abinit also possibl specifi yaml configur file yamlconf option one employ paramet use runtestspi explor command allow user explor valid yaml configur file provid shell like interfac user explor tree defin configur file print constraint also provid document constraint paramet via show command inform format pseudopotenti format abinit pseudopotenti allow use pseudopotenti gener fhipp code fritzhaberinstitut berlin code avail urlhttpwwwfhiberlinmpgdethfhimdfhipp line must ad file gener fhipp code describ present file abinitv abl read format pseudopotenti file without core correct abinitv abl read core correct thank af origin cpi file suppos user abl gener cpi file fhipp code one file abinittestspsps_for_test directori name al_hcpi fhipp code gener file name alhcpi name chang allow portabl doswindow begin e e e e e e e e e e e e e e e e e e e e e e e e e e e e e number make direct use first line ie number valenc electron e number pseudopotenti compon first th line ie number mesh point new file purpos gener correspond file readabl abinit also found abinittestspsps_for_test directori name alfhi follow seven line ad begin al_hcpi file aluminum fhipp hamanntyp lda ca perdewwang l local zatomzionpspdat pspcodpspxclmaxllocmmaxrwel rchrg fchrg qchrg two line avail give inform later follow cpi file fhipp code similar line must ad begin cpi file order make readabl abinit line simpli header might includ inform print without modif output abinit line describ atom number zatom ionic charg zion number valenc electron date pseudopotenti gener two first inform crucial third one realli import atom number hydrogen oxygen ionic charg number first number mention cpi file call number valenc electron line describ format pseudopotenti pspcod must format xc function use gener pseudopotenti pspxc number input variabl ixc use see abinitdocusersabinit_helphtml maxim angular momentum wavefunct describ pseudopotenti file lmax swavefunct present lmax p wf lmax p wf lmax must equal number pseudopotenti compon mention cpi file second number first line angular momentum potenti use local pseudopotenti lloc spotenti local lloc ppotenti local number radial mesh point mmax mean cpi file first number th line last number set line describ paramet need read model corecharg core correct need rchrg radiu core charg vanish ie cutoff au fchrg amplitud core charg non corecorrect perform corecorrect appli specif valu fchrg physic mean fhipp scheme core correct qchrg integr model core charg actual use abinit set valu rchrg infer pp file inde pp gener corecorrect option end cpi file immax radi fi fi fi end radial grid core charg f firstf second f deriv radial mesh rchrg equal valu radi ff f reason vanish line interest pseudopotenti format treat routin pspinf call psplof local part pspnlf nonloc part psplof pspnlf integr vrzionr r psplof perform highest allow radiu usual au except beyond au valu absvr larger toler allow cut spuriou behaviour pseudopotenti whose data file written singl precis author mg xg howto guid develop page intend quick refer solv problem commonli encount develop within abinit project gener configur script via makemak abinit use standard configur make approachhttpsthoughtbotcomblogthemagicbehindconfiguremakemakeinstal build sourc note howev development version contain configur script gener configur script file requir build system need execut makemak cd abinit configscriptsmakemak makemak requir recent version python interpret well mhttpswwwgnuorgsoftwarem autoconfhttpswwwgnuorgsoftwareautoconf automakehttpswwwgnuorgsoftwareautomak tool instal machin need compil sourc use prefer packag manag instal usual use condahttpsdocscondaioenlatest packag manag conda instal autoconf automak c condaforg import rememb run makemak everi time addremov fortran file new directori chang part buildsystem ie file abinitconfig build abinit develop invit build execut insid build directori ie directori separ sourc tree order keep sourc directori clean possibl allow multipl build usual use name scheme _build_compiler_nam build directori extern file eg gccac store configur option pass configur via withconfigfil option sh mkdir _build_gcc cd _build_gcc configur withconfigfilegccac make j use process compil note name option configfil normal form remov initi name option replac underscor _ everywher instanc withmpiprefix normal form becom with_mpi_prefix exampl configur file cluster found abiconfig packagehttpsgithubcomabinitabiconfig detail descript configur option support build system given guid marc emb srchttpsschoolabinitorgimageslecturesabischool_installing_abinit_lecturepdf typeapplicationpdf width heightpx build complet good idea check whether execut work expect run test v directori sh cd test testsruntestspi v j usual use testsruntestspi help list avail option detail discuss given pagedeveloperstestsuite_howto asciicasthttpsasciinemaorgapnghttpsasciinemaorga tip rememb run test frequent possibl develop new featur order spot possibl regress incompat trust save lot time run runtestspi systemat brows sourc file html document gener robodoc avail pagehttpswwwabinitorgsitesdefaultfilesrobodochtmlmasterindexhtml need tool navig abinit code insid editor would sugest exuberantctagshttpctagssourceforgenet gener tag file contain list procedur modul datatyp file insid abinitsrc use cd abinitsrc ctag r possibl open file contain declar dataset_typ fortran datatyp directli termin vi dataset_typ insid editor go directli tag definit enter follow vim command mode tag dataset_typ tip vim user avail herehttpsandrewstwrtcapostsvimctag emac see pagehttpswwwemacswikiorgemacsemacstag final one use abisrcpi script abinit directori todo debug gdb load execut gnu debugg use syntax gdb path_to_abinit_execut run code gdb run command redirect standard input gdb run runfil wait error eg sigsegv print backtrac gdb bt tip rememb compil code g option avoid debug code compil tricki case may need resort use fortran print statement avoid miscompil complet introduct gdb suggest youtub tutori ifram width height srchttpswwwyoutubecomembedbwhnlvf framebord allowacceleromet autoplay encryptedmedia gyroscop pictureinpictur allowfullscreenifram use lldb lldb src_mainabinit lldb target creat src_mainabinit current execut set src_mainabinit x_ lldb set set targetinputpath tin lldb run basic convent fortran procedur declar modul import client code use statement modul name usual start m_ cpp macro standard import lowlevel code locat lowlevel directori avoid cyclic depend insid directori use lot cpp macro defin abi_commonh wrap basic fortran statement pleas familiar definit abi_commonh particular never ever use fortran stop abort handl error msg_errormsg msg_bugmsg return exit statu lowlevel procedur let caller handler error use call wrtoutunit instead print write use abi_mallocarray instead allocatedarray use abi_freearray dealloc memori abi_sfre variant need check alloc statu import abinit use special logic track fortran alloc dealloc order spot possibl memori leak add new fortran file creat f modul git add regist f file abinitsrc file avoid duplic name public api abisrcpi complain rerun makemak sourc directori rerun configur make build directori possibl make clean make add new abinit input variabl section document procedur requir add new abinit input variabl make thing simpl possibl ignor complic case dimens nkpt nsym whose valu may depend dataset add new variabl follow step add new variabl dataset_typ rememb name end digit enter conflict multidataset syntax default valu new input variabl specifi two differ way declar fortran type size known compil time initi valu depend variabl indefo routin valu must comput runtim add name new variabl chkvar add new section dtset_copi copi new variabl use alloc_copi allocat need allocat entiti rememb dealloc memori dtset_fre read variabl invar basic dimens chang one outvar routin outvar_a_h outvar_i_n outvar_o_z print variabl accord first letter new variabl logic check consist input variabl goe chkinp use routin chkint_eq chkint_n chkint_g chkint_l chkdpr add document new variabl abinitabimkdocsvariables_codepi follow instruct given sectiondevelopersabimkdocshowtoaddmodifyaninputvari final make clean make j sinc broke abihttpsenwikipediaorgwikiapplication_binary_interfac public datastructur object file depend datastructur must recompil develop librari releas new major version typo abi api two differ concept answer stackoverflowhttpsstackoverflowcomquestionswhatisanapplicationbinaryinterfaceabi expand say bit data structur field bit field alreadycompil code use data structur access field follow correctli access data structur member get convert memori address offset compil data structur chang offset point code expect point result unpredict best treatment dimens see invar invarsm add new test test suit follow inform complement testsuit documentationdeveloperstestsuite_howto order introduc test one need provid new input file eg testsvinput modifi exist one possibl anoth directori pleas suppress exist capabl test provid new refer file correspond testsvref insert test list test done ad name testsv__init__pi document test ad comment section insid input file edit exist input file follow style declar pseudopotenti flow action file analyz toler test insid document toler start tolnlin tolab e tolrel e differ field control strictli test result analys maximum float point differ found must less tolab maximum rel differ less tolrel line individu tolnlin maxim number line found differ output refer file within anoth toler tune option optmedium opteasi optridicul see ad section input file procedur fail contact code maintain order adjust test case might mean modifi toler file unless realli expert let maintain final adjust import pleas tri keep prefer total time per test case less second second maximum test case go need except reason suppos introduc new test case use test abinit test suit differ channel test trigger test farm web page local machin whole set sequenti test particular test seri test trigger issu abinittest directori command runtestspi see mani capabl script issu runtestspi help set calcul trigger describ issu make help result appear new subdirectori test_suit last least sure modif deterior perform code regim modif use inspect modif memori use cpu time code coverag comput scienc code coveragehttpenwikipediaorgwikicode_coverag measur use describ degre sourc code program test particular test suit program high code coverag thoroughli test lower chanc contain softwar bug program low code coverag mani differ metric use calcul code coverag basic percent program subroutin percent program statement call execut test suit aim test suit cover function abinit trigger coverag report one slave dedic ondemand execut branch develop produc code coverag report present higgs_gnu__cov launch gener ondemand interfacehttpsbbportalabinitorg contact jeanmichel xavier yet access code coverag report recent run test avail herehttpcoverageabinitorg see part code well test pleas contribut improv coverag write new test info work abinit built special option everi function execut program map back function point sourc code gcno file gener sourc file compil gcc ftestcoverag option contain inform reconstruct basic block graph assign sourc line number block info avail gvoc pagehttpsgccgnuorgonlinedocsgccgccindexhtmltocgcovatestcoverageprogram gcda file gener program contain object file built gcc fprofilearc option execut separ gcda file creat object file compil option contain arc transit count summari inform final use lcovhttpltpsourceforgenetcoveragelcovphp analyz gcda file gener html report includ docdevelopersrobodocdoctxt includ docdevelopersdebug_make_par includ docdevelopersdebug_make_abiauti author jb document xg_t xgblock_t abinit written updat introduct motiv last decad comput precis processor evolv lot answer issu renew new set function written eas adapt abinit new architectur abstract layer still prototyp proof concept true librari written orient object way allow switch runtim differ librari acceler current state code stabl design array complex real fortran compliant without oop list memori manag alloc memori free memori block subblock map object alreadi alloc memori space get fortran array object getset valu fromto fortran array copi object one pack matrix upperlow triangular matrix reshap bla oper potrf trsm gemm add scale lapack oper heev heevd hpev hpevd hegv hegvx hpgvx hpgvd scalapack pheev phegv custom extens array shift colwis norm colwis yax set set ident set diagon set diagon zero offdiagon term get averag get deviat print tool get size get space function explain detail memori manag section two type explain first one xg_t alloc memori wherea second one xgblock_t work alreadi alloc object pointer find way thing fortran cours c type would alloc memori creat new xg_t one declar xg_t alloc memori xg_init function fortran typexg_t xg call xg_initxgspacerowscolscomm space either space_c space_r space_cr space_c true complex number space_r real number taken real part complex number wherea space_cr consid real imaginari part complex number independ real number differ space_r space_cr visibl get set valu see getset valu section detail row would number row consid col number column comm option use reduct need algebra oper even scalapack avail free memori need array anymor need memori anymor free xg_free fortran call xg_freexg block sub block may happen want work full array part array main motiv introduc block notion block part array work main thing rememb block work alreadi alloc memori therefor check alloc free block fortran type object xgblock_t creat fortran typexgblock_t xgblocka basic main object use even creat xg_t object alloc memori work xg_t rather block access xgself xgself type xgblock_t repres full array alloc work subarray need xgblock_t object build xg_setblock function fortran typexg_txg typexgblock_txgblocka call xg_initxgspace_cmaxrowsmaxcol call xg_setblockxgxgblockafirstcolumnrowscol xgblocka repres subarray xg start first column firstcolumn first one xg row row col column map object alreadi alloc memori space usual fortran array may want plug xgblock_t vice versa xgblock_t object want get fortran array variabl achiev oper call map revers map fortran array xgblock_t map regular cpu free alloc memori transfer noth keep mind xgblock_t repres array gpu coprocessor unit alloc memori transfer fortran doubl precis array typexgblock_t xgblocka array repres complex number complex number call xgblock_mapxgblockaarrayspace_crowscolscomm array repres real number real number space_cr call xgblock_mapxgblockaarrayspace_crrowscolscomm row col number row column represent insid xgblock_t take account space regardless space chose rowcol size element exampl array fortran c e g k q b f h j l n p r fortran call xgblock_mapxgblockaarrayspace_ccomm give ab kl cd mn ef op gh qr ij st ab complex number posit fortran call xgblock_mapxgblockaarrayspace_crcomm give f b g c h e j real number posit get fortran array object xgblock_t fortran array revers map exactli opposit oper map fortran doubl precis array typexgblock_t xgblocka array repres complex number take first complex number call xgblock_reversemapxgblockaarrayrowscol array repres real number real number space_cr put array call xgblock_reversemapxgblockaarrayrowscol care work complex array complex number one row complex number exampl xgblock_t complex ab kl cd mn ef op gh qr ij st fortran call xgblock_reversemapxgblockaarray give c e g k q b f h j l n p r xgblock_t real f b g c h e j fortran call xgblock_reversemapxgblockaarray give c e g b f h j fortran call xgblock_reversemapxgblockaarray give b c e f g h j access space xgblock_t dimens fortran depend version spacexgblocka space getspacexgblocka depend version colsxgblocka col getcolsxgblock next version getrowsxgblocka function call xgblock_getsizexgblockrowscol getset valu fromto fortran array old function use much map revers map process copi valu fortran array xgblock_t vice versa import take care declar space xgblock_t furthermor abinit complianc fortran array alway array first dimens equal doubl precis array settergett exist xg_t xgblock_t xgblock_t version follow fortran doubl precis array typexgblock_t xgblocka manag memori call xgblock_setxgblockaarrayshiftcolrow let say array c e g k q b f h j l n p r shiftcol row result array xgblocka space_c xxxxx ab kl xxxxx cd mn xxxxx ef op xxxxx gh qr xxxxx ij st space_cr set row complex number row real xxxxx b xxxxx c xxxxx e f xxxxx g h xxxxx j xxxxx k l xxxxx n xxxxx p xxxxx q r xxxxx clear first half column real part second half part imaginari part absolut import sinc decoupl space_r take real part number actual row xxxxx k xxxxx c xxxxx e xxxxx g q xxxxx getter work revers set oper copi object one want copi xgblock_t one use function bla copi function specifi increment object fortran call xgblock_copyxgblockaxgblockbincinc copi xgblocka increment inc xgblockb increment inc pack matrix upperlow triangular matrix pack useful intent use lapack function need pack upper lower triangular pack implement fortran call xgblock_packxgblockaxgblockbuplo xgblocka pack xgblockb accord valu uplo l l lower pack u u upper pack see bla document explan reshap tool shape block chang fortran call xgblock_reshapexgblockanewshap newshap valu array first one number row second one number column present tool alloc free manag memori block next part focu bla function eas use compar bare bla function bla oper bla function input variabl name ident real bla call miss argument need librari pleas refer bla document netlib documentationhttpwwwnetliborglapackexplorehtmldir_ffcaefeffbadhtml potrf trsm gemm add scale lapack oper lapack function input variabl name ident real lapack call miss argument need librari pleas refer bla document netlib documentationhttpwwwnetliborglapackexplorehtmldfdagroup__complex_h_eeigenhtml heev heevd hpev hpevd hegv hegvx hpgvx hpgvd scalapack warn present time none scalapack implement thread safe elpa work requir mpi_thread_multipl work yet avail architectur test secur scalapackelpa disabl runtim thread _______________________________ use scalapack function one check possibl event effici xgscalapack_init function design purpos similar alreadi done old implement flexibl way fortran use m_xgscalapack typexgscalapack_t xgscalapack integ comm integ maxdim integ verbos logic usabl call xgscalapack_initxgscalapackcommmaxdimverbosityus comm mpi commun use note process avail use maxdim maximum dimens matrix use xgscalapack object verbos posit valu noth print posit number process insid commun comm display configur number processu select must invok function xgscalapack_config call xgscalapack_init fortran call xgscalapack_configconfigrankpp config one slk_autoslk_dis posit valu posit valu forc scalapack use exactli config process slk_auto mode maxdim drive number process use fli basic maximum size matrix process hold instanc full matrix x maxdim scalapack use process configslk_dis scalapack use usabl set fals addit matrix small respect configur moddul usabl set fals usabl set true scalapack use case subcomminc creat xgscalapack object forget call xgscalapack_freexgscalapack free memori destroy commun thread usabl alway set fals call follow function usablefals test crash think give trash result pheev equival heev solv matrixaxeigenvaluesx fortran call xgscalapack_heevxgscalapackmatrixaeigenvalu xgscalapack previous initi xgscalapac_t object matrixa matrix diagon eigenvalu eigenvalu eigenvector place matrixa end phegv equival hegv solv matrixaxeigenvaluesmatrixbx fortran call xgscalapack_hegvxgscalapackmatrixamatrixbeigenvalu eigenvector place matrixa end custom extens array shift function standard fortran cshift function interfac fortran integ nshift integ shiftdim call xgblock_cshiftxgblocknshiftshiftdim nshift shift perform along shiftdim dimens see fortran document inform colwis norm function useful comput squar l norm mean dot product column function also provid inform min max present fortran call xgblock_colwisenormxgblockdotmax_valmax_eltmin_valmin_elt dot result dot product bla call column xgblock therefor dot space_r column vector xgblockcol row max_val min_val maxim minim valu dot vector max_elt min_elt indic maxim minim valu variabl option colwis yax colwis oper done done column column use function comput residu eigen problem let suppos solv hxex hxebx call function comput hxex hxebx eigenvector matrix x fortran call xgblock_colwisecymaxxgblocka da xgblockbxgblockw oper xgblockai xgblockwidaixgblockbi da xgblock_t colum vector xgblockacol row exampl xgblocka hx xgblockw x bx da eigenvalu vector note function similar bla saxpi function last one use minu oper would requir array copi want avoid set nullifi set coeffici block fortran call xgblock_zeroxgblock set ident function set diagon one offdiagon coeffici modifi want build ident matrix first call xgblock_zero function fortran call xgblock_onexgblock set diagon impos diagon matrix fortran call xgblock_diagonalxgblockdiag diag type xgblock_t column vector diagon impos xgblock object set diagon zero offdiagon term keep diagon term set offdiagon term fortran call xgblock_diagonalonlyxgblock get averag comput averag full block fortran call xgblock_averagexgblockaverag averag result real number get deviat comput deviat full block fortran call xgblock_deviationxgblockdevi deviat result real number print obviou seem function print conveni way data insid block fortran call xgblock_printxgblockoutunit xgblock block print outunit unit number data written author mg xg howto use git gitlab server page intend quick refer git integr abinit project familiar git would strongli advis watch tutori ifram width height srchttpswwwyoutubecomembedhvsyszhr framebord allowacceleromet autoplay encryptedmedia gyroscop pictureinpictur allowfullscreenifram inform git pleas consult offici documentationhttpsgitscmcom tip access onlin help command use git command help see also page commonli use git tip trickshttpsgithubcomgittipstip next section explain configur git interoper abinit gitlab serverhttpsgitlababinitorg assum alreadi account intern gitlab server note account gitlabcom githubcom enough sinc run server need contact jeanmichel beuken account creat initi configur first time use git pleas set follow global paramet anyth els sh mkdir p homeconfiggit git config global usernam firstnam lastnam git config global useremail someonesomeserversomedomain git config global coreeditor my_preferred_editor git config global coreexcludesfil homeconfiggitignor git config global colorui auto git config global mergeconflictstyl diff replac firstnam lastnam someonesomeserversomedomain my_preferred_editor respect first name last name email address prefer editor abl push contribut abinit forg need add follow section sshconfig file host abinitforg hostnam gitlababinitorg user git serveraliveinterv compress ye one use abinitforg hostnam clone pull push repositori info pleas consult offici documentionhttpsgitlababinitorghelpsshreadmemd clone repositori execut git clone abinitforgedeveloperabinit develop must replac abinit forg login order avoid type password everi time issu command access gitlab introduc public key profil see httpsgitlababinitorgprofilekey local machin gener rsa ssh key without passphras sshkeygen rsa call id_rsa_gitlab add section sshconfig file host gitlab hostnam gitlababinitorg user git keepal ye identityfil sshid_rsa_gitlab final copi public key id_rsa_gitlabpub gitlab use local machin follow syntax git clone gitlabuser_idabinitgit instead git clone gitgitlababinitorguser_idabinitgit sure key propos time git call ssh use sshagent sshagent start agent provid process id execut line command sshagent propos eg ssh_auth_socktmpsshngserherkhsag export ssh_auth_sock ssh_agent_pid export ssh_agent_pid echo agent pid ssh add sshid_rsa_gitlab add correspond ssh key gitlab everi develop hisher specif gitlab user_id eg gonz addit virtual develop call trunk also defin standard name project id branch abinit gitlab server abinit project defin specif address color bluegitgitlababinitorgcolorcolor reduser_idcolorcolor blueabinitgitcolor order log httpsgitlababinitorg go explor project find trunk abinit perhap select click fork button need contact jeanmichel beuken access abinit gitlab order start work local abinit gitlab server machin setup ssh environ gitlab describ particular machin need ssh agent run rsa key alreadi avail git find run ssh default master branch develop branch repo also possibl creat work branch clone gitlab repositori local repositori recommend command git clone gitlabuser_idabinitgit b develop user_id replac adequ name addit explan normal clone command gitlab repositori hisher gitlab repositori hisher local machin git clone gitgitlababinitorguser_idabinitgit howev proper ssh environ follow clone command use git clone gitlabuser_idabinitgit clone master usual work branch develop branch obtain directli abovement command modif use git command eg git add git commit push gitlab server thank git push add tag push tag order modif merg trunk merg request mr issu describ later might done branch creat local develop one use git branch another_branch git checkout another_branch push first time use git push u origin another_branch abl creat addit branch either local gitlab name choic import note accord gitflow branch modelhttpnviecompostsasuccessfulgitbranchingmodel master branch littl use physic develop includ develop releas branch quit import normal develop nutshel new develop alway merg trunkdevelop trunkmast contain stabl version final releas branch mainli use bug fix minor chang includ next releas httpsmiromediumcommaxyjyfyscwfuvrqnxbmapng git branch abinit git workflow order merg trunk branch ontrack explain later issu merg request gitlab usual trunkdevelop default branch push gitlab might test ondemand user branch ontrack succeed pass automat test consid merg case previous develop branch correspond develop stage releas branch correspond releas candid hotfix branch slightli simpler gitflow name scheme tip git philosophi branch often creat merg destroy develop encourag take advantag flexibl trigger action buildbot ondemand develop use ondemand form abinit buildbot portalhttpsbbportalabinitorg authentif made gitlab loginpassword one import featur taken account git commit character sha code hexadecim charact four first charact actual defin commit combin charact combin five first charact defin commit combin charact combin gitlab know repositori differ user exist branch well sha code commit three follow field must defin develop buildbot know revis abinit run user choos one exist user_id menu default valu user_id branch choos one exist user_id menu default valu develop commit develop enter free text first hexadecim charact sha code commit case differ commit user branch first charact last commit taken buildbot default valu last commit userbranch ontrack branch branch ontrack specif commit must contain histori branch specif commit creat trunkdevelop correspond releas new version necessarli public version releas branch ontrack specif commit must contain past histori branch also commit start next develop version present one among releas branch ontrack time note exampl suppos abinit vx want start prepar releas product new v develop branch entitl releas fork develop branch branch first commit releas branch tag start first commit develop branch tag start develop branch consid ontrack elig merg request commit tag start present releas branch consid ontrack elig merg request commit tag start present forbidden contain commit tag start complement start xyz version tag startxyz commit end xyz version abinit tag xyz shown buildbot statu tabl buildbot statu tablehttpsbbportalabinitorgstatu show summari recent result obtain test farm alll activ branch want see result select filter click updat button default select bot night set adequ merg request select capabl buildbot statu tabl rather extend play bit wit way behaviour buildbot statu tabl chang select still problem may hesit click updat button group button latter back forth sorri inconveni merg master branch done order develop incorpor merg request specif branch trunk branch merg request trunkdevelop branch list merg request avail herehttpsbbportalabinitorgmr howev releas branch readi merg merg request target correspond trunkreleasecolor branch master branch use trunk never issu merg request trunkmast suppos merg insid branch specif tag branch trunk order avoid diverg specif tag branch advertis mention earlier presenc tag commit allow one identifi whether branch ontrack automat test done synchron trunk order keep branch date trunk first regist gitgitlababinitorgtrunkabinitgit remot git remot add trunk gitlabtrunkabinitgit point one fetch branch trunk git fetch trunk develop branch updat suppos check merg trunkdevelop develop branch git checkout develop git merg trunk develop combin last two command one git pull trunk develop contrari new branch eg releas branch let say fix idea creat git branch releas start creat branch releas start tag git checkout releas git merg remotestrunkreleas git push u origin releas that make modif releas issu merg request trunkreleas addit info setup ssh environ clone repositori git track trunk clone repositori localhost git clone track trunk git remot add trunk show list remot branch git remot v merg develop branch trunk branch git checkout develop git pull trunk develop push gilab server git push origin develop tip access onlin help use git command help import gitflow alway send pull request trunkdevelop file contain inform use spinorbit format pspcod pseudopotenti first line contain haman grid paramet must complet inform spinorbit format pseudopotenti one replac e ral e ralpspso pspso non spinorbit option spinorbit next line describ number projector characterist must duplic soon l number projector must one replac leenprojrcpsp rmsekbekbepsatm leenprojrcpsp rmsekbekbepsatm leenprojrcpsp rmsekbekbepsatm leenprojrcpsp rmsekbekbepsatm leenprojrcpsp rmsekbekbepsatm leenprojrcpsp rmsekbekbepsatm leenprojrcpsp rmsekbekbepsatm leenprojrcpsp rmsekbekbepsatm pseudopotenti pseudowavefunct enter order p p f f local potenti specifi lloc follow valu lloc refer potenti lloc refer p potenti lloc refer potenti lloc refer f potenti lloc refer p potenti lloc refer potenti lloc refer f potenti inform format pseudopotenti format abinit pseudopotenti allow use pseudopotenti set lda pseudotenti whole period tabl build dc allan akhein gener accord troulliermartin techniqu see abinitdocusersbibliographyhtml correspond refer pspcod psp file format data file give potenti projector function real space radial grid firstli radial grid run index point grid point given follow equat given fortran nmax jnmax xdblejdblenmax rjdxdd enddo psp file consist number header line follow data radial grid header section follow titl singl charact line zatom zion pspdat pspcod pspxc lmax lloc mmax rwell l lmax follow line leenprojrcpsp rmsekbekbepsatm final one line rchrgfchrgqchrg data may locat anywher line long provid order indic read free format case si lmax header may look like follow line si fri oct zatom zion pspdat pspcodpspxclmaxllocmmaxrwel leenprojrcpsp rmsekbekbepsatm leenprojrcpsp rmsekbekbepsatm leenprojrcpsp rmsekbekbepsatm rchrgfchrgqchrg zatom atom number atom si zion number valenc electron si pspdat code revis date case pspcod anoth index describ code case pspxc index show choic exchangecorrel lmax highest angular momentum pseudopotenti defin also use local potenti lloc angular momentum use local potenti mmax number grid point rwell prefactor harmon well sometim use bind electron would otherwis unbound lda l angular momentum si case e planewav cutoff need converg within kinet energi atom variou number variou l e planewav cutoff need converg within kinet energi atom variou number variou l nproj number project function use l rcpsp pseudopotenti core radiu rm measur pseudopotenti qualiti reflect valu penalti function design potenti ekb ekb kleinmanbyland energi project function l epsatm integr int inf pirrvrzion rchrg core charg radiu addit core charg use match xc contribut hard matrix fchrg prefactor core charg express qchrg total integr core charg follow header l lmax pseudopotenti form titl line follow line data line contain three number radial grid valu given titl line give valu l first follow text case si eg l line l teter pseudopotenti follow line number give l potenti radial grid describ follow pseudopotenti first project function given l titl line follow data line follow first project function l second project function determin nproj follow second project function sever line addit data read plane_wav provid describ detail construct pseudopotenti omiss line affect run plane_wav time wish use core charg simpli set fchrg use rchrg qchrg wish make local potenti use lmaxlloc nproj need provid project function time valu rm ekb ekb epsatm e e use inform time may set creat pseudopotenti file rcpsp still use definit pseudopotenti core radiu must provid best understand data structur recommend studi sever pseudopotenti file compar content descript given insid abinit pseudopotenti format treat routin pspinf call psplof local part pspnlf nonloc part pspccf xc core correct matter numer accuraci note integr vrzionr r psplof perform highest allow radiu usual au without cutoff vrzionr tend rapidli zero larg radii beyond au correct behaviour enforc routin tail vr inaccur ie pseudopotenti singl precis larg inaccuraci integr r factor author mg xg page describ detail document system abinit contribut document written markdownhttpsenwikipediaorgwikimarkdown lightweight markup languag plain text format syntaxhttpsgithubcomadampmarkdownherewikimarkdowncheatsheet document includ user guid abinit tutori topic releas note well page input variablesvari bibliograph referencestheorybibliographi gener automat python inform report abinitmkdocsvariables_abinitpi similar file directori main execut bibtex entri given abinitdocabirefbib file websit automat gener mkdocshttpwwwmkdocsorg static site gener gear toward project document mkdoc employ pythonmarkdownhttpspypipythonorgpypimarkdown pars markdown document use singl yamlhttpenwikipediaorgwikiyaml configur file mkdocsyml defin organ page websit navig bar header footer gener automat framework use jinja templat enginehttpjinjapocooorg mkdoc includ coupl builtin theme well variou third parti theme easili custom extra css javascript overridden theme directori abinit websit use mkdocsmaterialhttpsquidfunkgithubiomkdocsmateri theme built use googl materi designhttpswwwgooglecomdesignspecmaterialdesign guidelin also use fontawesom iconshttpsfontawesomecom note major abinit develop need know use technolog sinc mainli interact markdown file plain text file easili modifi editor mkdoc mkdocsmateri handl htmlcssjavascript part addit basic markdown syntax abinit document support extens shortcut eas write hyperlink inclus bibliograph citat detail descript markdown dialect given markdown pagedevelopersmarkdown also mathjaxhttpswwwmathjaxorg equat latex activ specif usag abinit doc explain sectiondevelopersmarkdownmathjax net result abinit develop write nicelook document releas note without use html explicitli work environ wellintegr abinit ecosystem yaml databas input variabl test suit bibtex citat ad new content straightforward write new page markdown add new entri mkdocsyml final regener websit mkdoc get start make sure toplevel abinit directori instal python packag requir build websit use sh pip instal r requirementstxt user packag alreadi instal alreadi preexist instal need upgrad recent version add upgrad option u short sh pip instal r requirementstxt user u step may need version mkdoc mkdoc updat upstream trunkdevelop check version list requirementstxt note python requir entir document support unicod feel free use unicod symbol doc mkdoc come builtin devserv let preview document work first issu makemak actual configscriptsmakemak top abinit directori start custom server run mksitepi serv command sh mksitepi serv regener databas save databas usersgmatteogit_reposabidocsdocteststest_suitecpkl initi websit gener complet gener markdown file input variabl code abinit info build document info clean site directori server serv http handler start watch chang handler start detect chang open http browser youll see default home page display note gener websit take minut price must paid web server inde reload automat sourc file modifi user one easili chang document inspect chang correspond html file tip use mksitepi serv dirtyreload enabl live reload develop server rebuild file chang option design site develop purpos much faster default live reload warn server rebuild automat page gener chang md file one chang abinitdocabirefbib neither chang abinitabimkdocspi mean upgrad descript input variabl bibtex refer done close server reissu mksitepi command also case md file abinitdoctop directori similar md sourc file prepend underscor must preprocess mksitepi deliv md file without underscor live reload mksite serv build websit temporari directori need inspect html file produc script use mksitepi build html page avail site directori also possibl valid html document site use mksitepi valid command connect wc valid servicehttpsvalidatorworg possibl error print termin valid given list html file use mksitepi valid siteindexhtml sitevariablesindexhtml present v mani html file compliant strict html syntax procedur yet oper note html file produc temporari directori thu revis control real sourc repres md file yml file file chang develop therefor known git markdown page gener mksitepi automat list abinitdocgitignor thu ignor git abinitdocmksitepi script gener websit convert markdown file html script start creat python object use inform report python file abimkdoc input variabl abinitdocabirefbib list bibliograph refer input file contain abinittestsinput perform initi consist check gener markdown file variabl citat etc invok mkdoc pars markdown file declar mkdocsyml expand special string form span stylebackgroundcolor eeefonts namespacenamesectiontext span creat html link creat need hmtl file expans special string document link sectionmarkdownmdlink use yaml file mention equationsformula mathjaxhttpdocsmathjaxorgenlatestmathjaxhtml activ allow process visual latex formula see also sectionmarkdownmdmathjax detail write doc markdown file store insid doc directori accord follow structur consol doc css develop extra_javascript imag variabl test theori topic tutori guid file releas note licens css extra css file use websit develop document develop document howto git code rule extra_javascript extra javascript code use websit imag logo favicon variabl file input variabl automat gener test symbol link abinittest directori theori file theoret note topic file abinit topic tutori offici abinit tutori guid help file main execut directori ital mainli use build websit visibl outsid directori contain markdown file directori associ entri websit menu see page mkdocsyml page configurationhttpwwwmkdocsorguserguidewritingyourdoc mkdocsyml defin page built mkdoc appear document navig directori contain indexmd file suppos gener page overview topic treat directori indexmd file automat gener python eg variablesindexmd other tutorialindexmd make sure new document page properli mention link correspond indexmd file new page ad imag addit materi eg script associ markdown page store correspond asset directori whose name construct base name markdown page instanc figur use tutorialbsemd store tutorialbse_asset front matter front matter first section markdown file must take form valid yaml document enclos tripledash line basic exampl yaml titl document code like hacker author mg tripledash line set predefin variabl see refer even creat custom one variabl made avail framework instanc list author report html page footer titl ad html meta section document guid line paragraph name short enough fit nice menu also long enough stand reason extent titl set use navig menu page titl display browser tab page start paragraph explain cover first head page head markdown other h h necessari find want use h consid truli necessari dont use term like previou page etc may add rearrang page futur instead use hyperlink chapter also avoid sentenc like follow tutori go back tutori window number paragraph realli need link navig bar readabl besid number appear permalinkdevelopersmarkdownpermalink mean may need chang sever link decid add new section page later user may want share bookmark link abinit document broken link avoid much possibl fact wikilink syntaxdevelopersmarkdownwikilink facilit inclus hyperlink mean add link everywher especi true document input variabl make sens put link variabl describ link paragraph text uppercas significantli difficult read lower mix case text write cap like shout use cap sparingli addmodifi input variabl variabl given execut declar abinitabimkdocsvariables_codenamepi file consist list python dictionari dictionari contain declar singl variabl associ document markdown format wikilink latex markdown extens use insid text ad new variabl easi edit python modul add new item end list templat provid rememb escap charact python interpret may rais except start add latex equat document eg python error alpha unrecogn escap charact string start alpha solut simpl declar string raw string prepend r eg python textr spmeth input variabl defin method use calcul irreduc polariz chi_k note input variabl execut main abinit eg anaddb aim optic denot input_variable_nameexecut eg dipdipanaddb allow waiv ambigu eg dipdip input variabl use main abinit edit python modul must rerun mksite serv see chang import use pytest abimkdocs_teststest_variablespi valid chang rebuild document well present v script detect mani problem procedur use yet oper add bibliograph refer bibliograph refer must bibtex format provid enough inform python code gener appropri link websit central bibliographi databas present locat abinitdocabirefbib publish work doi strongli recommend avoid cutpast bibtex file central bibliographi databas inde unit test enforc presenc particular entri bibtex document bibtex may fulfil requir provid bibtex data publish site better method know doi articl also possibl use betterbibhttpsgithubcomnschloebetterbib fetch data crossrefhttpwwwcrossreforg produc bibtex entri betterbib avail python packag index simpli type pip instal betterbib use doibibtex command line text betterbibdoibibtex physrevlett articlebibtex author amadon b biermann georg aryasetiawan f doi physrevlett issn journal physic review letter month feb number publish american physic societi ap sourc crossref titl  transit cerium entropi driven url httpdxdoiorgphysrevlett volum year add entri bibtex file use firstauthoryear convent key make sure duplic entri note bibtex id must form firstauthornameyear eg amadon start uppercas letter lower case fourdigit year possibl letter might ad case ambigu eg exist also amadona build html page use mksitepi serv run test pytest abimkdocs_teststest_bibtexpi pytest valid chang order refer bibliographi entri use wikilink syntaxdevelopersmarkdownwikilink cite namespac topic topic file written markdown found abinitdoctop sourc file start underscor eg _abipymd templat file contain text two variabl relat input variabl related_vari select input file selected_input_fil fill mksitepi inspect databas variabl test test suit new markdown file without underscor gener includ mkdocsyml import develop suppos edit version underscor provid enough inform declar variabl test_info section mksitepi fill templat rememb restart mksitepi see chang add new document order add new tutori creat new markdown file doctutori regist mkdocsyml build html use mksitepi serv start enjoy markdown syntax organ help file theori document similar one tutori topic relev sinc begin abinit html document everi input variabl requir belong varset set variabl eg varba varfil howev start summer requir everi input variabl also mention least one document topic topic character relev allow list relev gener list irrespect topic declar abinitabimkdocsvariablespi standard name compulsori input variabl must present input file featur topic activ basic input variabl usual explicitli specifi standard usag although default might adequ use default valu use time expert expert user use valu default relev name allow specif topic classif compulsorybasicusefulexpert relev one order specifi possibl sever combin topicrelev input variabl attach field topic use insid abinitabimkdocsvariables_abinitpi file similar file directori execut exampl dmatpawu dftu_us mdwall moleculardynamics_expert gwpara parallelism_us gw_basic latter case one input variabl associ two topic differ relev topic parallel topic gw releas note releas note written markdown possibl use wikilink syntaxdevelopersmarkdownwikilink insert link new test new autoconf file even link pullrequest issu redirect reader abinit repositori github exampl follow markdown text md b implement algorithm interpol electron band structur see new input variabl einterp nkpath prteband new test testv_ testlibxc_ ad gitshafdbaedcadcfdfebcedd b ad subsuit syntax testgspw_ c new version fortran compil integr test farm intel gnu ibm xlf compil nag correspond exampl avail acabiref_nag__openmpiac produc nice report link featur avail new version b implement algorithm interpol electron band structur see new input variabl einterp nkpath prteband new test testv_ testlibxc_ ad gitshafdbaedcadcfdfebcedd b ad subsuit syntax testgspw_ c new version fortran compil integr test farm intel gnu ibm xlf compil nag correspond exampl avail acabiref_nag__openmpiac import alreadi use markdown gitlab document merg request mean easili integr gitlab document releas note publish websit variabl object type contain field abivarnam name variabl note name input variabl execut anaddb aim optic alway finish anaddb aim optic characterist possibl specif characterist input variabl chosen among name abinitdocinput_variablesorigin_filescharacteristicsyml commentdefault possibl comment default valu commentdim possibl comment dimens array defaultv must integ real valu possibl specifi use type present eg multiplevalu dimens either scalar list dimens use yml syntax exclud possibl exclud valu mnemon longer descript variabl role word requir input variabl relev condit fulfil text free text describ input variabl topic string specifi topics_and_relevancestopicsandrelev varset uniqu set variabl variabl belong chosen among name abinitdocinput_variablesorigin_filesvarsetsyml vartyp chosen among integ real string inform type specif variabl valu must null multiplevalu object equival x syntax abinit parser code x code becom yaml multiplevalu number x valu x null mean want rang object yaml rang start stop n default valu mean default valu n valuewithcondit object type allow specifi condit valu yaml valuewithcondit defaultv diemix iprcel iprcel diemix iscf diemix iprcel diemix defaultv default valu condit fulfil condit pleas use string basic express contain etc allow simpl pars convent use python way express use also span stylebackgroundcolor eeefonts varnam span exampl valuewithunit object type allow specifi valu unit yaml valuewithunit unit ev valu mean ev constraint variabl yml file via gui constraint variabl introduc specifi requir condit exclud condit yml file fill field requir exclud gui varnam requir condit mean variabl relev condit fulfil varnam exclud condit mean specif variabl input file forbid condit fulfil pay attent string recogn string directli dont need tick otherwis need put tick exampl want use link valu use link shortcut like span stylebackgroundcolor eeefonts abivarnam span see doc link shortcut link shortcutsmarkdownmdlink file contain inform format pspcod pspcod pseudopotenti pspcod correspond case teter pseudopotenti gener louvainlaneuv use code atom pspcod correspond phoney pseudopotenti built hamman grid stage juli possibl treat pseudopotenti version later howev one care format pseudopotenti inde read abinit code slightli modifi let take exampl explain modif pspcod case teter pseudopotenti exampl correspond lead old header xef p frcsrcdexncrcprcf chemhard ecut e zzionetotwrong iexcipsplmaxngrid e e rchrgfchrgqchrg new header readabl abinit xef p frcsrcdexncrcprcf chemhard ecut zatomzionpspdat pspcodpspxclmaxllocmmaxrwel leenprojrcpsp rmsekbekbepsatm leenprojrcpsp rmsekbekbepsatm leenprojrcpsp rmsekbekbepsatm leenprojrcpsp rmsekbekbepsatm rchrgfchrgqchrg header correspond exactli tm pseudoptenti pspcod addit new form teter pseudopotenti one indic number angular momentum set data correspond consid angular momentum allow clearer pseudopotenti file pspcod case phoney pseudopotenti exampl correspond oxygen old header compromis psp oxygen rc ec doubl refer e e new header readabl abinit compromis psp oxygen rc ec doubl refer zatomzionpspdat pspcodpspxclmaxllocmmaxrwel e e ral leenprojrcpsp rmsekbekbepsatm leenprojrcpsp rmsekbekbepsatm rchrgfchrgqchrg note header almost pspcod pspcod case differ lie presenc r al paramet defin hamman grid also indic addit number angular momentum set data correspond consid angular momentum insid abinit pseudopotenti format treat routin pspinf call psplof local part pspnlf nonloc part pspcc core correct matter numer accuraci note integr vrzionr r psplof perform highest allow radiu usual au without cutoff vrzionr tend rapidli zero larg radii beyond au correct behaviour enforc psplo tail vr inaccur ie pseudopotenti singl precis larg inaccuraci integr r factor contrast pseudopotenti format treat routin pspinf call psplof local part pspnlf nonloc part pspcc core correct integr vrzionr r psplof perform highest allow radiu usual au except beyond au valu absvr larger toler allow cut spuriou behaviour pseudopotenti whose data file written singl precis author mg xg plotli true write document page intend quick refer markdown syntax extens avail abinit document markdown use almost everywher user guid tutori releas note theori note descript input variabl store python file insid abimkdoc well test_info section automat test originaloffici markdown syntax ruleshttpsdaringfireballnetprojectsmarkdownsyntaxhtml nbsp state markdown syntax intend one purpos use format write web markdown replac html even close syntax small correspond small subset html tag idea creat syntax make easier insert html tag opinion html tag alreadi easi insert idea markdown make easi read write edit prose html publish format markdown write format thu markdown format syntax address issu convey plain text markup cover markdown syntax simpli use html basic markdown syntax alreadi cover need abinit extens wikilinkswikilink abinit extensionsabinitextens facilit integr document websit new develop done gitlab branch page exampl entir written markdown except last two section discuss advanc featur requir html code markdown quick refer inlin style markdown result extens requir ital ital bold bold bold ital bold ital monospac monospac strikethrough strikethrough tildehttpfacelessusergithubiopymdownextensionsextensionstild chchoh chchoh tildehttpsfacelessusergithubiopymdownextensionsextensionstild highlight highlight markhttpfacelessusergithubiopymdownextensionsextensionsmark underlin underlin carethttpsfacelessusergithubiopymdownextensionsextensionscaret markdown publish format provid way color text outofscop markdown possibl use raw html code exampl follow markdown text md markdown text span stylecolorredsom red textspan produc markdown text span stylecolorredsom red textspan complet introduct markdown pleas consult markdown cheatsheethttpsgithubcomadampmarkdownherewikimarkdowncheatsheet list unnumb list creat blank line follow star dash line list exampl blank line follow markdown text md list item list item b produc list item list item b number list start number instead star md list item list item produc list item list item code syntax highlight block code either fenc line three backtick indent four space exampl markdown text text fenc code three backtick around produc fenc code three backtick around indent code four space md abinit runabi log produc abinit runabi log fenc block altern form allow specif languag use syntax highlight fortran code exampl includ text fortran ii writehello world end display fortran ii writehello world end obtain inlin highlight simpli use backtick exampl text inlin code backtick around produc inlin code backtick around tabl creat tabl markdown use syntax md first header second header content cell content cell content cell content cell produc first header second header content cell content cell content cell content cell warn text insid colum contain pipe enclos backtick use pipe figur includ figur use standard markdown syntax md tutorialbse_assetstbs_png tutorialbse_assetstbs_png figur caption use markdownfigur extensionhttpsgithubcomheldercomarkdownfigur md tutorialbse_assetstbspng converg bse optic spectrum wrt kkpoint sampl see also ngkpt shiftk tutorialbse_assetstbspng converg bse optic spectrum wrt kkpoint sampl see also ngkpt shiftk caption contain latex equat well abinit wikilinkswikilink html img html figur element automat center via css direct declar extracss note two exampl locat png file given rel url rel page first exampl use rootrel url tutorialbse_assetstbs_png root correspond abinitdoc directori run webserv local abinit websit domain document serv internet second exampl use rel url rel page mkdoc convert markdown url rel url websit easili deploy concis explan absolut rel rootrel link given herehttpsmorcomhtmlbasicshyperlinksyntaxabsoluterelativeandrootrel need custom height width imag use md tutorialephmob_assetsworkflowpng styleheightpxwidthpx tutorialephmob_assetsworkflowpng styleheightpxwidthpx note standard markdown extens provid attribut list extensionhttpspythonmarkdowngithubioextensionsattr_list add syntax defin attribut variou html element markdown output pdf file link intern pdf file ship abinit document insert use base name pdf file wikilink syntaxwikilink pleas consult pdfhowto_chebfi document give pleas consult pdfhowto_chebfi document note pdf extens end file option recommend approach link pdf document descript input variabl tutori theori note hand may want display pdf file directli html page case use html emb element html emb srchowto_chebfipdf typeapplicationpdf width heightpx see automat gener pdf gallerytheorydocu exampl video link video includ standard markdown syntax md video give overwiew command line option runtestspi asciicasthttpsasciinemaorgapnghttpsasciinemaorga produc video give overwiew command line option runtestspi asciicasthttpsasciinemaorgapnghttpsasciinemaorga advanc featur video galleri requir bit htmlcssj code markdown page see exampl abinit video gallerytopicsexternal_resourcesabinitvideo built lightgalleryhttpsachinchoolurgithubiolightgalleri link markdown link creat link enclos link text bracket eg duck duck go follow immedi url parenthes eg httpsduckduckgocom altern one enclos url directli tabl show typic scenario markdown result duck duck gohttpsduckduckgocom duck duck gohttpsduckduckgocom httpswwwabinitorg httpswwwabinitorg link video section pagevideo link video section pagevideo note link extern websit signal fontawesomehttpfontawesomeio nbsp icon classfa faexternallink ariahiddentruei see css rule extracss markdown also use creat intern link page abinit websit main problem need know rel url rootrel url html page want refer unfortun easi sinc html page automat gener mksitepi mkdoc henc need understand tool work intern make thing even complic differ way achiev result rel url rootrel url mkdoc md syntax let tri clarifi point use pragmat approach first import understand mkdocsyml configur file use_directory_urlshttpswwwmkdocsorguserguideconfigurationuse_directory_url option set true mean mkdoc creat directori indexhtml file md page includ abinit document instanc abimkdocsmd markdownmd file locat abinitdocdevelop convert mkdoc follow hierarchi html file developersabimkdocsindexhtml developersmarkdownindexhtml content eg abimkdocsmd use gener abimkdocsindexhtml import exampl symbol correspond root filesystem root directori use webserv serv html file roughli speak abinitdoc directori consir root node use convent lead userfriendli url abimkdoc page serv local web server httpdevelopersabimkdoc instead lengthier httpdevelopersabimkdocshtml websit deploy product page serv httpsdocsabinitorgdevelopersabimkdoc instead httpsdocsabinitorgdevelopersabimkdocshtml point clear rel path see file system rel url seen webserv word add extra rel path file system account creation directori syntax clearli unintuit errorpron worth know especi reason need inject md page html code rel href fortun oblig use rel url markdown link sinc two approach much userfriendli much easier maintain first one base rootrel url second one reli preprocess oper perform mkdocshttpswwwmkdocsorguserguidewritingyourdocsinternallink brief rootrel url seen path rel abinitdoc directori provid add begin string mkdoc syntax activ use rel path seen file system crucial differ must includ md extens end url usual much easier explain differ case exampl markdown result link type mbpt documenttheorymbt mbpt documenttheorymbt rootrel url recommend mbpt documenttheorymbtmd mbpt documenttheorymbtmd mkdoc preprocess rel url topicsdevelopersabimkdocstop topicsdevelopersabimkdocstop rootrel html fragment recommend topicsabimkdocsmdtop topicsabimkdocsmdtop mkdoc preprocess rel url html fragment topicsabimkdocstop topicsabimkdocstop rel url mkdoc preprocess html fragment dont use import rel url obvious depend locat page conta link wherea rootrel url invari evid absolut filesystem depend path gmatteoabinitdoctheorymbt wont work websit deploy dont use point may ask differ approach one use write document make long stori short strongli suggest use rootrel url reason rootrel url look like absolut path one easili use regular express updat link everywher md page move around mkdoc syntax shorter refer anoth md page directori sinc abinit websit mani nest level rootrel url necessarili much longer mkdoc syntax mkdoc syntax advantag mkdoc immedi check whether intern url correct build web site matter fact perform similar check run linkcheck buildbot infrastructur mean use rootrel url doc mkdoc wont abl detect broken link work interact error automat detect test farm howev case would like even simpler syntax automat gener link within document particular link input variabl declar abimkdoc directori bibliograph citat declar abirefbib input file pseudopotenti use abinit test suit websit page commonli mention eg topicindextop page reason use extens apihttpspythonmarkdowngithubioextensionsapi nbsp provid python markdown extend syntax parser use wikilink syntax dont need know rootrel rel url html page want link typic case discuss next section wikilink wikilink syntaxhttpspythonmarkdowngithubioextensionswikilink nbsp use two pair squar bracket possibl separ simpl case give span stylebackgroundcolor eeefonts name span although gener form span stylebackgroundcolor eeefonts namespacenamesectiontext span namespac section text option case adequ separ mention namespac echo web page text given superced echo name web page see exampl warn use parenthes within pair doubl bracket whole express recogn intern link recogn wikilink string replac adequ html link coupl name immedi recogn name abinit input variabl eg ecut provid mention variables_abinitpi name bibliograph refer provid mention abirefbib path file one abinittestsinput directori path refer output file one abinitteststutoref directori label section insid file exampl markdown result ecut ecut abinitecut abinitecut anaddbdipdip anaddbdipdip dipdipanaddb dipdipanaddb citeamadon citeamadon abinitteststutorialinputtbase_abi abinitteststutorialinputtbase_abi teststutorialinputtbase_abi teststutorialinputtbase_abi testlibxc_ testlibxc_ teststutorialrefstbase_abo teststutorialrefstbase_abo abinitteststutorialrefstbase_abo abinitteststutorialrefstbase_abo abinittestspsps_for_testsc_ldapaw abinittestspsps_for_testsc_ldapaw testspsps_for_testsc_ldapaw testspsps_for_testsc_ldapaw digit digit input variabl anaddb optic aim recogn use namespac anaddb optic aim one thu also choic syntax anaddbdipdip dipdipanaddb first case dipdip echo second case dipdipanaddb echo syntax need there also dipdip variabl abinit wikilink start interpret intern link within page henc md see markdownquickreferencethi section info becom see markdownquickreferencethi section info although result obtain readabl markdown syntax md see sectionmarkdownquickrefer info specifi name anchor bibliograph citat use syntax separ pleas consult citegonz last gener abinit articl render html pleas consult citegonz last gener abinit articl script bit format exampl keep one pair squar bracket case bibliograph refer addd abinit case path syntax testlibxc_ prefer document new test releas note python code issu warn termin link establish note link input file popov descript test hover citat open popov titl report bibtex entri link variabl intern file use differ font declar extracss intern link namespac intern link recogn thank namespac exampl namespac markdown result tutori tutorialgw tutorialgw tutori tutorialindex tutorialindex topic topicbs topicbs topic topicindex topicindex help helpabinit helpabinit help helpabinitfilesfil helpabinitfilesfil theori theorymbt theorymbt varset varsetbs varsetbs cite citeamadon citeamadon ac acabiref_nag__openmpiac acabiref_nag__openmpiac pdf pdfhowto_chebfipdf pdfhowto_chebfipdf pdf pdfhowto_chebfi pdfhowto_chebfi src src_scfcvm_scfcvf src_scfcvm_scfcvf filesfil html id defin abinitdocguideabinitmd html idfilesfilea detail present file file also case possibl specifi name link separ topicpimdintroduct becom topicpimdintroduct import intern link automat gener markdown parser discuss permalink sectionpermalink care includ wikilink insid squar bracket eg span stylebackgroundcolor eeefonts ecut span occurr confus parser problem easili solv insert whitespac express ecut version much readabl also avoid possibl problem special mean markdown refer particular git commit insid markdown document use solv gitshafdbaedcadcfdfebcedd produc gitshafdbaedcadcfdfebcedd extens use gener nice changelog releas notesaboutreleasenot also possibl mention particular github issu syntax fix httpsgithubcomabinitabinitissu produc fix httpsgithubcomabinitabinitissu extern link intern wikilink extern link also recogn follow case treat link start www namespac http http ftp file markdown result httpswwwabinitorg httpswwwabinitorg httpswwwabinitorg httpswwwabinitorg also possibl specifi name link separ exampl httpswikiabinitorgth abinit wiki produc httpswikiabinitorgth abinit wiki markdown parser support alias commonli use link alias defin mkdocsyml configur file abimkdocs_alias markdown result abipi abipi abipystructurenb abipystructurenb xmgrace xmgrace gnuplot gnuplot today today permalink permalink featur tabl content extensionhttpspythonmarkdowngithubioextensionstoc nbsp part standard markdown librari extens insert anchor end headlin make possibl directli link subpart document default header automat uniqu id attribut gener base upon text header name anchor construct header convert string lowercas ascii remov dot symbol replac white space dash instanc pdffile anchor associ pdf file section page thu refer markdown syntax md seen previou sectionpdffil produc seen previou sectionpdffil tip hover mous header html page show permalink browser also copi link use last part gener refer link intern page easi includ websit built mkdoc two possibl approach rel link rootrel link let assum exampl insert link section abimkdocsmd locat abinitdocdevelop directori directori page thu use rel url syntax md exampl rel linkabimkdocsmdgettingstart produc exampl rel linkabimkdocsmdgettingstart altern rootrel syntax md exampl rootrel linkdevelopersabimkdocsmdgettingstart path rel abinitdoc must start also case get correct result exampl rootrel linkdevelopersabimkdocsmdgettingstart note mkdoc convert url rel url two approach complet equival still use rel url strongli suggest develop abl open link editor provid editor markdownawar note also possibl gener automat tabl content place toc marker document would like tabl content appear nest list header document replac marker note howev use toc page recomend tabl content automat gener mkdoc theme display navig bar right markdown extens smartsymbol smartsymbolshttpsfacelessusergithubiopymdownextensionsextensionssmartsymbol nbsp add syntax creat special charact trademark arrow fraction etc list symbol support extens markdown result tm tm c c r r co co etc etc st nd etc st nd etc definit list definit listshttpspythonmarkdowngithubioextensionsdefinition_list nbsp extens add abil creat definit list markdown document extens includ standard markdown librari follow text md appl pomac fruit plant genu malu famili rosacea orang fruit evergreen tree genu citru render appl pomac fruit plant genu malu famili rosacea orang fruit evergreen tree genu citru admonit admonit httpspythonmarkdowngithubioextensionsadmonit nbsp use stress import section use eg abinit tutori admonit creat use markdown syntax md note note md danger dont tri home stand back im tri scienc admonit custom titl make sure quot titl type admonit avail use mkdoc depend theme use materi theme supportshttpsquidfunkgithubiomkdocsmaterialextensionsadmonitiontyp nbsp follow type note note admonit look seealso tip tip admonit look hint import warn warn admonit look attent caution danger danger admonit look error summari summari admonit look tldr success success admonit look check done failur failur admonit look fail miss bug bug admonit complet list pleas consult mkdocsmateri documentationhttpsquidfunkgithubiomkdocsmaterialextensionsadmonit detail detailhttpsfacelessusergithubiopymdownextensionsextensionsdetail nbsp extens creat collaps element hide content use html html detailssummari tag accomplish support nest also forc default state open extens use document input variabl gener contain list test associ variabl also use long faq qa section tutori exampl md note list variabl ecut asranaddb produc open element note list variabl ecut asranaddb md note click open ecut asranaddb creat close element note click open ecut asranaddb abinit extens creat button open dialog contain input file use dialog testsvinputtabi produc dialog testsvinputtabi multipl file use dialog testsvinputtabi testsvinputtabi testsvinputtabi multipl button produc dialog testsvinputtabi testsvinputtabi testsvinputtabi mathjax formula written latex interpret automat visual time thank mathjaxhttpdocsmathjaxorgenlatestmathjaxhtml nbsp ontheflight processor math extens pythonmarkdown provid pythonmarkdownmathhttpsgithubcommityapythonmarkdownmath latex equat use everywher includ descript variabl report abinit_varsyml descript test give test_info section abinit document convent yield onlinecit translat latex formula yield display mode latex formula render one dedic line moreov center equat number use display mode insid marker declar equat within standard beginequationendequ marker sign insid html prepr html section mathjax interpret use prevent real interpret instanc latex phirangl produc phirangl latex phi_kqrr produc phi_kqrr equat enclos beginequationendequ marker automat number referenc insid markdown text use standard latex syntax latex beginequ g langl thetan_tbiglpsipsidaggerbigrthetan_ rangl labeleqgreendef endequ produc beginequ g langl thetan_tbiglpsipsidaggerbigrthetan_ rangl labeleqgreendef endequ equat referenc propag eqrefeqgreendef produc propag eqrefeqgreendef note mathjax configur latex macro facilit insert symbol commonli use domain markdown result rr rr gg gg kk kk qq qq kq kq pleas consult preambl abinit_thememainhtml complet list macro bug seem plotli javascript librari play well mathjax equat sometim display plotli activ problem fix reload page repres seriou issu sinc plotli use select page like one unicod unicod charact particular greek symbol accent charact use document websit use googl roboto fonthttpsfontsgooglecomspecimenroboto nbsp greek symbol includ without use mathjax either specifi html entiti copi unicod charact given two tabl could use page contain latex equat greek symbol insert pleas use unicod charact latex equat charact name charact entiti hex entiti html entiti greek capit letter alpha  x alpha greek capit letter beta  x beta greek capit letter gamma  x gamma greek capit letter delta  x delta greek capit letter epsilon  x epsilon greek capit letter zeta  x zeta greek capit letter eta  x eta greek capit letter theta  x theta greek capit letter iota  x iota greek capit letter kappa  xa kappa greek capit letter lambda  xb lambda greek capit letter mu  xc mu greek capit letter nu  xd nu greek capit letter xi  xe xi greek capit letter omicron  xf omicron greek capit letter pi  xa pi greek capit letter rho  xa rho greek capit letter sigma  xa sigma greek capit letter tau  xa tau greek capit letter upsilon  xa upsilon greek capit letter phi  xa phi greek capit letter chi  xa chi greek capit letter psi  xa psi greek capit letter omega  xa omega charact name charact entiti hex entiti html entiti greek small letter alpha  xb alpha greek small letter beta  xb beta greek small letter gamma  xb gamma greek small letter delta  xb delta greek small letter epsilon  xb epsilon greek small letter zeta  xb zeta greek small letter eta  xb eta greek small letter theta  xb theta greek small letter iota  xb iota greek small letter kappa  xba kappa greek small letter lambda  xbb lambda greek small letter mu  xbc mu greek small letter nu  xbd nu greek small letter xi  xbe xi greek small letter omicron  xbf omicron greek small letter pi  xc pi greek small letter rho  xc rho greek small letter final sigma  xc greek small letter sigma  xc sigma greek small letter tau  xc tau greek small letter upsilon  xc upsilon greek small letter phi  xc phi greek small letter chi  xc chi greek small letter psi  xc psi greek small letter omega  xc omega taken httpssitespsuedusymbolcodeslanguagesancientgreekgreekchart plotli plotlyhttpsplotlyapi nbsp highlevel declar chart librari built top dj stackgl plotlyj ship chart type includ scientif chart graph statist chart svg map financi chart note plotli deactiv default activ insid markdown page ad yaml plotli true front matter option tell browser load javascript librari html page possibl includ htmljavascript code gener nice interact plot insid markdown document exampl html javascript code html plot go blank div element size plot layout give div size shown phere simpl plotli plot hrefhttpsbitlyorigjplotlyj documentationap div idplotly_plot stylewidthheightpxdiv script function plotlyplotdocumentgetelementbyidplotly_plot x margin script produc follow plot phere simpl plotli plot hrefhttpsbitlyorigjplotlyj documentationap div idplotly_plot stylewidthheightpxdiv script function plotlyplotdocumentgetelementbyidplotly_plot x margin script plotli use plot code statisticscodestatsmd requir proper function websit use html directli html code use markdown keep mind standard markdown parser ignor text insid blocklevel html tag html div emphas text div wont work situat occur tri write advanc html code anoth thing worth notic mkdoc default gener directori indexhtml file everi markdown page declar mkdocsyml see also offici documentationhttpwwwmkdocsorguserguideconfigurationpreviewcontrol mean local webserv serv page httpdevelopersmarkdownindexhtml equival reach user friendli url httpdevelopersmarkdown implement detail affect link specifi either wikilink markdown syntax python code perform automat translat url affect howev way specifi src href html code one take account extra directori creat mkdoc nutshel prepend rel path would use insid shell specifi locat resourc respect present page warn use rootrel url eg tutorialbse_assetstbspng html code creat problem site deploy besid rel url allow us serv multipl version abinit document associ differ version code plotli true div classplotlygraphdiv idabinit_stats_plot stylewidthheightpxdiv script function plotlydjsonstatisticsjson functionstat var mode linesmark var x statsdat var trace x x statsnum_flin mode mode name number f line var trace x x statsnum_ffil mode mode name number f file yaxi var trace x x statsnum_test mode mode name number test yaxi var trace x x statstargz_s mode mode name tarbal size mb yaxi var data trace trace trace trace var layout titl date releas date mention releas note xaxi tickval statsdat ticktex statsvers legend traceord revers yaxi domain yaxi domain yaxi domain yaxi domain plotlynewplotdocumentgetelementbyidabinit_stats_plot data layout showlink fals script descript tool avail yaml base test author tc yamlbas test suit fortran python api page give overview intern implement order facilit futur develop extens first part discuss write new yaml document use lowlevel fortran api second part describ python implement step requir regist new yaml document framework final provid recommend name variabl use yaml document order improv readabl facilit integr yaml document python code fortran api lowlevel fortran api consist follow modul m_pair_listf fortran modul construct dictionari map string valu intern dictionari implement c term list keyvalu pair pair list dynam hold either real integ string valu implement basic getter setter method iter system allow loop keyvalu pair easili fortran list chosen hash tabl particular context perform critic cost requir locat key neglig given never lot element tabl m_stream_stringf fortran modul provid tool manipul variabl length string file like interfac stream object m_yaml_outf fortran modul easili output yaml document fortran modul repres main entri point client code may use implement method output fortran object provid basic routin produc yaml document base map root contain well format human readabl possibl valid yaml array number integ real keyvalu map use pair list list keyvalu map scalar field routin support tag specifi special data structur m_neatf new abinit test system higher level modul provid fortran procedur creat specif document associ import physic properti current routin total energi compon ground state result implement detail exampl provid belowcreatinganewdocumentinfortran new infrastructur design extens easeofus mind perspect develop ad new yaml document requir three step implement output yaml document fortran use preexist api associ uniqu tag new document tag identifi document structur regist tag associ class python code detail procedur found creat yaml configur file defin quantiti compar correspond toler exampl help clarifi let assum want implement output etot document differ compon total free energi workflow split two part idea separ comput composit document separ composit document actual render fortran code build list key valu entri look like mg fortran exampl refactor merg text creat new document fortran fortran import modul use m_neat neat_etot use m_pair_list pair_list realdp etot typepair_list e_compon list key valu entri call e_componentssetcom stotal energi compon call e_componentssettot energi retot footer routin data store call neat_etote_compon unit _neatm_neatf implement neat_etot fortran subroutin neat_etotcompon unit typepair_list intentin compon integ intentin unit call yaml_single_dictetot compon width fileunit real_fmt max size label need extract pairlist max size string need extract comment width width field name side permit nice align valu end subroutin neat_etot creat new document fortran develop invit brows sourc m_neat m_yaml_out comprehens overview avail tool inde routin document comment creat handwritten refer like go sync quicker onsit document show littl exampl give feel process simplest way creat yaml document introduc use yaml_single_dict howev method limit scalar possibl put array dictionari even tabular data best way creat new document routin neat_my_new_docu take requir data argument format work routin declar stream_str object build yaml document insid open document yaml_open_doc fill close yaml_close_doc final print wrtout_stream come basic skeleton neat routin fortran subroutin neat_my_new_documentdata_ data_ iout declar piec data array number pair_list integerintentin iout output file descriptor local variabl typestream_str stream open document call yaml_open_docmi label comment document streamstream fill document close output document call yaml_close_docstreamstream call wrtout_streamstream iout end subroutin neat_my_new_docu suppos want matrix real number tag nicematrix document field name matrix add follow middl section fortran call yaml_add_realdthat matrix dimension_ dimension_ mat_data tagnicematrix streamstream m_yaml_out routin provid similar interfac first label data structur metadata bunch option argument format ad tag tweak space etc python api roughli speak one group python modul three differ part fldiff algorithm interfac pyyaml librari pars output data pars yaml configur file test logic fldiff algorithm slightli modifi extract yaml document output file store later treatment newt tool written facilit creation new python class correspond yaml tag implement new logic oper extract data tool easi use via class decor tool use creat basic class futur tag among class directli convert yaml list number numpi array class may use exampl creation tag parser test configur ad facil test place command line tool testtoolspi allow differ manual action see test cli fldiff algorithm machineri use extract data output file defin abinittestspymodsdata_extractorpi modul take care identif yaml document insid output file includ treatment metacharact found first column follow origin fldiffpl implement abinittestspymodsfldiffpi main driver call testsuitepi part implement legaci fldiff algorithm use object defin yaml_tool perform yamlbas test produc final report interfac pyyaml librari interfac pyyaml librari implement abinittestspymodsyaml_tool __init__pi modul expos public api consist yaml_pars function pars document output file document class give interfac extract document metadata flag is_avail true pyyaml numpi avail has_panda true panda avail register_tagpi defin tool regist tag see detail yamlbas test logic logic use pars configur file defin meta_conf_parserpi contain creation config tree logic regist constraint paramet logic appli constraint constraint class host code build constraint identifi candid applic appli identif base type candid compar refer type set type extend test suit main entri point three main entri point system discuss order increas complex first one yaml configur file requir python knowledg basic comprehens convent use write test fulli declar logic quit easi learn usag avail exampl second one abinittestspymodsyaml_testsconf_parserpi file contain declar avail constraint paramet basic python understand requir order modifi file comment doc string help user grasp mean file detail avail sectionconstraintsandparametersregistr third one file abinittestspymodsyaml_testsstructur defin structur use yaml parser encount tag start case reach given pattern __undef__ exampl structur directori packag organis featur ex file structuresground_statepi file defin structur given featur file import main script structures__init__pi even abstract layer top _yaml_ modul help better good understand advanc python concept like inherit decor classmethod etc tag registr class implicit method attribut basic tag registr tool register_tagpi modul defin python decor use build python class associ yaml document yaml_map regist structur base yaml map class must provid method from_map receiv dict object argument return instanc class from_map class method might normal method constructor accept zero argument yaml_seq regist structur base yaml sequencelist class must provid from_seq method take list input return instanc class yaml_scalar regist structur base yaml scalaranyth fit two type string class must provid from_scalar method take string argument return instanc class use complex pars practic case csv tabl pars panda yaml_implicit_scalar provid possibl special pars without explicit tag class appli meet requir yaml_scalar also provid class attribut name yaml_pattern either string compil regex match expect structur scalar auto_map provid basic gener purpos interfac map object dictlik interfac inherit basedictwrapp get __contains__ __getitem__ __setitem__ __delitem__ __iter__ key item from_map method accept key dictionari add attribut __repr__ method show attribut yaml_auto_map equival auto_map follow yaml_map yaml_not_available_tag normal function decor take tag name messag argument regist tag rais warn time tag use option third argument fatal replac warn error set true implicit method attribut class attribut method use tester logic avail never requir chang behaviour provid _is_base_array boolean class attribut assert object deriv basearray set true isinst reliabl manipul syspath _not_avail boolean class attribut set true object return tag regist yaml_not_available_tag make constraint fail use messag is_dict_lik boolean class attribut assert object provid full dict like interfac set true use basedictwrapp __iter__ method standard python implicit method iter object test driver crawl element get_children method easi way allow test driver crawl children object take argument return dictionari child_nam child_object has_no_child boolean class attribut prevent test driver crawl children even __iter__ method need string short_str method use avail string represent object long error messag return string repres object long constraint output length one keep thing readabl constraint paramet registr add new paramet parser recognis new token paramet one edit abinittestspymodsconf_parserpi conf_pars variabl file method paramet regist new paramet argument follow token mandatori name use configur paramet default option none default valu use paramet avail configur value_typ option float expect type valu found configur inherit option true whether explicit valu configur propag deeper level exampl python conf_parserparametertol_eq default inheritedtru ad constraint parser recognis new token constraint one also edit abinittestspymodsconf_parserpi conf_pars method constraint regist new constraint suppos use decor function take keyword argument argument option follow name str name use config file specifi name function use value_typ float expect type valu found configur inherit true whether constraint propag deeper level apply_to number type data constraint appli type one special string number real integ complex array refer numpi array use constraint appli structur defin inherit use_param list name paramet pass argument test function exclud set set name constraint appli one handle_undef true whether special valu undef handl call test function true undef valu present data test fail succeed depend valu special paramet allow_undef fals undef valu wont check equival nan decor function contain actual test code return true test succeed either fals instanc faildetail commonpi test fail test simpl enough one use fals howev test compound sever nontrivi check faildetail come handi tell user part fail want signal fail test explain happen return faildetailsom explan messag pass faildetail transmit final report user exampl faildetail python conf_parserconstraintexcludeceil tol_ab tol_rel ignor def toltolv ref test valid rel absolut differ valu given toler absref abstest return true elif absref test absref abstest tolv return faildetailrel error toler elif absref test tolv return faildetailabsolut error toler els return true add new tag pyyaml offer possibl directli convert yaml document python class use tag regist new tag edit file abinittestspymodsyaml_toolsstructurespi file sever class decor one yaml_map yaml_scalar yaml_seq yaml_auto_map decoratorshttpsrealpythoncomprimeronpythondecor function actual regist class known tag whether use one anoth depend organ data yaml document dictionari scalar listsequ major case one want tester brows children structur appli relev constraint access attribut origin name data case simpler way regist new tag use yaml_auto_map exampl regist tag etot simpli regist field data tree let tester check tol_ab tol_rel would put follow abinittestspymodsyaml_toolsstructuresground_statepi python yaml_auto_map class etotobject pass name class etot associ tag recogn yaml parser yaml_auto_map sever thing us give class dict like interfac defin relev method allow tester brows children regist tag yaml parser automat regist attribut found data tree attribut class instanc attribut access attribut syntax ex my_objectmy_attribute_unit normal name basic remov charact python identifi like space punctuat charact dictionari syntax origin name ex my_objectmi attribut unit sometim one want control build class instanc yaml_map let suppos still want regist tag want select subset compon exampl use yaml_map give us control build instanc done implement from_map class method class method method call class instead call instanc method take argument dictionari built data tree yaml parser return instanc class python yaml_map class energytermsobject def __init__self kin hart xc ew selfkinet kin selfhartre hart selfxc xc selfewald ew classmethod def from_mapcl cl class etot someth els subclass etot dictionari built data tree kin dkinet hart dhartre xc dxc ew dewald energi return clskin hart xc ew fulli control build structur howev lost abil tester brows compon check want make custom check fine exampl defin method check_compon use callback constraint like abinittestspymodsyaml_toolsstructureground_statepi python yaml_map class energytermsobject code previou exampl def check_componentsself test self alway refer object return absselfkinet otherkinet e absselfhartre otherhartre e absselfxc otherxc e absselfewald otherewald e configur file yaml energyterm callback method check_compon howev better give back control tester purpos implement method get_children return dictionari data check automat tester detect use check gave python yaml_map class energytermsobject code previou exampl def get_childrenself return kin selfkinet hart selfhartre xc selfxc ew selfewald tester abl appli tol_ab friend compon gave class __complete__ dictlik read interfac __iter__ yield key __contains__ __getitem__ key item class attribut is_dict_lik set true treat node longer need get_children yaml_auto_map regist class automat address requir yaml_seq analog yaml_map howev to_map becam to_seq yaml sourc data match yaml sequenc structur either b c yaml b c argument pass to_seq list one want tester brows element result object one either implement get_children method implement __iter__ python special method reason class __iter__ method implement one __not__ want tester brows children basearray subclass case one defin has_no_child attribut set true tester wont tri brows string particular case __iter__ method never brows associ tag anyth els yaml map sequenc one use yaml_scalar decor expect class method from_scalar take raw sourc string argument return instanc class use creat custom parser new number represent exampl creat vector unit tag python yaml_scalar class vecunitobject def __init__self x z unit selfx selfi selfz x z selfunit unit classmethod def from_scalarcl raw sx sy sz unit _ rawsplit split blank return clsfloatsx floatsi floatsz unit new tag regist yaml parser happili pars someth like yaml kpt vecunit bohr final scalar easili detect form one creat implicit scalar implicit scalar advantag detect yaml parser without need write tag soon match given regular express exampl pars directli complex number could naiv follow python yaml_implicit_scalar class yamlcomplexcomplex quit rigid regular express match complex number yaml_pattern rdd ddi noth yam_implicit_scalar way creat subclass python nativ object staticmethod def __new__arg kwarg return complex__new__arg kwarg classmethod def from_scalarcl scal adjust match python restrict complex number write return clsscalreplacei jreplac recommend convent yaml document section discuss basic convent follow write yaml document fortran note convent motiv technic aspect facilit integr python languag well implement postprocess tool tag name use camelcas one directli map tag name python class usual given follow convent see also pephttpswwwpythonorgdevpepspep tag name selfexplanatori whenev possibl keyword valid python identifi mean one avoid white space much possibl avoid name start nonalphabet charact white space replac underscor prefer lowercas name whenev possibl default quantiti suppos given atom unit document contain quantiti given unit recommend encod inform name use syntax foo_ev avoid name start underscor name reserv futur addit python infrastructur tol_ab tol_rel tol_vec tol_eq ceil ignor equat equat callback callback reserv keyword shall use yaml document comment field option recommend especi purpos document obviou exampl wellform document yaml energyterm comment compon total free energi hartre kinetic_energi e hartree_energi e xc_energi e total_energy_ev e exampl yaml document follow guidelin yaml etot kinet energi e hartre energi e _xc energi e total energyev e equat nutshel savag usag write statement major case yaml document open close routin discuss crystalyaml_writestream indent one also promot use pythonfriendli key white space replac underscor number first charact tag camelcas yaml mode support main output file happen file files_to_test section tag mandatori document document tag consid standard document ie document there offici commit abinit commun maintain backward compat offici yaml document may use thirdparti softwar implement postprocess tool label field appear data document uniqu identifi scale _iter state_ tag necessarili uniqu describ structur document need use unless special logic implement document develop new yamlbas infrastructur use build block implement highlevel logic requir advanc integr test parametr test test multipl paramet chang either level input variabl mpiopenmp level typic exampl run calcul useylm paral_kgb run multipl configur npfft npband npkpt benchmark test monitor scalabl code make sure seriou bottleneck introduc trunkdevelop import dimens increas eg chksymbreak ngkpt possibl applic monitor memori alloc detect possibl regress interfac abipi abiflow abipi set integr test mainli focu python layer without test numer valu still would nice check numer reproduc especi come workflow alreadi use product highthroughput applic eg dfpt author mg design abinit test suit collect input output file organ hierarch structur directori directori contain test share kind properti abinit major version test ad extern librari whose presenc requir execut test purpos test suit twofold develop use test farm valid code push develop trunk wherea user use test suit valid execut use product calcul code drive execut test valid final result written python version requir reli follow principl test selfdescrib sens input file provid inform need run test analyzevalid final result test keyword possibl select run test contain tag possibl run entir suit parallel mpiopenmp arbitrari number processor test paral directori execut test distribut among python process order reduc execut time configur file configur paramet test suit defin __init__pi file locat test suit directori file standard python file paramet specifi standard python syntax list string tests__init__pi top level configur file file defin list directori contain abinit test python cat tests__init__pi testsuite_dir atompaw bigdft builtin etsf_io fast cpu disabl add new directori test suit suffici add name python list directori list testsuite_dir contain addit __init__pi file list input file associ test option global attribut python cat testslibxc__init__pi cpp variabl need_cpp_var have_libxc list input file inp_fil tin tin tin tin tin disabl inp_fil list name input file contain input directori one prepend dash name file eg tin signal python code test disabl variabl need_cpp_var list cpp variabl must defin includ file configh order activ test directori case exampl libxc test execut have_libxc defin configh note one prepend charact name cpp variabl specifi test execut variabl defin build input file contain inform need run test analyz final result metavari gather test_info section convent paragraph summar convent use name test abinit test group suit whose name given name directori specifi tests__init__pi suit option divid subsuit whose name must regist dirname__init__pi test therefor assign suit subsuit integ number import name suitesubsuit must uniqu asciicasthttpsasciinemaorgapnghttpsasciinemaorga organ term suitessubsuit allow one select easili test command line interfac runtestspi name input file must match one two possibl regular express tintegerin eg tin tsubsuitename_integerin eg tgw_in latter syntax use exampl tutori directori group test associ particular lesson name subsuit pass argument runtestspi specifi test particular subsuit execut exampl command runtestspi gw run test tgw_in tgw_in warn test standard input standard output standard error whose name tgw_stdin tgwstdout tgwstderr respect name construct automat python code henc develop avoid creat similar file name fortran execut runtim test_info section input file contain addit paramet pass fortran code addit section test_info provid inform need run test analyz final result test_info section place end input file order avoid problem execut read standard input xmllike marker begin_test_info end_test_info enclos section line start sentinel remov pars left standard ini configur file provid inform need run test analyz final result figur show option group differ section testsuite_howto_assetstestinfopng simpl exampl test_info section report figur testsuite_howto_assetssimple_testinfopng note token separ comma eg tolab tolrel field separ colon tip use testlintpi valid new test_info section import option paragraph discuss detail import option present test_info section complet document option one execut script testspymodstestsuitepi execut name binari file eg abinit mandatori max_nproc maximum number mpi process use mandatori pre_command post_command list shell command shell section execut run execut present command cp mv touch support sinc python code use absolut pathnam deal file one specifi file locat use rel path python function oscurdir threadsaf input directori p psps_for_test w work directori directori test execut exampl ww_mv foo bar correspond mv workdirfoo wordirbar iw_cp twanin wannierin correspond cp inputtwanin workdirwannierin keyword list keyword use select test note name execut alway ad list keyword henc runtestspi k cutd run test associ execut cutd chain test case one connect differ step typic case depict figur testsuite_howto_assetsdeppng case test tin produc densiti file den need start second calcul test tin python code must awar depend tin tin execut correct order test_info section defin option test_chain name test form chain sequenc order sens python script execut test start first item list note input file belong test chain must contain test_chain option obvious list test execut test chain one usual perform basic oper file renam file copi order connect differ step exampl may want renam den file produc tin output densiti automat read test tin shell section contain two option use specifi list shell command execut run test typic exampl shown testsuite_howto_assetstest_chainpng note peculiar syntax shell command testsuite_howto_assetsrshell_syntaxpng multiparallel test multiparallel test test execut parallel differ number mpi process eg test testspar abinit test suit design possibl defin singl input file multipl parallel test automat gener follow describ specifi multiparallel test test_info section import option nprocs_to_test defin mpi section list number mpi process use differ test max_nproc maximum number mpi process support calcul set maximum valu present nprocs_to_test possibl number mpi process section whose name construct rule ncpu_nproc simplifi exampl test_info section multiparallel test report testsuite_howto_assetsmultiparapng complic exampl chain multi parallel test warn chang number mpi process insid test chain run test abinittestsruntestspi script provid userfriendli command line interfac allow user select test keyword author suit name input variabl etc also provid option control number mpi process number openmp thread well number python thread task parallel syntax runtestspi suite_arg option suite_arg list suit name option select slice use python syntax exampl runtest v v v execut test v exclud test v start vt warn suite_arg given script execut entir test suit use option j specifi number python process task parallel n specifi number mpi node eg abinit specifi number openmp thread eg abinit k select test keyword tip complet list option support use runtest h run test mpi simplest case one run mpi test issu runtestspi n paral n specifi number mpi process runtestspi employ simpl rule guess mpi implement invok particular assum environ properli setup path ld_library_path mpi demon eg mpd alreadi run background initi demon manual launch test use mpirnun path default mpirun assum standard syntax specifi number processor ie mpirun n execut stdin stdout need overrid default set pass option script via configur file ini format c option runtestspi n c mpicfg cat mpicfg mpi mpi_prefix usrlocalopenmpigcc mpirun_np mpi_prefixsbinmpirun np mpirun_np string path mpirunn follow addit option may want use option use specifi number mpi node must ad end string tip exampl consult configur file abinittestsmpi_cfg run testbotpi buildbot slave section intend develop may want run interact entir test suit slave builder exampl one test fail slave alreadi modifi sourc code fix problem want avoid launch full buildbot build check chang ok case one rererun entir test suit part execut follow two step cd abinittest testbotpi script testbotpi read configur file testbotcfg alreadi present work directori run entir set test produc final report note one modifi configur option defin testbotcfg order speedup execut test particular one use option with_tdir list directori execut without_tdir list directori exclud add new test let assum want add new test tfoo_in directori v test henc locat foo subsuit within suit v easili run runtest runtest foo order add new test one follow follow step add name input file inp_fil list v__init__pi regist name subsuit list subsuit defin v__init__pi step skip test belong subsuit add input file vinput refer file vref warn code use pickl file test_suitecpkl store set object repres test test suit rememb regener databas chang test_info section modif configur paramet test suit __init__pi file runtestspi provid handi option r regener automat regener databas run test add chain test todo add parallel test add support new execut let assum new execut name foox want chang python code result foox automat test modif need integr foox abinit test suit first provid input file foox test_info section provid inform need run execut foox requir kind input data extra rule support modifi parser new option store basetest tell code construct standard input pass foox complic part requir understand intern implement code use three differ object basetest chainoftest testsuit repres test test suit basetest base class provid method run analyz result test tri reus piec code much possibl chainoftest list basetest instanc execut separ typic exampl tin produc output result use input test tin testsuit list basetest chainoftest instanc provid userfriendli method extract test accord rule eg keyword run test python thread basetest class provid make_stdin method return string standard input pass fortran execut sinc execut format input file basetest abl handl differ case hope need replac make_stdin method basetest appropri standard input construct valu specifi test_info section build abinit introduct document describ build abinit use autotoolsbas build framework find someth outofd incorrect pleas send messag yann pouillon build requir tri build abinit pleas make sure instal correct tool correctli setup unixlinux hardwar mb ram may suffici your patient static build mb ram minimum debug build least gb free disk space gb recommend optim build least mb free disk space mb recommend build tool recent posix shell default binsh come older unic notabl osf known defici case use make shellksh instanc c compil gcc higher recommend egc higher gcc higher also work platform nativ c compil redhat user compil distribut rh buggi recommend upgrad latest gcc x compil later need packag name gcc cpp perl higher older perl version may work though test python higher older python version may work though test pleas note becom true requir soon gnu make higher flavour make may work yet support option softwar follow softwar use develop idea purpos dont worri dont need build abinit autoconf higher autoconf necessari want hack configurein earlier version might work though test automak higher automak necessari gener makefilein makefileam autmoak earlier like work bazaar tla higher tla allow access latest version sourc window mac os x abinit build mac os x macho build built gcc makefil build mac os x therefor similar unix build comfort termin app applicationsutil instal softwar requir need admin privileg machin hardwar mac os x later gb free disk space build tool latest develop tool appl dont alreadi youll need free adc membership download tool decemb tool later requir build abinit current version fink time write note conflict fink virex use sw virex instal need updat latest version virex resolv conflict describ fink news earlier version mac os support get sourc sourc packag abinit usual avail abinit websit httpswwwabinitorg develop strongli advis use bazaar instead acceler lot integr contribut detail bazaar pleas consult abinit websit httpswwwabinitorgbzr bazaar websit httpbazaarvcsorg configur build option run configur make default option give fulli optim build order take full benefit machin use config file pleas read direct care build abinit use perus config file though possibl manual call configur commandlin option better perman way tune build paramet typic done place config file home directori ttabinitbuildhostnameactt file actual bourn shellscript execut configur setup overrid default valu sinc name host store abl build abinit sever machin share home directori find selfdocu tunabl configur abinit abinitdocbuildconfigtemplateac build objdir highli recommend use separ object directori objdir build abinit mean sourc code object file intermingl build abinit multipl architectur sourc tree build abinit use objdir creat go insid run configur eg pre mkdir tmpbuilddir cd tmpbuilddir configur make pre option mani option recogn configur script specialpurpos option intend embedd user use build full suit full list obtain run configur help advic cant figur configur option dont use build instal build abinit done follow tradit configur make make instal trilog precis preliminari step ttmkdir tmpbuilddir cd tmpbuilddirtt ttconfigurett ttmakett ttmake installtt ttmake checktt may perform ttmakett option author xg contribut abinit warn file obsolet reexaminedrewritten contrast document develop abinit wikihttpswikiabinitorgdokuphpiddevelopersoverview uptod page provid descript procedur follow develop abinit packag collabor differ group person base differ place world comment suggest improv procedur welcom toc introduct abinit packag aim use differ group peopl without mandatori control main contributor abinit group way abinit develop project fundament open contribut differ person locat louvainlaneuv corn contribut person member _de facto_ abinit group peopl use code might consid ad person subroutin without tri make part offici abinit packag howev two drawback subsequ version modif incorpor might check modifi interfac new version moreov contribut test user code bug might remain unnot also nicer share result code effort user code cours collabor effort also drawback particular collabor distant develop care plan sinc orthogon modif piec code two differ peopl time like happen gener neg progress ie larg wast time synchron done also requir use welldefin code style provid test case file comment modif addit much possibl order facilit mainten futur modif document aim defin protocol follow avoid neg progress due lack synchron analog procedur use parallel code obviou aim extern node wast time commun kept lowest level possibl final result correct need barrier synchron abil incorpor contribut differ group harmoni way might becom notic strength abinit project code repositori manag differ version abinit done thank util call bazaarhttpwwwbazaarvcsorg introduct power versatil tool look dedic page develop corner abinit web site thank bazaar develop project becom complet transpar sinc chang file regist latest version cours avail one come backward time track bug easili know anybodi develop differ branch also manag well subsequ merg procedur featur import allow develop mani differ peopl place file store includ histori call repositori develop use repositori privileg way manag contribut sinc coordin automat instantli inform progress also benefit regular backup contribut abinit repositori divid sever main categori abinitreleas go contribut offici releas packag contribut consist mainli fix document abinitdevel new ongo develop manag abinitdoc contain new incomplet document consist enough move sourc code categori divid version digit _abinitrelease_ digit _abinitdevel_ categori version one refer branch codenam _merge_ backbon develop effort concern develop suppos use branch start point task keep perman sync may least one branch basic philosophi follow distinguish debug contribut develop contribut _debug contributions_ typic modif line one rel routin need code work properli properli document sometim relat comment within routin correct document usual modif need synchron sent directli coordin via email form patch howev possibl synchron record insid abinitreleas categori repositori time xavier ltxaviergonzeuclouvainbegtmailtoxaviergonzeuclouvainb contact _develop contributions_ usual involv addit new capabl code despit use bazaar synchron coordin alway need one make sure nobodi els alreadi charg similar project develop contribut might quit local basic ad one routin call line exist routin contrari involv modif mani exist routin even local type modif discuss coordin mandatori though bazaar deal nice conflict file level great import avoid semant conflict begin develop alloc _develop task_ relat task free code experi debug check result work without commun rest abinit group alloc task obvious done coordin rest group prior work result develop incorpor new offici version task thu also limit time prior alloc subsequ incorpor take account possibl mani differ develop work independ must done central one coordin present xavier might chang futur order guarante harmoni relev consist contribut respons develop make enough check correct modif addit develop provid adequ document basic descript input variabl output data _abinit_help_ file well possibl updat bibliographi also provid one test ad standard suit test need ensur transfer offici version code done properli also new capabl preserv subsequ modif code final show modif suppress exist capabl code run set alreadi exist automat test respons coordin transfer result develop effort develop offici version way test reproduc satisfactori way subsequ mainten automat done check correspond test still work despit modif detail protocol develop develop propos modif addit code coordin case propos warmli welcom might discuss possibl involv scientist improv origin propos develop mail list setup purpos see commun section abinit web site b respect latest offici version develop defin task make list routin wish heavili modifi would like add realli need time follow current code practic ad new input variabl would need rather small modif larg number routin invar abinit gstate brdmin mover scfcv_core vtorho order avoid alloc larg area develop within sourc code would make develop effort imposs assum develop make appropri use differ user input variabl appropri use mean none aforement routin modifi purpos easiest case handl routin set routin ad packag interfac rest code involv set call subroutin interfac list argument chang one modifi call routin mani develop project type coexist contrast one develop effort involv major chang major routin prohibit execut anoth develop project type take account current structur code c gather differ suggest made basi current offici version coordin releas next version adequ prepar allow propos develop differ develop group list routin alloc group number test case alloc inform task done instal develop machin prior modif develop run intern test well test seri _v_ _v_ _paral_ sequenti case suit test make tests_dev command perfectli suit purpos check previou refer file result ok alway nice enough develop replac refer file provid offici version produc machin eas check result develop effort begin expect _a priori_ follow file modifi case _abinitsrc_ file _src_ directori new routin must list _allvariableshtml_ _varhtml_ file new input variabl must list document user variabl use final aesthet name propos _readme_ _testscnf_ file subdirectori _v_ well addit input file least import develop alloc routin modifi import mani other creat case develop must follow current abinit code style present latest version document _rules_coding_ _abinitdocdevelopers_ subdirectori particular mention initi header new modifi routin use somebodi need inform routin time later end develop effort mandatori develop run _tests_dev_ seri sure develop spoil featur code easili done issu make tests_dev command run automat requir test produc file _summary_teststargz_ send updat routin separ new test import sinc coordin run suit test well time troubl modif done develop would mean import delay deliveri new offici version thu larg wast time desir test new featur last minut pentium iii ghz second faster processor e develop occur develop prepar gzip compress tar file need file addit routin modifi routin makemak abinit_help readm testscnf _summary_teststargz_ file make avail coordin email ftp ssh exampl david propos nice addit abinit packag doug xavier enthusiast b basi version david propos list routin alloc c xavier deliv x version adequ prepar independ develop david want david implement addit modif basi version x check whether suit test still ok make file avail xavier e xavier thank david much transfer work offici version perform final modif name new input variabl includ propag routin alloc developp v version releas octob list chang respect version releas note updat novemb mani thank contributor abinit project februari septemb releas note rel modificationsimprov abinit v respect v merg request includ mr except mr also mr taken account list contributor includ l baguet jm beuken j bieder blanchet j clerouin c espejo giantomassi gingra x gonz f goudreault b guster ch paillard pouillon rodriguezmayorga royo f soubiran torrent verstraet j zwanzig worth read care modif mention present file examin link help file test case might take time xavier import remark warn noth mention v b notic achiev b bandparallel implement dfpt memori footprint distribut differ processor previous memori distribut kpoint parallel automat manag user action taken activ memori save see test testdfpt_ verstraet mr b iter boltzmann transport equat ibt comput electr conduct implement activ ibt use ibte_prep eph_task ibt solver also invok standalon mode provid sigeph file eph_task relat input variabl ibte_nit ibte_abs_tol ibte_alpha_mix see test testv_ giantomassi mr b comput dynam quadrupol flexoelectr avail within gga test gga longwav testv_ also usag quadrupol ration made easier anaddb default valu dipquadanaddb quadquadanaddb chang mean dipolequadrupol quadrupolequadrupol contribut alway includ fourier interpol dynam matrix provid ddb provid term default behaviour similar one use dipoledipol treatment inde default valu dipdipanaddb henc dipolar term automat includ ddb contain born effect charg electron dielectr tensor still user deactiv inclus differ term set correspond variabl zero test purpos see anaddb input variabl test testlw_ royo contribut giantomassi chang default mr b stress avail within cdft constrain dft see test testv_ testv_ testv_ x gonz mr b comput effect mass renorm due electronphonon coupl treat gener frohlich model avail cubic materi articl submit see httpsarxivorgab activ use eph_task see test testv_ b guster mr b import speedup paw calcul allow thank storag cprj coeffici see input variabl cprj_update_lvl howev present possibl groundstat calcul sever restrict spell cprj_update_lvl activ default also intern variabl cprj_in_memori expos document input variabl introduc develop process fft_count nonlop_ylm_count allow one monitor better number fft nonloc oper applic see test testv_ testv_ testv_ testv_ l baguet mr b extend firstprincipl molecular dynam implement method allow one drastic reduc need number band high temperatur simul use pure singl plane wave descript base fermi ga model beyond explicitli comput band implement usag describ upcom paper current review author blanchet j clrouin torrent f soubiran see topicextfpmd well input variabl useextfpmd extfpmd_nbcut test testv_ blanchet j clrouin torrent f soubiran mr c chang develop includ inform compil c support compil gfort gnu compil v newli support ifort intel compil v newli support two new bot introduc test farm alps_intel__elpa graphene_gnu__macport jm beuken chang ongo develop yet final new input variabl optic prtlincompmatrixelementsopt ad flag order make possibl print differ element use build suscept linear compon dielectr tensor element name matrix element renorm electron eigenvalu occup kpt weight everyth dump _opticnc file main process thu optim could done memorywis speed wise mpiio implement nc file testv_ creat testv_ except aforement flag set test check everyth work well even though print matrix element test matrix element well print would requir test opticnc file although possibl check work well use simpl python script see figur merg request gitlab note test v_ v_ move v_ v_ chang f goudreault mr new radial sine transform vdwdf kernel c espejo mr new test orbit magnet testv_ also ongo work orbit magnet includ use ddk wavefunct j zwanzig mr mr mr mr migrat mkdoc mkdocsmateri mksitepi requir python activ search capabl avail new mkdoc version giantomassi mr fix bug make_efg_onsit nspden case j zwanzig mr correct tutori rf rf version gingra mr fix error bug detect use ftrapuv intel option giantomassi mr bug fix nspden dfpt fe verstraet mr fix spuriou test line m_occf caus abinit abort case occopt number conduct band enough accommod nqfd enough accommod nelect ch paillard mr gw methodolog kohnsham densiti matrix solv bug produc segment fault use bdgw gwrdm new test testv_ rodriguezmayorga mr introduc new input variabl use_oldchi input variabl temporari test purpos document test wei chen modifi line src_drivescreeningf april input variabl rfstrs_ref introduc yet document test ongo work royo miscellan addit bug fix upgrad build system upgrad tutori j bieder giantomassi pouillon torrent j zwanzig v version releas februari list chang respect version releas note updat april mani thank contributor abinit project novemb april releas note rel modificationsimprov abinit v respect v merg request includ mr taken account also mr backport mr mr list contributor includ b amadon l baguet jm beuken j bieder e bousquet v brousseau f brunev w chen cote giantomassi gingra x gonz f goudreault b guster karatsu h larsen nadeau r outerovich ch paillard g petretto ponc pouillon gm rignanes rodriguezmayorga schmitt torrent verstraet xu j zwanzig worth read care modif mention present file examin link help file test case might take time xavier import remark warn charg variabl obsolet replac cellcharg inde charg quit ambigu string charg present input variabl time abinit still recogn charg input file might last longer abinitv new check govern input variabl chksymtnon examin whether tnon symmetri oper zero ration number small denomin requir gw calcul implement abinit alway possibl choos origin coordin properti abinit give suggest want chang coordin origin eg intent perform gw calcul set chksymtnon zero danger set metavari expert_us one disabl sever check input variabl x gonz mr input variabl npkpt chang np_spkpt inde parallel govern npkpt spin k point k point time npkpt still admit becom obsolet next major version chang x gonz nimag default valu prtgsr like sever prt variabl x gonz code stop anymor first occur overlap paw sphere larger pawovlp case ionmov imgmov second occurr per dataset inde trespass might transient see descript pawovlp x gonz b notic achiev b rmmdii algorithm implement scf groundstat algorithm faster potenti unstabl cg lobpcg algorithm medium larg size system less cubic scale step eg orthogonalis typic use molecular dynam structur relax restart previou time step give rmmdii less opportun fail see input variabl rmm_dii rmm_diis_savemem sever test exist testparal_ testparal_ testparal_ testv_ testv_ cover mani case includ ncpaw spinorbit note paw version rmmdii unstabl nc one extra oper need make converg speedup paw calcul good one observ nc giantomassi mr mr mr b treatment quasifermi energi valenc conduct band popul electron conduct band hole valenc band implement gap materi cours use eg citepaillard see variabl occopt nqfd see also relat input variabl ival intern variabl ne_qfd nh_qfd present initi nqfd intern see test testv_ ch paillard mr b tutori care reexamin improv appropri particular old pseudopotenti replac new one eg pseudodojohttpwwwpseudodojoorg jthhttpswwwabinitorgpspt text tutori use new convent launch abinit eg abinit input_fil instead abinit files_fil pseudopotenti mention input file input file suffix chang abiand output file suffix chang outto abo input file clean adequ mani restructur use templat popul electron conduct band hole valenc band also new tutori tutorialephisotc avail test testephisotc_ testephisotc_ also tutorialnlo tutorialephzpr enlarg new develop see testephzpr_ testnlo_ b amadon l baguet j bieder e bousquet f brunev w chen cote gingra giantomassi x gonz f goudreault b guster nadeau r outerovich ponc schmitt torrent verstraet xu j zwanzig numer mr b gw bodi reduc densiti matrix rdm linear dyson equat implement effect hartreefock expect valu therefor gw quasiparticl energi evalu result total energi part kinet energi includ correl electronnucleu hartre exchang calcul togeth galitskiimigd correl give new approxim selfconsist gw total energi see input variabl gwrdm xrdm also irdchkprdm prtchkprdm gwgmcorr see test testv_ testv_ also miss test ad gw calcul base hartreefock wavefunct use mini brillouin zone integr techniqu see testv_ new test testv_ provid comput suscept matrix chi_ inclvkb mauricio rodriguezmayorga f brunev mr b psic polaron selfinteract correct methodolog implement see citesadigh citesadigha base imag capabl abinit extend differ valu input variabl cellcharg differ imag also parallel activ psic use imgmov proper occup number see test exampl testv_ testpsic_ testpsic_ testpsic_ x gonz initi test c tantardini mr b comput electr conduct implement metal relaxationtim approxim transport lifetim comput imaginari part fanmigd selfenergi see test testv_ testv_ nadeau mr mr b implement ipi clientserv protocol describ citekapil option requir ionmov specif socket via command line option unix socket use ipi unixsocketunix inet socket use ipi hostport usag exampl abinit runabi ipi unixsocketunix runlog note present featur mainli use interfac abinit ase optim routin moreov user respons creat input file tune toler prevent abinit exit intern converg reach see exampl avail ase documentationhttpswikifysikdtudkasedevasecalculatorssocketiosocketiohtml giantomassi h larsen c chang develop includ inform compil c test farm new obsolet bot bot introduc test farm scope_gnu__par bot remov crono replac scope_gnu__par bigdft test activ alp jm beuken c support compil gfort gnu compil v newli support v obsolet ifort intel compil v obsolet reintroduc licenc reason support aocc ad build system jm beuken namevda chang ongo develop yet final calcul lutting paramet frohlich model echo see testv_ v brousseau mr new test testv_ treatment coulomb interact low dimension materi b guster dfpt includ ddk perturb done presenc nucdipmom j zwanzig mr bug fix new test testv_ use anaddb presenc larg tolsym valu g petretto sever bug fix relat treatment inaccur atom posit larg tolsym sever test creat testv_ testv_ aiidaabinit develop aiida plugin abinit develop httpsgithubcomsponceaiidaabinit also index httpsaiidateamgithubioaiidaregistri aiida support psp type pseudopotenti httpsgithubcomaiidateamaiidapseudo also impli modif pseudodojohttpwwwpseudodojoorg includ djrepo type pseudopotenti work common relax workflowhttpsgithubcomaiidateamaiidacommonworkflow dozen code includ abinit ponc also gm rignanes g petretto giantomassi new input variabl dmft_wanorthnorm introduc see testv_ testv_ howev still document b amadon increas stack size limit insid xmpi_init use posix capi giantomassi mr document ipi interfac link ase doc giantomassi mr correct messag forum relat forc electronpositron mode torrent mr miscellan addit bug fix improv document includ build system mani made upgrad tutori b amadon l baguet f brunev karatsu g petretto pouillon torrent j zwanzig v version releas septemb list chang respect version releas note updat novemb mani thank contributor abinit project octob novemb releas note rel modificationsimprov abinit v respect v merg request includ mr taken account also mr list contributor includ b amadon g antoniu l baguet jm beuken j bieder j bouchet e bousquet f brunev g brunin wei chen jb charraud ph ghosez giantomassi gingra x gonz f goudreault b guster g hautier xu n helbig f jollet h miranda f naccarato r outerovitch g petretto n pike pouillon f ricci royo schmitt stengel torrent j van bever verstraet j zwanzig worth read care modif mention present file examin link help file test case might take time xavier import remark warn occas switch abinitv abinitv mani improv format content file written abinit made backward compat abinitv may broken particular build system reli new ac file see bvb superceed v ac file bash script upgradebuildconfigfilesh locat top level directori packag use convert old acformat ac build system abinitv build anymor hard depend linalg netcdf hdf libxc sustain see bvb nowaday user instal prerequisit librari see also special instal note centosinstall_cento easybuildinstall_easybuild macosinstall_maco ubuntuinstall_ubuntu main abinit output file contain section written yaml sometim replac text section sometim ad inform mean userdevelop pars tool might work anymor adapt new abinitv output file see bvb note yaml output still develop modif may appear next version python api extract result calcul provid implement final sever default valu chang see ava new account abinit effort publish comput phi comm citegonz provid descript sever new featur version paper format comput phi comm also availablehttpswwwabinitorgsitesdefaultfilesabinitpdf licenc allow author put web second new account abinit effort publish j chem phi citeromero scope second paper differ first one survey abinit focus specif capabl still contain also descript new featur version paper format j chem phi also availablehttpswwwabinitorgsitesdefaultfilesabinit_jpcpdf licenc allow author put web specif public mention suggest acknowledg pagetheoryacknowledg namevaa default valu follow abinit input variabl chang ixcrot chneut ntime prtkden symsigma tolsym particular new default valu tolsym e line toler code user code one barrier use abinit remov token bug recognit symmetri fix tolsym close default see new test testv_ testv_ new input variabl chksymtnon introduc govern possibl automat align tnon fft grid actual need gw calcul x gonz mr other initi wavefunct paral_kgb nspinor chang sinc previou one could prevent code converg torrent mr input variabl xangst disabl use xcart instead specifi unit name angstrom work ongo concern coulomb singular treatment see dvd usag input variabl icutcoul chang time use gw_icutcoul instead name tdep main execut chang tdep atdep line citeromero j bieder mr b notic achiev b electronphonon interact mobil selfenergi relax time approxim temperaturedepend electron band structur includ zeropoint renorm etc new capabl abinitv relat electronphonon calcul describ fulli sec citegonz follow abinit v possibl comput eph selfenergi kohnsham represent use eph matrix element code employ optim algorithm comput either full selfenergi need qp correct spectral function imaginari part use evalu mobil within selfenergi relax time approxim serta comput mobil fulli integr insid abinit automat output comput imaginari part selfenergi bypass need postprocess result comput full selfenergi possibl reduc number empti state requir converg use firstord wavefunct obtain solv relev sternheim equat case lifetim comput code take advantag tetrahedron method filter contribut qpoint doublegrid integr techniqu acceler converg margin addit comput cost sampl relev region brillouin zone contribut transport properti thu lead signific reduct comput effort crystallin symmetri use throughout code order reduc number k qpoint must explicitli includ integr achiev good parallel effici cpu demand part parallel mpi employ distribut scheme kqpoint perturb band band level avail comput full selfenergi moreov interpol dfpt potenti describ sec citegonz fulli oper mani test three tutori provid list test testv_ testv_ testv_ testv_ testv_ testv_ testephmob_ testephmob_ testephmob_ testephmob_ testephmob_ testephmob_ testephmob_ testephzpr_ testephzpr_ testephzpr_ testephzpr_ testephzpr_ testephzpr_ testephzpr_ new input variabl brav dvdb_add_lr dvdb_qcache_mb dvdb_qdamp dvdb_rspace_cel eph_dop eph_phrang eph_tols_idelta eph_ecutosc eph_restart eph_stern eph_use_ftinterp eph_phwinfact getdvdb getdvdb_filepath getkerange_filepath getsigeph_filepath irddvdb prteliash rifcsph sigma_bsum_rang sigma_erang sigma_ngkpt sigma_nshiftk sigma_shiftk symvscf note new eph process unit abinit optdriv differ implement one implement anaddb three new tutori avail tutorialeph_intro tutorialephmob tutorialephzpr superced legaci tutori tutorialeph tutorialtdep detail implement usag pleas consult citebruninb g brunin h miranda giantomassi gm rignanes g hautier b flexoelectr dynam quadrupol new driver includ abinit allow one comput spatial dispers tensori quantiti clampedion flexoelectr tensor dynam quadrupol first moment ifc matrix first moment piezoelectr forc respons tensor precalcul ground state first second d_dkdk order respons function requir execut driver creat rd order energi deriv databas file use anaddb comput mix latticemedi flexoelectr tensor includ dipolequadrupol quadrupolequadrupol electrostat interact calcul dynam matrix see complementari descript sec v citeromero underli theori test calcul present citeroyo practic level see citeromero way perturb gener finit q alreadi case atom displac enabl us carri analyt third order deriv energi respect two standard perturb momentum q directli provid soughtaft spatial dispers tensor remark virtu n theorem thirdord energi comput one shot use precalcul firstord respons function standard perturb without necess selfconsist comput respons function perturb gradient execut longwav dfpt routin gener deriv databas subsequ use postprocess tool implement anaddb comput print differ contribut fxe tensor dynam quadrupol spatial dispers counterpart born effect charg use lattic dynam calcul improv preval dipoledipol treatment longrang interact anaddb routin carri process interpol dynam matrix follow ref adapt incorpor dipolequadrupol quadrupolequadrupol electrostat interact deriv ref new function result faster converg phonon band calcul respect densiti q point materi repres rout obtain correct sound veloc current implement restrict use normconserv pseudopotenti without nonlinear core correct lda function tutori prepar test testlw_ testlw_ see topiclongwav relev input variabl optdriv new input variabl defin lw_flexo lw_qdrpl prepalw flexoflaganaddb dipquadanaddb quadquadanaddb capabl still develop complet stabl interest user strongli recommend contact miquel royo mroyoicmab massimiliano stengel mstengelicmab start use royo stengel b dftdmft new capabl abinitv relat dftdmft calcul describ fulli sec citegonz follow dftdmft parallel improv larg system particular possibl parallel calcul kpoint bandsgvector use input variabl paral_kgb relat input variabl two new approach ctqmc ad solv aim first one densitydens ctqmc code avail abinit citegonz citebied gener order take account offdiagon element hybrid function implement activ input variabl dmft_solv spinorbit coupl calcul possibl use real valu imaginari time hybrid function solver use ref citeamadon citeamadon second approach use toolbox research interact quantum system triqslibrari citeparcollet opensourc project provid framework manybodi quantum physic specif stronglycorrel electron system triq provid open sourc implement continuoustim hybrid expans quantum impur solver cthyb citeseth consid stateofth art solver multiorbit aim interfac abinit impur solver triqscthyb avail make use independ progress made triq librari also dmft kresolv spectral function avail mr list test testparal_ testparal_ testparal_ testv_ new input variabl dmft_charge_prec dmft_kspectral_func test provid latter also dmft_occnd_imag keep backward compat test cavignac b amadon gingra b spin model within multibinit new capabl multibinit within abinitv describ fulli sec citegonz see also sec dvd particular spin model describ specif sec citegonz avail follow multibinit implement commonli use model spin system via heisenberg hamiltonian includ magnet exchang dzyaloshinskii moriya interact singl ion anisotropi dipoledipol interact also includ term bear strong similar quadrat part lattic model hamiltonian number open sourc spin dynam code alreadi exist uppasd vampir oomf distinguish featur multibinit integr abinit fit paramet simultan dynam degre freedom particular use interatom forc constant tutori multibinit spin model written tutorialspin_model mani new input variabl present test document slc_couplingmultibinitslc_coupl spin_calc_thermo_obsmultibinitspin_calc_thermo_ob spin_dampingmultibinitspin_damp spin_init_orientationmultibinitspin_init_orient spin_init_qpointmultibinitspin_init_qpoint spin_init_rotate_axismultibinitspin_init_rotate_axi spin_init_statemultibinitspin_init_st spin_ntime_premultibinitspin_ntime_pr spin_projection_qpointmultibinitspin_projection_qpoint spin_sia_addmultibinitspin_sia_add spin_sia_kampmultibinitspin_sia_kamp spin_sia_kdirmultibinitspin_sia_kdir spin_temperature_startmultibinitspin_temperature_start spin_temperature_endmultibinitspin_temperature_end spin_temperature_nstepmultibinitspin_temperature_nstep spin_var_temperaturemultibinitspin_var_temperatur spin_write_trajmultibinitspin_write_traj list test addit tutori testv_ testv_ testv_ testv_ testv_ testv_ xu n helbig j bieder e bousquet ph ghosez verstraet namevba b constrain dft constrain densityfunct theori see topicconstraineddft avail new algorithm allow impos constraint arbitrari precis whether relat charg magnet magnet direct magnetis size combin thereof differ atom constraint smear spheric integr ajust sphere radiu center atom algorithm demonstr normconserv pseudopotenti well paw forc deriv respect constraint avail ie magnet torqu noncollinear spin case stress still code avail abinitv abinitv new test v v v new input variabl chrgat constraint_kind ratsm x gonz namevba b larg modif build system build system reli new hostnameac file superceed v hostnameac file fulli document exampl file found docbuildconfigexampl bash script upgradebuildconfigfilesh locat top level directori packag use convert old acformat ac build system abinitv build anymor hard soft depend linalg netcdf hdf libxc wannier sustain three librari mandatori linalg netcdfhdf libxc fail link prevent build abinit librari option warn avail user provid path librari build system tri find usual directori inform user done build system also make suggest user complet ac file special instal note avail help user centosinstall_cento easybuildinstall_easybuild macosinstall_maco ubuntuinstall_ubuntu pouillon jm beuken b new command line interfac new recommend command line interfac run abinit without file file new syntax abinit runabi abinit runabi runlog runerr runabi abinit input file provid inform relat pseudo prefix previous pass via file file comparison old syntax abinit runfil runlog runerr old syntax file extens input file highli recommend exampl use abi default parser use string file extens root build prefix inputoutputtemporari file user specifi name main output file thank output_fil input variabl list pseudopotenti thank pseudo input variabl directori pseudo locat pp_dirpath prefix input output temporari file specifi indata_prefix outdata_prefix tmpdata_prefix respect default set prefix comput basenam input file use variabl specifi input exampl see test testv_ testv_ testv_ see also topiccontrol similar command line interfac also use anaddb code case relev variabl output_fileanaddb ddb_filepathanaddb ddk_filepathanaddb gkk_filepathanaddb eph_prefixanaddb new syntax anaddb runin runlog runerr see test testv_ standard analysi ddb file testv_ old implement electronphonon calcul anaddb import old file file interfac still oper although deprec remov abinit v giantomassi mr b read string input file new mechan read string enclos doubl quotat mark input file activ mani new input keyword read string data often use altern similar input keyword expect numer valu get ird variabl goal encourag new approach perform abinit calcul multipl dataset get variabl replac independ input file connect togeth via file path list new input variabl reli featur getddb_filepath altern getddb irdddb see test testv_ getden_filepath altern getden irdden see test testv_ testv_ getscr_filepath altern getscr irdscr see test testvmbpt_ getwfkfine_filepath altern getwfkfin irdwfkfin see test testv_ testv_ getwfk_filepath altern getwfk irdwfk see test testv_ getwfq_filepath altern getwfq irdwfq see test testv_ getkerange_filepath see test testv_ getpot_filepath see test testv_ pseudo indata_prefix outdata_prefix tmpdata_prefix output_fil see test testv_ pp_dirpath use input file test suit output_fileanaddb ddb_filepathanaddb gkk_filepathanaddb eph_prefixanaddb see test testv_ standard analysi ddb file testv_ old implement electronphonon calcul anaddb giantomassi namevba b yaml section output file yaml section gener output file sometim replac text section sometim provid new inform present yaml section compon total energi gs result includ forc stress well yaml section gw calcul yaml section give inform iter statu exampl test paral vmbpt see input variabl use_yaml document occas develop capabl adapt test farm perl script fldiffpl replac python version see relat inform sec citegonz cavignac giantomassi gm rignanes x gonz b new approach defin crystallin structur abinit input new variabl structur use initi lattic vector atom posit extern file variabl natom ntypat typat znucl automat initi need specifi abinit input present code read netcdf file produc abinit gsrnc wfknc dennc histnc poscar file vasp format see document syntax limit giantomassi b new capabl abipi abiflow abipi abiflow project significantli extend see sec citegonz well galleri plot scriptshttpabinitgithubioabipygalleryindexhtml nbsp galleri abipi workflowshttpabinitgithubioabipyflow_galleryindexhtml nbsp giantomassi g petretto f naccarato c chang develop includ inform compil c python script help abinit develop develop new python script abisrcpi locat top directori abinit packag develop superced abilintpi makemak procedur tri abisrcpi help follow suggest get info file directori interfac visual depend abinit subroutin etc note depend abisrcpi instal prior abl use capabl use pip instal r requirementstxt user instal depend user mode giantomassi c new characterist input variabl descript input variabl eg file abimkdocsvariables_abinitpi new field added_in_vers introduc exampl added_in_vers variabl introduc prior v added_in_versionbefore_v c test farm new obsolet bot bot introduc test farm alps_nag__openmpi atlas_gnu__openmpi buda_gnu__cuda cronos_gnu__par scope_gnu__mpich scope_gnu__dep bot upgrad abiref_gnu__ abiref_gnu__ bob_gnu__openmp bob_gnu__openmp buda_gnu__mpich buda_gnu__mpich graphene_gnu__macport graphene_gnu__macport max_gnu__ max_gnu__ ubu_gnu__openmpi ubu_gnu__openmpi bot remov abiref_nag__openmpi superced alps_nag__openmpi atlas_gnu__fbac nightli test fallback anymor cronos_gnu__paralreplac crono inca_gnu__pyk inca old tikal_gnu_ tikal old work also cronoscrono cluster jm beuken c support compil gfort gnu compil v newli support v obsolet ifort intel compil v newli support nag instead jm beuken c unitari ttranspos test transpos linear algebra kgb parallelis j bieder c linkcheck reenabl intern link check jm beuken mr c enabl gener html sidebysid diff test farm fldiff fail line count error caus crash abinit diff algorithm use special heurist improv line synchron prevent weird match th cavignac mr c split sourc tree ongo order improv modular sourc tree must split two part one lowlevel routin larg independ abinit one specif routin abinit lowlevel routin becom separ librari build system make present lowlevel librari move src insid sharedcommonsrc directori see relat inform sec citegonz c new fft specif build system see httpsgitlababinitorgpouillonabinitissu pouillon mr c reorganis testspsps_for_test directori prepar beautif clarif pseudopotenti recent format legaci pseudopotenti prepar beautif x gonz mr namevda chang ongo develop yet final miscellan improv multibinit lattic part miscellan improv made lattic part multibinit see new input variabl also see sec citegonz new test testv_ testv_ testv_ testv_ testv_ testv_ testv_ testv_ testv_ testv_ new input variabl list new input variabl present automat test though analyze_anh_potmultibinitanalyze_anh_pot dyn_chksymmultibinitdyn_chksym dyn_tolsymmultibinitdyn_tolsym fit_efsmultibinitfit_ef fit_iatommultibinitfit_iatom fit_spc_maxsmultibinitfit_spc_max latt_frictionmultibinitlatt_frict latt_taupmultibinitlatt_taup test latt_tautmultibinitlatt_taut opt_coeffmultibinitopt_coeff opt_effpotmultibinitopt_effpot opt_ncoeffmultibinitopt_ncoeff sel_efsmultibinitsel_ef strfactmultibinitstrfact test_effpotmultibinittest_effpot test_prt_phmultibinittest_prt_ph ts_optionmultibinitts_opt test final sever input variabl main abinit applic also reus multibinit without modif mean like iatfix natfix relat similar input variabl also tolmxf schmitt xu f ricci verstraet ph ghosez miscellan improv chern number orbit magnet calcul includ parallel k point chern number calcul j zwanzig mr calcul debyewal tensor new test testv_ giantomassi speedup suscept matrix calcul gw analyt continu calcul see new input variabl gwaclowrank new test testv_ f brunev mr ncpp wavefunct mix variat energi minor improv prepar pawhybrid variat energi new test testv_ simpl system test hartreefock scf algorithm x gonz mr new weight distribut fourier compon forc constant test toler new integr weight test testv_ testv_ testv_ h miranda giantomassi test calcul veloc matrix element ddk optdriv wfk_task wfk_ddk see testv_ giantomassi upgrad tutorialparal_gspw new version auto paral thread torrent mr test wannier interfac nsppol nspden testwannier_ xu mix precis fft transform new input variabl mixprec see testv_ testv_ testv_ testv_ giantomassi mr multibinit interfac scaleuphttpswwwsecondprinciplesunican marcu schmitt jordan bieder matthieu verstraet philipp ghosez follow unit also allow input file sec second abinit input file nm nanomet abinit anaddb input file atdep util ad guideatdepatdep user guid topicatdepatdep topic correspond input variabl document refer pdfatdep_paperatdep paper also see sec citegonz f bottin j bouchet j bieder mr improv nlo calcul optim memori alloc particular usepead write raman suscept netcdf anaddb g petretto mr metagga paw progress intern unit test ok implement seem close end still need perform physic test torrent jb charraud mr implement altern version mpi reduct valid number data exce torrent mr build system src support llvm clangflang arm armflangarmclangarmpl torrent mr improv core wf read optic electronpositron torrent mr fix bootstrap kernel converg issu wei chen mr upgrad version librari use abinit upgrad atompaw upgrad libxc prepar interfac libxc bit libxc torrent jm beuken mr write yaml file fatband phonopi format atdep j bieder mr write polar vector gsrnc h miranda mr updat user interfac raman_specpi ad one section tutori nlo describ use raman_specpi n pike mr mr xml format core wavefunct f jollet mr wavefunct predict molecular dynam f jollet mr ad preview toptic_abi file optic tutori f goudreault mr improv elpa detect make abinit compat elpa torrent mr upgrad tutorialbas tutorialbasepar x gonz mr new input variabl prtprocar see test testv_ verstraet mr abinit input variabl supercell_latt document see also testv_ x gonz new implement crpa comput u j dftu dftdmft consid subset orbit system compil bit long certain compil new keyword ad build system enable_crpa_optim enable_crpa_no_optim r outerov b amadon mr namevda ongo work refactor coulomb interact part abinit new input variabl fock_icutcoul gw_icutcoul superce icutcoul new test ad minibrillouin zone integr gw_icutcoul see testv_ b guster giantomassi f brunev x gonz mr new tbj python script comput superexchang j dzyaloshinskiimoriya dmi interact script found httpgitlababinitorgxuhetbjhttpgitlababinitorgxuhetbj doc tutori script interfac wannier use w output file j calcul work product dmi much sensit disentangl nois use care articl construct describ method implement script deliv input data file spin model multibinit xu verstraet e bousquet mr test linear electroopt coeffici tutorespfn testoptic_ n pike mr optic print spindecomposit applic fix reflect screw result test thoroughli optic incl interfac use netcdf see new test testv_ testv_ also testv_ testv_ x gonz mr fix dfptpawggausexcnhatq bug also add new relat test testv_ testv_ torrent x gonz mr updat paw tutori f jollet mr nonlinear xc preliminari preliminari work chang exchang correl term nonlinear rd order dfpt one term implement pead dfptnl routin merg one routin dfptnl_exc due subtl reorder nonlinear core correct term pead ref chang final result first order chang electron dielectr suscept tensor remain l baguet mr anaddb output data prefix former write anaddbnc fix path fix name made flexibl introduc prefix j bieder xu mr new macro input variabl expert_us nonzero expert_us automat switch check done chkprim chkdilatmx chksymbreak chksymtnon x gonz mr miscellan addit bug fix improv document includ build system g antoniu l baguet jm beuken j bieder e bousquet f brunev cavignac giantomassi x gonz f jollet r outerovitch n pike pouillon royo torrent j van bever verstraet xu v version releas march list chang respect version mani thank contributor abinit project octob march releas note rel modificationsimprov abinit v respect v merg request includ mr taken account list contributor includ b amadon l baguet jm beuken j bieder j bouchet e bousquet f brunev g brunin wei chen jb charraud ph ghosez giantomassi gingra x gonz f goudreault b guster g hautier xu n helbig f jollet h miranda f naccarato r outerov g petretto n pike pouillon f ricci royo schmitt stengel torrent j van bever verstraet j zwanzig worth read care modif mention present file examin link help file test case might take time xavier import remark warn occas switch abinitv abinitv mani improv format content file written abinit made backward compat abinitv may broken present abinitv consid product version beta releas allow develop get feedback user mani featur work correctli cours still beginn advis stick abinitv except abinitv appropri work particular build system reli new ac file see bvb superceed v ac file bash script upgradebuildconfigfilesh locat top level directori packag use convert old acformat ac build system abinitv build anymor hard depend linalg netcdf hdf libxc sustain see bvb nowaday user instal prerequisit librari main abinit output file contain section written yaml sometim replac text section sometim ad inform mean userdevelop pars tool might work anymor adapt new abinitv output file see bvb note yaml output still develop modif may appear next version python api extract result calcul provid implement final sever default valu chang see ava new account abinit effort publish comput phi comm citegonz provid descript sever new featur version paper format comput phi comm also availablehttpswwwabinitorgsitesdefaultfilesabinitpdf licenc allow author put web second new account abinit effort publish j chem phi citeromero scope second paper differ first one survey abinit focus specif capabl still contain also descript new featur version paper format j chem phi also availablehttpswwwabinitorgsitesdefaultfilesabinit_jpcpdf licenc allow author put web specif public mention suggest acknowledg pagetheoryacknowledg namevaa default valu follow abinit input variabl chang ixcrot chneut ntime symsigma prtkden initi wavefunct paral_kgb nspinor chang sinc previou one could prevent code converg torrent mr input variabl xangst disabl use xcart instead specifi unit name angstrom name tdep main execut chang tdep atdep line citeromero b notic achiev b electronphonon interact mobil selfenergi relax time approxim temperaturedepend electron band structur includ zeropoint renorm etc new capabl abinitv relat electronphonon calcul describ fulli sec citegonz follow abinit v possibl comput eph selfenergi kohnsham represent use eph matrix element code employ optim algorithm comput either full selfenergi need qp correct spectral function imaginari part use evalu mobil within selfenergi relax time approxim serta comput mobil fulli integr insid abinit automat output comput imaginari part selfenergi bypass need postprocess result comput full selfenergi possibl reduc number empti state requir converg use firstord wavefunct obtain solv relev sternheim equat case lifetim comput code take advantag tetrahedron method filter contribut qpoint doublegrid integr techniqu acceler converg margin addit comput cost sampl relev region brillouin zone contribut transport properti thu lead signific reduct comput effort crystallin symmetri use throughout code order reduc number k qpoint must explicitli includ integr achiev good parallel effici cpu demand part parallel mpi employ distribut scheme kqpoint perturb band band level avail comput full selfenergi moreov interpol dfpt potenti describ sec citegonz fulli oper mani test provid list test testv_ testv_ testv_ new input variabl dvdb_qcache_mb eph_phrang eph_tols_idelta eph_ecutosc eph_restart eph_stern eph_use_ftinterp getdvdb getdvdb_filepath getkerange_filepath irddvdb prteliash sigma_bsum_rang sigma_erang sigma_ngkpt sigma_nshiftk sigma_shiftk symvscf note new eph process unit abinit optdriv differ implement one implement anaddb new set tutori prepar made avail forthcom version detail implement pleas consult preprinthttpsarxivorgab g brunin h miranda giantomassi gm rignanes g hautier b flexoelectr dynam quadrupol new driver includ abinit allow one comput spatial dispers tensori quantiti clampedion flexoelectr tensor dynam quadrupol first moment ifc matrix first moment piezoelectr forc respons tensor precalcul ground state first second d_dkdk order respons function requir execut driver creat rd order energi deriv databas file use anaddb comput mix latticemedi flexoelectr tensor includ dipolequadrupol quadrupolequadrupol electrostat interact calcul dynam matrix see complementari descript sec v citeromero underli theori test calcul present citeroyo practic level see citeromero way perturb gener finit q alreadi case atom displac enabl us carri analyt third order deriv energi respect two standard perturb momentum q directli provid soughtaft spatial dispers tensor remark virtu n theorem thirdord energi comput one shot use precalcul firstord respons function standard perturb without necess selfconsist comput respons function perturb gradient execut longwav dfpt routin gener deriv databas subsequ use postprocess tool implement anaddb comput print differ contribut fxe tensor dynam quadrupol spatial dispers counterpart born effect charg use lattic dynam calcul improv preval dipoledipol treatment longrang interact anaddb routin carri process interpol dynam matrix follow ref adapt incorpor dipolequadrupol quadrupolequadrupol electrostat interact deriv ref new function result faster converg phonon band calcul respect densiti q point materi repres rout obtain correct sound veloc current implement restrict use normconserv pseudopotenti without nonlinear core correct lda function tutori prepar test testlw_ testlw_ well specif topic new input variabl defin lw_flexo lw_qdrpl prepalw flexoflaganaddb dipquadanaddb quadquadanaddb capabl still develop complet stabl interest user strongli recommend contact miquel royo mroyoicmab massimiliano stengel mstengelicmab start use royo stengel giantomassi b dftdmft new capabl abinitv relat dftdmft calcul describ fulli sec citegonz follow dftdmft parallel improv larg system particular possibl parallel calcul kpoint bandsgvector use input variabl paral_kgb relat input variabl two new approach ctqmc ad solv aim first one densitydens ctqmc code avail abinit citegonz citebied gener order take account offdiagon element hybrid function implement activ input variabl dmft_solv spinorbit coupl calcul possibl use real valu imaginari time hybrid function solver use ref citeamadon citeamadon second approach use toolbox research interact quantum system triqslibrari citeparcollet opensourc project provid framework manybodi quantum physic specif stronglycorrel electron system triq provid open sourc implement continuoustim hybrid expans quantum impur solver cthyb citeseth consid stateofth art solver multiorbit aim interfac abinit impur solver triqscthyb avail make use independ progress made triq librari also dmft kresolv spectral function avail mr list test testparal_ testparal_ testparal_ testv_ new input variabl dmft_charge_prec dmft_kspectral_func test provid latter also dmft_occnd_imag keep backward compat test cavignac b amadon gingra b spin model within multibinit new capabl multibinit within abinitv describ fulli sec citegonz see also sec dvd particular spin model describ specif sec citegonz avail follow multibinit implement commonli use model spin system via heisenberg hamiltonian includ magnet exchang dzyaloshinskii moriya interact singl ion anisotropi dipoledipol interact also includ term bear strong similar quadrat part lattic model hamiltonian number open sourc spin dynam code alreadi exist uppasd vampir oomf distinguish featur multibinit integr abinit fit paramet simultan dynam degre freedom particular use interatom forc constant tutori multibinit spin model written tutorialspin_model mani new input variabl present new input variabl present automat test though betareleas nontest input variabl indic nt complet product version v list test addit tutori testv_ testv_ testv_ testv_ new input variabl test document spin_calc_thermo_obsmultibinitspin_calc_thermo_ob spin_dampingmultibinitspin_damp spin_init_orientationmultibinitspin_init_orient spin_init_qpointmultibinitspin_init_qpoint spin_init_rotate_axismultibinitspin_init_rotate_axi spin_init_statemultibinitspin_init_st spin_ntime_premultibinitspin_ntime_pr spin_projection_qpointmultibinitspin_projection_qpoint spin_sia_addmultibinitspin_sia_add spin_sia_kampmultibinitspin_sia_kamp spin_sia_kdirmultibinitspin_sia_kdir spin_temperature_startmultibinitspin_temperature_start spin_temperature_endmultibinitspin_temperature_end spin_temperature_nstepmultibinitspin_temperature_nstep spin_var_temperaturemultibinitspin_var_temperatur spin_write_trajmultibinitspin_write_traj additionn new input variabl slc_couplingmultibinitslc_coupl nt spin_calc_correlation_ob nt document spin_calc_traj_ob nt document spin_projection_qpointmultibinitspin_projection_qpoint nt xu n helbig j bieder e bousquet ph ghosez verstraet b constrain dft constrain densityfunct theori see topicconstraineddft avail new algorithm allow impos constraint arbitrari precis whether relat charg magnet magnet direct magnetis size combin thereof differ atom constraint smear spheric integr ajust sphere radiu center atom algorithm demonstr normconserv pseudopotenti well paw forc deriv respect constraint avail ie magnet torqu noncollinear spin case stress still code avail abinitv new test v v v new input variabl chrgat constraint_kind ratsm x gonz namevba b larg modif build system build system reli new hostnameac file superceed v hostnameac file fulli document exampl file found docbuildconfigexampl bash script upgradebuildconfigfilesh locat top level directori packag use convert old acformat ac build system abinitv build anymor hard soft depend linalg netcdf hdf libxc wannier sustain three librari mandatori linalg netcdfhdf libxc fail link prevent build abinit librari option warn avail user provid path librari build system tri find usual directori inform user done build system also make suggest user complet ac file pouillon jm beuken b new command line interfac new recommend command line interfac run abinit without file file new syntax abinit runabi abinit runabi runlog runerr runabi abinit input file provid inform relat pseudo prefix previous pass via file file comparison old syntax abinit runfil runlog runerr old syntax file extens input file highli recommend exampl use abi default parser use string file extens root build prefix inputoutputtemporari file user specifi name main output file thank output_fil input variabl list pseudopotenti thank pseudo input variabl directori pseudo locat pp_dirpath prefix input output temporari file specifi indata_prefix outdata_prefix tmpdata_prefix respect default set prefix comput basenam input file use variabl specifi input exampl see test testv_ testv_ testv_ see also topiccontrol similar command line interfac also use anaddb code case relev variabl output_fileanaddb ddb_filepathanaddb ddk_filepathanaddb gkk_filepathanaddb eph_prefixanaddb new syntax anaddb runin runlog runerr see test testv_ standard analysi ddb file testv_ old implement electronphonon calcul anaddb import old file file interfac still oper although deprec remov abinit v giantomassi mr b read string input file new mechan read string enclos doubl quotat mark input file activ mani new input keyword read string data often use altern similar input keyword expect numer valu get ird variabl goal encourang new approach perform abinit calcul multipl dataset get variabl replac indipend input file connect togeth via file path list new input variabl reli featur getddb_filepath altern getddb irdddb see test testv_ getden_filepath altern getden irdden see test testv_ testv_ getscr_filepath altern getscr irdscr see test testvmbpt_ getwfkfine_filepath altern getwfkfin irdwfkfin see test testv_ testv_ getwfk_filepath altern getwfk irdwfk see test testv_ getwfq_filepath altern getwfq irdwfq see test testv_ getkerange_filepath see test testv_ getpot_filepath see test testv_ pseudo indata_prefix outdata_prefix tmpdata_prefix output_fil see test testv_ pp_dirpath test explicitli system depend use runtestspi gener input file output_fileanaddb ddb_filepathanaddb gkk_filepathanaddb eph_prefixanaddb see test testv_ standard analysi ddb file testv_ old implement electronphonon calcul anaddb giantomassi namevba b yaml section output file yaml section gener output file sometim replac text section sometim provid new inform present yaml section compon total energi gs result includ forc stress well yaml section gw calcul yaml section give inform iter statu exampl test paral vmbpt see input variabl use_yaml document occas develop capabl adapt test farm perl script fldiffpl replac python version see relat inform sec citegonz cavignac giantomassi gm rignanes x gonz b new approach defin crystallin structur abinit input new variabl structur use initi lattic vector atom posit extern file variabl natom ntypat typat znucl automat initi need specifi abinit input present code read netcdf file produc abinit gsrnc wfknc dennc histnc poscar file vasp format see document syntax limit giantomassi b new capabl abipi abiflow abipi abiflow project significantli extend see sec citegonz well galleri plot scriptshttpabinitgithubioabipygalleryindexhtml nbsp galleri abipi workflowshttpabinitgithubioabipyflow_galleryindexhtml nbsp giantomassi g petretto f naccarato c chang develop includ inform compil c python script help abinit develop develop new python script abisrcpi locat top directori abinit packag develop superced abilintpi makemak procedur tri abisrcpi help follow suggest get info file directori interfac visual depend abinit subroutin etc note depend abisrcpi instal prior abl use capabl use pip instal r requirementstxt user instal depend user mode giantomassi c new characterist input variabl descript input variabl eg file abimkdocsvariables_abinitpi new field added_in_vers introduc exampl added_in_vers variabl introduc prior v added_in_versionbefore_v c test farm new obsolet bot bot introduc test farm atlas_gnu__openmpi buda_gnu__cuda cronos_gnu__par bot upgrad abiref_gnu__ abiref_gnu__ abiref_nag__openmpi abiref_nag__openmpi bob_gnu__openmp bob_gnu__openmp buda_gnu__mpich buda_gnu__mpich graphene_gnu__macport graphene_gnu__macport max_gnu__ max_gnu__ ubu_gnu__openmpi ubu_gnu__openmpi bot remov atlas_gnu__fbac nightli test fallback anymor cronos_gnu__paralremplac crono inca_gnu__pyk inca old tikal_gnu_ tikal old work also cronoscrono cluster jm beuken c support compil gfort gnu compil v newli support v obsolet ifort intel compil v newli support nag instead jm beuken c unitari ttranspos test transpos linear algebra kgb parallelis j bieder c linkcheck reenabl intern link check jm beuken mr c enabl gener html sidebysid diff test farm fldiff fail line count error caus crash abinit diff algorithm use special heurist improv line synchron prevent weird match th cavignac mr c split sourc tree ongo order improv modular sourc tree must split two part one lowlevel routin larg independ abinit one specif routin abinit lowlevel routin becom separ librari build system make present lowlevel librari move src insid sharedcommonsrc directori see relat inform sec citegonz c new fft specif build system see httpsgitlababinitorgpouillonabinitissu pouillon mr namevda chang ongo develop yet final miscellan improv multibinit lattic part miscellan improv made lattic part multibinit see new input variabl also see sec citegonz new test testv_ testv_ testv_ testv_ testv_ testv_ testv_ new input variabl list new input variabl present automat test though betareleas nontest input variabl indic nt also document partli document eg variabl type acronym default complet product version v analyze_anh_potmultibinitanalyze_anh_pot fit_spc_maxsmultibinit nt fit_iatommultibinit testparal_ testparal_ testv_ testv_ document latt_compressibilitymultibinit test document latt_frictionmultibinitlatt_frict latt_maskmultibinit test document latt_taupmultibinitlatt_taup despit link test partli document latt_tautmultibinitlatt_taut despit link partli document opt_coeffmultibinitopt_coeff opt_effpotmultibinitopt_effpot opt_ncoeffmultibinitopt_ncoeff prt_name test document test_effpotmultibinittest_effpot v schmitt xu f ricci verstraet ph ghosez miscellan improv chern number orbit magnet calcul includ parallel k point chern number calcul j zwanzig mr calcul debyewal tensor new test testv_ giantomassi test linear electroopt coeffici tutorespfn testoptic_ n pike mr ncpp wavefunct mix variat energi minor improv prepar pawhybrid variat energi new test testv_ simpl system test hartreefock scf algorithm x gonz mr new weight distribut fourier compon forc constant test toler new integr weight test testv_ testv_ testv_ h miranda giantomassi test calcul veloc matrix element ddk optdriv wfk_task wfk_ddk see testv_ giantomassi upgrad tutorialparal_gspw new version auto paral thread torrent mr test wannier interfac nsppol nspden testwannier_ xu mix precis fft transform new input variabl mixprec see testv_ testv_ testv_ testv_ giantomassi mr multibinit interfac scaleup httpswwwsecondprinciplesunican marcu schmitt jordan bieder matthieu verstraet philipp ghosez follow unit also allow input file sec second abinit input file nm nanomet abinit anaddb input file atdep util ad guideatdepatdep user guid topicatdepatdep topic correspond input variabl document refer pdfatdep_paperatdep paper also see sec citegonz f bottin j bouchet j bieder mr improv nlo calcul optim memori alloc particular usepead write raman suscept netcdf anaddb g petretto mr metagga paw progress intern unit test ok implement seem close end still need perform physic test torrent jb charraud mr implement altern version mpi reduct valid number data exce torrent mr build system src support llvm clangflang arm armflangarmclangarmpl torrent mr improv core wf read optic electronpositron torrent mr fix bootstrap kernel converg issu wei chen mr upgrad version librari use abinit upgrad atompaw upgrad libxc torrent jm beuken mr write yaml file fatband phonopi format atdep j bieder mr write polar vector gsrnc h miranda mr updat user interfac raman_specpi ad one section tutori nlo describ use raman_specpi n pike mr mr xml format core wavefunct f jollet mr wavefunct predict molecular dynam f jollet mr ad preview toptic_abi file optic tutori f goudreault mr improv elpa detect make abinit compat elpa torrent mr upgrad tutorialbas tutorialbasepar x gonz mr new input variabl prtprocar see test testv_ verstraet mr abinit input variabl supercell_latt document see also testv_ x gonz new implement crpa comput u j dftu dftdmft consid subset orbit system compil bit long certain compil new keyword ad build system enable_crpa_optim enable_crpa_no_optim r outerov b amadon mr work refactor coulomb interact part abinit b guster giantomassi x gonz mr new tbj python script comput superexchang j dzyaloshinskiimoriya dmi interact script found httpgitlababinitorgxuhetbjhttpgitlababinitorgxuhetbj doc tutori script interfac wannier use w output file j calcul work product dmi much sensit disentangl nois use care articl construct describ method implement script deliv input data file spin model multibinit xu verstraet e bousquet miscellan addit bug fix improv document l baguet jm beuken j bieder e bousquet f brunev cavignac giantomassi x gonz f jollet n pike pouillon torrent j van bever verstraet xu v version releas octob list chang respect version mani thank contributor abinit project april octob releas note rel modificationsimprov abinit v respect v merg request first mr report releas note also includ list contributor includ b amadon g antoniu l baguet jm beuken j bieder e bousquet f brunev wei chen cote j denier g genest ph ghosez giantomassi gingra x gonz f goudreault b guster xu jia f jollet lherbier martin h miranda f naccarato g petretto n pike ponc pouillon prokhorenko f ricci torrent van setten b van troey verstraet j zwanzig worth read care modif mention present file examin link help file test case might take time xavier warn import remark correct definit temperatur implement isokinet algorithm ionmov multibinit input variabl supercel renam supercell_latt test v move v test paral move paral b notic achiev b comput raman intens dfpt paw possibl avail norm conserv psp previous base secondord sternheim equat deriv respect electr field see test testv_ testv_ l baguet torrent b larg effort clean document need made possibl thank recent move mkdoc system particular mani new hyperlink creat dozen markdown file refer central theorybibliographi b amadon g antoniu l baguet j bieder e bousquet f brunev wei chen cote g genest giantomassi x gonz xu f jollet lherbier h miranda f naccarato g petretto n pike ponc pouillon torrent van setten b van troey verstraet j zwanzig b multibinit applic secondprincipl calcul consider progress document thu set topic written well tutori addit alreadi exist input variabl document test case see topiclatticemodel topicboundingprocess topicfitprocess topicdynamicsmultibinit hub relev tutori input variabl test case eg lessonlattice_modeltestv_ testv_ martin collabor fabio ricci ph ghosez b sever new option avail ionmov input variabl govern ionic dynam geometri optim ionmov fire algorithm testv_ ionmov isokinet ensembl fix atom posit allow testv_ testv_ also document hybrid mont carlo algorithm improv see testv_ new input variabl hmcsst hmctt xu prokhorenko x gonz b linear combin imag allow new valu input variabl imgmov mix factor given mixesimgf case total energi forc also assembl linear combin geometri optim use algorithm select usual ionmov input variabl see test testv_ wavefunct previou itimimag valu see ntimimag input variabl store use new input variabl imgwfstor allow save cpu time expens memori imag base algorithm x gonz test jia b tutori tutorialnuc section comput isom shift mossbauer spectroscopi base fermi contact interact j zwanzig b frohlich model implement electronphonon part abinit optdriv frohlich averag effect mass comput dfpt comput effect mass see testv_ also zeropoint renorm band extrema comput use gener formula valid isotrop anisotrop solid well nondegener degener extrema see eph_frohlichm testv_ x gonz c chang develop also compil c f abinit sourc insid modul makemak abort f procedur outsid modul giantomassi help j zwanzig torrent b amadon c prepar remov bind subsystem pouillon torrent c new howto developersdevelopersdevelopers_howto variabl mkparent robodoc test_suit giantomassi c new howto test suitedeveloperstestsuite_howto giantomassi chang ongo develop yet final new input variabl prtkbff input variabl activ output kleynmanbyland form factor netcdf wfk file produc end groundstat calcul form factor need comput matrix element commut vnl r nonloc part nc pseudopotenti wfk file therefor use perform optic andor manybodi calcul extern code dpexc yambo option ignor paw h miranda giantomassi new routin calcul write ddk matrix element evknc file normconserv pseudopotenti nspinor wfk file use commut h r use calcul matrix element chi file format contain inform evknc file former ddknc produc dfpt part code routin parallel kpoint band requir much smaller memori footprint dfpt code h miranda giantomassi new input variabl slk_rankpp variabl control number process use scalapack diagon algorithm np_slk calcul accord valu j bieder new input variabl prtefma irdefma getefma deal effect mass eg allow feed comput effect mass one dataset anoth one x gonz spin dynam implement multibinit xu new valu input variabl usepawu fll doubl count use howev comparison usepaw calcul done without polar exchang correl function b amadon new extens test dfptpawgga see testv_ howev pawxcdev still need torrent new input variabl prtfullwf print full perturb wavefunct g antoniu allow one suppress complet dte vanish element use symmetri neg valu rfmeth x gonz interfac triqs_ gingra allow defin differ occup differ spin occopt nsppol x gonz neb test last testv_ x gonz mani abitutori improv x gonz work orbit magnet j zwanzig elast piezoelectr tensor netcdf format giantomassi allow boxcutmin dfpt case check h miranda abiwannc file wannier output analyz wit abipi see abiwanfilenb futher inform giantomassi topicmacroav creat x gonz includ ctqmc code use non diagon hybrid function see testparal_ b amadon j denier j bieder final scalapackelpa integr lobpcg use openmp warn scalapack threadsaf gener j bieder automat test testv_ tdep applic j bieder python script calcul physic properti deriv elast tensor result anaddb calcul n pike miscellan addit bug fix improv document b amadon g antoniu l baguet jm beuken j bieder f goudreault f jollet h miranda f nacaratto n pike torrent verstraet v version releas april list chang respect version mani thank contributor abinit project novemb april releas note rel modificationsimprov abinit v respect v merg request first mr report releas note list contributor includ b amadon g antoniu l baguet jm beuken j bieder f bottin bouchet e bousquet w chen c espejo ph ghosez giantomassi x gonz f jollet martin h miranda g petretto n pike pouillon prokhorenko f ricci gm rignanes torrent verstraet j zwanzig worth read care modif mention present file examin link help file test case might take time xavier warn import remark due avail new input variabl obsolet input variabl suppress input variabl cgtyphf see fockoptmix input variabl gwfockmix see hyb_mix hyb_mixing_sr algorithm use comput weight phonon band structur interpol anaddb case bravanaddb chang see b test v move v replac tribe relev doctop replac eelf file extens elf see prtelf guido petretto definit maxim valu dilatmx bypass set chkdilatmx prevent user slow abinit much inadvertantli b notic achiev b whole abinit document place control mkdocshttpwwwmkdocsorg file translat markdown well still remain file place system quit capabl develop vv topic b central bibliographi b restructur searcheabl list input variabl b frequenc statist b maintain consolid document avail develop whole system better integr easier maintain appear also new work document nearli complet still bibliograph refer doc enter central bibliograph databas entri point see new header abinit document file eg new user guideguidenew_us giantomassi help x gonz b dfpt extend noncollinear system nspden without spinorbit coupl ddk electr field atom displac perturb well zeeman magnet field perturb see b see test testv_ testv_ expert see new input variabl ixcrot f ricci prokhorenko verstraet torrent e bousquet b dfpt treat magnet field perturb zeeman interact magnet field coupl spin see input variabl rfmagn well test testv_ testv_ new input variabl timrev introduc allow treat perturb nonzero q wavevector prokhorenko e bousquet b python librari abipyhttpsgithubcomabinitabipi launch abinit also highthroughput mode jupyt notebook base tutori nicknam abitutorialshttpsgithubcomabinitabitutori suffici matur advertis use ictp electronphonon doctor school march feedback abipi abitutori welcom giantomassi b new algorithm wignerseitz cell base comput weight phonon band structur interpol anaddb implement replac old algorithm case bravanaddb old algorithm still avail backcompat purpos correspond bravanaddb see testv_ although real reason use new algorithm gener respect better symmetri even superced use valu bravanaddb g petretto follow discuss gm rignanes xgonz test henriqu pereira miranda b chern number comput normconserv case well paw case see theori citeceresoli associ input variabl orbmag nuclear magnet dipol moment code improv effici particular improv due convert nucdipmom_k complex type explicit bla call tutori tutorialnucnuc nightli test j zwanzig tutorialnucnuc test x gonz c chang develop also compil c add support nag use netcdf hdf nag new builder abiref_nag__openmpi atlas_gnu__fb c new version elpa modul compat torrent c replac httpwwwabinitorg httpswwwabinitorg everywher doc jm beuken c ad fake nnosplit option makemak littl chang let test farm keep work branch sourc tree split common core pouillon c upgrad abinit psml api pouillon c allow freeform link flag statement configur option pouillon c intel offici support one bot use present test farm situat perfect though mrgscr mrgdv advanceno specif write instruct work work simpl program thu test chain test reli mrgscr mrgdv disabl compil name v vvmbpt v v v also read wfk file use mpiio correct test mpiio chang ongo develop yet final implement lda methodolog see announc b v testv_ provid f jollet numer progress made relat hybrid function although hybrid function yet product stress comput correctli downsampl brillouin zone build fock oper implement test see input variabl fockdownsampl well test testlibxc_ testparal_ blyp function implement ixc new input variabl hyb_mix hyb_mixing_sr hyb_range_dft hyb_range_fock give suffici flexibl pbe hse famili function gw calcul start top hybrid function calcul varianc also flexibl run hybrid calcul use gw infrastructur gwcalctyp definit ixc_sigma input variabl also import work concern selfconsist although work final yet one reason hybrid function yet product selfconsist fix ace oper take advantag auxiliari xc function decreas number inner iter see fockoptmix auxc_ixc auxc_scal outer loop ace oper upgrad wavefunct mix implement fockoptmix wfmix see new test v libxc also updat test v vmbpt v libxc paral x gonz f jollet help torrent tutorialtdepestutori temperaturedepend electron structur upgrad care test see test tutorespfntdep x gonz giantomassi output interpol densiti mpiio case test testmpiio_ testmpiio_ ongo work multibinit project new input variabl fit_nfixcoeff fit_fixcoeff fix_generateterm see testv_ testv_ new input variabl dipdip_prt see testv_ well test testparal_ paral new gener polynomi coeffici debug strain fit process add toler fit process add plot comparison model dft martin verstraet ph ghosez adjust tutori tutopar ucrpa see test tutoparaltucrpa_ b amadon ddk file avail netcdf format lightweight version without firstord wavefunct test optic postprocessor set see new testv_ giantomassi continu develop electronphonon optdriv modul abinit new input variabl tmesh defin linear mesh temperatur see test testv_ testv_ also debug improv doc giantomassi ad netcdf output phonon full grid band structur tetrahedron prtdo case verstraet ongo develop main execut atdep tdep algorithm hellman cowork see src_maintdepf well directori _tdep automat test provid yet document well f bottin j bouchet j bieder capabl print perturb vxc potenti respons function calcul g antoniu ongo modular sourc f file get rid abilint giantomassi ongo improv doc benefit new process capabl like central bibliographi matjax etc giantomassi x gonz postprocess script raman calcul scriptpostprocessingraman_specpi read anaddb output file extract raman tensor calcul raman spectra function frequenc userdefin temperatur addit script automat extract dielectr tensor function frequenc avail n pike refactor dfptnon_col first version paw torrent fix sever bug constrain magnet calcul magconon e bousquet wrong sign deriv spheric harmon f orbit lead problem bse gw calcul pseudo explicit fprojector use detect correct henriqu pereira miranda see gitshadbeafbbdddecf correct express add possibl dftu calcul without spin polar exchang correl function spin polar thu come u j term use usepawu still test b amadon gw avail nspinor without spinorbit coupl nspden collinear noncollinear spinmagnetis implement normconserv case still test see test testv_ testv_ giantomassi miscellan addit bug fix improv document l baguet w chen c espejo giantomassi pouillon torrent j zwanzig v mani thank contributor abinit project may octob releas note rel modificationsimprov abinitv respect v list contributor includ b amadon g antoniu l baguet jm beuken j bieder f bottin bouchet e bousquet giantomassi gingra ph ghosez giantomassi x gonz f jollet j junquera martin f naccarato g petretto n pike pouillon prokhorenko torrent verstraet j wiktor j zwanzig worth read care modif mention present file examin link help file test case might take time xavier version releas novemb list chang respect version warn import remark interfac abinit triq chang triq use instead triq backward compat triq code sorri see chang name input variabl gwls_sternheimer_kmax becom gwls_stern_kmax input variabl gwls_dielectric_model becom gwls_diel_model input variabl prt_effpot becom prt_model multibinit input variabl input variabl effmass becom effmass_fre tutori tlda becom tdftu also input variabl gwls_second_model_paramet use suppress definit hund coupl j comput within crpa chang use convent convent use variabl jpawu dftu dftdmft abinit automat test tutori accordingli chang b amadon b notic achiev b whole abinit document significantli improv introduct topic replac previou list abinit featur capabl abinit present short topic web page topic web page usual brief introduct list relat tutori list relat input variabl order accord import topic compulsori basic use expert possibl exampl input file list refer entri point see new header abinit document file eg new user guideguidenew_us f jollet x gonz also testsfix b amadon torrent b central theorybibliographi databas abirefbib creat link abovement topic b also part abinit document eg input variabl list tutori theori document acknowledg bibliograph refer present bibliograph refer doc enter central bibliograph databas though x gonz f jollet b list input variabl restructur searchabl input variabl anaddb aim optic includ databas j bieder x gonz f jollet b frequenc usag input variabl set automat test automat comput mention document input variabl exampl input file also mention document input file automat test directli access web well refer file tutori x gonz f jollet b sever import develop relat electronphonon matrix element comput made frohlich interpol procedur electronphonon matrix element explain prl implement longrang part phonon coupl potenti model born effect charg dielectr tensor longrang part substract potenti fourier interpol ad interpol result potenti much better agreement full calcul verifi elph matrix element also function ad eph driver eph_task interpol phonon potenti onto fine qpoint grid interpol perform one perturb time thu memori effici previou procedur addit test new driver optdriv specif deal electronphonon relat comput includ zeropoint renormalis especi interpol symmetri fix see new test testv_testv_ g antoniu giantomassi b abinit read pseudopotenti psml format describ httpsarxivorgab xmlbase format produc oncvpsp well siesta atom allow perform calcul exact pseudopotenti file abinit siesta see new directori abinittestspsml test testpsml_ testpsml_ note patch provid httpslaunchpadnetpspgenpatch enabl psml output oncvpsp pouillon verstraet j junquera garcia b abinit interfac libxc interfac libxc prepar test testlibxc_ testlibxc_ testlibxc_ testlibxc_ testlibxc_ testlibxc_ modifi function libxc v chang categori v torrent b new tutori call tutorialpositronelectronpositron annihil creat j wiktor torrent b new input variabl chkdilatmx introduc allow expert user make abinit bypass stop criterion relat dilatmx practic condit relat dilatmx met abinit continu deliv approxim optim geometri energi might use extern driver like eg uspex continu search global optim structur see input variabl chkdilatmx test testv_ x gonz b implement lda methodolog test provid f jollet c chang develop also compil c larg chang procedur document abinit document file html file produc yaml file control script abinitdocgenerate_docpi document describ procedur avail abinit wiki httpswikiabinitorgdokuphpiddevelopersgenerate_doc directli link modif doc present bb particular dokuwiki syntax use hyperlink f jollet x gonz chang ongo develop yet final adapt compress oper approach fast applic fock oper implement replac tradit way appli fock oper hybrid function eg hse pbe hybrid function yet consid product though see like abinitv see test libxc also v f jollet x gonz set input file accompani refer proc benchmark highperform comput avail new directori abinittestshpc yet test automat futur capabl prepar torrent tutori temperaturedepend electron structur import abinit wiki usual locat abinitdoctutori suppress wiki howev yet oper work also go tutori foldbloch x gonz interfac triq instead gingra b amadon jm beuken anaddb interpol print ddb onto arbitrari set qpoint procedur use produc phonon band structur input variabl prtddb anaddb produc _ddb file _ddbnc file latter separ qpoint g antoniu ongo work hybrid function speedup scf loop comput stress joint comput forc stress downsampl wavevector x gonz f jollet ongo work implement tdep algorithm temperatur depend sampl j bieder f bottin bouchet replac http http mani document file jm beuken test nonmagnet dftu dftuso see new test v torrent make dftu local exexchang compat nspdennspinor torrent test veloc verlet algorithm ionmov see new test v prokhorenko make thermal occupi supercel given size input variabl thermal_supercel see test v giantomassi write dielectr tensor anaddbnc perturb wrt electr field present test nlflag test comput nonlinear coeffici first chang dielectr tensor see test v f naccarato ongo work raman intens paw case use dfpt l baguet torrent ongo work multibinit project new hist storag new test paral test anharmon part ration supercel treatment multibinit martin verstraet ph ghosez ongo work extens dfpt within noncollinear magnet f ricci prokhorenko verstraet torrent e bousquet ongo work dfpt magnet field perturb zeeman field prokhorenko e bousquet begin transport epc calcul within eph part code verstraet improv read initi densiti esp nspden torrent new interfac build system new ac config file format pouillon store foldbloch result netcdf format add new option cutd convert denpot fortran netcdf giantomassi add mdtemp _hist file use mandatori post process mdpimd add imgmov _hist file conveni know pimd nebstr postprocess j bieder use invers symmetri nspden nc giantomassi updat elast tutori j zwanzig add loto term netcdf file giantomassi numer miscellan addit bug fix improv document g antoniu j bieder giantomassi f jollet g petretto n pike pouillon verstraet torrent v mani thank contributor abinit project januari may releas note rel modificationsimprov abinitv respect v list contributor includ f altvat g antoniu l baguet jm beuken j bieder e bousquet w chen g genest giantomassi gillet x gonz f jollet martin f naccarato g petretto prokhorenko f ricci torrent verstraet j zwanzig worth read care modif mention present file examin link help file test case might take time xavier version releas june list chang respect version warn import remark github abinit web page httpsgithubcomabinit allow one access mirror repositori abinit well project relat abinit like abipi pseudodojo content abinit web portal specif page relat present abinit httpwwwabinitorgaboutwhatisabinit upgrad b notic achiev b implement algorithm interpol electron band structur base either star function bspline altern wannier function interpol see input variabl einterp nkpath prteband test old syntax tlibxc tv replac testslibxcinputtabi testv_ work giantomassi b fock mix factor hse hybrid function tune thank input variabl gwfockmix warn gwtype approach electron structur total energi see test tlibxc work w chen b implement spatiallyvari chemic potenti atom speci see input variabl chempot nzchempot test tv work x gonz b linear geometr constraint impos pimd run allow abinit use blue moon sampl techniqu see input variabl pimd_contraint test tv use histori hist file possibl imag work g genest torrent b comput linear repons optic execut well bse part abinit case temperaturedepend electron structur see test tvmbpt warn capabl abinit fulli test howev basic test nonspinpolar simpl semiconductor ok usual use risk work gillet giantomassi b comput gruneisen paramet finit differ within anaddb see test v work giantomassi b new lobpcg implement wfoptalg default paral_kgb perform equival standard use mpi alon much better openmpmultithread linalg also allow one block larg system reduc memori copi version develop keep mind next gener hpc work j bieder b new algorithm displac nuclei ionmov hybrid mont carlo hmc predictor ionmov veloc verlet vv nve molecular dynam predictor ionmov see tv ionmov work prokhorenko b refactor anaddb product do thermodynam quantiti also mean squar displac mean squar veloc do obtain use usual do method instead histogram method converg much faster anaddbngqpt activ anaddbprtdo anaddb work verstraet c chang develop also compil c manag test farm new bot ubu_intel__openmpi activ intel support also replac shiva_gnu__pyk inca_gnu__pyk updat graphen macport gcc scalapack jm beuken chang ongo develop yet final print potenti eg prtvxc work dfpt verstraet new input variabl prtphband see test v v giantomassi case anaddb interpol phonon frequenc produc erron neg slope around gamma new anaddbnspher possibl allow anaddb select set ifc lead nonphys behaviour see test v work giantomassi ad new valu anaddbnlflag comput nonlinear suscept f naccarato comput forc possibl wavelet paw case torrent ongo work concern new driver optdriv specif deal electronphonon relat comput includ zeropoint renormalis see new test v work giantomassi ongo work raman intens paw case use dfpt l baguet torrent ongo work relat noncollinear dfpt definit new input variabl rfmagn well tv dfpt static bfield zeeman term work q adjustmanet dfpt correct metal noncollinear case bug fix gs calcul finit magnet field case collinear spin prokhorenko f ricci e bousquet ongo work multibinit project npt simul possibl new test v paral check correct io xml file note test tv renumb tv work martin new test paral make sure paral_kgb work idl proc giantomassi ongo work forc stress hybrid function f jollet ongo work electronphonon postprocessor electronphononcoupl fix bug affect mpi run g antoniu improv zheevd use magma msg forum torrent implement kssnc output netcdf primit giantomassi concern fourier interpol phonon band structur insid anaddb work g petretto updat calcul sound veloc small modif anaddbnlflag ad quantiti anaddb netcdf file fix bug implement new weight concern path integr molecular dynam quantum thermal bath allow restart histori file torrent refactor comput electr dipol moment torrent energi width band boltztrap intran file automat set previous constant ryd user check hand valu suffici consid bug fix verstraet numer miscellan addit bug fix improv document f altvat g antoniu j bieder giantomassi f jollet g petretto verstraet torrent j zwanzig v mani thank contributor abinit project june januari releas note rel modificationsimprov abinitv respect v moreov also describ comput physic commun abinit paper doijcpc list contributor includ b amadon g antoniu l baguet jm beuken j bieder e bousquet f brunev w chen giantomassi gillet x gonz g petretto f jollet martin v plane pouillon rangel f ricci torrent verstraet worth read care modif mention present file examin link help file test case might take time xavier version releas februari list chang respect version warn import remark articl abinit group mention acknowledg recent develop abinit softwar packag comput phi commun see httpwwwabinitorgdochelpfilesforvusersacknowledgmentshtml well notic end abinit run inclvkb remov possibl valu either default strategi so_psp chang see descript input variabl so_psp b notic achiev b implement limitedmemori broydenfletchergoldfarbshanno lbfg minim algorithm activ algorithm use ionmov test run algorithm much better nativ implement bfg abinit one approach converg perhap better treatment numer detail algorithm might becom default abinit better behaviour confirm test case v work routin base origin implement j noced avail netliborg reshap translat modern fortran interfac abinit f brunev sourc _geomoptimm_lbfgsf b new tutori avail calcul effect interact u j use constrain random phase approxim crpa dftdmft dftu calcul see doctutorial_ucalc_crpamd well automat test tutorialtucrpa tutori prepar b amadon b implement temperaturedepend spectral function electron spectral function electronphonon interact well real part phonon selfenergi pi gap system also automat test spectral function v improv document work g antoniu b rpa oneshot bootstrap fxc kernel implement gw calcul gwgamma see rigamonti et al prl berger prl test vmbpt updat work w chen c chang develop also compil c version control system use develop abinit chang whole abinit project port bzr git work jm beuken pouillon giantomassi x gonz discuss mani develop c new version fortran compil integr test farm intel gnu ibm xlf compil nag correspond exampl avail docbuildconfigexampl contrari g test anymor work jm beuken c v directori test initi matteo giantomassi c python support build system script compat py_ version maintain matteo giantomassi chang ongo develop yet final main execut multibinit creat goal perform secondprincipl calcul build model hamiltonian use data provid ddb info abinit test v renam well paral work martin new driver within abinit defin specif deal electronphonon relat comput includ zeropoint renormalis set optdriv new input variabl ddb_shiftq eph_task eph_transport prtphdo prtphsurf see test v work giantomassi g antoniu gener kpoint mesh kptrlatt shiftk test see test v work giantomassi followup achiev b releas note abinitv dmft triq new input variabl defin dmft dmft_tolfreq dmftctqmc_triqs_nleg automat test setup test v paral work b amadon v plane systemat test io parallel differ file set normconserv paw paw spinorbit case see test mpiio also case paral_kgb test idl processor see test paral work giantomassi load balanc repartit plane wave among proc monitor dynam equilibr made possibl thank new input variabl pw_unbal_thresh see test mpiio work torrent capabl output spinresolv do case spinorbit nc pseudopotenti calcul check test setup test v work giantomassi file gener abinit use boltztrap test see v work giantomassi unit test fftprof set use mkldfti routin unitarytfftmkl_ work giantomassi ongo work raman intens paw case use dfpt l baguet torrent prtvcbm work parallel test mpiio reactiv processor torrent go work relat noncollinear dfpt f ricci prokhorenko e bousquet mbpt support commut vnl r case nc pseudo one projector per lchannel ad test vmbpt gw run psp file soc yet avail though kss file continu use old implement maintain backward compat henc outkss wont produc file multipleprojector detect inclvkb remov possibl valu either giantomassi hirshfeld bader doc warn hirshfeld charg output unclear densiti integr electron call hirshfeld charg oppos net one bader check core charg file correspond pseudopotenti use check least integr znuclzion first step import default fc file web semicor electron wherea mani psp contribut verstraet updat acknowledg includ paper x gonz ongo work forc stress hybrid function f jollet ongo work concern weight fourier interpol insid anaddb g petretto numer miscellan addit bug fix sourc well build system includ patch fallback improv document g antoniu l baguet j bieder f brunev giantomassi gillet g petretto pouillon verstraet torrent particular dfptpaw author xg abinit packag context develop corn code electron structur calcul began develop late eighti dc allan corn inc fundament algorithm code bandbyband conjug gradient algorithm propos mp teter payn dcallan describ thoroughli review paper citepayn refer found written fortran technic featur planewav represent wavefunct use pseudopotenti localdens approxim lda within densityfunct theori dft juli x gonz join cornel univers mpteter professor build upon corn code respfn respons function code written see citegonzea complet descript algorithm corn respfn code consist end x gonz stay cornel univers septemb began diverg afterward corn inc agre allow develop base version louvainlaneuv featur respfn develop jc charlier c lee separ code well corn inc agre biosym inc corn code renam plane_wav would commerci biosym inc biosym inc merg msi molecular simul inc shortli afterward decis taken msi continu develop plane_wav code dc allan x gonz explor possibl write new code commerci render avail scientif commun freewar would written fortran would includ parallel featur would base scf selfconsist field algorithm write would facilit avail respfn code corn code well later develop corn code renam plane_wav exclud featur develop biosym comput scientist tightli bound biosym proprietari featur project first name dft name abinit definit adopt septemb version abinit made avail march beta tester done bit earlier outsid louvainlaneuv corn groundstat featur version releas juli possibl comput responsefunct phonon born effect charg dielectr constant avail version first version propos web gnu gpl licenc featur consider improv upon exist respfn version corn even latest avail version plane_wav ie much faster better parallelis abinit v made avail decemb advisori commite set june serv whole lifetim version version deliv first intern abinit develop workshop januari renew advisori committe aim bridg speed gap respect planewav base firstprincipl code paw parallel fft better geometri optim better molecular dynam second intern abinit workshop may held pari version deliv autumn complet renew build system descript print use quantiti author fj sourc file topic edit page give hint print use quantiti abinit packag introduct mani quantiti comput report main abinit output file demand print thank follow prtlanglesuffixrangl input variabl usual correspond file suffix _langlesuffixrangl print case main output modifi contain data relat input variabl related_vari select input file selected_input_fil descript perform artifici modif physic author xg sourc file topic edit page give hint perform artifici modif physic abinit packag introduct comput one consid nonphys modif system help understand physic nuclear mass free electron mass modifi fake space depend chemic poteni ad see chempot well electrostat potenti slab jellslab simpl sinecosin potenti wavevector compat supercal also ad see qprtrb relat input variabl related_vari select input file selected_input_fil descript perform dmft calcul author bamadon sourc file topic edit page give hint perform dmft calcul abinit packag introduct dft fail describ ground state andor excit state mani lanthanid actinid transit metal inde exchang correl function yet abl describ strong repuls coulomb interact occur among electron partli fill local f orbit way improv descript strongli correl system explicitli includ strong repuls coulomb interact hamiltonian solv static mean field approxim give dftu method citeanisimov citeliechtenstein implement abinit citeamadona dynam mean field theori citegeorg dmft goe beyond solv exactli local correl atom effect field ie anderson model effect field reproduc effect surround correl atom thu selfconsist relat solut anderson model citegeorg combin dft dmft citegeorg citekotliar usedmft reli definit correl orbit abinit use wannier function built use project local orbit citeamadon wannier function unitarili relat select set kohn sham ks wavefunct specifi abinit band indic dmftbandi dmftbandf empti band necessari build wannier function requir dmft calcul ks hamiltonian correctli diagon use high valu nnsclo nline order make first rough estim orbit charact ks band choos band index band structur highlight atom orbit charact call fatband plot use pawfatbnd variabl band structur obtain project orbit wannier function also plot use plowan_comput relat variabl choic screen coulomb interact u upawu j jpawu note version later version jpawu requir densiti matrix correl subspac diagon choic doubl count correct citeamadon current default choic abinit dmft_dc correspond full local limit method resolut anderson model abinit hubbard method citeamadon dmft_solv continu time quantum mont carlo ctqmc method citegullcitebied dmft_solv static mean field method dmft_solv equival usual dftu citeamadon practic solut dftdmft scheme usual present doubl loop first local green function second electron local densiti citeamadon number iter two loop determin dmft_iter nstep howev gener case effici way carri fulli consist dftdmft calcul keep loop govern nstep dmft_iter citebied dmft_rslf read selfenergi file step dft loop prtden abl restart calcul step dft loop densiti file lastli one linear one logarithm grid use matsubara frequenc citekotliar determin dmft_nwli dmft_nwlo typic valu converg studi inform obtain log file set pawprtvol main output calcul imaginari time green function spectral function obtain use extern maximum entropi code citebergeron selfenergi quasiparticl renorm weight extract densiti matrix correl orbit intern energi citeamadon electron entrop contribut free energi also obtain use dmft_entropi dmft_nlambda effici ctqmc code abinit time consum part dmft use hybrid expans citewern citegul _densitydensity_ multiorbit interact citegul moreov hybrid function citegul assum diagon orbit flavor index exact cubic symmetri without spin orbit coupl gener one alway check offdiagon term much smaller diagon one link exact rotat invari interact ctqmc code triq librari also avail use dmft_solv ctqmc solver use fourier transform time grid dmftqmc_l imaginari space must chosen nyquist frequenc defin dmftqmc_l tsmear around ha converg studi perform variabl moreov number imaginari frequenc dmft_nwlo set least twice valu dmftqmc_l typic number step thermal dmftqmc_therm mont carlo run dmftqmc_n respect random number gener initi variabl dmftqmc_seed sever variabl avail dmftctqmc_order give histogram perturb order simul dmftctqmc_gmove custom global move tri mainli use system highlow spin configur dmftctqmc_mea set frequenc measur quantiti relat input variabl related_vari select input file selected_input_fil tutori tutorialdmftth tutori dftdmft show perform dftdmft calcul srvo use project wannier function prerequisit dftu descript use van der waal function author ypouillon bvantroey sourc file topic edit page give hint use van der waal function abinit packag introduct well known long rang correl respons van der waal interact reach lda gga approxim exchangecorrel energi dft recent year sever method devis includ interact group two strategi name _ad hoc_ method selfconsist approach current abinit perform calcul base either dftd method vdw wf method describ later belong first group fulli customiz implement vdwdf method citedion selfconsist approach adapt strategi follow gromanperez _et al_ citeromanperez case abinit develop offer around ajust paramet deliv graphic tool help user assess qualiti kernel aim perform product calcul vdwdf also help research develop new densiti function optimis system requir vanderwa interact dftd method implement insid abinit name dftd citegrimm dftd citegrimm dftdbj citegrimm case pairwis term bodi correct dftd dftdbj ad dft energi independ electron densiti order mimic vdw interact implement includ contribut method forc stress view geometri optim well firstord respons function like dynam matric clamp elast constant intern strain coupl paramet activ dftd dispers correct two keyword use vdw_xc choos dftd dftd dftdbj vdw_tol control inclus larg distant pair give contribut vdw_tol ignor also possibl includ bodi correct citegrimm groundstat keyword vdw_tol_bt also control toler term method base maxim local wannier function mlwf calcul vdw energi correct also implement abinit case pairwis term come contribut pair mlwf rather atom among implement method abinit found vdwwf citesilvestrelli citesilvestrelli vdwwf citeambrosetti vdwqhowf citesilvestrelli full descript implement vdwwf report citeespejo select one method achiev use vdw_xc respectivelli sinc vdwwf vdwwf method approxim dispers energi non overlap electron densiti necessari defin interact fragment system whose dispers energi go calcul latter achiev use input variabl vdw_nfrag vdw_typfrag defin number interact fragment unit cell assign atom fragment given mlwf belong fragment closer atom need defin interact fragment overridden vdwqhowf input variabl use deal period system input variabl vdw_supercel control number neighbor unit cell includ calcul one compon vdw_supercel indic maximum number cell along posit neg direct correspond primit vector use studi spacial converg vdw energi notic user must set variabl associ calcul mlwf result vdw energi strongli depend obtain wannier function relat input variabl related_vari select input file selected_input_fil descript use abipi python packag author mg sourc file topic edit page give hint use abipi python packag abinit packag introduct abipyhttpsgithubcomabinitabipi python librari analyz result produc abinit also provid tool gener input file workflow autom abinitio calcul typic converg studi abipi interfac pymatgenhttppymatgenorg allow user benefit differ tool python object avail pymatgen ecosystem abipi use conjunct matplotlib panda ipython jupyt thu provid power userfriendli environ data analysi visual offici document stabl version avail check galleri plot scriptshttpabinitgithubioabipygalleryindexhtml galleri abipi workflowshttpabinitgithubioabipyflow_galleryindexhtml learn integr jupyt abipi visit collect notebookshttpsnbviewerjupyterorggithubabinitabitutorialsblobmasterabitutorialsindexipynb relat input variabl related_vari select input file selected_input_fil descript calcul transit path author gg sourc file topic edit page give hint calcul transit path abinit packag introduct similarli pimd find minimum energi path particular transit state chemic transform great import mani differ field abinit implement two differ flavour base interpol method citeweinan citehenkelman citemil control keyword imgmov calcul start knowledg initi final state local minima configur space educ guess reaction pathway reaction path given linear interpol reactant final product construct seri imag configur connect two state given keyword nimag energi path join seri imag modifi step allow search lowest energi path join reactant product nudg elast band method neb imag connect spring spring constant chosen imag uniformli space path search forc imag come potenti energi surfac configur spring forc two closest configur chang imag calcul project true forc perpendicular path parallel project spring forc respect path citehenkelman spring constant obtain keyword neb_spr number iter given ntimimag string method system set exactli neb method differ spring constant need defin case forc obtain neb method true forc perpendicular configur equal redistribut along path iter citeweinan method search stop number predefin iter ntimimag toler converg criteria tolimg reach pimd imag treat parallel request parallel mode set keyword npimag specifi lattic paramet angl atom posit kept fix need see topicgeoconstraint relat input variabl related_vari select input file selected_input_fil tutori tutorialparal_imagesparallel base imag eg determin transit path string method activ top kgb parallel forc calcul light_galleri true abinit video httpscodepeniosachinchoolurpenxnavpp div classmdcontain div classgalleri dark span classgallerynoteclick imag see galleryspan ul idvideogalleri li classvideo datasrchttpswwwyoutubecomwatchvdpplqkqa href img classimgrespons srcimgyoutubecomvidpplqkqahqdefaultjpg div classgallerypost img srchttpssachinchoolurgithubiolightgallerystaticimgplaybuttonpng div li li classvideo datasrchttpsyoutubeefjcyimnbg href img classimgrespons srcimgyoutubecomviefjcyimnbghqdefaultjpg div classgallerypost img srchttpssachinchoolurgithubiolightgallerystaticimgplaybuttonpng div li li classvideo datasrchttpswwwyoutubecomwatchvgcbfb_mteo href img classimgrespons srcimgyoutubecomvigcbfb_mteohqdefaultjpg div classgallerypost img srchttpssachinchoolurgithubiolightgallerystaticimgplaybuttonpng div li li classvideo datasrchttpsyoutubeunlrhwavvw href img classimgrespons srcimgyoutubecomviunlrhwavvwhqdefaultjpg div classgallerypost img srchttpssachinchoolurgithubiolightgallerystaticimgplaybuttonpng div li li classvideo datasrchttpsyoutubejzajixm href img classimgrespons srcimgyoutubecomvijzajixmhqdefaultjpg div classgallerypost img srchttpssachinchoolurgithubiolightgallerystaticimgplaybuttonpng div li ul div div script function videogallerylightgalleri script div classmdcontain div classrowhtest embedli embedshdiv div classrow div classcolmd habinit github repoh p classembedlycard datacardcontrol hrefhttpsgithubcomabinitabinitabinitabinita script async srccdnembedlycomwidgetsplatformj charsetutfscript div div classcolmd habiconfigh p classembedlycard datacardcontrol hrefhttpsgithubcomabinitabiconfigabinitabiconfiga script async srccdnembedlycomwidgetsplatformj charsetutfscript div div classcolmd habicondah p classembedlycard datacardcontrol hrefhttpsgithubcomabinitabicondaabinitabicondaa script async srccdnembedlycomwidgetsplatformj charsetutfscript div div row hr div contain blockquot classembedlycard datacardcontrolsha hrefhttppythonhostedorgabipyget start abipi documentationahpabipi distribut hope use without warranti without even impli warranti merchant fit particular purpos see gnu lesser gener public licens detailspblockquot script async srccdnembedlycomwidgetsplatformj charsetutfscript classembedlycard datacardcontrol hrefhttpwwwpseudodojoorgth period tabl test pseudopotentialsa script async srccdnembedlycomwidgetsplatformj charsetutfscript classembedlycard datacardcontrol hrefhttpjpmineralsorgvestaenvestaa script async srccdnembedlycomwidgetsplatformj charsetutfscript classembedlycard datacardcontrol hrefhttpswwwmaterialsprojectorgmateri projecta script async srccdnembedlycomwidgetsplatformj charsetutfscript classembedlycard datacardcontrol hrefhttpwwwaflowliborgcarda script async srccdnembedlycomwidgetsplatformj charsetutfscript classembedlycard datacardcontrol hrefhttpwwwaflowliborgcrystaldatabasecarda script async srccdnembedlycomwidgetsplatformj charsetutfscript classembedlycard datacardcontrol hrefhttpschmelingacrwthaachendecohpindexphpmenuidcohp crystal orbit hamilton popul downloada script async srccdnembedlycomwidgetsplatformj charsetutfscript descript fit anharmon part model multibinit author amacgc page give hint fit anharmon part model multibinit introduct fit process implement multibinit base citeescorihuelasayalero fit process multibinit contain two main option gener list symmetryadapt term select best coeffici list fit process first option multibinit gener set coeffici multibinitfit_generatecoeff set one gener mainli parametr multibinitfit_rangepow multibinitfit_cutoff avoid gener provid list coeffici model_anharmonicxml file see helpmultibinit fit process select coeffici one one multibinitfit_ncoeff accord procedur detail citeescorihuelasayalero process requir provid training_set_histnc list file see helpmultibinit tutori tutoriallattice_modelfirst lesson multibinit explain build lattic model run dynam relat input variabl related_vari select input file selected_input_fil descript manipul atom group atom gener set atom posit author fj sourc file topic edit page give hint manipul atom group atom gener set atom posit abinit packag introduct abinit nongraph capabl manipul atom group atom help establish set atom posit input file big cell consid explicitli one two group atom form eg molecul cluster small primit cell repeat arbitrari number translat rotat atom remov form eg vacanc see nobj entri point relat input variabl use preprocess input file echo output file input_onli characterist relat input variabl related_vari select input file selected_input_fil descript set paramet spinpolar calcul author fj sourc file topic edit page give hint set paramet spinpolar calcul abinit packag introduct electron system may comput spinunpolar spin polar case possibl impos occup number major minor spin spin start configur specif option effici treatment antiferromagnet shubnikov group avail treatment noncollinear magnet avail detail implement de found pdfnoncolher total magnet moment unit cell constrain local magnet also constrain relat input variabl related_vari select input file selected_input_fil tutori tutorialspinth tutori spin abinit present properti relat spin spinpolar calcul spinorbit coupl descript use hybrid function author fj sourc file topic edit page give hint use hybrid function abinit packag introduct fock exchang term implement abinit norm conserv pseudopotenti framework paw one detail implement abinit found pdfhybridspdfher abinit user make calcul fock exchang first gga dataset ground state second dataset fock calcul choos ixc hf pbe pbe blyplibxc pbelibxc pbe libxc hse hse energi forc stress avail normconserv paw framework oneshot gw calcul follow normconserv case present warn use istwfk iscf paral_kgb paral_atom effici calcul optim work progress concern point relat input variabl related_vari select input file selected_input_fil descript calcul rpa correl energi author fb sourc file topic edit page give hint calcul rpa correl energi abinit packag introduct adiabaticconnect fluctuationdissip framework correl energi electron system relat densitydens correl function also known reduc polariz neglect exchangecorrel contribut polariz one obtain celebr randomphas approxim rpa correl energi express correl energi altern deriv manybodi perturb theori context rpa correl energi correspond gw total energi rpa correl energi express integr function dielectr matrix see citegonz integr frequenc perform along imaginari axi integrand function smooth sampl frequenc necessari abinit rpa correl energi trigger set keyword gwrpacorr rpa correl energi postprocess quantiti gw modul abinit take care evalu dielectr matrix sever imaginari frequenc rpa correl shown captur weak van der waal interact citelebegu drastic improv defect format energi citebrunev converg versu empti state energi cutoff gener slow requir care converg studi situat improv use extrapol scheme citebrunev citeharl relat input variabl related_vari select input file selected_input_fil descript control flow abinit author xg sourc file topic edit page give hint control flow abinit abinit packag introduct input variabl govern name prefix inputoutputtemporari file eg pseudo output_fil path possibl stop abinit eg accord maxim limit cpu time detail abinit flow specif case relat input variabl related_vari select input file selected_input_fil descript comput electron selfenergi due electronelectron interact author mg sourc file topic edit page give hint comput electron selfenergi due electronelectron interact abinit packag introduct principl exact selfenergi obtain solv selfconsist set coupl integrodifferenti equat propos hedin citehedin fundament build block hedin equat besid sigma green function interact manybodi system g green function appropri noninteract system go irreduc polariz tchi invers dielectr matrix ee renorm static coulomb potenti result dynam screen interact w final vertex function gamma describ interact virtual hole electron typic selfenergi calcul combin quasiparticl band structur screen interact possibl vertex correct qp correct optdriv frequenc domain gw selfenergi sigmaomega evalu abinit two differ effect techniqu integr plasmonpol model ppm integr contour deform cd former case frequenc depend eeomega model simpl analyt form frequenc convolut carri analyt latter approach integr evalu numer extend function complex plane order smoother integrand four differ plasmon pole model ppm avail abinit choic particular ppm use control variabl ppmodel first two option ppmodel refer approxim employ pioneer implement gw formal plasmonpol model godbyne citegodbi gn hybertsen louie citehybertsen hl contour deform techniqu activ set input variabl gwcalctyp integr along imaginari axi requir calcul eeomega pure imaginari frequenc frequenc mesh quadratur govern input variabl nfreqim coars sinc integrand smooth region evalu residu pole requir calcul eeomega fine mesh along real axi regular mesh sampl interv defin two input variabl nfreqr freqremax cd approach requir mani evalu eeomega therefor comput highli demand hand prefer approach calcul qp correct lowli state moreov techniqu avail abinit comput imaginari part sigmaomega spectral function aomega possibl disabl full comput actual hartreefock screen exchang cohsex hybrid function calcul calcul done precomput basi set kohnsham eg pbe gener kohnsham eg hse vertex correct bootstrap kernel other includ selfconsist w faleev method citefaleev implement converg number unoccupi band much improv respect usual implement gw thank extrapolar method frequenc mesh use eg integr along real imaginari axe describ topicfrequencymeshmbpt relat input variabl related_vari select input file selected_input_fil tutori first tutori gw tutorialgwgw deal comput quasiparticl band gap silicon semiconductor gw approxim much better kohnsham lda band structur plasmonpol model second tutori gw tutorialgwgw deal comput quasiparticl band structur aluminum gw approxim much better kohnsham lda band structur without use plasmonpol model tutorialparal_mbtth tutori parallel manybodi perturb calcul gw allow speed calcul accur electron structur quasiparticl band structur includ manybodi effect descript perform gw lanczossternheim calcul author jl sourc file topic edit page give hint perform gw lanczossternheim calcul abinit packag introduct function product high perform gw implement citelaflamm develop within abinit relat input variabl related_vari select input file selected_input_fil descript comput linear nonlinear optic properti independentparticl approxim author ss xg yg sourc file topic edit page give hint comput linear nonlinear optic properti independentparticl approxim abinit packag introduct optic nonlinear optic properti comput differ level approxim simplest fastest approach reli independentparticl approxim ipa electron suppos independ react optic perturb even initi comput band structur includ interact meanfield sens like dft approxim also refer sumoverst approach so neglect electronhol interact exciton effect might provid meaning result mani case sometim even quantit first problem link erron band gap materi correct scissor approxim see scissoropt abinit one either work ipa see take account exciton effect see topicbs abinit packag two differ util comput optic respons independentparticl approxim helpopt conducti citemazevet develop independ thu overlap significantli first one comput linear non linear optic properti function frequenc provid optic dielectr tensor secondharmon gener shg well optic rectif tensor electroopt tensor without contribut nuclear displac inclus contribut nuclear displac see topicnonlinear second util conducti capabl linear level provid electron conduct dielectr tensor index refract reflect absorpt thermal conduct thermopow electron transport high temperatur kubogreenwood formal real well imaginari part relat input variabl related_vari select input file selected_input_fil tutori see tutorialopticth tutori optic util allow obtain frequenc depend linear optic dielectr function frequenc depend second order nonlinear optic suscept simpl sumoverst approxim descript set paramet calcul positron system author mt sourc file topic edit page give hint set paramet calcul positron system abinit packag introduct lifetim positron annihil rate associ properti comput use selfconsist twocompon dft formal includ forc stress comput thu relax lda gga wirhin normconserv pseudopotenti well paw approach citewiktor doppler broaden also comput detail way perform calcul given descript positron input variabl well tutorialpositronth tutori electronpositron annihil exampl found citewiktor citewiktor citewiktora citewiktorb relat input variabl related_vari select input file selected_input_fil tutori tutorialpositronth tutori electronpositron annihil descript take account extern magnet field author eb sourc file topic edit page give hint take account extern magnet field abinit packag introduct appli extern magnet field sever type interact system electron nuclei particular coupl electron spin zeeman term well electron orbit motion orbit term input variabl deal two situat decoupl abinit zeemanfield give access zeeman coupl product coupl electron orbit motion much delic treat current develop chern number calcul avail type input variabl list relat input variabl related_vari select input file selected_input_fil descript enabl extend fpmd method high temperatur simul author blanchet sourc file topic edit page give hint perform calcul extend fpmd model introduct extend first principl molecular dynam ext fpmd method allow perform high temperatur simul kelvin thousand ev drastic reduc need number band high temperatur simul implement usag describ upcom paper current review author blanchet j clrouin torrent f soubiran high energi orbit replac pure singl plane wave descript base fermi ga model band nband treat complet plane wave basi set usual rest occupi band nband infin treat fermi ga model contribut energi entropi stress number electron chemic potenti comput automat enabl model variabl useextfpmd contribut number electron energi explicitli shown _gsrnc output file key nelect_extfpmd e_extfpmd edc_extfpmd doubl count term energi shift factor result constant background potenti also print _gsrnc output file key shiftfactor_extfpmd relat input variabl related_vari select input file selected_input_fil descript use appa postprocess tool analysi molecular dynam output file trajectori author ss xg yg sourc file topic edit page give hint use appa postprocess tool analysi molecular dynam output file trajectori abinit packag introduct appa graphic text postprocessor abinit dedic analysi molecular dynam output file trajectori output file larg scale molecular dynam simul easi manag data extract output file netcdf acsciitext format appa graphic tool written python pyqt librari abl read abinit output easi use order follow trajectori molecular dynam simul total energi pressur also possibl calcul veloc autocorrel function simul radial pair distribut vibrat densiti state etc python abl handl effici kind output file one suit comput quantiti come largescal md simul that appa also use fortran thank fpi librari connect languag possibl relat input variabl related_vari select input file selected_input_fil descript analyz densiti potenti author ss xg yg sourc file topic edit page give hint analyz densiti potenti abinit packag introduct file densiti potenti format see topicprint analyz cutd postprocessor particular produc twodimension cut onedimension cut threedimension data suitabl later visualis use eg topicabipi perform hirshfeld comput atom charg analys charg contain atom sphere determin angular momentum project charg l contain sphere avail normconserv pseudopotenti see helpcutd well tutorialcutd relat input variabl related_vari select input file selected_input_fil tutori tutorialcutd explain use input paramet need cut dimension file postprocessor abinit packag descript perform gw calcul includ selfconsist author mg sourc file topic edit page give hint perform gw calcul includ selfconsist abinit packag introduct dft perform reason well determin structur properti fail predict accur band gap rigor framework descript excit state provid manybodi perturb theori mbpt citefett citeabrikosov base green function formal concept quasiparticl citeonida within mbpt one calcul quasiparticl qp energi e amplitud  solv nonlinear equat involv nonhermitian nonloc frequenc depend selfenergi oper  equat goe beyond meanfield approxim independ ks particl account dynam manybodi effect electron electron interact detail gw implement abinit found theorymbther typic gw calcul consist two differ step follow dft calcul first screen interact  calcul store disk optdriv ks band structur w use evalu matrix element  final obtain qp correct optdriv comput screen interact describ topicsuscept comput selfenergi describ topicselfenergi frequenc mesh use eg integr along real imaginari axe describ topicfrequencymeshmbpt gw calcul made less memori cpu time consum expens numer precis compil abinit option enable_gw_dpcno ac file gw bodi reduc densiti matrix rdm linear dyson equat comput use selfconsist galitskiimigd correl provid approxim selfconsist gw total energi relat input variabl related_vari select input file selected_input_fil tutori tutorialgw first tutori gw gw deal comput quasiparticl band gap silicon semiconductor gw approxim much better kohnsham lda band structur plasmonpol model tutorialgw second tutori gw gw deal comput quasiparticl band structur aluminum gw approxim much better kohnsham lda band structur without use plasmonpol model tutorialparal_mbtparallel manybodi perturb calcul gw allow speed calcul accur electron structur quasiparticl band structur includ manybodi effect descript comput frequencydepend suscept matrix relat screen interact matrix invers dielectr marix author mg sourc file topic edit page give hint comput frequencydepend suscept matrix relat screen interact matrix invers dielectr marix abinit packag introduct independentparticl approxim frequencydepend suscept matrix relat screen interact matrix invers dielectr matrix comput done top eigenfunct eigenvalu obtain kohn sham gener kohnsham eg hybrid function well self consist quasiparticl methodolog gener kohnsham basi prerequisit manybodi perturb theori calcul see topicgw topicbs refer frequenc mesh use eg integr along real imaginari axe suscept matric relat matric comput describ topicfrequencymeshmbpt relat input variabl related_vari select input file selected_input_fil descript tune comput forc stress author fj sourc file topic edit page give hint tune comput forc stress abinit packag introduct hellmanfeynman forc comput analyt formula correspond exactli limit finit differ energi infinitesim small atom displac groundstat calcul converg featur avail case total energi comput correct nonconverg case allow get accur forc less converg wavefunct without decomposit forc differ compon provid stress also comput featur avail case total energi comput except wavelet decomposit stress differ compon provid smear scheme appli kinet energi ecutsm allow one get smooth energi curv function lattic paramet angl target stress given user strtarget geometri optim algorithm tri find primit cell atom posit deliv target stress comput forc stress option see optforc optstress use defin scf stop criteria toldff tolrff geometri optim stop criteria tolmxf geometri optim combin cell shape atom posit optim need convers scale set strprecon relat input variabl related_vari select input file selected_input_fil tutori tutorialbaseth tutori deal h molecul get total energi electron energi charg densiti bond length atomis energi tutorialbaseth tutori deal h molecul converg studi lda versu gga tutorialbaseth tutori deal crystallin silicon insul definit kpoint grid smear cutoff energi comput band structur converg studi tutorialbaseth tutori deal crystallin aluminum metal surfac occup number smear fermidirac distribut surfac energi converg studi descript calcul temperatur depend electron structur author sp sourc file topic edit page give hint calcul temperatur depend electron structur abinit packag introduct electron structur chang temperatur materi chang mainli driven electronphonon interact also present zero kelvin induc socal zeropoint motion renorm zpr eigenvalu effect comput thank allenheinecardona ahc theori citeallen citeallen citeallen base diagrammat method manybodi perturb theori extens standard ahc theori also give access electron lifetim decay rate physic properti avail abinit sinc v ahc formal implement equat found citeponcea extend verif valid studi also versu firstprincipl code abinit implement found citeponc ahc implement use xc function work responsefunct rf part code requir use normconserv pseudopotenti netcdf support mandatori ahc implement abinit still heavi develop present inform relat legaci implement although also relat recent procedur reli optdriv document new procedur given mostli relat tutori describ frohlich model comput oldest wellestablish ahc implement abinit sum highli energet band appear ahc equat citegonz effici comput behavior control input variabl ieigrf k point converg strongli improv restor charg neutral read born effect charg dielectr tensor control input variabl getddb inform import charg neutral fulfil found citeponc valu elph_imagden set imaginari shift use smooth numer instabl denomin sumov state express check implement correctli hold arbitrarili small elph_imagden paramet citeponc input variabl smdelta trigger calcul electron lifetim valu smear delta function specifi esmear doubl grid use speedup calcul getwfkfin irdwfkfin variabl getgam_eignkq give contribut  debyewal term comput variabl relev calcul ahc use abinit program nonetheless recommend use provid python postprocess script temperature_parapi modul rf_modspi directori scriptspost_process allow flexibl python script support multithread follow step requir perform ahc calcul perform respons function calcul q  electr field perturb perform phonon calcul produc epc larg set wavevector q read born effect charg dielectr tensor getddb gather comput impact electronphonon coupl electron eigenenergi use temperature_parapi python script output script provid text netcdf format allow later read insid abinit could use futur develop abinit comput temperaturedepend optic properti exampl temperatur depend fermi energi see topicelphontransport relat input variabl related_vari select input file selected_input_fil tutori legaci procedur tutori avail tutorialtdepesth temperatur depend electron structur new procedur two tutori avail tutorialeph_introan overview eph code tutorialephzprzeropoint renorm band gap temperaturedepend band gap descript gener electron band structur relat topic author xg sourc file topic edit page give hint gener electron band structur relat topic abinit packag introduct eigenenergi along set segment comput nonselfconsist calcul iscf use neg valu kptopt kptbound defin end point segment ndivsm ndivk defin sampl choic output unit main output file govern enunit band structur even repres use weight proport orbit content socal fat band case paw calcul see pawfatbnd relat variabl differ interpol scheme band energi defin thank einterp wannier interpol also avail use tutorialwanni postprocessor band structur supercel calcul unfold larg brillouin zone small primit cell thank helpfoldbloch postprocessor see relat topicunfold differ plot postprocessor exist produc graphic represent electron band structur abinit power base topicabipi provid sever tool analyz band structur info avail gsrfilenb simpler tool also exist found abinitscriptspost_process eg abinitbandstructuremakerpi plot_bandstructurepi abinit_eignc_to_bandstructurepi relat input variabl related_vari select input file selected_input_fil descript perform wannier function calcul author bamadon sourc file topic edit page give hint perform wannier function calcul abinit packag introduct two way obtain wannier function abinit first one use intern implement project local orbit wannier function citeamadon citeamadon activ input variabl plowan_comput variabl plowan_bandi plowan_bandf specifi kohn sham band use built wannier function wherea variabl plowan_natomplowan_iatomplowan_nbl plowan_lcalc plowan_projcalc specifi atom angular momentum projector correspond project local orbit wannier function order wannier interpol analysi hop integr real space wannier function built use variabl plowan_realspac plowan_nt well plowan_it real space hamiltonian analysi given latex file whose name end wanniereigen band structur given output log file second one use extern code wannier wwwwannierorghttpwwwwannierorg calcul maxim local wannier function mlwf ground state calcul wannier code obtain mlwf requir two ingredi overlap cell period part bloch state start guess project bloch state onto trial local orbit abinit take bloch function ground state calcul comput two ingredi wannier run wannier includ librari abinit process automat singl run ground state calcul comput mlwf input variabl prtwant winiprj wprtunk relat use wannier librairi relat input variabl related_vari select input file selected_input_fil tutori tutorialwannierth tutori wannier deal wannier librari obtain maxim local wannier function descript check regress author xg sourc file topic edit page explain portabl nonregress manag abinit project introduct abinit test merg trunk dedic test farm see httpswikiabinitorgdokuphpidbbslav httpswikiabinitorgdokuphpidbbbuild numer test contain abinittest execut compar refer file relat input variabl related_vari select input file selected_input_fil descript perform calcul within constrain dft author eb xg sourc file topic edit page give hint perform calcul constrain dft atom charg atom magnet moment abinit packag introduct constrain densiti function theori cdft impos constraint charg densiti magnet moment usual integr charg densiti magnet realspac function insid sphere constrain userdefin valu describ eg citekaduk citema algorithm implement abinit publish clear improv algorithm report paper algorithm citekaduk initi report citewu implement doubleloop cycl avoid present implement also improv algorithm present citema base penalti function lagrang multipli approach unlik claim author also implement abinit see topicmagmom impos arbitrari numer precis constraint instead approxim one tunabl accuraci control magcon_lambda present algorithm also subject instabl observ magcon_lambda becom larger larger citewu algorithm abinit implement forc well stress cdft also deriv total energi respect constraint deliv charg constraint vector magnet constraint magnet length constraint magnet axi constraint deriv determind respect valu constraint defin directli user magnet direct constraint deriv evalu respect chang angl relat input variabl related_vari select input file selected_input_fil descript perform pimd calcul author gg sourc file topic edit page give hint perform pimd calcul abinit packag introduct pathintegr molecular dynam pimd techniqu allow simul quantum fluctuat nuclei thermodynam equilibrium citemarx implement abinit nvt ensembl sinc v pathintegr formal quantum statist mechan quantum nuclei replac set imag bead treat mean classic mechan interact specif effect potenti limit infinit number bead quantum system manybead classicl system partit function thu static observ pimd classic system bead simul standard molecular dynam pimd equat motion integr use verlet algorithm time step ground state dft calcul perform imag pimd use xc function work paw framework well normconserv pseudopotenti ncpp case pimd abinit follow set numer scheme develop sever author citemarx citetuckerman pimd canon ensembl need specif thermostat ensur trajectori ergod nosehoov chain implement well langevin thermostat control valu imgmov also possibl use coordin transform stage normal mode control keyword pitransform standard equilibrium pimd static observ relev quantum timecorrel function access mass associ motion bead control keyword pimass wherea true mass atom given amu valu given pimass use fix socal fictiti mass citemarx case coordin transform use fictiti mass automat fix code match socal stage mass normal mode mass number time step trajectori control ntimimag initi thermostat temperatur mdtemp except specifi imag initi configur assum posit random distribut veloc appli govern mdtemp start dynam time step abinit deliv output file inform ground state dft calcul ground state imag ii instantan temperatur instantan energi given primit virial estim pressur tensor given primit estim number imag keyword nimag associ specif parallel level keyword npimag pimd use abinit reproduc larg isotop effect phase transit phase phase ii dens hydrogen citegenest also aspect diffus low room temperatur protonconduct oxid fuel cell citegenest pimd npt ensembl avail yet relat input variabl related_vari select input file selected_input_fil descript comput polaris take account finit homogen electr field author jz sourc file topic edit page give hint comput polaris take account finit homogen electr field abinit packag introduct effect homogen static electr field insul may treat abinit two perspect one perturb yield suscept form second deriv total energi respect electr field zero field strength see topicdfpt abinit also use comput effect electr field finit amplitud use techniqu modern theori polar citerestacitenunescitesouza latter base notion berri phase approach total energi minim includ contribut due interact extern electr field materi polar p tot follow e e  p tot e e usual ground state energi obtain kohnsham dft absenc extern field e p tot polar made ionic contribut electron contribut  volum unit cell detail implement modern theori polar abinit given citegonzeth abinit public ncpp case electr field addit contribut hellmannfeynman forc electron state depend explicitli ionic posit citesouza paw case howev projector depend ion locat addit forc addit stress term aris citezwanzig generalis fix dfield fix reduc field also avail describ stengel na spaldin vanderbilt nat phi polar finit electr field calcul abinit access variabl berryopt efield addit displac field mix boundari condit mix electr field displac field comput well relat input variabl related_vari select input file selected_input_fil tutori tutorialffieldtutori polar finit electr field deal comput polar insul eg ferroelectr dielectr materi thank berri phase approach also present comput materi properti presenc finit electr field also thank berri phase approach descript control scf cycl author xg sourc file topic edit page give hint control scf cycl abinit packag introduct numer precis calcul depend mani set among precis solv kohnsham selfconsist equat sever paramet govern scf loop maximum number cycl given nstep iter procedur might stop earlier soon criterion chosen user fulfil user ask give toler measur converg user must choos among toldf toldff tolrff tolvr tolwfr theoret justifi densitypotenti selfconsist tolvr tolwfr interest nonselfconsist calcul molecular dynam reli accuraci forc one might prefer tolrff input variabl relat solut schroding equat howev usual relat iter techniqu welltun input variabl nline tolrd usual use expert howev case converg difficult might interest test improv well modifi nnsclo accuraci variabl enabl one tune accuraci calcul set automat seventeen variabl relat input variabl related_vari select input file selected_input_fil tutori tutorialbaseth tutori deal h molecul converg studi lda versu gga tutorialbaseth tutori deal crystallin silicon insul definit kpoint grid smear cutoff energi comput band structur converg studi author fj xg abinit featur overview abinit set featur beginn experienc user document give overview featur implement abinit packag group differ topic beginn well experienc user might answer question abinit extent also give synthet view need set foreword document featur larg scientif code complex task present list featur refer differ topic topic dedic page quick read unlik lessonindexlesson tutori usual least one hour work mani topic make link physic properti quantiti includ bibliograph refer theori sometim point publish work use featur way comput abinit eg correspond input variabl exampl input file possibl tutori associ postprocess tool optic anaddb multibinit topicbas approach might use beginn get broad overview capabl abinit applic well expert user quickli find way comput exist quantiti rememb input variabl use mandatori calcul given properti topic rather inputori eg specifi atom geometri occup number etc propertyori eg comput elast constant temperaturedepend electron structur etc relat properbett usag code care taken duplic exist complet document abinit point appropri abinit document cover webaccess document still unlink document subdirectori abinitdoc work progress make avail discuss abinit discours forumhttpsdiscourseabinitorg might also allow get inform abinit specif static dft calcul topic topicgsintroductionbuild input file briefli explain content abinit input file follow topic go detail howev restrict static dft calcul without anyth fanci exchangecorrel function go beyond left section section beyond particular accur electron properti eg correct band structur optic respons strongli correl electron pleas go beyond present sec also topic relat global control paramet appli gener speak type calcul explain later set atom cell atom atom posit symmetri topicunitcellunit cell topicatomtypestyp atom alchemi topiccrystalcrystallin structur symmetri topicsmartsymmsmart symmetr topicatommanipulatoratom manipul advanc topic physic set electron xc function atomicpseudo potenti metalinsul spin coulomb interact topicxcoverview avail exchang correl function topichybridshybrid function topicvdwvan der waal function topicrpacorrencorrel energi within rpa topicpseudospawpseudopotenti paw atom dataset topicbandoccband occup number metal insul topicspinpolarisationspinpolaris system spinorbit coupl topiccoulombcoulomb interact charg cell numer set electron basi set planewav real space sampl brillouin zone sampl topicplanewavesplanewav real space sampl topicpawpaw special set topicwaveletswavelet abinit topickpointswavevector sampl k point grid scf algorithm tune stop criteria topicscfalgorithmsscf algorithm topicscfcontrolscf control toler stop criteria topicforcesstressesforc stress topictuningspeedmemtun speed memori usag topicrecursionrecurs method orbit free calcul product ad electricmagnet field artifici constraintsmodif relat properti topicberryelectr polar finit electr field topicmagfieldextern magnet field topicconstraineddftconstrain densityfunct theori topicmagmomconstrain atom magnet moment topicefgelectr field gradient mossbauer fermi contact interact topicartificialartifici modif system global control paramet flow parallel output file output content time memori control topicmultidtsetmultidataset calcul topicparallelismparallel abinit topicprintingprint file topicoutputtun output content differ file topiccontroltim memori control molecular dynam geometri optim transit path topicgeooptgeometri optim topicmoleculardynamicsmolecular dynam topictranspathtransit path search neb string method topicgeoconstraintsgeometri constraint topicpimdpathintegr molecular dynam pimd topiccrossingbarrierscross barrier search linear combin constrain dft energi ensembl dft topiclotflearnontheflight lotf product correl electron correl electron consid case f orbit play activ role necessari go beyond standard dft framework abinit enabl follow possibl topichybridshybrid function topicdftudftu approxim topicdmftdynam mean field theori dmft topiccrpacalcul effect coulomb interact adiabat respons properti phonon lowfrequ dielectr raman elast temperatur depend mani properti obtain approxim electron stay ground state adiabat respons pow densityfunct perturb theori dfpt framework allow abinit address directli properti case connect deriv total energi respect perturb includ dynam effect due phonon coupl thu also temperaturedepend properti due phonon topicdfptgener dfpt topicqpointswavevector phonon qpoint topicphononsvibr dielectr properti phonon frequenc mode ir raman spectra born effect charg topicphononbandsphonon band do interatom forc constant sound veloc topictemperaturetemperatur depend properti free energi entropi specif heat atom temperatur factor thermal expans topicelasticelast piezoelectr topicnonlinearraman intens electroopt properti topicelphonintelectronphonon interact topicphononwidthphonon linewidth due electronphonon interact topicelphontransportelectron transport properti electronphonon interact resist superconduct thermal topictdepestemperatur depend electron structur electronphonon interact topicconstrainedpolconstrain polar geometri optim advanc topic excit state calcul frequencydepend electron optic properti excitedst calcul frequencydepend properti frequenc nonneglig respect electron gap address varieti methodolog usual trade accuraci speed lowest level one encount independentparticl approxim build upon previous obtain band structur eg kohnsham band structur dft charg excit allow obtain quasiparticl band structur without wellknown dft band gap problem one resort costli gw calcul neutral excit ie optic costli bethesalpet approach accur formal present avail tddft scf calcul cheaper work well molecul isol defect solid eg correct band gap topicopticlinear nonlinear optic properti independentparticl approxim topicfrequencymeshmbptdefinit frequenc mesh manybodi perturb theori topicsusceptibilityfrequencydepend suscept matrix relat dielectr matrix screen coulomb interact topicselfenergyelectron selfenergi topicgwgw calcul accur band structur includ selfconsist topicbsebethesalpet calcul accur optic properti topictddfttddft calcul topicdeltascfdeltascf calcul topicrandstoppowrandom electron stop power topicgwlsgw lanczossternheim method product secondprincipl calcul multibinit handl million atom firstprincipl accuraci construct model hamiltonian whose linear select nonlinear characterist ident firstprincipl calcul simul million atom model hamiltonian one studi phase transit polar boundari properti largescal system reach firstprincipl algorithm implement abinit dft code even respect linearsc code prefactor much smaller implement multibinit applic topiclatticemodellattic model harmon level topicfitprocessfitprocess topicboundingprocessboundingprocess topicdynamicsmultibinitdynamicsmultibinit electron properti analysi tool do stm wannier band plot interpol mani properti directli deduc knowledg electron wavefunct eigenenergi densiti potenti etc necessit addit tune paramet link postprocess tool describ follow topic other actual activ singl print paramet electron local function elf see prtelf see list print input variabl topicprint topicelecbandstructureelectron band structur relat topic topicelecdoselectron do relat topic topiceffectivemasseffect mass calcul topicunfoldingunfold supercel band structur topicdensitypotentialmanipul densiti potenti topicmacroavemacroscop averag densiti potenti topicstmscan tunnel microscopi map topicwannierwanni function topicbaderbad atominmolecul analysi physic properti eg positron topicpositronpositron calcul topicldaminushalfth lda approach analysispostprocess tool topicabipyabipi abinit swiss knife topicappaabinit postprocessor applic appa moleculardynam trajectori analysi topicbandepsbandep phonon dispers curv topicatdeptemperatur depend effect potenti thermodynam properti miscellan topic topicverificationverif implement topicportabilitynonregressionport nonregress test topicgitgit gitlab github abinit project topicdevmiscellan develop descript comput vibrat free energi entropi specif heat thermal expans well atom temperatur factor author xg sourc file topic edit page give hint comput vibrat free energi entropi specif heat thermal expans well atom temperatur factor abinit packag introduct phonon band structur correspond eigenvector known whole brillouin zone thank fo fourier interpol see topicphononband integr perform allow obtain wealth properti like free energi entropi specif heat well atom temperatur factor applic techniqu see citele moreov know inform differ volum allow one comput thermal expans see anaddbgruns_ddb input variabl need perform interpol brillouin zone describ topicphononband list present topic relat input variabl related_vari select input file selected_input_fil tutori tutorialrfth tutori responsefunct rf present analysi ddb introduc preceed tutori rf comput interatom forc comput thermodynam properti outcom tutori descript plot phonon band structur author ssxgyg sourc file topic edit page give hint plot phonon band structur abinit packag introduct postprocessor bandep written f one execut src_main allow one draw phonon dispers curv automat file written encapsul postscript ep moreov color code allow emphas contribut individu atom correspond eigenvector three type atom relat input variabl related_vari select input file selected_input_fil descript calcul electr field gradient mossbauer fermi contact interact author jz sourc file topic edit page give hint calcul electr field gradient mossbauer fermi contact interact abinit packag introduct paw formal provid robust way reconstruct allelectron wavefunct valenc space suitabl comput expect valu observ local even close nuclei obtain equival accuraci within normconserv pseudopotenti framework would requir small atom radii pseudiz procedur concomitantli high planewav cutoff energi lengthi calcul remain question whether even allelectron accuraci valenc space suffici accur represent observ close nuclei convent wisdom would suggest deep core polar might quit signific properti electr field gradient fermi contact interact concern turn unwarr howev experi other shown paw formal togeth typic chemic valencecor separ suffici accur descript nuclear point properti electr field gradient citepetrilli citeprofeta citezwanzig fermi contact interact citezwanzig magnet chemic shield citepickard electr field gradient fermi contact interact ground state observ comput add neglig time normal selfconsist ground state calcul total charg densiti paw formal contain pseudoval densiti nuclear ionic charg allelectron pseudo charg densiti within paw sphere done earlier work electr field gradient due pseudoval densiti comput reciproc space gradient due fix ionic charg comput ewald sum approach paw sphere charg densiti contribut matrix element x x rr weight charg densiti channel determin selfconsist minim procedur treatment citezwanzig flexibl exampl assum band doubli occupi permit current approach use complex electron magnet state insul within abinit electr field gradient comput invok key word prtefg print efg togeth key word quadmom prtefg key word take valu valu electr field gradient coupl mhz report convers made atom combin gradient nuclear quadrupol moment suppli quadmom prtefg input addit breakdown field gradient term valenc onsit paw term report along eigenvector efg matrix princip direct may determin respect crystal axe final prtefg allow addit comput pointcharg model gradient comparison purpos point charg atom suppli addit variabl ptcharg detail exampl use abinit comput efg found citezwanzig citezwanzigera fermi contact interact electron densiti evalu precis nuclear locat import compon isom shift measur mossbauer spectroscopi isom shift directli proport nab r nsrc r differ electron densiti absorb sampl sourc evalu densiti nuclear posit accomplish treat  r r observ threedimension dirac delta function center nuclear posit r shortrang natur delta function pawtransform version observ matrix element onsit allelectron valenc function requir citezwanzig evalu linear fit first point paw radial function within abinit fermi contact interact invok key word prtfc print fermi contact take valu call electron densiti nuclear posit report atom unit electron per cubic bohr isom shift measur mossbauer spectroscopi typic report veloc unit obtain formula  czee nab r nsrc r r c speed light e ray energi z atom number e electron charg r chang mean squar nuclear radiu transit electron densiti nab nsrc refer absorb sourc respect linear formula densiti absorb sampl nucleu unknown r obtain compar calcul valu sever standard experi comput use interpret measur new materi citezwanzig show perform studi varieti compound relat input variabl related_vari select input file selected_input_fil tutori tutorialnucth tutori properti nuclei show comput electr field gradient mossbauer fermi contact interact prerequisit paw descript perform calcul constrain atom magnet moment author eb sourc file topic edit page give hint perform calcul constrain atom magnet moment abinit packag introduct complementari magnet constraint method implement abinit code wherein magnet around atom push desir vectori valu constraint either full vector quantiti vecm_i direct vece_i mainli use non collinear system direct amplitud magnet moment chang method follow use quantum espresso citemoscacont vasp citema lagrangian constraint appli energi work result term potenti act differ spin compon magnet sphere omega_i around atom posit vecr_i calcul vecm_i int_omega_i vecmvecr f_ivecrvecr_i dvecr correspond potenti spin compon alpha written v_alphavecr lambda f_ivecrvecr_i vecc vecsigma_alpha function f_i zero outsid sphere radiu ratsph atom insid sphere function fx xxxx see eq b citelaflamm appli smooth transit region thick r_ fix bohr otherwis minim discontinu variat potenti iter iter constraint manag keyword magconon valu give constraint direct vecc vecm_ivecm_ivecmspinat_i vecmspinat_i valu give full constraint vector vecc vecm_i vecmspinat_i case vecmspinat_i defin spinat give vector magnet potenti atom latter quit stringent constraint often may converg former valu usual work provid suffici precis given calcul magnet moment kinet energi cutoff particular strength constraint given keyword magcon_lambda lambda real valu typic valu vari strongli system type valu start small constraint may enforc fulli increas larg valu lead oscil magnet equival charg slosh converg correspond lagrang penalti term ad total energi print log file along effect magnet field appli ideal case energi penalti term go constraint fulli satisfi relat input variabl related_vari select input file selected_input_fil descript perform random stop power calcul author fb sourc file topic edit page give hint perform random stop power calcul abinit packag introduct slow swift charg particl insid condens matter subject intens interest sinc advent quantummechan lindhard formula citelindhard give polariz free electron ga develop specif purpos kinet energi lost imping particl unit path length name stop power larg veloc stop power domin electron contribut arriv particl induc electron excit target electron excit target relat invers dielectr function  q  provid linear respons theori valid consequ electron stop power random possibl impact paramet read v  zn q  v q g im  q v q g v q g q g z v respect charg veloc imping particl  unit cell volum n q number q point first brillouin zone g reciproc lattic vector apart overal factor equat ident formula publish citecampillo gw modul abinit give access full invers dielectr function grid frequenc  implement equat postprocess employ spline interpol invers dielectr function order evalu  v q g energi cutoff g govern ecutep gw modul integ npvel cartesian vector pvelmax control discret particl veloc note absolut converg random electron stop power delic matter gener requir thousand empti state togeth larg valu energi cutoff relat input variabl related_vari select input file selected_input_fil descript perform lda calcul author f jollet g zerah sourc file topic edit page give hint perform lda calcul abinit packag introduct featur avail paw lda framework describ citeferreira abinit lda approxim need use paw data file contain small potenti vminushalf ad local potenti insid code lda approach base slater half occup techniqu restor band gap semiconductor insul relat input variabl related_vari select input file selected_input_fil descript perform molecular dynam calcul author gg sourc file topic edit page give hint perform molecular dynam calcul abinit packag introduct three molecular dynam algorithm numerov verlet blane moan allow perform simul real simul time see ionmov displac atom may comput accord newton law ad friction forc nosehoov thermostat avail verlet algorithm langevin dynam also avail specifi lattic paramet angl atom posit kept fix need see topicgeoconstraint trajectori analyz thank topicappaappa postprocessor relat input variabl related_vari select input file selected_input_fil tutori tutorialparal_moldyn parallel molecular dynam calcul descript perform macroscop averag densiti potenti author xg sourc file topic edit page explain perform macroscop averag densiti potenti abinit packag introduct macroav program implement macroscop averag techniqu introduc baldereschi et al citebaldereschi power method relat microscop quantiti typic output firstprincipl code macroscop magnitud need perform electrostat analysi within methodolog one abl wash wiggl rapidlyvari function posit resembl underli atom structur microscop quantiti blow macroscop featur use comput band offset work function effect charg high frequenc dielectr constant among other see also citecolombo well citeshaltaf latter applic use macroav program deliv abinit see fig use macroav program prepar input file name macroavein name admit exampl renam macroavein issu simpli macroav without argument two file gener whose name construct name densiti potenti file third line input macroavein file let us take t_den exampl first one append pav abbrevi planar averag xy averag done gener file t_den one gener t_denpav second one append mav abbrevi macroscop averag xy averag follow macroscop averag gener file t_den one gener t_denmav note planar averag alway done xy plane macroscop averag z direct note macroav work reduc coordin encount problem nonorthogon primit vector relat input variabl related_vari select input file selected_input_fil descript perform geometri optim author gg sourc file topic edit page give hint perform geometri optim abinit packag introduct differ algorithm broyden modifi broyden verlet sudden stop atom fire allow find equilibrium configur nuclei forc vanish see ionmov cell paramet also optim concur atom posit optcel possibl state given stress target strtarget specifi lattic paramet angl atom posit kept fix need see topicgeoconstraint genet algorithm code global optimis see ga_rul product yet result structur relax save histnc file file use restart calcul analyz result end calcul detail abipi api pleas consult histfilenb perform cell paramet optim default set abinit permit increas lattic paramet initi one one need set dilatmx valu larger default start lattic paramet thought accur increas set dilatmx lead moder increas cpu time start lattic paramet guess perform first run chkdilatmx yield estim correct lattic paramet estim numer exact one ecut valu done need accur geometri estim anyhow otherwis first run perform second run restart newli estim valu chkdilatmx dilatmx relat input variabl related_vari select input file selected_input_fil descript comput matrix element electronphonon interact author mv sourc file topic edit page give hint comput matrix element electronphonon interact abinit packag introduct theori detail implement describ citegonz citegonz basic calcul electronphonon interact abinit one perform normal ground state dfpt phonon calcul use rfphon ad keyword prepgkk prtgkk save matrix element file suffix gkk main chang respect prtgkk disabl use symmetri reduc qpoint perturb avoid ambigu wave function phase due band degeneraci result gkk file merg use mrggkk util process anaddb implement phonon paw dfpt electron phonon coupl also avail paw though yet test extens input variabl electronphonon coupl anaddb describ citegonz citegonz detail calcul electronphonon quantiti abinit anaddb found pdfelphon_manualpdfher subsequ gkk file use comput mani quantiti explain topicphononwidth topictdep topicelphontransport brand new abinit driver focus treatment electronphonon interact heavi develop input variabl expert optdriv relat develop oper v although document yet fulli upgrad relat input variabl related_vari select input file selected_input_fil tutori tutorialrfth tutori responsefunct rf present basic dfpt calcul within abinit exampl given studi dynam dielectr properti ala insul phonon gamma dielectr constant born effect charg loto split phonon whole brillouin zone creation deriv data base ddb present legaci implement tutorialephth tutori electronphonon interact present use util mrgkk anaddb examin electronphonon interact subsequ calcul superconduct temperatur bulk system also tutori tutorialtdepesth temperatur depend electron structur new implement three tutori new procedur avail tutorialeph_introan overview eph code tutorialephzprzeropoint renorm band gap temperaturedepend band gap tutorialephmobphononlimit mobil descript modifi abinit behaviour develop author xg sourc file topic edit page give hint modifi abinit behaviour develop abinit packag introduct special input variabl tune inner behaviour abinit freeli relat input variabl related_vari select input file selected_input_fil descript set paramet parallel calcul author mtfj sourc file topic edit page give hint set paramet parallel calcul abinit packag introduct run abinit parallel mpi processor simpl mpirun n abinit runabi log err mpi processor openmp thread export omp_num_thread mpirun n abinit runabi log err latter standard output applic redirect log err collect standard error command mpirun might possibl replac mpiexec depend system groundstat calcul code parallel mpibas parallel kpoint spin spinor compon band fft grid plane wave coeffici kpoint spin parallelis use mpi commun load gener small parallel effici good provid number mpi proc divid number kpoint ibz howev number node use kind kpointspin distribut might small depend strongli physic problem combin fft band parallelis lobpcg paral_kgb avail citebottin shown larg speed power comput larg number processor highspe interconnect combin fft band k point spin parallel also avail quit effici comput avail normconserv well paw case automat determin best combin parallel level avail use mpiio mandatori largest speed up observ chebyshev filter chebfi method solv linear eigenvalu problem use scf solver abinit implement abinit citelevitt design goal chebfi replac lobpcg solver choic largescal comput abinit perform less orthogon diagon lobpcg scale higher processor count possibl manual use chebfi avail pdfhowto_chebfipdfher groundstat calcul set imag eg nudg elast band method string method pathintegr molecular dynam genet algorithm mpibas parallel use workload differ imag distribut parallel level combin parallel describ lead speedup beyond groundstat calcul gpu use implement base cudamagma groundstat calcul wavelet part abinit bigdft also well parallel mpi band parallel combin gpu respons calcul code mpiparallel kpoint spin band well perturb kpoint spin band parallelis commun load rather small also unlik gs calcul number node use parallel larg nearli independ physic problem parallel perturb similar parallel imag ground state case effici although load balanc problem perturb differ number k point adress present use mpiio mandatori largest speed up observ gw calcul mpiparallel kpoint also parallel transit valenc conduct band pair two parallelis use current present transit parallel show allow speed up larg ground state respons function gw parallel calcul done also use openmp parallel even combin mpi parallel relat input variabl related_vari select input file selected_input_fil tutori tutorialbaseparan introduct abinit parallel read go next tutori parallel one simpl exampl parallel abinit shown tutorialparal_gspwparallel groundstat calcul plane wave present combin kpoint k planewav g band b spinspinor parallel abinit kgb parallel comput total energi densiti ground state properti tutorialparal_moldynparallel molecular dynam calcul tutorialparal_imagesparallel base imag eg determin transit path neb string method pimd activ top kgb parallel forc calcul tutorialparal_gswvlparallel groundstat calcul wavelet present parallel abinit wavelet use basi function instead planewav comput total energi densiti ground state properti tutorialparal_dfptparallel responsefunct calcul need familiar calcul linearrespons properti within abinit see tutori tutorialrfresponsefunct rf tutorialparal_mbtparallel manybodi perturb calcul gw allow speed calcul accur electron structur quasiparticl band structur includ manybodi effect descript perform effect mass calcul author jlaflamm sourc file topic edit page give hint perform effect mass calcul abinit packag introduct direct estim effect mass dft band curvatur use topicdfpt implement within linear respons part abinit citelaflamm method avoid use finit differ estim mass elimin associ numer nois converg studi comput effect mass one set keyword efma within calcul deriv groundstat wavefunct respect wavevector rfelfd effect mass comput kpoint band present calcul one option specifi rang band treat kpoint keyword efmas_band addit featur effect mass implement correct treatment degener band inde concept effect mass break degener band extrema sinc longer possibl describ band curvatur use tensor citelutting citemecholski howev use concept transport equival effect mass citemecholski adapt kp framework implement abl provid user effect mass tensor describ band curvatur describ accur contribut individu band transport properti implement support ncpp paw scheme spinpolar system nspden well spinor nspinor treat although spinorbit interact treat paw case treatment degeneraci limit extrem point band structur relev case way first deriv eigenenergi also comput print ddk calcul correspond electron veloc relat input variabl related_vari select input file selected_input_fil descript perform timedepend densityfunct theori calcul neutral excit energi author fj sourc file topic edit page give hint perform timedepend densityfunct theori calcul neutral excit energi abinit packag introduct finit system atom molecul excit state comput within tddft casida approach normconserv pseudopotenti see explan given tutorialtddft tutori tutori iscf input variabl must set nonspinpolar case spinsinglet well spintriplet excit comput spinpolar case also avail relat input variabl related_vari select input file selected_input_fil tutori tutorialtddftth tutori tddft deal comput excit spectrum finit system thank timedepend densiti function theori approach cassida formal descript comput spatial dispers properti longwav dfpt approach author mr ms sourc file topic edit page give hint comput spatial dispers properti eg flexoelectr tensor dynam quadrupol longwav dfpt driver abinit packag introduct condensedmatt physic spatial dispers refer depend mani materi properti wavevector q probe equival gradient extern field electr magnet strain andor respons real space remark exampl gradient effect includ natur optic rotat citebelinich wherebi crystal rotat polar plane transmit light flexoelectr tensor citezubko describ polar respons gradient appli strain sinc abinit v calcul sever spatial dispers quantiti access via longwav driver implement detail citeromero follow formal develop citeroyo adapt classic longwav method born huang citeborn modern tool dfpt technic driver comput analyt thirdord energi deriv readili convert physic spatial dispers quantiti respect two standard perturb atom displac electr field strain wavevector q present today abinit enabl calcul four spatial dispers tensor requir order build contribut bulk flexoelectr tensor follow prescript expos citestengel includ clampedion flexoelectr tensor pure electron contribut first realspac moment three tensor enter mix lattic mediat contribut polar respons atom displac interatom forc constant piezoelectr forcerespons tensor implement also provid access byproduct flexoelectr formal dynam quadrupol consid spatialdispers counterpart born effect charg dynam dipol execut longwav routin gener thirdord deriv databas subsequ use anaddb either comput print differ contribut flexoelectr tensor consid quadrupolar field within fourier interpol procedur dynam matrix citeroyo underli theori longwav dfpt approach citeroyo develop applic timerevers symmetr insul crystal therefor usag longwav driver restrict materi kind extens theoret framework abinit implement magnet insul andor metal hope pursu futur regard flexoelectr tensor abinit provid remark order first recal bulk flexoelectr tensor surfac counterpart still miss order obtain total flexoelectr tensor systemcitestengel even though implement appli slab lowdimension system materi via supercel approach outcom calcul directli produc total ie bulksurfac flexoelectr tensor neither surfac contribut readili estim obtain total flexoelectr tensor within current capabl abinit subject futur public interest user must likewis awar physic ambigu exist definit bulk flexoelectr tensor inher affect longwav driver one preclud usag obtain flexoelectr tensor noncentrosymmetr ie piezoelectr materi see section viic citestengel one relat depend bulk flexoelectr coeffici choic arbitrari refer energi averag electrostat potenti taken energi refer within longwav driver nonetheless illustr section ivd citestengela choic might lead quantit qualit differ outcom hand ambigu well known disappear surfacespecif part account done eg citestengel longwav implement still heavi develop date requir use normconserv pseudopotenti without xc nonlinear core correct use lda gga xc function use spheric harmon nonloc projector mandatori option useylm follow step requir perform longwav dfpt calcul bulk flexoelectr tensor see eg test testlw_ testlw_ perform groundstat calcul perform ddk d_dkdk respons function calcul perform respons function calcul q  atom displac electr field strain perturb includ option prepalw perform longwav dftp calcul thirdord energi deriv optdriv lw_flexo use mrgddb merg st nd rd order ddb file run anaddb anaddbflexoflag follow step requir perform phonon dispers calcul includ quadrupolar field nonanalyt part dynam matrix see eg test testlw_ testlw_ perform groundstat calcul perform ddk d_dkdk respons function calcul perform respons function calcul q  atom displac electr field includ option prepalw perform longwav dftp calcul thirdord energi deriv optdriv lw_qdrpl perform respons function calcul atom displac finit q coars grid use mrgddb merg nd rd order ddb file run phonon dispers calcul anaddb includ anaddbdipquad andor anaddbquadquad relat input variabl related_vari select input file selected_input_fil tutori tutori prepar descript specifi type atom form system author fj sourc file topic edit page give hint specifi type atom form system introduct abinit need know differ type atom form system atom assembl molecul solid physic specifi nuclear charg mass dynam properti howev pseudopotenti paw approach knowledg nuclear charg defin potenti felt electron atom data file pseudopotenti paw defin thu addit number type atom ntypat nuclear charg znucl abinit requir know pseudopotentialpaw use type atom latter specifi helpabinitintrofil file unless alchem potenti use see later number pseudopotenti read npsp ntypat note one mix norm conserv pseudopotenti paw atom data file singl abinit run even differ dataset one stick either normconserv pseudopotenti paw pseudospaw topicpseudospaw abinit also default tabl atom mass superced specifi amu alchem potenti normconserv pseudopotenti abinit mix pseudopotenti describ httpswikiabinitorgdokuphpiddeveloperspseudosth abinit wiki creat socal alchem potenti see mixalch case number pseudopotenti given npsp usual larger number type atom ntypat use alchem potenti make sens treat alloy similar ion present whose specif chemic properti crucial properti interest usual done isoval speci ion quit similar radii reason interpol techniqu electron properti relat input variabl related_vari select input file selected_input_fil tutori tutorialffieldtutori polar finit electr field polar respons finit electr field ala present topic exampl definit sever atom type descript obtain scan tunnel microscopi map author xg sourc file topic edit page give hint obtain scan tunnel microscopi map abinit packag introduct charg densiti state close fermi energi output provid simpl approach stm imag calcul paw see input variabl prtstm stmbia explan exampl input file also use angular momentum decompos do evalu sphere around point provid st analysi relat input variabl related_vari select input file selected_input_fil descript specifi crystal atom posit symmetri author fj sourc file topic edit page give hint specifi crystal atom posit symmetri abinit packag introduct addit topicunitcellspecif unit cell topicatomtypesatom type abinit must know number atom insid cell type posit describ natom typat one xred xcart abinit automat detect bravai lattic space group gener symmetri eg nsym symrel tnon primit cell posit atom provid inaccur see tolsym purpos magnet case abinit also take account input atom spin knowledg spinat altern abinit start specif symmetri either spgroup list symmetri nsym symrel tnon gener atom posit asymmetr irreduc part primit cell describ topicsmartsymmsmart symmetr topic abinit treat antiferromagnet symmetri oper see symafm abinit databas spatial group symmetri see spgroup shubnikov antiferromagnet space group present see also spgroupma genafm also nongraph atom manipul abinit see topicatommanipul abinit read xyz file see xyzfil atom posit also gener random see random_atpo detail way crystal structur defin abinit found theorygeometryher tip abipi instal machin use abistruct script autom sever oper relat crystallin structur detail python api avail abipystructurenb relat input variabl related_vari select input file selected_input_fil tutori tutorialbaseth tutori deal h molecul get total energi electron energi charg densiti bond length atomis energi tutorialbaseth tutori deal h molecul converg studi lda versu gga tutorialbaseth tutori deal crystallin silicon insul definit kpoint grid smear cutoff energi comput band structur converg studi tutorialbaseth tutori deal crystallin aluminum metal surfac occup number smear fermidirac distribut surfac energi converg studi descript perform molecular dynam calcul multibinit author sourc file topic edit page give hint perform molecular dynam calcul multibinit packag introduct multibinit use molecular dynam algorithm implement abinit softwar see topicmoleculardynamicsmolecular dynam abinit npt ionmov nvt ionmov simul avail tutori tutoriallattice_modelfirst lesson multibinit explain build lattic model run dynam relat input variabl related_vari select input file selected_input_fil descript constrain geometri system geometri optim molecular dynam search author gg sourc file topic edit page give hint constaint geometri system geometri optim molecular dynam search abinit packag introduct two mechan put constraint atom posit abinit use topicgeooptgeometri optim topicmoleculardynamicsmolecular dynam includ pimd geometri algorithm eg topictranspathtransit path search simplest one entri point iatfix simpli defin set atom fix either entir along one direct latter see warn iatfix complex one also much power allow place constraint linear combin atom posit thank constraint mean posit two atom fragment like molecul fix constrain stay within arbitrari plane one thu also sampl differ mean posit see complet descript wtatcon relat input variabl related_vari select input file selected_input_fil descript comput linewidth lifetim phonon due electronphonon interact author mv sourc file topic edit page give hint comput linewidth lifetim phonon due electronphonon interact abinit packag introduct topic concern metal gener gkk file see topicelphonint electronphonon coupl epc analysi perform anaddb set anaddbelphflag variabl procedur automat lengthi larg number kpoint use anaddbnqpath anaddbqpath variabl must set specifi path reciproc space anaddb gener file contain phonon linewidth suffix _lwd frequenc qj suffix _bst along anaddbqpath one calcul nest function nq kii ki kqi set anaddbprtnest output _nest relat input variabl related_vari select input file selected_input_fil tutori tutori tutorialephelectronphonon interact present use util mrgkk anaddb examin electronphonon interact subsequ calcul superconduct temperatur bulk system descript comput transport properti determin electronphonon interact electr resist superconduct thermal conduct author mv sourc file topic edit page give hint comput transport properti determin electronphonon interact electr resist superconduct thermal conduct abinit packag introduct warn topic concern metal calcul bulk transport quantiti electr thermal resist part determin electronphonon interact possibl use anaddb analog quantiti obtain conducti postprocessor due electronelectron scatter instead electronphonon preliminari calcul deriv wavefunct respect kvector must carri gener gkk file see topicelphonint electronphonon coupl epc analysi perform anaddb set anaddbelphflag variabl procedur automat lengthi larg number kpoint use legaci implement transport properti abinit quit stabl new implement heavi develop present inform relat legaci implement although also relat recent procedur reli optdriv document new procedur given mostli relat tutori introduct mobil see anoth tutori new procedur superconduct calcul still develop superconduct calcul legaci implement electronphonon interact interpol reciproc space integr fermi surfac give eliashberg function sever quadratur method avail default anaddbtelphint use gaussian weight width anaddbelphsmear anoth option improv tetrahedron citebloechla anaddbtelphint final anaddbtelphint one integr given set electron band anaddbep_b_max anaddbep_b_min result integr quantiti eliashberg function file suffix _af epc strength  print main output file transport calcul turn set anaddbifltransport anaddb transport quantiti depend fermi veloc band electron banddepend matrix element must preserv integr set anaddbep_keepband increas memori use squar number band cross ef result transport eliashberg function file _af_tr electr resist file _rho thermal conduct file _wth also possibl consid temperatur depend fermi energi cubic spline interpol anaddbep_nsplin enabl linearli interpol transport array reduc memori usag besid set fermi level anaddbelph_fermi hartre also possibl specifi extra electron per unit cell ie dope concentr often express cm anaddbep_extrael detail calcul electronphonon quantiti abinit anaddb found pdfelphon_manualher relat input variabl related_vari select input file selected_input_fil tutori legaci approach tutorialephth tutori electronphonon interact present use util mrgkk anaddb examin electronphonon interact subsequ calcul superconduct temperatur bulk system new procedur two tutori avail tutorialeph_introan overview eph code tutorialephmobphononlimit mobil descript becom convinc result numer correct author xg sourc file topic edit page give hint becom convinc result numer correct abinit packag introduct one never sure implement complic formal numer correct howev sever studi help gain confid select properti comput within abinit make detail comparison independ develop softwar applic ground state total energi geometri relax phonon frequenc electronphonon matrix element temperatur depend electron gap cross check quantum espresso yambo see citeponc possibl choos convent definit averag eletrostat potenti quantum espresso allow verif result charg system see citebrunev see valid section topicpseudospaw relat input variabl related_vari select input file selected_input_fil descript use git abinit author xg sourc file topic edit page give hint abinit packag introduct abinit develop control githttpsgitscmcom develop base gitflow branch modelhttpswwwatlassiancomgittutorialscomparingworkflowsgitflowworkflow offici github mirrorhttpsgithubcomabinitabinit welcom bug fix improv note howev activ develop host intern gitlab serverhttpsgitlababinitorg embark make signific chang pleas contact abinit group see mani differ project link abinit github actual gather github abinit organizationhttpsgithubcomabinit relat input variabl related_vari select input file selected_input_fil descript calcul effect coulomb interact author bamadon sourc file topic edit page give hint calcul effect coulomb interact abinit packag introduct dftu well dftdmft requir input valu effect coulomb interact two way comput avail abinit firstli constrain random phase approxim citearyasetiawan ucrpa allow one take account screen coulomb interact correl electron noninteract electron nonentangl band ucrpa band exclud polaris specifi either band index ucrpa_band energi window ucrpa_window citeamadon entangl band ucrpa scheme use abinit citeshih citesakumaciteamadon use band kpoint depend weight defin polaris use wannier orbit correl orbit method well adapt comput effect interact orbit use dftdmft use orbit dftu wannier function ajust bare interact close bare interact atom orbit use dft _u_ see tutori secondli linear respons method citecococcioni implement implement yet product implement abinit take account truncat atom orbit paw therefor differ origin work citecococcioni treat full atom orbit particular consider higher effect valu u found relat input variabl related_vari select input file selected_input_fil tutori tutorialucalc_crpatutori calcul effect interact u j crpa method show determin u valu constrain random phase approxim citearyasetiawan use project wannier orbit prerequisit dftu tutorialudetth tutori determin u dftu show determin u valu linear respons method citecococcioni use dftu approach prerequisit dftu descript perform bader analysi author pcasek ff xg sourc file topic edit page give hint perform bader analysi abinit packag introduct postprocessor abinit call aim atominmolecul perform bader analysi basi charg densiti normconserv pseudopotenti case complement core charg densiti provid httpswwwabinitorgdownloadscore_electron specif helpaim abinit postprocessor relat input variabl related_vari select input file selected_input_fil descript gener electron do relat topic author xg sourc file topic edit page give hint gener electron do relat topic abinit packag introduct _do file produc either use tetrahedron method smear approach partial orbit weight do also obtain see detail explan prtdo differ plot postprocessor allow one repres do includ topicabipyabipi relat input variabl related_vari select input file selected_input_fil tutori paw tutori section tutorialpawdosplot paw contribut densiti state descript use learnoftheflight featur author xg sourc file topic edit page give hint use learnoftheflight featur abinit packag introduct develop expert relat input variabl related_vari select input file selected_input_fil descript perform scf calcul neutral excit author fj sourc file topic edit page give hint perform scf calcul neutral excit abinit packag introduct although formal justifi differ total energi use constrain occup number sometim result surprisingli good agreement experiment result neutral excit molecul dope solid see eg citejia manual specif occup number need case accomplish input variabl occ coupl occopt homogen occup band throughout brillouin zone occopt specif occup state select kwavevector big cell equival occopt easier use linear combin imag algorithm allow one work set imag geometri differ electron state even optim geometri accord linear combin forc see imgmov mixesimgf relat input variabl related_vari select input file selected_input_fil descript comput raman intens relat electroopt coeffici author rc xg sourc file topic edit page give hint comput raman intens relat electroopt coeffici abinit packag introduct raman experi incid light usual polar unpolar laser scatter sampl energi well polar outgo light measur raman spectrum present energi outgo photon consist rather welldefin peak around elast peak lowest order theori domin mechan absorpt emiss phonon photon energi absorb emit phonon correspond energi differ outgo incid photon thu even straightforwardli ir spectrum raman spectrum directli relat energi phonon brillouinzon center zero energi scale set incid light energi absolut valu energi peak correspond energi phonon comput phonon energi present topicphonon raman intens due onephonon emiss absorpt link second order deriv total energi within adiabat approxim deriv dielectr phonon respect atom displac moreov frequenc incid light usual ev ev rang small respect band gap eg gap larger ev static approxim made raman intens link thirdord deriv total energi respect twice homogen electr field respect atom displac thu dfpt use see case incid light frequenc neglig respect gap dfpt use adiabat approxim use valid phonon frequenc much smaller gap also consequ featur smaller largest phonon frequenc resolv raman spectrum one comput raman intens thank finit differ dielectr function see citegillet twophonon raman spectrum see citegillet deriv linear electron dielectr suscept respect atom displac nonlinear electron dielectr suscept requir evalu raman intens thu non linear respons abinit implement comput within densiti function perturb theori first formal pead describ citeveithen thank n theorem formul requir knowledg groundstat firstord chang wavefunct quantiti evalu thank finitediffer kspace implement nc pseudopotenti within lda anoth formal base ndorder sternheim equat recent made avail l baguet publish latter implement nc pseudopotenti paw lda work nsppol pead nonlinear respons formal success appli larg varieti system far studi raman spectra ferroelectr oxid batio pbtio citehermet differ miner pressur condit characterist interior earth citecaracasa molecular solid extrem condit citecaraca comput nonlinear optic suscept also appli sever polar dielectr citecaraca byproduct calcul raman tensor nonlinear optic coeffici also possibl determin directli within abinit electroopt eo coeffici rij pockel effect describ chang optic dielectr tensor quasistat electr field follow express citeveithen ij rij clamp zero strain eo coeffici includ electron ionic contribut directli access within abinit unclamp eo coeffici includ addit piezoelectr contribut must comput separ knowledg elastoopt piezoelectr strain coeffici formal instanc appli differ ferroelectr abo compound citeveithena relat input variabl related_vari select input file selected_input_fil tutori tutorialnloth tutori static nonlinear properti present comput respons beyond linear order within densityfunct perturb theori beyond simpl sumoverst approxim raman scatter effici nonreson case nonlinear electron suscept electroopt effect comparison finit field techniqu combin comput linear respons function finit differ calcul also provid descript optim geometri constrain polar author mt sourc file topic edit page give hint optim geometri constrain polar abinit packag introduct comput polar cartesian coordin updat lattic constant atom posit order perform structur optim constrain polar follow formal describ na sai et al prb detail anaddbpolflag geometri optim done anaddb relat input variabl related_vari select input file selected_input_fil descript perform bethesalpet calcul neutral excit energi dielectr function author mg sourc file topic edit page give hint perform bethesalpet calcul neutral excit energi dielectr function abinit packag introduct manybodi perturb theori mbpt citeonida defin rigor framework descript excitedst properti base green function formal within mbpt one calcul charg excit ie electron addit remov energi use exampl hedin gw approxim citehedin electron selfenergi framework neutral excit experiment relat optic absorpt spectra also well describ solut bethesalpet equat bse citeonidacitealbrecht present bse repres accur approach ab initio studi neutral excit crystallin system includ attract interact electron hole thu go beyond randomphas approxim rpa employ gw approxim bse implement abinit discuss review articl citegiantomassi bse calcul activ set optdriv number valenc conduct state eh basi set control variabl bs_loband nband respect default code solv bse socal tammdancoff approxim tda coupl reson antireson transit ignor full bse calcul includ coupl term done set bs_coupl input file variabl bs_coulomb_term specifi treatment screen interact bse kernel default code read w matrix scr file gener gw code optdriv altern one model spatial depend w model dielectr function propos cappellini citecappellini option requir specif bs_coulomb_term mdf_epsinf contribut due exchang term option exclud use bs_exchange_term equival comput macroscop dielectr function without local field effect frequenc mesh macroscop dielectr function specifi bs_freq_mesh zcut defin complex shift avoid diverg due presenc pole along real axi physic standpoint paramet relat electron lifetim addit scissor oper energi mbpt_sciss use correct initi band energi mimic open ks gap introduc gw approxim three differ algorithm solut bse implement direct diagon haydock recurs algorithm conjug gradient eigensolv bs_algorithm input variabl allow user choos among haydock algorithm citehaydockcitebenedict recommend approach comput optic spectra variabl bs_haydock_nit bs_haydock_tol control haydock iter method unfortun haydock solver give direct access eigenst hamiltonian henc use studi exciton wavefunct conjug gradient cg method employ standard iter techniqu citepayn comput lowest eigenst bse hamiltonian solver memori demand haydock approach sinc eigenst must store memori give direct access exciton state cg algorithm prefer direct diagon especi number eigenst much smaller size bse hamiltonian note howev cg implement tda calcul hermitian matric import result calcul save five differ file bsr file store upper triangl bse reson block fortran binari format bsc coupl matrix haydr_sav file contain coeffici tridiagon matrix three vector employ iter algorithm file use restart calcul converg achiev relat input variabl gethaydock irdhaydock final macroscop dielectr function exciton effect report exc_mdf file rpa_nlf_mdf gw_nlf_mdf contain rpa spectrum without local field effect obtain ks energi gw energi respect differ scheme differ degre accuraci comput load avail abinit citegillet order improv converg rate bse calcul avail abinitv bs_interp_ input variabl nonspinpolar case spinsinglet well spintriplet excit comput spinpolar case also avail relat input variabl related_vari select input file selected_input_fil tutori tutorialbs tutori bethesalpet equat bse deal comput macroscop dielectr function silicon within bethesalpet equat descript treat adequ coulomb interact especi charg cell author fb sourc file topic edit page give hint treat adequ coulomb interact especi charg cell abinit packag introduct abinit treat charg system eg either molecul dopant supercel use cellcharg input variabl care converg studi respect cell size must howev done depend dimens differ treatment coulomb interact enforc govern icutcoul groundstat calcul possibl altern icoulomb coulomb interact comput real space use wavelet gw_icutcoul gw calcul fock_icutcoul specif evalu fock exchang energi groundstat calcul hybrid function charg system provid addit inform concern usepotzero well known electrostat potenti aris ionion ionelectron electron electron interact illdefin within period boundari condit howev less well known total energi charg cell also illdefin fact care deriv citebrunev shown two statement tightli link number electron differ number proton cell necessari compens background enforc overal charg neutral sensit arbitrari averag electrostat potenti abinit offer possibl choos convent use averag electrostat potenti keyword usepotzero paw one choos among option averag smooth electrostat potenti set zero averag allelectron electrostat potenti set zero averag smooth electrostat potenti set finit valu follow quantum espresso implement see citegiannozzi detail option valid ncpp case none convent intrins correct one arbitrari choic abinit permit straight comparison code relat input variabl related_vari select input file selected_input_fil descript bound model multibinit author amacgc page give hint bound model multibinit introduct model build contain phonon instabl may produc diverg dynam avoid behaviour multibinit includ automat procedur bound model multibinit first gener set coeffici power rang defin multibinitbound_rangepow keep coeffici even power procedur similar fit process constrain keep posit coeffici next bound process add new coeffici model multibinitbound_maxcoeff check model bound step process tutori tutoriallattice_modelfirst lesson multibinit explain build lattic model run dynam relat input variabl related_vari select input file selected_input_fil descript perform tdep calcul author yb fbottin sourc file topic edit page give hint perform thermodynam elast transport properti calcul includ explicit temperatur effect abinit packag user guid pdfatdep_guid atdep guid theori pdfatdep_paperatdep paper introduct temperatur depend effect potenti tdep method develop hellman et al citehellman citehellman citehellmana atdep implement abinit perform use first time j bouchet f bottin citebouchet citebouchet captur thermal effect solid state physic long stand issu sever standalon postprocess comput code avail use differ theoret framework propos provid thermodynam quantiti involv call anharmon effect atdep calcul produc almost temperaturedepend thermodynam quantiti want singl ab initio molecular dynam aimd trajectori mean graphic user interfac gui easi use httpsgithubcomabinitabioutag origin tdep method citehellman implement abinit particular variou algorithm use obtain interatom forc constant ifc ndorder soon rdorder ifc produc selfconsist use leastsquar method fit aimd forc model hamiltonian function displac numer thermodynam quantiti comput start nd order ifc st one phonon spectra larg number quantiti flow intern energi entropi free energi specif heat elast constant usual elast moduli bulk shear young moduli also produc level use rd order ifc could extract gruneisen paramet thermal expans sound veloc particular take account anisotropi system within relat input variabl related_vari select input file selected_input_fil descript set paramet relat exchang correl function author fj sourc file topic edit page give hint set paramet relat exchang correl function abinit packag introduct total energi comput abinit done accord densiti function theori dft although formal exact approxim exchangecorrel xc function must chosen govern input variabl ixc howev pseudopotenti paw data set construct one specif xc function ixc specifi abinit simpli take ixc given pseudopoenti hope coher other one introduc error use pseudopotenti gener xc function one explicitli specifi ixc howev abinit nevertheless calcul mani exchangecorrel function avail see list descript ixc two differ implement one nativ abinit implement etsf librari xc function libxc plugin abinit nativ abinit set import local approxim lda avail includ perdew zunger one two differ local spin densiti lsd avail includ perdew wang one due teter perdewburkeernzerhof revpb rpbe hcth gga spin unpolar well polar also avail libxc librari interfac abinit function form lda type function form gga type use normconserv pseudopotenti well paw atom data also metagga use abinit normconserv case need usekden particular tb deliv reliabl total energi allow one get cheap correct band structur use ixc hgh pseudopotenti responsefunct type calcul nativ abinit lda gga kernel use well libxc one hybrid function exchang also comput basi fock express exact exchang correl comput basi rpa approxim see gw section topichybridshybrid function calcul hse pbe blyp perform implement exact exchang correl hybrid deliv forc stress present except forc normconserv pseudopotenti local exact exchang useexexch hybrid function pbe use paw insid paw sphere correl orbit given lexexch chang ratio exact exchang see also exchmix implement local exact exchang abinit provid citejollet see use input variabl exchmix lexexch useexexch van der waal function topicvdwsever van der waal function avail grimm dbeckejohnson silvestrelli relat input variabl related_vari select input file selected_input_fil tutori tutorialbas deal h molecul converg studi lda versu gga descript perform numer precis calcul planewav projector augment wave pseudopotenti author fj sourc file topic edit page give hint perform numer precis calcul planewav projector augment wave pseudopotenti abinit packag introduct numer precis calcul depend mani set among definit basi set like import planewav one singl paramet ecut govern complet basi set wavefunct densiti potenti repres reciproc space plane wave real space homogen grid point transform reciproc space real space viceversa made thank fast fourier transform fft algorithm normconserv pseudopotenti ecut also main paramet defin real space fft grid paw sampl quantiti govern independ variabl pawecutdg precis tune might done use boxcutmin ngfft avoid discontinu issu chang size planewav basi set made possibl thank ecutsm accuraci variabl enabl tune accuraci calcul set automat seventeen variabl mani paramet govern paw comput normconserv pseudopotenti calcul describ specif page topicpaw set relat wavelet see topicwavelet relat input variabl related_vari select input file selected_input_fil tutori tutorialbaseth tutori deal h molecul converg studi lda versu gga tutorialbaseth tutori deal crystallin silicon insul definit kpoint grid smear cutoff energi comput band structur converg studi first tutori tutorialpawth projectoraug wave techniqu descript set paramet paw calcul author fj sourc file topic edit page give hint set paramet paw calcul abinit packag introduct paw atom data use plane wave well wavelet specif paw use planewav present see topicwavelet use wavelet way paw method implement planewav abinit describ citetorr use paw atom data equival pseudopotenti file norm conserv case automat launch paw calcul abinit provid jth citejollet paw atom data tabl abinit web site perform standard paw calcul input file normconserv one except variabl pawecutdg must specifi see case input variabl accuraci use input variabl pawecutdg automat use physic function avail paw framework dftu dmft local exact exchang relat input variabl related_vari select input file selected_input_fil tutori tutori use paw tutorialpawpaw present projectoraug wave method implement abinit altern normconserv pseudopotenti sizeabl accuraci cpu time advantag tutori gener paw atom data file tutorialpawpaw present gener atom data use paw method prerequisit paw tutori valid paw atom datafil tutorialpawpaw demonstr test gener paw dataset use abinit elk allelectron code diamond magnesium prerequisit paw paw descript perform calcul wavelet basi author mt sourc file topic edit page give hint perform calcul wavelet basi abinit packag introduct wavelet basi instead plane wave basi use abinit wavelet basi one perform basic static dft calcul select normconserv pseudopotenti hgh gth pseudopotenti citegenoves also paw atom data citerangel avail also finit size correct total energi restart wavefunct follow etsf norm geometri relax use bfg molecular dynam also avail test purpos howev dfpt excitedst calcul except scf perform relat input variabl related_vari select input file selected_input_fil tutori tutorialparal_gswvlparallel groundstat calcul wavelet present parallel abinit wavelet use basi function instead planewav comput total energi densiti ground state properti descript perform orbitalfre calcul author fj sourc file topic edit page give hint perform orbitalfre calcul abinit packag introduct possibl use thomasfermi kinet function explicit function densiti thomasfermiweizsack kinet function gradient correct instead kohnsham kinet energi function implicit function densiti kohnsham wavefunct see citeperrot recurs method may use order comput electron densiti entropi fermi energi eigenvalu energi method comput densiti without comput orbit effici high temperatur effici parallel almost perfect scalabl present work local pseudopotenti sever restrict use method relat input variabl related_vari select input file selected_input_fil descript calcul cross barrier author gg sourc file topic edit page give hint calcul barrier cross abinit packag well ensembl dft psic approach polaron format introduct knowledg geometri cross two electron state happen minim energi geometri energi differ ground state excit state small energi still low play import role studi nonradi transit possibl formul search geometri term minimis function linear combin energi two state geometri lagrang multipli citejia also relat simpl approach ensembl dft make linear combin dft energi xc correl energi comput singl common densiti densiti separ also psic polaron selfinteract correct method citesadigh citesadigha formul term abinit imgmov possibl deal linear combin system geometri differ occup factor occ even differ cellcharg possibl find geometri result energi minim given valu mix factor mixesimgf set nimag set occup number imag groundstat occup imag excitedst occup relat input variabl related_vari select input file selected_input_fil tutori descript perform spin dynam calcul multibinit author xuhe sourc file topic edit page give hint perform spin dynam calcul multibinit packag introduct multibinit use landaulifshitzgilbert equat perform spin dynam finit temperatur relat input variabl related_vari select input file selected_input_fil descript set paramet relat phonon wavevector qpoint dfpt calcul author fj sourc file topic edit page give hint set paramet relat phonon wavevector qpoint dfpt calcul abinit packag introduct like electron wavefunct collect atom displac eigenmod correspond period hamiltonian character wavevector denot qpoint abinit dfpt calcul one dataset done one specif qpoint must specifi simplest case user give correspond qpoint dataset set nqpt specifi correspond singl qpt howev often need run calcul dozen hundr qpoint henc follow mechan set use specifi set q point use input variabl similar kpoint dataset number qpoint set indic thank iqpt appli gener qpoint grid well qpoint path produc phonon band structur input variabl specifi qpoint anaddb specifi topicphonon topicphononband relat input variabl related_vari select input file selected_input_fil descript defin frequenc mesh imaginari real axe mbpt calcul author mg sourc file topic edit page give hint defin frequenc mesh imaginari real axe mbpt calcul abinit packag introduct contour deform techniqu case one defin set frequenc differ numer oper perform comput suscept matric integr along realimaginari axe present topic input variabl connect definit gather relat input variabl related_vari select input file selected_input_fil tutori tutorialgwth second tutori gw deal comput quasiparticl band structur aluminum gw approxim much better kohnsham lda band structur without use plasmonpol model descript comput phonon band densiti state interatom forc constant sound veloc author mt sourc file topic edit page give hint comput phonon band densiti state interatom forc constant sound veloc abinit packag introduct fourier transform phonon dynam matric gener interatom forc constant real space explain citegonzea backtransform reciproc space give fourier interpol initi phonon band structur fourier interpol do produc see citele phonon eigenenergi plot along line slope energi versu cristallin momentum evalu give sound veloc twophonon sum differ spectra also obtain see anaddbdossum relat comput temperaturedepend properti see topictemperatur relat input variabl related_vari select input file selected_input_fil tutori tutorialrfth tutori responsefunct rf present analysi ddb introduc tutorialrf comput interatom forc comput thermodynam properti outcom tutori descript perform dftu calcul author bamadon sourc file topic edit page give hint perform dftu calcul abinit packag introduct featur avail paw dftu framework describ citeanisimov citeliechtenstein abinit dftu approxim implement insid paw atom sphere two choic doubl count provid full local limit around mean field approxim implement describ citeamadona follow main line citebengon see also citeczyzyk forc stress implement detail keyword lpawu upawu jpawu usedmatpu dmatpuopt dmatudiag see keyword usepawu input variabl output log file find dftu contribut energi contain insid paw spheric term output file decomposit dftu energi given interact energi doubl count term sum two log file orbit densiti matrix n_mmsigma also call occup matrix correspond eq citebengon eq citeliechtenstein see also citeamadona variabl dmatpuopt also given atom basi real spheric harmon given scf step log file one thu check converg calcul consist total energi forc dftu check implement dftu abinit allow also impos start densiti matrix order compar energi variou electron configur see keyword usedmatpu dmatpawu relat input variabl related_vari select input file selected_input_fil tutori tutorialdftuth tutori dftu show perform dftu calcul use abinit lead comput project do nio prerequisit paw descript comput phonon frequenc mode ir raman spectra born effect charg ir reflect author mt sourc file topic edit page give hint comput phonon frequenc mode ir raman spectra born effect charg ir reflect abinit packag introduct comput secondord deriv total energi respect atom displac arbitrari wavevector use topicdfpt open possibl comput dynam matrix wavevector henc comput phonon eigenfrequ eigendisplac wavevector usual denot gamma point combin atom displac electr field type perturb open also access born effect charg electron frequenc lower electron band gap dielectr constant infrar reflect materi infinit lifetim approxim see citegonzea present theori dfpt abinit one dataset fix wavevector see topicqpoint one comput secondord deriv abinit alreadi perform postprocess treatment secondord deriv eg comput dynam matrix correspond eigenenergi eigendisplac although extend postprocess treatment provid anaddb thu overlap two execut common input variabl usual action input variabl name two execut similar although input variabl govern option anaddb abinit previous mention differ capabl databas input variabl input variabl relat abinit anaddb clearli distinguish bandbyband decomposit born effect charg tensor comput thank prtbbb relat local tensor see citeveithen also comput phonon calcul arbitrari qpoint done finit electr field topicberri easiest discov capabl two execut tutorialrf tutori see topicdfpt gener inform dfpt topicqpoint specif qpoint topicphononband comput full phonon band import phonon band structur insul comput abinit avail materi project web sitehttpsmaterialsprojectorg accompani deriv thermodynam quantiti born effect charg dielectr tensor citepetrettoa ddb file download automat abipi start materi project identifi futher inform pleas consult ddbfilenb relat input variabl related_vari select input file selected_input_fil tutori tutorialrfth tutori responsefunct rf present basic dfpt calcul within abinit exampl given studi dynam dielectr properti ala insul phonon gamma dielectr constant born effect charg loto split phonon whole brillouin zone creation deriv data base ddb present descript set paramet relat electron wavevector kpoint author fj sourc file topic edit page give hint set paramet relat electron wavevector kpoint abinit packag introduct sinc abinit base period boundari condit everi wavefunct character wavevector usual denot kpoint list kpoint specifi thank keyword nkpt kpt still kpoint use two differ context vast major case sampl brillouin zone goal produc integr quantiti eg charg densiti electron energi electron do numer precis specif comput wavefunct eigenenergi eg get electron band structur first case pleas complet present topic read topicbandocc second case pleas read topicelecbandstructur first case brillouin zone must sampl adequ grid gener homogen distribut kpoint throughout brillouin zone eg monkhorstpack grid generalis grid see ngkpt nshiftk shiftk even gener kptrlatt list interest k point set gener automat includ measur accuraci term integr within brillouin zone see prtkpt kptrlen metal joint converg studi tsmear kpoint grid import definit path kpoint see topicelecbandstructur detail explan concern converg respect kpoint sampl number kpoint use sampl full brillouin zone invers proport unit cell volum may also vari lot system system rule thumb system larg band gap need kpoint metal need lot kpoint produc converg result larg system invers scale respect unit cell volum unfortun stop least one kpoint must use effect number kpoint use strongli influenc symmetri system sinc irreduc part brillouin zone must sampl moreov timerevers symmetri k equival k use groundstat calcul reduc sometim even portion brillouin zone sampl number k point use calcul name nkpt anoth way take advantag timerevers symmetri specif case kpoint invari k k sent anoth vector distant origin one vector reciproc lattic see explan advantag use kpoint rule thumb homogen system reason accuraci may reach product number atom number kpoint full brillouin zone order larger wide gap insul order small gap semiconductor like si beyond metal depend valu input variabl tsmear soon vacuum system product natom nkpt much smaller isol molecul suffici larg supercel one kpoint enough relat input variabl related_vari select input file selected_input_fil tutori tutorialbaseth tutori deal crystallin silicon insul definit kpoint grid smear cutoff energi comput band structur converg studi descript set paramet multi dataset calcul author xg sourc file topic edit page give hint set paramet multi dataset calcul abinit packag introduct simplest use abinit correspond one task one set data exampl determin total energi geometri set plane wave set kpoint often need redo calcul differ valu paramet let thing equal typic exampl converg studi need determin cutoff energi give need accuraci case one make chain calcul order comput band structur first selfconsist calcul densiti potenti eigenenergi comput along differ line similarli dfpt gw bse calcul reli preliminari calcul groundstat wavefunct purpos multidataset mode implement allow code treat one run differ set data chain number dataset treat specifi variabl ndtset indic dataset default eventu provid array jdtset udtset full descript multidataset capabl abinit found helpabinitmultidatasetth multidataset section abinit help file import mechan allow pass inform obtain earlier calcul defin get input variabl import exampl getden chain selfconsist determin densiti nonselfconsist calcul kohnsham band structur getwfk chain groundstat determin wavefunct dfpt gw comput tip abipi provid programmat interfac gener input file python futher detail pleas consult abinitinputnb relat input variabl related_vari select input file selected_input_fil descript tune output comput quantiti author fj sourc file topic edit page give hint tune output comput quantiti abinit packag introduct follow input variabl use trigger modifi output quantiti main output file relat input variabl related_vari select input file selected_input_fil descript specifi unit cell author fj sourc file topic edit page give hint specifi unit cell abinit packag introduct abinit need three dimens noncoplanar vector form unit cell set real space lattic initi set three vector specifi real space rprim unit vector angl angdeg dimens second step use scale factor specifi acel rescal cartesian coordin specifi scalecart intern final result rprimd matter detail explan found look rprim note abinit expect mix product three vector rxrr posit case exchang two associ reduc coordin inform way real space lattic reciproc lattic symmetri defin abinit found pdfgeometryher also note abinit space group routin use default strict toler recognit symmetri oper mean lattic vector atom posit must give enough figur code detect correct space group especi true case hexagon rhombohedr lattic rememb one specifi ration number syntax xred instead less precis xred use acel angdeg instead rprimd may solv possibl issu space group recognit input paramet correspond highsymmetri structur numer valu hand noisi may want increas valu tolsym input file abinit resymmetr automat input paramet final one use structur input variabl initi crystallin geometri extern file instanc possibl read crystallin structur extern netcdf file format poscar without specifi valu natom ntypat typat znucl smart symmetris abinit also smart symmetris capabl spgroup brvltt case convent unit cell must input usual input variabl rprim angdeg acel andor scalecart abinit fold convent unit primit cell also gener nuclei posit irreduc one see topicsmartsymm relat input variabl related_vari select input file selected_input_fil tutori tutorialbasefourth basic tutori determin surfac energi aluminum chang orient unit cell descript comput elast piezoelectr intern strain tensor dfpt author mt sourc file topic edit page give hint comput elast piezoelectr intern strain tensor dfpt abinit packag introduct dfpt theori comput elast piezoelectr intern strain tensor present citehamann see topicdfptgener dfpt well tutori tutorialelast preliminari run abinit see rfstr anaddb see anaddbelaflag elast tensor anaddbpiezoflag piezoelectr tensor relat input variabl related_vari select input file selected_input_fil tutori tutorialelasticth tutori elast properti present comput respect strain perturb respons elast constant piezoelectr tutorialparal_dfptparallel responsefunct calcul addit inform use dfpt parallel descript tune speed memori usag author xg sourc file topic edit page give hint tune speed memori usag abinit packag introduct major factor govern speed abinit run given physic system size planewav basi set see topicplanewav size wavevector grid sampl see topickpoint parallel see topicparallel two first factor tradeoff cpu time precis comput third factor limit maxim speedup achiev also resourc must avail beyond major factor still room adjust need planewav basi set depend pseudopotenti paw atom dataset use might softer other need smaller planewav basi set might possibl less accur well one interest groundstat properti forc one might also get speed use realspac represent densiti potenti real space fft grid allow fine detail taken account actual filter quantiti achiev lower boxcutmin theoret need valu choic fft algorithm implement see fftalg might also lead signific speed specif machin specif kpoint timerevers symmetri use repres wavefunct real part instead real complex part allow halv memori need well cpu time see istwfk gw calcul made less memori cpu time consum expens numer precis compil abinit option enable_gw_dpcno ac file asid use input variabl sometim solv memori problem user increas stack size limit use linuxosx one get stack size use ulimit set larger limit use eg ulimit mb cach size ulimit unlimit os allow note version oper automat perform abinit begin run input variabl relat tune speed memori usag expert user relat input variabl related_vari select input file selected_input_fil descript select scf algorithm author xg sourc file topic edit page give hint select scf algorithm abinit packag introduct selfconsist field calcul allow determin solut kohnsham equat end converg selfconsist wavefunct densiti kohnsham potenti differ algorithm chosen converg solut set equat input variabl iscf govern choic densitypotenti selfconsist algorithm wfoptalg focus determin wavefunct solut schroding equat fix kohnsham potenti first class algorithm select iscf pulay mix one effici also effici precondition speed converg among differ choic gener kerker precondition implement see diemac diemix dielng order perform nonselfconsist calcul wavefunct correspond eigenvalu fix potenti repres full band structur loop densitypotenti selfconsist must disabl iscf must chosen among algorithm find wavefunct select wfoptalg conjugategradi lobpcg one favourit rmmdii algorithm faster might unstabl use molecular dynam run long geometri optim use chebyshev filter massiv parallel run inner electron eigenvalu comput thank minimis residu respect target energi valu see eshift relat input variabl related_vari select input file selected_input_fil descript master use normconserv pseudopotenti paw atom data consequ author xg sourc file topic edit page give hint master use normconserv pseudopotenti paw atom data consequ abinit packag introduct abinit read mani differ type normconserv nc pseudopotenti paw atom data name file use abinit run provid input file one topicatomtypestyp atom list pseudopotenti pseudo input variabl option directori pseudo locat pp_dirpath note one mix nc pseudopotenti paw atom data file singl abinit run even differ dataset one stick either nc pseudopotenti paw ultrasoft formal implement normconserv pseudopotenti tabl sever set nc pseudopotenti avail element period tabl either lda ggapb httpswwwabinitorgpsptablesrecommend one ggapb ixc come oncvpsp gener formal pleas consult citehamann gener valid tabl discuss citesetten tableshttpswwwabinitorgatomicdatafil also avail goedeck hgh tabl eg lda ixc also includ spinorbit rather accur requir often larg ecut old troulliermartin type tabl deprec accur enough also includ spinorbit coupl differ format normconserv pseudopotenti describ pseudo page develop sectiondeveloperspsp_info much flexibl power file format psml recent propos citegarcia format support abinit via psml librari must activ user configur packag import abinit read nc pseudo upf format pseudo written follow recent upf specif also ultrasoft paw pseudo upfupf format support paw atom data tabl five larg set paw atom data read abinit httpswwwabinitorgpsptablesjth tabl recommend ggapb ixc use pawxml format othershttpswwwabinitorgatomicdatafil also avail valid mani pseudopotenti nc well paw test allelectron calcul see section document tool paragraph delta project httpswwwabinitorgdownloadspawth abinit web site paw page tutorialpaw explain perform detail comparison allelectron code gener six code avail gener new pseudopotenti need see httpswwwabinitorgatomicdatafilesth relat abinit web page normconserv pseudopotenti oncvpsp prefer one ultrasoft pseudopotenti gener uspp approxim projector augment wave approach treat within paw framework abinit atompaw gener actual tightli connect abinit abinit automat test paw atom data gener use abinit also dedic tutori atompawabinit miscellan normconserv pseudopotenti mix gener alchem pseudoatom see topicatomtyp featur avail paw relat input variabl related_vari select input file selected_input_fil tutori tutorialpawsecond tutori projectoraug wave techniqu gener atom data tutorialpawthird tutori projectoraug wave techniqu test paw dataset allelectron code descript manag file format interfac applic outsid abinit organis author xg sourc file topic edit page give hint manag file format interfac applic outsid abinit organis abinit packag introduct long time abinit produc file either text format fortran binari format drawback difficult read code also difficult maintain long run chang must propag read routin follow advent nanoquantaetsf file formathttpwwwetsfeufileformat abinit gradual shift toward use file format address content especi netcdf xml netcdf use file typic store larg amount data like wavefunct densiti potenti etc one even shift hdf due time file xml use smaller file eg psml pseudopotenti use common siesta code yaml file allso recent appear abinit document relat input variabl related_vari select input file selected_input_fil descript gener perform dfpt calcul author mt sourc file topic edit page give hint gener perform dfpt calcul abinit packag introduct densityfunct perturb theori dfpt allow one address larg varieti physic observ mani properti interest comput directli deriv energi without use finit differ phonon mode elast tensor effect charg dielectr tensor etc even nonlinear properti comput like raman intens latter see topicnonlinear dfpt calcul workflow conduct follow run groundstat calcul order extract kohnsham pseudo wavefunct must extrem well converg necessari eg applic deriv hamiltonian respect electr field determin deriv wave function respect wave vector k keep file keyword rfddk use perform type calcul comput ndorder deriv matrix ie nd deriv energi respect differ perturb  done thank keyword rfphon atom displac rfstr strain rfelfd electr field rfmagn magnet field launch anaddb tool distribut abinit analys deriv databas comput relax tensor thermodynam properti note paw calcul perform postprocess anaddb recommend includ keyword enforc sum rule acoust sum charg neutral inde paw formal involv atom calcul larg number real space integr whose numer effect may break translat invari thank local provid paw partial wave basi possibl perform respons function calcul correl electron materi dftu formal usabl without restrict pawdfpt calcul tutori dedic respons function follow normconserv pseudopotenti paw atom dataset dfpt abinit implement nonmagnet collinear well noncollinear system nspden well howev treatment strain perturb yet implement nspden noncollinear system detail explan perform respons calcul given helprespfn relat input variabl related_vari select input file selected_input_fil tutori tutorialrfth tutori responsefunct rf present basic dfpt calcul within abinit exampl given studi dynam dielectr properti ala insul phonon gamma dielectr constant born effect charg loto split phonon whole brillouin zone creation deriv data base ddb present tutorialrfth tutori responsefunct rf present analysi ddb introduc preceed tutori rf comput interatom forc comput thermodynam properti outcom tutori tutorialelasticth tutori elast properti present comput respect strain perturb respons elast constant piezoelectr tutorialparal_dfptparallel responsefunct calcul addit inform use dfpt parallel tutorialnlotutori static nonlinear properti electron nonlinear suscept nonreson raman tensor electroopt effect descript unfold supercel band structur author sourc file topic edit page give hint unfold supercel band structur abinit packag introduct supercel often use ab initio calcul model compound alloy surfac defect band structur plot obtain supercel calcul difficult interpret compar refer band structur correspond primit crystallograph unit due zone fold purpos execut file helpfoldbloch assist interpret supercel electron structur calcul recov bloch charact electron eigenst perturb disord gener singl wavevector k associ particular eigenvalu e rather distribut ks distribut also known bloch spectral densiti spectral weight spectral weight w n k amount bloch k charact nth energi eigenst n fulfil normal k wn k case nonloc basi set plane wave spectral weight construct fourier expans coeffici gather group associ particular bloch wave vector primit cell citewang citepopescu citepopescu citeallen citemedeiro wn k g c n k g g fulfil k g k g cn k g refer plane wave coeffici nth eigenst wave vector k within first brillouin zone bz supercel g g reciproc lattic vector supercel primit cell respect technic detail unfold procedur avail citerubel note primit supercel reciproc lattic commensur requir equat condit impli supercel need gener translat primit cell along lattic vector real space use desir multipl n xnynz care taken work lattic whose convent unit cell differ primit cell eg zincblend rock salt structur prerequisit unfold presenc wave function file eg abo_wfk gener way similar standard band structur calcul differ convent band structur calcul kpath select approach instanc aim band structur plot z path primit brillouin zone bz kptbound supercel bz includ zz first part z seem redund lie outsid rang interest howev easi show wave vector contribut rang z unfold instanc let us consid kpoint k supercel point unfold kpoint primit bz k k k first two point irrelev purpos plot belong z segment last point fall rang interest need includ wave function file prepar unfold proce invok foldbloch abo_wfk nxnynz gener output file abo_wfkfb output file contain column list unfold wave vector kxkykz primit bz correspond eigenvalu n ha bloch spectral weight wn matlab script _ubs_dotsm_ design assist plot unfold band structur unfold band structur plot repres scatter plot size colour marker carri inform bloch charact energi band user ask provid detail kpath name foldbloch output file abo_wfkfb posit fermi energi reciproc lattic vector found main output file ab_outout relat input variabl related_vari select input file selected_input_fil tutori tutorialfoldblochth tutori unfold supercel band structur descript specifi band occup number metal insul author fj sourc file topic edit page give hint specifi band occup number metal insul abinit packag introduct metal well insul system treat depend valu occopt default valu occopt correspond insul finit molecul number band state molecul deduc number electron brought pseudopotenti ion band occupi two electron case nonspinpolar system one electron case spinpolar system small number empti band ad eg obtain band gap metal system use valu occopt abinit comput default number band includ nearli unoccupi one find occup number differ valu occopt correspond differ smear scheme smearn defin tsmear defin occup number eg fermi broaden gaussian broaden gaussianhermit broaden well modif propos marzari finit temperatur also treat thank smear scheme citeverstraet scheme use tphysel gap materi treatment quasifermi energi valenc conduct band popul electron conduct band hole valenc band avail occopt possibl defin manual number band input variabl nband well occup number input variabl occ might use perform scf calcul excit state relat input variabl related_vari select input file selected_input_fil tutori tutorialbaseth tutori deal h molecul get total energi electron energi charg densiti bond length atomis energi tutorialbaseth tutori deal h molecul converg studi lda versu gga tutorialbaseth tutori deal crystallin silicon insul definit kpoint grid smear cutoff energi comput band structur converg studi tutorialbaseth tutori deal crystallin aluminum metal surfac occup number smear fermidirac distribut surfac energi converg studi descript build input file ground state calcul author fj sourc file topic edit page give hint build input file ground state calcul abinit packag introduct comput ground state energi assembl nuclei electron place repeat cell done use plane wave normconserv pseudopotenti socal projectoraug wave paw method appropri pseudoatom data wavelet wavelet framework describ topicwaveletsher plane wave framework program admit mani differ type pseudopotenti sever complet set normconserv pseudopotenti avail element period tabl recommend tabl ggapb ggapbesol lda come pseudodojo project oncvpsp pseudopotenti citehamann scalarrelativist format fullyrelativist version spinorbit coupl paw calculationth recommend one ggapb lda jth tabl paw xml format citejollet choic normconserv pseudopotenti paw deduc automat choic pseudopotenti file file input file must specifi follow item topiccrystalcrystallin structur symmetri set topickpointskpoint use topicxcexchang correl function converg set possibl topicpawpaw special set possibl input variabl topicspinpolarisationspinpolar system spin orbit coupl calcul exampl minim input file calcul ground state crystallin aluminium given crystallin aluminum calcul total energi fix number k point broaden definit occup number occopt tsmear definit unit cell acel equival rprim fcc primit vector scale acel definit atom type ntypat one type atom znucl keyword znucl refer atom number possibl type atom pseudopotenti mention file file must correspond type atom type aluminum definit atom natom one atom per cell typat atom type aluminum xred keyword indic locat atom follow one triplet number atom triplet give reduc coordin atom definit planewav basi set ecut maxim kinet energi cutoff hartre pawecutdg maxim kinet energi cutoff hartre fine grid case paw calcul definit kpoint grid ngkpt xx fcc grid base primit vector chksymbreak definit scf procedur nstep maxim number scf cycl toldf stop twice row differ two consecut evalu total energi differ less toldf hartre valu way larg realist studi materi relat input variabl related_vari select input file selected_input_fil tutori tutorialbaseth tutori deal h molecul get total energi electron energi charg densiti bond length atomis energi tutorialbaseth tutori deal h molecul converg studi lda versu gga tutorialbaseth tutori deal crystallin silicon insul definit kpoint grid smear cutoff energi comput band structur converg studi tutorialbaseth tutori deal crystallin aluminum metal surfac occup number smear fermidirac distribut surfac energi converg studi descript fit build lattic model multibinit author page give hint build lattic model multibinit introduct multibinit softwar base secondprincipl approach lattic dynam simul use atom potenti fit firstprincipl calcul citewojdel see helpmultibinitmultibinit user guid set lattic model first step secondprincipl approach harmon part possibl anharmon part harmon part see tutori anharmon part see topic name topicfitprocess topic fit process topicboundingprocess topic bound process one run dynam see topicdynamicsmultibinit topic run dynam tutori tutoriallattice_modelfirst lesson multibinit explain build lattic model run dynam relat input variabl related_vari select input file selected_input_fil descript use symetri inform build system irreduc part primit cell author fj sourc file topic edit page give hint use symetri inform build system irreduc part primit cell abinit packag introduct sometim user know space group system convent cell vector well posit atom asymmetr irreduc part cell data abinit gener usual primit cell vector well coordin atom cell activ spgroup brvltt user need specifi number atom read natrd asymmetr part cell well expect number atom natom primit cell addit inform axe orient spgaxor cell origin spgorig might also given see helpspacegroupth space group help file specif magnet space group even possibl antiferromagnet see spgroupma genafm see also topicunitcel relat input variabl related_vari select input file selected_input_fil author ss xg yg nap optic util frequenc depend linear optic dielectr function second order nonlinear optic suscept file explain io paramet need calcul frequencydepend linear optic dielectr function secondord nonlinear optic suscept rpa approxim sumoverst use independ electron state thank optic util abinit packag user advis familiar main helpabinit read present file knowledg comput linear respons partial partial k perturb explain helprespfn also advis easier discov present file help tutorialopticopt tutori introduct optic util allow comput frequencydepend linear optic dielectr function secondord nonlinear optic suscept includ nonlinear suscept linear electroopt coeffici introduct comput given citesharma onlin httparxivorgabscondmat use refer includ citehugh citedraxl onlin httparxivorgabscondmat citesharma onlin httparxivorgabscondmat go detail explan optic util user advis becom familiar theori behind explain refer familiar least citesharma strongli advis specif purpos optic util read momentum matrix element gener abinit actual matrix element partial hpartial k oper use approach citesharma determin linear eq nonlinear eq optic respons materi investig note optic work independentparticl approxim exciton without localfield effect higher level theori use bethesalpet equat see tutorialbsebs tutori intraband drude term metal also includ usual small effect visibl frequenc import effect smaller frequenc see eg citecazzaniga fig run optic use optic quit simpl optic opticabi opticlog opticstderr howev abl use optic must obtain main abinit program four differ file correspond physic system want studi ground state wavefunct file index _wfk three file contain matrix element partial h partial k oper unperturb wavefunct one direct space suppos read helpabinitmain abinit help file product first file requir addit explan howev way obtain three file contain matrix element dhdk oper worth explain straightforward relationship exist dhdk matrix element matrix element momentum oper comput dhdk matrix element initi step treatment respons electr field dfpt longwav method well berryphas treatment electr field allow establish equival offdiagon matrix element posit oper offdiagon matrix element deriv respect wavevector partial partial k period part bloch function see exampl section vi citegonz citenun calcul involv appli dhdk oper unperturb wavefunct sternheim equat main abinit program capabl comput deriv wavefunct respect wavevector explain helprespfn calcul impli treat three ddk perturb index number natom natom natom thu exampl unit cell atom perturb number twoatom case associ file need optic index _wf _wf _wf howev mention comput dhdk matrix element initi step calcul still partial hpartial k made avail file formal implement optic treat explicitli eigenst lie rang energi lowest occupi wavefunct highest one plu maxim excit energi chosen user one neglect two import consequ preliminari run ground calcul must produc explicitli eigenst eigenvalu target rang energi restrict occupi wavefunct one need full chang bloch wavefunct respect partial partial k matrix element partial hpartial k wavefunct rang energi latter comput respons partial partial k perturb much shorter usual inde matrix element explicitli groundstat wavefunct comput begin abinitrespfn run necessari make full calcul modif wavefunct due chang wavevector explain nstep set calcul idinputa optic input file input variabl pleas note format input file optic chang abinit v sinc input paramet requir optic opticin file contain namelist format order three part name file paramet comput must kept unalt fortran file ddkfile_ toptic_o_ds_wf ddkfile_ toptic_o_ds_wf ddkfile_ toptic_o_ds_wf wfkfile toptic_o_ds_wfk paramet broaden domega maxomega scissor toler comput num_lin_comp lin_comp num_nonlin_comp nonlin_comp num_linel_comp linel_comp list input variabl optic input file present topicopt idoutputa optic output file linear optic respons data file name case_a_blinoptout contain follow data set column energyev column imaginari part ab compon frequencydepend linear dielectr tensor column energyev column real part ab compon frequencydepend linear dielectr tensor column energyev column absolut valu ab compon frequencydepend linear dielectr tensor column energyev column imaginari part ab compon frequencydepend linear refract index kappa column energyev column real part ab compon frequencydepend linear refract index n column energyev column frequencydepend reflect normal incid column energyev column absorpt coeff omega imepsilon c nepsilon header file find inform calcul case nsppol spindecomposit item provid column imaginari part real part spinindepend contribut deltaab mention well nonlinear optic respons data file name case_a_b_cchikindout kindthi totim totr totab contain column energyev column imaginari kindtotim real kindtotr absolut kindtotab valu abc compon nonlinear optic suscept second column contain valu electrostat unit esu third column contain valu si unit name case_a_b_cchikindout kindthi im ab contain column energyev column inter column intra band contribut imaginari kindim real kindr absolut kindab valu abc compon nonlinear optic suscept compon label inter intra eq citesharma valu electrostat unit esu header file find inform calcul idtroubleshootinga troubleshoot get zero linoptout file sever possibl let us explor compon dielectr tensor look could zero due symmetri crystal normal zz compon good place start almost never zero check file case___linoptout ii compon zz zero seriou use default input file tin pleas check line number second number use default input file pleas calcul zz compon make sure zero iii even zz compon zero possibl endless maximum frequenc line number tin small number band use perform ground state calcul small get zero chikindout file two common mistak calcul second order respons materi invers symmetri case compon correctli zero small order ii compon zero due symmetri crystal pleas calcul differ compon author xg dca dfpt respfn code page complement main helpabinit matter relat respons perturb comput dfpt easier discov present file help tutorialrfdfpt tutori idintroa introduc comput respons abinit comput respons differ perturb provid access quantiti second deriv total energi dte respect perturb present four type phonon static homogen electr field strain magnet field coupl spin orbit motion physic properti connect dte respect perturb phonon dynam matric dielectr tensor born effect charg addit strain perturb mix phonon electr field lead elast constant intern strain piezoelectr magnet field perturb recent addit abinit detail present function comput respons implement sooner later third deriv total energi dte also implement dte might give phononphonon coupl nonlinear electr respons anharmon elast constant gruneisen paramet basic quantiti abinit comput firstord deriv wavefunct wf respect perturb later calcul dte dte wf easi comput task construct dte respect perturb j j involv mainli evalu matrix element wf j andor wf j detail techniqu found citegonz citegonzea calcul wf particular perturb done use variat principl algorithm rather similar one use find unperturb groundstat wavefunct thu lot technic detail paramet groundstat responsefunct calcul justifi develop one uniqu code two class properti mani routin abinit common calcul duplic rel small modif abinit code perform rather primit analysi calcul dte exampl give phonon frequenc electron dielectr tensor effect charg main output code deriv databas ddb file contain set dte dte calcul code ddb manipul mrgddb code fulli analyz anaddb code see correspond helpmrgddb helpanaddb ida descript perturb perturb phonon type displac one atom along one axi unit cell unit length reduc coordin character two integ number one wavevector two integ number number move atom note ipert number axi unit cell note idir import ipert phonon perturb valu natom idir valu set possibl phonon perturb one wavevector thu natom element basi set phonon construct linear combin set atom move one dataset abinit determin input variabl rfatpol set direct consid one dataset abinit determin input variabl rfdir wavevector consid one dataset abinit determin input variabl nqpt qpt qptnrm perturb electr field type applic homogen electr field along axe reciproc lattic deriv hamiltonian respect electron wavevector along axe reciproc lattic allow comput deriv wavefunct respect wavevector auxiliari quantiti need applic homogen electr field perturb chang wavevector dk hamiltonian henc perturb refer deriv dk perturb ddk perturb note ddk perturb defin deriv respect k reduc coordin equival appli linear perturb strength pi along conjug direct real space statement come deriv phase factor expipi kr respect k reduc coordin note case electr field type perturb comput insid finit electr field deriv hamiltonian respect electron wavevector comput everyth done finit differ techniqu also definit homogen electr field perturb along axe reciproc lattic cartesian coordin sorri possibl confus electrictyp perturb also character two number ipert natom ddk perturb natom electr field idir phonon perturb although possibl electr field character nonzero wavevector envis futur version code present homogen field consid wavevector electr field type perturb gamma q perturb strain type either uniaxi strain shear strain strain perturb consid cartesian coordin xyz character two number ipert natom uniaxi strain natom shear strain idir describ particular compon explicitli uniaxi strain idir give xx strain perturb idir give yy strain perturb idir give zz strain perturb shear strain idir give yz strain perturb idir give xz perturb idir give xy perturb note rigidatom elast constant output abinit obtain frozen intern coordin intern coordin relax need give physic elast constant handl knowledg intern strain dynam matrix gamma anaddb cours intern coordin fix symmetri intern strain vanish rigidatom physic elast constant equal limit present implement v symmetri present use skip redund k point bz sum skip redund strain perturb also defin index perturb call pertcas equal idir ipert accordingli pertcas run natom need identifi output input file see section summari summar perturb character two number ipert natom idir well one wavevector gamma nonphonon perturb consid number call pertcas combin ipert idir run natom dte deriv total energi respect two perturb character two set idiripert two pertcas number dte need three set pertcas number addit depend one wavevector dte two wavevector dte nonstationari implement dte use offdiagon element abinit first pertcas correspond perturb give deriv potenti second pertcas correspond perturb give deriv wavefunct ida filenam input groundstat wavefunct file file gs calcul use rf calcul actual multidataset mode one abl make one abinit run groundstat comput well responsefunct comput file file must input file mani common input variabl differ case also separ one two groundstat wavefunct file might need file groundstat wavefunct set wavevector name kpoint file groundstat wavefunct correspond kq q wavevector perturb file also contain correspond eigenvalu note second file kq ident first one k case zerowavevector perturb also qwavevector map kpoint grid onto q differ point belong grid inform kq grid contain k grid fact abinit abl exploit one look input variabl irdwfk irdwfq descript groundstat wavefunct file name gener root name provid file file multidataset mode follow input variabl relev getwfk getwfq file name groundstat wavefunct file follow convent groundstat case thu read helpabinitfilesfilecorrespond section abinit help file need case electr field perturb output wf correspond ddk perturb need input option rfelfd use code take care first deriv dk perturb calcul write wf correct place output file begin homogen field perturb calcul usual use rfelfd recommend ddk comput often done differ paramet electr field perturb dataset rfelfd follow dataset rfelfd nomenclatur firstord wavefunct file also given helpabinitfilesfileabinit help file worth specifi detail root name form string charact third line file file input file fourth line file file output file complement multidataset mode _d dataset number string _wf ad follow pertcas index perturb give eg file file whose fourth line tmpo dataset number perturb correspond displac second atom x direct pertcas follow name correspond storder wavefunct output file tmpo_ds_wf file might use input anoth comput anoth dataset relev input variabl irdwf irdddk well getwf getddk multidataset mode idsymmetriesa use symmetri order understand correctli behaviour responsefunct run inform use symmetri must given perturb includ wavevector may invari symmetri code abl use symmetri skip perturb symmetr alreadi calcul except case strain perturb abinit also abl use symmetri keep perturb invari reduc number k point need sampl electron wavefunct brillouin zone although featur optim yet one except ddk perturb spatial symmetri use yet case unlik groundstat input kpoint set respons function decreas use spatial symmetri prior loop perturb see section timerevers symmetri retain calcul q ought use decreas input kpoint set consid perturb turn abinit abl select nonreduc set kpoint proper kpoint set automat use symmetri leav perturb invari accordingli prefer way gener kpoint grid cours use ngkpt kptrlatt input variabl differ valu kptopt kptopt ground state kptopt respons function q kptopt respons function nonzero q ida organis responsefunct comput agreement inform provid previou section differ case distinguish one consid respons atom displac q follow procedur suggest first selfconsist groundstat comput restrict set kpoint irreduc brillouin zone kptopt second selfconsist responsefunct comput atom displac perturb half set kpoint kptopt one consid respons electr field q follow procedur suggest first selfconsist groundstat comput restrict set kpoint irreduc brillouin zone kptopt second nonselfconsist responsefunct comput ddk perturb half set kpoint kptopt iscf third selfconsist responsefunct comput electr field perturb half set kpoint kptopt one consid respons atom displac special case q connect kpoint belong special kpoint grid follow procedur suggest first selfconsist groundstat comput restrict set kpoint irreduc brillouin zone kptopt second selfconsist responsefunct comput atom displac perturb full set kpoint kptopt one consid respons atom displac gener q point follow procedur suggest first selfconsist groundstat comput restrict set kpoint irreduc brillouin zone kptopt second nonselfconsist groundstat run set kq point might reduc thank symmetri kptopt third selfconsist responsefunct comput atom displac perturb full set kpoint kptopt cours differ step combin set respons look particular comput respons gamma case full dynam matrix well dielectr tensor born effect charg need combin follow first selfconsist groundstat comput restrict set kpoint irreduc brillouin zone kptopt second three nonselfconsist responsefunct comput one direct ddk perturb half set kpoint kptopt iscf third selfconsist responsefunct comput electr field perturb atom displac half set kpoint kptopt still comput perturb differ q wavevector mix follow comput suppos perturb q gener q point perform combin follow first selfconsist groundstat comput restrict set kpoint irreduc brillouin zone kptopt second three nonselfconsist responsefunct comput one direct ddk perturb half set kpoint kptopt iscf third q selfconsist responsefunct comput electr field perturb atom displac half set kpoint kptopt fourth nonselfconsist groundstat comput set kq point might reduc thank symmetri kptopt fifth selfconsist responsefunct comput atom displac perturb q wavevector full set kpoint kptopt note error dte linear groundstat wavefunct error unlik error due wf moreov larg prefactor associ sourc error even caus caus instabl scf procedur consequ converg groundstat wavefunct good true level ddk wavefunct mention introduct insid responsefunct part code calcul proce two step first calcul firstord deriv wavefunct wf combin wf build dte dte initialis part input file groundstat file read basic quantiti construct first part everi perturb examin one time separ file contain previou rf wavefunct eventu read minimis variat express perform procedur gener wf well firstord densiti potenti possibl know quantiti perturb ipert construct dte respect perturb ipert except ipert homogen electr field case deriv groundstat wavefunct respect wavevector ddk also need featur implement ipert phonon wavevector ipert homogen electr field firstord wavefunct wf written well firstord densiti potenti request ida list relev input variabl subset abinit input variabl modifi mean modifi behaviour case rf calcul list input variabl togeth variabl appli rf comput note code rf calcul optdriv one rfphon rfelfd nonzero amu getwfk getwfq getwf getddk irdwfk irdwfq irdwf irdddk iscf nkpt nqpt qpt qptnrm nsym rfasr rfatpol rfdir rfelfd rfphon dfpt_sciss tolwfr toldf tolvr idoutputa differ output file output code goe sever place list log file file log file abinit code comput ground state gs result possibl output dataset relat respons function intertwin concern groundstat case purpos file gs case use error messag unchang ida main output file file main output file abinit code comput ground state gs result possibl output dataset relat respons function intertwin concern groundstat case explain part relat rf comput initialis part gs reader advis read helpabinitoutputfilesect abinit help file well first paragraph section helpabinit file afterward content main output file differ bit main output file report initialis groundstat wavefunct kq loop perturb begin perturb short descript perturb time inform report initialis wf iter minimis begin output file describ number iter second deriv total energi obtain dtenergi ha chang dtenergi sinc last iter maximum residu band k point squar potenti residu iter complet residu report case deriv dk perturb ek explain fsum rule ratio valu print fsum rule ratio close ecutsm howev compon dtenergi broken piec depend perturb dtenergi hartre ev relax contribut caus chang wavefunct nonrelax contribut ewald frozenwavefunct contribut dtenergi evalu use nonvari express comput perturb output file report dte matrix element part execut perturb deriv dk perturb give follow inform prtvol bigger full detail everi contribut dte reduc coordin dte reduc coordin use dte perform alreadi analysi data without use mrgddb anaddb code name full dynam matrix cartesian coordin mass includ effect charg dielectr tensor phonon frequenc includ analysi non analyt gamma note phonon frequenc lower dha absolut valu automat set zero imaginari phonon frequenc squar root neg eigenvalu indic instabl print neg facilit postprocess last analysi code assum whole set perturb class calcul either phonon perturb homogen electr field perturb true code give result may wrong case reduc system coordin cartesian dynam matrix effect charg tensor dielectr matrix case wrong phonon frequenc also code put zero matrix element calcul warn messag issu inform trust final code provid time inform ida firstord wavefunct wf file unformat data file contain planewav coeffici wavefunct written follow format first header see helpabinitheadersect abinit help file follow fortran bantot count band index index wavefunct isppolnsppol ikptnkpt writeunit npwnspinornband k point writeunit kgnpw plane wave reduc coordin ibandnband writeunit eigenjbandibandnbandbantotjbandnband column eigenvalu matrix writeunit cgiiindexiinpwnspinor wavefunct coeffici enddo singl band k point bantotbantotnband indexindexnpwnspinornband enddo enddo code section npwikpt number planewav basi kq point nbandikpt likewis number band k point may vari among k point depend occopt factor write wavefunct result fact complex eigen array contain matrix element firstord hamiltonian differ groundstat wavefunct could use build electronphonon coupl deform potenti note format firstord wf file differ format use groundstat wf file fact eigen array vector written correspond wf write wf one k point firstord densiti file consist header line follow fortran writeunit rhorirircplexngfftngfftngfft rhor chang electron densiti electronsbohr paramet cplex q q inde q densiti chang real quantiti complex gener q idddba deriv databas ddb made two part first allow one unambigu identifi run gener ddb second part contain dte group block data note ddb output abinit code merg ddb describ helpmrgddbmrgddb help file first part contain ddb version number defin structur ddb seven paramet need dimens ddb file natom nkpt nsppol nsym ntypat occopt nband array nband nkpt nsppol occopt differ inform run gener dte acellamuecutiscfixckptkptnrm ngfftoccrprimdfpt_scisssymrelxredtnonstypattolwfrwtkziontypat well inform pseudopotenti mean kleinmanbyland energi valu simpli transcript input data simpl intern paramet note format content first part ddb updat futur second part contain number data block data block type block number element list element element dte block describ integ real number first integ defin first perturb form idiripert two next defin second perturb form idiripert matrix element correspond deriv total energi respect paramet correspond perturb real number real imaginari part dte sometim code use spatial symmetri timerevers symmetri even permut first second perturb deduc valu noncomput matrix element behaviour might improv sometim confus idnumericalqualitya numer qualiti calcul possibl get rf calcul essenti exact deriv total energi respect perturb publish account fact citegonz agreement digit obtain comparison finitediffer deriv gs data accuraci calcul thu entir determin input paramet user choos rf run preparatori gs run review converg paramet usual gs calcul indic specif featur relat rf calcul input paramet could influenc accuraci calcul ecut energi cutoff depend strongli pseudopotenti ixc describ exchangecorrel function nkptor accur brillouin zone sampl determin altern input variabl ngkpt kptrlatt one selfconsist converg toler paramet toldf tolvr tolwfr input paramet ecut ecutsm ixc intxc set kwavevector well relat variabl groundstat calcul go rf run rf run name tri use groundstat wavefunct file produc ecutha rf run ecutha case code complain stop case might simpli produc garbag valu ngfft input hand valu must also equal gs rf case alway use ngfft larg enough boxcut larger order avoid fft filter error gs case boxcut small could allow case allow rf calcul sensit error converg test respect ecut kpoint grid done care alreadi emphas helpabinit emphas user test converg directli properti interest exampl user want phonon frequenc accur cm hesh could lead full calcul gsrf phonon ha anoth full calcul ha anoth ha error reli toler total energi exampl mhaatom geometri accuraci one part per thousand bond length draw priori conclus converg quantiti monitor converg directli clear phonon frequenc need check converg phonon frequenc user note band small occup metal case well unoccupi band insul ground state run preceed respons function run necessarili converg wavefunct use usual groundstat test toldf better tolvr sure inaccuraci introduc respons function calcul poorli converg unoccupi band separ run start save charg densiti prtden selfconsist run use iscf tolwfr may need atdep util temperatur depend effect potenti tdep method develop hellman et al citehellman citehellman citehellmana atdep implement abinit perform use first time j bouchet f bottin citebouchet citebouchet manual found pdf file pdfatdep_guid atdep guid prerequisit theori approach use code detail public dedic develop formula see pdfatdep_paperatdep paper strongli encourag user care read paper begin vibrat elast thermodynam quantiti comput atdep present write convent one use output file atdep manner comprehens understand abinit basic variabl also requir order fill input file read output file atdep addit paper also use understand limit converg inher present method particular point sometim discuss articl refer illustr exampl abinit comput run atdep preliminari abinit simul need one could molecular dynam trajectori set ground state calcul specif configur repres given thermodynam state configur merg singl netcdf file histnc ii three separ ascii file fcartdat xreddat etotdat forc cartesian coordin posit reduc coordin total energi ha written output file abinit later case file built easili concaten one time step configur use agrep shell instruct exampl atdep comput manner perform abinit use atdep quit simpl one execut atdep follow sh atdep inputfil log inputfil file contain line first one defin input file second one netcdf file present see third one defin root output file inputin histnc output detect histnc file perform begin one absent code automat search asciidat file input file exampl atdep calcul special case netcdf file histnc employ found testv_ input file given testsvinput directori let us describ briefli testv_ file dialog testsvinputtabi input file format fix file begin normalmod debugmod keyword finish theend line read line unit cell definit option input fix option input theend format free detail section unit cell definit defin bravai lattic bravatdepbrav simpl cubic number atom unit cell natom_unitcellatdepnatom_unitcel atom reduc coordin unit cell xred_unitcellatdepxred_unitcel perovskit type atom unit cell typat_unitcellatdeptypat_unitcel one atom one atom b atom c section supercel definit defin multipl supercel respect unit cell multipl simpl xx multipl unit cell temperatur system temperatureher k section comput detail defin rang nstep_maxatdepnstep_maxnstep_minatdepnstep_min time step configur time step cutoff radiu pair interact rcutatdeprcut interact pair bond length larger bohr consid section option input defin larg number option keyword ngqptatdepngqpt defin qpoint grid vdo integr set order test suffici fast mean thermodynam quantiti sens input variabl defin atdep section input variabl descript note input variabl defin inputin file obtain histnc file particular featur supercel subsuptodo explain extra input variabl ascii file employedsupsub output file larg number output file obtain execut atdep dialog testsvrefstabo dialog testsvrefstomegadat dialog testsvrefstthermodat abo main output file includ echo input variabl intermediari result definit variou shell interact second order ifc atom shell elast constant moduli energi model omegadat contain dispers phonon frequenc mev along path brillouin zone thermodat list thermodynam quantiti obtain consid system quantum harmon crystal specif heat vibrat energi entropi free energi also give contribut function temperatur harmon approxim symdat detail symmetri oper bravai lattic qptdat defin qpoint grid use comput phonon frequenc contain omegadat file xredaveragexyz includ ideal averag posit supercel indymdat contain symmetri relat one two atom unit cell supercel vdosdat display vibrat densiti state mev dijdat list dynam matric particular set qpoint etotmdvstdepdat compar md trajectori one comput use second order ifc one must superimpos much possibl fcartmdvstdepdat plot md forc wrt forc comput use second order ifc cloud point must closer first bisector eigenvectorsdat list eigenvector particular set qpoint nbcoeffphijdat show number ifc coeffici reduc shell symmetri author rc list symmetri space group page present list symmetri space group characterist also applic deriv space group list symmetri group part onlin help abinit code besid classic crystallograph inform provid valu certain symmetryrel variabl use input file abinit code tabl entri follow spgroup space group number found intern tabl crystallographi edit citehahn spgaxor space group axi orient orient unit cell axi allow valu trigon group repres hexagon axe repres rhombohedr axe orthorhomb group abc abc abc cab abc bca abc acb abc bac abc cba monoclin possibl depend space group spgorig space group origin posit origin unit cell allow valu correspond actual choic intern tabl crystallographi edit brvltt bravai lattic type bravai lattic allow valu primit associ translat inner center b c associ translat face center b b c c associ translat c center b associ translat center b c associ translat b center c associ translat rhombohedr lattic intern intern notat space group schoenfli equival schoenfli notat space group multipl x z maximum multipl appli bravai lattic translat correspond gener posit x z list symmetri space group section present list symmetri space group characterist also applic deriv space group tabl border cellspac cellpad tr td width spgroup td td width spgaxor td td width spgorig td td width brvltt td td width intern td td width schoenfli td td width order td tr trtd tdtd tdtd tdtd tdtd p tdtd csupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd p tdtd cisupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd p_b p tdtd csupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd p_c p tdtd csupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd p_a p tdtd csupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd p_b p tdtd csupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd p_c p tdtd csupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd p_a p tdtd csupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd c_b c tdtd csupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd c_b tdtd csupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd c_b tdtd csupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd c_c tdtd csupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd c_c b b tdtd csupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd c_c tdtd csupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd c_a b tdtd csupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd c_a c tdtd csupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd c_a tdtd csupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pm_b pm tdtd cssupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pm_c pm tdtd cssupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pm_a pm tdtd cssupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pc_b pc tdtd cssupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pc_b pn tdtd cssupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pc_b pa tdtd cssupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pc_c pa tdtd cssupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pc_c pn tdtd cssupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pc_c pb pb tdtd cssupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pc_a pb tdtd cssupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pc_a pn tdtd cssupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pc_a pc tdtd cssupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd cm_b cm tdtd cssupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd cm_b tdtd cssupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd cm_b im tdtd cssupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd cm_c tdtd cssupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd cm_c bm bm tdtd cssupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd cm_c im tdtd cssupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd cm_a bm tdtd cssupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd cm_a cm tdtd cssupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd cm_a im tdtd cssupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd cc_b cc tdtd cssupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd cc_b tdtd cssupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd cc_b ia tdtd cssupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd cc_c aa tdtd cssupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd cc_c bn tdtd cssupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd cc_c ib tdtd cssupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd cc_a bb tdtd cssupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd cc_a cn tdtd cssupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd cc_a ic tdtd cssupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pm_b pm tdtd chsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pm_c pm tdtd chsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pm_a pm tdtd chsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsubm_b psubsubm tdtd chsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsubm_c psubsubm tdtd chsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsubm_a psubsubm tdtd chsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd cm_b cm tdtd chsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd cm_b tdtd chsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd cm_b im tdtd chsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd cm_c tdtd chsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd cm_c bm bm tdtd chsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd cm_c im tdtd chsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd cm_a bm tdtd chsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd cm_a cm tdtd chsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd cm_a im tdtd chsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pc_b pc tdtd chsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pc_b pn tdtd chsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pc_b pa tdtd chsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pc_c pa tdtd chsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pc_c pn tdtd chsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pc_c pb pb tdtd chsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pc_a pb tdtd chsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pc_a pn tdtd chsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pc_a pc tdtd chsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsubc_b psubsubc tdtd chsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsubc_b psubsubn tdtd chsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsubc_b psubsuba tdtd chsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsubc_c psubsuba tdtd chsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsubc_c psubsubn tdtd chsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsubc_c psubsubb psubsubb tdtd chsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsubc_a psubsubb tdtd chsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsubc_a psubsubn tdtd chsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsubc_a psubsubc tdtd chsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd cc_b cc tdtd chsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd cc_b tdtd chsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd cc_b ia tdtd chsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd cc_c aa tdtd chsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd cc_c bn tdtd chsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd cc_c ib tdtd chsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd cc_a bb tdtd chsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd cc_a cn tdtd chsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd cc_a ic tdtd chsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd p tdtd dsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd p tdtd dsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsub tdtd dsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsub tdtd dsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsubsubsub tdtd dsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsubsubsub tdtd dsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsubsubsub tdtd dsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsubsubsubsubsub tdtd dsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd csubsub tdtd dsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd asubsub tdtd dsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd bsubsub tdtd dsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd c tdtd dsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd tdtd dsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd b tdtd dsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd f tdtd dsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd tdtd dsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd isubsubsubsubsubsub tdtd dsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pmm tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pmm tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pmm tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pmcsubsub tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pcmsubsub tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsubma tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsubam tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pbsubsubm tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pmsubsubb tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pcc tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd paa tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pbb tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pma tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pbm tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pmb tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pcm tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pcm tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pma tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pcasubsub tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pbcsubsub tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsubab tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsubca tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pcsubsubb tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pbsubsuba tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pnc tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pcn tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pna tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pan tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pbn tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pnb tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pmnsubsub tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pnmsubsub tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsubmn tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsubnm tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pnsubsubm tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pmsubsubn tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pba tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pcb tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pca tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pnasubsub tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pbnsubsub tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsubnb tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsubcn tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pcsubsubn tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pnsubsuba tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pnn tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pnn tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pnn tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd cmm tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd amm tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd bmm tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd cmcsubsub tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd ccmsubsub tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd asubsubma tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd asubsubam tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd bbsubsubm tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd bmsubsubb tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd ccc tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd aaa tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd bbb tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd amm tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd bmm tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd bmm tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd cmm tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd cmm tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd amm tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd abm tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd bma tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd bcm tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd cmb tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd cma tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd acm tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd ama tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd bbm tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd bmb tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd ccm tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd ccm tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd ama tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd aba tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd bba tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd bcb tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd ccb tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd cca tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd aca tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd fmm tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd fmm tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd fmm tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd fdd tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd fdd tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd fdd tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd imm tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd imm tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd imm tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd iba tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd icb tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd ica tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd ima tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd ibm tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd imb tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd icm tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd icm tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd ima tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pmmm tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pnnn_ tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pnnn_ tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pccm tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pmaa tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pbmb tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pban_ tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pban_ tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pncb_ tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pncb_ tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pcna_ tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pcna_ tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pmma tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pmmb tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pbmm tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pcmm tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pmcm tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pmam tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pnna tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pnnb tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pbnn tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pcnn tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pncn tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pnan tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pmna tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pnmb tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pbmn tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pcnm tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pncm tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pman tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pcca tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pccb tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pbaa tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pcaa tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pbcb tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pbab tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pbam tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pmcb tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pcma tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pccn tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pnaa tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pbnb tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pbcm tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pcam tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pmca tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pmab tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pbma tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pcmb tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pnnm tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pmnn tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pnmn tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pmmn_ tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pmmn_ tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pnmm_ tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pnmm_ tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pmnm_ tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pmnm_ tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pbcn tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pcan tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pnca tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pnab tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pbna tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pcnb tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pbca tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pcab tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pnma tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pmnb tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pbnm tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pcmn tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pmcn tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pnam tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd cmcm tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd ccmm tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd amma tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd amam tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd bbmm tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd bmmb tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd cmca tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd ccmb tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd abma tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd acam tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd bbcm tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd bmab tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd cmmm tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd ammm tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd bmmm tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd cccm tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd amaa tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd bbmb tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd cmma tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd cmmb tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd abmm tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd acmm tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd bmcm tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd bmam tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd ccca_ tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd ccca_ tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd cccb_ tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd cccb_ tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd abaa_ tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd abaa_ tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd acaa_ tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd acaa_ tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd bbcb_ tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd bbcb_ tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd bbab_ tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd bbab_ tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd fmmm tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd fddd_ tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd fddd_ tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd immm tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd ibam tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd imcb tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd icma tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd ibca tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd icab tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd imma tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd immb tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd ibmm tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd icmm tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd imcm tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd imam tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd p tdtd csupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsub tdtd csupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsub tdtd csupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsub tdtd csupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd tdtd csupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd isubsub tdtd csupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd p tdtd ssupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd tdtd ssupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pm tdtd chsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsubm tdtd chsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pn_ tdtd chsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pn_ tdtd chsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsubn_ tdtd chsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsubn_ tdtd chsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd im tdtd chsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd isubsuba_ tdtd chsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd isubsuba_ tdtd chsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsub tdtd dsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsub tdtd dsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsub tdtd dsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsubsubsub tdtd dsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd p tdtd dsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsub tdtd dsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsub tdtd dsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsubsubsub tdtd dsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd tdtd dsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd isubsub tdtd dsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pmm tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pbm tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pcm tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pnm tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pcc tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pnc tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsubmc tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsubbc tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd imm tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd icm tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd isubsubmd tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd isubsubcd tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pm tdtd ddsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pc tdtd ddsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsubm tdtd ddsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsubc tdtd ddsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pm tdtd ddsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pc tdtd ddsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pb tdtd ddsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pn tdtd ddsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd im tdtd ddsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd ic tdtd ddsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd im tdtd ddsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd id tdtd ddsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pmmm tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pmcc tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pnbm_ tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pnbm_ tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pnnc_ tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pnnc_ tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pmbm tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pmnc tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pnmm_ tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pnmm_ tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pncc_ tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pncc_ tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsubmmc tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsubmcm tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsubnbc_ tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsubnbc_ tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsubnnm_ tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsubnnm_ tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsubmbc tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsubmnm tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsubnmc_ tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsubnmc_ tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsubncm_ tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsubncm_ tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd immm tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd imcm tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd isubsubamd_ tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd isubsubamd_ tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd isubsubacd_ tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd isubsubacd_ tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd p tdtd csupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsub tdtd csupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsub tdtd csupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd r_h tdtd csupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd r_r tdtd csupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd p tdtd cisupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd r_h tdtd cisupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd r_r tdtd cisupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd p tdtd dsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd p tdtd dsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsub tdtd dsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsub tdtd dsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsub tdtd dsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsub tdtd dsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd r_h tdtd dsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd r_r tdtd dsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pm tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pm tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pc tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pc tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd rm_h tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd rm_r tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd rc_h tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd rc_r tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pm tdtd ddsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pc tdtd ddsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pm tdtd ddsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pc tdtd ddsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd rm_h tdtd ddsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd rm_r tdtd ddsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd rc_h tdtd ddsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd rc_r tdtd ddsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd p tdtd csupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsub tdtd csupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsub tdtd csupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsub tdtd csupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsub tdtd csupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsub tdtd csupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd p tdtd chsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pm tdtd chsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsubm tdtd chsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd p tdtd dsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsub tdtd dsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsub tdtd dsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsub tdtd dsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsub tdtd dsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsub tdtd dsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pmm tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pcc tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsubcm tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsubmc tdtd cvsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pm tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pc tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pm tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pc tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pmmm tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pmcc tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsubmcm tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsubmmc tdtd dhsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd p tdtd tsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd f tdtd tsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd tdtd tsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsub tdtd tsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd isubsub tdtd tsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pm tdtd thsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pn_ tdtd thsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pn_ tdtd thsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd fm tdtd thsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd fd_ tdtd thsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd fd_ tdtd thsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd im tdtd thsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pa tdtd thsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd ia tdtd thsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd p tdtd osupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsub tdtd osupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd f tdtd osupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd fsubsub tdtd osupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd tdtd osupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsub tdtd osupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd psubsub tdtd osupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd isubsub tdtd osupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pm tdtd tdsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd fm tdtd tdsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd im tdtd tdsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pn tdtd tdsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd fc tdtd tdsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd id tdtd tdsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pmm tdtd ohsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pnn_ tdtd ohsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pnn_ tdtd ohsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pmn tdtd ohsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pnm_ tdtd ohsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd pnm_ tdtd ohsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd fmm tdtd ohsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd fmc tdtd ohsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd fdm_ tdtd ohsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd fdm_ tdtd ohsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd fdc_ tdtd ohsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd fdc_ tdtd ohsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd imm tdtd ohsupsup tdtd tdtr trtd tdtd tdtd tdtd tdtd iad tdtd ohsupsup tdtd tdtr tabl bodyhtml author pcasek ff xg aim util file explain use io paramet need atominmolecul aim bader analysi util abinit packag aim util allow analys charg densiti produc abinit code aim analysi atominmolecul propos bader thank topolog properti charg densiti space partit nonoverlap region contain nucleu charg densiti region attribut correspond nucleu henc concept atom inmolecul introduct bader techniqu allow partit space attract region region center one atom input techniqu total charg densiti densiti gradient line start one point space lead one uniqu attract atom refer relev literatur provid around atom basin attract form irregular curv polyhedron differ polyhedra might face vertic apic common altogeth polyhedra span whole space point densiti gradient vanish call critic point cp belong surfac bader polyhedra accord number posit eigenvalu hessian densiti one distinguish bond cp minimum along one eigenvector hessian maximum along two eigenvector hessian belong face bader volum one bcp per face ring cp minimum along two eigenvector hessian maximum along remain eigenvector hessian belong vertex bader volum one rcp per vertex cage cp global minimum defin apex bader volum euler relat must fulfil number bcp minu number rcp plu number ccp must equal bader polyhedra might convex usual case might well convex present implement user requir specifi one atom hesh want comput bader volum surfac critic point differ run need differ atom case search critic point one start middl segment neighbour atom neighbour atom examin turn evolv toward nearbi point zero gradient case aimcrit equal one check cp found belong attract region desir atom last step mean trivial present implement check done mean straight line radiu connect point atom case bader volum convex might correctli identifi cp bader volum defin radiu goe region belong bader volum cp hidden atom defin attract region case cp consid part bader volum unfortun reader advis look automat test mgo molecul see patholog cage critic point found mg atom chanc problem sever one user interest aspect bader analysi describ case search bader surfac integr charg within bader surfac user defin seri radii integr equal spread theta phi angular variabl symmetri use decreas angular region sampl along radii algorithm determin distanc radiu cross bader surfac integr charg done distanc search bader surfac inform need critic point analysi rather restrict estim minim maxim radii bader surfac fact cp determin rather unimport hand fact part bader surfac might seen defin atom must known user might small amount hidden charg well numer test show amount hidden charg quit small like less electron determin densiti gradient densiti hessian densiti made thank interpol scheme within small parallelepip fft grid nnn parallelepip numer subtleti associ finit element scheme delic usual treatment densiti within main abinit code mani paramet adjust defin criteria stop search cp distanc beyond cp consid differ user strongli advis experi differ paramet order feel robust hisher calcul variat exampl automat test help himher well associ comment correspond readm file note aim program also determin bader distanc one given angular direct determin densiti laplacian sever given point space accord user input output file run program one need prepar two file filesfil file contain name input file root name differ output file name data file inputfil file give valu input variabl except file need valenc densiti real space _den file output abinit core densiti file fc file output fhi pseudopotenti gener code actual avail abinit web page file file call exampl aimfil could look like aimin inputfil abo_den valenc densiti output abinit aim root differ output file atfc core densiti file order atfc abinit filesfil _den file usual grid real space valenc densiti finer one propos abinit exampl lattic paramet au ngfft least give precis bader charg estim better electron core densiti file lda core densiti file gener whole period tabl avail abinit web site sinc densiti weakli depend choic xc function moreov charg densiti analysi mostli qualit tool file use function still realli accur valu bader charg analysi need one gener core densiti file xc function valenc densiti main execut file call aim suppos file file call aimfil execut place work directori aim run interact unix command aim aimfil log background command aim aimfil log standard standard error pipe log file call log pipe standard error thank sign place realli import analysi eventu failur due aim sourc like disk full problem user specifi name hesh wish file variat command could need depend flavor unix use platform consid run code syntax input file quit similar syntax main abinit input file file pars keyword identifi comment also identifi howev multidataset mode avail note specifi want calcul default noth exampl simpl input file oxygen bulk mgo given abinittestvinputtin also correspond output file directori give descript input variabl aim input file give explan concern output file atom unit cartesian coordin use output paramet name output file form rootsuffix differ output file central output file mani inform clearli describ addit inform integr separ integr core valenc densiti case radial integr perform use cubic spline angular one gauss quadratur howev princip part core densiti consid atom integr sphere minim bader radiu use spheric symmetri rest core densiti atom sphere togeth core contribut neighbor ad valenc densiti integr output file result complet integr core densiti atom two contribut spheric integr vs other total bader charg crit file critic point cp list order bond cp bcp ring cp rcp cage cp ccp line output contain inform posit quad fraceigenvaluesof hessian quad fracindex ofbond atom quad delta rho_c quad rho_c note posit evalu respect consid atom index bond atom list bcp surf file bader surfac head form latex latex begintabularccc index atom multicolumncposit ntheta thetamin thetamax nphi phimin phimax endtabular list bader surfac radii theta quad phi quad rthetaphi quad wthetaphi note wthetaphi weight gauss quadratur minim maxim radii given last line log log file lot inform nice actual gp gnuplot script show calcul part bader surfac line gnuplot script made manner one need type load file quot necessari note isnt consid visual work purpos list input variabl list input variabl aim input file present varsetaimaim set input variabl author xg dca anaddb util file explain use io paramet need analysi deriv databas code code abl comput interatom forc constant also gener mani differ physic properti databas contain deriv total energi deriv databas ddb user suppos know deriv databas dbb gener hesh simpli know materi describ ddb hesh want use hesh interest gener ddb want know topic hesh read differ help file abinit packag relat helpabinitmain abinit execut helprespfndfpt featur abinit helpmrgddbddb merg tool easier discov present file help tutorialstutori especi tutori dfpttutorialrf dfpttutorialrf introduct short deriv databas contain list deriv total energi respect three kind perturb phonon electr field stress present code analys ddb directli give properti materi investig like phonon spectrum frequencydepend dielectr tensor thermal properti given input file paramet describ user must creat file file list name file job requir includ main input file main output file name ddb file name option use select capabl code file file call exampl abfil could look like anaddbin anaddbout ddb band_ep gkk anaddbep ddk exampl main input file call anaddbin main output put file call anaddbout input ddb file call ddb inform draw phonon band structur go band_ep input gkk file call gkk use electronphonon interact base filenam electronphonon output anaddbep use electronphonon interact file name ddk refer file gkk file gener kpoint deriv run use prtgkk abinit input variabl use electronphonon transport calcul exampl given abinittestv directori latter three filenam inform often use anaddb maxim length name main input output file present charact main execut file call anaddb suppos file file call anaddbfil execut place work directori anaddb run interact unix command anaddb anaddbfil log background command anaddb anaddbfil log standard standard error pipe log file call log tip pipe standard error thank sign place realli import analysi eventu failur due abinit sourc like disk full problem user specifi name hesh wish file variat command could need depend flavor unix use platform consid run code syntax input file strictli similar syntax main abinit input file file pars keyword identifi comment also identifi howev multidataset mode avail input variabl anaddb util abl perform mani differ task govern select set input variabl also input variabl common mani differ task flag variabl activ differ task eg dieflaganaddb thmflaganaddb elphflaganaddb list input variabl anaddb input file present varsetanaddb variabl set order discov easier use differ tutori start second dfpt tutorialtutorialrf follow tutori elast piezoelectricitytutorialelast tutori electronphonon interactiontutorialeph tutori nonlinear propertiestutorialnlo author ab foldbloch util file explain use io paramet need foldbloch postprocessor abinit packag program gener unfold spectrum small cell fold spectrum eigenvalu supercel new kwavevector weight rang energi standard postscript file _foldblochout_ base user input number direct fold one execut argument xyz calcul program use coeffici vector k valu eigenvalu found __wfk_ file foldbloch use _wfk_open_read wfk_read_band_block hdr_io_ routin abinit packag read _wfk file header inform element structur use calcul easier discov present file help tutori tutorialfoldbloch compil instruct compil part abinit packag foldbloch differenti parallel serial configur alway compil serial oper execut program foldbloch execut invok follow command _from directori case file_ foldbloch case_wfk xyz case name file come _wfk identif xyz integ valu repres multipl correspond direct use construct supercel separ colon ex foldbloch gaasbi_wfk note cell structur spin polar two output file foldblock_upout foldbloch_downout output sampl _output sample_ three randomli select part output file data present follow left right column new k valu x z eigenvalueht weight subroutin function _subroutin functions_ subroutin getarg getargsf routin read argument command line check correct format check whether input file exist valu assign appropri variabl pass back foldbloch paramet _input_ fold fname fold empti array fname empti string _output_ fold fname fold array contain number fold x z direct command argument fname string contain name input file command argument _local_ num_arg argcount ii io arg argfold dir num_arg integ contain number command argument sent argcount integ counter use iter argument ii index use indic posit fold argument io integ use iostat check fold digit arg array contain argument argfold temp string contain fold argument dir boolean use check input file exist subroutin progress progressf progress compar k point current process total number k point calcul percent complet output result current k point process screen user know paramet _input_ ikpt nkpt kpt ikpt current k point number nkpt total number k point kpt current k point process _output_ none _local_ none subroutin newk newkf subroutin find new k valu unfold spectrum k valu determin base mani time direct function need unfold give us shape size unfold brillouin zone paramet _input_ xx yy zz fx fy fz xx origin k point coordin xplane yy origin k point coordin yplane zz origin k point coordin zplane fx number fold x direct fy number fold direct fz number fold z direct _output_ nkval nkval array contain xyz coordin new k point _local_ field_x field_i field_z tx ty tz loop ii jj kk size field_x size unfold brillouin zone x direct field_i size unfold brillouin zone direct field_z size unfold brillouin zone z direct tx temporari hold x coordin new k point ty temporari hold coordin new k point tz temporari hold z coordin new k point loop point place nkval store new k point j k counter x z direct respect size number new k point use nkval alloc subroutin sortc sortcf subroutin sort energi coeffici appropri group find group weight unfold spectrum number group correspond number new k point found newk coeffici sort base rel posit gamma point paramet _input_ fx fy fz vector coefc nv fx fy fz number fold direct see newk vector array contain xyz coordin energi coeffici coef array contain energi coeffici specif eigenvalu nv number vector coeffici one vector per coeffici _output_ weight weight array contain weight group _local_ tgroupc sum counter sumtot remainder_x remainder_i remainder_z jj kk pp el tgroupc array contain group sort coeffici sum array contain sum squar coeffici group counter array keep track number coeffici group sumtot total sum sum group reminader_x rel posit coeffici xaxi reminader_i rel posit coeffici yaxi reminader_z rel posit coeffici zaxi jj kk counter cycl group p counter element group el point locat sum store next valu main folblochf paramet _input_ fname fold nkval nkpt kpt cg kg eig weight nsppol nspinor npwarr nband fname case name input part initi argument user getarg fold initi argument xyz indic number direct fold getarg nkval array new k point unfold newk nkpt total number k point hdrnkpt kpt k point coordin hdrkptn cg kg array vector per k point wfk_read_band_bloch eig array eigenvalu per k point wfk_read_band_bloch weight weight calcul sortc nsppol integ indic updown polar none polar nspinor number local orbit hdrnspinor npwarr number vector kpoint hdrnpwarr nband number band k point hdrnband _output_ nkval eig weight written foldblochout foldbloch_upout foldbloch_downout spin polar nkval new k point unfold eigval origin eigenvalu weight weight new k point certain eigenvalu _local_ ikpt iband csppol cg_b count infil outfil coefc mband mcg outnam ikpt integ number current k point process iband integ current band process csppol integ current spin polar process infil integ input file number outfil integ output file number coefc array contain coeffici band process mband integ maximum number band mcg integ maximum possibl number coeffici alloc author rshaltaf mrgscr util file explain io paramet need screen file scr merg code mrgscr user advis familiar main helpabinit especi gw part read present file introduct mrgscr util come abinit code use merg partial screen file file contain screen calcul select q point gener use input variabl nqptdm qptdm mrgscr util merg file singl file contain screen full list q point like util within abinit eg mrgddb mrgkk input simpl could given directli screen conveni pipe file user give number scr merg first line name output file second line hesh shall write whole set filenam scr merg one line util use gw part abinit code present version x yet parallel input variabl nqptdm qptdm meant use kind manual parallel split whole screen calcul sever smaller job submit sever machin simultan mrgscr later use merg sever output scr singl file mrgscr code work first code read header first partial file calcul full list q point exist full screen file check consist file exist q point file last merg file singl file worth say merg success output file gener file consist ie differ pp differ dm size etc usual file must gener condit everi singl input variabl except cours nqptdm qptdm variou input partial screen file form complet file via merg often happen user still one q point screen still need calcul repetit one q point differ input partial screen file problem code includ one q point everi two repeat q point report log file check statu result screen file partial file need etc mrgscr user need use twolin input file first line input file second line contain name file check result check report log file exampl merg case number file merg name put file _scr startnam file merg _scr _scr merg qpoint merg frequenc check case write zero _scr name file check author dca xg abinit main code document explain io paramet format need main code abinit abinit packag new user advis read first new user guidenew_us read present file easier discov present file help tutorialindextutori mani user guid also present web exampl calcul respons properti use abinit complementari helprespfn need addit special document avail web insid packag advanc user idintroa run code main execut file call abinit suppos input file call runabi execut place work directori abinit run interact unix command abinit runabi log background command abinit runabi log standard standard error pipe log file call log pipe standard error thank sign place realli import analysi eventu failur due abinit sourc like disk quota issu also possibl separ standard error file standard output file command abinit runabi log err even explicitli abinit runabi runlog runerr actual user specifi name hesh wish file suffix abi usual abinit input file likewis suffix abo main output file nevertheless name inputoutputtemporari abinit file also tune see eg output_fil topiccontrol variat command could need depend flavor unix use platform consid run code underderstand standard unix syntax pleas get familiar unix continu ida underli theoret framework algorithm method employ comput code solv electron structur problem describ part differ review paper well research paper code implement local densiti approxim densiti function theori base upon plane wave basi set separ pseudopotenti iter minim algorithm combin fix potenti precondit conjug gradient optim wavefunct choic differ algorithm updat potenti one potentialbas conjug gradient algorithm represent potenti densiti wavefunct real space done regular grid point space determin cutoff energi ecut planewav basi reciproc space grid point also start point fast fourier transform real reciproc space number point call ngfft suffici larg adequ represent function larg reason comput effici tradeoff accuraci comput effici present mani place code address briefli end present help file recommend good introduct mani differ concept valid code avail citepaynereview modern physic articl note paper reflect present statu code abinit closer spirit citekressepap kress furthmul never use anoth electron structur code quantum chemistri packag brows chap appendic l citemartinthi book r martin idinputa input file format input file note input file call ab_in exampl introductionintro first explain content input file without use multidataset possibl explain section multidataset paramet input code singl input file paramet provid give name input variabl place numer valu name separ one space even equal sign equal sign replac blank parser depend input variabl numer valu may integ real number intern represent doubl precis number charact string delimit doubl quot may actual repres array valu repres array next set number separ space taken valu array separ minu sign number appli use tab note line input file may exceed charact first charact line input file read pars input variabl valu name paramet found varsetallvarsinput variabl databas list input variabl present latter file link definit contain differ variabl set file list basic variabl varsetbas file handl variabl varsetfil groundstat calcul variabl varsetgst gw variabl varsetgw parallelis variabl varsetpar densiti function perturb theori variabl varsetdfpt actual input file paramet may given desir order one may given per line space use separ valu addit space ignor exampl input paramet length scale call acel array acel length primit translat bohr atom unit input typic si diamond lattic one would line acel input file may equival written acel still pars correctli equival line even acel work latter case sign mean parser use given valu fill array repeat mani time need multipl space ignor text contain charact string correspond input paramet case array need number consid eventu number need also ignor exampl natom give number atom typat typatnatom give type atom first three data read sinc natom given variabl identifi parser least one blank multipl blank irrelev abinit also limit interpretor capabl identifi one slash sign place two number without separ blank definit fraction eg interpret identifi sqrt sqrt definit squar root appli one valid number also without separ blank eg sqrt interpret note howev capabl recurs sqrt identifi contain express use fraction eg sqrt ok two fraction two sqrt use one express sqrt present numer denomin fraction string might form concaten two string oper even blank accept environ variabl accept form var var name environ variabl end name environ variabl var determin find closest separ among blank slash doubl quot parser automat substitut valu environ variabl var string exampl pspdirpseudoshgh_pwtet pspdir psps_for_test give psps_for_testspseudoshgh_pwtet comment place right comment charact anyth right line simpli ignor parser addit text preced would otherwis caus troubl unless text inadvert contain charact string variabl name eg acel charact also use store old valu variabl place anyth els conveni file way ignor parser data read case irrelev entir input string map upper case pars remov case sensit one paramet per line may given given paramet name given input file error messag print code stop extern input file includ syntax includ geometryinc geometryinc give crystallin structur abinit format cat geometryin si diamond structur acel rprim natom ntypat typat xred znucl altern one use structur variabl read structur poscar file netcdf file produc abinit text file reduc set abinit variabl idfilesfilea file name abinit file name abinit either given automat abinit build differ input variabl like output_fil pseudo indata_prefix outdata_prefix tmpdata_prefix output_fil filenam main file format output place main output file error messag diagnost place file sent unit termin log file unit output ignor unless someth goe wrong code repeat lot inform unit main output file unit output intend discard run complet success main output file keep record run nicer look format pseudo give filenam differ pseudopotenti input file pseudopotenti data file format must mani filenam provid sequenti type atom system order name given establish ident atom unit cell list typat abi indata_prefix file read code name construct root abi anoth root defin indata_prefix appli option read wavefunct densiti potenti file multidataset mode root complement _d dataset index list possibl input file name creat root abi follow similar list exist _d dataset index append abi abi_wfk filenam file contain input wavefunct coeffici creat earlier run nqpt open read irdwfk wavefunct file unformat larg warn multi dataset mode getwfk nonzero wavefunct file build abo read abi_wfq filenam file contain input wavefunct coeffici creat earlier run nqpt need respons function calcul wavefunct file unformat larg warn multi dataset mode getwfk nonzero wavefunct file build abo read abi_wfxx filenam file contain input firstord wavefunct creat earlier rf run xx index perturb abi_den filenam file contain densiti creat earlier run see explan relat neg valu iscf file also unformat warn multi dataset mode getwfk nonzero densiti file build abo read abi_h filenam file contain approxim hessian eventu reinitialis broyden minimis see brdminf routin use restartxf prefer abo outdata_prefix except output_fil log file written code name construct root abo outdata_prefix appli option written wavefunct densiti potenti densiti state file multi dataset mode root complement _d dataset index also multidataset mode root abo use build name input file thank get variabl list possibl output file name creat root abo follow similar list exist _d dataset index append abo abo_wfk filenam file contain output wavefunct coeffici nqpt wavefunct file unformat larg abo_wfq abo_wfk case nqpt wavefunct alway output either name abo_wfk name abo_wfq abo_wfxx abo_wfk firstord wavefunct xx index perturb see section helprespfnsect helprespfn abo_ddb deriv databas produc responsefunct dataset see helprespfnddbthi section respfn help file abo_den filenam file contain densiti case ionmov see keyword prtden file unformat read cutd abo_timx_den filenam file contain densiti case ionmov valu x tim describ hereaft see keyword prtden file unformat read cutd abo_pot filenam file contain kohnsham potenti see keyword prtpot file unformat read cutd abo_timx_pot filenam file contain kohnsham potenti case ionmov valu x tim describ hereaft see keyword prtpot file unformat read cutd abo_do filenam file contain densiti state see keyword prtdo file format abo_timx_do filenam file contain densiti state case prtdo ionmov valu x tim describ hereaft see also keyword prtdo file format abo_geo filenam file contain geometr analysi bond length bond angl case ionmov see keyword prtgeo file format abo_timx_geo filenam file contain geometr analysi bond length bond angl case ionmov valu x tim describ hereaft see also keyword prtgeo file format abo_kss filenam file contain output wavefunct coeffici nbandkss wavefunct file unformat larg purpos start gw calcul use mtorrent code differ format abo_wfk use see file abinitdocdevelopersformat_ksstxt abo_eig file contain electron eigenvalu subsequ plot band structur ionmov pot den geo file output time scf cycl finish x timx aim give file differ name attribut follow case ionmov initi phase take call scf calcul valu x b c x actual agreement valu itim see keyword ntime ionmov case initialis phase take one scf call valu x call valu x agreement valu itim see keyword ntime tmp tmpdata_prefix temporari file creat code name construct root tmp tmpdata_prefix tmp usual chosen give access disk machin run job remot nf disk unix name might someth like tmpuser_nametemp exampl tmp_statu give statu advanc calcul updat frequent idparametersa abinit input variabl section abinit input variabl file gener inform input variabl given mnemon possibl characterist variabl type integ real string default valu follow descript variabl characterist one follow develop no_multi internal_onli input_onli evolv energi length magnet field physic inform energi length magnet field characterist indic physic mean variabl known abinit abinit treat physic dimens unit use atom unit system eg hartre energi ev bohr length angstrom strictli enforc within code howev dimens input variabl specifi read correctli present appli three type variabl dimens energi dimens length dimens magnet field first class variabl characterist energi specifi atom unit hartre electronvolt rydberg even kelvin second class variabl characterist length specifi atom unit bohr nm nanomet angstrom third class variabl characterist magnet field specifi atom unit tesla abinit parser recogn dimens specifi list number follow input variabl keyword input file specif upper lower case mix thereof list recogn chain charact ry rydberg rydberg rydberg energi ev electronvolt energi k kelvin energi angstr angstrom length nm nanomet length tesla tesla magnet field sec second second time charact chain like au atom unit hartre bohr recogn make parser choos default atom unit correct behaviour exampl acel angstrom ecut ry tsmear k acel bohr ecut ev tsmear use atom unit mandatori dimens input variabl like toler forc toldff paramet defin object objaax objaax objbax objatr objbtr initi veloc atom vel need initi atom posit input bohr angstrom xcart possibl use angstrom unit even reduc coordin xred flow inform variabl use multidataset mode see section multidataset must uniqu valu throughout dataset signal indic no_multi input variabl characterist input_onli use parser initi input variabl transmit insid code beyond parser particular echo output file varianc intern variabl characterist internal_onli document help file access input variabl document provid variabl sometim mention output file input variabl chang run perform contrast may evolv like atom posit atom veloc cell shape occup number echo run proceed cours differ input valu signal indic evolv inform develop refer input variabl use product run introduc develop time featur like final non abinit develop strongli advis skip addit give input variabl input file use anoth purpos place word exit top line caus job end smoothli next iter chkexit input variabl nonzero function program close reopen input file everi iter check top line keyword exit word must place space blank side thu place exit top line input file job alreadi run forc job end smoothli next iter machin work alway know anoth possibl offer one creat file name abinitexit directori job start code also smoothli end case stop immedi take signific fraction one scf step execut properli instruct still need idmultidatasetsa multidataset mode assum user want make comput correspond one set data exampl determin total energi geometri set plane wave set kpoint often need redo calcul differ valu paramet let thing equal typic exampl converg studi need determin cutoff energi give need accuraci case one make chain calcul order comput band structur first selfconsist calcul densiti potenti eigenenergi comput along differ line purpos multidataset mode implement allow code treat one run differ set data chain number dataset treat specifi variabl ndtset indic dataset default eventu provid array jdtset dataset treat character index input variabl determin follow rule actual easier understand one look exampl see abinit look whether variabl name eg ecut append index dataset eg jdtset exist eg ecut take data follow keyword exist modifi variabl name exist look whether metacharact seri doubleloop data set defin see section seri loop variabl name append index dataset exist seri doubleloop dataset keyword look occurr variabl name without index append take correspond data correspond singl dataset mode occurr exist take default valu also similar singl dataset mode st exampl ndtset acel ecut ecut mean dataset first acel ecut use second acel ecut use nd exampl ndtset jdtset acel acel ecut ecut ecut ecut ecut mean still two dataset character indic first run use gener acel ecut acel ecut second run use acel ecut acel ecut note ecut ecut ecut use idseriesa defin seri rule split three part b c seri relat b b variabl name append index dataset exist code look whether seri defin keyword two kind seri arithmet seri constant _increment_ term seri geometr seri constant _ratio_ term seri first term seri defin keyword append colon eg ecut increment arithmet seri defin keyword append plu eg ecut factor geometr seri defin keyword append time eg ecut index dataset first term seri use index n appropri input data obtain consid nth term seri rd exampl ndtset ecut ecut ecut ecut ecut ecut equival ndtset ecut ecut case six dataset increas valu ecut idloopa defin doubl loop dataset defin doubl loop dataset one first defin upper limit two loop counter thank variabl udtset inner loop execut udtset outer loop execut udtset note largest valu udtset present udtset last digit inner loop valu ndtset must coher udtset must equal product udtset udtset dataset index creat concaten outer loop index inner loop index exampl udtset udtset index assum follow valu independ use udtset rule c use defin valu input variabl question mark use metacharact replac digit defin index dataset exampl ecut mean input valu follow use ecut dataset c variabl name append index dataset exist code look whether doubleloop seri defin keyword seri defin inner loop index outer loop index two sign append variabl name instead one simpl seri case one sign must question mark use metacharact abl assum valu found first two posit mean seri care outer loop index valu gener equal outer loop index valu found second two posit seri care inner loop index sign colon plu time case seri defin mean rule preced preced rule rule preced rule b c two latter use simultan variabl th exampl ndtset udtset acel acel ecut ecut equival ndtset jdtset acel ecut acel ecut acel ecut acel ecut acel ecut acel ecut tip exampl found directori abinittestsv case later idfilenamesmultidataseta file name multidataset mode root name input output file potenti densiti wavefunct receiv appendix _d follow index dataset see section get variabl use chain calcul let us mention getwfk getwfq getddk getwf getden getcel getxr getxcart getwfk allow take output wavefunct previou dataset use input wavefunct getwfq getddk getwf similar thing respons function calcul getden densiti getcel acel rprim getxr getxcart atom posit either reduc coordin cartesian coordin differ variabl correspond dataset echo use index convent input step last echo code variabl output variabl also summar use convent etot total energi fcart cartesian forc strten stress tensor idpseudopotentialfilesa pseudopotenti file paw atom data file actual real understand file need run code recommend pseudopotenti download abinit web site httpswwwabinitorgpspt document provid well dedic topicpseudospaw note possibl mix normconserv pseudopotenti paw atom data set run also everi file gener particular choic exchangecorrel function ixc principl incorrect use pseudopotenti paw data anoth exchangecorrel function one gener abinit send warn differ reason might nevertheless use abl grasp inform file normconserv pseudopotenti differ format possibl label present associ intern variabl call pspcod inform header pseudopotenti file found abinit wiki httpswikiabinitorgdokuphpiddeveloperspseudo read pursu descript format though differ output file explan output code output code goe sever place list idlogfilea log file log file standard unix output file correspond fortran unit number file echo valu input paramet describ variou step calcul typic much detail desir perman record run log file intend inform case error fuller descript run success run user gener delet log file afterward four type except messag error bug warn comment messag error bug messag caus code stop immedi small delay error attribut user bug attribut develop warn messag indic someth happen expect someth import make code stop comment messag give inform user concern someth unusu none appear run complet normal run complet alway look end log file see whether error bug occur also code give number warn comment issu advis read least warn messag first month abinit use idoutputfilea main output file main output file format output file kept perman record run note expect exist begin run file name one specifi input variabl output_fil see also default output file name descript alreadi exist code gener given one anoth name append new name alreadi exist tri append b z code stop ask clean directori main output file start head version number specifi platform copyright notic distribut licenc date echo file file except pseudopotenti name dataset report point symmetri group bravai lattic expect memori need echo input data report check data consist dataset idmainoutputfilea main output file dataset real comput done code report initialis scf converg final analysi result dataset phase describ detail code report real reciproc space translat vector _note_ definit reciproc vector r_ig_j delta_ij volum unit cell ratio linear dimens fft box sphere plane wave call boxcut must exact treatment convolut fft ngfft automat chosen give boxcut valu larger much larger sinc cpu time need larger fft grid code also mention fft grid might treat slightli larger ecut rather small increas cpu time head pseudopotenti input inwffil subroutin descript wavefunct initi random number initi input disk file report number planewav npw basi k point setup subroutin averag number planewav k point report two form arithmet averag geometr averag output groundstat comput ident one responsefunct calcul see helprespfn latter especi helprespfnsect next code report inform scf iter iter number pseudo total energi etot hartre total energi system sinc pseudopotenti approxim made constant energi frozencor approxim ad present pseudo total energi order obtain total energi includ contribut core electron sinc differ total energi matter except extrem rare case one work pseudo energi like true total energi except miss constant depend pseudopotenti use thu one perform differ pseudo energi simul use pseudopotenti chang etot sinc last iter delta maximum squar residu residm band k point residm residu measur qualiti wavefunct converg squar residu potenti scf procedur vre maximum chang gradient etot respect fraction coordin diffor hartre rm valu gradient etot respect fraction coordin maxfor hartre latter two directli relat forc atom come assess scf converg criterion fulfil scf criterion defin toldf toldff tolwfr tolvr might satisfi stress report end content fix atom posit calcul mani block follow atom posit eventu relax accord valu ntime code output inform squar residu band report k point k point fraction reduc coordin given follow energi gradient follow cartesian coordin angstrom follow cartesian forc hartreebohr evangstrom also given rm forc frm maximum absolut valu forc compon max next length scale unit cell bohr angstrom next eigenvalu band k point ev hartre depend choic enunit idaveragepota note averag electrostat potenti period repeat cell undefin present implement averag hartre potenti local potenti impos zero averag exchangecorrel potenti definit give mean absolut valu eigenenergi thank janak theorem deriv total energi respect occup number inde g contribut hartre local potenti ionion total energi independ occup number present implement notic except one alway work differ eigenenergi well differ eigenenergi potenti exampl absolut eigenenergi bulk cell use tri predict work function latter quantiti obtain supercel geometri compar fermi energi slab potenti vacuum supercel next minimum maximum valu charg densiti next smaller larger valu order see degeneraci next total energi ha ev compon kinet hartre exchang correl xc ewald ionion energi core correct local pseudopotenti local pseudopotenti nonloc pseudopotenti sum kohnsham energi term band energi also given next stress tensor ucvol detotdstrainab etottot energi per unit cell b x z compon strain stress tensor given cartesian coordin hartreebohr gpa basic stress tensor describ citenielsen citenielsena finish calcul differ dataset code echo paramet list input file use latest valu eg xred vel xcart supplement valu obtain total energi forc stress well occup number latter echo conveni quick look result calcul follow final time output cpu time wall clock time provid call within code total cpu wall clock time report first second minut hour conveni check glanc next cpu wall time princip timeconsum subroutin call independ other sum time usual account run time main subroutin big job fourwf subroutin perform fast fourier transform wavefunct fourdp subroutin perform fast fourier transform relat densiti potenti rhohxc comput hartre exchangecorrel energi potenti sometim deriv potenti xc time report exclud time connect fft xcpotfourdp nonlop comput matrix element nonloc pseudopotenti langl gv_nonlocalc rangl projbd gramschmidt orthogonalis case small job initialis routin may take larger share sum time princip timeconsum subroutin call make run time long print option select prtvol code give much inform whole output file rather selfexplanatori usual need explan particular cpu wall time major subroutin independ exampl vtorho conduct loop k point call practic everyth els case ground state calcul fix atom posit subroutin abinit main routin driver select ground state respons calcul gstate driver ground state calcul scfcv_core scf cycl driver vtorho comput densiti potenti includ loop spin kpoint vtowfk comput wavefunct one particular kpoint includ non self consist loop loop band cgwf optim one wavefunct fix potenti getghc comput langl ghcrangl appli hamiltonian oper input vector idheadera header wavefunct file densiti file potenti file plain text file quit big need kind compress storag mode either binari file fortran write statement netcdf file see input variabl iomod fortran binari format default focu follow section read netcdf file actual much easier read fortran binari file netcdf file address content order provid relev metadata run gener numer data wavefunct file densiti file potenti file irrespect format contain standard basic inform case fortran file begin record call header header treat use hdr_type fortran data structur insid abinit dedic routin insid abinit initi header updat read header unformat disk file write header unformat disk file echo header format disk file clean header data structur header made ntypat unformat record obtain follow fortran instruct format fortran writeunithead codvsnheadformfform writeunithead bantotdateintxcixcnatomngfft nkptnspdennspinornsppolnsymnpspntypatoccoptpertcaseusepaw ecutecutdgecutsmecut_effqptnrprimdstmbia tphyseltsmearusewvlnshiftk_orignshiftkmband writeunithead istwfknkptnbandnkptnsppol npwarrnkptso_pspnpspsymafmnsymsymrelnsym typatnatomkptnkptoccbantottnonsnsym znucltypatntypatwtknkpt writeunitunit residmxrednatometotalfermieamuntypat writeunitunit kptoptpawcpxoccnelectcellchargeicoulomb kptrlattkptrlatt_origshiftk_origshiftk ipspnpsp npsp line pseudo npspntypat except alchem pseudoatom writeunitunit titleznuclpspzionpsppspso pspdatpspcodpspxclmn_sizemd_pseudo enddo case usepaw addit record usepawthen writeunitunit pawrhoijiatomnrhoijselnspdeniatomnatom cplex nspden writeunitunitpawrhoijiatomrhoijselect nrhoijselispdenispdenispdennspdeniatomnatom pawrhoijiatomrhoijp cplexnrhoijselispdenispdenispdennspdeniatomnatom endif type differ variabl fortran charact codvsn integ headformfform integ bantotcplexdateicoulombintxcixckptoptmbandnatomngfft nkptnpspnshiftk_orignshiftknspdennspinornsppolnsymntypatoccopt pawcpxoccpertcaseusepawusewvl doubl precis acellcellchargeecutecutdgecutsmecut_effetot fermienelectqptnresidmrprimdshiftkshiftk_orig stmbiastphyseltsmear integ istwfknkptkptrlattkptrlatt_orignbandnkptnsppol npwarrnkptso_pspnpspsymafmnsymsymrelnsymtypatnatom nrhoijselnspdenrhoijselectnspden doubl precis amuntypatkptnkptoccbantottnonsnsym znucltypatntypatwtknkptxrednatom charact titl charact md_pseudo doubl precis znuclpspzionpsp integ pspsopspdatpspcodpspxclmn_s doubl precis rhoijnspden note _etot set true valu densiti potenti file file set d_ note _ecut_eff ecutdilatmx_ note _for case occup number defin posit iscf iscf nonmetal occup number fermi energi set highest occupi eigenenergi might correspond expect fermi energi later nonselfconsist calcul eg band structure_ header might differ differ version abinit one prev format describ note howev current version abinit abl read previou format write except wavefunct file ecutsm valu nonzero chang definit smear function v format abinit version fortran writeunithead codvsnheadformfform writeunithead bantotdateintxcixcnatomngfft nkptnspdennspinornsppolnsymnpspntypatoccoptpertcaseusepaw ecutecutdgecutsmecut_effqptnrprimdstmbiastphyseltsmearusewvl writeunithead istwfknkptnbandnkptnsppol npwarrnkptso_pspnpspsymafmnsymsymrelnsymtypatnatom kptnkptoccbantottnonsnsymznucltypatntypatwtknkpt ipspnpsp npsp line pseudopotenti npspntypat except alchem pseudoatom writeunitunit titleznuclpspzionpsppspsopspdatpspcodpspxclmn_s enddo case usepaw final record residm coordin total energi fermi energi writeunitunit residmxrednatometotalfermi case usepaw addit record usepawthen writeunitunit pawrhoijiatomnrhoijselnspdeniatomnatom cplex nspden writeunitunitpawrhoijiatomrhoijselect nrhoijselispdenispdenispdennspdeniatomnatom pawrhoijiatomrhoijp cplexnrhoijselispdenispdenispdennspdeniatomnatom endif type differ variabl fortran charact codvsn integ headformfform integ bantotdateintxcixcnatomngfftnkptnpsp nspdennspinornsppolnsymntypatoccoptpertcaseusepaw integ usewvl cplex nspden doubl precis acellecutecutdgecutsmecut_effqptnrprimdstmbiastphyseltsmear integ istwfknkptnbandnkptnsppolnpwarrnkptso_pspnpsp symafmnsymsymrelnsymtypatnatomnrhoijselnspdenrhoijselectnspden doubl precis kptnkptoccbantottnonsnsymznucltypatntypatwtknkpt charact titl doubl precis znuclpspzionpsp integ pspsopspdatpspcodpspxclmaxllocmmaxinteg doubl precis residmxrednatometotalfermierhoijnspden iddenfilea densiti output file unformat data file contain electron densiti real space fft grid consist header recordshead follow fortran ispdennspden writeunit rhorirircplexngfftngfftngfft enddo rhor electron densiti electronsbohr cplex number complex compon densiti cplex gs calcul densiti real cplex rf input variabl nspden describ number compon densiti first compon one present nspden alway total charg densiti nspden second compon densiti associ spinup electron nspden second third fourth compon correspond x z project local magnet unit hbar note mean differ compon densiti differ densiti array rhor differ potenti array vxc see next sectionlocalpotfil identifi point real space correspond index ir consid follow first array valu ir correspond first grid point origin unit cell x z next grid point ir lie along first primit translat next fft grid point ngfftacellrprimmu ngfft way along first primit translat rest valu irngfft lie along vector irngfft way along first primit translat point irngfft lie ngfft along second primit translat next point irngfftngfft displac direct second primit translat ngfft first translat irngfftngfft pattern continu irngfftngfft next point displac along third primit translat ngfft forth ir vari way ngfftngfftngfft last point corner diagon opposit origin right alongsid origin whole grid view period repeat idlocalpotfilea potenti file also unformat file consist header recordshead fortran ispdennspden writeunit potentialirircplexngfftngfftngfft enddo potenti either sum hartre potenti exchang correl local pseudopotenti see prtpot hartre potenti see prtvha hartreexc potenti see prtvhxc local pseudopotenti see prtvpsp xc potenti see prtvxc defin real space grid hartre energi unit underli grid describ nspden differ compon spinup potenti spindown potenti case nspden compon correspond upup potenti downdown potenti real part updown potenti imaginari part updown potenti note hartre potenti spindepend order use format potenti file spinindepend array written twice spinup one spindown idwfkfilea wavefunct output file unformat data file contain planewav coeffici wavefunct differ supplementari data groundstat wf file consist header recordshead data written follow line fortran fortran bantot count band index index wavefunct locat isppolnsppol ikptnkpt writeunit npwnspinornband k point writeunit kgnpw plane wave reduc coordin writeunit eigenbantotnbandbantot eigenvalu k point occbantotnbandbantot occup number k point ibandnband writeunit cgiiindexiinpwnspinor wavefunct coeffici enddo singl band k point bantotbantotnband indexindexnpwnspinornband enddo enddo job end without problem supplementari line ad order give histori atom posit correspond forc integ nxfh give number pair xf posit forc reduc coordin fortran writeunitnxfh ixfhnxfh writeunit xrednatomixfhdummi frednatomixfhdummi enddo dummi variabl might contain futur descript unit cell stress type differ variabl fortran integ kgnbandnpwnspinornxfh doubl precis cgdummyeigenfredoccxr responsefunct wf file consist header recordshead data written follow line fortran fortran bantot count band isppolnsppol ikptnkpt writeunit npwnspinornband k point writeunit kgnpw plane wave reduc coordin ibandnband writeunit eigenjbandibandnbandbantotjbandnband column eigenvalu matrix writeunit cgiiindexiinpwnspinor wavefunct coeffici enddo singl band k point bantotbantotnband enddo enddo note altern format _kss output wavefunct coeffici activ nonzero valu nbandkss output file mani output file option written format file present use usual govern specif input variabl pleas consult descript input variabl order inform file prtdo print file electron densityofst prteig print file list k point eigenenergi prtgeo print file geometr analysi bond length bond angl also contain xmol section prtdm print onedimension project potenti densiti three axe control output parallel case massiv parallel run one afford output file usual creat explicitli log file also statu file becom problemat default n processor less n processor creat beyond n processor deactiv except main log file master processor default behaviour chang follow file name _nolog exist current directori log file statu file creat even less n processor contrast file _log exist current directori log file statu file creat even n processor altern file name _mainlog exist less n processor master processor write log statu file mimic default behavior use n processor less n processor abinitv n set n howev abinitv n switch chang hand though modifi nproc_no_extra_log src_defsdefs_basisf recompil see _abitypes_defsm_dtfilf explan idnumericalqualitya numer qualiti calcul follow section describ variou paramet affect converg numer qualiti calcul list input paramet ecut toldf toldff tolwfr tolvr well nstep nkpt ngfft tolmxf well amu dtion vi ntime acel rprim technic design pseudopotenti also affect qualiti result first issu regard converg number planewav basi given set atom atom notabl first row first transit seri row rel deep pseudopotenti requir mani planewav converg contrast atom like si fewer planewav need typic valu ecut silicon normconserv pseudopotenti might hartre quit good converg valu oxygen might hartre depend converg desir design pseudopotenti paw ecut use usual smaller eg hartre oxygen pseudodojo httpwwwpseudodojoorg provid hint avail pseudopotenti note necessari everi new problem test converg rais ecut given calcul result comput constant within toler user import given acel rprim ecut paramet control number planewav cours rprim acel vari number planewav also chang let us reiter extrem care pseudopotenti design optim converg _eg_ total energi within rang planewav number ecut appropri attempt optim converg especi difficult atom like oxygen copper long one significantli compromis qualiti transfer pseudopotenti inform optim converg pseudopotenti see citerapp gener oncvpsp pseudopotenti see citehamann pseudodojo see citevansetten jth tabl paw atom data see citejollet addit achiev converg number planewav basi one must ensur scf iter solv electron structur given set atom coordin also converg converg control paramet toldf toldff tolwfr tolvr well paramet nstep one toler paramet must chosen requir level toler fulfil scf cycl stop nstep variabl also control converg precondit conjug gradient iter forc calcul stop whenev number iter exce nstep usual one want nstep set larger need reach given toler els one want restart insuffici converg calcul requir toler reach note gap system close eg due defect format system metal first place present code algorithm slower converg insul materi converg troubl iter usual signal closur gap code suggest treat least one unoccupi state band order abl monitor closur self consist calcul iscf posit import test adequaci k point integr symmetri use one usual test set special point grid otherwis one test addit k point presum uniform grid ensur suffici number includ good k point integr paramet nkpt indic mani k point use coordin given kpt kptnrm describ weight given k point provid input variabl wtk systemat test k point integr much difficult test adequaci number planewav difficulti refer simpli lack systemat method gener k point grid test possibl run calcul fft box quit larg enough avoid alias error fft convolut alias error fourier filter approxim occur output variabl boxcut less boxcut smallest ratio fft box side planewav basi sphere diamet ratio larger eg calcul hartre potenti charg densiti done without approxim note valu ngfft chosen automat code give boxcut ngfft set hand ratio smaller certain highest fourier compon corrupt convolut basi nearli complet fourier filter excel approxim case valu boxcut small without incur signific error given ecut acel rprim one run test ngfft larg enough give boxcut one may tri smaller valu ngfft result significantli alter see descript variabl run calcul relax equilibr structur ie ionmov possibl vi qualiti molecular dynam relax affect paramet amu dtion vi ntime tolmxf clearli want relax structur must either run long enough make repeat run largest forc problem output fmax smaller toler see tolmxf dtion larg given valu mass amu viscos vi molecular dynam unstabl dtion small molecular dynam move ineffici slowli consensu exist commun forc larger evangstrom realli larg consid relax converg best user get experi hisher applic option ionmov also avail use broyden bfg scheme structur optim much effici viscou damp structur relax run supercel calcul ie isol atom molecul big box defect solid slab calcul must check converg calcul respect supercel system size isol molecul big box increas concurr three dimens supercel acel check converg physic properti defect solid supercel must multipl primit cell bulk solid less freedom still sure supercel larg enough properti interest accur level want slab calcul must increas vacuum cell also thick slab systemat author xg rc gmr jfb mcote cutd util file explain use io paramet need cut dimension file postprocessor abinit packag code abl analys file produc abinit contain dimension real space data like type potenti file densiti file wavefunct file data also analys first kpoint number band number must given correspond wavefunct transform real space case thank cutd one obtain dimension data correspond cut plane dimension data along line one also translat origin format mani differ one final one also perform angular momenta analysi wavefunct respect given atom comput hirshfeld atom charg start densiti file run cutd run cutd simpli type cutd provid answer question give first name unformat file exampl txo_den analyz type file exclud wavefunct file suppos treat wavefunct file choos differ possibl comput data point specifi comput data along line specifi comput data grid specifi comput data grid specifi convers format file convers index format convers molekel format convers data coordin tecplot ascii format output xsf file xcrysden comput atom charg use hirshfeld method option possibl specifi point reduc cartesian coordin option possibl specifi line two endpoint reduc cartesian coordin perpendicular plane option mani possibl offer includ specif thank point defin reduc coordin cartesian coordin atom posit continu analysi simpli answer question code suffici selfexplanatori analyz wavefunct file instead suppos treat wavefunct file abl perform analysi one wave function defin k point number band possibl spinpolar spinor compon ask whether want perform angular compon analysi provid radiu sphere around atom angular analysi perform final given choic differ format wavefunct realspac data includ bare file xcrysden format file author amacgcfr multibinit softwar multibinit softwar implement secondprincipl approach lattic dynam simul base atom potenti fit firstprincipl calcul citewojdel secondprincipl effect potenti account harmon shortrang longrang dipoledipol interact anharmon contribut well explicit treatment homogen strain coupl lattic one hand paramet associ second energi deriv harmon interatom forc constant ifc elast constant strainphonon coupl etc determin exactli provid densiti function perturb theori topicdfptdfpt hand anharmon lattic contribut restrict limit number term shortrang interact low order treat effect way fit citeescorihuelasayalero reproduc stress forc train set includ repres configur properli sampl phase space instal multibinit softwar includ helpabinitabinit packag thu instal code follow instruct helpinstallationinstal guid packag howev order abl use multibinit featur might need recompil abinit activ flag configur configac file multibinit gener output molecular dynam netcdf format netcdf librari link use flag with_trio_flavornetcdf multibinit use libxml pars xml file mandatori effici heavi xml file principl configur script automat detect libxml need specifi option enable_xmly cflags_extraxmlconfig cflag fc_libs_extraxmlconfig lib run code introduc file file prepar input file see paramet descript requir file gener model must creat file file list one line filenam job requir main input file main output file file model modelddb modelxml xml file anharmon part model netcdf file train set file file call exampl multibinitfil look like multibinitin multibinitout modelddb modelxml model_anharmonicxml training_set_histnc exampl main input file call multibinitin main output written multibinitout modelddb modelxml databas abinit xml model_anharmonicxml _optional_ xml coeffici fit polynomi training_set_histnc histori file netcdf format contain train set modelddb modelxml file contain system definit list total energi deriv respect three kind perturb phonon electr field strain _optional_ xml file contain list coeffici obtain fit polynomila energi last file mandatori obtain model_anharmonicxml file run code main execut file call multibinit suppos execut locat work directori run interact unix command multibinit multibinitfil log background command multibinit multibinitfil log standard output standard error pipe file call log user full freedom chang filenam moreov modif command could need depend unix flavour use platform suppos execut code syntax input file complet similar one main abinit file pars keyword identifi comment also identifi howev topicmultidtsetmultidataset mode avail input variabl multibinit abl perform mani differ task exampl possibl gener second principl model extract harmon part dfpt calcul fit relat anharmon part polynomi express model contain phonon instabl bound automat procedur addit given model also possibl perform molecular dynam use multibinit featur select set input variabl correspond flag variabl activ differ task eg multibinitprt_model multibinitfit_coeff multibinitbound_model multibinitdynam full list input variabl present varsetmultibinitmultibinit variabl set gener model learn gener model encourag read paper citewojdel citeescorihuelasayalero comput harmon contribut use helpabinitabinit multibinit requir ddb file abinit build harmon part potenti produc file first suppos learn perform topicdfptdfpt calcul abinit purpos use follow differ tutori start second lesson respons function lessonrf comput phonon dispers build relat ddb file follow lesson elast lessonelast comput elast contribut build relat ddb end use helpmrgddbddb merg tool gener modelddb file seen learn procedur comput harmon part potenti look topiclatticemodel input variabl select input file mention later lessonlattice_model tutori tutori avail comput anharmon contribut use train set comput anharmon part model multibinit requir train set contain sever dft calcul train set contain ensembl atom configur sampl potenti energi surfac file use fit polynomi follow method develop citeescorihuelasayalero gener train set user requir get experi topicmoleculardynamicsmolecular dynam simul within abinit altern user gener train set configur mean phonon popul procedur fix temperatur ddb file mandatori activ impos abinitionmov bound model multibinit includ automat bind process look topicboundingprocess input variabl select input file mention later lessonlattice_model tutori tutori avail run dynam multibinit use routin abinit perform atom relax molecular dynam mont carlo simul look topicdynamicsmultibinit input variabl select input file mention later lessonlattice_model tutori tutori avail author dca xg rc new user help file page give beginn introduct abinit resourc packag main abinit applic foreword abinit project group effort dozen peopl worldwid develop main abinit applic deliv mani file postprocessor test document abinit packag abinit project includ also resourc provid abinit web sitehttpswwwabinitorg github organizationhttpsgithubcomabinit read present page get grasp main abinit applic get theoret background case alreadi use anoth electron structur code quantum chemistri code might suffici read introduct citepayn never use anoth electron structur code quantum chemistri packag complet read go pace chap appendic l rm martin book citemartin gone present new user guid follow tutorialindexabinit tutori introduct abinit packag whose main program allow find total energi charg densiti electron structur system made electron nuclei molecul period solid within densiti function theori use pseudopotenti planewav basi augment plane wave even wavelet possibl abinit go beyond densiti function theori ie manybodi perturb theori gw approxim bethesalpeth equat timedepend densiti function theori dynam meanfield theori allenheinecardona theori find temperaturedepend electron structur abinit also includ option optim geometri accord dft forc stress perform molecular dynam simul use forc gener dynam vibrat phonon properti dielectr properti mechan properti thermodynam properti etc addit main abinit code differ util program provid suppos download abinit packag web site unpack instal might nevertheless continu read present web page get overview might prove fruit first download abinit packag least unpack see instal notesinstal note use name abinit refer directori contain abinit packag download practic version number append name give exampl abinit abinit packag version scheme explain later file abinit contain differ subdirectori exampl present file well descript file found abinitdoc subdirectori describ later main execut abinit compil main code present packag abinitsrc_mainabinit perhap anoth place depend instal run abinit need three thing access execut abinit input file pseudopotenti input file kind element unit cell item job run full list input variabl provid singl input file given abinit varsetallvarslist variabl detail descript input variabl given mani variabl set file includ basic variabl varsetbas groundstat calcul variabl varsetgst gw variabl varsetgw file handl variabl varsetfil parallelis variabl varsetpar densiti function perturb theori variabl varsetdfpt set exampl aim guid beginn avail tutorialindextutori test case input file found abinittest subdirectori eg fast vx seri v v vmbpt v v libxc paral tutox seri mani differ sort pseudopotenti use abinit found atom data fileshttpswwwabinitorgdownloadsatomicdatafil page abinit web site offici recommend pseudopotenti tabl paw jth tabl normconserv tabl oncvpsp also older set pseudopotenti inform pseudopotenti file found helpabinitabinit help file theorypseudopotentialspseudopotenti theori document abinit wikihttpswikiabinitorgdokuphpiddeveloperspseudo topicpseudospawpseudospaw topic warn subset exist pseudopotenti use test case locat abinittestspsps_for_test directori recommend product program packag addit abinit util program provid packag util program written fortran like main abinit program sourc also abinitsrc_main includ mrgddb anaddb allow one postprocess respons atom displac andor homogen electr field andor strain perturb gener abinit produc full phonon band structur thermodynam function piezoelectr properti superconduct properti name mrgddb merg deriv databas anaddb analysi deriv databas cutd use postprocess threedimension densiti potenti file gener abinit allow one deduc charg densiti select plane isodens plot along select line select point allow one also make hirshfeld decomposit charg densiti atom contribut foldbloch use unfold firstprincipl electron band structur aim also postprocessor threedimension densiti file gener abinit perform bader atominmolecul decomposit charg densiti atom contribut conducti allow one comput frequencydepend optic conduct util program written fortran python contain abinitscript postprocess numer tool pre process script distinguish allow one visual abinit output like abinit_eignc_to_bandstructurepi resourc outsid abinit packag addit abinit packag resourc obtain abinit github sitehttpsgithubcomabinit sourc latest version abinit packag actual mirror site resourc packag download point abipyhttpsgithubcomabinitabipi opensourc librari analyz result produc abinit includ visualis prepar input file workflow autom calcul socal highthroughput calcul provid interfac pymatgenhttppymatgenorg develop materi projecthttpmaterialsprojectorg abinit tutori base abipi avail abitutori repositoryhttpsgithubcomabinitabitutori pseudodojohttpwwwpseudodojoorg python framework gener valid pseudopotenti paw atom data file normal abinit user benefit lot project sinc abinit recommend tabl normconserv pseudopotenti gener thank recommend paw tabl also provid via pseudodojo interfac abiconfighttpsgithubcomabinitabiconfig hold area configur file use configurecompil abinit cluster might benefit instal abinit cluster abiflowshttpsgithubcomabinitabiflow provid flow highthroughput calcul abinit abicondahttpsgithubcomabinitabiconda contain conda recip build abinitrel packag like abipi might benefit instal abipi machin addit resourc abinit develop provid commun abinit packag portal github mani abinitindepend commerci free applic use visual abinit output interact abinit provid well maintain list link last section httpwwwabinitorgsponsorshttpwwwabinitorgsponsor cours might get brows web input variabl abinit overview import input variabl provid input file list specif geometri problem type atom natom total number atom unit cell ntypat number type atom typatnatom sequenc integ specifi type atom note atom coordin xcart xred must specifi order rprim unscal primit translat period cell column array one primit translat xcartnatom cartesian coordin bohr atom unit cell note use xred absent xrednatom fraction coordin atom locat note leav xcart use znuclntypat nuclear charg type element must agre nuclear charg found psp file specif planewav basi set brillouin zone wavevector sampl occup band ecut planewav kinet energi cutoff hartre kptopt option specifi kpoint grid kptopt automat gener use ngkpt shiftk ngkpt dimens threedimension grid kpoint occopt set occup electron level semiconductor metal specif type calcul done ionmov ionmov ion cell shape fix search equilibrium geometri molecular dynam iscf either posit number defin selfconsist algorithm usual band structur fix potenti optdriv gw calcul manybodi perturb theori rfelfd respons calcul electr field rfphon respons calcul atom displac specif numer converg calcul nstep maxim number selfconsist cycl order tolvr toler selfconsist converg ntime number molecular dynam relax step tolmxf forc toler structur relax hartreebohr output file output abinit run show sever file standard output usual one run command pipe standard output log file inspect warn error messag anyth goe wrong otherwis discard end run easili readabl format output goe standard output file gener abinit default extens abo error messag report latter file hand file usual kept archiv purpos addit wavefunct input start point output result calcul possibl charg densiti andor electrostat potenti ask three set data store unformat binari file nativ fortran netcdf format densiti state do also output format readabl file analysi geometri also provid geo file name file construct root name might differ input file output file either provid abinit provid user code append descriptor like wfk wavefunct den densiti pot potenti do densiti state also differ temporari file also construct root name amongst file statu file summar current statu advanc code long job helpabinitabinit help file contain detail code simplest sort job comput electron structur fix set atom posit within period unit cell electron structur mean set eigenvalu wavefunct achiev lowest dft energi possibl basi set number planewav code take descript unit cell atom posit assembl crystal potenti input atom pseudopotenti use either input wavefunct simpl gaussian gener initi charg densiti screen potenti use selfconsist algorithm iter adjust planewav coeffici suffici converg reach energi analyt deriv energi respect atom posit unit cell primit translat yield atom forc stress tensor code option adjust atom posit move forc toward zero adjust unit cell paramet move toward zero stress perform molecular dynam also use find respons atom displac homogen electr field full phonon band structur construct version logic finish help new user brief explan logic abinit version releas full name version three digit exampl first digit slowli vari one averag chang two three year indic major effort trend version level xy abinit major effort place groundstat properti total energi forc geometri optimis molecular dynam version xy responsefunct featur phonon dielectr respons effect charg interatom forc constant includ main addit characterist version xy distribut gnu gener public licenc setup document help user web site html format avail gw capabl version xy put lot effort speed abinit eg paw parallelis histor develop explain test gather directori v v v etc everi month releas product version abinit second digit even number increment usual goe addit featur releas note documentaboutreleasenot issu list addit capabl inform respect modif previou releas odd second digit use intern manag socal develop version abinit exampl two version differ last third digit capabl one largest last digit debug version debug new featur ad like addit bug order start use abinit pleas follow tutorialindexthi tutori learn compil code sourc pleas consult follow guid emb srchttpswikiabinitorglibexefetchphpmediabuildinstalling_abinitpdf typeapplicationpdf width heightpx author xg dca mrgddb util user advis familiar main helpabinit help file read present file import read also helpanaddb complement present read introduct mrgddb code purpos merg transfer ddb gener abinit code make complet ddb exploit anaddb code input simpl could given directli screen conveni pipe file user provid first name new output ddb hesh give short descript one line new ddb creat line print begin ddb user give number ddb merg whole set filenam ddb merg one line use merg code abinit code present version abl produc result one q wavevector dataset databas one q point thu creat use mrgddb also use abl merg differ ddb produc independ differ machin merg code work ddb made two part first part list paramet use make ddb second part list dte dte merg code check follow variabl exactli differ input ddb natom ntypat nband acel amu ecut ixc lloc ngfft occ rprim typat xred zion nband occ valu occopt taken account see abinit help file possibl mrgddb produc ddb occopt case two differ data set code print error messag stop code merg two ddb gener use two differ geometri converg ecut paramet except connect possibl use timerevers symmetri decreas number special k point wavevector perturb gamma case code merg ddb put largest set kpoint insid new ddb mrgddb copi latest date transfer current ddb copi new ddb also take less accur tolwfr copi new ddb end first part action mrgddb name compar inform two differ ddb check done mrgddb check content differ data block constitut new ddb copi sequenti nonident block merg ident block case two element ident mrgddb copi valu transfer ddb latter properti make easi get rid old erron data put new correct data place final summari block content ddb provid end ddb file tutori describ produc testcoverag metric cc project start instrument autotool build produc gcov output gcc gener test coverag artifact run test suit final explor result use lcov introduct wed like assess qualiti exist test suit product strategi project measur test coverag tell us part project code cover exercis test start would good goal neglect project one rare encount test coverag wed like get close initi well use find gain overview testqual project ultim metric guid improv codebas enabl us monitor progress use jenkin associ opensourc tool threepart process sever step well enabl testcoverag particular cc project threepart process enabl special build run test studi output first step enabl special build ultim mean ad flag gcc invoc never seem straightforward autotool project product strategi qualiti team made avail set file facilit buildpleas check youd like follow along bzr co lpallanlesagecoveragetutori inspect archiv youll find __gcovm__ autoconf macro check relev tool __makefileamcoverage__ includ coverageen automak target old revis __dbustestrunner__ copi tutori start let make sure lcov instal lcov incopor gnu tool gcov produc pretti html report coverag result sudo aptget lcov note debian lcov packag includ genhtml readi begin branch project interest heard like test exampl well test __dbustestrunner__ runner run test dbu messag system old revis includ coveragetutori archiv want start fresh differ project would bzr branch lpdbustestrunn instal gcovm autoconf macro invok open gcovm here defin compil flag check necessari tool let put file autoconf find project may alreadi directori macro grep ac_config_macro_dir configureacac_config_macro_dirm find direct simpli copi gcovm file name directori creat directori copi gcovm file thereand dont forget includ refer directori bodi configureac itll look like grep result massag configureac includ necessari coverag flag essenti move special build gcc support coverag report addit compil flag gcovm file remov optim flag cflag changequot cflagsecho cflag sed e sog changequot add special gcc flag coverage_cflagso fprofilearc ftestcoverag coverage_cxxflagso fprofilearc ftestcoverag coverage_ldflagslgcov test run fprofilearc produc talli execut arc codeon gcda file sourc file ftestcoverag flag produc gcno file link arc sourc line see line touch well watch file produc littl bit read flag length gnu documentationhttpgccgnuorgonlinedocsgccdebuggingoptionshtml note also remov optim flag get precis result here step requir knowledg code littl bit autoconf weve includ flag step well need edit configureac make flag avail build dbustestrunn diff look like modifi file configureac configureac configureac am_glib_gnu_gettext gcov coverag report m_includemgcovm ac_tdd_gcov ac_substcoverage_cflag ac_substcoverage_cxxflag ac_substcoverage_ldflag file ad flag build process need actual actual add build proper modifi file srcmakefileam srcmakefileam srcmakefileam dbus_test_runner_sourc dbustestrunnerc dbus_test_runner_cflag dbus_test_runner_cflag coverage_cflag ddefault_session_confdatadirdbustestrunnersessionconf wall werror dbus_test_runner_ldadd dbus_test_runner_lib dbus_test_runner_ldflag coverage_ldflag risk run afoul autotool ancient one uncompl projectif your get result want next step recommend goat bookhttpsourcewareorgautobookautobookautobook_htmlsec decent tutori macro work verifi autoconfsh enablegcov gener gcno file enabl special build gcc compil flag let verifi autoconf gener gcno file weve ask autogensh enablegcov find name gcno srcdbus_test_runnerdbustestrunnergcno goe well well find gcno file compil flag arent respectedmayb someth wrong configureac addit step import checkpoint along way divid autotool process testabl piec instal makefileamcoverag instrument need well use special build run test copi makefileamcoverag toplevel directori cp makefileamcoverag inspect show file defin extra make target gener coverag result use lcov well alert automak simpli includ fileher diff dbustestrunn modifi file makefileam makefileam makefileam subdir data src test po includ top_srcdirmakefileamcoverag verifi make check gener gcda file well actual run test make coveragehtml find name gcda srcdbus_test_runnerdbustestrunnergcda gcda file repres talli arc code note gener file run test also normal executiony see kinship profil lcov via gcov use talli gcno file produc linebylin result well studi moment here test coverag look like dbustestrunn overal coverag rate line line function function branch branch small project figur show good testsuit build curiou miss though well investig regist comment coverag result recogn may actual zero code coverag least your abl measur riiight look lcov page lcov produc coverageresult directori toplevel project open indexhtml web browser explor lcov indexlcov_indexjpg lcov index glanc line coverag testcoverag progress bar yellow awar differ offer metric __line coverage__ mani line test touch __function coverage__ mani function test touch __branch coverage__ graph describ possibl path control fileespeci condit egwhat percentag test touch opinion killer featur lcov output sourcefil display show line werent touch test drill sourc directori see result particular file lcov detaillcov_detailjpg lcov detail dbustestrunnerc line weve hit line test statu g_io_status_norm time never taken path line g_io_status_norm fals conclus weve present introduct test coverag featur gcc toolchain autotoolsa demonstr set util weve found use qualiti group hope obviou tutori beginningnot appli method code also understand test coverag mean improv qualiti team wit observ measur like lcov green bar encourag develop increas test coverag howev chase particularli narrow corner code develop produc confound result caus us doubt accuraci avail toolsi hope thoma voss follow post find futur regardless test coverag import metric group come cycl bar continu grow greener spring approach meanwhil ill interest learn autotoolsgcccoverag experi lcov altern tri hallow autotool ritual profan prepar tutori what highest coverag percentag youv wit gpl project directori test contain test exercis part abinit packag test design primarili exercis part code quickli necessarili give physic sensibl result greater speed test run full converg also qualiti paramet especi ecut minim ie calcul underconverg ran runtestspi util type runtestspi help get help small readm file subdirectori contain input refer file document relat specif one test append input file test also access runtestspi aka runtestspi l also type make help give inform use make command present directori make mostli reli runtestspi also trigger action runtestspi use video give overwiew command line option runtestspi asciicasthttpsasciinemaorgapnghttpsasciinemaorga inform pseudopotenti directori pseudopotenti characterist pseudopotenti gener gth see phi rev b pseudopotenti format pspcod exchangecorrel function pspxc perdewwang parameter teter also found page httpswwwabinitorgsitesdefaultfilesprevatomicdatapsplinkshghhtml warn bigdft tri read addit line give rcutoff rloc present pseudopotenti line exist valu defin lmax contain proper rcutoff rloc eg bigdft might fail hang segfault without give proper error messag difficult debug inform core densiti file directori file gener pspxc perdewwang download page httpswwwabinitorgcore_electron juli inform pseudopotenti directori pseudodojo ncfr v pseudopotenti characterist pseudopotenti gener oncvpsp pseudopotenti format pspcod exchangecorrel function pspxc pbe perdewburkeernzerhof standard accuraci fulli relativist spinorbit inform download juli page httpwwwpseudodojoorg set nc fr oncvpsp v pbe standard psp inform pseudopotenti directori jth v pseudopotenti characterist pseudopotenti gener atompaw pseudopotenti format xml paw exchangecorrel function pspxc perdewwang standard accuraci download juli page httpwwwpseudodojoorg set paw jth v lda standard xml inform pseudopotenti directori pseudodojo ncsr v pseudopotenti characterist pseudopotenti gener oncvpsp pseudopotenti format pspcod exchangecorrel function pspxc pbe perdewburkeernzerhof standard accuraci sever aspsp capsp gapsp inpsp npsp opsp download juli page httpwwwpseudodojoorg set nc sr oncvpsp v pbe standard psp sedpsp znsppsp download novemb httpsgithubcomabinitpseudo_dojotreemasterpseudo_dojopseudosoncvpsppbepdv hpsp download decemb page httpwwwpseudodojoorg set nc sr oncvpsp v pbe standard psp inform pseudopotenti directori pseudopotenti characterist pseudopotenti gener hgh see phi rev b pseudopotenti format pspcod exchangecorrel function pspxc perdewwang parameter teter also found page httpswwwabinitorgsitesdefaultfilesprevatomicdatapsplinkshghhtml warn bigdft tri read addit line give rcutoff rloc present pseudopotenti line exist valu defin lmax contain proper rcutoff rloc eg bigdft might fail hang segfault without give proper error messag difficult debug inform pseudopotenti directori jth v pseudopotenti characterist pseudopotenti gener atompaw pseudopotenti format xml paw exchangecorrel function pspxc perdewwang stringent accuraci download juli page httpwwwpseudodojoorg set paw jth v lda stringent xml inform pseudopotenti directori pseudopotenti characterist pseudopotenti gener troulliermartin gener khein dc allan pseudopotenti format pspcod exchangecorrel function pspxc perdewwang parameter teter download page httpswwwabinitorgsitesdefaultfilesprevatomicdatapsplinkslda_tmhtml juli inform pseudopotenti directori pseudodojo ncsr v pseudopotenti characterist pseudopotenti gener oncvpsp pseudopotenti format pspcod exchangecorrel function pspxc pw perdewwang lda standard accuraci download juli page httpwwwpseudodojoorg set nc sr oncvpsp v lda standard psp opsp download septemb github httpsgithubcomabinitpseudo_dojoblobmasterpseudo_dojopseudosoncvpsppwpdvoopsp time avail pseudodojo web site inform pseudopotenti directori jth v pseudopotenti characterist pseudopotenti gener atompaw pseudopotenti format xml paw exchangecorrel function pspxc pbe perdewburkeernzerhof standard accuraci download juli page httpwwwpseudodojoorg set paw pbe standard xml jth v except jth v fexml nixml snspxml snxml naxml ixml download februari page set jth v inform atom densiti file directori file gener pspxc perdewwang download page httpswwwabinitorgall_core_electron juli inform pseudopotenti directori pseudodojo ncsr v larg core pseudopotenti characterist pseudopotenti gener oncvpsp pseudopotenti format pspcod exchangecorrel function pspxc pw perdewwang lda standard accuraci download septemb github directori httpsgithubcomabinitpseudo_dojotreemasterpseudo_dojopseudo avail pseudodojo web site lower accuraci standard small core pseudopotenti deliv pseudodojo web page git submodul precomput abinit file directori contain git submodul precomput netcdf text file file use select abinit tutori bypass preliminari step eg expens gsdfpt calcul use netcdf text file sinc format portabl across differ architectur contrarili fortran binari file portabl due hardwareendia advantag gitmodulebas approach tutori focu import part calcul without wast time gener requir file moreov improv stabil automat test well user experi disadvantag includ file offici distribut would increas size tarbal file reason decid host extern file github repo includ submodul submodul includ offici tarbal file directori modules_with_data inde list abinitconfigspecsjunkconf user interest run tutori base git submodul easili download data internet use git directli fetch repositori internet quick intro submodul pleas consult offici documentationhttpsgitscmcombookenvgittoolssubmodul also note abinit test suit submoduleawar test requir submodul must declar file section syntax file use_git_submodul mgo_eph_zpr abinit input file locat precomput file pass via string eg getden_filepath mgo_eph_zprflow_zpr_mgowtoutdataout_dennc structur abifilemgo_eph_zprflow_zpr_mgowtoutdataout_dennc runtim runtestspi creat insid work directori test symbol link point eg abinittestsmodules_with_datamgo_eph_zpr exampl see tutorespfninputtephzpr_in git submodul updat remot init submodul testsmodules_with_datamgo_eph_zpr path testsmodules_with_datamgo_eph_zpr url httpsgithubcomabinitmgo_eph_zprgit branch master add new submodul use git submodul add httpsgithubcomabinitmgo_eph_zprgit add follow section abinitgitmodul submodul testsmodules_with_datamgo_eph_zpr path testsmodules_with_datamgo_eph_zpr url gitgithubcomabinitmgo_eph_zprgit branch master ad new directori instruct adapt move directori insid src see point autotool creat directori fill add file git configspecscorelibsconf declar new directori attribut depend upon extern librari configspecsbinariesconf specifi main code depend routin contain new directori order make work issu abinitconfigscriptsmakemak configur make case move check doc file need updat advic find occurr thank grep name_of_directori grep name_of_directori file list thing multibinit todo list multibinit temporari short term todo move section remov done todo add energi tabl manag state wait approv multibinit dev state implement need test todo check acoust sum rule oiju tijuv term sum_u oiju sum_u tijuv sum_v tijuv sum_uv tijuv state oiju bug found partiali fix cutoff riurju disabl done check oiju paramet fit correct sign ij permut state oijuojiu correct soc todo implement sort nicol confirm one oiju could group ju tijuv could group uv ju todo clean spin hist data structur prepar abinit todo updat automat test hexu time novemb todo add autotest nicol time novemb list slc test todo autotest multibinit f ongo final format potenti netcdf file spin hist file hexu nicol time decemb oiju format updat todo document file format nicol hexu todo use reduc coordin instead cartersian final decis hexu time novemb ongo full workflow fit paramet hexu time novemb todo updat tutori document nicol hexu time novemb todo tutori spinlattic coupl genen structur todo clean lattic part _mainmultibinitf manag lattic code state todo separ _effpot directori layer state done make exampl harmon lattic potenti hexu time juli done implement primit potentail read netcdf file test done implement supercel potenti fill_supercel done add data structur manag done move random number gener manag use pointer mover issu store total energi multipl potenti mover get part energi eg spinlattic spin mover get espin espinlatticecoupl lattice_mov get elattic espinlatticecoup anoth problem kinet energi calcul potenti lattic mover also note energi relat specif heat suscept etc documen done document gener data structur hexu time juli done make develop guid add new thing hexu time juli state first draft multibinit_notemd todo make full technic note includ method use everyon state one file exist spinspinlattic coupl lattic todo adapt gener data structur state todo mover todo set intial state hexu time juli done implement get_temperatur get_kinetic_energi todo option maxwellboltzmann distribut done make center mass fix todo make sure global rotat use nonperiod structur todo implement mover hexu time juli done implement veloc verlet mover done implement langevin mover done implement berendsen nvt pend implement berendsen npt pend due testcas avail done add friction paramet langevin taut berendsen taup berendsen npt done add document input variabl spin todo documentaion code hexu time juli todo implement dipoledipol todo implement impsib integr mover todo biqudrat term comput tbj spinlattic coupl done test two dynam without coupl hexu time juli todo implement primit oiju potenti nicol term also implement test done todo implement supercel oiju potenti nicol term also implement test done todo implement advanc integr algorithm spinlattic dynam todo optim tijuv term time accept nicol hexu time firt time consum part sort ijuv indic merg sort onlogn instead insert sort test need see calcul forc bfield fast enough especi larger supercel todo implement full procedur coupl slc dynam nicol lattic wannier function electron long term issu issu damp paramet spin dynam get damp paramet spin dynam count spinphonon coupl copyright c abinit group hexu file distribut term gnu gener public licens see abinitcopi httpwwwgnuorgcopyleftgpltxt initi contributor see abinitdocdeveloperscontributorstxt develop note multibinit manag whole procedur read file outsid manag file input file alloc data structur use inform input param read primit potenti put primitive_potential_list includ read primit cell work like alloc object primit potenti set primit pointer call load_from_fil method primit potenti append potenti primit potenti list build supercel supercel potenti initi mover use inform input file supercel call mover run dynam mover call supercel potenti calcul energi deriv updat system state calcul observ need write hist file final one thing note object manag alloc initi need calcul pointer initi null manag check assciatedpoint finalis object tag tell initi taken care insid object potenti potenti usual primit cell supercel present primit cell potenti one save file xml netcdf etc paramet fit supercel potenti use calcul get energi deriv abstract type add new potenti one add primit potenti fill_supercel add has_var abstract class abstract_primitive_potenti abstract_potenti todo sinc univers whole program would better defin data structur save use pointer add section cell mb_cell_t type section lattic spin lwf ad primit potenti make deriv type abstract_primitive_potential_t modifi function manag read_potenti usual step alloc abstract_primitive_t pointer primit potenti need set primitive_cel pointer potenti done load file function load function also load inform primit cell type load primit potenti file append primit potenti primit potenti list mean pointer point alloc type final function call primit potenti list final ad supercel potenti make deriv type abstract_potential_t overrid method necessari need anyth manag build supercel potenti supercel potenti built fill_supercel method primitv poteti list automat also need worri call final function call potential_list final function mover mover ad new type mover make deriv type abstract_mover_t overrid method necessari add polymorph class pointer mover manag mover deriv type use null default one know get initi add initi set_mov method manag implement run function make mover work final function need call insid manag final function one thing note mover might initi therefor final alway check use associatedpoint ad new lattic mover make deriv type lattice_mover_t overrid least initi final run_one_step function modifi set_mov function manag activ mover paramet ask write hist file hist file note rememb put netcdf relat code netcdf use supercell_mak supercel maker use translat symmetri translat harmon lattic potenti ad test abstract lattic mover ad test veloc verlet nve mover ad test langevin nvt mover ad test berendsen nvt mover ad test multibinit enhanc propos mep keep list propos chang mep chang basic structur multibinit put mep add label properti potenti debug potenti default label modifi final becom destroy potenti mep add get_delta_energi method potenti mont carlo get_delta_energi displac strain spin lwf ispin ds ilatt dtau ilwf dlwf energi param option given pair ispin ds limit one move per step simpl metropolishast possibl extens array chang mc method mep use mover list need fine control mover put list loop use fortran polymorph pointer quit verbos use mep save global state type extend multibinit_dtset_typ potenti mover need share state mostli input paramet thing deriv eg current temperatur temperatur rang extend multibinit_dtset_typ add attribut pointer ad mover potenti necessari mep specifi data structur mpi awar ye outsid ifiam_mast els insid ifiam_mast mep unit test mode unit test use easi abinitmultibinit make modul m_multibinit unit test call unit test function unit test function implement modul run multibinit unittest unit test run instead main multibinit mep usenot use sub type primitivesupercel lattic part use crystal_t abinit either extend type make one type natur one better abinit user script collect script contribut variou user script organ follow configur eas configurationcompil abinit post_process plot extract modifi output data pre_process check visual manipul input data deprec script document suspect broken eventu remov think deprec script kept contact develop via forum contribut commit new script directori pleas make sure contain full document script singl file includ comment head file want add collect script gather subdirectori includ readm file proper document contain onelin descript program ad local readm file liter descript program data script oper usag feed input script output data produc author inform name email address note split sourc tree relev sourc tree abinit gone monolith structur set autonom block abinit common libpaw abinit core first block repres share part abinit latter contain much specif code tightli bound ident packag know exactli use cpp option distribut within sourc tree abinit essenti determin element build system focu instanc someth use lowlevel routin abinit common includ build system abinit core useless viceversa hold libpawspecif featur knowledg extract cpp option actual defin option configur script relationship build system block block also help identifi set small refactor oper highest impact simplic veloc build system last least pinpoint obsolet design make easier elimin dead code give concret exampl sinc cpp option relat fortran standard version support compil use abinit common worth take design decis order repeat detect test within abinit core thu save signific amount time run configur script one anoth motiv simplifi design build system add case abinit common libpaw use one dft code sinc export fortran modul least standard softwar compon ever exist utmost import limit number variant produc build block access inform differ level one simpl strategi avoid repeat timeconsum detect test provid channel pass inform one block other abinit would benefit one follow implement defin common space block would drop requir inform use other eg install_prefixshareorgabinit block produc config file sourc tree build tree would includ other abinit common instal execut script eg abinitconfig block would call retriev essenti inform ensur consist build step implement pro con discuss among core develop abinit select adequ one classifi cpp option python script found split subdirectori pouillon repositori abinit provid locat cpp option sourc code statist extract follow inform relev design build system much cpp option use sourc code cpp option use block cpp option exclus use one block cpp option use one block plu anoth block cpp option use one block plu twice anoth block cpp use everywher treat global cpp option found one block fulli align split sourc tree appear one build system mostli use one block plu twice anoth block best candid explor impact refactor oper design individu build system mutual relationship appear everywher defin build system commun cpp option align split use abinit common abinit_singl cuda_common_h dev_linalg_tim fc_gnu fc_pgi gpu_four_header_h have_cclock have_elpa_fortran have_errno_h have_fc_async have_fc_backtrac have_fc_contigu have_fc_cputim have_fc_ieee_arithmet have_fc_ieee_except have_fc_iomsg have_fc_iso_fortran_ have_fc_macro_newlin have_fc_priv have_fc_protect have_ibm have_inttypes_h have_libtetra_abinit have_linalg_asl have_linalg_elpa_ have_linalg_elpa_ have_linalg_elpa_ have_linalg_elpa_ have_linalg_elpa_ have_linalg_essl have_linalg_magma_ have_linalg_mkl_imatcopi have_linalg_mkl_omatcopi have_linalg_plasma have_malloc_h have_math_h have_mpi_type_create_struct have_omp_collaps have_os_macosx have_papi have_stdarg_h have_stddef_h have_stdint_h have_stdio_h have_stdlib_h have_string_h have_sys_stat_h have_sys_types_h have_unistd_h have_varmacro _abinit_clib_h _abinit_common_h _cray _md_h _xmalloc_h_ __gnuc_minor__ __gnuc__ __stdc_version__ __stdc__ __cplusplu use libpaw have_avx_safe_mod have_fox have_libpaw have_libpaw_abinit have_mpi_inplac have_yaml libpaw_have_fox libpaw_have_libxc libpaw_have_netcdf libpaw_iso_c_bind use core cuda_header_h cuda_rec_head_h debug_verbos dev_debug_thi dev_mg_debug_mod dev_mg_debug_thi dev_new_cod dev_new_hdr dev_rc_bug dev_usesplin dev_yp_debug_psp dev_yp_vdwxc fft_precis have_bigdft have_bse_unpack have_dfti have_dfti_mixed_precis have_fc_command_argu have_fftw have_fftw_mpi have_fftw_thread have_gpu_cuda_sp have_gpu_cuda_tm have_levmar have_libpsml have_linalg_mkl_thread have_lotf have_mpi_ialltoal have_mpi_ibcast have_mpi_io_default have_test_time_partit have_triq have_triqs_v_ have_triqs_v_ have_wanni have_wannier_v have_xml m_ab_kpoints_export_h m_ab_symmetry_export_h read_from_fil _abinit_xc_vdw_h seen cpp option relat capabl fortran compil well interfac fortran languag like c c found abinit common block intricaci linear algebra also found topic thu major focu area build system abinit common libpaw block cpp option finer analysi includ inform histori abinit detail also show outdat have_fox have_yaml regard fortran standard libpaw_iso_c_bind could easili remov libpaw also place abinit have_mpi_inplac use implement build system libpaw take place parallel refactor sourc code abinit core option featur manag well differ level parallel interact cpp option relat fft particular import level associ experiment develop found tell us posteriori split abinit abinit common libpaw abinit core actual consist content sourc code definit core build system abinit manag extern depend relat aspect like fallback best candid refactor _hidewritem_cppopts_dumperf could move upper part abinit use m_error exclus modul lot detect code use abinit core would duplic abinit common cpp option use almost uniqu one block anoth block point easi refactor oper stop use cpp option relat legaci fortran standard fortran assum fortran compil support fortran build system abinit common libpaw could simplifi substanti get rid have_etsf_io cpp option replac direct implement etsf file format move linear algebrarel fortran modul abinit common abinit core confirm libpaw requir second round follow cpp option could use exclus abinit core have_gpu_xxx gpurel modul c header well m_abi_linalg move abinit core have_levmar lowlevel c subdirectori creat upward level have_mem_profil move away m_error abinit_doctor abi_commonh have_netcdf_default move away m_nctk latter move abinit core have_netcdf_mpi m_nctk move abinit core have_gw_dpc option could use exclus abinit core defin somewher els _defsdefs_basisf _numeric_noabirulem_arrayf move upward possibl refactor oper involv small effort discuss among core develop abinit start abinit propos schedul polish test farm configur ypjmb progress make new buildsystem interfac userfriendli ypjmb progress move transient fallback yp use fallback tarbal yp instal fallback within abinit build dir default fc vendor version yp make configur use fallback automat yp write proper warn libpsml dynlib design flaw yp intern ref ypq electronphononcoupl electronphononcoupl epc python modul analyz electronphonon relat quantiti comput abinit istal issu python setuppi instal requir numpi mpipi netcdf build netcdf depend sometim delic certain system might necessari set cc environ variabl compil use build python eg ccgcc usag exampl import electronphononcoupl epc epccomput renormalizationtru broadeningtru self_energytru spectral_functiontru temperaturetru run python script parallel eg mpirun n python myscriptpi document use modul see exampl directori theori pertain electron selfenergi due electronphonon coupl temperatur depend electron structur see prb advanc user develop see doc directori directori contain exampl usag modul electronphononcoupl run exampl must first run abinit calcul calculationslifdynam directori contain document user developp anyon