badg start rcmdcheckhttpsgithubcomarkajyotisaharandomforestsglsworkflowsrcmdcheckbadgesvghttpsgithubcomarkajyotisaharandomforestsglsact badg end randomforestsgl overview r packag randomforestsgl random forest depend data fit nonlinear regress model depend data gener least squar gl base random forest rfgl classic random forest ignor correl structur data purpos greedi partit mean estim resampl regress tree packag implement rfgl propos saha et al circumv aforement problem incorpor work correl structur data partit mean estim resampl articl shown greedi split criterion classic regress tree written ordinari least squar ol optim membership current leaf node form design matrix articl extend rf rfgl similar fashion ol extend gl incorpor covari structur data cost function ensur node split node repres involv contribut point belong node weigh respect spatial correl classic random forest rf data point resampledsubsampl regress tree without account inher correl structur rfgl circumv problem resamplingsubsampl uncorrel contrast instead origin data point randomforestsgl implement fast version rfgl approxim work correl structur use nearest neighbor gaussian process nngp datta et al make suitabl larger dataset instal order instal develop version packag pleas run follow command r r requiredevtool installpackagesdevtool devtoolsinstall_githubarkajyotisaharandomforestsgl ref head instal cran version packag pleas use follow command r r installpackagesrandomforestsgl exampl usag vignett packag vignett avail httpscranrstudiocomwebpackagesrandomforestsglsvignettesrandomforestsgls_user_guidepdf demonstr exampl function avail randomforestsgl use nonlinear regress analysi depend data specif function discuss much detail code document packag function document detail help function randomforestsgl pleas use follow r rfgls_estimate_spati estim spatial data rfgls_estimate_timeseri estim timeseri data rfgls_predict predict mean function rfgls_predict_spati predict spatial respons function input output describ detail refer manual document avail httpscranrstudiocomwebpackagesrandomforestsglsrandomforestsglspdf unknown model paramet spatial data often true covari paramet data known apriori given choic prespecifi list covari function softwar present allow exponenti spheric matérn gaussian covari softwar accommod paramet estim argument param_estim true first fit classic rf ignor correl structur next fit zero mean gaussian process covari structur choic residu obtain estim model paramet maximum likelihood estim initi rf fit estim spatial paramet rf residu justifi theoret result saha et al prove even depend naiv rf consist although empir suboptim estim model paramet use fit rfgl demonstr saha et al lead signific improv classic rf term estim predict accuraci procedur analog linear model setup fit feasibl gl model often involv preestim covari paramet residu ol fit also demonstr section saha et al even misspecif covari structur ie true spatial effect gener differ covari structur specifi covari estim arbitrari smooth function use rfgl exponenti covari default choic covari function softwar lead notic improv simpli use classic rf one addit consider model paramet estim involv comput complex maximum likelihood estim gaussian process origin form involv comput storag space may prohibit larg n problem thoroughli studi spatial statist literatur refer reader datta et al detail review present scenario perform fast lineartim estim model paramet brisc saha datta directli implement present softwar r packag brisc httpscranrprojectorgpackagebrisc timeseri data timeseri data often model paramet autoregress process order autoregress autocorrel coeffici unknown estim use strategi similar spatial case option param_estim true softwar estim model coeffici fit zero mean autoregress process user defin order residu naiv rf fit autoregress paramet fit done use arima base r packag stat parallel rfgls_estimate_spati rfgls_estimate_timeseri rfgls_predict rfgls_predict_spati one also take advantag parallel conting upon avail multipl core one aspect parallelizatiion multithread implement deriv nngp datta et al compon follow brisc packag help deal larg dataset also run regress tree parallel benefici number tree larg small dataset small number tree commun overhead node parallel outweigh benefit parallel comput henc recommend parallel moder larg dataset andor larg number tree packag featur implement sourc code packag written chttpsencppreferencecomwclanguagechttpsisocpporg sake optim execut time function avail user wrapper around sourc code built rs foreign languag interfac basic structur code make use opensourc code regress tree r base implement classic rf randomforest packag split criterion rfgl involv comput intens linear algebra oper nest loop use fortran basic linear algebra subprogram blashttpwwwnetliborgbla linear algebra packag lapackhttpwwwnetliborglapack achiev store matric contigu memori columnmajor format also offer multicor comput build regress tree independ nngp approxim node split rfgl requir optim cost function involv choleski factor precis matrix use full dens precis matrix spatial process becom tax typic person comput resourc term comput cost storag cost order circumv problem use nngp datta et al replac dens graph among spatial locat nearest neighbor graphic model nngp compon combin obtain spars choleski factor close approxim decorrel perform true choleski implement conveni nearest neighbor search follow spnngphttpscranrprojectorgpackagespnngp finley et al effici spars matrix multipl brischttpscranrprojectorgpackagebrisc saha datta structur loop use process facilit parallel use openmp dagum menon stage calcul time seri analysi sparsiti precis matrix inher induc ar covari structur scalabl node split anoth aspect optim propos algorithm involv resourc implement cost function optim provid candid cut direct optim cutoff point c chosen search gap correspond covari follow implement classic regress forest randomforesthttpscranrprojectorgpackagerandomforest start list order covari valu correspond prefix candid direct assign associ data point one node initi help search gap data search next gap equival switch membership exist smallest member wrt covari valu prefix direct initi assign node order determin cost function correspond potenti cutoff point iter serial switch membership data point initi node process graphic demonstr follow figur serial updat membership cutoff labelfigexamplefigurepng sinc serial updat affect one row two column design matrix z correspond newli form node exampl chang z correspond chang figur demonstr follow figur note covari valu correspond matrix compon unord henc serial updat follow natur order result correl adjust effect design matrix qsupsup z use gl loss experi chang correspond two column row corresond point specif point nearest neighbor set consid specif exampl follow figur locat nearest neighbor locat henc updat rule effect row effici implement packag provid effici brute forc recomput effect design matrix serial updat process graphic demonstr follow figur serial updat z labelfigexamplefigurepng chang correl adjust design matrix labelfigexamplefigurepng commun guidelin pleas report issu bug problem softwar httpsgithubcomarkajyotisaharandomforestsglsissu contribut softwar support pleas get touch maintain arkajyoti saha arkajyotisahagmailcom note code block borrow r packag spnngp spatial regress model larg dataset use nearest neighbor gaussian process httpscranrprojectorgpackagespnngp randomforest breiman cutler random forest classif regress httpscranrprojectorgpackagerandomforest rfgl use nearest neighbor gaussian process nngp approxim covari structur data tool necessari implement nngp borrow spnngp packag includ utilcpp part updatebf_org rfgls_bfcpp rfglscpp basic build block random forest borrow randomforest includ part rfglstree_cpp findbestsplit rfglspredicttree_cpp rfglscpp citat pleas cite follow paper use rfgl saha arkajyoti sumanta basu abhirup datta random forest spatial depend data journal american statist associ httpswwwtandfonlinecomdoiful refer dagum leonardo ramesh menon openmp industri standard api sharedmemori program ieee comput scienc engin datta abhirup sudipto banerje andrew finley alan e gelfand hierarch nearestneighbor gaussian process model larg geostatist dataset journal american statist associ httpswwwtandfonlinecomdoiful saha arkajyoti abhirup datta brisc bootstrap rapid infer spatial covari stat e httpsonlinelibrarywileycomdoista finley andrew abhirup datta sudipto banerje spnngp r packag nearest neighbor gaussian process model arxiv preprint arxiv saha arkajyoti sumanta basu abhirup datta random forest spatial depend data journal american statist associ httpswwwtandfonlinecomdoiful titl randomforestsgl r packag random forest depend data tag r spatial statist gaussian process random forest gener leastsquar author name arkajyoti saha affili name sumanta basu affili name abhirup datta affili affili name depart statist univers washington index name depart statist data scienc cornel univers index name depart biostatist john hopkin bloomberg school public health index date februari bibliographi paperbib summari modern advanc geograph inform system remot sens technolog lowcost sensor increasingli encount dataset need account spatial serial depend depend observ y_ y_ cdot y_n covari mathbf x_ldotsmathbf x_n model nonparametr y_i mmathbf x_i epsilon_i mmathbf x_i mean compon epsilon_i account depend data assum depend captur covari function correl stochast process epsilon_i second order depend correl typic function spatial distanc timelag two observ unlik linear regress nonlinear machin learn ml method estim regress function captur complex interact among variabl howev often fail account depend structur result suboptim estim hand special softwar spatialtempor data properli model data correl lack flexibl model mean function focus linear model randomforestsgl bridg gap novel rendit random forest rf name rfgl explicitli model spatialseri data correl rf fit procedur substanti improv estim mean function addit randomforestsgl leverag krige perform predict new locat geospati data statement need randomforestsgl statist machin learn orient rhttpscranrprojectorg packag fit rfgl depend data rfgl algorithm describ saharandom involv comput intens linear algebra oper nest loop especi slow interpret languag like r randomforestsgl effici implement rfgl algorithm lowlevel languag userfriendli interfac r popular comput softwar free gnu gener public licens statist commun randomforestsgl focus fast paralleliz implement rfgl spatial time seri data includ popular choic covari function spatial matérn gp time seri autoregress data packag primarili design use research associ field statist machin learn spatial statist time seri analysi scientif applic signific part code alreadi use saharandom combin speed easeofus randomforestsgl bring tabl regard nonlinear regress analysi depend data hope see packag use plethora futur scientif methodolog explor state field sever r packag implement classic rf notabl randomforesthttpscranrprojectorgpackagerandomforest implement breiman random forest breimanrandom classif regress use fortranhttpsfortranlangorg packag xgboosthttpscranrprojectorgpackagexgboost randomforestsrchttpscranrprojectorgpackagerandomforestsrc rangerhttpscranrprojectorgpackagerang rboristhttpscranrprojectorgpackagerborist detail overview refer reader cran task view machin learn statist learninghttpscranrprojectorgwebviewsmachinelearninghtml best knowledg none packag explicitli account spatial andor tempor correl classic rf use geospati tempor applic see saharandom refer without make methodolog adjust account spatial depend cran task view analysi spatial datahttpscranrprojectorgwebviewsspatialhtml cran task view time seri analysishttpscranrprojectorgwebviewstimeserieshtml two recent work attempt explicitli use spatial inform rf predict purpos henglrandom geomlahttpsgithubcomthenglgeomla georganosgeograph spatialmlhttpscranrprojectorgpackagespatialml see saharandom detail approach tri account depend structur incorpor addit spatial covari advers affect predict perform presenc domin covari effect saharandom addit unlik rfgl estim covari effect separ spatial effect independ interest rf tempor data propos basak suffer similar shortcom randomforestsgl packag provid brief overview function packag packag vignettehttpscranrprojectorgwebpackagesrandomforestsglsvignettesrandomforestsgls_user_guidepdf demonstr exampl use packag nonlinear regress analysi depend data specif function discuss detail document packag rf rfgl account correl structur classic rf averag mani regress tree node regress tree split optim cart split criterion breimanclassif rewritten follow way v_ncartdc fracn left mathbfi mathbf zboldsymbolhatbetamathbf z_ mathbf mathbf z boldsymbolhatbetamathbf z_ right mathbf z mathbf z binari membership matric leaf node tree potenti node split dc denot potenti cut locat split c cut direct choic covari cutoff point valu covari respect boldsymbolhatbeta mathbf z leaf node repres given ol estim correspond design matrix mathbf z written boldsymbolhatbeta mathbf z leftmathbf z top mathbf z right mathbf z top mathbf observ split criterion differ ol loss function cut respect design matric membership leaf node incorpor correl structur data split criterion replac ol loss gl loss tradit done linear model modifi split criterion rewritten beginalign v_nmathbf qdartdc fracn biggleftmathbfi mathbfzboldsymbolhatbeta_glsmathbf z righttop mathbf qleftmathbfi mathbfzboldsymbolhatbeta_glsmathbf z right leftmathbfi mathbfzboldsymbolhatbeta_glsmathbf z righttop mathbf qleftmathbfi mathbfzboldsymbolhatbeta_glsmathbf z right bigg endalign mathbf q invers work covari matrix model spatialseri depend boldsymbolhatbeta_gl mathbf z leaf node repres given gl estim correspond design matrix mathbf z written follow boldsymbolhatbeta_gl mathbf z leftmathbf z top mathbf q mathbf z right mathbf z top mathbf q mathbf spatial data model consid spatial pointreferenc data follow mix model y_i mmathbfx_i wmathbfs_i epsilon_i y_i mathbfx_i respect denot observ respons covari correspond ith observ locat mathbfs_i mmathbfx_i denot covari effect spatial random effect w mathbf account spatial depend beyond covari model use gp mathbfepsilon account independ ident distribut random gaussian nois fit predict spatial random effect model use gaussian process gp practic use comput conveni nearest neighbor gp nngp nngp model paramet unknown estim data saharandom alongsid predict covari effect new covari valu also offer spatial predict new locat nonlinear krige combin nonlinear mean estim spatial krige estim brischttpscranrprojectorgpackagebrisc brisc packag autoregress ar time seri data model rfgl also use function estim time seri set autoregress ar error consid time seri data error arq autoregress process lag q process follow y_t mmathbfx_t e_t e_t sum_i qrho_i e_ti eta_t y_i mathbfx_i denot respons covari correspond tth time point respect e_t arq process eta_t denot iid white nois rho_ cdot rho_q model paramet captur depend e_t e_t cdot e_tq fit predict rfgl exploit sparsiti close form precis matrix ar process model fit predict mean function ar model paramet coeffici order autoregress process unknown code automat estim ar model specifi lag predict covari effect time seri data like spatial data discuss packag provid effici parallel implement rfgl method propos saharandom account correl data modifi node split criteria node repres updat rule packag account spatial correl via matérn gp serial autocorrel provid paramet estim covari structur effici implement cc take advantag nngp approxim scalabl node split updat rule reduc execut time detail packag featur paramet estim parallel found packag readmehttpsgithubcomarkajyotisaharandomforestsglsreadm sinc comput complex evalu potenti split cubic number leaf node rfgl constant standard rf improv comput complex algorithm independ research interest also plan implement valid addit form time seri depend acknowledg ad support nsf award dm ad support nieh award re sb support nsf award dm nih award rgm refer titl use randomforestsgl output rmarkdownpdf_docu vignett vignetteindexentryhow use randomforestsgl vignetteengineknitrrmarkdown vignetteencodingutf r includ fals knitropts_chunkset collaps true comment packag randomforestsgl fit nonlinear regress model depend data generalis least squar gl base random forest rfgl detail saha basu datta httpswwwtandfonlinecomdoiful start load randomforestsgl r packag r setup libraryrandomforestsgl next discuss randomforestsgl packag use estim predict nonlinear regress setup correl error differ scenario spatial data consid spatial point referenc data follow model y_i mmathbfx_i wmathbfs_i epsilon_i y_i mathbfx_i respect denot observ respons covari correspond ith observ locat mathbfs_i mmathbfx_i denot covari effect spatial random effect w mathbf account spatial depend beyond covari mathbfepsilon account independ ident distribut random gaussian nois spatial mix model set packag randomforestsgl allow fit use rfgl spatial random effect model use gaussian process practic model fit use comput conveni nearest neighbor gaussian process nngp datta banerje finley gelfand spatial random effect wcdot along predict covari effect mean function also offer krige base predict spatial respons new locat illustr simul data follow model y_i sinpi x_i w mathbfs_i epsilon_i epsilon sim nmathbf tau mathbfi tau w sim textitexponenti gp sigma phi mean function ey sinpi x w account spatial correl gener exponenti gaussian process spatial varianc sigma spatial correl decay phi epsilon iid random nois varianc tau also call nugget spatial literatur illustr purpos simul n r simul messagefals warningfals rmvn functionn mu v matrix p lengthmu ifanyisnamatchdimvp stopdimens right cholv tmatrixrnormnp ncolpd repmurepnp setse n coord cbindrunifn runifn setse x asmatrixrunifnn sigmasq phi tausq asmatrixdistcoord r expphid w rmvn repn sigmasqr rnormn sinpi x w sqrttausq model fit packag randomforestsgl work precis matrix use glsloss nngp approxim precis matric correspond matérn covari function order fit model code requir coordin coord n time matrix dimension locat respons n length vector respons observ coordin covari x n time p matrix covari observ coordin covari estim xtest ntest time p matrix covari want estim function must ident variabl x default x minimum size leaf node nthsize recommend set valu small lead deep tree take lot time built produc unstabl estim default valu paramet correspond covari function detail afterward detail choic paramet pleas refer help file code rfgls_estimate_spati access rfgls_estimate_spati known covari paramet covari paramet known set param_estim fals default valu code addit requir follow covari model covmodel support keyword exponenti matern spheric gaussian exponenti matérn spheric gaussian covari function respect default valu exponenti sigma sigmasq spatial varianc default valu tau tausq nugget default valu phi phi spatial correl decay paramet default valu nu nu smooth paramet correspond matérn covari function default valu fit model follow r model_fit messagefals warningfals setse est_known rfgls_estimate_spatialcoord x ntree covmodel exponenti nthsize sigmasq sigmasq tausq tausq phi phi estim function covari xtest given estimation_reultpredict interpret rest output pleas see help file code rfgls_estimate_spati use covari model exponenti model beta test stage unknown covari paramet covari paramet known set param_estim true code addit requir covari model covmodel use paramet estim prior rfgl fit fit model unknown covari paramet follow r model_fit_unknown messagefals warningfals setse est_unknown rfgls_estimate_spatialcoord x ntree covmodel exponenti nthsize param_estim true predict mean function given fit model use rfgls_estimate_spati estim mean function new covari valu follow r model_estim messagefals warningfals xtest matrixseq rfgls_predict_known rfgls_predictest_known xtest perform comparison obtain mean integr squar error mise estim hatm rfgl compar correspond classic random forest rf obtain use packag randomforest similar minimum nodes nodes default nodes perform wors see method significantli smaller mise addit show mise obtain unknown paramet rfgl compar mise obtain known covari paramet r comparison messagefals warningfals libraryrandomforest setse rf_est randomforestx nodes rf_predict predictrf_est xtest rf mise meanrf_predict sinpi xtest rfgl mise meanrfgls_predict_knownpredict sinpi xtest rfgls_predict_unknown rfgls_predictest_unknown xtest rfgl unknown mise meanrfgls_predict_unknownpredict sinpi xtest plot true mx sinpi x along loesssmooth version estim hatm obtain rfgl rf show rfgl estim approxim mx better correspond rf r plot_comparison messagefals warningfals rfgls_loess_ loessrfgls_predict_knownpredict clengthxtest span rfgls_smooth predictrfgls_loess_ rf_loess_ loessrf_predict clengthrf_predict span rf_smooth predictrf_loess_ xval csinpi xtest rf_smooth rfgls_smooth xval_tag creptruth lengthsinpi xtest reprf lengthrf_smooth reprfglslengthrfgls_smooth plot_data asdataframexv plot_datamethod xval_tag coval crepseq plot_datacovari coval libraryggplot ggplotplot_data aesxcovari yxval colormethod geom_point lab x x lab fx predict spatial respons given fit model use rfgls_estimate_spati predict spatial responseoutcom new locat provid covari locat approach perform krige new locat use mean function estim correspond covari valu partit simul data train test set ratio next perform predict test set use model fit train set r prediction_spati messagefals warningfals est_known_short rfgls_estimate_spatialcoord matrixx ntree covmodel exponenti nthsize param_estim true rfgls_predict_spati rfgls_predict_spatialest_known_short coord matrixx pred_mat asdataframecbindrfgls_predict_spatialpredict colnamespred_mat cpredict observ ggplotpred_mat aesxobserv ypredict geom_point geom_ablineintercept slope color blue ylim xlim misspecif covari model follow exampl consid set paramet estim misspecifi covari model simul spatial correl matérn covari function smooth paramet nu fit rfgl estim covari paramet use exponenti covari model nu show obtain mise compar favor classic rf r misspec_spati messagefals warningfals data simul matern nu nu r dphinunugammanubesselkxdphi nunu diagr setse w rmvn repn sigmasqr rnormn sinpi x w sqrttausq rfgl exponenti covari setse est_misspec rfgls_estimate_spatialcoord x ntree covmodel exponenti nthsize param_estim true rfgls_predict_misspec rfgls_predictest_misspec xtest rf setse rf_est randomforestx nodes rf_predict predictrf_est xtest rfgl mise meanrfgls_predict_misspecpredict sinpi xtest rf mise meanrf_predict sinpi xtest autoregress time seri data rfgl also use function estim time seri set autoregress error consid time seri data error arq process follow y_t mmathbfx_t e_t e_t sum_i qrho_i e_ti eta_t y_i mathbfx_i denot respons covari correspond tth time point e_t arq pprocess eta_t denot iid white nois rho_ cdot rho_q model paramet captur depend e_t e_t cdot e_tq ar time seri scenario packag randomforestsgl allow fit use rfgl rfgl exploit sparsiti close form precis matrix ar process model fit predict mean function illustr simul ar process follow sinpi x mathbf e_t rho e_t eta_t eta_t sim nsigma e_ eta_ rho sigma ey sinpi x mathbf ar process account tempor correl sigma denot varianc white nois part ar process rho captur degre depend e_t e_t illustr purpos simul n r simulation_tempor rho setse b rho sqrtsigmasq ep arimasimlistord c ar b n n randgen rnorm sd cep sinpi x model fit case time seri data code requir respons n length vector respons observ time point covari x n time p matrix covari observ time point covari estim xtest ntest time p matrix covari want estim function must ident variabl x default x minimum size leaf node nthsize recommend set valu small lead deep tree take lot time built produc unstabl estim default valu paramet correspond ar process detail afterward detail choic paramet pleas refer help file code rfgls_estimate_timeseri access rfgls_estimate_timeseri known ar process paramet ar process paramet known set param_estim fals default valu code addit requir lag_param crho_ cdot rho_q fit model follow r model_fit_tempor messagefals warningfals setse est_temp_known rfgls_estimate_timeseriesi x ntree lag_param rho nthsize unknown ar process paramet ar process paramet known set param_estim true code requir order ar process obtain length lag_param input vector henc want estim paramet arq process lag_param vector length q fit model q r model_fit_temporal_unknown messagefals warningfals setse est_temp_unknown rfgls_estimate_timeseriesi x ntree lag_param rho nthsize param_estim true predict mean function part time seri data analysi ident correspond spatial data r model_estimate_tempor messagefals warningfals xtest matrixseq rfgls_predict_temp_known rfgls_predictest_temp_known xtest also similar spatial data scenario rfgl outperform classic rf term mise true estim ar process paramet r comparison_temp messagefals warningfals libraryrandomforest setse rf_est_temp randomforestx nodes rf_predict_temp predictrf_est_temp xtest rf mise meanrf_predict_temp sinpi xtest rfgl mise meanrfgls_predict_temp_knownpredict sinpi xtest rfgls_predict_temp_unknown rfgls_predictest_temp_unknown xtest rfgl unknown mise meanrfgls_predict_temp_unknownpredict sinpi xtest misspecif ar process order consid scenario order autoregress use rfgl model fit misspecifi simul ar error ar process fit rfgl ar process r misspec_tempor messagefals warningfals simul ar process rho rho setse b crho rho sqrtsigmasq ep arimasimlistord c ar b n n randgen rnorm sd cep sinpi x rfgl ar setse est_misspec_temp rfgls_estimate_timeseriesi x ntree lag_param nthsize param_estim true rfgls_predict_misspec_temp rfgls_predictest_misspec_temp xtest rf setse rf_est_temp randomforestx nodes rf_predict_temp predictrf_est_temp xtest rfgl mise meanrfgls_predict_misspec_temppredict sinpi xtest rf mise meanrf_predict_temp sinpi xtest parallel rfgls_estimate_spati rfgls_estimate_timeseri rfgls_predict rfgls_predict_spati one also take advantag parallel conting upon avail multipl core compon h function determin number core use demonstr exampl h r parallel_spati messagefals warningfals simul exponenti distribut setse n coord cbindrunifn runifn setse x asmatrixrunifnn sigmasq phi tausq nu asmatrixdistcoord r expphid w rmvn repn sigmasqr rnormn sinpi x w sqrttausq rfgl model fit predict parallel comput setse est_known_pl rfgls_estimate_spatialcoord x ntree covmodel exponenti nthsize sigmasq sigmasq tausq tausq phi phi h rfgls_predict_known_pl rfgls_predictest_known_pl xtest h mise singl core meanrfgls_predict_knownpredict sinpi xtest mise parallel comput meanrfgls_predict_known_plpredict sinpi xtest rfgls_estimate_spati small dataset n small number tree ntree commun overhead node parallel outweigh benefit parallel comput henc recommend parallel moder larg n andor ntree strongli recommend max valu h kept strictli less number total core avail parallel rfgls_estimate_timeseri address ident rfgls_predict rfgls_predict_spati even larg dataset singl core perform fast henc unless ntest ntree high recommend use parallel rfgls_predict rfgls_predict_spati titl use randomforestsgl output rmarkdownpdf_docu vignett vignetteindexentryhow use randomforestsgl vignetteengineknitrrmarkdown vignetteencodingutf r includ fals knitropts_chunkset collaps true comment packag randomforestsgl fit nonlinear regress model depend data generalis least squar gl base random forest rfgl detail saha basu datta httpswwwtandfonlinecomdoiful start load randomforestsgl r packag r setup libraryrandomforestsgl next discuss randomforestsgl packag use estim predict nonlinear regress setup correl error differ scenario spatial data consid spatial point referenc data follow model y_i mmathbfx_i wmathbfs_i epsilon_i y_i mathbfx_i respect denot observ respons covari correspond ith observ locat mathbfs_i mmathbfx_i denot covari effect spatial random effect w mathbf account spatial depend beyond covari mathbfepsilon account independ ident distribut random gaussian nois spatial mix model set packag randomforestsgl allow fit use rfgl spatial random effect model use gaussian process practic model fit use comput conveni nearest neighbor gaussian process nngp datta banerje finley gelfand spatial random effect wcdot along predict covari effect mean function also offer krige base predict spatial respons new locat illustr simul data follow model y_i sinpi x_i w mathbfs_i epsilon_i epsilon sim nmathbf tau mathbfi tau w sim textitexponenti gp sigma phi mean function ey sinpi x w account spatial correl gener exponenti gaussian process spatial varianc sigma spatial correl decay phi epsilon iid random nois varianc tau also call nugget spatial literatur illustr purpos simul n r simul messagefals warningfals rmvn functionn mu v matrix p lengthmu ifanyisnamatchdimvp stopdimens right cholv tmatrixrnormnp ncolpd repmurepnp setse n coord cbindrunifn runifn setse x asmatrixrunifnn sigmasq phi tausq asmatrixdistcoord r expphid w rmvn repn sigmasqr rnormn sinpi x w sqrttausq model fit packag randomforestsgl work precis matrix use glsloss nngp approxim precis matric correspond matérn covari function order fit model code requir coordin coord n time matrix dimension locat respons n length vector respons observ coordin covari x n time p matrix covari observ coordin covari estim xtest ntest time p matrix covari want estim function must ident variabl x default x minimum size leaf node nthsize recommend set valu small lead deep tree take lot time built produc unstabl estim default valu paramet correspond covari function detail afterward detail choic paramet pleas refer help file code rfgls_estimate_spati access rfgls_estimate_spati known covari paramet covari paramet known set param_estim fals default valu code addit requir follow covari model covmodel support keyword exponenti matern spheric gaussian exponenti matérn spheric gaussian covari function respect default valu exponenti sigma sigmasq spatial varianc default valu tau tausq nugget default valu phi phi spatial correl decay paramet default valu nu nu smooth paramet correspond matérn covari function default valu fit model follow r model_fit messagefals warningfals setse est_known rfgls_estimate_spatialcoord x ntree covmodel exponenti nthsize sigmasq sigmasq tausq tausq phi phi estim function covari xtest given estimation_reultpredict interpret rest output pleas see help file code rfgls_estimate_spati use covari model exponenti model beta test stage unknown covari paramet covari paramet known set param_estim true code addit requir covari model covmodel use paramet estim prior rfgl fit fit model unknown covari paramet follow r model_fit_unknown messagefals warningfals setse est_unknown rfgls_estimate_spatialcoord x ntree covmodel exponenti nthsize param_estim true predict mean function given fit model use rfgls_estimate_spati estim mean function new covari valu follow r model_estim messagefals warningfals xtest matrixseq rfgls_predict_known rfgls_predictest_known xtest perform comparison obtain mean integr squar error mise estim hatm rfgl compar correspond classic random forest rf obtain use packag randomforest similar minimum nodes nodes default nodes perform wors see method significantli smaller mise addit show mise obtain unknown paramet rfgl compar mise obtain known covari paramet r comparison messagefals warningfals libraryrandomforest setse rf_est randomforestx nodes rf_predict predictrf_est xtest rf mise meanrf_predict sinpi xtest rfgl mise meanrfgls_predict_knownpredict sinpi xtest rfgls_predict_unknown rfgls_predictest_unknown xtest rfgl unknown mise meanrfgls_predict_unknownpredict sinpi xtest plot true mx sinpi x along loesssmooth version estim hatm obtain rfgl rf show rfgl estim approxim mx better correspond rf r plot_comparison messagefals warningfals rfgls_loess_ loessrfgls_predict_knownpredict clengthxtest span rfgls_smooth predictrfgls_loess_ rf_loess_ loessrf_predict clengthrf_predict span rf_smooth predictrf_loess_ xval csinpi xtest rf_smooth rfgls_smooth xval_tag creptruth lengthsinpi xtest reprf lengthrf_smooth reprfglslengthrfgls_smooth plot_data asdataframexv plot_datamethod xval_tag coval crepseq plot_datacovari coval libraryggplot ggplotplot_data aesxcovari yxval colormethod geom_point lab x x lab fx predict spatial respons given fit model use rfgls_estimate_spati predict spatial responseoutcom new locat provid covari locat approach perform krige new locat use mean function estim correspond covari valu partit simul data train test set ratio next perform predict test set use model fit train set r prediction_spati messagefals warningfals est_known_short rfgls_estimate_spatialcoord matrixx ntree covmodel exponenti nthsize param_estim true rfgls_predict_spati rfgls_predict_spatialest_known_short coord matrixx pred_mat asdataframecbindrfgls_predict_spatialpredict colnamespred_mat cpredict observ ggplotpred_mat aesxobserv ypredict geom_point geom_ablineintercept slope color blue ylim xlim misspecif covari model follow exampl consid set paramet estim misspecifi covari model simul spatial correl matérn covari function smooth paramet nu fit rfgl estim covari paramet use exponenti covari model nu show obtain mise compar favor classic rf r misspec_spati messagefals warningfals data simul matern nu nu r dphinunugammanubesselkxdphi nunu diagr setse w rmvn repn sigmasqr rnormn sinpi x w sqrttausq rfgl exponenti covari setse est_misspec rfgls_estimate_spatialcoord x ntree covmodel exponenti nthsize param_estim true rfgls_predict_misspec rfgls_predictest_misspec xtest rf setse rf_est randomforestx nodes rf_predict predictrf_est xtest rfgl mise meanrfgls_predict_misspecpredict sinpi xtest rf mise meanrf_predict sinpi xtest autoregress time seri data rfgl also use function estim time seri set autoregress error consid time seri data error arq process follow y_t mmathbfx_t e_t e_t sum_i qrho_i e_ti eta_t y_i mathbfx_i denot respons covari correspond tth time point e_t arq pprocess eta_t denot iid white nois rho_ cdot rho_q model paramet captur depend e_t e_t cdot e_tq ar time seri scenario packag randomforestsgl allow fit use rfgl rfgl exploit sparsiti close form precis matrix ar process model fit predict mean function illustr simul ar process follow sinpi x mathbf e_t rho e_t eta_t eta_t sim nsigma e_ eta_ rho sigma ey sinpi x mathbf ar process account tempor correl sigma denot varianc white nois part ar process rho captur degre depend e_t e_t illustr purpos simul n r simulation_tempor rho setse b rho sqrtsigmasq ep arimasimlistord c ar b n n randgen rnorm sd cep sinpi x model fit case time seri data code requir respons n length vector respons observ time point covari x n time p matrix covari observ time point covari estim xtest ntest time p matrix covari want estim function must ident variabl x default x minimum size leaf node nthsize recommend set valu small lead deep tree take lot time built produc unstabl estim default valu paramet correspond ar process detail afterward detail choic paramet pleas refer help file code rfgls_estimate_timeseri access rfgls_estimate_timeseri known ar process paramet ar process paramet known set param_estim fals default valu code addit requir lag_param crho_ cdot rho_q fit model follow r model_fit_tempor messagefals warningfals setse est_temp_known rfgls_estimate_timeseriesi x ntree lag_param rho nthsize unknown ar process paramet ar process paramet known set param_estim true code requir order ar process obtain length lag_param input vector henc want estim paramet arq process lag_param vector length q fit model q r model_fit_temporal_unknown messagefals warningfals setse est_temp_unknown rfgls_estimate_timeseriesi x ntree lag_param rho nthsize param_estim true predict mean function part time seri data analysi ident correspond spatial data r model_estimate_tempor messagefals warningfals xtest matrixseq rfgls_predict_temp_known rfgls_predictest_temp_known xtest also similar spatial data scenario rfgl outperform classic rf term mise true estim ar process paramet r comparison_temp messagefals warningfals libraryrandomforest setse rf_est_temp randomforestx nodes rf_predict_temp predictrf_est_temp xtest rf mise meanrf_predict_temp sinpi xtest rfgl mise meanrfgls_predict_temp_knownpredict sinpi xtest rfgls_predict_temp_unknown rfgls_predictest_temp_unknown xtest rfgl unknown mise meanrfgls_predict_temp_unknownpredict sinpi xtest misspecif ar process order consid scenario order autoregress use rfgl model fit misspecifi simul ar error ar process fit rfgl ar process r misspec_tempor messagefals warningfals simul ar process rho rho setse b crho rho sqrtsigmasq ep arimasimlistord c ar b n n randgen rnorm sd cep sinpi x rfgl ar setse est_misspec_temp rfgls_estimate_timeseriesi x ntree lag_param nthsize param_estim true rfgls_predict_misspec_temp rfgls_predictest_misspec_temp xtest rf setse rf_est_temp randomforestx nodes rf_predict_temp predictrf_est_temp xtest rfgl mise meanrfgls_predict_misspec_temppredict sinpi xtest rf mise meanrf_predict_temp sinpi xtest parallel rfgls_estimate_spati rfgls_estimate_timeseri rfgls_predict rfgls_predict_spati one also take advantag parallel conting upon avail multipl core compon h function determin number core use demonstr exampl h r parallel_spati messagefals warningfals simul exponenti distribut setse n coord cbindrunifn runifn setse x asmatrixrunifnn sigmasq phi tausq nu asmatrixdistcoord r expphid w rmvn repn sigmasqr rnormn sinpi x w sqrttausq rfgl model fit predict parallel comput setse est_known_pl rfgls_estimate_spatialcoord x ntree covmodel exponenti nthsize sigmasq sigmasq tausq tausq phi phi h rfgls_predict_known_pl rfgls_predictest_known_pl xtest h mise singl core meanrfgls_predict_knownpredict sinpi xtest mise parallel comput meanrfgls_predict_known_plpredict sinpi xtest rfgls_estimate_spati small dataset n small number tree ntree commun overhead node parallel outweigh benefit parallel comput henc recommend parallel moder larg n andor ntree strongli recommend max valu h kept strictli less number total core avail parallel rfgls_estimate_timeseri address ident rfgls_predict rfgls_predict_spati even larg dataset singl core perform fast henc unless ntest ntree high recommend use parallel rfgls_predict rfgls_predict_spati namerfgls_estimate_spati aliasrfgls_estimate_spati titlefunct estim spatial data rfgl descript function coderfgls_estimate_spati fit univari nonlinear spatial regress model spatial data use rfgl saha et al coderfgls_estimate_spati use spars choleski represent vecchia likelihood vecchia develop datta et al saha datta fit random forest rf model use later predict via coderfgls_predict coderfgls_predict_spati code block borrow r packag spnngp spatial regress model larg dataset use nearest neighbor gaussian process cr httpscranrprojectorgpackagespnngp randomforest breiman cutler random forest classif regress cr httpscranrprojectorgpackagerandomforest usag rfgls_estimate_spatialcoord x xtest null nrnode null nthsize mtri pinv_choic n_omp ntree h sigmasq tausq phi nu nneighbor covmodel exponenti searchtyp tree param_estim fals verbos fals argument itemcoordsan eqnn time n x matrix observ coordin eqnrr eg east north itemyan eqnnn length vector respons observ coordin itemxan eqnn time pn x p matrix covari observ coordin itemxtestan eqnntest time pntest x p matrix covari predict locat structur ident includ intercept covari provid estim purpos codex codenul use codex codextest default valu codenul itemnrnodesth maximum number node tree default choic lead deepest tree contig codenths significantli larg eqnn one need bound grow shallow tree trade effici comput time itemnthsizeminimum size leaf node recommend set valu small lead deep tree take lot time built produc unstabl estima default valu itemmtrynumb variabl randomli sampl partit candid split direct recommend use valu p p number variabl codex default valu itempinv_choicedict choic method obtain pseudoinvers involv cost function node repres evalu pinv_choic svd use slower stabl pinv_choic orthogon decomposit faster may produc unstabl result codenths low use default valu itemn_ompnumb thread use valu sourc code compil openmp support default itemntreenumb tree grown valu small default valu itemhnumb core use parallel comput setup bootstrap sampl h parallel default valu itemsigmasqvalu sigma squar default valu itemtausqvalu tau squar default valu itemphivalu phi default valu itemnuvalu nu requir matern covari model default valu itemnneighborsnumb neighbor use nngp default valu itemcovmodelkeyword specifi covari function use model spatial depend structur among observ support keyword exponenti matern spheric gaussian exponenti matern spheric gaussian covari function respect default valu exponenti itemsearchtypekeyword specifi type nearest neighbor search algorithm use support keyword tree brute provid result though tree faster default valu tree itemparam_estimateif codetru use residu obtain fit classic rf default option codenodes nthsize estim coefficeint correspond codecovmodel codebrisc_estim deafult option default valu codefals itemverboseif codetru model specif along inform regard openmp support progress algorithm print screen otherwis noth print screen default valu codefals valu list compris itemp_matrixan eqnn time ntreen x ntree matrix zero index resampl tth column denot eqnn resampl use tth tree itempredicted_matrixan eqnntest time ntreentest x ntree matrix predict tth column denot predict eqnntest datapoint obtain tth tree itempredictedpreduct valu eqnntest predict point averag coderowmean treewis predction codepredicted_matrix itemxth matrix codex itemyth vector codey itemrfgls_objectobject requir predict refer saha basu datta random forest depend data arxiv preprint arxiv saha datta brisc bootstrap rapid infer spatial covari stat e doi sta datta banerje ao finley ae gelfand hierarch nearestneighbor gaussian process model larg geostatist dataset journal american statist associ andrew finley abhirup datta sudipto banerje spnngp spatial regress model larg dataset use nearest neighbor gaussian process r packag version httpscranrprojectorgpackagespnngp andi liaw matthew wiener randomforest breiman cutler random forest classif regress r packag version cr httpscranrprojectorgpackagerandomforest author arkajyoti saha emailarkajyotisahagmailcom cr sumanta basu emailsumbosecornelledu cr abhirup datta emailabhidattajhuedu exampl rmvn functionn mu v matrix p lengthmu ifanyisnamatchdimvp stopdimens right cholv tmatrixrnormnp ncolpd repmurepnp setse n coord cbindrunifn runifn setse x asmatrixrnormnn sigmasq phi tausq asmatrixdistcoord r expphid w rmvn repn sigmasqr rnormn sinpi x w sqrttausq estimation_result rfgls_estimate_spatialcoord x ntree keywordmodel namerfgls_predict_spati aliasrfgls_predict_spati titlespati respons predict new locat rfgl descript function coderfgls_predict_spati perform fast predict set new locat combin nonlinear mean estim fit rfgl model saha et al spatial krige estim obtain use nearest neighbor gaussian process nngp datta et al code block borrow r packag spnngp spatial regress model larg dataset use nearest neighbor gaussian process cr httpscranrprojectorgpackagespnngp randomforest breiman cutler random forest classif regress cr httpscranrprojectorgpackagerandomforest usag rfgls_predict_spatialrfgls_out coord xtest h verbos fals argument itemrfgls_outan object obtain coderfgls_estimate_spati itemcoordsth spatial coordin correspond predict locat cr structur coord codebrisc_estim default covari valu column eqn adjust mean intercept itemxtestan eqnntest time pntest x p matrix covari predict structur ident includ intercept covari provid estim purpos codex coderfgls_out itemhnumb core use parallel comput setup bootstrap sampl codeh parallel default valu itemverboseif codetru model specif along inform regard openmp support progress algorithm print screen otherwis noth print screen default valu codefals valu list compris itempredictionpredict spatial respons correspond codextest codecoord refer saha basu datta random forest depend data arxiv preprint arxiv saha datta brisc bootstrap rapid infer spatial covari stat e doi sta datta banerje ao finley ae gelfand hierarch nearestneighbor gaussian process model larg geostatist dataset journal american statist associ andrew finley abhirup datta sudipto banerje spnngp spatial regress model larg dataset use nearest neighbor gaussian process r packag version httpscranrprojectorgpackagespnngp andi liaw matthew wiener randomforest breiman cutler random forest classif regress r packag version cr httpscranrprojectorgpackagerandomforest author arkajyoti saha emailarkajyotisahagmailcom cr sumanta basu emailsumbosecornelledu cr abhirup datta emailabhidattajhuedu exampl rmvn functionn mu v matrix p lengthmu ifanyisnamatchdimvp stopdimens right cholv tmatrixrnormnp ncolpd repmurepnp setse n coord cbindrunifn runifn setse x asmatrixrnormnn sigmasq phi tausq asmatrixdistcoord r expphid w rmvn repn sigmasqr rnormn sinpi x w sqrttausq estimation_result rfgls_estimate_spatialcoord matrixx ntree prediction_result rfgls_predict_spatialestimation_result coord matrixx keywordmodel namerfgls_predict aliasrfgls_predict titlepredict mean function rfgl descript function coderfgls_predict predict mean function given set covari use fit rfgl model saha et al obtain predict code block borrow r packag randomforest breiman cutler random forest classif regress cr httpscranrprojectorgpackagerandomforest usag rfgls_predictrfgls_out xtest h verbos fals argument itemrfgls_outan object obtain coderfgls_estimate_spati cr coderfgls_estimate_timeseri itemxtestan eqnntest time pntest x p matrix covari predict structur ident includ intercept covari provid estim purpos codex coderfgls_out itemhnumb core use parallel comput setup bootstrap sampl codeh parallel default valu itemverboseif codetru model specif along inform regard openmp support progress algorithm print screen otherwis noth print screen default valu codefals valu list compris itempredicted_matrixan eqnntest time ntreentest x ntree matrix predict tth column denot predict eqnntest datapoint obtain tth tree itempredictedpreduct valu eqnntest predict point averag coderowmean treewis predction codepredicted_matrix refer saha basu datta random forest depend data arxiv preprint arxiv andi liaw matthew wiener randomforest breiman cutler random forest classif regress r packag version cr httpscranrprojectorgpackagerandomforest author arkajyoti saha emailarkajyotisahagmailcom cr sumanta basu emailsumbosecornelledu cr abhirup datta emailabhidattajhuedu exampl rmvn functionn mu v matrix p lengthmu ifanyisnamatchdimvp stopdimens right cholv tmatrixrnormnp ncolpd repmurepnp setse n x asmatrixrnormnn sigmasq rho setse b rho sqrtsigmasq ep arimasimlistord c ar b n n randgen rnorm sd ep sinpi x estimation_result rfgls_estimate_timeseriesi x ntree xtest matrixseq rfgls_predict rfgls_predictestimation_result xtest keywordmodel namerfgls_estimate_timeseri aliasrfgls_estimate_timeseri titlefunct estim timeseri data rfgl descript function coderfgls_estimate_spati fit univari nonlinear regress model timeseri data use rfgl saha et al coderfgls_estimate_spati use spars choleski represent corresponsind codearq process fit random forest rf model use later predict via coderfglspredict code block borrow r packag spnngp spatial regress model larg dataset use nearest neighbor gaussian process cr httpscranrprojectorgpackagespnngp randomforest breiman cutler random forest classif regress cr httpscranrprojectorgpackagerandomforest usag rfgls_estimate_timeseriesi x xtest null nrnode null nthsize mtri pinv_choic n_omp ntree h lag_param varianc param_estim fals verbos fals argument itemyan eqnnn length vector respons observ time point itemxan eqnn time pn x p matrix covari observ time point itemxtestan eqnntest time pntest x p matrix covari predict structur ident includ intercept covari provid estim purpos codex codenul use codex codextest default valu codenul itemnrnodesth maximum number node tree default choic lead deepest tree contig codenths significantli larg eqnn one need bound grow shallow tree trade effici comput time itemnthsizeminimum size leaf node recommend set valu small lead deep tree take lot time built produc unstabl estima default valu itemmtrynumb variabl randomli sampl partit candid split direct recommend use valu p p number variabl codex default valu itempinv_choicedict choic method obtain pseudoinvers involv cost function node repres evalu pinv_choic svd use slower stabl pinv_choic orthogon decomposit faster may produc unstabl result codenths low use default valu itemn_ompnumb thread use valu sourc code compil openmp support default itemntreenumb tree grown valu small default valu itemhnumb core use parallel comput setup bootstrap sampl h parallel default valu itemlag_paramseqnqq length vector ar coeffici paramet need estim arq process numer vector length q notat pleas see codearima default valu itemvariancevari white nois tempor error function estim affect default valu itemparam_estimateif codetru use residu obtain fit classic rf default option codenodes nthsize estim coefficeint correspond eqnarq codearima option codeincludemean fals default valu codefals itemverboseif codetru model specif along inform regard openmp support progress algorithm print screen otherwis noth print screen default valu codefals valu list compris itemp_matrixan eqnn time ntreen x ntree matrix zero index resampl tth column denot eqnn resampl use tth tree itempredicted_matrixan eqnntest time ntreentest x ntree matrix predict tth column denot predict eqnntest datapoint obtain tth tree itempredictedpreduct valu eqnntest predict point averag coderowmean treewis predction codepredicted_matrix itemxth matrix codex itemyth vector codey itemrfgls_objectobject requir predict refer saha basu datta random forest depend data arxiv preprint arxiv saha datta brisc bootstrap rapid infer spatial covari stat e doi sta andi liaw matthew wiener randomforest breiman cutler random forest classif regress r packag version cr httpscranrprojectorgpackagerandomforest andrew finley abhirup datta sudipto banerje spnngp spatial regress model larg dataset use nearest neighbor gaussian process r packag version httpscranrprojectorgpackagespnngp author arkajyoti saha emailarkajyotisahagmailcom cr sumanta basu emailsumbosecornelledu cr abhirup datta emailabhidattajhuedu exampl setse n x asmatrixrnormnn sigmasq rho setse b rho sqrtsigmasq ep arimasimlistord c ar b n n randgen rnorm sd ep sinpi x estimation_result rfgls_estimate_timeseriesi x ntree keywordmodel