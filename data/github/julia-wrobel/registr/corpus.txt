readmemd gener readmermd pleas edit file registr img srcreadme_filesfiguresregistrpng alignright height badg start httpswwwrpkgorgbadgesversionregistrhttpscranrprojectorgpackageregistr httpcranlogsrpkgorgbadgesgrandtotalregistrcolorgreenhttpscranrprojectorgpackageregistr httpstravisciorgjuliawrobelregistrsvgbranchmasterhttpstravisciorgjuliawrobelregistr appveyor build statushttpsciappveyorcomapiprojectsstatusgithubjuliawrobelregistrbranchmastersvgtruehttpsciappveyorcomprojectjuliawrobelregistr codecov test coveragehttpscodecovioghjuliawrobelregistrbranchmastergraphbadgesvghttpscodecovioghjuliawrobelregistrcoveragesvgbranchmast doihttpsjosstheojorgpapersjossstatussvghttpsdoiorgjoss rcmdcheckhttpsgithubcomjuliawrobelregistrworkflowsrcmdcheckbadgesvghttpsgithubcomjuliawrobelregistract badg end registr incomplet exponenti famili function data author julia wrobelhttpjuliawrobelcom alexand bauerhttpswwwenstablabstatunimuenchendepeopledoktorandenbauerindexhtml erin mcdonnellhttpeimcdonnellcom jeff goldsmithhttpsjeffgoldsmithcom licens mithttpsopensourceorglicensesmit see licenselicens file detail version function data analysi set tool understand pattern variabl data basic unit observ curv measur domain time space exampl acceleromet studi intens physic activ measur minut hour subject data contain curv curv hour activ profil particular subject classic function data analysi assum curv continu come gaussian distribut howev applic exponenti famili function data curv aris exponenti famili distribut smooth latent mean increasingli common exampl take acceleromet data mention assum research interest sedentari behavior instead activ intens minut hour collect binari measur indic whether subject activ inact sedentari binari curv subject trajectori time point take valu assum binari curv smooth latent mean case interpret probabl activ minut hour exampl exponenti famili function data often function dataset curv similar underli pattern main featur curv minimum maximum shift data appear misalign misalign obscur pattern share across curv produc messi summari statist registr method reduc variabl function data clarifi underli pattern align curv packag implement statist method regist exponenti famili function data basic method describ detail paperhttpjuliawrobelcomdownloadsregistration_efpdf adapt potenti incomplet curv set curv observ begin andor end common domain detail incomplet curv methodolog use see correspond packag vignett instruct instal softwar use regist simul binari data provid instal instal cran pleas use r installpackagesregistr instal latest version directli github pleas use r installpackagesdevtool devtoolsinstall_githubjuliawrobelregistr registr packag includ vignett detail packag use function instal latest version pull vignett pleas use r devtoolsinstall_githubjuliawrobelregistr build_vignett true vignettepackag registr use exampl regist simul binari data detail use packag found vignett mention code use registrsimulate_unregistered_curv simul curv subject timepoint observ domain curv similar structur locat peak shift observ domain tsupsup curv unregist misalign domain curv regist align r libraryregistr registration_data simulate_unregistered_curvesi seed plot show unregist curv regist curv img srcreadme_filesfiguregfmplot_sim_datapng styledisplay block margin auto continu observ curv shown order illustr misalign problem simul data simul dataset also includ binari valu gener use continu curv probabl unregist regist binari curv two subject shown img srcreadme_filesfiguregfmplot_subjspng styledisplay block margin auto softwar regist curv estim use function registration_fpca r binary_registr register_fpcay registration_data famili binomi kt kh npc run initi registr step current iter run final fpca step plot show unregist true regist estim regist binari curv two subject fit method img srcreadme_filesfiguregfmplot_fitpng styledisplay block margin auto citat like softwar pleas cite work cite latest cran version packag bibtex use manual titl registr registr exponenti famili function data author julia wrobel alexand bauer erin mcdonnel jeff goldsmith year note r packag version url httpscranrprojectorgpackageregistr cite journal open sourc softwar paper use articlewrobelregistr titleregistr incomplet curv registr exponenti famili function data authorwrobel julia bauer alexand journaljourn open sourc softwar volum number page year cite journal open sourc softwar paper use articlewrobelregi titleregistr registr exponenti famili function data authorwrobel julia journalth journal open sourc softwar volum year contribut find small bug larger issu suggest pleas file use issu trackerhttpsgithubcomjuliawrobelregistrissu email maintain juliawrobelcuanschutzedu contribut via pull request otherwis welcom registr ad newsmd file track chang packag registr prepar first releas cran ad erin mcdonnel author registr erin mcdonnel ad nonparametr updat updat vignett well use period bspline get implement gradient parametr warp stuff registr registr abl handl incomplet curv see new vignett ad twostep gfpca altern gfpca approach new plot function gfpca result parallel registr call ad userspecifi templat function argument y_templat ad gamma poisson famili ad alexand bauer author registr chang converg threshold register_fpca reason threshold mani data situat improv robust cov_hal first center curv take cross product smooth ii ensur posit semidefinit covari matrix matrixnearpd improv speed cov_hal larg data use mgcvbam smooth ad argument npc_varexplain function fpca_gauss bfpca choos number fpc base share explain variat verbos argument take valu better control level detail info messag lot minor fix refin updat potenti invalid url prepar thing mgcv spline choic penal optim sure choos best sigma test environ local r instal r ubuntu travisci r winbuild devel r cmd check result error warn note new releas cran submiss document fix request email receiv jelena saf march bullet detail chang made address request year ad refer descript field descript file descript field descript file lengthen provid full paragraph inform author field descript file chang includ erin mcdonnel jihui lee remov jihui accident referenc author anoth file actual contributor packag remov dontrun exampl check rel quickli replac dontrun donttest slow exampl main userfac function exampl test donttest exampl provid addit document user use softwar larg realworld data set adjust rd file compli cran standard ad valu section rd file data file explain function result titl registr incomplet curv registr exponenti famili function data tag r statist analysi function data partial observ curv author name julia wrobel orcid affili name alexand bauer orcid affili affili name depart biostatist informat univers colorado denver usa index name depart statist lmu munich germani index date decemb bibliographi paperbib introduct function data observ mani differ field typic exampl longerterm panel studi sequenc measur observ subject compar classic longitudin studi function data analysi focus shape timedepend process analyz observ curv per subject eg one analyz speed growth children adulthood berkeley child growth studi see left pane autoreffigregistr function data compris differ mode variat berkeley studi growth spurt less pronounc regard actual growth ie _amplitud variation_ along yaxi spurt also shift month year individu subject ie _phase variation_ along xaxi observ curv often preprocess _registr method_ order separ phase amplitud variat analysi registr method handl continu data data gaussian structur howev function data often nongaussian even categor eg function valu could binari indic repres physic inact patient time wrobel moreov registr approach applic complet observ curv compris underli process start end basic routin regist gaussian data implement r packag r_fda perform joint registr cluster possibl r_fdakma popular squareroot veloc function srvf framework curv registr implement r_fdasrvf complet observ curv regular grid similar approach packag allow regist curv similar shape well repres lowrank basi exponenti familybas registr registr packag base method outlin wrobel registr perform use likelihoodbas approach estim _invers warp functions_ h_i t_i mapsto map observ time domain t_i subject common time domain overal model beginalign elefty_ilefth_it_iright h_i alphat boldsymbolc_i boldsymbolpsit right mu_it gleftmu_itright alphat sum_k k c_ikpsi_kt endalign y_ileftt_iright y_ilefth_it_iright unregist regist curv respect mu_it estim subjectspecif mean serv templat function ie target registr assum distribut link function gcdot condit expect allow us defin loglikelihood elli observ function see wrobel subjectspecif mean mu_it express lowrank represent base populationlevel mean alphat linear combin populationlevel basi function psi_kt subjectspecif score boldsymbolc_i compos fix link function gcdot estim represent use likelihoodbas approach gener function princip compon analysi gfpca overal model estim function register_fpca iter estim warp function implement function registr gfpca estim function fpca_gauss bfpca gaussian binomi data respect approach consist earlier version registr packag compar wrobel version packag includ _twostep gfpca_ approach gertheiss handl exponenti famili distribut respect implement base gfpca packag goldsmith new distribut support registr gfpca furthermor registr step individu templat function curv map flexibl defin user argument y_templat registr register_fpca relev sinc mani set overal mean unregist curv reason templat incomplet curv registr extend approach wrobel incomplet curv underli process either observ begin ie _lead incompleteness_ end _trail incompleteness_ _full incompleteness_ sinc underli process fulli contain observ interv complet curv first last valu completecurv warp function lie diagon line preserv overal domain incomplet curv warp function estim without start point endpoint constraint howev fulli remov constraint lead extrem distort time domain includ regular term lambda penal amount domain dilat compress perform invers warp function mathemat speak add penal term log likelihood elli curv set full incomplet result beginalign ell_textpeni elli lambda cdot n_i cdot textpeni textwith textpeni left hath_it_maxi hath_it_mini t_maxi t_mini right endalign t_minit_maxi minimum maximum observ time domain curv hath_it_mini hath_it_maxi invers warp function evalu minimum maximum lead incomplet h_it_maxi t_maxi foral simplifi textpeni lefthath_it_mini t_miniright trail incomplet h_it_mini t_mini foral textpeni lefthath_it_maxi t_maxiright penal term scale number measur n_i curv ensur similar impact penal curv differ number measur practic set lambda set manual specifi kind warp deem unrealist prevent choic lambda base subject knowledg compar registr result given differ lambda valu registr register_fpca type incomplet defin argument incomplet detail given packag vignett _incomplete_curves_ appli berkeley data simul full incomplet approach lead reason registr shown autoreffigregistr left pane berkeley child growth data simul incomplet center curv registr right estim invers warp functionslabelfigregistrationfigures_registrationpng acknowledg thank fabian scheipl helmut küchenhoff valuabl methodolog contribut refer titl registr registr exponenti famili function data author affili name julia wrobel orcid date output pdf_document bibliographi paperbib tag r statist analysi function data affili index name columbia univers summari function data analysi set tool understand pattern variabl data basic unit observ curv measur time space anoth domain classic function data analysi assum curv continu come gaussian distribut howev applic exponenti famili function data curv aris exponenti famili distribut smooth latent mean increasingli common often function dataset curv similar underli pattern main featur curv minimum maximum shift data appear misalign misalign obscur pattern share across curv produc messi summari statist registr method reduc variabl function data clarifi underli pattern align curv method estim map call warp function transform domain curv align model registr written elefty_ilefth_it_iright c_i h_i right mu_it gleftmu_itright alphat sum_k k c_ikpsi_kt subject warp function h_i map domain curv misalign t_i align domain h_it_i y_ileftt_iright y_ilefth_it_iright unregist regist function respons curv respect mu_it subjectspecif mean relat populationlevel mean alphat linear combin populationlevel basi function psit subjectspecif score c_i known link function g registr packag estim warp function paramet model via twostep iter algorithm detail wrobel main function register_fpca regist function data specifi exponenti famili distribut register_fpca read longformat function dataset output object class registr enhanc comput effic key algorithm compon implement c use r librari rcpp rcpparmadillo rcpp rcpparma interact visual enabl refundshini packag refundshini wrobel refer output github_docu readmemd gener readmermd pleas edit file registr img srcreadme_filesfiguresregistrpng alignright height badg start httpswwwrpkgorgbadgesversionregistrhttpscranrprojectorgpackageregistr httpcranlogsrpkgorgbadgesgrandtotalregistrcolorgreenhttpscranrprojectorgpackageregistr httpstravisciorgjuliawrobelregistrsvgbranchmasterhttpstravisciorgjuliawrobelregistr appveyor build statushttpsciappveyorcomapiprojectsstatusgithubjuliawrobelregistrbranchmastersvgtruehttpsciappveyorcomprojectjuliawrobelregistr codecov test coveragehttpscodecovioghjuliawrobelregistrbranchmastergraphbadgesvghttpscodecovioghjuliawrobelregistrcoveragesvgbranchmast doihttpsjosstheojorgpapersjossstatussvghttpsdoiorgjoss rcmdcheckhttpsgithubcomjuliawrobelregistrworkflowsrcmdcheckbadgesvghttpsgithubcomjuliawrobelregistract badg end r setup includefals knitropts_chunksetecho fals warn fals messag fals collaps true registr incomplet exponenti famili function data author julia wrobelhttpjuliawrobelcom alexand bauerhttpswwwenstablabstatunimuenchendepeopledoktorandenbauerindexhtml erin mcdonnellhttpeimcdonnellcom jeff goldsmithhttpsjeffgoldsmithcom licens mithttpsopensourceorglicensesmit see licenselicens file detail version function data analysi set tool understand pattern variabl data basic unit observ curv measur domain time space exampl acceleromet studi intens physic activ measur minut hour subject data contain curv curv hour activ profil particular subject classic function data analysi assum curv continu come gaussian distribut howev applic exponenti famili function data curv aris exponenti famili distribut smooth latent mean increasingli common exampl take acceleromet data mention assum research interest sedentari behavior instead activ intens minut hour collect binari measur indic whether subject activ inact sedentari binari curv subject trajectori time point take valu assum binari curv smooth latent mean case interpret probabl activ minut hour exampl exponenti famili function data often function dataset curv similar underli pattern main featur curv minimum maximum shift data appear misalign misalign obscur pattern share across curv produc messi summari statist registr method reduc variabl function data clarifi underli pattern align curv packag implement statist method regist exponenti famili function data basic method describ detail paperhttpjuliawrobelcomdownloadsregistration_efpdf adapt potenti incomplet curv set curv observ begin andor end common domain detail incomplet curv methodolog use see correspond packag vignett instruct instal softwar use regist simul binari data provid instal instal cran pleas use r eval fals echo true installpackagesregistr instal latest version directli github pleas use r eval fals echo true installpackagesdevtool devtoolsinstall_githubjuliawrobelregistr registr packag includ vignett detail packag use function instal latest version pull vignett pleas use r eval fals echo true devtoolsinstall_githubjuliawrobelregistr build_vignett true vignettepackag registr use exampl regist simul binari data detail use packag found vignett mention code use registrsimulate_unregistered_curv simul curv subject timepoint observ domain curv similar structur locat peak shift observ domain curv unregist misalign domain curv regist align r simulate_data echo true libraryregistr registration_data simulate_unregistered_curvesi seed plot show unregist curv regist curv r plot_sim_data figaligncent figheight figwidth librarytidyvers librarycowplot unreg ggplotregistration_data aesx index bootinvlogitlatent_mean group id geom_pathalpha theme_bw labsx t_star probi reg ggplotregistration_data aesx bootinvlogitlatent_mean group id geom_pathalpha theme_bw labsx probi cowplotplot_gridunreg reg ncol continu observ curv shown order illustr misalign problem simul data simul dataset also includ binari valu gener use continu curv probabl unregist regist binari curv two subject shown r plot_subj figaligncent figheight figwidth id c sub_data registration_data filterid id unreg ggplotsub_data aesx index bootinvlogitlatent_mean group id color factorid geom_path theme_bw themelegendposit none geom_pointaesi valu alpha size labsx t_star probi reg ggplotsub_data aesx bootinvlogitlatent_mean group id color factorid geom_path theme_bw themelegendposit none geom_pointaesi valu alpha size labsx probi cowplotplot_gridunreg reg ncol softwar regist curv estim use function registration_fpca r register_data echo true messag true binary_registr register_fpcay registration_data famili binomi kt kh npc plot show unregist true regist estim regist binari curv two subject fit method r plot_fit figaligncent figheight figwidth sub_data binary_registrationi filterid id unreg ggplotsub_data aesx tstar bootinvlogitlatent_mean group id color factorid geom_path theme_bw themelegendposit none geom_pointaesi valu alpha size labsx t_star probi reg ggplotsub_data aesx bootinvlogitlatent_mean group id color factorid geom_path theme_bw themelegendposit none geom_pointaesi valu alpha size labsx probi reg_hat ggplotsub_data aesx t_hat bootinvlogitlatent_mean group id color factorid geom_path theme_bw themelegendposit none geom_pointaesi valu alpha size labsx probi cowplotplot_gridunreg reg reg_hat ncol citat like softwar pleas cite work cite latest cran version packag bibtex use manual titl registr registr exponenti famili function data author julia wrobel alexand bauer erin mcdonnel jeff goldsmith year note r packag version url httpscranrprojectorgpackageregistr cite journal open sourc softwar paper use articlewrobelregistr titleregistr incomplet curv registr exponenti famili function data authorwrobel julia bauer alexand journaljourn open sourc softwar volum number page year cite journal open sourc softwar paper use articlewrobelregi titleregistr registr exponenti famili function data authorwrobel julia journalth journal open sourc softwar volum year contribut find small bug larger issu suggest pleas file use issu trackerhttpsgithubcomjuliawrobelregistrissu email maintain juliawrobelcuanschutzedu contribut via pull request otherwis welcom titl regist incomplet curv author alexand bauer date r sysdat output rmarkdownhtml_vignett toc true toc_depth number_sect true vignett vignetteindexentryregist incomplet curv vignetteencodingutf vignetteengineknitrrmarkdown editor_opt chunk_output_typ consol style typetextcss h header fontsiz px h header fontsiz px h header fontsiz px style r setup includ fals knitropts_chunkset collaps true comment messag fals warn fals figwidth vignett outlin function registr packag regard incomplet curv r load_librari echo fals libraryregistr have_ggplot requirenamespaceggplot quietli true have_ggplot libraryggplot theme_settheme_minim themeplottitl element_texthjust introduct incomplet curv aris mani applic incomplet refer function data curv observ begin andor end common domain data structur eg observ presenc dropout panel studi differenti three differ type incomplet incomplet process observ begin end case reason assum start point endpoint warp function registr process lie diagon sinc observ process fulli compris observ interv lead incomplet process necessarili observ begin end case reason assum endpoint lie diagon sinc observ process observ end start point warp function abl vari diagon handl potenti time distort toward begin observ domain trail incomplet process observ begin necessarili end case reason assum start point lie diagon sinc observ process observ begin endpoint warp function abl vari diagon handl potenti time distort toward end observ domain full incomplet process neither necessarili observ begin end case reason assum either start point endpoint lie diagon start point endpoint warp function abl vari diagon handl potenti time distort toward begin end observ domain exemplarili showcas follow function data berkeley growth studi see growth_incomplet artifici simul children observ right start relev part children drop earli studi point time r berkeley data dat registrgrowth_incomplet sort data amount trail incomplet id levelsdatid datid factordatid level idsordersapplyid functioncurve_id maxdatindexdatid curve_id have_ggplot spaghetti plot ggplotdat aesx index valu group id geom_linealpha xlabt observ ylabderiv ggtitlefirst deriv growth curv r berkeley data lasagna figheight have_ggplot ggplotdat aesx index id col valu geom_linelwd scale_color_continuousderiv high midnightblu low lightskyblu xlabt observ ylabcurv ggtitlefirst deriv growth curv themepanelgrid element_blank axistexti element_blank incomplet curv methodolog adapt registr methodolog outlin wrobel et al handl incomplet curv sinc curv potenti individu rang observ time domain spline basi estim curv warp function defin individu curv base given number basi function often quit strict assumpt incomplet data set warp function start andor end diagon ie individu observ part whole time domain extent distort therefor registr packag give addit option estim warp function without constraint start point andor endpoint lie diagon hand fulli remov constraint result extrem unrealist distort time domain problem accompani fact assess given warp realist unrealist heavili vari differ applic reason method includ penal paramet lambda set manual specifi kind distort deem realist applic hand mathemat speak add penal term likelihood elli curv set full incomplet ie start point endpoint free vari diagon result beginalign ell_textpeni elli lambda cdot n_i cdot textpeni textwith textpeni left lefthath_it_maxi hath_it_miniright leftt_maxi t_miniright right endalign t_minit_maxi minimum maximum observ time domain curv hath_it_mini hath_it_maxi invers warp function evalu minimum maximum lead incomplet h_it_maxi t_maxi foral simplifi textpeni lefthath_it_mini t_miniright trail incomplet h_it_mini t_mini foral textpeni lefthath_it_maxi t_maxiright penal term scale number measur n_i curv ensur similar impact penal curv differ number measur higher penal paramet lambda length regist domain forc toward length observ domain given specif applic lambda chosen st unrealist distort time domain prevent user run registr approach multipl time differ lambda find optim valu applic incomplet growth data default function register_fpca registr includ argument incomplet null constrain warp function start end diagon r applic reg registri dat famili gaussian have_ggplot ggplotregi aesx tstar index group id geom_linealpha xlabt observ ylabt regist ggtitleestim warp function r applic lasagna figheight have_ggplot ggplotregi aesx index id col valu geom_linelwd scale_color_continuousderiv high midnightblu low lightskyblu xlabt regist ylabcurv ggtitleregist curv themepanelgrid element_blank axistexti element_blank r applic spaghetti have_ggplot ggplotregi aesx index valu group id geom_linealpha xlabt regist ylabderiv ggtitleregist curv assumpt drop set incomplet valu null nonneg valu penal paramet lambda_inc higher lambda_inc chosen regist domain forc length observ domain small lambda_inc r applic reg registri dat famili gaussian incomplet full lambda_inc have_ggplot ggplotregi aesx tstar index group id geom_linealpha xlabt observ ylabt regist ggtitleestim warp function r applic lasagna figheight have_ggplot ggplotregi aesx index id col valu geom_linelwd scale_color_continuousderiv high midnightblu low lightskyblu xlabt regist ylabcurv ggtitleregist curv themepanelgrid element_blank axistexti element_blank r applic spaghetti have_ggplot ggplotregi aesx index valu group id geom_linealpha xlabt regist ylabderiv ggtitleregist curv larger lambda_inc r applic reg registri dat famili gaussian incomplet full lambda_inc have_ggplot ggplotregi aesx tstar index group id geom_linealpha xlabt observ ylabt regist ggtitleestim warp function r applic lasagna figheight have_ggplot ggplotregi aesx index id col valu geom_linelwd scale_color_continuousderiv high midnightblu low lightskyblu xlabt regist ylabcurv ggtitleregist curv themepanelgrid element_blank axistexti element_blank r applic spaghetti have_ggplot ggplotregi aesx index valu group id geom_linealpha xlabt regist ylabderiv ggtitleregist curv choos optim lambda_inc outlin lambda set smallest valu prevent unrealist distort time domain intuit kind distort _unrealistic_ base subject knowledg exampl see lambda_inc lead extrem compress time domain clearli view unrealist compress exampl prevent set lambda_inc r applic reg registri dat famili gaussian incomplet full lambda_inc have_ggplot ggplotregi aesx tstar index group id geom_linealpha xlabt observ ylabt regist ggtitleestim warp function underli function princip compon estim jointli registr call register_fpca visual registrplotfpca r applic joint reg_joint register_fpcay dat famili gaussian incomplet full lambda_inc npc r applic joint spaghetti have_ggplot ggplotreg_jointi aesx t_hat valu group id geom_linealpha xlabt regist ylabderiv ggtitleregist curv r applic joint fpc plot figheight figwidth have_ggplot plotreg_jointfpca_obj constraint matric optim warp function estim use function constroptim estim warp function curv use linear inequ constraint form boldsymbolu_i cdot boldsymbolbeta_i boldsymbolc_i geq boldsymbol boldsymbolbeta_i paramet vector matrix boldsymbolu_i vector boldsymbolc_i defin constraint estim warp function paramet vector constrain st result warp function monoton exceed overal time domain t_mint_max follow constraint matric list differ set incomplet assum paramet vector length p boldsymbolbeta_i left beginarrayc beta_i beta_i vdot beta_ip endarray right mathbbr_p time note follow constraint matric refer estim nonparametr invers warp function warp nonparametr complet curv set curv observ complet ie underli process interest observ begin end warp function typic assum start end diagon sinc process complet observ observ interv t_minit_maxi subset t_mint_max assum start point endpoint lie diagon set beta_i t_mini beta_ip t_maxi perform estim left beginarrayc beta_i beta_i vdot beta_ip endarray right mathbbr_p time result follow constraint matric allow map observ domain t_minit_maxi domain t_minit_maxi subset t_mint_max beginalign boldsymbolu_i left beginarraycccccccc ldot ldot ldot vdot ddot ddot ddot ddot ddot ddot ddot ldot ldot endarray right mathbbr_p time p boldsymbolc_i left beginarrayc t_mini vdot cdot t_maxi endarray right mathbbr_p time endalign lead incomplet case lead incomplet ie underli process interest observ end necessarili start begin warp function typic assum end diagon st one assum beta_ip t_maxi let warp function end last observ time point t_maxi estim perform remain paramet vector left beginarrayc beta_i beta_i vdot beta_ip endarray right mathbbr_p time result follow constraint matric allow map observ domain t_minit_maxi domain t_mint_maxi subset t_mint_max beginalign boldsymbolu_i left beginarraycccccccc ldot ldot ldot vdot ddot ddot ddot ddot ddot ddot ddot ldot ldot endarray right mathbbr_p time p boldsymbolc_i left beginarrayc t_min vdot cdot t_maxi endarray right mathbbr_p time endalign trail incomplet case trail incomplet ie underli process interest observ begin necessarili end warp function typic assum start diagon st one assum beta_i t_mini let warp function start first observ time point t_mini estim perform remain paramet vector left beginarrayc beta_i beta_i vdot beta_ip endarray right mathbbr_p time result follow constraint matric allow map observ domain t_minit_maxi domain t_minit_max subset t_mint_max beginalign boldsymbolu_i text ident version lead incomplet boldsymbolc_i left beginarrayc t_mini vdot cdot t_max endarray right mathbbr_p time endalign lead trail incomplet case lead trail incomplet ie underli process interest neither necessarili observ begin end warp function typic assum map observ domain t_minit_maxi overal domain t_mint_max result follow constraint matric beginalign boldsymbolu_i left beginarraycccccccc ldot ldot ldot vdot ddot ddot ddot ddot ddot ddot ddot ldot ldot endarray right mathbbr_p time p boldsymbolc_i left beginarrayc t_min vdot cdot t_max endarray right mathbbr_p time endalign help file document individu function give inform argument return object pull via follow register_fpca registr titl registr vignett author julia wrobel alexand bauer erin mcdonnel date r sysdat output rmarkdownhtml_vignett toc true toc_depth number_sect true bibliographi referencesbib vignett vignetteencodingutf vignetteindexentryregistr vignett vignetteengineknitrrmarkdown editor_opt chunk_output_typ consol style typetextcss h header fontsiz px h header fontsiz px h header fontsiz px style r setup includ fals knitropts_chunkset collaps true comment messag fals warn fals figwidth registr packag regist align exponenti famili function data vignett outlin gener function packag packag handl complet incomplet function data ie curv observ begin andor end common domain detail handl incomplet curv registr packag found separ vignett incomplete_curv r load_librari echo fals libraryregistr librarydplyr have_ggplot requirenamespaceggplot quietli true have_cowplot requirenamespacecowplot quietli true have_ggplot have_cowplot libraryggplot theme_settheme_bw librarycowplot exponenti famili registr function data analysi set tool understand pattern variabl data basic unit observ curv measur domain time space exampl acceleromet studi intens physic activ measur minut hour subject data contain curv curv hour activ profil particular subject classic function data analysi assum curv continu come gaussian distribut howev applic exponenti famili function data curv aris exponenti famili distribut smooth latent mean increasingli common exampl take acceleromet data mention assum research interest sedentari behavior instead activ intens minut hour collect binari measur indic whether subject activ inact sedentari binari curv subject trajectori time point take valu assum binari curv smooth latent mean case interpret probabl activ minut hour exampl exponenti famili function data often function dataset curv similar underli pattern main featur curv minimum maximum shift data appear misalign misalign obscur pattern share across curv produc messi summari statist registr method reduc variabl function data clarifi underli pattern align curv core registr method gener function princip compon analysi gfpca popular techniqu extract pattern share across curv registr model algorithm main model exponenti famili registr begineqnarray elefty_ilefth_it_iright c_i h_i right mu_it gleftmu_itright alphat sum_k k c_ikpsi_kt endeqnarray subject invers warp function h_i map unregist time t_i regist time h_it_i y_ileftt_iright y_ilefth_it_iright unregist regist respons curv respect subjectspecif mean mu_it relat populationlevel mean alphat linear combin populationlevel basi function psit subjectspecif score c_i known link function g registr algorithm base model iter follow step estim subjectspecif mean mu_it use gfpca condit current estim h_it_i estim invers warp function h_it_i condit current estim mu_it method implement registr describ detail paperhttpjuliawrobelcomdownloadsregistration_efpdf registr packag main function packag register_fpca call two subfunct gfpca function implement step iter algorithm registr function implement step algorithm function calcul gfpca either base variat em approach outlin wrobel_ twostep method outlin gertheiss_ former case call function depend famili famili gaussian continu data famili binomi binari data function bfpca fpca_gauss call gfpca step respect latter case function gfpca_twostep call also support famili gamma strictli posit data varianc depend mean poisson nonneg count data register_fpca function iter align templat calcul step curv regist note data format use packag requir data specif format longform data frame variabl id index valu valu column contain function observ subject id column identifi observ belong subject index provid grid domain valu observ variabl id uniqu identifi id identifi singl subject sinc assum one curv per subject packag id uniqu identifi curv well covari includ data long variabl id index valu present data simul two function simul data includ packag simulate_unregistered_curv simulate_functional_data simul function data first intend demonstr registr algorithm second test gfpca subfunct packag simul data registr simulate_unregistered_curv gener curv unregist regist time gridsth code gener data subject use function r sim_data registration_data simulate_unregistered_curvesi seed headregistration_data result objectregistration_data data frame variabl id valu index latent_mean consist format registr softwar requir id identifi particular subject valu variabl contain binari observ latent_mean contain continu observ use gener binari observ valu variabl note famili binomi use binari valu variabl observ subject famili gaussian use latent_mean variabl outcom variabl index time grid evalu grid index data unregist grid data regist regist unregist curv plot r plot_sim echo fals figshowhold have_ggplot have_cowplot gg registration_data ggplotaesindex plogislatent_mean group id theme_bw geom_linealpha labsi pri gg registration_data ggplotaest plogislatent_mean group id theme_bw geom_linealpha labsi pri cowplotplot_gridgg gg nrow curv one main peak locat peak shift curv regist peak align simul data gfpca simulate_functional_data simul data populationlevel mean two orthogon princip compon base sine cosin function code gener data subject time point per subject use function r sim_data fpca_data simulate_functional_datai seed lsfpca_data headfpca_datay result objectfpca_data list contain true populationlevel mean alpha princip compon psi psi datafram datafram contain variabl id valu index latent_mean data plot r plot_sim figshowhold echo fals fpca_datay pc_df dataframepop_mean fpca_dataalpha psi fpca_datapsi psi fpca_datapsi index seq lengthout id have_ggplot have_cowplot gg ggploti aesindex latent_mean group id theme_bw geom_linealpha geom_linedata pc_df aesi pop_mean color red gg ggplotpc_df aesindex psi theme_bw geom_linecolor blue gg ggplotpc_df aesindex psi theme_bw geom_linecolor blue cowplotplot_gridgg gg gg nrow left panel figur show latent mean subject along populationlevel mean alphat red middl right panel show first second princip compon psi_t psi_t respect use logitcdot function convert subjectspecif mean probabl probabl use gener binari valu binari valu latent probabl curv one subject dataset shown r plot_sim echo fals have_ggplot filterid ggplotaesindex valu theme_bw geom_pointalpha size geom_lineaesi plogislatent_mean labsi pri alter score varianc princip compon use argument lambda lambda default set subject number time point howev specifi vary_d true gener data uneven grid length subject joint registr gfpca use register_fpca register_fpca main function registr packag use famili argument function specifi type exponenti famili data would like align packag support famili gaussian regist continu data famili binomi regist binari data famili gamma strictli posit data varianc depend mean famili poisson nonneg count data type gfpca specifi argument fpca_typ either call variat em approach wrobel_ fpca_typ variationalem default twostep approach gertheiss_ fpca_typ twostep analyz binari data regist binari data use follow code r register_binari messag fals registr_bin register_fpcay registration_data famili binomi kt kh npc verbos argument specifi input dataset code use simul registration_data kt kh specifi number bspline basi function subjectspecif mean warp function respect npc indic number function princip compon use latter also chosen base explain share varianc see argument npc_varexplain r plot_reg_bin echo fals figshowhold figwidth registr_bini have_ggplot have_cowplot gg ggploti aeststar plogislatent_mean group id theme_bw geom_linealpha labsi pri gg ggploti aest plogislatent_mean group id theme_bw geom_linealpha labsi pri gg ggploti aest_hat plogislatent_mean group id theme_bw geom_linealpha labsi pri cowplotplot_gridgg gg gg nrow underli probabl binari data plot left probabl unregist domain center probabl true regist domain right probabl estim regist domain widehatt registr underli probabl align though import note algorithm regist base underli binari observ true probabl r plot_reg_bin_warp echo fals figshowhold have_ggplot have_cowplot gg ggploti aeststar group id theme_bw geom_linealpha gg ggploti aeststar t_hat group id theme_bw geom_linealpha cowplotplot_gridgg gg nrow true estim warp function plot analyz gaussian data regist continu data use follow code r register_gaussian messag fals registration_datavalu registration_datalatent_mean registr_gauss register_fpcay registration_data famili gaussian npc kt estim gfpca approach gener fpca implement function specif gaussian data fpca_gauss binomi data bfpca altern gfpca_twostep allow appli gfpca also exponenti famili distribut binomi fpca use bfpca registr packag includ novel variat em algorithm binari function princip compon analysi bfpca deriv method binari probabilist pca tipping_ bfpca function work data spars irregular subject observ grid number grid point well dens regularli observ data follow code run bfpca fpca_data dataset r bfpca bfpca_object bfpcafpca_datay npc kt printit true argument printit true print error iter true estim populationlevel mean fpc plot r plot_bfpca echo fals figshowhold epc_df dataframeindex bfpca_objectt_vec psi_est bfpca_objectefunct psi_est bfpca_objectefunct alpha_est bfpca_objectalpha asvector have_ggplot have_cowplot gg ggplot geom_linedata pc_df aesindex pop_mean color blue geom_linedata epc_df aesindex alpha_est linetyp color red theme_bw gg ggplot geom_linedata pc_df aesindex psi color blue geom_linedata epc_df aesindex psi_est linetyp color red theme_bw gg ggplot geom_linedata pc_df aesindex psi color blue geom_linedata epc_df aesindex psi_est linetyp color red theme_bw cowplotplot_gridgg gg gg nrow algorithm run quickli good job recov true fpc note truth estim perfectli align expect data use estim function binari observ gener truth variabl result expect perfectli align one would expect result get better increas number time point per subject registr estim fpc easili visual use intern function plotfpca function automat call call gener plot function object class fpca r plotfpca figshowhold figwidth have_ggplot requirenamespacecowplot quietli true registrplotfpcabfpca_object gener fpca use gfpca_twostep register_fpca call fpca_typ twostep gfpca step perform function gfpca_twostep gertheiss_ outlin comparison pure margin thu bias gfpca approach twostep approach seen quickfix margin approach hall_ work well practic implement base codebas accompani paper found githubcomjeffgoldsmithgfpcahttpsgithubcomjeffgoldsmithgfpca adapt function work effici regard need comput time ram especi larg data set thousand curv estim registr use registr registr step register_fpca call registr function though registr intend perform register_fpca function registr work standalon function registr use constrain maxim exponenti famili likelihood function estim function align curv default option gradient true use analyt gradient optim problem avail famili gaussian binomi famili gamma poisson gradient comput numer thu less comput effici differ comput time gradient true gradient fals illustr code famili binomi r registr_funct data_test_gradi simulate_unregistered_curvesi seed start_tim systim reg_analyt registri data_test_gradi famili binomi gradient true end_tim systim analytic_gradi asnumericroundend_tim start_tim start_tim systim reg_numer registri data_test_gradi famili binomi gradient fals end_tim systim numeric_gradi asnumericroundend_tim start_tim exampl subject time point per subject registr function run r analytic_gradi second analyt gradient r numeric_gradi second numer gradient sinc register_fpca algorithm iter call registr function sever time use analyt deriv drastic increas comput effici especi number subject data larg r registr_funct gradient larg data includefals data_test_gradi simulate_unregistered_curvesi seed start_tim systim reg_analyt registri data_test_gradi famili binomi gradient true end_tim systim analytic_gradient_larg asnumericroundend_tim start_tim start_tim systim reg_numer registri data_test_gradi famili binomi gradient fals end_tim systim numeric_gradient_larg asnumericroundend_tim start_tim run exampl subject time point yield comput time r analytic_gradient_larg second analyt gradient r numeric_gradient_larg numer gradient registr step parallel use core argument addit featur regist incomplet curv incomplet curv aris mani applic incomplet refer function data curv observ begin andor end common domain data structur eg observ presenc dropout panel studi registr packag offer possibl flexibl account differ type incomplet structur registr use registr well joint approach use register_fpca incomplet curv function outlin separ vignett incomplete_curv parametr invers warp function registr packag current support two type invers warp function nonparmetr bspline basi function default parametr knot piecewis linear function warp piecewise_linear registr step estim x t_i coordin two knot construct invers warp function consist line segment regist data parametr invers warp function use follow code r register_parametr registration_data simulate_unregistered_curvesi seed registr_parametr register_fpcay registration_data famili binomi kt kh npc gradient fals warp piecewise_linear argument work famili note gradient option current unavail parametr invers warp function result invers warp function nonparametr left piecewise_linear right specif slope line segment make one parametr function provid interpret particular subject data warp align popul mean r register_parametric_plot echo fals figshowhold eval have_ggplot have_ggplot have_cowplot gg ggplotregistr_gaussi aesx tstar t_hat group id geom_lin labstitl warp nonparametr gg ggplotregistr_parametrici aesx tstar t_hat group id geom_lin labstitl warp piecewise_linear cowplotplot_gridgg gg nrow beyond interpret anoth advantag parametr invers warp function abil specifi prior inform look register_fpca function includ normallydistribut prior pull warp function toward ident line specif prior pull knot coordin toward activ prior one must specifi prior true choos valu argument prior_sd standard deviat appli prior distribut r register_par_prior registr_par_prior register_fpcay registration_data famili binomi kt kh npc gradient fals warp piecewise_linear prior true prior_sd expect smaller varianc lead stronger tendenc toward prior mean demonstr warp function plot r register_par_priors_plot echo fals figshowhold registr_par_prior register_fpcay registration_data famili binomi kt kh npc gradient fals warp piecewise_linear prior true prior_sd have_ggplot have_cowplot gg ggplotregistr_par_priorsi aesx tstar t_hat group id geom_lin labstitl sd prior gg ggplotregistr_par_priorsi aesx tstar t_hat group id geom_lin labstitl sd prior cowplotplot_gridgg gg nrow abil specifi prior current avail binari curv registr gaussian period bspline basi function gfpca case may interest place period boundari condit bspline basi function populationlevel subjectspecif mean templat period condit ensur result function start end valu may use model cyclic data daili physic activ pattern use period bspline basi function registr use option period true r fpca_period registr_period register_fpcay registration_data famili binomi kt kh npc gradient fals period true note gradient option current unavail period true result popul mean princip compon regist continu data use period fals default period true plot dot line demonstr unif start end period function r register_fpca_period echo fals figshowhold registr_non_period register_fpcay registration_data famili binomi kt kh npc gradient fals period fals have_ggplot have_cowplot gg tibblemu registr_non_periodicfpca_objmu mutatetim row_numb ggplotaesx time mu theme_bw geom_lin labsi mu nonperiod gg tibblepsi registr_non_periodicfpca_objefunct mutatetim row_numb ggplotaesx time psi theme_bw geom_lin labsi psi nonperiod gg tibblemu registr_periodicfpca_objmu mutatetim row_numb ggplotaesx time mu theme_bw geom_lin geom_hlineyintercept registr_periodicfpca_objmu lti dot labsi mu period gg tibblepsi registr_periodicfpca_objefunct mutatetim row_numb ggplotaesx time psi theme_bw geom_lin geom_hlineyintercept registr_periodicfpca_objefunct lti dot labsi psi period cowplotplot_gridgg gg gg gg nrow choos templat function default registr estim overal mean curv use mean curv templat function curv regist joint approach register_fpca mean curv use templat initi registr step main iter registr gfpca start situat overal mean reason choic templat see exampl follow curv trail incomplet structur process observ end shape mean curv match observ curv shape well r templat data sim echof figwidth seq lengthout temp_dat dataframeindex rept time valu cdnormt mean sd dnormt mean sd dnormt mean sd id factorrep lengtht have_ggplot ggplottemp_dat aesx index valu geom_lineaescol id geom_smooths fals col black ggtitlesimul data mean curv black perform registr mean curv templat would lead follow result r temp registr without templat figwidth reg registri temp_dat famili gaussian kh incomplet trail lambda_inc have_ggplot ggplotregi aesx index valu col id geom_lin ggtitleregistr overal mean black templat function altern templat function manual defin use one follow option defin templat mean curv base subset observ curv defin templat one observ curv defin templat curv independ observ curv subset curv option one specif curv option specifi use argument y_templat follow exampl red curv id use templat r temp registr templat figwidth y_templat temp_dat filterid reg registri temp_dat famili gaussian kh y_templat y_templat incomplet trail lambda_inc have_ggplot ggplotregi aesx index valu col id geom_lin ggtitleregistr red curv templat help file document individu function give inform argument return object pull via follow register_fpca registr bfpca fpca_gauss gfpca_twostep refer gener roxygen edit hand pleas edit document rplotfpcar nameplotfpca aliasplotfpca titleplot result function pca usag methodplotfpca x plot_fpc xnpc sd_factor response_funct null add_symbol true subtitl true xlim null ylim null xlab regist ylab argument itemxobject class codefpca itemplot_fpcsopt index vector fpc plot default fpc contain codex itemsd_factornumer factor standard deviat fpc score multipli display variat plot default itemresponse_functionopt respons function appli plot curv default codenul ie ident function codexfamili one codecgaussianbinomi codeexp codexfamili one codecgammapoisson itemadd_symbolsind symbol ad plot highlight direct display fpc default true itemsubtitleif true default paramet codesd_factor display plot subtitl itemxlim ylimopt numer vector limit x axi itemxlab ylabopt titl x axi itemaddit argument pass codelinkggplotthem valu return multipl fpc plot return grid codeggplot plot creat codecowplotplot_grid one fpc plot return singl codeggplot plot descript plot method class codefpca plot fpca result visual variat individu fpc around global mean base object creat function codelinkfpca_gauss codelinkbfpca codelinkgfpca_twostep cr cr share explain varianc includ plot titl codex contain element codeevalues_sum exampl datagrowth_incomplet fpca_obj fpca_gaussi growth_incomplet npc requirenamespaceggplot quietli true requirenamespacecowplot quietli true libraryggplot plotfpca_obj author alexand bauer emailalexanderbauerstatunimuenchend gener roxygen edit hand pleas edit document rrcppexportsr namesquaretheta aliassquaretheta titlecalcul quadrat form spline basi function current subject usag squarethetaxi theta argument itemxivector variat paramet current subject itemthetasplin basi function current subject valu matrix quadrat form theta current subject descript calcul quadrat form theta diagon variat paramet center gener roxygen edit hand pleas edit document rgfpca_helpersr namecoarsen_index aliascoarsen_index titlecoarsen index vector given resolut usag coarsen_indexindex significant_digit argument itemindexnumer vector index valu itemsignificant_digitsposit integ valu valu numer vector round index valu descript reduc resolut numer vector specifi number codesignificant_digit number round cr cr intern function use coarsen index vector estim twostep gfpca codelinkgfpca_twostep exampl index_vector c registrcoarsen_indexindex_vector registrcoarsen_indexindex_vector index_vector c registrcoarsen_indexindex_vector registrcoarsen_indexindex_vector author alexand bauer emailalexanderbauerstatunimuenchend gener roxygen edit hand pleas edit document rregistrr nameregistr_onecurv aliasregistr_onecurv titleintern function regist one curv usag registr_onecurv obj null null kt kh famili gaussian gradient true incomplet null lambda_inc null beta null t_min null t_max null period fals warp nonparametr gamma_scal null global_knot null mean_coef null verbos just_return_list fals argument itemobjcurr estim fpc object null argument select itemydatafram valu id valu index itemktnumb bspline basi function use estim mean function default itemkhnumb bspline basi function use estim warp function emphh default itemfamilyon codecgaussianbinomialgammapoisson default codegaussian itemgradientif codetru use analyt gradient calcul deriv codefals calcul gradient numer avail famili codegammapoisson itemincompletenessopt specif incomplet structur one codecleadingtrailingful specifi incomplet present initi measur trail measur respect detail see accompani vignett default null ie incomplet structur set codewarp nonparametr itemlambda_incpen paramet control amount overal dilat domain higher lambda regist domain forc length observ domain use codeincomplet null itembetacurr estim beta subject default null itemt_minminimum valu evalu time domain null taken minimum observ valu itemt_maxmaximum valu evalu time domain null taken maximum observ valu itemperiodicif codetru use period bspline basi function default codefals itemwarpingif codenonparametr default invers warp function estim nonparametr codepiecewise_linear follow piecewis linear function knot itemgamma_scalesonli use codefamili gamma vector one entri subject contain current estim scale paramet gamma distribut default null set start valu scale paramet itemglobal_knotsknot basissplin pass pbspb statsb itemmean_coefsmean coeffici mean curv gfpca base may extract obj object itemaddit argument pass function itemverbosecan set integ control level detail print diagnost messag higher number lead detail messag default itemjust_return_listdo use develop valu list contain itemhinv_innerknotsinn knot set spline basi invers warp function itemhinv_betaestim bspline basi coeffici use construct subjectspecif invers warp function itemt_hatvector regist time domain itemlossloss optim solut descript intern function use within coderegistr perform main optim step codeconstroptim registr one curv author julia wrobel emailjuliawrobelcuanschutzedu erin mcdonnel emaileimcumccolumbiaedu alexand bauer emailalexanderbauerstatunimuenchend gener roxygen edit hand pleas edit document rregister_fpcar nameregister_fpca aliasregister_fpca titleregist curv use constrain optim gfpca usag register_fpca kt kh famili gaussian incomplet null lambda_inc null y_templat null max_iter npc null npc_criterion null fpca_typ variationalem fpca_maxit fpca_se fpca_error_thresh e fpca_index_significantdigit l core l verbos argument itemydatafram valu id valu index itemktnumb bspline basi function use estim mean function function princip compon default codefpca_typ variationalem codenpc_criterion use codekt set itemkhnumb bspline basi function use estim warp function emphh default itemfamilyon codecgaussianbinomialgammapoisson famili codegamma codepoisson support codefpca_typ twostep default codegaussian itemincompletenessopt specif incomplet structur one codecleadingtrailingful specifi incomplet present initi measur trail measur respect detail see accompani vignett default null ie incomplet structur set codewarp nonparametr itemlambda_incpen paramet control amount overal dilat domain higher lambda regist domain forc length observ domain use codeincomplet null itemy_templateopt datafram structur codey use initi registr step null curv regist overal mean curv codey templat function specifi templat function taken mean curv codey_templ default null itemmax_iterationsnumb iter overal algorithm default itemnpc npc_criterionth number function princip compon fpc specifi either directli codenpc base explain share varianc latter case codenpc_criterion set number codefpca_typ twostep also possibl cut potenti tail subordin fpc see codelinkgfpca_twostep detail itemfpca_typeon codecvariationalemtwostep default codevariationalem itemfpca_maxiteronli use codefpca_typ variationalem number pass codemaxit argument bfpca fpca_gauss default itemfpca_seedonli use codefpca_typ variationalem number pass codese argument bfpca fpca_gauss default itemfpca_error_threshonli use codefpca_typ variationalem number pass codeerror_thresh argument bfpca fpca_gauss default itemfpca_index_significantdigitsonli use codefpca_typ twostep posit integ code state number signific digit index grid round gfpca step coarsen index grid necessari sinc otherwis covari surfac matrix explod size presenc mani uniqu index valu case registr step default set codenul prevent round itemcoresnumb core use codecor registr call parallel use codeparallelmclappli unixbas system codeparallelparlappli window default parallel call itemverbosecan set integ control level detail print diagnost messag higher number lead detail messag default itemaddit argument pass registr gfpca function codefpca_typ variationalem valu object class coderegistr contain itemyth observ data plu variabl codet_star codet_hat unregist grid regist grid respect itemfpca_objlist item fpca step itemfamilyus exponenti famili itemindex_warpedlist warp index valu iter codeconvergenceiter element sinc first two element contain origin observ index warp index valu preprocess registr step see detail respect itemhinv_innerknotslist inner knot set spline base invers warp function contain codenul valu codekh itemhinv_betamatrix bspline basi coeffici use construct subjectspecif invers warp function last perform registr step detail see coderegistr itemconvergencelist inform converg joint approach contain follow element cr cr emphconverg cr indic joint algorithm converg ie codemax_iter reach cr cr emphiter cr number joint iter perform cr cr emphdelta_index cr vector mean squar differ warp index valu scale base size observ domain current previou iter converg reach measur drop cr cr emphregistration_loss cr vector loss iter algorithm calcul registr step use exponenti famili likelihood natur paramet fpca step codeiter element sinc first element contain loss preprocess registr step see detail descript function combin constrain optim gfpca estim warp function exponenti famili curv see argument codefamili famili support warp function calcul function codelinkregistr gfpca step perform either use variat embas gfpca approach wrobel et al codefpca_typ variationalem default mix modelbas twostep approach gertheiss et al codefpca_typ twostep cr cr warp function default forc start end diagon domainpreserv behavior chang set codeincomplet valu null reason codelambda_inc valu detail see accompani vignett cr cr number function princip compon fpc either specifi directli argument codenpc chosen base explain share varianc iter argument codenpc_criterion cr cr specifi codecor registr call parallel detail requir input data codey datafram long format variabl codeid codeindex codevalu indic subject id observ time domain observ respect one joint iter consist gfpca step registr step preprocess one initi registr step perform templat function registr step defin argument codey_templ converg codemax_iter reach one final gfpca step perform exampl complet binomi curv simulate_unregistered_curvesi estim base wrobel et al reg register_fpcay npc famili binomi fpca_typ variationalem max_iter requirenamespaceggplot quietli true libraryggplot ggplotregi aesx tstar t_hat group id geom_linealpha ggtitleestim warp function plotregfpca_obj response_funct functionx expx donttest estim base gertheiss et al reg register_fpcay npc famili binomi fpca_typ twostep max_iter fpca_index_significantdigit exampl use acceleromet data nhane studi datanhan nhanes_short nhanesnhanesid uniquenhanesid reg_nhan register_fpcanhanes_short npc famili binomi max_iter incomplet gaussian curv datagrowth_incomplet forc warp function start end diagon rega register_fpcagrowth_incomplet npc famili gaussian incomplet null max_iter requirenamespaceggplot quietli true ggplotregay aesx tstar t_hat group id geom_linealpha ggtitleestim warp function ggplotregay aesx t_hat valu group id geom_linealpha ggtitleregist curv allow warp function start end diagon higher lambda_inc start point endpoint forc toward diagon regb register_fpcagrowth_incomplet npc famili gaussian incomplet full lambda_inc max_iter requirenamespaceggplot quietli true ggplotregbi aesx tstar t_hat group id geom_linealpha ggtitleestim warp function ggplotregbi aesx t_hat valu group id geom_linealpha ggtitleregist curv complet gamma curv simulate_unregistered_curvesi yvalu expylatent_mean registr_gamma register_fpcay npc famili gamma fpca_typ twostep gradient fals max_iter author julia wrobel emailjuliawrobelcuanschutzedu jeff goldsmith emailajgcumccolumbiaedu alexand bauer emailalexanderbauerstatunimuenchend gener roxygen edit hand pleas edit document rsimulate_unregistered_curvesr namegrid_subj_cr aliasgrid_subj_cr titlegener subjectspecif grid t_star usag grid_subj_createcoef argument itemcoefssplin basi coeffici reconstruct subjectspecif grid itemdnumb grid point per subject valu numer vector descript function creat subjectspecif time grid gener roxygen edit hand pleas edit document rsimulate_unregistered_curvesr namemean_curv aliasmean_curv titlesimul mean curv usag mean_curvegrid period pi spline_bas fals argument itemgridgrid x valu evalu function itemperiodcontrol period mean curv itemspline_basedif fals curv construct use sine cosin function true curv construct use bspline basi valu numer vector descript function gener mean simul acceleromet data gener roxygen edit hand pleas edit document rfpca_gaussr namefpca_gauss aliasfpca_gauss titlefunct princip compon analysi via variat em usag fpca_gauss npc null npc_varexplain null kt maxit t_min null t_max null printit fals row_obj null seed period fals error_thresh e subsampl true verbos argument itemydatafram variabl id valu index itemnpc npc_varexplainedth number function princip compon fpc specifi either directli codenpc base explain share varianc latter case codenpc_varexplain set share itemktnumb bspline basi function use estim mean function function princip compon default codenpc_varexplain use codekt set itemmaxitermaximum number iter perform em algorithm default itemt_minminimum valu evalu time domain itemt_maxmaximum valu evalu time domain itemprintiterprint current error iter itemrow_objif null function clean data calcul row indic keep null use standalon coderegist function itemseedset seed reproduc default itemperiodicif true use period bspline basi function default fals itemerror_thresherror threshold end iter default itemsubsampleif number row data greater million row id valu subsampl get mean coeffici itemverbosecan set integ control level detail print diagnost messag higher number lead detail messag default itemaddit argument pass function valu object class codefpca contain itemfpca_typeinform fpca perform variationem approach contrast registrgfpca_twostep itemt_vectim vector mean codemu function princip compon codeefunct evalu itemknotscutpoint bspline basi use rebuild codealpha itemefunctionseqnd time npc matrix estim fpc basi function itemevaluesestim varianc fpc score itemevalues_sumapproxim overal varianc codey base initi run fpca codenpc codenul codenpc_varexplain specifi itemnpcnumb fpc itemscoreseqni time npc matrix estim fpc score itemalphaestim populationlevel mean itemmuestim populationlevel mean valu codealpha includ compat coderefundshini packag itemsubject_coefsbsplin basi coeffici use construct subjectspecif mean use coderegistr function itemyhatfpc approxim subjectspecif mean itemyth observ data itemfamilycodegaussian compat coderefundshini packag itemsigmaestim error varianc descript function use fpca step regist function data call codelinkregister_fpca codefamili gaussian paramet estim base probabilist pca framework origin introduc tip bishop cr cr number function princip compon fpc either specifi directli argument codenpc chosen base explain share varianc codenpc_varexplain latter case explain share varianc accordingli number fpc estim main estim step run fpca codenpc correspondingli codekt approxim overal varianc data codey varianc repres fpc basi fpc exampl datagrowth_incomplet estim fpc fpca_obj fpca_gaussi growth_incomplet npc plotfpca_obj estim npc adapt explain overal variat donttest fpca_obj fpca_gaussi growth_incomplet npc_varexplain plotfpca_obj plot_fpc refer tip e bishop c probabilist princip compon analysi emphjourn royal statist societi seri b author julia wrobel emailjuliawrobelcuanschutzedu jeff goldsmith emailajgcumccolumbiaedu alexand bauer emailalexanderbauerstatunimuenchend gener roxygen edit hand pleas edit document rregistrutilsr namepiecewise_linear_hinv aliaspiecewise_linear_hinv titlecr twoparamet piecewis linear invers warp function usag piecewise_linear_hinvgrid knot_loc c argument itemgridgrid valu evalu function itemknot_locationscontrol x locat two knot descript function use knot piecewis linear model calcul invers warp function registr paramet codeknot_x codeknot_i control x locat first knot paramet codeknot_x codeknot_i control x locat second knot design invers intend commun function take data unregist space regist space consist function data literatur registr author erin mcdonnel emaileimcumccolumbiaedu gener roxygen edit hand pleas edit document rloss_h_gradientr nameloss_h_gradi aliasloss_h_gradi titlegradi loss function registr step usag loss_h_gradi theta_h mean_coef knot betainn famili gaussian incomplet null lambda_inc null t_min t_max t_min_curv t_max_curv kt period fals warp nonparametr argument itemyvector observ point itemtheta_hbsplin basi invers warp function itemmean_coefssplin coeffici vector mean curv itemknotsknot locat bspline basi use estim mean fpc basi function itembetainnersplin coeffici vector estim warp function h itemfamilyon codecgaussianbinomi default codegaussian itemincompletenessopt specif incomplet structur one codecleadingtrailingful specifi incomplet present initi measur trail measur respect detail see accompani vignett default null ie incomplet structur set codewarp nonparametr itemlambda_incpen paramet control amount overal dilat domain higher lambda regist domain forc length observ domain use codeincomplet null itemt_minminimum maximum valu evalu time domain itemt_maxminimum maximum valu evalu time domain itemt_min_curveminimum maximum valu observ time domain potenti incomplet curv itemt_max_curveminimum maximum valu observ time domain potenti incomplet curv itemktnumb bspline basi function use estim mean function default itemperiodicif codetru use period bspline basi function default codefals codeloss_h_gradi current avail codeperiod fals itemwarpingif codenonparametr default invers warp function estim nonparametr codepiecewise_linear follow piecewis linear function knot codeloss_h_gradi current avail codewarp nonparametr valu numer vector spline coeffici gradient loss function descript gradient loss function registr step author julia wrobel emailjuliawrobelcuanschutzedu alexand bauer emailalexanderbauerstatunimuenchend gener roxygen edit hand pleas edit document rregistrutilsr nameinitial_param aliasinitial_param titlecr initi paramet invers warp function usag initial_paramswarp nonparametr k t_vec argument itemwarpingif codenonparametr default invers warp function estim nonparametr codepiecewise_linear follow piecewis linear function knot itemksplin basi matrix defin interv codect_min t_max itemt_vecvector observ potenti irregular time grid descript depend specif type warp function function creat vector initi paramet codenonparametr warp base given spline basi matrix initi paramet defin st result invers warp function equal diagon line codepiecewise_linear warp fix paramet vector return gener roxygen edit hand pleas edit document rsimulate_functional_datar namemean_sim aliasmean_sim titlesimul mean usag mean_simgrid argument itemgridgrid x valu evalu function descript function gener mean simul function data gener roxygen edit hand pleas edit document rbfpcar namebfpca_argprepar aliasbfpca_argprepar titleintern main prepar function bfpca usag bfpca_argprepar kt time t_min t_max period seed subsampl verbos argument itemi time t_min t_maxintern object creat codebfpca itemktnumb bspline basi function use estim mean function function princip compon default codenpc_varexplain use codekt set itemperiodicif true use period bspline basi function default fals itemseedset seed reproduc default itemsubsampleif number row data greater million row id valu subsampl get mean coeffici itemverbosecan set integ control level detail print diagnost messag higher number lead detail messag default valu list element codeknot codetheta_phi codexi codealpha_coef descript intern main prepar function bfpca gener roxygen edit hand pleas edit document rgfpca_covhallr namecov_hal aliascov_hal titlecovari estim hall et al usag cov_hal index_evalgrid kt kc famili gaussian diag_epsilon make_pd true argument itemydatafram valu id valu index itemindex_evalgridgrid evalu covari structur itemktnumb pspline basi function estim margin mean default itemkcnumb margin pspline basi function smooth covari surfac default itemfamilyon codecgaussianbinomialgammapoisson poisson data round perform gfpca ensur integ data see detail section default codegaussian itemdiag_epsilonsmal constant diagon element covari matrix set smaller default itemmake_pdind posit semidefinit return latent covari ensur via codematrixnear_pd default true valu covari matrix dimens codetime_evalgrid x time_evalgrid descript intern function estim covari matrix latent process use approach hall et al use twostep gfpca approach implement codelinkgfpca_twostep cr cr function adapt implement jan gertheiss anamaria staicu gertheiss et al focu higher ram effici larg data set detail implement deviat algorithm describ hall one crucial step comput crossproduct emphcent observ smooth surfac crossproduct directli instead comput smooth surfac crossproduct uncent observ subsequ subtract crossproduct mean function former seem yield smoother eigenfunct fewer nonpositivedefinit covari estim data codey crossproduct matrix contain code row element estim margin mean smooth step covari matrix perform use discretizationbas estim algorithm codelinkmgcvbam rather codelinkmgcvgam estim algorithm exampl datagrowth_incomplet index_grid c seqfrom cov_matrix registrcov_hallgrowth_incomplet index_evalgrid index_grid refer hall p müller h g yao f model spars gener longitudin observ latent gaussian process emphjourn royal statist societi seri b statist methodolog gertheiss j goldsmith j staicu note model spars exponentialfamili function respons curv emphcomput statist data analysi author alexand bauer emailalexanderbauerstatunimuenchend fabian scheipl base work jan gertheiss anamaria staicu gener roxygen edit hand pleas edit document rsimulate_functional_datar namepsi_sim aliaspsi_sim titlesimul pc usag psi_simgrid argument itemgridgrid x valu evalu function descript function gener second princip compon simul function data gener roxygen edit hand pleas edit document rsimulate_unregistered_curvesr namesimulate_unregistered_curv aliassimulate_unregistered_curv titlesimul unregist curv usag simulate_unregistered_curv lambda seed period pi spline_bas fals phase_vari true argument iteminumb subject default itemdnumb grid point per subject default itemlambdastandard deviat subjectspecif amplitud itemseedse reproduc default itemperiodcontrol period mean curv itemspline_basedif fals curv construct use sine cosin function true curv construct use bspline basi itemphase_variationif true creat phase variat regist curv observ uneven grid fals phase variat valu simul datafram variabl id valu index latent_mean index domain curv unregist domain curv regist descript function simul unregist curv provid time valu unregist curv t_star regist curv curv one peak locat shift unregist domain meant mimic acceleromet data author julia wrobel emailjuliawrobelcuanschutzedu jeff goldsmith emailajgcumccolumbiaedu gener roxygen edit hand pleas edit document rbfpcar namebfpca aliasbfpca titlebinari function princip compon analysi usag bfpca npc null npc_varexplain null kt maxit t_min null t_max null printit fals row_obj null seed period fals error_thresh e verbos subsampl true argument itemydatafram variabl id valu index itemnpcth number function princip compon fpc specifi either directli codenpc base explain share varianc latter case codenpc_varexplain set share itemnpc_varexplainedth number function princip compon fpc specifi either directli codenpc base explain share varianc latter case codenpc_varexplain set share itemktnumb bspline basi function use estim mean function function princip compon default codenpc_varexplain use codekt set itemmaxitermaximum number iter perform em algorithm default itemt_minminimum valu evalu time domain itemt_maxmaximum valu evalu time domain itemprintiterprint current error iter itemrow_objif null function clean data calcul row indic keep null use standalon coderegist function itemseedset seed reproduc default itemperiodicif true use period bspline basi function default fals itemerror_thresherror threshold end iter default itemverbosecan set integ control level detail print diagnost messag higher number lead detail messag default itemsubsampleif number row data greater million row id valu subsampl get mean coeffici itemaddit argument pass function valu object class codefpca contain itemfpca_typeinform fpca perform variationem approach contrast registrgfpca_twostep itemt_vectim vector mean codemu function princip compon codeefunct evalu itemknotscutpoint bspline basi use rebuild codealpha itemefunctionseqnd time npc matrix estim fpc basi function itemevaluesestim varianc fpc score itemevalues_sumapproxim overal varianc codey base initi run fpca codenpc codenul codenpc_varexplain specifi itemnpcnumb fpc itemscoreseqni time npc matrix estim fpc score itemalphaestim populationlevel mean itemmuestim populationlevel mean valu codealpha includ compat coderefundshini packag itemsubject_coefsbsplin basi coeffici use construct subjectspecif mean use coderegistr function itemyhatfpc approxim subjectspecif mean appli respons function itemyth observ data itemfamilycodebinomi compat coderefundshini packag itemerrorvector contain error iter algorithm descript function use fpca step regist binari function data call codelinkregister_fpca codefamili binomi method use variat em algorithm estim score princip compon binari function data cr cr number function princip compon fpc either specifi directli argument codenpc chosen base explain share varianc codenpc_varexplain latter case explain share varianc accordingli number fpc estim main estim step run fpca codenpc correspondingli codekt approxim overal varianc data codey varianc repres fpc basi fpc exampl simulate_functional_datay estim fpc bfpca_obj bfpcay npc printit true maxit donttest plotbfpca_obj estim npc adapt explain overal variat bfpca_obj bfpcay npc_varexplain printit true maxit plotbfpca_obj refer jaakkola jordan variat approach bayesian logist regress model extens emphproceed sixth intern workshop artifici intellig statist tip e probabilist visualis highdimension binari data emphadv neural inform process system author julia wrobel emailjuliawrobelcuanschutzedu jeff goldsmith emailajgcumccolumbiaedu alexand bauer emailalexanderbauerstatunimuenchend gener roxygen edit hand pleas edit document rdatar doctypedata namegrowth_incomplet aliasgrowth_incomplet titleberkeley growth studi data simul incomplet format datafram made describ itemida uniqu subject identifi itemindexobserv age child height itemvaluefirst deriv height develop given age usag datagrowth_incomplet descript dataset berkeley growth studi compris height develop boy girl age base dataset codefdagrowth focus observ height first deriv curv take first deriv curv slightli smooth cr cr showcas function coderegistr packag regard analysi incomplet curv growth curv artifici made incomplet child lead incomplet simul draw random initi age first quarter domain also trail incomplet simul draw random cutoff age second half domain refer ramsay j silverman b w emphfunct data analysi nd ed springer new york tuddenham r snyder physic growth california boy girl birth age emphunivers california public child develop keyworddataset gener roxygen edit hand pleas edit document rfpca_gaussr namefpca_gauss_argprepar aliasfpca_gauss_argprepar titleintern main prepar function fpca_gauss usag fpca_gauss_argprepar kt time t_min t_max period seed subsampl verbos argument itemi time t_min t_maxintern object creat codefpca_gauss itemktnumb bspline basi function use estim mean function function princip compon default codenpc_varexplain use codekt set itemperiodicif true use period bspline basi function default fals itemseedset seed reproduc default itemsubsampleif number row data greater million row id valu subsampl get mean coeffici itemverbosecan set integ control level detail print diagnost messag higher number lead detail messag default valu list element codeknot codetheta_phi codealpha_coef descript intern main prepar function fpca_gauss gener roxygen edit hand pleas edit document rgfpca_twostepr namedetermine_npc aliasdetermine_npc titledetermin number fpc base share explain varianc usag determine_npcevalu npc_criterion argument itemevaluesvector estim varianc fpc score itemnpc_criterioneith share ii vector two element target explain share varianc cutoff scree plot criterion latter eg codenpc_criterion c tri choos number fpc explain least variat includ fpc explain least variat even mean explain variat reach valu integ number fucntion princip compon descript intern function call codegfpca_twostep codefpca_gauss codebfpca determin number function princip compon base share explain varianc gener roxygen edit hand pleas edit document rsimulate_functional_datar namesimulate_functional_data aliassimulate_functional_data titlesimul function data usag simulate_functional_data lambda lambda seed vary_d fals argument itemlambdastandard deviat pc score itemlambdastandard deviat pc score iteminumb subject default itemdnumb grid point per subject default itemseedse reproduc default itemvary_dind grid length vari subject fals subject grid length valu list contain itemysimul datafram variabl id valu index latent_mean itempsitru valu first princip compon itempsitru valu second princip compon itemalphatru valu populationlevel mean list contain itemya datafram simul data itempsith first simul eigenfunct itempsith second simul eigenfunct itemalphath popul mean descript function simul function data data output gener mean function two orthogon princip compon basi function mean princip compon base sine cosin function subjectspecif score pc drawn normal distribut standard deviat lambda lambda author julia wrobel emailjuliawrobelcuanschutzedu gener roxygen edit hand pleas edit document rhelpr rregistrr doctypepackag nameregistr aliasregistr titleregist exponenti famili function data usag registr obj null null kt kh famili gaussian gradient true incomplet null lambda_inc null y_templat null beta null t_min null t_max null row_obj null period fals warp nonparametr gamma_scal null core l subsampl true verbos argument itemobjcurr estim fpc object null argument select itemydatafram valu id valu index itemktnumb bspline basi function use estim mean function default itemkhnumb bspline basi function use estim warp function emphh default itemfamilyon codecgaussianbinomialgammapoisson default codegaussian itemgradientif codetru use analyt gradient calcul deriv codefals calcul gradient numer avail famili codegammapoisson itemincompletenessopt specif incomplet structur one codecleadingtrailingful specifi incomplet present initi measur trail measur respect detail see accompani vignett default null ie incomplet structur set codewarp nonparametr itemlambda_incpen paramet control amount overal dilat domain higher lambda regist domain forc length observ domain use codeincomplet null itemy_templateopt datafram structur codey use codeobj null codey_templ null curv regist overal mean curv codey templat function codey_templ specifi templat function taken mean curv codey_templ default null itembetacurr estim beta subject default null itemt_minminimum valu evalu time domain null taken minimum observ valu itemt_maxmaximum valu evalu time domain null taken maximum observ valu itemrow_objif null function clean data calcul row indic keep null use standalon coderegistr function itemperiodicif codetru use period bspline basi function default codefals itemwarpingif codenonparametr default invers warp function estim nonparametr codepiecewise_linear follow piecewis linear function knot itemgamma_scalesonli use codefamili gamma vector one entri subject contain current estim scale paramet gamma distribut default null set start valu scale paramet itemcoresnumb core use codecor registr call parallel use codeparallelmclappli unixbas system codeparallelparlappli window default parallel call itemsubsampleif number row data greater million row id valu subsampl get mean coeffici itemverbosecan set integ control level detail print diagnost messag higher number lead detail messag default itemaddit argument pass function valu list contain itemyth observ data variabl codeindex codeindex_sc contain new estim time domain itemlossvalu loss function registraton itemhinv_innerknotslist inner knot set spline base invers warp function contain codenul valu codekh itemhinv_betamatrix bspline basi coeffici use construct subjectspecif invers warp function see exampl reconstruct warp function base codehinv_innerknot codehinv_beta descript softwar regist function data exponenti famili distribut function use registr step fpcabas approach regist exponentialfamili potenti incomplet function data call codelinkregister_fpca method use constrain optim estim spline coeffici warp function object function optim come maxim ef likelihood subject monoton constraint warp function either specifi codeobj fpca object earlier step codey datafram long format variabl codeid codeindex codevalu indic subject id time observ respect cr cr warp function default forc start end diagon domainpreserv behavior chang set codeincomplet valu null reason codelambda_inc valu detail see accompani vignett cr cr specifi codecor registr call parallel detail templat function registr defin argument codeobj codey_templ depend codeobj null respect exampl complet binomi curv simulate_unregistered_curv register_step registrobj null kt kh famili binomi gradient true donttest incomplet gaussian curv datagrowth_incomplet forc warp function start end diagon preserv domain register_stepa registrobj null growth_incomplet kt kh famili gaussian gradient true incomplet null requirenamespaceggplot quietli true libraryggplot ggplotregister_stepay aesx tstar index group id geom_linealpha ggtitleestim warp function ggplotregister_stepay aesx index valu group id geom_linealpha ggtitleregist curv exampl recreat estim invers warp function given output registr focu id boy id boy index_obsrange_i rangegrowth_incompleteindexgrowth_incompleteid id index seqminindex_obsrange_i maxindex_obsrange_i lengthout note index must contain observ min max index_obsrange_i theta_h_i splinesbsindex knot register_stepahinv_innerknotsid intercept true index_reg asvectortheta_h_i register_stepahinv_betaid warp_dat_i dataframeindex_observ index index_regist index_reg requirenamespaceggplot quietli true ggplotwarp_dat_i aesx index_observ index_regist geom_lin ggtitleextract warp function id boy allow warp function start end diagon higher lambda_inc start point endpoint forc toward diagon register_stepb registrobj null growth_incomplet kt kh famili gaussian gradient true incomplet full lambda_inc requirenamespaceggplot quietli true ggplotregister_stepbi aesx tstar index group id geom_linealpha ggtitleestim warp function ggplotregister_stepbi aesx index valu group id geom_linealpha ggtitleregist curv defin templat function subset curv even though reason exampl template_id cgirlgirlgirl y_templat growth_incompletegrowth_incompleteid template_id register_stepc registrobj null growth_incomplet kt kh famili gaussian gradient true y_templat y_templat incomplet full lambda_inc requirenamespaceggplot quietli true ggplotregister_stepci aesx index valu group id geom_linealpha ggtitleregist curv author julia wrobel julia wrobel emailjuliawrobelcuanschutzedu erin mcdonnel emaileimcumccolumbiaedu alexand bauer emailalexanderbauerstatunimuenchend gener roxygen edit hand pleas edit document rgfpca_helpersr namederivinvlogit aliasderivinvlogit titleestim deriv logit function usag methodderivinvlogitx argument itemxvalu deriv comput descript comput deriv logit function given point codex author alexand bauer emailalexanderbauerstatunimuenchend gener roxygen edit hand pleas edit document rgfpca_covhallr namecrossprods_regular aliascrossprods_regular titlecrossproduct comput mostli regular grid usag crossprods_regulari argument itemydatafram center observ valu id center index descript comput crossproduct fast way mostli regular grid index valu mostli uniqu use intern codecov_hal gener roxygen edit hand pleas edit document rbfpcar namebfpca_optim aliasbfpca_optim titleintern main optim bfpca usag bfpca_optim npc npc_varexplain null kt maxit printit seed period error_thresh verbos row knot theta_phi xi alpha_coef argument itemnpcth number function princip compon fpc specifi either directli codenpc base explain share varianc latter case codenpc_varexplain set share itemnpc_varexplainedth number function princip compon fpc specifi either directli codenpc base explain share varianc latter case codenpc_varexplain set share itemktnumb bspline basi function use estim mean function function princip compon default codenpc_varexplain use codekt set itemmaxitermaximum number iter perform em algorithm default itemprintiterprint current error iter itemseedset seed reproduc default itemperiodicif true use period bspline basi function default fals itemerror_thresherror threshold end iter default itemverbosecan set integ control level detail print diagnost messag higher number lead detail messag default itemi row knot theta_phi xi alpha_coefsintern object creat codebfpca valu list element codet_vec codetheta_phi_mean codealpha_coef codeefunct codeevalu codeevalues_sum codescor codesubject_coef codefittedv codeerror see document codelinkfpca_gauss detail descript main optim function codebfpca codenpc_varexplain specifi function simpli return list element codenpc chosen number fpc codeevalu estim varianc first npc fpc codeevalues_sum sum estim varianc first fpc approxim overal varianc gener roxygen edit hand pleas edit document rrcppexportsr nameexpectedscor aliasexpectedscor titlecalcul expect score score varianc current subject usag expectedscoresi mu psi theta theta_quad argument itemyvector observ current subject itemmuvector spline coeffici popul mean itempsimatrix spline coeffici princip compon basi function itemthetasplin basi function current subject itemtheta_quadquadrat form theta current subject valu list expect score mean varianc current subject descript calcul deriv use maximum likelihood estim gener roxygen edit hand pleas edit document rfpca_gaussr namefpca_gauss_optim aliasfpca_gauss_optim titleintern main optim fpca_gauss usag fpca_gauss_optim npc npc_varexplain null kt maxit printit seed period error_thresh verbos row knot theta_phi alpha_coef argument itemnpcth number function princip compon fpc specifi either directli codenpc base explain share varianc latter case codenpc_varexplain set share itemnpc_varexplainedth number function princip compon fpc specifi either directli codenpc base explain share varianc latter case codenpc_varexplain set share itemktnumb bspline basi function use estim mean function function princip compon default codenpc_varexplain use codekt set itemmaxitermaximum number iter perform em algorithm default itemprintiterprint current error iter itemseedset seed reproduc default itemperiodicif true use period bspline basi function default fals itemerror_thresherror threshold end iter default itemverbosecan set integ control level detail print diagnost messag higher number lead detail messag default itemi row knot theta_phi alpha_coefsintern object creat codefpca_gauss valu list element codet_vec codetheta_phi_mean codealpha_coef codeefunct codeevalu codeevalues_sum codescor codesubject_coef codefittedv codesigma see document codelinkfpca_gauss detail descript main optim function codefpca_gauss codenpc_varexplain specifi function simpli return list element codenpc chosen number fpc codeevalu estim varianc first npc fpc codeevalues_sum sum estim varianc first fpc approxim overal varianc gener roxygen edit hand pleas edit document rconstroptim_helpersr nameensure_proper_beta aliasensure_proper_beta titlecorrect slightli improp paramet vector usag ensure_proper_betabeta t_min t_max argument itembetaparamet vector itemt_min t_maxminimum maximum underli time domain registr step valu slightli chang paramet vector ensur proper solut optim registr step descript intern function joint iter registr gfpca optim codeconstroptim registr step sometim lead slightli improp solut caus optim throw error follow optim step function correct paramet vector one follow slight inconsist occur mess optim codeconstroptim cr two neighbor valu paramet vector similar cr initi valu paramet vector smaller codet_min minimum underli time domain cr last valu paramet vector greater codet_max maximum underli time domain cr one paramet valu slightli greater follow valu ie paramet vector monoton exampl beta_improp c registrensure_proper_betabeta_improp t_min t_max author alexand bauer emailalexanderbauerstatunimuenchend gener roxygen edit hand pleas edit document rloss_hr nameloss_h aliasloss_h titleloss function registr step optim usag loss_h theta_h mean_coef knot betainn famili t_min t_max t_min_curv t_max_curv incomplet null lambda_inc null period fals kt warp nonparametr prior fals prior_sd null argument itemyvector observ point itemtheta_hbsplin basi invers warp function itemmean_coefssplin coeffici vector mean curv itemknotsknot locat bspline basi use estim mean fpc basi function itembetainnersplin coeffici vector estim warp function h itemfamilyon codecgaussianbinomialgammapoisson intern purpos also set codegammavarem codepoissonvarem preced fpca step coderegister_fpca perform codefpca_typ variationalem use gaussian famili itemt_min t_maxminimum maximum valu evalu time domain itemt_min_curv t_max_curveminimum maximum valu observ time domain potenti incomplet curv itemincompletenessopt specif incomplet structur one codecleadingtrailingful specifi incomplet present initi measur trail measur respect detail see accompani vignett default null ie incomplet structur set codewarp nonparametr itemlambda_incpen paramet control amount overal dilat domain higher lambda regist domain forc length observ domain use codeincomplet null itemperiodicif codetru use period bspline basi function default codefals itemktnumb bspline basi function use estim mean function default itemwarpingif codenonparametr default invers warp function estim nonparametr codepiecewise_linear follow piecewis linear function knot itempriorsfor codewarp piecewise_linear logic indic whether add normal prior pull knot toward ident line itemprior_sdfor codewarp piecewise_linear codeprior true userspecifi standard deviat normal prior singl valu appli knot prior valu scalar valu taken loss function descript loss function registr step optim author julia wrobel emailjuliawrobelcuanschutzedu erin mcdonnel emaileimcumccolumbiaedu alexand bauer emailalexanderbauerstatunimuenchend gener roxygen edit hand pleas edit document rgfpca_twostepr namegfpca_twostep aliasgfpca_twostep titlegener function princip compon analysi usag gfpca_twostep famili gaussian npc null npc_criterion null kt t_min null t_max null row_obj null index_significantdigit l estimation_accuraci high start_param null period fals verbos argument itemydatafram valu id valu index itemfamilyon codecgaussianbinomialgammapoisson poisson data round perform gfpca ensur integ data see detail section default codegaussian itemnpc npc_criterionth number function princip compon fpc specifi either directli codenpc base explain share varianc latter case codenpc_criterion either set share ii vector two element compris target explain share varianc cutoff scree plot criterion exampl latter codenpc_criterion c tri choos number fpc explain least variat includ fpc explain least variat even mean explain variat reach itemktnumb bspline basi function use estim mean function function princip compon default itemt_minminimum valu evalu time domain itemt_maxmaximum valu evalu time domain itemrow_objif null function clean data calcul row indic keep null use standalon coderegist function itemindex_significantdigitsposit integ code state number signific digit index grid round coarsen index grid necessari sinc otherwis covari surfac matrix explod size presenc mani uniqu index valu alway case registr step default set codenul prevent round itemestimation_accuracyon codechighlow set codelow mix model estim step codelm perform lower accuraci reduc comput time default codehigh itemstart_paramsopt start valu gamm use codenpc_criterion specifi itemperiodiconli contain full consist codefpca_gauss codebfpca true return knot vector period bspline basi function default fals paramet chang result twostep gfpca itemverbosecan set integ control level detail print diagnost messag higher number lead detail messag default itemaddit argument pass codelinkcov_hal valu object class codefpca contain itemfpca_typeinform fpca perform twostep approach contrast registrfpca_gauss registrbfpca itemt_vectim vector mean codemu evalu resolut specifi set codeindex_significantdigit itemknotscutpoint bspline basi use rebuild codealpha itemefunctionseqnd time npc matrix estim fpc basi function itemevaluesestim varianc fpc score itemevalues_sumsum nonneg eigenvalu smooth covari surfac estim codelinkcov_hal use approxim total varianc present codey comput share explain varianc fpc score itemnpcnumb fpc itemscoreseqni time npc matrix estim fpc score itemalphaestim populationlevel mean itemmuestim populationlevel mean valu codealpha includ compat coderefundshini packag itemsubject_coefsalway codena includ full consist codefpca_gauss codebfpca itemyhatfpc approxim subjectspecif mean appli respons function itemyth observ data itemfamilycodebinomi compat coderefundshini packag itemgamm_thetaestim paramet mix model descript function appli fpca differ exponenti famili distribut use fpca step regist function data call codelinkregister_fpca codefpca_typ twostep cr cr method implement twostep approach gertheiss et al base approach hall et al estim function princip compon cr cr number function princip compon fpc either specifi directli argument codenpc chosen base explain share varianc codenpc_criterion use latter approxim overal varianc data codey varianc repres smooth covari surfac estim codelinkcov_hal note eigenvalu decomposit covari surfac sometim lead long tail subordin fpc small eigenvalu subordin dimens seem often repres phase rather amplitud variat cut specifi second element argument codenpc_criterion cr cr function adapt implement jan gertheiss gertheiss et al focu higher ram effici larg data set detail codefamili poisson valu codey round perform gfpca ensur integ data done ensur reason comput time comput time tend explod estim underli highdimension mix model continu poisson data base codelinkgamm packag neg eigenvalu present respect eigenfunct drop consid exampl datagrowth_incomplet estim fpc fpca_obj gfpca_twostepi growth_incomplet npc famili gaussian plotfpca_obj estim npc adapt explain overal variat fpca_obj gfpca_twostepi growth_incomplet npc_criterion famili gaussian plotfpca_obj plot_fpc refer gertheiss j goldsmith j staicu note model spars exponentialfamili function respons curv emphcomput statist data analysi hall p müller h g yao f model spars gener longitudin observ latent gaussian process emphjourn royal statist societi seri b statist methodolog author alexand bauer emailalexanderbauerstatunimuenchend base work jan gertheiss gener roxygen edit hand pleas edit document rrcppexportsr namelambdaf aliaslambdaf titleappli lambda transform variat paramet usag lambdafx argument itemxth valu appli function valu numer valu transform descript simpl function use within c function gener roxygen edit hand pleas edit document rdatar doctypedata namenhan aliasnhan titlenhan activ data format datafram made describ itemida uniqu subject identifi itemageag survey particip itemgendergend survey particip itemindexobserv time activ measur integ indic minut midnight midnight itemvaluebinari valu zero one indic inact activ itemraw_activityraw activ count usag datanhan descript subset hour activ data subject nation health nutrit examin survey nhane subject observ hour sunday wore activ collect devic minimum hour activ measur minut hour keyworddataset gener roxygen edit hand pleas edit document rgfpca_covhallr namecrossprods_irregular aliascrossprods_irregular titlecrossproduct comput highli irregular grid usag crossprods_irregulari argument itemydatafram center observ valu id center index descript comput crossproduct fast way highli irregular grid index valu mostli uniqu use intern codecov_hal gener roxygen edit hand pleas edit document rconstraintsr nameconstraint aliasconstraint titledefin constraint optim warp function usag constraintskh t_min t_max warp nonparametr argument itemkhnumb bspline basi function use estim warp function emphh itemt_minminimum valu evalu time domain itemt_maxmaximum valu evalu time domain itemwarpingif codenonparametr default invers warp function estim nonparametr codepiecewise_linear follow piecewis linear function knot valu list contain itemuia constraint matrix itemcia constraint vector descript constraint ensur monoton spline coeffici warp function use codeconstroptim function author julia wrobel emailjuliawrobelcuanschutzedu erin mcdonnel emaileimcumccolumbiaedu gener roxygen edit hand pleas edit document rbs_derivr namebs_deriv aliasbs_deriv titlenth deriv spline basi usag bs_deriv x knot degre l boundaryknot rangex deriv intercept true argument itemxa numer vector valu evalu bspline function deriv itemknotsth intern breakpoint defin spline itemdegreedegre piecewis polynomialdefault cubic spline itemboundaryknotsboundari point anchor bspline basi set want domain itemderivativea posit integ valu specifi deriv take default st deriv valu return origin set bspline basi function iteminterceptif true intercept includ basi default true valu matrix contain itembasisa bspline basi use approxim deriv function descript function get deriv spline basi adapt codeb function codesplin packag author julia wrobel emailjuliawrobelcuanschutzedu gener roxygen edit hand pleas edit document rdata_cleanr namedata_clean aliasdata_clean titleconvert data coderefund object usag data_cleandata argument itemdatadatafram valu id valu index valu list contain itemyth origin data sort id index itemy_rowsa datafram contain first last row subject descript function use data clean gener roxygen edit hand pleas edit document rsimulate_unregistered_curvesr nameamp_curv aliasamp_curv titlesimul amplitud varianc usag amp_curvegrid period pi spline_bas fals argument itemgridgrid x valu evalu function itemperiodcontrol period mean curv itemspline_basedif fals curv construct use sine cosin function true curv construct use bspline basi valu numer vector descript function gener amplitud simul acceleromet data gener roxygen edit hand pleas edit document rsimulate_functional_datar namepsi_sim aliaspsi_sim titlesimul pc usag psi_simgrid argument itemgridgrid x valu evalu function descript function gener first princip compon simul function data gener roxygen edit hand pleas edit document rrcppexportsr nameexpectedxi aliasexpectedxi titleestim variat paramet current subject usag expectedxitheta mu mi psi ci argument itemthetasplin basi function current subject itemmuvector spline coeffici popul mean itemmivector expect mean score current subject itempsimatrix spline coeffici princip compon basi function itemciexpect covari matrix score current subject valu vector variat paramet current subject descript function calcul valu variat paramet use maximum likelihood