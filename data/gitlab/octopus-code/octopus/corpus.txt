spglib version badgehttpsanacondaorgatztogospglibbadgesversionsvghttpsanacondaorgatztogospglib download badgehttpsanacondaorgatztogospglibbadgesdownloadssvghttpsanacondaorgatztogospglib pypihttpsimgshieldsiopypidmspglibsvgmaxagehttpspypipythonorgpypispglib build statushttpstravisciorgatztogospglibsvgbranchmasterhttpstravisciorgatztogospglib c librari find handl crystal symmetri compil acloc autohead libtool glibtool macport etc touch instal news readm author automak acf autoconf configur lsize linear size titl code interna weight descript contribut code part web detail implement discuss children depth titl object orient octopu weight motiv sinc version octopu gradual convert fulli object orient code use oop featur fortran main featur oop use octopu encapsul inherit benefit oop design less code duplic better readabl code code closer physic low level aspect hidden object object refer datastructur bundl function method act data usual good practic declar data privat allow access socal access function getter setter call encapsul allow later chang detail implement without affect rest code object instanc class defin data structur method object inherit class hierarchi object orient program allow build complex class inherit structur behaviour class reduc duplic code ensur consist differ class share function expand exampl link list mani class requir function iter list object object howev depend natur specif class diagram see inherit tree code linked_list_t class parent mani special class graphvizfil staticgraph_datalinked_list_tviz expand templat languag like c allow use templat write function algorithm independ data type appli unfortun directli possibl fortran octopu use poorman approach templat use macro includ templat function explicit type replac macro routin usual defin file _inc name creat templat function one either provid explicit interfac fortran interfac my_funct modul procedur dmy_funct zmy_funct end interfac function need call use x macro bodi function usual defin separ file code my_funtion_incf need includ shown fortran includ undeff includ realf includ my_function_incf includ undeff includ complexf includ my_function_incf code my_function_incf would someth like fortran function xmy_functionarg arg resultr r_type intentin arg r_type intentin arg r_type intentout re end function xmy_funct use macro defin includ file expand includerealf fortran include_fil srcincluderealf expand expand includecomplexf fortran include_fil srcincludecomplexf expand expand includeintegerf fortran include_fil srcincludeintegerf expand expand includeundeff fortran include_fil srcincludeundeff expand titl abstract hamiltonian class weight descript contribut code abstract class contain real data comput term rather defin abstract interfac inherit specif hamiltonian class inform common system whether hamiltonian hermitian variabl describ spectral rang fortran include_type_def hamiltonian_abst_t abstract class special variou system graphvizfil staticgraph_datahamiltonian_abst_tviz titl hamiltonian weight descript contribut code notic warn work progress notic grid octopu introduct fundament element octopu real space grid quantiti wafe function densiti potenti defin gener grid consist mesh simul box mesh base regular mesh _d_ dimens distort use socal curvilinear coordin underli intern structur mesh integ coordin import map array map index _d_ integ coordin map integ coordin index grid construct sever step gener regular mesh fill rectangular volum enclos simul box select inner point enlarg point ghost point reorder point regener map array titl electron hamiltonian class weight descript contribut code electron hamiltonian deriv abstract hamiltonian expand definit hamiltonian_elec_t fortran include_type_def hamiltonian_elec_t expand contain physic quantiti inform dimension contribut potenti pointer ion electron mass etc instanc code hamiltonian_elec_base_t bundl lower level variabl separ quantiti two class mostli histor current deeper systemat expand definit hamiltonian_elec_base_t fortran include_type_def hamiltonian_elec_base_t expand method applic hamiltonian implement wrapper routin check compat suppli wave function call batch version routin expand appli hamiltonian wrapper fortran include_subroutin xhamiltonian_elec_appli expand batch routin take care actual applic variou term hamiltonian differ term appli select use option code term argument expand appli hamiltonian batch fortran include_subroutin xhamiltonian_elec_apply_batch expand notic note hamiltonian allow modifi wave function reason also initi state code psib code intentinout hamiltonian pack wave function request notic titl startup weight gener startup procedur octopu code flow chart calcul mani step common relat set basic data structur code main program perform task independ actual calcul physic system mainmainfhttpsgitlabcomoctopuscodeoctopusblobdevelopsrcmainmainf strongli simplifi way fortran program main constructor start code compon call global_init initi mpi clock etc call parser_init initi input parser call messages_init initi messag system call walltimer_init initi timer modul call io_init initi io subsystem call calc_mode_par_init initi parallel strategi call profiling_init initi start profil system call runinp_calc_mod pass control actual code run calcul destructor stop code compon revers order call profiling_end call calc_mode_par_end call io_end call walltimer_end call messages_end call parser_end call global_end end programm actual calcul start routin run initi data structur repres actual system calcul mode start correspond calcul mainrunfhttpsgitlabcomoctopuscodeoctopusblobdevelopsrcmainrunf defin modul run_oct_m modul contain data apart constant expand definit run fortran include_subroutin run expand scfground_statef fortran include_subroutin ground_state_run fortran include_subroutin ground_state_run_legaci fortran include_subroutin electrons_ground_state_run titl main routin weight titl state weight descript contribut code notic warn work progress notic children depth titl wave function weight notic warn work progress notic wavefunct octopu wave function octopu refer state handl modul states_abst_oct_m defin statesstates_abstfhttpsgitlabcomoctopuscodeoctopusblobdevelopsrcstatesstates_abstf exact way state store memori flexibl depend optim acceler set input file particular order indic depend pack set state store hierarchi contain concept hierarchi includ _groups_ _batches_ _blocks_ abstract class top level data structur describ state fortran include_type_def states_abst_t structur contain mainli metadata state describ _how_ state repres defin interfac class abstract class contain inform actual system state class electron class code states_elec_t special abstract class contain data specif electron system well pointer quantiti common state densiti current etc expand definit states_elec_t fortran include_type_def states_elec_t expand dimens object contain number variabl relev discuss dim variabl denot dimens one state spinless state spinor fortran include_type_def states_elec_dim_t wave function store fortran typestates_elec_group_t group turn defin modul states_elec_group_oct_m srcstatesstates_elec_groupfhttpsgitlabcomoctopuscodeoctopusblobdevelopsrcstatesstates_elec_groupf group contain wave function group togeth block batch organis array batch_t structur fortran include_type_def states_elec_group_t fortran typewfs_elec_t pointer psib set wavefunct index follow psibibiqb ib block index iqn kpoint see routin states_init_blockst mesh verbos creat group object given node wave function local block avail group object contain inform batch distribut node fortran include_type_def wfs_elec_t creat wave function number step initi states_t object call system_init routin states_init pars statesrel input variabl alloc memori book keep variabl alloc memori state states_distribute_nod states_density_init alloc memori densiti rho core densiti rho_cor states_exec_init fill block size stdblock_siz find whether pack state stdpack_stat find orthogon method stdorth_method memori actual wave function alloc states_elec_allocate_wfn call correspond _run routin scf_run td_run etc fortran include_subroutin states_elec_allocate_wfn routin states_init_block initi data compon st describ state distribut block stnblock number block state divid note number total number block regardless mani actual store node block_start node index first block block_end node index last block state parallel block_start block_end stnblock stiblockstnst stdnik point state block contain stblock_is_loc stblock_is_localib true block ib store run node stblock_rangestnblock block ib contain state fromn stblock_rangeib stblock_rangeib stblock_sizestnblock block ib contain number stblock_sizeib state stblock_initi fals entri true exit routin set batch stpsibstnblock contain block fortran include_subroutin states_elec_init_block alloc memori actual wave function perform batch_init_empti xbatch_alloc routin relat xbatch_add_st show clearli differ memori block relat batch_init_emptyhttpsgitlabcomoctopuscodeoctopusblobdevelopsrcgridbatchf alloc memori batch_state_t state batch_states_l_t states_linear _nullifies_ pointer within type note memori actual wave function alloc yet fortran include_subroutin batch_init_empti question differ object point state relat usual storag state states_linear shadow pack case pack state use differ batch_add_st batch_add_state_linear titl batch weight mani situat need perform oper mani mesh function electron wave function therefor advantag group function one object ensur differ mesh function contigu memori due natur stencil oper constitut larg part low level oper mesh function often effici perform stencil oper differ mesh function ie use state index fast index loop first mesh index would gener requir differ stencil mesh point particular case calcul util gpu therefor store mesh function linear socal pack form former refer natur order mesh index fastest move latter transpos abstract class code batch_t parent class batch electron versionedlink developerscode_documentationstatesst wave function expand definit batch_t fortran include_type_def batch_t expand class includ inform dimens function number state spatial dimens number mesh point also intern bookkeep variabl keep track statu batch furthermor code batch_t data type contain pointer actual data array defin method interact batch empti batch initi expand initi empti batch fortran include_subroutin xbatch_init expand expand initi batch memori fortran include_subroutin xbatch_init_with_memory_ fortran include_subroutin xbatch_init_with_memory_ fortran include_subroutin xbatch_init_with_memory_ expand graphvizfil staticgraph_databatch_tviz expand definit wfs_elec_t fortran include_type_def wfs_elec_t expand titl mesh oper weight access function function eg densiti given array rho_i__spin_ _i_ rang mesh point associ given domain see domain decomposit repres rho rsub_i_sub _spin_ mesh_x_globalmesh ip mesh_x_globalmesh ip return float vector correspond coordin point ip global mesh fortran include_funct mesh_x_glob integr integr implement straightforward summat fortran ip meshnp dd dd ffip end differenti take deriv done finit differ point involv deriv defin stencil see deriv discuss separ document derivativesmdderiv note pack state note curvilinear mesh meshx array alway contain regular mesh get distord curvilinear mesh addit function call domain decomposit see domain_decompositionmddomain_decompositionmd titl coordin system weight fortran include_type_def coordinate_system_t titl mesh setup weight set grid particular first stage set deriv doublegrid call stage mesh_init stage still unawar parallel domain decomposit expand fortran include_subroutin grid_init_stage_ expand second stage expand fortran include_subroutin grid_init_stage_ expand mesh initi first stage set mesh_tidx index structur defin lower upper bound expand fortran include_subroutin mesh_init_stage_ expand second stage expand fortran include_subroutin mesh_init_stage_ expand third stage final gener list mesh point mesh_tx stage domain decomposit consid x contain domain local point expand fortran run parallel domain stencil np_stencil need comput ghost point mpi_grp commun group use mesh include_subroutin mesh_init_stage_ expand serial mesh choic spacefil curv method titl mesh implement weight data structur expand definit basis_set_abst_t fortran include_type_def basis_set_abst_t expand graphvizfil staticgraph_databasis_set_abst_tviz mesh descriptor defin gridmeshf fortran include_type_def mesh_t use structur index_t contain rang map array fortran include_type_def index_t lxyz lxyz_inv map direct map lxyz_d_ _i_ rsup_d_supsub_i_sub _d_ denot dimens ie x z _i_ index point invers map lxyz_inv rsupxsupsub_i_sub rsupysupsub_i_sub rsupzsupsub_i_sub _i_ point defin lxyz defin rectangular box _d_ dimens real mesh vector relat rsub_i_sub multipl space possibl distort curvilinear coordin note index array parallel domain relat integ coordin global index given point fortran include_type_def mesh_cube_map_t note pack state note curvilinear mesh meshx array alway contain regular mesh get distord curvilinear mesh addit function call domain decomposit titl grid weight notic warn work progress notic grid octopu introduct fundament element octopu real space grid quantiti wave function densiti potenti defin gener grid consist mesh simul box mesh base regular mesh _d_ dimens distort use socal curvilinear coordin underli intern structur mesh integ coordin import map array map index _d_ integ coordin map integ coordin index grid construct sever step gener regular mesh fill rectangular volum enclos simul box select inner point enlarg point ghost point reorder point regener map array top level data structur describ grid defin gridgridf fortran include_type_def grid_t children depth titl simul box weight simul box defin class fortran include_type_def simul_box_t deriv develop code_documentationionsbox box_t main function simul box code simul_box_contains_point determin set point whether insid outsid simul box expand definit simul_box_contains_point fortran include_funct simul_box_contains_point expand titl deriv weight octopu use finit differ evalu deriv laplacian kinet energi deriv point mesh weight sum neighbor point instanc gener form laplacian nablafn_xhn_yh sum_insum_jnfracc_ijhfn_xh ihn_yhjh coeffici c_ij depend mesh number point use defin emph stencil deriv object contain oper gradient laplacian well inform order stencil type inform boundari fortran include_type_def derivatives_t deriv oper repres nonloc oper fortran include_type_def nl_operator_t fortran include_type_def stencil_t fortran include_type_def stargeneral_arms_t titl selfconsist cycl weight expand definit scf_t fortran include_type_def scf_t expand expand definit scf_run fortran include_subroutin scf_run expand titl electron weight descript contribut code titl system octopu weight notic warn work progress notic develop code_documentationmultisystem_framework multisystem framework allow defin coupl differ physic system follow diagram repres famili tree system class round box denot abstract class rectangular box normal class instanti graphvizfil staticgraph_datainteraction_partner_tviz abstract class code interaction_partner_t interaction_partn octopu anyth interact system instanc electron ion interact partner also photon system describ maxwel system extern potenti therefor base class possibl system multisystem expand definit interaction_partner_t fortran include_type_def interaction_partner_t expand name interaction_partn associ name namespac own name clock well list develop code_documentationmultisystemsinteract interact partner list physic quantiti expos system interact see develop code_documentationmultisystemsquant list possibl quantiti also provid basic function updat expos quantiti copi interact detail mechan describ section develop code_documentationmultisystemsinteract interact code system_t code system_t type abstract type system possibl system potenti partner interact code system_t type extend abstract code interaction_partner_t type expand definit system_t fortran include_type_def system_t expand code system_t class add inform physic space system exist propag list interact own system check section develop code_documentationmultisystemsinteract interact detail own interact code multisystem_t code multisystem_t final add list system type definiet expand definit multisystem_t fortran include_type_def multisystem_t expand notic note code multisystem_t abstract class use describ set system code code type use combin system code multisystem_basic_t extend code multisystem_t notic specif class children depth current follow system type defin fortran include_code_doc system_typ notic note use system type alway use paramet numer valu might chang time notic titl multisystem contain weight introduct octopu possibl group sever system contain implement code multisystem_basic_t class contain differ purpos applic simplest case contain simpli collect system interact anyth els case contain introduc differ physic approxim simpli help bookkeep problem notic note contain correspond given region space select system mani case system might confin certain region space properti contain mani case eg combin matter maxwel field system occupi space substanti overlap notic anoth use case might group system contain interact whole contain instead individu system howev approxim furthermor least moment limit due implement notic warn note contain move consequ definit energi contribut particular contain kinet energi kinet energi contribut constitu account intern energi inform see versionedlink developerscode_documentationmultisystem_frameworkenergi calcul energi notic implement function implement level abstract class code multisystem_t expand definit multisystem_t fortran include_type_def multisystem_t expand specif code multisystem_basic_t class add final expand definit multisystem_basic_t fortran include_type_def multisystem_basic_t expand titl system electron weight notic warn code electron_t current process refactor end class shall describ electron alon interact ion extern field etc interact also electronelectron interact describ accord variou theori level see variabl theorylevel implement socal intrainteract notic expand definit electrons_t fortran include_type_def electrons_t expand expand definit constructor fortran include_funct electrons_constructor expand titl abstract box class weight fortran include_type_def box_t graphvizfil staticgraph_databox_tviz titl ion weight descript contribut code children depth titl propag class weight notic warn work progress notic propag class expand definit propagator_t fortran include_type_def propagator_t expand type code propagator_t extens code algorithm_t therefor contain list oper defin propag element propag algorithm defin develop code_documentationmultisystemsalgorithmsalgorithmicoper algorithm oper complet propag algorithm defin ad step algorithm propag see exampl notic note note level progat independ actual implement step implement within system propag appli notic defin follow oper fortran include_code_doc general_propagation_oper oper gener bound specif propag specif system therefor implement code system_t class discuss see section develop code_documentationmultisystemstime_propag time propag class procedur code propagator_t handl intern state propag specif propag defin class extend code propagator_t necessari specif algorithm step defin scope modul file contain extend class exampl develop code_documentationpropagatorsverlet verlet algorithm develop code_documentationpropagatorsbeeman beeman algorithm develop code_documentationpropagatorsexp_mid exponenti midpoint algorithm expand placement class hierarchi graphvizfil staticgraph_datalinked_list_tviz expand titl propag weight descript contribut code notic warn work progress notic propag implement state machinehttpsenwikipediaorgwikifinitestate_machin everi iter step main tdloop develop code_documentationmultisystemstime_propag see time propag propag progress one algorithm step develop code_documentationpropagatorspropagator_class descript propag class develop code_documentationpropagatorsalgorithm descript algorithm class exampl develop code_documentationpropagatorsverlet verlet algorithm detail implement propag develop code_documentationpropagatorsbeeman beeman algorithm exampl predictorcorrector propag develop code_documentationpropagatorsexp_mid exponenti midpoint algorithm titl algorithm weight notic warn work progress notic octopu mani oper time propag geometri optim etc implement term algorithm algorithm gener contain set instruct perform welldefin order algorithm contain code algorithm_t class extent develop miscellanealinked_list link list expand definit algorithm_t fortran include_type_def algorithm_t expand algorithm operationsalgorithmicoper ad function code add_oper exampl discuss section develop code_documentationpropag propag expand placement class hierarchi graphvizfil staticgraph_datalinked_list_tviz expand algorithm iter expand definit algorithm_iterator_t fortran include_type_def algorithm_iterator_t expand algorithm oper expand definit algorithmic_operation_t fortran include_type_def algorithmic_operation_t expand global algorithm step defin sourc multisystempropagatorf fortran include_code_doc general_propagation_oper deriv propag add step eg sourc multisystempropagator_verletf fortran include_code_doc verlet_propagation_oper notic note import stress one algorithm step gener advanc clock clock advanc step updat correspond entiti could system expos quantiti interact therefor quit common specif state algorithm clock differ entiti differ valu expand titl exponenti midpoint weight exponenti midpoint propag need defin follow oper fortran include_code_doc exp_mid_propagation_oper use defin algorithm done constructor propag fortran include_funct propagator_exp_mid_constructor timelin explain dsequenc filegraph_datapropagationexpmidbodyequaljson viewcontainersy viewghostsy graph illustr state machin step algorithm system pick next algorithm step propag contain ie root earth step updat interact finish emph real system hand progress orderli oper defin propag titl static propag weight static propag dummi propag propag system implement oper updat interact necessari multisystem calcul system propag real propag fortran include_type_def propagator_static_t use defin algorithm done constructor propag fortran include_funct propagator_static_constructor titl detail exampl verlet weight notic warn work progress notic verlet algorithm accord wikipediahttpsenwikipediaorgwikiverlet_integr verlet algorithm defin calcul vecxt delta vecxt vecvt delta tfrac vecat delta deriv vecat delta interact potenti use vecxt delta calcul vecvt delta vecvt tfrac bigvecat vecat delta tbigdelta verlet oper repres type code propagator_verlet_t extend code propagator_t expand definit propagator_verlet_t fortran include_type_def propagator_verlet_t expand notic note note class definit add anyth code propagator_t class differ definit oper overload constructor notic verlet propag need defin follow oper fortran include_code_doc verlet_propagation_oper use defin algorithm done constructor propag fortran include_funct propagator_verlet_constructor algorithm also use step specif verlet algorithm defin code propagator_oct_m modul notic note note differ code op_verlet_finish code op_finish former denot specif step taken end one time step latter gener denot end time step notic seen exampl definit propag term algorithm oper direct translat algorithm shown implement step far propag defin abstract way individu system better programm implement individu step algorithm term dynam variabl system easi examampl demonstr classic particl implement code classical_particles_t expand definit classical_particles_t fortran include_type_def classical_particles_t expand describ extrem simpl system consist set classic neutral particl dynam variabl ie state system posit veloc acceler one tick propag defin function code classical_particle_do_td seen code function implement possibl algorithm step propag allow system expand exampl implement classic particl fortran include_subroutin classical_particles_do_td expand timelin explain verlet algorithm good simpl exampl illustr system interact updat code progress main loop dsequenc filegraph_datapropagationbodyverletequalstepjson viewcontainersy viewghostsy graph illustr state machin step algorithm system pick next algorithm step propag contain ie root earth step updat interact finish emph real system hand progress orderli oper defin propag br expand exampl differ time step exampl show propag solar system differ time step use three system dsequenc filegraph_datapropagationbodyverletdifferentstepjson viewcontainersy viewghostsy contrast previou exampl see slowest system ie sun wait updat interact mani comput step need wait system complet time step wait step comput cheap grid oper perform expand titl custom diagram weight page allow custom propag diagram arbitrari time propag run gener requir input file current special branch octopu need compil run later function includ main branch need checkout multisystem_debug branch octopusgit repositori order enabl output need set codeblock variabl debug propagation_graph codeblock notic note pleas keep mind lot output produc lower number time step minimum complet step subsystem notic use button navig file multisystem_propagationlog calcul dsequenc fileload viewcontainersy viewghostsy titl beeman weight beeman algorithmhttpsenwikipediaorgwikibeemans_algorithm one simplest allow predictorcorrector implement demonstr algorithm includ selfconsist loop within one propag timestep selfcontist predictorcorrector featur implement option beeman propag need defin follow oper fortran include_code_doc beeman_propagation_oper use defin algorithm done constructor propag fortran include_funct propagator_beeman_constructor timelin explain dsequenc filegraph_datapropagationbeemanbodyequaljson viewcontainersy viewghostsy graph illustr state machin step algorithm system pick next algorithm step propag contain ie root earth step updat interact finish emph real system hand progress orderli oper defin propag expand exampl differ time step exampl show propag solar system differ time step use three system dsequenc filegraph_datapropagationbeemanbodydifferentjson viewcontainersy viewghostsy expand titl multisystem framework weight notic warn work progress notic support multisystem octopu implement objectori framework current two major mode implement legaci mode allow one matter system consist electron ion extern field new multisystem framework allow sever coupl system eg maxwel charg particl etc time write feb electron ion yet avail separ system legaci mode legaci mode code use whenev input file _not_ variabl system block case top level system initi old code electrons_t type type describ combin electronion system plan te futur split new code electrons_t code ions_t descib electron ion separ system current code electrons_t replac code matter_t multisystem contain electron ion multisystem mode input file contain variabl system block code use new multisystem mode multisystem mode user perspect highest level system multisystem multisystem contain host system type includ multisystem code perspect code multisystem_t type special case code system_t type ie emph extend code system_t follow chapter discuss detail multisystem classessystem_class interactionsinteract expos quantitiesquant clocksclock initializationiniti time propagationtime_propag titl initi weight construct system multisystem framework import detail variou compon initi top level system creat sourc mainrunf call code multisystem_basic_t constructor expand definit multisystem_basic_constructor fortran include_funct multisystem_basic_constructor expand call code multisystem_basic_init code multisystem_init expand definit multisystem_basic_init fortran include_subroutin multisystem_basic_init fortran include_subroutin multisystem_init expand final code multisystem_create_system loop subsystem call system factori creat expand definit multisystem_create_system fortran include_subroutin multisystem_create_system expand initi propag propag system initi code time_dependent_run_multisystem call code systemsinit_propag code time_dependent_run_multisystem call code system type code multisystem_basic_t translat call code multisystem_init_propag expand definit multisystem_init_propag fortran include_subroutin multisystem_init_propag expand routin pars input propag type creat propag given type use respect constructor code multisystem_init_propag loop subsystem call code systempropagator_init gener ie function overload deriv class system use function code system_propagator_init expand definit system_init_propag fortran include_subroutin system_init_propag expand code system_propagator_init pars input file look variabl variabl tdsystempropag import rememb order parser treat namespac system specifi input file text system system_a type_a system_b type b toplevel multisystem intern call code total three namespac text system_a system_b code systempropagator_init routin code system_a code system_b first look whether variabl tdsystempropag defin respect namespac _not_ case look variabl parent namespac global namespac code notic warn code allow specifi differ propag multisystem subsystem _might_ work subsystem _not_ interact like fail interact system therefor highli recommend specifi propag subsystem separ unless one know exactli one notic titl time propag weight notic warn work progress notic new multisystem framework time propag handl routin code time_dependent_run_multisystem main loop expand implement time_dependent_run_multisystem fortran include_subroutin time_dependent_run_multisystem expand code quit selfexplanatori central part time propag code loop see code full td loop function code systemdt_oper call success trigger one algorithm step multisystem propag notic note propag gener need sever call finish one time step propag notic notic info top level one system gener call code type code multisystem_basic_t contain system subsystem subsystem multisystem notic updat system multisystem framework highest level system type code multisystem_basic_t inherit code dt_oper routin abstract code multisystem_t type expand implement multisystem_dt_oper fortran include_subroutin multisystem_dt_oper expand routin first call gener code system_dt_oper subroutin parent class code system_t loop subsystem part multisystem call specif code systemdt_oper routin gener code system_dt_oper subroutin handl gener algorithm oper start end scf loop updat interact expand implement system_dt_oper fortran include_subroutin system_dt_oper expand routin fetch next oper propag execut follow oper implement code update_intreract increment propagatorclock one tick interact updat tri updat interact might alway possibl interact partner still lag behind interact updat succes progress propag next step code finish increment systemclock one tick rewind propag code start_scf_loop code end_scf_loop handl selfconsist converg predictorcorrector algorithm clock updat remain oper pass system specif routin code systemdo_dt_oper place specif system need implement algorithm step requir propag allow system notic note multisystem multisystem well subsystem propag accord _own_ propag principl could differ could lead unexpect behaviour propag subsystem specifi explicit input file inherit automat propag parent multisystem therefor specifi individu multisystem contain alway use empti propag implement oper code op_update_interact code op_finish code multisystem_t object code do_td_oper routin implement code skip oper notic routin trigger updat interact via call code systemupdate_inter loop interact associ system requir expos quantiti updat interact system ie multisystem subsystem attempt updat interact code systemupdate_interact expand implement systemupdate_inter fortran include_funct system_update_interact expand first part make sure code update_interactions_start routin call interact updat yet time step iue clock behind system clock notic note assum interact never ahead time compar propag therefor suffici ask whether interact time equal propag time determin whether interact uptod notic second part actual attempt updat interact need interact uptod first need ensur quantiti interact depend uptod quantiti updat code updat routin interact call current propag time argument final interact updat success step code update_interactions_finish necessari system expand implement interaction_with_partner_upd fortran include_funct interaction_with_partner_upd expand function call specif code requested_tim time interact need function first tri updat expos quantiti partner successful function call code calcul routin interact set interact clock request time return result code true indic success updat case function block one expos quantiti interact calcul function return code fals seen possibl interact updat given time case interact also depend quantiti interact partner partner yet request time expand definit system_update_exposed_quant fortran include_funct system_update_exposed_quant expand routin demand comment firstli routin allow interact type code interaction_with_partner_t otherwis partner updat expos quantiti import rememb call function quantiti suppos updat code system_update_exposed_quant call code implement interaction_with_partner_upd interact system interact partner system respect given interact follow situat routin allowd updat expos quantiti intern scf loop propag step one quantiti updat becuas either far behind time two far one clock tick one clock tick behind user request code option__interactiontiming__timing_exact case routin return code fals propag continu system question held step system howev continu progress might abl get time quantiti updat time condit fulfil intern scf loop system call specif routin updat expos quantiti copi valu interact deadlock avoid titl clock weight notic warn work progress notic clock essenti keep thing synchron also case octopu instanc code clock_t type use ensur differ system stay sync time propag clock use determin whether quantiti interact need updat propag step smallest unit time octopu one code tick expand definit clock_t fortran include_type_def clock_t expand titl expos quantiti weight notic warn work progress notic system expos quantiti use calcul interact system quantiti dynam variabl system quantiti usual updat propag algorithm calcul ondemand quantiti must mark protect modul sourc multisystemquantityf quantityf defin paramet act index expos quantiti within system fortran include_code_doc quantiti system base class code interaction_partner_t own array type code quantity_t fortran include_type_def quantity_t determin whether quaniti requir given system also associ specif clock quantiti notic info protect quantiti deserv extra mention protect quantiti updat propag step system need updat explicit code update_exposed_quant notic titl interact section develop weight notic warn work progress notic introduct physic interact gener symmetr howev magnitud affect interact partner differ also way interact implement differ depend direct interact therefor octopu interact broken forward backward part treat seper graphviz digraph partner partner b label forward partner b partner label backward graphviz see approxim one usual forward interact use partner instanc code interaction_partner_t deriv type interact unidirect implement deriv type abstract code interaction_t class graphviz digraph partner partner b label interact graphviz interact belong partner act partner b abstract class code interaction_t expand definit interaction_t fortran include_type_def interaction_t expand minim data structur interact contain inform relat partner own interacion particular interact list quantiti partner need expos interact calcul id expos quantiti defin section develop code_documentationmultisystemsquant expos quantiti furthermor abstract type alreadi contain clock interact defin interfac defer code updat code calcul routin graphvizfil staticgraph_datainteraction_tviz code interaction_with_partner_t curretli interact deriv code interaction_with_partner_t extend code interaction_t add inform partner b call partner expand definit interaction_with_partner_t fortran include_type_def interaction_with_partner_t expand type add pointer interact partner list id quantiti partner expos interact furthermor level implement code updat procedur abstract children code force_interaction_t next level special interact interact creat forc partner add actual forc vector act partner system expand definit force_interaction_t fortran include_type_def force_interaction_t expand code potential_interaction_t next level special interact interact creat potenti partner expand definit potential_interaction_t fortran include_type_def potential_interaction_t expand code density_interaction_t next level special interact interact creat potenti partner expand definit density_interaction_t fortran include_type_def density_interaction_t expand br specif class specif interact class extend abstract one import element add abstract class inform quantiti requir calcul interact case system own interact system suffici keep pointer data store system thr reason interact alway updat propag system partner system system b howev interact keep copi expos quantiti allow partner system continu propag beyond time quantiti request might happen two system use differ time step ghost interact expand definit ghost_interaction_t fortran include_type_def ghost_interaction_t expand graviti expand definit gravity_t fortran include_type_def gravity_t expand coulomb forc expand definit coulomb_force_t fortran include_type_def coulomb_force_t expand lorentz forc expand definit lorentz_force_t fortran include_type_def lorentz_force_t expand interact factori instanc code interaction_t deriv type like system gener use versionedlink developerscode_documentationmultisystemsfactoriesinteractionfactori factori current follow interact type defin fortran include_code_doc interaction_typ notic note use system type alway use paramet numer valu might chang time notic graphvizfil staticgraph_datainteraction_graphdot titl calcul energi weight multisysten framework total energi code total_energi calcul consist variou contribut follow standard definit thermodynam see herehttpsenwikipediaorgwikiinternal_energi kinet energi code kinetic_energi intern energi code internal_energi potenti energi code potential_energi kinet energi use term kinet energi usual sens slight except contain system notic note ideal contain kinet energi kinet energi respect centr mass contain kinet energi constitu rel centr mass frame account part intern energi contain notic expand multisystem_update_kinetic_energi fortran include_subroutin multisystem_update_kinetic_energi expand specif system need specif routin calcul kinet energi notic note maxwel system socal electromagnet energi notic interact energi everyth els treat interact energi distinguish interact two differ system type interact system intrainteract interinteract interact two differ system requir thought definit physic selfinteract occur method calcul interact part interact class independ actual system implement level classcod system_t expand system_update_potential_energi fortran include_subroutin system_update_potential_energi expand except contain need loop constitu order distinguish inter intrainteract need queri interact interact partner skip interact partner part contain expand multisystem_update_potential_energi fortran include_subroutin multisystem_update_potential_energi expand intrainteract system may contain one physic particl eg electron set ion contain system order account interact particl particl system decid treat case system interact call intrainteract case singl particl intra interact zero case mani particl interact calcul cours interact one particl remov least approxim anoth import aspect implement octopu deal _onesided_ interact implic doubl count calcul interact energi contribut count system add energi system field partner expand system_update_internal_energi fortran include_subroutin system_update_internal_energi expand notic note contain mean interact energi contain complet interact energi subsystem contain _plus_ energi subsystem field system part contain notic notic warn note internal_energi contain _not_ sum self_energi constitu also extern energi contain _not_ sum extern energi constitu notic expand multisystem_update_internal_energi fortran include_subroutin multisystem_update_internal_energi expand total energi total energi whole simul top level contain clearli defin contain sum intern interact energi specif system eg electron total energi also sum intern energi interact energi includ intra interact energi expand system_update_total_energi fortran include_subroutin system_update_total_energi expand notic warn total energi interact energi depend state system therefor use converg criteria given system intern energi safe use notic titl factori weight octopu use socal factori patternhttpsenwikipediaorgwikifactory_method_pattern creat instanc system interact class abstract factori class introduc avoid problem circular depend function factori creat object dynam given type return pointer done call respect constructor class instanc creat system factori fortran include_type_def system_factory_abst_t graphvizfil staticgraph_datasystem_factory_abst_tviz fortran include_type_def system_factory_t expand definit system_factory_cr fortran include_funct system_factory_cr expand interact factori fortran include_type_def interactions_factory_abst_t graphvizfil staticgraph_datainteractions_factory_abst_tviz fortran include_type_def interactions_factory_t expand definit interactions_factory_abst_create_interact fortran include_subroutin interactions_factory_abst_create_interact expand expand definit interactions_factory_cr fortran include_funct interactions_factory_cr expand titl miscellanea weight descript contribut code children depth titl link list weight code linked_list_t type implement link list unlimit polymorph valu allow storag type data expand definit linked_list_t fortran include_type_def linked_list_t expand data store code list_node_t type object expand definit list_node_t fortran include_type_def list_node_t notic note code class pointer valu null allow storag pointer emph data type notic expand iter list done use associ iter expand definit linked_list_iterator_t fortran include_type_def linked_list_iterator_t expand class meant use rather extend provid add method list get_next method iter graphvizfil staticgraph_datalinked_list_tviz also code linked_list_iterator_t parent number special iter variou system graphvizfil staticgraph_datalinked_list_iterator_tviz titl eigensolv weight notic warn work progress notic titl eigensolv weight fortran include_type_def eigensolver_t fortran include_subroutin eigensolver_run titl graphic user interfac seri manual weight hidden true draft true titl octopu seri manual weight octopu softwar packag name densityfunct theori dft name timedepend densiti function theori tddft develop main develop team program compos joseba alberdi xavien andrad heiko appel florian buchholz alberto castro tilman dannert umberto de giovannini alain delgado nicol helbig hann hueben joaquim jornetsomoza ask larsen irina lebedeva martin luumlder miguel l marqu fernando nogueira micael oliveira carlo andrea rozzi angel rubio ravindra shind jose r f sousa david strubb iri theophil alejandro vara matthieu verstraet philipp wopper former develop fulvio berardi johanna fuk david kammerland kevin krieger florian lorenzen danilo nitsch roberto olivaresamaya arto sakko axel thimm jessica walkenhorst jan werschnik contributor sebastien hamel parallel version octexcit eugen kadantsev linear respons code introduct octopu pseudopotenti realspac packag aim simul electronion dynam one two threedimension ﬁnite system subject timedepend electromagnet ﬁeld program base timedepend densityfunct theori tddft kohnsham scheme quantiti expand regular mesh real space simul perform real time program success use calcul linear nonlinear absorpt spectra harmon spectra laser induc fragment etc varieti system fundament dft tddft found eg book footnot andfootnot inform octopu packag found homepag octopusweb articl footnot footnot main advantag realspac method simplic intuit whole procedur first quantiti like densiti wavefunct simpl visual real space furthermor method fairli simpl implement numer dimension system varieti differ boundari condit exampl one studi finit system molecul cluster without need supercel simpli impos wavefunct zero surfac far enough system way infinit system polym surfac bulk materi studi impos appropri cyclic boundari condit note also realspac method one converg paramet name gridspac decreas grid space alway improv result unfortun realspac method suffer drawback exampl realspac implement variat ie may find total energi lower true energi reduc gridspac energi actual increas moreov grid break translat symmetri also break symmetri system may possess lead artifici lift degeneraci appear spuriou peak spectra etc cours problem minim reduc gridspac histori octopu base fixednucleu code written georg f bertsch k yabana perform realtim dynam cluster footnot condens matter realspac planewav base code written rubio x blase sg louie footnot code afterward extend handl period system gf bertsch ji iwata rubio k yabana footnot contemporan major rewrit origin cluster code handl vast major finit system point cluster code name name tddft version consequ enhanc beautifi castro time phd student rubio origin fairli verbos line name fortran year marqu aka hyllio aka antónio de faria corsário portuguê join rubio group valladolid postdoc use name tddft work petul enough think could structur code better predecessor start major rewrit code togeth castro finish version name tddft thing still perfect due limit experi name fortran due inadequaci languag anyth beyond name hello world program sever part code still clumsi also idea gpling almost line aros alcohol even sever week frantic code get rid name numer recip code still linger around octopu born present releas version complet rewritten keep littl relat old version even input output file enhanc major new flag perform variou excitedst dynam finit extend system code updat frequent new version found find code use research would appreci give refer work previou one contribut octopu free time feel like take joy ride name fortran drop us email also send us patch comment idea wish etc includ new releas octopu found bug pleas report bug track system octopusbug octopu copi condit program free mean everyon free use free redistribut free basi allow tri prevent other share version program might get specif want make sure right give away copi program receiv sourc code els get want chang program use piec new free program know thing make sure everyon right forbid depriv anyon els right exampl distribut copi program must give recipi right must make sure receiv get sourc code must tell right also protect must make certain everyon find warranti program program modifi someon els pass want recipi know distribut problem introduc other reflect reput precis condit licens found gener public licens accompani pleas note octopu distribut normal come extern librari cover gpl licens pleas see manual appendixcopi copi appendix copi condit packag footnot book titlea primer densiti function theori authorc fiolhai f nogueira mal marqu editor publisherspring berlin heidelberg new york isbn serieslectur note physic year issn footnot book titletimedepend densiti function theori authorm l marqu c ullrich f nogueira rubio k burk e k u gross editor publisherspring berlin heidelberg new york isbn serieslectur note physic year issn footnot articl titleoctopu first principl tool excit state electronion dynam authorsm marqu castro g f bertsch rubio journalcomp phi comm volum page year footnot articl titleoctopu tool applic timedepend densiti function theori authorsa castro h appel oliveira c rozzi x andrad f lorenzen mal marqu e k u gross rubio journalphi stat sol b volum page year footnot articl authorsgf bertsch k yabana titletimedepend localdens approxim real time journalphi rev b volum page year footnot articl authorsa rubio x blase sg louie titleab initio photoabsorpt spectra structur small semiconductor metal cluster journalphi rev lett volum page year footnot articl authorsgf bertsch ji iwata rubio k yabana titlerealspac realtim method dielectr function journalphi rev b volum page year manualfoot prev nextinstal titl instal seri manual weight mayb somebodi els instal octopu case file directori call inst_fil execut inst_fil bin eg inst_fil file usrloc main octopu execut file usrlocalbinoctopu pseudopotenti file octopu need inst_fil shareoctopuspp etc howev may unlucki case follow tri help still rather unfriendli task compil instal octopu instruct specif architectur see manual installationspecif architectur stepbystep_instruct specif supercomput gener configur includ ubuntu mac osx system use list easiest way instal add entri supercomput gener configur success built code download download latest octopu version octopusdownload current binari distribut binari want instal octopu name debian base name linux box name debian name ubuntu might need compil releas binari packag platform keep mind packag intend run differ system therefor moder optim issu compil packag appropri compil flag librari see download appropri file deb file octopusdownload instal use root access command use appropri filenam download commandlin dpkg octopus_packagedeb nowikinowiki sourc code differ system mention want compil octopu need get sourc code file file targz file follow compil instruct build quick instruct impati quickstart commandlin tar xzf octopu octopus_vers targz commandlin cd octopu octopus_vers commandlin configur commandlin make commandlin make instal bash tar xzf octopu octopusvers targz cd octopu octopusvers configur make make instal probabl emph work give read follow paragraph slow instruct manual installationbuild scratch appendix detail instruct compil octopu requir librari scratch need unabl instal packag manag use perbuilt librari long instruct code written standard name fortran routin written name c name bison count input parser build need name c compil name gcc work fine avail almost everi piec silicon name fortran compil check manual installationporting_octopus_and_platform_specific_instruct compil appendix compil octopu test appendix also contain hint potenti problem certain platformcompil combin fix requir besid compil also need name make comput instal otherwis grab instal name gnu make name cpp name c preprocessor heavili use octopu preprocess name fortran code use c cpp variabl fortran fccpp name gnu cpp conveni other may work info see versionedlink developerspreprocessor preprocessor name libxc librari exchang correl function use part octopu sinc version standalon librari need instal independ inform see libxc pagehttpswwwtddftorgprogramslibxc octopu requir version octopu requir version x x wont compil x due bugfix libxc version small discrep testsuit code functionalsxcgga_x_pbeainp code periodic_systemstbtest octopu support libxc version x x x pleas note libxc testsuit prior report error case someth worri name fftw reli great librari perform fast fourier transform name fft may grab name fftw sitehttpswwwfftworg requir name fftw version name lapackbla polici reli two librari much possibl librari linearalgebra oper run name linux fair chanc alreadi instal system goe heavyweight machin name alpha name ibm name sgi etc otherwis grab sourc name netlib sitehttpswwwnetliborg name gsl final someon nice idea make public scientif librari name gsl still need grow alreadi quit use impress octopu use spline complex number special function etc name gsl must dont alreadi instal system obtain name gsl name gsl sitehttpswwwgnuorgsoftwaregsl need version higher version octopu earlier use gsl earlier test fail use gsl later version octopu earlier use gsl earlier due bug configur script name perl build process octopu run sever script languag normal avail everi modern name unix system option librari also option packag without part octopu wont work name mpi want run octopu multitentacl parallel mode need implement name mpi mpichhttpswwwunixmcsanlgovmpimpich open mpihttpswwwopenmpiorg work fine name linux box name pfft reli great librari highli scalabl parallel poisson solver base fast fourier transform name fft may grab name pippig sitehttpswwwusertuchemnitzdepottsworkgrouppippigsoftwarephpen also requir name fftw version compil mpi small patch pippig also avail name netcdf network common dataformhttpswwwunidataucaredusoftwarenetcdf librari need write binari file machineindepend welldefin format also read manual visual visual program opendxhttpswwwopendxorg name gdlib librari read graphic file see tutori particl octopu particl octopu simul box specifi via variabl boxshapeimag avail gdlibhttpswwwlibgdorg name sparskit librari spars matrix calculationshttpswwwuserscsumnedusaadsoftwaresparskit use one propag techniqu name etsf io inputoutput librari implement etsf standard format requir netcdf avail libraries_and_toolshttpswwwetsfeuresourcessoftwar version compat octopu though produc small discrep files testsuit must compil compil use octopu use etsf_io includ ttconfigurett line ttdirtt path librari instal codelin withetsfioprefixdir name libisf version later perform highli scalabl parallel poisson solver base bigdft cheap memori footprint may grab name bigdft sitehttpsbigdftorg requir name bigdft version compil mpi follow instruct instal instructionshttpsbigdftorgwikiindexphptitleinstallationbuilding_the_poisson_solver_library_onli probabl manual copi file libwrappersa libfliba instal lib directori configur octopu add configur line codelin withisfprefixdir minvers version isf librari replac successor psolverhttpsgitlabcoml_simpsolv correspond configur line codeblock withpsolverprefixdir directori psolver instal withpsolverincludedir directori psolver fortran header instal codeblock minvers unpack sourc uncompress untar command gzip cd octopu octopus_vers targz tar xvf follow file octopussrc denot sourc directori octopu creat command tar command file octopussrc contain follow subdirectori interest user file doc document octopu mainli html format file liboct_pars c librari handl input pars file sharepp pseudopotenti practic contain troulliermartin psf upf format hartwigsengoedeckerhutt pseudopotenti file file shareutil current emph util includ coupl ibm opendx network file mfnet visual wavefunct densiti etc file testsuit use check build may also use file sampl variou type calcul file src fortran c sourc file note fortran file preprocess fed fortran compil scare direct develop version get develop version octopu download octopu project octopusgit also get current version follow command need name git packag commandlin git clone gitgitlabcomoctopuscodeoctopusgit run configur script need run gnu autotool may done execut commandlin autoreconf note need work recent version name automak name autoconf particular configur script may fail part ttcheck fortran librari mpiftt ttautoconftt version earlier solut updat ttautoconftt later manual set ttfclibstt ttconfigurett command line remov spuriou apostroph autoreconf fail acloc warn couldnt open directori file directori creat empti folder name insid external_libsspglib pleas awar develop version may contain untest chang affect execut result octopu especi use new previous unreleas featur want use develop version product run least contact octopu develop configur configur set coupl option although name configur script tri guess system set recommend set explicitli default fortran compil compil option note name configur standard tool unixstyl program find lot gener document work elsewher exampl name bash would typic commandlin export fcifort commandlin export fcflagso xhost use intel fortran compil linux machin also requir librari unusu directori directori may place variabl code ldflag eg command export ldflagsldflagsoptlib configur script tri find compil use unfortun due natur primit languag octopu program automat test fail often often better set variabl code fcflag hand check manual installationporting_octopus_and_platform_specific_instruct compil appendix page flag report work differ fortran compil run configur script commandlin configur use fair amount option spice octopu tast obtain full list type command configur help commonli use option includ flag prefix inst_fil chang base instal dir octopu inst_fil inst_fil default home directori user run name configur script flag withfftlib file lib instruct name configur script look name fftw librari exactli way specifi file lib argument also use code fft_lib environ variabl flag withpfftprefix file dir instal directori name pfft librari flag withpfftlib file lib instruct name configur script look name pfft librari exactli way specifi file lib argument also use code pfft_lib environ variabl flag withbla file lib instruct name configur script look name bla librari way specifi file lib argument flag withlapack file lib instruct name configur script look name lapack librari way specifi file lib argument flag withgslprefix file dir instal directori name gsl librari librari expect file dirlib includ file file dirinclud valu file dir usual found issu command command gslconfig prefix flag withlibxcprefix file dir instal directori name libxc librari problem name configur script run find detail happen file name configlog directori compil instal run command make command make instal compil may take time might want speed run command make parallel command make j everyth went fine abl tast octopu depend valu given flag prefix inst_fil given execut resid inst_fil bin auxiliari file copi inst_fil shareoctopu test build success built octopu check build work expect batteri test run check octopu execut correctli give expect result least test case parallel version built test use mpi process though fine run core mpi implement gener permit use task actual core run test way make like develop find race condit run test sourc directori octopu use command commandlin make check impati commandlin make checkshort start run test inform whether test pass exampl job script run machin schedul pleas see manual installationspecific_architectur specific_architectur test fail mayb problem execut like miss share librari test fail might problem call extern librari typic blaslapack normal necessari compil fortran librari compil troubl tri look help octopu mail listhttpswwwtddftorgmailmanlistinfooctopusus fast recompil note featur current avail develop version plan includ octopu releas alreadi compil code chang one file run commandlin make nodep ignor depend due fortran modul file compil file chang link execut therefor much faster chang eg interfac modul function need run command make without command nodep ensur correct handl depend manualfoot prevmanualabout octopu nextmanualinput file titl manual weight descript user manual menu top welcom octopu onlin manual children depth sortweight titl manual seri manual weight copi manual octopu octopusvers first principl electron structur excit state timedepend densiti function theori program copyright miguel l marqu xavier andrad alberto castro angel rubio permiss grant copi distribut andor modifi document term gnu free document licens version later version publish free softwar foundat invari section frontcov text backcov text find copi free document licens herehttpswwwgnuorgcopyleftfdlhtml read manual new octopu recommend read manual sequenti read manual need basic knowledg name densiti function theori name dft name time depend densiti function theori name tddft also bit numer method may use way tell octopu input variabl one variabl proper document describ possibl valu take document variabl contain versionedlink variabl variabl refer inform complementari manual give brief descript function variabl leav detail refer manual read electron version manual refer input variabl mark hyperlink open link take page refer document variabl style use document name proper name like name fortran file file directori like file inp file tmp command command like command ls code input file text like code get help need help use octopu doubt content manual want contact us reason pleas octopu user mail listhttpstddftorgmailmanlistinfooctopusus contribut manual develop use wiki mean directli cooper alway find origin version httpswwwtddftorgprogramsoctopuswikiindexphpmanu manualfoot prev nextabout octopu titl pseudopotenti seri manual weight descript octopu capabl use differ format pseudopotenti see variabl speci inform includ distribut lda troulliermartin pseudopotenti common atom like need pseudopotenti repositori web place web includ pseudopotenti file varieti format note format read octopu mani nnin virtual vault pseudopotentialshttpswwwnninorgnnin_comp_psp_vaulthtml contain extens list pseudopotenti databas search engin also link pseudopotenti relat tool abinithttpswwwabinitorg quit complet set pseudopotentialshttpswwwabinitorgatomicdatafil moment ttfhitt file support quantumespressohttpswwwquantumespressoorg format also accept use inormconservingi pseudopotenti repositoryhttpswwwquantumespressoorgpseudopotenti pseudopotenti gener order gener pseudopotenti advis use follow program apehttpswwwtddftorgprogramsap opiumhttpsopiumsourceforgenet fhipphttpswwwfhiberlinmpgdethfhimdfhipp titl curvilinear coordin seri manual titl deprec util seri manual weight util present older version octopu supersed util integr main code section find replac octopus_cmplx exactli util complex version code main execut command octopu calcul real complex wavefunct depend requir input file octsf util replac manualextern utilitiesoctpropagation_spectrum command octpropagation_spectrum octcrosssect util replac manualextern utilitiesoctpropagation_spectrum command octpropagation_spectrum octhsmult octhsacc util replac manualextern utilitiesoctharmonicspectrum command octharmonicspectrum octexcit util use calcul excit spectrum within linear respons longer exist linearrespons formal calcul done main code make use casida run mode see manualcalcul modescasida octmakest util use replac kohnsham state restart directori gaussian wave packet sort oper done use variabl userdefinedst variabl octrotatory_strength octrsf util remov replac new variabl propagationspectrumtyp file octpropagation_spectrum manualfoot prevmanualextern utilitiesoctxyzanim nextmanualexampleshello world titl advanc way run octopu seri manual parallel octopu octopu run multitentacl parallel mode configur way compil instal four possibl parallel strategi domain state spinkpoint electronhol pair casida need specifi input file kind parallel strategi want use octopu find reason default howev experienc user may want tune correspond variabl parallel state first strategi parallel state mean processor take state propag independ other use includ codeblock variabl parstat auto codeblock input file clearli effici simplest way parallel code number state much larger number processor avail usual case us expect less linear speedup number processor reach around statesprocessor beyond start satur parallel domain run parallel domain octopu divid simul region box separ region domain assign differ processor allow speed calcul also divid memori among differ processor first step process split box gener complic process note talk simul box almost arbitrari shape arbitrari number processor furthermor commun processor grow proport surfac domain one use algorithm divid box domain number point time minim total area domain octopu use metishttpswwwuserscsumnedukarypismeti librari make domain decomposit space meti includ sourc code octopu use default exampl plan run ground state na there one choic codeblock variabl pardomain auto codeblock octopu partit realspac mesh comput result piec differ node later plan time propag choic hand could run parallel state codeblock variabl parstat auto variabl pardomain codeblock domain decid employ parallel strategi codeblock variabl parstat auto variabl pardomain auto codeblock problem parallel parallel effect suffici larg amount load given node otherwis commun domin case one calcul serial happen exampl attempt parallel realspac domain grid mani point code detect number point per node larg enough give warn text warn node less element parallel group recommend mayb reduc number node compil run parallel step compil use octopu parallel use code enablempi configur script give octopu librari etc necessari compil parallel code instal mpich system creat seri program call mpicc mpif mpif etc wrapper call specif compil appropri flag librari etc mean compil octopu parallel youll need mpif pleas check present system perhap file usrlocalbin compil mpich sourc octopu tri find compil may abl find sever reason file mpif _not_ path anoth f compil specifi usersystem mean variabl fc defin run configur script octopu use fortran compil specifi variabl tri find mpif configur fail bash export fcwhatev pathmpif export fcflagswhatev flag configur enablempi wise also set code fcflag octopu tell fortran compil use compil mpif run octopu parallel step depend actual system may use mpirun mpiexec accomplish run mode eg code td use multilevel parallel ie run parallel one way time code td case run parallel state domain time order finetun behavior pleas take look variabl variabl parstat variabl pardomain variabl parkpoint variabl paroth order check everyth ok take look output octopu parallel section exampl text parallel octopu run parallel info number node par_stat group info octopu wast least comput time case octopu run parallel state use processor state furthermor processor idl time great mayb differ number processor would better case pass argument environ variabl octopu also read input variabl environ variabl shell especi use want call octopu script want pass onetim argument run octopu activ featur must first set code oct_parse_env valu exampl shbash commandlin export oct_parse_env pass input variabl octopu must prepend name variabl code oct_ exampl commandlin export oct_radiu run octopu usual also pass variabl command line commandlin oct_parse_env oct_radiu octopu set variabl input file environ variabl environ variabl take preced care behaviour block support suggest elegantli put block insid environ variabl welcom addit environ variabl code octopus_shar set specifi locat file variabl file use parser environ variabl set default set configur script name file prefixshareoctopu set someth els necessari exampl handl move execut one machin anoth origin path exist new machin exampl exampl simpl script help determin optim radiu simul box file inp file rest paramet provid bash export oct_parse_env oct_radiu seq export oct_radiu octopu outoct_radiu energygrep total staticinfo head cut f echo oct_radiu energi done manualfoot prevbasicsvisu nextextern utilitiesoctanalyze_project titl visual seri manual weight everi given number time iter groundstat calcul function characteris system may written disk may anal file written within file static output directori selfconsist field within file tdx directori evolut x stand iter number write done function want plot select variabl output variabl output format chosen variabl outputformat dx opendx network aim visual wavefunct abl use need properli instal opendxhttpsopendxorg program well chemistri extens develop cornel theori center unfortun sinc softwar old unmaintain like troubl find instal work may follow versionedlink tutorialbasicsvisualizationbenzenemolecul tutori benzen molecul xcrysden atom coordin finit period forc function grid plot free program httpswwwxcrysdenorg xcrysden xsf format also read v_simhttpsinacceafrspml_simv_simindexenhtml vestahttpswwwgeocitiesjpkmo_mmacrystalenvestahtml bewar probabl assum output angstrom unit accord specificationhttpswwwxcrysdenorgdocxsfhtml use unitsoutput ev_angstrom data misinterpret visual softwar cube gaussian cube format see httpsgaussiancomcubegen httpswwwksuiuceduresearchvmdpluginsmolfilecubepluginhtml httpshcubespecreadthedocsioenlatestcubeformathtml detail descript format output read vmd xcrysden avogadro softwar note cube file alway atom unit unitsoutput input option ignor pdb everyth suppos angstrom httpsdepositrcsborgaditdocspdb_atom_formathtml xyz gener consid angstrom httpsopenbabelorgwikixyz_format httpsenwikipediaorgwikixyz_file_format httpswwwmolpronetinfodocmanualnodehtml httpsdepartmentsicmabesleemsiestadocumentationmanualssiestamanualnodehtml manualfoot prevmanualgeometri optim nextmanualadvanc way run octopu titl run octopu section manual weight descript input order run octopu requir input file must call file inp depend input file file might need like pseudopotenti coordin file discuss later manual rest file requir part octopu instal octopu correctli instal avail octopu know find octopu cant copi binari system expect work execut run octopu give command octopu command directori input file run octopu display inform screen want captur inform send output file let say file outlog execut like bash octopu outlog captur normal output warn error still print screen captur everyth file run bash octopu outlog want run octopu background append command last command output run octopu creat sever output file insid subdirectori directori run file contain physic inform depend octopu discuss next chapter one directori alway creat file exec file contain inform octopu run find file parserlog file text file contain emph input variabl read octopu variabl input file variabl took default valu second case mark comment code default file use want check octopu correctli pars variabl default valu take clean stop octopu allow stop code grace finish current iter may work gcm invert_k casida run mode use prevent possibl corrupt restart inform job kill schedul preemptiv ask octopu quit automat job script like done creat file call file stop run directori text pb l walltim mpirun homeoctopusbinoctopu output sleep h touch stop wait sophisticatedli like text minqstat pbs_jobid awk wall end print awk f min print min sh sleep_stopsh stop minm sleepi mpirun homeoctopusbinoctopu output auxiliari script code sleep_stopsh text binbash ne echo usag sleep_stopsh filenam time els echo time creat rm f sleep touch fi minvers sinc version second way use input variabl walltim variabl set time minut code grace stop minvers restart anoth directori creat file restart directori octopu save inform calcul inform use follow case octopu stop without finish reason restart without work calcul done even stop user want simul differ paramet octopu save work start restart inform calcul requir result type calcul input case use file written file restart previou calcul discuss case later talk differ calcul mode sometim desir restart calcul start begin octopu instruct set input variabl variabl fromscratch code ye manualfoot prevbasicsinput file nextbasicsunit titl hamiltonian section manual weight descript manual basic octopu base upon densiti function theori kohnsham formul kohnsham hamiltonian main part formul section describ hamiltonian treat octopu variabl control introduct although hohenbergkohn theorem state dft exact kohnsham method reduc interact manyparticl problem noninteract singleparticl problem introduc approxim exchangecorrel term groundstat dft kohnsham method dft assum interact groundstat densiti nr exist noninteract electron system groundstat densiti interact ground state obtain solut kohnsham equat leftfracnablav_rm ksnrrightvarphi_ir varepsilon_i varphi_ir notat v_rm ksn mean kohnsham potenti v_rm ks function depend n electron densiti defin term kohnsham wavefunct nr sum_irm occ varphi_ir potenti v_rm ks defin sum extern potenti normal potenti gener nuclei hartre term exchangecorrel xc potenti v_rm ksnr v_rm extr v_rm hartreenr v_rm xcnr due function depend densiti equat form set nonlinear coupl equat standard procedur solv iter selfconsist achiev total energi electron system given e_rm elecn t_sn intdrnrv_rm extr e_rm hartreen e_rm xn e_rm cn t_sn noninteract kinet energi v_rm ext extern potenti e_rm xcn exchang x correl c energi second term call extern energi code practic solut kohnsham equat evalu energi via eigenvalu e_rm elecn sum epsilon_i intdrnrv_rm xcr e_rm hartreen e_rm xn e_rm cn v_rm xcn exchangecorrel potenti find total energi entir system addit includ ionion interact ionic kinet energi e_rm xc e_rm x e_rm c unknown object includ nontrivi manybodi eﬀect requir make ks theori exact sever approxim e_rm xc propos use local densiti approxim lda approxim e_rm xcnr taken exchang correl energi homogen electron ga densiti n nr although exist exact express exchang energi model exact valu correl energi known limit high densiti ceperley alder mont carlo simul homogen electron ga sever densiti sever parameter correl energi densiti obtain interpol mont carlo result one particularli simpl parameter propos perdew zunger option may use octopu cours choos xc function variabl xcfunction via extens librari provid libxc timedepend dft timedepend densityfunct theori tddft extend basic idea groundstat densityfunct theori dft treatment excit gener timedepend phenomena tddft view altern formul timedepend quantum mechan contrast normal approach reli wavefunct manybodi schrödinger equat basic variabl onebodi electron densiti nrt advantag clear manybodi wavefunct function ndimension space n number electron system complex mathemat object densiti simpl function depend sole dimension vector r standard way obtain nrt help fictiti system noninteract electron kohnsham system final equat simpl tackl numer routin solv system larg number atom electron feel effect potenti timedepend kohnsham potenti exact form potenti unknown therefor approxim timedepend kohnsham equat fracpartialparti tvarphi_irt left fracnabla v_rm ksrt rightvarphi_irt densiti interact system obtain timedepend kohnsham orbit nr sum_irm occ leftvarphi_irtright timedepend kohnsham equat form oneparticl equat fairli easi solv numer stress howev kohnsham equat meanfield approxim knew exact kohnsham potenti v_rm ks would obtain exact kohnsham orbit correct densiti system kohnsham potenti convent separ follow way v_rm ksrt v_rm extrt v_rm hartreert v_rm xcrt first term extern potenti hartre potenti account classic electrostat interact electron v_rm hartreert intdr fracnrtleftrrright timedepend exchang correl potenti introduc need approxim beyond one made timeindepend case simplest method obtain timedepend xc potenti consist assum potenti timeindepend xc potenti evalu timedepend densiti ie vrm adiabatic_rm xcr lefttild v_rm xcnrright_nnt call adiabat approxim timeindepend xc potenti chosen lda obtain socal adiabat local densiti approxim alda approxim give remark good excit energi suﬀer problem lda notabl exponenti falloﬀ xc potenti strong laser push electron region far nucleu alda expect give accur descript system option timedepend xc potenti orbitaldepend potenti like exact exchang function exx usual kriegerliiafr kli approxim occup set occup orbit hand use variabl variabl occup extern potenti add extern uniform constant electr magnet field set variabl staticelectricfield variabl staticmagneticfield want add gener potenti use userdefin variabl speci got coordin pdb file add potenti gener point charg defin set variabl classicalpotenti variabl ye electronelectron interact neglect term set codeinlin variabl theorylevel independent_particl codeinlin variabl impli hartre exchangecorrel term calcul exchang correl potenti octopu distinguish moment groundstat dft xc function timedepend dft function word case adiabat approxim assum mathemat term may formal follow way let n timedepend densiti function live fourdimension spacetim world call n_tvecr nvecr electron densiti time function threedimension space exchang andor correl energi function ealpha ground state dft may use build adiabat exchang andor correl action function follow way aalphan int_t_t_frm dtau ealphan_tau timedepend potenti function valphanvecrt equiv delta aalpha delta nvecr delta ealpha delta n_tvecr valpha rm gsn_tvecr use distinct notat valphanvecrt valpha rm gsn_tvecr stress exchang correl potenti tddft former exchang correl potenti gsdft latter principl two conceptu differ object coincid thank adiabat approxim reason may actual refer function gsdft context may classifi xc function contain octopu code follow john perdew jacob ladder scheme lda rung function alpha belong lda rung depend electron densiti spin densiti spinpolar spinor case moreov ilocali depend densiti ie ealpha_rm lda ealpha_rm ldan int rm dr ealpha_rm ldanvecr potenti may deriv function deriv valpha_ldanvecr delta ealpha_rm lda delta nvecr rm dealpha_rm lda rm dn nvecr gga rung function alpha belong gga rung depend electron densiti also gradient moreov also local depend actual gga often call semiloc function due erm alpha gga erm alpha ggan vecnablan int rm dr ealpha_rm gganvecr vecnablanvecr metagga rung oep rung famili function defin term occupi kohnsham orbit lbrace varphi_i rbrace_in fact nonloc function name rung oep stand optimizedeffectivepotenti reason gener method use deriv potenti energi function direct function deriv case possibl suitabl name would orbitaldepend function octopu come sever exchang correl potenti includ sever flavour lda gga oep choos favorit set variabl variabl xcfunction note octopu exchangecorrel function chosen variabl ttxfunctionaltt ttcfunctionaltt use oep exchang variabl variabl oeplevel control level approxim requir also includ selfinteract correct sic control variabl variabl siccorrect relativist correct variabl variabl relativisticcorrect allow one choos relativist correct use spinorbit coupl variabl relativisticcorrect code spin_orbit implement spinorbit coupl spinorbit coupl implement octopu includ pseudopotenti either hgh pseudopotenti troulliermartinslik pseudopotenti latter case pseudopotenti need gener fulli relativist calcul fulli separ form given hatv_kbv_localsum_ljm_j fracvarphipp_ljm_jdelta v_ljppvarphipp_ljm_jdelta v_ljppvarphipp_ljm_j delta v_ljppvarphipp_ljm_j sinc angular part pseudo wavefunct varphipp_ljm_j spheric spinor wavefunct complex spinor variabl spincompon need set code non_collinear also true hgh pseudopotenti note current octopu abl read jdepend troulliermartinslik pseudopotenti provid upf file format manualfoot prevbasicsphys system nextbasicsdiscret titl basic weight descript section manual children depth titl physic system section manual weight descript first thing octopu know physic system want treat specifi group speci posit dimens octopu work space dimens select dimens system variabl dimens variabl speci octopu speci gener nucleu repres pseudopotenti full coulomb potenti jellium sphere even userdefin potenti inform regard atom speci goe variabl speci block pseudopotenti manyelectron schroeding equat greatli simpliﬁ electron divid two group valenc electron inner core electron electron inner shell strongli bound play signiﬁc role chemic bind atom thu form nucleu inert core bind properti almost complet due valenc electron especi metal semiconductor separ impli inner electron ignor reduc atom inert ionic core interact valenc electron suggest use eﬀect interact pseudopotenti give approxim potenti felt valenc electron due nucleu core electron signiﬁcantli reduc number electron dealt moreov pseudo wave function valenc electron much smoother core region true valenc wave function thu reduc comput burden calcul modern pseudopotenti obtain invert free atom schroeding equat given refer electron conﬁgur forc pseudo wave function coincid true valenc wave function beyond certain cutoﬀ distanc pseudo wave function also forc norm true valenc wave function energi pseudo eigenvalu match true valenc eigenvalu diﬀer method obtain pseudo eigenfunct satisﬁ requir lead diﬀer nonloc angular momentum depend pseudopotenti wide use pseudopotenti troullier martin potenti hamann potenti vanderbilt potenti hartwigsengoedeckerhutt potenti default potenti use octopu troullier martin type although also opt hgh potenti octopu come packag pseudopotenti paramet need use want look find inst_fil shareoctopuspseudopotenti pseudopotenti serv defin mani speci might wish use coordin block eg helium atom happi use predefin pseudopotenti need write speci block howev also possibl defin new speci use coordin block ad variabl speci block check document variabl specif syntax block may specifi format file contain pseudopotenti paramet atom number may defin algebra express potenti userdefin potenti user defin potenti finit everywher region calcul run want search repositori web creat pseudopotenti check manual pseudopotenti pseudopotenti page save pseudopotenti file directori inp file specifi format speci block allelectron nucleu potenti speci full coulomb potenti vleft vecrrightfracleftvecr_ivecrright main problem repres potenti discontinu vecr_i overcom problem follow first assum atom locat closest grid point calcul charg densiti associ nucleu delta distribut valu charg point zero elsewher solv poisson equat densiti way get potenti best represent coulomb potenti grid discuss grid later continu vecr_i valu averag potenti volum associ grid point main problem requir atom grid point quit strong possibl system simpl geometri cant move atom also coulomb potenti hard mean need small space consid core valenc electron speci suitabl atom small molecul user defin also possibl defin extern userdefin potenti input file versionedlink manualbasicsinput_filemathematicalexpress function accept parser use besid one use symbol x z r way trivial calcul model system like harmon oscil quantum dot etc coordin instanc speci even userdefin potenti specifi posit insid simul box use variabl coordin block describ posit insid input file one variabl xyzcoordin variabl pdbcoordin variabl specifi extern file name xyz name pdb format respect coordin read use geometri octopu recommend center use manual extern utilitiesoctcentergeom octcentergeom util veloc go ion dynam may want initi veloc particl sever choic dont put anyth input file particl zero initi veloc give random veloc accord temperatur degre kelvin given variabl randomvelocitytemp variabl explicitli give initi veloc particl either variabl veloc block pseudoxyz file detail variabl variabl xyzveloc number electron speci add enough electron make system neutral want add remov electron specifi total charg system variabl excesscharg variabl neg charg impli add electron manualfoot prevbasicsunit nextbasicshamiltonian titl troubleshoot section manual weight descript octopu work properli system ie recreat result versionedlink tutori tutori troubl use work thing tri pleas feel free add idea read parserlog look file file execparserlog tell valu variabl set file inp file well variabl take default valu sometim help understand behavior program use outputduringscf add variabl outputduringscf code ye input file examin result iter self consist field calcul also variabl variabl output set code output densiti potenti electron densiti kohnsham bare exchangecorrel hartre potenti written folder call eg file scf scf iter set debug set variabl variabl debug code info extra diagnost info stack trace fatal error code trace add full stack strace code trace_fil get stack trace mpi task run parallel manualfoot prevbasicssymmetri nextcalculationsground state titl output section manual weight descript first may quit happi master input file octopu run without error howev eventu thesi advisor want learn someth system manag describ octopu groundstat dft octopu send relev inform standard output may redirect file see energi occup eigenst system valu inform also found file file staticinfo howev octopu also calcul wavefunct state posit nuclei system thu tell densiti dipol moment charg densiti matrix element dipol moment oper differ state look valu variabl output variabl take see possibl exampl includ codelin output wfs_sqmod potenti file inp file octopu creat separ text file directori file static valu squar modulu wave function local classic hartre exchangecorrel part kohnsham potenti point mesh specifi format detail input file variabl outputformat variabl variabl variabl output section refer manual exampl specifi file contain valu along x z axi plane x z also set format readabl graphic program opendxhttpsenwikipediaorgwikiibm_opendxopendx gnuplothttpswwwgnuplotinfo matlabhttpswwwmathworkscomproductsmatlab opendx make plot isosurfac data threedimens howev gnuplot make plot function two variabl ie valu wavefunct plane plot function one variabl ie valu wavefunct along axi opendx unfortun opendx longer activ maintain linux distribut eg debian ubuntu still opendx packag recommend move differ visual programm visithttpswcillnlgovsimulationcomputercodesvisit paraviewhttpswwwparavieworg timedepend dft optic properti primari reason use timedepend dft program obtain optic properti system two choic linearrespons theori ia lai jamorski casida salahubhttpsdxdoiorgfootnot explicit timepropag system perturb la yabana bertschhttpsprolaapsorgabstractprbvip_footnot may wish read method paper castro et alhttpsprolaapsorgabstractprlvip_footnot linearrespons theori linearrespons theori base idea small timedepend perturb extern appli electr potenti delta v r omega result timedepend perturb electron densiti delta rho r omega linearli relat size perturb delta rho r omega int r chi r r omega delta v r omega obvious timedepend fouriertransform frequencydepend omega suscept chir r omega densitydens respons function respons charg densiti potenti coupl charg densiti system pole excit energi manybodi system mean induc densiti also pole one use analyt properti find relat oper whose eigenvalu manybodi excit energi matrix element oper contain among thing occupi unoccupi kohnsham state energi ground state dft calcul exchangecorrel kernel f_xcr r omega delta v_xcnromegaoverdelta nromegamid_delta v_ext casida equat full solut problem real wavefunct tammdancoff approxim use occupiedunoccupi transit petersilka approxim use diagon element tammdancoff matrix iiei mix transit footnot take littl time calcul whole matrix petersilka provid mostli comparison method clearli much faster order magnitud propag time turn sensit qualiti unoccupi state mean hard converg excit energi one requir larg simul box much larger propag real time electron excit mean timepropag see timedepend deltakick calcul absorpt spectrumcalculationstimedependentdeltakickcalculatinganabsorptionspectrum manualfoot prevbasicsdiscret nextbasicstroubleshoot refer footnot articl titledynam polariz excit spectra molecular implement timedepend densityfunct respons theori n case studi authorschristin jamorski mark e casida denni r salahub journalj chem phi year vol issu page urlhttpsscitationaiporggetabsservletgetabsservletprognormalidjcpsaidtypecvipsgifsy doi footnot articl titletimedepend localdens approxim real time authorsk yabana g f bertsch journalphi rev b year vol issu page urlhttpslinkapsorgabstractprbvp doiphysrevb footnot articl titleoctopu tool applic timedepend densiti function theori authorsalberto castro heiko appel micael oliveira carlo rozzi xavier andrad florian lorenzen l marqu e k u gross angel rubio journalphysica statu solidi b year volum issu page urlhttpswwwintersciencewileycomcgibinabstractabstractcretrysretri doipssb footnot articl titleexcit energi timedepend densityfunct theori authorspetersilka gossmann u j gross e k u journalphi rev lett volum number page numpag year monthfeb doiphysrevlett publisheramerican physic societi urlhttpsprolaapsorgabstractprlvip_ titl unit section manual weight descript enter physic octopu address import issu emph unit differ unit system use atom scale use one atom unit call conveni unit present unit system explain use octopu atom unit atom unit gaussian system unit gaussian mean vacuum dielectr constant dimens set epsilon_ pi numer valu bohr radiu electron charg electron mass reduc planck constant set one qquad a_ e m_e hbar simplifi formula although may feel present seriou hazard dimension analysi interpret understand formula physic gener person tast set directli two fundament unit atom unit length mass qquad rm au_rm length a_ time rm mquad rm au_rm mass m_e time rm kg sinc squar charg must unit energi time length thu set atom unit energi qquad rm au_rm energi e a_ time rm j call hartre hartre sinc energi unit mass time length squar per time squar help us get atom unit time qquad rm ha m_e a_ rm rm au_rm time rm au_rm time a_ sqrtm_e rm ha a_ e sqrtm_e a_ time rm catch planck constant dimens energi time time thu abl deriv valu begin set one point four physic constant use a_ m_e e hbar independ sinc qquad a_ hbar m_e e pi epsilon_ way could actual deriv atom unit time easier way use planck constant qquad hbar rm harm au_rm time rightarrow rm au_rm time hbar rm ha hbar a_ e combin retriev conveni unit much literatur field written use ångström electronvolt unit length energi respect may conveni defin system unit deriv atom system unit make substitut call conveni unit mass remain thu unit time must chang hbar rm ev hbar time rm ev unit octopu except otherwis note octopu expect valu input file atom unit prefer use unit input file code provid handi convers factor exampl write length valu ångström simpli multipli valu code angstrom codelin space angstrom complet list unit octopu know found variabl unit variabl descript default octopu write valu atom unit switch conveni unit set variabl variabl unitsoutput valu ev_angstrom mass unit except unit octopu mass unit deal mass ion atom mass unit amuhttpsenwikipediaorgwikiamu alway use unit defin mass supsup name c atom keep standard convent solidst physic effect mass electron alway report unit electron mass ie atom unit mass even evå system charg unit unit system charg unit electron charg e ie atom unit charg unit convers convert unit timeconsum errorpron task done hand especi implicit constant set one case atom unit better use special softwar like gnu unitshttpswwwgnuorgsoftwareunitsunitshtml field common unit express absorpt spectrum mb convert strength function ev mb multipli pi h c r_e r_eem_ c numer factor manualfoot prevbasicsrun octopu nextbasicsphys system titl symmetri section manual weight descript much use symmetri octopu finit system get analysi inform use anywher code form eg silan text symmetri symmetri element c c sigma symmetri group td mani symmetri fact broken realspac mesh sinc alway orthogon break threefold rotat symmetri benzen exampl period system also get analysi _eg_ like bulk silicon atom convent cell text symmetri space group intern fd internationallong fd _ schoenfli oh multipl point group intern schoenfli oh ident fraction translat ident fraction translat ident fraction translat disabl fraction translat system appear supercel info system symmetri use analysi done librari spglibhttpsspglibgithubiospglib comment fraction translat supercel due use convent cell sinc atom primit cell orthogon lattic vector therefor use octopu current larg system symmetri analysi might timeconsum rare case symmetri analysi might crash stop calcul either situat use variabl variabl symmetriescomput turn symmetri analysi manual identifi direct symmetri broken variabl symmetrybreakdir appropri case extern field appli particular direct symmetri use two way period system first reduc set kpoint need behavior control variabl kpointsusesymmetri highsymmetri system make dramat reduct time requir calcul exampl silicon exampl set text kpointsgrid obtain kpoint text kpoint gener paramet n index weight coordin densiti scalar quantiti straightforwardli comput densiti due kpoint weight done vector quantiti gradient use gga function forc note howev proper calcul complic tensori properti respons function sternheim calcul mode implement symmetri also use symmetri oper symmetr densiti via variabl symmetrizedens gener bewar use symmetri partial period system _eg_ wire sheet geometri problem found use symmetri reduc number calcul need obtain absorpt spectra timepropag discuss tutori responseuse_of_symmetries_in_optical_spectra_from_timepropag use symmetri optic spectra timepropag manualfoot prevbasicsoutput nextbasicstroubleshoot titl input file section manual weight descript octopu use singl input file read user instruct know calcul page explain gener file gener format octopu parser librari found file liboct_pars directori sourc base bison c find two old separ releas version bottom octopusreleas page input file input option file call file inp directori octopu run plain name ascii text file creat edit use text editor like name emac name vi name jed name pico name gedit etc fairli comprehens exampl look tutori page tutori basicsbasic_input_opt basic input option begin program parser read input file pars gener list variabl read octopu note input caseindepend two kind variabl scalar valu string number block may view matric scalar variabl scalar variabl code var defin codelin var exp code var contain alphanumer charact plu _ code exp quotedelimit string number integ real complex variabl name mathemat express complex number defin ttreal imagtt real number use scientif notat ttett ttett ttdtt ttdtt fortran peopl ttett variabl name casesensit must redefin previous defin symbol especi reserv variabl ttx z r w ttt use space timedepend express ttwtt th space coordin oper list predefin variabl follow belowpredefinedvari mathemat express parser interpret express input file either assign result variabl defin function potenti variabl speci block timedepend function variabl tdfunction block argument number variabl arithmet oper code ab addit code ab subtract code unari minu code ab multipl code ab divis code ab exponenti logic oper logic oper return fals true exploit defin piecewis express eg tt x x tt although ttsteptt function may also use comparison oper except tttt use real part complex number code b less code b less equal le code b greater code b greater equal ge code b equal code b logic code b logic code logic function code sqrtx squar root code x code expx exponenti code x code logx code lnx natur logarithm code x code logx base logarithm code x code logbx b base code b logarithm code x code x complex number x iy code argz argument complex number code z argz pi argz pi code absz magnitud complex number code z z code absz magnitud squar complex number code z z code logabsz natur logarithm magnitud complex number code z logz allow accur evalu logz z close one direct evalu code logabsz would lead loss precis case code conjgz complex conjug complex number code z z x code invz invers reciproc complex number code z fracz fracx yx code sinx code cosx code tanx code cotx code secx code cscx sine cosin tangent cotang secant cosec code x code asinx code acosx code atanx code acotx code asecx code acscx invers arc sine cosin tangent cotang secant cosec code x code atanxi mathrmatanyx code sinhx code coshx code tanhx code cothx code sechx code cschx hyperbol sine cosin tangent cotang secant cosec code x code asinhx code acoshx code atanhx code acothx code asechx code acschx invers hyperbol sine cosin tangent cotang secant cosec code x code minx minimum code x code code maxx maximum code x code code stepx heavisid step function code x use piecewisedefin function code erfx error function mathrmerfx fracsqrtpi int_x dt et code realpartz real part complex number code z code imagpartz imaginari part complex number code z code floorx largest integ less real number code x code ceilingx smallest integ greater real number code x mathemat oper base gsl librari defin code symbolsc code grammari refer httpswwwgnuorgsoftwaregslmanualhtml_nodepropertiesofcomplexnumbershtml httpswwwgnuorgsoftwaregslmanualhtml_nodecomplexarithmeticoperatorshtml httpswwwgnuorgsoftwaregslmanualhtml_nodeerrorfunctionhtml httpswwwgnuorgsoftwarelibcmanualhtml_noderoundingfunctionshtml httpswwwgnuorgsoftwaregslmanualhtml_noderepresentationofcomplexnumbershtml predefin variabl predefin constant conveni code pi code code e base natur logarithm code fals code fals code true code ye true code imaginari unit ie code sinc version also predefin unit found search decim point code code sharevari code angstrom code code pm code picomet code code nm code nanomet code code ry code rydberg code code ev code electronvolt code code invcm code e code kelvin code e code kjoule_mol code code kcal_mol code code code attosecond code code fs code femtosecond code code ps code picosecond code code c code block block defin collect valu organis row column format syntax follow codeblock var exp exp exp exp exp exp codeblock row block separ newlin column separ charact tab may number line number column block note also line differ number column valu block dont type comment everyth follow charact code end line consid comment simpli cast oblivion includ codeinclud filenamecod possibl includ extern file input file illustr usag command split input file versionedlink tutorialbasicstotal_energy_convergencemethanemolecul methan tutori two input file file inp text variabl calculationmod gs variabl unitsoutput ev_angstrom variabl radiu angstrom variabl space angstrom includ geometryoct geometri defin file geometryoct text ch angstrom variabl coordin c h chsqrt chsqrt chsqrt h chsqrt chsqrt chsqrt h chsqrt chsqrt chsqrt h chsqrt chsqrt chsqrt environ variabl also versionedlink manualadvanced_ways_of_running_octopuspassingargumentsfromenvironmentvari set variabl use environ help script default valu octopu tri read variabl defin input file automat assign default valu case octopu find sensibl default valu stop error variabl read present input file output file file execparserlog variabl defin input file ttdefaulttt comment sure program read take look recommend keep variabl input file minimum write variabl assign default valu default chang newer version octopu old valu might caus problem besid input file becom difficult read understand document input variabl document explain valid valu may take document obtain versionedlink variabl onlin also access manual external_utilitiesocthelp octhelp command experiment featur even stabl releas octopu mani featur develop suitabl product run protect user inadvertli use part declar experiment tri use one experiment function octopu stop error want use need set variabl variabl experimentalfeatur code ye octopu emit warn set variabl experimentalfeatur code ye allow use part code complet well test like produc wrong result want use product run contact octopu develop first good practic order ensur compat newer version octopu avoid problem keep mind follow rule good practic write input file although input variabl take option input also take number number represent make input file less readabl like chang futur avoid use number instead valu exampl text unitsoutput ev_angstrom must alway use instead text unitsoutput includ variabl requir input file especi declar valu copi default valu make input file longer less readabl sinc default like chang make probabl input file problem newer version octopu instead reli default valu avoid duplic inform input file use variabl mathematicalinterpret capabl exampl use text c e mc instead text c e second case might chang valu code code c cosmologist forget updat code e end inconsist file manualfoot prevbasicsinstal nextbasicsrun octopu titl discret seri manual weight descript manual basic besid approxim comput solv infinit continu problem discret equat somehow octopu use grid real space solv kohnsham equat function repres valu set point real space normal grid equal space also nonuniform grid use shape simul region may also tune suit geometr configur system grid octopu function repres set valu correspond valu function set point real space default point distribut uniform grid mean distanc point constant direct possibl grid uniform bit complex discuss later scheme separ point space critic valu becom larg represent function get wors becom small number point increas increas memori use calcul time valu equival name energi cutoff use planewav represent octopu choos space simul variabl space variabl set singl valu give space direct exampl code space want differ space coordin specifi variabl space block three real valu work default pseudopotenti speci octopu come recommend variabl space valu dont need give input file normal default valu around bohr angstrom may need smaller space case reli default valu product run doubl grid experiment doublegrid techniqu method increas precis represent pseudopotenti grid recent integr octopu avail octopu previou version activ techniqu set variabl variabl doublegrid valu ye use doubl grid increas cost transfer potenti grid case done time per run overhead total comput time neglig except atom displac timedepend simul doubl grid sever increas comput time box also select finit domain real space run simul known simul box octopu use sever kind shape box control variabl variabl boxshap besid standard shape octopu take shape given userdefin function even imag way give size simul box chang shape given variabl variabl radiu zero boundari condit default octopu assum zero boundari condit wavefunct densiti zero boundari domain natur boundari condit work finit system case choos adequ box size import box small wavefunct forc go zero unnatur box larg larger number point need increas calcul time memori requir manualfoot prevbasicshamiltonian nextbasicsoutput titl phonon seri manual weight hidden true continu titl optim control seri manual weight tutori unsortedbasic_qoct tutori basic optim control theori manualfoot prevcalculationslinear respons nextcalculationsgeometri optim titl calcul weight children depth titl ground state seri manual weight descript converg ground state system groundstat electron densiti kohnsham ksbase electronicstructur code octopu obtain selfconsist process attempt solv ks equat kohnsham ground state essenc problem follow given iter step one depart approxim solut ks eigenfunct psiinp_j eigenvalu epsiloninp_j densiti rhoinp determin ks input hamiltonian diagon hamiltonian one obtain correspond output eigenfunct eigenvalu densiti densiti altern correspond kohnsham potenti use build new input hamiltonian diagon next iter step cycl consid close solut achiev input output similar enough converg criterion fulfil case allow four differ criteria defin selfconsist procedur stop either first converg criterion fulfil maximum number iter perform mix output densiti potenti given iter use directli construct kohnsham potenti follow iter instead mix densiti potenti previou iter step manner mix produc determin variabl variabl mixingschem variabl mix variabl mixfield variabl mixnumberstep converg iter octopu check whether converg criterion met one criterion error electron densiti smaller threshold cours true electron densiti known error realli chang densiti sinc last iter epsilon int rm dr rhooutmathbf r rhoinpmathbf r call criterion variabl convabsden howev sinc densiti proport number electron n absolut criterion transfer differ system size therefor default criterion use variabl convrelden rel densiti rho n use rather absolut densiti epsilon n int rm dr rhooutmathbf r rhoinpmathbf r default use valu ttett converg variabl variabl convabsden variabl convabsev variabl convrelev set tttt indic use criteria converg avail criteria use error defin follow variabl convabsev chang eigenvalu found sum chang must smaller threshold epsilon sum_jn_occ vert epsilon_joutepsilon_jinpvert variabl convrelev eigenvalu scale total eigenvalu sum otherwis epsilon n sum_jn_occ vert epsilon_joutepsilon_jinpvert epsilon frac left sum_jn_occ epsilon_jout epsilon_jinp right left sum_jn_occ epsilon_jout right use set relev variabl equal number indic desir error set three converg variabl zero eigensolv iter selfconsist problem describ octopu must diagon kohnsham input hamiltonian obtain output eigenfunct eigenvalu diagon done eigensolv also iter procedur sever option iter scheme use diagon hamiltonian specifi document variabl variabl eigensolv may specifi threshhold consid iter diagon finish variabl variabl eigensolvertoler variabl variabl eigensolvermaxit set maximum number step diagon reach diagon consid finish even eigenvector fulli converg selfconsist field cycl iter octopu report eigenvalu obtain diagon hamiltonian mani eigenvector fulli converg text scf cycl iter etot e abs_ev e rel_ev e abs_den e rel_den e matrix vector product converg eigenvector eigenvalu h st spin eigenvalu occup error e e e e import whether eigenvector converg scf step whether converg end lcao sinc solut groundstat problem done iter need initi guess set initi kohnsham orbit calcul pseudopotenti oppos model potenti defin user use pseudoorbit use gener pseudopotenti default program fill initi guess state pseudoorbit whether done determin variabl variabl lcaostart guess densiti sum atom densiti note howev pseudoorbit pass directli iter cycl instead code perform initi diagon hamiltonian gener guess densiti therefor scf cycl start linear combin atom orbit coeffici result diagon lcao stand linear combin atom orbit word first step scf cycl perform insid lcao subspac wherea follow step perform full space diagon typic done number pseudoorbit larger number use later ks scf cycl diagon lcao matrix take lowest lie eigenst proceed calcul default number pseudoorbit use one chang make use variabl variabl lcaodimens set variabl scfinlcao lcao calcul perform selfconsist word whole scf cycl done insid lcao subspac unoccupi state variabl calculationmod code unocc purpos run mode calcul higher lie kohnsham orbit purpos read restart inform converg previou groundstat calcul build correspond hamiltonian calcul unoccupi eigenvalu eigenfunct number unoccupi orbit calcul given variabl extrast manualfoot prevcalculationstroubleshoot nextcalculationstimedepend titl linear respons seri manual weight descript polariz octopu calcul dynam polariz firstord hyperpolarizabilit linearrespons scheme use sternheim equat also possibl calcul optic spectra techniqu slower timeevolut ground state first thing need linear respons manual calculationsground state ground state calcul unlik casida approach use sterheim equat neednt unoccupiedst calcul improv converg linearrespons calcul better use tightli converg wavefunct exampl add paramet gs calcul text eigensolverfinaltoler e convrelden e input variabl calculationmod polariz calcul code em_resp main paramet specifi frequenc perturb given variabl emfreq block also add imaginari part frequenc set variabl variabl emeta ad small imaginari part requir want get imaginari part polariz calcul polariz near reson reason valu code ev get hyperpolarizabilti also specifi variabl variabl emhyperpol three coeffici respect base frequenc three valu must sum zero output run frequenc input file octopu gener subdirectori file em_resp subdirectori file call file alpha contain real part polariz tensor alpha_ij averag polariz baralphafracsum_ialpha_ii imaginari part eta written file file eta eta also file call file cross_section_tensor contain photoabsorpt cross section tensor frequenc relat imaginari part polariz sigma frac pi omegac mathrmim alpha hyperpolariz file call file beta base frequenc contain compon reduc quantiti beta_i frac sum_jbeta_ijjbeta_jijbeta_jji option born charg also calcul finit differ mode static polariz obtain calcul done take numer deriv energi respect extern static uniform electr field use run variabl responsemethod code finite_differ octopu run sever groundstat energi calcul calcul polariz use finitediffer formula deriv result file em_resp_fd directori hyperpolariz born charg also calcul manualfoot prevcalculationscasida nextcalculationsoptim control titl casida seri manual weight descript altern linear respons mark casida formul linearrespons tddft allow calcul excit energi finit system small molecul normal fastest way calcul perform casida calcul first need manual calculationsground state groundstat calcul calcul unoccupi state run code variabl calculationmod code casida input file linearrespons calcul nitrogen dimer found file sharetestsuitelinear_responsecasida ground state calcul first step converg groundstat expand ground state input file codeblock include_input testsuitelinear_responsecasidagsinp codeblock expand unoccupi state ground state calcul converg necessari add converg unoccupi state expand unoccupi state input file codeblock include_input testsuitelinear_responsecasidaunoccinp codeblock expand casida calcul excit state expand casida input file codeblock include_input testsuitelinear_responsecasidacasidainp codeblock expand see also tutori responseoptical_spectra_from_casida tutori casida calcul manualfoot prevcalculationstimedepend nextcalculationslinear_respons titl geometri optim seri manual weight perform geometri optim octopu one set variabl calculationmod code go method use set use variabl variabl gomethod note method use minim routin gslhttpswwwgnuorgsoftwaregslmanualhtml_nodemultidimensionalminimizationhtml stop criteria set variabl variabl gotoler variabl gominimummov minim stop forc ion smaller variabl gotoler speci coordin chang less variabl gominimummov one minim step none previou criteria match number minim step equal variabl gomaxit minim stop error messag minim step taken gslhttpswwwgnuorgsoftwaregsl algorithm octopu write current geometri file name file goxxxxxyz xxxx iter number directori file geom extra inform titl xyz file second line contain total energi current default method use geometri optim variabl gomethod code fire otherwis mani time stop criteria small gsl routin return error messag state unabl improv solut end run minim success minim geometri written file name file minxyz work directori see also tutori tutori unsortedgeometry_optim geometri optim manualfoot prevcalculationsoptim control nextvisu titl timedepend seri manual weight descript time evolut time evolut variabl calculationmod code td code perform timepropag electron orbit ndash requir ndash ionic posit latter task pose major algorithm problem usual verlet algorithm deal task howev best way propag schroumldingerlik equat still unclear due fact provid rather excess select possibl purpos describ set variabl necessari specifi way time evolut perform worth make brief introduct problem concern set schrödingerlik equat electron orbit psi_jt iparti partial tpsi_jt htpsi_jt psi_jt psi_j equat linear time deriv hamiltonian linear oper one may formal defin linear evolut oper ut transform initi vector solut time psi_jt ut psi_j moreov formal exact express evolut oper psi_jt mathcalt exp left int_t tau htau right psi_j mathcalt exp timeord exponentialhttpsenwikipediaorgwikiordered_exponenti shorthand psi_jt leftsum_ninfti fracleftirightnn int_t dtau_ cdot int_t dtau_n mathcalt htau_ cdot htau_nrightpsi_j hamiltonian commut differ time drop timeord product leav simpl exponenti hamiltonian timeindepend make trivial self commut solut simpli written psi_jt expleft ithright psi_j unfortun case tddft system expos extern timedepend perturb like electr magnet field puls laser even without extern timedepend remain intrins timedepend kohnsham hamiltonian built ldquoselfconsistentlyrdquo vari electron densiti first step tackl problem split propag long interv n smaller step util group properti ut ut tut timeevolut oper yield follow time discret ut prod_inut_idelta t_i t_ t_nt delta tn time step deal problem perform shorttim propag psi_jtdelta utdelta tpsi_jt mathcaltexpleft iint_ttdelta tdtau htauright psi_jt way one monitor evolut interior fact possibl monitor evolut gener requir requir impos natur restrict maximum size delta omega_mathrmmax maximum frequenc want discern delta larger approx omega_mathrmmax delta t_mathrmmax free choos delta consid perform reason technic reason discret twofold timedepend h allevi norm exponenti argument reduc norm increas linearli delta sinc drop timeord product desir algorithm reduc principl calcul action exponenti oper initi vector algorithm tailor approxim evolut oper fact even need peform oper exponenti howev reli calcul one exponenti one use octopu principl need specifi two differ issu ldquoevolut methodrdquo ldquoexponenti methodrdquo word need algorithm approxim evolut oper utdeltatt ndash specifi variabl variabl tdpropag ndash algorithm requir also need algorithm approxim exponenti matrix oper expleft aright ndash specifi variabl variabl tdexponentialmethod propag timedepend kohnsham equat follow describ propag avail octopu timedepend kohnsham equat propag solv problem approxim orbit psi_jtdelta knowledg psi_jtau htaufor letaul method requir knowledg hamiltonian point tau time tdelta quantiti approxim follow procedur approxim htau extrapol polynomi fit certain number previou time step propag psi_jt get psi_jtdelta calcul htdelta orbit psi_jtdelta interpol requir htau ht htdelta repeat step selfconsist reach octopu howev scheme drop perform reason step implement via secondord extrapol except first two step extrapol obvious trust instead reli suffici small delta midpoint rule implicit midpoint rule cranknicolson methodhttpsenwikipediaorgwikicrankenicolson_method variabl tdpropag code crank_nicolson calcul exponenti hamiltonian firstord padeacut approxim hamiltonian evalu delta integr drop u_mathrmcnt delta frac fracdelta thtdelta fracdelta thtdelta calcul matrix fraction transform solut linear system l psi_jtdelta b known quantiti l ifracdelta thtdelta b leftifracdelta thtdelta trightpsi_jt cranknicolson scheme unitari preserv timerevers symmetri simpler similar scheme exponenti midpoint rule variabl tdpropag code exp_mid unitari timereversalsymmetrypreserv drawback requir fairli small time step u_mathrmemt delta expleftidelta ht delta tright magnu expans magnu expansionhttpsenwikipediaorgwikimagnus_expans variabl tdpropag code magnu sophist propag implement octopu accord magnu exist oper omegatdelta hold utdelta expleftomegatdelta tright given seri omegat delta sum_kinfti omega_kt delta converg least local environ oper omega_ktdelta gener recurs procedur omega_ktdelta sum_lk fracb_llint_ttdelta sl_ktaudtau s_tau ihtau quad s_k mathrmfor k s_kjtau sum_mklleftomega_mtdelta s_kmltauright mathrmfor le lle k b_l bernoulli numbershttpsenwikipediaorgwikibernoulli_numb octopu implement fourthord magnu expans mean oper seri truncat second order integr calcul secondord quadratur formula result oper omega_mt delta ifracdelta tleftht_ ht_right fracsqrtdelta tleftht_ ht_right quadratur sampl point t_ leftfracmp fracsqrtrightdelta modifi hamiltonian h_mt delta overlineht delta leftt v_mathrmextmathrmnonlocalt overlinedelta vt delta tright overlineht delta fracleftv_mathrmkst_v_mathrmkst_right overlinedelta vt delta fracsqrtdelta tleftv_mathrmkst_v_mathrmkst_right propag take form u_mtdelta explefti delta h_mt delta tright note nonloc compon kohnsham hamiltonian contribut commut furthermor make assumpt nonloc potenti v_mathrmextmathrmnonlocalt vari significantli interv tdelta nonloc compon stem ionic pseudopotenti consequ variat caus ionic movement neglig electron time scale determin delta timereversalsymmetri base propag due timerevers symmetri propag backward delta start psi_jtdelta lead result propag forward delta start psi_jt use simplest approxim evolut oper end condit expleftifracdelta tht delta tright psi_jtdelta expleftifracdelta thtright psi_jt rearrang term give approxim propag u_mathrmetrst delta explefti fracdelta ht delta tright explefti fracdelta thtright enforc timerevers symmetri method avail octopu set variabl tdpropag code etr worthwhil give sidenot approxim htdelta code etr method hamiltonian time tdelta extrapol rather built densiti n sum_jpsi_jtdelta turn calcul orbit estim psi_jtdelta expleftidelta htrightpsi_jt exist howev also variant variabl tdpropag code aetr approxim enforc timerevers symmetri perform secondord polynomi extrapol htkdelta k get htdelta nbsp faster code etr approxim exponenti oper evolut method describ previou section requir calcul exponenti matrix go detail variabl tdexponentialmethod octopu provid one gener difficulti deserv mention principl would like calcul expleftarightv first calcul expleftaright appli result vector v unfortun size hamiltonian matrix order approx forbid full storag matrix form apart method calcul exponenti matrix explicitli limit thousand matrix element reason turn iter solut calcul expleftarightv particular vector v polynomi expans simplest possibl use definit exponenti matrix expleftaright sum_kinfti frackak get approxim order k variabl tdexponentialmethod code taylor mathrmtaylor_nlefta vright sum_knfrackakv mathrmtaylor_nlefta vright amount expans exponenti standard polynomi base left x x ldotsright experi show choic k give particularli good result tddft implement standard polynomi basi possibl octopu also implement expans exponenti chebyshev basi variabl tdexponentialmethod code chebyshev mathrmcheb_nlefta vright sum_knc_kt_kakv t_k chebyshev polynomialhttpsenwikipediaorgwikichebyshev_polynomi order k truncat n expans set input variabl variabl tdexpord krylovsubspac project krylov subspacehttpsenwikipediaorgwikikrylov_subspac order n given oper vector v defin mathcalk_nlefta vright mathrmspanleftv av av ldot anvright idea find element mathcalk_n lefta v right optim approxim expleftaright leastsquar sens proven given beta v_nv_ntexpleftarightv_ne_ v_n v_ ldot v_n orthonorm basi mathcalk_nlefta vright calcul lanczo procedur get rid exponenti approxim v_ntexpleftarightv_n approx expleftv_ntav_nright introduc object h_nv_ntav_n also result lanczo procedur small dimens ktime k allow direct calcul remain exponenti mathrmlanczos_nlefta vright v_nexplefth_nrighte_ select set variabl tdexponentialmethod code lanczo actual calcul exponenti octopu recurs gener quantiti h_n v_n converg criterion ndash control variabl tdlanczostol ndash met order exce maximum allow order control variabl tdexpord latter case warn written care taken choos converg paramet small enough avoid faulti evolut perform timepropag actual perform timepropag necessari prerequisit groundstat densiti see manual calculationsground_st ground state system consider variabl calculationmod set code td besid alreadi mention input variabl concern propag method two import paramet set variabl tdtimestep variabl tdmaxstep first one set delta second set number iter conveni defin two variabl like length propag dt length time step variabl tdmaxstep tdt variabl tdtimestep dt absenc perturb system total energi constant check determin reason time step done calcul relev part octopu output might look like text iter time energi elaps time energi print third column remain constant gener larger time step desir shorten comput propag time keep mind size time step limit maximum frequenc abl observ consequ also extern perturb might wish expos system extern field delta kick calcul absorpt spectrum obtain linear optic absorpt spectrum system follow scheme propos yabana bertsch excit frequenc system give small momentum mathcal k electron achiev transform groundstat wavefunct accord varphi_ir delta ei mathcal k z varphi_ir propag wavefunct finit time spectrum obtain express dipol strength function somega somega frac omegapi mathcal im alphaomega dynam polariz alphaomega essenti fourier transform dipol moment system dt alphaomega fracmathcalkint dt eiomega leftdtdright definit thomasreichekuhn fsum rule number electron n given integr n int domegasomega sum rule use check qualiti calcul anoth check energi conserv tddft respect extern field appli obtain spectrum recip octopu one follow step choos system linearli independ nonorthogon axe defin variabl variabl tdpolar default cartesian axe add electr kick use variabl variabl tddeltastrength valu small remain linear regim larg enough avoid numer error run timedepend simul independ direct involv run octopu time chang valu variabl tdpolarizationdirect time run move file code tdgeneralmultipol code tdgeneralmultipolesx code x run util manual external_utilitiesoctpropagation_spectrum octpropagation_spectrum laser calcul nonlinear optic properti follow evolut system influenc laser field treat dipol approxim although constraint remov harmon emiss spectrum calcul acceler dipol moment homega propto left int dt eiomega fracddt dt right propag charg densiti absorb boundari simul region either imaginari absorb potenti mask function first case add kohnsham potenti term v_rm effr v_rm ksrt v_rm absr v_rm ab zero inner region simul box rise smoothli till edg adjust height shape potenti select momenta absorb prevent unwant reflect boundari use mask wavefunct multipli timestep function inner simul region gradual goe border varphir rightarrow mr varphir absorb charg interpret ioniz probabl use estim photoelectron spectra box size big enough physic system perturb absorb boundari note wavefunct longer normal system slowli get charg symmetri dynam polariz trivial relat optic absorpt gener form x tensor reason shine light system polar three cartesian axe three case measur dipol molecul oscil along three cartesian axe usual mean obtain full dynam polariz molecul usual need appli differ perturb along x z set variabl tdpolarizationdirect howev molecul symmetri gener possibl reduc total number calcul even explain detail herehttpsnanobioehuesnod use formal octopu use variabl variabl tdpolar variabl tdpolarizationdirect variabl tdpolarizationequivax variabl tdpolarizationwprim block variabl tdpolar defin basi necessarili orthogon chosen maxim number equival axe variabl tdpolarizationdirect variabl tdpolarizationwprim vector specifi basi let us give coupl exampl methan molecul t_d symmetri mean respons ident direct mean need one propag obtain whole tensor propag perform direct wish could use input text variabl tdpolar variabl tdpolarizationdirect variabl tdpolarizationequivax variabl tdpolarizationwprim note could omit block variabl tdpolar variabl tdpolarizationwprim previou input file default valu let us look linear molecul case might think need two calcul obtain whole tensor one direct along axi molecul anoth axi perpendicular molecul fact need one special chosen direct field compon along axi molecul perpendicular let us assum axi molecul orient along xaxi use text variabl tdpolar sqrt sqrt sqrt sqrt sqrt sqrt variabl tdpolarizationdirect variabl tdpolarizationequivax variabl tdpolarizationwprim tri convinc three axe inde equival linearli independ final let us look gener planar molecul xy plane principl need two calcul reduc one symmetri present benzen case chose one polar axe plane two rotat degre plane text variabl tdpolarizationdirect sqrt sqrt sqrt sqrt variabl tdpolarizationequivax case need two run one variabl tdpolarizationdirect equal anoth equal note fewer equival axe variabl tdpolarizationwprim irrelev manualfoot prevcalculationsground_st nextcalculationscasida titl benzen seri manual well sodium atom bit trivial let tri someth harder benzen need geometri benzen abl play å text c c c c c c h h h h h h follow step previou exampl carbon hydrogen much harder pseudopotenti sodium probabl use tighter mesh also take much time manualfoot seri prevexampleshello world nextupd new version titl exampl weight children depth titl hello world seri manual first exampl take sodium atom favourit text editor creat file file inp text variabl calculationmod gs variabl coordin na input file essenti selfexplanatori note speci specifi variabl speci block octopu read inform pseudopotenti file default file locat inst_fil shareoctopuspp file also contain default valu variabl radiu variabl space run octopu exampl commandlin octopu output store file file everyth goe ok file look like text ___ ___ __ ___ _ ___ __ _ __ __ __ _ __ __ _ __ ____ _ _ __ jg _ program free softwar redistribut andor modifi term gnu gener public licens publish free softwar foundat either version option later version program distribut hope use without warranti without even impli warranti merchant fit particular purpos see gnu gener public licens detail receiv copi gnu gener public licens along program write free softwar foundat inc franklin street fifth floor boston run octopu version revis build time tue jan est configur option maxdim mpi sse option librari arpack berkeleygw etsf_io gdlib meti mpi netcdf newuoa parmeti parpack pfft scalapack sparskit architectur x_ c compil optlocalbinmpiccmpichmp usrbinclang c compil flag pipe arch x_ fortran compil optlocalbinmpifmpichmp optlocalbingfortranmp fortran compil flag pipe octopu swim dhcpdynmitedu darwin calcul start calcul mode input calculationmod gs read coordin coordin block speci read pseudopotenti file optlocalshareoctopuspppsfnapsf calcul atom pseudoeigenfunct speci na info l compon use local potenti info l maximum angular momentum consid number orbit total bound symmetri symmetri element cinf sigma symmetri group kh input spincompon unpolar input smearingfunct semiconduct input symmetrizedens state total electron charg number state state blocksiz info use default space b info use default space b info use default space b input curvmethod curv_uniform input derivativesstencil stencil_star parallel octopu run serial info gener weight finitediffer discret xgradient info gener weight finitediffer discret ygradient info gener weight finitediffer discret zgradient info gener weight finitediffer discret laplacian grid simul box type minimum speci na radiu b octopu run dimens octopu treat system period dimens main mesh space b volumepoint b inner mesh total mesh grid cutoff h grid cutoff ry info statesblock size mib input statesorthogon gram_schmidt hartre chosen poisson solver interpol scale function theori level input theorylevel dft exchangecorrel exchang slater exchang lda pam dirac proceed cambridg philosoph societi f bloch zeitschrift fuer physik correl perdew zunger modifi lda perdew zunger phi rev b modifi improv match low highr part input siccorrect sic_non input filterpotenti filter_non info pseudopotenti na radii local part local part b nonloc part b orbit b input relativisticcorrect non_relativist input absorbingboundari not_absorb approxim memori requir mesh global mib local mib total mib state real mib par_kpoint par_stat par_domain complex mib par_kpoint par_stat par_domain info gener extern potenti done info octopu initi complet info start calcul mode info alloc ground state wavefunct info block state block contain state info groundstat alloc done warn could find restartg directori restart restart inform read warn unabl read wavefunct start scratch input mixfield densiti mix scf cycl input typeofmix broyden eigensolv input eigensolv cg input precondition pre_filt input subspacediagon standard input lcaostart lcao_ful input lcaoscalefactor input lcaomaximumorbitalradiu b info singleprecis storag extra orbit alloc info unnorm total charg info renorm total charg info set hamiltonian info perform initi lcao calcul orbit info get hamiltonian matrix element eta eigenvalu h st spin eigenvalu occup info groundstat restart inform written restartg info scf use real wavefunct info start scf iter eta scf cycl iter etot e abs_ev e rel_ev e abs_den e rel_den e matrix vector product converg eigenvector eigenvalu h st spin eigenvalu occup error e elaps time scf step eta scf cycl iter etot e abs_ev e rel_ev e abs_den e rel_den e matrix vector product converg eigenvector eigenvalu h st spin eigenvalu occup error e elaps time scf step eta scf cycl iter etot e abs_ev e rel_ev e abs_den e rel_den e matrix vector product converg eigenvector eigenvalu h st spin eigenvalu occup error e elaps time scf step eta scf cycl iter etot e abs_ev e rel_ev e abs_den e rel_den e matrix vector product converg eigenvector eigenvalu h st spin eigenvalu occup error e elaps time scf step eta scf cycl iter etot e abs_ev e rel_ev e abs_den e rel_den e matrix vector product converg eigenvector eigenvalu h st spin eigenvalu occup error e elaps time scf step info write state info finish write state info scf converg iter info finish write inform restartg calcul end walltim octopu emit warn take look work directori besid initi file file inp file file three new directori appear file static find file file info inform static calcul hope selfexplanatori otherwis pleas complain author file restart find file gs directori contain restart inform groundstat use exampl want start timedepend calcul afterward final file exec directori inform run octopu insid file parserlog contain input variabl pars octopu exercis studi total energi eigenvalu sodium atom improv mesh space calcul static polariz sodium atom variabl calculationmod em_resp file em_respfreq_alpha creat contain static polariz tensor calcul unoccupi state variabl calculationmod unocc eigenspectrum file file staticeigenvalu dont find rydberg seri eigenspectrum repeat previou calcul differ exchang correl function like pbe lb exact exchang see variabl xcfunction perform timedepend evolut variabl calculationmod td calcul optic spectrum na atom use variabl tddeltastrength polaris xdirect multipol moment densiti output file file tdgeneralmultipol process file util manualexternal_utilitiesoctpropagation_spectrum command octpropagation_spectrum obtain optic spectrum comput time wast rerun timedepend simul xc choic manualfoot seriesexampl prevdeprec util nextexamplesbenzen titl octxyzanim seri manual name octxyzanim construct anim xyz file timepropag file atom allow move synopsi command octxyzanim octxyzanim read standard input standard input simpli ignor input file name file inp must present run directori also octxyzanim accept command line argument sinc standard way fortran descript program one octopu util read file tdgeneralcoordin file make movi xyz format call moviexyz manualfoot prevmanualextern utilitiesoctvibrational_spectrum nextmanualdeprecated_util titl octrun period tabl seri manual name octrun_periodic_t run octopu atom synopsi command octrun_periodic_t option descript script one octopu util simpl script run octopu atom period tabl pseudopotenti avail flag h show messag flag n run dri run mode show would execut flag speci run octopu given speci flag run octopu atom flag r restart ie use variabl fromscratch ye flag temperatur run electron temperatur flag e no_stat use extra state flag x octopus_execut flag defaults_file_for_pseudopotenti exampl follow command would run octopu execut calcul atom commandlin octrun_periodic_t x octopu manualfoot prevmanualextern utilitiesoctpropagation_spectrum nextmanualextern utilitiesoctrun_regression_testpl titl octinfrar spectrum seri manual titl octphotoelectron spectrum seri manual titl octrun regress testpl seri manual doctyp html htmlheadtitleforbiddentitlehead bodyhforbiddenhpinvalid file extens found path info queri stringpbodyhtml titl octcentergeom seri manual name octcentergeom center molecul geometri synopsi bash octcentergeom octcentergeom read standard input standard input simpli ignor input file name file inp must present run directori also octcentergeom accept commandlin argument sinc standard way fortran descript program one octopu util read coordin defin file inp file construct output xyz file call file adjustedxyz file describ system atom coordin center option axe align control orient center molecul two paramet variabl mainaxi variabl axistyp forget chang input file use file instead old geometri chang variabl xyzcoordin valu adjustedxyz care unit util honour variabl unit variabl unitsinput variabl unitsoutput variabl file adjustedxyz file specifi output unit manualfoot prevmanualextern utilitiesoctcasida_spectrum nextmanualextern utilitiesoctcheck_dealloc titl octvdw c seri manual titl octloc multipol seri manual titl octoscillatorstrength seri manual titl octcheck dealloc seri manual titl extern util weight children depth titl octvibr spectrum seri manual util calcul vibrat spectrum moleculardynam run util read veloc file tdgeneralcoordin calcul veloc autocorrel function c_vtsum_in_atomsvecv_itcdotvecv_it_ afterward cosinusoid envelop ad make period extens function continu spectrum calcul take fourier transform function exit two file gener file tdgeneralvelocity_autocorrel file tdgeneralvibr util honour variabl variabl propagationspectrumstarttim variabl propagationspectrumendtim control time sampl note veloc initi time must differ zero c_v ident zero discret fourier tranform use util take sever minut process larg run octopu compil openmp support util run sever thread manualfoot prevmanualextern utilitiesoctvdw_c nextmanualextern utilitiesoctxyzanim titl octpropag spectrum seri manual name octpropagate_spectrum calcul absorpt cross section tensor result timepropag run synopsi command octpropagate_spectrum octpropagate_spectrum read standard input standard input simpli ignor input file name file inp must present run directori also octpropagate_spectrum accept command line argument sinc standard way fortran descript program one octopu util util gener dipol strength function given system main input tdgeneralmultipol file output written file call spectrum file made two column energi ev au depend unit specifi input file dipol strength function ev au idem input file user may set variabl propagationspectrumtransform set sine proper use variabl propagationspectrumdampmod recommend valu polynomi ensur fulfil nsum rule variabl propagationspectrumstarttim variabl propagationspectrumendtim variabl propagationspectrumenergystep variabl propagationspectrummaxenergi manualfoot prevmanualextern utilitiesoctphotoelectron_spectrum nextmanualextern utilitiesoctrun_periodic_t titl octconduct seri manual titl octconvert seri manual name octconvert octopu util read obj file write mani differ file format descript execut give abil read file written groundstat timedepend execut exampl run groundstat timedepend execut benzen examplebenzene_molecul add inp file want ground state densiti dx format bash variabl output densiti variabl outputformat dx variabl convertfold restartg variabl convertfilenam densiti variabl convertiteratefold convert restart wavefunct td run bash variabl output densiti variabl outputformat dx variabl convertiteratefold variabl convertfilenam variabl convertstart variabl convertend variabl convertfold restarttd want convert densiti timedepend execut file td td bash variabl output densiti variabl outputformat dx variabl convertiteratefold ye variabl convertstart variabl convertend manualfoot prevmanualextern utilitiesoctconduct nextmanualextern utilitiesoctdielectricfunct titl octhelp seri manual octhelp util help write input file avail sinc version octhelp two mode search bash octhelp search string mode octhelp print variabl name contain string name show bash octhelp show variabl mode octhelp print document indic variabl manualfoot prevmanualextern utilitiesoctharmonicspectrum nextmanualextern utilitiesoctinfrared_spectrum titl octdisplay partit seri manual name octdisplay_partit graphic represent mesh partit synopsi bash octdisplay_partit octdisplay_partit read standard input standard input simpli ignor also octdisplay_partit accept command line argument descript program one octopu util script use gnuplot plot partit mesh file emph todo file mesh_partit produc file debugmesh_partit octopu debug mode present current work directori script invok plot found file file mesh_partitionspng script gener gnuplotscript call file mesh_partitions_indexgp store current work directori load gnuplot manual bash gnuplot load mesh_partitions_indexgp gnuplot set term x gnuplot replot plot reproduc shown screen rotat zoom possibl manualfoot prevmanualextern utilitiesoctdielectricfunct nextmanualextern utilitiesoctharmonicspectrum titl octharmonicspectrum seri manual name octharmonicspectrum calcul harmon spectrum synopsi bash octharmonicspectrum octharmonicspectrum read standard input standard input simpli ignor input file name file inp must present run directori also octharmonicspectrum accept command line argument sinc standard way fortran descript program one octopu util notic note todo miss short descript program notic manualfoot prevmanualextern utilitiesoctdisplay_partit nextmanualextern utilitiesocthelp titl octanalyz project seri manual titl octrun testsuitesh seri manual name code octrun_testsuit script run octopu testsuit synopsi bash octrun_testsuit option descript script one octopu util script run octopu testsuit flag h print short help messag flag n run dri mode show would execut flag f run full testsuit flag l local run flag p prefix instal prefix default usr flag address mail report address exampl titl octatom occup seri manual script print standard output electron configur given atom way electron configur reflect variabl occup block correspond octopu input file option flag speci speci atom symbol eg na au etc flag h show brief summari command line option exampl bash octatomic_occup na bash octatomic_occup ti_sc bash x cat usrshareoctopusppdefault awk print octatomic_occup x done manualfoot prevmanualextern utilitiesoctanalyze_project nextmanualextern utilitiesoctcasida_spectrum titl octdielectricfunct seri manual titl octcasida spectrum seri manual name octcasida_spectrum broaden linearrespons spectra casida run mode synopsi bash octcasida_spectrum octcasida_spectrum read standard input standard input simpli ignor input file name file inp must present run directori also octcasida_spectrum accept command line argument sinc standard way fortran descript program one octopu util postprocess file file casidacasida file casidapetersilka file casidaeps_diff contain excit energi oscil strength paramet spectrum set use variabl variabl casidaspectrumbroaden variabl casidaspectrumminenergi variabl casidaspectrummaxenergi variabl casidaspectrumenergystep manualfoot prevmanualextern utilitiesoctatomic_occup nextmanualextern utilitiesoctcentergeom titl octopu manual section manual children depth titl copi section manual introduct realspac tddft code octopu octopu provid gnu gener public licens gpl version except extern librari contain sole conveni distribut find copi gpl licens httpswwwgnuorgcopyleftgplhtml copi except licens follow introduct licens except octopu provid sever extern librari locat external_lib subdirectori octopu sourc distribut gnu gener public licens appli librari separ copyright notic found librari respect subdirectori external_lib copyright notic also contain document current follow extern librari provid expokit roger b sidj depart mathemat univers queensland brisban qld australia email rbsmathsuqeduau www httpswwwmathsuqeduauexpokit copyright httpswwwmathsuqeduauexpokitcopyright text meti georg karypi depart comput scienc engin twin citi campu univers minnesota minneapoli mn usa email karypiscsumnedu www httpswwwuserscsumnedukarypismetisindexhtml meti copyright notic parmetismeti packag copyright regent univers minnesota freeli use educ research purpos nonprofit institut us govern agenc organ allow use parmetismeti evalu purpos use requir prior approv softwar may sold redistribut without prior approv one may make copi softwar use provid copi sold distribut use term condit unestablish research softwar code provid basi without warranti kind either express impli download execut part softwar constitut implicit agreement term term condit subject chang time without prior notic qshep robert renka univers north texa qshep copyright notic acm softwar copyright notic httpswwwacmorgpubstoccrnoticehtml copyright c associ comput machineri inc permiss includ applic softwar make digit hard copi part work subject follow licens agreement acm softwar licens agreement softwar binari sourc publish associ comput machineri hereaft softwar copyright associ hereaft acm ownership right titl interest softwar remain acm use copi softwar user agre abid term agreement noncommerci use acm grant hereaft user royaltyfre nonexclus right execut copi modifi distribut binari sourc code sole academ research similar noncommerci use subject follow condit user acknowledg softwar still develop stage suppli without support servic acm neither acm author make represent warranti express impli includ without limit represent warranti merchant fit particular purpos applic softwar infring patent proprietari right other acm shall held liabl direct indirect incident consequenti damag aris claim user third parti respect use allow agreement use softwar user agre fulli indemnifi hold harmless acm andor author origin work claim demand suit loss damag cost expens aris user use softwar includ without limit aris user modif softwar user may modifi softwar distribut modifi work third parti provid post separ clearli acknowledg contain materi copyright acm b charg associ copi c user agre notifi acm author distribut user clearli notifi secondari user modifi work origin softwar user agre acm author origin work other may enjoy royaltyfre nonexclus licens use copi modifi redistribut modif softwar made user distribut third parti deriv work agreement agreement termin immedi upon user breach noncompli term user may held liabl copyright infring infring proprietari right softwar caus facilit user failur abid term agreement agreement constru enforc accord law state new york applic contract perform entir within state parti irrevoc consent exclus jurisdict state feder court locat citi new york disput concern agreement commerci use user wish make commerci use softwar must contact acm permissionsacmorg arrang appropri licens commerci use includ integr incorpor part sourc code product sale licens behalf user third parti distribut binari sourc code third parti use commerci product sold licens behalf user revis manualfoot prevmanualappendixrefer manual nextmanu titl spack draft true titl easybuild draft true titl direct instal use system compil weight titl specif architectur seri manual notic note page need updat notic manual instal gener instruct build octopu supplement instruct specif larg supercomput includ also configur option etsf_io librari run testsuit parallel gener ubuntu instal follow packag bash requir gfortran gcc make automak libtool libgsldev libblasdev liblapackdev libfftwdev option mpidefaultdev libgdxpmdev libsparskitdev libnetcdfdev libtrilinosdev unfortun use ttlibblacsmpidev libscalapackmpidevtt packag give incorrect result use blac scalapack option must build first download libxchttpswwwtddftorgprogramslibxcdownload extract code tar xzf enter result directori execut bash configur prefixpwd ccgcc fcgfortran fccpplibcpp ansi freestand fcflagso ffreelinelengthnon cflagso make instal make check octopu download extract execut follow insert path put libxc bash configur prefixpwd ccgcc cxxg fcgfortran fccpplibcpp ansi freestand fcflagso ffreelinelengthnon cflagso withlibxcprefixlibxc_path make instal use mpi replac compil ttccusrbinmpicc cxxusrbinmpicxx fcusrbinmpiftt add ttenablempitt build etsf_io option ttlibnetcdfdevtt requir bash configur prefixpwd ccgcc fcgfortran fcflagso ffreelinelengthnon cflagso withnetcdfldflagslnetcdff make instal add ttwithetsfioprefixdiretsf_iott octopu configur line ttdiretsf_iott instal etsf_io aug gener maco octopu avail macport info build hand macport librari see compiling_octopus_in_os_x unit state expand sequoiavulcan ibm blue geneq supercomput lawrenc livermor nation laboratori base ibm blue geneq architectur test vulcan work sequoia well httpscomputingllnlgovtutorialsbgq bash export libs_blaslusrlocaltoolsessllib lesslsmpbg export libs_lapackusrlocaltoolslapacklibliblapacka export libs_fftlusrlocaltoolsfftwlib lfftw_omp export fc_integer_s export cc_fortran_intint export ccmpixlc_r export fcmpixlf_r export ldflagsqsmpomp export cflagsg export fcflagscflag qxlfautodealloc qessl configur withlibxcprefixhom prefixhom hostpowerpcunknownlinuxgnu buildpowerpcunknownlinuxgnu withgslprefixhom enableopenmp enablempi build use scalapack expand expand stamped pflop pf dell linux cluster base dell poweredg server node outfit intel xeon e sandi bridg processor intel xeon phi coprocessor mic architectur texa advanc comput center univers texa austin usa httpsportaltaccutexaseduuserguidesstamped bash modul swap mvapich impi modul load fftw gsl hdf netcdf mkl_dirmklroot configur prefixpwd ccmpicc fcmpif cflagso fcflagso enablempi withblaslmkl_dirlibintel wlstartgroup lmkl_intel_lp lmkl_sequenti lmkl_core wlendgroup lpthread withfftwprefixtacc_fftw_dir withnetcdfprefixtacc_netcdf_dir enablenewuoa withlibxcprefixpwdlibxc withblacsmkl_dirlibintellibmkl_blacs_intelmpi_lpa withscalapackmkl_dirlibintellibmkl_scalapack_lpa make j instal libxc bash configur prefixpwd ccmpicc fcmpif fcflagso cflagso make j instal make check testsuit script bash usrbinenv bash sbatch n sbatch p develop sbatch sbatch exportal modul load perl workdirpwd export tempdirpathscratchtmp cd homeoctopu export oct_test_njob export mpiexecwhich ibrun make check workdirmakecheck septemb expand expand edison cray xc nation energi research scientif comput center nersc lawrenc berkeley nation laboratori usa httpswwwnerscgovnuserssystem bash modul load crayfftw gsl craynetcdfhdfparallel parpack configur prefixpwd withlibxcprefixusrcommonusglibxcintelivybridg enablempi cccc cxxcc fcftn fcflagsfast noipo cflagsfast noipo fccpplibcpp ffreestand withfftwprefixfftw_dir witharpackarpack withparpackno withberkeleygwprefixusrcommonsoftwareberkeleygw make j instal run testsuit parallel bash binbash l sbatch j pulpo sbatch n sbatch p regular sbatch sbatch exportal cd homeedisonoctopu export omp_num_thread export mpiexecwhich srun export tempdirpathscratchtmp export oct_test_njob make check slurm_submit_dirmakecheck build etsf_io option test fail bash modul load craynetcdfhdfparallel configur prefixpwd fcftn fcflagsfast noipo cccc cflagsfast noipo withnetcdfmodulepathnetcdf_dirinclud withnetcdfprefixnetcdf_dir make j instal make check version juli expand expand cori cray xc nation energi research scientif comput center nersc lawrenc berkeley nation laboratori usa httpswwwnerscgovuserscomputationalsystemscori bash modul load crayfftw gsl craynetcdfhdfparallel parpack libxc use instal version instead bash configur prefixpwd cccc fcftn fcflagsfast noipo cflagsfast noipo make j instal make check octopu note use parpack caus scalapack problem bash configur prefixpwd withlibxcprefixusrcommonsoftwarelibxcintelhaswel enablempi cccc cxxcc fcftn fcflagsfast noipo cflagsfast noipo fccpplibcpp ffreestand withfftwprefixfftw_dir witharpackarpack withparpackno withberkeleygwprefixusrcommonsoftwareberkeleygw make j instal run testsuit parallel bash binbash l sbatch j pulpo sbatch n sbatch c haswel sbatch p regular sbatch sbatch exportal cd homecorioctopu export omp_num_thread export mpiexecwhich srun export tempdirpathscratchtmp export oct_test_njob make check slurm_submit_dirmakecheck build etsf_io option test fail bash modul load craynetcdfhdfparallel configur prefixpwd fcftn fcflagsfast noipo cccc cflagsfast noipo make j instal make check juli expand expand lonestar dell linux cluster texa advanc comput center tacc univers texa austin usa part nation scienc foundat httpsteragridorg teragrid httpsservicestaccutexaseduindexphplonestaruserguid bash modul load gsl modul load mkl modul load netcdf modul load fftw cd libxc configur prefixpwd enablempi ccmpicc fcmpif fmpif fcflagso cflagso make instal cd export slkpathoptappsintel_mvapich__scalapacklib configur prefixpwd enablempi ccmpicc fcmpif withblaswlstartgroup tacc_mkl_liblibmkl_intel_lpa tacc_mkl_liblibmkl_sequentiala tacc_mkl_liblibmkl_corea wlendgroup lpthread withfftlibltacc_fftw_lib lfftw withnetcdfprefixtacc_netcdf_dir disablegdlib withetsfioprefixhomeetsf_io enablenewuoa withlibxcprefixpwd withblacsslkpathlibscalapacka slkpathblacs_mpilinuxa slkpathblacsfinit_mpilinuxa slkpathblacs_mpilinuxa make instal build etsf_io bash modul load netcdf configur prefixpwd fcmpif withnetcdfmodulepathtacc_netcdf_inc withnetcdfldflagsltacc_netcdf_lib fcflagso make instal make check run testsuit parallel bash binbash n test_pulpo cwd pe way q develop l h_rt v cd homeoctopu export tempdirpathscratchtmp tempdirpath mkdir tempdirpath fi export mpiexecwhich ibrun export oct_test_nproc make check makecheck may expand expand lawrencium dell linux cluster lawrenc berkeley nation laboratori usa cluster avail lawrenc berkeley nation laboratori research httpslrclblgovhtmllawrenciumhtml bash modul load icc modul load ifort modul load mkl modul load openmpiintel modul load netcdfintel modul load fftwintel modul load autoconf modul load gslintel modul load gdlib modul load libtoolb bash configur prefixpwd ccmpicc fcmpif cflagso fcflagso check bound enablempi withblaslmklrootlibintel wlstartgroup lmkl_intel_lp lmkl_sequenti lmkl_core wlendgroup lpthread withfftliblglobalsoftwarecentosx_modulesfftwintellib lfftw withnetcdfprefixnetcdf withnetcdfincludenetcdfinclud enablenewuoa withlibxcprefixpwd withblacsmkl_dirlibintellibmkl_blacs_openmpi_lpa withscalapackmkl_dirlibintellibmkl_scalapack_lpa build etsf_io bash modul load netcdfintelp configur prefixpwd ccmpicc fcmpif cflagso fcflagso withnetcdfmodulepathnetcdf_dirinclud withnetcdfldflagslnetcdf_dirlib lnetcdf aug expand europ expand curi pfft bigdft curi supercomput own genci oper tgcc cea first french tier system open scientist french particip prace research infrastructur curi offer differ fraction x comput resourc address wide rang scientif challeng offer aggreg peak perform petaflop gener inform httpswwwhpcceafrencomplexetgcccuriehtm compil pfft version libisf taken bigdft previous compil bash binbash modul load cintel modul load fortranintel modul load bullxmpi modul load mkl modul load gsl wprefixworkdirsoftwar prefixhomesoftwar export isf_homeworkdirsoftwarelibisf export ccmpicc export cflagsxhost ip precdiv staticintel sox iisf_homeinclud export fcmpif export fcflagsxhost ip precdiv staticintel sox iprefixfftwinclud iisf_homeinclud export libs_blasmkl_lib export libs_fftwlstartgroup lprefixpfftlib lprefixfftwlib lpfft lfftw lfftw_mpi wlendgroup export ldflagsldflag lisf_homelib lisfsolv lrt configur prefixwprefixoctopussuperciliosus_pfft disableopenmp withlibxcprefixwprefixlibxcx disablegdlib withgslprefixusrlocalgsl enablempi enablenewuoa withpfftprefixprefixpfft bigdft configur like bash binbash export fcmpif configur withextlinalglmkl_intel_lp lmkl_sequenti lmkl_core lm withextlinalgpathlusrlocalintel_compilersccomposer_xe__spmkllibintel prefixworkdirsoftwarebigdft pfft bigdft bash binbash modul load cintel modul load fortranintel modul load bullxmpi modul load mkl modul load gsl wprefixworkdirpoissonsoftwar wlprefixworkdirpoissonloc export isf_homewlprefixlibisf export fftw_homewlprefixfftw export pfft_homewlprefixpfftalpha export ccmpicc export cflagsxhost ip precdiv staticintel sox iisf_homeinclud export fcmpif export fcflagsxhost ip precdiv staticintel sox ifftw_homeinclud iisf_homeinclud export libs_blasmkl_lib export libs_fftwlstartgroup lpfft_homelib lfftw_homelib lpfft lfftw lfftw_mpi wlendgroup export ldflag lusrlib lisf_homelib lpsolver lrt export ld_library_pathisf_homelibld_library_path configur prefixwprefixoctopussuperciliosus_pfft disableopenmp withlibxcprefixwprefixlibxc disablegdlib withgslprefixusrlocalgsl enablempi enablenewuoa withpfftprefixpfft_hom libisf compil bash binbash modul load cintel modul load fortranintel modul load bullxmpi modul load mkl modul load gsl export fcmpif configur withextlinalglmkl_intel_lp lmkl_sequenti lmkl_core lm withextlinalgpathlusrlocalintel_compilersccomposer_xe__spmkllibintel prefixworkdirpoissonlocallibisf disablelibbigdft disablebinari enabledynamiclibrari fftw compil script httpswwwusertuchemnitzdempipsoftwareinstall_fftw_gccsh chang follow bash myprefixhomeloc modul load cintel modul load fortranintel modul load bullxmpi modul load mkl modul load gsl myprefixworkdirpoissonloc c wget httpswwwfftworgfftwfftw_versiontargz wget httpswwwfftworgfftwfftw_versiontargz cp fftwfftw_versiontargz c configur prefixinstalldir enablempi enableopenmp enableshar configur prefixinstalldir enablempi enableopenmp enableshar disableshar pfftw compil script httpswwwusertuchemnitzdempipsoftwareinstall_pfftalpha_gccsh chang follow bash myprefixhomeloc modul load cintel modul load fortranintel modul load bullxmpi modul load mkl modul load gsl myprefixworkdirpoissonloc c wget httpswwwtuchemnitzdempipsoftwarepfftpfft_versiontargz wget httpswwwtuchemnitzdempipsoftwarepfftpfft_versiontargz cp pfftpfft_versiontargz expand expand fermijuqueen ibm blue geneq cineca itali gener inform httpswwwhpccinecaitcontentibmfermiuserguid exactli script test juqueen forschungszentrum jülich jülich supercomput centr jsc jülich germani gener inform httpswwwfzjuelichdeiasjscenexpertisesupercomputersjuqueenjuqueen_nodehtml bash binbash modul load gsl modul load lapack modul load blac modul load scalapack export pfft_homehomelocalpfftthreadsalpha export fftw_homehomelocalfftwthread export ld_library_pathpfft_homelibfftw_homelibld_library_path export fc_integer_s export cc_fortran_intint export ccmpicc export cflagsg wlrelax ipfft_homeinclud ifftw_homeinclud export fcmpif export fcflagscflag qxlfautodealloc qessl qsmpomp export libs_blaslesslsmpbg loptibmmathessllib lesslbg export libs_lapackllapack_lib llapack export libs_fftlfftw_homelib lfftw_mpi lfftw lm echo gsl dir gsl_home echo pfft dir pfft_home export ldflagsldflag roptibmcmplibbgbglib lbgsysdriversvrm__pppcgnulinuxpowerpcbgplinuxlib lbgsysdriversvrm__pppcgnulinuxlibgccpowerpcbgplinux loptibmcmpxlfbgbglib loptibmcmpxlmassbgbglib loptibmcmpxlsmpbgbglib lbgsysdriversvrm__pppcruntimespi lbgsysdriversvrm__pppccommsyslib lbgsysdriversvrm__pppccommdefaultlib lusrlocalzlibvlib lbgsysdriversppcfloorruntimespi lpfft_homelib lfftw_homelib lpfft lfftw_mpi lfftw lm ldl lxl lxlopt lrt lpthread svn_verssvn info grep revis awk print echo svn_ver configur prefixhomesoftwareoctopus_omp withlibxcprefixhomesoftwarelibxc_new withfftlibfftw_homeliblibfftwa fftw_homeliblibfftw_ompa hostpowerpcunknownlinuxgnu buildpowerpcunknownlinuxgnu disablegdlib disablefforal withblasloptibmmathlib lesslbg withlapackllapack_lib llapack withgslprefixgsl_hom enablempi enableopenmp build fftw small chang made script taken pippig web site httpswwwusertuchemnitzdempipsoftwarephplangen patch build mpi multithread multithread may work juqueen bash binsh e myprefixhomeloc fftw_version installdirmyprefixfftwthreadsfftw_vers tmptmpminefftwfftw_vers bash check directori exist tmp echo directori tmp alreadi exist delet yn read answer answer rm rf tmp els echo program abort exit fi fi mkdir tmp cd tmp wget httpswwwfftworgfftwfftw_versiontargz gzip dc fftwfftw_versiontargz tar xvf cd fftwfftw_version fix bug fftw alltoal routin caus deadlock patch b p eof mpitransposealltoallc mpitransposealltoallc sbope int pe b ptblock vn rbspe int db bt vn rbope int pe pblock bt vn sbspe b ptblock vn rbspe pblock bt vn dbt ptblock db pblock equal_block plnsend_block_s sb eof configur buildpowerpcbgqlinuxgnu hostpowerpcbgqlinux prefixinstalldir enablempi enableopenmp enablethread disableshar ccmpixlc_r fmpixlf_r mpiccmpixlc_r mpicxxmpixlcxx_r mpifcmpixlf_r mpilib cflagso g fcflagso g make j make instal build pfft also taken httpswwwusertuchemnitzdempipsoftwarephplangen bash binsh e myprefixhomeloc pfft_versionalpha fftw_version instdirmyprefixpfftthreadspfft_vers fftwdirmyprefixfftwthreadsfftw_vers tmptmpminepfftpfft_vers bash check directori exist tmp echo directori tmp alreadi exist delet yn read answer answer rm rf tmp els echo program abort exit fi fi mkdir tmp cd tmp wget httpswwwtuchemnitzdempipsoftwarepfftpfft_versiontargz gzip dc pfftpfft_versiontargz tar xvf cd pfftpfft_version configur buildpowerpcbgqlinuxgnu hostpowerpcbgqlinux prefixinstdir withfftwfftwdir mpiccmpif mpicxxmpicxx mpifcmpif ccmpicc fcmpif cflagso g qmaxmem fcflagso g qmaxmem disableshar make j make instal expand expand jugen fzjjsc ibm blue genep jülich supercomput centr jsc germani may also work blue genep comput gener inform httpswwwfzjuelichdejscjugen usag inform httpswwwfzjuelichdejscjugeneusag bash modul load gsl modul load lapack autoreconf export fc_integer_s export cc_fortran_intint export ccmpixlc_r export cflagsg qarchd export fcmpixlf_r export fcflagsg qarchd qxlfautodealloc qessl qsmpomp export libs_blaslesslsmpbg loptibmmathessllib lesslbg export libs_lapackllapack_lib llapack export libs_fftlbgsyslocalfftwlib lfftw lm configur prefixoutdir hostpowerpcunknownlinuxgnu buildpowerpcunknownlinuxgnu disablegdlib withgslprefixgsl_dir enablempi enableopenmp run chang work directori run loadlevel exampl tutori httpswwwtddftorgprogramsoctopuswikiindexphptutorialbenzene_molecul execut node smp mode thread per chip execut mode hybrid openmpmpi exampl job input script bash job_nam octopus_sample_ comment bgp job size error job_namejobidout output job_namejobidout environ copy_al wall_clock_limit notif error notify_us foogmailcom job_typ bluegen bg_size queue mpirun exe octopus_homebinoctopus_mpi mode smp verbos execut script bash llsubmit executing_script expand expand marenostrum ii marenostrum supercomput europ power spain one seven supercomput spanish supercomput network supercomput consist js blade comput node dualcor ibm bit powerpc mp processor run ghz cpu total comput node marenostrum commun primarili myrinet may need compil gsl fftw librari start instal script build octopu bash binbash export ld_library_pathusrlib export ccmpicc export fcmpif export cflagsq qtuneppc qarchppc qcacheauto qnostrict qignerrno qinlglu export fcflagscflag qessl qxlfautodealloc export libs_blaslusrlib lessl configur withlapackgpfsappslapacklibliblapacka disablegsltest disablegdlib withgslprefixoutdirgsl withfftliboutdirfftliblibfftwa prefixoutdir enablempi disablefforal see script withgslprefix point gsl withfftlib fftw compil cflag fcflag exampl configur gsl use gsl bash configur prefixoutdirgsl ccgcc enablestat disableshar use fftw configur fftw write bash configur prefixoutdirfft recent marenostrum chang slurm manag execut job submit jobsubmit detail httpswwwbscesmediapdf user guid expand expand marenostrum iii marenostrum iii supercomput base intel sandybridg processor idataplex comput rack linux oper system infiniband interconnect inform httpswwwbscesmarenostrumsupportservicesmn bash modul load mkl modul load gsl export prefixhomesoftwar export fftw_homehomelocalfftw export pfft_homehomelocalpfftalpha export mkl_libsmkl_homelibintel export mklrootmkl_hom export mkl_libslmklrootlibintel lmkl_scalapack_lp lmkl_intel_lp lmkl_intel_thread lmkl_core lmkl_blacs_intelmpi_lp lpthread lm export ccmpicc export cflagsxhost ip precdiv staticintel sox iisf_homeinclud openmp imklrootinclud export fcmpif export fcflagsxhost ip precdiv staticintel sox ifftw_homeinclud openmp iisf_homeinclud imklrootinclud export libs_blasmkl_lib export libs_fftwlstartgroup lpfft_homelib lfftw_homelib lpfft lfftw lfftw_mpi wlendgroup configur prefixprefixoctopu enableopenmp withlibxcprefixprefixlibxc disablegdlib withgslprefixappsgsl enablempi enablenewuoa withpfftprefixpfft_hom expand expand corvo corvo comput cluster nanobio spectroscopi group consist processor core gib ram connect infiniband network script build libfm librari includ scafaco librari modifi scafaco svn version valid sinc version octopu bash configur enablefcssolversfmmdirect enablefcsfmmcommarmci enablefcsfmmunrol enablefcsfmmmaxmpol cflagso cxxflagso fcflagso disabledoc cxxmpic ccmpicc fcmpif prefixhomesoftwarescafaco ldflagsloptscalapacklib loptblacslib loptgotoblaslib loptnetcdflib loptlapacklib loptetsf_iolib enablefcsintint enablefcsfloatdoubl enablefcsintegerinteg enablefcsrealr make make instal script compil fftw pfft sh binsh e myprefixhomeloc fftw_version installdirmyprefixfftwfftw_vers tmptmpfftwfftw_version bash check directori exist tmp echo directori tmp alreadi exist delet yn read answer answer rm rf tmp els echo program abort exit fi fi mkdir tmp cd tmp wget httpswwwfftworgfftwfftw_versiontargz gzip dc fftwfftw_versiontargz tar xvf cd fftwfftw_version fix bug fftw alltoal routin caus deadlock patch b p eof mpitransposealltoallc mpitransposealltoallc sbope int pe b ptblock vn rbspe int db bt vn rbope int pe pblock bt vn sbspe b ptblock vn rbspe pblock bt vn dbt ptblock db pblock equal_block plnsend_block_s sb eof configur prefixinstalldir enablempi enableopenmp enablethread disableshar ccmpicc fmpif mpiccmpicc cflagso fflagso mpilib make j make instal bash binsh e myprefixhomeloc pfft_versionalpha fftw_version instdirmyprefixpfftpfft_vers fftwdirmyprefixfftwfftw_vers tmptmppfftpfft_version modul unload fftw bash check directori exist tmp echo directori tmp alreadi exist delet yn read answer answer rm rf tmp els echo program abort exit fi fi mkdir tmp cd tmp export ccmpicc export fcmpif wget httpswwwtuchemnitzdempipsoftwarepfftpfft_versiontargz gzip dc pfftpfft_versiontargz tar xvf cd pfftpfft_version configur prefixinstdir withfftwfftwdir disableshar make instal scrip compil octopu pfft fmm support scafaco librari bash modul add gcc modul add ifort modul add gsl modul add etsf_io modul add lapack modul add netcdf modul add gotobla modul add mpibul modul add blac modul add scalapack export ccmpicc export fcmpif import optintelcompilerbinintel path export pathoptmpimpibullsbinoptnetcdfbinoptetsf_iobinoptgslbinoptintelcomposer_xe__spbininteloptgccbinoptslurmbinusrkerberosbinoptcudabinusrlocalbinbinusrbin export libfm_homehomesoftwarescafaco export pfft_homehomelocalpfftalpha export fftw_homehomelocalfftw export libs_pfftlpfft_homelib lfftw_homelib lpfft lfftw_mpi lfftw export cflag ipfft_homeinclud ifftw_homeinclud ilibfm_homeinclud export ldflagsldflag llibfm_homelib lpfft_homelib lfftw_homelib lpfft lfftw_mpi lfftw lm export fcflagscflag export cppflag ilibfm_homeinclud export ld_library_pathlibfm_homelibld_library_path configur enablempi withlibxcprefixhomesoftwarelibxc_ prefixhomesoftwareoctopu withblacsoptblacsliblibblacsa withscalapack withlibfmllibfm_homelib lfcsfortran lfc lfcs_direct lfcs_fmm lfcs_near lfcs_gridsort lfcs_common disableopenmp expand expand lapalma lapalma supercomput iac part old marenostrum ii comput possibl compil xl compil gnu version use previous octopu libxc fftw gsl openbla requir compil gsl bash export ld_library_pathusrlibgpfsappsmpichslurmlibgpfsappsgcclib export ccgpfsappsmpichmxdefaultbinmpicc ccgpfsappsgccbingcc export fcgpfsappsmpichmxdefaultbinmpif fcgpfsappsgccbingfortran configur prefixhomelocalgslgnu enablestat disableshar openbla bash make prefixhomelocalopenbla binari ccgpfsappsgccbingcc fcgpfsappsgccbingfortran libxc bash export pathgpfsappsmpichmxdefaultbinpath export ld_library_pathgpfsappsmpichmxdefaultlibgpfsappsmpichslurmlib export ld_library_pathgpfsappsgcclibhomelocalopenblaslibld_library_path export ccgpfsappsmpichmxdefaultbinmpicc ccgpfsappsgccbingcc export fcgpfsappsmpichmxdefaultbinmpif fcgpfsappsgccbingfortran export cflagsm export fcflagscflag configur prefixhomelocallibxcgnu octopu bash export pathgpfsappsmpichmxdefaultbinpath export ld_library_pathgpfsappsmpichmxdefaultlibgpfsappsmpichslurmlib export ld_library_pathgpfsappsgcclibhomelocalopenblaslibld_library_path export ccgpfsappsmpichmxdefaultbinmpicc ccgpfsappsgccbingcc export fcgpfsappsmpichmxdefaultbinmpif fcgpfsappsgccbingfortran export cflagsm pwdexternal_libsisfwrapp export fcflagscflag configur withblashomelocalopenblasliblibopenblasso withlapackgpfsappslapacklibliblapacka disablegdlib withgslprefixhomelocalgslgnu withfftlibhomelocalfftwliblibfftwa withlibxcprefixhomelocallibxcgnu prefixgpfsprojectsehusoftwareoctopusgnu enablempi disablefforal expand expand xbe locat univers hamburg hamburg login node node intel xeon basic configur script bash configur pathpathhomecommonlibgslintelbin ccmpiicc cflag marchn imklrootincludeintellp imklrootinclud fcmpiifort fcflagso imklrootincludeintellp imklrootinclud gsl_confighomecommonlibgslintelbingslconfig withgslprefixhomecommonlibgslintel withlibxcprefixlibxc_prefix withblasmklrootlibintellibmkl_blas_lpa mklrootlibintellibmkl_lapack_lpa wlstartgroup mklrootlibintellibmkl_intel_lpa mklrootlibintellibmkl_corea mklrootlibintellibmkl_sequentiala wlendgroup lpthread lm ldl withlapackmklrootlibintellibmkl_blas_lpa mklrootlibintellibmkl_lapack_lpa wlstartgroup mklrootlibintellibmkl_intel_lpa mklrootlibintellibmkl_corea mklrootlibintellibmkl_sequentiala wlendgroup lpthread lm ldl withfftlibhomecommonlibfftwintelliblibfftwa expand expand magerit cesvima magerit cluster locat centro de supercomputación visualización de madrid consist node eserv bladecent ps power processor core ghz gflop gb de ram optim configur script use gnu compil essl ibm librari bash modul purg modul load gcc modul load openmpi export libsdirswopenmpi export software_dirhomesoftwareexec export fcmpif export ccmpicc export cxxmpicxx export stdflagso mcpupow mtunepow export fcflagsstdflag export cflagsstdflag export cxxlagsstdflag export c_typegnuessl export branchawk print githead export branchbasenam branch installdirsoftware_diroctopusgitc_typebranch gsl compil gcc export gsl_homelibsdirgsl lapack gcc export lapack_homelibsdirlapackgnu parmeti gcc export parmetis_homelibsdirmetisparmeti meti gcc export metis_homelibsdirmetismeti fftw gcc export fftw_homelibsdirfftwgnu export ld_library_pathfftw_homelibld_library_path scalapack gcc export scalapack_homelibsdirscalapackgnu export ld_library_pathscalapack_homelibld_library_path libxc export libxc_homesoftware_dirlibxcc_typ libvdwxc export libvdwxc_homesoftware_dirlibvdwxcc_typ export cppflagsilibvdwxc_homeinclud dhave_libvdwxc export libslvdwxcfort export ldflagsllibvdwxc_homelib lvdwxcfort wlrpathlibvdwxc_homelib export ld_library_pathlibvdwxc_homelibld_library_path export ld_library_pathoptibmcmpliboptibmcmpxlsmpliboptibmcmpxlflibld_library_path export libs_bla lscalapack_homelib llapack_homelib lscalapack llapack lessl lblacssmp lfftw_homelib lfftw lfftw_thread lfftw_mpi optgnugccliblibgfortrana loptibmcmpxlflib lxlf_r lxlfmath lxl loptibmcmpxlsmplib lxlomp_ser wlrpath optibmcmpxlflib optibmcmpxlfliblibxla roptibmcmplib make distclean make clean configur prefixinstalldir disablegdlib disablegsltest withlibxcprefixlibxc_hom withfftwprefixfftw_hom withgslprefixgsl_hom withmetisprefixmetis_hom withparmetisprefixparmetis_hom enablempi enableopenmp expand expand mpcdf system draco cobra raven draco cobra raven hpc machin maxplanck comput data facil garch octopu built follow script bash binbash l compil script octopu need execut subfold eg _build root directori want skip configur step call build_octopussh noconfig want skip configur step depend check call build_octopussh noconfig nodep f configureac echo error pleas execut script subfold root directori exit fi compilerintel compilergnu cuday echo use compil compil cuda ye echo build cuda support modul purg compil intel newest intel version modul load intel impi mkl export ccmpiicc export fcmpiifort export cxxmpiicpc export cflagso xcoreavx qoptzmmusagehigh fma ip export fcflagscflag export cxxflagscflag export mkllmklrootlibintel lmkl_scalapack_lp lmkl_intel_lp lmkl_intel_thread lmkl_core lmkl_blacs_intelmpi_lp liomp lpthread lm ldl elif compil gnu modul load gcc impi mkl export ccmpicc export fcmpif export cxxmpicxx export cflagso marchskylakeavx g export fcflagscflag export cxxflagscflag export mkllmklrootlibintel lmkl_scalapack_lp lmkl_gf_lp lmkl_gnu_thread lmkl_core lmkl_blacs_intelmpi_lp lgomp lpthread lm ldl els echo compil compil unknown exit fi modul load gsl hdfserial netcdfseri libxc meti parmeti export ldflagsxlink rpathmkl_homelibintelgsl_homelibnetcdf_homelibelpa_homelibmetis_homelibparmetis_homelib cuda ye modul load cuda cuda_flagsenablecuda enablenvtx withcudaprefixcuda_hom ldflagsldflagscuda_homelib els cuda_flag fi modul list export installdirpwdinstal noconfig pushd autoreconf popd configur cuda_flag fcflags_fftwimklrootincludefftw fccppcpp ffreestand prefixinstalldir enablempi enableopenmp disablegdlib withgslprefixgsl_hom withlibxcprefixlibxc_hom withblasmkl withlapackmkl withblacsmkl withscalapackmkl withnetcdfprefixnetcdf_hom withmetisprefixmetis_hom withparmetisprefixparmetis_hom exit fi echo nnbuild octopusn nodep make nodep j make nodep instal exit els make j make instal exit fi mkdir p installdirbuilddoc cp f configlog installdirbuilddoc cp f installdirbuilddoc echo done expand manualfoot prevtutorialrun octopu graphic process unit gpu nextmanualappendixport octopu platform specif instruct titl instal weight children depth titl port octopu platform specif instruct seri manual notic note page need updat notic page contain inform octopu portabl specif inform compil run octopu mani architectur manag compil octopu differ system pleas contribut warn inform quit date may longer valid gener inform tip compil octopu develop name gnu environ sometim depend system featur name gnu extens without know bug tri fix pleas report problem find problem c compil tri use name gcc normal work better vendor compil avail system howev care local instal version gcc sometim dont work name fortran code concaten oper sometim recogn name c style comment preprocessor give erron result sometim doesnt expand macro simpli elimin come solv problem use preprocessor name c keep comment name ansi equival option name ansi c code comment compil dual bit architectur like name powerpc name ultrasparc name amd system tip bit version octopu need go use name gb physic name ram oper system bit name kernel bit name userspac name solari name os x want bit octopu compil requir librari bit normal bit name libc avail typic linux distribut emph name amd bit name userspac get bit execut sse support sse code written use compil primit give import increas perfom need hardwar support amd opteronathlon sempronturion intel pentium newer compil support support compil gcc pathcc gcc need put correct flag march flag exampl code nowikimarchopteronnowiki code nowikimarchpentiumnowiki besid name x bit link dynam use tweak malloc function doesnt work static link x_ bit need oper system linux main develop oper system octopu solari octopu compil correctli either sun compil gccgfortran default name solari doesnt name gnu coreutil test wont run tru work mac os x work dont tri compil static binari support os window toy oper system support moment sorri compil intel compil xx_ statu ok version version build z ok version problemat recommend flag fcflagsu zero fpp nb pc pad align unrol ip tpp xw name intel artifici block compil use certain optim non name intel processor octopu use flag ttcheck tracebacktt ttiforttt caus intern compil segment fault compil ttsrcgridmesh_initftt intel compil itanium statu ok version older releas version report caus problem version work much slower recommend flag fcflagso tpp ip ipf_fp_relax ftz align pad cflagso tpp ip ipf_fp_relax ftz openhttpswwwopennet open sourc compil base liber code sgi mipspro compil avail x x_ itanium architectur pathscal fortran compilerhttpswwwpathscalecom version test architecur x amd recommend flag text fcflagswal marchauto mcpuauto optofast fnomatherrno issu everyth work necessari compil blaslapack compil nag compil amd text fcflagscolour kindbyt mismatch_al abi ieeeful ounrol gnu c compil gcchttpsgccgnuorg gnu fortran gfortranhttpsgccgnuorgfortran statu ok version gcc version newer emph work parallel version need least gfortran may also need compil bla lapack fftw use specif gfortran version recommend flag ttmarchathlon msse mfpmathss maligndoubl funrollloop ott httpswwwgorg g statu work test architectur xlinux powerpcdarwin version version g may g doesnt recogn linemark creat preprocessor necessari pass p flag cpp flag text fcg fcflagso funrollloop ffastmath fccppcpp ansip may problem version depend underli version gcc see g info build version gcc portland flag text fcflagsfast mcmodelmedium known problem follow problem pgi compil version mpich version name x_ report mpi detect command configur step work properli may lead compil failur e g file file par_vecf problem consid bug either pgi compil mpich implement pleas appli follow chang hand run command configur file file configh replac line text undef mpi_h text defin mpi_h remov line text defin mpi_mod portland flag test cray xt text fcflagso munrollc mnofram mlre mscalarss mcache_align mflushz configur script may fail part ttcheck fortran librari mpiftt ttautoconftt version earlier solut updat ttautoconftt later manual set ttfclibstt ttconfigurett command line remov spuriou apostroph portland octopu file ttsrcbasiclookupftt incorrectli optim yield mani segment fault testsuit pgi optim flag ttott less pgi optim flag ttott less note ttfasttt ttfastssett ttott ttott later version octopu pgi pragma compel file ttott regardless specifi ttfcflagstt may safe set ttfcflagstt ttfasttt portland work crash glibc memori corrupt error fine portland compil due intern compil error form text pgfsintern compil error sym_of_ast unexpect ast simul_boxf ok absoft flag x text fcflagso yext_nameslc yext_sfx_ flag amdemt text fcflagso mcmodelmedium cpuhost yext_nameslc yext_sfx_ compaq compil text fcflagsalign dcommon fast tune host arch host noautomat xlf statu work bmaxdatax qmaxmem qsuffixff q qstrict qtuneauto qarchauto qhot qipa exot mixtur name mac os name bsd system standard compil octopu problemat name os x doesnt support static link binari dont tri sgi mip inlin n langrecursiveon sun studio download compil free support linux solari x amd sparc fast compil quit buggi flag cflagsfast xprefetch xvectorsimd d__sse__ fcflagsflag mpi implement openmpi mpich sgi mpthttpswwwsgicomproductssoftwarempt intel mpi sun hpc clustertoolshttpswwwsuncomsoftwareproductsclustertool mvapichhttpsmvapichcseohiostateedu netcdf octopu use fortran interfac name netcdf mean like compil use compil use compil octopu get sourc follow instal instruct httpswwwunidataucaredusoftwarenetcdf name netcdf site bla lapack standard librari provid seri common vector matrix oper octopu use much possibl librari sever version avail depend hardwar around octopu execut time spend bla level routin get fast implement hardwar might import hand lapack perform import amd acml amd mathemat librari optim run athlon opteron processor get free copi httpsdeveloperamdcomacmljsp atlashttpsmathatlassourceforgenet compaq cxml goto bla probabl fastest implement bla sourc code avail compil mani architectur intel mkl see httpssoftwareintelcomenusarticlesintelmkllinklineadvisor mkl advic proper way link exampl code withlapack left blank includ code withbla text mkl_diroptintelmklliblintel withblaslmkl_dir wlstartgroup lmkl_intel_lp lmkl_sequenti lmkl_core wlendgroup lpthread withblacsmkl_dirlibmkl_blacs_intelmpi_lpa withscalapackmkl_dirlibmkl_scalapack_lpa netlib refer implement bla lapack avail linux distribut get sourc code httpswwwnetliborgbla httpswwwnetliborglapack manualfoot prevmanualspecif architectur nextmanualappendixrefer manual titl build scratch seri manual compil octopu system might difficult mainli librari requir compil fortran compil guid compil octopu requir librari start scratch fortran compil requir standard unix system notic note page consid last resort system abl instal mani depend packag manag prebuilt binari save lot effort notic prerequisit need follow standard unixlinux system want instal octopu basic knowledg use system manag file edit text file extract tar archiv etc directori instal creat binari special creat directori even code home assum directori basedir whenev appear replac actual directori use note file download directori sourc includ one octopu dont need place directori work c compil name gcc ideal choic name xx_ system platform might want choos compil produc optim code assum command run compil cc work fortran compil dont one probabl get httpsgccgnuorgfortran name gfortran httpswwwgorg name g assum command run fortran compil f compil dual bit architectur good idea tell compil explicitli type binari want mani problem caus unadvertedli mix bit code octopu normal want bit binari code flag compil sinc flag pass alway recommend includ compil command use guid sometim optim flag left exampl cc could command gcc compil flag sinc probabl want octopu run fast probabl would set optim flag c fortran compil system least gener octopu run fine aggress optim option assum found set flag cc f call cflag fflag exampl cflag could command marchn notic note cc f cflag fflag contain space enclos put explicitli necessari notic compil librari first compil instal librari requir octopu bla first librari compil name bla use gener refer implement version highli optim free softwar simpl instal work version octopu may want use optim name bla implement httpswwwtaccutexaseduresourcessoftwarebla name libgoto httpsmathatlassourceforgenet name atla name mkl name acml name essl etc download packag name netlib site httpswwwnetliborgblasblastgz extract packag enter newli creat file bla directori edit file makeinc file modifi definit fortran compil bash fortran f opt fcflag drvopt opt noopt loader f loadopt type command make compil take one compil finish creat directori basedir file lib bash mkdir basedir lib copi file file blas_linuxa basedir file liblibblasa bash cp blas_linuxa basedir liblibblasa notic note note gener file librrari alway call file blas_linuxa independ oper system use name notic lapack use open sourc refer implement lapack get lapak packag netlib httpswwwnetliborglapacklapacktgz extract archiv enter newli creat lapack directori copi file makeincexampl file makeinc bash cp makeincexampl makeinc edit file makeinc indic compil use relev part file look like bash fortran f opt fcflag drvopt opt noopt loader f loadopt build librari bash make lib copi newli creat librari file lapack_linuxa file basedirlibliblapacka gsl get sourc latest version gsl ftpftpgnuorggnugsl current gsl ftpftpgnuorggnugslgsltargz extract archiv enter newli creat directori run configur script bash configur cc cc prefix basedir disableshar enablestat compil instal bash make make instal fftw get sourc latest version httpswwwfftworg fftw current httpswwwfftworgfftwtargz extract archiv enter newli creat directori configur bash configur prefix basedir cc cc cflag cflag f f fflag fflag compil instal bash make make instal libxc get libxc current httpswwwtddftorgprogramsoctopusdownphpfilelibxclibxc libxcvers targz extract archiv enter newli creat directori bash tar xvzf libxc libxcvers targz cd libxc libxcvers configur bash configur prefix basedir cc cc cflag cflag fc f fcflag fcflag compil instal bash make make instal compil octopu compil librari readi compil octopu step follow download last version octopu httpswwwtddftorgprogramsoctopusdownphpfil octopusvers octopu octopusvers targz extract file enter newli creat directori defin follow environ variabl use configur script assum use name bash use anoth shell command modifi accordingli bash export libs_bla basedir liblibblasa export libs_lapack basedir libliblapacka export libs_fft basedir liblibfftwa call configur script bash configur cc cc cflag cflag fc f fcflag fcflag prefix basedir withgslprefix basedir withlibxcprefix basedir compil instal bash make make instal everyth went fine octopu instal basedir directori mean execut basedir file bin may want add last directori path run octopu command directli otherwis give full path test compil correct run testsuit octopu compar result obtain creat version refer valu run bash make check test pass compil correct fail probabl problem execut typic miss dynam librari fail might seriou problem recommend look help mail list manualfoot prevmanualupd new version nexttutorialrun octopu graphic process unit gpu titl updat new version seri manual page list issu may appear updat new version octopu solv octopu variabl variabl speci block take emph set option choos pseudopotenti set use default variabl xcfunction taken possibl pseudopotenti octopu variabl unitsinput unit variabl remov input file valu alway atom unit unless explicitli state otherwis correspond variabl descript constant avail help use evangstrom unit input file one write code space angstrom default code assum xyz file angstrom chang use variabl unitsxyzfil variabl octopu instal compil support fortran iso_c_bind requir execut alway call file octopu longer file octopus_mpi compil parallel version support libxc although still possibl use libxc x version updat libxc highli recommend variabl new format variabl speci block name speci option revis variabl outputhow renam variabl outputformat variabl parallelizationstrategi parallelizationgrouprank replac variabl pardomain variabl parstat variabl parkpoint variabl paroth util file octrotatory_strength util remov util replac new variabl propagationspectrumtyp file octpropagation_spectrum octopu restart file version break backward compat restart file nevertheless difficult updat restart file gener previou version summari chang updat file casida restart data goe directori file restartcasida file file kernel file kernel_triplet one need creat directori renam file format file occ file chang addit extra field imaginari part eigenvalu updat file one need add column zero hand column eigenvalu line start emph fft_alpha remov file mesh file note mesh partit restart also compat case partit need recalcul usual problem variabl variabl chang name chang format obsolet variabl found octopu stop tell variabl replac dataset featur remov input file calcul use dataset need split sever independ input file octopu instal version requir libxc higher might necessari updat libxc instal octopu restart file casida restart file incompat gener version new format avoid problem restart differ number state octopu instal libxc independ librari compil octopu compil libxc first short instruct compil assum libxc instal dir directori octopu go instal text tar xvzf libxctargz cd libxc configur prefixdir make make instal configur octopu pass option withlibxcprefixdir configur option locat netcdf etsf_io withnetcdfprefix withetsfioprefix variabl tdevolutionmethod call variabl tdpropag util file octcross_sect renam file octpropagation_spectrum file octbroad renam file octcasida_spectrum format file octhelp chang file use instead file search file p instead file show file l instead file list octopu input variabl variabl chang name chang format obsolet variabl found octopu stop tell variabl replac variabl unit variabl unitsinput variabl unitsoutput take name option argument instead string text unit eva replac text unit ev_angstrom code stop old format encount xfunction cfunction replac variabl xcfunction exampl text xfunction lda_x cfunction lda_c_vwn must replac text xcfunction lda_x lda_c_vwn tdlaser replac variabl tdexternalfield option variabl calculationmod renam output directori directori octopu output renam restart file store file restart instead file tmp file previous found file statu locat file exec restart file format octopu write restart file binari format format updat improv result octopu longer abl restart automat calcul run perform older version recov old restart file realli need recov old restart file first gener netcdf restart file old version octopu renam file tmp directori file restart remov file restart_ prefix subdirectori exampl file tmprestart_g call file restartg run octopu find restart inform manualfoot prevmanualexamplesbenzen nextmanualbuild scratch titl tutori weight descript entri page octopu tutori menu top find collect tutori cover wide rang topic basic perform calcul octopu advanc featur sever seri link tutori propos guid perform certain type calcul tutori mean cover thing octopu hope cover common option find inform manual onlin manual never use octopu start octopu basic seri tutori complet list avail tutori found tutori also organ categori brows case interest specif type system featur calcul mode main tutori seri tutori basic octopu basic get start octopu tutori respons optic respons calcul sever type optic respons differ method tutori model model system work model system like quantum dot quantum well tutori period system period system period boundari condit band structur etc difficulti level tutoriallist difficulti theori level tutoriallist theori calcul mode tutoriallist calculation_mod system type tutoriallist system_typ speci type tutoriallist species_typ featur tutoriallist featur util tutoriallist util titl period system tag basic ground state unoccupi bulk pseudopotenti dft band structur do seri tutori tutori octopu basic period system difficulti basic theori dft calculation_mod ground state unoccupi system_typ bulk species_typ pseudopotenti featur band structur do descript perform basic calcul use bulk silicon exampl weight extens groundstat calcul period system quit straightforward octopu tutori explain perform basic calcul use bulk silicon exampl input alway start simpl input file case use primit cell si compos two atom codeblock include_input doctutorialsoctopus_basicsperiodic_systemsstartinp codeblock let see detail input variabl codeinlin variabl periodicdimens codeinlin input variabl must set equal number dimens want consid period sinc system codeinlin variabl dimens codeinlin default set variabl impos period boundari condit border mean fulli period infinit crystal codeinlin variabl latticevector codeinlin codeinlin variabl latticeparamet codeinlin two block use defin primit lattic vector determin unit cell codeinlin variabl latticevector codeinlin defin direct vector variabl latticeparamet defin length codeinlin variabl reducedcoordin codeinlin posit atom insid unit cell reduc coordin codeinlin variabl kpointsgrid codeinlin specifi kpoint grid use calcul employ xx monkhorstpack grid four shift first line block defin number kpoint along axi brillouin zone sinc want number point along direct defin auxiliari variabl code nk use later studi converg respect number kpoint four line defin shift one per line express reduc coordin brillouin zone altern one also defin reciprocalspac mesh explicitli set posit weight kpoint use variabl kpoint variabl kpointsreduc variabl codeinlin variabl kpointsusesymmetri ye codeinlin variabl control symmetri use symmetri use code shrink brillouin zone irreduc portion effect number kpoint adjust codeinlin variabl output do codeinlin ask code output densiti state taken valu grid space bohr although use valu throughout tutori rememb reallif calcul converg respect grid space must perform quantiti interest note period system default valu codeinlin variabl boxshap codeinlin variabl code parallelepip although case name mislead actual shape also depend lattic vector box shape current avail period system output run octopu use input file import thing note output codeblock grid simul box type parallelepip length b octopu run dimens octopu treat system period dimens lattic vector b cell volum b reciprocallattic vector b main mesh space b volumepoint b inner mesh total mesh grid cutoff h grid cutoff ry codeblock octopu output inform cell real reciproc space codeblock symmetri space group intern fdm schoenfli oh index rotat matrix fraction translat info system symmetri use codeblock block tell us spacegroup symmetri found specifi structur codeblock kpoint gener paramet n index weight coordin codeblock next get list kpoint reduc coordin weight sinc symmetri use two kpoint gener use symmetri would kpoint instead rest output much like nonperiod counterpart iter code converg codeblock scf cycl iter etot e abs_ev e rel_ev e ediff e abs_den e rel_den e matrix vector product converg eigenvector state kpoint eigenvalu h occup error e e e e e e e e e e densiti state elaps time scf step info write state info finish write state info scf converg iter codeblock usual file staticinfo file contain relev inform concern calcul sinc ask code output densiti state also new file file static directori file dosxxxxdat bandresolv densiti state do file totaldosdat total do sum band file totaldosefermidat fermi energi format compat file totaldosdat cours tune output type format way finitesystem calcul converg kpoint similar converg space converg must perform sampl brillouin zone one must tri differ number kpoint along axi brillouin zone easili done chang valu ttnktt auxiliari variabl previou input file obvious hand someth also done script script name file kptssh bash include_fil doctutorialsoctopus_basicsperiodic_systemskpointskptssh run script code sourc kptssh obtain file call file kptslog look like codeblock nk total energi codeblock see total energi converg within hartre code nk extend rang eg script bash binbash echo nk total energi kptslog list nkpt list sed snk nk nkptg inp octopu outnkpt energygrep total staticinfo head tail cut f echo nkpt energi kptslog rm rf restart done file kptslog file look like codeblock nk total energi codeblock bandstructur proceed calcul bandstructur si order comput bandstructur must perform nonselfconsist calcul use densiti previou groundstat calcul first step obtain initi groundstat rerun previou input file chang number kpoint code nk next modifi input file look like codeblock include_input doctutorialsoctopus_basicsperiodic_systemsbandstructureinp codeblock thing chang codeinlin variabl calculationmod unocc codeinlin perform nonselfconsist calcul use code unoccupi calcul mode codeinlin variabl extrast codeinlin number unoccupi band calcul codeinlin variabl extrastatestoconverg codeinlin highest unoccupi state hard converg use variabl specifi mani unoccupi state consid stop criterion nonselfconsist run codeinlin variabl kpointspath codeinlin block use specifi want calcul band structur along certain path brillouin zone replac variabl kpointsgrid block first row describ mani kpoint use sampl segment next row coordin kpoint segment start stop particular exampl chose follow path lgamma gammax xgamma use sampl kpoint codeinlin variabl kpointsusesymmetri codeinlin turn use symmetri run octopu input file obtain file name file bandstructur insid file static directori first line file look like codeblock coord kx ky kz red coord band h codeblock include_ep doctutorialsoctopus_basicsperiodic_systemsbandstructuresi_bandstructureep captionband structur bulk silicon zero energi shift maximum occupi band first column coordin kpoint along path second third fourth column reduc coordin kpoint follow column eigenvalu differ band case band occupi unoccupi right see plot band structur plot show occupi band purpl first unoccupi band green use gnuplot obtain similar plot follow command text plot col staticbandstructur u columncol w l notitl ls note use variabl kpointspath input variabl octopu run special mode restart inform previou groundstat calcul alter way code inform us start unoccupi state iter text info code run band structur mode restart inform print tutorialfoot titl recip tag basic recip seri tutori tutori octopu basic descript final learn prepar tasti octopu dish difficulti basic weight input file set codeblock variabl calculationmod recip codeblock code print tasti recip randomli select avail packag exampl codeblock calcul mode input calculationmod recip info octopu initi complet info start calcul mode octopu la gallega ingredi person kg octopu kg potato gr paprika gr thick salt oliv oil prepar wash octopu cold water place copper cu pan water fire start boil submerg octopu remov repeat procedur time alway wait water start boil boil octopu minut remov pan fire let rest minut remov octopu water cut thin slice scissor serv wood plate spice follow order first salt paprika oliv oil serv potato disclaim author guarante implement recip lead edibl dish clearli systemdepend codeblock current recip avail english spanish italian basqu one get control lang environ variabl run lang octopu may get codeblock pulpo feira ingredient para persona kg de pulpo kg de papa patata gr de ají chile pimentón picant gr de sal gorda aceit preparación se lava el pulpo en agua fría se pone una olla de cobr con agua al fuego cuando rompa hervir se coge el pulpo se mete se saca del agua tre vece dejando que en cada intervalo vuelva hervir el agua se deja cocer el pulpo durant uno minuto retirándolo del fuego dejándolo reposar durant minuto continuación se quita del agua se corta en trozo fino con una tijera para servirlo se pone en uno plato de madera condimentándolo por est orden sal pimentón aceit se añaden uno cachelo patata codeblock contribut languag welcom tutorialfoot titl total energi converg tag basic ground state molecul pseudopotenti dft total energi seri tutori tutori octopu basic difficulti basic theori dft calculation_mod ground state system_typ molecul species_typ pseudopotenti featur total energi descript make sure result converg weight tutori show converg quantiti interest total energi respect paramet defin realspac grid use two exampl nitrogen atom tutori basicsbasic_input_opt basic input option tutori methan molecul nitrogen atom find good space key paramet realspac calcul space point mesh default option octopu use cartesian grid regular grid space along cartesian direct first step calcul make sure space good enough purpos done converg studi similar one perform planewav calcul need space essenti depend pseudopotenti use idea repeat seri groundstat calcul ident input file except grid space mani differ way simplest one chang input file hand run octopu time anoth option use littl bash script like one bellow first exampl use nitrogen atom previou tutori make sure correspond file inp file nxyz file work directori next creat file call code spacingsh follow content bash include_fil doctutorialsoctopus_basicstotal_energy_convergencenitrogen_atom_spacingspacingsh script quit simpl run octopu list space calcul collect valu total energi eigenvalu print file call file spacinglog order chang valu space calcul use featur one overrid variabl file inp file manual advanced_ways_of_running_octopuspassingargumentsfromenvironmentvari defin environ variabl shell note unset variabl oct_spac end script avoid remain defin case run script directli shell run script type bash sourc spacingsh commandlin sh spacingsh commandlin bash spacingsh note work file octopu execut must found shell path case replac bash octopu outspac actual path execut bash pathtooctopu outspac include_ep doctutorialsoctopus_basicstotal_energy_convergencenitrogen_atom_spacingnitrogenspacingep captionconverg space n script finish run file spacinglog file look someth like text sp energi s_eigen p_eigen also plot result file favorit plot program eg command gnuplot result particular exampl shown figur figur actual plot error respect accur result smallest space mean plot differ valu given space valu space å read note accur result left smallest space rather good space nitrogen pseudopotenti seem å howev usual interest total energi energi differ probabl larger one may also use without compromis result methan molecul move slightli complex system methan molecul chsubsub add converg studi respect box size input usual first thing creat input file system basic chemistri class know methan tetrahedr structur thing requir defin geometri bond length carbon hydrogen atom put carbon atom origin hydrogen atom coordin given follow input file codeblock variabl calculationmod gs variabl unitsoutput ev_angstrom variabl radiu angstrom variabl space angstrom ch angstrom variabl coordin c h chsqrt chsqrt chsqrt h chsqrt chsqrt chsqrt h chsqrt chsqrt chsqrt h chsqrt chsqrt chsqrt codeblock defin variabl ch repres bond length carbon hydrogen atom simplifi write coordin start bond length å that import moment sinc optim later inform see geometri optimizationgeometri optim tutori use å someth slightli bigger å fine note concern input file tell octopu explicitli variabl boxshap use default union sphere center around atom turn econom choic almost case also specifi variabl speci block way octopu use default pseudopotenti carbon hydrogen ok mani case rule thumb care test use pseudopotenti seriou calcul use given input file find follow valu result file staticinfo file codeblock eigenvalu ev st spin eigenvalu occup energi ev total free ionion eigenvalu hartre intnv_xc exchang correl vanderwa delta xc entropi ts kinet extern nonloc codeblock question whether valu converg depend two thing variabl space seen variabl radiu like nitrogen atom way answer question tri valu variabl converg space include_ep doctutorialsoctopus_basicstotal_energy_convergencemethane_spacingspacing_chep captionconverg space methan keep entri input file fix except space make smaller å way å run octopu sever time use similar script one nitrogen atom exampl bash include_fil doctutorialsoctopus_basicstotal_energy_convergencemethane_spacingspacingsh exampl chang list space tri keep thing simpl write total energi file spacinglog file run script get follow result codeblock sp energi codeblock give number gnuplot softwar plot get curv like one shown right see pictur total energi converg within ev space å use space next calcul converg radiu include_ep doctutorialsoctopus_basicstotal_energy_convergencemethane_radiusradius_chep captionconverg radiu methan see total energi chang variabl radiu box chang radiu step å chang input file hand run octopu time use small script bash include_fil doctutorialsoctopus_basicstotal_energy_convergencemethane_radiusradiussh run script make sure space set å input file get file file radiuslog look like text rad energi right see look like plot note case accur result right larger radiu ask converg ev use radiu å compar size molecul explain energi increas becom less neg one decreas size box tutorialfoot titl octopu basic weight descript basic introduct run octopu seri link tutori teach basic use octopu start never use octopu assum basic understand solid state physic densiti function theori octopu instal system know run command shell tutorialseri octopu basic titl timedepend propag tag basic timedepend molecul pseudopotenti dft laser seri tutori tutori octopu basic theori dft calculation_mod timedepend system_typ molecul species_typ pseudopotenti difficulti basic featur laser weight descript time evolut densiti methan molecul ok time tddft let us perform calcul time evolut densiti methan molecul groundstat reason first groundstat dft calcul initi state realtim calcul run input file obtain proper groundstat store code restart directori tutori basicstot energi converg total energi converg tutori use accur bond length codeblock include_input doctutorialsoctopus_basicstimedependent_rungsinp codeblock codeblock variabl calculationmod gs variabl unitsoutput ev_angstrom variabl radiu angstrom variabl space angstrom ch angstrom variabl coordin c h chsqrt chsqrt chsqrt h chsqrt chsqrt chsqrt h chsqrt chsqrt chsqrt h chsqrt chsqrt chsqrt codeblock timedepend input start point timedepend calcul modifi input file look like codeblock include_input doctutorialsoctopus_basicstimedependent_runtdinp codeblock codeblock variabl calculationmod td variabl unitsoutput ev_angstrom variabl radiu angstrom variabl space angstrom ch angstrom variabl coordin c h chsqrt chsqrt chsqrt h chsqrt chsqrt chsqrt h chsqrt chsqrt chsqrt h chsqrt chsqrt chsqrt tf ev dt ev variabl tdpropag aetr variabl tdmaxstep tfdt variabl tdtimestep dt codeblock switch new run mode codeinlin variabl calculationmod td codeinlin instead code gs timedepend run also ad three new input variabl variabl tdpropag algorithm use approxim evolut oper octopu larg number possibl propag use see reffootnot overview variabl tdmaxstep number timepropag step perform variabl tdtimestep length time step note conveni previous defin coupl variabl code tf code dt made use one possibl propag code aetr manual explain possibl option practic choic usual good except long propag code etr propag stabl output run octopu take second depend speed machin relev chunk standard output codeblock input ionsconstantveloc input thermostat none input moveion input tdionictimescal input tdtimestep e hbarev input tdpropagationtim hbarev input tdmaxstep input tddynam ehrenfest input tdscissor input tdpropag aetr input tdexponentialmethod taylor codeblock codeblock timedepend simul iter time energi sc step elaps time codeblock codeblock codeblock worthwhil comment thing perform timeevolut system depart groundstat influenc extern perturb consequ electron system evolv total energi chang may alreadi see output file third column number observ chang howev kind run use check paramet defin time evolut correct evolut perform code probe observ print place file directori file tdgener show work directori case two file show file tdgeneralenergi file tdgeneralmultipol file file tdgeneralmultipol file contain larg number column data line correspond one time step evolut except first three line start code symbol give mean number contain column unit brief overview inform contain file follow first column iter number second column time third column dipol moment electron system along xdirect langl phi vert hatx vert phitrangl intrm dr xnr next zcompon dipol moment file file tdgeneralenergi contain differ compon total energi possibl restart timedepend run tri increas valu variabl tdmaxstep rerun octopu howev want start evolut scratch set variabl variabl fromscratch code ye time step key paramet cours time step variabl tdtimestep make long calcul worthwhil spend time choos largest timestep possibl reduc number step need timestep depend crucial system consider space appli perturb algorithm chosen approxim evolut oper exampl tri chang timestep rerun timeevolut make sure use variabl tdmaxstep least shorter run instabl might appear yet see timestep larger code propag get unstabl total energi system longer conserv often diverg rapidli even becom nan also anoth input variabl set explicitli reli default valu variabl tdexponentialmethod sinc propag reli algorithm calcul action exponenti hamiltonian one specifi algorithm use purpos may want learn possibl option may taken variabl tdexponentialmethod variabl tdpropag take look manual tri exercis fix propag algorithm exampl default valu investig sever exponenti method work taylor chebyshev lanczo mean find maximum timestep one use without compromis proper evolut fix variabl tdexponentialmethod one play around variou propag laser field add timedepend extern perturb laser field molecular hamiltonian breviti omit begin file left unchang relev part input file modif addit codeblock include_input_snippet doctutorialsoctopus_basicstimedependent_runlaserinp laser codeblock include_ep doctutorialsoctopus_basicstimedependent_runlasertutorial_td_laserep captionlas field use tutori import variabl variabl tdexternalfield block associ variabl tdfunction block care read manual page dedic variabl particular laser puls employ one whose envelop function cosin readi set run laser field care set total time propag abl accommod laser shot even want see happen afterward may also want consult mean variabl variabl tdoutput coupl import comment may suppli sever laser puls simpli add line variabl tdexternalfield block need variabl tdfunction block ad code laser option variabl tdoutput variabl laser field print file file tdgenerallas done immedi begin run check laser correct without wait idea respons field look dipol moment file tdgeneralmultipol physic observ calcul respons extern field present one may expect unbound state may excit lead ioniz calcul reflect densiti reach border box case proper way proceed setup absorb boundari variabl variabl absorbingboundari variabl abwidth variabl abheight footnot articl titlepropag timedepend kohnsham equat authorsa castro mal marqu rubio journalj chem phi volum page year doi tutorialfoot titl center geometri tag basic molecul octcentergeom seri tutori tutori octopu basic difficulti basic system_typ molecul util octcentergeom descript translat center mass origin weight run octopu calcul molecul alway good idea run manual extern utilitiesoctcentergeom octcentergeom util translat center mass origin align molecul default main axi along xaxi often help visual purpos make clear symmetri system also help construct simul box effici code current implement octopu construct parallelepip contain simul box origin much larger necessari system center align period system consider relev least period direct input exampl need two file file inp need simpl input file specifi coordin file codeblock include_input doctutorialsoctopus_basicscentering_a_geometryinp codeblock file tabxyz use coordin file molecul httpsenwikipediaorgwikiazobenzen transazobenzen interest properti abl switch tran ci isom absorpt light codeblock include_fil doctutorialsoctopus_basicscentering_a_geometrytabxyz codeblock center geometri manual extern utilitiesoctcentergeom octcentergeom serial util found code bin directori instal octopu run util obtain new coordin file code adjustedxyz use calcul octopu output especi interest except perhap symmetri moment inertia tensor come end calcul codeblock symmetri symmetri element sigma symmetri group cs use main axi input axistyp inertia center mass b moment inertia tensor amub isotrop averag eigenvalu found primari axi found secondari axi codeblock visual origin new coordin file code xcrysden favorit visual program eg jmol avogadro vmd vesta etc see transform util perform see option align system variabl axistyp variabl mainaxi tutorialfoot titl get start tag basic ground state molecul pseudopotenti dft total energi tutori octopu basic difficulti basic theori dft calculation_mod ground state system_typ molecul species_typ pseudopotenti featur total energi weight descript learn run code object tutori give basic idea octopu work gener input file text editor creat text file call file inp contain follow text codeblock variabl calculationmod gs variabl coordin h codeblock codeblock include_input testsuitetutorialsoctopus_basicsgetting_startedh_atominp codeblock simplest exampl octopu input file codeinlin variabl calculationmod gs codeinlin variabl defin run mode pleas consult manual full list possibl run mode case set code gs instruct code start groundstat calcul codeinlin variabl coordin codeinlin entri definit variabl rather full set block variabl begin block mark code identifi line end code line case identifi codeinlin variabl coordin codeinlin list atom speci calcul coordin one per line case put singl hydrogen atom center simul box reason input file simpl octopu come default valu simul paramet set default pseudopotenti sever element properli converg calcul might need adjust paramet though get gener idea format octopu input file go read page manual basicsinput file input file manual document input variabl found versionedlink variabl variabl refer onlin also access via manual extern utilitiesocthelp octhelp util run octopu written input file run command octopu command use command mpirun perhap job script use parallel version everyth goe correctli see sever line output termin dont must problem instal probabl first time run octopu examin import part output notic note awar precis valu find output might differ one tutori text due updat code also chang compil run configur notic first octopu drawn ascii art copyright notic inform octopu version use system run codeblock ___ ___ __ ___ _ ___ __ _ __ __ __ _ __ __ _ __ ____ _ _ __ jg _ program free softwar redistribut andor modifi term gnu gener public licens publish free softwar foundat either version option later version program distribut hope use without warranti without even impli warranti merchant fit particular purpos see gnu gener public licens detail receiv copi gnu gener public licens along program write free softwar foundat inc franklin street fifth floor boston run octopu version commit feddfefddefdd build time thu jul cest configur option maxdim sse avx option librari arpack berkeleygw etsf_io gdlib netcdf pspio sparskit nlopt architectur x_ c compil gcc c compil flag g wall marchn fortran compil gfortran gcc version fortran compil flag g wall ffreelinelengthnon marchn octopu swim fenugreek linux calcul start codeblock note also give revis number compil compil flag use alway includ inform submit bug report type calcul ask perform codeblock calcul mode input calculationmod gs codeblock speci pseudopotenti use codeblock speci speci h type pseudopotenti file optlocalshareoctopuspseudopotentialspsfhpsf file format psf valenc charg atom number form file semiloc orbit origin calcul lmax llocal projector per l total projector applic form local orbit bound orbit codeblock output octopu print inform grid didnt say anyth input file octopu use paramet recommend pseupopotenti codeblock grid simul box type minimum speci h radiu b octopu run dimens octopu treat system period dimens main mesh space b volumepoint b inner mesh total mesh grid cutoff h grid cutoff ry codeblock level theori case tddft approxim exchangecorrel term codeblock theori level input theorylevel dft exchangecorrel exchang slater exchang lda p dirac math proc cambridg philo soc f bloch z phi correl perdew zunger modifi lda j p perdew zunger phi rev b modifi improv match low highr input siccorrect sic_non codeblock point octopu tri read wavefunct previou calcul none give warn codeblock warn could find restartg directori restart restart inform read warn unabl read wavefunct start scratch codeblock octopu commenc calcul get reason start point dft calcul initi wavefunct calcul manual calculationsground_statelcao linear combin atom orbit lcao codeblock info perform initi lcao calcul orbit info get hamiltonian matrix element eta eigenvalu h st spin eigenvalu occup info groundstat restart inform written codeblock lcao real dft calcul start selfconsist step inform print scf manual calculationsground_stateconverg converg calcul done codeblock scf cycl iter etot e abs_ev e rel_ev e ediff e abs_den e rel_den e matrix vector product converg eigenvector state eigenvalu h occup error e elaps time scf step codeblock codeblock scf cycl iter etot e abs_ev e rel_ev e ediff e abs_den e rel_den e matrix vector product converg eigenvector state eigenvalu h occup error e elaps time scf step info write state info finish write state info scf converg iter info finish write inform restartg calcul end walltim octopu emit warn codeblock run command command octopu write output directli termin save copi output gener advis redirect output file captur standard error stream well done like command octopu log would creat file call file log contain output includ warn error context analyz result finish calcul find seri file directori ran codeblock ls exec inp restart static codeblock moment ignor exec restart directori focu file staticinfo file contain detail result groundstat calcul open file first see paramet calcul alreadi got output calcul energi eigenvalu hartre codeblock eigenvalu h st spin eigenvalu occup energi h total free ionion eigenvalu hartre intnv_xc exchang correl vanderwa delta xc entropi ts kinet extern nonloc codeblock sinc default octopu spinunpolar densityfunctionaltheori calcul localdens approxim result differ exact total energi h exchangecorrel function set variabl variabl xcfunction use set provid libxc librari extra want improv lda result tri repeat calcul spinpolar codeblock variabl spincompon spin_polar codeblock want obtain exact schödinger equat result someth possibl simpl system like one remov selfinteract error problem lda sinc one electron simplest way case use independ electron codeblock variabl theorylevel independent_particl codeblock gener way would includ selfinteract correct tutorialfoot titl visual tag basic ground state molecul pseudopotenti dft visual tutori octopu basic difficulti basic theori dft calculation_mod ground state system_typ molecul species_typ pseudopotenti featur visual weight descript exampl benzen tutori explain visual output octopu sever differ file format avail octopu suitabl varieti visual softwar cover see manual visual visual inform benzen molecul exampl use benzen molecul point input quit familiar codeblock include_input doctutorialsoctopus_basicsvisualizationinp codeblock coordin case given file benzenexyz file file look like codeblock include_input doctutorialsoctopus_basicsvisualizationbenzenexyz codeblock use two new input variabl variabl output tell octopu quantiti output variabl outputformat specifi format output file case ask octopu output wavefunct code wf densiti electron local function code elf kohnsham potenti ask octopu gener output sever format requir differ visual tool mention want save disk space keep option correspond program use take look document variabl variabl output variabl outputformat full list possibl quantiti output format visual run octopu input file get follow file file static directori text ls static converg forc vhz wfstcube wfstdx wfstxsf wfstyz wfstz wfstcube wfstdx densitycub info vkscube wfstdx wfstxsf wfstyz wfstz wfstcube wfstdx wfstxsf densitydx vcube vksdx wfstxsf wfstyz wfstz wfstcube wfstdx wfstxsf wfstyz densityxsf vdx vksxsf wfstyz wfstz wfstcube wfstdx wfstxsf wfstyz wfstz densityyz vxsf vksyz wfstz wfstcube wfstdx wfstxsf wfstyz wfstz wfstcube densityz vyz vksz wfstcube wfstdx wfstxsf wfstyz wfstz wfstcube wfstdx elf_rscub vz vxccube wfstdx wfstxsf wfstyz wfstz wfstcube wfstdx wfstxsf elf_rsdx vhcube vxcdx wfstxsf wfstyz wfstz wfstcube wfstdx wfstxsf wfstyz elf_rsxsf vhdx vxcxsf wfstyz wfstz wfstcube wfstdx wfstxsf wfstyz wfstz elf_rsyz vhxsf vxcyz wfstz wfstcube wfstdx wfstxsf wfstyz wfstz elf_rsz vhyz vxcz wfstcube wfstdx wfstxsf wfstyz wfstz wfstcube visual gnuplot include_ep doctutorialsoctopus_basicsvisualizationbenzene_dep captionelectron densiti benzen along z plane gener gnuplot pmd option widthpx visual field dimens complic mani case use plot part data exampl valu scalar field along line plane display plot code gnuplot program use make type plot mani directli read octopu output first type code gnuplot enter program command line plot densiti along line x axi case type bash plot staticdensityyz w l plot field exampl densiti plane z use command bash splot staticdensityz w l want get color scale valu field use code w pmd instead code w l expand gnuplot script plot produc script codeblock include_fil doctutorialsoctopus_basicsvisualizationplotgp codeblock expand visit program visithttpsvisitllnlgov opensourc data visual develop lawrenc livermor nation laborartori support multipl platform includ linux os x window like download precompil version platform herehttpswcillnlgovsimulationcomputercodesvisitexecut tutori need visit instal run visit read sever format conveni octopu data ttcubett format variabl outputformat ttcubett common format read sever visual analysi program advantag includ request scalar field geometri file visit also read format octopu gener like ttxyztt ttxsftt partial support ttvtktt follow video contain instruct open ttcubett file visit note video subtitl case dont audio current locat enabl click cc button youtub idceiobmqm scale youtub width heighthttpswwwyoutubecomwatchvceiobmqmyoutub xcrysden atom coordin finit period forc function grid plot free program xcrysdenhttpswwwxcrysdenorg xsf format also read v_simhttpsinacceafrspml_simv_simindexenhtml vestahttpsjpmineralsorgvestaendownloadhtml bewar probabl assum output angstrom unit accord specificationhttpswwwxcrysdenorgdocxsfhtml use variabl unitsoutput ev_angstrom data misinterpret visual softwar ucsf chimera figur srcimagestutorial_chimera_png widthpx captiongroundst densiti plot ucsf chimera benzen molecul color accord valu electrostat potenti file dx file also open ucsf chimerahttpswwwcglucsfeduchimera ucsf chimera instal open open benzenexyz file file open open file dx file go tool volum data volum viewer new window open go file open select file staticdensitydx color densiti go tool surfac color new dialog open choos brows open vhdx file click color imag similar one tutorialfoot titl basic input option tag basic ground state molecul pseudopotenti dft total energi weight tutori octopu basic difficulti basic theori dft calculation_mod ground state system_typ molecul species_typ pseudopotenti featur total energi descript obtain ground state nitrogen atom move complic realist input file obtain ground state nitrogen atom introduc sever basic input variabl give detail descript output exampl input file sampl input file let us obtain ground state nitrogen atom within lda approxim closedshel unpolar configur explain need auxiliari file xyz input note correct ground state nitrogen atom howev permit us describ import input variabl codeblock include_input doctutorialsoctopus_basicsbasic_input_optionsinp codeblock introduc sever new variabl codeinlin variabl unitsoutput ev_angstrom codeinlin two differ unit system may use output usual atom unit default one use intern code system ångström substitut atom unit length electronvolt substitut atom unit energi find detail descript unit octopu manual basicsunit unit page manual follow entri input file variabl octopu read directli rather illustr possibl write userdefin valu express simplifi input file case defin nitrogen mass codeinlin nitrogen_mass codeinlin note case except valu expect socal atom mass unit rather atom unit definit may use elsewher input file variabl speci block contain list speci present system studi case one speci nitrogen first field string defin name speci n case second field defin type speci case codeinlin species_pseudo codeinlin list paramet follow paramet specifi first field paramet name field follow valu paramet paramet specif certain speci other accept speci exampl codeinlin set codeinlin instruct octopu use pseudopotenti nitrogen codeinlin standard codeinlin set happen troulliermartin pseudopotenti defin file npsf file found directori file shareoctopuspseudopotentialspsf come maximum codeinlin lmax codeinlin compon pseudopotenti consid calcul codeinlin lloc codeinlin compon consid local gener want set maximum l highest avail pseudopotenti local l equal maximum l final mass speci also modifi default valu set codeinlin mass codeinlin paramet codeinlin variabl xyzcoordin nxyz codeinlin geometri molecul case singl atom grid origin describ case file well known codeinlin xyz codeinlin format file outrag simpl case given codeblock comment line n codeblock codeinlin variabl extrast codeinlin default octopu perform spinunpolar calcul restrict closedshel hartreefock terminolog place two electron orbit number orbit kohnsham state calcul count number valenc electron present system divid two case sinc five valenc electron code would use three orbit howev know beforehand homo orbit threefold degeneraci consequ need put one three _p_ electron differ orbit therefor need one orbit get line input file codeinlin variabl occup codeinlin block gener occup kohnsham orbit automat decid code fill lowestenergi orbit howev degeneraci lumo case user may want accommod electron certain predefin way exampl obviou way fill orbit nitrogen atom put two electron first deepest orbit _s_ orbit one electron second third fourth orbit _p_ orbit degener codeinlin variabl boxshap sphere codeinlin choic shape simul box case set sphere possibl choic codeinlin minimum codeinlin codeinlin cylind codeinlin codeinlin parallelepip codeinlin codeinlin variabl radiu angstrom codeinlin radiu sphere defin simul box codeinlin variabl space angstrom codeinlin know octopu work realspac regular cubic mesh variabl defin space point key numer paramet way equival energi cutoff planewav calcul output construct input file creat file nxyz file may unleash octopu let go section output speci codeblock speci speci n type pseudopotenti file optshareoctopuspseudopotentialspsfnpsf file format psf valenc charg atom number form file semiloc orbit origin calcul lmax llocal projector per l total projector applic form kleinmanbyland orbit bound orbit codeblock code search need pseudopotenti file inform user success failur case file npsf file requir file process inform written output one import piec inform found valenc charg tell us mani electron speci consid calcul grid codeblock grid simul box type sphere radiu octopu run dimens octopu treat system period dimens main mesh space volumepoint inner mesh total mesh grid cutoff ev grid cutoff ry codeblock step construct mesh request input file sphere radiu å use contain cubic regular realspac grid space å impli point codeinlin inner mesh codeinlin sake comparison planewavebas code less equival planewav calcul impos densiti cutoff ev hartre except case artifici period repetit system mix codeblock input mixfield potenti mix scf cycl input mixingschem broyden codeblock selfconsist procedur one use manual calculationsground_statemix mix scheme help converg one mix either densiti potenti sever mix scheme avail eigensolv codeblock eigensolv input eigensolv cg input precondition pre_filt input preconditionerfilterfactor input subspacediagon standard codeblock see manual calculationsground_stateeigensolv eigensolv use simpl conjug gradient cg precondition use speed converg lcao output see someth like codeblock info perform initi lcao calcul orbit info get hamiltonian matrix element eta eigenvalu ev st spin eigenvalu occup codeblock first step groundstat calcul obtain reason good start densiti kohnsham orbit feed selfconsist scf procedur purpos octopu perform initi calcul restrict basi set atom orbit manual calculationsground_statelcao linear combin atom orbit lcao result eigenvalu calcul written standard output wavefunct kind codeblock info scf use real wavefunct codeblock often one work real wavefunct particularli help calcul real wavefunct much faster complex one howev magnet field present system period spinorbit coupl present complex wavefunct mandatori dont worri program abl figur use scf codeblock scf cycl iter etot e abs_ev e rel_ev e ediff e abs_den e rel_den e matrix vector product converg eigenvector state eigenvalu ev occup error e e e e densiti state elaps time scf step codeblock scf cycl start everi step octopu output sever piec inform valu codeinlin abs_den codeinlin codeinlin rel_den codeinlin monitor absolut rel converg densiti codeinlin rel_ev codeinlin codeinlin abs_ev codeinlin two altern measur converg base measur differ input output eigenvalu scf procedur default stop codeinlin rel_den codeinlin smaller may alter appropri input variabl see manual variabl variabl convabsden variabl convrelden variabl convabsev variabl convrelev line codeinlin matrix vector product codeinlin tell us hamiltonian appli time give us idea comput cost line codeinlin converg eigenvector codeinlin tell us upon complet diagon procedur none orbit met requir precis criterion wavefunct follow exampl modifi criterion input file list eigenvalu print along error much deviat exact eigenvalu current hamiltonian number socal residu take look file file staticinfo hold summari calcul restart groundstat calcul may restart later refin converg properli purpos provid content code restart directori preserv tri run octopu notic octopu give warn line codeblock info load restart inform codeblock use chang slightli paramet simul exampl xc function converg criteria chang grid paramet octopu abl restart previou calcul want octopu tri restart calcul set variabl variabl fromscratch case ware wonder restart inform look like look content file restart directori file need restart calcul store may contain sever subdirectori depend calcul previous perform case contain one bash ls restart gs ls restartg obf obf densiti df_obf df_obf dv_obf f_old_obf lxyzobf mix state vhxcobf wfn obf obf densityobf df_obf dv_obf dv_obf grid mesh occ vhxc vin_old_obf octopu store individu state differ binari yet platformindepend file case four state file file obf file obf use quantiti like densiti also store binari form file text file contain divers control inform unlik ever work directli file may take look around curiou tutorialfoot titl verlet propag tutori multisystem weight readi perform time propag system follow input file expand input file codeblock include_input testsuitemultisystempropagation_verletthree_bodyinp codeblock expand input file specifi propag codeblock variabl tdsystempropag verlet codeblock accord wikipediahttpsenwikipediaorgwikiverlet_integr verlet algorithm defin calcul vecxt delta vecxt vecvt delta tfrac vecat delta calcul interact potenti use vecxt delta deriv vecat delta interact potenti use vecxt delta calcul vecvt delta vecvt tfrac bigvecat vecat delta tbigdelta step perform time step expand detail descript algorithm step follow graph depict algorithm step state machin see develop code_documentationpropag descript propag implement dsequenc filedevelopgraph_datapropagationbodyverletequalstepjson box diagram repres function call octopu relat algorithm step propag seen three system step algorithm step verlet algorithm use button manual step algorithm see order step perform step variou clock system advanc interact graph also allow display unphys contain system socal ghost interact alway present intern tool ensur system stay synchron even physic interact set variabl codeinlin variabl debug info codeinlin input file rerun exampl look debug line output compar graph expand tutorialfoot titl interact graph tutori multisystem weight code gener interact graph help debug result expect enabl variabl debug variabl set code interaction_graph follow input file expand input file codeblock include_input testsuitemultisysteminteraction_graphthree_bodyinp codeblock expand give rise follow graph graphvizfil staticgraph_datainteraction_graphdot graph creat use code graphviz packag expand instal use graphviz name debian like system code graphviz simpli instal codeblock sudo aptget instal graphviz codeblock code interaction_graphdot convert code png file use codeblock dot tpng interaction_graphdot interaction_graphpng codeblock expand tutorialfoot titl multisystem weight tutorialseri multisystem titl multisystem introduct tutori multisystem weight octopu multisystem support octopu support calcul compound system aim develop allow coupl matter maxwel field coupl full dft system system treat tightbind hamiltonian tutori start differ model name celesti bodi due simplic well suit explain set system contain variou subsystem new variabl concept tutori variabl system variabl interact namespac system variabl system describ natur subsystem exampl classic particl charg particl maxwel system tight bind system electron yet implemn multisystem framework codeblock variabl system name emph systemtyp name emph systemtyp codeblock possibl system type found refer variabl system name given system defin namespac use remaind input file order defin system specif valu variabl seen exampl subsystem multisystem compon need specifi anoth variabl system block interact differ subsystem pretti bore interact mutual interact defin variabl interact block codeblock variabl interact emph interaction_typ emph interaction_mod emph partner codeblock namespac mani possibl system share variabl follow exampl celesti bodi planet classic particl albeit quit big one specifi mass obvious need abl differ mass reason systemspecif variabl defin variabl name system name ad prefix namespac exampl would codeblock variabl system earth classical_particl earth variabl particlemass e earth variabl particleinitialposit earth variabl particleinitialveloc codeblock tutorialfoot titl exampl celesti dynam tutori multisystem weight simplest exampl defin system consist similar subsystem input file show model describ motion earth moon sun three subsystem treat equal two level system solar system thought contain celesti bodi sub earth moon expand expand input file two level nest codeblock include_input testsuitemultisystemnested_systemstwo_levelsinp codeblock expand perfectli fine definit system sometim benefici group system togeth instanc might defin earth combin system terra luna orbit sun expand expand input file three level nest codeblock include_input testsuitemultisystemnested_systemsthree_levelsinp codeblock expand tutorialfoot titl atom simul environ ase tag tutori advanc difficulti advanc seri tutori descript use octopu calcul ase overview ase httpswikifysikdtudkaseabouthtml instal httpswikifysikdtudkaseinstallhtml octopu interfac distribut part ase requir special configur recompil octopu use set run octopu calcul python script combin differ algorithm structur optim molecular dynam nudgedelasticband method saddlepoint search vibrationphonon analysi genet algorithm featur ase also ase contain function gener structur like crystal surfac nanoparticl well mani standard molecul geometri ase interfac work write input file disk run octopu extern process mean step like structur optim less effici requir disk io restor quantiti densiti wavefunct disadvantag circumv use ramdisk amount memori larg cours one also simpli use ase script gener input file document may slightli inadequ exercis see httpswikifysikdtudkaseasecalculatorsoctopushtml back tutori tutori titl basic qoct tag tutori advanc optim control molecul userdefin speci independ particl laser difficulti advanc theori independ particl system_typ molecul calculation_mod optim control species_typ userdefin speci featur laser seri tutori descript introduct quantum optim control theori set codeinlin variabl calculationmod opt_control codeinlin attempt solv quantum optim control theori qoct equat tutori introduc basic theoret concept qoct well procedur perform basic qoct calcul octopu alreadi know qoct skip theoret introduct theoret introduct qoct formul follow way consid quantum mechan system govern tempor interv hamiltonian hathvarepsilont hamiltonian depend parametr control paramet varepsilont case concern tempor shape extern electromagnet field typic tempor shape laser puls hamiltonian drive system one specifi initi state vertpsi_rangl final state vertpsitrangl accord schroumlding equat ifracrm drm dtvertpsitrangl hathvarepsilontvertpsitrangl wish find optim control paramet varepsilon maxim given object gener express function j_psi full evolut state search must constrain two reason one control paramet must constrain physic valu laser field acquir unlimitedli larg valu two evolut state must obvious follow schroumlding equat consider translat mathemat term prescrib maxim follow function jpsichivarepsilon j_psi j_varepsilon j_psichivarepsilon j_psi object function basic tutori concern case depend valu state end propag psit moreov function expect valu positivedefinit oper hato j_psi langlepsitverthatovertpsitrangl j_varepsilon constrain valu control paramet typic idea maxim object j_ minim fluenc j_varepsilon alphaint_t rm dt varepsilont constant alpha usual call penalti maxim j_ must ensur verif schroumlding equat j_psichivarepsilon im left int_t rm dtlanglechitvert ifracrm drm dt hathvarepsilont vertpsitrangl right auxiliari state chi play role lagrangian multipli order obtain threesom psichivarepsilon maxim function must find solut correspond euler equat function deriv lead qoct equat ifracrm drm dtvertpsitrangl hathvarepsilontvertpsitrangl vertpsirangl vertpsi_rangl ifracrm drm dtvertchitrangl hathdaggervarepsilontvertchitrangl vertchitrangl hatovertpsitrangl alphavarepsilont im left langlechitvert fracparti hathparti varepsilonvertpsitrangleright popul target scheme zhu botina rabitz import case qoct want achiev larg transit probabl specif initi state final target state oper hato project onto one given target state psi_t j_psi vert langl psitvertpsi_trangl vert observ zhu botina rabitzzhu case one use altern definit j_ j_psichivarepsilon im langlepsitvertpsi_trangl int_t rm dt langlechitvert ifracrm drm dthathvarepsilontvertpsitrangl altern definit virtu decoupl equat chi psi ifracrm drm dtvertpsitrangl hathvarepsilontvertpsitrangl vertpsirangl vertpsi_rangl ifracrm drm dtvertchitrangl hathdaggervarepsilontvertchitrangl vertchitrangl vertpsi_trangl alphavarepsilont im left langlechitvert fracparti hathparti varepsilonvertpsitrangleright equat concern present exampl asymmetr doubl well prepar state go solv previou equat case attempt transit ground state given system first excit state system chosen onedimension asymmetr doubl well character potenti vx fracomega_bx fracomega_x beta x let us fix paramet valu omega_ b betafrac ground state system may obtain octopu run follow inp file codeblock variabl calculationmod gs variabl dimens variabl fromscratch ye variabl boxshap sphere variabl space variabl radiu variabl theorylevel independent_particl variabl speci awdd species_user_defin potential_formula xxx valenc variabl coordin awdd variabl extrast variabl eigensolvertoler e variabl eigensolvermaxit variabl mix variabl mixingschem linear codeblock figur srcimagestutorial_basicqoct_potentialpng widthpx captionfig black curv extern potenti defin asymmetr doubl well use exampl red green ground state excit state respect correspond system note set codeinlin variabl extrast codeinlin want get first excit state order abl qoct later object maximum popul state way obtain first two singl particl state system use make plot result togeth potenti curv depict fig observ ground state local left well surprisingli deeper wherea first excit state local right well go attempt transfer wavepacket one side energi two state au respect note order plot function add file inp file variabl variabl output variabl outputformat run octopu qoct mode run code follow file inp file codeblock variabl experimentalfeatur ye variabl dimens variabl fromscratch ye variabl calculationmod opt_control grid variabl boxshap sphere variabl space variabl radiu system variabl speci adwd species_user_defin potential_formula xxx valenc variabl coordin adwd variabl theorylevel independent_particl td run paramet stime dt variabl tdpropag aetr variabl tdexponentialmethod taylor variabl tdexponentialord variabl tdlanczostol e variabl tdmaxstep stimedt variabl tdtimestep dt oct paramet variabl octpenalti variabl octep e variabl octmaxit variabl octinitialst oct_is_groundst variabl octtargetoper oct_tg_gstransform variabl octtargettransformst variabl octschem oct_zbr variabl octdoublecheck ye laser field initi guess ampl freq variabl tdexternalfield electric_field freq envelope_funct tdfunction envelope_funct tdf_cw ampl output variabl output wf variabl outputformat axis_x variabl tdoutput laser td_occup codeblock let us go key element file inp file first part file repetit basic inform alreadi given file inp file ground state calcul definit system variabl speci block specif mesh etc qoct run consist seri backwardforward propag psi chi variabl section td run paramet specifi propag done especi import set total time propag fix interv mention qoct problem definit next section oct paramet defin particular way oct done variabl octschem particular oct algorithm use exampl use one suggest zhu botina rabitzzhu choic oct_zbr variabl octmaxit set maximum number iter zbr algorithm iter involv forward backward propag wavefunct variabl octep set converg threshold iter scheme iter scheme understood function process input control paramet varepsilon_i produc output control paramet varepsilon_o upon converg input output converg iter stop happen wheneverbr dvarepsilon_ivarepsilon_o int_t vert varepsilon_otvarepsilon_itvertbr smaller variabl octep note may never happen converg guarante variabl octpenalti set alpha penalti paramet describ previous variabl octinitialst specifi initi state propag start case ground state system case exampl valu oct_is_groundst mean variabl octtargetoper set kind target oper hato notat use use mention exampl use common kind target project onto target state hatovertpsi_tranglelanglepsi_tvert set variabl octtargetoper oct_tg_gstransform mean target state construct take linear combin spinorbit form ground state particular linear combin use set block variabl octtargettransformst variabl octtargettransformst block line code refer spin orbit form state system exampl oneparticl problem therefor one singl spinorbit spin orbit linear combin spinorbit calcul previou groundstat run column contain correspond coeffici case calcul two spinorbit ground state run therefor need two column target state simpli first excit state first column coeffici ground state orbit zero second column one variabl octdoublecheck simpli ask code perform final propag best field could find qoct iter scheme check realli work promis next section laser field initi guess simpli specifi initi laser field use initi guess mandatori sinc provid initi guess control paramet simpli real function varepsilont specifi tempor shape timedepend extern perturb also specifi kind extern perturb talk electr field x z polar magnet field etc final would like cute plot result add output section appli set variabl octdoublecheck ye sinc code plot anyth propag perform qoct iter variabl given permit us plot shape wavefunct propag well timedepend electr field project propag wave function onto ground state first excit state even simpl onedimension system run take minut lot propag see iter inform print standard output eg codeblock optim control iter j j j fluenc penalti dee e codeblock mean number clear notat introduc construct algorithm monoton converg mean valu j increas guarante final valu j_ actual approach one target full overlap first excit state certainli hope end run final propag best field usual one correspond last iter exampl get someth like codeblock final propag best field j j j fluenc codeblock almost achiev full transfer j_psivertlanglepsitvertpsi_tranglevert analysi result figur srcimagestutorial_basicqoct_convergencepng widthpx captionfig converg histori j black j_ red function figur srcimagestutorial_basicqoct_finalpng widthpx captionfig initi target state red green blue final propag state correspond last iter field run creat directori call file optcontrol among other file call file converg contain converg histori qoct run ie valu relev function qoct iter use make plot valu see result fig observ monoton increas j also case function j_ fact one realli interest grow approach uniti although final limit one case someth close may want get laser puls use iter set variabl variabl octdumpintermedi also directori call file initi use plot initi state directori call file target contain target state directori call file final contain state end propag correspond last qoct iter fig plot construct inform contain directori note initi target state imaginari part final propag wavefunct complex therefor plot real imaginari part directori file laserxxxx find file call file cp contain control paramet correspond qoct iter anoth file call file fluenc inform correspond fluenc format file file cp simpl first column time second third column real imaginari part control paramet sinc varepsilon defin real formul last column null final directori file laserbestj obvious contain control paramet correspond iter produc best j_ zhu w zhu j botina h rabitz j chem phi titl sternheim linear respons tag tutori advanc electromagnet respons molecul pseudopotenti dft optic absorpt sternheim difficulti advanc theori dft calculation_mod electromagnet respons system_styp molecul species_typ pseudopotenti featur optic absorpt sternheim seri tutori descript detail sternheim approach sternheim approach perturb theori allow effici calcul linear nonlinear respons properti footnot basi method standard perturb theori calcul variat wavefunct psi given perturb potenti advantag method variat obtain solv linear equat hepsilon omega psip_rm c hpsi depend occupi state instead requir infinit sum unoccupi state case timedepend densiti function theori variat hamiltonian includ term depend variat densiti equat must solv selfconsist run sternheim calcul octopu previou calcul need groundstat calcul tutori use water molecul basic input file ground state codeblock variabl calculationmod gs variabl coordin h h variabl radiu variabl space variabl convrelden e codeblock use tighter set scf converg convrelden help abil sternheim calcul converg numer increas bit size box respons calcul tend requir space around molecul groundstat calcul converg footnot groundstat calcul finish chang run mode code em_resp run calcul electricdipol respons codeblock variabl calculationmod em_resp codeblock next specifi frequenc respons use variabl emfreq block case use three valu unit hartre codeblock variabl emfreq codeblock also specifi small imaginari part frequenc unit ev avoid diverg reson codeblock variabl emeta ev codeblock final add specif linear solver greatli speed thing compar default codeblock variabl linearsolv qmr_dotp variabl experimentalfeatur ye codeblock run see calcul frequenc x z direct show scf iter linearsolv iter individu state psi label kpointspin ik state ist norm psi number linearsolv iter iter residu lefthepsilon omega psip_rm c hpsiright shown first see static respons codeblock linearrespons polariz wavefunct type complex calcul respons frequenc info calcul respons xdirect frequenc info em resp restart inform written restartem_resp info em resp restart inform read restartem_resp warn unabl read respons wavefunct wfs_x_f initi zero info finish read inform restartem_resp lr scf iter frequenc eta ik ist norm iter residu e e e e info write state info finish write state scf residu e ab e rel codeblock later come dynam respons neg state indic list indic respons omega frequenc code tri use save respons densiti closest previous calcul frequenc codeblock info calcul respons xdirect frequenc info em resp restart inform written restartem_resp info em resp restart inform read restartem_resp read respons densiti rho__ info finish read inform restartem_resp lr scf iter frequenc eta ik ist norm iter residu e e e e e e e e codeblock end directori call file em_resp contain subdirectori frequenc calcul turn contain file eta list eta unit ev file alpha contain real part polariz tensor file cross_sect contain crosssect absorpt base imaginari part polariz exampl file em_respfreq_alpha say codeblock polariz tensor b isotrop averag codeblock exercis compar result polariz crosssect calcul timepropag casida approach footnot articl titletimedepend densiti function theori scheme effici calcul dynam hyperpolariz authorsxavi andrad silvana botti miguel marqu angel rubio journalj chem phi volum page year doi footnot articl titlebasi set effect hyperpolariz chclsubsub gaussiantyp orbit numer basi set realspac grid authorsf vila strubb takimoto x andrad rubio g louie j j rehr journalj chem phi volum page year doi titl run octopu graphic process unit gpu tag tutori expert difficulti expert seri tutori descript notic warn chapter need updat gpu implement chang sinc written notic recent version octopu support execut graphic process unit gpu tutori explain gpu support work use speedup calcul octopu process port machin graphic process unit gpu oper support yet number support featur grow time notic note note code might fall back cpu oper unsupport featur notic consider use gpu calcul acceler gpu gpu massiv parallel processor work effici need larg amount data process mean use gpu simul small system like molecul less atom low dimension system probabl slower use cpu calcul octopu effect acceler gpu essenti ground state calcul rmmdii eigensolv calcul base ground state calcul like geometri optim time propag etr aetr propag simul use gpu effect type calcul might see improv perfom moreov octopu featur support gpu current hgh relativist pseudopotenti noncollinear spin curvilinear coordin period system partial support limit might forc code run cpu case octopu silent execut cpu support gpu octopu gpu support base opencl framework vendor independ current test gpu nvidia amd exati recent cuda support ad use cuda wrap layer notic warn actual noncuda version current untest develop system nvidia cuda base notic order run octopu gpu must doubl precis support amdati card avail highend model radeon xx xx xx xx fireprofirestream card recent nvidia card support doubl precis xx newer low middleend card howev limit process power probabl slower run octopu cpu import factor gpu memori need gpu least gib ram run octopu gib recommend activ gpu support octopu gpu support sinc version activ need version compil opencl support enabl see manual building_octopus_with_gpu_support manual detail version octopu compil opencl support see opencl among configur option text run octopu version superciliosu revis build time thu feb est configur option maxdim openmp opencl sse avx option librari netcdf clamdfft clamdbla ideal octopu version also compil option librari clamdfft clamdbla part httpsdeveloperamdcomtoolsheterogeneouscomputingamdacceleratedparallelprocessingmathlibrari amd appml packag librari work hardwar vendor includ nvidia start tutori run without opencl version octopu compil opencl support set variabl disableaccel code ye tell octopu use opencl select opencl devic opencl design work multipl devic differ vendor like singl opencl devic case need select opencl devic octopu use opencl platform identifi opencl implement multipl platform instal system octopu list avail platform begin execut exampl text info avail cl platform platform nvidia cuda opencl cuda platform amd acceler parallel process opencl amdapp default octopu use first platform select differ platform maxvers variabl openclplatform maxvers minvers variabl accelplatform minvers variabl select variabl name exampl minvers codeblock variabl accelplatform amd codeblock minvers maxvers codeblock variabl openclplatform amd codeblock maxvers use numer valu select platform index list minvers codeblock variabl accelplatform codeblock minvers maxvers codeblock variabl openclplatform codeblock maxvers first form prefer independ order platform opencl platform contain sever devic avail devic select platform print octopu like text info avail cl devic devic tahiti devic intelr coretm cpu ghz opencl devic certain type cpu gpu acceler default octopu tri use first devic type gpu fail octopu tri use default devic system defin opencl implement select differ devic use maxvers variabl opencldevic maxvers minvers variabl acceldevic minvers variabl select devic index type cpu gpu acceler notic note octopu opencl implement current design execut effici gpu octopu run cpu use opencl slower use cpu directli notic octopu select opencl devic print inform exampl text select cl devic devic vendor advanc micro devic inc devic name tahiti driver version vm comput unit clock frequenc ghz devic memori mib max alloc size mib devic cach kib local memori kib constant memori kib max workgroup size extens cl_khr_fp ye extens cl_amd_fp ye blocksiz obtain good peform gpu cpu octopu use block state basic data object size block control variabl statesblocks variabl gpu valu must power default optim perform must larg possibl catch larg valu might run gpu memori statespack poisson solver want use gpuacceler poisson solver need use fft solver clamdfft librari support compil select solver add text variabl poissonsolv fft variabl fftlibrari clfft input file span classnoprinthr back tutori titl larg system fulleren molecul tag tutori advanc ground state molecul pseudopotenti dft difficulti advanc theori dft calculation_mod ground state system_typ molecul species_typ pseudopotenti seri tutori descript set calcul larger system tutori solv fulleren molecul show simul system larg number atom octopu default paramet work fine larg system thing might need adjust eigensolv default eigensolv octopu simpl reliabl larg system orbit quit slow system better use rmmdii eigensolv effici diagon converg problem octopu follow algorithm implement kress furthmüller footnot provid robust algorithm follow consider taken good initi approxim eigenvalu eigenvector requir octopu mean lcao use rmmdii eigensolv default might well use altern eigensolv one two iter provid reason number variabl extrast around number occupi state must includ hand let see exampl input file file inp calcul ground state fulleren molecul rmmdii eigensolv codeblock variabl xyzcoordin cxyz variabl unitsoutput ev_angstrom variabl calculationmod gs variabl eigensolv rmmdii variabl extrast codeblock case use rmmdii thing need chang variabl eigensolv variabl includ variabl extrast default octopu includ unoccupi state content coordin file file cxyz codeblock c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c codeblock creat file run octopu take minut depend speed machin peculiar rmmdii eigensolv might notic first selfconsist iter take less time rest iter ensur proper initi approxim eigesolv differ diagon first step respect eigensolv take mani selfconsist iter converg calcul compens rmmdii step faster step small fix number eigensolv step done practic eigensolv selfconsist converg done togeth iter eigenvalu might order normal converg reach eigenvalu properli order selfconsist converg calcul finish might notic final residu eigenvector rather larg order two reason first possibl converg densiti without properli converg eigenvector sometim tri tighter toler rerun restart ad codeblock variabl convrelden e codeblock file inp file eigenvector better converg converg eigenvector mani state actual properli converg suppos want calcul correct unoccupi state would sure converg second reason poor converg use larg default space check output problem wellcondit larg space tri use smaller space one found methan tutorialmethane_molecul footnot kress furthmüllerhttpsdxdoiorgphysrevb titl vibrat mode tag tutori advanc vibrat mode geometri optim molecul pseudopotenti dft forc vibrat seri tutori theori dft calculation_mod geometri optim system_typ molecul species_typ pseudopotenti featur vibrat modesforc vibrat descript obtain vibrat mode use sternheim linear respons tutori show obtain vibrat mode octopu use sternheim linear respons use water molecul exampl start need geometri copi follow file call file hoxyz codeblock water molecul angstrom h h codeblock sinc obtain proper vibrat mode need close possibl minimum energi first optim geometri paramet defin simul use follow input file codeblock variabl calculationmod go variabl unitsoutput ev_angstrom variabl xyzcoordin hoxyz variabl space angstrom variabl radiu angstrom variabl boxshap minimum variabl filterpotenti filter_t variabl gomethod fire variabl experimentalfeatur ye codeblock see use smaller usual space larger spheric box requir sinc forc requir precis quantiti cours product run valu properli converg also increas precis forc total energi use variabl variabl filterpotenti specifi filter appli ionic potenti remov fourier compon higher repres grid run octopu calcul finish get optim geometri file minxyz modifi valu variabl xyzcoordin point file perform calcul vibrat mode need groundstat calcul well converg forc chang variabl calculationmod code gs run octopu ad variabl convforc e criterion stop selfconsist process given chang forc done check forc file staticinfo file reason small eva readi actual calcul vibrat mode chang variabl calculationmod code vib_mod run octopu calcul take sinc n_atom respons calcul requir final result written code vib_mod folder check file normal_frequencies_lr file codeblock codeblock kind inform give find correct equilibrium geometri tri visual vibrat eigenmod use xcrysden open file file normal_modes_lraxsf display menu set forc modifi set factor tri classifi mode translat rotat true intern vibrat one neg actual imaginari frequenc titl unsort tutori weight children titl polariz continuum model pcm theori dft calculation_mod ground statetimedepend system_typ molecul species_typ pseudopotenti featur polariz continuum model seri tutori descript calcul solvat energi hydrogen fluorid molecul water solut notic note carlo split tutori two part better fit categor tutori propos part solvat energi molecul solut within polariz continuum model part time propag solvent within polariz continuum model alreadi modifi intro havent split page yet gabriel finish first notic solvat energi molecul solut within polariz continuum model tutori show calcul solvat energi hydrogen fluorid molecul water solut set ground state calcul use polariz continnum model pcm time pcm implement theorylevel dft input requir input keyword activ gs pcm run variabl pcmcalcul variabl pcmstaticepsilon variabl pcmcalcul enabl pcm part calcul variabl pcmstaticepsilon contain valu rel static dielectr constant solvent medium particular exampl water epsilon correspond minim input ground state calcul solut codeblock variabl calculationmod gs variabl unitsoutput ev_angstrom variabl radiu angstrom variabl space angstrom variabl pseudopotentialset hgh_lda fh angstrom variabl coordin h f fh variabl pcmcalcul ye variabl pcmstaticepsilon codeblock warn pleas note latter input exampl intend make familiar run octopu pcm calcul provid benchmark hf molecul actual geometri might optim gs energi might converg respect radiu space variabl new converg analysi wrt radiu space independ one vacuo principl due pcm activ geometri optim solvat molecul within octopu still develop might work properli minor adjust geometri pass vacuuum solvent select pseudopotentialset implicit choic lda xc function particular exampl arbitrari output main output gs pcm calcul solvat energi system extract file file staticinfo actual info file produc calcul previou output contain follow energet contribut codeblock energi ev total free ionion eigenvalu hartre intnv_xc exchang correl vanderwa delta xc entropi ts e_esolv e_nsolv e_msolv kinet extern nonloc codeblock e_msolv solvat energi turn split term due electron anoth one due nuclei e_esolv e_nsolv respect notic note carlo add first line output file notic perform calcul hf water use previou input new folder call pcm creat insid work directori input file lie pcm folder contain follow file file cavity_molxyz use way visual molecul insid caviti tessel caviti plot collect fictiti hydrogen atom check file good sure molecul fit well insid caviti tessel doesnt contain artifact first line file codeblock h h h codeblock file pcm_infoout summari gs pcm calcul contain inform tessel tabl pcm energet contribut total polar charg due electron nuclei iter scf cycl pcm energet contribut split interact energi electron polar charg due electron esubeesub electron polar charg due nuclei esubensub nuclei polar charg due nuclei esubnnsub final nuclei polar charg due electron exampl file codeblock configur molecul solvent epsilonsolv number interlock sphere sphere element center xyz radiu f number tessera sphere total number tessera caviti surfac area caviti volum iter e_e e_en e_nn e_n e_msolv q_pol deltaq q_pol deltaqn codeblock file pcm_matrixout pcm respons matrix print advanc debug special check gamess pcm matrix condit solvent dielectr constant geometri caviti file asc_edat polar charg due electron file asc_ndat polar charg due nuclei file asc_soldat polar charg due full molecul notic note carlo word warn sign charg notic format polar charg file codeblock caviti posit x caviti posit caviti posit z polar charg label codeblock indic column separ actual replac space asc_dat file exercis figur srcimagespcm_gs_convergencepng widthpx captionconverg solvat energi hf water solut function number scf iter look first converg total energi system notic note carlo clarifi mean energi molecul solvat energi make figur accordingli notic look like figur import notic fact stabil system solvent respect vacuo case find final valu sign energi differ case obtain upon converg notic note carlo pleas renam someth meaning pcm_gs_convergencepng make figur larger mediawiki thumbnail automat also sure inset use mayb suggest plot log scale exercis notic anoth import check ascertain whether gauss theorem fulfil total polar charg ie q_polepsilonepsilon time q_m valid q_m nomin charg molecul latter fail set variabl pcmrenormcharg ye manipul variabl pcmqtottol gauss theorem recov scf iter timestep advanc set caviti improvedrefin sever way increas number point caviti chang default valu variabl variabl pcmtesssubdivid practic tessel sphere center atom posit hydrogen point check converg final valu total energi respect differ tessel also relax constrain minimum distanc variabl pcmtessmindist default tessera obtain smooth caviti might use geometri molecul complic check total energi chang construct molecular caviti put sphere also hydrogen ie set variabl pcmspheresonh ye chang radiu sphere use build caviti manipul variabl pcmradiussc moreov use variabl pcmcaviti full path caviti file keyword caviti geometri read file instead gener insid octopu default time propag solvent within polariz continuum model tutori show perform time propag methen molecul solvent set timedepend calcul use timedepend polariz continnum model tdpcm case gasphas calcul perform alway gs calcul td one time pcm implement theorylevel dft notic note carlo put differ method differ section use name octopu paper plea add comment input output notic sever way set pcm td calcul octopu correspond differ kind approxim coupl evolut solutesolv system equilibrium tdpcm first elementari approxim would consid evolut solvent abl instantan equilibr solut densiti fluctuat formal within pcm mean dielectr function constant equal static zerofrequ valu frequenc epsilonomegaepsilon_ practic approxim requir minim chang gs input file replac gs td calculationmod leav pcm relat variabl unchang span stylecolor redcarlo gabriel pleas check correspond meanspan input codeblock variabl calculationmod td variabl unitsoutput ev_angstrom variabl radiu angstrom variabl space angstrom variabl pseudopotentialset hgh_lda fh angstrom variabl coordin h f fh variabl pcmcalcul ye variabl pcmstaticepsilon codeblock output inerti tdpcm first nonequilibrium approxim consid fast slow degre freedom solvent former abl equilibr real time solut slow degre freedom solvent frozen time equilibrium initi gs state propag formal mean consid two dielectr function zerofrequ highfrequ regim name static dynam dielectr constant practic approxim final activ set extra input keyword ie variabl pcmtdlevel neq variabl pcmdynamicepsilon latter dynam dielectr constant valu input output equat motion pcm final last accur nonequilibrium approxim equat motion evolut solvent polar charg render historydepend formal requir use specif model frequencydepend dielectr function input output titl berri tag tutori advanc bulk berri phase seri tutori difficulti advanc system_typ bulk featur berri phase hidden true case finit electr field appli period system octopu code comput effect finit electr field finit use techniqu modern theori polar notion berri phase tutori give detail current implement use moment code use calcul perform singl kpoint therefor valid limit larg supercel tutori still construct titl geometri optim tag tutori beginn geometri optim molecul pseudopotenti dft total energi forc seri tutori difficulti beginn theori dft calculation_mod geometri optim species_typ pseudopotenti system_typ molecul featur total energi forc descript determin geometri methan tutori show perform geometri optim use octopu methan molecul manual optim start methan molecul use sophist algorithm geometri optim quit instruct first hand cours practic system degre freedom case methan need optim ch bondlength use follow file file inp file codeblock variabl calculationmod gs variabl unitsoutput ev_angstrom variabl radiu angstrom variabl space angstrom ch angstrom variabl coordin c h chsqrt chsqrt chsqrt h chsqrt chsqrt chsqrt h chsqrt chsqrt chsqrt h chsqrt chsqrt chsqrt codeblock input file similar one use tutori seen tutori basicstot energi converg total_energy_converg tutori valu space radiu total energi converg within ev file chsh script run code hand chang bondlength calcul also use follow script bash binbash echo ch distanc total energi chlog list ch list sed ie ch sch inp octopu outch energygrep total staticinfo head cut f echo ch energi chlog rm rf restart done figur srcimagesmethane_energy_vs_chpng widthpx captionenergi versu ch bond length methan result run calcul obtain valu similar follow one codeblock ch distanc total energi codeblock see right curv look like plot simpl inspect realiz equilibrium ch distanc obtain around å compar experiment valu å data calcul frequenc vibrat breath mode methan fire sinc chang bondlength hand exactli simplest method perform geometri optim use autom algorithm precis sever algorithm avail octopu default recommend one fire methodfootnot octopu also use gsl optim routineshttpswwwgnuorgsoftwaregslmanualhtml_nodemultidimensionalminimizationhtml method provid librari avail input first run simpl geometri optim use follow input file codeblock variabl fromscratch ye variabl calculationmod go variabl unitsoutput ev_angstrom variabl boxshap sphere variabl radiu angstrom variabl space angstrom ch angstrom variabl coordin c h chsqrt chsqrt chsqrt h chsqrt chsqrt chsqrt h chsqrt chsqrt chsqrt h chsqrt chsqrt chsqrt codeblock case use default valu input variabl relat geometri optim compar input file chang variabl calculationmod code go default minimum box sphere center atom caveat perform geometri optim see bellow detail also chang box shape singl sphere å radiu like alway converg final result check respect mesh paramet case trust us radiu å suffici geometri input file use start point note although singl variabl ch use specifi structur coordin optim independ output run octopu geometri optim mode output bit differ normal groundstat mode sinc minim step requir sever scf cycl one line inform scf iter print codeblock info start scf iter eta iter etot e abs_den e forc e etim eta iter etot e abs_den e forc e etim eta iter etot e abs_den e forc e etim eta iter etot e abs_den e forc e etim eta iter etot e abs_den e forc e etim eta iter etot e abs_den e forc e etim eta iter etot e abs_den e forc e etim info write state info finish write state info scf converg iter minim iter energi ev max forc eva max dr codeblock end minim step code print total energi maximum forc act ion maximum displac ion previou geometri next one octopu also print current geometri file name file goxxxxxyz xxxx minim iter number directori name file geom work directori also file name file workgeomxyz accumul geometri scf calcul result also summar file geomoptimizationlog recent individu geometri file lastxyz minim step code exit codeblock minim iter energi ev max forc eva max dr write final coordin minxyz info finish write inform restartg codeblock minim success file name file minxyz written work directori contain minim geometri case look like codeblock unit c h h h h codeblock symmetri retain equilibrium bond length determin check forc file staticinfo also visual optim process anim load file workgeomxyz xyz file xcrysden sodium trimer let tri someth differ small sodium cluster time use altern method relat conjug gradient input input file use codeblock variabl fromscratch ye variabl calculationmod go variabl unitsoutput ev_angstrom variabl radiu angstrom variabl space angstrom variabl xyzcoordin inpxyz variabl gomethod cg_bfg codeblock correspond file inpxyz file codeblock na na na codeblock case start geometri random geometri output time code stop success inform last minim iter look like codeblock minim iter energi ev max forc eva max dr codeblock might notic case code might perform sever scf cycl minim iter normal minim algorithm use requir evalu energi forc sever geometri per minim iter minim geometri found file minxyz file codeblock unit na na na codeblock caveat use minimum box exampl use minimum box codeinlin variabl boxshap minimum codeinlin box shape one use default usual effici one requir care use geometri optim reason box gener begin calcul updat atom move mean end optim center sphere compos box coincid anymor posit atom problem atom move enough initi final posit differ significantli case best restart calcul use previous minim geometri start geometri box construct consist atom exampl done copi content file minxyz file file inpxyz run octopu without chang input file time calcul converg one iter codeblock minim iter energi ev max forc eva max dr codeblock compar old file minxyz file new one codeblock unit na na na codeblock although differ larg also neglig improv geometri imagin want improv geometri obtain reduc valu forc act ion stop criterion control variabl gotoler variabl variabl gominimummov default valu evå hb let set evå codeblock variabl fromscratch ye variabl calculationmod go variabl unitsoutput ev_angstrom variabl radiu angstrom variabl space angstrom variabl xyzcoordin inpxyz variabl gomethod cg_bfg variabl gotoler evangstrom codeblock copi content file file minxyz file file inpxyz rerun code time minim step octopu return follow error messag codeblock fatal error fatal error descript follow error occur gsl minim procedur iter make progress toward solut codeblock mean minim algorithm unabl improv solut desir accuraci unfortun mani thing done case simpl one restart calcul start last geometri use last file goxxxxxyz file see code abl improv geometri footnot articl titlestructur relax made simpl authorserik bitzek pekka koskinen franz gähler michael mosel peter gumbsch journalphi rev lett volum page year urlhttpsjournalsapsorgprlabstractphysrevlett doiphysrevlett linkap titl unfold tag tutori expert ground state bulk octunfold difficulti expert system_typ bulk calculation_mod ground state util oct_unfold descript perform bandstructur unfold tutori look perform bandstructur unfold use octopu calcul done step describ first need comput ground state supercel input start input file octopu ground state calcul bulk silicon similar one tutori tutori periodic_system period system present case howev use supercel si compos atom codeblock variabl calculationmod gs variabl periodicdimens boxshap parallelepip variabl space variabl latticeparamet variabl reducedcoordin si si si si si si si si nk variabl kpointsgrid nk nk nk variabl kpointsusesymmetri ye variabl convrelden e variabl eigensolvertoler e codeblock variabl alreadi use tutori interest read could refer instanc tutori periodic_system period system detail descript unfold step run octopu use previou input file obtain ground state supercel defin primit cell want unfold supercel specif kpoint path interest done ad input file follow line codeblock variabl unfoldmod unfold_setup variabl unfoldlatticeparamet variabl unfoldlatticevector variabl unfoldkpointspath l point gamma point x point anoth gamma point codeblock let see detail input variabl tt variabl unfoldmod unfold_setuptt variabl instruct util ttoctunfoldtt mode run first step rune ttunfold_setuptt mode gener necessari file get unfold band structur tt variabl unfoldlatticeparamet tt specifi lattic paramet primit cell variabl similar variabl latticeparamet tt variabl unfoldlatticevector tt specifi lattic vector primit cell variabl similar variabl latticevector tt variabl unfoldkpointspath tt specifi kpoint path unfold coordin indic reduc coordin primit lattic variabl similar variabl kpointspath run ttoctunfoldtt obtain two file first one ttunfold_kptdattt contain list kpoint specifi kpoint path express reduc coordin supercel kpoint need evalu wavefunct supercel second file ttunfold_gvecdattt contain list reciproc lattic vector relat kpoint primit cell one supercel unfold still experiment featur also need add input file line codeblock experimentalfeatur ye codeblock unfold step order perform unfold must comput wavefunct supercel specif kpoint point describ file ttunfold_kptdattt get need run non selfconsist calcul use codeblock variabl calculationmod unocc codeblock order use list kpoint obtain step remov input file kpoint relat variabl variabl kpointsgrid variabl kpointspath variabl kpoint replac line codeblock includ unfold_kptdat codeblock run octopu input file note order get extra state one use variabl variabl extrast variabl extrastatestoconverg normal band structur calcul see tutori periodic_system period system tutori use codeblock variabl extrast variabl extrastatestoconverg maximumit codeblock note perform step run td calcul folder inde origin gs state replac one unocc calcul request converg unoccupi state correspond first valenc band fold primit cell supercel time larger initi cell unfold step comput state requir kpoint final comput spectral function kpoint specifi kpoint path done chang unfold mode codeblock variabl unfoldmod unfold_run codeblock produc spectral function full path ttstaticakedattt individu point path ttstaticake_xxxdattt unfold bandstructur silicon shown figur srcimagessi_unfoldedpng widthpx captionunfold band structur bulk silicon note order control energi rang energi resolut unfold band structur one specifi variabl variabl unfoldminenergi variabl unfoldmaxenergi variabl unfoldenergystep import note code need read unoccupi wavefunct therefor need enough memori titl rdmft tag tutori advanc rdmft difficulti advanc theori independentparticl rdmft calculation_mod ground state system_typ molecul species_typ pseudopotenti descript reduc densiti matrix function theori rdmft calcul seri tutori tutori learn reduc densiti matrix function theori rdmft calcul octopu contrast densiti function theori hartreefock theori tri find one optim slaterdetermin singlerefer describ groundstat given manybodi system instead approxim onebodi reduc densiti matrix rdm system thu outcom rdmft minim set eigenvector call natur orbit no eigenvalu socal natur occup number non rdm one import aspect need use orbit number electron addit freedom allow includ static correl descript system henc describ set process difficult singlerefer method one process dissoci molecul util exampl tutori learn properli converg dissoci studi h_ inform rdmft recommend eg chapter reduc densiti matrix function theori rdmft linear respons timedepend rdmft tdrdmft book ferr n filatov huixrotl densityfunct method excit state springer doi basic step rdmft calcul first thing notic rdmft calcul explicitli make use basi set contrast minim full realspac grid perform normal octopu consequ alway need preliminari calcul gener basi set exemplifi hydrogen molecul equilibrium posit creat follow file inp file codeblock variabl calculationmod gs variabl theorylevel independent_particl variabl dimens variabl radiu variabl space distanc h atom equilibrium bond length h variabl coordin h h variabl extrast codeblock alreadi familiar variabl need explain want stress two import point chose variabl theorylevel independent_particl alway use basi rdmft calcul see actual octopu paper set variabl extrast variabl control size basi set use rdmft calcul thu rdmft basi set new numer paramet besid variabl radiu variabl space need converg success calcul size basi set number orbit ground state number electron divid plu number extra state numer paramet depend want includ mani variabl extrast suffici larg basi need also larger variabl radiu especi smaller variabl space certain point reason addit state function valu bigger zero larger region bound state addit state orthogon thu grid need resolv node increas number variabl extrast basi first rdmft calcul need chang variabl theorylevel rdmft add part variabl experimentalfeatur ye standard new inform calcul coulomb exchang matrix element basi may take occup number zero onetwo instead fraction anyth els import basi set converg need converg calcul three numer paramet need done iter way mean first set variabl extrast converg seri variabl radiu variabl space know util converg valu perform seri variabl extrast converg variabl extrast start seri variabl radiu variabl space see energi better electron densiti still chang consider ye mea higher lie variabl extrast net well captur simul box need adjust paramet go like converg paramet sound like lot work dont worri done converg studi time get feel good valu let us one iter exampl start guess variabl extrast small say thu converg variabl radiu variabl space save time found valu variabl radiu variabl space feel insecur converg studi look correspond tutori tutorialtotal_energy_converg let us perform basisset seri first creat refer basi repeat calcul say variabl extrast copi restart folder new folder call basi execut follow script renam anyth need chang respect part script bash binbash seriesesseri outfileserieslog echo es energi non non outfil list export oct_parse_env param list folderseriesparam mkdir folder out_tmpoutrdmftparam cd folder specifi basi folder cp r basisrestart creat inp file cat eof calculationmod gs theorylevel rdmft experimentalfeatur ye extrast param dimens radiu space distanc h atom equilibrium coordin h h output densiti outputformat axis_x eof inp put octopu dir octopusdirbinoctopu out_tmp energygrep total energi out_tmp tail awk print seigengrep staticinfo awk print peigengrep staticinfo awk print echo param energi seigen peigen outfil cd done everyth work fine find follow output esserieslog file codeblock es energi non non e e e e e e codeblock see even calcul entir converg thu correctli converg result one would need increas basi optim simul box sinc calcul becom quit expens would need highperform cluster goe beyond scope tutori thu proceed entir converg paramet next section h dissoci third last part tutori come back origin goal calcul h dissoci curv want chang dparamet input file consequ use adapt simul box suit dissoci codeinlin variabl boxshap cylind codeinlin howev sinc make calcul much expens stick default choic codeinlin variabl boxshap minim codeinlin choos codeinlin variabl extrast codeinlin compromis accuraci numer cost dseri follow script bash binbash seriesdistseri outfileserieslog echo es energi non non outfil list export oct_parse_env param list folderseriesparam mkdir folder out_tmpoutseriesparam cd folder creat inp file cat eof calculationmod gs theorylevel rdmft experimentalfeatur ye extrast dimens radiu space distanc h atom param coordin h h output densiti outputformat axis_x eof inp put octopu dir oct_diroctopusdeveloperbin gener basi export oct_theorylevelindependent_particl oct_diroctopu out_tmp_basi actual rdmft calcul export oct_theorylevelrdmft oct_diroctopu out_tmp energygrep total energi out_tmp tail awk print nongrep staticinfo awk print nongrep staticinfo awk print echo param energi non non outfil cd done execut script take minut normal machin time welldeserv coffe script finish find new log file plot energi file get someth follow shape fileh diss curvepngthumbdissoci curv hydrogen molecul calcul rdmft use müller function comment dissoci limit correct sinc basi set converg get larg valu e_diss müller function obtain converg set e_diss hartre paradox closer exact dissoci limit e_diss hartre error cancel small base alway increas energi princip shape good especi see curv becom constant larg singlerefer method reproduc titl wannier tag tutori expert ground state bulk metal octwanni difficulti expert system_typ bulk metal calculation_mod ground state util octwanni descript use wannier interfac start octopu selen x octopu provid interfac wannier order perform tutori need first compil wannier detail inform found wannier websitehttpswwwwannierorg tutori follow second exampl wannier tutori consist comput fermi surfac lead requir sever step explain detail bellow groundstat input start input file octopu point noth special specifi octopu need know wannier call later codeblock variabl calculationmod gs variabl periodicdimens variabl space variabl latticevector variabl latticeparamet variabl pseudopotentialset hgh_lda variabl reducedcoordin pb variabl kpointsgrid variabl smear ev variabl smearingfunct fermi_dirac variabl extrast codeblock use variabl alreadi explain detail tutori see exampl period systemsperiodic_system tutori nevertheless option deserv detail explan tt variabl smearingfunct fermi_diractt interest lead metal need use smear occup order get converg groundstat chosen smear function fermidirac distribut tt variabl smear evtt defin effect temperatur smear function tt variabl pseudopotentialset hgh_ldatt sinc lead provid default pseudopotenti set must select one contain pb thu use lda hgh pseudopotenti set also import note kpoint symmetri use wannier also monkhorstpack grid allow one kpoint shift allow output run octopu use input file output similar groundstat calcul period system go look detail nevertheless make sure problem calcul sinc need inform later check calcul fermi energi find inform file staticinfo file codeblock fermi energi h codeblock wannier usag wannier postprocess tool requir sever step sever invoc wannier octopu note interfac wannier octopu done special util call file octwanni step one creat wannier input file order run wannier must prepar input file make task easier file octwanni util take octopu input file translat wannier input file util look like codeblock variabl calculationmod gs variabl periodicdimens variabl space variabl latticevector variabl latticeparamet variabl pseudopotentialset hgh_lda variabl reducedcoordin pb variabl kpointsgrid variabl smear ev variabl smearingfunct fermi_dirac variabl extrast variabl wanniermod w_setup codeblock basic input file follow option ad tt variabl wanniermod w_setuptt tell file octwanni util want setup input file wannier base content input file run file octwanni util creat file name file wwin look like codeblock file creat octopu wannier util begin unit_cell_cart ang end unit_cell_cart begin atoms_frac pb end atoms_frac use_bloch_phas true num_band num_wann write_u_matric true translate_home_cel true write_xyz true mp_grid begin kpoint codeblock run wannier go slightli tweak file interest lead replac follow line codeblock use_bloch_phas true num_band num_wann codeblock codeblock num_band num_wann begin project pbsp end project codeblock tell wannier want find wannier state band contain dft calcul moreov use guess project base sp orbit attach lead atom detail wannier project disentangl found tutori manual wannier step gener file nnkp file edit file file wwin run wannier postprocess mode commandlin wannierx pp wwin produc file name file wnnkp file contain inform tell octopu inform wannier requir follow step step gener file wannier stage go tell octopu gener file wannier use inform file wnnkp file chang valu variabl wanniermod variabl octopu input file codeblock variabl wanniermod w_output codeblock run file octwanni util time util produc file file weig file wmmn file wamn variabl control file produc variabl wannierfil step run wannier final call wannier perform wannier commandlin wannierx wwin comput fermi surfac figur srcimagesfs_lead_band_bandpng widthpx captionfermi surfac band lead perform previou step know run wannier top octopu calcul let comput interpol fermi surfac add follow line file wwin file codeblock restart plot fermi_energi fermi_surface_plot true codeblock valu fermi energi correspond one obtain octopu convert ev call wannier obtain file file wbxsf plot use instanc xcrysden commandlin xcrysden bxsf wbxsf abl produc plot fermi surfac band band shown figur visual wannier state use octopu wannier wannier allow one comput wannier state need output period part bloch state realspac grid produc file unk file need specifi output file octwanni ad follow line file inp file codeblock variabl wannierfil w_unk codeblock note order get file need one run could instead use tt variabl wannierfil w_amn w_mmn w_eig w_unktt altern way get state let octopu comput need get ttutt matric wannier ad follow line file wwin file codeblock write_u_matric true codeblock run file octwanni util appropri mode codeblock variabl wanniermod w_wannier codeblock creat folder name file wannier contain calcul wannier state main advantag wannier state obtain output format support octopu control usual variabl outputformat variabl titl parallel perform tag tutori advanc difficulti advanc seri tutori descript use octopu supercomput notic note tutori page set benasqu tddft school specif refer supercomput use time adapt other use tutori notic tutori see run rel big system hopper supercomputerhttpswwwnerscgovuserscomputationalsystemshopp nersc california measur perform key thing need know interact machin log run code ssh trainxhoppernerscgov termin substitut actual name train account awar sinc machin far away tri run xwindow program submit job code qsub command eg code qsub jobscr put queue execut free space see job current queue execut code qstat u user see job finish statu code shown q wait queue r run c complet cancel job code qdel job number written code qstat job script eg code jobscr specifi paramet pbstorqu queu system mani core use command run etc run ground state need input file job submiss script coordin file pseudopotenti mg element use default one come octopu pseudopotenti avail octopu directori code jubeinputmgfhi copi file hopper directli code globalhomesddstrubbeoctopus_tutori scratch directori follow bash cd scratch cp r globalhomesddstrubbeoctopus_tutori input file file inp codeblock variabl calculationmod gs system size paramet variabl space variabl radiu variabl unit ev_angstrom variabl xyzcoordin xyz variabl speci mg spec_ps_fhi variabl excesscharg variabl xcfunction gga_x_pb gga_c_pb variabl extrast variabl eigensolv rmmdii variabl lcaoaltern ye variabl smearingfunct fermi_dirac variabl smear variabl mix gs variabl maximumit variabl eigensolvertoler e variabl convrelden e save memori variabl symmetriescomput variabl partitionprint variabl meshpartitionpackag meti addit option variabl experimentalfeatur ye codeblock submiss script file jobscr cpu processor core bash binbash pb q regular pb l mppwidth pb l advresbenasqu pb l walltim pb n testing_chl pb v modul load octopu cd pbs_o_workdir aprun n octopus_mpi output_gs_ run bash qsub jobscr coordin file file xyz take look local machin visual softwar code xcrysden see kind molecul deal expand expand xyz file codeblock unit c c h h h n c h h h h mg c c c c n c c c c c c c c n c c c c c c c n c c c c c c c n c c c c c c c c c c c c c c c c c c c c c c c c c c c c c h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h h codeblock expand job finish take look output see happen make sure complet success timepropag run timedepend profil chang input file accordingli chang variabl calculationmod code gs code td add follow line codeblock td dt variabl tdpropag aetr variabl tdtimestep dt profil variabl profilingmod prof_memori variabl tdmaxstep variabl fromscratch ye codeblock time exactli td run chang number cpu processor core chang xxx power x start fastest divid step run core may work bash binbash pb q regular pb l mppwidthxxx pb l advresbenasqu pb l walltim pb n testing_chl pb v modul load octopu cd pbs_o_workdir aprun n xxx octopus_mpi output_td_xxx differ code profilingxxx folder creat execut need process mainli abl plot inform contain run next script run fine without argument control file go process use follow argument analyzesh first argument biggest number cpu processor core go consid second option argument number refer file go use third one start number ie smallest number cpu core consid bash binbash copyright c j alberdirodriguez program free softwar redistribut andor modifi term gnu gener public licens publish free softwar foundat either version option later version program distribut hope use without warranti without even impli warranti merchant fit particular purpos see gnu gener public licens detail receiv copi gnu gener public licens along program write free softwar foundat inc templ place suit boston usa analyzesh defin biggest number processor z last_proc els last_proc fi defin refer filefold z ref els ref fi defin start valu z start els start fi initialis output file echo profile_start numstartnumlast_procnum echo num profile_start done rm f tmp analyz profilingxxxxxxtim get time per subroutin count function_nam less profilingreftim awk print count lt countcount els echo function_nam tmp iter power two profil numstartnumlast_procnum folderprintf profilingdn num xless foldertim grep function_nam awk print zero_x_ zero __ echo x tmp els echo tmp fi done past profile_start tmp tmp rm tmp cp tmp profile_start fi done echo result profile_start file point run analyzesh thu creat file name profile_ take look follow column profil data time_step iter time good scale complete_dataset whole time execut gener decreas obviou real execut initi time execut one bigger system_init initi time abl stop increas time almost constant independ number process poisson_solv execut time poisson somehow constant case solver domain parallel restart_writ time write restart file depend much system statu number run process could heavili decreas written local drive plot use follow script bash binbash copyright c j alberdirodriguez program free softwar redistribut andor modifi term gnu gener public licens publish free softwar foundat either version option later version program distribut hope use without warranti without even impli warranti merchant fit particular purpos see gnu gener public licens detail receiv copi gnu gener public licens along program write free softwar foundat inc templ place suit boston usa plot_functionsh eq functiontime_step els function fi echo function column_numb awk v funfunct foriinfi fun print profile_ script_dir cd dirnam bash_sourc pwd sed srefcolumn_numberg script_dirplot_ref plot_bas sed sfunctionfunctiong plot_bas gnuplot plot_bas also need auxiliari file bash copyright c j alberdirodriguez program free softwar redistribut andor modifi term gnu gener public licens publish free softwar foundat either version option later version program distribut hope use without warranti without even impli warranti merchant fit particular purpos see gnu gener public licens detail receiv copi gnu gener public licens along program write free softwar foundat inc templ place suit boston usa plot_ref set postscript ep enhanc color solid set output gnuplotep set xlabel mpi process set ylabel set logscal yx plot profile_ u ref w linespoint function x someth els tri core node core case would need analyzesh make profile_ plot script bash plot profile_ u ref w linespoint function x profile_ u ref w lp function x parallel domain vs state divid work among processor differ way divid point domain processor divid state group processor combin tri differ combin ad input file codeblock variabl parstat variabl pardomain codeblock run core differ number first two field whose product total number processor eg x x pfft poisson solver anoth thing tri compar pfft parallel fft poisson solver one use look output file see one need use aprun line job script instead previou one bash aprun n xxx globalhomesjjosebaoctopusbinoctopus_mpi output_td_xxx order use differ octopu compil use librari add line input file codeblock variabl poissonsolv fft variabl fftlibrari pfft codeblock compar run one similar number processor previous time solver compar also tri ordinari fftw parallel codeblock variabl fftlibrari fftw codeblock parallel ground state also tri differ paramet algorithm see effect speed groundstat calcul processor look variabl refer see mean see option use previou run parallel domain vs state eigensolv rmmdii plan cg cg_new lobpcg statesorthogon cholesky_seri cholesky_parallel mg qr subspacediagon standard scalapack linearcombin atom orbit lcao initi guess variabl lcaoaltern ye case add variabl maximumit lcao rather whole calcul titl arp tag tutori advanc timedepend surfac user defin potenti tutori period system difficulti advanc theori independ particl system_typ semiperiod species_typ user defin potenti descript tutori aim introduc user basic concept need calcul arp octopu seri tutori weight tutori aim introduc user basic concept need calcul arp octopu choos test case fictiti noninteract twodimension system semiperiod boundari condit ground state start time propag need obtain ground state system simul arp simul tsurrf implement octopusfootnot one need explicitli model surfac materi requir often lead heavi simul reason tutori illustr procedur model system calcul arp tddft abinitio model surfac involv step input system choos toy model potenti simul atom chain dimension select tell octopu use spatial dimens xy codeinlinevari dimens codeinlin impos period boundari condit along x codeinlinevari periodicdimens codeinlin codeblock include_input doctutorialsotherarpesgsinp codeblock octopu calcul arp path reciproc space reason specifi path variabl kpointspath block alreadi ground state level need gener ks wave function evolv time propag also provid band structur use refer crosscheck qualiti spectrum note sinc toy model independ electron codeinlinevari theorylevel independent_particlescodeinlin need sampl bz grid reciproc space constitut gamma point codeblock include_input_snippet doctutorialsotherarpesgsinp kpoint codeblock timedepend run calcul arp spectrum excit system laser field excit electron vacuum ie nonperiod dimens photoelectron detect probabl constitut arp calcul analyz flux ioniz current trough surfac posit certain distanc surfac system current obtain propag time ks orbit effect laser input input file look time propag expand full input file codeblock include_input doctutorialsotherarpestdinp codeblock expand chang variabl calculationmod code td activ time propag codeblock include_input_snippet doctutorialsotherarpestdinp mode codeblock specifi laser field paramet follow codeblock include_input_snippet doctutorialsotherarpestdinp laser_field codeblock sinc deal period system specifi lightmatt coupl call veloc gaug field describ timedepend vector potenti specifi field vector_potenti polar along x carrier frequenc wpr codeblock include_input_snippet doctutorialsotherarpestdinp vector_potenti codeblock sin envelop function probe specifi analyt express time codeblock include_input_snippet doctutorialsotherarpestdinp tdfunction codeblock also specifi total time propag exactli synchron puls switchoff time set codeinlinevari tdpropagationtim tprcodeinlin detail look tutori basicstimedependent_propag timedepend propag tutori photoelectron eject system laser eventu bounc back boundari simul box along nonperiod dimens therefor employ absorb boundari condit prevent spuriou reflect follow code block codeblock include_input_snippet doctutorialsotherarpestdinp cap codeblock employ complex absorb potenti cap boundari codeinlinevari absorbingboundari capcodeinlin specifi cap paramet variabl abcapheight variabl abshap maxim absorpt energi region expect photoelectronsfootnot final specifi paramet evalu arp spectrum codeblock include_input_snippet doctutorialsotherarpestdinp arp codeblock tell octopu use tsurff codeinlinevari photoelectronspectrum pes_flux codeinlin specifi posit analyz surfac onset absorb boundari codeinlinevari pes_flux_ls lmincodeinlin defin paramet energi grid final spectrum block variabl pes_flux_energygrid tsurff method allow calcul momentumresolv photoelectron probabl pbf p arbitrari grid momentum space arp spectrum obtain rewrit pbf p function total kinet energi momentum parallel surfac bf p_parallel equival crystal momentum bf k pbf p_parallelbf k ebf p_parallel bf p_perp sinc simpl cartesian grid momentum result deform arp grid octopu gener grid compens deform final arp spectrum cartesian grid grid gener codeinlinevari pes_flux_arpes_grid yescodeinlin sinc option true default semiperiod system specifi input file output code run correctli standard output present photoelectron section like codeblock photoelectron info calcul pe use tsurff techniqu input pes_flux_shap pln input pes_flux_ls input pes_flux_parallel pf_none input pes_flux_momenutum_grid cartesian energi grid emin emax de h e momentum linear grid pmin pmax dp mebhpih e input pes_flux_arpes_grid ye number point e p input pes_flux_usesymmetri input pes_flux_runtimeoutput info total number surfac point info total number momentum point codeblock arp spectral inform photoelectron store file restarttdpesflux binari file analyz postprocess command octphotoelectron_spectrum util octopu provid util call command octphotoelectron_spectrum process file pesflux file obtain spectrum input util default requir input user calcul design obtain arp spectrum td run perform codeinlinevari pes_flux_arpes_grid yescodeinlin inform need run util path inp file resid output get codeblock kpoint select use zeroweight path reciproc space follow point read pe restart file zenith axi eta arp cut reciproc space path done codeblock goe well file file pes_arpespath creat contain arp spectrum evalu kpoint path spectrum visual command gnuplot densiti plot codeblock set pmd map sp pes_arpespath u codeblock figur srcimagesarpes_dpng widthpx captionarp spectrum atom chain model system arp spectrum look bit blocki improv resolut one increas number kpoint kpointspath requir recomput groundstat decreas energi space variabl pes_flux_energygrid keep mind larger grid impli heavier simul longer run time question think arp spectrum compar band structur plot one top command gnuplot choos photoelectron energi rang previou exampl chose emin wpr emax wpr order see photoelectron emit valenc band chang variabl pes_flux_energygrid see band conduct band play around laser carrier wpr puls envelop tpr identifi impact paramet spectrum refer footnot articl titlea firstprincipl timedepend densiti function theori framework spin timeresolv angularresolv photoelectron spectroscopi period system authorsu de giovannini h hübener rubio journaljctc volum page year doiacsjctcb footnot articl titlemodel electron dynam coupl continuum state finit volum absorb boundari authorsu de giovannini h larsen rubio rubio journalepjb volum page year doiepjb tutorialfoot titl wire slab tag advanc ground state unoccupi chain slab pseudopotenti dft band structur tutori period system difficulti advanc theori dft calculation_mod ground state unoccupi system_typ chain slab species_typ pseudopotenti featur band structur descript use flexibl realspac grid treat system period one two dimens seri tutori weight tutori explain use flexibl realspac grid treat system period one two dimens exampl use na chain hexagon boron nitrid hbn monolay introduct period systemsperiod system tutori saw variabl periodicdimens input variabl control number dimens consid period tutori consid case tt variabl periodicdimens tt let see detail differ case tt variabl periodicdimens tt default give finit system calcul sinc dirichlet zero boundari condit use border simul box tt variabl periodicdimens tt mean x axi period direct system confin valu must use simul instanc singl infinit wire tt variabl periodicdimens tt mean x axi period zero boundari condit impos border cross z axi valu must use simul instanc singl infinit slab tt variabl periodicdimens tt mean simul box primit cell fulli period infinit crystal period boundari condit impos border import understand perform instanc variabl periodicdimens tt tt calcul octopu quit perform variabl periodicdimens tt tt calcul larg supercel infinitesupercel limit two approach reach ground state hold excit state system anoth point worth note hartre potenti calcul period system fact discret fourier transform use intern period calcul would alway result period lattic ident replica simul box even one two dimens period fortun octopu includ clever system exactli truncat longrang part coulomb interact way effect suppress interact replica system along nonperiod axe cutoff done automat sinc valu variabl poissonsolv period calcul chosen accord variabl periodicdimens see also variabl document variabl poissonsolv atom posit import point deal semiperiod system coordin atom along aperiod direct must center around case isol system slab mean atom slab must center around z case calcul lead wrong result sodium chain let us calcul band simpl singl na chain ie crystal infinit parallel chain singl infinit chain confin two dimens groundstat first start groundstat calcul use follow input file text variabl calculationmod gs variabl unitsoutput ev_angstrom variabl experimentalfeatur ye variabl periodicdimens variabl space angstrom variabl lsize angstrom angstrom angstrom variabl coordin na variabl kpointsgrid variabl kpointsusesymmetri ye input variabl alreadi introduc period systemsperiod system tutori note kpoint along first dimens period dimens output quit familiar follow piec output confirm code inde use cutoff calcul hartre potenti mention introduct text hartre chosen poisson solver fast fourier transform input poissonfftkernel cylindr input fftlibrari fftw info fft grid dimens x x total grid size mib ineffici fft grid better grid would info poisson cutoff radiu cutoff use cylindr cutoff compar fft grid dimens size simul box see poisson solver use supercel doubl size z direct point might want play around number kpoint sure calcul converg band structur modifi input file follow way figur srcimagesna_chain_bands_d_dpng widthpx captionband structur infinit chain sodium atom calcul singl chain purpl line dperiod crystal chain supercel green line text variabl calculationmod unocc variabl unitsoutput ev_angstrom variabl experimentalfeatur ye variabl periodicdimens variabl space angstrom variabl lsize angstrom angstrom angstrom variabl coordin na variabl extrast variabl extrastatestoconverg variabl kpointspath variabl kpointsusesymmetri run code might notic comment lcao output what go cant full initi lcao done plot band structur use data file staticbandstructur file like period systemsperiod system tutori introduct mention perform calcul tt variabl periodicdimens tt quit perform tt variabl periodicdimens tt calcul larg supercel let check rerun groundstat unoccupi calcul set tt variabl periodicdimens tt input file make sure copi file staticbandstructur file differ place overwritten better yet run new calcul differ folder see plot two band structur right comment ref cutoff hbn monolay hexagon boron nitrid hbn insul wide studi similar structur graphen describ get band structur hbn monolay groundstat calcul start calcul groundstat use follow input file text variabl calculationmod gs variabl unitsoutput ev_angstrom variabl experimentalfeatur ye variabl periodicdimens variabl space angstrom bnlength angstrom sqrtbnlength l variabl latticeparamet l variabl latticevector sqrt variabl reducedcoordin b n variabl pseudopotentialset hgh_lda variabl lcaostart lcao_stat variabl kpointsgrid variabl kpointsusesymmetri ye file selfexplanatori detail explan choic tt variabl periodicdimens tt layer hbn period xy direct z direct two period dimens tt variabl latticeparamet tt set bond length å box size z direct l l larg enough describ monolay vacuum rememb one alway check converg quantiti interest box length valu run code notic cutoff use calcul hartre potenti differ sodium chain expect text hartre chosen poisson solver fast fourier transform input poissonfftkernel planar input fftlibrari fftw info fft grid dimens x x total grid size mib ineffici fft grid better grid would info poisson cutoff radiu band structur groundstat calcul calcul band structur input nonself consist calcul text variabl calculationmod gs variabl unitsoutput ev_angstrom variabl experimentalfeatur ye variabl periodicdimens variabl space angstrom bnlength angstrom sqrtbnlength l variabl latticeparamet l variabl latticevector sqrt variabl reducedcoordin b n variabl pseudopotentialset hgh_lda variabl lcaostart lcao_stat variabl extrastatestoconverg variabl extrast variabl kpointspath number k point sampl path reduc coordin gamma k point reduc coordin k k point reduc coordin k point reduc coordin gamma k point variabl kpointsusesymmetri figur srcimagestutorial_band_structure_hbnpng widthpx captionband structur monolay hbn case chose follow path calcul band structur gammak km mgamma sampl kpoint right result plot occupi band first four unoccupi band file staticbandstructur file cutoff articl titleexact coulomb cutoff techniqu supercel calcul authorsc rozzi varsano marini e k u gross rubio journalphi rev b volum page year doiphysrevb tutorialfoot titl dftu tag tutori advanc ground state bulk pseudopotenti dftu tutori period system difficulti advanc theori dftu system_typ bulk species_typ pseudopotenti descript object tutori give basic idea dftu octopu work seri tutori weight object tutori give basic idea dftu octopu work input prototyp exampl dftu consid bulk nio antiferromagnet configur neglect small lattic distort consid cubic cell codeblock variabl calculationmod gs variabl periodicdimens variabl boxshap parallelepip variabl experimentalfeatur ye variabl pseudopotentialset hscv_pbe variabl latticeparamet variabl latticevector variabl speci ni species_pseudo hubbard_l hubbard_u ev variabl dftulevel dft_u_empir variabl reducedcoordin ni ni variabl space variabl kpointsgrid variabl pardomain variabl parkpoint auto variabl spincompon polar variabl guessmagnetdens user_defin variabl atomsmagnetdirect variabl outputlda_u occ_matric codeblock interest antiferromagnet order primit cell doubl along last lattic vector help converg initi guess ad ad input file variabl variabl guessmagnetdens variabl atomsmagnetdirect order perform calcul u ev orbit correspond quantum number l defin block speci hubbard_l specifi orbit l orbit l p orbit hubbard_u use set valu effect hubbard u order activ dftu part one final need specifi level dftu use done use variabl variabl dftulevel moment three possibl option variabl correspond u correct dft_u_non empir correct dft_u_empir ab initio u correct base acbn functionalfootnot dft_u_acbn specif output ad densiti matrix select local subspac output refer footnot articl titlereformul mathrmdftu pseudohybrid hubbard densiti function acceler materi discoveri authorsagapito lui curtarolo stefano buongiorno nardelli marco journalphi rev x volum page year doiphysrevx tutorialfoot titl magnon tag tutori advanc bulk magnon real time tutori period system difficulti advanc theori dft calculation_mod timedepend system_typ bulk species_typ pseudopotenti featur magnon real time seri tutori descript tutori give basic idea possibl comput magnon transvers spin suscept realtim calcul use octopu weight object tutori give basic idea possibl comput magnon transvers spin suscept realtim calcul use octopu notic warn tutori requir abl run calcul nonneglig numer cost run local notic notic note tutori still construct notic magnon kick supercel first approach investig obtain transvers spin suscept use supercel adapt host spin spiral specif momentum groundstat input file prototyp exampl investig spinwav consid bulk iron ferromagnet materi start comput groundstat construct supercel correspond cubic cell iron doubl along one direct use follow input file codeblock variabl calculationmod gs variabl periodicdimens variabl boxshap parallelepip variabl experimentalfeatur ye variabl pseudopotentialset pseudodojo_lda angstrom variabl latticeparamet variabl reducedcoordin fe fe fe fe variabl space variabl kpointsgrid variabl smear ev variabl smearingfunct fermi_dirac variabl lcaostart lcao_stat variabl spincompon spinor variabl guessmagnetdens user_defin variabl atomsmagnetdirect variabl eigensolv rmmdii variabl convrelden e variabl extrast codeblock run input file give ground state bulk iron supercel import note use pauli spinor repres wavefunct need later kick system spiral spin space repres collinear spin note present input file converg number kpoint consid product run similarli smear occup set high temperatur ev also realist practic applic done number kpoint low exampl properli sampl energi window close fermi energi timedepend run construct supercel investig spin spiral momemtum q correspond cell valu q pia lattic paramet iron took angstrom exampl let us look specifi magnon kick octopu three differ point need specifi strength kick determin strongli perturb system momentum kick momentum spin spiral impos system spin easi axi materi usual z direct code allow defin arbitrari direct direct use determin transvers magnet total magnet comput cartesian coordin first need set use magnon kick codeblock variabl tddeltastrengthmod kick_magnon codeblock specifi strength perturb codeblock variabl tddeltastrength codeblock strength perturb converg result guaranti valid within linear respons mean chang strength kick lead transvers spin suscept origin calcul extract suscept see next section depend kick strength within linear respons momentum spin spiral set use block codeblock variabl tdmomentumtransf pia codeblock final easi axi materi defin codeblock variabl tdeasyaxi codeblock full input file read codeblock variabl calculationmod gs variabl periodicdimens variabl boxshap parallelepip variabl experimentalfeatur ye variabl pseudopotentialset pseudodojo_lda angstrom variabl latticeparamet variabl reducedcoordin fe fe fe fe variabl space variabl kpointsgrid variabl restartfixedoccup ye variabl spincompon spinor variabl extrast variabl restartwriteinterv variabl tddeltastrength variabl tddeltastrengthmod kick_magnon variabl tdmomentumtransf pia variabl tdeasyaxi variabl tdtimestep variabl tdpropag aetr variabl tdexponentialmethod lanczo variabl tdexpord variabl tdpropagationtim variabl tdoutput total_magnet energi codeblock paramet timedepend run alreadi explain tutori detail timepropag perform atom unit frequenc resolut time propag probabl larg applic use valu maintain tutori feasibl within reason amount time look total energi tdgeneralenergi system one realiz start increas correct due poor converg paramet use calcul practic calcul strongli advis check energi conserv throughout complet simul comput transvers spin suscept order extract transvers spin suscept total magnet one need use util octspin_suscept util produc file name tdgeneralspin_susceptibility_qxxx xxx index qvector typic one file produc except multiq kick mode see exampl magnon kick use gener bloch theorem hamiltonian includ offdiagon term spin space possibl use socal gener bloch theorem gbt thank gbt possibl investig spin spiral use primit cell system come cost modifi period boundari condit twist boundari condit differ phase appli compon pauli spinor order investig first need prepar groundstat system primit cell modifi input file defin primit cell codeblock variabl calculationmod gs variabl periodicdimens variabl boxshap parallelepip variabl experimentalfeatur ye variabl pseudopotentialset pseudodojo_lda angstrom variabl latticeparamet variabl latticevector variabl reducedcoordin fe variabl space variabl kpointsgrid variabl smear ev variabl smearingfunct fermi_dirac variabl lcaostart lcao_stat variabl spincompon spinor variabl guessmagnetdens user_defin variabl atomsmagnetdirect variabl eigensolv rmmdii variabl convrelden e variabl extrast codeblock ground state converg need run timedepend calcul done use variabl use ad line codeblock variabl spiralboundarycondit ye codeblock variabl set use gbt allow spinwav calcul primit cell tutorialfoot titl period system weight descript tutori seri system period boundari condit tutorialseri period system titl berkeleygw tag tutori bulk gw seri tutori hidden true note tutori page set httpswwwbenasqueorgtddft benasqu tddft school recent version tutorialberkeleygw interact cori berkeleygw tutori done httpswwwnerscgovuserscomputationalsystemscori cori supercomput nersc california key thing need know interact machin log run code ssh trainxxxcorinerscgov termin substitut actual name train account code xxx awar sinc machin far away tri run xwindow program work debug job submit via provid script directori use slurm queue manag cori copi file cori local machin termin local machin write code scp trainxxxcorinerscgovfull_path_to_your_fil fill usernam filenam enter password prompt small ascii file may find cut past conveni see job run code squeue u trainxxx one queue cancel code scancel jobid fill number jobid output code squeue account expir octob cori actual upgrad sinc sept file use avail login code edisonnerscgov go code cscratch document resourc httpswwwtddftorgprogramsoctopusdocgeneratedhtmlvarsphp octopu variabl refer httpswwwberkeleygworgreleasesmanual_vhtml berkeleygw manual httpswwwbenasqueorgtddfttalks_contr_berkeleygw_octopuspptxpdf intro slide first day httpswwwbenasqueorgtddfttalks_contr__felipe_bse_presentationpdf intro slide second day httpsarxivorgab berkeleygw implement paper arxiv extens httpssitesgooglecomsiteberkeleygwabout lectur slide longer tutori devot sole berkeleygw januari instruct first time log execut line help see colorcod link execut directori text echo alia lsl color bashrcext bashrc time log text load modul modul load berkeleygw octopu text go scratch directori run happen cd scratch begin exampl text list exampl avail ls projectprojectdirsmpbenasqu text copi silicon exampl directori cp r projectprojectdirsmpbenasqueboron_nitrid text go local folder follow instruct cd boron_nitrid less readm schedul day boron_nitrid gw day benzen gw httpsenwikipediaorgwikihans_beth bethehttpsenwikipediaorgwikiedwin_ernest_salpet salpet xct_licl exciton visual copi local machin accord blackboard cori unpack archiv follow readm silicon bethesalpet histor interest version tutorialberkeleygw span classnoprinthr back tutori titl benasqu school weight descript basic introduct run octopu hidden true titl berkeleygw tag tutori bulk gw seri tutori hidden true note tutori page set benasqu tddft school specif refer supercomput use time adapt other use tutori recent version tutorialberkeleygw interact hopper berkeleygw tutori done httpswwwnerscgovuserscomputationalsystemshopp hopper supercomput nersc california key thing need know interact machin log run code ssh trainxhoppernerscgov termin substitut actual name train account awar sinc machin far away tri run xwindow program submit job code qsub command eg code qsub jobscr put queue execut free space see job current queue execut code qstat u user see job finish statu code shown q wait queue r run c complet cancel job code qdel job code job job id written code qstat job script eg code calculate_scfqsub specifi paramet pbstorqu queu system mani core use command run etc copi file hopper local machin termin local machin write code scp trainxhoppernerscgovfull_path_to_your_fil fill usernam filenam enter password prompt small ascii file may find cut past conveni get start tutori day obtain file boron nitrid benzen exampl first day tutori text cd scratch projectprojectdirsmbgwtddftcopy_day_sh case enter copi directori look code readm follow instruct given start run code benzenemfscf code benzenemfwfn take littl run bn exampl day obtain file silicon benzen exampl second day tutori text cd scratch projectprojectdirsmbgwtddftcopy_day_sh solut benzen exampl avail text projectprojectdirsmbgwtddftbenzene_run copi necessari file wfn bsemat epsmat eqp instruct work follow directori benzen silicon work boron_nitrid exampl start exampl silicon case enter copi directori look code readm follow instruct given addit exampl xcrysden avail share folder imac see instruct blackboard reason abl copi also download httpscivetberkeleyedujornadafilesxct_liclzip note use xcrysden imac run code swbinxcrysden exampl avail download httpswebmitedudstrubbewwwbenzenetargz benzenetargz httpswebmitedudstrubbewwwsilicontargz silicontargz gener workflow finish basic goal boron nitrid benzen exampl start stretch goal document resourc httpswwwtddftorgprogramsoctopusdocgeneratedhtmlvarsphppagesect octopu variabl refer prereleas develop version httpswwwberkeleygworgreleasesmanual_vhtml berkeleygw manual httpsbenasqueorgtddfttalks_contr_berkeleygw_octopuspptxpdf intro slide first day httpsarxivorgab berkeleygw implement paper arxiv extens httpswwwnerscgovuserstrainingnersctrainingeventsberkeleygw lectur slide longer tutori devot sole berkeleygw novemb httpsbenasqueorgtddfttalks_contr_felipe_bse_presentationpdf slide second day tutori note use prereleas develop version octopu tutori rather current releas lack full support berkeleygw output small differ output span classnoprinthr back tutori titl berkeleygw tag tutori bulk gw seri tutori hidden true note tutori page set httpswwwbenasqueorgtddft benasqu tddft school instructor david strubb adriel gonzález test knowledg httpsfacultyucmercededudstrubbeberkeleygw_gw_bse_quizpdf quiz interact cori berkeleygw tutori done httpswwwnerscgovuserscomputationalsystemscori cori supercomput nersc california key thing need know interact machin log run code ssh trainxxxcorinerscgov termin substitut actual name train account code xxx awar sinc machin far away run xwindow program slow visual xcrysden tool instal run laptop recommend submit job use slurm queue manag use reserv aug benasque_ benasque_ benasque_ reserv usabl day want run outsid time use debug queue tutori design run use interact job node continu avail use execut launch command line run immedi start interact job like submit one text salloc n q regular reservationbenasque_ c haswel use debug queue rather reserv use text salloc n q debug c haswel use reserv need add reservationreserv name flag submiss exampl second day could either put follow line batch script text sbatch reservationbenasque_ add flag command line submit script text sbatch reservationbenasque_ myscriptsl also work interact job text salloc reservationbenasque_ argument exampl script use core use interact job dont use text binbash sbatch j test_pulpo sbatch n sbatch c haswel sbatch p debug sbatch sbatch exportal modul load octopu srun n octopu output copi file cori local machin termin local machin write code scp trainxxxcorinerscgovfull_path_to_your_fil fill usernam filenam enter password prompt small ascii file may find cut past conveni see job run code squeue u trainxxx one queue cancel code scancel jobid fill number jobid output code squeue account expir septemb feel free copi file machin somewher els futur refer document resourc httpswwwtddftorgprogramsoctopusdocgeneratedhtmlvarsphp octopu variabl refer httpsoldsiteberkeleygworgreleasesmanual_vhtml berkeleygw manual version httpswwwbenasqueorgtddfttalks_contr_berkeleygw_octopus_pdf lectur practic calcul gw approxim bethesalpet equat berkeleygw httpsfacultyucmercededudstrubbeberkeleygw_bse_pdf lectur practic bse calcul berkeleygw octopu httpsarxivorgab berkeleygw implement paper arxiv extens httpssitesgooglecomsiteberkeleygwabout lectur slide exampl longer tutori devot sole berkeleygw januari httpsdrivegooglecomfiledmlczrvpzrwsfsnvsbfzsakpkfwvsziuviewuspdrive_web slide develop interfac new dft code instruct first time log execut line help see colorcod link execut directori text echo alia lsl color bashrcext bashrc time log text load modul modul load berkeleygw text go scratch directori run happen cd scratch begin exampl text list exampl avail ls projectprojectdirsmpbenasqu text copi boron_nitrid exampl directori cp r projectprojectdirsmpbenasqueboron_nitrid text go local folder follow instruct cd boron_nitrid less readm schedul day boron_nitrid gw benzen gw day benzen bethesalpet xct_licl exciton visual download httpsfacultyucmercededudstrubbexctliclzip cori unpack archiv unzip follow readm silicon bethesalpet day option stretch goal benzen planewav berkeleygw exampl cori code projectprojectdirsmpbgw silicon paratec boron nitrid sheet benzen sodium quantum espresso errata code boron_nitridemfepsilon refer code calculate_wfnqsub code calculate_wfnqsub run code get_kgridsh first look input output file output code kgridx code kpointsgrid block valu small qshift quit right divid number kpoint direct valu given octopu input file correct one code boron_nitridebgwepsilon script code run_epsilonqsub rather execut line get omp error code boron_nitridebgwsigma script code run_sigmaqsub rather execut line get omp error histor interest version tutorialberkeleygw version tutorialberkeleygw span classnoprinthr back tutori titl benasqu seri tutori hidden true tutori octopu benasqu tddft school need help check manual manual also check document variabl easiest way run command octhelp show variable_nam command line also search among variabl name run command octhelp search string day ground state hydrogen atomhydrogen atom get start nitrogen atomnitrogen atom basic input variabl methan moleculemethan molecul converg groundstat calcul benzen moleculebenzen molecul make plot day excit state timedepend runtimedepend run optic spectra timepropagationopt spectra td obtain absorpt spectrum explicit solut timedepend kohnsham equat optic spectra casida equationopt spectra casida solv casida equat get optic spectrum option basic qoctbas qoct get start quantum optim control theori titl opendx tag obsolet seri tutori notic warn opendx program longer support follow tutori consid obsolet recommend use one altern mention tutori basicsvisu visual notic input point input quit familiar codeblock variabl calculationmod gs variabl unitsoutput ev_angstrom variabl radiu angstrom variabl space angstrom variabl output wf densiti elf potenti variabl outputformat cube xcrysden dx axis_x plane_z variabl xyzcoordin benzenexyz codeblock coordin case given file file benzenexyz file file look like codeblock geometri benzen angstrom c c c c c c h h h h h h codeblock note ask octopu output wavefunct code wf densiti electron local function code elf kohnsham potenti ask octopu gener output sever format requir differ visual tool mention want save disk space keep option correspond program use take look document variabl variabl output variabl outputformat full list possibl quantiti output format visual opendx opendxhttpswwwopendxorg power although quit complex program visual data complet generalpurpos use visual languag process data plot dont worri probabl need learn languag provid program file mfnet file mfcfg get file shareutil directori octopu instal probabl locat file usrshareoctopusutil start pleas make sure instal togeth chemistri extens may find instruct releasesopendxher note opendx far trivial instal use howev outcom realli spectacular will suffer littl begin sure effort compens run octopu input file afterward find file static directori sever file extens file dx file contain wavefunct densiti etc format understood httpswwwopendxorg open dx need chemistri extens packag instal top dx find releas page let us start first copi file file mfnet file mfcfg open directori open dx command line text dx follow instruct given releasesopendxher see window similar one shown right galleri text imagetutorial_dx_pngscreenshot open dx main menu imagetutorial_dx_pngmain dialog mfnet imagetutorial_dx_pngisosurfac dialog imagetutorial_dx_pnggeometri dialog galleri select ttrun visual programstt select file mfnet file click ttoktt open main dialog applic longer need main dx window perhap better minim get way continu go menu ttexecut execut changett instruct open dx recalcul plot whenev make chang paramet figur srcimagestutorial_dx_png widthpx captionpx let us choos file plot see field ttfilett main dialog ttnulltt click three dot next field file selector open select file file staticdensitydx press ok instruct open dx draw isosurfac click ttisosurfacestt new dialog box open close dialog box pleas click ttisosurfacestt main dialog end may lot window lie around tri organ click ttshow isosurfac tt imag appear densiti benzen zoom rotat etc pictur follow menu ttoption view controltt menu imag panel play also around isosurfac dialog ttisosurfac valuett order make pictur appeal chang color opac etc even plot two isosurfac differ valu hope disappoint pictur plot densiti usual quit bore even hohenbergkohn theorem prove know everyth tri plot quantiti like electron local function wavefunct etc choos appropri file main dialog tri later stick bore densiti let us add structur close isosurfac dialog click ttisosurfacestt main dialog box open ttgeometrytt dialog ttfilett select file file benzenexyz click ttshow geometrytt geometri appear beneath isosurfac make bond appear disappear use slide ttbond lengthtt chang color etc dialog finish let us put color pictur close ttgeometrytt dialog know open isosurfac dialog choos ttmap isosurfacett ttfilett field choos file file staticvhdx go pictur isosurfac benzen color accord valu electrostat potenti cool everyth went right end pictur like one right exercis tri plot wavefunct etc make slab etc play around usual thing work perfectli titl open boundari tag obsolet seri tutori notic warn warn open boundari implement remov version octopu longer avail notic tutori briefli sketch perform calcul open transpar boundari octopu emph import pleas note featur describ follow still subject chang develop certainli stabl reliabl requir product run therefor much appreci feedback bug report even fix geometri open boundari calcul possibl parallelepip variabl boxshap plane perpendicular xaxi transpar e transport direct along xaxi boundari rigid wall like usual finitesystem calcul system open left right side specifi charact outsid world done give unit cell two semiinfinit lead attach central devic region yield follow geometri figur srcimagesopen_boundaries_geometrypng widthpx captionopen boundari geometri red area devic region also constitut simul box e part space treat explicitli simul attach semiinfinit period lead shown green blue line indic left right open boundari overview method approach openboundari calcul octopu gener consist threestep procedur period groundstat calcul lead unit cell provid eigenst lead scatter free eigenst devic region obtain groundstat wave function system broken translat symmetri done solv lippmannschwing equat central region note impli symmetr lead posit propag ground state step time system may perturb timedepend electr magnet field central region ndash tddft finit system ndash addit differ left right timedepend spatial constant potenti lead timedepend bia propag perform modifi cranknicolson propag explicitli includ inject densiti lead hop central region addit sourc memori term detail see kurthtransport obtain ground state calcul ground state geometri requir two run octopu groundstat calcul infinit chain unit cell lead groundstat calcul full system e scatter center place use multidataset capabl octopu connect two first exampl calcul scatter state attract squar potenti figur srcimagesopen_boundaries_square_wellpng widthpx captiond squar well potenti begin calcul lead case flat zero potenti henc know result plane wave write follow input file name period dataset code lead_ order refer subsequ calcul text calculationmod lead_ gs fromscratch ye theorylevel independent_particl boxshap parallelepip dimens space speci flat user_defin lead lead_periodicdimens lead_coordin flat lead_lsiz space lead_kpoint lead_output potenti lead_outputhow binari write potenti binari format need next run scatter outcom period run squar well follow addit input file job text calculationmod lead_ well_ gs gs v w speci flat user_defin well user_defin vstepxwstepxw extend system scatter center add_ucel well_openboundari lead_dataset lead_ lead_restart_dir lead_restart lead_static_dir lead_stat add_unit_cel add_ucel well_coordin well well_lsiz point deserv comment block variabl openboundari enabl entir openboundari machineri block specifi dataset provid period result note code lead_ run period virtu ttlead_periodicdimensionstt furthermor algorithm calcul ground state extend system need know find lead potenti line start code lead_static_dir groundstat wave function lead line start code lead_restart_dir line code add_unit_cel bit special usual desir includ first unit cell lead simul box avoid put hand octopu attach mani unit cell request line simul box dataset open boundari code well_ case keep mind line may significantli increas grid size process input file octopu give us follow eigenst psix plot figur srcimagesopen_boundaries_square_well_eigenstatepng widthpx captionextend eigenst squar well turn attent timepropag briefli describ consol output octopu relat open boundari ttgridtt section appear two entri first one state open boundari inde enabl show number unit cell includ simul box alert reader note say tttt tttt input file reason least one addit unit cell requir propag algorithm eventu feed groundstat wave function second one print mani grid point interfac region basic determin size lead unit cell text grid open boundari xdirect addit unit cell left addit unit cell right left lead read directori lead_restart right lead read directori lead_restart number point left interfac number point right interfac follow section also relat open boundari text lead green function st spin lead energi l r green function lead requir includ effect lead lippmannschwing equat simul region inform found httpswwwphysikfuberlindelorenzenphysicstransport_nq_yrmpdf poster present th nanoquanta young research meet time propag give two small exampl time propag notic note todo add exampl td potenti central region lead give exampl calcul ivcurv soon current calcul fix notic propag eigenst first timedepend simul simpli propag eigenst obtain previou section time without extern influenc expect psix chang psix pick phase shown movi center flashfileopen_boundaries_square_well_eigenstate_propagationswfwidthheightqualitybestflash center order obtain input data movi add third dataset input file start tttdtt calcul text calculationmod gs gs td lead_ well_ well_ note dataset share label ground state run enabl octopu find correct initi state avoid need repeat ttopenboundariestt block apart tttdtt dataset give usual td paramet timestep number step propag text tdmaximumit tdtimestep complet mention octopu output relat open boundari td propag text open boundari type memori coeffici full mbyte requir memori term maximum bicg iter bicg residu toler e includ addit term memori sourc td lead potenti lr block give detail paramet propag algorithm sourc memori term includ simul chang variabl openboundariesadditionalterm variabl memori coeffici store full matric variabl openboundariesmemtyp requir mb main memori timedepend potenti lead maximum number iter solv cranknicolson system linear equat variabl openboundariesbicgmaxiit toler iter solver variabl openboundariesbicgtol calcul memori coeffici accompani oputput text info calcul miss coeffici memori term left lead eta take long inde one bottleneck algorithm propag gaussian wavepacket second exampl propag gaussianshap charg distribut initi complet local central region calcul standard test implement open boundari therefor worth repeat charg outsid central region disabl sourc term repsons inject densiti simul region furthermor initi state time propag given entri variabl userdefinedst block result ground state calcul nevertheless two groundstat calcul complet flat strip perform initi certain datastructur part input describ flat strip look like text calculationmod gs gs lead_ flat_ fromscratch ye theorylevel independent_particl dimens boxshap parallelepip space speci flat user_defin lead lead_periodicdimens lead_coordin flat lead_lsiz space lead_kpoint lead_output potenti lead_outputhow binari central region flat_openboundari lead_dataset lead_ lead_restart_dir lead_restart lead_static_dir lead_stat add_unit_cel flat_coordin flat flat_lsiz propag overrid initi state give explicit formula gaussian wavepacket initi momentum text kx ky alpha flat_onlyuserdefinedinitialst ye flat_userdefinedst formula expikxx kyyexpalpharr add td dataset text calculationmod gs gs td lead_ flat_ flat_ disabl sourc term line text flat_openboundariesadditionalterm mem_term default variabl openboundariesadditonalterm ttmem_term src_termtt sole give ttmem_termtt disabl sourc term feed input octopu gener movi psix give center flashfileopen_boundaries_wavepacket_propagationswfwidthheightqualitybestflash center sinc wavepacket initi momentum x well ydirect open boundari right rigid wall back easili recogn refer refer kurthtransport articl titletimedepend quantum transport practic scheme use densiti function theori authorss kurth g stefanucci co almbladh rubio e k u gross journalphi rev b volum page year urlhttpsjournalsapsorgprbabstractphysrevb doiphysrevb linkap titl obsolet materi weight descript basic introduct run octopu hidden true titl helium tag beginn ground state unoccupi model userdefin speci independ particl visual weight tutori model system difficulti beginn theori independ particl calculation_mod ground state unoccupi system_typ model species_typ userdefin speci featur visual descript helium atom one dimens also two electron seri tutori next exampl helium atom one dimens also two electron use harmon oscil main differ instead describ two electron one dimens describ one electron two dimens calcul case dft one exact solut schrödinger equat exact solut helium atom howev sinc onedimension model equival two electron one electron show treat two electron one dimens one electron two dimens let start call x coordin two electron hamiltonian would note usual coulomb interact particl usual substitut model soft coulomb potenti uxx hath fracfracpartialparti x fracfracpartialparti fracsqrtxfracsqrtyfracsqrtxi instead describ two electron one dimens howev may well think one electron two dimens subject extern potenti precis shape given fracsqrtxfracsqrtyfracsqrtxi sinc hamiltonian ident get result whether regard x coordin two differ particl one dimens coordin particl along two axe two dimens entir us idea actual gener treat two particl via simul octopu sinc usual easier treat one particl solv onedimension helium atom two dimens also therefor get twodimension wavefunct order plot wavefunct specifi output plane instead axi input differ potenti one dimens new input file look like follow codeblock include_input doctutorialsmodel_systemsd_heliumgsinp codeblock inform write potenti formula express see manual basicsinput file input file name speci helium instead alreadi name pseudopotenti actual helium atom run calcul converg within iter usual result summar file staticinfo file find codeblock theori level input theorylevel independent_particl scf converg iter state fulli converg eigenvalu h st spin eigenvalu occup energi h total free ionion eigenvalu hartre intnv_xc exchang correl vanderwa delta xc entropi ts kinet extern nonloc dipol b deby x e e e e converg abs_den e e rel_den e e abs_ev e e h codeblock run noninteract electron hartre exchang correl compon energi zero also ionion term zero one ion unoccupi state thing tutori modeld_harmonic_oscil harmon oscil chang unoccupi calcul mode codeblock include_input doctutorialsmodel_systemsd_heliumunoccinp codeblock ad extra state also restrict wavefunct plot codeinlin variabl outputwfsnumb codeinlin result calcul found file file staticeigenvalu case look like codeblock state fulli converg criterion e eigenvalu h st spin eigenvalu occup error e e e e e e codeblock apart eigenvalu occup number ask octopu output wavefunct plot use gnuplot start type bash include_fil doctutorialsmodel_systemsd_heliumunoccplotgp plot groundstat st nd excitedst wavefunct get ignor codeinlin warn contour non grid data pleas use set dgridd codeinlin correspond singlet triplet state include_ep doctutorialsmodel_systemsd_heliumunoccwfsstep captiongroundst include_ep doctutorialsmodel_systemsd_heliumunoccwfsstep captionst excitedst include_ep doctutorialsmodel_systemsd_heliumunoccwfsstep captionnd excitedst exercis calcul helium atom assum electron helium interact use variabl dimens justifi differ see result chang chang interact often one model coulomb interact sqrtar fit paramet reproduc requir properti tutorialfoot titl model system weight descript model system octopu unusu featur dft code abl handl model system ie one userdefin arbitrari potenti oppos system real atom use simplifi test calcul comput effect mass envelop function approxim eg quantum dot quantum well seri link tutori show run system set userdefin arbitrari potenti showcas unusu featur octopu tutori assum alreadi familiar use octopu case start first tutori basic octopu basic tutori tutorialseri model system titl particl box tag beginn ground state model userdefin speci independ particl weight tutori model system difficulti beginn theori independ particl calculation_mod ground state system_typ model species_typ userdefin speci descript classic quantum problem particl box seri tutori previou tutori consid appli userdefin potenti want classic quantum problem particl box ie infinit squar well vx begincas fracl x fracl cr infti textotherwis endcas meaning way set infinit valu potenti numer calcul howev instead use boundari condit set problem locat potenti infinit wavefunct must zero therefor equival solv electron potenti space solv electron domain x tfracl tfracl zero boundari condit edg follow input file accomplish set radiu tfracl default box shape sphere mean line input usual need write input file describ system want calcul codeblock include_input doctutorialsmodel_systemsparticle_in_a_boxinp codeblock run input file look groundstat energi eigenvalu singl state exercis calcul unoccupi state check obey expect relat vari box size check energi correct depend plot wavefunct compar expect set calcul finit squar well compar result infinit one function potenti step hint along usual arithmet oper may also use logic oper creat piecewisedefin express see manual input file input file tri infinit squar well tutorialfoot titl kronigpenney model tag beginn ground state model chain band structur userdefin speci independ particl section homeluedersdownloadstutori kronigpenney_model tutori model system theori independ particl calculation_mod ground state system_typ chain species_typ userdefin speci featur band structur difficulti beginn descript calcul bandstructur kronigpenney model kronigpenney model system demonstr band gap relat allow energi electron materi tutori calcul bandstructur kronigpenney model kronigpenney model period potenti vx begincas v_ b x cr x endcas b width barrier space input follow input file use ground state calcul codeblock include_input doctutorialsmodel_systemskronig_penney_modelgsinp codeblock figur srcimageskp_wavefunctionspng widthpx captionth first two wavefunct plot alongsid potenti bandstructur calcul bandstructur simpli chang variabl calculationmod unocc codeblock include_input doctutorialsmodel_systemskronig_penney_modelunoccinp codeblock include_ep doctutorialsmodel_systemskronig_penney_modelunoccbandstructureep captionth band structur kronigpenney model plot bandstructur use command tutori periodic_system period system assum use gnuplot codeblock plot col staticbandstructur u columncol w l notitl ls codeblock refer sidebottom dl fundament condens matter crystallin physic introduct student physic materi scienc new york cambridg univers press tutorialfoot titl harmon oscil tag beginn ground state unoccupi model userdefin speci independ particl weight tutori model system difficulti beginn theori independ particl calculation_mod ground state unoccupi species_typ userdefin speci descript standard textbook harmon oscil one dimens two noninteract electron seri tutori first exampl use standard textbook harmon oscil one dimens fill two noninteract electron input first thing tell octopu want write follow line save file file inp codeblock include_input doctutorialsmodel_systemsd_harmonic_oscillatormaininp codeblock input variabl alreadi familiar detail explan valu codeinlin variabl dimens codeinlin mean code run dimension system option default actual run compil configur flag ttmaxdimtt codeinlin variabl theorylevel independent_particl codeinlin tell octopu treat electron noninteract codeinlin variabl radiu codeinlin radiu sphere ie line therefor domain extend bohr codeinlin variabl speci codeinlin speci name ho potenti formula given final number valenc electron see manual input file input file descript kind express given potenti formula codeinlin variabl coordin codeinlin add extern potenti defin speci ho posit coordin use potenti formula rel point output one execut file run octopu thing worthi closer look standard output first one find list speci codeblock speci speci ho userdefin potenti potenti x number orbit codeblock potenti vx x hermitepolynomi orbit avail lcao number base valenc theori level request codeblock theori level input variabl theorylevel independent_particl codeblock electron treat noninteract mean hartre exchangecorrel term includ usual appropri model system particular standard xc approxim use actual electron correct effect electron differ mass codeblock input variabl mixfield none mix scf cycl codeblock sinc use independ particl one electron need use mix scheme acceler scf converg codeblock input variabl lcaostart lcao_non info unnorm total charg info renorm total charg info set hamiltonian orthogon wavefunct codeblock start scratch mean octopu gener start densiti sum atom densiti renorm integr total number electron present system atom system default find first estim wavefunct use manual calculationsground_statelcao linear combin atom orbit lcao techniqu use atom wavefunct pseudopotenti howev necessarili correspond wavefunct userdefin potenti lcao turn default start orbit random orthogon selfconsist cycl start see follow output codeblock info start scf iter eta scf cycl iter etot e abs_ev e rel_ev e ediff e abs_den e rel_den e matrix vector product converg eigenvector state eigenvalu h occup error e elaps time scf step eta codeblock iter converg codeblock scf cycl iter etot e abs_ev e rel_ev e ediff e abs_den e rel_den e matrix vector product converg eigenvector state eigenvalu h occup error e elaps time scf step info write state info finish write state info scf converg iter codeblock note electron noninteract actual selfconsist need nevertheless octopu take sever scf iter converg take one scf iter eigensolv converg wavefunct eigenvalu improv tri better initi guess wavefunct turn lcao set tt variabl lcaostart lcao_statestt compar mani iter matrixvector product total requir hint hermit polynomi exercis first thing look file staticinfo file look eigenvalu total energi compar expect analyt solut problem also play littl bit input file add featur exampl eigenst system obtain calcul unoccupi state done chang ttcalculationmodett codeblock variabl calculationmod unocc codeblock input file mode octopu give occupi state contribut densiti also unoccupi one set number state extra line codeblock variabl extrast codeblock calcul empti state thing note octopu need densiti calcul actual noninteract electron densiti need anyth sinc octopu design interact electron tri read densiti anyway alreadi perform static calcul ttcalculationmod gstt use result compar groundstat calcul also chang converg criterion unoccupi state contribut densiti might actual converg properli use densiti converg check therefor octopu check whether calcul state converg separ look biggest error wavefunct calcul get anoth file file static directori call file eigenvalu file info file contain inform groundstat eigenvalu occup number file eigenvalu file also want plot say wavefunct end calcul tell octopu give us wavefunct includ codeblock variabl output wf variabl outputformat axis_x codeblock first line tell octopu give wavefunct second line say along xaxi also select wavefunct would like output exampl first second fourth sixth dont specifi anyth octopu give codeblock variabl outputwfsnumb codeblock octopu store wavefunct folder file static file info file meaning name store pair xcoordin valu wavefunct posit x one easili plot gnuplot similar program also possibl extract coupl thing octopu like densiti kohnsham potenti tutorialfoot titl particl octopu tag beginn ground state model userdefin speci independ particl visual weight tutori model system difficulti beginn theori independ particl calculation_mod ground state species_typ userdefin speci featur visual descript system shape simul box defin imag file seri tutori octopu actual run system shape simul box defin white imag file exampl particl octopu constant potenti octopusshap quantum dot run need built code option librari gdlibhttpslibgdgithubio input exampl need two file file inp codeblock include_input doctutorialsmodel_systemsparticle_in_a_octopusinp codeblock file gdlibpng make file avail run directori download click imag bellow also avail file prefixshareoctopu directori octopu instal figur srcimagesgdlibpng plot wavefunct obtain use codeblock variabl output wf variabl outputformat plane_z codeblock view code gnuplot bash plot staticwfstz u linetyp palett bash splot staticwfstz u pmd wavefunct local exercis see total energi scale size system control code ff paramet input file compar formula particl box look wavefunct unoccupi state think seriou applic would use abil defin simul box imag tutorialfoot titl use symmetri optic spectra timepropag tag advanc timedepend molecul pseudopotenti dft optic absorpt octpropagation_spectrum tutori optic respons difficulti advanc theori dft calculation_mod timedepend system_typ molecul species_typ pseudopotenti featur optic absorpt util octpropagation_spectrum weight seri tutori descript reduc number timepropag requir comput absorpt crosssect tutori see spatial symmetri molecul use reduc number timepropag requir comput absorpt crosssect introduct dynam polariz relat optic absorpt crosssect via sigma frac pi omegac mathrmim alpha gener form x tensor reason shine light system polar three cartesian axe three case measur dipol molecul oscil along three cartesian axe usual mean obtain full dynam polariz molecul usual need appli differ perturb along x z set variabl tdpolarizationdirect howev molecul symmetri gener possibl reduc total number calcul requir obtain tensor even footnot use formal octopu need suppli extra inform import thing code requir inform equival axe direct relat symmetri transform use axe construct refer frame specifi variabl tdpolar block note axe need orthogon must linearlyindepend variabl tdpolarizationequivax tell code mani equival axe ideal refer frame chosen maxim number equival axe use three equival axe extra input variabl variabl tdpolarizationwprim also requir let us give coupl exampl make concept easier understand methan seen previou tutori methan molecul t_d symmetri mean trivial find three linearlyindepend equival axe one timepropag need obtain whole tensor happen use usual x z direct equival check symmetri operationshttpsenwikipediaorgwikisymmetry_oper t_d point grouphttpsenwikipediaorgwikimolecular_symmetri convinc therefor perform one propag perturb along x direct ad follow input file use previous codeblock include_input_snippet doctutorialsoptical_responseuse_of_symmetries_in_optical_spectra_from_timepropagationtdinp polar codeblock expand complet input file codeblock include_input doctutorialsoptical_responseuse_of_symmetries_in_optical_spectra_from_timepropagationtdinp codeblock expand note omit block variabl tdpolar variabl tdpolarizationwprim previou tutori default timepropag finish find usual file tdgeneralmultipol file time file contain necessari inform octopu comput full tensor run file octpropagation_spectrum util produc two file file cross_section_vector file cross_section_tensor later look like assum use converg grid paramet converg optic spectraconverg optic spectra tutori codeblock nspin kick mode kick strength pol pol pol direct equiv axe wprime kick time energi trsigma anisotropysigma sigma sigma sigma ev e e e e e e e e e e e e e e e e e e codeblock tri compar spectrum compon sigma tensor linear molecul let us look linear molecul case might think need two calcul obtain whole tensor one direct along axi molecul anoth axi perpendicular molecul fact need one special chosen direct field compon along axi molecul perpendicular let us assum axi molecul orient along x axi use codeblock variabl tdpolar sqrt sqrt sqrt sqrt sqrt sqrt variabl tdpolarizationdirect variabl tdpolarizationequivax variabl tdpolarizationwprim sqrt sqrt codeblock tri convinc three axe inde equival linearli independ first second axe connect simpl reflect xz plane transform coordin sqrt sqrt variabl tdpolarizationwprim set result obtain appli invers symmetri oper third axi actual leav third axi unchang planar molecul final let us look gener planar molecul xy plane principl need two calcul reduc one symmetri present like eg benzen case chose one polar axe plane two rotat degre codeblock variabl tdpolar sqrt sqrt sqrt sqrt variabl tdpolarizationequivax codeblock case need two run one variabl tdpolarizationdirect equal anoth equal note less equival axe variabl tdpolarizationwprim irrelev footnot articl titleon use neumann principl calcul polariz tensor nanostructur authorsmjt oliveira castro mal marqu rubio journalj nanosci nanotechnolog volum page year doijnn arxivv tutorialfoot titl converg optic spectra weight tag beginn timedepend molecul pseudopotenti dft optic absorpt octpropagation_spectrum tutori optic respons theori dft calculation_mod timedepend system_typ molecul species_typ pseudopotenti featur optic absorpt util octpropagation_spectrum difficulti beginn descript converg studi spectrum respect grid paramet previou tutori responseopt spectra timepropag optic spectra td seen obtain absorpt spectrum molecul perform converg studi spectrum respect grid paramet use methan molecul exampl converg space tutori basicstot energi converg total energi converg tutori found total energi methan molecul converg within ev space å radiu å therefor use valu start point converg studi like total energi way check absorpt spectrum converg respect space repeat seri calcul ident input file except grid space main differ case calcul given space requir sever step groundstat calcul three timedepend propag perturb along x z calcul spectrum use file octpropagation_spectrum util seen t_d symmetri methan mean spectrum ident direct case need perform converg studi perturb along x direct calcul done hand would rather use script bore repetit task need follow two file inp file one use previou tutori responseopt spectra timepropag optic spectra td codeblock include_input doctutorialsoptical_responseconvergence_of_the_optical_spectraspacinginp codeblock spacingsh bash script bash include_fil doctutorialsoptical_responseconvergence_of_the_optical_spectraspacingspacingsh script perform three step mention given list space notic includ smaller space å know previou experi optic spectrum well converg space larger one requir converg total energi run script type commandlin sourc spacingsh take time might want break script finish run need compar spectra differ space use favorit plot softwar eg commandlin gnuplot plot second column file cross_section_vector file vs first column see right plot look like make plot easier read restrict energi rang omit space plot clear space å suffici posit peak converg within ev include_ep doctutorialsoptical_responseconvergence_of_the_optical_spectraspacingabsorption_spectrum_ch_spacingep captionconverg space methan absorpt spectrum converg radiu studi spectrum chang radiu proceed space perform seri calcul ident input file except radiu use two follow file inp file prevou one except space timestep seen space å suffici turn allow us use larger timestep codeblock include_input doctutorialsoptical_responseconvergence_of_the_optical_spectraradiusinp codeblock radiussh bash script bash include_fil doctutorialsoptical_responseconvergence_of_the_optical_spectraradiusradiussh script work like previou one chang radiu instead space run script command sourc radiussh wait finish plot spectra file cross_section_vector file get someth similar plot right see case chang quit dramat get first peak close ev converg within ev radiu å necessari converg transit energi ev agre quit well experiment valu ev tddft valu ev obtain authorsfootnot include_ep doctutorialsoptical_responseconvergence_of_the_optical_spectraradiusabsorption_spectrum_ch_radiusep captionconverg space methan absorpt spectrum peak higher energi sinc run box zero boundari condit also box state spectrum energi state chang invers size box correspond peak keep shift lower energi howev one usual interest boundbound transit optic nearultraviolet regim stop converg studi exercis might want converg next experiment observ transit keep mind calcul larger box might take quit time run footnot articl titletimedepend densiti function theori calcul photoabsorpt spectra vacuum ultraviolet region authorsn n matsuzawa ishitani dixon uda journalj phi chem volum page year doijpv tutorialfoot titl optic spectra timepropag weight tag beginn timedepend molecul pseudopotenti dft optic absorpt octpropagation_spectrum difficulti beginn theori dft calculation_mod timedepend system_typ molecul species_typ pseudopotenti featur optic absorpt util octpropagation_spectrum tutori optic respons seri tutori descript absorpt spectrum molecul explicit solut timedepend kohnsham equat methan tutori learn obtain absorpt spectrum molecul explicit solut timedepend kohnsham equat choos test case methan chsubsub ground state start timedepend simul need obtain ground state system use basic file inp file tutori basicstot energi converg total energi converg tutori codeblock include_input doctutorialsoptical_responseoptical_spectra_from_timepropagationgsinp codeblock run octopu kohnsham wavefunct groundstat directori file restartg go propag wavefunct well converg import converg energi rel easi converg densiti default codeinlin variabl convrelden e codeinlin usual enough though timedepend run calcul absorpt excit system infinitesim electricfield puls propag timedepend kohnsham equat certain time spectrum evalu timedepend dipol moment input input file look time propag similar one tutori basicstimedepend propag timedepend propag tutori codeblock include_input doctutorialsoptical_responseoptical_spectra_from_timepropagationtd_xinp codeblock besid chang variabl calculationmod code td ad codeinlin variabl fromscratch ye codeinlin use decid run propag polar direct see bellow timeevolut use approxim enforc timerevers symmetri aetr propag timestep chosen propag remain numer stabl learn set tutori tutori baicstimedepend propag timedepend propag tutori final set number time step variabl variabl tdmaxstep maximum propag time hbarrm ev need around iter also introduc two new input variabl defin perturb variabl tddeltastrength strength perturb number small keep respons linear suffici larg avoid numer problem variabl tdpolarizationdirect variabl set polar perturb first axi x note calcul singlet dipol spectrum also obtain triplet use variabl tddeltastrengthmod multipol respons use variabl tdkickfunct detail triplet calcul see tutori responsetriplet excit triplet excit tutori start octopu go quick coffe take minut depend machin propag slow good news scale well size system mean even methan slow molecul atom still calcul without big problem output output similar one tutori basicstimedepend propag timedepend propag tutori main differ inform perturb codeblock info appli delta kick k info kick function dipol info delta kick mode densiti mode codeblock also get file tdgeneralmultipol file contain necessari inform calcul spectrum begin file look like codeblock header nspin lmax kick mode kick strength pol pol pol direct equiv axe wprime kick time iter electron charg x z iter n hbarev electron e e e e e e e e e e e e e e e e e e e e codeblock note dipol along x direct forth column chang respons perturb optic spectra order obtain spectrum gener system one would need perform three timedepend run perturb along differ cartesian direct x z practic would need set direct perturb along x codeinlin variabl tdpolarizationdirect codeinlin run timepropag renam file tdgeneralmultipol file file tdgeneralmultipol repeat step direct codeinlin variabl tdpolarizationdirect codeinlin z codeinlin variabl tdpolarizationdirect codeinlin obtain file file tdgeneralmultipol file tdgeneralmultipol nevertheless t_d symmetri methan mean respons ident direct absorpt spectrum xpolar fact equival spectrum averag three direct perform calcul z direct need convinc inde equival necessari complet tutori note octopu actual use knowledg symmetri system calcul spectrum howev fairli complic understand purpos introductori tutori cover tutori responseus symmetri optic spectra timepropag use symmetri optic spectra timepropag tutori file octpropagation_spectrum util octopu provid util call manual external_utilitiesoctpropagation_spectrum octpropagation_spectrum process file multipol file obtain spectrum input util requir littl inform input file need provid header file multipol file want reus input file timepropag run follow input file also work codeblock variabl unitsoutput ev_angstrom codeblock run util dont worri warn gener know output get codeblock spectrum option input propagationspectrumtyp absorptionspectrum input spectrummethod fourier input propagationspectrumdampmod polynomi input propagationspectrumtransform sine input propagationspectrumstarttim hbarev input propagationspectrumendtim e hbarev input propagationspectrumenergystep e ev input propagationspectrummaxenergi ev input propagationspectrumdampfactor hbarev input propagationspectrumsigmadiagon file multipol found file process one file use file call multipol multipol etc warn file multipol tell system usabl symmetri howev use file calcul full tensor file xxxx_vector gener instead octopu emit warn codeblock notic file file cross_section_vector creat requir inform either symmetr molecul one multipol file less symmetr molecul multipl multipol file file octpropagation_spectrum gener whole polariz tensor file cross_section_tensor enough multipol file avail gener respons particular polar chose timedepend run file cross_section_vector crosssect vector let us look first file cross_section_vector codeblock nspin kick mode kick strength pol pol pol direct equiv axe wprime kick time codeblock begin file repeat inform concern run codeblock number time step propagationspectrumdampmod propagationspectrumdampfactor propagationspectrumstarttim propagationspectrumendtim propagationspectrummaxenergi propagationspectrumenergystep codeblock come summari variabl use calcul spectra note chang set ad variabl input file run file octpropagation_spectrum special import perhap variabl propagationspectrummaxenergi set maximum energi calcul variabl propagationspectrumenergystep determin mani point spectrum contain smoother curv reduc last variabl codeblock electron sum rule static polariz sum rule codeblock come inform sum rule first fsum rule yield number activ electron calcul valenc electron carbon hydrogen sum rule give number much smaller reason sum spectrum ev see variabl propagationspectrummaxenergi sum rule fulfil go infin cours infin bit larg increas ev somewhat larger number improv dramat fsum rule second number static polariz also calcul sum rule forget converg number variabl propagationspectrummaxenergi codeblock energi sigma nspin sigma nspin sigma nspin strengthfunct ev ev e e e e e e e e e e e e e e e codeblock final come spectrum first column energi frequenc next three column row crosssect tensor last one strength function run dynam polariz relat optic absorpt crosssect via sigma left omega right frac pi omegac mathrmim alpha left omega right atom unit gener pi omega tildealpha mathrmim alpha left omega right tildealpha finestructur constant fracomega eepsilon_ c mathrmim alpha left omega right crosssect relat strength function left omega right fracmc pi hbar sigma left omega right crosssect tensor three direct done would four file file cross_section_vector file cross_section_vector file cross_section_vector file cross_section_tensor latter would similar codeblock nspin kick mode kick strength pol pol pol direct equiv axe wprime kick time energi trsigma anisotropysigma sigma sigma sigma ev e e e e e e e e e e e e e e e e e e codeblock include_ep doctutorialsoptical_responseoptical_spectra_from_timepropagationpropagation_spectra_tensorabsorption_spectrum_chep captionabsorpt spectrum methan column energi averag absorpt coeffici tr sigma anisotropi compon tensor third number spin compon sinc unpolar anisotropi defin delta sigma frac rm trsigma rm trsigma reason definit ident equal delta sigma sigma_sigma_ sigma_sigma_ sigma_sigma_ sigma_ sigma_ sigma_ eigenvalu sigma isotrop tensor character three equal eigenvalu lead zero anisotropi differ eigenvalu larger anisotropi plot absorpt spectrum column vs file cross_section_vector use file cross_section_tensor exercis case propag three direct obtain plot shown right cours tri converg spectrum respect calcul paramet particular increas total propag time reduc width peak fact width peak method absolut artifici invers proport total propag time forget howev area peak physic mean oscil strength transit converg studi respect space box size might necessari cover next tutori question think equat peak width term propag time observ width compar expect highest energi excit obtain calcul paramet key one control maximum energi spectrum go zero physic calcul paramet might chang tutorialfoot titl optic spectra casida tag beginn unoccupi casida molecul pseudopotenti dft optic absorpt octcasida_spectrum tutori optic respons theori dft calculation_mod timedepend difficulti beginn system_typ molecul species_typ pseudopotenti featur optic absorpt util octcasida_spectrum weight seri tutori descript calcul absorpt spectrum methan use casida equat tutori calcul absorpt spectrum methan time use casida equat groundstat first step calcul ground state use follow input file codeblock include_input doctutorialsoptical_responseoptical_spectra_from_casidagsinp codeblock note use valu space radiu found tutori responseconverg optic spectra convergence_of_the_optical_spectra tutori converg absorpt spectrum unoccupi state casida equat pseudoeigenvalu equat written basi particlehol state mean need occupi state comput groundstat calcul well unoccupi state obtain via nonselfconsist calcul use densiti comput code gs input file use codeblock include_input doctutorialsoptical_responseoptical_spectra_from_casidaunoccinp codeblock chang variabl calculationmod code unocc ad extra state set variabl extrast input variabl run octopu obtain first unoccupi state forget run groundstat calcul first solut unoccupi state control variabl section variabl eigensolv take look eigenvalu unoccupi state file file staticeigenvalu codeblock state converg criterion e eigenvalu ev st spin eigenvalu occup error e e e e e e e e e e e e e e codeblock casida calcul modifi variabl calculationmod code casida rerun octopu note default octopu use occupi unoccupi state avail sometim use use state exampl molecul atom occupi state rang ev interest look excit visibl tri use state within ev fermi energi could select state use variabl casidakohnshamst variabl casidaksenergywindow new directori appear name file casida find file file casidacasida codeblock e ev x z f e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e e codeblock x z transit dipol moment x phi_xphi_i qquad phi_yphi_i qquad z phi_zphi_i phi_ ground state phi_i given excit oscil strength given f_i frac m_e hbar omega_i sum_nin xyz phi_nphi_i averag three direct optic absorpt spectrum given strength function somega sum_i f_i deltaomegaomega_i note excit degener degeneraci could alreadi expect t_d symmetri methan note within degener subspac arbitrari possibl depend detail compil machin linear combin transit therefor concern result compon transit dipol moment analysi excit howev energi result spectra agre inform concern excit found directori file casidacasida_excit exampl first excit ev analyz file file casidacasida_excit codeblock energi ev e x e e z e e e codeblock file contain basic eigenvector casida equat first two column respect index occupi index unoccupi state third spin index alway spinunpolar fourth coeffici state casida eigenvector eigenvector normal one case one say supsup excit state state one homo orbitalslumo small contribut transit absorpt spectrum include_ep doctutorialsoptical_responseoptical_spectra_from_casidaspectrumabsorption_spectrum_ch_casidaep captionabsorpt spectrum methan calcul timepropag casida equat visual spectrum need broaden delta function util file octcasida_spectrum run work directori file casida convolv delta function lorentzian function oper file octcasida_spectrum control variabl variabl casidaspectrumbroaden width lorentzian variabl casidaspectrumenergystep variabl casidaspectrumminenergi variabl casidaspectrummaxenergi run file octcasida_spectrum obtain file file casidaspectrumcasida contain column file casida broaden interest total absorpt spectrum plot first fifth column obtain pictur like one right compar spectrum obtain timepropag tutori responseconverg optic spectra converg optic spectra tutori one obtain casida approach use grid paramet see peak timepropag broader solv either increas total propag time increas broaden casida approach first two peak nearli probabl also third ok low resolut timepropag allow distinguish two close peak compos high energi spectra differ lot reason use empti state casida approach order describ better region spectrum would need one alway check converg relev peak respect number empti state probabl notic casida calcul took much less time timepropag clearli true small mediums system howev implement casida octopu much wors scale size system timepropag larger system situat may differ note also casida one need fair amount unoccupi state fairli difficult obtain interest may also compar casida result kohnsham eigenvalu differ file casidaspectrumeps_diff petersilka approxim casida file casidaspectrumpetersilka tutorialfoot titl optic respons weight descript calcul optic respons seri link tutori show use tddft calcul optic absorpt molecul use differ method implement octopu tutori assum alreadi familiar use octopu case start first octopu basic tutori tutorialseri optic respons titl triplet excit tag advanc timedepend casida molecul pseudopotenti dft triplet excit octpropagation_spectrum octcasida_spectrum weight tutori optic respons theori dft calculation_mod timedepend casida system_typ molecul species_typ pseudopotenti featur triplet excit util octpropagation_spectrum octcasida_spectrum difficulti advanc seri tutori descript calcul triplet excit methan timepropag casida method tutori calcul triplet excit methan timepropag casida method timepropag groundstat begin spinpolar calcul groundstat codeinlin variabl spincompon spin_polar codeinlin specifi codeblock include_input doctutorialsoptical_responsetriplet_excitationstime_propagationgs_polinp codeblock verifi result ident detail nonspinpolar calcul sinc nonmagnet system timepropag next perform timepropag use follow input file codeblock include_input doctutorialsoptical_responsetriplet_excitationstime_propagationtdinp codeblock besid variabl spincompon variabl main differ type perturb appli system set codeinlin variabl tddeltastrengthmod kick_spin codeinlin kick opposit sign state wherea ordinari kick code kick_dens yield respons homogen electr field ie electr dipol respons kick yield respons homogen magnet field ie magnet dipol respons note howev spin degre freedom coupl field differ calcul would requir obtain orbit part respons singlet excit state contribut spectrum code kick_dens triplet excit state contribut code kick_spin see use symmetri obtain code kick_spin_and_dens spectrum propag complet run manual external_utilitiesoctpropagation_spectrum octpropagation_spectrum util obtain spectrum file cross_section_vector look like codeblock nspin kick mode kick strength pol pol pol direct equiv axe wprime kick time number time step propagationspectrumdampmod propagationspectrumdampfactor propagationspectrumstarttim propagationspectrumendtim propagationspectrummaxenergi propagationspectrumenergystep energi sigma nspin sigma nspin sigma nspin sigma nspin sigma nspin sigma nspin strengthfunct strengthfunct ev ev ev e e e e e e e e e e e e e e e e e e e e e e e e e e e codeblock include_ep doctutorialsoptical_responsetriplet_excitationstime_propagationspectrumsinglet_triplet_spectrum_chep captioncomparison absorpt spectrum methan calcul timepropag singlet triplet see separ column crosssect strength function spin physic meaning strength function magnet excit given code strengthfunct code strengthfunct sinc kick opposit two spin obtain file cross_section_tensor trace second column would appropri crosssect consid plot compar singlet result obtain see look right first triplet transit found ev slightli lower energi lowest singlet transit interest also repeat calcul codeinlin variabl tddeltastrengthmod kick_dens codeinlin default confirm result nonspinpolar calcul use symmetri nonmagnet system said methan nonmagnet system densiti magnet densiti zero everywher rhouparrowmathbf r rhodownarrowmathbf r note enough total magnet moment system zero previou condit hold antiferromagnet system symmetri spindens actual exploit order obtain singlet triplet spectra singl calcul done use special perturb appli spin statesfootnot use perturb need set codeinlin variabl tddeltastrengthmod kick_spin_and_dens codeinlin repeat timepropag kick obtain differ file cross_section_vector file contain singlet triplet spectra singlet given code strengthfunct code strengthfunct triplet given code strengthfunct code strengthfunct casida equat calcul triplet code casida mode spinpolar system current implement octopu nevertheless like timepropag take advantag nonmagnet system two spin equival case allow us calcul triplet without need spinpolar run effect kernel case f_rm hxcrm singlet left rho right fuparrow_rm hxc left rho uparrow right fuparrow_rm hxc left rhodownarrow right f_rm h left rho right fuparrow_rm xc left rho uparrow right fuparrow_rm xc left rhodownarrow right f_rm hxcrm triplet left rho right fuparrow_rm hxc left rho uparrow right fuparrow_rm hxc left rhodownarrow right fuparrow_rm xc left rho uparrow right fuparrow_rm xc left rhodownarrow right therefor start groundstat unoccupi state run exactli done tutori responseopt spectra casida optic spectra casida tutori casida run follow input file include_ep doctutorialsoptical_responsetriplet_excitationscasidaspectrumsinglet_triplet_spectrum_casida_chep captioncomparison absorpt spectrum methan calcul casida equat singlet triplet codeblock include_input doctutorialsoptical_responsetriplet_excitationscasidaextra_states_convergenceinp codeblock differ respect calcul singlet variabl casidacalctriplet input variabl casida calcul finish run file octcasida_spectrum plot result compar singlet calcul right see plot look like singlet triplet energi level compar explain gener relat runtim compar singlet triplet comparison singlet spectrum compar timepropag casida result main differ reason include_ep doctutorialsoptical_responsetriplet_excitationscomparisontriplet_casida_td_chep captioncomparison triplet absorpt spectrum methan calcul timepropag casida equat footnot articl titleon use neumann principl calcul polariz tensor nanostructur authorsmjt oliveira castro mal marqu rubio journalj nanosci nanotechnolog volum page year doijnn arxivv tutorialfoot titl optic spectra sternheim tag beginn molecul pseudopotenti dft optic absorpt electromagnet respons sternheim tutori optic respons theori dft calculation_mod electromagnet respons difficulti beginn system_typ molecul species_typ pseudopotenti featur optic absorpt sternheim weight seri tutori descript calcul optic spectra frequenc domain linear respons seen calcul optic spectra time domain finit perturb frequencydomain linearrespons matrix formul casida equat tri third approach frequenc domain linear respons rather use pseudoeigenvalu equat casida use selfconsist linear equat sternheim equat approach also known densityfunct perturb theori superior scale effici dens spectra applic nonlinear respons one disadvantag one need proceed one frequenc point time rather get whole spectrum find obtain equival result approach optic spectra time propag casida calcul polariz take imaginari part ground state linear respons need obtain ground state system use input file optic spectra casidaopt spectra casida use tighter numer toler help sternheim equat solv rapidli unlik casida unoccupi state requir present wont use anyway codeblock include_input doctutorialsoptical_responseoptical_spectra_from_sternheimergsinp codeblock codeblock variabl calculationmod gs variabl unitsoutput ev_angstrom variabl radiu angstrom variabl space angstrom ch angstrom variabl coordin c h chsqrt chsqrt chsqrt h chsqrt chsqrt chsqrt h chsqrt chsqrt chsqrt h chsqrt chsqrt chsqrt variabl convrelden e codeblock linear respons add line input file replac variabl calculationmod line frequenc interest must specifi choos base seen casida spectrum block specifi frequenc span rang ev reson frequenc span rang ev peak didnt know look look coars frequenc grid sampl point region seem peak includ look sign reson real part polariz would reason approach must add small imaginari part eta frequenc order abl obtain imaginari part respons avoid diverg reson reson broaden lorentzian width larger eta easier scf converg lower resolut spectrum help numer solut turn precondition sometim caus troubl use linear solver experiment give converg much faster default one codeblock include_input doctutorialsoptical_responseoptical_spectra_from_sternheimerem_respinp codeblock spectrum perl script extract need info file file em_resp directori text include_fil doctutorialsoptical_responseoptical_spectra_from_sternheimerem_respextractpl result text energi ev alpha im alpha crosssect see also tutori sternheim linear respons sternheim linear respons tutorialfoot titl gaussianshap extern current densiti tutori maxwel weight gaussianshap extern current densiti pass gaussian tempor current puls absorb boundari expand click complet input codeblock include_input doctutorialsmaxwellexternalcurrentgaussian_current_pulseinp codeblock expand instead incom extern plane wave octopu simul also extern current densiti place insid simul box exampl place one shape current densiti simul box codeblock include_input_snippet doctutorialsmaxwellexternalcurrentgaussian_current_pulseinp boundari codeblock sinc start absorb boundari reset box size codeblock include_input_snippet doctutorialsmaxwellexternalcurrentgaussian_current_pulseinp box codeblock extern current densiti switch correspond option two block defin spatial distribut tempor behavior spatial distribut exampl extern current gaussian distribut tempor puls one gaussian along yaxi one along opposit direct time shift codeblock include_input_snippet doctutorialsmaxwellexternalcurrentgaussian_current_pulseinp current codeblock expand gnuplot script set pmd set view map set palett defin blue white red set term png size unset surfac unset key set output plotpng set xlabel xdirect set ylabel ydirect set cbrang set multiplot set origin set size set size squar set titl electr field e_z au sp maxwelloutput_itertde_fieldzz u set origin set size set size squar set titl electr field e_z au sp maxwelloutput_itertde_fieldzz u unset multiplot expand contour plot electr field zdirect time step time step figur srcimagesmaxwelltutorial_plotpng width mask absorb boundari expand click complet input codeblock include_input doctutorialsmaxwellexternalcurrentgaussian_current_pulse_with_maskinp codeblock expand add mask absorb boundari codeblock include_input_snippet doctutorialsmaxwellexternalcurrentgaussian_current_pulse_with_maskinp boundari codeblock accordingli addit absorb width updat simul box dimens codeblock include_input_snippet doctutorialsmaxwellexternalcurrentgaussian_current_pulse_with_maskinp box codeblock contour plot electr field zdirect time step time step figur srcimagesmaxwelltutorial_plotpng width pml boundari expand click complet input codeblock include_input doctutorialsmaxwellexternalcurrentgaussian_current_pulse_with_pmlinp codeblock expand repeat simul use pml absorb boundari codeblock include_input_snippet doctutorialsmaxwellexternalcurrentgaussian_current_pulse_with_pmlinp boundari codeblock contour plot electr field zdirect time step time step figur srcimagesmaxwelltutorial_plotpng width maxwel field origin maxwel energi insid free maxwel propag region simul box figur srcimagesmaxwelltutorial__maxwell_energy_and_fieldspng width contour plot electr field zdirect time step time step figur srcimagesmaxwelltutorial__run_electric_field_contourpng widthpx tutorialfoot titl maxwel input file tutori maxwel weight maxwel input file input file variabl descript calcul mode parallel strategi begin input file basic option variabl variabl calculationmod select run mode octopu alway set case parallel run variabl set proper parallel option maxwel propag parallel domain possibl parallel state need alway state depend hamiltonian see codeblock include_input_snippet doctutorialsmaxwellmaxwellinputoptionsinp calc_mod codeblock multisystem setup maxwel system implement octopu multisystem framework allow calcul sever differ system interact current implement system type electron electron system partli implement maxwel maxwel system classical_particl classic particl use test purpos charged_particl charg classic particl multisystem system contain system dftbplu dftb system linear_medium linear medium classic electrodynam definit system tutori use pure maxwel system codeblock include_input_snippet doctutorialsmaxwellmaxwellinputoptionsinp system codeblock subsequ variabl relat name system prefix system name howev prefix mandatori calcul consid one system maxwel box variabl paramet maxwel box defin parallelepip box expand exampl codeblock include_input_snippet doctutorialsmaxwellmaxwellinputoptionsinp box codeblock expand maxwel option maxwel option determin maxwel propag scheme first maxwel propag oper option consist type variabl maxwellhamiltonianoper set vacuum maxwellhamiltonian faraday_amper maxwellhamiltonian linear medium faraday_ampere_medium current maxwel system defin propag use system default propag defin variabl tdsystempropag far exponenti midpoint implement maxwel boundari condit chosen direct differ variabl maxwellboundarycondit possibl choic zero absorb boundari condit well plane wave constant field boundari condit addit boundari condit code includ absorb boundari mean outgo wave absorb incom signal still aris boundari propag simul box absorb boundari achiev mask function perfectli match layer pml calcul addit paramet inform physic mean paramet pleas refer maxwelltddft paper maxwelltddft paper httpsdoiorg codeblock include_input_snippet doctutorialsmaxwellmaxwellinputoptionsinp maxwell_calc codeblock output option output option variabl outputformat use exactli case tddft calcul except format inconsist maxwel calcul like xyz possibl chose multipl format maxwel output option defin variabl maxwelloutput block written output_it everi variabl maxwelloutputinterv step variabl maxwelltdoutput written tdgener everi step codeblock include_input_snippet doctutorialsmaxwellmaxwellinputoptionsinp output codeblock time step variabl variabl tdtimestep option gener defin time step use system stabil time propag recommend maxwel system alway fulfil courant condit case larger time step possibl check case case codeblock include_input_snippet doctutorialsmaxwellmaxwellinputoptionsinp timestep codeblock maxwel field variabl incid plane wave defin boundari use variabl maxwellincidentwav block block defin incom wave type complex electr field amplitud maxwel envelop function name must defin separ block multipl plane wave defin superposit give final incid wave result boundari plane wave boundari evalu timestep give boundari condit propag insid box use variabl maxwellboundarycondit must set plane_wav necessari direct variabl maxwellfunct block read addit requir inform plane wave puls envelop function name given variabl maxwellincidentwav block insid simul box initi electromagnet field set variabl userdefinedinitialmaxwellst block puls paramet complet outsid box initi time variabl need set default initi field insid box zero case codeinlin variabl maxwellplanewavesinbox ye codeinlin code use initi analyt plane wave valu also insid simul box henc maxwel field propag valu set analyt codeblock include_input_snippet doctutorialsmaxwellmaxwellinputoptionsinp field codeblock extern current extern current switch add extern current contribut intern current extern current calcul analyt variabl userdefinedmaxwellexternalcurr block block defin spatial profil frequenc extern current contribut set envelop function name must defin separ variabl tdfunction block codeblock include_input_snippet doctutorialsmaxwellmaxwellinputoptionsinp ext_curr codeblock linear medium differ shape linear media includ calcul either simpl box file describ complex geometri inform check linear medium tutori tutorialfoot titl maxwel overview tutori maxwel weight tutori maxwel propag coupl tddft octopu author rene jestädt franco bonafé heiko appel max planck institut structur dynam matter theori depart tutori base follow public lightmatt interact within ehrenfestmaxwellpaulikohnsham framework fundament implement nanoopt applicationslight_matter_interactions_within_the_ehrenfest_maxwell_pauli_kohn_sham_framework_fundamentals_implementation_and_nano_optical_applicationspdf rené jestädt michael ruggenthal micael j oliveira angel rubio heiko appel httpsdoiorg slide heiko appel talkhttpstheorympsdmpgdetalksheikoappelunijena use riemannsilberstein represent maxwel equat correspond timeevolut maxwel field implement quantum mechan like propag tddft code octopu program run free maxwel propag mode electromagnet field calcul insid simul box box includ variou shape linear media initi electromagnet field set box well extern current densiti incom plane wave box boundari simul box boundari select zero boundari perfectli electr conductor pec mirror perfectli magnet conductor pmc absorb boundari differ method combin featur free maxwel propag normal tddft matter propag octopu code solv fulli coupl maxwellkohnsham system propag system two separ grid case kohnsham system give rise intern current densiti influenc maxwel field propag turn electromagnet field part kohnsham hamiltonian coupl system propag selfconsist code also use forward backward coupl follow introduc differ input option free maxwel propag fulli coupl maxwellkohnsham propag differ exampl show variou featur input file download heremaxwelltddft_tutorial_filestar simul box relev input file variabl tutori maxwellsimulationbox simul box tutori maxwellmaxwellinputfil input file variabl exampl electromagnet field propag without coupl tddft tutori maxwellrun cosinoid plane wave vacuum tutori maxwellrun interfer two cosinoid plane wave tutori maxwellrun cosinoid plane wave hit linear medium box without absorb boundari tutori maxwellrun gaussianshap spatial extern current distribut densiti pass gaussian tempor current puls coupl maxwelltddft propag tutori maxwellbenzen benzen ground state dynam coupl extern em puls check input syntax maxwel propag branch merg current version octopu obtain compil code click tutori multisystem multisystem tutorialfoot titl coupl maxwelltddft propag tutori maxwel weight draft ye coupl maxwelltddft propag notic warn need remov maxwellmatt coupl yet work notic ground state benzen simul coupl maxwellkohnsham system obtain first initi kohnsham system case groundstat benzen calcul node parallel calculationmod gs pardomain auto parstat matter box variabl lsize_ma dx_ma dimens boxshap parallelepip lsize lsize_ma lsize_ma lsize_ma space dx_ma dx_ma dx_ma speci variabl xyzcoordin geometry_z_dirbohrxyz hatter calcul variabl extrast xcfunction lda_x lda_c_gl eigensolv cg eigensolvertoler e eigensolvermaxit coanelden e maximumit convforc smearingfunct fermi_dirac smear mixingschem broyden mix lcaostart lcao_stat coupl dynam benzen cosinoid em puls folder _maxwell_ks_propagation_ed_coupling_no_backreaction_maxwell_ks_propagation_ed_coupling_no_backreact cosinoid laser puls hit molecul groundstat usind electr dipol approxim without matter maxwel backreact calcul mode parallel calculationmod maxwell_k pardomain auto parstat maxwellpardomain auto maxwellparst matter box variabl lsize_ma dx_ma dimens boxshap parallelepip lsize lsize_ma lsize_ma lsize_ma space dx_ma dx_ma dx_ma maxwel box variabl free maxwel box limit plu absorb pml boundari plu incid wave boundari der_ord time dx_mx lsize_mx dx_mx maxwelldimens maxwellboxshap parallelepip maxwellls lsize_mx lsize_mx lsize_mx maxwellspac dx_mx dx_mx dx_mx speci variabl xyzcoordin geometry_z_dirbohrxyz matter calcul variabl extrast xcfunction lda_x lda_c_gl eigensolv cg eigensolvertoler e eigensolvermaxit coanelden e maximumit derivativesstencil stencil_starplu derivativesord tdexpord absorbingboundari not_absorb maxwel calcul variabl maxwellhamiltonianoper faraday_amper maxwelltdoperatormethod maxwell_op_fd maxwelltdpropag maxwell_etr mattertomaxwellcoupl maxwelltomattercoupl ye maxwellcouplingord electric_dipole_coupl maxwelltransfieldcalculationmethod trans_field_poisson maxwellpoissonsolv isf maxwellpoissonsolverboundari multipol maxwellderivativesstencil stencil_starplu maxwellderivativesord maxwelltdexpord maxwellboundarycondit maxwell_plane_wav maxwell_plane_wav maxwell_plane_wav maxwellabsorbingboundari cpml cpml cpml maxwellabpmlwidth maxwellabpmlkappamax maxwellabpmlalphamax maxwellabpmlpow maxwellabpmlreflectionerror e output variabl outputformat plane_x plane_i plane_z vtk xyz axis_x matter output variabl output potenti densiti current geometri forc elf outputinterv tdoutput energi multipol laser geometri maxwel output variabl maxwelloutput maxwel electr field maxwel magnet field maxwell_energy_dens maxwell_trans_lectric_field _ha written one line maxwelloutputinterv maxwelltdoutput maxwell_energi maxwell_field maxwellfieldscoordin time step variabl tdtimestep tdmaxstep tdenergyupdateit maxwelltdintervalstep tdmaxwelltdrelaxationstep tdmaxwellksrelaxationstep maxwelltdetrsapprox currentpropagationtest maxwel field variabl lambda omega pi c lambda kx omega c e pw ps userdefinedmaxwellincidentwav plane_waves_mx_funct e plane_waves_funct plane_wav maxwellfunct plane_waves_funct mxf_cosinoidal_wav kx ps pw cosinoid puls userdefinedinitialmaxwellst formula electric_field ezcoskxxpscospixpspwpw steppwabskxxkxpskx one line formula magnetic_field cezcoskxxpscospixpspwpw steppwabskxxkxpskx one line explor effect back reaction field consid fulli coupl maxwellmatt interact effect higher order coupl term magnet dipol electr quadrupol run input file folder file _maxwell_ks_propagation_ed_coupling_fully_coupl file _maxwell_ks_propagation_ed_md_eq_coupling_no_backreact file _maxwell_ks_propagation_ed_md_eq_coupling_no_backreact tutorialfoot titl maxwel system weight descript maxwel system sinc version octopu also use calcul maxwel system ie propag electromagnet field futur version coupl matter system go beyond usual forwardonli coupl field electron tutorialseri maxwel titl interfer two cosinoid plane wave tutori maxwel weight interfer two cosinoid plane wave instead one plane wave simul two differ plane wave differ wavevector enter simul box interf leav box addit wave last tutori add second wave differ wave length enter box angl shift bohr along correspond direct propag expand click complet input codeblock include_input doctutorialsmaxwellfreepropagation_pulses_tdinp codeblock expand electr field polar zdirect magnet field ydirect start last input file add second wave accord follow excerpt codeblock include_input_snippet doctutorialsmaxwellfreepropagation_pulses_tdinp field codeblock contour plot electr field zdirect time step time step figur srcimagesmaxwelltutorial__run_electric_field_contourpng width maxwel field origin maxwel energi insid free maxwel propag region simul box figur srcimagesmaxwelltutorial__run_maxwell_energy_and_fieldspng width tutorialfoot titl cosinoid plane wave vacuum tutori maxwel weight cosinoid plane wave vacuum tutori describ propag cosinoid wave vacuum expand click full input file codeblock include_input doctutorialsmaxwellfreepropagation_pulse_tdinp codeblock expand notic warn current run work mpi task notic first defin calcul mode parallel strategi codeblock include_input_snippet doctutorialsmaxwellfreepropagation_pulse_tdinp calc_mod codeblock total size physic simul box x x bohr space bohr direct discuss tutori maxwellsimulationbox section simul box also boundari point account henc total size simul box chosen x x bohr codeblock include_input_snippet doctutorialsmaxwellfreepropagation_pulse_tdinp box codeblock sinc propag without linear medium use vacuum maxwel hamiltonian oper deriv exponenti expans order four codeblock include_input_snippet doctutorialsmaxwellfreepropagation_pulse_tdinp calcul codeblock boundari condit chosen plane wave simul incom wave without absorpt boundari codeblock include_input_snippet doctutorialsmaxwellfreepropagation_pulse_tdinp boundari codeblock simul time step set system propag maximum time step time step write output electr magnet field well energi densiti total maxwel energi codeblock include_input_snippet doctutorialsmaxwellfreepropagation_pulse_tdinp timestep codeblock incid cosinoid plane wave pass simul box cosinoid puls width bohr spatial shift bohr neg xdirect amplitud au wavelength bohr codeblock include_input_snippet doctutorialsmaxwellfreepropagation_pulse_tdinp field codeblock final output option set codeblock include_input_snippet doctutorialsmaxwellfreepropagation_pulse_tdinp output codeblock contour plot electr field zdirect time step time step expand exampl gnuplot script bash set pmd set view map set palett defin blue white red set term png size unset surfac unset key set output plotpng set xlabel xdirect set ylabel ydirect set cbrang set multiplot set origin set size set size squar set titl electr field e_z au sp maxwelloutput_itertde_fieldzz u set origin set size set size squar set titl electr field e_z au sp maxwelloutput_itertde_fieldzz u unset multiplot copi script file call file plotgnu creat plot bash gnuplot plotgnu expand figur srcimagesmaxwelltutorial__run_electric_field_contourpng width maxwel field origin maxwel energi insid free maxwel propag region simul box expand gnuplot script bash set term png size set output plotpng set multiplot set style data l set xlabel time au set origin set size set titl electr magnet field set ylabel maxwel field au p maxwelltdgeneraltotal_e_field_z u e_z maxwelltdgeneraltotal_b_field_i u b_i set origin set size set titl maxwel energi set ylabel maxwel energi au p maxwelltdgeneralmaxwell_energi u maxwel energi unset multiplot expand figur srcimagesmaxwelltutorial__run_maxwell_energy_and_fieldspng width tutorialfoot titl cosinoid plane wave hit linear medium box tutori maxwel weight cosinoid plane wave hit linear medium box arbitrari number linear medium shape place insid maxwel simul box linear media consid separ system type exampl codeblock include_input_snippet doctutorialsmaxwelllinearmediumcosinoidal_pulse_tdinp system codeblock box shape defin two way given variabl variabl linearmediumboxshap set medium_parallelepip parallelepip box defin center size dimens variabl linearmediumboxs block box shape defin medium_box_fil box shape read extern file defin variabl variabl linearmediumboxfil produc file check tutori maxwelldetailscreating_geometri creat geometri tutori either case electromagnet properti medium must defin variabl linearmediumproperti block specifi rel electr permitt rel magnet permeabl electr magnet conduct lossi media final spatial profil assum calcul gradient box edg defin variabl linearmediumedgeprofil variabl either edg smooth linear media shape read file edg codeblock include_input_snippet doctutorialsmaxwelllinearmediumcosinoidal_pulse_tdinp medium_box codeblock note also need chang variabl describ propag codeblock include_input_snippet doctutorialsmaxwelllinearmediumcosinoidal_pulse_tdinp timestep codeblock notic note linear media static therefor propag codeinlinevari tdsystempropag static codeinlin permit move variabl variabl tdsystempropag code maxwel namespac default propag code static automat inherit code medium system propag code maxwel system explicitli set code exp_mid code exp_mid propag contain two algorithm step must clock twice fast code static propag henc time step medium bust set half maxwel time step current workaround like chang futur releas code notic absorb boundari expand click complet input codeblock include_input doctutorialsmaxwelllinearmediumcosinoidal_pulse_tdinp codeblock expand illustr laser puls hit linear medium box addit ad linear_medium system need switch maxwel hamiltonian oper x vacuum represent x coupl represent six compon riemannsilberstein vector includ also complex conjug riemannsilberstein vector codeblock include_input_snippet doctutorialsmaxwelllinearmediumcosinoidal_pulse_tdinp calcul codeblock codeblock include_input_snippet doctutorialsmaxwelllinearmediumcosinoidal_pulse_tdinp box codeblock run use previou incid plane wave propag xdirect place medium box insid simul box codeblock include_input_snippet doctutorialsmaxwelllinearmediumcosinoidal_pulse_tdinp field codeblock expand gnuplot script set pmd set view map set palett defin blue white red set term png size unset surfac unset key set output plotpng set xlabel xdirect set ylabel ydirect set cbrang set multiplot set origin set size set size squar set titl electr field e_z au sp maxwelloutput_itertde_fieldzz u set origin set size set size squar set titl electr field e_z au sp maxwelloutput_itertde_fieldzz u unset multiplot set output plotpng set multiplot set origin set size set size squar set titl electr field e_z au sp maxwelloutput_itertde_fieldzz u set origin set size set size squar set titl electr field e_z au sp maxwelloutput_itertde_fieldzz u unset multiplot expand contour plot electr field zdirect time step time step figur srcimagesmaxwelltutorial_plotpng width contour plot electr field zdirect time step time step figur srcimagesmaxwelltutorial_plotpng width last panel seen signific amount scatter wave larg part scatter box boundari follow use differ boundari condit order reduc spuriou scatter mask absorb boundari expand click complet input codeblock include_input doctutorialsmaxwelllinearmediumcosinoidal_pulse_td_maskinp codeblock expand previou run without absorb boundari switch mask function damp field boundari multipli scalar mask function variabl maxwellabsorbingboundari block updat run mask absorb variabl maxwellabmaskwidth set five codeblock include_input_snippet doctutorialsmaxwelllinearmediumcosinoidal_pulse_td_maskinp boundari codeblock consequ addit region absorb boundari condit chang box size still obtain free maxwel propag box therefor code lsize_mx valu previous use size includ incid wave boundari width plu absorb boundari width detail see inform tutori maxwelldetailssimulationbox simul box codeblock include_input_snippet doctutorialsmaxwelllinearmediumcosinoidal_pulse_td_maskinp box codeblock contour plot electr field zdirect time step time step figur srcimagesmaxwelltutorial_plotpng width contour plot electr field zdirect time step time step figur srcimagesmaxwelltutorial_plotpng width seen scatter slightli reduc still notic perfectli match layer boundari expand click complet input codeblock include_input doctutorialsmaxwelllinearmediumcosinoidal_pulse_td_pmlinp codeblock expand mask absorb method replac accur perfectli match layer pml method therefor variabl maxwellabsorbingboundari code cpml option pml requir addit paramet width full definit codeblock include_input_snippet doctutorialsmaxwelllinearmediumcosinoidal_pulse_td_pmlinp boundari codeblock contour plot electr field zdirect time step time step figur srcimagesmaxwelltutorial_plotpng width contour plot electr field zdirect time step time step figur srcimagesmaxwelltutorial_plotpng width pml boundari condit case compar mask boundari condit lead increas comput cost tutorialfoot titl creat geometri tutori maxwell_detail weight creat geometri linear medium octopu use cgalhttpswwwcgalorg librari allow pars standard geometri file use eg print current support offhttpsenwikipediaorgwikioff_file_format file format mani softwar packag around gener file recommend openscadhttpswwwopenscadorgindexhtml ctmconv part openctmhttpsopenctmsourceforgenet notic info debian style system instal use codeblock aptget instal openscad aptget instal openctmtool codeblock notic openscad provid script languag creat geometri creat gui also render command line document openscad found herehttpswwwopenscadorgdocumentationhtml expand exampl creat simpl len openscad br exampl script len gener intersect two sphere codeblock fs fa intersect translat spherer translat spherer codeblock detail syntax see openscad link httpswwwopenscadorgdocumentationhtml tutori creat follow len figur srcimagesmaxwelllensepng widthpx expand copi code file lensscad gener requir file command bash openscad lensoff lensscad notic warn file gener openscad malform want manipul ctmconv header need fix codeblock codeblock first line need first line data block need contain number vertic plane option connect add comment start empti line allow header codeblock len gener openscad codeblock notic titl simul box tutori maxwell_detail weight simul box maxwel simul box divid mainli two region one inner region request maxwel propag outer region simul proper boundari condit later input file simul box size refer total simul box includ boundari region inner simul box defin total box size minu boundari width case zero boundari condit boundari region figur captionboundari srcimagesmaxwellboundaries_in_dpng widthpx boundari region set absorb boundari incid plane wave combin latter case absorb boundari region inner boundari region plane wave region outer boundari region box size determin total simul box size correspond boundari width figur captionplan wave pml srcimagesmaxwellplane_wave_and_pml_boundaries_in_dpng widthpx notic note given size propag region boundari ad total box size boundari width given deriv order default time space width absorb boundari region defin variabl variabl maxwellabwidth notic matter grid gener locat insid maxwel grid sever possibl type grid describ coupl maxwellmatt system follow figur illustr possibl case overlay maxwel matter grid octopu code current type e f g implement matter box size maxwel box size chosen independ wherea space grid equal grid point lie top except type g matter grid much smaller maxwel grid case matter grid size smaller maxwel grid space figur captionmultiscal srcimagesmaxwellmultiscale_figurespng widthpx dftd repackag version dftd program httpwwwthchunibonndetcindexphpsectiondownloadssubsectiongetd_ grimm cowork origin program v rev download convert free format encapsul modul sourc split two part librari core function directli use third parti applic wish calcul dispers dftd approach addit extens necessari command line tool dftd command line tool updat dftd code includ refittedmodifi zero bjdamp version sherril cowork bjm zerom function correspond v rev compil edit file makearch reflect compil linker issu one follow command make lib build librari libdftda necessari modul file mod directori lib make dftd build execut dftd directori prg make testapi build simpl tester librari testapi directori test sourc code tester demonstr librari use third parti code issu make three target compil credit use librari dftd tool pleas cite grimm j antoni ehrlich h krieg j chem phi bjdamp use grimm ehrlich l goerigk j comput chem cite well licens program free softwar redistribut andor modifi term gnu gener public licens publish free softwar foundat either version option later version chang log ad implement revis damp paramet desrib g smith l burn k patkowski c sherril j phi chem lett pp function correspond v rev origin dftd code fix routin dftd_pbc_dispers deliv correct stress tensor ad interfac api third parti code tester api default set variou compil chang origin sourc file convert free format use metcalf convert tool code pack modul core librari separ dftd tool spglib version badg download badg pypi download build statu python bind c librari find handl crystal symmetri instal packag develop github get sourc releas version repositori httpsgithubcomatztogospglibreleases__ use packag distribut servic easiest way instal pythonspglib use pypi packag numpi requir instal instal command instal spglib pip instal spglib conda anoth choic conda instal c atztogo spglib packag made paweł jochym build use setuppi manual instal pythonspglib use setuppi python header file pythondev ccompil eg gcc clang numpi requir build instal step shown follow go python directori type command python setuppi instal user version badg imag httpsanacondaorgatztogospglibbadgesversionsvg target httpsanacondaorgatztogospglib download badg imag httpsanacondaorgatztogospglibbadgesdownloadssvg target httpsanacondaorgatztogospglib pypi download imag httpsimgshieldsiopypidmspglibsvgmaxag target httpspypipythonorgpypispglib build statu imag httpstravisciorgatztogospglibsvgbranchmast target httpstravisciorgatztogospglib fortran rubi interfac expect fortran rubi interfac work certain level goog python interfac rubi interfac rubi script symposcarrb rubi directori read vasp poscar format file find spacegroup type l option refin slightli distort structur within toler spacifi option option give symmetri oper input structur rubi symposcarrb poscar l option shown help option rubi symposcarrb help way compil rubi modul explain rubyreadm httpsgithubcomatztogospglibblobmasterrubyreadme_ fortran interfac fortran interfac spglib_ff httpsgithubcomatztogospglibblobmasterexampleexample_ff_ found exampl httpsgithubcomatztogospglibtreemasterexample_ directori fortran interfac contribut dimitar pashov spglib_fc httpsgithubcomatztogospglibblobmastersrcspglib_fc_ obsolet recommend use _python_spglib spglib python content depth local instal sourc code download httpsgithubcomatztogospglibreleas minor updat includ packag want latest version gitclon spglib repositori git clone httpsgithubcomatztogospglibgit also possibl instal spglib python via follow packag distribut servic build use setuppi follow pip conda packag made maintain paweł jochym httpsgithubcomjochym_ great help keep spglib handi use use pip numpi requir pythonspglib instal command instal spglib pip instal user spglib see error messag like instal process _spglibc fatal error pythonh file directori develop tool build python modul addit necessari instal use oss packag manag system eg sudo aptget instal pythondev instal pip fail may need upgrad setuptool eg pip instal upgrad user setuptool use conda conda anoth choic conda instal c condaforg spglib build use setuppi manual instal pythonspglib use setuppi python header file pythondev ccompil eg gcc clang numpi requir build instal step shown follow go filepython directori type command python setuppi instal user document spglib instal found link httpsdocspythonorginstallalternateinstallationtheuserschem httpsdocspythonorginstallalternateinstallationtheuserschem instal setuppi fail may need upgrad setuptool eg pip instal upgrad user setuptool test test script filetest_spglibpi found filepythontest directori got directori run script like python test_spglibpi test_find_primit __main__testspglib ok test_get_symmetri __main__testspglib ok test_get_symmetry_dataset __main__testspglib ok test_refine_cel __main__testspglib ok ran test ok import spglib modul chang version version x later import spglib version x pyspglib import spglib version sure tri import spglib spg except importerror pyspglib import spglib spg version number version later version number obtain spglib__version__ refmethod_get_vers exampl exampl found exampl httpsgithubcomatztogospglibtreemasterpythonexamples_ directori _py_vari variabl _py_variables_crystal_structur crystal structur cell crystal structur given tupl tupl format support version later option ase atomslik object also support altern atom class atomspi httpsgithubcomatztogospglibblobmasterpythonexamplesatomspy_ contain minimum set method prepar exampl httpsgithubcomatztogospglibtreemasterpythonexamples_ directori use ase atomslik object get_symmetri collinear polar support tupl format shown follow three four element tupl cell lattic posit number cell lattic posit number magmom magmom repres collinear polar atom option lattic paramet lattic given x matrix float point valu mathmathbfa mathbfb mathbfc given row result transpos definit capi refvariables_lattic fraction atom posit posit given nx matrix float point valu n number atom number distinguish atom speci number given list n integ collinear polar magmom work get_symmetri given list n float point valu lattic a_x a_i a_z b_x b_i b_z c_x c_i c_z posit a_ b_ c_ a_ b_ c_ a_ b_ c_ number n_ n_ n_ magmom m_ m_ m_ work get_symmetri version later crystal structur properli given method use crsytal strcutr return none symmetri toler symprec distanc toler cartesian coordin find crystal symmetri method _method_get_vers get_vers new version version get_vers return version number spglib tupl three number get_error_messag new version method may use see spglib fail though error handl spglib sophist error_messag get_error_messag get_spacegroup spacegroup get_spacegroupcel symprec intern space group short symbol number obtain string symbol_typ schoenfli symbol given instead intern symbol _py_method_get_symmetri get_symmetri symmetri get_symmetrycel symprec symmetri oper obtain dictionari key rotat contain numpi array integ number symmetri oper x x matric key translat contain numpi array float number symmetri oper x vector order rotat matric translat vector correspond eg second symmetri oper organ set second rotat matrix second translat vector respect array therefor set symmetri oper may obtain r r zipdatasetrot datasettransl oper given respect fraction coordin cartesian coordin rotat matrix translat vector use follow new_vectorx rotationx vectorx translationx three valu vector given b c axe respect key equivalent_atom give map tabl atom symmetr independ atom use find symmetr equival atom number contain indic atom start ie first atom number npuniqueequivalent_atom give repres symmetr independ atom list atom symmetr euival independ atom exampl equivalent_atom found npwhereequivalent_atom search fail none return cell given tupl collinear polar given fourth element tupl symmetri oper search consid freedom ase atomsclass object support refine_cel behaviour chang version x lattic scaled_posit number refine_cellcel symprec standard crystal structur obtain tupl lattic x numpi array atom scale posit numpi array number_of_atom atom number numpi array symmetr follow space group type search fail none return detail control standard unit cell achiev use standardize_cel find_primit behaviour chang version x lattic scaled_posit number find_primitivecel symprec primit cell found lattic paramet x numpi array scale posit numpi array number_of_atom atom number numpi array return search fail none return detail control standard unit cell done use standardize_cel standardize_cel new version x lattic scaled_posit number standardize_cellbulk to_primitivefals no_idealizefals symprec to_primitivetru use creat standard primit cell no_idealizetru disabl ideal length angl basi vector posit atom accord crystal symmetri refine_cel find_primit shorthand method combin option search fail none return return detail explan shown spglib capi document _py_method_get_symmetry_dataset get_symmetry_dataset version member choic ad dataset get_symmetry_datasetcel symprec angle_toler hall_numb argument cell symprec see refpy_vari angle_toler experiment argument control angl toler basi vector normal recommend use argument see bit detail refvariables_angle_toler hall_numb see definit number refapi_spg_get_dataset_spacegroup_typ argument constrain spacegrouptyp search hall symbol correspond map hall symbol spacegrouptyp manytoon map without specifi option ie case hall_numb alway first one smallest serial number correspond spacegrouptyp list space group seto web site httppmslplanetscikobeuacjpsetopage_idlangen_ among possibl choic set chosen default argument use choic sett expect hook affect obtain valu intern hall hall_numb choic transformation_matrix origin shift wyckoff std_lattic std_posit std_type rotat translat sinc later set defin respect basi vector user input cell argument dataset dictionari key number intern space group number intern intern short symbol hall hall symbol hall_numb hall number number use refpy_method_get_symmetry_from_databas refpy_method_get_spacegroup_typ choic centr origin basi vector set transformation_matrix see detail refapi_origin_shift_and_transform origin shift see detail refapi_origin_shift_and_transform wyckoff wyckoff letter equivalent_atom map tabl equival atom rotat translat rotat matric translat vector see refpy_method_get_symmetri detail pointgroup symbol crystallograph point group hermannmauguin notat std_lattic std_posit std_type standard crystal structur correspond hall symbol found equival given array format lattic posit number present refpy_variables_crystal_structur respect pointgrouop_numb serial number crystallograph point group refer list space group seto web site search fail none return see detail key refapi_struct_spglibdataset _py_method_get_symmetry_from_databas get_symmetry_from_databas symmetri get_symmetry_from_databasehall_numb set crystallograph symmetri oper correspond hall_numb return dictionari rotat part translat part access key rotat translat respect definit hall_numb found refapi_spg_get_dataset_spacegroup_typ someth wrong happen none return _py_method_get_spacegroup_typ get_spacegroup_typ new version spacegroup_typ get_spacegroup_typehall_numb function allow directli access spacegrouptyp databas spglib spg_databasec dictionari return specifi space group type specif choic hall_numb use definit hall_numb found refapi_spg_get_dataset_spacegroup_typ key return dictionari follow number international_short international_ful intern schoenfli hall_symbol choic pointgroup_schoenfli pointgroup_intern arithmetic_crystal_class_numb arithmetic_crystal_class_symbol spacegroup_typeinternational_short equival datasetintern get_symmetry_dataset spacegroup_typehall_symbol equival datasethal get_symmetry_dataset spacegroup_typepointgroup_intern equival datasetpointgroup_symbol get_symmetry_dataset someth wrong happen none return niggli_reduc new version niggli_lattic niggli_reducelattic eps niggli reduct achiev use method algorithm detail found httpsatztogogithubioniggli refer origin basi vector store lattic niggli reduc basi vector given niggli_lattic format basi vector found refpy_variables_crystal_structur esp toler paramet unlik symprec unit length use check differ norm two basi vector close zero two basi vector orthogon valu dot product close zero detail shown httpsatztogogithubioniggli search fail none return transform origin basi vector math mathbfa mathbfb mathbfc final baiss vector math mathbfa mathbfb mathbfc achiev linear combin basi vector integ coeffici without rotat coordin therefor transform matrix obtain mathboldsymbolp mathbfa mathbfb mathbfc mathbfa mathbfb mathbfc matrix element almost integ delaunay_reduc new version delaunay_lattic delaunay_reducelattic eps delaunay reduct achiev use method algorithm found intern tabl crystallographi volum origin basi vector store lattic delaunay reduc basi vector given delaunay_lattic format basi vector shown refpy_variables_crystal_structur esp toler paramet unlik symprec unit length use criterion volum close zero two basi vector orthogon valu dot product close zero search fail none return transform origin basi vector math mathbfa mathbfb mathbfc final basi vector math mathbfa mathbfb mathbfc achiev linear combin basi vector integ coeffici without rotat coordin therefor transform matrix obtain mathboldsymbolp mathbfa mathbfb mathbfc mathbfa mathbfb mathbfc matrix element almost integ get_ir_reciprocal_mesh map grid get_ir_reciprocal_meshmesh cell is_shift irreduc kpoint obtain sampl mesh kpoint mesh given three integ array specifi mesh number along reciproc primit axi is_shift given three integ array is_shift set reciproc primit axi mesh shift along axi half adjac mesh point irrespect mesh number valu is_shift set map grid return grid give mesh point fraction coordin reciproc space map give map irreduc kpoint indic obtain npuniquemap np mean numpi modul grid point access gridindex sesarch fail none return exampl shown import numpi np import spglib lattic nparray posit number cell lattic posit number printspglibget_spacegroupcel symprec mesh gamma centr mesh map grid spglibget_ir_reciprocal_meshmesh cell is_shift kpoint map irgrid point ir_gp_id gp enumeratezipmap grid printd ir_gp_id gpastypefloat mesh irreduc kpoint printnumb irkpoint lennpuniquemap printgridnpuniquemap nparraymesh dtypefloat shift map grid spglibget_ir_reciprocal_meshmesh cell is_shift kpoint map irgrid point ir_gp_id gp enumeratezipmap grid printd ir_gp_id gp mesh irreduc kpoint printnumb irkpoint lennpuniquemap printgridnpuniquemap mesh spglib spglib librari find handl crystal symmetri written c spglib python found refpython_spglib version histori summar changelog httpsgithubcomatztogospglibblobmasterchangelog_ news spglibdataset slightli modifi version may hit user python modul pyspglib renam spglib version version x python wrapper pyspglib consid special extent spglib separ maintain version x later start part spglib usual extens python wrapper maintain work follow everi updat cspglib packag name chang pyspglib spglib follow chang way import python spglib modul chang written refpython_spglib featur find symmetri oper identifi spacegroup type wyckoff posit assign refin crystal structur find primit cell search irreduc kpoint document toctre maxdepth instal api variabl python interfac pythonspglib interfac definit refer gener materi intern tabl crystallographi volum b c onlin dictionari crystallographi httpreferenceiucrorgdictionari symmetri relationship crystal structur ulrich muller oxford univers press specif algorithm spacegroup type determin r w grossekunstlev acta cryst crystal refin r w grossekunstlev p adam acta cryst mail list question bug report comment pleas visit follow mail list httpslistssourceforgenetlistslistinfospglibus inform repositori httpsgithubcomatztogospglib licens new bsd version beta older version gplv contact atztogogmailcom authour atsushi togo acknowledg spglib project acknowledg yusuk seto crystallograph databas dimitar pashov fortran interfac paweł jochym python packag instal spglib capi download sourc code download httpsgithubcomatztogospglibreleas minor updat includ packag want latest version gitclon spglib repositori git clone httpsgithubcomatztogospglibgit instal compil use cmake expand sourc code go sourc code directori tar xvfz spglibtargz cd spglib current directori project_source_dir creat directori build mkdir _build cd _build cmake make make instal librari instal project_source_dirlib header file instal project_source_dirinclud compil use configur script configur script prepar use autotool libtool follow acloc autohead libtool glibtool macport etc touch instal news readm author automak acf autoconf run configur script tar xvfz spglibtargz cd spglib configur prefixinstallation_loc make make instal librari instal installation_locationlib found srclib dont run make instal openmp bottl neck symmetri oper search may eas use openmp thread case gcc set follow environ variabl run configur script export libslgomp export cflagsfopenmp overhead thread rel larg number atom small therefor thread activ number atom usag includ spglibh link libsymspga libsymspgso compil exampl shown examplereadm httpsgithubcomatztogospglibblobmasterexamplereadme_ exampl exampl found exampl httpsgithubcomatztogospglibtreemasterexample_ directori capi content list capi depth local spg_get_major_vers spg_get_minor_vers spg_get_micro_vers new version version number spglib obtain three function return integ correspond spglib version majorminormicro spg_get_error_cod spg_get_error_messag new version method may use see spglib fail though error handl spglib sophist spgliberror spg_get_error_codevoid char spg_get_error_messagespgliberror spglib_error spgliberror type enum type shown typedef enum spglib_success spgerr_spacegroup_search_fail spgerr_cell_standardization_fail spgerr_symmetry_operation_search_fail spgerr_atoms_too_clos spgerr_pointgroup_not_found spgerr_niggli_fail spgerr_delaunay_fail spgerr_array_size_shortag spgerr_non spgliberror usag follow spgliberror error error spg_get_error_cod printfsn spg_get_error_messageerror _api_spg_get_symmetri spg_get_symmetri function find set repres symmetri oper primit cell extens lattic translat supercel return fail int spg_get_symmetryint rotat doubl translat const int max_siz const doubl lattic const doubl posit const int type const int num_atom const doubl symprec oper store rotat translat number oper return return valu rotat translat given fraction coordin rotationi translationi index give symmetri oper ie use togeth except case supercel basi vector lattic break crsytallograph point group crystallograph symmetri oper search broken symmetri ie crystallograph point group found case point group lattic exampl happen mathtim time supercel convent cubic unit cell may understand crystallograph sens practic use treatment research comput materi scienc spg_get_intern space group type found return intern tabl symbol symbol also number return valu return fail int spg_get_internationalchar symbol const doubl lattic const doubl posit const int type const int num_atom const doubl symprec spg_get_schoenfli space group type found return schoenfli symbol also number return valu return fail int spg_get_schoenflieschar symbol const doubl lattic const doubl posit const int type const int num_atom const doubl symprec spg_standardize_cel standard unit cell see refdef_standardized_unit_cel gener input unit cell structur space group type determin symmetri search toler usual to_primit no_id recommend set set result behavior spg_refine_cel return fail int spg_standardize_celldoubl lattic doubl posit int type const int num_atom const int to_primit const int no_id const doubl symprec number atom found standard unit primit cell return to_primit use creat standard primit cell transform matrici shown refdef_standardized_primitive_cel otherwis to_primit must specifi found basi vector atom point coordin type overwritten lattic posit type respect therefor to_primit maximum four time larger array size posit type size input unit cell requir store standard unit cell face centr found case input unit cell primit cell no_id disabl ideal length angl basi vector posit atom accord crystal symmetri detail ideal no_id written refdef_idealize_cel no_id may use want leav basi vector atom posit cartesianl coordin fix spg_find_primit behavior chang function shortcut spg_standardize_cel to_primit no_id primit cell found input unit cell return fail int spg_find_primitivedoubl lattic doubl posit int type const int num_atom const doubl symprec lattic posit type overwritten number atom found primit cell return spg_refine_cel function exist backward compat sinc spg_standardize_cel to_primit leave_distort standard crystal structur obtain nonstandard crystal structur may slightli distort within symmetri recognit toler whose primit vector differ chosen etc return fail int spg_refine_celldoubl lattic doubl posit int type const int num_atom const doubl symprec calcul standard lattic atom posit overwrit lattic posit type number atom standard unit cell return return valu input unit cell primit cell face centr symmetri number atom return becom four time larg sinc function mean check array size memori space variabl array size memori space posit type prepar four time requir input unit cell gener _api_spg_get_dataset spg_get_dataset spg_get_dataset_with_hall_numb chang version input unit cell structur symmetri oper crystal search compar crsytallograph databas space group type determin result return spglibdataset structur dataset default choic set basi vector spglib explain manuscript found httparxivorgab usag dataset correspond space group type standard set obtain spg_get_dataset symmetri search fail null return version later spacegroup_numb return previou version function crystallograph set obtain spglibdataset spg_get_datasetconst doubl lattic const doubl posit const int type const int num_atom const doubl symprec specifi crystallograph choic set origin axi cell choic spg_get_dataset_with_hall_numb use spglibdataset spg_get_dataset_with_hall_numberspgconst doubl lattic spgconst doubl posit const int type const int num_atom const int hall_numb const doubl symprec hall_numb use specifi choic possibl choic serial number found list space group seto web site httppmslplanetscikobeuacjpsetopage_idlangen_ crystal structur possess spacegroup type hall symbol symmetri search fail specifi hall_numb list hall symbol space group type crystal structur spacegroup_numb spglibdataset structur set final alloc memori space must freed call spg_free_dataset _api_struct_spglibdataset dataset version spglibdataset modifi member name set chang choic pointgroup_numb remov dataset access cstructur given typedef struct int spacegroup_numb int hall_numb char international_symbol char hall_symbol char choic doubl transformation_matrix doubl origin_shift int n_oper int rotat doubl translat int n_atom int wyckoff int equivalent_atom int n_std_atom n_brv_atom version doubl std_lattic brv_lattic version int std_type brv_type version doubl std_posit brv_posit version char pointgroup_symbol spglibdataset version member name n_std_atom std_lattic std_type std_posit n_brv_atom brv_lattic brv_type brv_posit respect _api_spg_get_dataset_spacegroup_typ space group type spacegroup_numb space group type number defin intern tabl crystallographi ita hall_numb serial number found list space group seto web site httppmslplanetscikobeuacjpsetopage_idlangen_ full hermannmauguin notat space group type given international_symbol hall symbol store hall_symbol inform uniqu axi set cell choic found choic symmetri oper symmetri oper input unit cell store rotat translat crystallograph symmetri oper mathboldsymbolw boldsymbolw made pair rotat mathboldsymbolw translat mathboldsymbolw part index number symmetri oper given n_oper detail explan valu found refapi_spg_get_symmetri _api_spg_get_dataset_site_symmetri site symmetri n_atom number atom input unit cell wyckoff give wyckoff letter assign atom posit input unit cell number mathldot correspond b c mathldot respect number element wyckoff n_atom equivalent_atom list atom indic map indic symmetr independ atom list index correspond atom index input crystal structur _api_origin_shift_and_transform origin shift lattic transform chang version transformation_matrix origin_shift obtain result spacegrouptyp match set uniqu axi set cell choic match basi vector atom point coordin standard compar databas symmetri oper basi vector transform standard unit cell atom point coordin shift symmetri oper standard origin transformation_matrix mathboldsymbolp matrix transform input basi vector standard basi vector wihch repres math mathbfa mathbfb mathbfc mathbfa_mathrm mathbfb_mathrm mathbfc_mathrm boldsymbolp mathmathbfa mathmathbfb mathmathbfc input origin basi vector mathmathbfa_mathrm mathmathbfb_mathrm mathmathbfc_mathrm standard basi vector origin_shift mathboldsymbolp vector origin standard coordin system origin input origin coordin system measur standard coordin system atom point shift measur standard unit cell convent unit cell origin unit cell measur coordin standard unit cell atom point origin unit cell mathboldsymbolx input data map standard unit cell mathboldsymbolx_mathrm math boldsymbolx_mathrm boldsymbolpboldsymbolx boldsymbolp mathrmmod mathbf version x transformation_matrix origin_shift defin follow math mathbfa_mathrm mathbfb_mathrm mathbfc_mathrm mathbfa mathbfb mathbfc boldsymbolp textand boldsymbolx_mathrm boldsymbolpboldsymbolx boldsymbolp mathrmmod mathbf respect standard crystal structur chang version standard crystal structur correspond hall symbol store n_std_atom std_lattic std_type std_posit version x variabl name member correspond n_brv_atom brv_lattic brv_type brv_posit respect crystallograph point group new version pointgroup_numb serial number crystallograph point group refer list space group seto web site httppmslplanetscikobeuacjpsetopage_idlangen_ pointgroup_symbol symbol crystallograph point group hermannmauguin notat spg_free_dataset alloc memoeri space cstructur spglibdataset freed call spg_free_dataset void spg_free_datasetspglibdataset dataset spg_get_spacegroup_typ chang version member ad member name set chang choic function allow directli access spacegrouptyp databas spglib spg_databasec specifi space group type specif choic hall_numb use definit hall_numb found refapi_spg_get_dataset_spacegroup_typ number return fail spglibspacegrouptyp spg_get_spacegroup_typeconst int hall_numb spglibspacegrouptyp structur follow typedef struct int number char international_short char international_ful char intern char schoenfli char hall_symbol char choic char pointgroup_schoenfli char pointgroup_intern int arithmetic_crystal_class_numb char arithmetic_crystal_class_symbol spglibspacegrouptyp spg_get_symmetry_from_databas function allow directli access space group oper spglib databas spg_databasec specifi space group type specif choic hall_numb use definit hall_numb found refapi_spg_get_dataset_spacegroup_typ return fail int spg_get_symmetry_from_databaseint rotat doubl translat const int hall_numb return valu number space group oper space group oper store rotat translat spg_get_multipl function return exact number symmetri oper return fail int spg_get_multiplicityconst doubl lattic const doubl posit const int type const int num_atom const doubl symprec function may use advanc alloc memoeri space symmetri oper spg_get_symmetry_with_collinear_spin function find symmetri oper collinear polar spin atom except argument const doubl spin usag basic spg_get_symmetri output equivalent_atom obtain size array num_atom see refapi_spg_get_dataset_site_symmetri definit equivalent_atom return fail int spg_get_symmetry_with_collinear_spinint rotat doubl translat int equivalent_atom const int max_siz spgconst doubl lattic spgconst doubl posit const int type const doubl spin const int num_atom const doubl symprec spg_niggli_reduc niggli reduct appli input basi vector lattic reduc basi vector overwritten lattic return fail int spg_niggli_reducedoubl lattic const doubl symprec transform origin basi vector math mathbfa mathbfb mathbfc final basi vector math mathbfa mathbfb mathbfc achiev linear combin basi vector integ coeffici without rotat coordin therefor transform matrix obtain mathboldsymbolp mathbfa mathbfb mathbfc mathbfa mathbfb mathbfc matrix element almost integ spg_delaunay_reduc delaunay reduct appli input basi vector lattic reduc basi vector overwritten lattic return fail int spg_delaunay_reducedoubl lattic const doubl symprec transform origin basi vector math mathbfa mathbfb mathbfc final basi vector math mathbfa mathbfb mathbfc achiev linear combin basi vector integ coeffici without rotat coordin therefor transform matrix obtain mathboldsymbolp mathbfa mathbfb mathbfc mathbfa mathbfb mathbfc matrix element almost integ spg_get_ir_reciprocal_mesh irreduc reciproc grid point search uniform mesh grid point specifi mesh is_shift int spg_get_ir_reciprocal_meshint grid_address int map const int mesh const int is_shift const int is_time_revers const doubl lattic const doubl posit const int type const int num_atom const doubl symprec mesh store three integ reciproc primit vector divid number store mesh point center center grid mesh shift grid space along correspond reciproc axi set is_shift element grid mesh shift made set is_shift reduc uniform grid point return fraction coordin grid_address map reduc irreduc point return map indic grid_address number irreduc kpoint return return valu time revers symmetri impos set is_time_revers grid point store order run left element first eg xx mesh first index run first kqpoint calcul grid_address is_shift mesh grid point index recov grid_address numpydotgrid_address mesh mesh mesh mesh pythonnumpi notat alway return nonneg integ order grid_address chang last index run first set macro grid_order_xyz kpointc case grid point index recov numpydotgrid_address mesh mesh mesh mesh spg_get_stabilized_reciprocal_mesh irreduc kpoint search uniqu kpoint mesh grid direct real space basi vector set rotat part symmetri oper direct space one multipl stabil int spg_get_stabilized_reciprocal_meshint grid_address int map const int mesh const int is_shift const int is_time_revers const int num_rot const int rotat const int num_q const doubl qpoint stabil written fraction coordin number stabil given num_q symmetr equival kpoint star fraction coordin store map indic grid_address number reduc kpoint stabil return return valu function use obtain mesh grid point set num_rot rotat num_q qpoint variabl variabl frequent use capi explain interfac languag definit may differ eg lattic python interfac transpos content depth local _variables_lattic lattic attent python interfac lattic transpos refpy_variables_crystal_structur basi vector cartesian a_x b_x c_x a_i b_i c_i a_z b_z c_z cartesian posit mathmathbfx_mathrmcart obtain math mathbfx_mathrmcart mathrmlcdotmathbfx_mathrmfrac mathmathrml basi vector defin mathmathrmlmathbfamathbfbmathbfc mathmathbfx_mathrmfrac atom posit fraction coordin given posit atom point fraction coordin respect basi vector x_a x_b x_c x_a x_b x_c x_a x_b x_c type atom speci differenci integ nubmer use distinguish atom releat atom number type_ type_ type_ number element number atom rotat rotat matrici ingeg symmetri oper r_aa r_ab r_ac r_ba r_bb r_bc r_ca r_cb r_cc translat translat vector correspond symmetri oper fraction coordin t_a t_b t_c symprec toler distanc atom posit length lattic vector toler symmetri find angl distort lattic vector convert length compar distanc toler explicit angl toler expect see angle_toler _variables_angle_toler angle_toler experiment toler angl lattic vector degre toler symmetri find use angl toler anoth set function prepar follow spgat_get_dataset spgat_get_symmetri spgat_get_symmetry_with_collinear_spin spgat_get_multipl spgat_find_primit spgat_get_intern spgat_get_schoenfli spgat_refine_cel function call way addit argument const doubl angle_toler degre specifi neg valu behavior becom usual function default valu angle_toler neg valu definit convent inform page valid spglib later definit transform matrix origin shift differ previou version content depth local refer refer crystallograph definit convent shown though spglib may follow fulli doesnt mean spglib doesnt respect rather due lack understand author spglib intern tabl crystallographi httpitiucrorg_ bilbao crystallograph server httpwwwcrystehues_ refer mani use paper found httpwwwcrystehueswikiindexphparticl ulrich müller symmetri relationship crystal structur e parthé k cenzual r e gladyshevskii standard crystal structur data aid classif crystal structur type journal alloy compound doi httpsdxdoiorgs_ e parthé l gelato best unit cell monoclin structur consist b axi uniqu cell choic intern tabl crystallographi acta cryst doi httpsdoiorgs_ e parthé l gelato standard inorgan crystalstructur data acta cryst doi httpsdoiorgs_ hall spacegroup notat explicit origin acta cryst doi httpsdoiorgs_ basi vector mathmathbfa mathbfb mathbfc mathmathbfa_ mathbfa_ mathbfa_ spglib basi vector repres three column vector math mathbfa beginpmatrix a_x a_i a_z endpmatrix mathbfb beginpmatrix b_x b_i b_z endpmatrix mathbfc beginpmatrix c_x c_i c_z endpmatrix cartesian coordin depend situat mathmathbfa_ mathbfa_ mathbfa_ use instead mathmathbfa mathbfb mathbfc atom point coordin mathboldsymbolx coordin atom point mathboldsymbolx repres three fraction valu rel basi vector follow math boldsymbolx beginpmatrix x_ x_ x_ endpmatrix math le x_i posit vector mathmathbfx cartesian coordin obtain math mathbfx mathbfa mathbfb mathbfc boldsymbolx math mathbfx sum_i x_i mathbfa_i symmetri oper mathboldsymbolw boldsymbolw symmetri oper consist pair rotat part mathboldsymbolw translat part mathboldsymbolw repres mathboldsymbolw boldsymbolw spglib document symmetri oper transfer mathboldsymbolx mathtildeboldsymbolx follow math tildeboldsymbolx boldsymbolwboldsymbolx boldsymbolw transform matrix mathboldsymbolp origin shift mathboldsymbolp transform matrix mathboldsymbolp chang choic basi vector follow math mathbfa mathbfb mathbfc mathbfa_mathrm mathbfb_mathrm mathbfc_mathrm boldsymbolp math mathbfa mathbfb mathbfc math mathbfa_mathrm mathbfb_mathrm mathbfc_mathrm basi vector arbitrari system starndard system respect transform matrix doesnt rotat crystal cartesian coordin chang choic basi vector origin shift mathboldsymbolp give vector origin standard system mathboldsymbolo_mathrm origin arbitrari system mathboldsymbolo math boldsymbolp boldsymbolo boldsymbolo_mathrm origin shift doesnt move crystal cartesian coordin chang origin measur coordin atom point chang basi describ combin transform matrix origin shift denot mathboldsymbolp boldsymbolp first transform matrix appli origin shift point standard system mathboldsymbolx_mathrm arbitrari system mathboldsymbolx relat math boldsymbolx_mathrm boldsymbolpboldsymbolx boldsymbolp equival math boldsymbolx boldsymbolpboldsymbolx_mathrm boldsymbolpboldsymbolp graphic exampl shown cob imag changeofbasispng width cob click figur enlarg exampl math renewcommandarraystretch boldsymbolp beginpmatrix frac frac fracbar frac endpmatrix _def_standardized_unit_cel convent standard unit cell choic basi vector use api spg_get_dataset spg_get_dataset_with_hall_numb spg_standardize_cel starndard unit cell obtain starndard unit cell document mean convent unit cell structur standard crystal symmetri length basi vector crystal categor hall symbol differ type term space group type uniqu axe set cell choic moreov spglib length basi vector use choos order mathmathbfa mathbfb mathbfc order determin symmetr convent _def_standardized_primitive_cel transform primit cell standard unit cell five differ centr type avail base centr c rhombohedr r bodi centr face centr f transform appli standard unit cell math mathbfa_mathrmp mathbfb_mathrmp mathbfc_mathrmp mathbfa_mathrm mathbfb_mathrm mathbfc_mathrm boldsymbolp_mathrmc mathmathbfa_mathrmp mathmathbfb_mathrmp mathmathbfc_mathrmp basi vector primit cell mathboldsymbolp_mathrmc transform matrix standard unit cell primit cell mathboldsymbolp_mathrmc centr type given follow math renewcommandarraystretch boldsymbolp_mathrma beginpmatrix frac fracbar frac frac endpmatrix renewcommandarraystretch boldsymbolp_mathrmc beginpmatrix frac frac fracbar frac endpmatrix boldsymbolp_mathrmr beginpmatrix frac fracbar fracbar frac frac fracbar frac frac frac endpmatrix boldsymbolp_mathrmi beginpmatrix fracbar frac frac frac fracbar frac frac frac fracbar endpmatrix boldsymbolp_mathrmf beginpmatrix frac frac frac frac frac frac endpmatrix rhombohedr lattic system choic hexagon axe mathboldsymbolp_mathrmr appli _def_idealize_cel ideal unit cell structur spglib allow toler paramet match slightli distort unit cell structur space group type higher symmetri use obtain symmetri oper distort remov ideal unit cell structur coordin atom point ideal use respect sitesymmetri grossekunstlev et al basi vector ideal forc respect lattic shape follow treatment except triclin crystal crystal rotat cartesian coordin differ type transform changeofbasi transform explain triclin lattic niggli reduc cell use choos mathmathbfa mathbfb mathbfc mathmathbfa set along mathx direct cartesian coordin mathmathbfb set mathxtexti plane cartesian coordin mathmathbfatimesmathbfb along mathz direct cartesian coordin monoclin lattic mathb axi taken uniqu axi mathalpha circ mathgamma circ mathcirc beta circ mathmathbfa set along mathx direct cartesian coordin mathmathbfb set along mathi direct cartesian coordin mathmathbfc set mathxtextz plane cartesian coordin orthorhomb lattic mathalpha beta gamma circ mathmathbfa set along mathx direct cartesian coordin mathmathbfb set along mathi direct cartesian coordin mathmathbfc set along mathz direct cartesian coordin tetragon lattic mathalpha beta gamma circ mathab mathmathbfa set along mathx direct cartesian coordin mathmathbfb set along mathi direct cartesian coordin mathmathbfc set along mathz direct cartesian coordin rhombohedr lattic mathalpha beta gamma mathabc let mathmathbfa mathmathbfb mathmathbfc project mathxtexti plane cartesian coordin mathmathbfa_xi mathmathbfb_xi mathmathbfc_xi respect angl mathalpha_xi mathbeta_xi mathgamma_xi respect let mathmathbfa mathmathbfb mathmathbfc project along mathzaxi cartesian coordin mathmathbfa_z mathmathbfb_z mathmathbfc_z respect mathmathbfa_xi set along mathx direct cartesian coordin mathmathbfb_xi mathmathbfc_xi place angl mathcirc mathcirc mathmathbfa_xi counterclockwis respect mathalpha_xi beta_xi gamma_xi circ matha_xi b_xi c_xi matha_z b_z c_z hexagon lattic mathalpha beta circ mathgamma circ mathab mathmathbfa set along mathx direct cartesian coordin mathmathbfb set mathxtexti plane cartesian coordin mathmathbfc set along mathz direct cartesian coordin cubic lattic mathalpha beta gamma circ mathabc mathmathbfa set along mathx direct cartesian coordin mathmathbfb set along mathi direct cartesian coordin mathmathbfc set along mathz direct cartesian coordin